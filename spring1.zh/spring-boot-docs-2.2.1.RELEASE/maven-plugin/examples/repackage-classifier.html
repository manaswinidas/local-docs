<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Stephane Nicoll">
    <meta name="Date-Creation-yyyymmdd" content="20140502">
    <meta name="Date-Revision-yyyymmdd" content="20191106">
    <meta http-equiv="Content-Language" content="en">
    <title>Spring Boot Maven插件–重新打包分类器</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.6.min.css">
    <link rel="stylesheet" href="../css/site.css">
    <link rel="stylesheet" href="../css/print.css" media="print">
      <script type="text/javascript" src="../js/apache-maven-fluido-1.6.min.js"></script>
      
    
      </head><body class="topBarDisabled" >
<div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>Spring Boot Maven插件</h2>
</div>
</div>
        <div class="pull-right"></div>
        <div class="clear"><hr></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">上次发布时间：2019-11-06 <span class="divider">|</span>
</li>
          <li id="projectVersion">版本：2.2.1。发布</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
          <li class="nav-header">总览</li>
    <li><a href="../index.html" title="介绍"><span class="none"></span>介绍</a>  </li>
    <li><a href="../plugin-info.html" title="目标"><span class="none"></span>目标</a>  </li>
    <li><a href="../usage.html" title="用法"><span class="none"></span>用法</a>  </li>
          <li class="nav-header">例子</li>
    <li class="active"><a href="#"><span class="none"></span>自定义重新包装分类器</a>
  </li>
    <li><a href="../examples/repackage-name.html" title="自订重新包装名称"><span class="none"></span>自订重新包装名称</a>  </li>
    <li><a href="../examples/repackage-disable-attach.html" title="本地重新打包的工件"><span class="none"></span>本地重新打包的工件</a>  </li>
    <li><a href="../examples/exclude-dependency.html" title="排除依赖项"><span class="none"></span>排除依赖项</a>  </li>
    <li><a href="../examples/run-debug.html" title="调试应用程序"><span class="none"></span>调试应用程序</a>  </li>
    <li><a href="../examples/run-system-properties.html" title="使用系统属性"><span class="none"></span>使用系统属性</a>  </li>
    <li><a href="../examples/run-env-variables.html" title="使用环境变量"><span class="none"></span>使用环境变量</a>  </li>
    <li><a href="../examples/it-random-port.html" title="随机端口用于集成测试"><span class="none"></span>随机端口用于集成测试</a>  </li>
    <li><a href="../examples/it-skip.html" title="跳过集成测试"><span class="none"></span>跳过集成测试</a>  </li>
    <li><a href="../examples/run-profiles.html" title="指定活动的配置文件"><span class="none"></span>指定活动的配置文件</a>  </li>
    <li><a href="../examples/build-info.html" title="生成构建信息"><span class="none"></span>生成构建信息</a>  </li>
    <li><a href="../examples/custom-layout.html" title="自定义布局"><span class="none"></span>自定义布局</a>  </li>
          <li class="nav-header">项目文件</li>
    <li><a href="../project-info.html" title="项目信息"><span class="icon-chevron-right"></span>项目信息</a>  </li>
    <li><a href="../project-reports.html" title="项目报告"><span class="icon-chevron-right"></span>项目报告</a>  </li>
  </ul>
          <hr>
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="由Maven建造" class="poweredBy"><img class="builtBy" alt="由Maven建造" src="../images/logos/maven-feather.png"></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn" class="span10">
<p>默认情况下， <code>repackage</code>目标将用重新包装的工件代替原始工件。对于代表应用程序的模块来说，这是一种理智的行为，但是如果您的模块用作另一个模块的依赖项，则需要为重新包装的模块提供分类器。</p>
<p>原因是应用程序类打包在<code>BOOT-INF/classes</code>因此从属模块无法加载重新包装的jar的类。如果是这种情况，或者如果您希望保留原始工件，并使用其他分类器附加重新包装的工件，请按如下所示配置插件：</p>
<div>
<pre>&lt;project&gt;
  ...
  &lt;build&gt;
    ...
    &lt;plugins&gt;
      ...
      &lt;plugin&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.2.1.RELEASE&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;repackage&lt;/id&gt;
            &lt;goals&gt;
              &lt;goal&gt;repackage&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
              &lt;classifier&gt;exec&lt;/classifier&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
        ...
      &lt;/plugin&gt;
      ...
    &lt;/plugins&gt;
    ...
  &lt;/build&gt;
  ...
&lt;/project&gt;</pre></div>
<p>如果您使用的是spring-boot-starter-parent，则重新包装目标将在ID为repackage的执行中自动执行。在该设置中，仅应指定配置，如以下示例所示：</p>
<div>
<pre>&lt;project&gt;
  ...
  &lt;build&gt;
    ...
    &lt;plugins&gt;
      ...
      &lt;plugin&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;repackage&lt;/id&gt;
            &lt;configuration&gt;
              &lt;classifier&gt;exec&lt;/classifier&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
        ...
      &lt;/plugin&gt;
      ...
    &lt;/plugins&gt;
    ...
  &lt;/build&gt;
  ...
&lt;/project&gt;</pre></div>
<p>此配置将生成两个工件：原始工件和由重新包装目标产生的重新包装的对应零件。两者都将透明安装/部署。</p>
<p>如果要以替换主工件的相同方式重新打包辅助工件，也可以使用相同的配置。以下配置安装/部署单个<code>task</code>重新打包的应用程序具有分类的工件：</p>
<div>
<pre>&lt;project&gt;
  ...
  &lt;build&gt;
    ...
    &lt;plugins&gt;
      ...
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
        &lt;version&gt;@maven-jar-plugin.version@&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;jar&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;phase&gt;package&lt;/phase&gt;
            &lt;configuration&gt;
              &lt;classifier&gt;task&lt;/classifier&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
    &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.2.1.RELEASE&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;repackage&lt;/id&gt;
            &lt;goals&gt;
              &lt;goal&gt;repackage&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
              &lt;classifier&gt;task&lt;/classifier&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
        ...
      &lt;/plugin&gt;
      ...
    &lt;/plugins&gt;
    ...
  &lt;/build&gt;
  ...
&lt;/project&gt;</pre></div>
<p>由于两者<code>maven-jar-plugin</code>和<code>spring-boot-maven-plugin</code>在同一阶段运行，必须首先定义jar插件（这样才能在重新打包目标之前运行），这一点很重要。</p>
<p>同样，如果您使用的是“ spring-boot-starter-parent”，则可以简化如下：</p>
<div>
<pre>&lt;project&gt;
  ...
  &lt;build&gt;
    ...
    &lt;plugins&gt;
      ...
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;default-jar&lt;/id&gt;
            &lt;configuration&gt;
              &lt;classifier&gt;task&lt;/classifier&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
    &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;repackage&lt;/id&gt;
            &lt;configuration&gt;
              &lt;classifier&gt;task&lt;/classifier&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
        ...
      &lt;/plugin&gt;
      ...
    &lt;/plugins&gt;
    ...
  &lt;/build&gt;
  ...
&lt;/project&gt;</pre></div>
        </div>
      </div>
    </div>
    <hr>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>版权所有©2019 <a href="https://spring.io">Pivotal Software，Inc</a> .版权所有。</p>
        </div>
        </div>
    </footer>
    

</body></html>