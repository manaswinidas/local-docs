<html lang="en-US"  xmlns="http://www.w3.org/1999/xhtml"><head></head><body  onload="load()">﻿
        <title>结合使用具有GUI API的JDBC（Java™教程> JDBC（TM）数据库访问> JDBC基础）</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
     <meta name="description" content="This JDBC Java tutorial describes how to use JDBC API to create, insert into, update, and query tables. You will also learn how to use simple and prepared statements, stored procedures and perform transactions">
     <meta name="keywords" content="java programming, learn java, java sample code, jdbc, prepared statement, result set">
        
<style type="text/css">
    body {
        margin-left:10px;
        margin-right:10px;
        line-height: 1.5;
        FONT-FAMILY: Arial, Helvetica, sans-serif; 
        font-size: 0.8em;
    }
    
    a:link{text-decoration:none; color:#09569d;}
    a:visited{text-decoration:none; color: #3a87cf;}
    a:hover{text-decoration:underline; }
        
    code{
        font-family:Monaco,Courier,"Courier New";
    }
    
    .header-container {
        background-color: #fff;
        border-bottom: 1px solid #C1CFDA;
        -webkit-box-shadow: 0 2px 2px rgba(117, 163, 231, 0.1);
        box-shadow: 0 2px 2px rgba(117, 163, 231, 0.1);
    }
    
    .bookwrapper {
        width: auto;
        margin: auto;
    }
    
    .clearfix {
    }
    
    .clearfloat {
        clear: both;
        overflow: auto;
        height: 0px;
        font-size: 1px;
        line-height: 0px;
    }
    
    #brandProdName {
        width: auto;
        height: auto;
    }
    
    #logocover {
        display: block;
        background: transparent url(../../images/oracle-java-logo.png) 0px 0px no-repeat;
        height: 50px;
        width: 229px;
        float: left;
    }
    
    #productName {
        font-size: 16px;
        position: relative;
        top: 19px;
        padding-left: 3px;
        color: #457798;
        white-space: nowrap;
        width: 340px;
    }


    .FigureCaption   { 
        font-family: sans-serif; 
        text-align: center;
    }
    
    #TopBar_bl {        
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        margin-left: -110px;
        margin-right: -100px;       
		align: left;
        height: 60px;
    }
    #TopBar_tr {
        width: 100%;
        height: 60px;
    }
    
    #TopBar {
        min-width:700px;
        padding:25px 100px 10px;
        margin-bottom:25px;
        clear:both;
        
        border-bottom:1px solid #d2dde5;
        border-radius: 3px;
    
        background:#efefef; /* Old browsers */
        /* IE9 SVG, needs conditional override of 'filter' to 'none' */
        background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2ZmZmZmZiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlMmVmZjkiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
        background: -moz-linear-gradient(top,  #ffffff 0%, #e2eff9 100%); /* FF3.6+ */
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#e2eff9)); /* Chrome,Safari4+ */
        background: -webkit-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* Chrome10+,Safari5.1+ */
        background: -o-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* Opera 11.10+ */
        background: -ms-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* IE10+ */
        background: linear-gradient(to bottom,  #ffffff 0%,#e2eff9 100%); /* W3C */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#e2eff9',GradientType=0 ); /* IE6-8 */
        
    }
    
    #TopBar_left {
        line-height: 14px;
        position: absolute;
        padding-top: 30px;
        padding-right: 30px;
        padding-left: 30px;
        text-align: left;
        font: 13px/20px Arial, Helvetica, sans-serif;
        font-weight: bold;
        font-size: 20px;
        color: #333;
    }
    
    #TopBar_right {
        line-height: 12px;
        float: right;
        padding-top: 10px;
        padding-right: 30px;
        text-align: left;
    }
    

    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    
     
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 10px;
        margin: 3px;
        padding: 0;
    }
 
    #BreadCrumbs {
        padding: 15px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    
    #BreadCrumbs a {
        color:#09569d;
    }
    
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #F90000;
    }
    
    #PageContent{
        margin: 0 5px 0 20px;
    }
    
    .LeftBar_shown {
        width: 13em;
        float: left;
    }
    
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    
    .LeftBar_hidden {
        display: none;
    }
    
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;       
    }
    
    .footertext {
        font-size: 10px;
        font-family: sans-serif; 
        margin-top: 1px;
    }

    .NavBit  {
        padding: 15px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    
    @media print {
        .NavBit {
            display: none;
        }
    }
    
    #TagNotes {
        text-align: right;        
    }
    
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    
    #Contents a, .NavBit a, #TagNotes a {
        color:#09569d;
    }
    
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em;
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #333;
		
		
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
	
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h1, h2, h3, h4, h5 {
        color: #333;
        
    }

    h1 {
        font-weight: bold;
        font-size: 20px;
    }

    h2 {
        font-weight: bold;
        font-size: 17px;
    }

    h3 {
        font-weight: bold;
        font-size: 14px;
    }

    h4 {
        font-size: 15px;
    }

    h5 {
        font-size: 12px;
    }


    #ToggleLeft {
        display: none;
    }
    
    .note {
        margin: 0 30px 0px 30px;
    }
    
    .codeblock {
        margin: 0 30px 0px 30px;
		font-size:12px;
		font-family:Monaco,Courier,"Courier New";
    }
    
    .tocli {
        list-style-type:none;
    }

    .betadraft {
        color: red;
    }

</style>
<script type="text/javascript">
/* <![CDATA[ */
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }

    function showCode(displayCodePage, codePath) {
        var codePathEls = codePath.split("/");
        var currDocPathEls = location.href.split("/");
        //alert ("codePathEls = " + codePathEls + "\n" + "currDocPathEls = " + currDocPathEls);
        currDocPathEls.pop(); // remove file name at the end
        while (codePathEls.length > 0) {
            if (codePathEls[0] == "..") {
                codePathEls.shift();
                currDocPathEls.pop();
            } else {
                break;
            }
        }
        var fullCodePath = currDocPathEls.join("/") + "/" + codePathEls.join("/");
        //alert ("fullCodePath = " + fullCodePath );
        if (codePath.indexOf(".java") != -1 || codePath.indexOf(".jnlp") != -1) {
            window.location.href = displayCodePage + "?code=" + encodeURI(fullCodePath);
        } else {
            window.location.href = fullCodePath;
        }
    }
/* ]]> */    
</script>


    <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script>

    <noscript>要使此页面正常运行，需要启用JavaScript的浏览器。
    </noscript>
        <!-- header -->
    <div class="header-container">
        <div class="bookwrapper  clearfix">       
            <div id="brandProdName">
                <div id="logocover"></div>
                <div id="productName">文献资料</div>
            </div> 
            <br class="clearfloat">
        </div>
    </div>
    
    <div id="TopBar">
        <div id="TopBar_tr">
            <div id="TopBar_tl">
                <div id="TopBar_br"> <div id="TopBar_bl"> 
                    <div id="TopBar_left">Java™教程</div>
                        <div id="TopBar_right"> 
                            <!--
                            <a href="URL" target="_blank">External Link</a><br/>
                            --> <a href="javascript:void(0);" id="ToggleLeft">隐藏目录</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div id="LeftBar" class="LeftBar_shown">
        <div id="Contents">
            <div class="linkLESSON"><a href="index.html">JDBC基础</a></div>
<div class="linkAHEAD"><a href="gettingstarted.html">入门</a></div>
<div class="linkAHEAD"><a href="processingsqlstatements.html">使用JDBC处理SQL语句</a></div>
<div class="linkAHEAD"><a href="connecting.html">建立连接</a></div>
<div class="linkAHEAD"><a href="sqldatasources.html">连接数据源对象</a></div>
<div class="linkAHEAD"><a href="sqlexception.html">处理SQLException</a></div>
<div class="linkAHEAD"><a href="tables.html">设置表格</a></div>
<div class="linkAHEAD"><a href="retrieving.html">从结果集中检索和修改值</a></div>
<div class="linkAHEAD"><a href="prepared.html">使用准备好的语句</a></div>
<div class="linkAHEAD"><a href="transactions.html">使用交易</a></div>
<div class="linkAHEAD"><a href="rowset.html">使用行集对象</a></div>
<div class="linkAHEAD"><a href="jdbcrowset.html">使用JdbcRowSet对象</a></div>
<div class="linkAHEAD"><a href="cachedrowset.html">使用CachedRowSetObjects</a></div>
<div class="linkAHEAD"><a href="joinrowset.html">使用JoinRowSet对象</a></div>
<div class="linkAHEAD"><a href="filteredrowset.html">使用FilteredRowSet对象</a></div>
<div class="linkAHEAD"><a href="webrowset.html">使用WebRowSet对象</a></div>
<div class="linkAHEAD"><a href="sqltypes.html">使用高级数据类型</a></div>
<div class="linkAHEAD"><a href="blob.html">使用大对象</a></div>
<div class="linkAHEAD"><a href="sqlxml.html">使用SQLXML对象</a></div>
<div class="linkAHEAD"><a href="array.html">使用数组对象</a></div>
<div class="linkAHEAD"><a href="distinct.html">使用DISTINCT数据类型</a></div>
<div class="linkAHEAD"><a href="sqlstructured.html">使用结构化对象</a></div>
<div class="linkAHEAD"><a href="sqlcustommapping.html">使用自定义类型映射</a></div>
<div class="linkAHEAD"><a href="sqldatalink.html">使用数据链接对象</a></div>
<div class="linkAHEAD"><a href="sqlrowid.html">使用RowId对象</a></div>
<div class="linkAHEAD"><a href="storedprocedures.html">使用存储过程</a></div>
<div class="nolinkAHEAD">结合使用JDBC和GUI API</div>
</div>
    </div>
    <div id="MainFlow" class="MainFlow_indented">
    <div class="PrintHeaders">
        <b>Trail：</b> JDBC（TM）数据库访问<br><b>课程：</b> JDBC基础</div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">主页</a> > <a href="../index.html" target="_top">JDBC（TM）数据库访问</a> > <a href="index.html" target="_top">JDBC基础</a>
            </div>
            <div class="NavBit">
                <a href="storedprocedures.html" target="_top">«上一个</a> • <a href="../TOC.html" target="_top">追踪</a> • <a href="../end.html" target="_top">下一个»</a>
            </div>
            <div class="Banner"><p style="background-color:rgb(247,248,249);border-width:1px;padding:10px;font-style:italic;border-style:solid;border-color:rgb(64,74,91)">Java教程是为JDK 8编写的。此页面中描述的示例和实践没有利用更高版本中引入的改进。</p></div>
            <div id="PageTitle"><h1>结合使用JDBC和GUI API</h1></div>
            <div id="PageContent">

<!-- Using JDBC with GUI API -->
<p>这个样本<code><a href="gettingstarted.html">CoffeesFrame.java</a></code>演示如何将JDBC与GUI API（特别是Swing API）集成在一起。它显示的内容<code>COFFEES</code>表中的数据库表，并包含使您可以向表中添加行的字段和按钮。以下是此示例的屏幕截图：</p>
<center><img src="../../figures/jdbc/coffeesframe.gif" width="453" height="314" align="bottom" alt="Sample CoffeeFrames.java的屏幕截图"></center><p>该示例包含五个文本字段，分别对应于<code>COFFEES</code>表。它还包含三个按钮：</p>
<ul>
<li><strong>在表格中添加行</strong> ：根据在文本字段中输入的数据，在样本的表格中添加一行。</li>
<li><strong>更新数据库</strong> ：更新表<code>COFFEES</code>基于样本表中的数据。</li>
<li><strong>放弃更改</strong> ：检索内容<code>COFFEES</code>表，替换样本表中的现有数据。</li>
</ul>
<p>该样本（需要<code>CoffeesTableModel</code> ）演示了将JDBC与Swing API集成的以下常规步骤：</p>
<ol>
<li><a href="#implementing_tablemodel">实施<code>TableModel</code>接口</a></li>
<li><a href="#implemeting_rowsetlistener">实施<code>RowSetListener</code>接口</a></li>
<li><a href="#laying_out_swing">布置Swing组件</a></li>
<li><a href="#adding_listeners">为示例中的按钮添加侦听器</a></li>
</ol>
<!-- ***************************** -->
<h2><a name="implementing_tablemodel" id="implementing_tablemodel">实现javax.swing.event。表格模型</a></h2>
<p>的<code>TableModel</code>介面可让Java Swing应用程式管理<code>JTable</code>宾语。这个样本， <a href="gettingstarted.html"><code>CoffeesTableModel.java</code></a> ，实现此接口。它指定了如何<code>JTable</code>对象应该从<code>RowSet</code>对象并将其显示在表格中。</p>
<p><strong>注意</strong> ：尽管此示例显示了<code>COFFEES</code> Swing应用程序中的表，类<code>CoffeesTableModel</code>应该可以用于任何SQL表，只要它的数据可以用<code>String</code>对象。（但是，允许用户向其中添加行的字段<code>COFFEES</code> ，在类中指定<code>CoffeesFrame</code> ，则必须针对其他SQL表进行修改。）</p>
<p>在实现接口方法之前<code>TableModel</code> ，该类的构造函数<code>CoffeeTableModel</code>初始化这些实现的方法所需的各种成员变量，如下所示：</p>
<div class="codeblock"><pre>
public CoffeesTableModel(CachedRowSet rowSetArg)
    throws SQLException {

    this.coffeesRowSet = rowSetArg;
    this.metadata = this.coffeesRowSet.getMetaData();
    numcols = metadata.getColumnCount();

    // Retrieve the number of rows.
    this.coffeesRowSet.beforeFirst();
    this.numrows = 0;
    while (this.coffeesRowSet.next()) {
        this.numrows++;
    }
    this.coffeesRowSet.beforeFirst();
}
</pre></div>
<p>下面介绍在此构造函数中初始化的成员变量：</p>
<ul>
<li>
<p><code>CachedRowSet coffeesRowSet</code> ：存储表的内容<code>COFFEES</code> 。</p>
<p>本示例使用<code>RowSet</code>对象，特别是一个<code>CachedRowSet</code>对象，而不是<code>ResultSet</code>反对有两个原因。一种<code>CachedRowSet</code>对象使应用程序的用户无需连接数据库就可以更改其中包含的数据。另外，因为<code>CachedRowSet</code> object是JavaBeans组件，它可以在发生某些事情时通知其他组件。在此示例中，将新行添加到<code>CachedRowSet</code>对象，它通知正在将其数据呈现在表中的Swing组件刷新自身并显示新行。</p>
</li>
<li>
<p><code>ResultSetMetaData metadata</code> ：检索表中的列数<code>COFFEES</code>以及每个名称。</p>
</li>
<li>
<p><code>int numcols, numrows</code> ：分别存储表中的列数和行数<code>COFFEES</code> 。</p>
</li>
</ul>
<p>的<code>CoffeesTableModel.java</code>该示例实现了以下方法<code>TableModel</code>接口：</p>
<ul>
<li><code>Class<?> getColumnClass(int columnIndex)</code> ：返回列中所有单元格值的最特定的超类。</li>
<li><code>int getColumnCount()</code> ：返回模型中的列数。</li>
<li><code>String getColumnName(int columnIndex)</code> ：返回参数指定的列的名称<code>columnIndex</code> 。</li>
<li><code>int getRowCount()</code> ：返回模型中的行数。</li>
<li><code>Object getValueAt(int rowIndex, int columnIndex)</code> ：返回列交点处的单元格的值<code>columnIndex</code>和那排<code>rowIndex</code> 。</li>
<li><code>boolean isCellEditable(int rowIndex, int columnIndex)</code> ：如果列交点处的单元格返回true <code>rowIndex</code>和那排<code>columnIndex</code>可以编辑。</li>
</ul>
<p>由于该示例不允许用户直接编辑表的内容，因此尚未实现以下方法：</p>
<ul>
<li><code>void addTableModelListener(TableModelListener l)</code> ：将侦听器添加到每次数据模型发生更改时都会通知的列表。</li>
<li><code>void removeTableModelListener(TableModelListener l)</code> ：从每次数据模型发生更改时通知的列表中删除一个侦听器。</li>
<li><code>void setValueAt(Object aValue, int rowIndex, int columnIndex)</code> ：设置列交点处单元格中的值<code>columnIndex</code>和那排<code>rowIndex</code>到对象<code>aValue</code> 。</li>
</ul>
<h3>实现getColumnCount和getRowCount</h3>
<p>方法<code>getColumnCount</code>和<code>getRowCount</code>返回成员变量的值<code>numcols</code>和<code>numrows</code> ， 分别：</p>
<div class="codeblock"><pre>
public int getColumnCount() {
    return numcols;
}

public int getRowCount() {
    return numrows;
}
</pre></div>
<h3>实现getColumnClass</h3>
<p>的<code>getColumnClass</code>方法返回指定列的数据类型。为简单起见，此方法返回<code>String</code>类，从而将表中的所有数据转换为<code>String</code>对象。的<code>JTable</code>类使用此方法确定如何在GUI应用程序中呈现数据。</p>
<div class="codeblock"><pre>
public Class getColumnClass(int column) {
    return String.class;
}
</pre></div>
<h3>实现getColumnName</h3>
<p>的<code>getColumnName</code>方法返回指定列的名称。的<code>JTable</code>类使用此方法标记其每个列。</p>
<div class="codeblock"><pre>
public String getColumnName(int column) {
    try {
        return this.metadata.getColumnLabel(column + 1);
    } catch (SQLException e) {
        return e.toString();
    }
}

</pre></div>
<h3>实现getColumnAt</h3>
<p>的<code>getColumnAt</code>方法检索行集中指定行和列的值<code>coffeesRowSet</code> 。的<code>JTable</code>类使用此方法填充其表。请注意，SQL开始将其行和列编号为1，但是<code>TableModel</code>接口从0开始；这就是为什么<code>rowIndex</code>和<code>columnIndex</code>值增加1。</p>
<div class="codeblock"><pre>
public Object getValueAt(int rowIndex, int columnIndex) {

    try {
        this.coffeesRowSet.absolute(rowIndex + 1);
        Object o = this.coffeesRowSet.getObject(columnIndex + 1);
        if (o == null)
            return null;
        else
            return o.toString();
    } catch (SQLException e) {
        return e.toString();
    }
}
</pre></div>
<h3>实现isCellEditable</h3>
<p>因为此示例不允许用户直接编辑表的内容（行由另一个窗口控件添加），所以此方法返回<code>false</code>不管的值<code>rowIndex</code>和<code>columnIndex</code> ：</p>
<div class="codeblock"><pre>
public boolean isCellEditable(int rowIndex, int columnIndex) {
    return false;
}
</pre></div>
<!-- ************************************** -->
<h2><a name="implemeting_rowsetlistener" id="implemeting_rowsetlistener">实现javax.sql。RowSetListener</a></h2>
<p>班级<code>CoffeesFrame</code>从接口仅实现一种方法<code>RowSetListener</code> ， <code>rowChanged</code> 。当用户向表中添加一行时，将调用此方法。</p>
<div class="codeblock"><pre>
public void rowChanged(RowSetEvent event) {

    CachedRowSet currentRowSet =
        this.myCoffeesTableModel.coffeesRowSet;

    try {
        currentRowSet.moveToCurrentRow();
        myCoffeesTableModel = new CoffeesTableModel(
            myCoffeesTableModel.getCoffeesRowSet());
        table.setModel(myCoffeesTableModel);

    } catch (SQLException ex) {

        JDBCTutorialUtilities.printSQLException(ex);

        // Display the error in a dialog box.

        JOptionPane.showMessageDialog(
            CoffeesFrame.this,
            new String[] {
                // Display a 2-line message
                ex.getClass().getName() + ": ",
                ex.getMessage()
            }
        );
    }
}
</pre></div>
<p>此方法更新GUI应用程序中的表。</p>
<!-- ******************************** -->
<h2><a name="laying_out_swing" id="laying_out_swing">布置回转组件</a></h2>
<p>类的构造函数<code>CoffeesFrame</code>初始化并布置Swing组件。以下语句检索<code>COFFEES</code>表，将内容存储在<code>CachedRowSet</code>宾语<code>myCachedRowSet</code> ，并初始化<code>JTable</code>摇摆组件：</p>
<div class="codeblock"><pre>
CachedRowSet myCachedRowSet = getContentsOfCoffeesTable();
myCoffeesTableModel = new CoffeesTableModel(myCachedRowSet);
myCoffeesTableModel.addEventHandlersToRowSet(this);

// Displays the table   
table = new JTable(); 
table.setModel(myCoffeesTableModel);
</pre></div>
<p>如前所述，代替<code>ResultSet</code>代表内容的对象<code>COFFEES</code>表，此示例使用<code>RowSet</code>对象，特别是<code>CachedRowSet</code>宾语。</p>
<p>方法<code>CoffeesFrame.getContentsOfCoffeesTable</code>检索表的内容<code>COFFEES</code> 。</p>
<p>方法<code>CoffeesTableModel.addEventHandlersToRowSet</code>添加在中定义的事件处理程序<code>CoffeesFrame</code>类，这是方法<code>rowChanged</code> ，到行集成员变量<code>CoffeesTableModel.coffeesRowSet</code> 。这样可以上课<code>CoffeesFrame</code>通知行集<code>coffeesRowSet</code>事件，特别是当用户单击“ <strong>向表添加行”</strong> ，“ <strong>更新数据库</strong> ”或“ <strong>放弃更改</strong> ”按钮时。当行设置<code>coffeesRowSet</code>收到这些更改之一的通知后，该方法<code>CoffeesFrame.rowChanged</code>叫做。</p>
<p>该声明<code>table.setModel(myCoffeesTableModel)</code>指定它使用<code>CoffeesTableModel</code>宾语<code>myCoffeesTableModel</code>填充<code>JTable</code>摆动组件<code>table</code> 。</p>
<p>以下语句指定<code>CoffeesFrame</code>类使用布局<code>GridBagLayout</code>布置其Swing组件：</p>
<div class="codeblock"><pre>
Container contentPane = getContentPane();
contentPane.setComponentOrientation(
    ComponentOrientation.LEFT_TO_RIGHT);
contentPane.setLayout(new GridBagLayout());
GridBagConstraints c = new GridBagConstraints();
</pre></div>

<p>有关使用布局的更多信息，请参见<a class="TutorialLink" href="../../uiswing/layout/gridbag.html" target="_top">如何在使用</a> <a class="TutorialLink" href="../../uiswing/index.html" target="_top">JFC / Swing创建GUI中</a> <a class="TutorialLink" href="../../uiswing/layout/gridbag.html" target="_top">使用GridBagLayout</a> 。 <code>GridBagLayout</code> 。</p>
 
<p>请参阅源代码<code><a href="gettingstarted.html">CoffeesFrame.java</a></code>了解如何将此示例的Swing组件添加到布局中<code>GridBagLayout</code> 。</p>
<!-- ********************************* -->
<h2><a name="adding_listeners" id="adding_listeners">为按钮添加侦听器</a></h2>
<p>以下语句将一个侦听器<strong>添加</strong>到“ <strong>将行添加到表</strong> ”按钮<strong>中</strong> ：</p>
<div class="codeblock"><pre>
button_ADD_ROW.addActionListener(
    new ActionListener() {
      
    public void actionPerformed(ActionEvent e) {

        JOptionPane.showMessageDialog(
            CoffeesFrame.this, new String[] {
                "Adding the following row:",
                "Coffee name: [" +
                textField_COF_NAME.getText() +
                "]",
                "Supplier ID: [" +
                textField_SUP_ID.getText() + "]",
                "Price: [" +
                textField_PRICE.getText() + "]",
                "Sales: [" +
                textField_SALES.getText() + "]",
                "Total: [" +
                textField_TOTAL.getText() + "]"
            }
        );

        try {
            myCoffeesTableModel.insertRow(
                textField_COF_NAME.getText(),
                Integer.parseInt(textField_SUP_ID.getText().trim()),
                Float.parseFloat(textField_PRICE.getText().trim()),
                Integer.parseInt(textField_SALES.getText().trim()),
                Integer.parseInt(textField_TOTAL.getText().trim())
            );
        } catch (SQLException sqle) {
            displaySQLExceptionDialog(sqle);
        }
    }
});
</pre></div>
<p>当用户单击此按钮时，它将执行以下操作：</p>
<ul>
<li>创建一个消息对话框，显示要添加到表中的行。</li>
<li>调用方法<code>CoffeesTableModel.insertRow</code> ，将行添加到成员变量<code>CoffeesTableModel.coffeesRowSet</code> 。</li>
</ul>
<p>如果<code>SQLException</code>抛出，然后该方法<code>CoffeesFrame.displaySQLExceptionDialog</code>创建一个消息对话框，显示消息内容<code>SQLException</code> 。</p>
<p>以下语句将一个侦听器添加到“ <strong>更新数据库</strong> ”按钮：</p>
<div class="codeblock"><pre>
button_UPDATE_DATABASE.addActionListener(
    new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            try {
                myCoffeesTableModel.coffeesRowSet.acceptChanges();
                msgline.setText("Updated database");
            } catch (SQLException sqle) {
                displaySQLExceptionDialog(sqle);
                // Now revert back changes
                try {
                    createNewTableModel();
                    msgline.setText("Discarded changes");
                } catch (SQLException sqle2) {
                    displaySQLExceptionDialog(sqle2);
                }
            }
        }
    }
);
</pre></div>
<p>当用户单击此按钮时，表格<code>COFFEES</code>用行集的内容更新<code>myCoffeesTableModel.coffeesRowSet</code> 。</p>
<p>以下语句向“ <strong>放弃更改</strong> ”按钮添加了一个侦听器：</p>
<div class="codeblock"><pre>
button_DISCARD_CHANGES.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent e) {
        try {
            createNewTableModel();
        } catch (SQLException sqle) {
            displaySQLExceptionDialog(sqle);
        }
    }
});
</pre></div>
<p>当用户单击此按钮时，该方法<code>CoffeesFrame.createNewTableModel</code>被称为，重新填充<code>JTable</code>组件的内容<code>COFFEES</code>表。</p>


        </div>
        <div class="NavBit">
            <a href="storedprocedures.html" target="_top">«上一个</a> • <a href="../TOC.html" target="_top">追踪</a> • <a href="../end.html" target="_top">下一个»</a>
        </div>
    </div>
    
<hr class="clearfloat">

<div id="Footer">

<p class="footertext">
<a href="http://www.oracle.com/corporate/index.html">关于Oracle</a> | <a href="http://www.oracle.com/us/corporate/contact/index.html">联系我们</a> | <a href="http://www.oracle.com/us/legal/index.html">法律声明</a> | <a href="http://www.oracle.com/us/legal/terms/index.html">使用条款</a> | <a href="http://www.oracle.com/us/legal/privacy/index.html">您的隐私权</a></p>

<p class="footertext"><a href="http://www.oracle.com/pls/topic/lookup?ctx=cpyr&id=en-US">版权所有©1995、2017 Oracle和/或其分支机构。版权所有。</a></p>
       
</div>    
    <div class="PrintHeaders">
        <b>上一页：</b>使用存储过程<br><b>下一页：</b>小路尽头</div>
<!-- Start SiteCatalyst code -->
<script type="application/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_docs.js"></script>
<!-- End SiteCatalyst code --> 

 
</body></html>