<html lang="en-US"  xmlns="http://www.w3.org/1999/xhtml"><head></head><body  onload="load()">﻿
        <title>使用JdbcRowSet对象（Java™教程> JDBC（TM）数据库访问> JDBC基础）</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
     <meta name="description" content="This JDBC Java tutorial describes how to use JDBC API to create, insert into, update, and query tables. You will also learn how to use simple and prepared statements, stored procedures and perform transactions">
     <meta name="keywords" content="java programming, learn java, java sample code, jdbc, prepared statement, result set">
        
<style type="text/css">
    body {
        margin-left:10px;
        margin-right:10px;
        line-height: 1.5;
        FONT-FAMILY: Arial, Helvetica, sans-serif; 
        font-size: 0.8em;
    }
    
    a:link{text-decoration:none; color:#09569d;}
    a:visited{text-decoration:none; color: #3a87cf;}
    a:hover{text-decoration:underline; }
        
    code{
        font-family:Monaco,Courier,"Courier New";
    }
    
    .header-container {
        background-color: #fff;
        border-bottom: 1px solid #C1CFDA;
        -webkit-box-shadow: 0 2px 2px rgba(117, 163, 231, 0.1);
        box-shadow: 0 2px 2px rgba(117, 163, 231, 0.1);
    }
    
    .bookwrapper {
        width: auto;
        margin: auto;
    }
    
    .clearfix {
    }
    
    .clearfloat {
        clear: both;
        overflow: auto;
        height: 0px;
        font-size: 1px;
        line-height: 0px;
    }
    
    #brandProdName {
        width: auto;
        height: auto;
    }
    
    #logocover {
        display: block;
        background: transparent url(../../images/oracle-java-logo.png) 0px 0px no-repeat;
        height: 50px;
        width: 229px;
        float: left;
    }
    
    #productName {
        font-size: 16px;
        position: relative;
        top: 19px;
        padding-left: 3px;
        color: #457798;
        white-space: nowrap;
        width: 340px;
    }


    .FigureCaption   { 
        font-family: sans-serif; 
        text-align: center;
    }
    
    #TopBar_bl {        
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        margin-left: -110px;
        margin-right: -100px;       
		align: left;
        height: 60px;
    }
    #TopBar_tr {
        width: 100%;
        height: 60px;
    }
    
    #TopBar {
        min-width:700px;
        padding:25px 100px 10px;
        margin-bottom:25px;
        clear:both;
        
        border-bottom:1px solid #d2dde5;
        border-radius: 3px;
    
        background:#efefef; /* Old browsers */
        /* IE9 SVG, needs conditional override of 'filter' to 'none' */
        background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2ZmZmZmZiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlMmVmZjkiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
        background: -moz-linear-gradient(top,  #ffffff 0%, #e2eff9 100%); /* FF3.6+ */
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#e2eff9)); /* Chrome,Safari4+ */
        background: -webkit-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* Chrome10+,Safari5.1+ */
        background: -o-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* Opera 11.10+ */
        background: -ms-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* IE10+ */
        background: linear-gradient(to bottom,  #ffffff 0%,#e2eff9 100%); /* W3C */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#e2eff9',GradientType=0 ); /* IE6-8 */
        
    }
    
    #TopBar_left {
        line-height: 14px;
        position: absolute;
        padding-top: 30px;
        padding-right: 30px;
        padding-left: 30px;
        text-align: left;
        font: 13px/20px Arial, Helvetica, sans-serif;
        font-weight: bold;
        font-size: 20px;
        color: #333;
    }
    
    #TopBar_right {
        line-height: 12px;
        float: right;
        padding-top: 10px;
        padding-right: 30px;
        text-align: left;
    }
    

    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    
     
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 10px;
        margin: 3px;
        padding: 0;
    }
 
    #BreadCrumbs {
        padding: 15px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    
    #BreadCrumbs a {
        color:#09569d;
    }
    
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #F90000;
    }
    
    #PageContent{
        margin: 0 5px 0 20px;
    }
    
    .LeftBar_shown {
        width: 13em;
        float: left;
    }
    
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    
    .LeftBar_hidden {
        display: none;
    }
    
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;       
    }
    
    .footertext {
        font-size: 10px;
        font-family: sans-serif; 
        margin-top: 1px;
    }

    .NavBit  {
        padding: 15px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    
    @media print {
        .NavBit {
            display: none;
        }
    }
    
    #TagNotes {
        text-align: right;        
    }
    
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    
    #Contents a, .NavBit a, #TagNotes a {
        color:#09569d;
    }
    
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em;
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #333;
		
		
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
	
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h1, h2, h3, h4, h5 {
        color: #333;
        
    }

    h1 {
        font-weight: bold;
        font-size: 20px;
    }

    h2 {
        font-weight: bold;
        font-size: 17px;
    }

    h3 {
        font-weight: bold;
        font-size: 14px;
    }

    h4 {
        font-size: 15px;
    }

    h5 {
        font-size: 12px;
    }


    #ToggleLeft {
        display: none;
    }
    
    .note {
        margin: 0 30px 0px 30px;
    }
    
    .codeblock {
        margin: 0 30px 0px 30px;
		font-size:12px;
		font-family:Monaco,Courier,"Courier New";
    }
    
    .tocli {
        list-style-type:none;
    }

    .betadraft {
        color: red;
    }

</style>
<script type="text/javascript">
/* <![CDATA[ */
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }

    function showCode(displayCodePage, codePath) {
        var codePathEls = codePath.split("/");
        var currDocPathEls = location.href.split("/");
        //alert ("codePathEls = " + codePathEls + "\n" + "currDocPathEls = " + currDocPathEls);
        currDocPathEls.pop(); // remove file name at the end
        while (codePathEls.length > 0) {
            if (codePathEls[0] == "..") {
                codePathEls.shift();
                currDocPathEls.pop();
            } else {
                break;
            }
        }
        var fullCodePath = currDocPathEls.join("/") + "/" + codePathEls.join("/");
        //alert ("fullCodePath = " + fullCodePath );
        if (codePath.indexOf(".java") != -1 || codePath.indexOf(".jnlp") != -1) {
            window.location.href = displayCodePage + "?code=" + encodeURI(fullCodePath);
        } else {
            window.location.href = fullCodePath;
        }
    }
/* ]]> */    
</script>


    <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script>

    <noscript>要使此页面正常运行，需要启用JavaScript的浏览器。
    </noscript>
        <!-- header -->
    <div class="header-container">
        <div class="bookwrapper  clearfix">       
            <div id="brandProdName">
                <div id="logocover"></div>
                <div id="productName">文献资料</div>
            </div> 
            <br class="clearfloat">
        </div>
    </div>
    
    <div id="TopBar">
        <div id="TopBar_tr">
            <div id="TopBar_tl">
                <div id="TopBar_br"> <div id="TopBar_bl"> 
                    <div id="TopBar_left">Java™教程</div>
                        <div id="TopBar_right"> 
                            <!--
                            <a href="URL" target="_blank">External Link</a><br/>
                            --> <a href="javascript:void(0);" id="ToggleLeft">隐藏目录</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div id="LeftBar" class="LeftBar_shown">
        <div id="Contents">
            <div class="linkLESSON"><a href="index.html">JDBC基础</a></div>
<div class="linkAHEAD"><a href="gettingstarted.html">入门</a></div>
<div class="linkAHEAD"><a href="processingsqlstatements.html">使用JDBC处理SQL语句</a></div>
<div class="linkAHEAD"><a href="connecting.html">建立连接</a></div>
<div class="linkAHEAD"><a href="sqldatasources.html">连接数据源对象</a></div>
<div class="linkAHEAD"><a href="sqlexception.html">处理SQLException</a></div>
<div class="linkAHEAD"><a href="tables.html">设置表格</a></div>
<div class="linkAHEAD"><a href="retrieving.html">从结果集中检索和修改值</a></div>
<div class="linkAHEAD"><a href="prepared.html">使用准备好的语句</a></div>
<div class="linkAHEAD"><a href="transactions.html">使用交易</a></div>
<div class="linkAHEAD"><a href="rowset.html">使用行集对象</a></div>
<div class="nolinkAHEAD">使用JdbcRowSet对象</div>
<div class="linkAHEAD"><a href="cachedrowset.html">使用CachedRowSetObjects</a></div>
<div class="linkAHEAD"><a href="joinrowset.html">使用JoinRowSet对象</a></div>
<div class="linkAHEAD"><a href="filteredrowset.html">使用FilteredRowSet对象</a></div>
<div class="linkAHEAD"><a href="webrowset.html">使用WebRowSet对象</a></div>
<div class="linkAHEAD"><a href="sqltypes.html">使用高级数据类型</a></div>
<div class="linkAHEAD"><a href="blob.html">使用大对象</a></div>
<div class="linkAHEAD"><a href="sqlxml.html">使用SQLXML对象</a></div>
<div class="linkAHEAD"><a href="array.html">使用数组对象</a></div>
<div class="linkAHEAD"><a href="distinct.html">使用DISTINCT数据类型</a></div>
<div class="linkAHEAD"><a href="sqlstructured.html">使用结构化对象</a></div>
<div class="linkAHEAD"><a href="sqlcustommapping.html">使用自定义类型映射</a></div>
<div class="linkAHEAD"><a href="sqldatalink.html">使用数据链接对象</a></div>
<div class="linkAHEAD"><a href="sqlrowid.html">使用RowId对象</a></div>
<div class="linkAHEAD"><a href="storedprocedures.html">使用存储过程</a></div>
<div class="linkAHEAD"><a href="jdbcswing.html">结合使用JDBC和GUI API</a></div>
</div>
    </div>
    <div id="MainFlow" class="MainFlow_indented">
    <div class="PrintHeaders">
        <b>Trail：</b> JDBC（TM）数据库访问<br><b>课程：</b> JDBC基础</div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">主页</a> > <a href="../index.html" target="_top">JDBC（TM）数据库访问</a> > <a href="index.html" target="_top">JDBC基础</a>
            </div>
            <div class="NavBit">
                <a href="rowset.html" target="_top">«上一个</a> • <a href="../TOC.html" target="_top">追踪</a> • <a href="cachedrowset.html" target="_top">下一个»</a>
            </div>
            <div class="Banner"><p style="background-color:rgb(247,248,249);border-width:1px;padding:10px;font-style:italic;border-style:solid;border-color:rgb(64,74,91)">Java教程是为JDK 8编写的。此页面中描述的示例和实践没有利用更高版本中引入的改进。</p></div>
            <div id="PageTitle"><h1>使用JdbcRowSet对象</h1></div>
            <div id="PageContent">

<p>一种<code>JdbcRowSet</code>对象是增强的<code>ResultSet</code>宾语。它维护与其数据源的连接，就像<code>ResultSet</code>对象呢。最大的区别在于，它具有一组属性和一个侦听器通知机制，这些机制使它成为JavaBeans组件。</p>
<p>的主要用途之一<code>JdbcRowSet</code>目的是使<code>ResultSet</code>如果对象不具备这些功能，则它可以滚动和更新。</p>
<p>本节涵盖以下主题：</p>
<ul>
<li><a href="#creating-jdbcrowset-object">创建JdbcRowSet对象</a></li>
<li><a href="#default-jdbcrowset-objects">默认的JdbcRowSet对象</a></li>
<li><a href="#setting-properties">设定属性</a></li>
<li><a href="#using-jdbcrowset-object">使用JdbcRowSet对象</a></li>
<li><a href="#code-sample">代码样例</a></li>
</ul>
<!-- ********************************************************** -->
<h2><a name="creating-jdbcrowset-object" id="creating-jdbcrowset-object">创建JdbcRowSet对象</a></h2>
<p>您可以创建一个<code>JdbcRowSet</code>对象以各种方式：</p>
<ul>
<li>通过使用引用实现的构造函数， <code>ResultSet</code>宾语</li>
<li>通过使用引用实现的构造函数， <code>Connection</code>宾语</li>
<li>通过使用参考实现的默认构造函数</li>
<li>通过使用一个实例<code>RowSetFactory</code> ，它是从类创建的<code>RowSetProvider</code></li>
</ul>
<p><strong>注意</strong> ：或者，您可以使用<code>JdbcRowSet</code> JDBC驱动程序的实现。但是， <code>RowSet</code>接口将与参考实现不同。这些实现将具有不同的名称和构造函数。例如，Oracle JDBC驱动程序的实现<code>JdbcRowSet</code>接口被命名<code>oracle.jdbc.rowset.OracleJDBCRowSet</code> 。</p>
<!-- ********************************************************** -->
<h3><a name="passing-resultset-object" id="passing-resultset-object">传递ResultSet对象</a></h3>
<p>创建一个最简单的方法<code>JdbcRowSet</code>目的是产生一个<code>ResultSet</code>对象并将其传递给<code>JdbcRowSetImpl</code>构造函数。这样做不仅会创建一个<code>JdbcRowSet</code>对象，但还会使用<code>ResultSet</code>宾语。</p>
<p><strong>注意</strong> ： <code>ResultSet</code>传递给<code>JdbcRowSetImpl</code>构造函数必须是可滚动的。</p>
<p>例如，以下代码片段使用<code>Connection</code>宾语<code>con</code>创建一个<code>Statement</code>宾语， <code>stmt</code> ，然后执行查询。查询产生<code>ResultSet</code>宾语<code>rs</code> ，将其传递给构造函数以创建一个新的<code>JdbcRowSet</code>用数据初始化的对象<code>rs</code> ：</p>
<div class="codeblock"><pre>
stmt = con.createStatement(
           ResultSet.TYPE_SCROLL_SENSITIVE,
           ResultSet.CONCUR_UPDATABLE);
rs = stmt.executeQuery("select * from COFFEES");
jdbcRs = new JdbcRowSetImpl(rs);
</pre></div>
<p>一种<code>JdbcRowSet</code>用创建的对象<code>ResultSet</code>对象用作包装<code>ResultSet</code>宾语。因为<code>RowSet</code>宾语<code>rs</code>可滚动和可更新， <code>jdbcRs</code>也是可滚动和可更新的。如果您已运行该方法<code>createStatement</code>没有任何争论， <code>rs</code>将无法滚动或更新，也不会<code>jdbcRs</code> 。</p>
<!-- ********************************************************** -->
<h3><a name="passing-connection-object" id="passing-connection-object">传递连接对象</a></h3>
<p>以下代码摘录中的第一条语句摘自<a href="gettingstarted.html"><code>JdbcRowSetSample</code></a>创建一个<code>JdbcRowSet</code>使用以下命令连接到数据库的对象<code>Connection</code>宾语<code>con</code> ：</p>
<div class="codeblock"><pre>
<strong>jdbcRs = new JdbcRowSetImpl(con);</strong>
jdbcRs.setCommand("select * from COFFEES");
jdbcRs.execute();
</pre></div>
<p>物体<code>jdbcRs</code>在使用方法指定SQL语句之前，不包含任何数据<code>setCommand</code> ，然后运行方法<code>execute</code> 。</p>
<p>物体<code>jdbcRs</code>可滚动和可更新；默认， <code>JdbcRowSet</code>和所有其他<code>RowSet</code>除非另有说明，否则对象是可滚动和可更新的。有关更多信息，请参见<a href="#default-jdbcrowset-objects">默认JdbcRowSet对象</a> 。 <code>JdbcRowSet</code>您可以指定的属性。</p>
<!-- ********************************************************** -->
<h3>使用默认构造函数</h3>
<p>以下代码摘录中的第一条语句创建一个空<code>JdbcRowSet</code>宾语。</p>
<div class="codeblock"><pre>
public void createJdbcRowSet(String username, String password) {

    jdbcRs = new JdbcRowSetImpl();
    jdbcRs.setCommand("select * from COFFEES");
    jdbcRs.setUrl("jdbc:myDriver:myAttribute");
    jdbcRs.setUsername(username);
    jdbcRs.setPassword(password);
    jdbcRs.execute();
    // ...
}
</pre></div>
<p>物体<code>jdbcRs</code>在使用方法指定SQL语句之前，不包含任何数据<code>setCommand</code> ，请指定<code>JdbcResultSet</code>对象连接数据库，然后运行该方法<code>execute</code> 。</p>
<p>所有参考实现构造函数均为“ <a href="#default-jdbcrowset-objects">默认JdbcRowSet对象</a> ”部分中列出的属性分配默认值。</p>
<!-- ********************************************************** -->
<h3><a name="rowsetfactory" id="rowsetfactory">使用RowSetFactory接口</a></h3>
<p>通过Java SE 7和更高版本的RowSet 1.1，您可以使用以下实例<code>RowSetFactory</code>创建一个<code>JdbcRowSet</code>宾语。例如，以下代码摘录使用了<code>RowSetFactory</code>界面来创建<code>JdbcRowSet</code>宾语， <code>jdbcRs</code> ：</p>
<div class="codeblock"><pre>
public void createJdbcRowSetWithRowSetFactory(
    String username, String password)
    throws SQLException {

    RowSetFactory myRowSetFactory = null;
    JdbcRowSet jdbcRs = null;
    ResultSet rs = null;
    Statement stmt = null;

    try {
        myRowSetFactory = RowSetProvider.newFactory();
        jdbcRs = myRowSetFactory.createJdbcRowSet();

        jdbcRs.setUrl("jdbc:myDriver:myAttribute");
        jdbcRs.setUsername(username);
        jdbcRs.setPassword(password);

        jdbcRs.setCommand("select * from COFFEES");
        jdbcRs.execute();

        // ...
    }
}
</pre></div>
<p>以下语句创建<code>RowSetProvider</code>宾语<code>myRowSetFactory</code>使用默认<code>RowSetFactory</code>实施， <code>com.sun.rowset.RowSetFactoryImpl</code> ：</p>
<div class="codeblock"><pre>
myRowSetFactory = RowSetProvider.newFactory();
</pre></div>
<p>或者，如果您的JDBC驱动程序有自己的驱动程序， <code>RowSetFactory</code>实现中，您可以将其指定为<code>newFactory</code>方法。</p>
<p>以下语句创建<code>JdbcRowSet</code>宾语<code>jdbcRs</code>并配置其数据库连接属性：</p>
<div class="codeblock"><pre>
jdbcRs = myRowSetFactory.createJdbcRowSet();
jdbcRs.setUrl("jdbc:myDriver:myAttribute");
jdbcRs.setUsername(username);
jdbcRs.setPassword(password);
</pre></div>
<p>的<code>RowSetFactory</code>界面包含创建不同类型的<code>RowSet</code> RowSet 1.1和更高版本中可用的实现：</p>
<ul>
<li><code>createCachedRowSet</code></li>
<li><code>createFilteredRowSet</code></li>
<li><code>createJdbcRowSet</code></li>
<li><code>createJoinRowSet</code></li>
<li><code>createWebRowSet</code></li>
</ul>
<!-- ********************************************************** -->
<h2><a name="default-jdbcrowset-objects" id="default-jdbcrowset-objects">默认的JdbcRowSet对象</a></h2>
<p>当您创建一个<code>JdbcRowSet</code>具有默认构造函数的对象new <code>JdbcRowSet</code>对象将具有以下属性：</p>
<ul>
<li><code>type</code> ： <code>ResultSet.TYPE_SCROLL_INSENSITIVE</code> （具有可滚动的光标）</li>
<li><code>concurrency</code> ： <code>ResultSet.CONCUR_UPDATABLE</code> （可以更新）</li>
<li><code>escapeProcessing</code> ： <code>true</code> （驱动程序将进行转义处理；启用转义处理后，驱动程序将扫描任何转义语法并将其转换为特定数据库可以理解的代码）</li>
<li><code>maxRows</code> ： <code>0</code> （行数没有限制）</li>
<li><code>maxFieldSize</code> ： <code>0</code> （列值的字节数没有限制；仅适用于存储<code>BINARY</code> ， <code>VARBINARY</code> ， <code>LONGVARBINARY</code> ， <code>CHAR</code> ， <code>VARCHAR</code>和<code>LONGVARCHAR</code>值）</li>
<li><code>queryTimeout</code> ： <code>0</code> （对于执行查询没有时间限制）</li>
<li><code>showDeleted</code> ： <code>false</code> （删除的行不可见）</li>
<li><code>transactionIsolation</code> ： <code>Connection.TRANSACTION_READ_COMMITTED</code> （仅读取已提交的数据）</li>
<li><code>typeMap</code> ： <code>null</code> （与<code>Connection</code>此对象使用的对象<code>RowSet</code>对象是<code>null</code> ）</li>
</ul>
<p>您必须从此列表中记住的主要事情是<code>JdbcRowSet</code>和所有其他<code>RowSet</code>除非您为这些属性设置不同的值，否则对象是可滚动和可更新的。</p>
<!-- ********************************************************** -->
<h2><a name="setting-properties" id="setting-properties">设定属性</a></h2>
<p>“ <a href="#default-jdbcrowset-objects">默认JdbcRowSet对象</a> ”部分列出了新的默认设置。 <code>JdbcRowSet</code>对象已创建。如果使用默认构造函数，则必须设置一些其他属性，然后才能填充新的<code>JdbcRowSet</code>带有数据的对象。</p>
<p>为了获取其数据， <code>JdbcRowSet</code>对象首先需要连接到数据库。以下四个属性保存用于获得与数据库的连接的信息。</p>
<ul>
<li><code>username</code> ：用户为获得访问权限而提供给数据库的名称</li>
<li><code>password</code> ：用户的数据库密码</li>
<li><code>url</code> ：用户要连接到的数据库的JDBC URL</li>
<li><code>datasourceName</code> ：用于检索<code>DataSource</code>已向JNDI命名服务注册的对象</li>
</ul>
<p>您设置的这些属性中的哪一个取决于您将如何建立连接。首选方式是使用<code>DataSource</code>对象，但您注册一个对象可能不切实际<code>DataSource</code>具有JNDI命名服务的对象，通常由系统管理员来完成。因此，所有代码示例均使用<code>DriverManager</code>获得连接的机制，您可以使用<code>url</code>财产，而不是<code>datasourceName</code>属性。</p>
<p>您必须设置的另一个属性是<code>command</code>属性。此属性是确定哪些数据的查询<code>JdbcRowSet</code>对象将保留。例如，以下代码行设置了<code>command</code>属性与产生一个<code>ResultSet</code>包含表中所有数据的对象<code>COFFEES</code> ：</p>
<div class="codeblock"><pre>
jdbcRs.setCommand("select * from COFFEES");
</pre></div>
<p>设置完后<code>command</code>属性和建立连接所需的属性，您就可以填充<code>jdbcRs</code>通过调用对象来获取数据<code>execute</code>方法。</p>
<div class="codeblock"><pre>
jdbcRs.execute();
</pre></div>
<p>的<code>execute</code>方法在后台为您做很多事情：</p>
<ul>
<li>它使用您分配给数据库的值建立与数据库的连接。 <code>url</code> ， <code>username</code>和<code>password</code>属性。</li>
<li>它执行您在<code>command</code>属性。</li>
<li>它从结果读取数据<code>ResultSet</code>对象进入<code>jdbcRs</code>宾语。</li>
</ul>
<!-- ********************************************************** -->
<h2><a name="using-jdbcrowset-object" id="using-jdbcrowset-object">使用JdbcRowSet对象</a></h2>
<p>您更新，插入和删除行中<code>JdbcRowSet</code>对象与更新，插入和删除可更新行的方式相同<code>ResultSet</code>宾语。同样，您导航<code>JdbcRowSet</code>对象与导航可滚动对象的方式相同<code>ResultSet</code>宾语。</p>
<p>咖啡馆的Coffee Break连锁店收购了另一家咖啡馆，现在拥有一个不支持滚动或更新结果集的旧数据库。换句话说，任何<code>ResultSet</code>此旧数据库产生的对象没有可滚动的游标，并且其中的数据也无法修改。但是，通过创建一个<code>JdbcRowSet</code>对象中填充了来自<code>ResultSet</code>对象，实际上可以使<code>ResultSet</code>对象可滚动和可更新。</p>
<p>如前所述， <code>JdbcRowSet</code>默认情况下，对象是可滚动和可更新的。因为其内容与<code>ResultSet</code>对象，在<code>JdbcRowSet</code>对象等同于在<code>ResultSet</code>对象本身。而且因为<code>JdbcRowSet</code>对象与数据库之间存在持续的连接，它对自己的数据所做的更改也会对数据库中的数据进行更改。</p>
<p>本节涵盖以下主题：</p>
<ul>
<li><a href="#navigating-jdbcrowset-object">导航JdbcRowSet对象</a></li>
<li><a href="#updating-column-value">更新列值</a></li>
<li><a href="#inserting-row">插入行</a></li>
<li><a href="#deleting-row">删除行</a></li>
</ul>
<!-- ********************************************************** -->
<h3><a name="navigating-jdbcrowset-object" id="navigating-jdbcrowset-object">导航JdbcRowSet对象</a></h3>
<p>一种<code>ResultSet</code>无法滚动的对象只能使用<code>next</code>方法将光标向前移动，并且只能将光标从第一行向前移动到最后一行。默认值<code>JdbcRowSet</code>但是，对象可以使用在<code>ResultSet</code>接口。</p>
<p>一种<code>JdbcRowSet</code>对象可以调用方法<code>next</code> ，它也可以调用其他任何一个<code>ResultSet</code>光标移动方法。例如，以下代码行将光标移动到<code>jdbcRs</code>对象，然后返回第三行：</p>
<div class="codeblock"><pre>
jdbcRs.absolute(4);
jdbcRs.previous();
</pre></div>
<p>方法<code>previous</code>与方法类似<code>next</code>因为它可以用于<code>while</code>循环以按顺序遍历所有行。区别在于您必须将光标移动到最后一行之后的位置，并且<code>previous</code>将光标移到开头。</p>
<!-- ********************************************************** -->
<h3><a name="updating-column-value" id="updating-column-value">更新列值</a></h3>
<p>您在<code>JdbcRowSet</code>对象与您更新数据的方式相同<code>ResultSet</code>宾语。</p>
<p>假设Coffee Break的所有者希望提高一磅Espresso咖啡的价格。如果所有者知道Espresso位于菜单的第三行<code>jdbcRs</code>对象，执行此操作的代码可能如下所示：</p>
<div class="codeblock"><pre>
jdbcRs.absolute(3);
jdbcRs.updateFloat("PRICE", 10.99f);
jdbcRs.updateRow();
</pre></div>
<p>该代码将光标移动到第三行并更改该列的值<code>PRICE</code>到10.99，然后使用新价格更新数据库。</p>
<p>调用方法<code>updateRow</code>更新数据库是因为<code>jdbcRs</code>保持了与数据库的连接。对于断开<code>RowSet</code>对象，情况就不同了。</p>
<!-- ********************************************************** -->
<h3><a name="inserting-row" id="inserting-row">插入行</a></h3>
<p>如果“茶歇”链的所有者想要在他提供的产品中添加一种或多种咖啡，则所有者需要在“咖啡中断”链中添加一行。 <code>COFFEES</code>每种新咖啡的表格，如以下代码段中所示<code><a href="gettingstarted.html">JdbcRowSetSample</a></code> 。注意，因为<code>jdbcRs</code>对象始终连接到数据库，将行插入到<code>JdbcRowSet</code>对象与将行插入<code>ResultSet</code>对象：将光标移至插入行，使用适当的updater方法为每一列设置一个值，然后调用该方法<code>insertRow</code> ：</p>
<div class="codeblock"><pre>
jdbcRs.moveToInsertRow();
jdbcRs.updateString("COF_NAME", "HouseBlend");
jdbcRs.updateInt("SUP_ID", 49);
jdbcRs.updateFloat("PRICE", 7.99f);
jdbcRs.updateInt("SALES", 0);
jdbcRs.updateInt("TOTAL", 0);
jdbcRs.insertRow();

jdbcRs.moveToInsertRow();
jdbcRs.updateString("COF_NAME", "HouseDecaf");
jdbcRs.updateInt("SUP_ID", 49);
jdbcRs.updateFloat("PRICE", 8.99f);
jdbcRs.updateInt("SALES", 0);
jdbcRs.updateInt("TOTAL", 0);
jdbcRs.insertRow();
</pre></div>
<p>调用方法时<code>insertRow</code> ，新行将插入到<code>jdbcRs</code>对象，并且还插入到数据库中。前面的代码片段经过两次此过程，因此将两个新行插入到<code>jdbcRs</code>对象和数据库。</p>
<!-- ********************************************************** -->
<h3><a name="deleting-row" id="deleting-row">删除行</a></h3>
<p>就像更新数据并插入新行一样，删除行对于<code>JdbcRowSet</code>至于一个对象<code>ResultSet</code>宾语。店主想停止销售法式烘焙脱咖啡因咖啡，这是<code>jdbcRs</code>宾语。在下面的代码行中，第一行将光标移到最后一行，第二行将光标从最后一行删除。 <code>jdbcRs</code>对象并从数据库中获取：</p>
<div class="codeblock"><pre>
jdbcRs.last();
jdbcRs.deleteRow();
</pre></div>
<!-- ********************************************************** -->
<h2><a name="code-sample" id="code-sample">代码样例</a></h2>
<p>这个样本<code><a href="gettingstarted.html">JdbcRowSetSample</a></code>执行以下操作：</p>
<ul>
<li>创建一个新的<code>JdbcRowSet</code>用初始化的对象<code>ResultSet</code>通过执行查询产生的对象，该查询检索<code>COFFEES</code>表</li>
<li>将光标移动到<code>COFFEES</code>表并更新<code>PRICE</code>该行中的列</li>
<li>插入两行，其中一列用于<code>HouseBlend</code>还有一个<code>HouseDecaf</code></li>
<li>将光标移动到最后一行并将其删除</li>
</ul>


        </div>
        <div class="NavBit">
            <a href="rowset.html" target="_top">«上一个</a> • <a href="../TOC.html" target="_top">追踪</a> • <a href="cachedrowset.html" target="_top">下一个»</a>
        </div>
    </div>
    
<hr class="clearfloat">

<div id="Footer">

<p class="footertext">
<a href="http://www.oracle.com/corporate/index.html">关于Oracle</a> | <a href="http://www.oracle.com/us/corporate/contact/index.html">联系我们</a> | <a href="http://www.oracle.com/us/legal/index.html">法律声明</a> | <a href="http://www.oracle.com/us/legal/terms/index.html">使用条款</a> | <a href="http://www.oracle.com/us/legal/privacy/index.html">您的隐私权</a></p>

<p class="footertext"><a href="http://www.oracle.com/pls/topic/lookup?ctx=cpyr&id=en-US">版权所有©1995、2017 Oracle和/或其分支机构。版权所有。</a></p>
       
</div>    
    <div class="PrintHeaders">
        <b>上一页：</b>使用行集对象<br><b>下一页：</b>使用CachedRowSetObjects</div>
<!-- Start SiteCatalyst code -->
<script type="application/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_docs.js"></script>
<!-- End SiteCatalyst code --> 

 
</body></html>