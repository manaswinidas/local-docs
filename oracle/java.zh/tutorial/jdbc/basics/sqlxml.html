<html lang="en-US"  xmlns="http://www.w3.org/1999/xhtml"><head></head><body  onload="load()">﻿
        <title>使用SQLXML对象（Java™教程> JDBC（TM）数据库访问> JDBC基础）</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
     <meta name="description" content="This JDBC Java tutorial describes how to use JDBC API to create, insert into, update, and query tables. You will also learn how to use simple and prepared statements, stored procedures and perform transactions">
     <meta name="keywords" content="java programming, learn java, java sample code, jdbc, prepared statement, result set">
        
<style type="text/css">
    body {
        margin-left:10px;
        margin-right:10px;
        line-height: 1.5;
        FONT-FAMILY: Arial, Helvetica, sans-serif; 
        font-size: 0.8em;
    }
    
    a:link{text-decoration:none; color:#09569d;}
    a:visited{text-decoration:none; color: #3a87cf;}
    a:hover{text-decoration:underline; }
        
    code{
        font-family:Monaco,Courier,"Courier New";
    }
    
    .header-container {
        background-color: #fff;
        border-bottom: 1px solid #C1CFDA;
        -webkit-box-shadow: 0 2px 2px rgba(117, 163, 231, 0.1);
        box-shadow: 0 2px 2px rgba(117, 163, 231, 0.1);
    }
    
    .bookwrapper {
        width: auto;
        margin: auto;
    }
    
    .clearfix {
    }
    
    .clearfloat {
        clear: both;
        overflow: auto;
        height: 0px;
        font-size: 1px;
        line-height: 0px;
    }
    
    #brandProdName {
        width: auto;
        height: auto;
    }
    
    #logocover {
        display: block;
        background: transparent url(../../images/oracle-java-logo.png) 0px 0px no-repeat;
        height: 50px;
        width: 229px;
        float: left;
    }
    
    #productName {
        font-size: 16px;
        position: relative;
        top: 19px;
        padding-left: 3px;
        color: #457798;
        white-space: nowrap;
        width: 340px;
    }


    .FigureCaption   { 
        font-family: sans-serif; 
        text-align: center;
    }
    
    #TopBar_bl {        
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        margin-left: -110px;
        margin-right: -100px;       
		align: left;
        height: 60px;
    }
    #TopBar_tr {
        width: 100%;
        height: 60px;
    }
    
    #TopBar {
        min-width:700px;
        padding:25px 100px 10px;
        margin-bottom:25px;
        clear:both;
        
        border-bottom:1px solid #d2dde5;
        border-radius: 3px;
    
        background:#efefef; /* Old browsers */
        /* IE9 SVG, needs conditional override of 'filter' to 'none' */
        background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2ZmZmZmZiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlMmVmZjkiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
        background: -moz-linear-gradient(top,  #ffffff 0%, #e2eff9 100%); /* FF3.6+ */
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#e2eff9)); /* Chrome,Safari4+ */
        background: -webkit-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* Chrome10+,Safari5.1+ */
        background: -o-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* Opera 11.10+ */
        background: -ms-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* IE10+ */
        background: linear-gradient(to bottom,  #ffffff 0%,#e2eff9 100%); /* W3C */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#e2eff9',GradientType=0 ); /* IE6-8 */
        
    }
    
    #TopBar_left {
        line-height: 14px;
        position: absolute;
        padding-top: 30px;
        padding-right: 30px;
        padding-left: 30px;
        text-align: left;
        font: 13px/20px Arial, Helvetica, sans-serif;
        font-weight: bold;
        font-size: 20px;
        color: #333;
    }
    
    #TopBar_right {
        line-height: 12px;
        float: right;
        padding-top: 10px;
        padding-right: 30px;
        text-align: left;
    }
    

    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    
     
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 10px;
        margin: 3px;
        padding: 0;
    }
 
    #BreadCrumbs {
        padding: 15px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    
    #BreadCrumbs a {
        color:#09569d;
    }
    
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #F90000;
    }
    
    #PageContent{
        margin: 0 5px 0 20px;
    }
    
    .LeftBar_shown {
        width: 13em;
        float: left;
    }
    
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    
    .LeftBar_hidden {
        display: none;
    }
    
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;       
    }
    
    .footertext {
        font-size: 10px;
        font-family: sans-serif; 
        margin-top: 1px;
    }

    .NavBit  {
        padding: 15px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    
    @media print {
        .NavBit {
            display: none;
        }
    }
    
    #TagNotes {
        text-align: right;        
    }
    
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    
    #Contents a, .NavBit a, #TagNotes a {
        color:#09569d;
    }
    
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em;
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #333;
		
		
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
	
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h1, h2, h3, h4, h5 {
        color: #333;
        
    }

    h1 {
        font-weight: bold;
        font-size: 20px;
    }

    h2 {
        font-weight: bold;
        font-size: 17px;
    }

    h3 {
        font-weight: bold;
        font-size: 14px;
    }

    h4 {
        font-size: 15px;
    }

    h5 {
        font-size: 12px;
    }


    #ToggleLeft {
        display: none;
    }
    
    .note {
        margin: 0 30px 0px 30px;
    }
    
    .codeblock {
        margin: 0 30px 0px 30px;
		font-size:12px;
		font-family:Monaco,Courier,"Courier New";
    }
    
    .tocli {
        list-style-type:none;
    }

    .betadraft {
        color: red;
    }

</style>
<script type="text/javascript">
/* <![CDATA[ */
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }

    function showCode(displayCodePage, codePath) {
        var codePathEls = codePath.split("/");
        var currDocPathEls = location.href.split("/");
        //alert ("codePathEls = " + codePathEls + "\n" + "currDocPathEls = " + currDocPathEls);
        currDocPathEls.pop(); // remove file name at the end
        while (codePathEls.length > 0) {
            if (codePathEls[0] == "..") {
                codePathEls.shift();
                currDocPathEls.pop();
            } else {
                break;
            }
        }
        var fullCodePath = currDocPathEls.join("/") + "/" + codePathEls.join("/");
        //alert ("fullCodePath = " + fullCodePath );
        if (codePath.indexOf(".java") != -1 || codePath.indexOf(".jnlp") != -1) {
            window.location.href = displayCodePage + "?code=" + encodeURI(fullCodePath);
        } else {
            window.location.href = fullCodePath;
        }
    }
/* ]]> */    
</script>


    <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script>

    <noscript>要使此页面正常运行，需要启用JavaScript的浏览器。
    </noscript>
        <!-- header -->
    <div class="header-container">
        <div class="bookwrapper  clearfix">       
            <div id="brandProdName">
                <div id="logocover"></div>
                <div id="productName">文献资料</div>
            </div> 
            <br class="clearfloat">
        </div>
    </div>
    
    <div id="TopBar">
        <div id="TopBar_tr">
            <div id="TopBar_tl">
                <div id="TopBar_br"> <div id="TopBar_bl"> 
                    <div id="TopBar_left">Java™教程</div>
                        <div id="TopBar_right"> 
                            <!--
                            <a href="URL" target="_blank">External Link</a><br/>
                            --> <a href="javascript:void(0);" id="ToggleLeft">隐藏目录</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div id="LeftBar" class="LeftBar_shown">
        <div id="Contents">
            <div class="linkLESSON"><a href="index.html">JDBC基础</a></div>
<div class="linkAHEAD"><a href="gettingstarted.html">入门</a></div>
<div class="linkAHEAD"><a href="processingsqlstatements.html">使用JDBC处理SQL语句</a></div>
<div class="linkAHEAD"><a href="connecting.html">建立连接</a></div>
<div class="linkAHEAD"><a href="sqldatasources.html">连接数据源对象</a></div>
<div class="linkAHEAD"><a href="sqlexception.html">处理SQLException</a></div>
<div class="linkAHEAD"><a href="tables.html">设置表格</a></div>
<div class="linkAHEAD"><a href="retrieving.html">从结果集中检索和修改值</a></div>
<div class="linkAHEAD"><a href="prepared.html">使用准备好的语句</a></div>
<div class="linkAHEAD"><a href="transactions.html">使用交易</a></div>
<div class="linkAHEAD"><a href="rowset.html">使用行集对象</a></div>
<div class="linkAHEAD"><a href="jdbcrowset.html">使用JdbcRowSet对象</a></div>
<div class="linkAHEAD"><a href="cachedrowset.html">使用CachedRowSetObjects</a></div>
<div class="linkAHEAD"><a href="joinrowset.html">使用JoinRowSet对象</a></div>
<div class="linkAHEAD"><a href="filteredrowset.html">使用FilteredRowSet对象</a></div>
<div class="linkAHEAD"><a href="webrowset.html">使用WebRowSet对象</a></div>
<div class="linkAHEAD"><a href="sqltypes.html">使用高级数据类型</a></div>
<div class="linkAHEAD"><a href="blob.html">使用大对象</a></div>
<div class="nolinkAHEAD">使用SQLXML对象</div>
<div class="linkAHEAD"><a href="array.html">使用数组对象</a></div>
<div class="linkAHEAD"><a href="distinct.html">使用DISTINCT数据类型</a></div>
<div class="linkAHEAD"><a href="sqlstructured.html">使用结构化对象</a></div>
<div class="linkAHEAD"><a href="sqlcustommapping.html">使用自定义类型映射</a></div>
<div class="linkAHEAD"><a href="sqldatalink.html">使用数据链接对象</a></div>
<div class="linkAHEAD"><a href="sqlrowid.html">使用RowId对象</a></div>
<div class="linkAHEAD"><a href="storedprocedures.html">使用存储过程</a></div>
<div class="linkAHEAD"><a href="jdbcswing.html">结合使用JDBC和GUI API</a></div>
</div>
    </div>
    <div id="MainFlow" class="MainFlow_indented">
    <div class="PrintHeaders">
        <b>Trail：</b> JDBC（TM）数据库访问<br><b>课程：</b> JDBC基础</div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">主页</a> > <a href="../index.html" target="_top">JDBC（TM）数据库访问</a> > <a href="index.html" target="_top">JDBC基础</a>
            </div>
            <div class="NavBit">
                <a href="blob.html" target="_top">«上一个</a> • <a href="../TOC.html" target="_top">追踪</a> • <a href="array.html" target="_top">下一个»</a>
            </div>
            <div class="Banner"><p style="background-color:rgb(247,248,249);border-width:1px;padding:10px;font-style:italic;border-style:solid;border-color:rgb(64,74,91)">Java教程是为JDK 8编写的。此页面中描述的示例和实践没有利用更高版本中引入的改进。</p></div>
            <div id="PageTitle"><h1>使用SQLXML对象</h1></div>
            <div id="PageContent">

<p>的<code>Connection</code>界面提供了对创建的支持<code>SQLXML</code>使用方法的对象<code>createSQLXML</code> 。创建的对象不包含任何数据。数据可以通过调用<code>setString</code> ， <code>setBinaryStream</code> ， <code>setCharacterStream</code>要么<code>setResult</code>上的方法<code>SQLXML</code>接口。</p>
<p>涵盖以下主题：</p>
<ul>
<li><a href="#creating_sqlxml">创建SQLXML对象</a></li>
<li><a href="#retrieving_sqlxml">在ResultSet中检索SQLXML值</a></li>
<li><a href="#accessing_sqlxml">访问SQLXML对象数据</a></li>
<li><a href="#storing_sqlxml">存储SQLXML对象</a></li>
<li><a href="#initializing_sqlxml">初始化SQLXML对象</a></li>
<li><a href="#releasing_sqlxml">释放SQLXML资源</a></li>
<li><a href="#sample_code">样例代码</a></li>
</ul>
<h2><a name="creating_sqlxml" id="creating_sqlxml">创建SQLXML对象</a></h2>
<p>在下面的摘录中，方法<code>Connection.createSQLXML</code>用于创建一个空的<code>SQLXML</code>宾语。的<code>SQLXML.setString</code>方法用于将数据写入<code>SQLXML</code>创建的对象。</p>
<div class="codeblock"><pre>
Connection con = DriverManager.getConnection(url, props);
SQLXML xmlVal = con.createSQLXML();
xmlVal.setString(val);
</pre></div>

<h2><a name="retrieving_sqlxml" id="retrieving_sqlxml">在ResultSet中检索SQLXML值</a></h2>

<p>的<code>SQLXML</code>数据类型的处理方式与更原始的内置类型类似。一种<code>SQLXML</code>值可以通过调用<code>getSQLXML</code>中的方法<code>ResultSet</code>要么<code>CallableStatement</code>接口。</p>
<p>例如，以下摘录检索一个<code>SQLXML</code>来自第一列的值<code>ResultSet</code> <i>rs</i> ：</p>
<div class="codeblock"><pre>
SQLXML xmlVar = rs.getSQLXML(1);
</pre></div>
<p><code>SQLXML</code>对象至少在创建它们的交易期间保持有效，除非它们的对象<code>free</code>方法被调用。</p>

<h2><a name="accessing_sqlxml" id="accessing_sqlxml">访问SQLXML对象数据</a></h2>

<p>的<code>SQLXML</code>介面提供<code>getString</code> ， <code>getBinaryStream</code> ， <code>getCharacterStream</code>和<code>getSource</code>访问其内部内容的方法。以下摘录检索了<code>SQLXML</code>使用对象<code>getString</code>方法：</p>
<div class="codeblock"><pre>
SQLXML xmlVal= rs.getSQLXML(1);
String val = xmlVal.getString();
</pre></div>
<p>的<code>getBinaryStream</code>要么<code>getCharacterStream</code>方法可以用来获取<code>InputStream</code>或一个<code>Reader</code>可以直接传递给XML解析器的对象。以下摘录获得了<code>InputStream</code>来自的对象<code>SQLXML</code>对象，然后使用DOM（文档对象模型）解析器处理流：</p>
<div class="codeblock"><pre>
SQLXML sqlxml = rs.getSQLXML(column);
InputStream binaryStream = sqlxml.getBinaryStream();
DocumentBuilder parser = 
    DocumentBuilderFactory.newInstance().newDocumentBuilder();
Document result = parser.parse(binaryStream);
</pre></div>
<p>的<code>getSource</code>方法返回一个<code>javax.xml.transform.Source</code>宾语。源用作XML解析器和XSLT转换器的输入。</p>
<p>以下摘录从以下位置检索并解析数据： <code>SQLXML</code>使用对象<code>SAXSource</code>通过调用返回的对象<code>getSource</code>方法：</p>
<div class="codeblock"><pre>
SQLXML xmlVal= rs.getSQLXML(1);
SAXSource saxSource = sqlxml.getSource(SAXSource.class);
XMLReader xmlReader = saxSource.getXMLReader();
xmlReader.setContentHandler(myHandler);
xmlReader.parse(saxSource.getInputSource());
</pre></div>
<h2><a name="storing_sqlxml" id="storing_sqlxml">存储SQLXML对象</a></h2>
<p>一种<code>SQLXML</code>对象可以作为输入参数传递给<code>PreparedStatement</code>对象就像其他数据类型一样。方法<code>setSQLXML</code>设置指定<code>PreparedStatement</code>带一个参数<code>SQLXML</code>宾语。</p>
<p>在以下摘录中， <code>authorData</code>是<code>java.sql.SQLXML</code>先前已初始化其数据的接口。</p>
<div class="codeblock"><pre>
PreparedStatement pstmt = conn.prepareStatement("INSERT INTO bio " +
                              "(xmlData, authId) VALUES (?, ?)");
pstmt.setSQLXML(1, authorData);
pstmt.setInt(2, authorId);
</pre></div>
<p>的<code>updateSQLXML</code>方法可用于更新可更新结果集中的列值。</p>
<p>如果<code>java.xml.transform.Result</code> ， <code>Writer</code> ， 要么<code>OutputStream</code>的对象<code>SQLXML</code>调用前对象尚未关闭<code>setSQLXML</code>要么<code>updateSQLXML</code> ， 一种<code>SQLException</code>将被抛出。</p>
<h2><a name="initializing_sqlxml" id="initializing_sqlxml">初始化SQLXML对象</a></h2>
<p>的<code>SQLXML</code>界面提供了方法<code>setString</code> ， <code>setBinaryStream</code> ， <code>setCharacterStream</code> ， 要么<code>setResult</code>初始化内容<code>SQLXML</code>通过调用创建的对象<code>Connection.createSQLXML</code>方法。</p>
<p>以下摘录使用方法<code>setResult</code>返回一个<code>SAXResult</code>用于填充新创建的对象<code>SQLXML</code>宾语：</p>
<div class="codeblock"><pre>
SQLXML sqlxml = con.createSQLXML();
SAXResult saxResult = sqlxml.setResult(SAXResult.class);
ContentHandler contentHandler = saxResult.getXMLReader().getContentHandler();
contentHandler.startDocument();
    
// set the XML elements and
// attributes into the result
contentHandler.endDocument();
</pre></div>
<p>以下摘录使用<code>setCharacterStream</code>获得方法<code>java.io.Writer</code>对象以初始化一个<code>SQLXML</code>宾语：</p>
<div class="codeblock"><pre>
SQLXML sqlxml = con.createSQLXML();
Writer out= sqlxml.setCharacterStream();
BufferedReader in = new BufferedReader(new FileReader("xml/foo.xml"));
String line = null;
while((line = in.readLine() != null) {
    out.write(line);
}
</pre></div>
<p>同样， <code>SQLXML</code><code>setString</code>方法可用于初始化<code>SQLXML</code>宾语。</p>
<p>如果试图致电<code>setString</code> ， <code>setBinaryStream</code> ， <code>setCharacterStream</code>和<code>setResult</code>上的方法<code>SQLXML</code>先前已初始化的对象<code>SQLException</code>将被抛出。如果多次调用方法<code>setBinaryStream</code> ， <code>setCharacterStream</code>和<code>setResult</code>发生相同<code>SQLXML</code>对象，一个<code>SQLException</code>被抛出并且先前返回<code>javax.xml.transform.Result</code> ， <code>Writer</code> ， 要么<code>OutputStream</code>对象不受影响。</p>
<h2><a name="releasing_sqlxml" id="releasing_sqlxml">释放SQLXML资源</a></h2>
<p><code>SQLXML</code>对象至少在创建它们的事务期间保持有效。在长时间运行的事务中，这可能导致应用程序资源不足。应用可能会发布<code>SQLXML</code>通过调用他们的资源<code>free</code>方法。</p>
<p>在以下摘录中， <code>method SQLXML.free</code>被调用以释放为先前创建的资源<code>SQLXML</code>宾语。</p>
<div class="codeblock"><pre>
SQLXML xmlVar = con.createSQLXML();
xmlVar.setString(val);
xmlVar.free();
</pre></div>
<h2><a name="sample_code" id="sample_code">样例代码</a></h2>
<p>MySQL和Java DB及其各自的JDBC驱动程序不完全支持<code>SQLXML</code> JDBC数据类型，如本节中所述。但是，样本<code><a href="gettingstarted.html">RSSFeedsTable</a></code>演示如何使用MySQL和Java DB处理XML数据。</p>
<p>The Coffee Break的所有者关注着来自各种网站的一些RSS提要，这些提要涵盖了餐饮业的新闻。RSS（真正简单的联合组织或富网站摘要）提要是一个XML文档，其中包含一系列文章和相关的元数据，例如每篇文章的出版日期和作者。所有者希望将这些RSS提要存储到数据库表中，包括来自The Coffee Break博客的RSS提要。</p>
<p>文件<code><a href="gettingstarted.html">rss-the-coffee-break-blog.xml</a></code>是The Coffee Break博客的RSS feed示例。</p>
<!-- ******************************** -->
<h3><a name="working-with-xml-data-in-mysql" id="working-with-xml-data-in-mysql">在MySQL中使用XML数据</a></h3>
<p>这个样本<code>RSSFeedsTable</code>在表格中存储RSS提要<code>RSS_FEEDS</code> ，使用以下命令创建：</p>
<div class="codeblock"><pre>
create table RSS_FEEDS
    (RSS_NAME varchar(32) NOT NULL,
    RSS_FEED_XML longtext NOT NULL,
    PRIMARY KEY (RSS_NAME));
</pre></div>
<p>MySQL不支持XML数据类型。而是，此样本将XML数据存储在type列中<code>LONGTEXT</code> ，这是一个<code>CLOB</code> SQL数据类型。MySQL有四个<code>CLOB</code>数据类型；的<code>LONGTEXT</code>数据类型在这四个字符中包含最多的字符。</p>
<p>方法<code><a href="gettingstarted.html">RSSFeedsTable.addRSSFeed</a></code>将RSS供稿添加到<code>RSS_FEEDS</code>表。此方法的第一条语句将RSS feed（在此示例中由XML文件表示）转换为类型的对象<code>org.w3c.dom.Document</code> ，代表DOM（文档对象模型）文档。此类以及包中包含的类和接口<code>javax.xml</code> ，包含使您能够处理XML数据内容的方法。例如，以下语句使用XPath表达式从以下网址检索RSS供稿的标题： <code>Document</code>宾语：</p>
<div class="codeblock"><pre>
Node titleElement =
    (Node)xPath.evaluate("/rss/channel/title[1]",
        doc, XPathConstants.NODE);
</pre></div>
<p>XPath表达式<code>/rss/channel/title[1]</code>检索第一个的内容<code><title></code>元件。对于文件<code>rss-the-coffee-break-blog.xml</code> ，这是字符串<code>The Coffee Break Blog</code> 。</p>
<p>以下语句将RSS feed添加到表中<code>RSS_FEEDS</code> ：</p>
<div class="codeblock"><pre>
// For databases that support the SQLXML
// data type, this creates a
// SQLXML object from
// org.w3c.dom.Document.

System.out.println("Adding XML file " + fileName);
String insertRowQuery =
    "insert into RSS_FEEDS " +
    "(RSS_NAME, RSS_FEED_XML) values " +
    "(?, ?)";
insertRow = con.prepareStatement(insertRowQuery);
insertRow.setString(1, titleString);

System.out.println("Creating SQLXML object with MySQL");
rssData = con.createSQLXML();
System.out.println("Creating DOMResult object");
DOMResult dom = (DOMResult)rssData.setResult(DOMResult.class);
dom.setNode(doc);

insertRow.setSQLXML(2, rssData);
System.out.println("Running executeUpdate()");
insertRow.executeUpdate();
</pre></div>
<p>的<code><a href="gettingstarted.html">RSSFeedsTable.viewTable</a></code>方法检索的内容<code>RSS_FEEDS</code> 。对于每一行，该方法都会创建一个类型的对象<code>org.w3c.dom.Document</code>命名<code>doc</code>在其中将XML内容存储在列中<code>RSS_FEED_XML</code> 。该方法检索XML内容并将其存储在类型的对象中<code>SQLXML</code>命名<code>rssFeedXML</code> 。内容<code>rssFeedXML</code>被解析并存储在<code>doc</code>宾语。</p>
<!-- ************************************************* -->
<h3><a name="working-with-xml-data-in-java-db" id="working-with-xml-data-in-java-db">在Java DB中使用XML数据</a></h3>
<p><strong>注意</strong> ：有关在<a href="http://docs.oracle.com/javadb/index_jdk8.html"><em>Java DB中</em></a>使用XML数据的更多信息，请参见《 <a href="http://docs.oracle.com/javadb/index_jdk8.html"><em>Java DB开发人员指南</em></a> 》中的“ XML数据类型和运算符”部分。</p>
<p>这个样本<code>RSSFeedsTable</code>在表格中存储RSS提要<code>RSS_FEEDS</code> ，使用以下命令创建：</p>
<div class="codeblock"><pre>
create table RSS_FEEDS
    (RSS_NAME varchar(32) NOT NULL,
    RSS_FEED_XML xml NOT NULL,
    PRIMARY KEY (RSS_NAME));
</pre></div>
<p>Java DB支持XML数据类型，但不支持<code>SQLXML</code> JDBC数据类型。因此，您必须将任何XML数据转换为字符格式，然后使用Java DB运算符<code>XMLPARSE</code>将其转换为XML数据类型。</p>
<p>的<code><a href="gettingstarted.html">RSSFeedsTable.addRSSFeed</a></code>方法将RSS Feed添加到<code>RSS_FEEDS</code>表。此方法的第一条语句将RSS feed（在此示例中由XML文件表示）转换为类型的对象<code>org.w3c.dom.Document</code> 。<a href="#working-with-xml-data-in-mysql">在MySQL中使用XML数据</a>一节中对此进行了描述。</p>
<p>的<code><a href="gettingstarted.html">RSSFeedsTable.addRSSFeed</a></code>方法将RSS feed转换为<code>String</code>方法的对象<code><a href="gettingstarted.html">JDBCTutorialUtilities.convertDocumentToString</a></code> 。</p>
<p>Java DB有一个名为<code>XMLPARSE</code>将字符串表示形式解析为Java DB XML值，以下摘录演示了这一点：</p>
<div class="codeblock"><pre>
String insertRowQuery =
    "insert into RSS_FEEDS " +
    "(RSS_NAME, RSS_FEED_XML) values " +
    "(?, <strong>xmlparse(document cast " +
    "(? as clob) preserve whitespace)</strong>)";
</pre></div>
<p>的<code>XMLPARSE</code>运算符要求您将XML文档的字符表示形式转换为Java DB可以识别的字符串数据类型。在此示例中，它将其转换为<code>CLOB</code>数据类型。有关Apache Xalan和Java DB要求的更多信息，请参见<a href="gettingstarted.html">入门</a>和Java DB文档。</p>
<p>方法<code><a href="gettingstarted.html">RSSFeedsTable.viewTable</a></code>检索的内容<code>RSS_FEEDS</code> 。因为Java DB不支持JDBC数据类型<code>SQLXML</code>您必须以字符串形式检索XML内容。Java DB有一个名为<code>XMLSERIALIZE</code>将XML类型转换为字符类型：</p>
<div class="codeblock"><pre>
String query =
    "select RSS_NAME, " +
    "xmlserialize " +
    "(RSS_FEED_XML as clob) " +
    "from RSS_FEEDS";
</pre></div>
<p>与<code>XMLPARSE</code>操作员<code>XMLSERIALIZE</code>运算符要求在您的Java类路径中列出Apache Xalan。</p>


        </div>
        <div class="NavBit">
            <a href="blob.html" target="_top">«上一个</a> • <a href="../TOC.html" target="_top">追踪</a> • <a href="array.html" target="_top">下一个»</a>
        </div>
    </div>
    
<hr class="clearfloat">

<div id="Footer">

<p class="footertext">
<a href="http://www.oracle.com/corporate/index.html">关于Oracle</a> | <a href="http://www.oracle.com/us/corporate/contact/index.html">联系我们</a> | <a href="http://www.oracle.com/us/legal/index.html">法律声明</a> | <a href="http://www.oracle.com/us/legal/terms/index.html">使用条款</a> | <a href="http://www.oracle.com/us/legal/privacy/index.html">您的隐私权</a></p>

<p class="footertext"><a href="http://www.oracle.com/pls/topic/lookup?ctx=cpyr&id=en-US">版权所有©1995、2017 Oracle和/或其分支机构。版权所有。</a></p>
       
</div>    
    <div class="PrintHeaders">
        <b>上一页：</b>使用大对象<br><b>下一页：</b>使用数组对象</div>
<!-- Start SiteCatalyst code -->
<script type="application/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_docs.js"></script>
<!-- End SiteCatalyst code --> 

 
</body></html>