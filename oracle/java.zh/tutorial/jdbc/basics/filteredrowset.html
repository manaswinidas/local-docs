<html lang="en-US"  xmlns="http://www.w3.org/1999/xhtml"><head></head><body  onload="load()">﻿
        <title>使用FilteredRowSet对象（Java™教程> JDBC（TM）数据库访问> JDBC基础）</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
     <meta name="description" content="This JDBC Java tutorial describes how to use JDBC API to create, insert into, update, and query tables. You will also learn how to use simple and prepared statements, stored procedures and perform transactions">
     <meta name="keywords" content="java programming, learn java, java sample code, jdbc, prepared statement, result set">
        
<style type="text/css">
    body {
        margin-left:10px;
        margin-right:10px;
        line-height: 1.5;
        FONT-FAMILY: Arial, Helvetica, sans-serif; 
        font-size: 0.8em;
    }
    
    a:link{text-decoration:none; color:#09569d;}
    a:visited{text-decoration:none; color: #3a87cf;}
    a:hover{text-decoration:underline; }
        
    code{
        font-family:Monaco,Courier,"Courier New";
    }
    
    .header-container {
        background-color: #fff;
        border-bottom: 1px solid #C1CFDA;
        -webkit-box-shadow: 0 2px 2px rgba(117, 163, 231, 0.1);
        box-shadow: 0 2px 2px rgba(117, 163, 231, 0.1);
    }
    
    .bookwrapper {
        width: auto;
        margin: auto;
    }
    
    .clearfix {
    }
    
    .clearfloat {
        clear: both;
        overflow: auto;
        height: 0px;
        font-size: 1px;
        line-height: 0px;
    }
    
    #brandProdName {
        width: auto;
        height: auto;
    }
    
    #logocover {
        display: block;
        background: transparent url(../../images/oracle-java-logo.png) 0px 0px no-repeat;
        height: 50px;
        width: 229px;
        float: left;
    }
    
    #productName {
        font-size: 16px;
        position: relative;
        top: 19px;
        padding-left: 3px;
        color: #457798;
        white-space: nowrap;
        width: 340px;
    }


    .FigureCaption   { 
        font-family: sans-serif; 
        text-align: center;
    }
    
    #TopBar_bl {        
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        margin-left: -110px;
        margin-right: -100px;       
		align: left;
        height: 60px;
    }
    #TopBar_tr {
        width: 100%;
        height: 60px;
    }
    
    #TopBar {
        min-width:700px;
        padding:25px 100px 10px;
        margin-bottom:25px;
        clear:both;
        
        border-bottom:1px solid #d2dde5;
        border-radius: 3px;
    
        background:#efefef; /* Old browsers */
        /* IE9 SVG, needs conditional override of 'filter' to 'none' */
        background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2ZmZmZmZiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlMmVmZjkiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
        background: -moz-linear-gradient(top,  #ffffff 0%, #e2eff9 100%); /* FF3.6+ */
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#e2eff9)); /* Chrome,Safari4+ */
        background: -webkit-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* Chrome10+,Safari5.1+ */
        background: -o-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* Opera 11.10+ */
        background: -ms-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* IE10+ */
        background: linear-gradient(to bottom,  #ffffff 0%,#e2eff9 100%); /* W3C */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#e2eff9',GradientType=0 ); /* IE6-8 */
        
    }
    
    #TopBar_left {
        line-height: 14px;
        position: absolute;
        padding-top: 30px;
        padding-right: 30px;
        padding-left: 30px;
        text-align: left;
        font: 13px/20px Arial, Helvetica, sans-serif;
        font-weight: bold;
        font-size: 20px;
        color: #333;
    }
    
    #TopBar_right {
        line-height: 12px;
        float: right;
        padding-top: 10px;
        padding-right: 30px;
        text-align: left;
    }
    

    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    
     
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 10px;
        margin: 3px;
        padding: 0;
    }
 
    #BreadCrumbs {
        padding: 15px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    
    #BreadCrumbs a {
        color:#09569d;
    }
    
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #F90000;
    }
    
    #PageContent{
        margin: 0 5px 0 20px;
    }
    
    .LeftBar_shown {
        width: 13em;
        float: left;
    }
    
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    
    .LeftBar_hidden {
        display: none;
    }
    
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;       
    }
    
    .footertext {
        font-size: 10px;
        font-family: sans-serif; 
        margin-top: 1px;
    }

    .NavBit  {
        padding: 15px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    
    @media print {
        .NavBit {
            display: none;
        }
    }
    
    #TagNotes {
        text-align: right;        
    }
    
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    
    #Contents a, .NavBit a, #TagNotes a {
        color:#09569d;
    }
    
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em;
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #333;
		
		
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
	
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h1, h2, h3, h4, h5 {
        color: #333;
        
    }

    h1 {
        font-weight: bold;
        font-size: 20px;
    }

    h2 {
        font-weight: bold;
        font-size: 17px;
    }

    h3 {
        font-weight: bold;
        font-size: 14px;
    }

    h4 {
        font-size: 15px;
    }

    h5 {
        font-size: 12px;
    }


    #ToggleLeft {
        display: none;
    }
    
    .note {
        margin: 0 30px 0px 30px;
    }
    
    .codeblock {
        margin: 0 30px 0px 30px;
		font-size:12px;
		font-family:Monaco,Courier,"Courier New";
    }
    
    .tocli {
        list-style-type:none;
    }

    .betadraft {
        color: red;
    }

</style>
<script type="text/javascript">
/* <![CDATA[ */
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }

    function showCode(displayCodePage, codePath) {
        var codePathEls = codePath.split("/");
        var currDocPathEls = location.href.split("/");
        //alert ("codePathEls = " + codePathEls + "\n" + "currDocPathEls = " + currDocPathEls);
        currDocPathEls.pop(); // remove file name at the end
        while (codePathEls.length > 0) {
            if (codePathEls[0] == "..") {
                codePathEls.shift();
                currDocPathEls.pop();
            } else {
                break;
            }
        }
        var fullCodePath = currDocPathEls.join("/") + "/" + codePathEls.join("/");
        //alert ("fullCodePath = " + fullCodePath );
        if (codePath.indexOf(".java") != -1 || codePath.indexOf(".jnlp") != -1) {
            window.location.href = displayCodePage + "?code=" + encodeURI(fullCodePath);
        } else {
            window.location.href = fullCodePath;
        }
    }
/* ]]> */    
</script>


    <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script>

    <noscript>要使此页面正常运行，需要启用JavaScript的浏览器。
    </noscript>
        <!-- header -->
    <div class="header-container">
        <div class="bookwrapper  clearfix">       
            <div id="brandProdName">
                <div id="logocover"></div>
                <div id="productName">文献资料</div>
            </div> 
            <br class="clearfloat">
        </div>
    </div>
    
    <div id="TopBar">
        <div id="TopBar_tr">
            <div id="TopBar_tl">
                <div id="TopBar_br"> <div id="TopBar_bl"> 
                    <div id="TopBar_left">Java™教程</div>
                        <div id="TopBar_right"> 
                            <!--
                            <a href="URL" target="_blank">External Link</a><br/>
                            --> <a href="javascript:void(0);" id="ToggleLeft">隐藏目录</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div id="LeftBar" class="LeftBar_shown">
        <div id="Contents">
            <div class="linkLESSON"><a href="index.html">JDBC基础</a></div>
<div class="linkAHEAD"><a href="gettingstarted.html">入门</a></div>
<div class="linkAHEAD"><a href="processingsqlstatements.html">使用JDBC处理SQL语句</a></div>
<div class="linkAHEAD"><a href="connecting.html">建立连接</a></div>
<div class="linkAHEAD"><a href="sqldatasources.html">连接数据源对象</a></div>
<div class="linkAHEAD"><a href="sqlexception.html">处理SQLException</a></div>
<div class="linkAHEAD"><a href="tables.html">设置表格</a></div>
<div class="linkAHEAD"><a href="retrieving.html">从结果集中检索和修改值</a></div>
<div class="linkAHEAD"><a href="prepared.html">使用准备好的语句</a></div>
<div class="linkAHEAD"><a href="transactions.html">使用交易</a></div>
<div class="linkAHEAD"><a href="rowset.html">使用行集对象</a></div>
<div class="linkAHEAD"><a href="jdbcrowset.html">使用JdbcRowSet对象</a></div>
<div class="linkAHEAD"><a href="cachedrowset.html">使用CachedRowSetObjects</a></div>
<div class="linkAHEAD"><a href="joinrowset.html">使用JoinRowSet对象</a></div>
<div class="nolinkAHEAD">使用FilteredRowSet对象</div>
<div class="linkAHEAD"><a href="webrowset.html">使用WebRowSet对象</a></div>
<div class="linkAHEAD"><a href="sqltypes.html">使用高级数据类型</a></div>
<div class="linkAHEAD"><a href="blob.html">使用大对象</a></div>
<div class="linkAHEAD"><a href="sqlxml.html">使用SQLXML对象</a></div>
<div class="linkAHEAD"><a href="array.html">使用数组对象</a></div>
<div class="linkAHEAD"><a href="distinct.html">使用DISTINCT数据类型</a></div>
<div class="linkAHEAD"><a href="sqlstructured.html">使用结构化对象</a></div>
<div class="linkAHEAD"><a href="sqlcustommapping.html">使用自定义类型映射</a></div>
<div class="linkAHEAD"><a href="sqldatalink.html">使用数据链接对象</a></div>
<div class="linkAHEAD"><a href="sqlrowid.html">使用RowId对象</a></div>
<div class="linkAHEAD"><a href="storedprocedures.html">使用存储过程</a></div>
<div class="linkAHEAD"><a href="jdbcswing.html">结合使用JDBC和GUI API</a></div>
</div>
    </div>
    <div id="MainFlow" class="MainFlow_indented">
    <div class="PrintHeaders">
        <b>Trail：</b> JDBC（TM）数据库访问<br><b>课程：</b> JDBC基础</div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">主页</a> > <a href="../index.html" target="_top">JDBC（TM）数据库访问</a> > <a href="index.html" target="_top">JDBC基础</a>
            </div>
            <div class="NavBit">
                <a href="joinrowset.html" target="_top">«上一个</a> • <a href="../TOC.html" target="_top">追踪</a> • <a href="webrowset.html" target="_top">下一个»</a>
            </div>
            <div class="Banner"><p style="background-color:rgb(247,248,249);border-width:1px;padding:10px;font-style:italic;border-style:solid;border-color:rgb(64,74,91)">Java教程是为JDK 8编写的。此页面中描述的示例和实践没有利用更高版本中引入的改进。</p></div>
            <div id="PageTitle"><h1>使用FilteredRowSet对象</h1></div>
            <div id="PageContent">

<p>一种<code>FilteredRowSet</code>对象可让您减少在<code>RowSet</code>对象，以便您只能使用与您正在做的事情有关的数据。您可以决定要对数据设置哪些限制（如何“过滤”数据）并将该过滤器应用于<code>FilteredRowSet</code>宾语。换句话说， <code>FilteredRowSet</code>对象仅显示符合您设置的限制的数据行。一种<code>JdbcRowSet</code>始终与其数据源保持连接的对象可以通过查询数据源（仅选择要查看的列和行）来进行此过滤。查询的<code>WHERE</code>子句定义过滤条件。一种<code>FilteredRowSet</code>对象提供了一种断开连接的方法<code>RowSet</code>对象执行此筛选，而不必在数据源上执行查询，因此避免了必须与数据源建立连接并向其发送查询。</p>
<p>例如，假设在美国，咖啡屋的Coffee Break连锁店已经发展到数百家商店，并且所有这些商店都列在称为<code>COFFEE_HOUSES</code> 。所有者希望使用不需要比较数据库系统的持久连接的咖啡馆比较应用程序来衡量仅加利福尼亚州商店的成功率。该比较将着眼于销售商品与销售咖啡饮料的获利能力以及各种其他成功衡量标准，并将根据咖啡饮料销售，商品销售和总销售对加利福尼亚的商店进行排名。因为桌子<code>COFFEE_HOUSES</code>有数百行，如果将搜索的数据量减少到仅列中的值所在的那些行，则这些比较将更快，更轻松<code>STORE_ID</code>表示加利福尼亚。</p>
<p>这正是一个问题<code>FilteredRowSet</code>通过提供以下功能实现对象地址：</p>
<ul>
<li>能够根据设置的标准限制可见的行</li>
<li>能够选择可见数据而无需连接到数据源</li>
</ul>
<p>涵盖以下主题：</p>
<ul>
<li><a href="#defining-filtering-criteria-in-predicate-object">在谓词对象中定义过滤条件</a></li>
<li><a href="#creating-filteredrowset-object">创建FilteredRowSet对象</a></li>
<li><a href="#creating-and-setting-predicate-object">创建和设置谓词对象</a></li>
<li><a href="#filter-data-further">使用新的谓词对象设置FilteredRowSet对象以进一步过滤数据</a></li>
<li><a href="#updating-filteredrowset-object">更新FilteredRowSet对象</a></li>
<li><a href="#inserting-or-updating-row">插入或更新行</a></li>
<li><a href="#removing-all-filters">删除所有筛选器，以便所有行均可见</a></li>
<li><a href="#deleting-row">删除行</a></li>
</ul>
<!-- **************************** -->
<h2><a name="defining-filtering-criteria-in-predicate-object" id="defining-filtering-criteria-in-predicate-object">在谓词对象中定义过滤条件</a></h2>
<p>设置条件<code>FilteredRowSet</code>对象将是可见的，您定义一个实现<code>Predicate</code>接口。用此类初始化的对象使用以下初始化：</p>
<ul>
<li>值必须落入的范围的高端</li>
<li>值必须落入的范围的下限</li>
<li>列的名称或列号，其值必须在上下边界设置的值的范围内</li>
</ul>
<p>注意，值的范围是包括端值的，这意味着该范围内包括边界处的值。例如，如果范围的上限为100，下限为50，则认为值50在该范围内。值49不是。同样，100在该范围内，但101不在该范围内。</p>
<p>与所有者想要比较加利福尼亚商店的方案相一致， <code>Predicate</code>必须编写用于位于加利福尼亚的Coffee Break咖啡屋过滤器的界面。没有正确的方法来执行此操作，这意味着实现的编写方式有很大的自由度。例如，您可以根据需要命名类及其成员，并以实现所需结果的任何方式实现构造函数和三个评估方法。</p>
<p>该表列出了所有咖啡馆的名称， <code>COFFEE_HOUSES</code> ，具有数百行。为了使事情更易于管理，本示例使用的表中的行要少得多，这足以演示如何进行过滤。</p>
<p>列中的值<code>STORE_ID</code>是一个<code>int</code>除其他外，该值指示咖啡馆所在的状态。例如，以10开头的值表示该州为加利福尼亚州。 <code>STORE_ID</code>以32开头的值表示俄勒冈州，以33开头的值表示华盛顿州。</p>
<p>下课<a href="gettingstarted.html"><code>StateFilter</code></a>实现<code>Predicate</code>接口：</p>
<div class="codeblock"><pre>
public class StateFilter implements Predicate {

    private int lo;
    private int hi;
    private String colName = null;
    private int colNumber = -1;

    public StateFilter(int lo, int hi, int colNumber) {
        this.lo = lo;
        this.hi = hi;
        this.colNumber = colNumber;
    }

    public StateFilter(int lo, int hi, String colName) {
        this.lo = lo;
        this.hi = hi;
        this.colName = colName;
    }

    public boolean evaluate(Object value, String columnName) {
        boolean evaluation = true;
        if (columnName.equalsIgnoreCase(this.colName)) {
            int columnValue = ((Integer)value).intValue();
            if ((columnValue >= this.lo)
                &amp;&amp;
                (columnValue &lt;= this.hi)) {
                evaluation = true;
            } else {
                evaluation = false;
            }
        }
        return evaluation;
    }

    public boolean evaluate(Object value, int columnNumber) {

        boolean evaluation = true;

        if (this.colNumber == columnNumber) {
            int columnValue = ((Integer)value).intValue();
            if ((columnValue >= this.lo)
                &amp;&amp;
                (columnValue &lt;= this.hi)) {
                evaluation = true;
            } else {
                evaluation = false;
            }
        }
        return evaluation;
    }


    public boolean evaluate(RowSet rs) {
    
        CachedRowSet frs = (CachedRowSet)rs;
        boolean evaluation = false;

        try {
            int columnValue = -1;

            if (this.colNumber > 0) {
                columnValue = frs.getInt(this.colNumber);
            } else if (this.colName != null) {
                columnValue = frs.getInt(this.colName);
            } else {
                return false;
            }

            if ((columnValue >= this.lo)
                &amp;&amp;
                (columnValue &lt;= this.hi)) {
                evaluation = true;
            }
        } catch (SQLException e) {
            JDBCTutorialUtilities.printSQLException(e);
            return false;
        } catch (NullPointerException npe) {
            System.err.println("NullPointerException caught");
            return false;
        }
        return evaluation;
    }
}
</pre></div>
<p>这是一个非常简单的实现，它检查由以下任一指定的列中的值<code>colName</code>要么<code>colNumber</code>看看它是否在<code>lo</code>至<code>hi</code> ， 包括的。下面的代码行，来自<a href="gettingstarted.html"><code>FilteredRowSetSample</code></a> ，创建一个过滤器，该过滤器仅允许<code>STORE_ID</code>列值表示介于10000和10999之间的值，表示加利福尼亚的位置：</p>
<div class="codeblock"><pre>
StateFilter myStateFilter = new StateFilter(10000, 10999, 1);
</pre></div>
<p>请注意<code>StateFilter</code>刚定义的类适用于一列。通过使每个参数数组代替单个值，可以使其应用于两列或更多列。例如， <code>Filter</code>对象可能如下所示：</p>
<div class="codeblock"><pre>
public Filter2(Object [] lo, Object [] hi, Object [] colNumber) {
    this.lo = lo;
    this.hi = hi;
    this.colNumber = colNumber;
}
</pre></div>
<p>中的第一个元素<code>colNumber</code> object给出第一列，其中将根据中的第一个元素检查值<code>lo</code>和第一个元素<code>hi</code> 。第二列中的值由<code>colNumber</code>将对照中的第二个元素进行检查<code>lo</code>和<code>hi</code> ， 等等。因此，三个数组中的元素数应相同。以下代码是该方法的实现<code>evaluate(RowSet rs)</code>可能看起来像<code>Filter2</code>对象，其中参数是数组：</p>
<div class="codeblock"><pre>
public boolean evaluate(RowSet rs) {
    CachedRowSet crs = (CachedRowSet)rs;
    boolean bool1;
    boolean bool2;
    for (int i = 0; i &lt; colNumber.length; i++) {

        if ((rs.getObject(colNumber[i] &gt;= lo [i]) &amp;&amp;
            (rs.getObject(colNumber[i] &lt;= hi[i]) {
            bool1 = true;
        } else {
            bool2 = true;
        }

        if (bool2) {
            return false;
        } else {
            return true;
        }
    }
}
</pre></div>
<p>使用一个优点<code>Filter2</code>实现是您可以使用任何参数<code>Object</code>类型，并且可以检查一列或多列，而无需编写另一种实现。但是，您必须通过<code>Object</code>类型，这意味着您必须将原始类型转换为其<code>Object</code>类型。例如，如果您使用<code>int</code>的价值<code>lo</code>和<code>hi</code> ，您必须将<code>int</code>价值<code>Integer</code>对象，然后再将其传递给构造函数。 <code>String</code>对象已经<code>Object</code>类型，因此您不必转换它们。</p>
<!-- *************************** -->
<h2><a name="creating-filteredrowset-object" id="creating-filteredrowset-object">创建FilteredRowSet对象</a></h2>
<p>参考实现<code>FilteredRowSet</code>接口， <code>FilteredRowSetImpl</code> ，包括默认构造函数，该代码在以下代码行中用于创建空<code>FilteredRowSet</code>宾语<code>frs:</code> 。</p>
<div class="codeblock"><pre>
FilteredRowSet frs = new FilteredRowSetImpl();
</pre></div>
<p>该实现扩展了<code>BaseRowSet</code>抽象类，所以<code>frs</code>对象具有在中定义的默认属性<code>BaseRowSet</code> 。这意味着<code>frs</code>是可滚动的，可更新的，不显示已删除的行，已启用转义处理等等。另外，因为<code>FilteredRowSet</code>接口是的子接口<code>CachedRowSet</code> ， <code>Joinable</code>和<code>WebRowSet</code> ， <code>frs</code>对象具有各自的功能。它可以作为断开连接运行<code>RowSet</code>对象，可以是一个对象的一部分<code>JoinRowSet</code>对象，并且可以以XML格式进行读写。</p>
<p><strong>注意</strong> ：或者，您可以使用<code>WebRowSet</code> JDBC驱动程序的实现。但是， <code>RowSet</code>接口将与参考实现不同。这些实现将具有不同的名称和构造函数。例如，Oracle JDBC驱动程序的实现<code>WebRowSet</code>接口被命名<code>oracle.jdbc.rowset.OracleWebRowSet</code> 。</p>
<p>您可以使用<code>RowSetFactory</code> ，它是从类创建的<code>RowSetProvider</code> ，创建一个<code>FilteredRowSet</code>宾语。有关更多信息，请参见<a href="jdbcrowset.html#rowsetfactory">使用</a> <a href="jdbcrowset.html">JdbcRowSet对象</a>中的<a href="jdbcrowset.html">使用</a> <a href="jdbcrowset.html#rowsetfactory">RowSetFactory接口</a> 。</p>
<p>像其他断开<code>RowSet</code>对象， <code>frs</code>对象必须使用来自表格数据源的数据填充自身，该数据源是参考实现中的关系数据库。以下代码片段来自<a href="gettingstarted.html"><code>FilteredRowSetSample</code></a>设置连接到数据库以执行其命令所需的属性。请注意，此代码使用<code>DriverManager</code>类以建立连接，这样做是为了方便。通常，最好使用<code>DataSource</code>已向实现Java命名和目录接口（JNDI）的命名服务注册的对象：</p>
<div class="codeblock"><pre>
frs.setCommand("SELECT * FROM COFFEE_HOUSES");
frs.setUsername(settings.userName);
frs.setPassword(settings.password);
frs.setUrl(settings.urlString);
</pre></div>
<p>以下代码行填充<code>frs</code>对象中存储的数据<code>COFFEE_HOUSE</code>表：</p>
<div class="codeblock"><pre>
frs.execute();
</pre></div>
<p>方法<code>execute</code>通过调用在后台执行各种操作<code>RowSetReader</code>的对象<code>frs</code> ，它创建一个连接，执行命令<code>frs</code> ，填充<code>frs</code>与来自<code>ResultSet</code>产生的对象，并关闭连接。注意如果表<code>COFFEE_HOUSES</code>行数多于<code>frs</code>对象可以一次保存在内存中， <code>CachedRowSet</code>使用分页方法。</p>
<p>在这种情况下，Coffee Break所有者将在办公室中完成上述任务，然后导入或下载存储在服务器中的信息。 <code>frs</code>反对咖啡馆比较应用程序。从现在开始， <code>frs</code>对象将独立运行，而无需连接到数据源。</p>
<h2><a name="creating-and-setting-predicate-object" id="creating-and-setting-predicate-object">创建和设置谓词对象</a></h2>
<p>现在， <code>FilteredRowSet</code>宾语<code>frs</code>包含“茶歇”场所的列表，您可以设置选择条件以缩小<code>frs</code>可见的对象。</p>
<p>以下代码行使用<code>StateFilter</code>先前定义的用于创建对象的类<code>myStateFilter</code> ，它检查列<code>STORE_ID</code>确定哪些商店在加利福尼亚（如果其ID号在10000和10999（含）之间，则商店在加利福尼亚）：</p>
<div class="codeblock"><pre>
StateFilter myStateFilter = new StateFilter(10000, 10999, 1);
</pre></div>
<p>以下行集<code>myStateFilter</code>作为过滤器<code>frs</code> 。</p>
<div class="codeblock"><pre>
frs.setFilter(myStateFilter);
</pre></div>
<p>要进行实际过滤，请调用方法<code>next</code> ，在参考实现中会调用相应版本的<code>Predicate.evaluate</code>您以前实现的方法。</p>
<p>如果返回值为<code>true</code> ，该行将可见；如果返回值为<code>false</code> ，则该行将不可见。</p>
<h2><a name="filter-data-further" id="filter-data-further">使用新的谓词对象设置FilteredRowSet对象以进一步过滤数据</a></h2>
<p>您可以依次设置多个过滤器。第一次调用该方法<code>setFilter</code>并通过<code>Predicate</code>对象，您已在该过滤器中应用了过滤条件。调用方法后<code>next</code>在每行上（仅显示那些满足过滤条件的行），您可以调用<code>setFilter</code>再一次，传递不同<code>Predicate</code>宾语。即使一次仅设置一个过滤器，效果是两个过滤器都累加应用。</p>
<p>例如，所有者通过以下方式检索了加利福尼亚州的Coffee Break商店列表<code>stateFilter</code>作为<code>Predicate</code>的对象<code>frs</code> 。现在，店主想比较两个加利福尼亚城市旧金山的商店（表中的SF <code>COFFEE_HOUSES</code> ）和洛杉矶（表中的LA）。首先要做的是写一个<code>Predicate</code>对SF或LA中的商店进行过滤的实现：</p>
<div class="codeblock"><pre>
public class CityFilter implements Predicate {

    private String[] cities;
    private String colName = null;
    private int colNumber = -1;

    public CityFilter(String[] citiesArg, String colNameArg) {
        this.cities = citiesArg;
        this.colNumber = -1;
        this.colName = colNameArg;
    }

    public CityFilter(String[] citiesArg, int colNumberArg) {
        this.cities = citiesArg;
        this.colNumber = colNumberArg;
        this.colName = null;
    }

    public boolean evaluate Object valueArg, String colNameArg) {

        if (colNameArg.equalsIgnoreCase(this.colName)) {
            for (int i = 0; i &lt; this.cities.length; i++) {
                if (this.cities[i].equalsIgnoreCase((String)valueArg)) {
                    return true;
                }
            }
        }
        return false;
    }

    public boolean evaluate(Object valueArg, int colNumberArg) {

        if (colNumberArg == this.colNumber) {
            for (int i = 0; i &lt; this.cities.length; i++) {
                if (this.cities[i].equalsIgnoreCase((String)valueArg)) {
                    return true;
                }
            }
        }
        return false;
    }


    public boolean evaluate(RowSet rs) {

        if (rs == null) return false;

        try {
            for (int i = 0; i &lt; this.cities.length; i++) {

                String cityName = null;

                if (this.colNumber &gt; 0) {
                    cityName = (String)rs.getObject(this.colNumber);
                } else if (this.colName != null) {
                    cityName = (String)rs.getObject(this.colName);
                } else {
                    return false;
                }

                if (cityName.equalsIgnoreCase(cities[i])) {
                    return true;
                }
            }
        } catch (SQLException e) {
            return false;
        }
        return false;
    }
}
</pre></div>
<p>以下代码片段来自<a href="gettingstarted.html"><code>FilteredRowSetSample</code></a>设置新的过滤器并遍历其中的行<code>frs</code> ，列印出<code>CITY</code>列包含SF或LA。注意<code>frs</code>当前仅包含该商店位于加利福尼亚州的行，因此<code>Predicate</code>宾语<code>state</code>过滤器更改为另一个过滤器时，它仍然有效<code>Predicate</code>宾语。后面的代码将过滤器设置为<code>CityFilter</code>宾语<code>city</code> 。的<code>CityFilter</code>实现使用数组作为构造函数的参数来说明如何实现：</p>
<div class="codeblock"><pre>
public void testFilteredRowSet() {

    FilteredRowSet frs = null;
    StateFilter myStateFilter = new StateFilter(10000, 10999, 1);
    String[] cityArray = { "SF", "LA" };

    CityFilter myCityFilter = new CityFilter(cityArray, 2);

    try {
        frs = new FilteredRowSetImpl();

        frs.setCommand("SELECT * FROM COFFEE_HOUSES");
        frs.setUsername(settings.userName);
        frs.setPassword(settings.password);
        frs.setUrl(settings.urlString);
        frs.execute();

        System.out.println("\nBefore filter:");
        FilteredRowSetSample.viewTable(this.con);

        System.out.println("\nSetting state filter:");
        frs.beforeFirst();
        frs.setFilter(myStateFilter);
        this.viewFilteredRowSet(frs);

        System.out.println("\nSetting city filter:");
        frs.beforeFirst();
        frs.setFilter(myCityFilter);
        this.viewFilteredRowSet(frs);
    } catch (SQLException e) {
        JDBCTutorialUtilities.printSQLException(e);
    }
}
</pre></div>
<p>对于位于加利福尼亚州旧金山或加利福尼亚州洛杉矶的每个商店，输出应包含一行。如果有一行<code>CITY</code>列包含LA和<code>STORE_ID</code>列包含40003，因此不会包含在列表中，因为在将过滤器设置为时已将其过滤掉<code>state</code> 。 （40003不在10000到10999的范围内。）</p>
<h2><a name="updating-filteredrowset-object" id="updating-filteredrowset-object">更新FilteredRowSet对象</a></h2>
<p>您可以更改<code>FilteredRowSet</code>对象，但前提是该更改不违反当前有效的任何过滤条件。例如，如果一个或多个新值在过滤条件之内，则可以插入新行或更改现有行中的一个或多个值。</p>
<h2><a name="inserting-or-updating-row" id="inserting-or-updating-row">插入或更新行</a></h2>
<p>假设有两个新的Coffee Break咖啡屋刚刚开放，所有者希望将它们添加到所有咖啡屋的列表中。如果要插入的行不符合有效的累积过滤条件，则将阻止添加该行。</p>
<p>当前状态<code>frs</code>对象是<code>StateFilter</code>设置了对象，然后<code>CityFilter</code>对象已设置。结果是， <code>frs</code>当前仅使满足两个过滤器条件的那些行可见。同样重要的是，您不能在<code>frs</code>对象，除非它同时满足两个过滤器的条件。以下代码片段尝试将两个新行插入到<code>frs</code>对象，其中一行中的值<code>STORE_ID</code>和<code>CITY</code>列均符合条件，并且其中一行符合条件<code>STORE_ID</code>没有通过过滤器，但是<code>CITY</code>专栏做：</p>
<div class="codeblock"><pre>
frs.moveToInsertRow();
frs.updateInt("STORE_ID", 10101);
frs.updateString("CITY", "SF");
frs.updateLong("COF_SALES", 0);
frs.updateLong("MERCH_SALES", 0);
frs.updateLong("TOTAL_SALES", 0);
frs.insertRow();

frs.updateInt("STORE_ID", 33101);
frs.updateString("CITY", "SF");
frs.updateLong("COF_SALES", 0);
frs.updateLong("MERCH_SALES", 0);
frs.updateLong("TOTAL_SALES", 0);
frs.insertRow();
frs.moveToCurrentRow();
</pre></div>
<p>如果您要遍历<code>frs</code>使用方法的对象<code>next</code> ，您会在加利福尼亚州旧金山的新咖啡馆找到一排，但在华盛顿旧金山的商店找不到。</p>
<h2><a name="removing-all-filters" id="removing-all-filters">删除所有筛选器，以便所有行均可见</a></h2>
<p>所有者可以通过取消过滤器来在华盛顿添加商店。如果未设置过滤器，则<code>frs</code>对象再次可见，可以将任何位置的商店添加到商店列表中。以下代码行取消了当前过滤器的设置，从而有效地消除了<code>Predicate</code>先前在<code>frs</code>宾语。</p>
<div class="codeblock"><pre>
frs.setFilter(null);
</pre></div>
<h2><a name="deleting-row" id="deleting-row">删除行</a></h2>
<p>如果所有者决定关闭或出售其中一个Coffee Break咖啡馆，则所有者将要从“咖啡休息时间”咖啡馆中删除它<code>COFFEE_HOUSES</code>表。所有者可以删除效果欠佳的咖啡屋的行，只要该行可见即可。</p>
<p>例如，给定方法<code>setFilter</code>刚刚使用参数null进行了调用，则在上没有设置过滤器<code>frs</code>宾语。这意味着所有行都是可见的，因此可以删除。但是，之后<code>StateFilter</code>宾语<code>myStateFilter</code>设置为，过滤掉除加利福尼亚州以外的任何州，只能删除位于加利福尼亚州的商店。当。。。的时候<code>CityFilter</code>宾语<code>myCityFilter</code>为<code>frs</code>对象，只能删除位于加利福尼亚州旧金山或加利福尼亚州洛杉矶的咖啡馆，因为它们仅在可见的行中。</p>


        </div>
        <div class="NavBit">
            <a href="joinrowset.html" target="_top">«上一个</a> • <a href="../TOC.html" target="_top">追踪</a> • <a href="webrowset.html" target="_top">下一个»</a>
        </div>
    </div>
    
<hr class="clearfloat">

<div id="Footer">

<p class="footertext">
<a href="http://www.oracle.com/corporate/index.html">关于Oracle</a> | <a href="http://www.oracle.com/us/corporate/contact/index.html">联系我们</a> | <a href="http://www.oracle.com/us/legal/index.html">法律声明</a> | <a href="http://www.oracle.com/us/legal/terms/index.html">使用条款</a> | <a href="http://www.oracle.com/us/legal/privacy/index.html">您的隐私权</a></p>

<p class="footertext"><a href="http://www.oracle.com/pls/topic/lookup?ctx=cpyr&id=en-US">版权所有©1995、2017 Oracle和/或其分支机构。版权所有。</a></p>
       
</div>    
    <div class="PrintHeaders">
        <b>上一页：</b>使用JoinRowSet对象<br><b>下一页：</b>使用WebRowSet对象</div>
<!-- Start SiteCatalyst code -->
<script type="application/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_docs.js"></script>
<!-- End SiteCatalyst code --> 

 
</body></html>