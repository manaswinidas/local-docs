<html lang="en-us"  xml:lang="en-us"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Ergonomics is the process by which the Java Virtual Machine (JVM) and garbage collection heuristics, such as behavior-based heuristics, improve application performance.">
      <meta name="description" content="Ergonomics is the process by which the Java Virtual Machine (JVM) and garbage collection heuristics, such as behavior-based heuristics, improve application performance.">
      <title>Ergonomics</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="HotSpot Virtual Machine Garbage Collection Tuning Guide">
      <meta property="og:description" content="Ergonomics is the process by which the Java Virtual Machine (JVM) and garbage collection heuristics, such as behavior-based heuristics, improve application performance.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="HotSpot Virtual Machine Garbage Collection Tuning Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="hotspot-virtual-machine-garbage-collection-tuning-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-09-21T11:00:40-07:00">
      <meta name="dcterms.title" content="HotSpot Virtual Machine Garbage Collection Tuning Guide">
      <meta name="dcterms.dateCopyrighted" content="2015, 2018">
      <meta name="dcterms.category" content="java">
      <meta name="dcterms.identifier" content="E95201-01">
      
      <meta name="dcterms.product" content="en/java/javase/11">
      <meta name="dcterms.release" content="11">
      <link rel="prev" href="introduction-garbage-collection-tuning.html" title="Previous" type="text/html">
      <link rel="next" href="garbage-collector-implementation.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"java","element_name":"Java","display_in_url":true},"suite":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product_group":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product":{"short_name":"javase","element_name":"Java SE","display_in_url":true},"release":{"short_name":"11","element_name":"11","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="GCTUNING">
  <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
   <body >
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="introduction-garbage-collection-tuning.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一个</a> <a href="garbage-collector-implementation.html" class="pull-right">下一个<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">HotSpot虚拟机垃圾收集优化指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">人机工程学</li>
            </ol>
            <a id="GUID-DB4CAE94-2041-4A16-90EC-6AE3D91EC1F1" name="GUID-DB4CAE94-2041-4A16-90EC-6AE3D91EC1F1"></a>
            
            <h2 id="JSGCT-GUID-DB4CAE94-2041-4A16-90EC-6AE3D91EC1F1" class="sect2"><span class="enumeration_chapter">2</span>人机工程学</h2>
         </header>
         <div class="ind">
            <div>
               <p><span class="italic">人体工程学</span>是Java虚拟机（JVM）和垃圾收集启发法（例如基于行为的启发法）提高应用程序性能的过程。
               </p>
               <p>JVM为垃圾收集器，堆大小和运行时编译器提供了依赖于平台的默认选择。这些选择符合不同类型应用程序的需求，同时需要较少的命令行调整。此外，基于行为的调整可动态优化堆的大小，以满足应用程序的指定行为。</p>
               <p>本节描述了这些默认选择和基于行为的调整。在使用后续各节中介绍的更详细的控件之前，请使用这些默认值。</p>
               <div class="section">
                  <p class="subhead1" id="GUID-DB4CAE94-2041-4A16-90EC-6AE3D91EC1F1__GUID-9129376F-65B1-4135-A881-5E8E89814AA9">话题</p>
                  <ul style="list-style-type:disc">
                     <li><a href="ergonomics.html#GUID-DA88B6A6-AF89-4423-95A6-BBCBD9FAE781" title="这些是重要的垃圾收集器，堆大小和运行时编译器的默认选择：">垃圾收集器，堆和运行时编译器的默认选择</a></li>
                     <li><a href="ergonomics.html#GUID-3D0BB91E-9BFF-4EBB-B523-14493A860E73" title="暂停时间是垃圾收集器停止应用程序并恢复不再使用的空间的持续时间。最大暂停时间目标的目的是限制这些暂停中的最长时间。吞吐量目标是根据收集垃圾所花费的时间来衡量的，而在垃圾收集之外所花费的时间就是应用时间。">基于行为的调整</a><ul style="list-style-type:disc">
                           <li><a href="ergonomics.html#GUID-C15D02E5-E783-4A0D-8A6B-D57A36A23F77" title="暂停时间是垃圾收集器停止应用程序并恢复不再使用的空间的持续时间。最大暂停时间目标的目的是限制这些暂停中的最长时间。">最大暂停时间目标</a></li>
                           <li><a href="ergonomics.html#GUID-BC516CBE-700D-44DB-8485-3FD5CA9A411B" title="吞吐量目标是根据收集垃圾所花费的时间来衡量的，而在垃圾收集之外所花费的时间就是应用时间。">吞吐量目标</a></li>
                           <li><a href="ergonomics.html#GUID-83551BA5-ADEA-4E2E-B60A-3A953DA8FD02">脚印</a></li>
                        </ul>
                     </li>
                     <li><a href="ergonomics.html#GUID-034BAF7C-2F2E-483D-8606-0BF2B8710BC9" title="堆增长或缩小到支持所选吞吐量目标的大小。了解有关堆调整策略的信息，例如选择最大堆大小和选择最大暂停时间目标。">调整策略</a></li>
                  </ul>
               </div>
               <!-- class="section" -->
            </div>
            <div class="props_rev_3"><a id="GUID-DA88B6A6-AF89-4423-95A6-BBCBD9FAE781" name="GUID-DA88B6A6-AF89-4423-95A6-BBCBD9FAE781"></a><h3 id="JSGCT-GUID-DA88B6A6-AF89-4423-95A6-BBCBD9FAE781" class="sect3">垃圾收集器，堆和运行时编译器的默认选择</h3>
               <div>
                  <p>这些是重要的垃圾收集器，堆大小和运行时编译器的默认选择：</p>
                  <div class="section">
                     <ul style="list-style-type:disc">
                        <li>
                           <p>垃圾优先（G1）收集器</p>
                        </li>
                        <li>
                           <p>GC线程的最大数量受堆大小和可用CPU资源的限制</p>
                        </li>
                        <li>
                           <p>初始堆大小为物理内存的1/64</p>
                        </li>
                        <li>
                           <p>最大堆大小为物理内存的1/4</p>
                        </li>
                        <li>
                           <p>使用C1和C2的分层编译器</p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-3D0BB91E-9BFF-4EBB-B523-14493A860E73" name="GUID-3D0BB91E-9BFF-4EBB-B523-14493A860E73"></a><h3 id="JSGCT-GUID-3D0BB91E-9BFF-4EBB-B523-14493A860E73" class="sect3">基于行为的调整</h3>
               <div>
                  <p>可以将Java HotSpot VM垃圾收集器配置为优先满足以下两个目标之一：最大暂停时间和应用程序吞吐量。如果达到了首选目标，则收集者将尝试使另一个最大化。自然地，这些目标并不总是可以满足的：应用程序需要最小的堆来容纳至少所有实时数据，而其他配置则可能无法实现某些或所有期望的目标。</p>
               </div>
               <div class="props_rev_3"><a id="GUID-C15D02E5-E783-4A0D-8A6B-D57A36A23F77" name="GUID-C15D02E5-E783-4A0D-8A6B-D57A36A23F77"></a><h4 id="JSGCT-GUID-C15D02E5-E783-4A0D-8A6B-D57A36A23F77" class="sect4">最大暂停时间目标</h4>
                  <div>
                     <p><span class="italic">暂停时间</span>是垃圾收集器停止应用程序并恢复不再使用的空间的持续时间。<span class="italic">最大暂停时间</span>目标的目的是限制这些暂停中的最长时间。
                     </p>
                     <p>垃圾回收器会保持平均的停顿时间和该平均值的方差。平均值是从执行开始算起的，但会对其进行加权，以使最近的暂停次数增加。如果平均时间加上暂停时间的方差大于最大暂停时间目标，则垃圾收集器认为未达到目标。</p>
                     <p>最大暂停时间目标是通过命令行选项指定的<code class="codeph">-XX:MaxGCPauseMillis=</code> <span class="variable" translate="no"><nnn></nnn></span> 。这被解释为向垃圾收集器的提示，即暂停时间为<span class="variable" translate="no"><nnn></nnn></span>要求毫秒或更少。垃圾收集器会调整Java堆大小以及与垃圾收集相关的其他参数，以使垃圾收集的暂停时间短于<span class="variable" translate="no"><nnn></nnn></span>毫秒。最大暂停时间目标的默认值因收集器而异。这些调整可能导致垃圾回收更加频繁地发生，从而降低了应用程序的整体吞吐量。但是，在某些情况下，无法达到所需的暂停时间目标。
                     </p>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-BC516CBE-700D-44DB-8485-3FD5CA9A411B" name="GUID-BC516CBE-700D-44DB-8485-3FD5CA9A411B"></a><h4 id="JSGCT-GUID-BC516CBE-700D-44DB-8485-3FD5CA9A411B" class="sect4">吞吐量目标</h4>
                  <div>
                     <p>吞吐量目标是根据收集垃圾所花费的时间来衡量的，而在垃圾收集之外所花费的时间就是<span class="italic">应用时间</span> 。
                     </p>
                     <p>目标由命令行选项指定<code class="codeph">-XX:GCTimeRatio=</code> <span class="variable" translate="no">nnn</span> 。垃圾回收时间与应用程序时间之比为1 /（1+ <span class="variable" translate="no">nnn</span> ）。例如， <code class="codeph">-XX:GCTimeRatio=19</code>将垃圾收集的目标定为总时间的1/20或5％。
                     </p>
                     <p>垃圾收集所花费的时间是所有垃圾收集引起的暂停的总时间。如果没有达到吞吐量目标，那么垃圾收集器可能采取的一种措施是增加堆的大小，以便在两次收集暂停之间花费在应用程序中的时间更长。</p>
                  </div>
               </div>
               <div class="props_rev_3"><a id="GUID-83551BA5-ADEA-4E2E-B60A-3A953DA8FD02" name="GUID-83551BA5-ADEA-4E2E-B60A-3A953DA8FD02"></a><h4 id="JSGCT-GUID-83551BA5-ADEA-4E2E-B60A-3A953DA8FD02" class="sect4">脚印</h4>
                  <div>
                     <p>如果达到了吞吐量和最大暂停时间目标，则垃圾收集器会减小堆的大小，直到不能满足其中一个目标（始终是吞吐量目标）。可以使用以下命令设置垃圾收集器可以使用的最小和最大堆大小： <code class="codeph">-Xms=</code> <span class="variable" translate="no"><nnn></nnn></span>和<code class="codeph">-Xmx=</code> <span class="variable" translate="no"><mmm></mmm></span>分别用于最小和最大堆大小。
                     </p>
                  </div>
               </div>
            </div>
            <div class="props_rev_3"><a id="GUID-034BAF7C-2F2E-483D-8606-0BF2B8710BC9" name="GUID-034BAF7C-2F2E-483D-8606-0BF2B8710BC9"></a><h3 id="JSGCT-GUID-034BAF7C-2F2E-483D-8606-0BF2B8710BC9" class="sect3">调整策略</h3>
               <div>
                  <p>堆增长或缩小到支持所选吞吐量目标的大小。了解有关堆调整策略的信息，例如选择最大堆大小和选择最大暂停时间目标。</p>
                  <p>除非您知道需要的堆大于默认的最大堆大小，否则不要为堆选择最大值。选择适合您的应用程序的吞吐量目标。</p>
                  <p>应用程序行为的更改可能导致堆增大或缩小。例如，如果应用程序开始以更高的速率进行分配，则堆会增长以保持相同的吞吐量。</p>
                  <p>如果堆增长到最大大小并且未达到吞吐量目标，则最大堆大小对于吞吐量目标而言太小。将最大堆大小设置为接近平台上总物理内存的值，但不会导致应用程序交换。再次执行该应用程序。如果仍然没有达到吞吐量目标，那么对于平台上的可用内存来说，应用程序时间目标太高了。</p>
                  <p>如果可以满足吞吐量目标，但暂停时间太长，则选择最大暂停时间目标。选择最大暂停时间目标可能意味着您的吞吐量目标将无法实现，因此请选择对应用程序可接受的折衷值。</p>
                  <p>当垃圾收集器试图满足竞争目标时，堆的大小通常会振荡。即使应用程序已达到稳定状态，也是如此。达到吞吐量目标（可能需要更大的堆）的压力与目标竞争，以获得最大的暂停时间和最小的占用空间（这两者都可能需要一个小堆）。</p>
               </div>
            </div>
         </div>
      </article>
   

</body></html>