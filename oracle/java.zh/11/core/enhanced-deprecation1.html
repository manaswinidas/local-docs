<html lang="en-us"  xml:lang="en-us"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="The semantics of what deprecation means has been clarified, including whether an API may be removed in the near future.">
      <meta name="description" content="The semantics of what deprecation means has been clarified, including whether an API may be removed in the near future.">
      <title>Enhanced Deprecation</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Core Libraries">
      <meta property="og:description" content="The semantics of what deprecation means has been clarified, including whether an API may be removed in the near future.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Core Libraries">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="java-core-libraries-developer-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-09-20T08:11:40-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2017, 2018">
      <meta name="dcterms.category" content="java">
      <meta name="dcterms.identifier" content="E94895-01">
      
      <meta name="dcterms.product" content="en/java/javase/11">
      <meta name="dcterms.release" content="11">
      <link rel="prev" href="serialization-filtering1.html" title="Previous" type="text/html">
      <link rel="next" href="xml-catalog-api1.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"java","element_name":"Java","display_in_url":true},"suite":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product_group":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product":{"short_name":"javase","element_name":"Java SE","display_in_url":true},"release":{"short_name":"11","element_name":"11","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Java Core Libraries Developer Guide">
    <meta name="dcterms.isVersionOf" content="CORE">
  <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="serialization-filtering1.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一个</a> <a href="xml-catalog-api1.html" class="pull-right">下一个<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">核心图书馆</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">增强的弃用</li>
            </ol>
            <a id="GUID-23B13A9E-2727-42DC-B03A-E374B3C4CE96" name="GUID-23B13A9E-2727-42DC-B03A-E374B3C4CE96"></a>
            
            <h2 id="JSCOR-GUID-23B13A9E-2727-42DC-B03A-E374B3C4CE96" class="sect2"><span class="enumeration_chapter">3</span>增强的弃用</h2>
         </header>
         <div class="ind">
            <div>
               <p>已经阐明了弃用的含义，包括在不久的将来是否可以删除API。</p>
               <p>如果您是库维护者，则可以利用更新的弃用语法来通知您的库用户有关库提供的API状态的信息。</p>
               <p>如果您是图书馆或应用程序开发人员，则可以使用<code class="codeph">jdeprscan</code>工具来查找应用程序或库中不推荐使用的JDK API元素的使用。
               </p>
               <div class="section">
                  <p class="subhead1" id="GUID-23B13A9E-2727-42DC-B03A-E374B3C4CE96__GUID-DFE09963-C4D2-48B7-AC0D-706CDD96BD19">话题</p>
                  <ul style="list-style-type:disc">
                     <li><a href="enhanced-deprecation1.html#GUID-BB859EA8-E6F7-4239-9A52-4F1BDE27BB09" title="弃用是向库使用者发出的通知，告知他们应该从已弃用的API迁移代码。">JDK中的弃用</a></li>
                     <li><a href="enhanced-deprecation1.html#GUID-E182DAF6-282B-4C1F-8CCF-0A61008E3F11" title="弃用API需要使用两种不同的机制：@Deprecated批注和@deprecated Javadoc标记。">如何弃用API</a></li>
                     <li><a href="enhanced-deprecation1.html#GUID-97A6BB09-6F7D-4ED0-BF53-22D40757B0B2" title="不建议使用API时，必须通知开发人员。不建议使用的API可能会在您的代码中引起问题，或者，如果最终将其删除，则会在运行时导致失败。">通知和警告</a></li>
                     <li><a href="enhanced-deprecation1.html#GUID-F0CD4B54-CD8A-4153-87F9-7E7481F9AAFC" title="jdeprscan是一个静态分析工具，它报告应用程序对已弃用的JDK API元素的使用情况。运行jdeprscan以帮助识别编译的类文件或jar文件中的可能问题。">运行jdeprscan</a> 
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
            </div>
            <div class="sect2"><a id="GUID-BB859EA8-E6F7-4239-9A52-4F1BDE27BB09" name="GUID-BB859EA8-E6F7-4239-9A52-4F1BDE27BB09"></a><h3 id="JSCOR-GUID-BB859EA8-E6F7-4239-9A52-4F1BDE27BB09" class="sect3">JDK中的弃用</h3>
               <div>
                  <p>弃用是向库使用者发出的通知，告知他们应该从已弃用的API迁移代码。</p>
                  <div class="p">在JDK中，由于多种原因而弃用了API，例如：<ul style="list-style-type:disc">
                        <li>
                           <p>该API很危险（例如<span class="apiname">Thread.stop</span>方法）。
                           </p>
                        </li>
                        <li>
                           <p>有一个简单的重命名（例如，AWT <span class="apiname">Component.show/hide</span>替换为<span class="apiname">setVisible</span> ）。
                           </p>
                        </li>
                        <li>
                           <p>可以使用更新更好的API。</p>
                        </li>
                        <li>
                           <p>不推荐使用的API将被删除。</p>
                        </li>
                     </ul>
                  </div>
                  <p>在以前的版本中，不建议使用API，但实际上从未删除过。从JDK 9开始，API可能被标记为不赞成删除。这表明该API有资格在下一版JDK平台中删除。如果您的应用程序或库使用了这些API中的任何一个，那么您应该制定一个计划，以便尽快从它们中进行迁移。</p>
                  <p>有关当前JDK版本中已弃用的API的列表，请参阅API规范中的“ <a href="https://docs.oracle.com/javase/10/docs/api/deprecated-list.html" target="_blank">已弃用的API”</a>页面。
                  </p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-E182DAF6-282B-4C1F-8CCF-0A61008E3F11" name="GUID-E182DAF6-282B-4C1F-8CCF-0A61008E3F11"></a><h3 id="JSCOR-GUID-E182DAF6-282B-4C1F-8CCF-0A61008E3F11" class="sect3">如何弃用API</h3>
               <div>
                  <p>弃用API需要使用两种不同的机制： <span class="apiname">@Deprecated</span>批注和<span class="apiname">@deprecated</span> Javadoc标记。
                  </p>
                  <p><span class="apiname">@Deprecated</span>注释以一种记录在类文件中并在运行时可用的方式标记API。这允许使用各种工具，例如<code class="codeph">javac</code>和<code class="codeph">jdeprscan</code> ，以检测并标记已弃用的API的使用情况。 <span class="apiname">@deprecated</span> Javadoc标记用于过时的API文档中，例如，描述过时的原因并建议其他API。</p>
                  <p>请注意大写：注解以大写字母<span class="italic">D</span>开头，而Javadoc标记以小写字母<span class="italic">d</span>开头。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-E182DAF6-282B-4C1F-8CCF-0A61008E3F11__GUID-6BB43188-865A-4AE4-A600-24412287822E">使用@Deprecated注释</p>
                     <p>要表明已弃用，请在模块，类，方法或成员声明之前加上<span class="apiname">@Deprecated</span> 。批注包含以下元素：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><span class="apiname">@Deprecated（since =“</span> <code class="codeph"><span class="codeinlineitalic"><version></span></code> <span class="apiname">”）</span></p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="italic"><version></version></span>是API弃用的版本。这仅供参考。默认为空字符串（ <code class="codeph">"</code><code class="codeph">"</code> ）。
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p><span class="apiname">@Deprecated（forRemoval =</span> <code class="codeph"><span class="codeinlineitalic"><boolean></span></code> <span class="apiname">）</span></p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p><span class="apiname">forRemoval = true</span>表示该API将在将来的版本中删除。
                                 </p>
                              </li>
                              <li>
                                 <p><span class="apiname">forRemoval = false</span>建议代码不应再使用此API。但是，目前没有删除该API的意图。这是默认值。
                                 </p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <p>例如： <span class="apiname">@Deprecated（since =“ 9”，forRemoval = true）</span></p>
                     <div class="p"><span class="apiname">@Deprecated</span>注释使Javadoc生成的文档在出现该程序元素的任何位置都被标记为以下内容之一：<ul style="list-style-type:disc">
                           <li>
                              <p><span class="bold">不推荐使用。</span></p>
                           </li>
                           <li>
                              <p><span class="bold">不推荐使用，以便删除：此API元素可能会在将来的版本中删除。</span></p>
                           </li>
                        </ul>
                     </div>
                     <p>的<code class="codeph">javadoc</code>工具生成一个名为<code>deprecated-list.html</code>其中包含已弃用的API列表，并在导航栏中添加了指向该页面的链接。
                     </p>
                     <p>以下是使用<span class="apiname">java.lang中 <span class="apiname">@Deprecated</span>批注的简单示例<span class="apiname">。线程</span>类：</span></p><pre class="pre codeblock"><code>public class Thread implements Runnable {
	... 
	@Deprecated(since="1.2")
	public final void stop() {
		...
	}
	...</code></pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-E182DAF6-282B-4C1F-8CCF-0A61008E3F11__GUID-A436F32E-3553-48C7-B37B-7BCCAC4E4B47">折旧的语义</p>
                     <p><span class="apiname">@Deprecated</span>批注的两个元素使开发人员有机会阐明弃用对其导出的API意味着什么。</p>
                     <div class="p">对于JDK平台：<ul style="list-style-type:disc">
                           <li>
                              <p><span class="apiname">@Deprecated（forRemoval = true）</span>表示该API有资格在将来的JDK平台版本中删除。
                              </p>
                           </li>
                           <li>
                              <p><span class="apiname">@Deprecated（since =“</span> <code class="codeph"><span class="codeinlineitalic"><version></span></code> <span class="apiname">”）</span>包含JDK版本字符串，该字符串指示何时在JDK 9及更高版本中弃用了API元素。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <p>如果维护库并产生自己的API，则可能使用<span class="apiname">@Deprecated</span>批注。您应该确定并传达有关删除API的政策。例如，如果您每隔6周发布一次新库，则可以选择弃用要删除的API，但要在几个月后才删除它，才能使客户有时间进行迁移。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-E182DAF6-282B-4C1F-8CCF-0A61008E3F11__GUID-47F5AA2E-7ED7-425A-B07D-B419E29715FD">使用@deprecated Javadoc标记</p>
                     <p>在任何不赞成使用的程序元素的javadoc注释中使用<span class="apiname">@deprecated</span>标记表示不应再使用它（即使它可能继续起作用）。该标记在所有类，方法或字段文档注释中均有效。<span class="apiname">@deprecated</span>标记后必须带有空格或换行符。在<span class="apiname">@deprecated</span>标记后面的<span class="apiname">段落中</span> ，说明为什么不推荐使用该项目，并建议使用什么代替。用<span class="apiname">@link</span>标记标记引用相同功能新版本的文本。
                     </p>
                     <div class="p">当遇到<span class="apiname">@deprecated</span>标记时， <code class="codeph">javadoc</code>工具将<span class="apiname">@deprecated</span>标记之后的文本移动到描述的前面，并在其前面加上警告。例如，此源：<pre class="pre codeblock"><code>  /**
   * ...
   * @deprecated  This method does not properly convert bytes into
   * characters.  As of JDK&nbsp;1.1, the preferred way to do this is via the
   * {@code String} constructors that take a {@link
   * java.nio.charset.Charset}, charset name, or that use the platform's
   * default charset.
   * ...
   */
   @Deprecated(since="1.1")
   public String(byte ascii[], int hibyte) {
      ...
</code></pre></div>
                     <p>生成以下输出：</p><pre class="pre codeblock"><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/Deprecated.html" target="_blank">@Deprecated</a>(<a href="https://docs.oracle.com/javase/10/docs/api/java/lang/Deprecated.html#since--" target="_blank">since</a>="1.1")
public&nbsp;String​(byte[]&nbsp;ascii, 
              int&nbsp;hibyte)
<span class="bold">Deprecated.</span> This method does not properly convert bytes into characters. As of 
JDK&nbsp;1.1, the preferred way to do this is via the <span class="bold">String</span> constructors that take a 
<a href="https://docs.oracle.com/javase/10/docs/api/java/nio/charset/Charset.html" target="_blank">Charset</a>, charset name, or that use the platform's default charset.</code></pre><p>如果您使用<span class="apiname">@deprecated</span> Javadoc标记而没有相应的<span class="apiname">@Deprecated</span>批注，则会生成警告。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-97A6BB09-6F7D-4ED0-BF53-22D40757B0B2" name="GUID-97A6BB09-6F7D-4ED0-BF53-22D40757B0B2"></a><h3 id="JSCOR-GUID-97A6BB09-6F7D-4ED0-BF53-22D40757B0B2" class="sect3">通知和警告</h3>
               <div>
                  <p>不建议使用API时，必须通知开发人员。不建议使用的API可能会在您的代码中引起问题，或者，如果最终将其删除，则会在运行时导致失败。</p>
                  <p>Java编译器会生成有关已弃用的API的警告。有一些选项可以生成有关警告的更多信息，您也可以禁止不赞成使用的警告。</p>
                  <div class="section">
                     <p class="subhead2" id="GUID-97A6BB09-6F7D-4ED0-BF53-22D40757B0B2__GUID-BB4D07CD-36FB-4032-8EAE-DE14765C266B">编译器弃用警告</p>
                     <p>如果弃用是<code class="codeph">forRemoval=false</code> ，Java编译器会生成<span class="q">“常规弃用警告”</span> 。如果弃用是<code class="codeph">forRemoval=true</code> ，编译器会生成<span class="q">“删除警告”</span> 。
                     </p>
                     <p>两种警告分别控制<code class="codeph">-Xlint</code>标志： <code class="codeph">-Xlint:deprecation</code>和<code class="codeph">-Xlint:removal</code> 。的<code class="codeph">javac -Xlint:removal</code>该选项默认情况下处于启用状态，因此显示删除警告。
                     </p>
                     <p></p>
                     <p>警告也可以单独关闭（注意<span class="q">“ –”</span> ）： <code class="codeph">-Xlint:-deprecation</code>和<code class="codeph">-Xlint:-removal</code> 。
                     </p>
                     <p>这是普通弃用警告的示例。</p><pre class="pre codeblock"><code>$ <span class="bold">javac src/example/DeprecationExample.java</span>	
Note: src/example/DeprecationExample.java uses or overrides a deprecated API.	
Note: Recompile with -Xlint:deprecation for details.	
</code></pre><p>使用<code class="codeph">javac -Xlint:deprecation</code>选项以查看不推荐使用的API。
                     </p><pre class="pre codeblock"><code>$ <span class="bold">javac -Xlint:deprecation src/example/DeprecationExample.java</span>	
src/example/DeprecationExample.java:12: warning: [deprecation] getSelectedValues() in JList has been deprecated	
   Object[] values = jlist.getSelectedValues();	
                     ^	
1 warning	</code></pre><p>这是删除警告的示例。</p><pre class="pre codeblock"><code>public class RemovalExample {
    public static void main(String[] args) {
        System.runFinalizersOnExit(true);
    }
}
$ <span class="bold">javac RemovalExample.java
</span>RemovalExample.java:3: warning: [removal] runFinalizersOnExit(boolean) in System 
has been deprecated and marked for removal
        System.runFinalizersOnExit(true);
              ^
1 warning
==========</code></pre></div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-97A6BB09-6F7D-4ED0-BF53-22D40757B0B2__GUID-79034A97-AC3B-478C-BB08-68231E917364">禁止弃用警告</p>
                     <p>的<code class="codeph">javac -Xlint</code>选项控制在特定运行中编译的所有文件的警告<code class="codeph">javac</code> 。您可能已经在源代码中标识了特定位置，这些特定位置会生成不再希望看到的警告。您可以使用<code class="codeph">@SuppressWarnings</code>注释，用于在编译代码时禁止显示警告。放置<code class="codeph">@SuppressWarnings</code>使用不推荐使用的API的类，方法，字段或局部变量的声明处的注释。</p>
                     <div class="p">的<code class="codeph">@SuppressWarnings</code>选项是：<ul style="list-style-type:disc">
                           <li>
                              <p><span class="apiname">@SuppressWarnings（“ deprecation”）</span> —仅禁止普通的不赞成使用警告。
                              </p>
                           </li>
                           <li>
                              <p><span class="apiname">@SuppressWarnings（“ removal”）</span> -仅禁止删除警告。
                              </p>
                           </li>
                           <li>
                              <p><span class="apiname">@SuppressWarnings（{“ deprecation”，“ removal”}）</span> -禁止两种类型的警告。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <p>这是禁止警告的示例。</p><pre class="pre codeblock"><code>   @SuppressWarnings("deprecation")
   Object[] values = jlist.getSelectedValues();</code></pre><p>随着<code class="codeph">@SuppressWarnings</code>注解，即使在命令行上启用了警告，也不会对此行发出警告。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-F0CD4B54-CD8A-4153-87F9-7E7481F9AAFC" name="GUID-F0CD4B54-CD8A-4153-87F9-7E7481F9AAFC"></a><h3 id="JSCOR-GUID-F0CD4B54-CD8A-4153-87F9-7E7481F9AAFC" class="sect3">运行jdeprscan</h3>
               <div>
                  <p><code class="codeph">jdeprscan</code>是一种静态分析工具，它报告应用程序对已弃用的JDK API元素的使用情况。跑<code class="codeph">jdeprscan</code>帮助识别编译的类文件或jar文件中的可能问题。
                  </p>
                  <p>您可以从编译器通知中找到不赞成使用的JDK API。但是，如果您不重新编译每个JDK版本，或者警告被抑制，或者您依赖作为二进制工件分发的第三方库，则应运行<code class="codeph">jdeprscan</code> 。
                  </p>
                  <p>在从JDK中删除API之前，发现对不赞成使用的API的依赖性很重要。如果该二进制文件使用了在当前JDK版本中不建议删除的API，并且您没有重新编译，那么您将不会收到任何通知。在将来的JDK版本中删除API时，二进制文件将在运行时完全失败。 <code class="codeph">jdeprscan</code>现在，您可以在删除API之前检测到这种用法。
                  </p>
                  <p>有关如何运行该工具以及如何解释输出的完整语法，请参见<code class="codeph"><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/java/javase/11/core&id=JSWOR-GUID-2B7588B0-92DB-4A88-88D4-24D183660A62" target="_blank">jdeprscan</a></code>在<span><cite>Java平台标准版工具参考中</cite></span> 。
                  </p>
               </div>
            </div>
         </div>
      </article>
   

</body></html>