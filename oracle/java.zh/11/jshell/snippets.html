<html lang="en-us"  xml:lang="en-us"><head></head><body >﻿
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="JShell accepts Java statements; variable, method, and class definitions; imports; and expressions. These pieces of Java code are referred to as snippets.">
      <meta name="description" content="JShell accepts Java statements; variable, method, and class definitions; imports; and expressions. These pieces of Java code are referred to as snippets.">
      <title>片段</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Java Shell User’s Guide">
      <meta property="og:description" content="JShell accepts Java statements; variable, method, and class definitions; imports; and expressions. These pieces of Java code are referred to as snippets.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Java Shell User’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="java-shell-user-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-09-20T08:11:45-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2017, 2018">
      <meta name="dcterms.category" content="java">
      <meta name="dcterms.identifier" content="E94826-01">
      
      <meta name="dcterms.product" content="en/java/javase/11">
      <meta name="dcterms.release" content="11">
      <link rel="prev" href="introduction-jshell.html" title="Previous" type="text/html">
      <link rel="next" href="commands.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"java","element_name":"Java","display_in_url":true},"suite":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product_group":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product":{"short_name":"javase","element_name":"Java SE","display_in_url":true},"release":{"short_name":"11","element_name":"11","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Java Shell User Guide">
    <meta name="dcterms.isVersionOf" content="JSHELL">
  <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script>
   
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="introduction-jshell.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一个</a> <a href="commands.html" class="pull-right">下一个<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Java Shell用户指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">片段</li>
            </ol>
            <a id="GUID-064E541A-911A-4BA6-BE2F-B03818FB8F6A" name="GUID-064E541A-911A-4BA6-BE2F-B03818FB8F6A"></a>
            
            <h2 id="JSHEL-GUID-064E541A-911A-4BA6-BE2F-B03818FB8F6A" class="sect2"><span class="enumeration_chapter">2个</span>摘要</h2>
         </header>
         <div class="ind">
            <div>
               <p>JShell接受Java语句；变量，方法和类定义；进口；和表情。这些Java代码片段称为代码段。</p>
               <div class="section">
                  <p class="subhead1" id="GUID-064E541A-911A-4BA6-BE2F-B03818FB8F6A__GUID-89ED625B-9F4A-4FFE-A3E7-37D5FD890A31">话题</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p><a href="snippets.html#GUID-91924322-1F68-4E47-9AC6-CAD8A3114E21" title="Java代码段被输入到JShell中并立即进行评估。显示有关结果，执行的操作以及发生的任何错误的反馈。使用本节中的示例尝试JShell。">试用片段</a></p>
                     </li>
                     <li>
                        <p><a href="snippets.html#GUID-614373AD-8D94-462A-B05E-DFA35DF098C9" title="在尝试代码时，您可能会发现变量，方法或类的定义没有按照您想要的去做。通过输入一个新的定义即可轻松更改该定义，该新定义将覆盖先前的定义。">改变定义</a></p>
                     </li>
                     <li>
                        <p><a href="snippets.html#GUID-DA21BC6E-9C07-4C67-842F-BEEC7B8FF85F" title="JShell接受引用尚未定义的方法，变量或类的方法定义。这样做是为了支持探索性编程，并且因为某些形式的编程需要它。">前向参考</a></p>
                     </li>
                     <li>
                        <p><a href="snippets.html#GUID-C265A167-24D4-435D-998F-230BD0E32149" title="在异常回溯中，反馈标识代码段以及代码段内发生异常的位置。">例外情况</a></p>
                     </li>
                     <li>
                        <p><a href="snippets.html#GUID-E24D9E84-C9E3-43DE-B14D-C9544A35E5FC" title="输入摘录时，请使用Tab键自动完成项目。如果根据输入的内容无法确定该项目，则提供可能的选项。">片段的选项卡完成</a></p>
                     </li>
                     <li>
                        <p><a href="snippets.html#GUID-63DBC3E7-6EF2-498D-8638-94867ED10F76" title="使用JShell可以轻松在首次引用所需类时将其导入，并使用键盘快捷键将表达式转换为变量声明。">摘要转换</a></p>
                     </li>
                  </ul>
               </div>
               <!-- class="section" -->
            </div>
            <div class="sect2"><a id="GUID-91924322-1F68-4E47-9AC6-CAD8A3114E21" name="GUID-91924322-1F68-4E47-9AC6-CAD8A3114E21"></a><h3 id="JSHEL-GUID-91924322-1F68-4E47-9AC6-CAD8A3114E21" class="sect3">试用片段</h3>
               <div>
                  <p>Java代码段被输入到JShell中并立即进行评估。显示有关结果，执行的操作以及发生的任何错误的反馈。使用本节中的示例尝试JShell。</p>
                  <p>使用verbose选项启动JShell以获得最大数量的可用反馈：</p><pre class="pre codeblock"><code>% <span class="bold">jshell -v</span>
|  Welcome to JShell -- Version 9
|  For an introduction type: /help intro</code></pre><p>在提示符下输入以下示例语句，并查看显示的输出：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">int x = 45</span>
x ==&gt; 45
|  created variable x : int</code></pre><p>首先，显示结果。读为：变量x的值为45。因为您处于详细模式，所以还会显示发生的情况的描述。信息性消息以竖线开头。请注意，同时显示了所创建变量的名称和类型。</p>
                  <div class="infoboxnote" id="GUID-91924322-1F68-4E47-9AC6-CAD8A3114E21__GUID-7DF90061-90F3-43F8-BAEB-D8203CCA39F7">
                     <p class="notep1">注意：</p>如果未输入，则将终止分号自动添加到完整代码段的末尾。
                  </div>
                  <p>输入不带命名变量的表达式时，将创建一个暂存变量，以便以后可以引用该值。以下示例显示了表达式和方法结果的暂存值。该示例还显示了继续提示（ <code class="codeph">...></code> ）在摘要需要多于一行输入才能完成时使用：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">2 + 2</span>
$3 ==&gt; 4
|  created scratch variable $3 : int

jshell&gt; <span class="bold">String twice(String s) {</span>
   ...&gt; <span class="bold">   return s + s;</span>
   ...&gt; <span class="bold">}</span>
|  created method twice(String)

jshell&gt; <span class="bold">twice("Ocean")</span>
$5 ==&gt; "OceanOcean"
|  created scratch variable $5 : String</code></pre></div>
            </div>
            <div class="sect2"><a id="GUID-614373AD-8D94-462A-B05E-DFA35DF098C9" name="GUID-614373AD-8D94-462A-B05E-DFA35DF098C9"></a><h3 id="JSHEL-GUID-614373AD-8D94-462A-B05E-DFA35DF098C9" class="sect3">改变定义</h3>
               <div>
                  <p>在尝试代码时，您可能会发现变量，方法或类的定义没有按照您想要的去做。通过输入一个新的定义即可轻松更改该定义，该新定义将覆盖先前的定义。</p>
                  <p>要更改变量，方法或类的定义，只需输入一个新定义。例如， <code class="codeph">twice</code>在下面的示例中，“ <a href="snippets.html#GUID-91924322-1F68-4E47-9AC6-CAD8A3114E21" title="Java代码段被输入到JShell中并立即进行评估。显示有关结果，执行的操作以及发生的任何错误的反馈。使用本节中的示例尝试JShell。">尝试片段”中</a>定义的方法将获得新的定义：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">String twice(String s) {</span>
   ...&gt; <span class="bold">   return "Twice:" + s;</span>
   ...&gt; <span class="bold">}</span>
|  modified method twice(String)

jshell&gt; <span class="bold">twice("thing")</span>
$7 ==&gt; "Twice:thing"
|  created scratch variable $7 : String</code></pre><p>请注意，与其显示<samp class="sysout">created method</samp>和以前一样，反馈显示<samp class="sysout">modified method</samp> 。此消息表示定义已更改，但是该方法具有相同的签名，因此所有现有用法继续有效。
                  </p>
                  <p>您也可以以不兼容的方式更改定义。以下示例显示<code class="codeph">x</code>从改变<code class="codeph">int</code>到<span class="apiname">字符串</span> ：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">int x = 45</span>
x ==&gt; 45
|  created variable x : int

jshell&gt; <span class="bold">String x</span>
x ==&gt; null
|  replaced variable x : String
|    update overwrote variable x : int</code></pre><p>变量的类型<code class="codeph">x</code>更改，现在反馈显示<samp class="sysout">replaced</samp> 。
                  </p>
                  <div class="section">
                     <p class="subhead2" id="GUID-614373AD-8D94-462A-B05E-DFA35DF098C9__GUID-576D0DA3-FC1B-4BFC-81C0-0D2DFF370C52">改变反馈水平</p>
                     <p>JShell是在详细反馈模式下启动的，该模式提供了大量注释。您可以使用以下命令设置输出的数量和格式<code class="codeph">/set feedback</code>命令，例如<code class="codeph">/set feedback concise</code> 。如果您主要是通过从其他窗口进行粘贴来使用JShell，那么您可能更喜欢没有提示且仅错误反馈的反馈模式。如果是这样，则输入<code class="codeph">/set feedback silent</code>命令。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-DA21BC6E-9C07-4C67-842F-BEEC7B8FF85F" name="GUID-DA21BC6E-9C07-4C67-842F-BEEC7B8FF85F"></a><h3 id="JSHEL-GUID-DA21BC6E-9C07-4C67-842F-BEEC7B8FF85F" class="sect3">前向参考</h3>
               <div>
                  <p>JShell接受引用尚未定义的方法，变量或类的方法定义。这样做是为了支持探索性编程，并且因为某些形式的编程需要它。</p>
                  <p>例如，如果要定义球体体积的方法，则可以输入以下公式作为方法<code class="codeph">volume</code> ：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">double volume(double radius) {</span>
   ...&gt; <span class="bold">   return 4.0 / 3.0 * PI * cube(radius);</span>
   ...&gt; <span class="bold">}</span>
|  created method volume(double), however, it cannot be invoked until variable PI, and method cube(double) are declared</code></pre><p>JShell允许定义，但警告尚未定义的内容。可以引用该定义，但是如果尝试执行，那么它将失败，直到定义了所有必需的元素：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">double PI = 3.1415926535</span>
PI ==&gt; 3.1415926535
|  created variable PI : double

jshell&gt; <span class="bold">volume(2)</span>
|  attempted to call method volume(double) which cannot be invoked until method cube(double) is declared

jshell&gt; <span class="bold">double cube(double x) { return x * x * x; }</span>
|  created method cube(double)
|    update modified method volume(double)

jshell&gt; <span class="bold">volume(2)</span>
$5 ==&gt; 33.510321637333334
|  created scratch variable $5 : double</code></pre><p>有了所有定义后， <code class="codeph">volume</code>该方法现在有效。
                  </p>
                  <p>现在，此方法用于说明有关不兼容替换的更多信息。例如，更改精度<code class="codeph">PI</code> ，输入新值，如以下示例所示：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">BigDecimal PI = new BigDecimal("3.141592653589793238462643383")</span>
PI ==&gt; 3.141592653589793238462643383
|  replaced variable PI : BigDecimal
|    update modified method volume(double) which cannot be invoked until this error is corrected: 
|      bad operand types for binary operator '*'
|        first type:  double
|        second type: java.math.BigDecimal
|          return 4.0 / 3.0 * PI * cube(radius);
|                 ^------------^
|    update overwrote variable PI : double</code></pre><p>的新定义<code class="codeph">PI</code>与以下类型的定义不兼容<code class="codeph">volume()</code> 。因为您处于详细模式，所以会显示受更改影响的其他定义的更新信息，在这种情况下，描述将描述不兼容。请注意，详细模式是唯一显示更新信息的预定义反馈模式。在其他反馈模式下，直到执行代码，才会显示警告。这样做的目的是防止更新过载。在所有预定义模式下，执行<code class="codeph">volume()</code>方法显示问题：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">volume(2)</span>
|  attempted to call method volume(double) which cannot be invoked until this error is corrected: 
|      bad operand types for binary operator '*'
|        first type:  double
|        second type: java.math.BigDecimal
|          return 4.0 / 3.0 * PI * cube(radius);
|                 ^------------^</code></pre></div>
            </div>
            <div class="sect2"><a id="GUID-C265A167-24D4-435D-998F-230BD0E32149" name="GUID-C265A167-24D4-435D-998F-230BD0E32149"></a><h3 id="JSHEL-GUID-C265A167-24D4-435D-998F-230BD0E32149" class="sect3">例外情况</h3>
               <div>
                  <p>在异常回溯中，反馈标识代码段以及代码段内发生异常的位置。</p>
                  <p>输入到JShell中的代码中的位置显示为<code class="codeph">#<span class="variable" translate="no">ID</span>:<span class="variable" translate="no">line-number</span></code> ，其中代码段<span class="variable" translate="no">ID</span>是由<code class="codeph">/list</code>命令，而<span class="variable" translate="no">line-number</span>是代码段内的行号。在以下示例中，片段1中发生了异常，即<code class="codeph">divide()</code>方法，方法的第二行：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">int divide(int x, int y) {</span>
   ...&gt; <span class="bold">return x / y;</span>
   ...&gt; <span class="bold">}</span>
|  created method divide(int,int)

jshell&gt; <span class="bold">divide(5, 0)</span>
|  java.lang.ArithmeticException thrown: / by zero
|        at divide (#1:2)
|        at (#2:1)
                             
jshell&gt; <span class="bold">/list</span>
                                                            
   1 : int divide(int x, int y) {
           return x / y;
       }
   2 : divide(5, 0)</code></pre></div>
            </div>
            <div class="sect2"><a id="GUID-E24D9E84-C9E3-43DE-B14D-C9544A35E5FC" name="GUID-E24D9E84-C9E3-43DE-B14D-C9544A35E5FC"></a><h3 id="JSHEL-GUID-E24D9E84-C9E3-43DE-B14D-C9544A35E5FC" class="sect3">片段的选项卡完成</h3>
               <div>
                  <p>输入摘录时，请使用Tab键自动完成项目。如果根据输入的内容无法确定该项目，则提供可能的选项。</p>
                  <p>例如，如果您输入了<code class="codeph">volume</code> “ <a href="snippets.html#GUID-DA21BC6E-9C07-4C67-842F-BEEC7B8FF85F" title="JShell接受引用尚未定义的方法，变量或类的方法定义。这样做是为了支持探索性编程，并且因为某些形式的编程需要它。">前向引用”中的“</a>方法”，然后可以输入方法名称的前几个字母，然后按Tab键完成输入：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">vol&lt;Tab&gt;</span></code></pre><p>输入更改为以下内容：</p><pre class="pre codeblock"><code>jshell&gt; volume(</code></pre><p>如果可以通过多种方式完成该项目，则会显示一组可能性：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">System.c&lt;Tab&gt;</span>
class                 clearProperty(        console()             currentTimeMillis()

jshell&gt; System.c</code></pre><p>任何常用字符都会添加到您输入的内容中，并且光标会位于输入的末尾，以便可以输入更多内容。</p>
                  <p>当您在方法调用的打开括号中时，按Tab键可显示参数类型的完成可能性：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">"hello".startsWith(&lt;Tab&gt;</span>
Signatures:
boolean String.startsWith(String prefix, int toffset)
boolean String.startsWith(String prefix)

&lt;press tab again to see documentation&gt;

jshell&gt; "hello".startsWith(</code></pre><p>再次按Tab键将显示第一种方法的文档的纯文本版本。</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">"hello".startsWith(&lt;Tab&gt;</span>
boolean String.startsWith(String prefix, int toffset)
Tests if the substring of this string beginning at the specified index starts with the
specified prefix.

Parameters:
prefix - the prefix.
toffset - where to begin looking in this string.

Returns:
true if the character sequence represented by the argument is a prefix of the substring of this
          object starting at index toffset ; false otherwise. The result is false if toffset is
          negative or greater than the length of this String object; otherwise the result is
          the same as the result of the expression
                    this.substring(toffset).startsWith(prefix)
                    

&lt;press tab to see next documentation&gt;

jshell&gt; "hello".startsWith(</code></pre></div>
            </div>
            <div class="sect2"><a id="GUID-63DBC3E7-6EF2-498D-8638-94867ED10F76" name="GUID-63DBC3E7-6EF2-498D-8638-94867ED10F76"></a><h3 id="JSHEL-GUID-63DBC3E7-6EF2-498D-8638-94867ED10F76" class="sect3">摘要转换</h3>
               <div>
                  <p>使用JShell可以轻松在首次引用所需类时将其导入，并使用键盘快捷键将表达式转换为变量声明。</p>
                  <p>输入尚未导入的标识符时，请在标识符后立即按Shift + Tab i，以查看使您可以将导入添加到会话中的选项：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">new JFrame&lt;Shift+Tab i&gt;</span>
0: Do nothing
1: import: javax.swing.JFrame
Choice: <span class="bold">1</span>
Imported: javax.swing.JFrame

jshell&gt; new JFrame</code></pre><p>输入所需选项的编号。可以提供多个导入选项。</p>
                  <p>输入表达式后，可以通过按Shift + Tab v将表达式转换为变量声明。表达式成为变量声明的初始值，表达式的类型成为变量的类型。在按下Shift + Tab v之后，将光标（在示例中以竖线（|）表示）放置在需要输入变量名称的行中：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">new JFrame("Demo") &lt;Shift+Tab v&gt;</span>
jshell&gt; JFrame | = new JFrame("Demo")</code></pre><div class="infoboxnote" id="GUID-63DBC3E7-6EF2-498D-8638-94867ED10F76__GUID-22780893-96F3-4070-9A63-F1B77DCDF47D">
                     <p class="notep1">注意：</p>该表达式必须有效，否则转换请求将被忽略。在此示例中，在变量转换之前需要导入<span class="apiname">JFrame</span> 。
                  </div>
                  <p>要完成前面的示例，请输入变量名称<kbd class="userinput">frame</kbd>在光标处，然后按Enter：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">JFrame frame = new JFrame("Demo")</span>
frame ==&gt; javax.swing.JFrame[frame0,0,0,0x0,invalid,hidden, ... tPaneCheckingEnabled=true]
|  created variable frame : JFrame

jshell&gt;</code></pre><p>有时表达式的结果类型尚未导入。在这种情况下，Shift + Tab v可以导入和创建变量，如以下示例所示：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">frame.getGraphics() &lt;Shift+Tab v&gt;</span>
0: Do nothing
1: Create variable
2: import: java.awt.Graphics. Create variable
Choice: <span class="bold">2</span>
Imported: java.awt.Graphics

jshell&gt; Graphics | = frame.getGraphics()</code></pre><p>要完成前面的示例，请输入变量名称<kbd class="userinput">gc</kbd>在光标处，然后按Enter：</p><pre class="pre codeblock"><code>jshell&gt; <span class="bold">Graphics gc = frame.getGraphics()</span>
|  created variable gc : JFrame

jshell&gt;</code></pre></div>
            </div>
         </div>
      </article>
   

</body></html>