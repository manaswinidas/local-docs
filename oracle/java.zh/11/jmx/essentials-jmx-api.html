<html lang="en-us"  xml:lang="en-us"><head></head><body >﻿
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>JMX API的要点</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Java Management Extensions Guide">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Java Management Extensions Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="java-management-extensions-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-09-20T10:06:58-07:00">
      <meta name="dcterms.title" content="Java Management Extensions Guide">
      <meta name="dcterms.dateCopyrighted" content="1993, 2018">
      <meta name="dcterms.category" content="java">
      <meta name="dcterms.identifier" content="E95075-01">
      
      <meta name="dcterms.product" content="en/java/javase/11">
      <meta name="dcterms.release" content="11">
      <link rel="prev" href="getting-started.html" title="Previous" type="text/html">
      <link rel="next" href="jmx-connectors.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"java","element_name":"Java","display_in_url":true},"suite":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product_group":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product":{"short_name":"javase","element_name":"Java SE","display_in_url":true},"release":{"short_name":"11","element_name":"11","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="JMX">
  <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script>
   
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="getting-started.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一个</a> <a href="jmx-connectors.html" class="pull-right">下一个<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Java管理扩展指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="java-management-extensions-jmx-technology-tutorial.html" property="item" typeof="WebPage"><span property="name">Java管理扩展（JMX）技术教程</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">JMX API的要点</li>
            </ol>
            <a id="GUID-DED0E9DB-8ABE-41D1-A3A7-BA7EDB377AE5" name="GUID-DED0E9DB-8ABE-41D1-A3A7-BA7EDB377AE5"></a>
            
            <h2 id="JSJMX-GUID-DED0E9DB-8ABE-41D1-A3A7-BA7EDB377AE5" class="sect2">JMX API的<span class="enumeration_chapter">10个</span>要点</h2>
         </header>
         <div class="ind">
            <div>
               <p>本章介绍了托管bean（MBean），它们是Java Management Extensions（JMX）API的核心组件。</p>
               <p><span class="italic">MBean</span>是类似于JavaBean <sup>TM</sup>的托管Java对象，它遵循JMX规范的工具级别中提出的设计模式。MBean可以代表设备，应用程序或任何受管理的资源。MBean公开了一个管理界面，该界面是一组可读和/或可写的属性以及一组可调用的操作以及一个自我描述。在MBean实例的整个生命周期中，管理界面都不会更改。当某些定义的事件发生时，MBean也可以发出通知。
               </p>
               <p>JMX规范定义了四种类型的MBean： <span class="italic">标准MBean</span> ， <span class="italic">动态MBean</span> ， <span class="italic">开放MBean</span>和<span class="italic">模型MBean</span> 。本教程中的示例演示了最简单的MBean类型，即标准MBean。
               </p>
            </div>
            <div class="sect2"><a id="GUID-A7621810-656C-46D2-B06E-029F2B8662A6" name="GUID-A7621810-656C-46D2-B06E-029F2B8662A6"></a><h3 id="JSJMX-GUID-A7621810-656C-46D2-B06E-029F2B8662A6" class="sect3">标准MBean</h3>
               <div>
                  <p>您可以通过编写一个名为Java的接口来定义标准的MBean。 <code class="codeph">SomethingMBean</code>还有一个叫做<code class="codeph">Something</code>实现该接口。接口中的每个方法都定义MBean中的属性或操作。默认情况下，每个方法都定义一个操作。属性和操作只是遵循某些设计模式的简单方法。一个标准的MBean由MBean接口（列出所有公开的属性和操作的方法）以及实现该接口并提供所检测资源的功能的类组成。
                  </p>
                  <p>以下各节描述了示例标准MBean和管理MBean的简单JMX代理。<a href="jmx-essentials-example.html">JMX Essentials</a>中提供了代码示例。您可以从目录运行示例<code class="codeph"><span class="variable" translate="no">work_dir</span>/jmx_examples/Essential/com/example/mbeans.</code></p>
               </div>
               <div class="sect3"><a id="GUID-27D7C6DF-DFA2-49BF-AF5A-C1D8172CC32C" name="GUID-27D7C6DF-DFA2-49BF-AF5A-C1D8172CC32C"></a><h4 id="JSJMX-GUID-27D7C6DF-DFA2-49BF-AF5A-C1D8172CC32C" class="sect4">MBean接口</h4>
                  <div>
                     <p>基本MBean接口的示例，名为<code class="codeph">HelloMBean</code>在<span class="bold">代码示例2-1示例MBean接口HelloMBean中显示</span> 。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-27D7C6DF-DFA2-49BF-AF5A-C1D8172CC32C__GUID-DAB16CE1-B5BF-455E-A236-F3D2BD8AB4AE">代码示例2-1 MBean接口HelloMBean</p><pre class="pre codeblock"><code>
 
package com.example.mbeans; 
 
public interface HelloMBean { 
 
    public void sayHello(); 
    public int add(int x, int y); 
 
    public String getName(); 
 
    public int getCacheSize(); 
    public void setCacheSize(int size); 
} 
 
</code></pre><p>MBean接口采用实现它的Java类的名称，并添加了后缀<span class="italic">MBean</span> 。该接口称为<code class="codeph">HelloMBean</code> 。的<code class="codeph">Hello</code> <a href="essentials-jmx-api.html#GUID-215E9966-9BF6-4201-848A-FE860BDF3DAD">MBean实现中</a>描述了实现此接口的类。
                        </p>
                        <p>根据JMX规范，MBean接口由可读且可能可写的命名和类型属性以及可以由MBean管理的应用程序调用的命名和类型操作组成。的<code class="codeph">HelloMBean</code> <span class="bold">代码示例2-1中</span>所示的接口<span class="bold">MBean接口HelloMBean</span>声明了两个操作：Java方法<code class="codeph">add()</code>和<code class="codeph">sayHello()</code> 。
                        </p>
                        <p>由声明的两个属性中<code class="codeph">HelloMbean</code> ， <code class="codeph">Name</code>是只读字符串，并且<code class="codeph">CacheSize</code>是可以读取和写入的整数。声明了<span class="italic">Getter</span>和<span class="italic">setter</span>方法，以允许托管应用程序访问并可能更改属性值。根据JMX规范的定义，getter是任何名称以<span class="italic">get</span>开头且不返回void的公共方法。使用getter，经理可以读取属性的值，该属性的类型为返回对象的类型。设置器是任何名称以<span class="italic">set</span>开头且带有单个参数的公共方法。设置器使管理员可以在属性中写入新值，该属性的类型与参数的类型相同。
                        </p>
                        <p>这些操作和属性的实现在以下部分中显示。</p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-215E9966-9BF6-4201-848A-FE860BDF3DAD" name="GUID-215E9966-9BF6-4201-848A-FE860BDF3DAD"></a><h4 id="JSJMX-GUID-215E9966-9BF6-4201-848A-FE860BDF3DAD" class="sect4">MBean实施</h4>
                  <div>
                     <p>的<code class="codeph">Hello</code> <span class="bold">代码示例2-2中</span>所示的<span class="bold">MBean实现类，Hello</span>实现<code class="codeph">HelloMBean</code> 。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-215E9966-9BF6-4201-848A-FE860BDF3DAD__GUID-DE953F05-5FD3-4EF5-B7EB-B16388222B54">代码示例2-2 MBean实现类，您好</p><pre class="pre codeblock"><code>
 
package com.example.mbeans; 
 
public class Hello implements HelloMBean { 
    public void sayHello() { 
        System.out.println("hello, world"); 
    } 
 
    public int add(int x, int y) { 
        return x + y; 
    } 
 
    public String getName() { 
        return this.name; 
    } 
 
 
    public int getCacheSize() { 
        return this.cacheSize; 
    } 
 
    public synchronized void setCacheSize(int size) { 
        this.cacheSize = size; 
 
        System.out.println("Cache size now " + this.cacheSize); 
    } 
 
    private final String name = "Reginald"; 
    private int cacheSize = DEFAULT_CACHE_SIZE; 
    private static final int DEFAULT_CACHE_SIZE = 200; 
} 
 
</code></pre><p>在示例2-2中，Java类<code class="codeph">Hello</code>提供由声明的操作和属性的定义<code class="codeph">HelloMBean</code> 。如您所见，该示例<code class="codeph">sayHello()</code>和<code class="codeph">add()</code>操作非常简单，但是现实生活中的操作可以随意，也可以任意复杂。
                        </p>
                        <p>获得方法<code class="codeph">Name</code>属性并获取并设置<code class="codeph">cacheSize</code>属性也被定义。在此示例中， <code class="codeph">Name</code>属性值永远不会改变，但是在实际情况下，它可能会随着托管资源的运行而改变。例如，该属性可能表示统计信息，例如正常运行时间或内存使用情况。在这里，它只是名字“ Reginald”。
                        </p>
                        <p>呼叫<code class="codeph">setCacheSize</code>方法允许您更改<code class="codeph">cacheSize</code>属性从其声明的默认值200开始。实际上，改变<code class="codeph">cacheSize</code>属性可能需要执行其他操作，例如丢弃条目或分配新条目。本示例仅打印一条消息以确认缓存大小已更改，但是您可以在调用的地方定义更复杂的操作。 <code class="codeph">println()</code> 。
                        </p>
                        <p>随着<code class="codeph">Hello</code>定义了MBean及其接口，它们可用于管理它们表示的资源，如以下部分所示。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-FA3724F5-9E67-4002-82BE-B05716E902C3" name="GUID-FA3724F5-9E67-4002-82BE-B05716E902C3"></a><h4 id="JSJMX-GUID-FA3724F5-9E67-4002-82BE-B05716E902C3" class="sect4">管理资源</h4>
                  <div>
                     <p>如《 <a href="java-management-extensions-jmx-user-guide.html">Java管理扩展技术用户指南》中所述</a> ，在MBean检测了资源之后，该资源的管理由<span class="italic">JMX代理</span>执行。
                     </p>
                     <p>JMX代理的核心组件是<span class="italic">MBean服务器</span> ，这是一个在其中注册MBean的托管对象服务器。请参阅API文档，以了解<code class="codeph">MBeanServer</code>接口，以获取MBean服务器实现的详细信息。JMX代理还包括一组用于管理MBean的服务。<span class="bold">代码示例2-3创建JMX代理</span>将提供一个名为的基本JMX代理<code class="codeph">Main</code> 。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-FA3724F5-9E67-4002-82BE-B05716E902C3__GUID-1FEC501D-328D-4A6B-B99A-298CF7974E8E">代码示例2-3创建JMX代理</p><pre class="pre codeblock"><code>
 
package com.example.mbeans; 
 
import java.lang.management.*; 
import javax.management.*; 
 
public class Main { 
 
   public static void main(String[] args) throws Exception { 
 
      MBeanServer mbs = ManagementFactory.getPlatformMBeanServer(); 
 
      ObjectName name = new ObjectName("com.example.mbeans:type=Hello"); 
 
      Hello mbean = new Hello(); 
 
      mbs.registerMBean(mbean, name); 
 
      System.out.println("Waiting forever..."); 
      Thread.sleep(Long.MAX_VALUE); 
   } 
} 
 
</code></pre><p>在示例2-3中，JMX代理<code class="codeph">Main</code>首先，通过获取平台上运行的任何MBean服务器， <code class="codeph">getPlatformMBeanServer()</code>的方法<code class="codeph">java.lang.management.ManagementFactory</code>类。如果平台上尚未运行任何MBean服务器，则<code class="codeph">getPlatformMBeanServer()</code>通过调用JMX方法自动创建一个<code class="codeph">MBeanServerFactory.createMBeanServer()</code> 。的<code class="codeph">MBeanServer</code>实例由<code class="codeph">Main</code>被称为<code class="codeph">mbs</code> 。
                        </p>
                        <p>下一个， <code class="codeph">Main</code>定义将创建的MBean实例的对象名称。每个JMX MBean必须具有一个对象名称。对象名称是JMX类的实例<code class="codeph">ObjectName</code> ，并且必须符合JMX规范定义的语法，即它必须包含<span class="italic">domain</span>和<span class="italic">key-properties</span>列表。请参阅API文档，以了解<code class="codeph">ObjectName</code>有关此语法的详细信息，请参见类。在定义的对象名称中<code class="codeph">Main</code> ， <code class="codeph">name</code> ，该域是<code class="codeph">com.example.mbeans</code> （包含示例MBean的包），并且键属性声明此对象的类型为<code class="codeph">Hello</code> 。
                        </p>
                        <p>一个实例<code class="codeph">Hello</code>创建对象，命名为<code class="codeph">mbean</code> 。这个<code class="codeph">Hello</code>对象是MBean的实例<code class="codeph">Hello</code>在<a href="essentials-jmx-api.html#GUID-215E9966-9BF6-4201-848A-FE860BDF3DAD">MBean实现</a>中定义。
                        </p>
                        <p>的<code class="codeph">Hello</code>对象名为<code class="codeph">mbean</code>在MBean服务器中注册为MBean <code class="codeph">mbs</code>与对象名称<code class="codeph">name</code> ，方法是将对象和对象名称传递给对JMX方法的调用<code class="codeph">MBeanServer.registerMBean()</code> 。
                        </p>
                        <p>随着<code class="codeph">Hello</code>在MBean服务器中注册的MBean， <code class="codeph">Main</code>只会等待在其上执行管理操作<code class="codeph">Hello</code> 。在此示例的范围内，这些管理操作正在调用<code class="codeph">sayHello()</code>和<code class="codeph">add()</code> ，并获取和设置属性值。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-2DC4C102-AC0C-4E00-9AF7-341BE0AA74D0" name="GUID-2DC4C102-AC0C-4E00-9AF7-341BE0AA74D0"></a><h4 id="JSJMX-GUID-2DC4C102-AC0C-4E00-9AF7-341BE0AA74D0" class="sect4">运行标准MBean示例</h4>
                  <div>
                     <p>检查了示例类之后，您可以运行该示例。Java平台标准版包括一个名为JConsole的管理和监视控制台，在本示例中，该控制台用于与MBean进行交互。JConsole位于<code class="codeph"><span class="variable" translate="no">JavaSE_HOME</span>/bin/jconsole</code> ，其中<code class="codeph"><span class="variable" translate="no">JavaSE_HOME</span></code>是Java平台标准版（Java SE平台）的安装目录。
                     </p>
                     <p>运行示例：</p>
                     <ol>
                        <li>
                           <p>将<a href="jmx-essentials-example.html">JMX Essentials中</a>的源代码复制到<code class="codeph"><span class="variable" translate="no">work_dir</span>/jmx_examples/Essential</code> 。
                           </p>
                        </li>
                        <li>编译示例Java类。
                           <p><code class="codeph">$ javac com/example/mbeans/*.java</code></p>
                        </li>
                        <li>开始<code class="codeph">Main</code>应用。
                           <p><code class="codeph">$ java com.example.mbeans.Main</code></p>
                           <p>您会看到一个确认<code class="codeph">Main</code>正在等待发生的事情。
                           </p>
                        </li>
                        <li>在同一台计算机上的另一个终端窗口中启动JConsole。
                           <p><code class="codeph">$ jconsole</code></p>
                           <p>您将看到JConsole工具打开，其中提供了可以连接到的正在运行的JMX代理的列表。</p>
                        </li>
                        <li>选择<code class="codeph">com.example.mbeans.Main</code>从“新建连接”窗口中的列表中，然后单击“ <span class="bold">连接”</span> 。
                           <p>您将看到平台当前活动的摘要。</p>
                        </li>
                        <li>单击“ <span class="bold">MBeans”</span>选项卡。
                           <p>该面板向您显示当前在MBean服务器中注册的所有MBean。</p>
                        </li>
                        <li>在左侧框架中，展开<code class="codeph">com.example.mbeans</code> MBean树中的节点。
                           <p>您将看到示例MBean <code class="codeph">Hello</code> ，是由创建和注册的<code class="codeph">Main</code> 。如果单击<code class="codeph">Hello</code> ，您将在MBean树中看到其关联的Attributes和Operations节点。
                           </p>
                        </li>
                        <li>点击<code class="codeph">Hello</code> MBean树中的MBean节点显示<code class="codeph">Hello</code> MBean的元数据及其关联的描述符。
                        </li>
                        <li>点击<code class="codeph">Attributes</code>的节点<code class="codeph">Hello</code> MBean树中的MBean。
                           <p>这将显示由<code class="codeph">Hello</code>类。
                           </p>
                        </li>
                        <li>更改值<code class="codeph">CacheSize</code>属性为150。
                           <p>在您开始的终端窗口中<code class="codeph">Main</code> ，您将看到此属性更改的确认。
                           </p>
                        </li>
                        <li>点击<code class="codeph">Operations</code> MBean树中Hello MBean的节点。
                           <p>在这里，您将看到由<code class="codeph">Hello</code> MBean， <code class="codeph">sayHello()</code>和<code class="codeph">add()</code> 。
                           </p>
                        </li>
                        <li>调用<code class="codeph">sayHello()</code>操作，方法是单击<code class="codeph">sayHello</code>按钮。
                           <p>JConsole对话框将通知您该方法已成功调用，并且您将在终端窗口中看到消息“ <span class="italic">hello，world</span> ”。 <code class="codeph">Main</code>在跑。
                           </p>
                        </li>
                        <li>提供两个整数<code class="codeph">add()</code>添加操作，然后单击<code class="codeph">add</code>按钮。
                           <p>您将在JConsole对话框中收到答案的通知。</p>
                        </li>
                        <li>单击“ <span class="bold">连接”</span> ，然后单击“ <span class="bold">退出</span> ”以退出JConsole。
                        </li>
                     </ol>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-A2DD5808-2DBC-4A36-B9DB-A58E86CB2503" name="GUID-A2DD5808-2DBC-4A36-B9DB-A58E86CB2503"></a><h3 id="JSJMX-GUID-A2DD5808-2DBC-4A36-B9DB-A58E86CB2503" class="sect3">发送通知</h3>
               <div>
                  <p>MBean可以生成通知，例如以信号通知状态更改，检测到的事件或问题。</p>
                  <p>为了使MBean生成通知，它必须实现接口<code class="codeph">NotificationBroadcaster</code>或其子接口<code class="codeph">NotificationEmitter</code> 。发送通知所需要做的就是构造该类的实例<code class="codeph">javax.management.Notification</code>或子类（例如<code class="codeph">AttributeChangedNotification</code> ），并将其传递给<code class="codeph">NotificationBroadcasterSupport.sendNotification</code> 。
                  </p>
                  <p>每个通知都有一个来源。源是发出通知的MBean的对象名称。</p>
                  <p>每个通知都有一个序列号。当订单很重要时，此数字可用于订购来自同一来源的通知，并且有可能以错误的顺序处理通知。序列号可以为零是可以的，但是对于来自给定MBean的每个通知，最好增加它。</p>
                  <p>有一个标准MBean的示例，该示例在目录<span class="italic">work_dir</span>中发出通知<code class="codeph">/jmx_examples/Notification/com/example/mbeans</code> 。该示例与<a href="essentials-jmx-api.html#GUID-A7621810-656C-46D2-B06E-029F2B8662A6">Standard MBeans中</a>的示例基本相同，除了<code class="codeph">Hello</code> MBean实现<code class="codeph">NotificationBroadcaster</code>接口。
                  </p>
               </div>
               <div class="sect3"><a id="GUID-B85BE5D8-6932-41B5-BDDA-514C57B846B5" name="GUID-B85BE5D8-6932-41B5-BDDA-514C57B846B5"></a><h4 id="JSJMX-GUID-B85BE5D8-6932-41B5-BDDA-514C57B846B5" class="sect4">NotificationBroadcaster界面</h4>
                  <div>
                     <p>如上所述，此示例与<a href="essentials-jmx-api.html#GUID-A7621810-656C-46D2-B06E-029F2B8662A6">Standard MBean中</a>提供的示例之间的唯一区别是，MBean实现允许发送通知。通知通过以下方式激活： <code class="codeph">NotificationBroadcaster</code>接口，如<span class="bold">代码示例2-4实现MBean通知所示</span> 。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-B85BE5D8-6932-41B5-BDDA-514C57B846B5__GUID-8C91A85D-3F15-4D56-A3B9-03C359958717">代码示例2-4实现MBean通知</p><pre class="pre codeblock"><code>
 
package com.example.mbeans; 
 
import javax.management.*; 
 
public class Hello 
        extends NotificationBroadcasterSupport implements HelloMBean { 
 
    public void sayHello() { 
        System.out.println("hello, world"); 
    } 
 
    public int add(int x, int y) { 
        return x + y; 
    } 
 
    public String getName() { 
        return this.name; 
    } 
 
    public int getCacheSize() { 
        return this.cacheSize; 
    } 
 
    public synchronized void setCacheSize(int size) { 
        int oldSize = this.cacheSize; 
        this.cacheSize = size; 
 
        System.out.println("Cache size now " + this.cacheSize); 
 
        Notification n = 
            new AttributeChangeNotification(this, 
                                            sequenceNumber++, 
                                            System.currentTimeMillis(), 
                                            "CacheSize changed", 
                                            "CacheSize", 
                                            "int", 
                                            oldSize, 
                                            this.cacheSize); 
 
        sendNotification(n); 
    } 
 
    @Override 
    public MBeanNotificationInfo[] getNotificationInfo() { 
        String[] types = new String[] { 
            AttributeChangeNotification.ATTRIBUTE_CHANGE 
        }; 
        String name = AttributeChangeNotification.class.getName(); 
        String description = "An attribute of this MBean has changed"; 
        MBeanNotificationInfo info = 
            new MBeanNotificationInfo(types, name, description); 
        return new MBeanNotificationInfo[] {info}; 
    } 
 
    private final String name = "Reginald"; 
    private int cacheSize = DEFAULT_CACHE_SIZE; 
    private static final int DEFAULT_CACHE_SIZE = 200; 
 
    private long sequenceNumber = 1; 
} 
 
</code></pre><p>如您在<span class="bold">代码示例2-4实现MBean通知中所</span>看到的， <code class="codeph">Hello</code> MBean实现扩展了<code class="codeph">NotificationBroadcasterSupport</code>类，它本身实现了<code class="codeph">NotificationEmitter</code>接口。
                        </p>
                        <p>操作和属性的设置方式与以前相同，唯一的例外是<code class="codeph">cacheSize</code>属性的setter方法现在定义了一个新值<code class="codeph">oldSize</code> ，其中记录了<code class="codeph">cacheSize</code>设置操作之前的属性值。
                        </p>
                        <p>通知是根据实例构造的， <code class="codeph">n</code> ，属于JMX类<code class="codeph">AttributeChangeNotification</code> ，扩展了<code class="codeph">javax.management.Notification</code> 。该通知是在<code class="codeph">setCacheSize()</code>方法，将以下信息传递给<code class="codeph">AttributeChangeNotification</code>作为参数：</p>
                        <ul style="list-style-type:disc">
                           <li>通知来源的对象名称，即<code class="codeph">Hello</code> MBean，简单表示为<code class="codeph">this</code></li>
                           <li>序列号，在此示例中为长名称<code class="codeph">sequenceNumber</code> ，将其设置为1并逐渐增加</li>
                           <li>时间戳记</li>
                           <li>通知消息的内容</li>
                           <li>在这种情况下，已更改的属性的名称<code class="codeph">cacheSize</code></li>
                           <li>更改的属性类型</li>
                           <li>在这种情况下，旧的属性值<code class="codeph">oldSize</code></li>
                           <li>在这种情况下，新的属性值<code class="codeph">this.cacheSize</code></li>
                        </ul>
                        <p>通知n然后传递给<code class="codeph">NotificationBroadcasterSupport.sendNotification()</code>方法。
                        </p>
                        <p>最后， <code class="codeph">MBeanNotification</code>定义用于描述MBean针对给定的Java通知类发出的不同通知实例的特征，在这种情况下为<code class="codeph">AttributeChangeNotification</code>通知。
                        </p>
                        <p>MBean接口， <code class="codeph">HelloMBean</code> ，以及JMX代理<code class="codeph">Main</code>与前面示例中使用的相同。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-EFD430B2-D827-4EE6-A695-2F6F26744067" name="GUID-EFD430B2-D827-4EE6-A695-2F6F26744067"></a><h4 id="JSJMX-GUID-EFD430B2-D827-4EE6-A695-2F6F26744067" class="sect4">运行MBean通知示例</h4>
                  <div>
                     <p>检查了示例类之后，您现在可以运行该示例。本示例使用JConsole与<code class="codeph">Hello</code> MBean。运行示例：</p>
                     <ol>
                        <li>
                           <p>将源代码从<a href="jmx-mbean-notifications-example.html">JMX MBean Notifications</a>复制到<code class="codeph"><span class="variable" translate="no">work_dir</span>/jmx_examples/Notification</code> 。
                           </p>
                        </li>
                        <li>
                           <p>编译示例Java类。</p>
                           <div class="p"><pre class="pre codeblock"><code>$ javac com/example/mbeans/*.java</code></pre></div>
                        </li>
                        <li>
                           <p>开始<code class="codeph">Main</code>应用。
                           </p>
                           <div class="p"><pre class="pre codeblock"><code>$ java com.example.mbeans.Main</code></pre></div>
                           <p>您会看到确认<code class="codeph">Main</code>正在等待发生的事情。
                           </p>
                        </li>
                        <li>
                           <p>在同一台计算机上的另一个终端窗口中启动JConsole。</p>
                           <div class="p"><pre class="pre codeblock"><code>$ jconsole</code></pre></div>
                           <p>您将看到JConsole工具打开，其中提供了可以连接到的正在运行的JMX代理的列表。</p>
                        </li>
                        <li>
                           <p>选择<code class="codeph">com.example.mbeans.Main</code>从“ <span class="wintitle">新建连接”</span>窗口中的列表中，然后单击“ <span class="bold">连接”</span> 。
                           </p>
                           <p>您将看到平台当前活动的摘要。</p>
                        </li>
                        <li>
                           <p>单击“ <span class="bold">MBeans”</span>选项卡。
                           </p>
                           <p>该面板向您显示当前在MBean服务器中注册的所有MBean。</p>
                        </li>
                        <li>
                           <p>在左侧框架中，展开<code class="codeph">com.example.mbeans</code> MBean树中的节点。
                           </p>
                           <p>您将看到示例MBean <code class="codeph">Hello</code> ，是由创建和注册的<code class="codeph">Main</code> 。如果点击<code class="codeph">Hello</code> ，您将看到其关联<code class="codeph">Attributes</code> ， <code class="codeph">Operations</code>和<code class="codeph">Notifications</code> MBean树中的节点。
                           </p>
                        </li>
                        <li>
                           <p>点击<code class="codeph">Hello</code> MBean树中的MBean节点。
                           </p>
                           <p>这将显示MBean的元数据及其关联的描述符。</p>
                        </li>
                        <li>
                           <p>点击<code class="codeph">Notifications</code> MBean树中Hello MBean的节点。
                           </p>
                           <p>您将看到面板为空白。</p>
                        </li>
                        <li>
                           <p>点击“订阅”按钮。</p> 
                           <p>当前收到的通知数（0）将显示在“通知”节点标签中。</p>
                        </li>
                        <li>
                           <p>点击<code class="codeph">Attributes</code>的节点<code class="codeph">Hello</code> MBean树中的MBean，然后更改<code class="codeph">CacheSize</code>属性为150。
                           </p>
                           <p>在您开始的终端窗口中<code class="codeph">Main</code> ，您将看到此属性更改的确认。您还将看到“通知”节点中显示的收到的通知数已更改为1。
                           </p>
                        </li>
                        <li>
                           <p>点击<code class="codeph">Notifications</code>的节点<code class="codeph">Hello</code>再次在MBean树中使用MBean。
                           </p>
                           <p>您将看到已发送通知的详细信息。</p>
                        </li>
                        <li>单击<span class="bold">Connection</span> ，然后单击<span class="bold">Exit</span> ，退出JConsole。
                        </li>
                     </ol>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-41CDE7AB-FEAD-42E0-BCE6-933501B654E2" name="GUID-41CDE7AB-FEAD-42E0-BCE6-933501B654E2"></a><h3 id="JSJMX-GUID-41CDE7AB-FEAD-42E0-BCE6-933501B654E2" class="sect3">MXBeans简介</h3>
               <div>
                  <p>MXBean是一种新型的MBean，它提供了一种简单的方式来编写仅引用一组预定义类型的MBean。这样，您可以确保您的MBean可被任何客户端（包括远程客户端）使用，而无需客户端有权访问代表MBean类型的特定于模型的类。MXBean提供了一种方便的方式将相关值捆绑在一起，而无需将客户端特别配置为处理捆绑。</p>
                  <p>与标准MBean一样，通过编写一个称为<span class="italic">Something</span>的Java接口来定义MXBean。 <code class="codeph">MXBean</code>和一个实现该接口的Java类。但是，与标准MBean不同，MXBean不需要调用Java类。 <code class="codeph">Something</code> 。接口中的每个方法都定义了MXBean中的属性或操作。注释<code class="codeph">@MXBean</code>也可以用于注释Java接口，而不要求接口名称后跟MXBean后缀。
                  </p>
                  <p>MXBean提供了一种方便的方法来将相关值捆绑在MBean中，而无需将客户端特别配置为在与该MBean交互时处理捆绑。软件包中的MXBean已存在于Java 2 Platform Standard Edition（J2SE）5.0中。 <code class="codeph">java.lang.management</code> 。使用Java SE 6平台，用户现在可以定义自己的MXBean，除了<code class="codeph">java.lang.management</code> 。
                  </p>
                  <p>MXBeans背后的关键思想是诸如<code class="codeph">java.lang.management.MemoryUsage</code>在MXBean接口中引用的<code class="codeph">java.lang.management.MemoryMXBean</code>在这种情况下，被映射为一组标准类型，即在包中定义的所谓的“开放类型” <code class="codeph">javax.management.openmbean</code> 。确切的映射规则出现在MXBean规范中，但是为了简化起见，我们可以说像<code class="codeph">int</code>要么<code class="codeph">String</code>不变，而复杂类型如<code class="codeph">MemoryUsage</code>映射到标准类型<code class="codeph">CompositeDataSupport</code> 。
                  </p>
                  <p>MXBeans的操作由示例程序演示，您可以在目录<span class="italic">work_dir中</span>找到该示例程序<code class="codeph">/jmx_examples/MXBean/com/example/mxbeans</code>下载并解压缩后<code class="codeph">jmx_examples.zip</code>文件。MXBean示例包含以下文件：</p>
                  <ul style="list-style-type:disc">
                     <li><code class="codeph">QueueSamplerMXBean</code>接口。
                     </li>
                     <li><code class="codeph">QueueSampler</code>实现MXBean接口的类。
                     </li>
                     <li><code class="codeph">QueueSample</code>返回的Java类型<code class="codeph">getQueueSample()</code> MXBean接口中的方法。
                     </li>
                     <li><code class="codeph">Main</code> ，它是设置并运行示例的程序。
                     </li>
                  </ul>
                  <p></p>
                  <p>MXBean示例执行以下操作。</p>
                  <ul style="list-style-type:disc">
                     <li>定义一个简单的MXBean，用于管理以下资源<code class="codeph">type Queue<String></code> 。
                     </li>
                     <li>声明一个吸气剂， <code class="codeph">getQueueSample</code> ，在MXBean中，该MXBean在调用时拍摄队列快照并返回Java类<code class="codeph">QueueSample</code>将以下值捆绑在一起：</li>
                     <li>拍摄快照的时间。</li>
                     <li>队列大小。</li>
                     <li>在给定时间的队列头。</li>
                     <li>在MBean服务器中注册MXBean。</li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-1BB36D3F-9ABA-4481-83E3-7E2A48983C93" name="GUID-1BB36D3F-9ABA-4481-83E3-7E2A48983C93"></a><h4 id="JSJMX-GUID-1BB36D3F-9ABA-4481-83E3-7E2A48983C93" class="sect4">QueueSamplerMXBean接口</h4>
                  <div>
                     <p><span class="bold">代码示例2-5 QueueSamplerMXBean接口</span>显示示例代码<code class="codeph">QueueSamplerMXBean</code>接口。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-1BB36D3F-9ABA-4481-83E3-7E2A48983C93__GUID-440C57DC-33B5-49A9-AA9A-9517E4AC733C">代码示例2-5 QueueSamplerMXBean接口</p><pre class="pre codeblock"><code>
 
package com.example.mxbeans; 
 
public interface QueueSamplerMXBean { 
    public QueueSample getQueueSample(); 
    public void clearQueue(); 
} 
 
</code></pre><p>如您所见，您以与声明标准MBean完全相同的方式声明MXBean接口。的<code class="codeph">QueueSamplerMXBean</code>接口声明了两个操作， <code class="codeph">getQueueSample</code>和<code class="codeph">clearQueue</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-FF5986D4-6980-4773-BAE3-B596A1E1BDEC" name="GUID-FF5986D4-6980-4773-BAE3-B596A1E1BDEC"></a><h4 id="JSJMX-GUID-FF5986D4-6980-4773-BAE3-B596A1E1BDEC" class="sect4">QueueSampler类</h4>
                  <div>
                     <p>的<code class="codeph">QueueSampler</code>类实现<code class="codeph">QueueSamplerMXBean</code>接口在<span class="bold">代码示例2-6 QueueSampler类中显示</span> 。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-FF5986D4-6980-4773-BAE3-B596A1E1BDEC__GUID-6C52B322-5A45-4840-A203-0F7D36A48530">代码示例2-6 QueueSampler类</p><pre class="pre codeblock"><code>
package com.example.mxbeans; 
 
import java.util.Date; 
import java.util.Queue; 
 
public class QueueSampler implements QueueSamplerMXBean { 
     
    private Queue&lt;String&gt; queue; 
     
    public QueueSampler(Queue&lt;String&gt; queue) { 
       this.queue = queue; 
    } 
     
    public QueueSample getQueueSample() { 
        synchronized (queue) { 
            return new QueueSample(new Date(), queue.size(), queue.peek()); 
        } 
    } 
     
    public void clearQueue() { 
        synchronized (queue) { 
            queue.clear(); 
        } 
    } 
} 
 
</code></pre><p>MXBean操作<code class="codeph">getQueueSample()</code>和<code class="codeph">clearQueue()</code> MXBean接口声明的定义在<code class="codeph">QueueSampler</code> 。的<code class="codeph">getQueueSample()</code>操作仅返回的实例<code class="codeph">QueueSample</code> Java类型，使用由<code class="codeph">java.util</code> 。 <code class="codeph">Queue</code>方法<code class="codeph">peek()</code>和<code class="codeph">size()</code>和一个实例<code class="codeph">java.util.Date</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-0526AEF2-5ED1-4499-BB62-DC09AFF290D8" name="GUID-0526AEF2-5ED1-4499-BB62-DC09AFF290D8"></a><h4 id="JSJMX-GUID-0526AEF2-5ED1-4499-BB62-DC09AFF290D8" class="sect4">QueueSample类</h4>
                  <div>
                     <p>的<code class="codeph">QueueSample</code>实例返回<code class="codeph">QueueSampler</code>在中定义<code class="codeph">QueueSample</code> <span class="bold">代码示例2-7 QueueSample</span>类中显示的<span class="bold">类</span> 。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-0526AEF2-5ED1-4499-BB62-DC09AFF290D8__GUID-026D8303-F332-4975-9D19-3FC3881CEC86">代码示例2-7 QueueSample类</p><pre class="pre codeblock"><code>
package com.example.mxbeans; 
 
import java.beans.ConstructorProperties; 
import java.util.Date; 
 
public class QueueSample { 
     
    private final Date date; 
    private final int size; 
    private final String head; 
     
    @ConstructorProperties({"date", "size", "head"}) 
    public QueueSample(Date date, int size, String head) { 
        this.date = date; 
        this.size = size; 
        this.head = head; 
    } 
     
    public Date getDate() { 
        return date; 
    } 
     
    public int getSize() { 
        return size; 
    } 
     
    public String getHead() { 
        return head; 
    } 
} 
 
</code></pre><p>在<code class="codeph">QueueSample</code>类，MXBean框架调用其中的所有getter <code class="codeph">QueueSample</code>将给定的实例转换为<code class="codeph">CompositeData</code>并使用<code class="codeph">@ConstructorProperties</code>注释以重建<code class="codeph">QueueSample</code>来自的实例<code class="codeph">CompositeData</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-7E8AF654-047B-4597-94DA-AA1FDE995EF6" name="GUID-7E8AF654-047B-4597-94DA-AA1FDE995EF6"></a><h4 id="JSJMX-GUID-7E8AF654-047B-4597-94DA-AA1FDE995EF6" class="sect4">在MBean服务器中创建和注册MXBean</h4>
                  <div>
                     <p>定义了MXBean接口和实现该接口的类以及返回的Java类型之后，现在必须创建MXBean并将其注册在MBean服务器中。这些操作由示例类执行<code class="codeph">Main</code> 。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-7E8AF654-047B-4597-94DA-AA1FDE995EF6__GUID-14332C56-4DE1-4B51-968B-2A575057E781">代码示例2-8 MXBean示例主类</p><pre class="pre codeblock"><code>
package com.example.mxbeans; 
 
import java.lang.management.ManagementFactory; 
import java.util.Queue; 
import java.util.concurrent.ArrayBlockingQueue; 
import javax.management.MBeanServer; 
import javax.management.ObjectName; 
 
public class Main { 
 
    public static void main(String[] args) throws Exception { 
        MBeanServer mbs = ManagementFactory.getPlatformMBeanServer(); 
         
        ObjectName name = 
                new ObjectName("com.example.mxbeans:type=QueueSampler"); 
         
        Queue&lt;String&gt; queue = new ArrayBlockingQueue&lt;String&gt;(10); 
        queue.add("Request-1"); 
        queue.add("Request-2"); 
        queue.add("Request-3"); 
        QueueSampler mxbean = new QueueSampler(queue); 
         
        mbs.registerMBean(mxbean, name); 
         
        System.out.println("Waiting..."); 
        Thread.sleep(Long.MAX_VALUE); 
    } 
} 
 
</code></pre><p>的<code class="codeph">Main</code>类获取平台MBean服务器，为MXBean创建对象名称<code class="codeph">QueueSampler</code> ，创建一个<code class="codeph">Queue</code>的实例<code class="codeph">QueueSampler</code> MXBean进行处理，并将此Queue实例提供给新创建的<code class="codeph">QueueSampler</code> MXBean。然后，以与标准MBean完全相同的方式将MXBean注册到MBean服务器中。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-592808D7-3734-4834-9650-455D25A5084B" name="GUID-592808D7-3734-4834-9650-455D25A5084B"></a><h4 id="JSJMX-GUID-592808D7-3734-4834-9650-455D25A5084B" class="sect4">运行MXBean示例</h4>
                  <div>
                     <p>要运行MXBean示例：</p>
                     <ol>
                        <li>
                           <p>将源从<a href="mxbeans-example.html">MXBeans</a>复制到<code class="codeph"><span class="variable" translate="no">work_dir</span>/jmx_examples/MXBean</code> 。
                           </p> 
                        </li>
                        <li>
                           <p>编译示例Java类。</p> 
                           <div class="p"><pre class="pre codeblock"><code>$ javac com/example/mxbeans/*.java</code></pre></div>
                        </li>
                        <li>
                           <p>开始<code class="codeph">Main</code>应用。
                           </p> 
                           <div class="p"><pre class="pre codeblock"><code>$ java com.example.mxbeans.Main</code></pre></div>
                           <p>您会看到确认<code class="codeph">Main</code>正在等待发生的事情。
                           </p>
                        </li>
                        <li>
                           <p>在同一台计算机上的另一个终端窗口中启动JConsole。</p> 
                           <div class="p"><pre class="pre codeblock"><code>$ jconsole</code></pre></div>
                           <p>您将看到JConsole工具打开，其中提供了可以连接到的正在运行的JMX代理的列表。</p>
                        </li>
                        <li>
                           <p>选择<code class="codeph">com.example.mxbeans.Main</code>从“ <span class="wintitle">新建连接”</span>窗口中的列表中，然后单击“ <span class="bold">连接”</span> 。
                           </p> 
                           <p>您将看到平台当前活动的摘要。</p>
                        </li>
                        <li>
                           <p>单击“ <span class="bold">MBeans”</span>选项卡。
                           </p> 
                           <p>该面板向您显示当前在MBean服务器中注册的所有MBean。</p>
                        </li>
                        <li>
                           <p>在左侧框架中，展开<code class="codeph">com.example.mxbeans</code> MBean树中的节点。
                           </p> 
                           <p>您将看到示例MBean <code class="codeph">QueueSampler</code> ，由Main创建和注册。如果点击<code class="codeph">QueueSampler</code> ，那么您将在MBean树中看到其关联的Attributes和Operations节点。
                           </p>
                        </li>
                        <li>
                           <p>选择<code class="codeph">Attributes</code>节点。
                           </p> 
                           <p>您会看到<code class="codeph">QueueSample</code>属性显示在右侧窗格中，其值为<code class="codeph">javax.management.openmbean.CompositeDataSupport</code> 。
                           </p>
                        </li>
                        <li>
                           <p>双击<code class="codeph">CompositeDataSupport</code>值。
                           </p> 
                           <p>你可以看到<code class="codeph">QueueSample</code>价值观<code class="codeph">date</code> ， <code class="codeph">head</code>和<code class="codeph">size</code>因为MXBean框架已将<code class="codeph">QueueSample</code>实例成<code class="codeph">CompositeData</code> 。如果您已经定义<code class="codeph">QueueSampler</code>作为标准MBean而不是MXBean，JConsole不会找到<code class="codeph">QueueSample</code> class，因为它将不在其类路径中。如果<code class="codeph">QueueSampler</code>如果是标准的MBean，您会收到一个<code class="codeph">ClassNotFoundException</code>检索时<code class="codeph">QueueSample</code>属性值。这证明了在通过通用JMX客户端（例如JConsole）连接到JMX代理时使用MXBean的有用性。
                           </p>
                        </li>
                        <li>
                           <p>选择“ <span class="bold">操作”</span>节点。
                           </p> 
                           <p>您将看到一个按钮，用于调用<code class="codeph">clearQueue</code>操作。
                           </p>
                        </li>
                        <li>
                           <p>单击<span class="bold">clearQueue</span>按钮。
                           </p> 
                           <p>您将被告知该方法已成功调用。</p>
                        </li>
                        <li>
                           <p>再次选择“ <span class="bold">属性”</span>节点，然后双击<code class="codeph">CompositeDataSupport</code>值。
                           </p> 
                           <p>队列现在已被重置。</p>
                        </li>
                        <li>
                           <p>单击<span class="bold">Connection</span> ，然后单击<span class="bold">Exit</span> ，退出JConsole。
                           </p>
                        </li>
                     </ol>
                     <p>在此示例中，JConsole用作JMX客户端，但是如果要在JMX客户端中以编程方式访问MXBean，则可以编写自己的代码，那么可以通过以下两种方式之一进行操作：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>通常，使用以下代码：</p><pre class="pre codeblock"><code>MBeanServer mbs = <span class="italic">...whatever...</span>; 
ObjectName name = new ObjectName("com.example.mxbeans:type=QueueSampler"); 
CompositeData queueSample = (CompositeData) mbs.getAttribute(name,  
                             "QueueSample"); 
int size = (Integer) queueSample.get("size"); 
</code></pre></li>
                        <li>
                           <p>通过代理，使用以下代码：</p><pre class="pre codeblock"><code>MBeanServer mbs = <span class="italic">...whatever...</span>; 
ObjectName name = new ObjectName("com.example.mxbeans:type=QueueSampler"); 
QueueSamplerMXBean proxy = JMX.newMXBeanProxy(mbs, name,  
                                              QueueSamplerMXBean.class); 
QueueSample queueSample = proxy.getQueueSample(); 
int size = queueSample.getSize(); 
</code></pre><p>此代码使用newMXBeanProxy方法创建MXBean代理。等效方法<code class="codeph">newMBeanProxy</code>存在的目的是为其他类型的MBean创建代理。的<code class="codeph">newMBeanProxy</code>和<code class="codeph">newMXBeanProxy</code>方法的使用方式完全相同。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-393ED70C-29FA-4869-8D26-57ECC3E14B45" name="GUID-393ED70C-29FA-4869-8D26-57ECC3E14B45"></a><h3 id="JSJMX-GUID-393ED70C-29FA-4869-8D26-57ECC3E14B45" class="sect3">MBean描述符</h3>
               <div>
                  <p>描述符允许您将有关MBean的其他信息提供给管理客户端。例如，MBean属性上的Descriptor可能会说出它的度量单位，或者其最小和最大可能值。从Java SE 6开始，描述符是JMX API的集成部分，并且在所有类型的MBean中都可用。</p>
                  <p>描述符为您提供了一种方便的方法，可将任意额外的元数据附加到您的MBean。描述符一直存在于JMX API中，但是直到Java SE 6为止，它们只能与Model MBeans一起使用。</p>
                  <p>对于课程中的大多数构造函数<code class="codeph">MBean*Info</code> （ <code class="codeph">MBeanInfo</code> ， <code class="codeph">MBeanAttributeInfo</code> ，依此类推），存在一个并行构造函数，其中包含相同的参数以及其他参数<code class="codeph">javax.management.Descriptor</code>参数。情况也是如此<code class="codeph">OpenMBean*InfoSupport</code> 。的<code class="codeph">MBean*Info</code>和<code class="codeph">OpenMBean*InfoSupport</code>类包含一个<code class="codeph">getDescriptor()</code>方法。
                  </p>
                  <p>Open MBeans返回有关默认值和合法值的信息。 <code class="codeph">getDefaultValue()</code> ， <code class="codeph">getLegalValues()</code> ， <code class="codeph">getMaxValue()</code> ， <code class="codeph">getMinValue()</code>方法<code class="codeph">OpenMBeanParameterInfo</code>和<code class="codeph">OpenMBeanAttributeInfo</code> 。现在，该信息也出现在相应的描述符中，并且其他类型的MBean也可以在其描述符中返回该信息。
                  </p>
                  <p>MBean描述符在示例类中进行了演示，您可以在目录<span class="italic">work_dir中</span>找到<span class="italic">该类</span> <code class="codeph">/jmx_examples/Descriptors/com/example/mxbeans</code>下载并解压缩后<code class="codeph">jmx_examples.zip</code>文件。MBean描述符示例包含以下文件。
                  </p>
                  <ul style="list-style-type:disc">
                     <li><code class="codeph">Author</code>注释提供MBean接口作者的名称。
                     </li>
                     <li><code class="codeph">DisplayName</code> ，一个注释，为MBean接口中的方法提供显示名称。
                     </li>
                     <li><code class="codeph">Main</code> ，它是设置并运行示例的程序。
                     </li>
                     <li><code class="codeph">QueueSamplerMXBean</code>接口。
                     </li>
                     <li><code class="codeph">QueueSampler</code>实现MXBean接口的类。
                     </li>
                     <li><code class="codeph">QueueSample</code>返回的Java类型<code class="codeph">getQueueSample()</code> MXBean接口中的方法。
                     </li>
                     <li><code class="codeph">Version</code> ，提供当前版本的MBean接口的注释。
                     </li>
                  </ul>
                  <p>的<code class="codeph">QueueSampler</code>除了添加了MBean描述符之外，此示例中的MXBean基本上执行与MXBean <a href="essentials-jmx-api.html#GUID-41CDE7AB-FEAD-42E0-BCE6-933501B654E2">简介</a>中<a href="essentials-jmx-api.html#GUID-41CDE7AB-FEAD-42E0-BCE6-933501B654E2">介绍</a>的MXBean示例相同的操作。这个例子说明了<code class="codeph">DescriptorKey</code> meta-annotation可用于通过标准MBean（或MXBean）接口中的注释将新的描述符项添加到标准MBean（或MXBean）的描述符中。
                  </p>
               </div>
               <div class="sect3"><a id="GUID-C0B6FA45-CA92-4B13-B32A-08CE2A1E823B" name="GUID-C0B6FA45-CA92-4B13-B32A-08CE2A1E823B"></a><h4 id="JSJMX-GUID-C0B6FA45-CA92-4B13-B32A-08CE2A1E823B" class="sect4">描述符键注释</h4>
                  <div>
                     <p>一个新的注释， <code class="codeph">DescriptorKey</code>可用于通过标准MBean或MXBean接口中的注释将信息添加到标准MBean或MXBean的描述符中。这使从现有管理模型生成标准MBean的工具可以将来自模型的信息包括在生成的MBean接口中，而不是在单独的文件中。<span class="bold">代码示例2-9作者注释</span>演示了<span class="bold">注释</span>的定义<code class="codeph">Author</code> 。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-C0B6FA45-CA92-4B13-B32A-08CE2A1E823B__GUID-16989C17-E5BF-41B8-B938-F46211751F53">代码示例2-9作者注释</p><pre class="pre codeblock"><code>
 
package com.example.mxbeans; 
 
import java.lang.annotation.Documented; 
import java.lang.annotation.ElementType; 
import java.lang.annotation.Retention; 
import java.lang.annotation.RetentionPolicy; 
import java.lang.annotation.Target; 
import javax.management.DescriptorKey; 
 
@Documented 
@Target(ElementType.TYPE) 
@Retention(RetentionPolicy.RUNTIME) 
public @interface Author { 
    @DescriptorKey("author") 
    String value(); 
} 
</code></pre><p>该批注提供了MBean接口创建者的名称。新领域<code class="codeph">author</code>将被添加到<code class="codeph">MBeanInfo</code>描述符的值由<code class="codeph">@Author</code>注解。文件<code class="codeph">Version</code>和<code class="codeph">DisplayName</code>以与for完全相同的方式定义这些名称的注释<code class="codeph">Author</code>以上。在每个<code class="codeph">Version</code>和<code class="codeph">DisplayName</code> ， <code class="codeph">@DescriptorKey</code>值是<code class="codeph">“version”</code>和<code class="codeph">“displayname”</code>分别。
                        </p>
                        <p>对于“版本”，一个新字段<code class="codeph">version</code>将被添加到<code class="codeph">MBeanInfo</code>描述符的值由<code class="codeph">@Version</code>注解。
                        </p>
                        <p>对于<code class="codeph">DisplayName</code> ，新领域<code class="codeph">displayName</code>将被添加到<code class="codeph">MBeanAttributeInfo</code>描述符或<code class="codeph">MBeanOperationInfo</code>描述符的值由<code class="codeph">@DisplayName</code>注释分别取决于被注释的方法是getter / setter还是操作。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-919C3274-B791-4A6C-A075-9746928DCBE3" name="GUID-919C3274-B791-4A6C-A075-9746928DCBE3"></a><h4 id="JSJMX-GUID-919C3274-B791-4A6C-A075-9746928DCBE3" class="sect4">使用MBean描述符</h4>
                  <div>
                     <p>的<code class="codeph">QueueSamplerMXBean</code>本示例中使用的接口与MXBeans示例中使用的接口略有不同，因为它实现了MBean描述符以发布其某些信息。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-919C3274-B791-4A6C-A075-9746928DCBE3__GUID-6D2758F0-C994-4F43-A7A9-3CF89AED210E">代码示例2-10带有描述符的QueueSamplerMXBean</p><pre class="pre codeblock"><code>
 
package com.example.mxbeans; 
 
@Author("Mr Bean") 
@Version("1.0") 
public interface QueueSamplerMXBean { 
    @DisplayName("GETTER: QueueSample") 
    public QueueSample getQueueSample(); 
    @DisplayName("OPERATION: clearQueue") 
    public void clearQueue(); 
} 
 
</code></pre><p>在这里<code class="codeph">@Author</code>注释设置为<code class="codeph">Mr. Bean</code> ， <code class="codeph">@Version</code>注释设置为<code class="codeph">1.0</code>和<code class="codeph">@DisplayName</code>设置为属性名称之一<code class="codeph">QueueSample</code>或手术<code class="codeph">clearQueue</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-35866F70-15B7-423C-80D8-0D2DEF88E757" name="GUID-35866F70-15B7-423C-80D8-0D2DEF88E757"></a><h4 id="JSJMX-GUID-35866F70-15B7-423C-80D8-0D2DEF88E757" class="sect4">运行MBean描述符示例</h4>
                  <div>
                     <p>运行示例：</p>
                     <ol>
                        <li>
                           <p>将<a href="mbean-descriptors-example.html">MBean描述符中</a>的源代码复制到<code class="codeph"><span class="variable" translate="no">work_dir</span>/jmx_examples/Descriptors</code> 。
                           </p>
                        </li>
                        <li>
                           <p>编译示例Java类。</p> 
                           <div class="p"><pre class="pre codeblock"><code>$ javac com/example/mxbeans/*.java</code></pre></div>
                        </li>
                        <li>
                           <p>开始<code class="codeph">Main</code>应用。
                           </p> 
                           <div class="p"><pre class="pre codeblock"><code>$ java com.example.mxbeans.Main</code></pre></div>
                           <p>您会看到确认<code class="codeph">Main</code>正在等待发生的事情。
                           </p>
                        </li>
                        <li>
                           <p>在同一台计算机上的另一个终端窗口中启动JConsole。</p> 
                           <div class="p"><pre class="pre codeblock"><code>$ jconsole</code></pre></div>
                           <p>您将看到JConsole工具打开，其中提供了可以连接到的正在运行的JMX代理的列表。</p>
                        </li>
                        <li>
                           <p>选择<code class="codeph">com.example.mxbeans.Main</code>从“ <span class="wintitle">新建连接”</span>窗口中的列表中，然后单击“ <span class="bold">连接”</span> 。
                           </p> 
                           <p>您将看到平台当前活动的摘要。</p>
                        </li>
                        <li>
                           <p>单击“ <span class="bold">MBeans”</span>选项卡。
                           </p> 
                           <p>该面板向您显示当前在MBean服务器中注册的所有MBean。</p>
                        </li>
                        <li>
                           <p>在左侧框架中，展开<code class="codeph">com.example.mxbeans</code> MBean树中的节点。
                           </p> 
                           <p>您将看到示例MBean <code class="codeph">QueueSampler</code> ，由Main创建和注册。如果点击<code class="codeph">QueueSampler</code> ，您将在MBean树中看到其关联的Attributes和Operations节点。您还将看到字段<code class="codeph">author</code>和<code class="codeph">version</code>在里面<code class="codeph">MBeanInfo</code>描述符表。
                           </p>
                        </li>
                        <li>
                           <p>展开<code class="codeph">Attributes</code>和<code class="codeph">Operations</code>下的节点<code class="codeph">QueueSampler</code> MBean节点。
                           </p> 
                           <p>您将看到各个属性和操作。</p>
                        </li>
                        <li>
                           <p>选择<code class="codeph">QueueSample</code>节点。
                           </p> 
                           <p>您将看到该字段<code class="codeph">displayName</code>在里面<code class="codeph">MBeanAttributeInfo</code>描述符表。
                           </p>
                        </li>
                        <li>
                           <p>选择<code class="codeph">clearQueue</code>节点。
                           </p> 
                           <p>您将看到该字段<code class="codeph">displayName</code>在里面<code class="codeph">MBeanOperationInfo</code>描述符表。
                           </p>
                        </li>
                        <li>
                           <p>单击<span class="bold">Connection</span> ，然后单击<span class="bold">Exit</span> ，退出JConsole。
                           </p>
                        </li>
                     </ol>
                  </div>
               </div>
            </div>
         </div>
      </article>
   

</body></html>