<html lang="en-us"  xml:lang="en-us"><head></head><body >﻿
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="The lookup services allow JMX technology clients to find and connect to connector servers that have registered with the lookup services.">
      <meta name="description" content="The lookup services allow JMX technology clients to find and connect to connector servers that have registered with the lookup services.">
      <title>查询服务</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Java Management Extensions Guide">
      <meta property="og:description" content="The lookup services allow JMX technology clients to find and connect to connector servers that have registered with the lookup services.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Java Management Extensions Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="java-management-extensions-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-09-20T10:06:58-07:00">
      <meta name="dcterms.title" content="Java Management Extensions Guide">
      <meta name="dcterms.dateCopyrighted" content="1993, 2018">
      <meta name="dcterms.category" content="java">
      <meta name="dcterms.identifier" content="E95075-01">
      
      <meta name="dcterms.product" content="en/java/javase/11">
      <meta name="dcterms.release" content="11">
      <link rel="prev" href="jmx-connectors.html" title="Previous" type="text/html">
      <link rel="next" href="security.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"java","element_name":"Java","display_in_url":true},"suite":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product_group":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product":{"short_name":"javase","element_name":"Java SE","display_in_url":true},"release":{"short_name":"11","element_name":"11","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="JMX">
  <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script>
   
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="jmx-connectors.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一个</a> <a href="security.html" class="pull-right">下一个<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Java管理扩展指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="java-management-extensions-jmx-technology-tutorial.html" property="item" typeof="WebPage"><span property="name">Java管理扩展（JMX）技术教程</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">查询服务</li>
            </ol>
            <a id="GUID-4F31260F-C8EF-466D-96AF-2DC7C0ABF776" name="GUID-4F31260F-C8EF-466D-96AF-2DC7C0ABF776"></a>
            
            <h2 id="JSJMX-GUID-4F31260F-C8EF-466D-96AF-2DC7C0ABF776" class="sect2"><span class="enumeration_chapter">12</span>查询服务</h2>
         </header>
         <div class="ind">
            <div>
               <p>查找服务允许JMX技术客户端查找并连接到已向查找服务注册的连接器服务器。</p>
               <p>Java管理扩展（JMX）规范使用现有的查找技术定义了对查找服务的三个绑定，如以下各节所述：</p>
               <ul style="list-style-type:disc">
                  <li><a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">初始配置</a>提供适用于所有三种类型的查找服务的配置信息。
                  </li>
                  <li><a href="lookup-services.html#GUID-4F759996-3FE4-43EE-8651-11C7AA88C54A">服务位置协议（SLP）查找服务</a>提供了SLP查找示例。
                  </li>
                  <li><a href="lookup-services.html#GUID-9926AA06-560E-46C7-AA27-8C71EED4F811">Jini查找服务</a>提供了一个Jini查找示例。
                  </li>
                  <li><a href="lookup-services.html#GUID-258E2025-16D3-4D22-A19F-F6FA0833018D">Java命名和目录接口（JNDI）/ LDAP查找服务</a>提供了一个JNDI / LDAP查找示例。
                  </li>
               </ul>
            </div>
            <div class="sect2"><a id="GUID-5E7A4F97-EA73-42AD-A539-D63327192B30" name="GUID-5E7A4F97-EA73-42AD-A539-D63327192B30"></a><h3 id="JSJMX-GUID-5E7A4F97-EA73-42AD-A539-D63327192B30" class="sect3">初始配置</h3>
               <div>
                  <p>如<a href="jmx-connectors.html#GUID-681F18DA-8B9B-4FC2-8164-5BE0864A239C">使用RMI连接器访问标准MBean和动态MBean中</a>所示，如果您正在使用远程方法调用（RMI）连接器，则可以选择使用外部目录来注册要查找的连接器服务器存根。与RMI连接器有关的查找服务示例中介绍了以下情况：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>使用以下外部目录之一的RMI连接器：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>RMI注册表，用于实现默认Java远程方法协议（JRMP）传输的RMI连接器</p>
                           </li>
                           <li>
                              <p>轻型目录访问协议（LDAP），用于JRMP传输</p> 
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>不使用外部目录的RMI连接器</p> 
                     </li>
                  </ul>
                  <p>如果在外部目录中注册RMI连接器存根，则需要一些初始配置。您必须设置RMI注册表或LDAP服务器。如果不使用外部目录，则RMI连接器存根将被编码到JMX服务URL中。</p>
                  <p>以下各节描述了可以与使用RMI连接器的查找服务示例结合使用的外部目录。运行本章后面各节中的三个查找服务示例时，将引用这些外部目录。</p>
               </div>
               <div class="sect3"><a id="GUID-B734AA09-9CAE-4656-826D-DE4266A13D20" name="GUID-B734AA09-9CAE-4656-826D-DE4266A13D20"></a><h4 id="JSJMX-GUID-B734AA09-9CAE-4656-826D-DE4266A13D20" class="sect4">外部RMI注册中心</h4>
                  <div>
                     <p>要在外部RMI注册表中注册RMI连接器服务器存根以供实现JRMP传输的连接器使用，请执行以下操作：</p>
                     <ol>
                        <li>
                           <p>在本地主机的端口9999上启动RMI注册表。</p> 
                           <p>与<a href="jmx-connectors.html#GUID-A4CA2A4D-49EE-4DA8-871F-DD633C28DAD9">JMX连接器一样</a> ，RMI注册表用于存储实现JRMP传输的RMI连接器的RMI连接器存根。
                           </p>
                           <div class="p"><pre class="pre codeblock"><code>$ rmiregistry 9999 &amp;</code></pre></div>
                        </li>
                        <li>
                           <p>为了方便您键入命令，请为RMI注册表的地址创建一个环境变量。</p> 
                           <p>为了缩短您在运行示例时输入的命令，请将RMI注册表的服务URL设置为环境变量， <code class="codeph">jndirmi</code> 。在这些示例中，服务URL以JNDI形式给出。请参阅API文档，以了解<code class="codeph">javax.management.remote.rmi</code>包，用于解释JNDI形式。如果要在本地计算机以外的计算机上运行外部目录，则必须指定该计算机的主机名，而不是localhost。
                           </p>
                           <div class="p"><pre class="pre codeblock"><code>$ jndirmi="rmi://localhost:9999"</code></pre></div>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-08ED790A-3FCC-4436-8056-0FBD805F02D9" name="GUID-08ED790A-3FCC-4436-8056-0FBD805F02D9"></a><h4 id="JSJMX-GUID-08ED790A-3FCC-4436-8056-0FBD805F02D9" class="sect4">外部LDAP注册表</h4>
                  <div>
                     <p>要在外部LDAP注册表中注册RMI连接器服务器存根，以供实现JRMP传输的连接器使用：</p>
                     <ol>
                        <li>
                           <p>启动LDAP服务器。</p> 
                           <p>尽管在服务器上必须知道用于表示LDAP目录中Java对象的架构，但您还是可以选择使用LDAP服务器。有关详细信息，请参见相关的征求意见文档（RFC）。</p>
                           <p><code class="codeph"><a href="http://www.ietf.org/rfc/rfc2713.txt" target="_blank">http://www.ietf.org/rfc/rfc2713.txt</a></code></p>
                        </li>
                        <li>
                           <p>创建一个域组件后缀。</p> 
                           <p>这些示例要求您创建以下域组件后缀：</p>
                           <div class="p"><pre class="pre codeblock"><code>dc=Test</code></pre></div>
                           <p>有关如何配置服务器和创建此后缀的详细信息，请参阅LDAP服务器随附的文档。</p>
                        </li>
                        <li>
                           <p>为方便起见，请将以下LDAP参数设置为环境变量。</p> 
                           <p>这些变量用于缩短启动在外部服务中注册RMI连接器存根的查找服务示例中的Server和Client类时键入的命令。</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>运行LDAP服务器的计算机的名称（ <code class="codeph"><span class="variable" translate="no">ldap_host</span></code> ）</p><pre class="pre codeblock"><code>$ ldaphost=<span class="variable" translate="no">ldap_host</span></code></pre></li>
                              <li>
                                 <p>LDAP服务器运行的端口（ <code class="codeph"><span class="variable" translate="no">ldap_port</span></code> ）</p><pre class="pre codeblock"><code>$ ldapport=<span class="variable" translate="no">ldap_port</span></code></pre></li>
                              <li>
                                 <p>LDAP通用名称属性，在这些示例中为“目录管理器”</p><pre class="pre codeblock"><code>$ principal=”cn=Directory Manager”</code></pre></li>
                              <li>
                                 <p>LDAP服务器所需的密码。提供您的LDAP服务器的密码。</p><pre class="pre codeblock"><code>$ credentials=<span class="variable" translate="no">your_ldap_password</span></code></pre></li>
                              <li>
                                 <p>LDAP服务器的地址。在此示例中，LDAP服务器的服务URL以JNDI形式给出，并由变量jndildap标识。</p><pre class="pre codeblock"><code>$ jndildap="ldap://$ldaphost:$ldapport"</code></pre></li>
                           </ul>
                        </li>
                     </ol>
                     <p>现在您可以运行其他查找服务示例。</p>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-4F759996-3FE4-43EE-8651-11C7AA88C54A" name="GUID-4F759996-3FE4-43EE-8651-11C7AA88C54A"></a><h3 id="JSJMX-GUID-4F759996-3FE4-43EE-8651-11C7AA88C54A" class="sect3">服务定位协议（SLP）查找服务</h3>
               <div>
                  <p>JMX技术指定如何向SLP查找服务注册RMI连接器。</p>
                  <p>此示例演示JMX远程API连接器客户端如何找到并连接到已向SLP查找服务注册的连接器服务器。本示例执行以下操作：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>中介：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>创建一个MBean服务器</p>
                           </li>
                           <li>
                              <p>获取指向SLP查找服务的指针</p>
                           </li>
                           <li>
                              <p>创建连接器服务器</p>
                           </li>
                           <li>
                              <p>向SLP查找服务注册连接器地址</p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>客户端：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>获取指向SLP查找服务的指针</p>
                           </li>
                           <li>
                              <p>查找在SLP查找服务中注册的所有连接器服务器</p>
                           </li>
                           <li>
                              <p>创建一个JMX远程API连接器</p>
                           </li>
                           <li>
                              <p>检索有关MBean服务器中的MBean的信息</p>
                           </li>
                        </ul>
                     </li>
                  </ul>
                  <p>本示例假定您已经熟悉<a href="http://www.ietf.org/rfc/rfc2614.txt" target="_blank">SLP技术</a> 。本示例提供的代码符合RFC 2614定义的Oracle SLP实现（请参见<a href="http://www.ietf.org/rfc/rfc2614.txt" target="_blank">http://www.ietf.org/rfc/rfc2614.txt）</a> 。 Oracle的SLP实现在Solaris操作环境中的目录中可用<code class="codeph">/usr/share/lib/slp</code> 。如果未运行Solaris操作环境，则必须获得符合RFC 2614第5节的SLP版本。您可以从<a href="http://www.openslp.org/" target="_blank">http://www.openslp.org/</a>下载OpenSLP Java实现<a href="http://www.openslp.org/" target="_blank">。</a></p>
                  <div class="section">
                     <p class="subhead2" id="GUID-4F759996-3FE4-43EE-8651-11C7AA88C54A__GUID-1B38465F-27B0-4197-84BA-C872FEA04DDC">分析SLP查找示例类</p>
                     <ol>
                        <li> 
                           <p>将源代码从<a href="service-location-protocol-slp-lookup-service-example.html">服务定位协议（SLP）查找服务</a>复制到<code class="codeph"><span class="variable" translate="no">work_dir</span>/jmx_examples/Lookup/slp</code> 。该目录中的文件应包括：</p>
                           <ul style="list-style-type:disc">
                              <li><code class="codeph">README</code></li>
                              <li><code class="codeph">Server.java</code></li>
                              <li><code class="codeph">Client.java</code></li>
                           </ul>
                        </li>
                        <li>
                           <p>打开<code class="codeph">*.java</code>在IDE或文本编辑器中的文件。
                           </p>
                        </li>
                     </ol>
                     <p>以下各节分析这些类中的每一个，并说明它们如何执行示例中描述的操作。</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div class="sect3"><a id="GUID-BE193215-C7B5-426C-8454-B110A42F899E" name="GUID-BE193215-C7B5-426C-8454-B110A42F899E"></a><h4 id="JSJMX-GUID-BE193215-C7B5-426C-8454-B110A42F899E" class="sect4">SLP查找示例中的Server.java</h4>
                  <div>
                     <p>由于其大小，SLP查找服务<code class="codeph">Server.java</code>以下代码摘录显示了该类：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="lookup-services.html#GUID-BE193215-C7B5-426C-8454-B110A42F899E__CODEEXAMPLE4-1SLPLOOKUPSERVICEEXAMP-BFC0C449">示例4-1 SLP查找服务示例类Server.java（摘录1）</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-BE193215-C7B5-426C-8454-B110A42F899E__CODEEXAMPLE4-2SLPLOOKUPSERVICEEXAMP-BFC0C80A">示例4-2 SLP查找服务示例类Server.java（摘录2）</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-BE193215-C7B5-426C-8454-B110A42F899E__CODEEXAMPLE4-3SLPLOOKUPSERVICEEXAMP-BFC0CB65">示例4-3 SLP查找服务示例类Server.java（摘录3）</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-BE193215-C7B5-426C-8454-B110A42F899E__CODEEXAMPLE4-4SLPLOOKUPSERVICEEXAMP-BFC0CFC8">示例4-4 SLP查找服务示例类Server.java（摘录4）</a></p>
                        </li>
                     </ul>
                     <p>有关此示例中使用的SLP代码的说明，请参阅RFC 2614和SLP的API文档。</p>
                     <div class="section" id="GUID-BE193215-C7B5-426C-8454-B110A42F899E__CODEEXAMPLE4-1SLPLOOKUPSERVICEEXAMP-BFC0C449">
                        <p class="subhead3" id="GUID-BE193215-C7B5-426C-8454-B110A42F899E__GUID-0543A1B2-80F6-43EC-828D-F05626881541">示例4-1 SLP查找服务示例类Server.java（摘录1）</p><pre class="pre codeblock"><code>
 
public class Server { 
   public final static int <span class="bold">JMX_DEFAULT_LEASE = 300</span>; 
   public final static String JMX_SCOPE = "DEFAULT"; 
 
   private final MBeanServer mbs; 
   public Server() { 
       mbs = <span class="bold">MBeanServerFactory.createMBeanServer()</span>; 
   } 
    
[...] 
 
</code></pre><p><span class="bold">例4-1</span>设置默认的SLP租约<code class="codeph">JMX_DEFAULT_LEASE</code>的缺省租期为300秒，对应于URL注册的时间长度，并显示了MBean服务器的初始创建<code class="codeph">mbs</code> 。
                        </p>
                        <p>在示例中未显示的代码中，然后定义一个SLP广告商<code class="codeph">slpAdvertiser</code>以及SLP服务网址<code class="codeph">url</code> 。的<code class="codeph">slpAdvertiser</code>用于在SLP查找服务中注册服务URL。的<code class="codeph">SCOPE</code>和<code class="codeph">agentName</code>在SLP中注册为查找属性。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-BE193215-C7B5-426C-8454-B110A42F899E__CODEEXAMPLE4-2SLPLOOKUPSERVICEEXAMP-BFC0C80A">
                        <p class="subhead3" id="GUID-BE193215-C7B5-426C-8454-B110A42F899E__GUID-6E39C14F-B7AD-43B1-B3C5-4CEA8B2179E5">示例4-2 SLP查找服务示例类Server.java（摘录2）</p><pre class="pre codeblock"><code>
 
[...] 
 
   public static void register(JMXServiceURL jmxUrl, String name) 
     throws ServiceLocationException { 
     <span class="bold">ServiceURL serviceURL =</span> 
<span class="bold">          new ServiceURL(jmxUrl.toString(),</span> 
<span class="bold">                         JMX_DEFAULT_LEASE)</span>; 
     debug("ServiceType is: " + serviceURL.getServiceType()); 
     Vector attributes = new Vector(); 
     Vector attrValues = new Vector(); 
     attrValues.add(JMX_SCOPE); 
     ServiceLocationAttribute attr1 = 
          new ServiceLocationAttribute("SCOPE", attrValues); 
     attributes.add(attr1); 
     attrValues.removeAllElements(); 
     <span class="bold">attrValues.add(name);</span> 
<span class="bold">     ServiceLocationAttribute attr2 =</span> 
<span class="bold">          new ServiceLocationAttribute("AgentName", attrValues);</span> 
     attributes.add(attr2); 
     final <span class="bold">Advertiser</span> slpAdvertiser = 
          ServiceLocationManager.getAdvertiser(Locale.US); 
     slpAdvertiser.<span class="bold">register(serviceURL, attributes)</span>; 
      
   }  
 
[...] 
 
</code></pre><p><span class="bold">例4-2</span>显示了使用SLP查找服务注册JMX连接器服务器的URL。
                        </p>
                        <p>JMX服务网址<code class="codeph">jmxUrl</code>是连接器服务器的地址，可以通过调用<code class="codeph">getAddress()</code>的方法<code class="codeph">JMXConnectorServer</code>连接器服务器启动时。
                        </p>
                        <p>SLP查找属性，即注册连接器服务器地址所依据的范围和代理名称（ <code class="codeph">name</code> ），然后由SLP类指定<code class="codeph">ServiceLocationAttribute</code> 。的<code class="codeph">AgentName</code>属性是必填属性，但其他可选属性（例如<code class="codeph">ProtocolType</code> ， <code class="codeph">AgentHost</code>和<code class="codeph">Property</code>也可以在SLP查找服务中注册。
                        </p>
                        <p>最后，JMX连接器服务器地址通过以下方式在SLP服务中注册： <code class="codeph">register()</code>的方法<code class="codeph">Advertiser</code>界面， <code class="codeph">serviceURL</code>和<code class="codeph">attributes</code>作为参数传递。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-BE193215-C7B5-426C-8454-B110A42F899E__CODEEXAMPLE4-3SLPLOOKUPSERVICEEXAMP-BFC0CB65">
                        <p class="subhead3" id="GUID-BE193215-C7B5-426C-8454-B110A42F899E__GUID-1C97CB52-DF93-4438-9EE9-517ECB9BA855">示例4-3 SLP查找服务示例类Server.java（摘录3）</p><pre class="pre codeblock"><code>
 
[...] 
 
   public JMXConnectorServer rmi(String url) throws 
     IOException, 
     JMException, 
     NamingException, 
     ClassNotFoundException, 
     ServiceLocationException { 
     JMXServiceURL jurl = new JMXServiceURL(url); 
     final HashMap env = new HashMap(); 
     // Environment map attributes 
     [...] 
 
  
     <span>JMXConnectorServer rmis =</span> 
<span>        JMXConnectorServerFactory</span>.newJMXConnectorServer(jurl, env, mbs); 
     final String agentName = System.getProperty("agent.name", 
                                                 "DefaultAgent"); 
     start(rmis, agentName); 
 
     return rmis; 
  } 
[...] 
 
</code></pre><p><span class="bold">例4-3</span>显示了RMI连接器服务器的创建。JMX服务网址<code class="codeph">jurl</code>由字符串构造<code class="codeph">url</code>用于启动<code class="codeph">Server</code>在命令行中。一个名为RMI的连接器服务器<code class="codeph">rmis</code>然后使用环境定义的系统属性创建<code class="codeph">map</code>和地址<code class="codeph">jurl</code> 。
                        </p>
                        <p>然后启动连接器服务器，并将RMI连接器服务器地址注册在SLP查找服务中，名称为<code class="codeph">agentName</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-BE193215-C7B5-426C-8454-B110A42F899E__CODEEXAMPLE4-4SLPLOOKUPSERVICEEXAMP-BFC0CFC8">
                        <p class="subhead3" id="GUID-BE193215-C7B5-426C-8454-B110A42F899E__GUID-395F7753-C513-4FE4-A20E-908BC562A8B3">示例4-4 SLP查找服务示例类Server.java（摘录4）</p><pre class="pre codeblock"><code>
 
[...] 
 
   public void start(JMXConnectorServer server, String agentName) 
      throws IOException, ServiceLocationException { 
      server.start(); 
      final JMXServiceURL address = server.getAddress(); 
      register(address,agentName); 
   } 
    
[...] 
 
</code></pre><p><span class="bold">例4-4</span>显示了连接器服务器的启动<code class="codeph">server</code>和注册<code class="codeph">server</code>在具有给定地址的SLP查找服务中<code class="codeph">address</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-47106B0D-94D5-4F0F-995F-1B2291E8711D" name="GUID-47106B0D-94D5-4F0F-995F-1B2291E8711D"></a><h4 id="JSJMX-GUID-47106B0D-94D5-4F0F-995F-1B2291E8711D" class="sect4">SLP查找示例中的Client.java</h4>
                  <div>
                     <p>SLP查找服务<code class="codeph">Client.java</code>下面的代码摘录系列中分析了该类：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="lookup-services.html#GUID-47106B0D-94D5-4F0F-995F-1B2291E8711D__CODEEXAMPLE4-1SLPLOOKUPSERVICEEXAMP-BFBAFA35">示例4-5 SLP查找服务示例类Client.java（摘录1）</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-47106B0D-94D5-4F0F-995F-1B2291E8711D__CODEEXAMPLE4-2SLPLOOKUPSERVICEEXAMP-BFBAFE9D">示例4-6 SLP查找服务示例类Client.java（摘录2）</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-47106B0D-94D5-4F0F-995F-1B2291E8711D__CODEEXAMPLE4-7SLPLOOKUPSERVICEEXAMP-BFC2ACEA">示例4-7 SLP查找服务示例类Client.java（摘录3）</a></p>
                        </li>
                     </ul>
                     <div class="section" id="GUID-47106B0D-94D5-4F0F-995F-1B2291E8711D__CODEEXAMPLE4-1SLPLOOKUPSERVICEEXAMP-BFBAFA35">
                        <p class="subhead3" id="GUID-47106B0D-94D5-4F0F-995F-1B2291E8711D__GUID-D3A1F6DC-CB2E-4D36-87DD-EC5801FDE5EE">示例4-5 SLP查找服务示例类Client.java（摘录1）</p><pre class="pre codeblock"><code>
 
public class Client { 
 
    public final static String JMX_SCOPE = "DEFAULT"; 
 
    public static Locator <span>getLocator()</span> throws ServiceLocationException { 
      final Locator slpLocator = 
          <span>ServiceLocationManager.getLocator(Locale.US)</span>; 
      return slpLocator; 
    } 
     
      public static List lookup(Locator slpLocator, String name) 
          throws IOException, ServiceLocationException { 
 
   
          final ArrayList list = new ArrayList(); 
          Vector scopes = new Vector(); 
 
          scopes.add(JMX_SCOPE); 
          <span>String query = </span> 
<span>              "(&amp;(AgentName=" + ((name!=null)?name:"*") + "))"</span>; 
 
          <span>ServiceLocationEnumeration result =</span> 
<span>              slpLocator.findServices(new ServiceType("service:jmx"),</span> 
<span>                                      scopes, query)</span>; 
 
          while(result.hasMoreElements()) { 
                <span>final ServiceURL surl = (ServiceURL) result.next()</span>; 
                 
 
             <span>JMXServiceURL jmxUrl = new JMXServiceURL(surl.toString())</span>; 
             try { 
                  <span>JMXConnector client =</span> 
<span>                     JMXConnectorFactory.newJMXConnector(jmxUrl,null)</span>; 
                  if (client != null) list.add(client); 
             } catch (IOException x ) {  
             [...] 
             } 
          } 
      } 
      return list; 
    } 
 
</code></pre><p><span class="bold">例4-5</span>获得了SLP服务， <code class="codeph">Locator</code>通过调用<code class="codeph">getLocator</code> SLP类的方法<code class="codeph">ServiceLocationManager</code> 。的<code class="codeph">Client</code>然后检索给定代理名或与特定模式匹配的代理名下在SLP服务中注册的所有连接器服务器。如果没有指定代理名称，何时<code class="codeph">Client</code>启动后，将考虑所有座席名称。
                        </p>
                        <p>JMX技术服务网址， <code class="codeph">jmxUrl</code>会为SLP检索到的每个代理以及每个代理的SLP服务URL生成， <code class="codeph">surl</code> ，作为参数传递到<code class="codeph">JMXServiceURL</code>实例。网址， <code class="codeph">jmxUrl</code> ，然后传递给<code class="codeph">newJMXConnector()</code>的方法<code class="codeph">JMXConnectorFactory</code> ，以创建一个名为的新连接器客户端<code class="codeph">client</code>对于在SLP服务中注册的每个代理。
                        </p>
                        <p>检索到的连接器客户端存储在名为<code class="codeph">list</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-47106B0D-94D5-4F0F-995F-1B2291E8711D__CODEEXAMPLE4-2SLPLOOKUPSERVICEEXAMP-BFBAFE9D">
                        <p class="subhead3" id="GUID-47106B0D-94D5-4F0F-995F-1B2291E8711D__GUID-07139EA2-825D-4FB9-B715-5970FDC60134">示例4-6 SLP查找服务示例类Client.java（摘录2）</p><pre class="pre codeblock"><code>
 
<span class="bold">public static void listMBeans(MBeanServerConnection server)</span> 
     throws IOException { 
 
     final Set names = server.queryNames(null,null); 
     for (final Iterator i=names.iterator(); i.hasNext(); ) { 
          ObjectName name = (ObjectName)i.next(); 
          System.out.println("Got MBean: "+name); 
          try { 
               MBeanInfo info = 
                  server.getMBeanInfo((ObjectName)name); 
               MBeanAttributeInfo[] attrs = info.getAttributes(); 
               if (attrs == null) continue; 
               for (int j=0; j&lt;attrs.length; j++) { 
                    try { 
                         Object o = 
                         server.getAttribute(name,attrs[j].getName()); 
                         System.out.println("\t\t" + attrs[j].getName() + 
                         " = "+o); 
                    } catch (Exception x) { 
                         System.err.println("JmxClient failed to get " + 
                                             attrs[j].getName() + x); 
                         x.printStackTrace(System.err); 
                    } 
     } 
} 
 
</code></pre><p>在<span class="bold">示例4-6中</span> ，对<code class="codeph">MBeanServerConnection</code>对于从存储在SLP服务中的连接器服务器地址创建的每个连接器客户端，都将检索。检索所有MBean及其属性的列表。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-47106B0D-94D5-4F0F-995F-1B2291E8711D__CODEEXAMPLE4-7SLPLOOKUPSERVICEEXAMP-BFC2ACEA">
                        <p class="subhead3" id="GUID-47106B0D-94D5-4F0F-995F-1B2291E8711D__GUID-A6CDF0E6-24C4-4FB7-9BB0-06A87732B49E">示例4-7 SLP查找服务示例类Client.java（摘录3）</p><pre class="pre codeblock"><code>
 
public static void main(String[] args) { 
      try { 
           <span>final String agentName = System.getProperty("agent.name")</span>; 
           <span>final Locator slpLocator = getLocator()</span>; 
           List l = lookup(slpLocator,agentName); 
           int j = 1; 
           for (Iterator i=l.iterator();i.hasNext();j++) { 
                JMXConnector c1 = (JMXConnector) i.next(); 
                if (c1 != null) { 
                    try { 
                         c1.connect(env); 
                    } catch (IOException x) { 
                         System.err.println ("Connection failed: " + x); 
                         x.printStackTrace(System.err); 
                         continue; 
                    } 
 
                    <span>MBeanServerConnection conn =</span> 
<span>                         c1.getMBeanServerConnection()</span>; 
 
                    try { 
                         listMBeans(conn); 
                    } catch (IOException x) { 
                         x.printStackTrace(System.err); 
                    } 
                    try { 
                         c1.close(); 
                    } catch (IOException x) { 
                         x.printStackTrace(System.err); 
                    } 
                } 
           } 
      } catch (Exception x) { 
           x.printStackTrace(System.err); 
      } 
} 
 
</code></pre><p>在<span class="bold">示例4-7中</span> ， <code class="codeph">agent.name</code>通过调用检索属性<code class="codeph">getProperty()</code>的方法<code class="codeph">System</code>类，并且通过调用SLP查找服务<code class="codeph">getLocator()</code>的方法<code class="codeph">Locator</code> 。
                        </p>
                        <p>所有代理商都命名<code class="codeph">agentName</code>然后查找它们，并与发现的代理建立连接。如果未指定代理，则查找所有代理。建立与创建的MBean服务器的连接<code class="codeph">Server</code> ，并列出其中的所有MBean，然后再关闭连接。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-A70EB27A-8C8A-4DAC-9E56-282D8B753158" name="GUID-A70EB27A-8C8A-4DAC-9E56-282D8B753158"></a><h4 id="JSJMX-GUID-A70EB27A-8C8A-4DAC-9E56-282D8B753158" class="sect4">运行SLP查找服务示例</h4>
                  <div>
                     <p>本示例演示了如何使用SLP查找服务来查找使用RMI默认传输JRMP的RMI连接器服务器。如<a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">初始配置中所述</a> ，不同的外部目录用于注册RMI连接器存根。
                     </p>
                     <p>演示了传输和外部目录的以下组合：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>通过JRMP传输的RMI连接器，具有：</p> 
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>没有外部目录</p>
                              </li>
                              <li>
                                 <p>RMI注册表</p>
                              </li>
                              <li>
                                 <p>LDAP注册表</p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <p>除了您在“ <a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">初始配置”中</a>执行的操作外，您还必须执行特定于此示例的其他操作，然后才能运行使用SLP的示例。然后，您可以结合使用SLP和JMX技术支持的两个连接器来开始查找连接器。
                     </p>
                     <div class="infoboxnote" id="GUID-A70EB27A-8C8A-4DAC-9E56-282D8B753158__GUID-18F37B96-5D5C-4B75-B6D4-5A85EF2C3CBB">
                        <p class="notep1">注意：</p>
                        <p>在运行示例时，为了帮助您跟踪已使用哪种传输方式创建了哪个代理，代理名称包含字母后缀，该后缀与相应部分的字母相同。例如，“ <a href="lookup-services.html#GUID-A70EB27A-8C8A-4DAC-9E56-282D8B753158__STARTTHESERVER-BFC76E5E">启动服务器”中</a>的代理子步骤a。<span class="bold">通过JRMP的RMI连接器，没有外部目录</span> 。叫做<code class="codeph">example-server-a</code> 。
                        </p>
                     </div>
                     <p>要运行该示例，请执行以下步骤中描述的步骤：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="lookup-services.html#GUID-A70EB27A-8C8A-4DAC-9E56-282D8B753158__SETTINGUPTHESLPLOOKUPSERVICEEXAMPLE-BFC5DF65">设置SLP查找服务示例</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-A70EB27A-8C8A-4DAC-9E56-282D8B753158__STARTTHESERVER-BFC76E5E">启动服务器</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-A70EB27A-8C8A-4DAC-9E56-282D8B753158__STARTTHECLIENT-BFC77262">启动客户端</a></p>
                        </li>
                     </ul>
                     <div class="section" id="GUID-A70EB27A-8C8A-4DAC-9E56-282D8B753158__SETTINGUPTHESLPLOOKUPSERVICEEXAMPLE-BFC5DF65">
                        <p class="subhead3" id="GUID-A70EB27A-8C8A-4DAC-9E56-282D8B753158__GUID-D0B7962B-F80A-42B1-B5D4-214316794E56">设置SLP查找服务示例</p>
                        <p>在此示例中可以运行的所有不同传输都需要执行以下步骤。</p>
                        <ol>
                           <li>
                              <p>为了方便在编译和运行类时定义一个附加的环境变量。除了在<a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">初始配置</a>中设置的公共环境变量外，您还需要将路径添加到SLP服务。
                              </p>
                              <p>如果使用的是Solaris操作环境，请添加以下变量：</p><pre class="pre codeblock"><code>$ SLPLIB=/usr/share/lib/slp</code></pre><p>如果您使用其他平台，请设置<code class="codeph">SLPLIB</code>适合您所使用的平台。
                              </p>
                           </li>
                           <li>
                              <p>定义并导出<code class="codeph">classp</code>环境变量。此示例需要一个包含SLP的Java归档（JAR）文件的类路径：</p><pre class="pre codeblock"><code>$ classp=$SLPLIB/slp.jar</code></pre></li>
                           <li>
                              <p>编译例子<code class="codeph">Client</code>和<code class="codeph">Server</code>通过键入以下命令来分类：</p><pre class="pre codeblock"><code>$ javac -d . -classpath $classp Server.java Client.java</code></pre></li>
                           <li>
                              <p>启动SLP守护程序。</p>
                              <p>如果使用的是Solaris操作环境，请键入以下命令，该命令要求您知道超级用户密码：</p><pre class="pre codeblock"><code>$ su root -c "java -cp $SLPLIB/slpd.jar com.sun.slp.slpd &amp;"
Password:[<span class="variable" translate="no">type superuser password</span>]</code></pre><p>如果您没有运行Solaris系统，请根据所使用的SLP的实现启动SLP守护程序。</p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-A70EB27A-8C8A-4DAC-9E56-282D8B753158__STARTTHESERVER-BFC76E5E">
                        <p class="subhead3" id="GUID-A70EB27A-8C8A-4DAC-9E56-282D8B753158__GUID-718220A8-4355-4BA2-B7D0-5969915BE863">启动服务器</p>
                        <p>您用来启动<code class="codeph">Server</code>根据您使用的外部目录而有所不同。在开始之前<code class="codeph">Client</code> ，请启动以下一个或多个实例<code class="codeph">Server</code> 。您可以启动<code class="codeph">Server</code>具有不同的运输方式和外部注册表。
                        </p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="bold">不使用外部目录的JRMP上的RMI连接器：</span>启动<code class="codeph">Server</code>通过键入以下命令。
                              </p><pre class="pre codeblock"><code>$ java -classpath .:$classp -Ddebug=true \ 
  -Dagent.name=example-server-a \ 
  -Durl ="service:jmx:rmi://" \ 
  slp.Server &amp; 
</code></pre><p>在此命令中：</p>
                              <ul style="list-style-type:disc">
                                 <li>的价值<code class="codeph">debug</code>设置为true时，当<code class="codeph">Server</code>运行。
                                 </li>
                                 <li>代理的名称是<code class="codeph">example-server-a</code> 。
                                 </li>
                                 <li>服务URL指定所选连接器为RMI连接器，并在RMI默认传输JRMP上运行。</li>
                              </ul>
                              <p>当。。。的时候<code class="codeph">Server</code>启动后，您将看到有关RMI连接器创建的确认以及SURL服务中其URL的注册。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">使用RMI注册表作为外部目录，通过JRMP上的RMI连接器：</span>启动<code class="codeph">Server</code>通过键入以下命令。
                              </p><pre class="pre codeblock"><code> $ java -classpath .:$classp -Ddebug=true \ 
  -Dagent.name=example-server-b \ 
  -Durl="service:jmx:rmi:///jndi/${jndirmi}/server" \ 
  slp.Server &amp; 
</code></pre><p>在此命令中：</p>
                              <ul style="list-style-type:disc">
                                 <li>创建的代理的名称为<code class="codeph">example-server-b</code> 。
                                 </li>
                                 <li>服务URL将选定的连接器指定为JRMP上的RMI，并且存储RMI连接器存根（服务器）的外部目录是您在<a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">Initial Configuration中</a>标识为jndirmi的RMI注册表。
                                 </li>
                              </ul>
                              <p>当。。。的时候<code class="codeph">Server</code>启动后，您将看到有关RMI连接器创建的确认以及SURL服务中其URL的注册。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">使用LDAP作为外部目录的JRMP上的RMI连接器：</span>启动<code class="codeph">Server</code>通过键入以下命令。
                              </p>
                              <p></p><pre class="pre codeblock"><code> $ java -classpath .:$classp -Ddebug=true \ 
  -Dagent.name=example-server-c \ 
  -Durl="service:jmx:rmi:///jndi/${jndildap}/cn=x,dc=Test" \ 
  -Djava.naming.security.principal="$principal" \ 
  -Djava.naming.security.credentials="$credentials" \ 
  slp.Server &amp; 
</code></pre><p>在此命令中：</p>
                              <ul style="list-style-type:disc">
                                 <li>创建的代理的名称是<code class="codeph">example-server-c</code> 。
                                 </li>
                                 <li>服务URL将选定的连接器指定为JRMP上的RMI，并且存储RMI连接器存根的外部目录是您标识为的LDAP服务器。 <code class="codeph">jndildap</code>在<a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">初始配置中</a> 。
                                 </li>
                                 <li>存根已在<code class="codeph">Test</code> LDAP服务器中的域组件。
                                 </li>
                                 <li>通用名称属性， <code class="codeph">principal</code>和密码<code class="codeph">credentials</code>被赋予访问LDAP服务器的权限。
                                 </li>
                              </ul>
                              <p>当。。。的时候<code class="codeph">Server</code>启动后，您将看到有关RMI连接器创建的确认，以及在代理名称下的SLP服务中其URL的注册。 <code class="codeph">example-server-c</code> 。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-A70EB27A-8C8A-4DAC-9E56-282D8B753158__STARTTHECLIENT-BFC77262">
                        <p class="subhead3" id="GUID-A70EB27A-8C8A-4DAC-9E56-282D8B753158__GUID-44EEB450-1D0D-4FA7-8E77-D126952BA141">启动客户端</p>
                        <p>开始之后<code class="codeph">Server</code>通过使用您选择的传输目录和外部目录，启动<code class="codeph">Client</code></p><pre class="pre codeblock"><code>$ java -classpath .:$classp -Ddebug=true \ 
     -Djava.naming.security.principal="$principal" \ 
     -Djava.naming.security.credentials="$credentials" \ 
     slp.Client 
</code></pre><p>您将看到输出确认已检测到由代理创建的代理。 <code class="codeph">Server</code>并在查找服务中注册。您还将看到与代理建立的连接的标识和确认。
                        </p>
                        <p>要查找特定的代理，请键入以下命令：</p><pre class="pre codeblock"><code>$ java -classpath .:$classp -Ddebug=true \  
     -Djava.naming.security.principal="$principal" \ 
     -Djava.naming.security.credentials="$credentials" \ 
     -Dagent.name="agentName" \ 
    slp.Client 
</code></pre><p>在上面显示的此命令中， <span class="italic">agentName</span>是您要查找的代理的名称。您可以使用来指定部分座席名称<code class="codeph">*</code> ;例如， <code class="codeph">x*</code>所有以字母x开头的座席姓名。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-9926AA06-560E-46C7-AA27-8C71EED4F811" name="GUID-9926AA06-560E-46C7-AA27-8C71EED4F811"></a><h3 id="JSJMX-GUID-9926AA06-560E-46C7-AA27-8C71EED4F811" class="sect3">Jini查询服务</h3>
               <div>
                  <p>此示例演示JMX技术连接器客户端如何查找并连接到在Jini查找服务中注册的连接器服务器。本示例执行以下操作：</p>
                  <ul style="list-style-type:disc">
                     <li>中介：<ul style="list-style-type:disc">
                           <li>创建一个MBean服务器</li>
                           <li>创建连接器服务器</li>
                           <li>向Jini查找服务注册连接器地址</li>
                        </ul>
                     </li>
                     <li>客户端：<ul style="list-style-type:disc">
                           <li>获取指向Jini查找服务的指针</li>
                           <li>查找在Jini查找服务中注册的所有连接器服务器</li>
                           <li>创建一个JMX远程API连接器</li>
                           <li>检索有关MBean服务器中的MBean的信息</li>
                        </ul>
                     </li>
                  </ul>
                  <div class="section">
                     <p class="subhead2" id="GUID-9926AA06-560E-46C7-AA27-8C71EED4F811__GUID-07352586-74A1-45AD-889C-4DB135A78FB2">分析示例类</p>
                     <ol>
                        <li> 
                           <p>将源代码从<a href="jini-lookup-service-example.html">Jini Lookup Service</a>复制到<code class="codeph"><span class="variable" translate="no">work_dir</span>/jmx_examples/Lookup/jini</code>目录。该目录中的文件应包括：</p>
                           <ul style="list-style-type:disc">
                              <li><code class="codeph">README</code></li>
                              <li><code class="codeph">Server.java</code></li>
                              <li><code class="codeph">Client.java</code></li>
                              <li><code class="codeph">java.policy</code></li>
                              <li><code class="codeph">jini.properties.template</code></li>
                           </ul>
                        </li>
                        <li>打开<code class="codeph">*.java</code> ，IDE或文本编辑器中的文件。
                        </li>
                     </ol>
                     <p>以下各节分析Jini查找服务示例中使用的每个类，并说明它们如何执行上述操作。</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div class="sect3"><a id="GUID-CFB6BE50-E982-47FF-BABE-8A4F9A505471" name="GUID-CFB6BE50-E982-47FF-BABE-8A4F9A505471"></a><h4 id="JSJMX-GUID-CFB6BE50-E982-47FF-BABE-8A4F9A505471" class="sect4">Jini查找服务示例中的Server.java</h4>
                  <div>
                     <p>由于其大小，Jini查找服务<code class="codeph">Server.java</code>以下代码摘录中分析了该类：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="lookup-services.html#GUID-CFB6BE50-E982-47FF-BABE-8A4F9A505471__CODEEXAMPLE4-8JINILOOKUPSERVICEEXAM-C1BAB206">示例4-8 Jini查找服务示例类Server.java（摘录1）</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-CFB6BE50-E982-47FF-BABE-8A4F9A505471__CODEEXAMPLE4-9JINILOOKUPSERVICEEXAM-C1BAB5D7">示例4-9 Jini查找服务示例类Server.java（摘录2）</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-CFB6BE50-E982-47FF-BABE-8A4F9A505471__CODEEXAMPLE4-10JINILOOKUPSERVICEEXA-C1BAC2AA">示例4-10 Jini查找服务示例类Server.java（摘录3）</a></p>
                        </li>
                     </ul>
                     <div class="section" id="GUID-CFB6BE50-E982-47FF-BABE-8A4F9A505471__CODEEXAMPLE4-8JINILOOKUPSERVICEEXAM-C1BAB206">
                        <p class="subhead3" id="GUID-CFB6BE50-E982-47FF-BABE-8A4F9A505471__GUID-6C121ACF-15E6-4FA7-9714-DB7C4E81396D">示例4-8 Jini查找服务示例类Server.java（摘录1）</p><pre class="pre codeblock"><code>public class Server { 
   private final MBeanServer mbs; 
   private static boolean debug = false; 
   public Server() { 
     mbs = <span class="bold">MBeanServerFactory.createMBeanServer()</span>; 
   } 
 
[...] 
</code></pre><p>例4-8显示了MBean服务器的创建<code class="codeph">mbs</code> 。与SLP示例一样，JMX服务URL和代理名称被传递到<code class="codeph">Server</code>在命令行启动时。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-CFB6BE50-E982-47FF-BABE-8A4F9A505471__CODEEXAMPLE4-9JINILOOKUPSERVICEEXAM-C1BAB5D7">
                        <p class="subhead3" id="GUID-CFB6BE50-E982-47FF-BABE-8A4F9A505471__GUID-49B234E2-B3B8-4D48-A92F-9DB7A55BED48">示例4-9 Jini查找服务示例类Server.java（摘录2）</p><pre class="pre codeblock"><code>[...] 
 
   public JMXConnectorServer rmi(String url) 
      throws IOException, JMException, ClassNotFoundException { 
      JMXServiceURL jurl = new JMXServiceURL(url); 
      final HashMap env = new HashMap(); 
      // Environment map attributes 
     [...] 
     JMXConnectorServer rmis = 
        JMXConnectorServerFactory.newJMXConnectorServer(jurl, env, mbs); 
 
     final String agentName = System.getProperty("agent.name", 
                                                 "DefaultAgent"); 
 
     start(rmis,env,agentName); 
 
     return rmis; 
   } 
    
[...] 
 
</code></pre><p>例4-9显示了如何创建名为RMI的连接器服务器<code class="codeph">rmis</code> ，使用环境地图定义的系统属性， <code class="codeph">env,</code>和地址， <code class="codeph">jurl</code> 。
                        </p>
                        <p>RMI连接器服务器， <code class="codeph">rmis,</code>开始。RMI连接器服务器地址在Jini查找服务中以名称注册。 <code class="codeph">agentName</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-CFB6BE50-E982-47FF-BABE-8A4F9A505471__CODEEXAMPLE4-10JINILOOKUPSERVICEEXA-C1BAC2AA">
                        <p class="subhead3" id="GUID-CFB6BE50-E982-47FF-BABE-8A4F9A505471__GUID-3711BB07-FB70-4D48-AF09-14C96E1FF41F">示例4-10 Jini查找服务示例类Server.java（摘录3）</p><pre class="pre codeblock"><code> [...] 
 
   public void start(<span class="bold">JMXConnectorServer server, Map env, String agentName</span>) 
      throws IOException, ClassNotFoundException { 
      server.start(); 
      final ServiceRegistrar registrar=getRegistrar(); 
      final <span class="bold">JMXConnector proxy = server.toJMXConnector(env);</span> 
      <span class="bold">register</span>(registrar,proxy,agentName); 
   } 
    
   public static ServiceRegistrar getRegistrar() 
      throws IOException, ClassNotFoundException, 
         MalformedURLException { 
      final String jurl = 
         System.getProperty("jini.lookup.url","jini://localhost"); 
      final <span class="bold">LookupLocator lookup = new LookupLocator(jurl);</span> 
      final <span class="bold">ServiceRegistrar registrar = lookup.getRegistrar();</span> 
      if (registrar instanceof Administrable) 
          debug("Registry is administrable."); 
      return registrar; 
   } 
    
   public static ServiceRegistration <span class="bold">register(ServiceRegistrar registrar,</span> 
<span class="bold">                                              JMXConnector proxy, String name)</span> 
      throws IOException { 
      Entry[] serviceAttrs = new Entry[] { 
              new net.jini.lookup.entry.Name(name) 
                       }; 
                        
      System.out.println("Registering proxy: AgentName=" + name ); 
      debug("" + proxy); 
      ServiceItem <span class="bold">srvcItem</span> = new ServiceItem(null, proxy, serviceAttrs); 
      ServiceRegistration srvcRegistration = 
             registrar.register(srvcItem, Lease.ANY); 
      debug("Registered ServiceID: " + 
                              srvcRegistration.getServiceID().toString()); 
      return <span class="bold">srvcRegistration</span>; 
   } 
    
[...] 
 
</code></pre><p>例4-10显示了如何创建名为的连接器服务器<code class="codeph">server</code>与环境图， <code class="codeph">env,</code>以及服务网址， <code class="codeph">jurl</code> 。连接器服务器实例服务器通过调用Jini查找服务方法来获取指向Jini查找服务的指针。 <code class="codeph">LookupLocator.getRegistrar()</code> 。
                        </p>
                        <p>连接器服务器以代理的形式在Jini查找服务中注册，即使用Jini查找服务定位器， <code class="codeph">registrar,</code>以及用于注册连接器服务器的代理名称。代理实际上是连接器服务器的客户端存根，它是通过调用<code class="codeph">toJMXConnector()</code>的方法<code class="codeph">JMXConnectorServer</code> 。
                        </p>
                        <p>注册本身是通过调用<code class="codeph">register()</code> Jini查找服务类的方法<code class="codeph">ServiceRegistrar</code> ，其中包含一系列服务项目。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-EBCBD5FA-A2FC-4DAD-9EE2-B2CE0B8AB3AE" name="GUID-EBCBD5FA-A2FC-4DAD-9EE2-B2CE0B8AB3AE"></a><h4 id="JSJMX-GUID-EBCBD5FA-A2FC-4DAD-9EE2-B2CE0B8AB3AE" class="sect4">Jini查找服务示例中的Client.java</h4>
                  <div>
                     <p>Jini查找服务示例类<code class="codeph">Client.java</code>如代码示例4-11所示。
                     </p>
                     <div class="section">
                        <p class="subhead3" id="GUID-EBCBD5FA-A2FC-4DAD-9EE2-B2CE0B8AB3AE__GUID-4D134F40-4E26-4645-82E7-1C92B6148E47">示例4-11 Jini查找服务示例类Client.java</p><pre class="pre codeblock"><code>public class Client { 
 
   private static boolean debug = false; 
   public static ServiceRegistrar getRegistrar() 
       throws IOException, ClassNotFoundException, MalformedURLException { 
       final String jurl = 
                  System.getProperty("jini.lookup.url","jini://localhost"); 
       final LookupLocator lookup = new LookupLocator(jurl); 
       final ServiceRegistrar registrar = <span>lookup.getRegistrar()</span>; 
       if (registrar instanceof Administrable) 
               debug("Registry is administrable."); 
       return registrar; 
 } 
 
   public static List lookup(ServiceRegistrar registrar, 
           String name) throws IOException { 
       final ArrayList list = new ArrayList(); 
       final Class[] classes = new Class[] {JMXConnector.class}; 
       final Entry[] serviceAttrs = new Entry[] { 
           new net.jini.lookup.entry.Name(name) 
   }; 
    
   ServiceTemplate template = 
        new ServiceTemplate(null,classes,serviceAttrs); 
   ServiceMatches matches = 
        registrar.lookup(template, Integer.MAX_VALUE); 
   for(int i = 0; i &lt; matches.totalMatches; i++) { 
        debug("Found Service: " + matches.items[i].serviceID); 
        if (debug) { 
           if (matches.items[i].attributeSets != null) { 
                   final Entry[] attrs = matches.items[i].attributeSets; 
                   for (int j = 0; j &lt; attrs.length ; j++) { 
                       debug("Attribute["+j+"]=" + attrs[j]); 
               } 
           } 
        } 
 
 
        if(matches.items[i].service != null) { 
            JMXConnector c = (JMXConnector)(matches.items[i].service); 
            debug("Found a JMXConnector: " + c); 
            list.add(c); 
        } 
   } 
   return list; 
} 
 
[...] 
 
</code></pre><p>例4-11显示了连接器客户端如何通过调用来获得指向Jini查找服务的指针。 <code class="codeph">lookup.getRegistrar()</code> 。然后，客户端会获得在Jini查找服务中注册为具有代理名称的条目的连接器列表， <code class="codeph">name</code> 。与SLP示例不同，您传递给的代理名称<code class="codeph">Client</code>启动时，它必须与现有代理名称完全匹配或为null，在这种情况下，Jini查找服务将查找所有代理。
                        </p>
                        <p>在获取连接器列表之后，在此处未显示的代码中，客户端连接到由以下位置启动的MBean服务器： <code class="codeph">Server</code> ，并检索其中注册的所有MBean的列表。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-56F8EB12-0BA0-43EE-9A79-0435AB0B03CD" name="GUID-56F8EB12-0BA0-43EE-9A79-0435AB0B03CD"></a><h4 id="JSJMX-GUID-56F8EB12-0BA0-43EE-9A79-0435AB0B03CD" class="sect4">Jini查找服务示例中的java.policy</h4>
                  <div>
                     <p>的<code class="codeph">java.policy</code>文件是为此示例配置的Java技术安全策略文件。
                     </p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-BD99DA1D-A9F5-4D9E-84B7-C1CDD75CCA12" name="GUID-BD99DA1D-A9F5-4D9E-84B7-C1CDD75CCA12"></a><h4 id="JSJMX-GUID-BD99DA1D-A9F5-4D9E-84B7-C1CDD75CCA12" class="sect4">jini.properties.template</h4>
                  <div>
                     <p>的<code class="codeph">jini.properties.template</code>该文件是Jini网络技术属性文件的模板。您必须为此示例配置它。要使用此文件，请更改<code class="codeph">@INSTALL_HOME_FOR_JINI@</code>并将文件重命名为<code class="codeph">jini.properties</code> 。
                     </p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-EB45E697-04FD-4461-A3A4-358ECB170946" name="GUID-EB45E697-04FD-4461-A3A4-358ECB170946"></a><h4 id="JSJMX-GUID-EB45E697-04FD-4461-A3A4-358ECB170946" class="sect4">运行Jini查找服务示例</h4>
                  <div>
                     <p>本示例演示如何使用Jini查找服务来查找使用RMI默认传输JRMP的RMI连接器服务器。</p>
                     <p>演示了传输和外部目录的以下组合：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>通过JRMP传输的RMI连接器，具有：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>没有外部目录</p>
                              </li>
                              <li>
                                 <p>RMI注册表</p>
                              </li>
                              <li>
                                 <p>LDAP注册表</p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <p>在运行使用Jini查找服务的示例之前，必须完成“ <a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">初始配置”</a>部分中的操作以及该示例特定的操作。
                     </p>
                     <div class="infoboxnote" id="GUID-EB45E697-04FD-4461-A3A4-358ECB170946__GUID-B8229B0C-5210-46DF-B6C5-1556422CEDCD">
                        <p class="notep1">注意：</p>
                        <p>在运行示例时，为了帮助您跟踪使用哪种传输方式创建了哪个代理，代理名称包含一个字母后缀，该后缀与相应部分的字母相同。例如，“ <a href="lookup-services.html#GUID-EB45E697-04FD-4461-A3A4-358ECB170946__RUNNINGTHEJINILOOKUPSERVICEEXAMPLE-C1E12527">启动服务器”中</a>的代理子步骤a。<span class="bold">通过JRMP的RMI连接器，没有外部目录</span> 。被称为<code class="codeph">example-server-a</code> 。
                        </p>
                     </div>
                     <p>要运行该示例，请执行以下步骤中描述的步骤：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="lookup-services.html#GUID-EB45E697-04FD-4461-A3A4-358ECB170946__SETTINGUPTHEJINILOOKUPSERVICEEXAMPL-C1E11F49">设置Jini查找服务示例</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-EB45E697-04FD-4461-A3A4-358ECB170946__RUNNINGTHEJINILOOKUPSERVICEEXAMPLE-C1E12527">启动服务器</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-EB45E697-04FD-4461-A3A4-358ECB170946__STARTTHECLIENT-C1E27ADE">启动客户端</a></p>
                        </li>
                     </ul>
                     <div class="section" id="GUID-EB45E697-04FD-4461-A3A4-358ECB170946__SETTINGUPTHEJINILOOKUPSERVICEEXAMPL-C1E11F49">
                        <p class="subhead3" id="GUID-EB45E697-04FD-4461-A3A4-358ECB170946__GUID-78441C4C-C36E-4B04-9D1E-5E4A535C6EEE">设置Jini查找服务示例</p>
                        <p>在此示例中，您可以运行的所有不同传输都需要执行以下步骤。</p>
                        <ol>
                           <li>
                              <p>为了方便您在编译和运行示例类时，可以定义一些其他环境变量。除了您在“ <a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">初始配置”中</a>设置的公共环境变量外，您还可以将路径添加到Jini查找服务。
                              </p>
                              <p>您安装了Jini网络技术的目录称为<code class="codeph"><span class="variable" translate="no">jini_dir</span></code> 。
                              </p><pre class="pre codeblock"><code>$ JINI_HOME=<span class="variable" translate="no">jini_dir</span></code></pre><pre class="pre codeblock"><code>$ JINILIB=$JINI_HOME/lib</code></pre></li>
                           <li>
                              <p>定义<code class="codeph">classp</code>环境变量。此示例需要Jini查找服务核心和扩展的JAR文件。
                              </p><pre class="pre codeblock"><code>$ classp=$JINILIB/jini-core.jar:$JINILIB/jini-ext.jar</code></pre></li>
                           <li> 
                              <p>创建一个<code class="codeph">jini.properties</code>文件。Solaris，Linux或Mac OS X平台的属性文件与该示例的类位于同一目录中。如果未运行Solaris，Linux或Mac OS X平台，则可以在以下目录中获取平台的属性文件：</p><pre class="pre codeblock"><code>$JINI_HOME/example/launcher/jini12_<span class="variable" translate="no">platform</span>.properties</code></pre></li>
                           <li>
                              <p>更新<code class="codeph">jini.properties</code>文件，以包含系统的所有必需路径，主机名和端口号。即使您没有运行Solaris，Linux或Mac OS X平台，也可以使用模板作为指南。
                              </p>
                           </li>
                           <li>
                              <p>启动Jini网络技术<code class="codeph">StartService</code>通过输入：</p> <pre class="pre codeblock"><code>$ java -cp $JINILIB/jini-examples.jar com.sun.jini.example.launcher.StartService &amp;</code></pre><p>这将打开<code class="codeph">StartService</code>图形用户界面。
                              </p>
                           </li>
                           <li>
                              <p>加载你的<code class="codeph">jini.properties</code>归档到<code class="codeph">StartService</code>通过单击<span class="bold">文件</span> ， <span class="bold">打开属性文件</span> ，然后从以下目录中选择属性文件：</p><pre class="pre codeblock"><code><span class="variable" translate="no">work_dir</span>/jmx_examples/Lookup/jini.</code></pre></li>
                           <li>
                              <p>通过单击“ <span class="bold">运行”</span>选项卡，启动Jini查找服务，然后为以下每个选项单击“ <span class="bold">开始”</span>按钮：</p>
                              <ul style="list-style-type:disc">
                                 <li>RMID</li>
                                 <li>网络服务器</li>
                                 <li>雷吉</li>
                                 <li>查找浏览器</li>
                              </ul>
                              <p>您将看到有关服务正在运行的确认。</p>
                           </li>
                           <li>
                              <p>编译<code class="codeph">Client</code>和<code class="codeph">Server</code>通过键入以下命令来分类：</p><pre class="pre codeblock"><code>$ javac -d . -classpath $classp Server.java Client.java</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-EB45E697-04FD-4461-A3A4-358ECB170946__RUNNINGTHEJINILOOKUPSERVICEEXAMPLE-C1E12527">
                        <p class="subhead3" id="GUID-EB45E697-04FD-4461-A3A4-358ECB170946__GUID-1FBAC772-B6D9-4C41-B427-C0966CBD7A56">启动服务器</p>
                        <p>您用来启动<code class="codeph">Server</code>根据您使用的外部目录而有所不同。您可以启动以下一个或多个实例： <code class="codeph">Server</code>在开始之前，使用不同的传输方式和外部注册表<code class="codeph">Client</code> 。
                        </p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="bold">不使用外部目录的JRMP上的RMI连接器：</span>通过键入以下命令来启动服务器：</p><pre class="pre codeblock"><code>$ java -classpath .:$classp -Ddebug=true \ 
  -Dagent.name=example-server-a \ 
  -Durl="service:jmx:rmi://" \ 
  -Djava.security.policy=java.policy \ 
  jini.Server &amp; 
</code></pre><p>在此命令中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>的<code class="codeph">debug</code>值设置为<code class="codeph">true</code>提供更完整的屏幕输出<code class="codeph">Server</code>运行。
                                    </p>
                                 </li>
                                 <li>
                                    <p>提供了安全策略，以允许访问Jini查找服务。</p>
                                 </li>
                                 <li>
                                    <p>创建的代理的名称是<code class="codeph">example-server-a</code> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>服务URL指定所选连接器为RMI连接器，并在RMI默认传输JRMP上运行。</p>
                                 </li>
                              </ul>
                              <p>当。。。的时候<code class="codeph">Server</code>启动后，您将看到有关RMI连接器创建的确认，以及在Jini查找服务中其URL的注册。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">通过JRMP的RMI连接器，该连接器使用RMI注册表作为外部目录：</span>通过键入以下命令来启动服务器：</p><pre class="pre codeblock"><code>$ java -classpath .:$classp -Ddebug=true \ 
  -Dagent.name=example-server-b \ 
  -Durl="service:jmx:rmi:///jndi/${jndirmi}/server" \ 
  -Djava.security.policy=java.policy \ 
  jini.Server &amp;</code></pre><p>在此命令中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>提供了安全策略，以允许访问Jini查找服务。</p>
                                 </li>
                                 <li>创建的代理的名称是<code class="codeph">example-server-b</code> 。
                                 </li>
                                 <li>服务URL将选定的连接器指定为JRMP上的RMI，并指定RMI连接器存根的外部目录， <code class="codeph">server</code> ，存储为您标识为的RMI注册表<code class="codeph">jndirmi</code>在<a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">初始配置中</a> 。
                                 </li>
                              </ul>
                              <p>什么时候<code class="codeph">Server</code>启动后，您将看到有关RMI连接器创建的确认，以及在Jini查找服务中其URL的注册。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">通过JRMP的RMI连接器（使用LDAP作为外部目录）：</span>启动<code class="codeph">Server</code>通过键入以下命令：</p><pre class="pre codeblock"><code>$ java -classpath .:$classp -Ddebug=true \ 
  -Dagent.name=example-server-c \ 
  -Durl="service:jmx:rmi:///jndi/${jndildap}/cn=x,dc=Test" \ 
  -Djava.security.policy=java.policy \ 
  -Djava.naming.security.principal="$principal" \ 
  -Djava.naming.security.credentials="$credentials" \ 
  jini.Server &amp;</code></pre><p>在此命令中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>提供了安全策略，以允许访问Jini查找服务。</p>
                                 </li>
                                 <li>
                                    <p>创建的代理的名称是<code class="codeph">example-server-c</code> 。服务URL将选定的连接器指定为JRMP上的RMI，并且存储RMI连接器存根的外部目录是您标识为的LDAP服务器。 <code class="codeph">jndildap</code>在<a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">初始配置中</a> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>存根已在<code class="codeph">Test</code> LDAP服务器中的域组件。
                                    </p>
                                 </li>
                                 <li>
                                    <p>通用名称属性， <code class="codeph">principal</code>和密码， <code class="codeph">credentials</code>被赋予访问LDAP服务器的权限。
                                    </p>
                                 </li>
                              </ul>
                              <p>当。。。的时候<code class="codeph">Server</code>启动后，您将看到确认已创建RMI连接器，并在Jini查找服务中以代理名称注册了其URL。 <code class="codeph">example-server-c</code> 。
                              </p>
                           </li>
                        </ul>
                        <p>什么时候<code class="codeph">Server</code>启动后，您将看到确认已创建RMI连接器，并在Jini查找服务中以代理名称注册了其URL。 <code class="codeph">example-server-f</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-EB45E697-04FD-4461-A3A4-358ECB170946__STARTTHECLIENT-C1E27ADE">
                        <p class="subhead3" id="GUID-EB45E697-04FD-4461-A3A4-358ECB170946__GUID-229805BB-D195-4BA6-93C8-2084DC4D51C8">启动客户端</p>
                        <p>开始之后<code class="codeph">Server</code>通过使用您选择的传输目录和外部目录，启动<code class="codeph">Client</code>通过输入：</p><pre class="pre codeblock"><code>$ java -classpath .:$classp -Ddebug=true \ 
  -Djava.security.policy=java.policy \ 
  jini.Client 
</code></pre><p>您将看到输出确认已检测到由代理创建的代理。 <code class="codeph">Server</code>并在查找服务中注册。您还将看到与代理建立的连接的标识和确认。
                        </p>
                        <p>要查找特定的代理，可以通过键入以下命令来进行查找：</p><pre class="pre codeblock"><code>$ java -classpath .:$classp -Ddebug=true \ 
  -Djava.security.policy=java.policy \ 
  -Dagent.name=<span class="variable" translate="no">agentName</span> \ 
  jini.Client</code></pre><p>在上面显示的命令中， <code class="codeph"><span class="variable" translate="no">agentName</span></code>是您要查找的代理的名称。您还可以使用以下命令指定部分座席名称<code class="codeph">*</code> ;例如， <code class="codeph">x*</code>以字母开头的所有座席姓名<code class="codeph">x</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-258E2025-16D3-4D22-A19F-F6FA0833018D" name="GUID-258E2025-16D3-4D22-A19F-F6FA0833018D"></a><h3 id="JSJMX-GUID-258E2025-16D3-4D22-A19F-F6FA0833018D" class="sect3">Java命名和目录接口（JNDI）/ LDAP查找服务</h3>
               <div>
                  <p>JMX技术允许您使用LDAP注册表作为后端向JNDI查找服务注册RMI连接器。本示例执行以下操作：</p>
                  <ul style="list-style-type:disc">
                     <li>
                        <p>中介：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>创建一个MBean服务器</p>
                           </li>
                           <li>
                              <p>创建连接器服务器</p>
                           </li>
                           <li>
                              <p>将连接器地址注册到LDAP服务器</p>
                           </li>
                        </ul>
                     </li>
                     <li>
                        <p>客户端：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p>获取指向JNDI / LDAP查找服务的指针</p>
                           </li>
                           <li>
                              <p>查找在JNDI / LDAP查找服务中注册的所有连接器服务器</p>
                           </li>
                           <li>
                              <p>创建一个JMX远程API连接器</p>
                           </li>
                           <li>
                              <p>检索有关MBean服务器中的MBean的信息</p>
                           </li>
                        </ul>
                     </li>
                  </ul>
                  <div class="section">
                     <p class="subhead2" id="GUID-258E2025-16D3-4D22-A19F-F6FA0833018D__GUID-AA4E1AF0-603B-4C0D-A94C-F2D7CF1E2D73">分析示例类</p>
                     <ol>
                        <li> 
                           <p>将源代码从<a href="java-naming-and-directory-interface-jndi-ldap-lookup-service-example.html">Java命名和目录接口（JNDI）/ LDAP查找服务</a>复制到<code class="codeph"><span class="variable" translate="no">work_dir</span>/jmx_examples/Lookup/ldap</code>目录。该目录中的文件应包括：</p>
                           <ul style="list-style-type:disc">
                              <li><code class="codeph">README</code></li>
                              <li><code class="codeph">Server.java</code></li>
                              <li><code class="codeph">Client.java</code></li>
                              <li><code class="codeph">jmx-schema.txt</code></li>
                              <li><code class="codeph">60jmx-schema.ldif</code></li>
                           </ul>
                        </li>
                        <li>打开<code class="codeph">*.java</code>在IDE或文本编辑器中的文件。
                        </li>
                     </ol>
                     <p>以下各节分析了JNDI / LDAP查找服务示例中使用的每个类，并解释了它们如何执行上述操作。</p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div class="sect3"><a id="GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D" name="GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D"></a><h4 id="JSJMX-GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D" class="sect4">JNDI / LDAP查找服务示例中的Server.java</h4>
                  <div>
                     <p>由于其大小，JNDI / LDAP查找服务<code class="codeph">Server.java</code>以下代码摘录中分析了该类：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="lookup-services.html#GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D__CODEEXAMPLE4-1JNDILDAPLOOKUPSERVICE-C45BA32D">示例4-12 JNDI / LDAP查找服务示例Server.java（摘录1）</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D__CODEEXAMPLE4-13JNDILDAPLOOKUPSERVIC-C45D0795">示例4-13 JNDI / LDAP查找服务示例类Server.java（摘录2）</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D__CODEEXAMPLE4-14JNDILDAPLOOKUPSERVIC-C45D0E1F">示例4-14 JNDI / LDAP查找服务示例类Server.java（摘录3）</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D__CODEEXAMPLE4-15JNDILDAPLOOKUPSERVIC-C45FBA93">示例4-15 JNDI / LDAP查找服务示例类Server.java（摘录4）</a></p>
                        </li>
                     </ul>
                     <div class="section" id="GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D__CODEEXAMPLE4-1JNDILDAPLOOKUPSERVICE-C45BA32D">
                        <p class="subhead3" id="GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D__GUID-6C121ACF-15E6-4FA7-9714-DB7C4E81396D">示例4-12 JNDI / LDAP查找服务示例Server.java（摘录1）</p><pre class="pre codeblock"><code>[...]

public class Server {
   public final static int JMX_DEFAULT_LEASE = 60;
   private static boolean debug = false;
   private final MBeanServer mbs;
   public Server() {
      mbs = MBeanServerFactory.createMBeanServer();
   }

  public static DirContext getRootContext() throws NamingException {
      final Hashtable env = new Hashtable();

      final String factory =
        System.getProperty(Context.INITIAL_CONTEXT_FACTORY,
                           "com.sun.jndi.ldap.LdapCtxFactory");
      final String ldapServerUrl =
        System.getProperty(Context.PROVIDER_URL);
      final String ldapUser =
        System.getProperty(Context.SECURITY_PRINCIPAL,
                           "cn=Directory Manager");
      final String ldapPasswd =
        System.getProperty(Context.SECURITY_CREDENTIALS);
      debug(Context.PROVIDER_URL + "=" + ldapServerUrl);
      debug(Context.SECURITY_PRINCIPAL + "=" + ldapUser);
      if (debug) {
                  System.out.print(Context.SECURITY_CREDENTIALS + "=");
                  final int len = (ldapPasswd==null)?0:ldapPasswd.length();
                  for (int i=0;i&lt;len;i++) System.out.print("*");
                  System.out.println();
      }
      env.put(Context.INITIAL_CONTEXT_FACTORY,factory);
      env.put(Context.SECURITY_PRINCIPAL, ldapUser);
      if (ldapServerUrl != null)
           env.put(Context.PROVIDER_URL, ldapServerUrl);
      if (ldapPasswd != null)
           env.put(Context.SECURITY_CREDENTIALS, ldapPasswd);
      InitialContext root = new InitialLdapContext(env,null);
      return (DirContext)(root.lookup(""));
  }
[...]</code></pre><p>例4-12显示了MBean服务器的初始创建， <code class="codeph">mbs</code> ，并获得指向注册连接器服务器地址的LDAP目录树的根上下文的指针。所有相关的LDAP访问变量（例如提供商URL，LDAP用户名和安全凭证）都在此处给出，并传递到环境映射中， <code class="codeph">env</code> 。环境图， <code class="codeph">env</code> ，然后作为参数传递给对的调用<code class="codeph">InitialLdapContext</code> ，从中获取初始LDAP上下文。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D__CODEEXAMPLE4-13JNDILDAPLOOKUPSERVIC-C45D0795">
                        <p class="subhead3" id="GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D__GUID-49B234E2-B3B8-4D48-A92F-9DB7A55BED48">示例4-13 JNDI / LDAP查找服务示例类Server.java（摘录2）</p><pre class="pre codeblock"><code>[...]

public static void register(DirContext root,
                           JMXServiceURL jmxUrl,
                           String name)
   throws NamingException, IOException {

   final String mydn = System.getProperty("dn","cn="+name);

   debug("dn: " + mydn );

   Object o = null;
   try {
       o = root.lookup(mydn);
   } catch (NameNotFoundException n) {
       Attributes attrs = new BasicAttributes();
       Attribute objclass = new BasicAttribute("objectClass");
       objclass.add("top");
       objclass.add("javaContainer");
       objclass.add("jmxConnector");
       attrs.put(objclass);
       attrs.put("jmxAgentName", name);
       o = root.createSubcontext(mydn,attrs);
   }
   if (o == null) throw new NameNotFoundException();
   final Attributes attrs = root.getAttributes(mydn);
   final Attribute oc = attrs.get("objectClass");
   if (!oc.contains("jmxConnector")) {
       final String msg = "The supplied node [" + mydn + 
         "] does not contain the jmxConnector objectclass";
       throw new NamingException(msg);
   }
   final Attributes newattrs = new BasicAttributes();
   newattrs.put("jmxAgentName",name);
   newattrs.put("jmxServiceURL",jmxUrl.toString());
   newattrs.put("jmxAgentHost",InetAddress.getLocalHost().getHostName());
   newattrs.put("jmxProtocolType",jmxUrl.getProtocol());
   newattrs.put("jmxExpirationDate",
                getExpirationDate(JMX_DEFAULT_LEASE));
   root.modifyAttributes(mydn,DirContext.REPLACE_ATTRIBUTE,newattrs);
}

[...]</code></pre><p>例4-13显示了LDAP目录中JMX连接器服务器服务URL的注册。您可以指定将要注册URL的DN，该DN可以通过命令行在命令行中传递<code class="codeph">dn</code>系统属性，即<code class="codeph">-Ddn=<span class="variable" translate="no">mydn</span></code> 。有关说明，请参阅用于启动服务器的命令。如果<code class="codeph">dn</code>未指定系统属性，则可以使用<code class="codeph">DN: cn=<span class="variable" translate="no">name</span></code>哪里<code class="codeph"><span class="variable" translate="no">name</span></code>是个<code class="codeph">agentName</code> 。但是，这不是强制性的。URL的注册位置无关紧要，因为客户端代码从不直接使用该DN，而是执行LDAP搜索来查找具有辅助节点的节点。 <code class="codeph">jmxConnector ObjectClass</code> 。重要的是每个URL都在其自己的LDAP节点中注册。LDAP管理员（在本例中为您）将如何命名这些节点。在此示例中，假定您已通过创建根上下文来配置LDAP服务器，在该上下文下该节点<code class="codeph">cn=<span class="variable" translate="no">name</span></code>可以创建，并且这个<code class="codeph">root</code>上下文已通过传递给LDAP初始上下文<code class="codeph">Context.PROVIDER_URL</code>属性。请参见<a href="lookup-services.html#GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D__CODEEXAMPLE4-1JNDILDAPLOOKUPSERVICE-C45BA32D">示例4-12 JNDI / LDAP查找服务示例Server.java（摘录1）</a> ）。
                        </p>
                        <p>例4-13中的代码检查您将在其中注册服务器URL的节点是否已经存在。如果不是，则尝试创建它。如果父节点不存在，这将失败。的<code class="codeph">jmxConnector ObjectClass</code>是一个简单的辅助类，您将使用<code class="codeph">javaContainer ObjectClass</code>如果需要创建新的上下文，则将其作为结构类。这是完全可选的。任何结构类<code class="codeph">jmxConnector</code>可以添加辅助类是可以接受的。然后，它将检查您要在其中注册服务器的节点是否已经具有<code class="codeph">jmxConnector</code>辅助课。如果不是，则抛出异常。
                        </p>
                        <p>此时，您确定要在其中注册URL的节点存在并且具有适当的节点。 <code class="codeph">jmxConnector</code>辅助课。您只需要替换JMX远程API为LDAP查找定义的属性值即可。请参阅jmx-schema.txt。
                        </p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><code class="codeph">jmxServiceUrl</code> ：包含从以下网址获取的服务器URL的字符串形式： <code class="codeph">server.getAddress()</code>服务器启动后</p>
                           </li>
                           <li>
                              <p><code class="codeph">jmxAgentName</code> ：包含JMX代理名称</p>
                           </li>
                           <li>
                              <p><code class="codeph">jmxProtocolType</code> ：包含JMX协议类型，由返回<code class="codeph">jmxUrl.getProtocolType()</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">jmxAgentHost</code> ：包含代理主机的名称</p>
                           </li>
                           <li>
                              <p><code class="codeph">jmxExpirationDate</code> ：包含网址将被视为过时的日期</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D__CODEEXAMPLE4-14JNDILDAPLOOKUPSERVIC-C45D0E1F">
                        <p class="subhead3" id="GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D__GUID-3711BB07-FB70-4D48-AF09-14C96E1FF41F">示例4-14 JNDI / LDAP查找服务示例类Server.java（摘录3）</p><pre class="pre codeblock"><code> [...]

   public JMXConnectorServer rmi(String url)
     throws IOException, JMException,
        NamingException, ClassNotFoundException {

     JMXServiceURL jurl = new JMXServiceURL(url);
     final HashMap env = new HashMap();
     // Prepare the environment Map
[...]

     JMXConnectorServer rmis =
JMXConnectorServerFactory.newJMXConnectorServer(jurl, env, mbs)

     final String agentName = System.getProperty("agent.name",
                                                 "DefaultAgent");
     start(rmis,env,agentName);
     return rmis;
   }
[...]</code></pre><p>例4-14创建一个新的名为RMI的连接器服务器<code class="codeph">rmis</code>与JMX服务URL <code class="codeph">jurl</code>并将适当的LDAP属性传递到其环境图<code class="codeph">env</code> 。连接器服务器<code class="codeph">rmis</code>通过调用启动<code class="codeph">JMXConnectorServer.start()</code>并在LDAP服务器中注册。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D__CODEEXAMPLE4-15JNDILDAPLOOKUPSERVIC-C45FBA93">
                        <p class="subhead3" id="GUID-E392AB91-6214-495C-BBAE-BAD60657CE4D__GUID-ECC445BB-5044-4A3B-BD6D-791BAFBBF0B7">示例4-15 JNDI / LDAP查找服务示例类Server.java（摘录4）</p><pre class="pre codeblock"><code>[...]

    public void start(JMXConnectorServer server, Map env, String agentName)
       throws IOException, NamingException {server.start()
       final DirContext root=getRootContext();
       final JMXServiceURL address = server.getAddress();register(root,address,agentName)
    }
[...]</code></pre><p>例4-15创建一个JMX连接器服务器服务器，获得一个指向LDAP服务器根目录root的指针，并为名为address的服务器创建一个URL。根目录，URL和代理名称作为参数传递给<code class="codeph">register()</code>并在LDAP服务器中注册。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-1C2BF6D6-2FF5-44DA-9F1D-7AE941E884CA" name="GUID-1C2BF6D6-2FF5-44DA-9F1D-7AE941E884CA"></a><h4 id="JSJMX-GUID-1C2BF6D6-2FF5-44DA-9F1D-7AE941E884CA" class="sect4">JNDI / LDAP查找服务示例中的Client.java</h4>
                  <div>
                     <p>JNDI / LDAP查找服务示例类<code class="codeph">Client.java</code>如代码示例4-16所示。
                     </p>
                     <div class="section" id="GUID-1C2BF6D6-2FF5-44DA-9F1D-7AE941E884CA__CODEEXAMPLE4-16JNDILDAPLOOKUPSERVIC-C46122C7">
                        <p class="subhead3" id="GUID-1C2BF6D6-2FF5-44DA-9F1D-7AE941E884CA__CODEEXAMPLE4-16JNDILDAPLOOKUPSERVIC-C461292A">代码示例4-16 JNDI / LDAP查找服务示例类Client.java</p><pre class="pre codeblock"><code>[...]

public class Client {

   private static boolean debug = false;

   public static void listAttributes(DirContext root, String dn)
     throws NamingException {
     final Attributes attrs = root.getAttributes(dn);
     System.out.println("dn: " + dn);
     System.out.println("attributes: " + attrs);
   }
   public static DirContext getRootContext() throws NamingException {
      final Hashtable env = new Hashtable();
      // Prepare environment map
      [...]
      InitialContext root = new InitialLdapContext(env,null);
      return (DirContext)(root.lookup(""));
   }
   // Confirm URL has not expired 
  [...] 

   public static List lookup(DirContext root, String protocolType,
                             String name)
      throws IOException, NamingException {
      final ArrayList list = new ArrayList();
      String queryProtocol =
         (protocolType==null)?"":"(jmxProtocolType="+protocolType+")";
      String query =
          "(&amp;" + "(objectClass=jmxConnector) " +
          "(jmxServiceURL=*) " +
          queryProtocol +
          "(jmxAgentName=" + ((name!=null)?name:"*") + "))";

      SearchControls ctrls = new SearchControls();
      ctrls.setSearchScope(SearchControls.SUBTREE_SCOPE);
      final NamingEnumeration results = root.search("", query, ctrls);
      while (results.hasMore()) { 
           final SearchResult r = (SearchResult) results.nextElement();
           debug("Found node: " + r.getName());
           final Attributes attrs = r.getAttributes();
           final Attribute attr = attrs.get("jmxServiceURL");
           if (attr == null) continue;
           final Attribute exp = attrs.get("jmxExpirationDate");
           if ((exp != null) &amp;&amp; hasExpired((String)exp.get())) {
               System.out.print(r.getName() + ": ");
               System.out.println("URL expired since: " + exp.get());
               continue;}
           final String urlStr = (String)attr.get();
           if (urlStr.length() == 0) continue;

           debug("Found URL: "+ urlStr);

           final JMXServiceURL url = new JMXServiceURL(urlStr);
           final JMXConnector conn =
               JMXConnectorFactory.newJMXConnector(url,null);
           list.add(conn);
           if (debug) listAttributes(root,r.getName());
      }

      return list;
}
}</code></pre><p>在代码示例4-16中， <code class="codeph">Client</code>首先返回一个指针， <code class="codeph">root</code> ，到LDAP目录<code class="codeph">DirContext</code> ，然后在目录中搜索该类型的对象类<code class="codeph">jmxConnector</code> 。服务网址和有效期属性， <code class="codeph">attr</code>和<code class="codeph">exp</code>分别为<code class="codeph">jmxConnector</code>获得对象类， <code class="codeph">exp</code>已检查以确保URL尚未过期并且已调用<code class="codeph">JMXConnectorFactory</code>创建一个新的连接器<code class="codeph">conn</code> 。连接器<code class="codeph">conn</code>被添加到连接器列表中，并用于访问由MBean创建的MBean服务器中的MBean。 <code class="codeph">Server</code> 。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-B64797D1-9C1E-4781-9EF1-A9070878C746" name="GUID-B64797D1-9C1E-4781-9EF1-A9070878C746"></a><h4 id="JSJMX-GUID-B64797D1-9C1E-4781-9EF1-A9070878C746" class="sect4">jmx-schema.txt</h4>
                  <div>
                     <p>的<code class="codeph">jmx-schema.txt</code>文件是JMX远程API的LDAP模式文件。</p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-A7B31115-E440-48FA-AD7C-984733CC4D7E" name="GUID-A7B31115-E440-48FA-AD7C-984733CC4D7E"></a><h4 id="JSJMX-GUID-A7B31115-E440-48FA-AD7C-984733CC4D7E" class="sect4">60jmx-schema.ldif</h4>
                  <div>
                     <p>的<code class="codeph">60jmx-schema.ldif</code>文件是一个<code class="codeph">ldif</code>与LDAP模式文件相对应的文件， <code class="codeph">jmx-schema.txt</code> ，用于JMX技术。
                     </p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-CDB5A299-C863-42FC-A669-D77F2483ABD3" name="GUID-CDB5A299-C863-42FC-A669-D77F2483ABD3"></a><h4 id="JSJMX-GUID-CDB5A299-C863-42FC-A669-D77F2483ABD3" class="sect4">运行JNDI / LDAP查找服务示例</h4>
                  <div>
                     <p>本示例演示了如何使用JNDI / LDAP查找服务来查找实现默认JRMP传输以及IIOP传输的RMI连接器服务器。此外，如“ <a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">初始配置”中所述</a> ，不同的外部目录用于注册RMI连接器存根。
                     </p>
                     <p>这里展示了传输和外部目录的组合：</p>
                     <p></p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>通过JRMP传输的RMI连接器，具有：</p>
                           <ul style="list-style-type:disc">
                              <li>
                                 <p>没有外部目录</p>
                              </li>
                              <li>
                                 <p>RMI注册表</p>
                              </li>
                              <li>
                                 <p>LDAP注册表</p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                     <p>在运行使用JNDI / LDAP查找服务的示例之前，必须完成“ <span class="bold">初始配置</span> ”部分中的操作以及该示例特定的操作。然后，您可以开始使用JNDI / LDAP网络技术以及JMX技术支持的两个连接器来查找连接器。</p>
                     <div class="infoboxnote" id="GUID-CDB5A299-C863-42FC-A669-D77F2483ABD3__GUID-7FDF80BB-48AD-4FE4-87CF-377E00ED4943">
                        <p class="notep1">注意：</p>
                        <p>在运行示例时，为了帮助您跟踪使用哪种传输方式创建了哪个代理，代理名称包含一个字母后缀，该后缀与相应部分的字母相同。例如，从“启动服务器”的子步骤a。<span class="bold">通过JRMP的RMI连接器，没有外部目录</span> 。被称为<code class="codeph">example-server-a</code> 。
                        </p>
                     </div>
                     <p>要运行该示例，请执行以下步骤中描述的步骤：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p><a href="lookup-services.html#GUID-CDB5A299-C863-42FC-A669-D77F2483ABD3__SETTINGUPTHEJNDILDAPLOOKUPSERVICEEX-C46E5D5B">设置JNDI / LDAP查找服务示例</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-CDB5A299-C863-42FC-A669-D77F2483ABD3__STARTTHESERVER-C46E6398">启动服务器</a></p>
                        </li>
                        <li>
                           <p><a href="lookup-services.html#GUID-CDB5A299-C863-42FC-A669-D77F2483ABD3__STARTTHECLIENT-C46E678B">启动客户端</a></p>
                        </li>
                     </ul>
                     <div class="section" id="GUID-CDB5A299-C863-42FC-A669-D77F2483ABD3__SETTINGUPTHEJNDILDAPLOOKUPSERVICEEX-C46E5D5B">
                        <p class="subhead3" id="GUID-CDB5A299-C863-42FC-A669-D77F2483ABD3__GUID-AB03BC04-61D4-4162-B7F6-0733D1A821FD">设置JNDI / LDAP查找服务示例</p>
                        <p>在此示例中可以运行的所有不同连接器/传输器组合都需要执行以下步骤。</p>
                        <div class="infoboxnote" id="GUID-CDB5A299-C863-42FC-A669-D77F2483ABD3__GUID-4959F1F8-3F9B-4E8F-BEF0-0F740EC0EEB8">
                           <p class="notep1">注意：</p>
                           <p>根据您使用的LDAP服务器的类型完成以下步骤。</p>
                        </div>
                        <ol>
                           <li>
                              <p>停止在“ <a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">初始配置”中</a>启动的LDAP服务器。
                              </p>
                           </li>
                           <li>
                              <p>将JMX技术架构复制到LDAP服务器的架构目录中。</p> 
                           </li>
                           <li>
                              <p>重新启动LDAP服务器</p>
                           </li>
                           <li>定义服务器将在其下注册其服务URL的根。您必须为服务器提供域组件后缀的路径<code class="codeph">dc=Test</code>您在“ <a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">初始配置”中</a>创建的。<pre class="pre codeblock"><code>$ provider="ldap://$ldaphost:$ldapport/dc=Test"</code></pre></li>
                           <li>
                              <p>编译例子<code class="codeph">Client</code>和<code class="codeph">Server</code>通过键入以下命令来分类：</p><pre class="pre codeblock"><code>$ javac -d . -classpath $classp Server.java Client.java</code></pre></li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-CDB5A299-C863-42FC-A669-D77F2483ABD3__STARTTHESERVER-C46E6398">
                        <p class="subhead3" id="GUID-CDB5A299-C863-42FC-A669-D77F2483ABD3__GUID-F3E63C9E-B7DE-4FEC-BE95-A0CE2651275C">启动服务器</p>
                        <p>您用来启动<code class="codeph">Server</code>根据您使用的外部目录而有所不同。您可以启动以下一个或多个实例： <code class="codeph">Server</code>与不同的运输方式和外部注册表进行交互<code class="codeph">Client</code> 。
                        </p>
                        <p>传输和外部目录的组合如下所示：</p>
                        <ul style="list-style-type:disc">
                           <li>
                              <p><span class="bold">通过JRMP的RMI连接器，没有外部目录：</span>启动<code class="codeph">Server</code>通过键入以下命令。
                              </p><pre class="pre codeblock"><code>$ java -classpath . -Ddebug=true \
  -Dagent.name=example-server-a \
  -Durl="service:jmx:rmi://" \
  -Djava.naming.provider.url="$provider" \
  -Djava.naming.security.principal="$principal" \
  -Djava.naming.security.credentials="$credentials" \
  jndi.Server &amp;</code></pre><p>在此命令中：</p>
                              <ul style="list-style-type:disc">
                                 <li>的<p><code class="codeph">debug</code>设置为true时，当<code class="codeph">Server</code>运行。
                                    </p>
                                 </li>
                                 <li>
                                    <p>要创建的代理的名称是<code class="codeph">example-server-a</code> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>网址， <code class="codeph">provider</code>给出指向将在其中注册代理的域组件后缀。
                                    </p>
                                 </li>
                                 <li>
                                    <p>通用名称属性， <code class="codeph">principal</code>和密码， <code class="codeph">credentials</code>被赋予访问LDAP服务器的权限。
                                    </p>
                                 </li>
                                 <li>
                                    <p>服务URL指定所选择的连接器是RMI连接器，它在RMI默认JRMP传输上运行。</p>
                                 </li>
                              </ul>
                              <p>当。。。的时候<code class="codeph">Server</code>启动后，您将看到有关RMI连接器创建的确认，以及在JNDI / LDAP查找服务中其URL的注册。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">通过JRMP的RMI连接器（使用RMI注册表作为外部目录）：</span>启动<code class="codeph">Server</code>通过键入以下命令。
                              </p><pre class="pre codeblock"><code>$ java -classpath . -Ddebug=true \ 
  -Dagent.name=example-server-b \ 
  -Durl="service:jmx:rmi:///jndi/${jndirmi}/server" \ 
  -Djava.naming.provider.url="$provider" \ 
  -Djava.naming.security.principal="$principal" \ 
  -Djava.naming.security.credentials="$credentials" \ 
  jndi.Server &amp;</code></pre><p>在此命令中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>创建的代理的名称为<code class="codeph">example-server-b</code> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>网址， <code class="codeph">provider</code>给出指向将在其中注册代理的域组件后缀。
                                    </p>
                                 </li>
                                 <li>
                                    <p>通用名称属性， <code class="codeph">principal</code>和密码， <code class="codeph">credentials</code>被赋予访问LDAP服务器的权限。
                                    </p>
                                 </li>
                                 <li>
                                    <p>服务URL将所选的连接器指定为JRMP上的RMI，并且存储RMI连接器存根（服务器）的外部目录是您标识为的RMI注册表。 <code class="codeph">jndirmi</code>在<a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">初始配置中</a> 。
                                    </p>
                                 </li>
                              </ul>
                              <p>当。。。的时候<code class="codeph">Server</code>启动后，将在JNDI / LDAP查找服务中看到有关RMI连接器创建的确认以及其URL的注册。
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">通过JRMP的RMI连接器（使用LDAP作为外部目录）：</span>启动<code class="codeph">Server</code>通过键入以下命令。
                              </p><pre class="pre codeblock"><code>$ java -classpath . -Ddebug=true \ 
  -Dagent.name=example-server-c \ 
  -Durl="service:jmx:rmi:///jndi/${jndildap}/cn=x,dc=Test" \ 
  -Djava.naming.provider.url="$provider" \ 
  -Djava.naming.security.principal="$principal" \ 
  -Djava.naming.security.credentials="$credentials" \ 
  jndi.Server &amp;</code></pre><p>在此命令中：</p>
                              <ul style="list-style-type:disc">
                                 <li>
                                    <p>创建的代理名称为<code class="codeph">example-server-c</code> 。
                                    </p>
                                 </li>
                                 <li>
                                    <p>网址， <code class="codeph">provider</code>给出指向将在其中注册代理的域组件后缀。
                                    </p>
                                 </li>
                                 <li>
                                    <p>通用名称属性， <code class="codeph">principal</code>和密码， <code class="codeph">credentials</code>被赋予访问LDAP服务器的权限。
                                    </p>
                                 </li>
                                 <li>
                                    <p>服务URL将所选的连接器指定为JRMP上的RMI，并且存储RMI连接器存根（服务器）的外部目录是您标识为的RMI注册表。 <code class="codeph">jndildap</code>在<a href="lookup-services.html#GUID-5E7A4F97-EA73-42AD-A539-D63327192B30">初始配置中</a> 。
                                    </p>
                                 </li>
                              </ul>
                              <p>当。。。的时候<code class="codeph">Server</code>启动后，您将在代理名称下的JNDI / LDAP查找服务中看到有关RMI连接器创建的确认以及其URL的注册。 <code class="codeph">example-server-c</code> 。
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-CDB5A299-C863-42FC-A669-D77F2483ABD3__STARTTHECLIENT-C46E678B">
                        <p class="subhead3" id="GUID-CDB5A299-C863-42FC-A669-D77F2483ABD3__GUID-054925BF-6588-4890-9B94-6DE1CCC47584">启动客户端</p>
                        <p>启动使用您选择的传输目录和外部目录的服务器后，通过键入以下命令来启动客户端：</p><pre class="pre codeblock"><code>$ java -classpath . -Ddebug=true \ 
  -Djava.naming.provider.url="$provider" \ 
  -Djava.naming.security.principal="$principal" \ 
  -Djava.naming.security.credentials="$credentials" \ 
  jndi.Client</code></pre><p>您将看到确认已检测到由代理创建的代理的输出。 <code class="codeph">Server</code>并在查找服务中注册。您还将看到与代理建立的连接的标识和确认。
                        </p>
                        <p>要查找特定的代理，请键入以下命令：</p><pre class="pre codeblock"><code>$ java -classpath . -Ddebug=true \ 
  -Djava.naming.provider.url="$provider" \ 
  -Djava.naming.security.principal="$principal" \ 
  -Djava.naming.security.credentials="$credentials" \ 
  -Dagent.name=<span class="variable" translate="no">agentName</span> \ 
  jndi.Client </code></pre><p>在上面显示的命令中， <code class="codeph"><span class="variable" translate="no">agentName</span></code>是您要查找的代理的名称。您也可以使用*指定部分座席名称。例如， <code class="codeph">x*</code>所有以字母x开头的座席姓名。
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   

</body></html>