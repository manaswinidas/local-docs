<html lang="en-us"  xml:lang="en-us"><head></head><body >﻿
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="">
      <meta name="description" content="">
      <title>第二部分：使用Java SE Security API的安全通信</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Security Developer’s Guide">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Security Developer’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="security-developer-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-09-21T08:42:26-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="1993, 2018">
      <meta name="dcterms.category" content="java">
      <meta name="dcterms.identifier" content="E94828-01">
      
      <meta name="dcterms.product" content="en/java/javase/11">
      <meta name="dcterms.release" content="11">
      <link rel="prev" href="part-i-secure-authentication-using-java-authentication-and-authorization-service-jaas.html" title="Previous" type="text/html">
      <link rel="next" href="part-iii-deploying-single-sign-kerberos-environment.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"java","element_name":"Java","display_in_url":true},"suite":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product_group":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product":{"short_name":"javase","element_name":"Java SE","display_in_url":true},"release":{"short_name":"11","element_name":"11","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Security Developer Guide">
    <meta name="dcterms.isVersionOf" content="SECURITY">
  <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script>
   
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="part-i-secure-authentication-using-java-authentication-and-authorization-service-jaas.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一个</a> <a href="part-iii-deploying-single-sign-kerberos-environment.html" class="pull-right">下一个<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">安全开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="java-generic-security-services-java-gss-api1.html" property="item" typeof="WebPage"><span property="name">Java通用安全服务（Java GSS-API）</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="advanced-security-programming-java-se-authentication-secure-communication-and-single-sign1.html" property="item" typeof="WebPage"><span property="name">Java SE身份验证，安全通信和单点登录中的高级安全性编程</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">第二部分：使用Java SE Security API的安全通信</li>
            </ol>
            <a id="GUID-98B02DB0-13DB-4175-9485-3449E1A241B5" name="GUID-98B02DB0-13DB-4175-9485-3449E1A241B5"></a>
            
            <h2 id="JSSEC-GUID-98B02DB0-13DB-4175-9485-3449E1A241B5" class="sect2">第二部分：使用Java SE Security API的安全通信</h2>
         </header>
         <div class="ind">
            <div>
               <p></p>
               <p>本部分向您展示如何构建执行安全通信的应用程序。Java SE平台提供了三个标准API，这些API允许应用程序执行安全的通信：Java通用安全服务（GSS），Java SASL API和Java安全套接字扩展（JSSE）。在构建应用程序时，应使用以下哪个API？答案取决于许多因素，包括协议或服务的要求，部署基础结构以及与其他安全服务的集成。例如，如果要构建LDAP客户端库，则需要使用Java SASL API，因为使用SASL是LDAP协议定义的一部分。作为另一个示例，如果服务支持SSL，则尝试访问该服务的客户端应用程序将需要使用JSSE。</p>
            </div>
            <div class="sect2"><a id="GUID-1E4E43BA-EC38-435E-A426-7A88E52F34DF" name="GUID-1E4E43BA-EC38-435E-A426-7A88E52F34DF"></a><h3 id="JSSEC-GUID-1E4E43BA-EC38-435E-A426-7A88E52F34DF" class="sect3">练习3：使用Java通用安全服务（GSS）API</h3>
               <div>
                  <p></p>
                  <div class="section">
                     <p class="subhead2" id="GUID-1E4E43BA-EC38-435E-A426-7A88E52F34DF__GUID-5F596C97-100D-477E-9F65-58FEEC2BDBE7">本练习的目的</p>
                     <p>本练习的目的是学习如何使用Java GSS API来执行安全的身份验证和通信。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1E4E43BA-EC38-435E-A426-7A88E52F34DF__GUID-1D5C3754-F12B-43C4-8466-2D1A8373F5A3">本练习的背景</p>
                     <p>通用安全服务API提供统一的C语言接口，以访问各种安全服务，例如身份验证，消息完整性和消息机密性。Java GSS API为Java应用程序提供了相应的接口。它允许应用程序执行身份验证并与对等方建立安全的通信。通过GSS-API和Java GSS-API访问的最常见的安全服务之一是Kerberos。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1E4E43BA-EC38-435E-A426-7A88E52F34DF__GUID-CA64C2E2-AC75-4A77-8097-9584A234BAE6">本练习的资源</p>
                     <ul style="list-style-type:disc">
                        <li><a href="introduction-jaas-and-java-gss-api-tutorials1.html">JAAS和Java GSS-API教程简介</a></li>
                        <li><a href="http://www.ietf.org/rfc/rfc2853.txt" target="_blank">通用安全服务API版本2：Java绑定（RFC 2853）</a></li>
                        <li>Java GSS Javadoc API文档： <a href="https://docs.oracle.com/javase/10/docs/api/org/ietf/jgss/package-summary.html" target="_blank"><span class="apiname">org.ietf.jgss</span></a> 。
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1E4E43BA-EC38-435E-A426-7A88E52F34DF__GUID-F1B68493-604A-4FA9-AACA-9B32B23318F7">本练习概述</p>
                     <p>此练习是一个客户端-服务器应用程序，演示了如何使用Java GSS API进行安全通信。客户机和服务器部分首先向Kerberos进行身份验证，如<a href="part-i-secure-authentication-using-java-authentication-and-authorization-service-jaas.html#GUID-1446370E-5019-4BD1-860A-22BAC1F13CF8">练习1：使用JAAS API所示</a> 。这会将凭据存储在主题中。然后，应用程序执行一个操作，该操作使用<span class="apiname">使用者</span>在<span class="apiname">Subject.doA</span>内部执行Java GSS操作（使用Kerberos作为底层GSS机制）。由于Java GSS Kerberos机制是在<span class="apiname">doA</span>内部执行的，因此它会从主题中获取Kerberos凭据，并使用它们与对等方进行身份验证并安全地交换消息。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1E4E43BA-EC38-435E-A426-7A88E52F34DF__GUID-2F1E6A79-6773-4826-B475-5DCD0AACAF50">遵循的步骤</p>
                     <ol>
                        <li>
                           <p>阅读<a href="source-code-advanced-security-programming-java-se-authentication-secure-communication-and-single-sig.html#GUID-40AF52E5-ECEA-4E5F-B0C1-35C150C7BB6E__GSSSERVER.JAVA-338B6349"><code>GssServer.java</code></a>码。
                           </p>
                           <p>此代码片段定义了在服务主体已向KDC进行身份验证之后执行的操作。它取代了<code class="codeph">MyAction</code>在<a href="part-i-secure-authentication-using-java-authentication-and-authorization-service-jaas.html#GUID-1446370E-5019-4BD1-860A-22BAC1F13CF8">练习1：使用JAAS API中</a> 。该代码首先创建<span class="bold"><span class="apiname">GSSManager</span></span>实例，它用于获取自己的凭据并创建<span class="apiname">GSSContext</span>实例。它使用此上下文执行身份验证。完成身份验证后，它接受来自客户端的加密输入，并使用已建立的安全上下文解密数据。然后，它使用安全上下文对包含原始输入和日期的答复进行加密，然后将其发送回客户端。
                           </p>
                        </li>
                        <li>
                           <p>编译示例代码。</p>
                        </li>
                        <li>
                           <p>阅读<a href="source-code-advanced-security-programming-java-se-authentication-secure-communication-and-single-sig.html#GUID-40AF52E5-ECEA-4E5F-B0C1-35C150C7BB6E__GSSCLIENT.JAVA-338B6631"><code>GssClient.java</code></a>码。
                           </p>
                           <p>此代码片段定义了在客户端主体已向KDC进行身份验证之后执行的操作。它取代了<code class="codeph">MyAction</code>在<a href="part-i-secure-authentication-using-java-authentication-and-authorization-service-jaas.html#GUID-1446370E-5019-4BD1-860A-22BAC1F13CF8">练习1：使用JAAS API中</a> 。该代码首先创建<span class="bold"><span class="apiname">GSSManager</span></span>的实例，该实例将用于获取将与之通信的服务的主体名称。然后，它创建<span class="apiname">GSSContext</span>实例以执行对服务的身份验证。完成身份验证后，它将使用已建立的安全上下文对消息进行加密，然后将其发送到服务器。然后，它从服务器读取加密的消息，并使用已建立的安全上下文对其进行解码。
                           </p>
                        </li>
                        <li>
                           <p>编译示例代码。</p>
                        </li>
                        <li>
                           <p>启动一个新窗口并启动服务器：</p><pre class="pre codeblock"><code>% java -Djava.security.auth.login.config=jaas-krb5.conf GssServer</code></pre></li>
                        <li>
                           <p>运行客户端应用程序。<span class="apiname">GssClient</span>采用两个参数：服务名称和运行该服务的服务器的名称。例如，如果服务是在机器j1hol-001上运行的主机，则应输入以下内容：</p><pre class="pre codeblock"><code>% java -Djava.security.auth.login.config=jaas-krb5.conf GssClient host j1hol-001</code></pre><p>当提示您输入密码时，输入<code class="codeph">change_it</code> 。
                           </p>
                        </li>
                        <li>
                           <p>在相应的客户端和服务器应用程序的窗口中观察以下输出。</p>
                           <p>运行<span class="apiname">GssServer</span>示例的输出：</p><pre class="pre codeblock"><code>Authenticated principal: [host/j1hol-001@J1LABS.EXAMPLE.COM]
Waiting for incoming connections..
Got connection from client /192.0.2.102
Context Established!
Client principal is test@J1LABS.EXAMPLE.COM
Server principal is host/j1hol-001@J1LABS.EXAMPLE.COM
Mutual authentication took place!
Received data "Hello There!" of length 12
Confidentiality applied: true
Sending: Hello There! Thu May 06 12:11:15 PDT 2005</code></pre><p>运行<span class="apiname">GssClient</span>示例的输出：</p><pre class="pre codeblock"><code>Kerberos password for test: change_it
Authenticated principal: [test@J1LABS.EXAMPLE.COM]
Connected to address j1hol-001/192.0.2.102
Context Established!
Client principal is test@J1LABS.EXAMPLE.COM
Server principal is host@j1hol-001
Mutual authentication took place!
Sending message: Hello There!
Will read token of size 93
Received message: Hello There! Thu May 06 12:11:15 PDT 2005</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1E4E43BA-EC38-435E-A426-7A88E52F34DF__GUID-3EFF7338-8FB6-4229-AAEC-5BE549F439A7">摘要</p>
                     <p>在本练习中，您学习了如何编写使用Java GSS API进行身份验证和彼此安全通信的客户端服务器应用程序。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-1E4E43BA-EC38-435E-A426-7A88E52F34DF__GUID-1277477E-C788-4486-8975-1B600A1B6542">下一步</p>
                     <ol>
                        <li>
                           <p>继续<a href="part-ii-secure-communications-using-java-se-security-api.html#GUID-727C5CDB-8701-40B3-8355-00C8314590A3">练习4：使用Java SASL API</a>学习如何编写使用Java SASL API进行身份验证和彼此安全通信的客户端/服务器应用程序。
                           </p>
                        </li>
                        <li>
                           <p>继续<a href="part-ii-secure-communications-using-java-se-security-api.html#GUID-9AAFC7BB-8562-4E3E-B5EF-E33F30E779D1">练习5：将Java Secure Socket Extension与Kerberos一起使用，</a>以学习如何编写使用JSSE进行身份验证和彼此安全通信的客户端/服务器应用程序。
                           </p>
                        </li>
                        <li>
                           <p>继续<a href="part-iii-deploying-single-sign-kerberos-environment.html#GUID-5D0B8FD9-FF12-44E7-B7E9-7620E95E784C">练习6：部署单点登录，</a>以了解如何配置您刚刚用来在Kerberos环境中实现单点登录的示例程序。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-727C5CDB-8701-40B3-8355-00C8314590A3" name="GUID-727C5CDB-8701-40B3-8355-00C8314590A3"></a><h3 id="JSSEC-GUID-727C5CDB-8701-40B3-8355-00C8314590A3" class="sect3">练习4：使用Java SASL API</h3>
               <div>
                  <p></p>
                  <div class="section">
                     <p class="subhead2" id="GUID-727C5CDB-8701-40B3-8355-00C8314590A3__GUID-725B412A-9101-467E-87AF-0D17C2F304BF">本练习的目的</p>
                     <p>本练习的目的是学习如何使用Java SASL API来执行安全的身份验证和通信。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-727C5CDB-8701-40B3-8355-00C8314590A3__GUID-C1C253A8-7374-4535-81A2-A71124730D10">本练习的背景</p>
                     <p>简单身份验证和安全层（SASL）指定了一种挑战响应协议，其中，为了进行身份验证和（可选）建立在其上进行后续通信的安全层，在客户端和服务器之间交换数据。SASL允许使用不同的机制。每个此类机制都由定义要交换数据的配置文件和名称来标识。SASL与基于连接的协议（例如LDAPv3和IMAPv4）一起使用。<a href="http://www.ietf.org/rfc/rfc4422.txt" target="_blank">RFC 4422中</a>描述了SASL。
                     </p>
                     <p>Java SASL API定义了一个API，供应用程序以独立于机制的方式使用SASL。例如，如果您正在编写使用SASL的网络协议的库，则可以使用Java SASL API生成要与对等方交换的数据。部署库后，您可以动态配置要与库一起使用的机制。</p>
                     <p>除身份验证外，您还可以使用SASL协商身份验证后要使用的安全层。但是与GSS-API不同，安全层的属性（例如您是否需要完整性或机密性）是在协商时确定的。 （GSS-API允许根据每条消息打开或关闭机密性）。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-727C5CDB-8701-40B3-8355-00C8314590A3__GUID-107B65D9-10A4-4DBC-8719-3BBBB4247F2E">本练习的资源</p>
                     <ul style="list-style-type:disc">
                        <li><a href="java-sasl-api-programming-and-deployment-guide1.html#GUID-6D78EE33-62E6-4D85-9695-322EED493F72">Java SASL API编程和部署指南</a></li>
                        <li><a href="https://docs.oracle.com/javase/10/docs/api/javax/security/sasl/package-summary.html" target="_blank"> <span class="apiname">javax.security.sasl</span></a></li>
                        <li><a href="http://www.ietf.org/rfc/rfc4422.txt" target="_blank">简单身份验证和安全层（SASL）（RFC 4422）</a></li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-727C5CDB-8701-40B3-8355-00C8314590A3__GUID-06232C00-CD72-4520-83C0-96CF0053DDBA">本练习概述</p>
                     <p>此练习是一个客户端-服务器应用程序，演示了如何使用Java SASL API进行安全通信。客户端和服务器部分首先使用<a href="part-i-secure-authentication-using-java-authentication-and-authorization-service-jaas.html#GUID-1446370E-5019-4BD1-860A-22BAC1F13CF8">练习1：使用JAAS API</a>向Kerberos进行身份验证。这会将凭据存储在主题中。然后，该应用程序执行一个操作，该操作使用主题在<span class="apiname">Subject.doAs</span>内部执行Java SASL API操作（使用Kerberos作为底层SASL机制）。因为SASL / Kerberos机制是在<span class="apiname">doA</span>内部执行的，所以它会从主题中获取Kerberos凭据，并使用它们与对等方进行身份验证并安全地交换消息。
                     </p>
                     <p>本示例使用由<a href="source-code-advanced-security-programming-java-se-authentication-secure-communication-and-single-sig.html#GUID-40AF52E5-ECEA-4E5F-B0C1-35C150C7BB6E__APPCONNECTION.JAVA-338B5FD0"><code class="codeph">AppConnection</code></a>类。该协议交换认证命令和数据命令。每个命令都包含一个类型（例如， <code class="codeph">AppConnection.AUTH_CMD</code> ），要遵循的数据长度以及数据本身。如果该数据用于身份验证或加密/完整性保护的应用程序数据，则为SASL缓冲区；否则为普通应用程序数据。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-727C5CDB-8701-40B3-8355-00C8314590A3__GUID-D7B255D7-9ED9-43D9-94F7-FE5792CB2931">遵循的步骤</p>
                     <ol>
                        <li>
                           <p>阅读<a href="source-code-advanced-security-programming-java-se-authentication-secure-communication-and-single-sig.html#GUID-40AF52E5-ECEA-4E5F-B0C1-35C150C7BB6E__SASLTESTSERVER.JAVA-338B69BC"><code>SaslTestServer.java</code></a>示例代码。
                           </p>
                           <p>此代码片段定义了在服务主体已向KDC进行身份验证之后执行的操作。它取代了<code class="codeph">MyAction</code>在<a href="part-i-secure-authentication-using-java-authentication-and-authorization-service-jaas.html#GUID-1446370E-5019-4BD1-860A-22BAC1F13CF8">练习1：使用JAAS API中</a> 。服务器指定它将支持的保护质量（QOP），然后创建一个<span class="apiname">SaslServer</span>实例来执行身份验证。SASL的质询-响应协议在while循环中执行，服务器将质询发送到客户端并处理来自客户端的响应。认证之后，可以通过调用<span class="apiname">getAuthorizedID（）</span>方法来获取已认证客户端的身份。如果协商了安全层，则服务器可以与客户端安全地交换数据。
                           </p>
                        </li>
                        <li>
                           <p>编译示例代码。</p>
                        </li>
                        <li>
                           <p>阅读<a href="source-code-advanced-security-programming-java-se-authentication-secure-communication-and-single-sig.html#GUID-40AF52E5-ECEA-4E5F-B0C1-35C150C7BB6E__SASLTESTCLIENT.JAVA-338B6D11"><code>SaslTestClient.java</code></a>示例代码。
                           </p>
                           <p>此代码片段定义了在客户端主体已向KDC进行身份验证之后执行的操作。它代替了<a href="part-i-secure-authentication-using-java-authentication-and-authorization-service-jaas.html#GUID-1446370E-5019-4BD1-860A-22BAC1F13CF8">练习1：使用JAAS API中</a>的MyAction。该程序首先指定所需的保护质量（在这种情况下为机密性），然后创建一个实例。 <code class="codeph">SaslClient</code>用于身份验证。然后，它会检查该机制是否具有初始响应，如果有，则通过调用<code class="codeph">evaluateChallenge()</code>空字节数组的方法。然后，它将响应发送到服务器以开始身份验证。SASL的质询响应协议是在while循环中执行的，客户端评估其从服务器获得的质询，并将对质询的相应响应发送给服务器。身份验证之后，客户端可以继续使用协商的安全层与服务器进行通信。
                           </p>
                        </li>
                        <li>
                           <p>编译示例代码。</p>
                        </li>
                        <li>
                           <p>启动一个新窗口并启动服务器。 <code class="codeph">SaslTestServer</code>接受两个参数：服务名称和运行该服务的服务器的名称。例如，如果服务是在机器j1hol-001上运行的主机，则应输入以下内容：</p><pre class="pre codeblock"><code>% java -Djava.security.auth.login.config=jaas-krb5.conf SaslTestServer host j1hol-001</code></pre></li>
                        <li>
                           <p>运行客户端应用程序。 <code class="codeph">SaslTestClient</code>接受两个参数：服务名称和运行该服务的服务器的名称。例如，如果服务是在机器j1hol-001上运行的主机，则应输入以下内容：</p><pre class="pre codeblock"><code>% java -Djava.security.auth.login.config=jaas-krb5.conf SaslTestClient host j1hol-001</code></pre><p>提供安全密码。</p>
                        </li>
                        <li>
                           <p>在相应的客户端和服务器应用程序的窗口中观察以下输出。</p>
                           <p>输出用于运行<code class="codeph">SaslTestServer</code>例：</p><pre class="pre codeblock"><code>Authenticated principal: [host/j1hol-001@J1LABS.EXAMPLE.COM]
Waiting for incoming connections...
Got connection from client /192.0.2.102
Client authenticated; authorized client is: test@J1LABS.EXAMPLE.COM
Negotiated QOP: auth-conf
Received: Hello There!
Sending: Hello There! Fri May 07 15:32:37 PDT 2005
Received data "Hello There!" of length 12</code></pre><p>输出用于运行<code class="codeph">SaslTestClient</code>示例（ <span class="italic">密码</span>将替换为您提供的密码）：</p><pre class="pre codeblock"><code>Kerberos password for test: password
Authenticated principal: [test@J1LABS.EXAMPLE.COM]
Connected to address j1hol-001/192.0.2.102
Client authenticated.
Negotiated QOP: auth-conf
Sending: Hello There!
Received: Hello There! Fri May 07 15:32:37 PDT 2005</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-727C5CDB-8701-40B3-8355-00C8314590A3__GUID-A8E9D844-7F09-4DB7-B317-8A553D210E6A">摘要</p>
                     <p>在本练习中，您学习了如何编写使用Java SASL API进行身份验证和彼此安全通信的客户端服务器应用程序。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-727C5CDB-8701-40B3-8355-00C8314590A3__GUID-9C5E34C7-EC7C-40B8-9CA0-940ACF7920A1">下一步</p>
                     <ol>
                        <li>
                           <p>继续<a href="part-ii-secure-communications-using-java-se-security-api.html#GUID-9AAFC7BB-8562-4E3E-B5EF-E33F30E779D1">练习5：将Java Secure Socket Extension与Kerberos一起使用，</a>以学习如何编写使用JSSE进行身份验证和彼此安全通信的客户端/服务器应用程序。
                           </p>
                        </li>
                        <li>
                           <p>继续<a href="part-iii-deploying-single-sign-kerberos-environment.html#GUID-5D0B8FD9-FF12-44E7-B7E9-7620E95E784C">练习6：部署单点登录，</a>以了解如何配置您刚刚用来在Kerberos环境中实现单点登录的示例程序。
                           </p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-9AAFC7BB-8562-4E3E-B5EF-E33F30E779D1" name="GUID-9AAFC7BB-8562-4E3E-B5EF-E33F30E779D1"></a><h3 id="JSSEC-GUID-9AAFC7BB-8562-4E3E-B5EF-E33F30E779D1" class="sect3">练习5：将Java安全套接字扩展与Kerberos一起使用</h3>
               <div>
                  <p></p>
                  <div class="section">
                     <p class="subhead2" id="GUID-9AAFC7BB-8562-4E3E-B5EF-E33F30E779D1__GUID-62E60DAA-6C96-4A75-94A2-AE657ECAE01D">本练习的目的</p>
                     <p>本练习的目的是学习如何使用JSSE API使用Kerberos密码套件执行安全的身份验证和通信。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-9AAFC7BB-8562-4E3E-B5EF-E33F30E779D1__GUID-8698BA6F-AB32-4CC9-A79D-82769A35798E">本练习的背景</p>
                     <p>安全套接字层（SSL）和传输层安全性（TLS）是用于在Internet上实施加密的最广泛使用的协议。TLS是从SSL演变而来的Internet标准。 SSL / TLS为应用程序级协议（例如HTTP和LDAP）提供安全的身份验证和通信。例如，HTTPS是使用基于SSL / TLS的HTTP的结果协议。 SSL / TLS不仅用于HTTP等标准协议，而且在使用需要安全通信的自定义协议构建自定义应用程序时也广泛使用SSL / TLS。</p>
                     <p>SSL / TLS传统上使用基于证书的身份验证，通常用于服务器身份验证。例如，当诸如浏览器之类的Web客户端代表用户访问安全网站（服务器）时，服务器将其证书发送给浏览器，以便浏览器可以验证服务器的身份。这样可以确保用户不会将机密信息（例如信用卡信息）泄露给虚假服务器。最近，新标准允许将Kerberos与TLS一起使用。这意味着应用程序可以使用Kerberos凭据并在部署环境中利用Kerberos基础结构，而不是使用基于证书的身份验证。使用Kerberos密码套件还提供了对相互身份验证的自动支持，其中除了服务器之外，还对客户端进行身份验证。</p>
                     <p>是否针对特定应用程序使用Java GSS，Java SASL或JSSE的决定通常取决于几个因素，包括与应用程序交互的服务（所使用的协议），部署环境（基于PKI或Kerberos的） ，以及应用程序的安全要求。JSSE提供了一个负责I / O和传输的安全的端到端通道，而Java GSS和Java SASL提供了对数据的加密和完整性保护，但是应用程序负责将安全的数据传输到其对等端。文档“ <a href="when-use-java-gss-api-vs-jsse.html#GUID-51EAFD1C-7203-40C7-A295-61062D322E8C">何时使用Java GSS-API与JSSE”</a>中介绍了一些有关决定何时使用JSSE和Java GSS的因素的详细信息。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-9AAFC7BB-8562-4E3E-B5EF-E33F30E779D1__GUID-FA4445E1-86C3-40BC-81EA-915111A48C81">本练习的资源</p>
                     <ul style="list-style-type:disc">
                        <li><a href="java-secure-socket-extension-jsse-reference-guide.html#GUID-93DEEE16-0B70-40E5-BBE7-55C3FD432345" title="Java安全套接字扩展（JSSE）支持安全的Internet通信。它为TLS和DTLS协议的Java版本提供了框架和实现，并包括数据加密，服务器身份验证，消息完整性和可选的客户端身份验证的功能。">Java安全套接字扩展（JSSE）参考指南</a></li>
                        <li>JSSE Javadoc API： <a href="https://docs.oracle.com/javase/10/docs/api/javax/net/package-summary.html" target="_blank"><span class="apiname">javax.net</span></a>和<a href="https://docs.oracle.com/javase/10/docs/api/javax/net/ssl/package-summary.html" target="_blank"><span class="apiname">javax.net.ssl</span></a></li>
                        <li><a href="https://www.ietf.org/rfc/rfc6101.txt" target="_blank">SSL协议版本3.0</a></li>
                        <li><a href="http://www.ietf.org/rfc/rfc2246.txt" target="_blank">TLS协议版本1.0（RFC 2246）</a></li>
                        <li><a href="http://www.ietf.org/rfc/rfc2712.txt" target="_blank">将Kerberos密码套件添加到传输层安全性TLS（RFC 2712）</a></li>
                        <li><a href="when-use-java-gss-api-vs-jsse.html#GUID-51EAFD1C-7203-40C7-A295-61062D322E8C">何时使用Java GSS-API和JSSE</a></li>
                     </ul>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-9AAFC7BB-8562-4E3E-B5EF-E33F30E779D1__GUID-C1E26FD3-021A-44CF-A5ED-93FA54680BF7">本练习概述</p>
                     <p>此练习是一个客户机/服务器应用程序，它演示了如何使用JSSE和Kerberos密码套件安全地进行通信。客户端和服务器部分首先使用<a href="part-i-secure-authentication-using-java-authentication-and-authorization-service-jaas.html#GUID-1446370E-5019-4BD1-860A-22BAC1F13CF8">练习1：使用JAAS API</a>向Kerberos进行身份验证。这会将凭据存储在主题中。然后，应用程序执行一个操作，该操作在使用主题的<span class="apiname">Subject.doA</span>内部执行JSSE操作（使用Kerberos密码套件）。Kerberos密码套件实现是因为它在<span class="apiname">doA</span>内部执行，因此从主题中获取Kerberos凭据，并使用它们与对等方进行身份验证并安全地交换消息。此示例在客户端和服务器之间来回发送以换行符结尾的消息，该消息使用协商的密码套件加密并受完整性保护。
                     </p>
                     <p>根据标准（RFC 2712），所有启用Kerberos的TLS应用程序都使用相同的服务名称（ <span class="italic">主机</span> ）。因此，在本练习中，您无需显式提供Kerberos服务名称。
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-9AAFC7BB-8562-4E3E-B5EF-E33F30E779D1__GUID-866C3EFB-D41E-40FE-945A-9B08068A0DBA">遵循的步骤</p>
                     <ol>
                        <li>
                           <p>阅读<a href="source-code-advanced-security-programming-java-se-authentication-secure-communication-and-single-sig.html#GUID-40AF52E5-ECEA-4E5F-B0C1-35C150C7BB6E__JSSESERVER.JAVA-338B733A"><code>JsseServer.java</code></a>示例代码。
                           </p>
                           <p>此代码片段定义了在服务主体已向KDC进行身份验证之后执行的操作。它取代了<code class="codeph">MyAction</code>在<a href="part-i-secure-authentication-using-java-authentication-and-authorization-service-jaas.html#GUID-1446370E-5019-4BD1-860A-22BAC1F13CF8">练习1：使用JAAS API中</a> 。服务器首先创建一个<span class="apiname">SSLServerSocket</span> 。这类似于创建普通<span class="apiname">ServerSocket</span>的应用程序，只是<span class="apiname">SSLServerSocket</span>将根据需要提供自动身份验证，加密和解密。然后，服务器设置它要使用的密码套件。然后，服务器循环运行，接受来自SSL客户端的连接，并从SSL套接字读取和写入。服务器可以通过调用<span class="apiname">getLocalPrincipal（）</span>和<span class="apiname">getPeerPrincipal（）</span>方法来找出套接字所有者的身份。
                           </p>
                        </li>
                        <li>
                           <p>编译示例代码。</p>
                        </li>
                        <li>
                           <p>阅读<a href="source-code-advanced-security-programming-java-se-authentication-secure-communication-and-single-sig.html#GUID-40AF52E5-ECEA-4E5F-B0C1-35C150C7BB6E__JSSECLIENT.JAVA-338B7667"><code>JsseClient.java</code></a>示例代码。
                           </p>
                           <p>此代码片段定义了在客户端主体已向KDC进行身份验证之后执行的操作。它取代了<code class="codeph">MyAction</code>在<a href="part-i-secure-authentication-using-java-authentication-and-authorization-service-jaas.html#GUID-1446370E-5019-4BD1-860A-22BAC1F13CF8">练习1：使用JAAS API中</a> 。客户端首先创建一个<span class="apiname">SSLSocket</span> 。然后，客户端将设置要使用的密码套件。然后，客户端通过读取和写入套接字的输入/输出流，使用<span class="apiname">SSLSocket</span>与服务器交换消息。客户端可以通过调用<span class="apiname">getLocalPrincipal（）</span>和<span class="apiname">getPeerPrincipal（）</span>方法找出套接字所有者的身份。
                           </p>
                        </li>
                        <li>
                           <p>编译示例代码。</p>
                        </li>
                        <li>
                           <p>启动一个新窗口并启动服务器。 <code class="codeph">JsseServer</code>接受一个参数：运行JSSE服务的服务器的名称。例如，如果它在计算机j1hol-001上运行，则应输入以下内容：</p><pre class="pre codeblock"><code>% xterm &amp;
% java -Djava.security.auth.login.config=jaas-krb5.conf JsseServer j1hol-001</code></pre></li>
                        <li>
                           <p>运行客户端应用程序。 <code class="codeph">JsseClient</code>接受一个参数：运行JSSE服务的服务器的名称。例如，如果服务在计算机j1hol-001上运行，则应输入以下内容。
                           </p><pre class="pre codeblock"><code>% java -Djava.security.auth.login.config=jaas-krb5.conf JsseClient j1hol-001</code></pre><p>提供安全密码。</p>
                        </li>
                        <li>
                           <p>在相应的客户端和服务器应用程序的窗口中观察以下输出。</p>
                           <p>输出用于运行<code class="codeph">JsseServer</code>例：</p><pre class="pre codeblock"><code>Authenticated principal: [host/j1hol-001@J1LABS.EXAMPLE.COM]
Waiting for incoming connections...
Got connection from client /192.0.2.102
Received: Hello There!
Sending: Hello There! Fri May 07 15:32:37 PDT 2005
Cipher suite in use: TLS_KRB5_WITH_3DES_EDE_CBC_SHA
I am: host/j1hol-001@J1LABS.EXAMPLE.COM
Client is: test@J1LABS.EXAMPLE.COM</code></pre><p>输出用于运行<code class="codeph">JsseClient</code>示例（ <span class="italic">密码</span>将替换为您提供的密码）：</p><pre class="pre codeblock"><code>Kerberos password for test: password
Authenticated principal: [test@J1LABS.EXAMPLE.COM]
Sending: Hello There!
Received: Hello There! Fri May 07 15:32:37 PDT 2005
Cipher suite in use: TLS_KRB5_WITH_3DES_EDE_CBC_SHA
I am: test@J1LABS.EXAMPLE.COM
Server is: host/j1hol-001@J1LABS.EXAMPLE.COM</code></pre></li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-9AAFC7BB-8562-4E3E-B5EF-E33F30E779D1__GUID-DC5B5DA3-7473-417A-B013-95948CA3A78B">摘要</p>
                     <p>在本练习中，您学习了如何编写一个客户端服务器应用程序，该应用程序使用Kerberos作为底层身份验证系统，使用JSSE进行身份验证并彼此安全地通信。</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-9AAFC7BB-8562-4E3E-B5EF-E33F30E779D1__GUID-79182006-68D1-4AB7-BDE7-22A2588ABD45">下一步</p>
                     <p>继续<a href="part-iii-deploying-single-sign-kerberos-environment.html#GUID-5D0B8FD9-FF12-44E7-B7E9-7620E95E784C">练习6：部署单点登录，</a>以学习如何在练习3、4和5中配置示例程序，以在Kerberos环境中实现单点登录。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   

</body></html>