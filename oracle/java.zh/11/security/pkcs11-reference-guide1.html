<html lang="en-us"  xml:lang="en-us"><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content>
      <meta name="description" content>
      <title>PKCS#11 Reference Guide</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Security Developer’s Guide">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Security Developer’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="security-developer-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-09-21T08:42:26-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="1993, 2018">
      <meta name="dcterms.category" content="java">
      <meta name="dcterms.identifier" content="E94828-01">
      
      <meta name="dcterms.product" content="en/java/javase/11">
      <meta name="dcterms.release" content="11">
      <link rel="prev" href="oracle-providers.html" title="Previous" type="text/html">
      <link rel="next" href="java-authentication-and-authorization-service-jaas1.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"java","element_name":"Java","display_in_url":true},"suite":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product_group":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product":{"short_name":"javase","element_name":"Java SE","display_in_url":true},"release":{"short_name":"11","element_name":"11","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Security Developer Guide">
    <meta name="dcterms.isVersionOf" content="SECURITY">
  <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="oracle-providers.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一个</a> <a href="java-authentication-and-authorization-service-jaas1.html" class="pull-right">下一个<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">安全开发人员指南</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">PKCS＃11参考指南</li>
            </ol>
            <a id="GUID-30E98B63-4910-40A1-A6DD-663EAF466991" name="GUID-30E98B63-4910-40A1-A6DD-663EAF466991"></a>
            
            <h2 id="JSSEC-GUID-30E98B63-4910-40A1-A6DD-663EAF466991" class="sect2"><span class="enumeration_chapter">5</span> PKCS＃11参考指南</h2>
         </header>
         <div class="ind">
            <div>
               <p></p>
               <p>Java平台定义了一组用于执行加密操作的编程接口。这些接口统称为Java密码体系结构（JCA）和Java密码扩展（JCE）。请参阅《 <a href="java-cryptography-architecture-jca-reference-guide.html#GUID-2BCFDD85-D533-4E6C-8CE9-29990DEB0190" title="Java密码体系结构（JCA）是该平台的主要部分，包含一个" name="" provide="=" ="">Java密码学体系结构（JCA）参考指南》</a> 。
               </p>
               <p>密码接口是基于提供程序的。具体来说，应用程序与应用程序编程接口（API）进行通信，并且实际的加密操作在遵循一组服务提供程序接口（SPI）的已配置提供程序中执行。此体系结构支持不同的提供程序实现。某些提供程序可能会在软件中执行加密操作；其他人可以对硬件令牌（例如，在智能卡设备或硬件密码加速器上）执行操作。</p>
               <p>密码令牌接口标准PKCS＃11由RSA Security生成，它定义了加密令牌的本机编程接口，例如硬件加密加速器和智能卡。使用JCA和JCE API的现有应用程序可以使用PKCS＃11提供程序访问本机PKCS＃11令牌。无需修改应用程序。唯一的要求是正确配置提供程序。</p>
               <p>尽管应用程序可以使用现有API利用大多数PKCS＃11功能，但是某些应用程序可能需要更多的灵活性和功能。例如，应用程序可能要处理被更轻松地动态删除和插入的智能卡。或者，PKCS＃11令牌可能需要对某些与密钥无关的操作进行身份验证，因此，应用程序必须能够在不使用密钥库的情况下登录到令牌。JCA使应用程序在与不同的提供程序打交道时具有更大的灵活性。</p>
               <p>本文档描述了如何将本地PKCS＃11令牌配置到Java平台中以供Java应用程序使用。它还描述了JCA如何使应用程序更轻松地处理不同类型的提供程序，包括PKCS＃11提供程序。</p>
            </div>
            <div class="sect2"><a id="GUID-6DA72F34-6C6A-4F7D-ADBA-5811576A9331" name="GUID-6DA72F34-6C6A-4F7D-ADBA-5811576A9331"></a><h3 id="JSSEC-GUID-6DA72F34-6C6A-4F7D-ADBA-5811576A9331" class="sect3">SunPKCS11提供者</h3>
               <div>
                  <p>与大多数其他提供程序相比，SunPKCS11提供程序本身并不实现加密算法。相反，它充当Java JCA和JCE API与本机PKCS＃11加密API之间的桥梁，在两者之间转换调用和约定。</p>
                  <p>这意味着调用标准JCA和JCE API的Java应用程序无需修改即可利用基础PKCS＃11实现提供的算法，例如，</p>
                  <ul style="list-style-type:disc">
                     <li>密码智能卡，</li>
                     <li>硬件加密加速器，以及</li>
                     <li>高性能软件实现。</li>
                  </ul>
                  <div class="infoboxnote" id="GUID-6DA72F34-6C6A-4F7D-ADBA-5811576A9331__GUID-1DBACA0C-33DE-436F-B9B1-18D9AD105863">
                     <p class="notep1">注意：</p>Java SE仅有助于访问本机PKCS＃11的实现，它本身不包括本机PKCS＃11的实现。但是，诸如智能卡和硬件加速器之类的密码设备通常会附带包含PKCS＃11实现的软件，您需要根据制造商的说明进行安装和配置。
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-97F1E537-CB59-4C7F-AB6B-05D4DBD69AC0" name="GUID-97F1E537-CB59-4C7F-AB6B-05D4DBD69AC0"></a><h3 id="JSSEC-GUID-97F1E537-CB59-4C7F-AB6B-05D4DBD69AC0" class="sect3">SunPKCS11要求</h3>
               <div>
                  <p>SunPKCS11提供程序要求在系统上安装PKCS＃11 v2.20或更高版本的实现。此实现必须采用共享库的形式（ <code>.so</code>在Solaris和Linux上）或动态链接库（ <code>.dll</code>在Windows上）。请查阅您的供应商文档，以了解您的加密设备是否包括这样的PKCS＃11实现，如何配置它以及库文件的名称是什么。
                  </p>
                  <p>如果基础PKCS＃11实现提供了这些算法，则SunPKCS11提供程序支持多种算法。该算法及其对应的PKCS＃11机制在<a href="pkcs11-reference-guide1.html#GUID-D3EF9023-7DDC-435D-9186-D2FD05674777">SunPKCS11提供程序支持的算法</a>的表中列出。
                  </p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-C4ABFACB-B2C9-4E71-A313-79F881488BB9" name="GUID-C4ABFACB-B2C9-4E71-A313-79F881488BB9"></a><h3 id="JSSEC-GUID-C4ABFACB-B2C9-4E71-A313-79F881488BB9" class="sect3">SunPKCS11配置</h3>
               <div>
                  <div class="section">
                     <p>SunPKCS11提供程序位于模块<span class="apiname">jdk.crypto.cryptoki中</span> 。要使用提供程序，您必须首先以静态或编程方式安装它。
                     </p>
                     <p>要静态安装提供程序，请将提供程序添加到Java安全属性文件中（ <code class="codeph"><span class="variable" translate="no">java-home</span>/conf/security/java.security</code> ）。
                     </p>
                     <p>例如，这是<code class="codeph">java.security</code>该文件将SunPKCS11提供程序与配置文件一起安装<code class="codeph">/opt/bar/cfg/pkcs11.cfg</code> 。
                     </p><pre class="pre codeblock"><code># configuration for security providers 1-12 omitted
security.provider.13=SunPKCS11 /opt/bar/cfg/pkcs11.cfg
</code></pre><p>要动态安装提供程序，请使用适当的配置文件名创建提供程序的实例，然后进行安装。这是一个例子。</p><pre class="pre codeblock"><code>    String configName = "/opt/bar/cfg/pkcs11.cfg";
    Provider p = Security.getProvider("SunPKCS11");
    p = p.configure(configName);
    Security.addProvider(p);</code></pre><div class="infoboxnote" id="GUID-C4ABFACB-B2C9-4E71-A313-79F881488BB9__GUID-160774D2-1740-4A7B-9C74-E82383614A0E">
                        <p class="notep1">注意：</p>
                        <p>保存从<span class="apiname">configure</span>方法返回的<span class="apiname">Provider</span>对象，然后添加该对象，如本示例所示：</p><pre class="pre codeblock"><code>    p = p.configure(configName);
    Security.addProvider(p);</code></pre><p>不要添加您从中调用<span class="apiname">configure</span>方法的提供程序：</p><pre class="pre codeblock"><code>    p.configure(configName);
    Security.addProvider(p);</code></pre><p>如果无法就地配置此提供程序，则将创建并返回一个新的提供程序。因此，请始终使用从<span class="apiname">configure</span>方法返回的提供程序。
                        </p>
                     </div>
                     <p>要为每个PKCS＃11实现使用多个插槽，或使用一个以上的PKCS＃11实现，只需使用适当的配置文件为每个应用重复安装。这将为每个PKCS＃11实现的每个插槽生成一个SunPKCS11提供程序实例。</p>
                     <p>配置文件是一个文本文件，其中包含以下格式的条目：</p><code class="codeph"><span class="variable" translate="no">attribute</span>=<span class="variable" translate="no">value</span></code><p>本节中的表描述了<span class="variable" translate="no">attribute</span>和<span class="variable" translate="no">value</span>的有效值：</p>这两个强制属性是<code class="codeph">name</code>和<code class="codeph">library</code> 。
                     <p>这是一个示例配置文件：</p><pre class="pre codeblock"><code>name = FooAccelerator
library = /opt/foo/lib/libpkcs11.so
</code></pre><p>注释由以<code class="codeph">#</code> （数字）符号。
                     </p>
                     <div class="tblformal" id="GUID-C4ABFACB-B2C9-4E71-A313-79F881488BB9__GUID-8ADD17FD-3320-4D8F-A1ED-319DFEABA338">
                        <p class="titleintable">表5-1 PKCS＃11提供程序配置文件中的属性</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="PKCS＃11提供程序配置文件中的属性" border="1" summary="PKCS#11 provider configuration file attributes." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th rowspan="1" colspan="1" align="left" valign="bottom" id="d80237e166">属性</th>
                                 <th rowspan="1" colspan="1" align="left" valign="bottom" id="d80237e168">值</th>
                                 <th rowspan="1" colspan="1" align="left" valign="bottom" id="d80237e170">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e174" headers="d80237e166 ">图书馆</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e174 d80237e168 ">PKCS＃11实现的路径名</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e174 d80237e170 ">这是PKCS＃11实现的完整路径名（包括扩展名）。路径名的格式取决于平台。例如， <code class="codeph">/opt/foo/lib/libpkcs11.so</code>可能是Solaris和Linux上PKCS＃11实现的路径名，而<code class="codeph">C:\foo\mypkcs11.dll</code>在Windows上可能是路径名。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e187" headers="d80237e166 ">名称</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e187 d80237e168 ">此提供程序实例的名称后缀</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e187 d80237e170 ">该字符串与前缀连接<code class="codeph">SunPKCS11-</code>产生此提供者实例的名称（即，其提供者返回的字符串<code class="codeph">Provider.getName()</code>方法）。例如，如果<code class="codeph">name</code>属性为<code class="codeph">"FooAccelerator"</code> ，那么提供者实例的名称将为<code class="codeph">"SunPKCS11-FooAccelerator"</code> 。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e209" headers="d80237e166 ">描述</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e209 d80237e168 ">此提供程序实例的描述</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e209 d80237e170 ">该字符串将由提供者实例的<code class="codeph">Provider.getInfo()</code>方法。如果未指定，将返回默认描述。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e219" headers="d80237e166 ">插槽</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e219 d80237e168 ">插槽编号</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e219 d80237e170 ">这是与此提供程序实例关联的插槽的ID。例如，您将使用<code class="codeph">1</code>具有ID的广告位<code class="codeph">1</code>在PKCS＃11下。最多<code class="codeph">slot</code>要么<code class="codeph">slotListIndex</code>可以指定。如果未指定，则默认为<code class="codeph">slotListIndex</code>的<code class="codeph">0</code> 。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e245" headers="d80237e166 ">slotListIndex</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e245 d80237e168 ">插槽索引</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e245 d80237e170 ">这是与此提供程序实例关联的插槽索引。它是PKCS＃11函数返回的所有插槽的列表的索引<code class="codeph">C_GetSlotList</code> 。例如， <code class="codeph">0</code>表示列表中的第一个插槽。最多<code class="codeph">slot</code>要么<code class="codeph">slotListIndex</code>可以指定。如果未指定，则默认为<code class="codeph">slotListIndex</code>的<code class="codeph">0</code> 。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e271" headers="d80237e166 ">启用机制</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e271 d80237e168 ">括号括起来，用空格分隔的PKCS＃11机制列表，以启用</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e271 d80237e170 ">这是此提供程序实例应使用的PKCS＃11机制列表，前提是SunPKCS11提供程序和PKCS＃11令牌都支持它们。所有其他机制将被忽略。列表中的每个条目都是PKCS＃11机制的名称。这是一个示例，列出了两种PKCS＃11机制。<pre class="pre codeblock"><code>enabledMechanisms = {
  CKM_RSA_PKCS
  CKM_RSA_PKCS_KEY_PAIR_GEN
}
</code></pre>最多<code class="codeph">enabledMechanisms</code>要么<code class="codeph">disabledMechanisms</code>可以指定。如果未指定，则启用的机制是SunPKCS11提供程序（请参阅<a href="pkcs11-reference-guide1.html#GUID-D3EF9023-7DDC-435D-9186-D2FD05674777">SunPKCS11提供程序支持的算法</a> ）和PKCS＃11令牌所支持的机制。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e290" headers="d80237e166 ">禁用机制</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e290 d80237e168 ">用括号括起来的空格分隔的PKCS＃11机制列表</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e290 d80237e170 ">这是此提供程序实例应忽略的PKCS＃11机制的列表。提供程序将忽略列出的任何机制，即使令牌和SunPKCS11提供程序支持它们也是如此。琴弦<code class="codeph">SecureRandom</code>和<code class="codeph">KeyStore</code>可以指定禁用这些服务。
                                    <p>最多<code class="codeph">enabledMechanisms</code>要么<code class="codeph">disabledMechanisms</code>可以指定。如果未指定，则启用的机制是SunPKCS11提供程序（请参阅<a href="pkcs11-reference-guide1.html#GUID-D3EF9023-7DDC-435D-9186-D2FD05674777">SunPKCS11提供程序支持的算法</a> ）和PKCS＃11令牌所支持的机制。
                                    </p> 
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e315" headers="d80237e166 ">属性</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e315 d80237e168 ">见下文</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e315 d80237e170 ">的<code class="codeph">attributes</code>选项可用于指定在创建PKCS＃11关键对象时应设置的其他PKCS＃11。这使得可以容纳需要特定属性的令牌。有关详细信息，请参见以下部分。
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-C4ABFACB-B2C9-4E71-A313-79F881488BB9__GUID-42F46DC9-8833-42E7-BB90-BD5D9091D8C1">属性配置</p>
                     <p>属性选项允许您指定在创建PKCS＃11密钥对象时应设置的其他PKCS＃11属性。默认情况下，SunPKCS11提供程序仅在创建对象时指定必需的PKCS＃11属性。例如，对于RSA公共密钥，它指定密钥类型和算法（CKA_CLASS和CKA_KEY_TYPE）以及RSA公共密钥的密钥值（CKA_MODULUS和CKA_PUBLIC_EXPONENT）。您正在使用的PKCS＃11库会将实现特定的默认值分配给RSA公钥的其他属性，例如，该密钥可用于加密和验证消息（CKA_ENCRYPT和CKA_VERIFY = true）。</p>
                     <p>的<code class="codeph">attributes</code>如果您不喜欢PKCS＃11实现分配的默认值，或者您的PKCS＃11实现不支持默认值并且需要显式指定值，则可以使用option选项。请注意，指定您的PKCS＃11实现不支持的属性或对于所讨论的密钥类型无效的属性，可能会导致操作在运行时失败。
                     </p>
                     <p>可以将选项指定零次或多次，以如下所述在配置文件中指定的顺序处理选项。的<code class="codeph">attributes</code>选项具有以下格式：</p><pre class="pre codeblock"><code>attributes(operation, keytype, keyalgorithm) = {
  name1 = value1
  [...]
}
</code></pre><p>的有效值<code class="codeph">operation</code>是：</p>
                     <ul style="list-style-type:disc">
                        <li><code class="codeph">generate</code> ，用于通过<span class="apiname">KeyPairGenerator</span>或<span class="apiname">KeyGenerator</span>生成的密钥</li>
                        <li><code class="codeph">import</code> ，用于通过<span class="apiname">KeyFactory</span>或<span class="apiname">SecretKeyFactory</span>创建的密钥。这也适用于将Java软件密钥传递给密码操作的初始化方法时自动转换为PKCS＃11密钥对象的情况。 <code class="codeph">Signature.initSign()</code> 。
                        </li>
                        <li><code class="codeph">*</code> ，用于使用“生成”或“创建”操作创建的密钥。
                        </li>
                     </ul>
                     <p>的有效值<code class="codeph">keytype</code>是<code class="codeph">CKO_PUBLIC_KEY</code> ， <code class="codeph">CKO_PRIVATE_KEY</code>和<code class="codeph">CKO_SECRET_KEY</code> ，分别用于公用密钥，专用密钥和秘密密钥，以及<code class="codeph">*</code>匹配任何类型的键。
                     </p>
                     <p>的有效值<code class="codeph">keyalgorithm</code>是其中之一<code class="codeph">CKK_xxx</code> PKCS＃11规范中的常量，或<code class="codeph">*</code>匹配任何算法的键。SunPKCS11提供程序当前支持的算法包括CKK_RSA，CKK_DSA，CKK_DH，CKK_AES，CKK_DES，CKK_DES3，CKK_RC4，CKK_BLOWFISH，CKK_GENERIC_SECRET和CKK_EC。</p>
                     <p>属性名称和值被指定为一个或多个名称-值对的列表。 <code class="codeph">name</code>必须是<code class="codeph">CKA_xxx</code>例如，来自PKCS＃11规范的常量<code class="codeph">CKA_SENSITIVE</code> 。 <code class="codeph">value</code>可以是以下之一：</p>
                     <ul style="list-style-type:disc">
                        <li>布尔值， <code class="codeph">true</code>要么<code class="codeph">false</code></li>
                        <li>整数，以十进制形式（默认）或十六进制形式（如果以开头） <code class="codeph">0x</code> 。
                        </li>
                        <li><code class="codeph">null</code> ，表明创建对象时，这个属性<span class="italic">不</span>应该被指定。
                        </li>
                     </ul>
                     <p>如果<code class="codeph">attributes</code>如果多次指定该选项，则将按指定的顺序处理条目，这些属性具有聚合的属性，后来的属性覆盖了先前的属性。例如，请考虑以下配置文件摘录：</p><pre class="pre codeblock"><code>attributes(*,CKO_PRIVATE_KEY,*) = {
  CKA_SIGN = true
}

attributes(*,CKO_PRIVATE_KEY,CKK_DH) = {
  CKA_SIGN = null
}

attributes(*,CKO_PRIVATE_KEY,CKK_RSA) = {
  CKA_DECRYPT = true
}
</code></pre><p>第一个条目说要指定<code class="codeph">CKA_SIGN = true</code>用于所有私钥。第二个选项用<code class="codeph">null</code>对于Diffie-Hellman私钥，因此<code class="codeph">CKA_SIGN</code>根本不会为他们指定属性。最后，第三个选项表示还要指定<code class="codeph">CKA_DECRYPT = true</code>用于RSA私钥。这意味着RSA私钥将同时具有<code class="codeph">CKA_SIGN = true</code>和<code class="codeph">CKA_DECRYPT = true</code>组。
                     </p>
                     <p>还有一种特殊的形式<code class="codeph">attributes</code>选项。你可以写<code class="codeph">attributes = compatibility</code>在配置文件中。这是整个属性语句集的快捷方式。它们旨在提供与现有Java应用程序的最大兼容性，例如，它们可能期望所有密钥组件都可访问，而秘密密钥可用于加密和解密。的<code class="codeph">compatibility</code>属性行可以与其他属性一起使用<code class="codeph">attributes</code>行，在这种情况下，如前所述适用相同的汇总和覆盖规则。
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-85EA1017-E59C-49B9-9207-65B7B2BF171E" name="GUID-85EA1017-E59C-49B9-9207-65B7B2BF171E"></a><h3 id="JSSEC-GUID-85EA1017-E59C-49B9-9207-65B7B2BF171E" class="sect3">访问网络安全服务（NSS）</h3>
               <div>
                  <p></p>
                  <div class="section">
                     <p><a href="http://www.mozilla.org/projects/security/pki/nss/" target="_blank">网络安全服务（NSS）</a>是一组开源安全性库，其加密API基于PKCS＃11，但是它包含PKCS＃11标准之外的特殊功能。SunPKCS11提供程序包括与这些NSS特定功能进行交互的代码，其中包括一些NSS特定的配置指令，如下所述。
                     </p>
                     <p>为了获得最佳效果，我们建议您使用最新版本的NSS。至少应为3.12版本。</p>
                     <p>当以下任何情况发生时，SunPKCS11提供程序将使用NSS特定的代码： <code class="codeph">nss</code>使用下面描述的配置指令。在这种情况下，常规配置命令<code class="codeph">library</code> ， <code class="codeph">slot</code>和<code class="codeph">slotListIndex</code>不能使用。
                     </p>
                     <div class="tblformal" id="GUID-85EA1017-E59C-49B9-9207-65B7B2BF171E__GUID-D7866EA0-8645-4F13-A702-7502BCDFC51F">
                        <p class="titleintable">表5-2 NSS属性和值</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="NSS属性和值" border="1" summary="List of NSS attributes and values." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th rowspan="1" colspan="1" align="left" valign="bottom" id="d80237e519">属性</th>
                                 <th rowspan="1" colspan="1" align="left" valign="bottom" id="d80237e521">值</th>
                                 <th rowspan="1" colspan="1" align="left" valign="bottom" id="d80237e523">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e527" headers="d80237e519 ">nssLibraryDirectory</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e527 d80237e521 ">包含NSS和NSPR库的目录</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e527 d80237e523 ">这是包含NSS和<a href="http://www.mozilla.org/projects/nspr/" target="_blank">NSPR</a>库的目录的完整路径名。必须指定它，除非已由与Java VM相同进程运行的另一个组件加载和初始化了NSS。<p>根据您的平台，您可能需要设置<code class="codeph">LD_LIBRARY_PATH</code>要么<code class="codeph">PATH</code> （在Windows上）包括此目录，以允许操作系统找到从属库。
                                    </p> 
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e547" headers="d80237e519 ">nssSecmodDirectory</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e547 d80237e521 ">包含NSS DB文件的目录</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e547 d80237e523 ">包含NSS配置和密钥信息的目录的完整路径名（ <code class="codeph">secmod.db</code> ， <code class="codeph">key3.db</code>和<code class="codeph">cert8.db</code> ）。除非已由另一个组件初始化NSS（请参见上文）或使用NSS且没有数据库文件（如下所述），否则必须指定此伪指令。
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e563" headers="d80237e519 ">nssDbMode</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e563 d80237e521 ">之一<code class="codeph">readWrite</code> ， <code class="codeph">readOnly</code>和<code class="codeph">noDb</code></td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e563 d80237e523 ">该指令确定如何访问NSS数据库。在读写模式下，可以进行完全访问，但是一次只能访问一个进程。只读模式不允许修改文件。
                                    <p>noDb模式允许NSS在没有数据库文件的情况下纯粹用作加密提供程序。无法使用PKCS11 KeyStore创建持久密钥。</p> 
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e581" headers="d80237e519 ">nssModule</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e581 d80237e521 ">之一<code class="codeph">keystore</code> ， <code class="codeph">crypto</code> ， <code class="codeph">fips</code>和<code class="codeph">trustanchors</code></td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e581 d80237e523 ">
                                    <p>NSS使用几个不同的库和插槽使其功能可用。此伪指令确定此SunPKCS11实例访问这些模块中的哪个。</p>
                                    <p>的<code class="codeph">crypto</code>模块是默认的<code class="codeph">noDb</code>模式。它支持无需登录但没有永久密钥的加密操作。
                                    </p>
                                    <p>的<code class="codeph">fips</code>如果NSS，则模块为默认模块<code class="codeph">secmod.db</code>已设置为FIPS-140兼容模式。在这种模式下，NSS限制了可用于创建密钥的可用算法和PKCS＃11属性。
                                    </p>
                                    <p>的<code class="codeph">keystore</code>在其他配置中，模块是默认设置。它使用PKCS11 KeyStore支持持久密钥，这些密钥存储在NSS DB文件中。该模块需要登录。
                                    </p>
                                    <p>的<code class="codeph">trustanchors</code>模块通过PKCS11 KeyStore启用对NSS信任锚证书的访问（如果有） <code class="codeph">secmod.db</code>已配置为包括信任锚库。
                                    </p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-85EA1017-E59C-49B9-9207-65B7B2BF171E__GUID-98F50D8E-A21A-4749-A540-DEDA7DD5ED9E">
                     <p class="titleinexample">示例5-1 NSS的SunPKCS11配置文件</p>
                     <p>NSS作为纯加密技术提供者</p><pre class="pre codeblock"><code>name = NSScrypto
nssLibraryDirectory = /opt/tests/nss/lib
nssDbMode = noDb
attributes = compatibility
</code></pre><p>NSS作为符合FIPS 140的加密令牌</p><pre class="pre codeblock"><code>name = NSSfips
nssLibraryDirectory = /opt/tests/nss/lib
nssSecmodDirectory = /opt/tests/nss/fipsdb
nssModule = fips
</code></pre></div>
                  <!-- class="example" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-7989F8B4-7260-4908-8203-99056B2D060E" name="GUID-7989F8B4-7260-4908-8203-99056B2D060E"></a><h3 id="JSSEC-GUID-7989F8B4-7260-4908-8203-99056B2D060E" class="sect3">PKCS＃11故障排除</h3>
               <div>
                  <p></p>
                  <div class="section">
                     <p>PKCS＃11可能存在问题，需要调试。要显示有关库，插槽，令牌和机制的调试信息，请添加<code class="codeph">showInfo=true</code>在SunPKCS11提供程序配置文件中，该文件是<code><span class="variable" translate="no"><java-home></span>/conf/security/sunpkcs11-solaris.cfg</code>或您按照<a href="pkcs11-reference-guide1.html#GUID-C4ABFACB-B2C9-4E71-A313-79F881488BB9">SunPKCS11 Configuration中</a>所述静态或动态指定的配置文件。
                     </p>
                     <p>有关其他调试信息，用户可以使用以下选项之一启动或重新启动Java进程：</p>
                     <ul style="list-style-type:disc">
                        <li>
                           <p>有关常规SunPKCS11提供程序的调试信息：</p>
                           <p><code class="codeph">-Djava.security.debug=sunpkcs11</code></p>
                        </li>
                        <li>
                           <p>对于PKCS＃11密钥库特定的调试信息：</p>
                           <p><code class="codeph">-Djava.security.debug=pkcs11keystore</code></p>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-F068B4E6-8FAD-4443-9269-7DF13573C8DF" name="GUID-F068B4E6-8FAD-4443-9269-7DF13573C8DF"></a><h3 id="JSSEC-GUID-F068B4E6-8FAD-4443-9269-7DF13573C8DF" class="sect3">禁用PKCS＃11提供程序和/或单个PKCS＃11机制</h3>
               <div>
                  <p>作为故障排除过程的一部分，暂时禁用PKCS＃11提供程序或给定提供程序的特定机制可能会有所帮助。</p>
                  <div class="section">请注意，禁用PKCS＃11提供程序只是一种临时措施。通过禁用PKCS＃11提供程序，该提供程序将不再可用，从而可能导致应用程序中断或对性能产生影响。一旦发现问题，则仅应禁用该特定机制。</div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F068B4E6-8FAD-4443-9269-7DF13573C8DF__GUID-76E350DE-6387-4E88-81ED-3FE29BDEF673">禁用PKCS＃11提供程序</p>
                     <p>可以使用以下方法之一禁用PKCS＃11提供程序：</p>
                     <ol>
                        <li>
                           <p>对单个Java进程禁用PKCS＃11。使用以下Java命令行标志启动或重新启动Java进程：</p> 
                           <p><code class="codeph">-Dsun.security.pkcs11.enable-solaris=false</code></p>
                           <div class="infoboxnote" id="GUID-F068B4E6-8FAD-4443-9269-7DF13573C8DF__GUID-2A2DD2C2-41EC-44C6-A37F-9D52ED1BF951">
                              <p class="notep1">注意：</p>仅当由默认Solaris PKCS＃11提供程序文件支持时，此步骤才适用于SunPKCS11提供程序（ <code><span class="variable" translate="no"><java_home></span>/conf/security/sunpkcs11-solaris.cfg</code> ）。
                           </div>
                        </li>
                        <li>
                           <p>对使用特定Java安装运行的所有Java进程禁用PKCS＃11：这可以通过使用API（本节未显示）动态完成，也可以通过编辑<code class="codeph"><span class="variable" translate="no"><java_home></span>/conf/security/java.security</code>文件，并注释掉SunPKCS11安全提供程序（如有必要，请不要忘记对提供程序的顺序重新编号），如下所示。
                           </p>
                           <div class="p"><pre class="pre codeblock"><code>#
# List of providers and their preference orders (see above):
#
security.provider.1=SUN
security.provider.2=SunRsaSign
security.provider.3=SunEC
security.provider.4=SunJSSE
security.provider.5=SunJCE
security.provider.6=SunJGSS
security.provider.7=SunSASL
security.provider.8=XMLDSig
security.provider.9=SunPCSC
security.provider.10=JdkLDAP
security.provider.11=JdkSASL
security.provider.12=SunMSCAPI
<span class="bold">#security.provider.13=SunPKCS11</span></code></pre></div>
                           <p>启动或重新启动在此Java安装上运行的Java进程。</p>
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section" id="GUID-F068B4E6-8FAD-4443-9269-7DF13573C8DF__GUID-6D397DE0-3339-426C-ABA8-A0B079DB8A5A">
                     <p class="subhead2" id="GUID-F068B4E6-8FAD-4443-9269-7DF13573C8DF__GUID-2C4BC0FE-A576-4C3B-A614-BAD021648004">禁用特定机制</p>
                     <p>如果某个问题在PKCS＃11的一种机制中发生，可以通过仅禁用该特定机制而不是整个PKCS＃11提供程序来解决（如果禁用了该功能，请不要忘记重新启用PKCS＃11提供程序）之前）。</p>
                     <div class="infoboxnote" id="GUID-F068B4E6-8FAD-4443-9269-7DF13573C8DF__GUID-2DFCFB11-76BD-46E8-9FE1-0033BBF66714">
                        <p class="notep1">注意：</p>
                        <p>要仅禁用PKCS＃11 SecureRandom实现，可以将<span class="apiname">SecureRandom</span>添加到禁用的机制列表中。 <code><span class="variable" translate="no"><java-home></span>/conf/security/sunpkcs11-solaris.cfg</code>文件：</p><pre class="pre codeblock"><code>name = Solaris

description = SunPKCS11 accessing Solaris Cryptographic Framework

library = /usr/lib/$ISA/libpkcs11.so

handleStartupErrors = ignoreAll

# Use the X9.63 encoding for EC points (do not wrap in an ASN.1 OctetString).
useEcX963Encoding = true

attributes = compatibility

disabledMechanisms = {
  CKM_DSA_KEY_PAIR_GEN
  <span class="bold">SecureRandom</span>
}
</code></pre></div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-4C366313-33B9-458C-A845-33D0C8A9C367" name="GUID-4C366313-33B9-458C-A845-33D0C8A9C367"></a><h3 id="JSSEC-GUID-4C366313-33B9-458C-A845-33D0C8A9C367" class="sect3">应用程式开发人员</h3>
               <div>
                  <p>Java应用程序可以使用现有的JCA和JCE API通过SunPKCS11提供程序访问PKCS＃11令牌。</p>
               </div>
               <div class="sect3"><a id="GUID-6E8B2F3C-792F-4512-9BB3-234C440ADC46" name="GUID-6E8B2F3C-792F-4512-9BB3-234C440ADC46"></a><h4 id="JSSEC-GUID-6E8B2F3C-792F-4512-9BB3-234C440ADC46" class="sect4">令牌登录</h4>
                  <div>
                     <p>您可以使用个人识别码登录到密钥库，然后执行PKCS＃11操作。</p>
                     <p>某些PKCS＃11操作（例如访问私钥）要求使用个人识别码或PIN登录，然后才能进行操作。需要登录的最常见的操作类型是那些处理令牌上的键的操作。在Java应用程序中，此类操作通常涉及首先加载密钥库。通过以下方式访问PKCS＃11令牌作为密钥库时<code class="codeph">java.security.KeyStore</code>类别，您可以在密码输入参数中提供PIN给<a href="https://docs.oracle.com/javase/10/docs/api/java/security/KeyStore.html#load-java.io.InputStream-char:A-" target="_blank"><code class="codeph">load</code></a>方法。然后，SunPKCS11提供程序将使用PIN登录令牌。这是一个例子。
                     </p><pre class="pre codeblock"><code>    char[] pin = ...; 
    KeyStore ks = KeyStore.getInstance("PKCS11");
    ks.load(null, pin); 
</code></pre><p>这对于将PKCS＃11令牌视为静态密钥库的应用程序来说是很好的。对于想要更动态地容纳PKCS＃11令牌的应用程序（例如，插入和移除智能卡），可以使用新的<code class="codeph">KeyStore.Builder</code>类。这是一个如何使用回调处理程序初始化PKCS＃11密钥库的构建器的示例。
                     </p><pre class="pre codeblock"><code>    KeyStore.CallbackHandlerProtection chp =
        new KeyStore.CallbackHandlerProtection(new MyGuiCallbackHandler());
    KeyStore.Builder builder =
        KeyStore.Builder.newInstance("PKCS11", null, chp);
</code></pre><p>对于SunPKCS11提供程序，回调处理程序必须能够满足<code class="codeph">PasswordCallback</code> ，用于提示用户输入PIN。每当应用程序需要访问密钥库时，它都会使用构建器，如下所示。
                     </p><pre class="pre codeblock"><code>    KeyStore ks = builder.getKeyStore();
    Key key = ks.getKey(alias, null);
</code></pre><p>构建器将使用先前配置的回调处理程序根据需要提示输入密码。构建器将仅提示您为初始访问输入密码。如果应用程序的用户继续使用同一智能卡，则不会再次提示该用户。如果用户删除并插入其他智能卡，则构建器将提示您输入新卡的密码。</p>
                     <p>根据PKCS＃11令牌的不同，可能存在一些与密钥无关的操作，这些操作也需要令牌登录。使用此类操作的应用程序可以使用<a href="https://docs.oracle.com/javase/10/docs/api/java/security/AuthProvider.html" target="_blank"><span class="apiname">java.security。AuthProvider</span></a>类。的<code class="codeph">AuthProvider</code>类从<code class="codeph">java.security.Provider</code>并定义了在提供程序上执行登录和注销操作，以及设置供提供程序使用的回调处理程序的方法。
                     </p>
                     <p>对于SunPKCS11提供程序，回调处理程序必须能够满足<code class="codeph">PasswordCallback</code> ，用于提示用户输入PIN。</p>
                     <p>这是应用程序可能如何使用<code class="codeph">AuthProvider</code>登录令牌。（请注意，在使用SunPKCS11提供程序之前，必须对其进行配置。）
                     </p><pre class="pre codeblock"><code>    Provider p = Security.getProvider("SunPKCS11");
    AuthProvider aprov = (AuthProvider)p.configure(<span class="variable" translate="no">&lt;provider configuration file&gt;</span>);
    aprov.login(subject, new MyGuiCallbackHandler());</code></pre></div>
               </div>
               <div class="sect3"><a id="GUID-508B5E3B-BF39-4E02-A1BD-523352D3AA12" name="GUID-508B5E3B-BF39-4E02-A1BD-523352D3AA12"></a><h4 id="JSSEC-GUID-508B5E3B-BF39-4E02-A1BD-523352D3AA12" class="sect4">令牌密钥</h4>
                  <div>
                     <p>爪哇<code class="codeph">Key</code>对象可能包含也可能不包含实际的密钥材料。
                     </p>
                     <ul style="list-style-type:disc">
                        <li>软件<span class="apiname">密钥</span>对象确实包含实际的密钥材料，并允许访问该材料。
                        </li>
                        <li>安全令牌（例如智能卡）上的不可提取密钥由不包含实际密钥材料的Java <span class="apiname">Key</span>对象表示。<span class="apiname">Key</span>对象仅包含对实际键的引用。
                        </li>
                     </ul>
                     <p>应用程序和提供程序必须使用正确的接口来表示这些不同类型的<span class="apiname">Key</span>对象。软件<span class="apiname">密钥</span>对象（或任何有权访问实际密钥材料的<span class="apiname">密钥</span>对象）应实现<a href="https://docs.oracle.com/javase/10/docs/api/java/security/interfaces/package-summary.html" target="_blank"><span class="apiname">java.security.interfaces</span></a>和<a href="https://docs.oracle.com/javase/10/docs/api/javax/crypto/interfaces/package-summary.html" target="_blank"><span class="apiname">javax.crypto.interfaces</span></a>包中的接口（例如<code class="codeph">DSAPrivateKey</code> ）。表示不可提取令牌密钥的密钥对象应仅在<a href="https://docs.oracle.com/javase/10/docs/api/java/security/package-summary.html" target="_blank"><span class="apiname">java.security</span></a>和<a href="https://docs.oracle.com/javase/10/docs/api/javax/crypto/package-summary.html" target="_blank"><span class="apiname">javax.crypto</span></a>包中实现相关的通用接口（ <code class="codeph">PrivateKey</code> ， <code class="codeph">PublicKey</code> ， 要么<code class="codeph">SecretKey</code> ）。密钥算法的识别应使用<code class="codeph">Key.getAlgorithm()</code>方法。
                     </p>
                     <p>请注意，不可提取令牌密钥的<span class="apiname">Key</span>对象只能由与该令牌关联的提供者使用。
                     </p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-99785B51-50D8-458E-AA2C-755749F1E39E" name="GUID-99785B51-50D8-458E-AA2C-755749F1E39E"></a><h4 id="JSSEC-GUID-99785B51-50D8-458E-AA2C-755749F1E39E" class="sect4">延迟的提供商选择</h4>
                  <div>
                     <p>Java密码学<code class="codeph">getInstance()</code>方法，例如<code class="codeph">Cipher.getInstance("AES")</code> ，从实现请求的算法的第一个提供程序返回实现。但是，JDK会延迟提供程序的选择，直到调用相关的初始化方法为止。初始化方法接受<code class="codeph">Key</code>对象，然后可以确定哪个提供者可以接受指定的对象<code class="codeph">Key</code>宾语。这样可以确保所选提供者可以使用指定的<code class="codeph">Key</code>宾语。（如果应用程序尝试使用<code class="codeph">Key</code>提供程序仅接受软件密钥对象的提供者的不可提取令牌密钥的对象，然后提供者抛出<code class="codeph">InvalidKeyException</code> 。这是一个问题<code class="codeph">Cipher</code> ， <code class="codeph">KeyAgreement</code> ， <code class="codeph">Mac</code>和<code class="codeph">Signature</code>类。）以下是受影响的初始化方法。
                     </p>
                     <ul style="list-style-type:disc">
                        <li><code class="codeph"><a href="https://docs.oracle.com/javase/10/docs/api/javax/crypto/Cipher.html" target="_blank"><code class="codeph">Cipher</code></a>.init(..., Key key, ...)</code></li>
                        <li><code class="codeph"><a href="https://docs.oracle.com/javase/10/docs/api/javax/crypto/KeyAgreement.html" target="_blank"><code class="codeph">KeyAgreement</code></a>.init(Key key, ...)</code></li>
                        <li><code class="codeph"><a href="https://docs.oracle.com/javase/10/docs/api/javax/crypto/Mac.html" target="_blank"><code class="codeph">Mac</code></a>.init(Key key, ...)</code></li>
                        <li><code class="codeph"><a href="https://docs.oracle.com/javase/10/docs/api/java/security/Signature.html" target="_blank"><code class="codeph">Signature</code></a>.initSign(PrivateKey privateKey)</code></li>
                     </ul>
                     <p>此外，如果应用程序多次调用初始化方法（例如，每次使用不同的密钥），则每次都会选择给定密钥的正确提供者。换句话说，可以为每个初始化调用选择不同的提供程序。</p>
                     <p>尽管此延迟的提供程序选择对应用程序是隐藏的，但确实会影响<code class="codeph">getProvider()</code>方法<code class="codeph">Cipher</code> ， <code class="codeph">KeyAgreement</code> ， <code class="codeph">Mac</code>和<code class="codeph">Signature</code> 。如果<code class="codeph">getProvider()</code>被称为<span class="variable" translate="no">before</span>发生的初始化操作（和发生供应商的选择，因此之前），那么第一个供应商返回支持请求的算法。该提供程序可能与调用初始化方法<span class="italic">之后</span>选择的提供程序不同。如果<code class="codeph">getProvider()</code>初始化操作发生<span class="variable" translate="no">after</span>调用，然后返回实际选择的提供程序。建议仅应用程序调用<code class="codeph">getProvider()</code>在他们调用了相关的初始化方法之后。
                     </p>
                     <p>此外<code class="codeph">getProvider()</code> ，以下其他方法也会受到类似的影响。
                     </p>
                     <ul style="list-style-type:disc">
                        <li><code class="codeph">Cipher.getBlockSize</code></li>
                        <li><code class="codeph">Cipher.getExcemptionMechanism</code></li>
                        <li><code class="codeph">Cipher.getIV</code></li>
                        <li><code class="codeph">Cipher.getOutputSize</code></li>
                        <li><code class="codeph">Cipher.getParameters</code></li>
                        <li><code class="codeph">Mac.getMacLength</code></li>
                        <li><code class="codeph">Signature.getParameters</code></li>
                        <li><code class="codeph">Signature.setParameter</code></li>
                     </ul>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-60672551-8FF7-4BE1-AF28-CA0C81706B1C" name="GUID-60672551-8FF7-4BE1-AF28-CA0C81706B1C"></a><h4 id="JSSEC-GUID-60672551-8FF7-4BE1-AF28-CA0C81706B1C" class="sect4">JAAS KeyStoreLoginModule</h4>
                  <div>
                     <p></p>
                     <p>JDK带有JAAS密钥库登录模块<a href="https://docs.oracle.com/javase/10/docs/api/com/sun/security/auth/module/KeyStoreLoginModule.html" target="_blank"><span class="apiname">KeyStoreLoginModule</span></a> ，该模块允许应用程序使用其在指定密钥库中的身份进行身份验证。认证之后，应用程序将从密钥库中获取其主体和凭证信息（证书和私钥）。通过使用此登录模块并将其配置为使用PKCS＃11令牌作为密钥库，应用程序可以从PKCS＃11令牌获取此信息。
                     </p>
                     <p>使用以下选项来配置<code class="codeph">KeyStoreLoginModule</code>使用PKCS＃11令牌作为密钥库。
                     </p>
                     <ul style="list-style-type:disc">
                        <li><code class="codeph">keyStoreURL="NONE"</code></li>
                        <li><code class="codeph">keyStoreType="PKCS11"</code></li>
                        <li><code class="codeph">keyStorePasswordURL=<span class="variable" translate="no">some_pin_url</span></code></li>
                     </ul>
                     <p>哪里</p>
                     <dl>
                        <dt class="dlterm"><a name="GUID-60672551-8FF7-4BE1-AF28-CA0C81706B1C__GUID-D778A65D-C000-44CD-B164-2B4745AA4289"><!-- --></a> <span class="variable" translate="no">some_pin_url</span></dt>
                        <dd>PIN的位置。如果<code class="codeph">keyStorePasswordURL</code>选项被省略，那么登录模块将通过应用程序的回调处理程序获取PIN，并为其提供一个<code class="codeph">PasswordCallback</code> 。这是一个使用PKCS＃11令牌作为密钥库的配置文件示例。<pre class="pre codeblock"><code>other {
    com.sun.security.auth.module.KeyStoreLoginModule required
        keyStoreURL="NONE"
  keyStoreType="PKCS11"
  keyStorePasswordURL="file:/home/joe/scpin";
};
</code></pre></dd>
                     </dl>
                     <p>如果已动态配置了多个SunPKCS11提供程序，或者在<code class="codeph">java.security</code>安全属性文件，可以使用<code class="codeph">keyStoreProvider</code>以特定的提供者实例为目标的选项。此选项的参数是提供程序的名称。对于SunPKCS11提供程序，提供程序名称的格式为<code class="codeph">SunPKCS11-<span class="variable" translate="no">TokenName</span></code> ，在哪里<code class="codeph"><span class="variable" translate="no">TokenName</span></code>是配置了提供程序实例的名称后缀，如<a href="pkcs11-reference-guide1.html#GUID-C4ABFACB-B2C9-4E71-A313-79F881488BB9__GUID-8ADD17FD-3320-4D8F-A1ED-319DFEABA338" title="PKCS＃11提供程序配置文件属性。">表5-1所示</a> 。例如，以下配置文件使用名称后缀命名PKCS＃11提供程序实例<code class="codeph">SmartCard</code> 。
                     </p><pre class="pre codeblock"><code>other {
    com.sun.security.auth.module.KeyStoreLoginModule required
        keyStoreURL="NONE"
  keyStoreType="PKCS11"
  keyStorePasswordURL="file:/home/joe/scpin"
  keyStoreProvider="SunPKCS11-SmartCard";
};
</code></pre><p>某些PKCS＃11令牌支持通过受保护的身份验证路径登录。例如，智能卡可以具有专用的密码键盘来输入密码。生物识别设备还将拥有自己的获取身份验证信息的方式。如果PKCS＃11令牌具有受保护的身份验证路径，请使用<code class="codeph">protected=true</code>选项并省略<code class="codeph">keyStorePasswordURL</code>选项。这是此类令牌的配置文件示例。
                     </p><pre class="pre codeblock"><code>other {
    com.sun.security.auth.module.KeyStoreLoginModule required
        keyStoreURL="NONE"
  keyStoreType="PKCS11"
  protected=true;
};
</code></pre></div>
               </div>
               <div class="sect3"><a id="GUID-CE29BCBA-4C87-4DA0-B170-328E579200BD" name="GUID-CE29BCBA-4C87-4DA0-B170-328E579200BD"></a><h4 id="JSSEC-GUID-CE29BCBA-4C87-4DA0-B170-328E579200BD" class="sect4">令牌作为JSSE密钥库和信任库</h4>
                  <div>
                     <p></p>
                     <p>要使用PKCS＃11令牌作为JSSE密钥库或信任专卖店，JSSE应用程序可以使用中介绍的API <a href="pkcs11-reference-guide1.html#GUID-6E8B2F3C-792F-4512-9BB3-234C440ADC46" title="您可以使用个人识别码登录到密钥库，然后执行PKCS＃11操作。">令牌登录</a>实例化由PKCS＃11令牌支持的<span class="apiname">密钥库</span>和它传递给它的密钥管理器和信任管理器。然后，JSSE应用程序将可以访问令牌上的密钥。
                     </p>
                     <p>JSSE还支持通过系统属性配置对密钥库和信任库的使用，如《 <a href="java-secure-socket-extension-jsse-reference-guide.html#GUID-93DEEE16-0B70-40E5-BBE7-55C3FD432345" title="Java安全套接字扩展（JSSE）支持安全的Internet通信。它为TLS和DTLS协议的Java版本提供了框架和实现，并包括数据加密，服务器身份验证，消息完整性和可选的客户端身份验证的功能。">Java安全套接字扩展（JSSE）参考指南》中所述</a> 。要将PKCS＃11令牌用作密钥库或信任库，请设置<code class="codeph">javax.net.ssl.keyStoreType</code>和<code class="codeph">javax.net.ssl.trustStoreType</code>系统属性分别为“ PKCS11”，并设置<code class="codeph">javax.net.ssl.keyStore</code>和<code class="codeph">javax.net.ssl.trustStore</code>系统属性分别为<code class="codeph">NONE</code> 。要指定使用特定提供者实例，请使用<code class="codeph">javax.net.ssl.keyStoreProvider</code>和<code class="codeph">javax.net.ssl.trustStoreProvider</code>系统属性（例如，“ SunPKCS11-SmartCard”）。
                     </p>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-05DE5039-C62A-42B9-8F8E-DB6DB1B0CD44" name="GUID-05DE5039-C62A-42B9-8F8E-DB6DB1B0CD44"></a><h3 id="JSSEC-GUID-05DE5039-C62A-42B9-8F8E-DB6DB1B0CD44" class="sect3">将keytool和jarsigner与PKCS＃11令牌一起使用</h3>
               <div>
                  <p>如果已经在SunPKCS11提供程序中配置了<code class="codeph">java.security</code>安全属性文件（位于<code class="codeph">$JAVA_HOME/conf/security</code> Java运行时的目录），然后可以通过指定以下选项来使用keytool和jarsigner对PKCS＃11令牌进行操作。
                  </p>
                  <div class="p">
                     <ul style="list-style-type:disc">
                        <li><code class="codeph">-keystore NONE</code></li>
                        <li><code class="codeph">-storetype PKCS11</code></li>
                     </ul>这里是列出配置的PKCS＃11令牌的内容的命令示例。
                  </div>
                  <div class="p"><pre class="pre codeblock"><code>keytool -keystore NONE -storetype PKCS11 -list
</code></pre>可以使用<code class="codeph">-storepass</code>选项。如果未指定，则<code class="codeph">keytool</code>和<code class="codeph">jarsigner</code>将提示您输入令牌PIN。如果令牌具有受保护的身份验证路径（例如专用密码键盘或生物识别读取器），则<code class="codeph">-protected</code>必须指定选项，并且不能指定密码选项。
                  </div>
                  <p>如果在服务器中配置了多个SunPKCS11提供程序， <code class="codeph">java.security</code>安全属性文件，可以使用<code class="codeph">-providerName</code>以特定的提供者实例为目标的选项。此选项的参数是提供程序的名称。
                  </p>
                  <ul style="list-style-type:disc">
                     <li><code class="codeph">-providerName <span class="variable" translate="no">providerName</span></code></li>
                  </ul>
                  <p>对于SunPKCS11提供程序， <code class="codeph"><span class="variable" translate="no">providerName</span></code>的形式<code class="codeph">SunPKCS11-<span class="variable" translate="no">TokenName</span></code>哪里：</p>
                  <dl>
                     <dt class="dlterm"><a name="GUID-05DE5039-C62A-42B9-8F8E-DB6DB1B0CD44__GUID-486DE0FD-CA9D-401F-96D2-44FDB25B6FC3"><!-- --></a> <span class="variable" translate="no">TokenName</span></dt>
                     <dd>配置了提供程序实例的名称后缀，如<a href="pkcs11-reference-guide1.html#GUID-C4ABFACB-B2C9-4E71-A313-79F881488BB9__GUID-8ADD17FD-3320-4D8F-A1ED-319DFEABA338" title="PKCS＃11提供程序配置文件属性。">表5-1所示</a> 。例如，以下命令列出名称后缀为PKCS＃11密钥库提供程序实例的内容<code class="codeph">SmartCard</code> 。<pre class="pre codeblock"><code>keytool -keystore NONE -storetype PKCS11 \
        -providerName SunPKCS11-SmartCard \
        -list
</code></pre><p>如果尚未在SunPKCS11提供程序中配置<code class="codeph">java.security</code>安全属性文件，可以使用以下选项来指示<code class="codeph">keytool</code>和<code class="codeph">jarsigner</code>动态安装提供程序。
                        </p>
                        <ul style="list-style-type:disc">
                           <li><code class="codeph">-providerClass sun.security.pkcs11.SunPKCS11</code></li>
                           <li><code class="codeph">-providerArg <span class="variable" translate="no">ConfigFilePath</span></code></li>
                        </ul>
                     </dd>
                     <dt class="dlterm"><a name="GUID-05DE5039-C62A-42B9-8F8E-DB6DB1B0CD44__GUID-BA567174-BE55-43B8-AE0B-F5564824E458"><!-- --></a> <span class="variable" translate="no">ConfigFilePath</span></dt>
                     <dd>
                        <div class="p">令牌配置文件的路径。这是在尚未在服务器中配置SunPKCS11提供程序时列出PKCS＃11密钥库的命令的示例。 <code class="codeph">java.security</code>文件。<pre class="pre codeblock"><code>keytool -keystore NONE -storetype PKCS11 \
        -providerClass sun.security.pkcs11.SunPKCS11 \
        -providerArg /foo/bar/token.config \
        -list
</code></pre></div>
                     </dd>
                  </dl>
               </div>
            </div>
            <div class="sect2"><a id="GUID-F8D31D74-8D4D-4981-BC63-05ABED100AB8" name="GUID-F8D31D74-8D4D-4981-BC63-05ABED100AB8"></a><h3 id="JSSEC-GUID-F8D31D74-8D4D-4981-BC63-05ABED100AB8" class="sect3">政策工具</h3>
               <div>
                  <div class="infoboxnote" id="GUID-F8D31D74-8D4D-4981-BC63-05ABED100AB8__GUID-73BDA382-76B1-4F3C-8A13-CEB4B86B48F7">
                     <p class="notep1">注意：</p>
                     <p>JDK 9中不推荐使用该策略工具。</p>
                  </div>
                  <p>的<code class="codeph">keystore</code>默认策略实现中的条目具有以下语法，可容纳一个PIN和多个PKCS＃11提供程序实例：</p><pre class="pre codeblock"><code>
keystore "<span class="italic">some_keystore_url</span>", "<span class="italic">keystore_type</span>", "<span class="italic">keystore_provider</span>";
keystorePasswordURL "<span class="italic">some_password_url</span>";
</code></pre><p>哪里</p>
                  <dl>
                     <dt class="dlterm"><a name="GUID-F8D31D74-8D4D-4981-BC63-05ABED100AB8__GUID-DCD1833C-101D-4568-A7DC-4E8F1F18ED67"><!-- --></a> <span class="variable" translate="no">keystore_provider</span></dt>
                     <dd>密钥库提供程序名称（例如， <code class="codeph">"SunPKCS11-SmartCard"</code> ）。
                     </dd>
                     <dt class="dlterm"><a name="GUID-F8D31D74-8D4D-4981-BC63-05ABED100AB8__GUID-8F5B3FF4-863B-4EA5-B16B-4454B035C54E"><!-- --></a> <span class="variable" translate="no">some_password_url</span> 
                     </dt>
                     <dd>指向令牌PIN位置的URL。 <span class="variable" translate="no">keystore_provider</span>和<span class="variable" translate="no">keystorePasswordURL</span>行都是可选的。如果未指定<span class="variable" translate="no">keystore_provider</span> ，则使用第一个配置的，支持指定密钥库类型的提供程序。如果<code class="codeph">keystorePasswordURL</code>未指定行，则不使用密码。
                     </dd>
                  </dl>
                  <div class="example" id="GUID-F8D31D74-8D4D-4981-BC63-05ABED100AB8__GUID-466262E0-C186-4808-828D-FB8CEFDE1076">
                     <p class="titleinexample">示例5-2 PKCS＃11令牌的密钥库策略条目</p>
                     <p>以下是PKCS＃11令牌的示例密钥库策略条目：</p><pre class="pre codeblock"><code>
keystore "NONE", "PKCS11", "SunPKCS11-SmartCard";
keystorePasswordURL "file:/foo/bar/passwordFile";
</code></pre></div>
                  <!-- class="example" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-2216C9EC-5F64-424C-BA35-E7DDEDC61C53" name="GUID-2216C9EC-5F64-424C-BA35-E7DDEDC61C53"></a><h3 id="JSSEC-GUID-2216C9EC-5F64-424C-BA35-E7DDEDC61C53" class="sect3">提供者开发商</h3>
               <div>
                  <p>的<code class="codeph">java.security.Provider</code>该类使提供程序开发人员可以通过提供程序服务和参数支持更轻松地支持PKCS＃11令牌和加密服务。
                  </p>
                  <p>有关<a href="pkcs11-reference-guide1.html#GUID-50C137F1-F23B-434D-AA90-5A744ABA2F5B" title="The following is an example of a simple provider that demonstrates features of the Provider class.">示例</a>简单提供<a href="pkcs11-reference-guide1.html#GUID-50C137F1-F23B-434D-AA90-5A744ABA2F5B" title="The following is an example of a simple provider that demonstrates features of the Provider class.">程序</a>的示例，请参见<a href="pkcs11-reference-guide1.html#GUID-50C137F1-F23B-434D-AA90-5A744ABA2F5B" title="下面是一个简单提供程序的示例，该示例演示了Provider类的功能。">示例提供程序</a> ，该示例旨在演示提供程序服务和参数支持。
                  </p>
               </div>
               <div class="sect3"><a id="GUID-BDF21F95-43FA-462F-A89C-5DF20760440E" name="GUID-BDF21F95-43FA-462F-A89C-5DF20760440E"></a><h4 id="JSSEC-GUID-BDF21F95-43FA-462F-A89C-5DF20760440E" class="sect4">提供者服务</h4>
                  <div>
                     <div class="section">
                        <p>对于提供者实施的每个服务，必须有一个名称为服务类型的属性（ <code class="codeph">Cipher</code> ， <code class="codeph">Signature</code> ，等等），其后是句点和该服务适用的算法的名称。该属性值必须指定实现服务的类的标准名称。这是提供者设置的示例<code class="codeph">KeyAgreement.DiffieHellman</code>具有价值的财产<code class="codeph">com.sun.crypto.provider.DHKeyAgreement</code> 。
                        </p><pre class="pre codeblock"><code>put("KeyAgreement.DiffieHellman", "com.sun.crypto.provider.DHKeyAgreement")
</code></pre><p>公共静态嵌套类<a href="https://docs.oracle.com/javase/10/docs/api/java/security/Provider.Service.html" target="_blank"><span class="apiname">Provider。服务</span></a>封装提供程序服务的属性（包括其类型，属性，算法名称和算法别名）。提供者可以实例化<code class="codeph">Provider.Service</code>对象并通过调用<code class="codeph">Provider.putService()</code>方法。这等效于创建一个<code class="codeph">Property</code>进入并呼叫<code class="codeph">Provider.put()</code>方法。请注意，旧版<code class="codeph">Property</code>通过注册的条目<code class="codeph">Provider.put</code>仍受支持。
                        </p>
                        <p>这是提供商创建一个示例的示例<code class="codeph">Service</code>与对象<code class="codeph">KeyAgreement</code>类型，用于<code class="codeph">DiffieHellman</code>算法，由类实现<code class="codeph">com.sun.crypto.provider.DHKeyAgreement</code> 。
                        </p><pre class="pre codeblock"><code>
Service s = new Service(this, "KeyAgreement", "DiffieHellman",
    "com.sun.crypto.provider.DHKeyAgreement", null, null);
putService(s);
</code></pre><p>使用<code class="codeph">Provider.Service</code>对象而不是传统<code class="codeph">Property</code>参赛作品有两个主要好处。好处之一是，它允许提供程序在<a href="pkcs11-reference-guide1.html#GUID-BDF21F95-43FA-462F-A89C-5DF20760440E__INSTANTIATINGENGINECLASSES-F41C69E1">实例化引擎类</a>时具有更大的灵活性。另一个好处是，它允许提供程序测试<a href="pkcs11-reference-guide1.html#GUID-BDF21F95-43FA-462F-A89C-5DF20760440E__PARAMETERSUPPORT-57310DC1">参数支持</a> 。接下来将详细讨论这些功能。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-BDF21F95-43FA-462F-A89C-5DF20760440E__INSTANTIATINGENGINECLASSES-F41C69E1">
                        <p class="subhead3" id="GUID-BDF21F95-43FA-462F-A89C-5DF20760440E__GUID-71AEAF50-B785-4B40-BEEE-0D3533CD698D">实例化引擎类</p>
                        <p>默认情况下，Java密码学框架会查找特定服务的provider属性，并直接实例化为该属性注册的引擎类。提供者可以覆盖此行为，并为请求的服务本身实例化引擎类。</p>
                        <p>要覆盖默认行为，提供程序将覆盖<code class="codeph">Provider.Service.newInstance()</code>添加其自定义行为的方法。例如，提供者可以调用自定义构造函数，或者可以使用在提供者外部无法访问的信息（或仅由提供者知道的信息）执行初始化。
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section" id="GUID-BDF21F95-43FA-462F-A89C-5DF20760440E__PARAMETERSUPPORT-57310DC1">
                        <p class="subhead3" id="GUID-BDF21F95-43FA-462F-A89C-5DF20760440E__GUID-BE3D99EE-A185-4B2E-9856-DE2D6BB1D668">参数支持</p>
                        <p>Java密码术框架可以尝试快速检查以确定提供者的服务实现是否可以使用应用程序指定的参数。为了执行此快速检查，框架调用<code class="codeph">Provider.Service.supportsParameter()</code> 。
                        </p>
                        <p>框架在延迟提供者选择期间依赖于此快速测试（请参阅<a href="pkcs11-reference-guide1.html#GUID-99785B51-50D8-458E-AA2C-755749F1E39E">延迟提供者选择</a> ）。当应用程序调用初始化方法并将其传递给<code class="codeph">Key</code>对象，该框架通过调用基础提供程序来询问其是否支持该对象<code class="codeph">Service.supportsParameter()</code>方法。如果<code class="codeph">supportsParameter()</code>退货<code class="codeph">false</code> ，该框架可以立即将该提供商排除在考虑范围之外。如果<code class="codeph">supportsParameter()</code>退货<code class="codeph">true</code> ，框架通过<code class="codeph">Key</code>该提供程序的初始化引擎类实现的对象。需要软件的提供商<code class="codeph">Key</code>对象应重写此方法以返回<code class="codeph">false</code>传递非软件密钥时。同样，包含不可提取密钥的PKCS＃11令牌的提供者应仅返回<code class="codeph">true</code>对于<code class="codeph">Key</code>它创建的对象，因此对应于其各自令牌上的键。
                        </p>
                        <div class="infoboxnote" id="GUID-BDF21F95-43FA-462F-A89C-5DF20760440E__THEDEFAULTIMPLEMENTATIONOFSUPPORTSP-1E7A1649">
                           <p class="notep1">注意：</p>默认实现<code class="codeph">supportsParameter()</code>退货<code class="codeph">true</code> 。这使现有提供程序无需修改即可工作。但是，由于这种宽松的默认实现，因此必须准备好框架以捕获拒绝提供程序的提供程序抛出的异常。 <code class="codeph">Key</code>对象在其初始化引擎类实现中。框架将这些情况与<code class="codeph">supportsParameter()</code>退货<code class="codeph">false</code> 。
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-AD009675-E028-4A86-BE87-8DBD03B538DC" name="GUID-AD009675-E028-4A86-BE87-8DBD03B538DC"></a><h4 id="JSSEC-GUID-AD009675-E028-4A86-BE87-8DBD03B538DC" class="sect4">参数支持</h4>
                  <div>
                     <p>Java密码术框架可以尝试快速检查以确定提供者的服务实现是否可以使用应用程序指定的参数。为了执行此快速检查，框架调用<code class="codeph">Provider.Service.supportsParameter()</code> 。
                     </p>
                     <p>框架在延迟提供者选择期间依赖于此快速测试（请参阅<a href="pkcs11-reference-guide1.html#GUID-99785B51-50D8-458E-AA2C-755749F1E39E">延迟提供者选择</a> ）。当应用程序调用初始化方法并将其传递给<code class="codeph">Key</code>对象，该框架通过调用基础提供程序来询问其是否支持该对象<code class="codeph">Service.supportsParameter()</code>方法。如果<code class="codeph">supportsParameter()</code>退货<code class="codeph">false</code> ，该框架可以立即将该提供商排除在考虑范围之外。如果<code class="codeph">supportsParameter()</code>退货<code class="codeph">true</code> ，框架通过<code class="codeph">Key</code>该提供程序的初始化引擎类实现的对象。需要软件的提供商<code class="codeph">Key</code>对象应重写此方法以返回<code class="codeph">false</code>传递非软件密钥时。同样，包含不可提取密钥的PKCS＃11令牌的提供者应仅返回<code class="codeph">true</code>对于<code class="codeph">Key</code>它创建的对象，因此对应于其各自令牌上的键。
                     </p>
                     <div class="infoboxnote" id="GUID-AD009675-E028-4A86-BE87-8DBD03B538DC__GUID-019F1138-29BE-43FA-91DC-42CAED7D7ACF">
                        <p class="notep1">注意：</p>默认实现<code class="codeph">supportsParameter()</code>退货<code class="codeph">true</code> 。这使现有提供程序无需修改即可工作。但是，由于这种宽松的默认实现，因此必须准备好框架以捕获拒绝提供程序的提供程序抛出的异常。 <code class="codeph">Key</code>对象在其初始化引擎类实现中。框架将这些情况与<code class="codeph">supportsParameter()</code>退货<code class="codeph">false</code> 。
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-D3EF9023-7DDC-435D-9186-D2FD05674777" name="GUID-D3EF9023-7DDC-435D-9186-D2FD05674777"></a><h3 id="JSSEC-GUID-D3EF9023-7DDC-435D-9186-D2FD05674777" class="sect3">SunPKCS11提供程序支持的算法</h3>
               <div>
                  <div class="section"><a href="pkcs11-reference-guide1.html#GUID-D3EF9023-7DDC-435D-9186-D2FD05674777__GUID-21B92E76-EE33-47EA-BC0C-F428AF662C02" title="Sun PKCS＃11 Provider支持的Java算法列表。">表5-3</a>列出了SunPKCS11提供程序支持的Java算法以及支持它们的相应PKCS＃11机制。当列出了多种机制时，将按照优先顺序给出它们，并且任何一种都足够。
                     <div class="infoboxnote" id="GUID-D3EF9023-7DDC-435D-9186-D2FD05674777__GUID-E2C635BE-FFB1-4E12-90F3-5679264E9219">
                        <p class="notep1">注意：</p>可以指示SunPKCS11使用以下命令忽略机制： <code class="codeph">disabledMechanisms</code>和<code class="codeph">enabledMechanisms</code>配置指令（请参见<a href="pkcs11-reference-guide1.html#GUID-C4ABFACB-B2C9-4E71-A313-79F881488BB9">SunPKCS11配置</a> ）。
                     </div>
                     <p>对于椭圆曲线机制，SunPKCS11提供程序将仅使用使用<code class="codeph">namedCurve</code>选择作为参数的编码，并且仅允许使用未压缩的点格式。SunPKCS11提供程序假定令牌支持所有标准命名域参数。
                     </p>
                     <div class="tblformal" id="GUID-D3EF9023-7DDC-435D-9186-D2FD05674777__GUID-21B92E76-EE33-47EA-BC0C-F428AF662C02">
                        <p class="titleintable">表5-3 SunPKCS11提供程序支持的Java算法</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="SunPKCS11提供程序支持的Java算法" border="1" summary="List of Java Algorithms supported by the Sun PKCS#11 Provider." frame="hsides" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d80237e1642">Java算法</th>
                                 <th align="left" valign="bottom" id="d80237e1644">PKCS＃11机制</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1648" headers="d80237e1642 ">签名。MD2withRSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1648 d80237e1644 ">CKM_MD2_RSA_PKCS，CKM_RSA_PKCS，CKM_RSA_X_509</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1653" headers="d80237e1642 ">签名。MD5withRSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1653 d80237e1644 ">CKM_MD5_RSA_PKCS，CKM_RSA_PKCS，CKM_RSA_X_509</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1658" headers="d80237e1642 ">签名。SHA1withRSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1658 d80237e1644 ">CKM_SHA1_RSA_PKCS，CKM_RSA_PKCS，CKM_RSA_X_509</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1663" headers="d80237e1642 ">签名。SHA224withRSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1663 d80237e1644 ">CKM_SHA224_RSA_PKCS，CKM_RSA_PKCS，CKM_RSA_X_509</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1668" headers="d80237e1642 ">签名。SHA256withRSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1668 d80237e1644 ">CKM_SHA256_RSA_PKCS，CKM_RSA_PKCS，CKM_RSA_X_509</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1673" headers="d80237e1642 ">签名。SHA384withRSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1673 d80237e1644 ">CKM_SHA384_RSA_PKCS，CKM_RSA_PKCS，CKM_RSA_X_509</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1678" headers="d80237e1642 ">签名。SHA512withRSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1678 d80237e1644 ">CKM_SHA512_RSA_PKCS，CKM_RSA_PKCS，CKM_RSA_X_509</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1683" headers="d80237e1642 ">签名。SHA1withDSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1683 d80237e1644 ">CKM_DSA_SHA1，CKM_DSA</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1688" headers="d80237e1642 ">签名。没有DSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1688 d80237e1644 ">CKM_DSA</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1693" headers="d80237e1642 ">签名。SHA1withECDSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1693 d80237e1644 ">CKM_ECDSA_SHA1，CKM_ECDSA</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1698" headers="d80237e1642 ">签名。SHA224withECDSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1698 d80237e1644 ">CKM_ECDSA</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1704" headers="d80237e1642 ">签名。SHA256withECDSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1704 d80237e1644 ">CKM_ECDSA</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1709" headers="d80237e1642 ">签名。SHA384withECDSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1709 d80237e1644 ">CKM_ECDSA</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1714" headers="d80237e1642 ">签名。SHA512withECDSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1714 d80237e1644 ">CKM_ECDSA</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1719" headers="d80237e1642 ">签名。ECDSA没有</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1719 d80237e1644 ">CKM_ECDSA</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1724" headers="d80237e1642 ">密码。RSA / ECB /无填充</td>
                                 <td align="left" valign="top" headers="d80237e1724 d80237e1644 ">CKM_RSA_X_509</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1729" headers="d80237e1642 ">密码。RSA / ECB / PKCS1填充</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1729 d80237e1644 ">CKM_RSA_PKCS</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1734" headers="d80237e1642 ">密码。ARCFOUR</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1734 d80237e1644 ">CKM_RC4</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1739" headers="d80237e1642 ">密码。DES / CBC /无填充</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1739 d80237e1644 ">CKM_DES_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1744" headers="d80237e1642 ">密码。DES / CBC / PKCS5填充</td>
                                 <td align="left" valign="top" headers="d80237e1744 d80237e1644 ">CKM_DES_CBC_PAD，CKM_DES_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1749" headers="d80237e1642 ">密码。DES / ECB /无填充</td>
                                 <td align="left" valign="top" headers="d80237e1749 d80237e1644 ">CKM_DES_ECB</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1754" headers="d80237e1642 ">密码。DES / ECB / PKCS5填充</td>
                                 <td align="left" valign="top" headers="d80237e1754 d80237e1644 ">CKM_DES_ECB</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1760" headers="d80237e1642 ">密码。DESede / CBC / NoPadding</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1760 d80237e1644 ">CKM_DES3_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1765" headers="d80237e1642 ">密码。DESede / CBC / PKCS5填充</td>
                                 <td align="left" valign="top" headers="d80237e1765 d80237e1644 ">CKM_DES3_CBC_PAD，CKM_DES3_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1770" headers="d80237e1642 ">密码。DESede / ECB / NoPadding</td>
                                 <td align="left" valign="top" headers="d80237e1770 d80237e1644 ">CKM_DES3_ECB</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1775" headers="d80237e1642 ">密码。DESede / ECB / PKCS5填充</td>
                                 <td align="left" valign="top" headers="d80237e1775 d80237e1644 ">CKM_DES3_ECB</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1780" headers="d80237e1642 ">密码。AES / CBC /无填充</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1780 d80237e1644 ">CKM_AES_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1785" headers="d80237e1642 ">密码。AES / CBC / PKCS5填充</td>
                                 <td align="left" valign="top" headers="d80237e1785 d80237e1644 ">CKM_AES_CBC_PAD，CKM_AES_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1790" headers="d80237e1642 ">密码。河豚/ CBC /无填充</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1790 d80237e1644 ">CKM_BLOWFISH_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1795" headers="d80237e1642 ">密码。河豚/ CBC / PKCS5</td>
                                 <td align="left" valign="top" headers="d80237e1795 d80237e1644 ">CKM_BLOWFISH_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1800" headers="d80237e1642 ">密码。AES / CTR /无填充</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1800 d80237e1644 ">CKM_AES_CTR</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1805" headers="d80237e1642 ">密码。AES / ECB /无填充</td>
                                 <td align="left" valign="top" headers="d80237e1805 d80237e1644 ">CKM_AES_ECB</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1810" headers="d80237e1642 ">密码。AES / ECB / PKCS5填充</td>
                                 <td align="left" valign="top" headers="d80237e1810 d80237e1644 ">CKM_AES_ECB</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1816" headers="d80237e1642 ">密码。AES_128 / CBC /无填充</td>
                                 <td align="left" valign="top" headers="d80237e1816 d80237e1644 ">CKM_AES_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1821" headers="d80237e1642 ">密码。AES_128 / ECB /无填充</td>
                                 <td align="left" valign="top" headers="d80237e1821 d80237e1644 ">CKM_AES_ECB</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1826" headers="d80237e1642 ">密码。AES_192 / CBC /无填充</td>
                                 <td align="left" valign="top" headers="d80237e1826 d80237e1644 ">CKM_AES_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1831" headers="d80237e1642 ">密码。AES_192 / ECB /无填充</td>
                                 <td align="left" valign="top" headers="d80237e1831 d80237e1644 ">CKM_AES_ECB</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1836" headers="d80237e1642 ">密码。AES_256 / CBC /无填充</td>
                                 <td align="left" valign="top" headers="d80237e1836 d80237e1644 ">CKM_AES_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d80237e1841" headers="d80237e1642 ">密码。AES_256 / ECB /无填充</td>
                                 <td align="left" valign="top" headers="d80237e1841 d80237e1644 ">CKM_AES_ECB</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1846" headers="d80237e1642 ">关键协议。ECDH</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1846 d80237e1644 ">CKM_ECDH1_DERIVE</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1851" headers="d80237e1642 ">关键协议。迪菲·赫尔曼</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1851 d80237e1644 ">CKM_DH_PKCS_DERIVE</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1856" headers="d80237e1642 ">KeyPairGenerator。RSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1856 d80237e1644 ">CKM_RSA_PKCS_KEY_PAIR_GEN</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1861" headers="d80237e1642 ">KeyPairGenerator。DSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1861 d80237e1644 ">CKM_DSA_KEY_PAIR_GEN</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1866" headers="d80237e1642 ">KeyPairGenerator。欧共体</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1866 d80237e1644 ">CKM_EC_KEY_PAIR_GEN</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1872" headers="d80237e1642 ">KeyPairGenerator。迪菲·赫尔曼</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1872 d80237e1644 ">CKM_DH_PKCS_KEY_PAIR_GEN</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1877" headers="d80237e1642 ">KeyGenerator。ARCFOUR</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1877 d80237e1644 ">CKM_RC4_KEY_GEN</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1882" headers="d80237e1642 ">KeyGenerator。DES</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1882 d80237e1644 ">CKM_DES_KEY_GEN</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1887" headers="d80237e1642 ">KeyGenerator。DESede</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1887 d80237e1644 ">CKM_DES3_KEY_GEN</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1892" headers="d80237e1642 ">KeyGenerator。AES</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1892 d80237e1644 ">CKM_AES_KEY_GEN</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1897" headers="d80237e1642 ">KeyGenerator。河豚</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1897 d80237e1644 ">CKM_BLOWFISH_KEY_GEN</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1902" headers="d80237e1642 ">Mac HmacMD5</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1902 d80237e1644 ">CKM_MD5_HMAC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1907" headers="d80237e1642 ">Mac.HmacSHA1</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1907 d80237e1644 ">CKM_SHA_1_HMAC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1912" headers="d80237e1642 ">Mac.HmacSHA224</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1912 d80237e1644 ">CKM_SHA224_HMAC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1917" headers="d80237e1642 ">Mac.HmacSHA256</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1917 d80237e1644 ">CKM_SHA256_HMAC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1922" headers="d80237e1642 ">Mac的HmacSHA384</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1922 d80237e1644 ">CKM_SHA384_HMAC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1928" headers="d80237e1642 ">Mac.HmacSHA512</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1928 d80237e1644 ">CKM_SHA512_HMAC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1933" headers="d80237e1642 ">MessageDigest.MD2</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1933 d80237e1644 ">CKM_MD2</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1938" headers="d80237e1642 ">MessageDigest.MD5</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1938 d80237e1644 ">CKM_MD5</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1943" headers="d80237e1642 ">MessageDigest.SHA1</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1943 d80237e1644 ">CKM_SHA_1</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1948" headers="d80237e1642 ">MessageDigest.SHA-224</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1948 d80237e1644 ">CKM_SHA224</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1953" headers="d80237e1642 ">MessageDigest.SHA-256</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1953 d80237e1644 ">CKM_SHA256</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1958" headers="d80237e1642 ">邮件摘要.SHA-384</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1958 d80237e1644 ">CKM_SHA384</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1963" headers="d80237e1642 ">邮件摘要.SHA-512</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1963 d80237e1644 ">CKM_SHA512</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1968" headers="d80237e1642 ">KeyFactory。RSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1968 d80237e1644 ">任何受支持的RSA机制</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1973" headers="d80237e1642 ">KeyFactory。DSA</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1973 d80237e1644 ">任何受支持的DSA机制</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1978" headers="d80237e1642 ">KeyFactory。欧共体</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1978 d80237e1644 ">任何受支持的EC机制</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1984" headers="d80237e1642 ">KeyFactory。迪菲·赫尔曼</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1984 d80237e1644 ">任何受支持的Diffie-Hellman机制</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1989" headers="d80237e1642 ">SecretKeyFactory。ARCFOUR</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1989 d80237e1644 ">CKM_RC4</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1994" headers="d80237e1642 ">SecretKeyFactory。DES</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1994 d80237e1644 ">CKM_DES_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e1999" headers="d80237e1642 ">SecretKeyFactory。DESede</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e1999 d80237e1644 ">CKM_DES3_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e2004" headers="d80237e1642 ">SecretKeyFactory。AES</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e2004 d80237e1644 ">CKM_AES_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e2009" headers="d80237e1642 ">SecretKeyFactory。河豚</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e2009 d80237e1644 ">CKM_BLOWFISH_CBC</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e2014" headers="d80237e1642 ">SecureRandom。PKCS11</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e2014 d80237e1644 ">CK_TOKEN_INFO的CKF_RNG位置1</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td rowspan="1" colspan="1" align="left" valign="top" id="d80237e2019" headers="d80237e1642 ">密钥库。PKCS11</td>
                                 <td rowspan="1" colspan="1" align="left" valign="top" headers="d80237e2019 d80237e1644 ">始终可用</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-F068390B-EB41-48A0-A713-B4CBCC72285D" name="GUID-F068390B-EB41-48A0-A713-B4CBCC72285D"></a><h3 id="JSSEC-GUID-F068390B-EB41-48A0-A713-B4CBCC72285D" class="sect3">SunPKCS11提供程序密钥库要求</h3>
               <div>
                  <p>以下内容描述了SunPKCS11提供程序的KeyStore实现对基础本机PKCS＃11库提出的要求。</p>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-F068390B-EB41-48A0-A713-B4CBCC72285D__GUID-D235AC91-F2D1-4F7A-83D5-5604508A9578">
                        <p class="notep1">注意：</p>将来的发行版中可能会进行更改，以最大程度地与尽可能多的现有PKCS＃11库实现互操作性。
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F068390B-EB41-48A0-A713-B4CBCC72285D__GUID-6B58C7A9-D9E9-441C-BE80-F2CF81EF0105">只读访问</p>
                     <p>要将存储在PKCS＃11令牌上的现有对象映射到KeyStore条目，SunPKCS11提供程序的KeyStore实现将执行以下操作。</p>
                     <ol>
                        <li>通过调用以下命令来搜索令牌上的所有私钥对象： <code class="codeph">C_FindObjects[Init|Final]</code> 。搜索模板包括以下属性：<ul style="list-style-type:disc">
                              <li>CKA_TOKEN =真</li>
                              <li>CKA_CLASS = CKO_PRIVATE_KEY</li>
                           </ul> 
                        </li>
                        <li>通过调用以下命令搜索令牌上的所有证书对象： <code class="codeph">C_FindObjects[Init|Final]</code> 。搜索模板包括以下属性：<ul style="list-style-type:disc">
                              <li>CKA_TOKEN =真</li>
                              <li>CKA_CLASS = CKO_CERTIFICATE</li>
                           </ul> 
                        </li>
                        <li>通过检索各自的CKA_ID属性，可以将每个私钥对象与其对应的证书进行匹配。匹配对必须共享相同的唯一CKA_ID。<p>对于每个匹配对，证书链都是通过遵循issuer-> subject路径构建的。在最终实体证书中，要求<code class="codeph">C_FindObjects[Init|Final]</code>由包含以下属性的搜索模板组成：</p> 
                           <ul style="list-style-type:disc">
                              <li>CKA_TOKEN =真</li>
                              <li>CKA_CLASS = CKO_CERTIFICATE</li>
                              <li>CKA_SUBJECT = [证书颁发者的DN]</li>
                           </ul> 
                           <p>继续此搜索，直到没有找到颁发者的证书，或者直到找到了自签名证书为止。如果找到多个证书，则使用第一个证书。</p> 
                           <p>匹配私钥和证书（并建立其证书链）后，该信息将存储在私钥条目中，并将最终实体证书中的CKA_LABEL值作为KeyStore别名。</p> 
                           <p>如果最终实体证书没有CKA_LABEL，则别名是从CKA_ID派生的。如果可以确定CKA_ID仅由可打印字符组成，则可以通过使用UTF-8字符集对CKA_ID字节进行解码来创建字符串别名。否则，将从CKA_ID字节（例如，“ 0xFFFF ...”）创建十六进制字符串别名。</p> 
                           <p>如果多个证书共享同一个CKA_LABEL，则别名是从CKA_LABEL加上最终实体证书颁发者和序列号（ <code>"MyCert/CN=foobar/1234"</code> ， 例如）。
                           </p> 
                        </li>
                        <li>检查不是私有密钥条目一部分的每个证书（作为最终实体证书）是否受信任。如果CKA_TRUSTED属性为true，则创建一个密钥库受信任证书条目，并将CKA_LABEL值作为密钥库别名。如果证书没有CKA_LABEL，或者如果多个证书共享同一CKA_LABEL，则别名将按上述方式派生。
                           <p>如果不支持CKA_TRUSTED属性，则不会创建可信证书条目。</p> 
                        </li>
                        <li>不属于私钥条目或受信任证书条目的任何私钥或证书对象都将被忽略。</li>
                        <li>通过调用以下命令搜索令牌上的所有秘密密钥对象： <code class="codeph">C_FindObjects[Init|Final]</code> 。搜索模板包括以下属性：<ul style="list-style-type:disc">
                              <li>CKA_TOKEN =真</li>
                              <li>CKA_CLASS = CKO_SECRET_KEY</li>
                           </ul> 
                           <p>将为每个密钥对象创建一个密钥库密钥条目，并使用CKA_LABEL值作为密钥库别名。每个密钥对象必须具有唯一的CKA_LABEL。</p> 
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F068390B-EB41-48A0-A713-B4CBCC72285D__GUID-9CD4F05D-932B-418F-B45C-B6BEC4572257">写访问</p>
                     <p>要在PKCS＃11令牌上的KeyStore条目上创建新的KeyStore条目，SunPKCS11提供程序的KeyStore实现将执行以下操作。</p>
                     <ol>
                        <li>在创建KeyStore条目时（例如，在KeyStore.setEntry期间），使用以下命令调用C_CreateObject <code class="codeph">CKA_TOKEN=true</code>为各个条目内容创建令牌对象。
                           <p>私钥对象存储在<code class="codeph">CKA_PRIVATE=true</code> 。将密钥存储别名（UTF8编码）设置为私钥和相应的最终实体证书的CKA_ID。最终实体证书对象的KeyStore别名也设置为CKA_LABEL。
                           </p> 
                           <p>还存储私钥条目链中的每个证书。未为CA证书设置CKA_LABEL。如果令牌中已包含CA证书，则不会存储重复证书。</p> 
                           <p>密钥对象与<code class="codeph">CKA_PRIVATE=true</code> 。KeyStore别名设置为CKA_LABEL。</p> 
                        </li>
                        <li>如果尝试将会话对象转换为令牌对象（例如，如果调用KeyStore.setEntry且指定条目中的私钥对象是会话对象），则使用以下命令调用C_CopyObject <code class="codeph">CKA_TOKEN=true</code> 。
                        </li>
                        <li>如果在令牌中发现多个证书共享同一CKA_LABEL，则将禁用对令牌的写入功能。</li>
                        <li>由于PKCS＃11规范不允许设置常规应用程序<code class="codeph">CKA_TRUSTED=true</code> （只有令牌初始化应用程序可以这样做），无法创建可信证书条目。
                        </li>
                     </ol>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2" id="GUID-F068390B-EB41-48A0-A713-B4CBCC72285D__GUID-46490C60-75B3-4F0D-8F8C-67F6AEE668C2">杂</p>
                     <p>除了上面列出的搜索之外，SunPKCS11提供程序的KeyStore实现还可以使用以下搜索来执行内部功能。特别， <code class="codeph">C_FindObjects[Init|Final]</code>可以使用以下任何属性模板调用：</p>
                     <ul style="list-style-type:disc">
                        <li> <pre class="pre codeblock"><code>    CKA_TOKEN    true
    CKA_CLASS    CKO_CERTIFICATE
    CKA_SUBJECT  [subject DN]
</code></pre></li>
                        <li> <pre class="pre codeblock"><code>    CKA_TOKEN    true
    CKA_CLASS    CKO_SECRET_KEY
    CKA_LABEL    [label]</code></pre></li>
                        <li> <pre class="pre codeblock"><code>    CKA_TOKEN    true
    CKA_CLASS    CKO_CERTIFICATE or CKO_PRIVATE_KEY
    CKA_ID       [cka_id]</code></pre></li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
            </div>
            <div class="sect2"><a id="GUID-50C137F1-F23B-434D-AA90-5A744ABA2F5B" name="GUID-50C137F1-F23B-434D-AA90-5A744ABA2F5B"></a><h3 id="JSSEC-GUID-50C137F1-F23B-434D-AA90-5A744ABA2F5B" class="sect3">提供者示例</h3>
               <div>
                  <p>下面是一个简单提供程序的示例，该示例演示了<span class="apiname">Provider</span>类的功能。
                  </p>
                  <div class="section"><pre class="pre codeblock"><code>
package com.foo;

import java.io.*;
import java.lang.reflect.*;
import java.security.*;
import javax.crypto.*;

/**
 * Example provider that demonstrates some Provider class features.
 *
 *  . implement multiple different algorithms in a single class.
 *    Previously each algorithm needed to be implemented in a separate class
 *    (e.g. one for SHA-256, one for SHA-384, etc.)
 *
 *  . multiple concurrent instances of the provider frontend class each
 *    associated with a different backend.
 *
 *  . it uses "unextractable" keys and lets the framework know which key
 *    objects it can and cannot support
 *
 * Note that this is only a simple example provider designed to demonstrate
 * several of the new features.  It is not explicitly designed for efficiency.
 */
public final class ExampleProvider extends Provider {

    // reference to the crypto backend that implements all the algorithms
    final CryptoBackend cryptoBackend;

    public ExampleProvider(String name, CryptoBackend cryptoBackend) {
        super(name, 1.0, "JCA/JCE provider for " + name);
        this.cryptoBackend = cryptoBackend;
        // register the algorithms we support (SHA-256, SHA-384, DESede, and AES)
        putService(new MyService
            (this, "MessageDigest", "SHA-256", "com.foo.ExampleProvider$MyMessageDigest"));
        putService(new MyService
            (this, "MessageDigest", "SHA-384", "com.foo.ExampleProvider$MyMessageDigest"));
        putService(new MyCipherService
            (this, "Cipher", "DES", "com.foo.ExampleProvider$MyCipher"));
        putService(new MyCipherService
            (this, "Cipher", "AES", "com.foo.ExampleProvider$MyCipher"));
    }

    // the API of our fictitious crypto backend
    static abstract class CryptoBackend {
        abstract byte[] digest(String algorithm, byte[] data);
        abstract byte[] encrypt(String algorithm, KeyHandle key, byte[] data);
        abstract byte[] decrypt(String algorithm, KeyHandle key, byte[] data);
        abstract KeyHandle createKey(String algorithm, byte[] keyData);
    }

    // the shell of the representation the crypto backend uses for keys
    private static final class KeyHandle {
        // fill in code
    }

    // we have our own ServiceDescription implementation that overrides newInstance()
    // that calls the (Provider, String) constructor instead of the no-args constructor
    private static class MyService extends Service {

        private static final Class[] paramTypes = {Provider.class, String.class};

        MyService(Provider provider, String type, String algorithm,
                String className) {
            super(provider, type, algorithm, className, null, null);
        }

        public Object newInstance(Object param) throws NoSuchAlgorithmException {
            try {
                // get the Class object for the implementation class
                Class clazz;
                Provider provider = getProvider();
                ClassLoader loader = provider.getClass().getClassLoader();
                if (loader == null) {
                    clazz = Class.forName(getClassName());
                } else {
                    clazz = loader.loadClass(getClassName());
                }
                // fetch the (Provider, String) constructor
                Constructor cons = clazz.getConstructor(paramTypes);
                // invoke constructor and return the SPI object
                Object obj = cons.newInstance(new Object[] {provider, getAlgorithm()});
                return obj;
            } catch (Exception e) {
                throw new NoSuchAlgorithmException("Could not instantiate service", e);
            }
        }
    }

    // custom ServiceDescription class for Cipher objects. See supportsParameter() below
    private static class MyCipherService extends MyService {
        MyCipherService(Provider provider, String type, String algorithm,
                String className) {
            super(provider, type, algorithm, className);
        }
        // we override supportsParameter() to let the framework know which
        // keys we can support. We support instances of MySecretKey, if they
        // are stored in our provider backend, plus SecretKeys with a RAW encoding.
        public boolean supportsParameter(Object obj) {
            if (obj instanceof SecretKey == false) {
                return false;
            }
            SecretKey key = (SecretKey)obj;
            if (key.getAlgorithm().equals(getAlgorithm()) == false) {
                return false;
            }
            if (key instanceof MySecretKey) {
                MySecretKey myKey = (MySecretKey)key;
                return myKey.provider == getProvider();
            } else {
                return "RAW".equals(key.getFormat());
            }
        }
    }

    // our generic MessageDigest implementation. It implements all digest
    // algorithms in a single class. We only implement the bare minimum
    // of MessageDigestSpi methods
    private static final class MyMessageDigest extends MessageDigestSpi {
        private final ExampleProvider provider;
        private final String algorithm;
        private ByteArrayOutputStream buffer;
        MyMessageDigest(Provider provider, String algorithm) {
            super();
            this.provider = (ExampleProvider)provider;
            this.algorithm = algorithm;
            engineReset();
        }
        protected void engineReset() {
            buffer = new ByteArrayOutputStream();
        }
        protected void engineUpdate(byte b) {
            buffer.write(b);
        }
        protected void engineUpdate(byte[] b, int ofs, int len) {
            buffer.write(b, ofs, len);
        }
        protected byte[] engineDigest() {
            byte[] data = buffer.toByteArray();
            byte[] digest = provider.cryptoBackend.digest(algorithm, data);
            engineReset();
            return digest;
        }
    }

    // our generic Cipher implementation, only partially complete. It implements
    // all cipher algorithms in a single class. We implement only as many of the
    // CipherSpi methods as required to show how it could work
    private static abstract class MyCipher extends CipherSpi {
        private final ExampleProvider provider;
        private final String algorithm;
        private int opmode;
        private MySecretKey myKey;
        private ByteArrayOutputStream buffer;
        MyCipher(Provider provider, String algorithm) {
            super();
            this.provider = (ExampleProvider)provider;
            this.algorithm = algorithm;
        }
        protected void engineInit(int opmode, Key key, SecureRandom random)
                throws InvalidKeyException {
            this.opmode = opmode;
            myKey = MySecretKey.getKey(provider, algorithm, key);
            if (myKey == null) {
                throw new InvalidKeyException();
            }
            buffer = new ByteArrayOutputStream();
        }
        protected byte[] engineUpdate(byte[] b, int ofs, int len) {
            buffer.write(b, ofs, len);
            return new byte[0];
        }
        protected int engineUpdate(byte[] b, int ofs, int len, byte[] out, int outOfs) {
            buffer.write(b, ofs, len);
            return 0;
        }
        protected byte[] engineDoFinal(byte[] b, int ofs, int len) {
            buffer.write(b, ofs, len);
            byte[] in = buffer.toByteArray();
            byte[] out;
            if (opmode == Cipher.ENCRYPT_MODE) {
                out = provider.cryptoBackend.encrypt(algorithm, myKey.handle, in);
            } else {
                out = provider.cryptoBackend.decrypt(algorithm, myKey.handle, in);
            }
            buffer = new ByteArrayOutputStream();
            return out;
        }
        // code for remaining CipherSpi methods goes here
    }

    // our SecretKey implementation. All our keys are stored in our crypto
    // backend, we only have an opaque handle available. There is no
    // encoded form of these keys.
    private static final class MySecretKey implements SecretKey {

        final String algorithm;
        final Provider provider;
        final KeyHandle handle;

        MySecretKey(Provider provider, String algorithm, KeyHandle handle) {
            super();
            this.provider = provider;
            this.algorithm = algorithm;
            this.handle = handle;
        }
        public String getAlgorithm() {
            return algorithm;
        }
        public String getFormat() {
            return null; // this key has no encoded form
        }
        public byte[] getEncoded() {
            return null; // this key has no encoded form
        }
        // Convert the given key to a key of the specified provider, if possible
        static MySecretKey getKey(ExampleProvider provider, String algorithm, Key key) {
            if (key instanceof SecretKey == false) {
                return null;
            }
            // algorithm name must match
            if (!key.getAlgorithm().equals(algorithm)) {
                return null;
            }
            // if key is already an instance of MySecretKey and is stored
            // on this provider, return it right away
            if (key instanceof MySecretKey) {
                MySecretKey myKey = (MySecretKey)key;
                if (myKey.provider == provider) {
                    return myKey;
                }
            }
            // otherwise, if the input key has a RAW encoding, convert it
            if (!"RAW".equals(key.getFormat())) {
                return null;
            }
            byte[] encoded = key.getEncoded();
            KeyHandle handle = provider.cryptoBackend.createKey(algorithm, encoded);
            return new MySecretKey(provider, algorithm, handle);
        }
    }
}
</code></pre></div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   

</body></html>