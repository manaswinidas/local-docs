<html lang="en-us"  xml:lang="en-us"><head></head><body >﻿
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>使用JAAS登录实用程序和Java GSS-API进行安全消息交换</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Security Developer’s Guide">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Security Developer’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="security-developer-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-09-21T08:42:26-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="1993, 2018">
      <meta name="dcterms.category" content="java">
      <meta name="dcterms.identifier" content="E94828-01">
      
      <meta name="dcterms.product" content="en/java/javase/11">
      <meta name="dcterms.release" content="11">
      <link rel="prev" href="use-jaas-login-utility.html" title="Previous" type="text/html">
      <link rel="next" href="more-things-you-can-do-java-gss-api-and-jaas.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"java","element_name":"Java","display_in_url":true},"suite":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product_group":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product":{"short_name":"javase","element_name":"Java SE","display_in_url":true},"release":{"short_name":"11","element_name":"11","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Security Developer Guide">
    <meta name="dcterms.isVersionOf" content="SECURITY">
  <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script>
   
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="use-jaas-login-utility.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一个</a> <a href="more-things-you-can-do-java-gss-api-and-jaas.html" class="pull-right">下一个<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">安全开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="java-generic-security-services-java-gss-api1.html" property="item" typeof="WebPage"><span property="name">Java通用安全服务（Java GSS-API）</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="introduction-jaas-and-java-gss-api-tutorials1.html" property="item" typeof="WebPage"><span property="name">JAAS和Java GSS-API教程简介</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">使用JAAS登录实用程序和Java GSS-API进行安全消息交换</li>
            </ol>
            <a id="GUID-C1DFED9D-D3A1-4C11-95D8-3543935E87C8" name="GUID-C1DFED9D-D3A1-4C11-95D8-3543935E87C8"></a>
            
            <h2 id="JSSEC-GUID-C1DFED9D-D3A1-4C11-95D8-3543935E87C8" class="sect2">使用JAAS登录实用程序和Java GSS-API进行安全消息交换</h2>
         </header>
         <div class="ind">
            <div>
               <p>本教程提供了两个示例应用程序，以演示Java GSS-API的用法。该API允许在通信应用程序之间安全地交换消息。这是本教程所需的示例客户端和服务器应用程序：</p>
               <ul style="list-style-type:disc">
                  <li><a href="source-code-jaas-and-java-gss-api-tutorials.html#GUID-09D4192C-D855-49D6-BC62-E08F49ADB4F8__SAMPLECLIENT.JAVA-338923E1"><code class="codeph">SampleClient.java</code></a></li>
                  <li><a href="source-code-jaas-and-java-gss-api-tutorials.html#GUID-09D4192C-D855-49D6-BC62-E08F49ADB4F8__SAMPLESERVER.JAVA-33891DED"><code class="codeph">SampleServer.java</code></a></li>
               </ul>
               <div class="infoboxnote" id="GUID-C1DFED9D-D3A1-4C11-95D8-3543935E87C8__GUID-14947E17-44D9-4CE2-8A0F-922A12CFEC92">
                  <p class="notep1">注意：</p>
                  <p>本教程使用与<a href="use-java-gss-api-secure-message-exchanges-jaas-programming.html#GUID-42A2B80C-90CD-4C7A-8EED-8BFFE83CAF56">使用Java GSS-API进行无JAAS编程的安全消息交换</a>相同的客户端和服务器应用程序。在该教程中，不需要进行JAAS（Java身份验证和授权服务）编程。取而代之的是，让基础机制决定如何获取凭据。
                  </p>
               </div>
               <p>本教程使用策略文件和更复杂的登录配置文件。这些程序由安全管理器运行；结果，除非明确授予必需的权限，否则不允许进行对安全敏感的操作。本教程还演示了JAAS授权如何添加以<span class="italic">用户为中心的</span>访问控制，该访问控制基于代码的运行<span class="italic">者</span> （而不只是运行的代码）应用控制。
               </p>
               <ul style="list-style-type:disc">
                  <li><a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-A742F77E-9D77-42E1-BFB8-2DE9C6FB3051">开始之前：推荐阅读</a></li>
                  <li><a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-1C2B6E45-2E2F-421C-B0D3-F034156DDAE7">客户端和服务器应用程序概述</a></li>
                  <li><a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-832A32FD-3D99-4624-86A4-7AFBF8924C80">Kerberos用户和服务主体名称</a></li>
                  <li><a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-3B582CD5-135F-4516-843E-1831DB25CCC4">登录配置文件</a></li>
                  <li><a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-2BA7F0B7-D3E3-4B81-8E98-0A39F9763B59">政策文件</a></li>
                  <li><a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-07D0C8CC-0922-4B0F-B14D-9A644CB13783">运行SampleClient和SampleServer程序</a></li>
               </ul>
            </div>
            <div class="sect2"><a id="GUID-A742F77E-9D77-42E1-BFB8-2DE9C6FB3051" name="GUID-A742F77E-9D77-42E1-BFB8-2DE9C6FB3051"></a><h3 id="JSSEC-GUID-A742F77E-9D77-42E1-BFB8-2DE9C6FB3051" class="sect3">开始之前：推荐阅读</h3>
               <div>
                  <p>在此Java GSS-API教程中，第一步是JAAS身份验证。先前的教程演示了如何使用JAAS进行用户身份验证和授权，并提供了JAAS所需的策略文件和登录配置文件（指定要使用的基础身份验证技术）的示例。JAAS入门教程， <a href="jaas-authentication.html#GUID-0C6EB04B-D203-4688-A3E2-A7D442334623">JAAS身份验证</a>和<a href="jaas-authorization.html#GUID-69241059-CCD0-49F6-838F-DDC752F9F19F">JAAS授权</a>中的应用程序直接调用了JAAS方法。“ <a href="use-jaas-login-utility.html#GUID-F41E74DF-EE54-4EB1-8609-49C6D324ADF5">JAAS登录实用程序</a>的使用”教程显示了实用程序的使用，该实用程序使应用程序不必执行此操作。当前教程中的客户端和服务器应用程序也使用相同的实用程序，因此我们建议您首先<span class="bold">阅读登录实用程序教程</span> 。
                  </p>
                  <p>与本系列的所有教程一样，本教程中用于支持应用程序的身份验证和安全通信的基础技术是Kerberos。请参见<a href="kerberos-requirements.html#GUID-EAA2758B-3071-4CDA-AEF1-D76F5271E998">Kerberos要求</a> 。
                  </p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-1C2B6E45-2E2F-421C-B0D3-F034156DDAE7" name="GUID-1C2B6E45-2E2F-421C-B0D3-F034156DDAE7"></a><h3 id="JSSEC-GUID-1C2B6E45-2E2F-421C-B0D3-F034156DDAE7" class="sect3">客户端和服务器应用程序概述</h3>
               <div>
                  <p>本教程的应用程序名为<code class="codeph">SampleClient</code>和<code class="codeph">SampleServer</code> 。
                  </p>
                  <p>通过执行本教程随附的Login实用程序并将其作为参数传递给应用程序的名称（ <code class="codeph">SampleClient</code>要么<code class="codeph">SampleServer</code> ），然后是应用程序所需的参数。登录实用程序使用JAAS <span class="apiname">LoginContext</span>来使用Kerberos认证用户。最后，登录实用程序调用<code class="codeph">main</code>应用程序类的方法，在我们的情况下<code class="codeph">SampleClient</code>要么<code class="codeph">SampleServer</code> ，并将其参数传递给应用程序。
                  </p>
                  <p>这是执行的摘要<code class="codeph">SampleClient</code>和<code class="codeph">SampleServer</code>应用范围：</p>
                  <ol>
                     <li>跑过<code class="codeph">SampleServer</code>通过运行Login实用程序并将其传递为参数“ <code class="codeph">SampleServer</code> ”，然后是<code class="codeph">SampleServer</code>程序。登录实用程序会提示您输入以下用户的密码<code class="codeph">SampleServer</code>应该运行为。（请参阅<a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-832A32FD-3D99-4624-86A4-7AFBF8924C80">Kerberos用户和服务主体名称</a> 。）身份验证完成后， <code class="codeph">SampleServer</code>运行它：<ol type="a">
                           <li>读取其参数，即应侦听客户端连接的端口号。</li>
                           <li>创建一个<span class="apiname">ServerSocket</span>来侦听该端口上的客户端连接。
                           </li>
                           <li>监听连接。</li>
                        </ol>
                     </li>
                     <li>跑过<code class="codeph">SampleClient</code>应用程序（可能在其他计算机上），方法是运行“登录”实用程序并将其传递为参数“ <code class="codeph">SampleClient</code> ”，然后是<code class="codeph">SampleClient</code>程序。登录实用程序会提示您输入Kerberos名称和密码。身份验证完成后， <code class="codeph">SampleClient</code>运行。它<ol type="a">
                           <li>读取其参数：（1）表示以下内容的Kerberos主体的名称<code class="codeph">SampleServer</code> 。（请参阅<a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-832A32FD-3D99-4624-86A4-7AFBF8924C80">Kerberos用户和服务主体名称</a> 。），（2）在其上的主机（计算机）的名称<code class="codeph">SampleServer</code>正在运行，以及（3）其上的端口号<code class="codeph">SampleServer</code>侦听客户端连接。
                           </li>
                           <li>尝试与<code class="codeph">SampleServer</code> ，使用主机和端口将其作为参数传递。
                           </li>
                        </ol>
                     </li>
                     <li>套接字连接被接受<code class="codeph">SampleServer</code>两个应用程序都从套接字输入和输出流初始化<span class="apiname">DataInputStream</span>和<span class="apiname">DataOutputStream</span> ，以用于将来的数据交换。
                     </li>
                     <li><code class="codeph">SampleClient</code>和<code class="codeph">SampleServer</code>每个实例都实例化<span class="apiname">GSSContext</span>并建立一个共享上下文，该上下文将支持后续的安全数据交换。
                     </li>
                     <li><code class="codeph">SampleClient</code>和<code class="codeph">SampleServer</code>现在可以安全地交换消息。
                     </li>
                     <li>什么时候<code class="codeph">SampleClient</code>和<code class="codeph">SampleServer</code>完成交换消息后，它们执行清理操作。
                     </li>
                  </ol>
                  <div class="infoboxnote" id="GUID-1C2B6E45-2E2F-421C-B0D3-F034156DDAE7__GUID-FF74737A-36D0-4B2D-8625-D720121B8CE2">
                     <p class="notep1">注意：</p>
                  </div>
                  <p>有关本教程中使用的代码的完整讨论，请参阅《 <a href="use-java-gss-api-secure-message-exchanges-jaas-programming.html#GUID-42A2B80C-90CD-4C7A-8EED-8BFFE83CAF56">使用Java GSS-API进行不使用JAAS编程的安全消息交换》</a>教程中<a href="use-java-gss-api-secure-message-exchanges-jaas-programming.html#GUID-0DDC8ACE-7398-41C6-B061-CF3DEAB7AC86">的SampleClient和SampleServer代码</a>部分。
                  </p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-832A32FD-3D99-4624-86A4-7AFBF8924C80" name="GUID-832A32FD-3D99-4624-86A4-7AFBF8924C80"></a><h3 id="JSSEC-GUID-832A32FD-3D99-4624-86A4-7AFBF8924C80" class="sect3">Kerberos用户和服务主体名称</h3>
               <div>
                  <p>由于本教程使用的基础身份验证和安全通信技术是Kerberos V5，因此无论需要用户或服务的地方，我们都使用Kerberos样式的主体名称（请参阅<a href="java-authentication-and-authorization-service-jaas-reference-guide.html#GUID-8FAF9739-CD62-4A47-9582-884DBF3081F0">Principals</a> ）。
                  </p>
                  <p>例如，当您运行<code class="codeph">SampleClient</code>要求您提供<span class="bold">用户名</span> 。Kerberos风格的用户名就是为Kerberos身份验证分配的用户名。它由基本用户名（例如<code class="codeph">mjones</code> ）后跟一个“ <code class="codeph">@</code>以及您的境界（例如<code class="codeph">mjones@KRBNT-OPERATIONS.EXAMPLE.COM</code> ）。
                  </p>
                  <p>像这样的服务器程序<code class="codeph">SampleServer</code>通常被视为提供“服务”并代表特定的“ <span class="bold">服务主体</span> ” <span class="bold">运行</span> 。的服务主体名称<code class="codeph">SampleServer</code>在几个地方需要：</p>
                  <ul style="list-style-type:disc">
                     <li>当你跑步<code class="codeph">SampleServer</code>您必须以适当的服务主体身份登录。本教程的登录配置文件实际上指定了服务主体名称（作为<span class="apiname">Krb5LoginModule的</span>一个选项），因此JAAS身份验证（由<span class="apiname">Login</span>实用程序完成）仅要求您指定该服务主体的密码。如果指定了正确的密码，验证成功， <span class="apiname">主题</span>是创建一个包含与服务主体名称的<span class="apiname">负责人</span> ，以及<span class="apiname">主题</span>与新的访问控制上下文关联。随后执行的代码（ <code class="codeph">SampleServer</code>代码）被视为代表指定的主体执行。
                     </li>
                     <li>当你跑步<code class="codeph">SampleClient</code> ，参数之一是服务主体名称。这是需要的<code class="codeph">SampleClient</code>可以使用适当的服务启动安全上下文的建立。
                     </li>
                     <li>客户端和服务器策略文件每个都需要一个<span class="apiname">ServicePermission</span> ，其名称等于服务主体名称，其操作等于“发起”或“接受”（用于发起或接受建立安全上下文）。
                     </li>
                  </ul>
                  <p>在本文档中以及随附的登录配置文件和策略文件中， <code class="codeph">service_principal@your_realm</code>用作占位符，由您的环境中使用的实际名称替换。实际上， <span class="italic">任何</span> Kerberos主体都可以用作服务主体名称。因此<span class="bold">，出于尝试本教程的目的，您可以将用户名用作客户端用户名和服务主体名。</span></p>
                  <p>在生产环境中，系统管理员通常喜欢将服务器仅作为特定主体运行，并且可以分配要使用的特定名称。分配的Kerberos样式服务主体名称通常为以下形式</p><pre class="pre codeblock"><code>service_name/machine_name@realm; 
</code></pre><p>例如，nfs服务在名为“ raven”的域中的机器上运行<code class="codeph">KRBNT-OPERATIONS.EXAMPLE.COM</code>可以具有服务主体名称</p><pre class="pre codeblock"><code>nfs/raven@KRBNT-OPERATIONS.EXAMPLE.COM
</code></pre><p>但是，此类多组件名称不是必需的。可以使用单组件名称，就像用户主体的名称一样。例如，安装可能使用相同的ftp服务主体<code class="codeph">ftp@realm</code>适用于该领域中的所有ftp服务器，而另一个安装可能针对不同的ftp服务器具有不同的ftp主体，例如<code class="codeph">ftp/host1@realm</code>和<code class="codeph">ftp/host2@realm</code>在机器上<code class="codeph">host1</code>和<code class="codeph">host2</code> ， 分别。
                  </p>
               </div>
               <div class="sect3"><a id="GUID-E863F99A-77AC-4BE8-BAC1-A7B2E77FE775" name="GUID-E863F99A-77AC-4BE8-BAC1-A7B2E77FE775"></a><h4 id="JSSEC-GUID-E863F99A-77AC-4BE8-BAC1-A7B2E77FE775" class="sect4">当主体名称中需要领域时</h4>
                  <div>
                     <p>如果用户或服务主体名称的领域是默认领域（请参见<a href="kerberos-requirements.html#GUID-EAA2758B-3071-4CDA-AEF1-D76F5271E998">Kerberos要求</a> ），则可以在登录Kerberos（即提示您输入用户名）时离开该领域。因此，例如，如果您的用户名是<code class="codeph">mjones@KRBNT-OPERATIONS.EXAMPLE.COM</code> ，然后您跑步<code class="codeph">SampleClient</code> ，当它要求您的用户名时，您只需指定<code class="codeph">mjones</code> ，离开领域。该名称在作为Kerberos主体名称的上下文中进行解释，并根据需要附加默认领域。
                     </p>
                     <p>如果主体名称将由<span class="apiname">GSSManager</span>转换为<span class="apiname">GSSName</span> ，那么您也可以离开领域<code class="codeph">createName</code>方法。例如，当您运行<code class="codeph">SampleClient</code> ，参数之一是服务器服务主体名称。您可以指定名称而不包含领域，因为<code class="codeph">SampleClient</code>将名称传递给这样的<code class="codeph">createName</code>方法，根据需要追加默认领域。
                     </p>
                     <p>建议在登录配置文件和策略文件中使用主体名称时始终包含领域，因为此类文件的解析器行为可能与实现有关；它们可能会或可能不会在使用此类名称之前附加默认领域，并且如果名称中没有领域，则后续操作可能会失败。</p>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-3B582CD5-135F-4516-843E-1831DB25CCC4" name="GUID-3B582CD5-135F-4516-843E-1831DB25CCC4"></a><h3 id="JSSEC-GUID-3B582CD5-135F-4516-843E-1831DB25CCC4" class="sect3">登录配置文件</h3>
               <div>
                  <p>无论何时使用JAAS，都需要登录配置以指定所需的身份验证技术。（有关什么是登录配置文件，请参阅<a href="appendix-b-jaas-login-configuration-file.html#GUID-7EB80FA5-3C16-4016-AED6-0FC619F86F8E">附录B：JAAS登录配置文件</a> 。）都<code class="codeph">SampleClient</code>和<code class="codeph">SampleServer</code>可以使用相同的登录配置文件（如果该文件包含两个条目，一个条目用于客户端，一个条目用于服务器）。
                  </p>
                  <p>的<a href="source-code-jaas-and-java-gss-api-tutorials.html#GUID-09D4192C-D855-49D6-BC62-E08F49ADB4F8__CSLOGIN.CONF-33894173"><code>csLogin.conf</code></a>本教程使用的登录配置文件如下：</p><pre class="pre codeblock"><code><span class="bold">SampleClient</span> {
  com.sun.security.auth.module.Krb5LoginModule required;
};

<span class="bold">SampleServer</span> {
  com.sun.security.auth.module.Krb5LoginModule required storeKey=true 
    principal="service_principal@your_realm";
};
</code></pre><p>请注意，每个条目的名称都与我们两个顶级应用程序的相应类名称匹配， <code class="codeph">SampleClient</code>和<code class="codeph">SampleServer</code> 。回想一下，这也是传递给为应用程序执行JAAS操作的Login实用程序的名称。该实用程序希望在登录配置文件中查找的条目名称与传递的名称相同。
                  </p>
                  <p>这两个条目都指定必须使用Oracle的Kerberos V5 LoginModule来成功验证用户。仅当尝试以指定实体身份登录Kerberos KDC时，Krb5LoginModule才成功。如果是<code class="codeph">SampleClient</code> ，系统将提示用户输入其名称和密码。如果是<code class="codeph">SampleServer</code> ，此登录配置文件中已经提供了名称（指定的主体，如下所述），并且用户正在运行<code class="codeph">SampleServer</code>仅要求输入由该名称指定的实体的密码。他们必须指定正确的密码才能成功进行身份验证。
                  </p>
                  <p>的<code class="codeph">SampleServer</code>条目<span class="bold"><code class="codeph">storeKey=true</code></span>表示应从登录期间提供的密码中计算出一个密钥，并将其存储在登录后创建的<span class="apiname">主题</span>的专用凭据中。此密钥随后在相互认证期间在以下情况下建立安全上下文时使用： <code class="codeph">SampleClient</code>和<code class="codeph">SampleServer</code> 。
                  </p>
                  <p><span class="apiname">Krb5LoginModule</span>具有一个<span class="bold"><code class="codeph">principal</code></span>该选项可用于指定对于给定程序，仅应登录指定的主体（实体/用户）。在这里<code class="codeph">SampleClient</code>该条目未指定主体（尽管可以，但可以指定），因此系统会提示用户输入用户名和密码，任何具有有效用户名和密码的人都可以运行<code class="codeph">SampleClient</code> 。 <code class="codeph">SampleServer</code>另一方面，表示特定的主体，因为系统管理员通常喜欢将服务器仅作为特定的主体运行。在这种情况下，用户正在运行<code class="codeph">SampleServer</code>提示输入该主体的密码，并且必须提供正确的密码才能成功进行身份验证。
                  </p>
                  <p>请注意，您必须更换<code class="codeph">service_principal@your_realm</code>带有代表的服务主体的名称<code class="codeph">SampleServer</code> 。（请参阅<a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-832A32FD-3D99-4624-86A4-7AFBF8924C80">Kerberos用户和服务主体名称</a> 。）
                  </p>
                  <p>如果服务器具有包含密钥的密钥表文件，请使用以下JAAS登录条目：</p><pre class="pre codeblock"><code><span class="bold">SampleServer</span> {
  com.sun.security.auth.module.Krb5LoginModule required
  principal="service_principal@your_realm"
  storeKey=true useKeyTab=true keyTab=keytab.file.name
  isInitiator=false;
};</code></pre><p>由于keytab文件已经提供了密钥，因此不会提示您输入密码。如果keytab文件包含多个服务主体的密钥，并且服务器被设计为充当所有这些服务主体，则可以将主体条目设置为以下内容：</p><pre class="pre codeblock"><code>  principal=*</code></pre><p>请参阅<a href="https://docs.oracle.com/javase/10/docs/api/com/sun/security/auth/module/Krb5LoginModule.html" target="_blank"><span class="apiname">Krb5LoginModule</span></a> Javadoc API文档，以获取有关可以传递给<span class="apiname">Krb5LoginModule的</span>所有可能选项的信息。
                  </p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-2BA7F0B7-D3E3-4B81-8E98-0A39F9763B59" name="GUID-2BA7F0B7-D3E3-4B81-8E98-0A39F9763B59"></a><h3 id="JSSEC-GUID-2BA7F0B7-D3E3-4B81-8E98-0A39F9763B59" class="sect3">政策文件</h3>
               <div>
                  <p>运行时使用的策略文件<code class="codeph">SampleClient</code>是<a href="source-code-jaas-and-java-gss-api-tutorials.html#GUID-09D4192C-D855-49D6-BC62-E08F49ADB4F8__CLIENT.POLICY-33894283"><code>client.policy</code></a> ，以及运行时使用的策略文件<code class="codeph">SampleServer</code>是<a href="source-code-jaas-and-java-gss-api-tutorials.html#GUID-09D4192C-D855-49D6-BC62-E08F49ADB4F8__SERVER.POLICY-33894513"><code>server.policy</code></a> 。其内容如下。
                  </p>
               </div>
               <div class="sect3"><a id="GUID-6C3F477A-6245-48F1-B83F-3CCE8581197C" name="GUID-6C3F477A-6245-48F1-B83F-3CCE8581197C"></a><h4 id="JSSEC-GUID-6C3F477A-6245-48F1-B83F-3CCE8581197C" class="sect4">客户端策略文件</h4>
                  <div>
                     <p></p>
                  </div>
                  <div class="sect4"><a id="GUID-F5030E1B-C83F-4464-BD5C-D0D04051FF12" name="GUID-F5030E1B-C83F-4464-BD5C-D0D04051FF12"></a><h5 id="JSSEC-GUID-F5030E1B-C83F-4464-BD5C-D0D04051FF12" class="sect5">登录实用程序类所需的权限</h5>
                     <div>
                        <p>中的类需要许多权限<code class="codeph">Login.java</code> （ <code class="codeph">Login</code>和<code class="codeph">MyAction</code> ）。根据<a href="use-jaas-login-utility.html#GUID-F41E74DF-EE54-4EB1-8609-49C6D324ADF5">使用登录实用程序</a>中的使用<a href="use-jaas-login-utility.html#GUID-F41E74DF-EE54-4EB1-8609-49C6D324ADF5">JAAS登录实用程序中的</a>建议，我们创建了一个<code class="codeph">Login.jar</code>包含<code class="codeph">Login.class</code>和<code class="codeph">MyAction.class</code>文件和<code class="codeph">client.policy</code>我们授予的政策文件<code class="codeph">Login.jar AllPermission</code> ：</p><pre class="pre codeblock"><code>grant codebase "file:./Login.jar" {
   permission java.security.AllPermission;
};
</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-92A55C57-DA1F-492E-95F3-7FDCF84FCB34" name="GUID-92A55C57-DA1F-492E-95F3-7FDCF84FCB34"></a><h5 id="JSSEC-GUID-92A55C57-DA1F-492E-95F3-7FDCF84FCB34" class="sect5">SampleClient所需的权限</h5>
                     <div>
                        <p>的<code class="codeph">SampleClient</code>代码执行两种需要权限的操作。它</p>
                        <ul style="list-style-type:disc">
                           <li>打开与正在运行主机的主机的套接字连接<code class="codeph">SampleServer</code>应用。
                           </li>
                           <li>通过以下方式建立安全上下文<code class="codeph">SampleServer</code> 。
                           </li>
                        </ul>
                        <p>打开套接字连接所需的权限是</p><pre class="pre codeblock"><code>permission java.net.SocketPermission "*", "connect";
</code></pre><p>您可以将“ *”替换为以下主机的主机名或IP地址： <code class="codeph">SampleServer</code>将继续运行。
                        </p>
                        <p>启动安全上下文的建立所需的权限将取决于基础机制。本教程使用Kerberos作为基础机制，对于这两种机制<code class="codeph">javax.security.auth.kerberos.ServicePermission</code>是必需的。<span class="apiname">ServicePermission</span>包含服务主体名称和一个操作（或操作列表）。要启动安全上下文的建立，您需要具有操作“ initiate”的两个<span class="apiname">ServicePermission</span> ，其名称指定：</p>
                        <ul style="list-style-type:disc">
                           <li>您的域的票证授予服务的服务主体名称。授予此权限本质上允许使用Kerberos作为客户端。</li>
                           <li>服务主体名称代表<code class="codeph">SampleServer</code> 。（请参阅<a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-832A32FD-3D99-4624-86A4-7AFBF8924C80">Kerberos用户和服务主体名称</a> 。）授予此权限后，您便可以与服务进行交互， <code class="codeph">SampleServer</code> ，使用Kerberos。
                           </li>
                        </ul>
                        <p>我们要向执行特定身份验证的用户授予权限<code class="codeph">SampleClient</code> ，因此我们同时指定了<code class="codeph">SampleClient</code>代码位置（在<code class="codeph">SampleClient.jar</code> ）和一个主要名称（指示用户的用户名和领域，即您将要运行的人） <code class="codeph">SampleClient</code> ）。（请参阅<a href="jaas-authorization.html#GUID-80F0B546-1E95-457B-8EF7-5BB1519E20A4">如何制作基于主体的策略文件语句？</a> <a href="jaas-authorization.html#GUID-69241059-CCD0-49F6-838F-DDC752F9F19F">JAAS授权</a>中的有关策略文件的信息<code class="codeph">grant</code>包含<span class="apiname">主要</span>名称的声明。）
                        </p>
                        <p>这是<code class="codeph">grant</code>声明：</p><pre class="pre codeblock"><code>  grant CodeBase "file:./SampleClient.jar", 
    Principal javax.security.auth.kerberos.KerberosPrincipal 
        "your_user_name@your_realm" {

    permission java.net.SocketPermission "*", "connect";

    permission javax.security.auth.kerberos.ServicePermission
        "krbtgt/your_realm@your_realm", 
        "initiate";

    permission javax.security.auth.kerberos.ServicePermission
        "service_principal@your_realm", 
        "initiate";
};
</code></pre><p>您必须将Kerberos用户名（用“ @”和领域完整）替换为<code class="codeph">your_user_name@your_realm</code> 。例如，如果您的用户名是<span class="apiname">mjones，</span>而领域是<span class="apiname">KRBNT-OPERATIONS.EXAMPLE.COM</span> ，则可以使用<span class="apiname">mjones@KRBNT-OPERATIONS.EXAMPLE.COM</span> 。</p>
                        <p>您还必须在<span class="apiname">krbtgt / your_realm @ your_realm中</span>替换您的领域，并使用代表服务器的服务主体的服务主体名称（请参见<a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-832A32FD-3D99-4624-86A4-7AFBF8924C80">Kerberos用户和服务主体名称</a> ，以获取代表服务器的服务主体的服务主体名称）。 <code class="codeph">service_principal@your_realm</code> 。假设前者是<span class="apiname">krbtgt/KRBNT-OPERATIONS.EXAMPLE.COM@KRBNT-OPERATIONS.EXAMPLE.COM</span> ，后者是<span class="apiname">sample/raven.example.com@KRBNT-OPERATIONS.EXAMPLE.COM</span> ，并且您的用户名与前一段。然后<code class="codeph">grant</code>声明将是</p><pre class="pre codeblock"><code>
grant CodeBase "file:./SampleClient.jar", 
    Principal javax.security.auth.kerberos.KerberosPrincipal 
        "mjones@KRBNT-OPERATIONS.EXAMPLE.COM" {

    permission java.net.SocketPermission "*", "connect";

    permission javax.security.auth.kerberos.ServicePermission
        "krbtgt/KRBNT-OPERATIONS.EXAMPLE.COM@KRBNT-OPERATIONS.EXAMPLE.COM", 
        "initiate";

    permission javax.security.auth.kerberos.ServicePermission
        "sample/raven.example.com@KRBNT-OPERATIONS.EXAMPLE.COM", 
        "initiate";
};
</code></pre></div>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-9126BE63-55A5-45C0-8EDC-89A65A83271D" name="GUID-9126BE63-55A5-45C0-8EDC-89A65A83271D"></a><h4 id="JSSEC-GUID-9126BE63-55A5-45C0-8EDC-89A65A83271D" class="sect4">服务器策略文件</h4>
                  <div></div>
                  <div class="sect4"><a id="GUID-D84DE593-D18A-49A6-BE6D-DD7F787527C9" name="GUID-D84DE593-D18A-49A6-BE6D-DD7F787527C9"></a><h5 id="JSSEC-GUID-D84DE593-D18A-49A6-BE6D-DD7F787527C9" class="sect5">登录实用程序类所需的权限</h5>
                     <div>
                        <p>的<code class="codeph">grant</code>登录策略的服务器策略文件中的语句与客户端策略文件中的语句完全相同，如<a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-F5030E1B-C83F-4464-BD5C-D0D04051FF12">登录实用程序类所需的权限中所述</a> ：</p><pre class="pre codeblock"><code>grant codebase "file:./Login.jar" {
   permission java.security.AllPermission;
};
</code></pre></div>
                  </div>
                  <div class="sect4"><a id="GUID-D4D40063-566E-489E-AB13-C5B7ADA112B9" name="GUID-D4D40063-566E-489E-AB13-C5B7ADA112B9"></a><h5 id="JSSEC-GUID-D4D40063-566E-489E-AB13-C5B7ADA112B9" class="sect5">SampleServer所需的权限</h5>
                     <div>
                        <p>的<code class="codeph">SampleServer</code>代码执行两种需要权限的操作。它</p>
                        <ul style="list-style-type:disc">
                           <li>接受套接字连接。</li>
                           <li>接受安全上下文的建立，即它是安全上下文建立的“接受者”。</li>
                        </ul>
                        <p>接受套接字连接所需的权限是</p><pre class="pre codeblock"><code>
permission java.net.SocketPermission "*", "accept";
</code></pre><p>您可以将“ *”替换为以下主机的主机名或IP地址： <code class="codeph">SampleClient</code>将继续运行。
                        </p>
                        <p>接受建立安全上下文所需的许可是</p><pre class="pre codeblock"><code>permission javax.security.auth.kerberos.ServicePermission
    "service_principal@your_realm", 
    "accept";
</code></pre><p>哪里<code class="codeph">service_principal@your_realm</code>是表示以下内容的服务主体的Kerberos名称： <code class="codeph">SampleServer</code> （请参阅<a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-832A32FD-3D99-4624-86A4-7AFBF8924C80">Kerberos用户和服务主体名称</a> ）。
                        </p>
                        <p>我们要向执行特定身份验证的用户授予权限<code class="codeph">SampleServer</code> （被视为代表的服务主体<code class="codeph">SampleServer</code> ），因此我们同时指定了<code class="codeph">SampleServer</code>代码位置（在<code class="codeph">SampleServer.jar</code> ）和表示服务主体的主体名称。假设这个名字是<code class="codeph">sample/raven.example.com@KRBNT-OPERATIONS.EXAMPLE.COM</code> 。然后<code class="codeph">grant</code>声明将是</p><pre class="pre codeblock"><code>  grant CodeBase "file:./SampleServer.jar" 
    Principal javax.security.auth.kerberos.KerberosPrincipal 
        "sample/raven.example.com@KRBNT-OPERATIONS.EXAMPLE.COM" {

    permission java.net.SocketPermission "*", "accept";

    permission javax.security.auth.kerberos.ServicePermission
        "sample/raven.example.com@KRBNT-OPERATIONS.EXAMPLE.COM", "accept";
};
</code></pre></div>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-07D0C8CC-0922-4B0F-B14D-9A644CB13783" name="GUID-07D0C8CC-0922-4B0F-B14D-9A644CB13783"></a><h3 id="JSSEC-GUID-07D0C8CC-0922-4B0F-B14D-9A644CB13783" class="sect3">运行SampleClient和SampleServer程序</h3>
               <div>
                  <p>执行<code class="codeph">SampleClient</code>和<code class="codeph">SampleServer</code>程序，请执行以下操作：</p>
                  <ul style="list-style-type:disc">
                     <li><a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-901B5429-D25C-4DAA-90BB-7665E3682D52">准备要执行的SampleServer</a></li>
                     <li><a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-F72FA916-2507-479C-A2E3-89FCB25D0FE8">准备SampleClient执行</a></li>
                     <li><a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-70ADB0E1-E036-4E40-8289-66545AD90C2F">执行SampleServer</a></li>
                     <li><a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-19CC950B-FFCA-471A-918E-92559F556356">执行SampleClient</a></li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-901B5429-D25C-4DAA-90BB-7665E3682D52" name="GUID-901B5429-D25C-4DAA-90BB-7665E3682D52"></a><h4 id="JSSEC-GUID-901B5429-D25C-4DAA-90BB-7665E3682D52" class="sect4">准备要执行的SampleServer</h4>
                  <div>
                     <p>准备<code class="codeph">SampleServer</code>要执行，请执行以下操作：</p>
                     <ol>
                        <li>将以下文件复制到要运行的计算机可访问的目录中<code class="codeph">SampleServer</code> ：<ul style="list-style-type:disc">
                              <li>的<a href="source-code-jaas-and-java-gss-api-tutorials.html#GUID-09D4192C-D855-49D6-BC62-E08F49ADB4F8__LOGIN.JAVA-338935D0"><code>Login.java</code></a>源文件。
                              </li>
                              <li>的<a href="source-code-jaas-and-java-gss-api-tutorials.html#GUID-09D4192C-D855-49D6-BC62-E08F49ADB4F8__SAMPLESERVER.JAVA-33891DED"><code>SampleServer.java</code></a>源文件。
                              </li>
                              <li>的<a href="source-code-jaas-and-java-gss-api-tutorials.html#GUID-09D4192C-D855-49D6-BC62-E08F49ADB4F8__CSLOGIN.CONF-33894173"><code>csLogin.conf</code></a>登录配置文件。
                              </li>
                              <li>的<a href="source-code-jaas-and-java-gss-api-tutorials.html#GUID-09D4192C-D855-49D6-BC62-E08F49ADB4F8__SERVER.POLICY-33894513"><code>server.policy</code></a>策略文件。
                              </li>
                           </ul>
                        </li>
                        <li>更换<code class="codeph">service_principal@your_realm</code>在<code class="codeph">csLogin.conf</code>服务主体的名称代表<code class="codeph">SampleServer</code> （请参阅<a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-832A32FD-3D99-4624-86A4-7AFBF8924C80">Kerberos用户和服务主体名称</a> ）。
                        </li>
                        <li>在两个地方都出现，更换<code class="codeph">service_principal@your_realm</code>在<code class="codeph">server.policy</code>的服务主体的Kerberos名称表示<code class="codeph">SampleServer</code> 。（与登录配置文件中使用的名称相同。）
                        </li>
                        <li>编译<code class="codeph">Login.java</code>和<code class="codeph">SampleServer.java</code> ：<pre class="pre codeblock"><code>javac Login.java SampleServer.java
</code></pre><p>注意<code class="codeph">Login.java</code>包含两个类，因此进行编译<code class="codeph">Login.java</code>创造<code class="codeph">Login.class</code>和<code class="codeph">MyAction.class</code> 。
                           </p>
                        </li>
                        <li>创建一个名为的JAR文件<code class="codeph">Login.jar</code>包含<code class="codeph">Login.class and MyAction.class</code> ：<pre class="pre codeblock"><code>jar -cvf Login.jar Login.class MyAction.class
</code></pre></li>
                        <li>创建一个名为的JAR文件<code class="codeph">SampleServer.jar</code>包含<code class="codeph">SampleServer.class</code> ：<pre class="pre codeblock"><code>jar -cvf SampleServer.jar SampleServer.class
</code></pre></li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-F72FA916-2507-479C-A2E3-89FCB25D0FE8" name="GUID-F72FA916-2507-479C-A2E3-89FCB25D0FE8"></a><h4 id="JSSEC-GUID-F72FA916-2507-479C-A2E3-89FCB25D0FE8" class="sect4">准备SampleClient执行</h4>
                  <div>
                     <p>准备<code class="codeph">SampleClient</code>要执行，请执行以下操作：</p>
                     <ol>
                        <li>将以下文件复制到要运行的计算机可访问的目录中<code class="codeph">SampleClient</code> ：<ul style="list-style-type:disc">
                              <li>的<a href="source-code-jaas-and-java-gss-api-tutorials.html#GUID-09D4192C-D855-49D6-BC62-E08F49ADB4F8__LOGIN.JAVA-338935D0"><code>Login.java</code></a>源文件。
                              </li>
                              <li>的<a href="source-code-jaas-and-java-gss-api-tutorials.html#GUID-09D4192C-D855-49D6-BC62-E08F49ADB4F8__SAMPLECLIENT.JAVA-338923E1"><code>SampleClient.java</code></a>源文件。
                              </li>
                              <li>的<a href="source-code-jaas-and-java-gss-api-tutorials.html#GUID-09D4192C-D855-49D6-BC62-E08F49ADB4F8__CSLOGIN.CONF-33894173"><code>csLogin.conf</code></a>登录配置文件。
                              </li>
                              <li>的<a href="source-code-jaas-and-java-gss-api-tutorials.html#GUID-09D4192C-D855-49D6-BC62-E08F49ADB4F8__CLIENT.POLICY-33894283"><code>client.policy</code></a>策略文件。
                              </li>
                           </ul>
                        </li>
                        <li>更换零件<code class="codeph">client.policy</code> ：<ul style="list-style-type:disc">
                              <li>更换<code class="codeph">your_user_name@your_realm</code>与您的用户名和领域。
                              </li>
                              <li>更换<code class="codeph">your_realm</code>在<code class="codeph">krbtgt/your_realm@your_realm</code>与您的境界。
                              </li>
                              <li>更换<code class="codeph">service_principal@your_realm</code>的服务主体的Kerberos名称表示<code class="codeph">SampleServer</code> （请参阅<a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-832A32FD-3D99-4624-86A4-7AFBF8924C80">Kerberos用户和服务主体名称</a> ）。
                              </li>
                           </ul>
                        </li>
                        <li>编译<code class="codeph">Login.java</code>和<code class="codeph">SampleClient.java</code> ：<pre class="pre codeblock"><code>javac Login.java SampleClient.java
</code></pre></li>
                        <li>创建一个名为的JAR文件<code class="codeph">Login.jar</code>包含<code class="codeph">Login.class and MyAction.class</code> ：<pre class="pre codeblock"><code>jar -cvf Login.jar Login.class MyAction.class
</code></pre></li>
                        <li>创建一个名为的JAR文件<code class="codeph">SampleClient.jar</code>包含<code class="codeph">SampleClient.class</code> ：<pre class="pre codeblock"><code>jar -cvf SampleClient.jar SampleClient.class
</code></pre></li>
                     </ol>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-70ADB0E1-E036-4E40-8289-66545AD90C2F" name="GUID-70ADB0E1-E036-4E40-8289-66545AD90C2F"></a><h4 id="JSSEC-GUID-70ADB0E1-E036-4E40-8289-66545AD90C2F" class="sect4">执行SampleServer</h4>
                  <div>
                     <p>重要的是要执行<code class="codeph">SampleServer</code>之前<code class="codeph">SampleClient</code>因为<code class="codeph">SampleClient</code>将尝试建立套接字连接<code class="codeph">SampleServer</code>如果那会失败<code class="codeph">SampleServer</code>尚未运行并接受套接字连接。
                     </p>
                     <p>执行<code class="codeph">SampleServer</code> ，请确保在预期运行的计算机上运行它。该机器名（主机名）被指定为<code class="codeph">SampleClient</code> 。服务主体名称出现在多个位置，包括登录配置文件和策略文件。
                     </p>
                     <p>转到您准备的目录<code class="codeph">SampleServer</code>执行。执行<code class="codeph">Login</code>类，指定</p>
                     <ul style="list-style-type:disc">
                        <li>通过适当的<code class="codeph">-classpath</code>子句，应该在<code class="codeph">Login.jar</code>和<code class="codeph">SampleServer.jar</code> JAR文件，</li>
                        <li>通过<code class="codeph">-Djava.security.manager</code>应该安装安全管理器，</li>
                        <li>通过<code class="codeph">-Djava.security.krb5.realm=<span class="variable" translate="no"><your_realm></span></code>您的Kerberos领域是指定的领域。例如，如果您的领域是<code class="codeph">KRBNT-OPERATIONS.EXAMPLE.COM</code>你放<code class="codeph">-Djava.security.krb5.realm=KRBNT-OPERATIONS.EXAMPLE.COM</code> 。
                        </li>
                        <li>通过<code class="codeph">-Djava.security.krb5.kdc=<span class="variable" translate="no"><your_kdc></span></code>您的Kerberos KDC是指定的那个。例如，如果您的KDC是<code class="codeph">samplekdc.example.com</code>你放<code class="codeph">-Djava.security.krb5.kdc=samplekdc.example.com</code> 。
                        </li>
                        <li>通过<code class="codeph">-Djava.security.policy=server.policy</code>要使用的策略文件是<code class="codeph">server.policy</code>和</li>
                        <li>通过<code class="codeph">-Djava.security.auth.login.config=csLogin.conf</code>要使用的登录配置文件是<code class="codeph">csLogin.conf</code> 。
                        </li>
                     </ul>
                     <p>您传递应用程序的名称（在这种情况下， <code class="codeph">SampleServer</code> ）作为登录名的参数。然后，您可以将应用程序所需的所有参数添加为参数，对于<code class="codeph">SampleServer</code>是单个参数，用于指定用于侦听客户端连接的端口号。选择一个高端口号，该端口号不太可能用于其他用途。例如4444。
                     </p>
                     <p>以下是可用于Windows和Solaris，Linux和macOS的完整命令。唯一的区别是Windows使用分号分隔类路径项，而在Solaris，Linux和macOS上为此目的使用冒号。</p>
                     <div class="infoboxnote" id="GUID-70ADB0E1-E036-4E40-8289-66545AD90C2F__GUID-B539751A-F513-41FA-A623-134F1ABEEBD4">
                        <p class="notep1">注意：</p>
                        <p><span class="bold">重要说明：在这些命令中，您必须替换<code class="codeph"><span class="variable" translate="no"><port_number></span></code>带有适当的端口号， <code class="codeph"><span class="variable" translate="no"><your_realm></span></code>与您的Kerberos领域，以及<code class="codeph"><span class="variable" translate="no"><your_kdc></span></code>与您的Kerberos KDC。</span></p>
                     </div>
                     <p>这是Windows的命令：</p><pre class="pre codeblock"><code>java -classpath Login.jar;SampleServer.jar 
 -Djava.security.manager 
 -Djava.security.krb5.realm=<span class="variable" translate="no">&lt;your_realm&gt;</span> 
 -Djava.security.krb5.kdc=<span class="variable" translate="no">&lt;your_kdc&gt;</span> 
 -Djava.security.policy=server.policy 
 -Djava.security.auth.login.config=csLogin.conf 
 Login SampleServer <span class="variable" translate="no">&lt;port_number&gt;</span>
</code></pre><p>这是用于Solaris，Linux和macOS的命令：</p><pre class="pre codeblock"><code>java -classpath Login.jar:SampleServer.jar 
 -Djava.security.manager 
 -Djava.security.krb5.realm=<span class="variable" translate="no">&lt;your_realm&gt;</span>
 -Djava.security.krb5.kdc=<span class="variable" translate="no">&lt;your_kdc&gt;</span> 
 -Djava.security.policy=server.policy 
 -Djava.security.auth.login.config=csLogin.conf 
 Login SampleServer <span class="variable" translate="no">&lt;port_number&gt;</span>
</code></pre><p>在一行上键入完整的命令。为了清晰起见，此处使用多行。如果该命令对于您的系统而言太长，则可能需要将其放置在.bat文件（对于Windows）或.sh文件（对于Solaris，Linux和macOS）中，然后运行该文件以执行命令。</p>
                     <p>系统将提示您输入服务主体的Kerberos密码。在登录配置文件中指定的底层Kerberos身份验证机制会将服务主体记录到Kerberos中。身份验证成功完成后， <code class="codeph">SampleServer</code>代码将代表服务主体执行。它将侦听指定端口上的套接字连接。
                     </p>
                     <p>有关登录故障排除的建议，请参阅<a href="troubleshooting.html#GUID-2087ADBA-6C36-43D5-8841-C79FCB4F5FBE">故障排除</a> 。
                     </p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-19CC950B-FFCA-471A-918E-92559F556356" name="GUID-19CC950B-FFCA-471A-918E-92559F556356"></a><h4 id="JSSEC-GUID-19CC950B-FFCA-471A-918E-92559F556356" class="sect4">执行SampleClient</h4>
                  <div>
                     <p>执行<code class="codeph">SampleClient</code> ，转到您准备好的目录<code class="codeph">SampleClient</code>执行。然后执行<code class="codeph">Login</code>类，指定</p>
                     <ul style="list-style-type:disc">
                        <li>通过适当的<code class="codeph">-classpath</code>子句，应该在<code class="codeph">Login.jar</code>和<code class="codeph">SampleClient.jar</code> JAR文件，</li>
                        <li>通过<code class="codeph">-Djava.security.manager</code>应该安装安全管理器，</li>
                        <li>通过<code class="codeph">-Djava.security.krb5.realm=<span class="variable" translate="no"><your_realm></span></code>您的Kerberos领域是指定的领域。
                        </li>
                        <li>通过<code class="codeph">-Djava.security.krb5.kdc=<span class="variable" translate="no"><your_kdc></span></code>您的Kerberos KDC是指定的那个。
                        </li>
                        <li>通过<code class="codeph">-Djava.security.policy=client.policy</code>要使用的策略文件是<code class="codeph">client.policy</code>和</li>
                        <li>通过<code class="codeph">-Djava.security.auth.login.config=csLogin.conf</code>要使用的登录配置文件是<code class="codeph">csLogin.conf</code> 。
                        </li>
                     </ul>
                     <p>传递登录名，您的应用程序名称（ <code class="codeph">SampleClient</code> ），然后是所需的参数<code class="codeph">SampleClient</code> 。的<code class="codeph">SampleClient</code>参数是（1）表示服务主体的Kerberos名称<code class="codeph">SampleServer</code> （请参见<a href="use-jaas-login-utility-and-java-gss-api-secure-message-exchanges.html#GUID-832A32FD-3D99-4624-86A4-7AFBF8924C80">Kerberos用户和服务主体名称</a> ，（2）主机（计算机）的名称<code class="codeph">SampleServer</code>正在运行，以及（3）其上的端口号<code class="codeph">SampleServer</code>正在侦听客户端连接。
                     </p>
                     <p>以下是可用于Windows，Solaris，Linux和macOS的完整命令。</p>
                     <div class="infoboxnote" id="GUID-19CC950B-FFCA-471A-918E-92559F556356__GUID-8F54E144-67DF-418F-B273-76815F39CF91">
                        <p class="notep1">注意：</p>
                     </div>
                     <p><span class="bold">重要说明：在这些命令中，您必须替换<code class="codeph"><span class="variable" translate="no"><service_principal></span></code> ， <code class="codeph"><span class="variable" translate="no"><host></span></code> ， <code class="codeph"><span class="variable" translate="no"><port_number></span></code> ， <code class="codeph"><span class="variable" translate="no"><your_realm></span></code>和<code class="codeph"><span class="variable" translate="no"><your_kdc></span></code>具有适当的值</span> （请注意，端口号必须与作为参数传递给的端口号相同） <code class="codeph">SampleServer</code> ）。这些值不必放在引号中。
                     </p>
                     <p>这是Windows的命令：</p><pre class="pre codeblock"><code>java -classpath Login.jar;SampleClient.jar 
 -Djava.security.manager 
 -Djava.security.krb5.realm=<span class="variable" translate="no">&lt;your_realm&gt;</span> 
 -Djava.security.krb5.kdc=<span class="variable" translate="no">&lt;your_kdc&gt;</span> 
 -Djava.security.policy=client.policy 
 -Djava.security.auth.login.config=csLogin.conf 
 Login SampleClient <span class="variable" translate="no">&lt;service_principal&gt;</span> <span class="variable" translate="no">&lt;host&gt;</span> <span class="variable" translate="no">&lt;port_number&gt;</span>
</code></pre><p>这是用于Solaris，Linux和macOS的命令：</p><pre class="pre codeblock"><code>java -classpath Login.jar:SampleClient.jar 
 -Djava.security.manager 
 -Djava.security.krb5.realm=<span class="variable" translate="no">&lt;your_realm&gt;</span> 
 -Djava.security.krb5.kdc=<span class="variable" translate="no">&lt;your_realm&gt;</span> 
 -Djava.security.policy=client.policy 
 -Djava.security.auth.login.config=csLogin.conf 
 Login SampleClient <span class="variable" translate="no">&lt;service_principal&gt;</span> <span class="variable" translate="no">&lt;host&gt;</span> <span class="variable" translate="no">&lt;port_number&gt;</span></code></pre><p>在一行上键入完整的命令。为了清晰起见，此处使用多行。与执行命令一样<code class="codeph">SampleServer</code> ，如果命令太长而无法直接在命令窗口中键入，请将其放在.bat文件（Microsoft Windows）或.sh文件（Solaris，Linux和macOS）中，然后执行该文件。
                     </p>
                     <p>出现提示时，键入您的Kerberos用户名和密码。登录配置文件中指定的基础Kerberos身份验证机制将使您登录Kerberos。身份验证成功完成后， <code class="codeph">SampleClient</code>代码将代表您执行。它将请求与<code class="codeph">SampleServer</code> 。一旦<code class="codeph">SampleServer</code>接受连接， <code class="codeph">SampleClient</code>和<code class="codeph">SampleServer</code>建立共享上下文，然后按照本教程中的描述交换消息。
                     </p>
                     <p>有关登录故障排除的建议，请参阅<a href="troubleshooting.html#GUID-2087ADBA-6C36-43D5-8841-C79FCB4F5FBE">故障排除</a> 。
                     </p>
                  </div>
               </div>
            </div>
         </div>
      </article>
   

</body></html>