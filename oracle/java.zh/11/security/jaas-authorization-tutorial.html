<html lang="en-us"  xml:lang="en-us"><head></head><body >﻿
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>JAAS授权教程</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Security Developer’s Guide">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Security Developer’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="security-developer-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-09-21T08:42:26-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="1993, 2018">
      <meta name="dcterms.category" content="java">
      <meta name="dcterms.identifier" content="E94828-01">
      
      <meta name="dcterms.product" content="en/java/javase/11">
      <meta name="dcterms.release" content="11">
      <link rel="prev" href="jaas-authentication-tutorial.html" title="Previous" type="text/html">
      <link rel="next" href="java-authentication-and-authorization-service-jaas-loginmodule-developers-guide1.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"java","element_name":"Java","display_in_url":true},"suite":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product_group":{"short_name":"not-applicable","element_name":"Not Applicable","display_in_url":false},"product":{"short_name":"javase","element_name":"Java SE","display_in_url":true},"release":{"short_name":"11","element_name":"11","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Security Developer Guide">
    <meta name="dcterms.isVersionOf" content="SECURITY">
  <script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script>
   
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="jaas-authentication-tutorial.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>上一个</a> <a href="java-authentication-and-authorization-service-jaas-loginmodule-developers-guide1.html" class="pull-right">下一个<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a> <span class="fa fa-exclamation-triangle" aria-hidden="true"></span>必须启用JavaScript才能正确显示此内容</div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">安全开发人员指南</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="java-authentication-and-authorization-service-jaas1.html" property="item" typeof="WebPage"><span property="name">Java身份验证和授权服务（JAAS）</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="jaas-tutorials.html" property="item" typeof="WebPage"><span property="name">JAAS教程</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">JAAS授权教程</li>
            </ol>
            <a id="GUID-D43CF965-8A5F-4A23-A2AF-F41DD5F8B411" name="GUID-D43CF965-8A5F-4A23-A2AF-F41DD5F8B411"></a>
            
            <h2 id="JSSEC-GUID-D43CF965-8A5F-4A23-A2AF-F41DD5F8B411" class="sect2">JAAS授权教程</h2>
         </header>
         <div class="ind">
            <div>
               <p>本教程将扩展“ <a href="jaas-authentication-tutorial.html#GUID-BFEBDB00-9826-499C-A20F-E9463883DED4">JAAS身份验证教程”</a>教程中开发的程序和策略文件，以演示JAAS授权组件，该组件可确保经过身份验证的调用者具有进行后续安全敏感操作所需的访问控制权（权限）。由于授权组件要求首先完成用户认证，因此，如果尚未完成，请先阅读<a href="jaas-authentication-tutorial.html#GUID-BFEBDB00-9826-499C-A20F-E9463883DED4">JAAS认证教程</a>教程。
               </p>
               <p>本教程的其余部分包括以下部分：</p>
               <ul style="list-style-type:disc">
                  <li><a href="jaas-authorization-tutorial.html#GUID-AA85EDBD-7866-41CF-925F-6AA329C2E161">什么是JAAS授权？</a></li>
                  <li><a href="jaas-authorization-tutorial.html#GUID-0420D2C8-DF99-43FF-929E-D44564C64F57">JAAS授权如何执行？</a><ul style="list-style-type:disc">
                        <li><a href="jaas-authorization-tutorial.html#GUID-8BB38DE7-73AA-4560-AA28-D9CCE265AA78">您如何制作基于主体的策略文件语句？</a></li>
                        <li><a href="jaas-authorization-tutorial.html#GUID-BB640CDE-3EA5-4980-94F8-C821B98101FA">您如何将主题与访问控制上下文相关联？</a></li>
                     </ul>
                  </li>
                  <li><a href="jaas-authorization-tutorial.html#GUID-C1549AAE-E32F-449C-9A05-B175A5181EF8">授权教程代码</a></li>
                  <li><a href="jaas-authorization-tutorial.html#GUID-247D6204-446B-4B48-B376-5CD76CAFE3E7">JAAS授权教程的登录配置文件</a></li>
                  <li><a href="jaas-authorization-tutorial.html#GUID-8462E46D-FF67-4630-9A87-D24EE60D100C">政策档案</a></li>
                  <li><a href="jaas-authorization-tutorial.html#GUID-04A78ED2-B68C-4C89-849D-F9BF4F17BBD1">运行授权教程代码</a></li>
               </ul>
               <p>如果您希望首先看到实际使用的教程代码，则可以直接跳至“ <a href="jaas-authorization-tutorial.html#GUID-04A78ED2-B68C-4C89-849D-F9BF4F17BBD1">运行授权教程代码”</a> ，然后返回其他部分以了解更多信息。
               </p>
            </div>
            <div class="sect2"><a id="GUID-AA85EDBD-7866-41CF-925F-6AA329C2E161" name="GUID-AA85EDBD-7866-41CF-925F-6AA329C2E161"></a><h3 id="JSSEC-GUID-AA85EDBD-7866-41CF-925F-6AA329C2E161" class="sect3">什么是JAAS授权？</h3>
               <div>
                  <p>JAAS授权扩展了使用安全策略（请参阅“ <a href="permissions-jdk1.html#GUID-789089CA-8557-4017-B8B0-6899AD3BA18D">默认策略实现”和“策略文件语法”</a> ）来指定授予执行代码哪些访问权限的现有Java安全体系结构。这种架构是以<span class="variable" translate="no">code-centric</span> 。也就是说，根据代码特征授予权限：代码来自哪里，是否经过数字签名，以及是否由谁签名。我们在<code class="codeph">sampleacn.policy</code> <a href="jaas-authentication-tutorial.html#GUID-BFEBDB00-9826-499C-A20F-E9463883DED4">JAAS认证教程</a>教程中使用的文件。该文件包含以下内容：</p><pre class="pre codeblock"><code>grant codebase "file:./SampleAcn.jar" {

   permission javax.security.auth.AuthPermission 
                    "createLoginContext.Sample";
};
</code></pre><p>这会授予<code class="codeph">SampleAcn.jar</code>文件，位于当前目录中，具有指定的权限。（未指定签名者，因此代码是否签名都没有关系。）
                  </p>
                  <p>JAAS授权通过新<span class="variable" translate="no">user-centric</span>访问控制来扩展现有的以代码为<span class="variable" translate="no">user-centric</span>访问控制。权限可以不只是基于什么代码在运行，但也被授予<span class="variable" translate="no">who</span>正在运行它。
                  </p>
                  <p>当应用程序使用JAAS身份验证来验证用户（或其他实体，例如服务）时，将创建一个<a href="https://docs.oracle.com/javase/10/docs/api/javax/security/auth/Subject.html" target="_blank"><span class="apiname">Subject</span></a> 。<span class="apiname">主题</span>的目的是代表经过身份验证的用户。一个<span class="apiname">Subject</span>由一组<a href="https://docs.oracle.com/javase/10/docs/api/java/security/Principal.html" target="_blank"><span class="apiname">Principal组成</span></a> ，其中每个<span class="apiname">Principal</span>代表该用户的身份。例如，一个<span class="apiname">主题</span>可以有一个名字<span class="apiname">Principal</span> （“ Susan Smith”）和一个社会安全号码<span class="apiname">Principal</span> （“ 987-65-4321”），从而将该<span class="apiname">主题</span>与其他<span class="apiname">Subject</span>区分开。
                  </p>
                  <p>可以在策略中向特定<span class="apiname">Principal</span>授予权限。在对用户进行身份验证之后，应用程序可以将<span class="apiname">主题</span>与当前访问控制上下文相关联。对于随后的每个经过安全检查的操作（例如，本地文件访问），Java运行时将自动确定该策略是否仅向特定的<span class="apiname">Principal</span>授予所需的权限，如果是，则仅当<span class="apiname">Subject</span>与访问控制上下文包含指定的<span class="apiname">Principal</span> 。
                  </p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-0420D2C8-DF99-43FF-929E-D44564C64F57" name="GUID-0420D2C8-DF99-43FF-929E-D44564C64F57"></a><h3 id="JSSEC-GUID-0420D2C8-DF99-43FF-929E-D44564C64F57" class="sect3">JAAS授权如何执行？</h3>
               <div>
                  <p>要进行JAAS授权，需要满足以下条件：</p>
                  <ul style="list-style-type:disc">
                     <li>如<a href="jaas-authentication-tutorial.html#GUID-BFEBDB00-9826-499C-A20F-E9463883DED4">JAAS身份验证教程</a>教程中所述，必须对用户进行身份<a href="jaas-authentication-tutorial.html#GUID-BFEBDB00-9826-499C-A20F-E9463883DED4">验证</a> 。
                     </li>
                     <li>必须在安全策略中配置基于<span class="apiname">主体</span>的条目。请参阅<a href="jaas-authorization-tutorial.html#GUID-8BB38DE7-73AA-4560-AA28-D9CCE265AA78">如何制作基于主体的策略文件语句？</a></li>
                     <li>即认证必须与当前访问控制上下文相关联的结果的<span class="apiname">主题</span> ;请参阅<a href="jaas-authorization-tutorial.html#GUID-BB640CDE-3EA5-4980-94F8-C821B98101FA">如何将主题与访问控制上下文相关联？</a> 。
                     </li>
                  </ul>
               </div>
               <div class="sect3"><a id="GUID-8BB38DE7-73AA-4560-AA28-D9CCE265AA78" name="GUID-8BB38DE7-73AA-4560-AA28-D9CCE265AA78"></a><h4 id="JSSEC-GUID-8BB38DE7-73AA-4560-AA28-D9CCE265AA78" class="sect4">您如何制作基于主体的策略文件语句？</h4>
                  <div>
                     <p>政策文件<code class="codeph">grant</code>语句（请参阅<a href="permissions-jdk1.html#GUID-789089CA-8557-4017-B8B0-6899AD3BA18D">默认策略实施和策略文件语法</a> ，现在可以选择包含一个或多个<code class="codeph">Principal</code>领域。包含一个<code class="codeph">Principal</code>字段指示由指定的用户或其他实体表示<code class="codeph">Principal</code> ，执行指定的代码，具有指定的权限。
                     </p>
                     <p>因此， <code class="codeph">grant</code>声明现在</p><pre class="pre codeblock"><code>
grant &lt;<span class="variable" translate="no">signer(s) field</span>&gt;, &lt;<span class="variable" translate="no">codeBase URL</span>&gt; 
  &lt;<span class="variable" translate="no">Principal field(s)</span>&gt; {
    permission <span class="variable" translate="no">perm_class_name</span> "<span class="variable" translate="no">target_name</span>", "<span class="variable" translate="no">action</span>";
    ....
    permission <span class="variable" translate="no">perm_class_name</span> "<span class="variable" translate="no">target_name</span>", "<span class="variable" translate="no">action</span>";
  };
</code></pre><p>其中每个<code class="codeph">signer</code> ， <code class="codeph">codeBase</code>和<code class="codeph">Principal</code>字段是可选的，字段之间的顺序无关紧要。
                     </p>
                     <p>一种<code class="codeph">Principal</code>字段如下所示：</p><pre class="pre codeblock"><code>Principal <span class="variable" translate="no">Principal_class</span> "<span class="variable" translate="no">principal_name</span>"
</code></pre><p>就是这个词<code class="codeph">Principal</code> （大小写无关紧要）后跟一个（完全限定）名称<code class="codeph">Principal</code>类和主体名称。
                     </p>
                     <p>一种<code class="codeph">Principal</code> class是实现<a href="https://docs.oracle.com/javase/10/docs/api/java/security/Principal.html" target="_blank"><span class="apiname">java.security的类</span></a><a href="https://docs.oracle.com/javase/10/docs/api/java/security/Principal.html" target="_blank"><span class="apiname">。主</span></a>界面。所有<code class="codeph">Principal</code>对象具有关联的名称，可以通过调用它们的名称来获得<code class="codeph">getName</code>方法。名称使用的格式取决于每个<code class="codeph">Principal</code>实施。
                     </p>
                     <p>的类型<code class="codeph">Principal</code>放在<code class="codeph">Subject</code>由本教程使用的基本身份验证机制创建的是<code class="codeph">SamplePrincipal</code> ，因此应将其用作<code class="codeph"><span class="variable" translate="no">Principal_class</span></code>我们的一部分<code class="codeph">grant</code>声明的<code class="codeph">Principal</code>指定。的用户名<code class="codeph">SamplePrincipal</code>的格式为<span class="variable" translate="no">name</span> ，本教程接受的唯一用户名是<code class="codeph">testUser</code> ， 所以<code class="codeph"><span class="variable" translate="no">principal_name</span></code>指定用于<code class="codeph">grant</code>声明是<code class="codeph">testUser</code> 。
                     </p>
                     <p>可以包含多个<code class="codeph">Principal</code>在一个领域<code class="codeph">grant</code>声明。如果多个<code class="codeph">Principal</code>指定字段，然后在其中的权限<code class="codeph">grant</code>仅当<code class="codeph">Subject</code>与当前访问控制上下文相关联的<span class="variable" translate="no">all</span>那些<code class="codeph">Principal</code> s。
                     </p>
                     <p>将同一组权限授予不同的权限<code class="codeph">Principal</code> s，创建多个<code class="codeph">grant</code>语句，其中每个列出权限并包含一个<code class="codeph">Principal</code>字段指定<code class="codeph">Principal</code> s。
                     </p>
                     <p>本教程的策略文件包括一个<code class="codeph">grant</code>用一个语句<code class="codeph">Principal</code>领域：</p><pre class="pre codeblock"><code>grant codebase "file:./SampleAction.jar",
        Principal sample.principal.SamplePrincipal "testUser" {

   permission java.util.PropertyPermission "java.home", "read";
   permission java.util.PropertyPermission "user.home", "read";
   permission java.io.FilePermission "foo.txt", "read";
};
</code></pre><p>这指定将指示的权限授予指定的<code class="codeph">Principal</code>在执行代码<code class="codeph">SampleAction.jar</code> 。（注意： <code class="codeph">SamplePrincipal</code>班级在<code class="codeph">sample.principal</code>包。）
                     </p>
                  </div>
               </div>
               <div class="sect3"><a id="GUID-BB640CDE-3EA5-4980-94F8-C821B98101FA" name="GUID-BB640CDE-3EA5-4980-94F8-C821B98101FA"></a><h4 id="JSSEC-GUID-BB640CDE-3EA5-4980-94F8-C821B98101FA" class="sect4">您如何将主题与访问控制上下文相关联？</h4>
                  <div>
                     <p>若要创建主题并将其与当前访问控制上下文相关联，您需要以下内容：</p>
                     <ul style="list-style-type:disc">
                        <li>如<a href="jaas-authentication-tutorial.html#GUID-BFEBDB00-9826-499C-A20F-E9463883DED4">JAAS身份验证教程中</a>所述，必须首先对用户进行身份<a href="jaas-authentication-tutorial.html#GUID-BFEBDB00-9826-499C-A20F-E9463883DED4">验证</a> 。
                        </li>
                        <li>静态<code class="codeph">doAs</code>必须调用<span class="apiname">Subject</span>类中的方法，并向其传递经过身份验证的<span class="apiname">Subject</span>和<a href="https://docs.oracle.com/javase/10/docs/api/java/security/PrivilegedAction.html" target="_blank"><span class="apiname">java.security。PrivilegedAction</span></a>或<a href="https://docs.oracle.com/javase/10/docs/api/java/security/PrivilegedExceptionAction.html" target="_blank"><span class="apiname">java.security。PrivilegedExceptionAction</span></a> 。（有关PrivilegedAction和PrivilegedExceptionAction的比较，请参见<a href="permissions-jdk1.html#GUID-1E8E213A-D7F2-49F1-A2F0-EFB3397A8C95" title="A permission represents access to a system resource. In order for a resource access to be allowed for an applet (or an application running with a security manager), the corresponding permission must be explicitly granted to the code attempting the access.">JDK</a>中的<a href="java-se-platform-security-architecture.html#GUID-BB3C8FB3-1A1A-47F3-8536-3952B84F46F2" title="This section explains what privileged code is and what it is used for. It also shows you how to use the doPrivileged API.">附录A：</a> <a href="permissions-jdk1.html#GUID-1E8E213A-D7F2-49F1-A2F0-EFB3397A8C95" title="权限表示对系统资源的访问。为了允许对applet（或使用安全管理器运行的应用程序）进行资源访问，必须将相应的权限显式授予尝试访问的代码。">权限中</a> <a href="java-se-platform-security-architecture.html#GUID-BB3C8FB3-1A1A-47F3-8536-3952B84F46F2" title="本节说明什么是特权代码及其用途。它还显示了如何使用doPrivileged API。">特权块的API</a> 。）的<code class="codeph">doAs</code>方法将提供的Subject与当前访问控制上下文关联，然后调用<code class="codeph">run</code>从行动方法。的<code class="codeph">run</code>方法实现包含将作为指定的Subject执行的所有代码。因此，该动作将作为指定的主题执行。
                           <p>静态<code class="codeph">doAsPrivileged</code>可以调用Subject类中的方法代替<code class="codeph">doAs</code>方法，如本教程所述。除了传递给<code class="codeph">doAs</code> ， <code class="codeph">doAsPrivileged</code>需要第三个参数：AccessControlContext。不像<code class="codeph">doAs</code> ，它将提供的Subject与当前访问控制上下文相关联， <code class="codeph">doAsPrivileged</code>如果传入的参数为，则将Subject与提供的访问控制上下文或空访问控制上下文相关联<code class="codeph">null</code> ，就像本教程一样。有关这些方法的比较，请参见《 JAAS参考指南》中的<a href="java-authentication-and-authorization-service-jaas-reference-guide.html#GUID-2A935F5E-0803-411D-B6BC-F8C64D01A25C">doAs与doAsPrivileged</a> 。
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-C1549AAE-E32F-449C-9A05-B175A5181EF8" name="GUID-C1549AAE-E32F-449C-9A05-B175A5181EF8"></a><h3 id="JSSEC-GUID-C1549AAE-E32F-449C-9A05-B175A5181EF8" class="sect3">授权教程代码</h3>
               <div>
                  <p>本教程的代码包含四个文件：</p>
                  <ul style="list-style-type:disc">
                     <li><a href="jaas-authorization-tutorial.html#GUID-07EAB926-63EA-48F4-8DF0-4CC4526FA545__GUID-9AE66C05-0850-4AAF-8DD9-7D940069844F"><code>SampleAzn.java</code></a>与...完全相同<code class="codeph">SampleAcn.java</code> <a href="jaas-authentication-tutorial.html#GUID-BFEBDB00-9826-499C-A20F-E9463883DED4">JAAS Authentication Tutorial</a>教程中的应用程序文件，但调用所需的其他代码除外<code class="codeph">Subject.doAsPrivileged</code> 。
                     </li>
                     <li><a href="jaas-authorization-tutorial.html#GUID-6ECF7E31-E49D-4DF7-B9C9-1EB62EA32510__GUID-49785CE0-3D88-480B-8F76-F87E8AB890E1"><code>SampleAction.java</code></a>包含<code class="codeph">SampleAction</code>类。此类实现<span class="apiname">PrivilegedAction</span>并具有一个<code class="codeph">run</code>包含我们希望通过基于<span class="apiname">主体</span>的授权检查执行的所有代码的方法。
                     </li>
                     <li><a href="jaas-authentication-tutorial.html#GUID-03476CCA-11C6-4D51-B170-C8DD7C0D9075__GUID-F9A208EC-3247-4320-8158-82B0E84C6A04"><code>SampleLoginModule.java</code></a>是由教程的登录配置文件（请参阅<a href="jaas-authorization-tutorial.html#GUID-247D6204-446B-4B48-B376-5CD76CAFE3E7">JAAS授权教程的登录配置文件</a> ）指定的类，作为实现所需基础身份验证的类。 <code class="codeph">SampleLoginModule</code>的用户身份验证仅包含验证用户指定的名称和密码是否具有特定值。<a href="jaas-authentication-tutorial.html#GUID-BFEBDB00-9826-499C-A20F-E9463883DED4">JAAS认证教程</a>教程也使用了该类，这里不再赘述。
                     </li>
                     <li><a href="jaas-authentication-tutorial.html#GUID-03476CCA-11C6-4D51-B170-C8DD7C0D9075__GUID-3EA5533B-1284-481E-A35F-C82B17837F2E"><code>SamplePrincipal.java</code></a>是实现<a href="https://docs.oracle.com/javase/10/docs/api/java/security/Principal.html" target="_blank"><span class="apiname">java.security的样本类</span></a><a href="https://docs.oracle.com/javase/10/docs/api/java/security/Principal.html" target="_blank"><span class="apiname">。主</span></a>界面。它由<code class="codeph">SampleLoginModule</code> 。JAAS认证教程也使用了该类，这里不再赘述。
                     </li>
                  </ul>
                  <p>的<code class="codeph">SampleLoginModule.java</code>和<code class="codeph">SamplePrincipal.java</code> <a href="jaas-authentication-tutorial.html#GUID-BFEBDB00-9826-499C-A20F-E9463883DED4">JAAS Authentication Tutorial</a>教程中还使用了这些文件，因此此处不再赘述。其他源文件如下所述。
                  </p>
               </div>
               <div class="sect3"><a id="GUID-07EAB926-63EA-48F4-8DF0-4CC4526FA545" name="GUID-07EAB926-63EA-48F4-8DF0-4CC4526FA545"></a><h4 id="JSSEC-GUID-07EAB926-63EA-48F4-8DF0-4CC4526FA545" class="sect4">SampleAzn.java</h4>
                  <div>
                     <p>喜欢<code class="codeph">SampleAcn</code> ， <code class="codeph">SampleAzn</code>类实例化<span class="apiname">LoginContext</span> <code class="codeph">lc</code>并称之为<code class="codeph">login</code>执行身份验证的方法。如果成功，则通过调用<span class="apiname">LoginContext</span>的获取获得经过身份验证的<span class="apiname">Subject</span> （包括代表用户的<span class="apiname">SamplePrincipal</span> ）。 <code class="codeph">getSubject</code>方法：</p><pre class="pre codeblock"><code>Subject mySubject = lc.getSubject();
</code></pre><p>为用户提供有关<span class="apiname">主题</span>的一些信息，比如它<span class="apiname">的Principal</span>有，在后<code class="codeph">main</code>方法然后调用<code class="codeph">Subject.doAsPrivileged</code> ，并向其传递经过身份验证的<span class="apiname">主题</span> <code class="codeph">mySubject</code> ，一个<span class="apiname">PrivilegedAction</span> （ <code class="codeph">SampleAction</code> ）和一个<code class="codeph">null</code> <span class="apiname">AccessControlContext</span> ，如下所述。
                     </p>
                     <p>的<code class="codeph">SampleAction</code>该类通过以下方法实例化：</p><pre class="pre codeblock"><code>PrivilegedAction action = new SampleAction();
</code></pre><p>致电<code class="codeph">Subject.doAsPrivileged</code>通过以下方式执行：</p><pre class="pre codeblock"><code>Subject.doAsPrivileged(mySubject, action, null);
</code></pre><p>的<code class="codeph">doAsPrivileged</code>方法调用执行<code class="codeph">run</code> <span class="apiname">PrivilegedAction中的</span>方法<code class="codeph">action</code> （ <code class="codeph">SampleAction</code> ）以启动其余代码的执行，这些代码被视为代表<span class="apiname">主题</span>执行<code class="codeph">mySubject</code> 。
                     </p>
                     <p>通过<code class="codeph">null</code>作为<span class="apiname">AccessControlContext</span> （第三个）参数<code class="codeph">doAsPrivileged</code>表示<code class="codeph">mySubject</code>应该与一个新的空<span class="apiname">AccessControlContext</span>关联。结果是在执行期间执行安全检查<code class="codeph">SampleAction</code>只需要对<code class="codeph">SampleAction</code>代码本身（或它调用的其他代码），以<code class="codeph">mySubject</code> 。请注意， <code class="codeph">doAsPrivileged</code> （以及当时执行堆栈中的调用方<code class="codeph">doAsPrivileged</code>在执行操作时不需要任何权限。
                     </p>
                     <div class="section" id="GUID-07EAB926-63EA-48F4-8DF0-4CC4526FA545__GUID-9AE66C05-0850-4AAF-8DD9-7D940069844F">
                        <p class="subhead3" id="GUID-07EAB926-63EA-48F4-8DF0-4CC4526FA545__GUID-E7B90F8D-B7A8-4FDD-95A6-4D53B7D89EC2">SampleAzn.java</p><pre class="pre codeblock"><code>package sample;

import java.io.*;
import java.util.*;
import java.security.Principal;
import java.security.PrivilegedAction;
import javax.security.auth.*;
import javax.security.auth.callback.*;
import javax.security.auth.login.*;
import javax.security.auth.spi.*;
import com.sun.security.auth.*;

/**
 * This Sample application attempts to authenticate a user
 * and executes a SampleAction as that user.
 *
 * If the user successfully authenticates itself,
 * the username and number of Credentials is displayed.
 */
public class SampleAzn {

    /**
     * Attempt to authenticate the user.
     *
     * @param args input arguments for this application.  These are ignored.
     */
     public static void main(String[] args) {

        // Obtain a LoginContext, needed for authentication. Tell it
        // to use the LoginModule implementation specified by the
        // entry named "Sample" in the JAAS login configuration
        // file and to also use the specified CallbackHandler.
        LoginContext lc = null;
        try {
            lc = new LoginContext("Sample", new MyCallbackHandler());
        } catch (LoginException le) {
            System.err.println("Cannot create LoginContext. "
                + le.getMessage());
            System.exit(-1);
        } catch (SecurityException se) {
            System.err.println("Cannot create LoginContext. "
                + se.getMessage());
            System.exit(-1);
        }

        // the user has 3 attempts to authenticate successfully
        int i;
        for (i = 0; i &lt; 3; i++) {
            try {

                // attempt authentication
                lc.login();

                // if we return with no exception, authentication succeeded
                break;

            } catch (LoginException le) {

                  System.err.println("Authentication failed:");
                  System.err.println("  " + le.getMessage());
                  try {
                      Thread.currentThread().sleep(3000);
                  } catch (Exception e) {
                      // ignore
                  }

            }
        }

        // did they fail three times?
        if (i == 3) {
            System.out.println("Sorry");
            System.exit(-1);
        }

        System.out.println("Authentication succeeded!");

        Subject mySubject = lc.getSubject();

        // let's see what Principals we have
        Iterator principalIterator = mySubject.getPrincipals().iterator();
        System.out.println("Authenticated user has the following Principals:");
        while (principalIterator.hasNext()) {
            Principal p = (Principal)principalIterator.next();
            System.out.println("\t" + p.toString());
        }

        System.out.println("User has " +
                        mySubject.getPublicCredentials().size() +
                        " Public Credential(s)");

        // now try to execute the SampleAction as the authenticated Subject
        PrivilegedAction action = new SampleAction();
        Subject.doAsPrivileged(mySubject, action, null);

        System.exit(0);
    }
}

/**
 * A CallbackHandler implemented by the application.
 *
 * This application is text-based.  Therefore it displays information
 * to the user using the OutputStreams System.out and System.err,
 * and gathers input from the user using the InputStream System.in.
 */
class MyCallbackHandler implements CallbackHandler {

    /**
     * Invoke an array of Callbacks.
     *
     * @param callbacks an array of &lt;code&gt;Callback&lt;/code&gt; objects which contain
     *                  the information requested by an underlying security
     *                  service to be retrieved or displayed.
     *
     * @exception java.io.IOException if an input or output error occurs. &lt;p&gt;
     *
     * @exception UnsupportedCallbackException if the implementation of this
     *                  method does not support one or more of the Callbacks
     *                  specified in the &lt;code&gt;callbacks&lt;/code&gt; parameter.
     */
    public void handle(Callback[] callbacks)
    throws IOException, UnsupportedCallbackException {

        for (int i = 0; i &lt; callbacks.length; i++) {
            if (callbacks[i] instanceof TextOutputCallback) {

                // display the message according to the specified type
                TextOutputCallback toc = (TextOutputCallback)callbacks[i];
                switch (toc.getMessageType()) {
                case TextOutputCallback.INFORMATION:
                    System.out.println(toc.getMessage());
                    break;
                case TextOutputCallback.ERROR:
                    System.out.println("ERROR: " + toc.getMessage());
                    break;
                case TextOutputCallback.WARNING:
                    System.out.println("WARNING: " + toc.getMessage());
                    break;
                default:
                    throw new IOException("Unsupported message type: " +
                                        toc.getMessageType());
                }

            } else if (callbacks[i] instanceof NameCallback) {

                // prompt the user for a username
                NameCallback nc = (NameCallback)callbacks[i];

                System.err.print(nc.getPrompt());
                System.err.flush();
                nc.setName((new BufferedReader
                        (new InputStreamReader(System.in))).readLine());

            } else if (callbacks[i] instanceof PasswordCallback) {

                // prompt the user for sensitive information
                PasswordCallback pc = (PasswordCallback)callbacks[i];
                System.err.print(pc.getPrompt());
                System.err.flush();
                pc.setPassword(System.console().readPassword());

            } else {
                throw new UnsupportedCallbackException
                        (callbacks[i], "Unrecognized Callback");
            }
        }
    }
}
</code></pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-6ECF7E31-E49D-4DF7-B9C9-1EB62EA32510" name="GUID-6ECF7E31-E49D-4DF7-B9C9-1EB62EA32510"></a><h4 id="JSSEC-GUID-6ECF7E31-E49D-4DF7-B9C9-1EB62EA32510" class="sect4">SampleAction.java</h4>
                  <div>
                     <p><code>SampleAction.java</code>包含<code class="codeph">SampleAction</code>类。该类实现<code class="codeph">java.security.PrivilegedAction</code>并有一个<code class="codeph">run</code>包含我们要作为主题执行的所有代码的方法<code class="codeph">mySubject</code> 。在本教程中，我们将执行三个操作，除非已授予代码必需的权限，否则每个操作都无法完成。我们会：</p>
                     <ul style="list-style-type:disc">
                        <li>读取并打印<code class="codeph">java.home</code>系统属性，</li>
                        <li>读取并打印<code class="codeph">user.home</code>系统属性，以及</li>
                        <li>确定是否有一个名为<code class="codeph">foo.txt</code>存在于当前目录中。
                        </li>
                     </ul>
                     <p>这是代码：</p>
                     <div class="section" id="GUID-6ECF7E31-E49D-4DF7-B9C9-1EB62EA32510__GUID-49785CE0-3D88-480B-8F76-F87E8AB890E1">
                        <p class="subhead3" id="GUID-6ECF7E31-E49D-4DF7-B9C9-1EB62EA32510__GUID-6E60B96F-D3DC-4926-9220-9BBC4F2C8B8D">SampleAction.java</p><pre class="pre codeblock"><code>package sample;

import java.io.File;
import java.security.PrivilegedAction;

/**
 * This is a Sample PrivilegedAction implementation, designed to be
 * used with the Sample application.
 *
 */
public class <span class="bold">SampleAction</span> implements PrivilegedAction {

    /**
     * This Sample PrivilegedAction performs the following operations:
     * &lt;ul&gt;
     *   &lt;li&gt;Access the System property, &lt;i&gt;java.home&lt;/i&gt;&lt;/li&gt;
     *   &lt;li&gt; Access the System property, &lt;i&gt;user.home&lt;/i&gt;&lt;/li&gt;
     *   &lt;li&gt; Access the file, &lt;i&gt;foo.txt&lt;/i&gt;&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @return &lt;code&gt;null&lt;/code&gt; in all cases.
     *
     * @exception SecurityException if the caller does not have permission
     *          to perform the operations listed above.
     */
    public Object run() {
        System.out.println("\nYour java.home property: "
                            +System.getProperty("java.home"));

        System.out.println("\nYour user.home property: "
                            +System.getProperty("user.home"));

        File f = new File("foo.txt");
        System.out.print("\nfoo.txt does ");
        if (!f.exists())
            System.out.print("not ");
        System.out.println("exist in the current working directory.");
        return null;
    }
}
</code></pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
            <div class="sect2"><a id="GUID-247D6204-446B-4B48-B376-5CD76CAFE3E7" name="GUID-247D6204-446B-4B48-B376-5CD76CAFE3E7"></a><h3 id="JSSEC-GUID-247D6204-446B-4B48-B376-5CD76CAFE3E7" class="sect3">JAAS授权教程的登录配置文件</h3>
               <div>
                  <p>本教程使用的登录配置文件可以与<a href="jaas-authentication-tutorial.html#GUID-BFEBDB00-9826-499C-A20F-E9463883DED4">JAAS Authentication Tutorial</a>教程使用的登录配置文件完全相同。因此，我们可以使用<code>sample_jaas.config</code>文件，其中仅包含一项：</p><pre class="pre codeblock"><code><span class="bold">Sample {
  sample.module.SampleLoginModule required debug=true;
};</span>
</code></pre><p>该条目名为<code class="codeph">Sample</code>这就是我们两个教程应用程序的名称<code class="codeph">SampleAcn</code>和<code class="codeph">SampleAzn</code>用于引用它。该条目指定用于执行用户身份验证的<span class="apiname">LoginModule</span>是<code class="codeph">SampleLoginModule</code>在里面<code class="codeph">sample.module</code>包和这个<code class="codeph">SampleLoginModule</code>必须“成功”才能使认证成功。的<code class="codeph">SampleLoginModule</code>仅当用户提供的名称和密码与期望的名称和密码相同时，该命令才会成功（ <code class="codeph">testUser</code>和<code class="codeph">testPassword</code> ， 分别）。
                  </p>
                  <p><span class="apiname">SampleLoginModule</span>还定义了一个<code class="codeph">debug</code>可以设置为<code class="codeph">true</code>如图所示。如果此选项设置为<code class="codeph">true,</code> <span class="apiname">SampleLoginModule</span>输出有关身份验证进度的其他信息。
                  </p>
               </div>
            </div>
            <div class="sect2"><a id="GUID-8462E46D-FF67-4630-9A87-D24EE60D100C" name="GUID-8462E46D-FF67-4630-9A87-D24EE60D100C"></a><h3 id="JSSEC-GUID-8462E46D-FF67-4630-9A87-D24EE60D100C" class="sect3">政策档案</h3>
               <div>
                  <p>该授权教程的应用程序包含两个类， <code class="codeph">SampleAzn</code>和<code class="codeph">SampleAction</code> 。每个类中的代码都包含一些对安全性敏感的操作，因此在策略文件中需要相关的权限才能执行操作。
                  </p>
                  <p>本教程使用的<span class="apiname">LoginModule</span> ， <code class="codeph">SampleLoginModule</code> ，还包含需要许可的操作。
                  </p>
                  <p>这些类别中的每一个所需的权限将在下面描述，然后是完整的策略文件。</p>
               </div>
               <div class="sect3"><a id="GUID-B048635B-ACC3-4049-BFAA-16F047ABA415" name="GUID-B048635B-ACC3-4049-BFAA-16F047ABA415"></a><h4 id="JSSEC-GUID-B048635B-ACC3-4049-BFAA-16F047ABA415" class="sect4">SampleAzn所需的权限</h4>
                  <div>
                     <p>主要方法<code class="codeph">SampleAzn</code>类执行两个需要权限的操作。它</p>
                     <ul style="list-style-type:disc">
                        <li>创建一个<span class="apiname">LoginContext</span> ，并</li>
                        <li>称<code class="codeph">doAsPrivileged</code> Subject类的静态方法。
                        </li>
                     </ul>
                     <p><span class="apiname">LoginContext的</span>创建与身份验证教程中的创建完全相同，因此需要相同的内容<code class="codeph">javax.security.auth.AuthPermission</code>目标“ <code class="codeph">createLoginContext.Sample</code> ”。
                     </p>
                     <p>为了打电话<code class="codeph">doAsPrivileged</code> <span class="apiname">Subject</span>类的方法，您需要<code class="codeph">javax.security.auth.AuthPermission</code>目标为“ <code class="codeph">doAsPrivileged</code> ”。
                     </p>
                     <p>假设<code class="codeph">SampleAzn</code>类放置在名为的JAR文件中<code class="codeph">SampleAzn.jar</code> ，这些权限可以授予<code class="codeph">SampleAzn</code>通过以下代码<code class="codeph">grant</code>策略文件中的语句：</p><pre class="pre codeblock"><code>grant codebase "file:./SampleAzn.jar" {
   permission javax.security.auth.AuthPermission 
                    "createLoginContext.Sample";
   permission javax.security.auth.AuthPermission "doAsPrivileged";
};
</code></pre></div>
               </div>
               <div class="sect3"><a id="GUID-1C4609F2-96F3-4B8B-BFF4-1496301EA4B0" name="GUID-1C4609F2-96F3-4B8B-BFF4-1496301EA4B0"></a><h4 id="JSSEC-GUID-1C4609F2-96F3-4B8B-BFF4-1496301EA4B0" class="sect4">SampleAction所需的权限</h4>
                  <div>
                     <p>的<code class="codeph">SampleAction</code>代码执行需要权限的三个操作。它</p>
                     <ul style="list-style-type:disc">
                        <li>读取<code class="codeph">java.home</code>系统属性。
                        </li>
                        <li>读取<code class="codeph">user.home</code>系统属性。
                        </li>
                        <li>检查以查看是否有一个名为<code class="codeph">foo.txt</code>存在于当前目录中。
                        </li>
                     </ul>
                     <p>这些操作所需的权限如下：</p><pre class="pre codeblock"><code>permission java.util.PropertyPermission "java.home", "read";
permission java.util.PropertyPermission "user.home", "read";
permission java.io.FilePermission "foo.txt", "read";
</code></pre><p>我们需要向这些代码授予这些权限<code class="codeph">SampleAction.class</code> ，我们将其放置在一个名为<code class="codeph">SampleAction.jar</code> 。但是，对于此特定<code class="codeph">grant</code>语句，我们不仅要向<span class="variable" translate="no">code</span>授予权限，还要向执行代码的特定用户授予权限，以演示如何限制对特定用户的访问。
                     </p>
                     <p>因此，如<a href="jaas-authorization-tutorial.html#GUID-8BB38DE7-73AA-4560-AA28-D9CCE265AA78">您如何制作基于主体的策略文件语句中所述？</a> ， 我们的<code class="codeph">grant</code>语句如下所示：</p><pre class="pre codeblock"><code>grant codebase "file:./SampleAction.jar", Principal sample.principal.SamplePrincipal "testUser" {
    permission java.util.PropertyPermission "java.home", "read";
    permission java.util.PropertyPermission "user.home", "read";
    permission java.io.FilePermission "foo.txt", "read";
};
</code></pre></div>
               </div>
               <div class="sect3"><a id="GUID-C7890B53-2A4B-4024-8A67-23CAFC81C496" name="GUID-C7890B53-2A4B-4024-8A67-23CAFC81C496"></a><h4 id="JSSEC-GUID-C7890B53-2A4B-4024-8A67-23CAFC81C496" class="sect4">SampleLoginModule所需的权限</h4>
                  <div>
                     <p>的<code class="codeph">SampleLoginModule</code>代码执行一项需要权限的操作。它需要一个<code class="codeph">javax.security.auth.AuthPermission</code>目标为“ <code class="codeph">modifyPrincipals</code> ”以填充<code class="codeph">Subject</code>与一个<code class="codeph">Principal</code> 。Grant语句如下：</p><pre class="pre codeblock"><code>grant codebase "file:./SampleLM.jar" {
    permission javax.security.auth.AuthPermission "modifyPrincipals";
};
</code></pre></div>
               </div>
               <div class="sect3"><a id="GUID-3A2FF6CF-3124-4402-B550-D0F4E76B3D4D" name="GUID-3A2FF6CF-3124-4402-B550-D0F4E76B3D4D"></a><h4 id="JSSEC-GUID-3A2FF6CF-3124-4402-B550-D0F4E76B3D4D" class="sect4">完整的政策文件</h4>
                  <div>
                     <p>完整的政策文件是<code>sampleazn.policy</code> ：</p>
                     <div class="section" id="GUID-3A2FF6CF-3124-4402-B550-D0F4E76B3D4D__GUID-6CA8F774-5E38-437D-8549-9604DEC5C317">
                        <p class="subhead3" id="GUID-3A2FF6CF-3124-4402-B550-D0F4E76B3D4D__GUID-5DE97424-F333-4C05-94C8-F9348E0AA7B1">样本政策</p><pre class="pre codeblock"><code>/* grant the sample LoginModule permissions */

grant codebase "file:./SampleAction.jar", Principal sample.principal.SamplePrincipal "testUser" {
    permission java.util.PropertyPermission "java.home", "read";
    permission java.util.PropertyPermission "user.home", "read";
    permission java.io.FilePermission "foo.txt", "read";
};

grant codebase "file:./SampleLM.jar" {
    permission javax.security.auth.AuthPermission "modifyPrincipals";
};

grant codebase "file:./SampleAcn.jar" {
   permission javax.security.auth.AuthPermission "createLoginContext.Sample";
};</code></pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
               <div class="sect3"><a id="GUID-04A78ED2-B68C-4C89-849D-F9BF4F17BBD1" name="GUID-04A78ED2-B68C-4C89-849D-F9BF4F17BBD1"></a><h4 id="JSSEC-GUID-04A78ED2-B68C-4C89-849D-F9BF4F17BBD1" class="sect4">运行授权教程代码</h4>
                  <div>
                     <p>要执行我们的JAAS授权教程代码，您要做的就是</p>
                     <ol>
                        <li>
                           <p>将以下文件放入目录：</p>
                           <ul style="list-style-type:disc">
                              <li><code>sample_jaas.config</code>登录配置文件（请参阅<a href="jaas-authorization-tutorial.html#GUID-247D6204-446B-4B48-B376-5CD76CAFE3E7">“ JAAS授权教程”的“登录配置文件”</a> ）</li>
                              <li><a href="jaas-authorization-tutorial.html#GUID-3A2FF6CF-3124-4402-B550-D0F4E76B3D4D__GUID-6CA8F774-5E38-437D-8549-9604DEC5C317"><code>sampleazn.policy</code></a>政策文件</li>
                           </ul>
                        </li>
                        <li>
                           <p>创建一个名为的子目录<code>sample</code>该顶级目录的名称，然后将以下内容放入其中（请注意<code class="codeph">SampleAzn</code>和<code class="codeph">SampleAction</code>类在名为的包中<code class="codeph">sample</code> ）：</p> 
                           <ul style="list-style-type:disc">
                              <li><a href="jaas-authorization-tutorial.html#GUID-07EAB926-63EA-48F4-8DF0-4CC4526FA545__GUID-9AE66C05-0850-4AAF-8DD9-7D940069844F"><code>SampleAzn.java</code></a>源文件</li>
                              <li><a href="jaas-authorization-tutorial.html#GUID-6ECF7E31-E49D-4DF7-B9C9-1EB62EA32510__GUID-49785CE0-3D88-480B-8F76-F87E8AB890E1"><code>SampleAction.java</code></a>源文件</li>
                           </ul>
                        </li>
                        <li>
                           <p>创建一个子目录<code>sample</code>目录并命名<code>module</code> 。将以下内容放入其中（请注意<code class="codeph">SampleLoginModule</code>类在名为的包中<code class="codeph">sample.module</code> ）：</p> 
                           <ul style="list-style-type:disc">
                              <li><a href="jaas-authentication-tutorial.html#GUID-03476CCA-11C6-4D51-B170-C8DD7C0D9075__GUID-F9A208EC-3247-4320-8158-82B0E84C6A04"><code>SampleLoginModule.java</code></a>源文件</li>
                           </ul>
                        </li>
                        <li>
                           <p>创建另一个子目录<code>sample</code>目录并命名<code>principal</code> 。将以下内容放入其中（请注意<code class="codeph">SamplePrincipal</code>类在名为的包中<code class="codeph">sample.principal</code> ）：</p>
                           <ul style="list-style-type:disc">
                              <li><a href="jaas-authentication-tutorial.html#GUID-03476CCA-11C6-4D51-B170-C8DD7C0D9075__GUID-3EA5533B-1284-481E-A35F-C82B17837F2E"><code>SamplePrincipal.java</code></a>源文件</li>
                           </ul>
                        </li>
                        <li>
                           <p>在顶级目录中，编译所有源文件：</p>
                           <p><code class="codeph">javac sample/SampleAction.java sample/SampleAzn.java sample/module/SampleLoginModule.java sample/principal/SamplePrincipal.java</code></p>
                           <p>（在一行上键入所有内容。）</p>
                        </li>
                        <li>
                           <p>创建一个名为的JAR文件<code class="codeph">SampleAzn.jar</code>包含<code class="codeph">SampleAzn.class</code>和<code class="codeph">MyCallbackHandler.class</code> （请注意，这两个类的来源都在<code class="codeph">SampleAzn.java</code> ）：</p> 
                           <p><code class="codeph">jar -cvf SampleAzn.jar sample/SampleAzn.class sample/MyCallbackHandler.class</code></p>
                           <p>（在一行上键入所有内容。）</p>
                        </li>
                        <li>
                           <p>创建一个名为的JAR文件<code class="codeph">SampleAction.jar</code>包含<code class="codeph">SampleAction.class</code> ：</p>
                           <p><code class="codeph">jar -cvf SampleAction.jar sample/SampleAction.class</code></p>
                        </li>
                        <li>
                           <p>创建一个包含以下内容的JAR文件<code class="codeph">SampleLoginModule.class</code>和<code class="codeph">SamplePrincipal.class</code> ：</p>
                           <p><code class="codeph">jar -cvf SampleLM.jar sample/module/SampleLoginModule.class sample/principal/SamplePrincipal.class</code></p>
                        </li>
                        <li>
                           <p>执行<code class="codeph">SampleAzn</code>应用程序，指定</p> 
                           <ol type="a">
                              <li>通过适当的<code class="codeph">-classpath</code>子句，应该在<code class="codeph">SampleAzn.jar</code> ， <code class="codeph">SampleAction.jar</code>和<code class="codeph">SampleLM.jar</code> JAR文件，</li>
                              <li>通过<code class="codeph">-Djava.security.manager</code>应该安装安全管理器，</li>
                              <li>通过<code class="codeph">-Djava.security.policy==sampleazn.policy</code>要使用的策略文件是<code class="codeph">sampleazn.policy</code>和</li>
                              <li>通过<code class="codeph">-Djava.security.auth.login.config==sample_jaas.config</code>要使用的登录配置文件是<code class="codeph">sample_jaas.config</code> 。
                              </li>
                           </ol>
                           <p>以下是可用于Windows和Solaris，Linux和macOS系统的完整命令。唯一的区别是，在Windows系统上，您使用分号分隔类路径项，而在Solaris，Linux和macOS系统上，则为此使用冒号。</p>
                           <p>这是Windows系统的完整命令：</p><pre class="pre codeblock"><code>java -classpath SampleAzn.jar;SampleAction.jar;SampleLM.jar 
 -Djava.security.manager 
 -Djava.security.policy==sampleazn.policy 
 -Djava.security.auth.login.config==sample_jaas.config sample.SampleAzn
</code></pre><p>这是Solaris，Linux和macOS系统的完整命令：</p><pre class="pre codeblock"><code>java -classpath SampleAzn.jar:SampleAction.jar:SampleLM.jar 
 -Djava.security.manager 
 -Djava.security.policy==sampleazn.policy 
 -Djava.security.auth.login.config==sample_jaas.config sample.SampleAzn
</code></pre><p>在一行上键入完整的命令。为了清晰起见，此处使用多行。如果该命令对于您的系统而言太长，则可能需要将其放置在<code>.bat</code>文件（适用于Windows）或<code>.sh</code>文件（适用于Solaris，Linux和macOS），然后运行该文件以执行命令。
                           </p>
                           <p>系统将提示您输入用户名和密码（使用<code class="codeph">testUser</code>和<code class="codeph">testPassword</code> ），以及<code class="codeph">SampleLoginModule</code>在登录配置文件中指定的名称将检查名称和密码。如果登录成功，您将看到消息<code class="codeph">Authentication succeeded!</code>如果没有，您会看到<code class="codeph">Authentication failed:</code>其次是失败的原因。
                           </p>
                           <p>身份验证成功完成后，程序的其余部分（在<code class="codeph">SampleAction</code> ）将代表您（即用户）执行，要求您被授予适当的权限。的<code class="codeph">sampleazn.policy</code>策略文件为您授予了所需的权限，因此您将看到您的值的显示<code class="codeph">java.home</code>和<code class="codeph">user.home</code>系统属性以及关于您是否具有名为的文件的声明<code class="codeph">foo.txt</code>在当前目录中。
                           </p>
                        </li>
                     </ol>
                  </div>
               </div>
            </div>
         </div>
      </article>
   

</body></html>