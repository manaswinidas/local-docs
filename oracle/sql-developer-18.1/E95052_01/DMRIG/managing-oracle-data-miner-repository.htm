<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Managing the Oracle Data Miner Repository</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="description" content="This chapter explains how to use scripts to manage the Oracle Data Miner repository." />
<meta name="keywords" content="Data Miner, administration scripts, repository, determining the status and version of, ODMRSYS, backing up and restoring, full backup and restore, Oracle Data Pump, Oracle RMAN, workflows, backing up, ODMR$WORKFLOWS_BACKUP able, restoring from backup, migratebinaryodmr.sql, ASM, ODMRUSER role, locks, session, migrateodmr.sql, upgradeRepoWithNewTableSpace.sql, upgradeRepoFromORtoBinary.sql, XML, binary storage, object-relational storage, Oracle Automatic Segment Space Management, ASSM, dropping" />
<meta name="dcterms.created" content="2018-04-05T22:23:43Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Data Miner Installation and Administration Guide" />
<meta name="dcterms.identifier" content="E94761-02" />
<meta name="dcterms.isVersionOf" content="DMRIG" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2015, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Prev" href="managing-oracle-data-miner-users.htm" title="Previous" type="text/html" />
<link rel="Next" href="managing-system-resources-for-data-miner.htm" title="Next" type="text/html" />
<link rel="alternate" href="DMRIG.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script type="text/javascript" src="target.js"></script>
</head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-E2186C4D-E4C0-4904-B5DE-6DF7FDD5E38E"></a> <span id="PAGE" style="display:none;">8/13</span> <!-- End Header -->
<a id="DMRIG152"></a><a id="DMRIG151"></a>
<h1 id="DMRIG-GUID-E2186C4D-E4C0-4904-B5DE-6DF7FDD5E38E" class="sect1"><span class="enumeration_chapter">5</span> Managing the Oracle Data Miner Repository</h1>
<div><span>This chapter explains how to use scripts to manage the Oracle Data Miner repository.</span></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-81FAA81C-0BAD-45FF-9CF1-60DEA6AA2F39">About Oracle Data Miner Administration Scripts</a><br />
Oracle Data Miner includes a set of Structured Query Language (SQL) scripts for installing and managing the repository.</li>
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-8BD5129A-77D1-4AC7-9BA9-0044C5A2F02C">Setting the Path to Oracle Data Miner Scripts</a><br />
You can set the path to Oracle Data Miner scripts using SQL*Plus or SQL Developer Websheet.</li>
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-50051695-A1CD-48CF-8D9F-D8160034DF85">Determining the Status and Version of the Repository</a><br />
The version of the repository must be compatible with the version of the Oracle Data Miner client. If the client and server versions are not compatible, then the client cannot connect to the server.</li>
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-1FA0658C-157C-4B33-9892-F564DE2CCC65">Backing Up and Restoring the Repository</a><br />
Before upgrading the Oracle Data Miner repository or performing a database upgrade, you should perform a full backup of Oracle Data Miner, including <code class="codeph">ODMRSYS</code> and the Oracle Data Miner user schemas.</li>
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-66BA6F6B-2CA2-4D64-9856-60B8F8510F38">Migrating the Repository</a><br />
This section contains topics related to repository migration.</li>
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-517C1C26-63F9-4A21-AC4E-A21805FF09B7">Dropping the Repository</a><br />
The <code>dropRepositoryAndUserObjects</code> script drops the Oracle Data Miner repository and related objects in the users' schemas.</li>
</ul>
</div>
<a id="DMRIG213"></a>
<div class="props_rev_3"><a id="GUID-81FAA81C-0BAD-45FF-9CF1-60DEA6AA2F39"></a>
<h2 id="DMRIG-GUID-81FAA81C-0BAD-45FF-9CF1-60DEA6AA2F39" class="sect2">About Oracle Data Miner Administration Scripts</h2>
<div>
<p>Oracle Data Miner includes a set of Structured Query Language (SQL) scripts for installing and managing the repository.</p>
<p>The SQL scripts are installed with SQL Developer in the following directory:</p>
<p><code><span class="variable">SQL_Developer_Home</span>\sqldeveloper\dataminer\scripts</code></p>
<p>You can run the SQL scripts in SQL*Plus or in SQL Developer Worksheet. All the Oracle Data Miner scripts must be run with DBA privilege.</p>
<div class="infobox-note" id="GUID-81FAA81C-0BAD-45FF-9CF1-60DEA6AA2F39__GUID-284AAED1-ADFC-411F-BE35-8E11534C3704">
<p class="notep1">Note:</p>
<p>Many of the Oracle Data Miner scripts are integrated with SQL Developer, enabling access to some administrative functions through the Data Graphical User Interface.</p>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-8BD5129A-77D1-4AC7-9BA9-0044C5A2F02C"></a>
<h2 id="DMRIG-GUID-8BD5129A-77D1-4AC7-9BA9-0044C5A2F02C" class="sect2">Setting the Path to Oracle Data Miner Scripts</h2>
<div>
<p>You can set the path to Oracle Data Miner scripts using SQL*Plus or SQL Developer Websheet.</p>
<div class="section">
<p>To set the default search path for scripts:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="wintitle">SQL*Plus:</span> Start SQL*Plus from the <code>scripts</code> directory.</p>
<p><code><span class="variable">SQL_Developer_Home</span>\sqldeveloper\dataminer\scripts</code></p>
</li>
<li>
<p><span class="wintitle">SQL Developer Worksheet:</span> Set the default search path to the <code class="codeph">scripts</code> directory in the Worksheet properties.</p>
<p>Also in SQL Developer Worksheet properties, you must change the maximum number of rows to print in a script to 500000.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<a id="DMRIG186"></a>
<div class="props_rev_3"><a id="GUID-50051695-A1CD-48CF-8D9F-D8160034DF85"></a>
<h2 id="DMRIG-GUID-50051695-A1CD-48CF-8D9F-D8160034DF85" class="sect2">Determining the Status and Version of the Repository</h2>
<div>
<p>The version of the repository must be compatible with the version of the Oracle Data Miner client. If the client and server versions are not compatible, then the client cannot connect to the server.</p>
<div class="section">
<p>The following query returns the repository version and status:</p>
<pre dir="ltr">
set echo on;
-- value of VERSION and REPOSITORY_STATUS
SELECT property_name, property_str_value 
   FROM ODMRSYS.ODMR$REPOSITORY_PROPERTIES
   WHERE property_name IN ('VERSION','REPOSITORY_STATUS', 'WF_VERSION');
PROPERTY_NAME             PROPERTY_STR_VALUE
------------------------------ ------------------------------
REPOSITORY_STATUS         LOADED
VERSION                   12.1.0.2.3
WF_VERSION                12.1.0.2.3 
</pre>
<p>The Oracle Data Miner repository has two values for status: <code class="codeph">NOT_LOADED</code> and <code class="codeph">LOADED</code>.The status <code class="codeph">NOT_LOADED</code>, usually indicates that the Repository is being upgraded to support a new version of SQL Developer or a new patch release. When the upgrade completes, then the status is <code class="codeph">LOADED</code>.</p>
</div>
<!-- class="section" --></div>
</div>
<a id="DMRIG218"></a>
<div class="props_rev_3"><a id="GUID-1FA0658C-157C-4B33-9892-F564DE2CCC65"></a>
<h2 id="DMRIG-GUID-1FA0658C-157C-4B33-9892-F564DE2CCC65" class="sect2">Backing Up and Restoring the Repository</h2>
<div>
<p>Before upgrading the Oracle Data Miner repository or performing a database upgrade, you should perform a full backup of Oracle Data Miner, including <code class="codeph">ODMRSYS</code> and the Oracle Data Miner user schemas.</p>
<div class="section">
<p>Oracle Data Miner also provides scripts for backing up the workflow metadata in <code class="codeph">ODMRSYS</code> without including the user schemas.</p>
</div>
<!-- class="section" --></div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-AF839A56-580D-466B-B8BA-3BE85A24B08F">Full Backup and Restore</a><br />
For Oracle Databases 11.2.0.4 and later, you can perform a full backup and restore of the Oracle Data Miner repository and user schema independently of a full database backup.</li>
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-7291F7CA-36B6-4CC8-AACF-3856D5503B4E">Workflow Only Backup</a><br />
Oracle Data Miner provides a script for backing up the workflow metadata in the repository without including the objects in the users' schemas that are generated by the workflows.</li>
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-15A4E279-45E5-4AA3-866A-E77164B34AC7">Workflow Only Restore</a><br />
You can restore workflows from the backup table created by <code class="codeph">createxmlworkflowsbackup2.</code></li>
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-F3198B17-6802-48AD-BE25-4F30D8C007C6">Workflow Only Restore Examples</a><br />
This topic provides examples on selective workflow restore and full workflow restore.</li>
</ul>
<div class="relinfo">
<p><strong>Related Topics</strong></p>
<ul>
<li><a href="managing-oracle-data-miner-users.htm#GUID-D6347758-ED43-4E16-B804-7424F3864619" title="An Oracle Data Miner installation consists of one repository and at least one user account. The user must have access to the repository and have the privileges required for data mining activities in the database, and appropriate access to data.">About User Objects and Repository Objects</a></li>
<li><a href="oracle-data-miner-overview.htm#GUID-A7D92925-9CBB-40E6-A5BC-FF3E8375D266" title="Oracle Data Miner is an extension of Oracle SQL Developer, a graphical development environment for Oracle SQL.">Oracle Data Miner Architecture</a></li>
</ul>
</div>
</div>
<a id="DMRIG219"></a>
<div class="props_rev_3"><a id="GUID-AF839A56-580D-466B-B8BA-3BE85A24B08F"></a>
<h3 id="DMRIG-GUID-AF839A56-580D-466B-B8BA-3BE85A24B08F" class="sect3">Full Backup and Restore</h3>
<div>
<p>For Oracle Databases 11.2.0.4 and later, you can perform a full backup and restore of the Oracle Data Miner repository and user schema independently of a full database backup.</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-43E766E0-3494-4034-B9AB-BEB2EF68A22D">Full Backup and Restore in Database 11.2.0.4 and Later</a><br />
In Oracle Database 11.2.0.4 and later, the XML storage in the Oracle Data Miner repository is binary. In these databases, you can use Oracle Data Pump to back up and restore <code class="codeph">ODMRSYS</code> and the user schemas independently of a full backup and restore of the database.</li>
</ul>
</div>
<a id="DMRIG221"></a>
<div class="props_rev_3"><a id="GUID-43E766E0-3494-4034-B9AB-BEB2EF68A22D"></a>
<h4 id="DMRIG-GUID-43E766E0-3494-4034-B9AB-BEB2EF68A22D" class="sect4">Full Backup and Restore in Database 11.2.0.4 and Later</h4>
<div>
<p>In Oracle Database 11.2.0.4 and later, the XML storage in the Oracle Data Miner repository is binary. In these databases, you can use Oracle Data Pump to back up and restore <code class="codeph">ODMRSYS</code> and the user schemas independently of a full backup and restore of the database.</p>
<p>Using Oracle Data Pump, you can back up and restore individual schemas. Alternatively you can back up and restore Oracle Data Miner with Oracle RMAN.</p>
</div>
<div>
<div class="relinfo">
<p><strong>Related Topics</strong></p>
<ul>
<li><a class="olink SUTIL-GUID-17FAE261-0972-4220-A2E4-44D479F519D4" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E95052-01&amp;id=SUTIL-GUID-17FAE261-0972-4220-A2E4-44D479F519D4"><span><cite>Oracle Database Utilities</cite></span></a></li>
</ul>
</div>
</div>
</div>
</div>
<a id="DMRIG222"></a>
<div class="props_rev_3"><a id="GUID-7291F7CA-36B6-4CC8-AACF-3856D5503B4E"></a>
<h3 id="DMRIG-GUID-7291F7CA-36B6-4CC8-AACF-3856D5503B4E" class="sect3">Workflow Only Backup</h3>
<div>
<p>Oracle Data Miner provides a script for backing up the workflow metadata in the repository without including the objects in the users' schemas that are generated by the workflows.</p>
<div class="section">
<p>The simplified backup strategy safeguards the workflow specifications and enables you to restore a workflow if you accidentally delete it. After the workflow is restored, you must re-run it to ensure that all the supporting objects are present in the user's schema. The <code>creatxmlworkflowsbackup2</code> script backs up all the workflows in <code class="codeph">ODMRSYS</code> to a table called <code>ODMR$WORKFLOWS_BACKUP</code> in a separate backup account. Before you run the script, ensure that the backup schema exists and is available.</p>
<p><span class="bold">Syntax:</span></p>
<pre dir="ltr">
createxmlworkflowsbackup2.sql <span class="variable">backup_account</span>
</pre>
<p>Parameter:</p>
<p><cite><code class="codeph">backup_account</code></cite> is the name of the schema of the backup table, <code>ODMR$WORKFLOWS_BACKUP</code>.</p>
<p>This example backs up the workflows in a backup account called <code class="codeph">BACKUPACCT</code>:</p>
<pre dir="ltr">
set serveroutput on
@createxmlworkflowsbackup2l BACKUPACCT
</pre>
<div class="infobox-note" id="GUID-7291F7CA-36B6-4CC8-AACF-3856D5503B4E__GUID-A416FA85-E9C2-45A8-9BE5-F452AD76DFB7">
<p class="notep1">Note:</p>
<p>The <code>dropRepositoryAndUserObjects</code> script drops all the backup tables when it drops the repository. If you run the <code>dropRepositoryAndUserObjects</code> script to drop the repository, then all the workflow backups are lost.</p>
</div>
<p>Each time you run <code>createxmlworkflowsbackup2</code>, a full set of workflows is added to the backup table. The backup script maintains up to 30 distinct backups within the backup table. Older backups are automatically deleted. For example, if the backup was run each day, then a user has up to 30 days to request a restore of a workflow.</p>
<p>In the backup script, the <code>DEFINE_MAX_VERSIONS</code> specifies the number of backups that are preserved in the backup table. If you want to preserve more than 30 backups, then in the backup script <code>createxmlworkflowsbackup2</code>, change the value of <code>DEFINE_MAX_VERSIONS</code> to the desired number.</p>
</div>
<!-- class="section" --></div>
<div>
<div class="relinfo">
<p><strong>Related Topics</strong></p>
<ul>
<li><a href="managing-oracle-data-miner-repository.htm#GUID-517C1C26-63F9-4A21-AC4E-A21805FF09B7" title="The dropRepositoryAndUserObjects script drops the Oracle Data Miner repository and related objects in the users' schemas.">Dropping the Repository</a></li>
</ul>
</div>
</div>
</div>
<a id="DMRIG223"></a>
<div class="props_rev_3"><a id="GUID-15A4E279-45E5-4AA3-866A-E77164B34AC7"></a>
<h3 id="DMRIG-GUID-15A4E279-45E5-4AA3-866A-E77164B34AC7" class="sect3">Workflow Only Restore</h3>
<div>
<p>You can restore workflows from the backup table created by <code class="codeph">createxmlworkflowsbackup2.</code></p>
<div class="section">
<p>To restore the workflows from the backup table created by <code>createxmlworkflowsbackup2</code>, run the <code>restorexmlworkflowfrombackup2</code> script.</p>
<p><code>restorexmlworkflowfrombackup2.sql</code> restore workflows from the backup table to the Oracle Data Miner repository. Use it as follows:</p>
<p>Syntax:</p>
<pre dir="ltr">
restorexmlworkflowfrombackup2.sql [<span class="variable">option</span>] [<span class="variable">backup_account</span>] [<span class="variable">workflow_definition</span>]
</pre>
<p>Parameters:</p>
<p><kbd class="userinput">option</kbd> is an optional parameter that can have one of the following values:</p>
</div>
<!-- class="section" -->
<div class="section">
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">ADD_ONLY</code> &mdash; Restore workflows that do not already exist in the repository, creating missing projects if necessary. (Default)</p>
</li>
<li>
<p><code class="codeph">DROP_AND_ADD</code> &mdash; Drop all existing workflows and projects in the repository, then restore all workflows from backup, creating missing projects if necessary.</p>
</li>
<li>
<p><code class="codeph">OVERRIDE_ONLY</code> &mdash; Only restore workflows that already exist in the repository.</p>
</li>
<li>
<p><code class="codeph">OVERRIDE_AND_ADD</code> &mdash; Applies both the <code class="codeph">OVERRIDE_ONLY</code> and <code class="codeph">ADD_ONLY</code> options.</p>
</li>
</ul>
<p><cite><code class="codeph">backup_account</code></cite> is optional unless <cite><code class="codeph">workflow_definition</code></cite> is specified, in which case it is required. If no backup account is specified, then workflows are restored from the backup table in the repository. If the backup tables does not exist, then an exception is raised.</p>
<p><cite><code class="codeph">workflow_definition</code></cite> is an optional parameter that identifies a table or view that specifies which workflows to restore from backup. The table or view must contain these four columns: <code class="codeph">USER_NAME</code>, <code class="codeph">PROJECT_NAME</code>, <code class="codeph">WORKFLOW_NAME</code>, and <code class="codeph">VERSION</code>. Each row in the table identifies a workflow to restore. If the <code class="codeph">VERSION</code> number is null, then the latest version number is used for the restore. When no workflow definition is provided, then the latest backup version is the default</p>
<p>Example:</p>
<p>This example drops all the workflows in the repository and restores the workflows from the backup table in <code class="codeph">BACKUPACCT.</code></p>
<pre dir="ltr">
set serverput on
@restorexmlworkflowfrombackup2 DROP_AND_ADD BACKUPACCT
</pre></div>
<!-- class="section" --></div>
<div>
<div class="relinfo">
<p><strong>Related Topics</strong></p>
<ul>
<li><a href="managing-oracle-data-miner-repository.htm#GUID-7291F7CA-36B6-4CC8-AACF-3856D5503B4E" title="Oracle Data Miner provides a script for backing up the workflow metadata in the repository without including the objects in the users' schemas that are generated by the workflows.">Workflow Only Backup</a></li>
</ul>
</div>
</div>
</div>
<a id="DMRIG250"></a><a id="DMRIG251"></a><a id="DMRIG249"></a>
<div class="props_rev_3"><a id="GUID-F3198B17-6802-48AD-BE25-4F30D8C007C6"></a>
<h3 id="DMRIG-GUID-F3198B17-6802-48AD-BE25-4F30D8C007C6" class="sect3">Workflow Only Restore Examples</h3>
<div>
<p>This topic provides examples on selective workflow restore and full workflow restore.</p>
<div class="example" id="GUID-F3198B17-6802-48AD-BE25-4F30D8C007C6__GUID-90112C00-430E-4DD4-A162-27C9A0859FDF">
<p class="titleinexample">Example 5-1 Selective Workflow Restore</p>
<p>Let us assume the user <code class="codeph">SCOTT</code> had accidentally deleted all his workflows last week. You can use the <code>ADD_ONLY</code> option to restore his workflows. You will have to query the backup table to determine which version of backups contain his missing workflows. If the version is 12, then the following script example, run with DBA privilege, will reload only those workflows.</p>
<pre dir="ltr">
@restorexmlworkflowfrombackup2.sql ADD_ONLY BACKUPACCT BACKUPACCT.WORKFLOW_V
</pre>
<p>The <code class="codeph">WORKFLOW_V</code> view, shown as follows, selects all the workflows present for the user <code class="codeph">SCOTT</code> from a specified version backup number.</p>
<pre dir="ltr">
CREATE VIEW BACKUPACCT.WORKFLOW_V AS 
       SELECT user_name, project_name, workflow_name, version
       FROM backupacct.odmr$workflows_backup 
       WHERE user_name='SCOTT' AND version = 12;
</pre></div>
<!-- class="example" -->
<div class="example" id="GUID-F3198B17-6802-48AD-BE25-4F30D8C007C6__GUID-FA4053D2-AAC9-4ED9-92B7-E12C49CE22B8">
<p class="titleinexample">Example 5-2 Full Workflow Restore</p>
<p>Let us assume that there was some critical repository failure that requires a full reload of all workflows from the latest backup. You can use the <code>DROP_AND_ADD</code> option to insure that all the old workflows are dropped and all the workflows on the backup are reloaded. In this case, the backup table is located in another account separate from the <code class="codeph">ODMRSYS</code> account. The latest backup version will be used for the recovery, so no workflow definition parameter is required.</p>
<pre dir="ltr">
@restorexmlworkflowfrombackup2.sql DROP_AND_ADD BACKUPACCT
</pre></div>
<!-- class="example" --></div>
</div>
</div>
<div class="sect2"><a id="GUID-66BA6F6B-2CA2-4D64-9856-60B8F8510F38"></a>
<h2 id="DMRIG-GUID-66BA6F6B-2CA2-4D64-9856-60B8F8510F38" class="sect2">Migrating the Repository</h2>
<div>
<p>This section contains topics related to repository migration.</p>
<p>Topics include:</p>
</div>
<div>
<ul class="ullinks">
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-F0573D3C-E47C-4E09-B783-175FE4CEBDD9">Upgrading ODMRSYS</a><br />
The <code>migratebinaryodmr</code> script upgrades the workflow data in an <code class="codeph">ODMRSYS</code> schema that uses binary XML storage. The <code class="codeph">ODMRSYS</code> tablespace is an Oracle Automatic Segment Space Management (ASSM) tablespace.</li>
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-49AA0AA6-022A-4626-A0F9-C31921807332">Scripts to Migrate the Repository</a><br />
Starting with SQL Developer 4.0, Oracle Data Miner migration scripts are available for specific upgrade paths.</li>
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-12F71FAA-27CF-4F4F-B9C1-DFCC31CD8F69">Upgrading New ODMRSYS Tablespace From Object-Relational to Binary</a><br />
The <code>upgradeRepoWithNewTableSpace</code> script upgrades the specified tablespace from object-relational to binary XML storage and migrates the workflow data in <code class="codeph">ODMRSYS</code> to the newt tablespace. The new tablespace must be an Oracle Automatic Segment Space Management (Oracle ASSM) tablespace.</li>
<li class="ulchildlink"><a href="managing-oracle-data-miner-repository.htm#GUID-14F2E094-6452-4FD3-90EB-96D80F74DDEF">Upgrading ODMRSYS From Object-Relational to Binary</a><br />
The <code>upgradeRepoFromORtoBinary</code> script migrates the <code class="codeph">ODMRSYS</code> workflow data from object-relational XML storage to binary XML storage. The upgraded <code class="codeph">ODMRSYS</code> tablespace is an Oracle Automatic Segment Space Management (ASSM) tablespace.</li>
</ul>
</div>
<div class="props_rev_3"><a id="GUID-F0573D3C-E47C-4E09-B783-175FE4CEBDD9"></a>
<h3 id="DMRIG-GUID-F0573D3C-E47C-4E09-B783-175FE4CEBDD9" class="sect3">Upgrading ODMRSYS</h3>
<div>
<p>The <code>migratebinaryodmr</code> script upgrades the workflow data in an <code class="codeph">ODMRSYS</code> schema that uses binary XML storage. The <code class="codeph">ODMRSYS</code> tablespace is an Oracle Automatic Segment Space Management (ASSM) tablespace.</p>
<div class="section">
<p>If any sessions that have the <code class="codeph">ODMRUSER</code> role are currently running, then the session object locks block the upgrade.You can use the <code>session_disconnect</code> parameter to disconnect any active sessions, thus enabling the upgrade process to proceed.</p>
<p>Syntax:</p>
<pre dir="ltr">
@migratebinaryodmr.sql <span class="variable">session_disconnect</span>
</pre>
<p>Parameters:</p>
<p><code>session_disconnect</code> can have one of the following values:</p>
<p><code>R</code> &mdash; Report active sessions. Do not disconnect them.</p>
<p><code>D</code> &mdash; Disconnect active sessions. Do not report them.</p>
<p><code>DR</code> or <code>RD</code> &mdash; Disconnect and report active sessions.</p>
<p>Example:</p>
<p>This example upgrades the binary XML workflow data in <code class="codeph">ODMRSYS</code>, disconnecting and reporting any active <code class="codeph">ODMRUSER</code> sessions.</p>
<pre dir="ltr">
@migratebinaryodmr DR
</pre></div>
<!-- class="section" --></div>
</div>
<div class="sect3"><a id="GUID-49AA0AA6-022A-4626-A0F9-C31921807332"></a>
<h3 id="DMRIG-GUID-49AA0AA6-022A-4626-A0F9-C31921807332" class="sect3">Scripts to Migrate the Repository</h3>
<div>
<p>Starting with SQL Developer 4.0, Oracle Data Miner migration scripts are available for specific upgrade paths.</p>
<div class="section">
<div class="p">
<div class="tblformalwide" id="GUID-49AA0AA6-022A-4626-A0F9-C31921807332__GUID-CC90D438-0CFD-49F8-BCEF-553EDE39E940">
<p class="titleintable">Table 5-1 Oracle Data Miner Upgrade Scripts</p>
<table class="cellalignment136" title="Oracle Data Miner Upgrade Scripts" summary="The table lists the scripts to upgrade Oracle Data Miner repository from an earlier version to the current version. All workflows are preserved during the upgrade.">
<thead>
<tr class="cellalignment108">
<th class="cellalignment175" id="d7600e1235">SQL Developer Version</th>
<th class="cellalignment175" id="d7600e1237">Database Version</th>
<th class="cellalignment175" id="d7600e1239">Script</th>
<th class="cellalignment175" id="d7600e1241">Description</th>
</tr>
</thead>
<tbody>
<tr class="cellalignment108">
<td class="cellalignment108" id="d7600e1245" headers="d7600e1235">4.0 and later</td>
<td class="cellalignment108" headers="d7600e1245 d7600e1237">11.2.0.4 and later</td>
<td class="cellalignment108" headers="d7600e1245 d7600e1239"><code class="codeph">migratebinaryodmr.sql</code></td>
<td class="cellalignment108" headers="d7600e1245 d7600e1241">Relevant for future releases, when XML conversion from object storage to binary storage will no longer needed.</td>
</tr>
<tr class="cellalignment108">
<td class="cellalignment108" id="d7600e1255" headers="d7600e1235">4.0 and later</td>
<td class="cellalignment108" headers="d7600e1255 d7600e1237">11.2.0.3 or earlier originally, and then the database was upgraded to 11.2.0.4 or later</td>
<td class="cellalignment108" headers="d7600e1255 d7600e1239"><code class="codeph">upgradeRepoWithNewTableSpace.sql</code> or <code class="codeph">upgradeRepoFromORtoBinary.sql</code></td>
<td class="cellalignment108" headers="d7600e1255 d7600e1241">Since the database can be upgraded independently of the Oracle Data Miner repository, this has to be taken into account. The choice of scripts will depend on whether <code class="codeph">ODMRSYS</code> tablespace is ASSM or not.</td>
</tr>
<tr class="cellalignment108">
<td class="cellalignment108" id="d7600e1271" headers="d7600e1235">3.2.2 or earlier</td>
<td class="cellalignment108" headers="d7600e1271 d7600e1237">11.2.0.4 and later, where the default <code class="codeph">ODMRSYS</code> tablespace is not ASSM-based</td>
<td class="cellalignment108" headers="d7600e1271 d7600e1239"><code class="codeph">upgradeRepoWithNewTableSpace.sql</code></td>
<td class="cellalignment108" headers="d7600e1271 d7600e1241">ASSM tablespace required as input parameter. This will be used to migrate the workflow data from XML object storage to XML binary storage.</td>
</tr>
<tr class="cellalignment108">
<td class="cellalignment108" id="d7600e1284" headers="d7600e1235">
<p>3.2.2 or earlier</p>
</td>
<td class="cellalignment108" headers="d7600e1284 d7600e1237">
<p>11.2.0.4 and later, where the default <code class="codeph">ODMRSYS</code> tablespace is ASSM-based</p>
</td>
<td class="cellalignment108" headers="d7600e1284 d7600e1239"><code class="codeph">upgradeRepoFromORtoBinary.sql</code></td>
<td class="cellalignment108" headers="d7600e1284 d7600e1241">Workflow data will be migrated from XML object storage to XML binary storage.</td>
</tr>
</tbody>
</table>
</div>
<!-- class="inftblhruleinformal" --></div>
</div>
<!-- class="section" --></div>
</div>
<div class="props_rev_3"><a id="GUID-12F71FAA-27CF-4F4F-B9C1-DFCC31CD8F69"></a>
<h3 id="DMRIG-GUID-12F71FAA-27CF-4F4F-B9C1-DFCC31CD8F69" class="sect3">Upgrading New ODMRSYS Tablespace From Object-Relational to Binary</h3>
<div>
<p>The <code>upgradeRepoWithNewTableSpace</code> script upgrades the specified tablespace from object-relational to binary XML storage and migrates the workflow data in <code class="codeph">ODMRSYS</code> to the newt tablespace. The new tablespace must be an Oracle Automatic Segment Space Management (Oracle ASSM) tablespace.</p>
<div class="section">
<p>If any sessions that have the <code class="codeph">ODMRUSER</code> role are currently running, then the session object locks block the upgrade. You can use the <code>session_disconnect</code> parameter to disconnect any active sessions, thus enabling the upgrade process to proceed.</p>
<p>Syntax:</p>
<pre dir="ltr">
upgradeRepoWithNewTableSpace.sql <span class="variable">ASSMtablespace</span> <span class="variable">session_disconnect</span>
</pre>
<p><span class="bold">Parameters</span>:</p>
<p><code>ASSMtablespace</code> is the name of an ASSM tablespace.</p>
<p><code>session_disconnect</code> can have one of the following values:</p>
<p><code>R</code> &mdash; Report active sessions. Do not disconnect them.</p>
<p><code>D</code> &mdash; Disconnect active sessions. Do not report them.</p>
<p><code>DR</code> or <code>RD</code> &mdash; Disconnect and report active sessions.</p>
<p><span class="bold">Example</span>:</p>
<p>This example migrates object-relational XML data in <code class="codeph">ODMRSYS</code> to the new ASSM tablespace, <code class="codeph">my_ASSM_space</code>, that uses binary XML storage. If any <code class="codeph">ODMRUSER</code> sessions are active, they are disconnected and reported.</p>
<pre dir="ltr">
@upgradeRepoWithNewTableSpace my_ASSM_space DR
</pre></div>
<!-- class="section" --></div>
<div>
<div class="relinfo">
<p><strong>Related Topics</strong></p>
<ul>
<li><a class="olink ADMIN-GUID-1C162C60-6698-44F2-B2A9-F3E2D2958D88" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E95052-01&amp;id=ADMIN-GUID-1C162C60-6698-44F2-B2A9-F3E2D2958D88"><span><cite>Oracle Database Administrator&rsquo;s Guide</cite></span></a></li>
</ul>
</div>
</div>
</div>
<div class="props_rev_3"><a id="GUID-14F2E094-6452-4FD3-90EB-96D80F74DDEF"></a>
<h3 id="DMRIG-GUID-14F2E094-6452-4FD3-90EB-96D80F74DDEF" class="sect3">Upgrading ODMRSYS From Object-Relational to Binary</h3>
<div>
<p>The <code>upgradeRepoFromORtoBinary</code> script migrates the <code class="codeph">ODMRSYS</code> workflow data from object-relational XML storage to binary XML storage. The upgraded <code class="codeph">ODMRSYS</code> tablespace is an Oracle Automatic Segment Space Management (ASSM) tablespace.</p>
<div class="section">
<p>If any sessions that have the <code class="codeph">ODMRUSER</code> role are currently running, then the session object locks block the upgrade.You can use the <code>session_disconnect</code> parameter to disconnect any active sessions, thus enabling the upgrade process to proceed.</p>
<p>Syntax:</p>
<pre dir="ltr">
@upgradeRepoFromORtoBinary.sql <span class="variable">session_disconnect</span>
</pre>
<p>Parameters:</p>
<p><code>session_disconnect</code> can have one of the following values:</p>
<p><code>R</code> &mdash; Report active sessions. Do not disconnect them.</p>
<p><code>D</code> &mdash; Disconnect active sessions. Do not report them.</p>
<p><code>DR</code> or <code>RD</code> &mdash; Disconnect and report active sessions.</p>
<p>Example:</p>
<p>This example upgrades <code class="codeph">ODMRSYS</code> from object-relational XML storage to binary XML storage. The upgraded tablespace is ASSM-based. If any <code class="codeph">ODMRUSER</code> sessions are active, they are disconnected and reported.</p>
<pre dir="ltr">
@upgradeRepoFromORtoBinary DR
</pre></div>
<!-- class="section" --></div>
<div>
<div class="relinfo">
<p><strong>Related Topics</strong></p>
<ul>
<li><a class="olink OSTMG-GUID-B20F761E-5217-4F49-BCB8-D200EEE5B51E" target="_blank" href="http://www.oracle.com/pls/topic/lookup?ctx=E95052-01&amp;id=OSTMG-GUID-B20F761E-5217-4F49-BCB8-D200EEE5B51E"><span><cite>Oracle Automatic Storage Management Administrator's Guide</cite></span></a></li>
</ul>
</div>
</div>
</div>
</div>
<a id="DMRIG182"></a>
<div class="props_rev_3"><a id="GUID-517C1C26-63F9-4A21-AC4E-A21805FF09B7"></a>
<h2 id="DMRIG-GUID-517C1C26-63F9-4A21-AC4E-A21805FF09B7" class="sect2">Dropping the Repository</h2>
<div>
<p>The <code>dropRepositoryAndUserObjects</code> script drops the Oracle Data Miner repository and related objects in the users' schemas.</p>
<div class="section">
<p>If any sessions that have the <code class="codeph">ODMRUSER</code> role are currently running, then the session object locks block the upgrade. You can use the <code>session_disconnect</code> parameter to disconnect any active sessions, thus enabling the upgrade process to proceed.</p>
<p>Syntax:</p>
<pre dir="ltr">
dropRepositoryAndUserObjects.sql <span class="variable">session_disconnect</span>
</pre>
<p>Parameters:</p>
<p><code>session_disconnect</code> can have one of the following values:</p>
<p><code>R</code> &mdash; Report active sessions. Do not disconnect them.</p>
<p><code>D</code> &mdash; Disconnect active sessions. Do not report them.</p>
<p><code>DR</code> or <code>RD</code> &mdash; Disconnect and report active sessions.</p>
<p>Example:</p>
<p>This example drops the <code class="codeph">ODMRSYS</code>, schema and related objects in the Oracle Data Miner users' schemas, disconnecting and reporting any active <code class="codeph">ODMRUSER</code> sessions.</p>
<pre dir="ltr">
@dropRepositoryAndUserObjects DR
</pre></div>
<!-- class="section" --></div>
<div>
<div class="relinfo">
<p><strong>Related Topics</strong></p>
<ul>
<li><a href="managing-oracle-data-miner-users.htm#GUID-D6347758-ED43-4E16-B804-7424F3864619" title="An Oracle Data Miner installation consists of one repository and at least one user account. The user must have access to the repository and have the privileges required for data mining activities in the database, and appropriate access to data.">About User Objects and Repository Objects</a></li>
<li><a href="oracle-data-miner-overview.htm#GUID-A7D92925-9CBB-40E6-A5BC-FF3E8375D266" title="Oracle Data Miner is an extension of Oracle SQL Developer, a graphical development environment for Oracle SQL.">Oracle Data Miner Architecture</a></li>
<li><a href="managing-oracle-data-miner-repository.htm#GUID-7291F7CA-36B6-4CC8-AACF-3856D5503B4E" title="Oracle Data Miner provides a script for backing up the workflow metadata in the repository without including the objects in the users' schemas that are generated by the workflows.">Workflow Only Backup</a></li>
</ul>
</div>
</div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment107">
<tr>
<td class="cellalignment127">
<table class="cellalignment112">
<tr>
<td class="cellalignment111"><a href="managing-oracle-data-miner-users.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment111"><a href="managing-system-resources-for-data-miner.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2015, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment129">
<table class="cellalignment110">
<tr>
<td class="cellalignment111"><a href="../index.htm"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment111"><a href="../nav/portal_booklist.htm"><img width="24" height="24" src="../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td class="cellalignment111"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment111"><a href="index.htm"><img width="24" height="24" src="../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td class="cellalignment111"><a href="../nav/mindx.htm"><img width="24" height="24" src="../dcommon/gifs/masterix.gif" alt="Go to Master Index" /><br />
<span class="icon">Master Index</span></a></td>
<td class="cellalignment111"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
