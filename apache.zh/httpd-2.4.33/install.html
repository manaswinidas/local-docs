<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type">
<title>编译和安装-Apache HTTP Server版本2.4</title>
<link href="./style/css/manual-zip.css" rel="stylesheet" type="text/css" title="Main stylesheet" media="all">
<link href="./style/css/manual-zip-100pc.css" rel="alternate stylesheet" type="text/css" title="No Sidebar - Default font size" media="all">
<link href="./style/css/manual-print.css" rel="stylesheet" type="text/css" media="print"><link rel="stylesheet" type="text/css" href="./style/css/prettify.css">
<script src="./style/scripts/prettify.min.js" type="text/javascript">
</script>
</head>
<body id="manual-page" ><div id="page-header">
<p class="menu"><a href="./mod/index.html">模块</a> | <a href="./mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="./glossary.html">词汇表</a> | <a href="./sitemap.html">网站地图</a></p>
<p class="apache">Apache HTTP服务器版本2.4</p>
<img alt="" src="./images/feather.png"></div>
<div class="up"><a href="./index.html"><img title="<-" alt="<-" src="./images/left.gif"></a></div>
<div id="path">
<a href="http://www.apache.org/">Apache</a> > <a href="http://httpd.apache.org/">HTTP Server</a> > <a href="http://httpd.apache.org/docs/">文档</a> > <a href="./index.html">版本2.4</a></div><div id="page-content"><div id="preamble"><h1>编译安装</h1>



    <p>本文档仅涵盖在Unix和类似Unix的系统上Apache HTTP Server的编译和安装。有关在Windows上进行编译和安装的信息，请参阅<a href="platform/windows.html">将Apache HTTP Server与Microsoft Windows一起使用</a>和<a href="platform/win_compiling.html">为Microsoft Windows编译Apache</a> 。对于其他平台，请参阅<a href="platform/index.html">平台</a>文档。</p>

    <p>Apache httpd的使用<code>libtool</code>和<code>autoconf</code>创建类似于许多其他开源项目的构建环境。</p>

    <p>如果要从一个次要版本升级到另一个（例如，从2.4.9 <a href="#upgrading">升级</a>到2.4.10），请跳至<a href="#upgrading">升级</a>部分。</p>

</div>
<div id="quickview"><a href="https://www.apache.org/foundation/contributing.html" class="badge"><img src="https://www.apache.org/images/SupportApache-small.png" alt="支持Apache！"></a><ul id="toc"><li><img alt="" src="./images/down.gif"> <a href="#overview">急躁的概述</a></li>
<li><img alt="" src="./images/down.gif"> <a href="#requirements">要求</a></li>
<li><img alt="" src="./images/down.gif"> <a href="#download">下载</a></li>
<li><img alt="" src="./images/down.gif"> <a href="#extract">提取</a></li>
<li><img alt="" src="./images/down.gif"> <a href="#configure">配置源树</a></li>
<li><img alt="" src="./images/down.gif"> <a href="#compile">建立</a></li>
<li><img alt="" src="./images/down.gif"> <a href="#install">安装</a></li>
<li><img alt="" src="./images/down.gif"> <a href="#customize">定制</a></li>
<li><img alt="" src="./images/down.gif"> <a href="#test">测试</a></li>
<li><img alt="" src="./images/down.gif"> <a href="#upgrading">升级中</a></li>
<li><img alt="" src="./images/down.gif"> <a href="#thirdp">第三方套餐</a></li>
</ul><h3>也可以看看</h3><ul class="seealso"><li><a href="programs/configure.html">配置源树</a></li><li><a href="invoking.html">启动Apache httpd</a></li><li><a href="stopping.html">停止并重新启动</a></li></ul></div>
<div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="overview" id="overview">急躁的概述</a></h2>

    <dl>
    <dt>在Fedora / CentOS / Red Hat Enterprise Linux上安装</dt>
    <dd>
    <pre class="prettyprint lang-">sudo yum install httpd
sudo systemctl enable httpd
sudo systemctl start httpd</pre>


    <div class="warning">这些发行版的较新版本使用<code>dnf</code>而不是<code>yum</code> 。有关特定于平台<a href="https://fedoraproject.org/wiki/Apache_HTTP_Server">的说明</a> ，请参阅<a href="https://fedoraproject.org/wiki/Apache_HTTP_Server">Fedora项目的文档</a> 。</div>
    </dd>

    <dt>在Ubuntu / Debian上安装</dt>
    <dd>
<pre class="prettyprint lang-">sudo apt install apache2
sudo service apache2 start</pre>


    <div class="warning">有关特定于平台<a href="https://help.ubuntu.com/lts/serverguide/httpd.html">的说明</a> ，请参见<a href="https://help.ubuntu.com/lts/serverguide/httpd.html">Ubuntu文档</a> 。</div>

    </dd>

    <dt>从源安装</dt>
    <dd>
    <table>
      
      <tbody><tr>
        <td><a href="#download">下载</a></td>

        <td>从<a href="http://httpd.apache.org/download.cgi#apache24">http://httpd.apache.org/download.cgi</a>下载最新版本
        </td>
      </tr>

      <tr>
        <td><a href="#extract">提取</a></td>

        <td><code>$ gzip -d httpd-<em>NN</em>.tar.gz<br> $ tar xvf httpd-<em>NN</em>.tar<br> $ cd httpd-<em>NN</em></code></td>
      </tr>

      <tr>
        <td><a href="#configure">配置</a></td>

        <td><code>$ ./configure --prefix=<em>PREFIX</em></code>
        </td>
      </tr>

      <tr>
        <td><a href="#compile">编译</a></td>

        <td><code>$ make</code> </td>
      </tr>

      <tr>
        <td><a href="#install">安装</a></td>

        <td><code>$ make install</code> </td>
      </tr>

      <tr>
        <td><a href="#customize">定制</a></td>

        <td><code>$ vi <em>PREFIX</em>/conf/httpd.conf</code> </td>
      </tr>

      <tr>
        <td><a href="#test">测试</a></td>

        <td><code>$ <em>PREFIX</em>/bin/apachectl -k start</code>
        </td>
      </tr>
    </tbody></table>

        <p><em>NN</em>必须替换为当前版本号，而<em>PREFIX</em>必须替换为应在其下安装服务器的文件系统路径。如果未指定<em>PREFIX</em> ，则默认为<code>/usr/local/apache2</code> 。</p>

        <p>从编译和安装Apache httpd的要求开始，下面将更详细地描述编译和安装过程的每个部分。</p>
    </dd>
    </dl>

    <div class="warning">在这里看不到您喜欢的平台吗？<a href="http://httpd.apache.org/docs-project/">快来帮助我们改进此文档。</a></div>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="requirements" id="requirements">要求</a></h2>

    <p>构建Apache httpd存在以下要求：</p>

    <dl>
      <dt>APR和APR-Util</dt>
      <dd>确保已在系统上安装APR和APR-Util。如果您不使用或不想使用系统提供的版本，请从<a href="http://apr.apache.org/">Apache APR</a>下载最新版本的APR和APR-Util，然后将它们解压缩到<code>/httpd_source_tree_root/srclib/apr</code>和<code>/httpd_source_tree_root/srclib/apr-util</code> （请确保目录名称没有版本号；例如，APR发行版必须位于/ httpd_source_tree_root / srclib / apr /下）并使用<code>./configure</code>的<code>--with-included-apr</code>选项。在某些平台上，您可能必须安装相应的<code>-dev</code>软件包，以允许httpd根据您安装的APR和APR-Util副本进行构建。</dd>

      <dt>Perl兼容的正则表达式库（PCRE）</dt>
      <dd>该库是必需的，但不再与httpd捆绑在一起。从<a href="http://www.pcre.org/">http://www.pcre.org</a>下载源代码，或安装端口或软件包。如果您的构建系统找不到PCRE构建安装的pcre-config脚本，请使用<code>--with-pcre</code>参数。在某些平台上，您可能必须安装相应的<code>-dev</code>软件包，以允许httpd根据您安装的PCRE副本进行构建。</dd>
      
      <dt>磁盘空间</dt>
      <dd>确保您至少有50 MB的可用临时磁盘空间。安装后，服务器大约占用10 MB的磁盘空间。实际的磁盘空间要求将根据您选择的配置选项，任何第三方模块以及服务器上的一个或多个网站的大小而有很大不同。</dd>

      <dt>ANSI-C编译器和构建系统</dt>
      <dd>确保已安装ANSI-C编译器。建议使用<a href="http://www.gnu.org/">自由软件基金会（FSF）</a>的<a href="http://gcc.gnu.org/">GNU C编译器（GCC）</a> 。如果您没有GCC，则至少要确保供应商的编译器符合ANSI。另外，您的<code>PATH</code>必须包含基本的构建工具，例如<code>make</code> 。</dd>

      <dt>精确计时</dt>
      <dd>HTTP协议的元素表示为一天中的时间。因此，是时候研究在系统上设置一些时间同步功能了。通常情况下<code>ntpdate</code>要么<code>xntpd</code>为此，使用基于网络时间协议（NTP）的程序。有关NTP软件和公共时间服务器的更多详细信息，请参见<a href="http://www.ntp.org">NTP主页</a> 。</dd>

      <dt><a href="http://www.perl.org/">Perl 5</a> [可选]</dt>
      <dd>对于某些支持脚本，例如<code class="program"><a href="./programs/apxs.html">apxs</a></code>要么<code class="program"><a href="./programs/dbmmanage.html">dbmmanage</a></code> （用Perl编写）需要Perl 5解释器（版本5.003或更高版本已足够）。如果没有找到Perl 5解释器， <code class="program"><a href="./programs/configure.html">configure</a></code>脚本，则将无法使用受影响的支持脚本。当然，您仍然可以构建和使用Apache httpd。</dd>
    </dl>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="download" id="download">下载</a></h2>

    <p>可以从<a href="http://httpd.apache.org/download.cgi">Apache HTTP Server下载站点</a>下载<a href="http://httpd.apache.org/download.cgi">Apache HTTP Server</a> ，该<a href="http://httpd.apache.org/download.cgi">站点</a>列出了多个镜像。在类似Unix的系统上使用Apache的大多数用户，最好下载并编译源代码版本。构建过程（如下所述）很容易，它使您可以自定义服务器以满足自己的需要。另外，二进制版本通常不是最新的源版本。如果您确实下载了二进制文件，请按照<code>INSTALL.bindist</code>文件里面的分布。</p>

    <p>下载后，重要的是要验证您是否具有完整且未修改的Apache HTTP Server版本。这可以通过针对PGP签名测试下载的tarball来完成。<a href="http://httpd.apache.org/download.cgi#verify">下载页面</a>上提供了有关如何执行此操作的详细信息，并提供了描述<a href="http://httpd.apache.org/dev/verification.html">PGP用法的</a>扩展示例。</p>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="extract" id="extract">提取</a></h2>

    <p>从Apache HTTP Server压缩包中提取源代码是一个简单的解压缩过程，然后解压缩：</p>

<div class="example"><p><code>$ gzip -d httpd-<em>NN</em>.tar.gz<br> $ tar xvf httpd-<em>NN</em>.tar</code></p></div>

    <p>这将在当前目录下创建一个新目录，其中包含分发的源代码。你应该<code>cd</code>进入该目录，然后再继续编译服务器。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="configure" id="configure">配置源树</a></h2>

    <p>下一步是为您的特定平台和个人需求配置Apache源代码树。这是使用脚本完成的<code class="program"><a href="./programs/configure.html">configure</a></code>包含在发行版的根目录中。（开发人员在下载未发布版本的Apache源代码树时需要<code>autoconf</code>和<code>libtool</code>已安装并需要运行<code>buildconf</code>在继续下一步之前。对于正式版本，这不是必需的。）</p>

    <p>要使用所有默认选项配置源树，只需键入<code>./configure</code> 。要更改默认选项， <code class="program"><a href="./programs/configure.html">configure</a></code>接受各种变量和命令行选项。</p>

    <p>最重要的选择是位置<code>--prefix</code>稍后安装Apache的位置，因为必须配置Apache才能使该位置正常工作。使用其他<a href="programs/configure.html#installationdirectories">配置选项，</a>可以对文件的位置进行更精细的控制。</p>

    <p>同样在这一点上，您可以通过启用和禁用<a href="mod/index.html">模块</a>来指定要包含在Apache中的<a href="programs/configure.html#optionalfeatures">功能</a> 。Apache默认随附了多种模块。它们将被编译为<a href="dso.html">共享对象（DSO）</a> ，可以在运行时加载或卸载。您还可以使用选项选择静态编译模块<code>--enable-<var>module</var>=static</code> 。</p>

    <p>使用<code>--enable-<var>module</var></code>选项，在哪里<var>module</var>是带有的模块名称<code>mod_</code>字符串已删除，并且所有下划线都转换为破折号。同样，您可以使用<code>--disable-<var>module</var></code>选项。使用这些选项时要小心，因为<code class="program"><a href="./programs/configure.html">configure</a></code>如果您指定的模块不存在，则无法警告您；它只会忽略该选项。</p>

    <p>此外，有时有必要提供<code class="program"><a href="./programs/configure.html">configure</a></code>脚本，其中包含有关编译器，库或头文件的位置的附加信息。通过将环境变量或命令行选项传递给<code class="program"><a href="./programs/configure.html">configure</a></code> 。有关更多信息，请参见<code class="program"><a href="./programs/configure.html">configure</a></code>手册页。或调用<code class="program"><a href="./programs/configure.html">configure</a></code>使用<code>--help</code>选项。</p>

    <p>为了简短地了解您所拥有的可能性，这是一个为安装树编译Apache的典型示例<code>/sw/pkg/apache</code>带有特定的编译器和标志以及两个附加模块<code class="module"><a href="./mod/mod_ldap.html">mod_ldap</a></code>和<code class="module"><a href="./mod/mod_lua.html">mod_lua</a></code> ：</p>

<div class="example"><p><code>$ CC="pgcc" CFLAGS="-O2" \<br> ./configure --prefix=/sw/pkg/apache \<br> --enable-ldap=shared \<br> --enable-lua=shared</code></p></div>

    <p>什么时候<code class="program"><a href="./programs/configure.html">configure</a></code>运行时，将需要几分钟来测试系统上功能的可用性并生成Makefile，这些Makefile将在以后用于编译服务器。</p>

    <p>所有不同的细节<code class="program"><a href="./programs/configure.html">configure</a></code>选项在<code class="program"><a href="./programs/configure.html">configure</a></code>手册页。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="compile" id="compile">建立</a></h2>

    <p>现在，您只需运行以下命令即可构建构成Apache软件包的各个部分：</p>

<div class="example"><p><code>$ make</code></p></div>

    <p>在这里请耐心等待，因为基本配置需要花费几分钟的时间进行编译，而且时间会因硬件和启用的模块数量而异。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="install" id="install">安装</a></h2>

    <p>现在是时候在配置<em>好的</em>安装<em>PREFIX</em>下安装软件包了（请参阅<code>--prefix</code>通过执行以下操作）：</p>

<div class="example"><p><code>$ make install</code></p></div>

    <p>由于<em>PREFIX</em>通常是具有受限写许可权的目录，因此此步骤通常需要root特权。</p>

    <p>如果要升级，安装将不会覆盖您的配置文件或文档。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="customize" id="customize">定制</a></h2>

    <p>接下来，您可以通过在以下位置编辑<a href="configuring.html">配置文件</a>来自定义Apache HTTP服务器<code><em>PREFIX</em>/conf/</code> 。</p>

<div class="example"><p><code>$ vi <em>PREFIX</em>/conf/httpd.conf</code></p></div>

    <p>看看下面的Apache手册<code><em>PREFIX</em>/docs/manual/</code>或访问<a href="http://httpd.apache.org/docs/2.4/">http://httpd.apache.org/docs/2.4/</a>获取本手册的最新版本以及可用<a href="mod/directives.html">配置指令</a>的完整参考。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="test" id="test">测试</a></h2>

    <p>现在，您可以通过立即运行以下命令来<a href="invoking.html">启动</a> Apache HTTP服务器：</p>

<div class="example"><p><code>$ <em>PREFIX</em>/bin/apachectl -k start</code></p></div>

    <p>然后，您应该可以通过URL请求第一个文档<code>http://localhost/</code> 。您看到的网页位于<code class="directive"><a href="./mod/core.html#documentroot">DocumentRoot</a></code> ，通常是<code><em>PREFIX</em>/htdocs/</code> 。然后通过运行再次<a href="stopping.html">停止</a>服务器：</p>

<div class="example"><p><code>$ <em>PREFIX</em>/bin/apachectl -k stop</code></p></div>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="upgrading" id="upgrading">升级中</a></h2>

    <p>升级的第一步是阅读发行公告和文件<code>CHANGES</code>在源代码发行版中查找可能影响您网站的任何更改。在主要版本之间进行更改时（例如，从2.0到2.2或从2.2到2.4），在编译时和运行时配置中可能存在重大差异，需要手动调整。还需要升级所有模块，以适应模块API中的更改。</p>

    <p>从一个次要版本升级到下一个版本（例如，从2.2.55升级到2.2.57）更加容易。的<code>make install</code>进程将不会覆盖您现有的任何文档，日志文件或配置文件。此外，开发人员会尽一切努力避免在<code class="program"><a href="./programs/configure.html">configure</a></code>选项，运行时配置或次要版本之间的模块API。在大多数情况下，您应该可以使用相同的<code class="program"><a href="./programs/configure.html">configure</a></code>命令行，相同的配置文件以及所有模块都应继续工作。</p>

    <p>要跨次要版本升级，请先查找文件<code>config.nice</code>在里面<code>build</code>安装服务器的目录或旧安装源树的根目录。这将包含确切的<code class="program"><a href="./programs/configure.html">configure</a></code>您用来配置源代码树的命令行。然后，要从一个版本升级到另一个版本，您只需复制<code>config.nice</code>文件添加到新版本的源树中，对其进行编辑以进行所需的更改，然后运行：</p>

    <div class="example"><p><code>$ ./config.nice<br> $ make<br> $ make install<br> $ <em>PREFIX</em>/bin/apachectl -k graceful-stop<br> $ <em>PREFIX</em>/bin/apachectl -k start<br></code></p></div>

    <div class="warning">在投入生产之前，应始终在环境中测试任何新版本。例如，您可以通过使用其他版本来与旧版本一起安装和运行新版本<code>--prefix</code>和其他端口（通过调整<code class="directive"><a href="./mod/mpm_common.html#listen">Listen</a></code>指令）以在进行最终升级之前测试是否存在任何不兼容性。</div>

    <p>您可以将其他参数传递给<code>config.nice</code> ，这将附加到您的原件上<code class="program"><a href="./programs/configure.html">configure</a></code>选项：</p>

    <div class="example"><p><code>$ ./config.nice --prefix=/home/test/apache --with-port=90</code></p></div>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="thirdp" id="thirdp">第三方套餐</a></h2>

    <p>大量的第三方提供了自己的Apache HTTP Server打包发行版，以便在特定平台上进行安装。这包括各种Linux发行版，各种第三方Windows软件包，Mac OS X，Solaris等。</p>

    <p>我们的软件许可证不仅允许而且鼓励这种重新分配。但是，这确实导致服务器安装的配置布局和默认设置可能与文档中所述有所不同。尽管很不幸，但这种情况不太可能很快改变。</p>

    <p>这些第三方分发的<a href="http://wiki.apache.org/httpd/DistrosDefaultLayout">描述</a>在HTTP Server Wiki中维护，并且应反映这些第三方分发的当前状态。但是，您需要熟悉特定平台的软件包管理和安装过程。</p>

</div></div>
<div id="footer">
<p class="apache">版权所有2018 The Apache Software Foundation。<br>根据<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache许可，版本2.0许可</a> 。</p>
<p class="menu"><a href="./mod/index.html">模块</a> | <a href="./mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="./glossary.html">词汇表</a> | <a href="./sitemap.html">网站地图</a></p></div><script type="text/javascript"><!--//--><![CDATA[//><!--
if (typeof(prettyPrint) !== 'undefined') {
    prettyPrint();
}
//--><!]]></script>

</body></html>