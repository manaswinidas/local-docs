<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type">
<title>mod_dir-Apache HTTP服务器版本2.4</title>
<link href="../style/css/manual-zip.css" rel="stylesheet" type="text/css" title="Main stylesheet" media="all">
<link href="../style/css/manual-zip-100pc.css" rel="alternate stylesheet" type="text/css" title="No Sidebar - Default font size" media="all">
<link href="../style/css/manual-print.css" rel="stylesheet" type="text/css" media="print"><link rel="stylesheet" type="text/css" href="../style/css/prettify.css">
<script src="../style/scripts/prettify.min.js" type="text/javascript">
</script>
</head>
<body >
<div id="page-header">
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p>
<p class="apache">Apache HTTP服务器版本2.4</p>
<img alt="" src="../images/feather.png"></div>
<div class="up"><a href="./index.html"><img title="&lt;-" alt="&lt;-" src="../images/left.gif"></a></div>
<div id="path">
<a href="http://www.apache.org/">Apache</a> &gt; <a href="http://httpd.apache.org/">HTTP服务器</a> &gt; <a href="http://httpd.apache.org/docs/">文档</a> &gt; <a href="../index.html">版本2.4</a> &gt; <a href="./index.html">模块</a></div>
<div id="page-content">
<div id="preamble"><h1>Apache模块mod_dir</h1>

<table class="module"><tr><th><a href="module-dict.html#Description">描述：</a></th><td>提供“尾随斜杠”重定向并提供目录索引文件</td></tr>
<tr><th><a href="module-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="module-dict.html#ModuleIdentifier">模块�标识符：</a></th><td>dir_module</td></tr>
<tr><th><a href="module-dict.html#SourceFile">源文件：</a></th><td>mod_dir.c</td></tr></table>
<h3>摘要</h3>

    <p>目录的索引可以来自两个来源之一：</p>

    <ul>
      <li>用户编写的文件，通常称为<code>index.html</code> 。<code class="directive"><a href="#directoryindex">DirectoryIndex</a></code>指令设置此文件的名称。这由<code class="module"><a href="../mod/mod_dir.html">mod_dir</a></code>控制。</li>

      <li>否则，服务器生成的列表。这是由<code class="module"><a href="../mod/mod_autoindex.html">mod_autoindex</a></code>提供的。</li>
    </ul>
    <p>这两个功能是分开的，因此您可以根据需要完全删除（或替换）自动索引生成。</p>

    <p>当服务器收到URL <code>http://servername/foo/dirname</code>的请求时，将发出“尾随斜杠”重定向，其中<code>dirname</code>是目录。目录要求末尾加斜杠，因此<code class="module"><a href="../mod/mod_dir.html">mod_dir</a></code>发出重定向到<code>http://servername/foo/dirname/</code> 。</p>
</div>
<div id="quickview"><a href="https://www.apache.org/foundation/contributing.html" class="badge"><img src="https://www.apache.org/images/SupportApache-small.png" alt="支持Apache！"></a><h3 class="directives">指令</h3>
<ul id="toc">
<li><img alt="" src="../images/down.gif"> <a href="#directorycheckhandler">DirectoryCheckHandler</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#directoryindex">目录索引</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#directoryindexredirect">DirectoryIndexRedirect</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#directoryslash">目录斜线</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#fallbackresource">后备资源</a></li>
</ul>
<h3>错误修正清单</h3><ul class="seealso"><li><a href="https://www.apache.org/dist/httpd/CHANGES_2.4">httpd更新日志</a></li><li><a href="https://bz.apache.org/bugzilla/buglist.cgi?bug_status=__open__&amp;list_id=144532&amp;product=Apache httpd-2&amp;query_format=specific&amp;order=changeddate DESC%2Cpriority%2Cbug_severity&amp;component=mod_dir">已知的问题</a></li><li><a href="https://bz.apache.org/bugzilla/enter_bug.cgi?product=Apache httpd-2&amp;component=mod_dir">报告错误</a></li></ul></div>

<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="DirectoryCheckHandler" id="DirectoryCheckHandler">DirectoryCheckHandler</a> <a name="directorycheckhandler" id="directorycheckhandler">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>切换配置其他处理程序时此模块的响应方式</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>DirectoryCheckHandler开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>DirectoryCheckHandler关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>指标</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_dir</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>在2.4.8及更高版本中可用。2.4之前的版本隐式地充当好像指定了“ DirectoryCheckHandler ON”。</td></tr>
</table>
    <p><code class="directive">DirectoryCheckHandler</code>指令确定当为当前URL配置了其他处理程序时， <code class="module"><a href="../mod/mod_dir.html">mod_dir</a></code>应检查目录索引还是添加尾斜杠。可以通过指令（例如<code class="directive"><a href="../mod/core.html#sethandler">SetHandler</a></code>或其他模块（例如，在按目录替换期间使用<code class="module"><a href="../mod/mod_rewrite.html">mod_rewrite</a></code>来设置处理程序。
    </p>

    <p>在2.4之前的版本中，如果为URL配置了任何其他处理程序，则此模块不执行任何操作。即使为整个目录指定了<code class="directive">SetHandler</code>指令，这也可以提供目录索引，但是它也可能导致与<code class="module"><a href="../mod/mod_rewrite.html">mod_rewrite</a></code>模块发生冲突。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="DirectoryIndex" id="DirectoryIndex">DirectoryIndex</a> <a name="directoryindex" id="directoryindex">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>客户端请求目录时要查找的资源列表</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>DirectoryIndex已禁用| <var>本地网址</var> [ <var>本地网址</var> ] ...</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>DirectoryIndex index.html</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>指标</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_dir</td></tr>
</table>
    <p>当客户端通过在目录名称末尾指定/来请求目录索引时， <code class="directive">DirectoryIndex</code>指令设置要查找的资源列表。<var>Local-url</var>是服务器上文档相对于所请求目录的（％编码）URL；它通常是目录中文件的名称。可能会提供几个URL，在这种情况下，服务器将返回它找到的第一个URL。如果不存在任何资源，并且设置了“ <code>Indexes</code>选项，则服务器将生成其自己的目录列表。</p>

    <div class="example"><h3>例</h3><pre class="prettyprint lang-config">DirectoryIndex index.html</pre>
</div>

    <p>那么对<code>http://example.com/docs/</code>的请求将返回<code>http://example.com/docs/index.html</code>如果存在），否则将列出目录。</p>

    <p>请注意，文档不需要相对于目录。</p>

    <pre class="prettyprint lang-config">DirectoryIndex index.html index.txt  /cgi-bin/index.pl</pre>


    <p>如果目录中<code>index.txt</code>存在<code>index.html</code>或<code>index.txt</code>将导致执行CGI脚本<code>/cgi-bin/index.pl</code> 。</p>

    <p>单个参数“ disabled”可防止<code class="module"><a href="../mod/mod_dir.html">mod_dir</a></code>搜索索引。如果参数“ disabled”在其之前或之后具有任何参数，则将按字面意义进行解释，即使它们也被“禁用”。</p>

    <p><strong>注意：</strong> <a href="../sections.html"><em>同一上下文中的</em></a>多个<code class="directive">DirectoryIndex</code>指令将添加到要查找而不是替换的资源列表中：</p>
    <pre class="prettyprint lang-config"># Example A: Set index.html as an index page, then add index.php to that list as well.
&lt;Directory "/foo"&gt;
    DirectoryIndex index.html
    DirectoryIndex index.php
&lt;/Directory&gt;

# Example B: This is identical to example A, except it's done with a single directive.
&lt;Directory "/foo"&gt;
    DirectoryIndex index.html index.php
&lt;/Directory&gt;

# Example C: To replace the list, you must explicitly reset it first:
# In this example, only index.php will remain as an index resource.
&lt;Directory "/foo"&gt;
    DirectoryIndex index.html
    DirectoryIndex disabled
    DirectoryIndex index.php
&lt;/Directory&gt;</pre>



</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="DirectoryIndexRedirect" id="DirectoryIndexRedirect">DirectoryIndexRedirect</a> <a name="directoryindexredirect" id="directoryindexredirect">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>为目录索引配置外部重定向。
</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>DirectoryIndexRedirect于|关|永久温度|看见者| <var>3xx代码</var>
</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>DirectoryIndexRedirect关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>指标</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_dir</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>在2.3.14版和更高版本中可用</td></tr>
</table>
    <p>默认情况下， <code class="directive">DirectoryIndex</code>被选中并透明地返回给客户端。<code class="directive">DirectoryIndexRedirect</code>导致发出外部重定向。</p>

    <p>参数可以是：</p>
    <ul>
     <li><code>on</code> ：向索引资源发出302重定向。</li>
     <li><code>off</code> ：不发出重定向。这是mod_dir的遗留行为。</li>
     <li><code>permanent</code> ：向索引资源发出301（永久）重定向。</li>
     <li><code>temp</code> ：这有效果相同<code>on</code></li>
     <li><code>seeother</code> ：向索引资源发出303重定向（也称为“其他”）。</li>
     <li><var>3xx代码</var> ：发出以所选3xx代码标记的重定向。</li>
    </ul>


    <div class="example"><h3>例</h3><pre class="prettyprint lang-config">DirectoryIndexRedirect on</pre>
</div>

    <p>对<code>http://example.com/docs/</code>的请求将返回到<code>http://example.com/docs/index.html</code>的临时重定向（如果存在）。</p>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="DirectorySlash" id="DirectorySlash">DirectorySlash</a> <a name="directoryslash" id="directoryslash">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>切换尾部斜杠重定向打开或关闭</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>DirectorySlash开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>DirectorySlash开</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>指标</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_dir</td></tr>
</table>
    <p><code class="directive">DirectorySlash</code>指令确定<code class="module"><a href="../mod/mod_dir.html">mod_dir</a></code>是否应修正指向目录的URL。</p>

    <p>通常，如果用户请求的资源没有指向目录的末尾斜杠， <code class="module"><a href="../mod/mod_dir.html">mod_dir</a></code>会将其重定向到相同的资源，但<em>带有</em>斜杠的原因有一些：</p>

    <ul>
    <li>用户最终正在请求资源的规范URL</li>
    <li><code class="module"><a href="../mod/mod_autoindex.html">mod_autoindex</a></code>正常工作。由于它不会发出链接中的路径，因此它将指向错误的路径。</li>
    <li><code class="directive"><a href="#directoryindex">DirectoryIndex</a></code> <em>仅对</em>带斜杠的目录进行评估。</li>
    <li>html页面内的相对URL引用将正常工作。</li>
    </ul>

    <p>如果您不希望这种效果， <em>并且</em>上述原因不适用于您，则可以关闭重定向，如下所示。但是，请注意，这样做可能会带来安全隐患。</p>

    <pre class="prettyprint lang-config"># see security warning below!
&lt;Location "/some/path"&gt;
    DirectorySlash Off
    SetHandler some-handler
&lt;/Location&gt;</pre>


    <div class="warning"><h3>安全警告</h3>
    <p>关闭结尾的斜杠重定向可能会导致信息泄露。考虑一种情况，其中<code class="module"><a href="../mod/mod_autoindex.html">mod_autoindex</a></code>是活动的（ <code>Options +Indexes</code> ）并且<code class="directive"><a href="#directoryindex">DirectoryIndex</a></code>设置为有效资源（例如<code>index.html</code> ），并且没有为该URL定义其他特殊处理程序。在这种情况下，带有斜杠的请求将显示<code>index.html</code>文件。<strong>但是没有斜杠的请求将列出目录内容</strong> 。</p>
    </div>
	<p>还要注意，某些浏览器在发出重定向时可能会将POST请求错误地更改为GET（从而丢弃POST数据）。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="FallbackResource" id="FallbackResource">后备资源</a> <a name="fallbackresource" id="fallbackresource">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>为未映射到文件的请求定义默认URL</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>FallbackResource已禁用| <var>本地网址</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>禁用-httpd将返回404（未找到）</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>指标</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_dir</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td><code>disabled</code>参数在2.4.4和更高版本中可用</td></tr>
</table>
    <p>使用此属性为未映射到文件系统中任何内容的任何URL设置处理程序，否则将返回HTTP 404（未找到）。例如</p>
    <pre class="prettyprint lang-config">FallbackResource /not-404.php</pre>

    <p>将导致<code>not-404.php</code>处理<code>not-404.php</code>存在的文件请求，而对已存在文件的请求不受影响。</p>
    <p>通常希望有一个文件或资源来处理对特定目录的所有请求，但与现有文件或脚本相对应的那些请求除外。这通常称为“前端控制器”。'</p>
    <p>在httpd的早期版本中，此效果通常需要<code class="module"><a href="../mod/mod_rewrite.html">mod_rewrite</a></code> ，并且需要使用<code>-f</code>和<code>-d</code>测试来确定文件和目录的存在。现在这仅需要一行配置。</p>
    <pre class="prettyprint lang-config">FallbackResource /index.php</pre>

    <p>现有文件，例如图像，css文件等，将正常提供。</p>
    <p>如果不需要从父目录继承，请使用<code>disabled</code>参数禁用该功能。</p>
    <p>在子URI中（例如<em>http://example.com/blog/），</em>该<em>子URI</em>必须作为<var>local-url提供</var> ：</p>
    <pre class="prettyprint lang-config">&lt;Directory "/web/example.com/htdocs/blog"&gt;
    FallbackResource /blog/index.php
&lt;/Directory&gt;
&lt;Directory "/web/example.com/htdocs/blog/images"&gt;
    FallbackResource disabled
&lt;/Directory&gt;</pre>


</div>
</div>
<div id="footer">
<p class="apache">版权所有2018 The Apache Software Foundation。<br>根据<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache许可，版本2.0许可</a> 。</p>
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p></div><script type="text/javascript"><!--//--><![CDATA[//><!--
if (typeof(prettyPrint) !== 'undefined') {
    prettyPrint();
}
//--><!]]></script>
</body></html>