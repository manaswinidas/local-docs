<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type">
<title>mod_cache-Apache HTTP服务器版本2.4</title>
<link href="../style/css/manual-zip.css" rel="stylesheet" type="text/css" title="Main stylesheet" media="all">
<link href="../style/css/manual-zip-100pc.css" rel="alternate stylesheet" type="text/css" title="No Sidebar - Default font size" media="all">
<link href="../style/css/manual-print.css" rel="stylesheet" type="text/css" media="print"><link rel="stylesheet" type="text/css" href="../style/css/prettify.css">
<script src="../style/scripts/prettify.min.js" type="text/javascript">
</script>
</head>
<body >
<div id="page-header">
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p>
<p class="apache">Apache HTTP服务器版本2.4</p>
<img alt="" src="../images/feather.png"></div>
<div class="up"><a href="./index.html"><img title="&lt;-" alt="&lt;-" src="../images/left.gif"></a></div>
<div id="path">
<a href="http://www.apache.org/">Apache</a> &gt; <a href="http://httpd.apache.org/">HTTP服务器</a> &gt; <a href="http://httpd.apache.org/docs/">文档</a> &gt; <a href="../index.html">版本2.4</a> &gt; <a href="./index.html">模块</a></div>
<div id="page-content">
<div id="preamble"><h1>Apache模块mod_cache</h1>

<table class="module"><tr><th><a href="module-dict.html#Description">描述：</a></th><td>符合RFC 2616的HTTP缓存过滤器。</td></tr>
<tr><th><a href="module-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="module-dict.html#ModuleIdentifier">模块标识符：</a></th><td>cache_module</td></tr>
<tr><th><a href="module-dict.html#SourceFile">源文件：</a></th><td>mod_cache.c</td></tr></table>
<h3>摘要</h3>

    <div class="warning">应谨慎使用此模块，因为当<code class="directive"><a href="#cachequickhandler">CacheQuickHandler</a></code>指令的默认值为<strong>on时</strong> ，将绕过<code class="directive"><a href="../mod/mod_access_compat.html#allow">Allow</a></code>和<code class="directive"><a href="../mod/mod_access_compat.html#deny">Deny</a></code>指令。您不应为希望通过客户端主机名，地址或环境变量限制访问的任何内容启用快速处理程序缓存。</div>

    <p><code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>实现了<a href="http://www.ietf.org/rfc/rfc2616.txt">RFC 2616</a>兼容的<strong>HTTP内容缓存过滤器</strong> ，并支持缓存包含Vary标头的内容协商响应。</p>

    <p>符合RFC 2616的缓存提供了一种机制，用于验证陈旧或过期的内容是否仍然新鲜，并且当原始服务器通过遵守<a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.26">If-None-Match</a> HTTP请求标头来支持<strong>条件请求</strong>时，可以显着提高性能。仅当内容已更改时才从头重新生成内容，而不是在缓存的条目过期时不重新生成内容。</p>

    <p>作为过滤器， <code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>可以放置在源自任何处理程序的内容之前，包括<strong>平面文件</strong> （由高速磁盘上缓存的慢速磁盘提供）， <strong>CGI脚本</strong>或<strong>动态内容生成器</strong>的输出或<strong>由另一台服务器代理的</strong>内容。</p>

    <p>在默认配置中， <code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>将高速缓存过滤器尽可能远地插入过滤器堆栈中，并在将内容返回给客户端时利用<strong>快速处理程序</strong>绕过每个请求处理。在这种操作模式下，可以将<code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>视为在Web服务器本身中运行时固定在Web服务器前端的缓存代理服务器。</p>

    <p>当使用<code class="directive"><a href="#cachequickhandler">CacheQuickHandler</a></code>指令关闭快速处理程序时，可以将<strong>CACHE</strong>过滤器插入管理员选择的过滤器堆栈中的某个点。这提供了在内容由<code class="module"><a href="../mod/mod_include.html">mod_include</a></code>过滤器个性化或由<code class="module"><a href="../mod/mod_deflate.html">mod_deflate</a></code>过滤器压缩之前缓存内容的机会。</p>

    <p>在正常操作下， <code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>将响应并由客户端在请求中或响应中的服务器发送的<a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9">Cache-Control</a>和<a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.32">Pragma</a>标头<a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9">控制</a> 。在特殊情况下，可以将<code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>配置为覆盖这些标头并强制执行特定于站点的行为，但是这种行为将仅限于此缓存，并且不会影响客户端和服务器之间可能存在的其他缓存的操作。除非绝对必要，否则不建议使用此结果。</p>

    <p>RFC 2616允许高速缓存在从源服务器刷新现有的陈旧条目时返回陈旧数据，并且在适当配置<code class="directive"><a href="#cachelock">CacheLock</a></code>指令后， <code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>支持此功能。此类响应将包含带有110响应代码的<a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.46">Warning</a> HTTP标头。当尝试刷新陈旧数据的尝试返回错误500或更高时，RFC 2616还允许缓存返回陈旧数据，并且<code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>默认支持此行为。此类响应将包含带有111响应代码的<a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.46">Warning</a> HTTP标头。</p>

    <p><code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>需要一个或多个存储管理模块的服务。基本的Apache发行版中包含以下存储管理模块：</p>
    <dl>
    <dt><code class="module"><a href="../mod/mod_cache_disk.html">mod_cache_disk</a></code></dt>
    <dd>实现基于磁盘的存储管理器。标头和正文分别存储在磁盘上的目录结构中，该目录结构是从缓存URL的md5哈希派生的。可以同时存储多个内容协商的响应，但是此模块不支持部分内容的缓存。提供<code class="program"><a href="../programs/htcacheclean.html">htcacheclean</a></code>工具来列出缓存的URL，删除缓存的URL或将磁盘缓存的大小保持在大小和inode限制之内。</dd>
    <dt><code class="module"><a href="../mod/mod_cache_socache.html">mod_cache_socache</a></code></dt>
    <dd>实现基于共享对象缓存的存储管理器。标头和正文根据要缓存的响应的URL一起存储在单个键下。可以同时存储多个内容协商的响应，但是此模块不支持部分内容的缓存。</dd>
    </dl>

    <p>《 <a href="../caching.html">缓存指南》</a>中提供了更多详细信息，讨论和示例。</p>
</div>
<div id="quickview"><a href="https://www.apache.org/foundation/contributing.html" class="badge"><img src="https://www.apache.org/images/SupportApache-small.png" alt="支持Apache！"></a><h3>话题</h3>
<ul id="topics">
<li><img alt="" src="../images/down.gif"> <a href="#related">相关模块和指令</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sampleconf">样本配置</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#thunderingherd">避开雷电群</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#finecontrol">使用CACHE过滤器进行精细控制</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#status">缓存状态和日志记录</a></li>
</ul><h3 class="directives">指令</h3>
<ul id="toc">
<li><img alt="" src="../images/down.gif"> <a href="#cachedefaultexpire">CacheDefaultExpire</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cachedetailheader">CacheDetailHeader</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cachedisable">CacheDisable</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cacheenable">CacheEnable</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cacheheader">CacheHeader</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cacheignorecachecontrol">CacheIgnoreCacheControl</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cacheignoreheaders">CacheIgnoreHeaders</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cacheignorenolastmod">CacheIgnoreNoLastMod</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cacheignorequerystring">CacheIgnoreQueryString</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cacheignoreurlsessionidentifiers">CacheIgnoreURLSessionIdentifiers</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cachekeybaseurl">CacheKeyBaseURL</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cachelastmodifiedfactor">CacheLastModifiedFactor</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cachelock">缓存锁</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cachelockmaxage">CacheLockMaxAge</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cachelockpath">CacheLockPath</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cachemaxexpire">CacheMaxExpire</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cacheminexpire">CacheMinExpire</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cachequickhandler">CacheQuickHandler</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cachestaleonerror">CacheStaleOnError</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cachestoreexpired">CacheStoreExpired</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cachestorenostore">CacheStoreNoStore</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#cachestoreprivate">CacheStorePrivate</a></li>
</ul>
<h3>错误修正清单</h3><ul class="seealso"><li><a href="https://www.apache.org/dist/httpd/CHANGES_2.4">httpd更新日志</a></li><li><a href="https://bz.apache.org/bugzilla/buglist.cgi?bug_status=__open__&amp;list_id=144532&amp;product=Apache httpd-2&amp;query_format=specific&amp;order=changeddate DESC%2Cpriority%2Cbug_severity&amp;component=mod_cache">已知的问题</a></li><li><a href="https://bz.apache.org/bugzilla/enter_bug.cgi?product=Apache httpd-2&amp;component=mod_cache">报告错误</a></li></ul><h3>也可以看看</h3>
<ul class="seealso">
<li><a href="../caching.html">缓存指南</a></li>
</ul></div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="related" id="related">相关模块和指令</a></h2>
    <table class="related"><tr><th>相关模块</th><th>相关指令</th></tr><tr><td><ul><li><code class="module"><a href="../mod/mod_cache_disk.html">mod_cache_disk</a></code></li><li><code class="module"><a href="../mod/mod_cache_socache.html">mod_cache_socache</a></code></li></ul></td><td><ul><li><code class="directive"><a href="../mod/mod_cache_disk.html#cacheroot">缓存根</a></code></li><li><code class="directive"><a href="../mod/mod_cache_disk.html#cachedirlevels">CacheDirLevels</a></code></li><li><code class="directive"><a href="../mod/mod_cache_disk.html#cachedirlength">CacheDirLength</a></code></li><li><code class="directive"><a href="../mod/mod_cache_disk.html#cacheminfilesize">CacheMinFileSize</a></code></li><li><code class="directive"><a href="../mod/mod_cache_disk.html#cachemaxfilesize">CacheMaxFileSize</a></code></li><li><code class="directive"><a href="../mod/mod_cache_socache.html#cachesocache">高速缓存</a></code></li><li><code class="directive"><a href="../mod/mod_cache_socache.html#cachesocachemaxtime">CacheSocacheMaxTime</a></code></li><li><code class="directive"><a href="../mod/mod_cache_socache.html#cachesocachemintime">CacheSocacheMinTime</a></code></li><li><code class="directive"><a href="../mod/mod_cache_socache.html#cachesocachemaxsize">CacheSocacheMaxSize</a></code></li><li><code class="directive"><a href="../mod/mod_cache_socache.html#cachesocachereadsize">CacheSocacheReadSize</a></code></li><li><code class="directive"><a href="../mod/mod_cache_socache.html#cachesocachereadtime">CacheSocacheReadTime</a></code></li></ul></td></tr></table>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="sampleconf" id="sampleconf">样本配置</a></h2>
    <div class="example"><h3>样本httpd.conf</h3><pre class="prettyprint lang-config">#
# Sample Cache Configuration
#
LoadModule cache_module modules/mod_cache.so
&lt;IfModule mod_cache.c&gt;
    LoadModule cache_disk_module modules/mod_cache_disk.so
    &lt;IfModule mod_cache_disk.c&gt;
        CacheRoot "c:/cacheroot"
        CacheEnable disk  "/"
        CacheDirLevels 5
        CacheDirLength 3
    &lt;/IfModule&gt;

    # When acting as a proxy, don't cache the list of security updates
    CacheDisable "http://security.update.server/update-list/"
&lt;/IfModule&gt;</pre>
</div>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="thunderingherd" id="thunderingherd">避开雷电群</a></h2>
  <p>当缓存的条目变得陈旧时， <code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>将向后端提交条件请求，以确认后端是否仍然是最新的，如果不是，则发送更新的实体。</p>
  <p>从缓存的实体变为陈旧的时间到陈旧的实体被完全刷新的时间之间，存在少量但有限的时间。在繁忙的服务器上，这段时间内可能会到达大量请求，并导致大量的请求突然<strong>意外</strong>地攻击后端。</p>
  <p>为了<code class="directive">CacheLock</code>可使用<code class="directive">CacheLock</code>指令定义一个目录，在该目录中为<strong>飞行中的</strong> URL创建锁。该锁定被其他请求用作<strong>提示</strong> ，以抑制尝试进行缓存的尝试（其他人已获取实体），或指示正在刷新陈旧的条目（同时将返回陈旧的内容）。
  </p>
  <h3>条目的初始缓存</h3>
    
    <p>第一次缓存实体时，将为该实体创建一个锁，直到响应被完全缓存。在锁定的生存期内，缓存将禁止第二次及其后尝试缓存同一实体。尽管这并不能阻止雷声群，但它确实停止了尝试同时多次缓存同一实体的缓存。
    </p>
  
  <h3>刷新陈旧条目</h3>
    
    <p>当实体达到其新鲜度生命周期并变得过时时，将为该实体创建锁，直到确认响应仍为新鲜或由后端替换为止。在锁的有效期内，第二个及随后的传入请求将导致过时的数据被返回，而雷电群则被拒之门外。</p>
  
  <h3>锁和缓存控制：无缓存</h3>
    
    <p>锁定<strong>仅用</strong>作<strong>提示，</strong>以使后端服务器上的缓存更加平缓，但是可以在必要时覆盖该锁定。如果客户端发送带有Cache-Control标头的请求以强制重新加载，则可能存在的任何锁都将被忽略，并且客户端的请求将被立即接受并且缓存的条目将刷新。</p>
    <p>作为进一步的安全机制，锁具有可配置的最大使用寿命。达到该年龄后，将删除该锁，并为新请求提供创建新锁的机会。可以使用<code class="directive">CacheLockMaxAge</code>指令设置此最长<code class="directive">CacheLockMaxAge</code> ，默认值为5秒。
    </p>
  
  <h3>配置示例</h3>
    
    <div class="example"><h3>启用缓存锁</h3><pre class="prettyprint lang-config">#
# Enable the cache lock
#
&lt;IfModule mod_cache.c&gt;
    CacheLock on
    CacheLockPath "/tmp/mod_cache-lock"
    CacheLockMaxAge 5
&lt;/IfModule&gt;</pre>
</div>
  
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="finecontrol" id="finecontrol">使用CACHE过滤器进行精细控制</a></h2>
  <p>在默认的缓存操作模式下，缓存作为快速处理程序运行，使大多数服务器处理短路，并提供最高的缓存性能。</p>

  <p>在这种模式下，缓存用<strong>螺栓固定</strong>在服务器的前端，就像在服务器的前端放置了独立的RFC 2616缓存代理一样。</p>

  <p>尽管此模式提供最佳性能，但管理员可能会发现，在某些情况下，他们可能希望在缓存请求后对请求进行进一步处理，例如将个性化设置注入缓存的页面，或对内容应用授权限制。在这种情况下，管理员通常被迫在缓存服务器的后面或前面放置独立的反向代理服务器，以实现此目的。</p>

  <p>为了解决此问题，可以将<code class="directive"><a href="#cachequickhandler">CacheQuickHandler</a></code>指令设置为<strong>off</strong> ，并且服务器将处理通常由非缓存请求处理的所有阶段，包括<strong>身份验证和授权</strong>阶段。</p>

  <p>另外，管理员可以通过将<strong>CACHE</strong>过滤器添加到输出过滤器链来选择指定<strong>过滤器链</strong>中要进行缓存的<strong>精确点</strong> 。</p>

  <p>例如，要在对响应进行压缩之前缓存内容，请将<strong>CACHE</strong>过滤器放在<strong>DEFLATE</strong>过滤器之前，如下例所示：</p>

  <pre class="prettyprint lang-config"># Cache content before optional compression
CacheQuickHandler off
AddOutputFilterByType CACHE;DEFLATE text/plain</pre>


  <p>另一种选择是在由<code class="module"><a href="../mod/mod_include.html">mod_include</a></code> （或其他内容处理过滤器）应用个性化设置之前，先缓存内容。在此示例中，包含由<code class="module"><a href="../mod/mod_include.html">mod_include</a></code>理解的标签的模板在解析之前被缓存：</p>

  <pre class="prettyprint lang-config"># Cache content before mod_include and mod_deflate
CacheQuickHandler off
AddOutputFilterByType CACHE;INCLUDES;DEFLATE text/html</pre>


  <p>您可以将<strong>CACHE</strong>过滤器放置在过滤器链中所需的任何位置。在此示例中，内容在由<code class="module"><a href="../mod/mod_include.html">mod_include</a></code>解析之后但在由<code class="module"><a href="../mod/mod_deflate.html">mod_deflate</a></code>处理之前被缓存：</p>

  <pre class="prettyprint lang-config"># Cache content between mod_include and mod_deflate
CacheQuickHandler off
AddOutputFilterByType INCLUDES;CACHE;DEFLATE text/html</pre>


  <div class="warning"><h3>警告：</h3>如果出于任何原因更改了<strong>CACHE</strong>过滤器在过滤器链中的位置，则可能需要<strong>刷新缓存</strong>以确保所提供的数据保持一致。 <code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>无法为您强制执行此操作。</div>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="status" id="status">缓存状态和日志记录</a></h2>
  <p>一旦<code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>决定了是否要从缓存中提供实体，就将该决定的详细原因写入到<strong>缓存状态</strong>键下的请求内的子流程环境中。可以通过<code class="directive"><a href="../mod/mod_log_config.html#logformat">LogFormat</a></code>指令记录此原因，如下所示：</p>

  <pre class="prettyprint lang-config">LogFormat "%{cache-status}e ..."</pre>


  <p>根据所做的缓存决策，还将根据以下四个关键之一将原因写入子流程环境：</p>

  <dl>
    <dt>缓存命中</dt><dd>响应是从缓存提供的。</dd>
    <dt>缓存重新验证</dt><dd>响应已过时，已成功重新验证，然后从缓存中提供。</dd>
    <dt>高速缓存未命中</dt><dd>响应是从上游服务器提供的。</dd>
    <dt>缓存无效</dt><dd>缓存的实体通过除GET或HEAD之外的请求方法无效。</dd>
  </dl>

  <p>这使得可以根据以下示例支持对缓存的请求进行条件日志记录：</p>

  <pre class="prettyprint lang-config">CustomLog "cached-requests.log" common env=cache-hit
CustomLog "uncached-requests.log" common env=cache-miss
CustomLog "revalidated-requests.log" common env=cache-revalidate
CustomLog "invalidated-requests.log" common env=cache-invalidate</pre>


  <p>对于模块作者，可以使用一个名为<var>cache_status</var>的钩子，该钩子允许模块以自定义方式响应上述缓存结果。</p>
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheDefaultExpire" id="CacheDefaultExpire">CacheDefaultExpire</a> <a name="cachedefaultexpire" id="cachedefaultexpire">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>未指定有效日期时的默认文档缓存时间。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheDefaultExpire <var>秒</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheDefaultExpire 3600（一小时）</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
    <p><code class="directive">CacheDefaultExpire</code>指令指定了默认时间（以秒为单位），如果文档没有提供到期日期或最后修改日期，则该默认时间以秒为单位。用<code class="directive">CacheMaxExpire</code>指令指定的值<em>不会</em>覆盖此设置。</p>

    <pre class="prettyprint lang-config">CacheDefaultExpire 86400</pre>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheDetailHeader" id="CacheDetailHeader">CacheDetailHeader</a> <a name="cachedetailheader" id="cachedetailheader">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>将X-Cache-Detail标头添加到响应。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheDetailHeader <var>开|关</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheDetailHeader关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>在Apache 2.3.9和更高版本中可用</td></tr>
</table>
  <p>当<code class="directive"><a href="#cachedetailheader">CacheDetailHeader</a></code>指令打开时， <strong>X-Cache-Detail</strong>标头将添加到响应中，其中包含特定缓存决策的详细原因。</p>

  <p>在开发缓存的RESTful服务期间，将有关缓存决策的其他信息写入响应标头可能很有用，以便确认服务和客户端是否正确使用了<code>Cache-Control</code>和其他标头。</p>

  <p>如果使用普通处理程序，则此伪指令可能出现在<code class="directive"><a href="../mod/core.html#directory">&lt;Directory&gt;</a></code>或<code class="directive"><a href="../mod/core.html#location">&lt;Location&gt;</a></code>伪指令内。如果使用快速处理程序，则此伪指令必须出现在服务器或虚拟主机上下文中，否则设置将被忽略。</p>

  <pre class="prettyprint lang-config"># Enable the X-Cache-Detail header
CacheDetailHeader on</pre>


  <div class="example"><p><code>X-Cache-Detail：来自本地主机的“条件缓存命中：实体已刷新”<br>
  </code></p></div>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheDisable" id="CacheDisable">CacheDisable</a> <a name="cachedisable" id="cachedisable">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>禁用指定URL的缓存</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheDisable <var>url-string</var> | <var>上</var></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
    <p><code class="directive">CacheDisable</code>指令指示<code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code> <em>不</em>缓存<var>url-string</var>或以下的<var>url</var> 。</p>

    <div class="example"><h3>例</h3><pre class="prettyprint lang-config">CacheDisable "/local_files"</pre>
</div>

    <p>如果在<code class="directive">&lt;Location&gt;</code>指令中使用，则需要在Location下方指定路径，或者如果使用单词“ on”，则将禁用对整个位置的缓存。</p>

    <div class="example"><h3>例</h3><pre class="prettyprint lang-config">&lt;Location "/foo"&gt;
    CacheDisable on
&lt;/Location&gt;</pre>
</div>

    <p>可以将<code>no-cache</code>环境变量设置为禁用在2.2.12和更高版本中对更细粒度的资源集的缓存。</p>


<h3>也可以看看</h3>
<ul>
<li><a href="../env.html">Apache中的环境变量</a></li>
</ul>
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheEnable" id="CacheEnable">CacheEnable</a> <a name="cacheenable" id="cacheenable">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>使用指定的存储管理器启用指定URL的缓存</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheEnable <var>cache_type</var> [ <var>url-string</var> ]</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>URL字符串“ /”应用于在2.2及更早版本中转发代理内容。</td></tr>
</table>
    <p><code class="directive">CacheEnable</code>指令指示<code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>将url缓存在<var>url-string</var>或以下。高速缓存存储管理器由<var>cache_type</var>参数指定。也可以将<code class="directive">CacheEnable</code>指令放置在<code class="directive">&lt;Location&gt;</code>或<code class="directive">&lt;LocationMatch&gt;</code>部分中，以指示内容是可缓存的。
    <var>cache_type</var> <code>disk</code>指示<code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>使用<code class="module"><a href="../mod/mod_cache_disk.html">mod_cache_disk</a></code>实现的基于磁盘的存储管理器。 <var>cache_type</var> <code>socache</code>指示<code class="module"><a href="../mod/mod_cache.html">mod_cache</a></code>使用由<code class="module"><a href="../mod/mod_cache_socache.html">mod_cache_socache</a></code>实现的基于共享对象缓存的存储管理器。</p>
    <p>如果URL空间在不同的<code class="directive">CacheEnable</code>指令之间重叠（如下面的示例），则将运行每个可能的存储管理器，直到第一个实际处理请求的存储管理器为止。存储管理器的运行顺序由配置文件中<code class="directive">CacheEnable</code>指令的顺序确定。<code class="directive">CacheEnable</code>内指令<code class="directive">&lt;Location&gt;</code>或<code class="directive">&lt;LocationMatch&gt;</code>部分被处理之前全局定义<code class="directive">CacheEnable</code>指令。</p>

    <p>充当转发代理服务器时， <var>url-string</var>必须至少以应启用缓存的协议开头。</p>

    <pre class="prettyprint lang-config"># Cache content (normal handler only)
CacheQuickHandler off
&lt;Location "/foo"&gt;
    CacheEnable disk
&lt;/Location&gt;

# Cache regex (normal handler only)
CacheQuickHandler off
&lt;LocationMatch "foo$"&gt;
    CacheEnable disk
&lt;/LocationMatch&gt;

# Cache all but forward proxy url's (normal or quick handler)
CacheEnable  disk  /

# Cache FTP-proxied url's (normal or quick handler)
CacheEnable  disk  ftp://

# Cache forward proxy content from www.example.org (normal or quick handler)
CacheEnable  disk  http://www.example.org/</pre>


    <p>以<strong>“ *”</strong>开头的主机名将匹配所有带有该后缀的主机名。主机名以<strong>“。”</strong>开头<strong>。</strong>匹配包含后面域组件的所有主机名。</p>

    <pre class="prettyprint lang-config"># Match www.example.org, and fooexample.org
CacheEnable  disk  "http://*example.org/"
# Match www.example.org, but not fooexample.org
CacheEnable  disk  "http://.example.org/"</pre>


    <p>可以将<code>no-cache</code>环境变量设置为禁用在2.2.12和更高版本中对更细粒度的资源集的缓存。</p>


<h3>也可以看看</h3>
<ul>
<li><a href="../env.html">Apache中的环境变量</a></li>
</ul>
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheHeader" id="CacheHeader">CacheHeader</a> <a name="cacheheader" id="cacheheader">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>将X-Cache标头添加到响应中。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheHeader <var>开|关</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheHeader关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>在Apache 2.3.9和更高版本中可用</td></tr>
</table>
  <p>当<code class="directive"><a href="#cacheheader">CacheHeader</a></code>指令打开时， <strong>X-Cache</strong>标头将添加到响应中，并带有该响应的缓存状态。如果使用普通处理程序，则此伪指令可能出现在<code class="directive"><a href="../mod/core.html#directory">&lt;Directory&gt;</a></code>或<code class="directive"><a href="../mod/core.html#location">&lt;Location&gt;</a></code>伪指令内。如果使用快速处理程序，则此伪指令必须出现在服务器或虚拟主机上下文中，否则设置将被忽略。</p>

  <dl>
    <dt><strong>击中</strong></dt><dd>该实体是新鲜的，并且是从缓存中提供的。</dd>
    <dt><strong>重新验证</strong></dt><dd>该实体已过时，已成功重新验证并从缓存中提供。</dd>
    <dt><strong>小姐</strong></dt><dd>该实体是从上游服务器获取的，而不是从缓存提供的。</dd>
  </dl>

  <pre class="prettyprint lang-config"># Enable the X-Cache header
CacheHeader on</pre>


  <pre class="prettyprint lang-config">X-Cache: HIT from localhost</pre>



</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheIgnoreCacheControl" id="CacheIgnoreCacheControl">CacheIgnoreCacheControl</a> <a name="cacheignorecachecontrol" id="cacheignorecachecontrol">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>忽略不向客户端提供缓存内容的请求</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheIgnoreCacheControl开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheIgnoreCacheControl关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
    <p>通常，包含Cache-Control：no-cache或Pragma：no-cache标头值的请求将不会从缓存中得到服务。<code class="directive">CacheIgnoreCacheControl</code>指令允许此行为被覆盖。<code class="directive">CacheIgnoreCacheControl On</code>告诉服务器即使请求中包含无缓存头值，也尝试从缓存中提供资源。需要授权的资源将<em>永远不会</em>被缓存。</p>

    <pre class="prettyprint lang-config">CacheIgnoreCacheControl On</pre>


    <div class="warning"><h3>警告：</h3>即使客户端已请求不从缓存中提供文档，此伪指令也将允许从缓存中提供服务。这可能会导致提供过时的内容。
    </div>

<h3>也可以看看</h3>
<ul>
<li><code class="directive"><a href="#cachestoreprivate">CacheStorePrivate</a></code></li>
<li><code class="directive"><a href="#cachestorenostore">CacheStoreNoStore</a></code></li>
</ul>
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheIgnoreHeaders" id="CacheIgnoreHeaders">CacheIgnoreHeaders</a> <a name="cacheignoreheaders" id="cacheignoreheaders">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>不要将给定的HTTP标头存储在缓存中。
</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheIgnoreHeaders <var>标头字符串</var> [ <var>header-string</var> ] ...</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheIgnoreHeaders无</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
    <p>根据RFC 2616，逐跳HTTP标头不存储在缓存中。以下HTTP标头是逐跳标头，因此无论<code class="directive">CacheIgnoreHeaders</code>的设置如何，在<em>任何</em>情况下<code class="directive">CacheIgnoreHeaders</code>存储在缓存中：</p>

    <ul>
      <li><code>连接</code></li>
      <li><code>活着</code></li>
      <li><code>代理验证</code></li>
      <li><code>代理授权</code></li>
      <li><code>TE</code></li>
      <li><code>预告片</code></li>
      <li><code>传输编码</code></li>
      <li><code>升级</code></li>
    </ul>

    <p><code class="directive">CacheIgnoreHeaders</code>指定不应存储在高速缓存中的其他HTTP标头。例如，在某些情况下，防止cookie被存储在缓存中是有意义的。</p>

    <p><code class="directive">CacheIgnoreHeaders</code>采用空格分隔的HTTP标头列表，不应将其存储在缓存中。如果不应仅将逐跳标头存储在缓存中（符合RFC 2616的行为），则<code class="directive">CacheIgnoreHeaders</code>可以设置为<code>None</code> 。</p>

    <div class="example"><h3>例子1</h3><pre class="prettyprint lang-config">CacheIgnoreHeaders Set-Cookie</pre>
</div>

    <div class="example"><h3>例子2</h3><pre class="prettyprint lang-config">CacheIgnoreHeaders None</pre>
</div>

    <div class="warning"><h3>警告：</h3>如果由于<code class="directive">CacheIgnoreHeaders</code>设置而未存储适当的缓存管理所需的诸如<code>Expires</code>标头，则<code class="directive">CacheIgnoreHeaders</code>的行为未定义。
    </div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheIgnoreNoLastMod" id="CacheIgnoreNoLastMod">CacheIgnoreNoLastMod</a> <a name="cacheignorenolastmod" id="cacheignorenolastmod">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>忽略响应没有Last Modified标头的事实。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheIgnoreNoLastMod开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheIgnoreNoLastMod关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
    <p>通常，不缓存没有最后修改日期的文档。在某些情况下，上次修改的日期会被删除（例如在<code class="module"><a href="../mod/mod_include.html">mod_include</a></code>处理期间）或根本不提供。<code class="directive">CacheIgnoreNoLastMod</code>指令提供一种方法，用于指定应考虑将没有上次修改日期的文档进行缓存，即使没有上一次修改日期也是如此。如果文档未提供最后修改日期和有效期，则<code class="directive">CacheDefaultExpire</code>指令指定的值将用于生成有效期。</p>

    <pre class="prettyprint lang-config">CacheIgnoreNoLastMod On</pre>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheIgnoreQueryString" id="CacheIgnoreQueryString">CacheIgnoreQueryString</a> <a name="cacheignorequerystring" id="cacheignorequerystring">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>缓存时忽略查询字符串</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheIgnoreQueryString打开|关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheIgnoreQueryString关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
    <p>通常，具有查询字符串参数的请求将分别为每个唯一查询字符串缓存。仅当指定了到期时间时，才根据RFC 2616 / 13.9执行此操作。<code class="directive">CacheIgnoreQueryString</code>指令告诉缓存，即使未指定到期时间，也缓存请求，即使查询字符串不同，也以缓存的回复进行回复。从缓存的角度来看，启用此伪指令后，将请求视为没有查询字符串。</p>

    <pre class="prettyprint lang-config">CacheIgnoreQueryString On</pre>



</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheIgnoreURLSessionIdentifiers" id="CacheIgnoreURLSessionIdentifiers">CacheIgnoreURLSessionIdentifiers</a> <a name="cacheignoreurlsessionidentifiers" id="cacheignoreurlsessionidentifiers">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>缓存时忽略URL中编码的定义的会话标识符</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheIgnoreURLSessionIdentifiers <var>标识符</var> [ <var>标识符</var> ] ...</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheIgnoreURLSessionIdentifiers无</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
    <p>有时，应用程序会将会话标识符编码为URL，如以下示例所示：</p>
    <ul>
      <li><code>/someapplication/image.gif;jsessionid=123456789</code></li>
      <li><code>/someapplication/image.gif？PHPSESSIONID = 12345678</code></li>
    </ul>
    <p>这导致可缓存资源针对每个会话分别存储，这通常是不希望的。<code class="directive">CacheIgnoreURLSessionIdentifiers</code>允许定义一个标识符列表，该标识符从用于标识缓存中实体的键中删除，这样可缓存资源就不会为每个会话单独存储。
    </p>
    <p><code>CacheIgnoreURLSessionIdentifiers None</code>清除忽略的标识符列表。否则，每个标识符将添加到列表中。</p>

    <div class="example"><h3>例子1</h3><pre class="prettyprint lang-config">CacheIgnoreURLSessionIdentifiers jsessionid</pre>
</div>

    <div class="example"><h3>例子2</h3><pre class="prettyprint lang-config">CacheIgnoreURLSessionIdentifiers None</pre>
</div>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheKeyBaseURL" id="CacheKeyBaseURL">CacheKeyBaseURL</a> <a name="cachekeybaseurl" id="cachekeybaseurl">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>覆盖反向代理缓存键的基本URL。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheKeyBaseURL <var>URL</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheKeyBaseURL http://example.com</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>在Apache 2.3.9和更高版本中可用</td></tr>
</table>
  <p>指定<code class="directive"><a href="#cachekeybaseurl">CacheKeyBaseURL</a></code>指令后，提供的URL将用作基本URL，以计算反向代理配置中的缓存键的URL。如果未指定，则使用当前虚拟主机的方案，主机名和端口来构造缓存键。如果存在计算机集群，并且所有缓存的条目都应缓存在同一缓存密钥下，则可以使用此伪指令指定新的基本URL。</p>

  <pre class="prettyprint lang-config"># Override the base URL of the cache key.
CacheKeyBaseURL "http://www.example.com/"</pre>


  <div class="warning">设置此指令时请多加注意。如果意外地给两个单独的虚拟主机提供了相同的基本URL，则来自一个虚拟主机的条目将被提供给另一个虚拟主机。</div>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheLastModifiedFactor" id="CacheLastModifiedFactor">CacheLastModifiedFactor</a> <a name="cachelastmodifiedfactor" id="cachelastmodifiedfactor">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>用于基于LastModified日期计算到期日期的因子。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheLastModifiedFactor <var>浮动</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheLastModifiedFactor 0.1</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
    <p>如果文档未提供有效期但提供了最后修改日期，则可以基于自上次修改文档以来的时间来计算有效期。<code class="directive">CacheLastModifiedFactor</code>指令根据以下公式指定要在此到期日期的生成中使用的<var>因子</var> ： <code>expiry-period = time-since-last-modified-date * <var>factor</var> expiry-date = current-date + expiry-period</code>例如，如果文档的最后修改时间是10小时前，并且<var>系数</var>是0.1，则有效期限将设置为10 * 0.1 = 1小时。如果当前时间是3:00 pm，则计算的到期日期将是3:00 pm + 1hour = 4:00 pm。如果到期时间长于<code class="directive">CacheMaxExpire</code>设置的时间，则后者优先。</p>

    <pre class="prettyprint lang-config">CacheLastModifiedFactor 0.5</pre>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheLock" id="CacheLock">CacheLock</a> <a name="cachelock" id="cachelock">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>启用防雷群锁。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheLock <var>开|关</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheLock关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>在Apache 2.2.15及更高版本中可用</td></tr>
</table>
  <p><code class="directive">CacheLock</code>伪指令为给定的URL空间启用雷电<code class="directive">CacheLock</code>锁。</p>

  <p>在最低配置中，以下指令是启用默认系统临时目录中的雷电追赶者锁所需要的全部。</p>

  <pre class="prettyprint lang-config"># Enable cache lock
CacheLock on</pre>



</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheLockMaxAge" id="CacheLockMaxAge">CacheLockMaxAge</a> <a name="cachelockmaxage" id="cachelockmaxage">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>设置高速缓存锁定的最大可能期限。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheLockMaxAge <var>整数</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheLockMaxAge 5</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
  <p><code class="directive">CacheLockMaxAge</code>指令指定任何高速缓存锁的最长期限。</p>

  <p>超过此值（以秒为单位）的锁定将被忽略，并且下一个传入的请求将有机会重新建立该锁定。此机制可防止慢速客户端花费过多时间来刷新实体。</p>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheLockPath" id="CacheLockPath">CacheLockPath</a> <a name="cachelockpath" id="cachelockpath">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>设置锁定路径目录。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheLockPath <var>目录</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheLockPath / tmp / mod_cache-lock</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
  <p><code class="directive">CacheLockPath</code>伪指令允许您指定在其中创建锁的目录。默认情况下，使用系统的临时文件夹。锁由空文件组成，这些空文件仅在飞行中的过时URL中存在，因此与传统的磁盘缓存相比，资源占用量明显减少。</p>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheMaxExpire" id="CacheMaxExpire">CacheMaxExpire</a> <a name="cachemaxexpire" id="cachemaxexpire">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>缓存文档的最长时间（以秒为单位）</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheMaxExpire <var>秒</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheMaxExpire 86400（一天）</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
    <p><code class="directive">CacheMaxExpire</code>指令指定在不检查源服务器的情况下保留可缓存HTTP文档的最大秒数。因此，文档最多将过时此秒数。即使随文档提供了有效期，也会强制执行此最大值。</p>

    <pre class="prettyprint lang-config">CacheMaxExpire 604800</pre>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheMinExpire" id="CacheMinExpire">CacheMinExpire</a> <a name="cacheminexpire" id="cacheminexpire">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>缓存文档的最短时间（以秒为单位）</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheMinExpire <var>秒</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheMinExpire 0</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
    <p><code class="directive">CacheMinExpire</code>指令指定在不检查源服务器的情况下保留可缓存HTTP文档的最小秒数。仅当文档没有提供有效的到期时间时才使用此选项。</p>


    <pre class="prettyprint lang-config">CacheMinExpire 3600</pre>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheQuickHandler" id="CacheQuickHandler">CacheQuickHandler</a> <a name="cachequickhandler" id="cachequickhandler">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>从快速处理程序运行缓存。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheQuickHandler <var>开启|关闭</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>开启CacheQuickHandler</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>Apache HTTP Server 2.3.3及更高版本</td></tr>
</table>
    <p><code class="directive"><a href="#cachequickhandler">CacheQuickHandler</a></code>指令控制处理缓存的阶段。</p>

    <p>在默认启用的配置中，缓存在快速处理程序阶段内运行。此阶段使大多数服务器处理短路，并代表典型服务器的最高性能操作模式。缓存用<strong>螺栓固定</strong>在服务器的前端，避免了大多数服务器处理。</p>

    <p>禁用后，缓存将作为常规处理程序运行，并且在处理服务器请求时会受整个阶段的约束。尽管此模式比默认模式慢，但它允许在需要完全处理的情况下（例如，内容受授权时）使用缓存。</p>

    <pre class="prettyprint lang-config"># Run cache as a normal handler
CacheQuickHandler off</pre>


    <p>禁用快速处理程序后，管理员还可以通过将<strong>CACHE</strong>过滤器添加到过滤器链中，在过滤器链中选择要执行缓存的精确位置。</p>

    <pre class="prettyprint lang-config"># Cache content before mod_include and mod_deflate
CacheQuickHandler off
AddOutputFilterByType CACHE;INCLUDES;DEFLATE text/html</pre>


    <p>如果多次指定CACHE过滤器，则将应用最后一个实例。</p>

  
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheStaleOnError" id="CacheStaleOnError">CacheStaleOnError</a> <a name="cachestaleonerror" id="cachestaleonerror">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>提供过时的内容来代替5xx响应。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheStaleOnError <var>开|关</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheStaleOnError开启</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>在Apache 2.3.9和更高版本中可用</td></tr>
</table>
  <p>当<code class="directive"><a href="#cachestaleonerror">CacheStaleOnError</a></code>指令打开时，并且当缓存中有陈旧数据时，缓存将通过返回陈旧数据而不是5xx响应来响应来自后端的5xx响应。虽然将尊重客户端发送的Cache-Control标头，并且原始的5xx响应应请求返回给客户端，但如此返回给客户端的5xx响应不会使缓存中的内容无效。</p>

  <pre class="prettyprint lang-config"># Serve stale data on error.
CacheStaleOnError on</pre>



</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheStoreExpired" id="CacheStoreExpired">CacheStoreExpired</a> <a name="cachestoreexpired" id="cachestoreexpired">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>尝试缓存服务器报告为过期的响应</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheStoreExpired开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheStore已过期</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
    <p>从httpd 2.2.4开始，已经过期的响应不会存储在缓存中。<code class="directive">CacheStoreExpired</code>指令允许重写此行为。
       <code class="directive">CacheStoreExpired</code> On告诉服务器尝试缓存过期的资源。后续请求将触发原始服务器的If-Modified-Since请求，并且如果后端资源未更改，则可以从缓存中满足响应。</p>

    <pre class="prettyprint lang-config">CacheStoreExpired On</pre>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheStoreNoStore" id="CacheStoreNoStore">CacheStoreNoStore</a> <a name="cachestorenostore" id="cachestorenostore">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>尝试缓存已标记为“无存储”的请求或响应。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheStoreNoStore开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheStoreNoStore关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
    <p>通常，具有Cache-Control：不存储标头值的请求或响应将不存储在缓存中。<code class="directive">CacheStoreNoStore</code>指令允许此行为被覆盖。<code class="directive">CacheStoreNoStore</code> On <code class="directive">CacheStoreNoStore</code>服务器尝试缓存资源，即使该资源包含无存储标头值也是如此。需要授权的资源将<em>永远不会</em>被缓存。</p>

    <pre class="prettyprint lang-config">CacheStoreNoStore On</pre>


    <div class="warning"><h3>警告：</h3>如RFC 2616中所述，no-store指令旨在“防止敏感信息的意外释放或保留（例如，在备份磁带上）”。启用此选项可以将敏感信息存储在缓存中。特此警告您。
    </div>

<h3>也可以看看</h3>
<ul>
<li><code class="directive"><a href="#cacheignorecachecontrol">CacheIgnoreCacheControl</a></code></li>
<li><code class="directive"><a href="#cachestoreprivate">CacheStorePrivate</a></code></li>
</ul>
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CacheStorePrivate" id="CacheStorePrivate">CacheStorePrivate</a> <a name="cachestoreprivate" id="cachestoreprivate">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>尝试缓存服务器已标记为私有的响应</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CacheStorePrivate开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>CacheStorePrivate关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_cache</td></tr>
</table>
    <p>通常，带有Cache-Control：专用头值的响应不会存储在缓存中。<code class="directive">CacheStorePrivate</code>指令允许此行为被覆盖。
       <code class="directive">CacheStorePrivate</code> On告诉服务器即使包含私有标头值，也尝试缓存资源。需要授权的资源将<em>永远不会</em>被缓存。</p>

    <pre class="prettyprint lang-config">CacheStorePrivate On</pre>


    <div class="warning"><h3>警告：</h3>即使上游服务器已请求不缓存资源，此指令也将允许缓存。该指令仅适用于“专用”缓存。
    </div>

<h3>也可以看看</h3>
<ul>
<li><code class="directive"><a href="#cacheignorecachecontrol">CacheIgnoreCacheControl</a></code></li>
<li><code class="directive"><a href="#cachestorenostore">CacheStoreNoStore</a></code></li>
</ul>
</div>
</div>
<div id="footer">
<p class="apache">版权所有2018 The Apache Software Foundation。<br>根据<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache许可，版本2.0许可</a> 。</p>
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p></div><script type="text/javascript"><!--//--><![CDATA[//><!--
if (typeof(prettyPrint) !== 'undefined') {
    prettyPrint();
}
//--><!]]></script>
</body></html>