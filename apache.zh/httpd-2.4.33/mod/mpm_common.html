<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head></head><body >﻿
<meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type">
<title>mpm_common-Apache HTTP服务器版本2.4</title>
<link href="../style/css/manual-zip.css" rel="stylesheet" type="text/css" title="Main stylesheet" media="all">
<link href="../style/css/manual-zip-100pc.css" rel="alternate stylesheet" type="text/css" title="No Sidebar - Default font size" media="all">
<link href="../style/css/manual-print.css" rel="stylesheet" type="text/css" media="print"><link rel="stylesheet" type="text/css" href="../style/css/prettify.css">
<script src="../style/scripts/prettify.min.js" type="text/javascript">
</script>


<div id="page-header">
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p>
<p class="apache">Apache HTTP服务器版本2.4</p>
<img alt="" src="../images/feather.png"></div>
<div class="up"><a href="./index.html"><img title="<-" alt="<-" src="../images/left.gif"></a></div>
<div id="path">
<a href="http://www.apache.org/">Apache</a> > <a href="http://httpd.apache.org/">HTTP服务器</a> > <a href="http://httpd.apache.org/docs/">文档</a> > <a href="../index.html">版本2.4</a> > <a href="./index.html">模块</a></div>
<div id="page-content">
<div id="preamble"><h1>Apache MPM通用指令</h1>

<table class="module"><tbody><tr><th><a href="module-dict.html#Description">描述：</a></th><td>由多个多处理模块（MPM）实施的指令的集合</td></tr>
<tr><th><a href="module-dict.html#Status">状态：</a></th><td>MPM</td></tr></tbody></table>
</div>
<div id="quickview"><a href="https://www.apache.org/foundation/contributing.html" class="badge"><img src="https://www.apache.org/images/SupportApache-small.png" alt="支持Apache！"></a><h3 class="directives">指令</h3>
<ul id="toc">
<li><img alt="" src="../images/down.gif"> <a href="#coredumpdirectory">CoreDumpDirectory</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#enableexceptionhook">EnableExceptionHook</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#gracefulshutdowntimeout">GracefulShutdownTimeout</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#listen">听</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#listenbacklog">听回日志</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#listencoresbucketsratio">ListenCoresBucketsRatio</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#maxconnectionsperchild">MaxConnectionsPerChild</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#maxmemfree">MaxMemFree</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#maxrequestworkers">MaxRequestWorkers</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#maxsparethreads">MaxSpareThreads</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#minsparethreads">MinSpare线程</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#pidfile">PidFile</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#receivebuffersize">ReceiveBufferSize</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#scoreboardfile">计分板文件</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sendbuffersize">SendBufferSize</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#serverlimit">服务器限制</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#startservers">启动服务器</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#startthreads">启动线程</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#threadlimit">线程限制</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#threadsperchild">每个孩子的线程数</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#threadstacksize">线程堆栈大小</a></li>
</ul>
<h3>错误修正清单</h3><ul class="seealso"><li><a href="https://www.apache.org/dist/httpd/CHANGES_2.4">httpd更新日志</a></li><li><a href="https://bz.apache.org/bugzilla/buglist.cgi?bug_status=__open__&list_id=144532&product=Apache httpd-2&query_format=specific&order=changeddate DESC%2Cpriority%2Cbug_severity&component=mpm_common">已知的问题</a></li><li><a href="https://bz.apache.org/bugzilla/enter_bug.cgi?product=Apache httpd-2&component=mpm_common">报告错误</a></li></ul></div>

<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="CoreDumpDirectory" id="CoreDumpDirectory">CoreDumpDirectory</a> <a name="coredumpdirectory" id="coredumpdirectory">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>转储核心之前Apache HTTP Server尝试切换的目录</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>CoreDumpDirectory <var>directory</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>See usage for the default setting</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ，<code class="module"><a href="../mod/prefork.html">prefork</a></code></td></tr>
</tbody></table>
    <p>这控制了在转储内核之前Apache httpd尝试切换到的目录。如果您的操作系统配置为在崩溃过程的工作目录中创建核心文件， <code class="directive">CoreDumpDirectory</code>从默认目录更改工作目录是必需的<code class="directive"><a href="../mod/core.html#serverroot">ServerRoot</a></code>目录，服务器运行用户不应写该目录。</p>

    <p>如果要使用核心转储进行调试，则可以使用此伪指令将其放置在其他位置。如果您的操作系统未配置为将核心文件写入崩溃进程的工作目录，则此指令无效。</p>

    <div class="note"><h3>Linux上的核心转储</h3>
      <p>如果Apache httpd以root身份启动并切换到另一个用户，则Linux内核<em>将禁用</em>核心转储，即使该进程的目录是可写的。Apache httpd（2.0.46及更高版本）可在Linux 2.4及更高版本上重新启用核心转储，但前提是您明确配置了<code class="directive">CoreDumpDirectory</code> 。</p>
    </div>

    <div class="note">
    <h3>BSD上的核心转储</h3>
    <p>要在BSD系统（例如FreeBSD）上启用suid可执行文件的核心转储，请设置<code>kern.sugid_coredump</code>到1。
    </p>
    </div>

    <div class="note"><h3>具体信号</h3>
      <p><code class="directive">CoreDumpDirectory</code>仅对一组致命信号进行处理：SIGFPE，SIGILL，SIGABORT，SIGSEGV和SIGBUS。</p>
      <p>在某些操作系统上，SIGQUIT还会导致核心转储，但不会通过<code class="directive">CoreDumpDirectory</code>要么<code class="directive">EnableExceptionHook</code>处理，因此核心位置完全由操作系统决定。</p>
    </div>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="EnableExceptionHook" id="EnableExceptionHook">EnableExceptionHook</a> <a name="enableexceptionhook" id="enableexceptionhook">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>启用在崩溃后运行异常处理程序的钩子</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>EnableExceptionHook On|Off</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>EnableExceptionHook Off</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ，<code class="module"><a href="../mod/prefork.html">prefork</a></code></td></tr>
</tbody></table>
    <p>出于安全原因，仅当服务器配置有<code>--enable-exception-hook</code>选项。它启用了一个挂钩，该挂钩允许外部模块在孩子撞车后插入并执行某些操作。</p>

    <p>已经有两个模块， <code>mod_whatkilledus</code>和<code>mod_backtrace</code>利用这个钩子。请访问Jeff Trawick的<a href="https://emptyhammock.com/projects/httpd/diag/">EnableExceptionHook网站</a> ，以获取有关这些信息的更多信息。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="GracefulShutdownTimeout" id="GracefulShutdownTimeout">GracefulShutdownTimeout</a> <a name="gracefulshutdowntimeout" id="gracefulshutdowntimeout">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>指定一个超时，在此超时后，正常关闭服务器将退出。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>GracefulShutdownTimeout <var>seconds</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>GracefulShutdownTimeout 0</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ，<code class="module"><a href="../mod/prefork.html">prefork</a></code></td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>在2.2版和更高版本中可用</td></tr>
</tbody></table>
    <p>的<code class="directive">GracefulShutdownTimeout</code>指定在收到“正常停止”信号后多少秒后，服务器应继续运行，以处理现有连接。</p>

    <p>将此值设置为零意味着服务器将无限期等待，直到所有剩余的请求都已完全满足为止。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="Listen" id="Listen">听</a> <a name="listen" id="listen">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>服务器监听的IP地址和端口</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>Listen [<var>IP-address</var>:]<var>portnumber</var> [<var>protocol</var>]</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ， <code class="module"><a href="../mod/prefork.html">prefork</a></code> ， <code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code> ， <code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code> ，<code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code></td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>的<var>protocol</var>参数已在2.1.5中添加</td></tr>
</tbody></table>
    <p>的<code class="directive">Listen</code>指令指示Apache httpd仅侦听特定的IP地址或端口；默认情况下，它响应所有IP接口上的请求。<code class="directive">Listen</code>现在是必需的指令。如果它不在配置文件中，则服务器将无法启动。这是对Apache httpd以前版本的更改。</p>

    <p>的<code class="directive">Listen</code>指令告诉服务器接受指定端口或地址和端口组合上的传入请求。如果仅指定端口号，则服务器在所有接口上侦听给定的端口。如果提供了IP地址和端口，则服务器将侦听给定的端口和接口。</p>

    <p>多<code class="directive">Listen</code>指令可用于指定要侦听的地址和端口的数量。服务器将响应来自任何列出的地址和端口的请求。</p>

    <p>例如，要使服务器接受端口80和8000上的连接，请使用：</p>

    <pre class="prettyprint lang-config">Listen 80
Listen 8000</pre>


    <p>要使服务器接受两个指定接口和端口号上的连接，请使用</p>

    <pre class="prettyprint lang-config">Listen 192.170.2.1:80
Listen 192.170.2.5:8000</pre>


    <p>IPv6地址必须用方括号括起来，如以下示例所示：</p>

    <pre class="prettyprint lang-config">Listen [2001:db8::a00:20ff:fea7:ccea]:80</pre>


    <p>可选的<var>protocol</var>对于大多数配置，不需要此参数。如果未指定， <code>https</code>是端口443的默认值， <code>http</code>所有其他端口的默认值。该协议用于确定哪个模块应处理请求，并通过<code class="directive"><a href="../mod/core.html#acceptfilter">AcceptFilter</a></code>指示。</p>

    <p>仅在非标准端口上运行时，才需要设置协议。例如，运行<code>https</code>在端口8443上的站点：</p>

    <pre class="prettyprint lang-config">Listen 192.170.2.1:8443 https</pre>


    <div class="note"><h3>错误情况</h3>多<code class="directive">Listen</code>相同IP地址和端口的指令将导致<code>Address already in use</code>错误信息。
    </div>


<h3>也可以看看</h3>
<ul>
<li><a href="../dns-caveats.html">DNS问题</a></li>
<li><a href="../bind.html">设置Apache HTTP Server使用哪些地址和端口</a></li>
<li><a href="http://wiki.apache.org/httpd/CouldNotBindToAddress">的进一步讨论<code>Address already in use</code>错误消息，包括其他原因。</a></li>
</ul>
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ListenBackLog" id="ListenBackLog">ListenBackLog</a> <a name="listenbacklog" id="listenbacklog">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>挂起连接队列的最大长度</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ListenBacklog <var>backlog</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>ListenBacklog 511</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ， <code class="module"><a href="../mod/prefork.html">prefork</a></code> ， <code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code> ， <code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code> ，<code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code></td></tr>
</tbody></table>
    <p>挂起的连接队列的最大长度。通常，不需要或不希望进行调整，但是在某些系统上，当受到TCP SYN泛洪攻击时，希望增加此调整。请参阅<code>listen(2)</code>系统调用。</p>

    <p>操作系统通常会将其限制为较小的数量。随操作系统的不同而不同。另请注意，许多操作系统并未完全使用指定为待办事项的列表，而是使用基于（但通常大于）设置值的数字。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ListenCoresBucketsRatio" id="ListenCoresBucketsRatio">ListenCoresBucketsRatio</a> <a name="listencoresbucketsratio" id="listencoresbucketsratio">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>CPU核心数（在线）与侦听器存储桶数之间的比率</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ListenCoresBucketsRatio <var>ratio</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>ListenCoresBucketsRatio 0 (disabled)</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ，<code class="module"><a href="../mod/prefork.html">prefork</a></code></td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>在Apache HTTP Server 2.4.17中可用，其内核支持套接字选项<code>SO_REUSEPORT</code>并使用它在侦听进程（或线程）套接字之间平均分配新的连接（例如Linux 3.9和更高版本，但不是当前的实现<code>SO_REUSEPORT</code>在* BSD中。</td></tr>
</tbody></table>
    <p>一种<var>ratio</var> （在线）CPU内核数和侦听器存储桶数之间的差额可用于使Apache HTTP Server创建<code>num_cpu_cores / ratio</code>监听桶，每个桶都有自己的听筒<code class="directive">Listen</code> -在同一端口上插入套接字，然后使每个子代处理单个存储桶（在创建子代时对存储桶进行循环分配）。</p>

    <div class="note"><h3>“在线” CPU内核的含义</h3>
    <p>在Linux（以及BSD）上，如果配置了<a href="https://www.kernel.org/doc/Documentation/cpu-hotplug.txt">Hotplug，</a>则可以打开/关闭CPU内核，因此<code class="directive">ListenCoresBucketsRatio</code>在计算要创建的存储桶数时需要考虑此参数。</p>
    </div>

    <p><code class="directive">ListenCoresBucketsRatio</code>当接受新连接成为瓶颈时，可以提高可伸缩性。在具有大量CPU内核的系统上，启用此功能已经过测试，显示出显着的性能改进和更短的响应时间。</p>

    <p>CPU核心数至少必须是配置的两倍<var>ratio</var>使其活跃起来。推荐的<var>ratio</var>是<code>8</code> ，因此至少<code>16</code>使用此值时，内核应在运行时可用。正确的<var>ratio</var>为了获得每个目标系统的最高性能，需要测试多个值并观察关键性能指标的变化。</p>

    <p>该指令会影响<code class="directive"><a href="#minsparethreads">MinSpareThreads</a></code>和<code class="directive"><a href="#maxsparethreads">MaxSpareThreads</a></code>下界值。子进程的数量必须是存储桶数量的倍数，才能最佳地接受连接。</p>

    <div class="note">
    <h3>多<code class="directive">Listen</code> er或Apache HTTP服务器在相同的IP地址和端口上</h3>
    <p>设置<code>SO_REUSEPORT</code>因此，侦听套接字上的选项允许多个进程（共享同一进程<code>EUID</code> ，例如<code>root</code> ）绑定到相同的IP地址和端口，而在通常情况下系统不会出现绑定错误。</p>
    <p>这也意味着在同一个配置中配置了多个Apache httpd实例<code>IP:port</code>并以积极的态度<code class="directive">ListenCoresBucketsRatio</code>也会毫无错误地开始，然后在两个实例之间均匀分布的传入连接中运行（在任何情况下，这都不是建议或明智的用法，但这只是一个通知，它可以防止发现此类可能的问题）。</p>
    <p>在同一实例中，如果多个http httpd将检查并无法启动<code class="directive">Listen</code>在完全相同的IP（或主机名）和端口上配置了伪指令，从而避免了创建一些重复的存储桶，这些存储桶是无用的并且会降低性能。但是，它不能（也不会更努力地）捕获所有可能重叠的情况（例如将主机名解析为其他地方使用的IP）。</p>
    </div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="MaxConnectionsPerChild" id="MaxConnectionsPerChild">MaxConnectionsPerChild</a> <a name="maxconnectionsperchild" id="maxconnectionsperchild">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>限制单个子级服务器在其生存期内要处理的连接数</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>MaxConnectionsPerChild <var>number</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>MaxConnectionsPerChild 0</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ， <code class="module"><a href="../mod/prefork.html">prefork</a></code> ， <code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code> ， <code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code> ，<code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code></td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>可用的Apache HTTP Server 2.3.9和更高版本。旧名<code>MaxRequestsPerChild</code>仍受支持。</td></tr>
</tbody></table>
    <p>的<code class="directive">MaxConnectionsPerChild</code>指令设置单个子服务器进程将处理的连接数限制。后<code class="directive">MaxConnectionsPerChild</code>连接后，子进程将死亡。如果<code class="directive">MaxConnectionsPerChild</code>是<code>0</code> ，那么该过程将永不过期。</p>

    <p>设置<code class="directive">MaxConnectionsPerChild</code>设置为非零值将限制（偶然的）内存泄漏导致进程消耗的内存量。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="MaxMemFree" id="MaxMemFree">MaxMemFree</a> <a name="maxmemfree" id="maxmemfree">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>主分配器无需调用即可保留的最大内存量<code>free()</code></td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>MaxMemFree <var>KBytes</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>MaxMemFree 2048</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ， <code class="module"><a href="../mod/prefork.html">prefork</a></code> ， <code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code> ，<code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code></td></tr>
</tbody></table>
    <p>的<code class="directive">MaxMemFree</code>伪指令设置允许每个分配器不调用而保留的最大可用字节数<code>free()</code> 。在线程MPM中，每个线程都有自己的分配器。设置为零时，阈值将设置为无限制。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="MaxRequestWorkers" id="MaxRequestWorkers">MaxRequestWorkers</a> <a name="maxrequestworkers" id="maxrequestworkers">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>同时处理的最大连接数</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>MaxRequestWorkers <var>number</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>See usage for details</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ，<code class="module"><a href="../mod/prefork.html">prefork</a></code></td></tr>
</tbody></table>
    <p>的<code class="directive">MaxRequestWorkers</code>指令设置对将同时服务的请求数的限制。任何通过<code class="directive">MaxRequestWorkers</code>限制通常会排队，最多可根据<code class="directive"><a href="#listenbacklog">ListenBacklog</a></code>指示。一旦在另一个请求结束时释放了子进程，则将为连接提供服务。</p>

    <p>对于非线程服务器（ <em>即</em> ， <code class="module"><a href="../mod/prefork.html">prefork</a></code> ）， <code class="directive">MaxRequestWorkers</code>转换为将启动以处理请求的子进程的最大数量。默认值为<code>256</code> ;要增加它，你还必须提高<code class="directive"><a href="#serverlimit">ServerLimit</a></code> 。</p>

    <p>对于线程和混合服务器（ <em>例如</em> <code class="module"><a href="../mod/event.html">event</a></code>要么<code class="module"><a href="../mod/worker.html">worker</a></code> ） <code class="directive">MaxRequestWorkers</code>限制可用于服务客户端的线程总数。对于混合MPM，默认值为<code>16</code> （ <code class="directive"><a href="#serverlimit">ServerLimit</a></code> ）乘以<code>25</code> （ <code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code> ）。因此，增加<code class="directive">MaxRequestWorkers</code>到需要超过16个过程的值，还必须提高<code class="directive"><a href="#serverlimit">ServerLimit</a></code> 。</p>

    <p><code class="directive">MaxRequestWorkers</code>被称为<code class="directive">MaxClients</code>在2.3.13版之前。仍然支持旧名称。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="MaxSpareThreads" id="MaxSpareThreads">MaxSpareThreads</a> <a name="maxsparethreads" id="maxsparethreads">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>最大空闲线程数</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>MaxSpareThreads <var>number</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>See usage for details</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ， <code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code> ，<code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code></td></tr>
</tbody></table>
    <p>最大空闲线程数。不同的MPM处理此指令的方式有所不同。</p>

    <p>对于<code class="module"><a href="../mod/worker.html">worker</a></code>和<code class="module"><a href="../mod/event.html">event</a></code> ，默认值为<code>MaxSpareThreads 250</code> 。这些MPM在服务器范围内处理空闲线程。如果服务器中的空闲线程过多，则子进程将被杀死，直到空闲线程的数量小于该数量为止。如果以下情况，可能会创建其他进程/线程<code class="directive"><a href="#listencoresbucketsratio">ListenCoresBucketsRatio</a></code>已启用。</p>

    <p>对于<code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code>默认是<code>MaxSpareThreads 100</code> 。由于此MPM运行单个进程，因此备用线程数也在服务器范围内。</p>

    <p><code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code>类似于<code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code> 。对于<code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code>默认值为<code>10</code> 。</p>

    <div class="note"><h3>限制条件</h3>
      <p>范围<code class="directive">MaxSpareThreads</code>值是受限制的。Apache httpd将根据以下规则自动更正给定值：</p>
      <ul>
        <li><code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code>希望该值大于<code class="directive"><a href="#minsparethreads">MinSpareThreads</a></code> 。</li>

        <li>对于<code class="module"><a href="../mod/worker.html">worker</a></code>和<code class="module"><a href="../mod/event.html">event</a></code> ，该值必须大于或等于<code class="directive"><a href="#minsparethreads"> MinSpareThreads</a></code>和<code class="directive"><a href="#threadsperchild"> ThreadsPerChild</a></code> 。</li>
      </ul>
    </div>

<h3>也可以看看</h3>
<ul>
<li><code class="directive"><a href="#minsparethreads">MinSpareThreads</a></code></li>
<li><code class="directive"><a href="#startservers">StartServers</a></code></li>
<li><code class="directive"><a href="../mod/prefork.html#maxspareservers">MaxSpareServers</a></code></li>
</ul>
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="MinSpareThreads" id="MinSpareThreads">MinSpareThreads</a> <a name="minsparethreads" id="minsparethreads">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>可用于处理请求峰值的最小空闲线程数</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>MinSpareThreads <var>number</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>See usage for details</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ， <code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code> ，<code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code></td></tr>
</tbody></table>
    <p>处理请求峰值的最小空闲线程数。不同的MPM处理此指令的方式有所不同。</p>

    <p><code class="module"><a href="../mod/worker.html">worker</a></code>和<code class="module"><a href="../mod/event.html">event</a></code>使用默认值<code>MinSpareThreads 75</code>并在整个服务器范围内处理空闲线程。如果服务器中没有足够的空闲线程，则将创建子进程，直到空闲线程的数量大于<var>number</var> 。如果以下情况，可能会创建其他进程/线程<code class="directive"><a href="#listencoresbucketsratio">ListenCoresBucketsRatio</a></code>已启用。</p>

    <p><code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code>使用默认值<code>MinSpareThreads 10</code>并且由于它是单进程MPM，因此可以在服务器范围内对其进行跟踪。</p>

    <p><code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code>类似于<code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code> 。对于<code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code>默认值为<code>5</code> 。</p>

<h3>也可以看看</h3>
<ul>
<li><code class="directive"><a href="#maxsparethreads">MaxSpareThreads</a></code></li>
<li><code class="directive"><a href="#startservers">StartServers</a></code></li>
<li><code class="directive"><a href="../mod/prefork.html#minspareservers">MinSpareServers</a></code></li>
</ul>
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="PidFile" id="PidFile">PidFile</a> <a name="pidfile" id="pidfile">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>服务器记录守护程序的进程ID的文件</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>PidFile <var>filename</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>PidFile logs/httpd.pid</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ， <code class="module"><a href="../mod/prefork.html">prefork</a></code> ， <code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code> ，<code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code></td></tr>
</tbody></table>
    <p>的<code class="directive">PidFile</code>指令设置服务器记录守护程序的进程ID的文件。如果文件名不是绝对的，则假定它是相对于<code class="directive"><a href="../mod/core.html#serverroot">ServerRoot</a></code> 。</p>

    <div class="example"><h3>例</h3><pre class="prettyprint lang-config">PidFile /var/run/apache.pid</pre>
</div>

    <p>能够向服务器发送信号，使其关闭然后重新打开，通常很有用。 <code class="directive"><a href="../mod/core.html#errorlog">ErrorLog</a></code>和<code class="directive"><a href="../mod/mod_log_config.html#transferlog">TransferLog</a></code> ，并重新读取其配置文件。这是通过将SIGHUP（kill -1）信号发送到列表中列出的进程ID来完成的<code class="directive">PidFile</code> 。</p>

    <p>的<code class="directive">PidFile</code>受到有关日志文件放置和<a href="../misc/security_tips.html#serverroot">安全性</a>的相同警告。</p>

    <div class="note"><h3>注意</h3>
      <p>从Apache HTTP Server 2开始，我们建议您仅使用<code class="program"><a href="../programs/apachectl.html">apachectl</a></code>脚本或操作系统提供的用于（重新）启动或停止服务器的初始化脚本。</p>
    </div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ReceiveBufferSize" id="ReceiveBufferSize">ReceiveBufferSize</a> <a name="receivebuffersize" id="receivebuffersize">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>TCP接收缓冲区大小</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ReceiveBufferSize <var>bytes</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>ReceiveBufferSize 0</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ， <code class="module"><a href="../mod/prefork.html">prefork</a></code> ， <code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code> ， <code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code> ，<code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code></td></tr>
</tbody></table>
    <p>服务器会将TCP接收缓冲区大小设置为指定的字节数。</p>

    <p>如果设置为<code>0</code> ，服务器将使用操作系统默认值。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ScoreBoardFile" id="ScoreBoardFile">ScoreBoardFile</a> <a name="scoreboardfile" id="scoreboardfile">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>用于存储子流程的协调数据的文件的位置</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ScoreBoardFile <var>file-path</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>ScoreBoardFile logs/apache_runtime_status</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ， <code class="module"><a href="../mod/prefork.html">prefork</a></code> ，<code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code></td></tr>
</tbody></table>
    <p>Apache HTTP Server使用记分板在其父进程和子进程之间进行通信。一些体系结构需要一个文件来促进这种通信。如果未指定文件，则Apache httpd首先尝试完全在内存中创建记分板（使用匿名共享内存），否则，将尝试在磁盘上创建文件（使用基于文件的共享内存）。指定此伪指令将导致Apache httpd始终在磁盘上创建文件。</p>

    <div class="example"><h3>例</h3><pre class="prettyprint lang-config">ScoreBoardFile /var/run/apache_runtime_status</pre>
</div>

    <p>基于文件的共享内存对于需要直接访问记分板的第三方应用程序很有用。</p>

    <p>如果您使用<code class="directive">ScoreBoardFile</code>那么将其放在RAM磁盘上可能会提高速度。但是请注意，请注意有关日志文件放置和<a href="../misc/security_tips.html">安全性</a>的相同警告。</p>

<h3>也可以看看</h3>
<ul>
<li><a href="../stopping.html">停止并重新启动Apache HTTP Server</a></li>
</ul>
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SendBufferSize" id="SendBufferSize">SendBufferSize</a> <a name="sendbuffersize" id="sendbuffersize">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>TCP缓冲区大小</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SendBufferSize <var>bytes</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SendBufferSize 0</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ， <code class="module"><a href="../mod/prefork.html">prefork</a></code> ， <code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code> ， <code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code> ，<code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code></td></tr>
</tbody></table>
    <p>将服务器的TCP发送缓冲区大小设置为指定的字节数。在高速，高延迟的连接（ <em>即</em> 100ms左右，例如跨大陆快速管道）上设置超过OS的标准默认值通常很有用。</p>

    <p>如果设置为<code>0</code> ，服务器将使用操作系统提供的默认值。</p>

    <p>可能需要对操作系统进行进一步的配置才能在高速，高延迟的连接上获得更好的性能。</p>

    <div class="note"> <p>在某些操作系统上，TCP行为的变化是由于<code class="directive">SendBufferSize</code>除非看到，否则可能看不到<code class="directive"><a href="../mod/core.html#enablesendfile">EnableSendfile</a></code>设置为OFF。此交互仅适用于静态文件。</p> </div>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ServerLimit" id="ServerLimit">ServerLimit</a> <a name="serverlimit" id="serverlimit">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>可配置进程数的上限</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ServerLimit <var>number</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>See usage for details</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ，<code class="module"><a href="../mod/prefork.html">prefork</a></code></td></tr>
</tbody></table>
    <p>为了<code class="module"><a href="../mod/prefork.html">prefork</a></code> MPM，此指令设置最大配置值<code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers</a></code>在Apache httpd进程的生存期内。为了<code class="module"><a href="../mod/worker.html">worker</a></code>和<code class="module"><a href="../mod/event.html">event </a></code> MPM，此指令与<code class="directive"><a href="#threadlimit">ThreadLimit</a></code>设置以下项的最大配置值<code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers</a></code>在Apache httpd进程的生存期内。为了<code class="module"><a href="../mod/event.html">event</a></code> MPM，此指令还定义了多少个旧服务器进程可以继续运行并完成对打开的连接的处理。在重新启动期间更改此指令的任何尝试将被忽略，但是<code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers</a></code>可以在重新启动期间进行修改。</p>

    <p>使用此指令时必须特别注意。如果<code class="directive">ServerLimit</code>如果将其设置为远远高于必要值的值，则会分配额外的未使用共享内存。如果两者<code class="directive">ServerLimit</code>和<code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers</a></code>设置为高于系统可以处理的值，Apache httpd可能无法启动，或者系统可能变得不稳定。</p>

    <p>随着<code class="module"><a href="../mod/prefork.html">prefork</a></code> MPM，仅在需要设置时才使用此指令<code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers</a></code>高于256（默认值）。请勿将此指令的值设置为高于您可能要设置的值<code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers</a></code>至。</p>

    <p>用<code class="module"><a href="../mod/worker.html">worker</a></code> ，仅当您的<code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers </a></code>和<code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code>设置需要超过16个服务器进程（默认）。请勿将此指令的值设置为高于您可能需要的服务器进程数<code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers </a></code>和<code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code> 。</p>

    <p>用<code class="module"><a href="../mod/event.html">event</a></code>如果您定义的进程号是<code class="directive"><a href="#maxrequestworkers">MaxRequestWorkers</a></code>和<code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code>设置以及正常关闭的进程数超过16个服务器进程（默认）。</p>

    <div class="note"><h3>注意</h3>
      <p>有一个硬限制<code>ServerLimit 20000</code>编译到服务器中（用于<code class="module"><a href="../mod/prefork.html">prefork</a></code> MPM 200000）。这是为了避免错别字造成的令人讨厌的影响。为了使其进一步超过此限制，您将需要修改mpm源文件中的MAX_SERVER_LIMIT值并重建服务器。</p>
    </div>

<h3>也可以看看</h3>
<ul>
<li><a href="../stopping.html">停止并重新启动Apache HTTP Server</a></li>
</ul>
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="StartServers" id="StartServers">StartServers</a> <a name="startservers" id="startservers">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>启动时创建的子服务器进程数</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>StartServers <var>number</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>See usage for details</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ， <code class="module"><a href="../mod/prefork.html">prefork</a></code> ，<code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code></td></tr>
</tbody></table>
    <p>的<code class="directive">StartServers</code>指令设置启动时创建的子服务器进程的数量。由于进程数量是根据负载动态控制的，因此（请参阅<code class="directive"><a href="#minsparethreads">MinSpareThreads</a></code> ， <code class="directive"><a href="#maxsparethreads">MaxSpareThreads</a></code> ， <code class="directive"><a href="../mod/prefork.html#minspareservers">MinSpareServers</a></code> ， <code class="directive"><a href="../mod/prefork.html#maxspareservers">MaxSpareServers</a></code> ）通常没有理由调整此参数。</p>

    <p>缺省值因MPM而异。 <code class="module"><a href="../mod/worker.html">worker</a></code>和<code class="module"><a href="../mod/event.html">event</a></code>默认为<code>StartServers 3</code> ; <code class="module"><a href="../mod/prefork.html"> prefork</a></code>默认为<code>5</code> ; <code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code>默认为<code>2</code> 。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="StartThreads" id="StartThreads">StartThreads</a> <a name="startthreads" id="startthreads">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>启动时创建的线程数</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>StartThreads <var>number</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>See usage for details</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code></td></tr>
</tbody></table>
    <p>启动时创建的线程数。由于线程数是根据负载动态控制的，因此（请参阅<code class="directive"><a href="#minsparethreads">MinSpareThreads</a></code> ， <code class="directive"><a href="#maxsparethreads">MaxSpareThreads</a></code> ， <code class="directive"><a href="../mod/prefork.html#minspareservers">MinSpareServers</a></code> ， <code class="directive"><a href="../mod/prefork.html#maxspareservers">MaxSpareServers</a></code> ）通常没有理由调整此参数。</p>

    <p>对于<code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code>默认是<code>StartThreads 50</code>并且，由于只有一个进程，因此这是启动时为服务请求而创建的线程总数。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ThreadLimit" id="ThreadLimit">ThreadLimit</a> <a name="threadlimit" id="threadlimit">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>设置每个子进程的可配置线程数上限</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ThreadLimit <var>number</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>See usage for details</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ，<code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code></td></tr>
</tbody></table>
    <p>该指令为以下参数设置最大配置值<code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code>在Apache httpd进程的生存期内。在重新启动期间更改此指令的任何尝试将被忽略，但是<code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code>可以在重新启动期间进行修改，直到此指令的值。</p>

    <p>使用此指令时必须特别注意。如果<code class="directive">ThreadLimit</code>设置为远高于<code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code> ，则会分配额外的未使用共享内存。如果两者<code class="directive">ThreadLimit</code>和<code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code>设置为高于系统可以处理的值，Apache httpd可能无法启动，或者系统可能变得不稳定。请勿将此指令的值设置为高于您的最大预测设置<code class="directive"><a href="#threadsperchild">ThreadsPerChild</a></code>当前运行的Apache httpd。</p>

    <p>的默认值<code class="directive">ThreadLimit</code>是<code>1920</code>当与<code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code>和<code>64</code>与其他人一起使用时。</p>

    <div class="note"><h3>注意</h3>
      <p>有一个硬限制<code>ThreadLimit 20000</code> （要么<code>ThreadLimit 100000</code>与<code class="module"><a href="../mod/event.html">event</a></code> ， <code>ThreadLimit 15000</code>与<code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code> ）编译到服务器中。这是为了避免错别字造成的令人讨厌的影响。为了使其进一步超过此限制，您将需要修改mpm源文件中的MAX_THREAD_LIMIT值并重建服务器。</p>
    </div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ThreadsPerChild" id="ThreadsPerChild">ThreadsPerChild</a> <a name="threadsperchild" id="threadsperchild">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>每个子进程创建的线程数</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ThreadsPerChild <var>number</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>See usage for details</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ，<code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code></td></tr>
</tbody></table>
    <p>该指令设置每个子进程创建的线程数。子级在启动时创建这些线程，而从不创建更多线程。如果使用MPM之类的<code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code>在只有一个子进程的情况下，此数字应足够大以处理服务器的整个负载。如果使用MPM之类的<code class="module"><a href="../mod/worker.html">worker</a></code> ，在有多个子进程的情况下，线程<em>总数</em>应足够高以处理服务器上的常见负载。</p>

    <p>的默认值<code class="directive">ThreadsPerChild</code>是<code>64</code>当与<code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code>和<code>25</code>与其他人一起使用时。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ThreadStackSize" id="ThreadStackSize">ThreadStackSize</a> <a name="threadstacksize" id="threadstacksize">指令</a></h2>
<table class="directive">
<tbody><tr><th><a href="directive-dict.html#Description">描述：</a></th><td>处理客户端连接的线程使用的堆栈大小（以字节为单位）</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ThreadStackSize <var>size</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>65536 on NetWare; varies on other operating systems</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>MPM</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td><code class="module"><a href="../mod/event.html">event</a></code> ， <code class="module"><a href="../mod/worker.html">worker</a></code> ， <code class="module"><a href="../mod/mpm_winnt.html">mpm_winnt</a></code> ， <code class="module"><a href="../mod/mpm_netware.html">mpm_netware</a></code> ，<code class="module"><a href="../mod/mpmt_os2.html">mpmt_os2</a></code></td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>在Apache HTTP Server 2.1和更高版本中可用</td></tr>
</tbody></table>
    <p>的<code class="directive">ThreadStackSize</code>指令设置用于处理客户端连接并调用模块以帮助处理这些连接的线程堆栈（用于自动数据）的大小。在大多数情况下，操作系统默认的堆栈大小是合理的，但是在某些情况下可能需要对其进行调整：</p>

    <ul>
      <li>在具有相对较小的默认线程堆栈大小的平台（例如，HP-UX）上，当使用一些第三方模块使用大量自动数据存储时，Apache httpd可能会崩溃。这些相同的模块可能在其他默认线程堆栈大小较大的平台上运行良好。通过设置以下类型的崩溃即可解决<code class="directive">ThreadStackSize</code>大于操作系统默认值的值。仅当第三方模块的提供程序指定需要此调整，或者诊断为Apache httpd崩溃表明线程堆栈大小过小时，才需要进行这种调整。</li>

      <li>在默认线程堆栈大小明显大于Web服务器配置所需平台的平台上，如果满足以下条件，则每个子进程可以实现更多数量的线程<code class="directive">ThreadStackSize</code>设置为低于操作系统默认值的值。这种调整类型只能在允许完全执行Web服务器处理的测试环境中进行，因为可能不经常出现请求，需要处理更多的堆栈。所需的最小最小堆栈大小很大程度上取决于所使用的模块，但是Web服务器配置中的任何更改都可能使当前的无效<code class="directive">ThreadStackSize</code>设置。</li>

      <li>在Linux上，此指令只能用于增加默认堆栈大小，因为基础系统调用使用该值作为<em>最小</em>堆栈大小。的（通常是较大的）软限制<code>ulimit -s</code> （如果没有限制，则为8MB）用作默认堆栈大小。</li>
    </ul>

    <div class="note">建议不要减少<code class="directive">ThreadStackSize</code>除非每个子进程需要大量线程。在某些平台（包括Linux）上，设置128000已经太低，导致某些常用模块崩溃。</div>

</div>
</div>
<div id="footer">
<p class="apache">版权所有2018 The Apache Software Foundation。<br>根据<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache许可，版本2.0许可</a> 。</p>
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p></div><script type="text/javascript"><!--//--><![CDATA[//><!--
if (typeof(prettyPrint) !== 'undefined') {
    prettyPrint();
}
//--><!]]></script>

</body></html>