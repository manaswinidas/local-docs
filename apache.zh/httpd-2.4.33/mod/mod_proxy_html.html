<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type">
<title>mod_proxy_html-Apache HTTP服务器版本2.4</title>
<link href="../style/css/manual-zip.css" rel="stylesheet" type="text/css" title="Main stylesheet" media="all">
<link href="../style/css/manual-zip-100pc.css" rel="alternate stylesheet" type="text/css" title="No Sidebar - Default font size" media="all">
<link href="../style/css/manual-print.css" rel="stylesheet" type="text/css" media="print"><link rel="stylesheet" type="text/css" href="../style/css/prettify.css">
<script src="../style/scripts/prettify.min.js" type="text/javascript">
</script>
</head>
<body >
<div id="page-header">
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p>
<p class="apache">Apache HTTP服务器版本2.4</p>
<img alt="" src="../images/feather.png"></div>
<div class="up"><a href="./index.html"><img title="&lt;-" alt="&lt;-" src="../images/left.gif"></a></div>
<div id="path">
<a href="http://www.apache.org/">Apache</a> &gt; <a href="http://httpd.apache.org/">HTTP服务器</a> &gt; <a href="http://httpd.apache.org/docs/">文档</a> &gt; <a href="../index.html">版本2.4</a> &gt; <a href="./index.html">模块</a></div>
<div id="page-content">
<div id="preamble"><h1>Apache模块mod_proxy_html</h1>

<table class="module"><tr><th><a href="module-dict.html#Description">描述：</a></th><td>重写HTML链接，以确保可在代理上下文中从客户端的网络寻址它们。</td></tr>
<tr><th><a href="module-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="module-dict.html#ModuleIdentifier">模块�标识符：</a></th><td>proxy_html_module</td></tr>
<tr><th><a href="module-dict.html#SourceFile">源文件：</a></th><td>mod_proxy_html.c</td></tr>
<tr><th><a href="module-dict.html#Compatibility">兼容性：</a></th><td>2.4版及更高版本。作为早期2.x版本的第三方模块提供</td></tr></table>
<h3>摘要</h3>

<p>此模块提供输出过滤器，以在代理情况下重写HTML链接，以确保链接对代理外部的用户有效。它具有与Apache的ProxyPassReverse指令用于HTTP标头相同的目的，并且是反向代理的重要组成部分。</p>

<p>例如，如果公司在<code>appserver.example.com</code>上有一个应用程序服务器（仅在公司内部网络中可见），而公共Web服务器<code>www.example.com</code> ，则他们可能希望在<code>http://www.example.com/appserver/</code>上提供到该应用程序服务器的网关。 <code>http://www.example.com/appserver/</code> 。当应用服务器链接到其自身时，需要重写这些链接以通过网关工作。 mod_proxy_html用于将<code>&lt;a href="http://appserver.example.com/foo/bar.html"&gt;foobar&lt;/a&gt;</code>重写为<code>&lt;a href="http://www.example.com/appserver/foo/bar.html"&gt;foobar&lt;/a&gt;</code>使其可以从外部访问。</p>

<p>mod_proxy_html最初是在Web上开发的，其大量<a href="http://apache.webthing.com/mod_proxy_html/">文档</a>可能对用户有用。</p>
</div>
<div id="quickview"><a href="https://www.apache.org/foundation/contributing.html" class="badge"><img src="https://www.apache.org/images/SupportApache-small.png" alt="支持Apache！"></a><h3 class="directives">指令</h3>
<ul id="toc">
<li><img alt="" src="../images/down.gif"> <a href="#proxyhtmlbufsize">ProxyHTMLBufSize</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#proxyhtmlcharsetout">ProxyHTMLCharsetOut</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#proxyhtmldoctype">ProxyHTMLDocType</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#proxyhtmlenable">ProxyHTMLEnable</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#proxyhtmlevents">ProxyHTMLEvents</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#proxyhtmlextended">代理HTML扩展</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#proxyhtmlfixups">代理HTML修复</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#proxyhtmlinterp">代理HTMLInterp</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#proxyhtmllinks">代理HTML链接</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#proxyhtmlmeta">代理HTML元</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#proxyhtmlstripcomments">ProxyHTMLStrip评论</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#proxyhtmlurlmap">代理HTMLURLMap</a></li>
</ul>
<h3>错误修正清单</h3><ul class="seealso"><li><a href="https://www.apache.org/dist/httpd/CHANGES_2.4">httpd更新日志</a></li><li><a href="https://bz.apache.org/bugzilla/buglist.cgi?bug_status=__open__&amp;list_id=144532&amp;product=Apache httpd-2&amp;query_format=specific&amp;order=changeddate DESC%2Cpriority%2Cbug_severity&amp;component=mod_proxy_html">已知的问题</a></li><li><a href="https://bz.apache.org/bugzilla/enter_bug.cgi?product=Apache httpd-2&amp;component=mod_proxy_html">报告错误</a></li></ul></div>

<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ProxyHTMLBufSize" id="ProxyHTMLBufSize">ProxyHTMLBufSize</a> <a name="proxyhtmlbufsize" id="proxyhtmlbufsize">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>设置用于缓冲内联脚本和样式表的缓冲区大小增量。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ProxyHTMLBufSize <var>字节</var></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_proxy_html</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>2.4及更高版本；作为早期版本2.x的第三方提供</td></tr>
</table>
<p>为了解析嵌入在HTML文档中的非HTML内容（样式表和脚本），mod_proxy_html必须将整个脚本或样式表读取到缓冲区中。该缓冲区将根据需要扩展以容纳页面中最大的脚本或样式表，以该指令设置的<var>字节</var>为增量。</p>
<p>默认值为8192，几乎适用于所有页面。但是，如果您知道要代理的页面包含样式表和/或大于8K的脚本（即，对于单个脚本或样式表，不是总和），则设置更大的缓冲区大小将更加有效，从而避免了需要在请求期间动态调整缓冲区的大小。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ProxyHTMLCharsetOut" id="ProxyHTMLCharsetOut">ProxyHTMLCharsetOut</a> <a name="proxyhtmlcharsetout" id="proxyhtmlcharsetout">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>为mod_proxy_html输出指定一个字符集。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ProxyHTMLCharsetOut <var>字符集| *</var></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_proxy_html</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>2.4及更高版本；作为早期版本2.x的第三方提供</td></tr>
</table>
<p>这将为mod_proxy_html输出选择一种编码。通常不应该使用它，因为对默认<code>UTF-8</code> （Unicode-libxml2内部使用）的任何更改都会带来额外的处理开销。特殊令牌<code>ProxyHTMLCharsetOut *</code>将使用与输入相同的编码来生成输出。</p>
<p>请注意，这取决于要加载的<code class="module"><a href="../mod/mod_xml2enc.html">mod_xml2enc</a></code> 。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ProxyHTMLDocType" id="ProxyHTMLDocType">ProxyHTMLDocType</a> <a name="proxyhtmldoctype" id="proxyhtmldoctype">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>设置HTML或XHTML文档类型声明。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ProxyHTMLDocType HTML | XHTML [旧版]<br><strong>要么</strong>
<br>ProxyHTMLDocType <var>fpi</var> [SGML | XML]</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_proxy_html</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>2.4及更高版本；作为早期版本2.x的第三方提供</td></tr>
</table>
<p>在第一种形式中，根据所选选项，文档将被声明为HTML 4.01或XHTML 1.0。此选项还确定是将HTML还是XHTML语法用于输出。请注意，来自后端服务器的文档格式并不重要：解析器将自动处理它。如果将第二个可选参数设置为“旧版”，则文档将被声明为“过渡版”，如果您代理1998年之前的内容或使用有缺陷的创作/发布工具，则可能需要使用该选项。</p>
<p>在第二种形式中，它将插入您自己的FPI。可选的第二个参数确定将使用SGML / HTML还是XML / XHTML语法。</p>
<p>默认设置更改为忽略任何FPI，理由是没有FPI比伪造的FPI好。如果您的后端生成了不错的HTML或XHTML，请相应地进行设置。</p>
<p>如果使用第一种形式，则mod_proxy_html还将清理HTML到指定的标准。它不能解决所有错误，但是会去除伪造的元素和属性。它还可以选择在<code class="directive"><a href="../mod/core.html#loglevel">LogLevel</a></code>调试中记录其他错误。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ProxyHTMLEnable" id="ProxyHTMLEnable">ProxyHTMLEnable</a> <a name="proxyhtmlenable" id="proxyhtmlenable">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>打开或关闭proxy_html过滤器。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ProxyHTMLEnable开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>ProxyHTML启用关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_proxy_html</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>2.4及更高版本；作为早期2.x版本的第三方模块提供。</td></tr>
</table>
    <p>一个简单的开关，用于启用或禁用proxy_html过滤器。如果加载了<code class="module"><a href="../mod/mod_xml2enc.html">mod_xml2enc</a></code> ，它还将自动设置国际化支持。</p>
    <p>请注意，proxy_html过滤器仅对HTML数据（内容类型text / html或application / xhtml + xml）和代理数据起作用。您可以通过设置<var>PROXY_HTML_FORCE</var>环境变量来覆盖此方法（ <var>后果</var>自负）。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ProxyHTMLEvents" id="ProxyHTMLEvents">ProxyHTMLEvents</a> <a name="proxyhtmlevents" id="proxyhtmlevents">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>指定将属性视为脚本事件。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ProxyHTMLEvents <var>属性[属性...]</var></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_proxy_html</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>2.4及更高版本；作为早期版本2.x的第三方提供</td></tr>
</table>
<p>指定一个或多个属性，将其视为脚本事件，并将<code class="directive"><a href="#proxyhtmlurlmap">ProxyHTMLURLMap</a></code>应用于启用的位置。您可以在一个或多个<code class="directive">ProxyHTMLEvents</code>指令中指定任意数量的属性。</p>
<p>通常，您将在全局范围内进行设置。如果您在多个作用域中设置<code class="directive">ProxyHTMLEvents</code> ，以便一个覆盖另一个，则您需要在每个作用域中指定一个完整的集合。</p>
<p><var>proxy-html.conf中</var>提供了默认配置，并在标准HTML 4和XHTML 1中定义了事件。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ProxyHTMLExtended" id="ProxyHTMLExtended">ProxyHTML扩展</a> <a name="proxyhtmlextended" id="proxyhtmlextended">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>确定是否修复内联脚本，样式表和脚本事件中的链接。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ProxyHTML扩展开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>ProxyHTML扩展了</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_proxy_html</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>2.4及更高版本；作为早期版本2.x的第三方提供</td></tr>
</table>
<p>设置为<code>Off</code> ，将根据<code class="directive"><a href="#proxyhtmlurlmap">ProxyHTMLURLMap</a></code>指令重写HTML链接，但忽略Javascript和CSS中出现的链接。</p>
<p>设置为<code>On</code> ，根据每个规则设置的标志， <code class="directive"><a href="#proxyhtmlurlmap">ProxyHTMLURLMap</a></code>规则也会处理所有脚本事件（由<code class="directive"><a href="#proxyhtmlevents">ProxyHTMLEvents</a></code>确定）和嵌入式脚本或样式表。由于这需要更多的解析，因此，只有在严格必要时才启用它才能获得最佳性能。
</p><p>您还需要注意匹配的模式，因为解析器不知道嵌入式脚本或样式表中的URL是什么。特别地， <code>/</code>扩展匹配可能会导致错误匹配。
</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ProxyHTMLFixups" id="ProxyHTMLFixups">ProxyHTMLFixups</a> <a name="proxyhtmlfixups" id="proxyhtmlfixups">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>修复了简单的HTML错误。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ProxyHTMLFixups [小写] [dospath] [重置]</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_proxy_html</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>2.4及更高版本；作为早期版本2.x的第三方提供</td></tr>
</table>
<p>该指令采用一到三个参数，如下所示：</p>
<ul>
<li><code>lowercase</code> Urls重写为小写</li>
<li>URL中的<code>dospath</code>反斜杠被重写为正斜杠。</li>
<li><code>reset</code>取消配置中更高级别设置的任何选项。</li>
</ul>
<p>使用这些时要小心。这些修补程序将纠正某些创作错误，但也有可能错误地修复了开头正确的链接。仅当知道后端服务器损坏时才使用它们。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ProxyHTMLInterp" id="ProxyHTMLInterp">ProxyHTMLInterp</a> <a name="proxyhtmlinterp" id="proxyhtmlinterp">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>启用<code class="directive">ProxyHTMLURLMap</code>规则的按请求插值。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ProxyHTMLInterp开启|关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>ProxyHTMLInterp关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_proxy_html</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>2.4及更高版本；作为早期版本2.x的第三方提供</td></tr>
</table>
    <p>这样就可以在<code class="directive"><a href="#proxyhtmlurlmap">ProxyHTMLURLMap</a></code>模式中按请求进行插值。</p>
    <p>如果未启用插值，则将在启动时预编译所有规则。使用插值时，必须为每个请求重新编译它们，这意味着额外的处理开销。因此，仅应在必要时启用它。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ProxyHTMLLinks" id="ProxyHTMLLinks">ProxyHTMLLinks</a> <a name="proxyhtmllinks" id="proxyhtmllinks">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>指定具有要重写的URL属性的HTML元素。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ProxyHTMLLinks <var>元素属性[attribute2 ...]</var></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_proxy_html</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>2.4及更高版本；作为早期版本2.x的第三方提供</td></tr>
</table>
<p>指定具有应使用标准<code class="directive"><a href="#proxyhtmlurlmap">ProxyHTMLURLMap</a></code>重写的URL属性的元素。每个元素将需要一个<code class="directive">ProxyHTMLLinks</code>指令，但是它可以具有任意数量的属性。</p>
<p>通常，您将在全局范围内进行设置。如果您在多个作用域中设置<code class="directive">ProxyHTMLLinks</code> ，以便一个覆盖另一个，则需要在每个作用域中指定一个完整的集合。</p>
<p><var>proxy-html.conf中</var>提供了默认配置，并定义了标准HTML 4和XHTML 1的HTML链接。</p>
<div class="example"><h3>proxy-html.conf中的示例</h3><pre class="prettyprint lang-config">ProxyHTMLLinks  a          href
ProxyHTMLLinks  area       href
ProxyHTMLLinks  link       href
ProxyHTMLLinks  img        src longdesc usemap
ProxyHTMLLinks  object     classid codebase data usemap
ProxyHTMLLinks  q          cite
ProxyHTMLLinks  blockquote cite
ProxyHTMLLinks  ins        cite
ProxyHTMLLinks  del        cite
ProxyHTMLLinks  form       action
ProxyHTMLLinks  input      src usemap
ProxyHTMLLinks  head       profile
ProxyHTMLLinks  base       href
ProxyHTMLLinks  script     src for</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ProxyHTMLMeta" id="ProxyHTMLMeta">ProxyHTMLMeta</a> <a name="proxyhtmlmeta" id="proxyhtmlmeta">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>打开或关闭HTML <code>&lt;head&gt;</code>部分中元数据的额外预解析。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ProxyHTMLMeta开启|关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>ProxyHTMLMeta关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_proxy_html</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>2.4及更高版本；作为早期2.x版本的第三方模块提供。</td></tr>
</table>
    <p>这将打开或关闭HTML <code>&lt;head&gt;</code>部分中的元数据预解析。</p>
    <p>如果不需要，关闭ProxyHTMLMeta可以跳过此解析步骤，从而对性能有所提升。但是，有时国际化必须正常工作。</p>
    <p><code class="directive">ProxyHTMLMeta</code>有两个作用。首先也是最重要的是，它可以检测以以下形式声明的字符编码</p>
    <pre>&lt;meta http-equiv="Content-Type" content="text/html;charset=<var>foo</var>"&gt;</pre>
    <p>或者，对于XHTML文档，则为XML声明。如果字符集是在后端服务器的真实HTTP标头中声明的（总是比较可取），则该字符集也不是必需的，或者该文档是<var>utf-8</var> （unicode）或诸如ASCII之类的子集，则不需要。在文档使用通过<code class="directive"><a href="../mod/mod_xml2enc.html#xml2encdefault">xml2EncDefault</a></code>声明的默认值的情况下，您也可以省去它，但是这可能会传播错误的声明。<code class="directive"><a href="#proxyhtmlcharsetout">ProxyHTMLCharsetOut</a></code>可以消除这种风险，但与启用ProxyHTMLMeta相比，可能会带来更大的处理开销。</p>
    <p>启用<code class="directive">ProxyHTMLMeta</code>的另一个效果是解析所有<code>&lt;meta http-equiv=...&gt;</code>声明，并将它们转换为真实的HTTP标头，这与HTML &lt;meta&gt;元素的这种形式的初衷是一致的。</p>

    <div class="warning"><h3>警告</h3>因为ProxyHTMLMeta会将<strong>所有</strong> <code>http-equiv</code>元素提升为HTTP标头，所以仅在信任HTML内容和信任上游服务器的情况下才启用它是很重要的。如果HTML由不良行为者控制，则他们可能会向服务器的响应中注入任意的，可能是恶意的HTTP标头。
    </div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ProxyHTMLStripComments" id="ProxyHTMLStripComments">ProxyHTMLStripComments</a> <a name="proxyhtmlstripcomments" id="proxyhtmlstripcomments">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>确定是否删除HTML注释。</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ProxyHTMLStripComments开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>ProxyHTMLStrip评论已关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_proxy_html</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>2.4及更高版本；作为早期版本2.x的第三方提供</td></tr>
</table>
<p>该指令将导致mod_proxy_html剥离HTML注释。请注意，这也会杀死注释中嵌入的所有脚本或样式（1995年6月在Netscape 2中引入的一种笨拙性，是为了使以前的浏览器受益，但今天仍在使用）。它还可能会干扰基于注释的处理器，例如SSI或ESI：如果要删除注释，请确保在过滤器链中运行mod_proxy_html <em>之前的</em>任何处理器！</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ProxyHTMLURLMap" id="ProxyHTMLURLMap">ProxyHTMLURLMap</a> <a name="proxyhtmlurlmap" id="proxyhtmlurlmap">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>定义重写HTML链接的规则</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ProxyHTMLURLMap <var>从模式到模式[标志] [继续]</var></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_proxy_html</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>2.4及更高版本；作为早期2.x版本的第三方模块提供。</td></tr>
</table>
<p>这是重写HTML链接的关键指令。解析文档时，只要链接目标匹配<var>from-pattern</var> ，匹配的部分都将被重写为<var>to-pattern</var> ，这可以通过提供的任何标志以及<code class="directive"><a href="#proxyhtmlextended">ProxyHTMLExtended</a></code>指令进行修改。仅将使用<code class="directive"><a href="#proxyhtmllinks">ProxyHTMLLinks</a></code>指令指定的元素视为HTML链接。</p>

<p>可选的第三个参数可以定义以下任何<strong>Flags</strong> 。标志区分大小写。</p>
<dl>
<dt>H</dt>
<dd><p>忽略HTML链接（不更改地传递）</p></dd>
<dt>Ë</dt>
<dd><p>忽略脚本事件（通过原样传递）</p></dd>
<dt>C</dt>
<dd><p>完整地传递嵌入式脚本和样式部分。</p></dd>

<dt>大号</dt>
<dd><p>最后一场比赛。如果此规则匹配，则不再应用任何规则（请注意，这对于HTML链接会自动发生）。</p></dd>
<dt>升</dt>
<dd><p>与L相反。使用HTML链接覆盖一次更改的默认行为。</p></dd>
<dt>[R</dt>
<dd><p>使用正则表达式匹配和替换。 <code>from-pattern</code>是一个正则表达式，而<code>to-pattern</code>是一个基于正则表达式的替换字符串。支持正则表达式内存：您可以在<code>from-pattern</code>使用方括号（），并在<code>to-pattern</code>检索$ 1到$ 9的匹配项。</p>

<p>如果未设置R，它将使用字符串字面量的搜索和替换。逻辑<em>从</em> HTML链接开始，但<em>包含</em>在脚本事件以及嵌入式脚本和样式部分中。
</p>
</dd>
<dt>X</dt>
<dd><p>使用POSIX扩展正则表达式。仅适用于R。</p></dd>
<dt>一世</dt>
<dd><p>不区分大小写的匹配。仅适用于R。</p></dd>

<dt>ñ</dt>
<dd><p>禁用正则表达式内存（用于速度）。仅适用于R。</p></dd>
<dt>s</dt>
<dd><p>基于行的正则表达式匹配。仅适用于R。</p></dd>
<dt>^</dt>
<dd><p>仅在开始比赛。这仅适用于字符串匹配（不适用于正则表达式），与HTML链接无关。</p></dd>
<dt>$</dt>
<dd><p>仅在末尾比赛。这仅适用于字符串匹配（不适用于正则表达式），与HTML链接无关。</p></dd>
<dt>V</dt>
<dd><p>在<code>to-pattern</code>插值环境变量。<code>${varname|default}</code>形式的字符串将由环境变量<code>varname</code>的值替换。如果未设置，则<code>default</code>其替换。<code>|default</code>是可选的。</p>
<p>注意：仅当<code class="directive"><a href="#proxyhtmlinterp">ProxyHTMLInterp</a></code>为<var>On时</var>才会启用插值。</p>
</dd>

<dt>v</dt>
<dd><p>在<code>from-pattern</code>插值环境变量。支持的模式如上所述。</p>
<p>注意：仅当<code class="directive"><a href="#proxyhtmlinterp">ProxyHTMLInterp</a></code>为<var>On时</var>才会启用插值。</p>
</dd>
</dl>

<p>可选的第四个<strong>cond</strong>参数定义一个条件，如果<code class="directive"><a href="#proxyhtmlinterp">ProxyHTMLInterp</a></code>为<var>On</var> ，则将按请求评估该条件。如果条件评估为FALSE，则该地图将不会应用于此请求。如果为TRUE，或者未定义任何条件，则应用映射。</p>
<p><strong>cond</strong>由<a href="../expr.html">Expression Parser</a>评估。此外，还支持针对HTTPD 2.0和2.2的mod_proxy_html 3.x中的条件的更简单语法。</p>

</div>
</div>
<div id="footer">
<p class="apache">版权所有2018 The Apache Software Foundation。<br>根据<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache许可，版本2.0许可</a> 。</p>
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p></div><script type="text/javascript"><!--//--><![CDATA[//><!--
if (typeof(prettyPrint) !== 'undefined') {
    prettyPrint();
}
//--><!]]></script>
</body></html>