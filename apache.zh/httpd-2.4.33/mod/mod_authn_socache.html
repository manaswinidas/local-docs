<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type">
<title>mod_authn_socache-Apache HTTP服务器版本2.4</title>
<link href="../style/css/manual-zip.css" rel="stylesheet" type="text/css" title="Main stylesheet" media="all">
<link href="../style/css/manual-zip-100pc.css" rel="alternate stylesheet" type="text/css" title="No Sidebar - Default font size" media="all">
<link href="../style/css/manual-print.css" rel="stylesheet" type="text/css" media="print"><link rel="stylesheet" type="text/css" href="../style/css/prettify.css">
<script src="../style/scripts/prettify.min.js" type="text/javascript">
</script>
</head>
<body >
<div id="page-header">
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p>
<p class="apache">Apache HTTP服务器版本2.4</p>
<img alt="" src="../images/feather.png"></div>
<div class="up"><a href="./index.html"><img title="&lt;-" alt="&lt;-" src="../images/left.gif"></a></div>
<div id="path">
<a href="http://www.apache.org/">Apache</a> &gt; <a href="http://httpd.apache.org/">HTTP服务器</a> &gt; <a href="http://httpd.apache.org/docs/">文档</a> &gt; <a href="../index.html">版本2.4</a> &gt; <a href="./index.html">模块</a></div>
<div id="page-content">
<div id="preamble"><h1>Apache模块mod_authn_socache</h1>

<table class="module"><tr><th><a href="module-dict.html#Description">描述：</a></th><td>管理身份验证凭据的缓存以减轻后端的负担</td></tr>
<tr><th><a href="module-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="module-dict.html#ModuleIdentifier">模块�标识符：</a></th><td>authn_socache_module</td></tr>
<tr><th><a href="module-dict.html#SourceFile">源文件：</a></th><td>mod_authn_socache.c</td></tr>
<tr><th><a href="module-dict.html#Compatibility">兼容性：</a></th><td>2.3及更高版本</td></tr></table>
<h3>摘要</h3>

    <p>维护身份验证凭据的高速缓存，以便不需要对每个经过身份验证的请求进行新的后端查找。</p>
</div>
<div id="quickview"><a href="https://www.apache.org/foundation/contributing.html" class="badge"><img src="https://www.apache.org/images/SupportApache-small.png" alt="支持Apache！"></a><h3>话题</h3>
<ul id="topics">
<li><img alt="" src="../images/down.gif"> <a href="#intro">身份验证缓存</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#usage">用法</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#dev">使用自定义模块进行缓存</a></li>
</ul><h3 class="directives">指令</h3>
<ul id="toc">
<li><img alt="" src="../images/down.gif"> <a href="#authncachecontext">AuthnCacheContext</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#authncacheenable">AuthnCacheEnable</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#authncacheprovidefor">AuthnCacheProvideFor</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#authncachesocache">AuthnCacheSOCache</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#authncachetimeout">AuthnCacheTimeout</a></li>
</ul>
<h3>错误修正清单</h3><ul class="seealso"><li><a href="https://www.apache.org/dist/httpd/CHANGES_2.4">httpd更新日志</a></li><li><a href="https://bz.apache.org/bugzilla/buglist.cgi?bug_status=__open__&amp;list_id=144532&amp;product=Apache httpd-2&amp;query_format=specific&amp;order=changeddate DESC%2Cpriority%2Cbug_severity&amp;component=mod_authn_socache">已知的问题</a></li><li><a href="https://bz.apache.org/bugzilla/enter_bug.cgi?product=Apache httpd-2&amp;component=mod_authn_socache">报告错误</a></li></ul></div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="intro" id="intro">身份验证缓存</a></h2>
    <p>一些重量级身份验证的用户（例如SQL数据库查找（ <code class="module"><a href="../mod/mod_authn_dbd.html">mod_authn_dbd</a></code> ））报告说，这给他们的身份验证提供程序带来了不可接受的负担。一个典型的例子是HTML页面包含数百个对象（图像，脚本，样式表，媒体等），并且对该页面的请求会生成数百个对已认证的其他内容的有效即时请求。</p>
    <p>mod_authn_socache通过维护身份验证凭据的缓存来提供此问题的解决方案。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="usage" id="usage">用法</a></h2>
    <p>在身份验证查找对服务器，后端或网络造成较大负载的情况下，应使用身份验证缓存。通过文件（ <code class="module"><a href="../mod/mod_authn_file.html">mod_authn_file</a></code> ）或dbm（ <code class="module"><a href="../mod/mod_authn_dbm.html">mod_authn_dbm</a></code> ）进行身份验证不太可能受益，因为它们本身具有快速，轻便的特性（尽管在某些情况下，例如网络安装的文件，缓存可能是值得的）。其他提供程序（例如基于SQL或LDAP的身份验证）更可能受益，特别是在出现性能问题的情况下。在标准模块中， <code class="module"><a href="../mod/mod_authnz_ldap.html">mod_authnz_ldap</a></code>管理自己的缓存，因此通常只有<code class="module"><a href="../mod/mod_authn_dbd.html">mod_authn_dbd</a></code>可以从此缓存中受益。</p>
    <p>为提供程序缓存的基本规则是：</p>
    <ol><li>在<code class="directive">AuthnCacheProvideFor</code>指令中包括要缓存的提供程序。</li>
        <li>在<code class="directive"><a href="../mod/mod_auth_basic.html#authbasicprovider">AuthBasicProvider</a></code>或<code class="directive"><a href="../mod/mod_auth_digest.html#authdigestprovider">AuthDigestProvider</a></code>指令中，在要缓存的提供程序之前列出<var>socache</var> 。</li>
    </ol>
    <p>一个使用dbm作为缓存引擎来加速<code class="module"><a href="../mod/mod_authn_dbd.html">mod_authn_dbd</a></code>简单用法示例：</p>
    <pre class="prettyprint lang-config">#AuthnCacheSOCache is optional.  If specified, it is server-wide
AuthnCacheSOCache dbm
&lt;Directory "/usr/www/myhost/private"&gt;
    AuthType Basic
    AuthName "Cached Authentication Example"
    AuthBasicProvider socache dbd
    AuthDBDUserPWQuery "SELECT password FROM authn WHERE user = %s"
    AuthnCacheProvideFor dbd
    Require valid-user
    #Optional
    AuthnCacheContext dbd-authn-example
&lt;/Directory&gt;</pre>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="dev" id="dev">使用自定义模块进行缓存</a></h2>
    <p>模块开发人员应注意，必须启用其模块才能使用mod_authn_socache进行缓存。提供了一个可选的API函数<var>ap_authn_cache_store</var>来缓存提供者刚刚查找或生成的凭据。<a href="http://svn.eu.apache.org/viewvc?view=revision&amp;revision=957072">r957072</a>中提供了使用示例，其中启用了三个<a href="http://svn.eu.apache.org/viewvc?view=revision&amp;revision=957072">身份验证</a>提供程序进行缓存。</p>
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="AuthnCacheContext" id="AuthnCacheContext">AuthnCacheContext</a> <a name="authncachecontext" id="authncachecontext">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>指定要在缓存键中使用的上下文字符串</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>AuthnCacheContext <var>目录|服务器|自定义字符串</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>目录</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>目录</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_authn_socache</td></tr>
</table>
    <p>该伪指令指定一个字符串，该字符串与提供的用户名（在摘要式身份验证的情况下为领域）一起使用，以构造缓存密钥。这可消除为服务器上不同身份验证区域提供服务的相同用户名的歧义。</p>
    <p>为此，有两个特殊值： <var>directory</var> （使用请求的目录上下文作为字符串）和<var>server</var> （使用虚拟主机名）。</p>
    <p>默认值为<var>directory</var> ，这也是最保守的设置。这可能不是最佳选择，因为它（例如）导致<var>$ app-base</var> ， <var>$ app-base / images</var> ， <var>$ app-base / scripts</var>和<var>$ app-base / media</var>各自具有自己的单独的缓存键。更好的策略是为密码提供者命名<code class="directive">AuthnCacheContext</code> ：例如<var>htpasswd</var>文件或数据库表。</p>
    <p>可以在共享凭据的服务器的不同区域之间共享上下文。但是，这有可能成为跨站点或跨应用程序安全漏洞的媒介，因此在<var>.htaccess</var>上下文中不允许使用此指令。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="AuthnCacheEnable" id="AuthnCacheEnable">AuthnCacheEnable</a> <a name="authncacheenable" id="authncacheenable">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>启用在任何地方配置的身份验证缓存</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>AuthnCacheEnable</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_authn_socache</td></tr>
</table>
    <p>该指令通常不是必需的：如果在<var>httpd.conf中的</var>任何位置启用了身份验证缓存，则意味着该指令。但是，如果未在<var>httpd.conf中的</var>任何位置启用它，则默认情况下将不对其进行初始化，因此在<var>.htaccess</var>上下文中不可用。该指令确保将其初始化，以便可以在<var>.htaccess中使用</var> 。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="AuthnCacheProvideFor" id="AuthnCacheProvideFor">AuthnCacheProvideFor</a> <a name="authncacheprovidefor" id="authncacheprovidefor">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>指定要为其缓存的身份验证提供程序</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>AuthnCacheProvideFor身份验证<var>提供者</var> [...]</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>没有</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>目录.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>验证配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_authn_socache</td></tr>
</table>
    <p>此伪指令指定一个或多个身份验证提供程序进行缓存。未在AuthnCacheProvideFor指令中列出的提供者找到的凭据将不会被缓存。</p>

    <p>例如，要缓存由<code class="module"><a href="../mod/mod_authn_dbd.html">mod_authn_dbd</a></code>或自定义提供程序<var>myprovider</var>找到的凭据，但不要将那些由轻量级提供程序（如文件或dbm查找）查找的凭据保留：</p>
    <pre class="prettyprint lang-config">AuthnCacheProvideFor dbd myprovider</pre>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="AuthnCacheSOCache" id="AuthnCacheSOCache">AuthnCacheSOCache</a> <a name="authncachesocache" id="authncachesocache">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>选择要使用的socache后端提供程序</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>AuthnCacheSOCache <var>提供程序名称[：provider-args]</var></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_authn_socache</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>可选的提供程序参数在Apache HTTP Server 2.4.7和更高版本中可用</td></tr>
</table>
    <p>这是服务器范围的设置，用于为<a href="../socache.html">共享库缓存</a>选择提供程序，后跟该提供程序的可选参数。<var>provider-name的</var>某些可能值为“ dbm”，“ dc”，“ memcache”或“ shmcb”，每个值都取决于要加载的适当模块。如果未设置，将使用您平台的默认设置。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="AuthnCacheTimeout" id="AuthnCacheTimeout">AuthnCacheTimeout</a> <a name="authncachetimeout" id="authncachetimeout">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>设置缓存条目超时</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>AuthnCacheTimeout <var>超时</var> （秒）</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>300（5分钟）</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>目录.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>验证配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>基础</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_authn_socache</td></tr>
</table>
    <p>缓存身份验证数据可能是一个安全问题，尽管短期缓存不太可能成为问题。通常，一个很好的解决方案是将凭据缓存的时间尽可能长，以减轻后端的负载，但不要再缓存它，但是如果您不经常更改用户名和密码，则较长的超时时间可能适合您。默认的300秒（5分钟）既谨慎又充足，可以使dbd（SQL数据库查询）等后端的负载保持较低。</p>
    <p>这不应与会话超时混淆，后者是一个完全独立的问题。但是，您可能希望检查会话管理软件，以了解缓存的凭据是否可以“意外”扩展会话，并在设置超时时牢记这一点。</p>

</div>
</div>
<div id="footer">
<p class="apache">版权所有2018 The Apache Software Foundation。<br>根据<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache许可，版本2.0许可</a> 。</p>
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p></div><script type="text/javascript"><!--//--><![CDATA[//><!--
if (typeof(prettyPrint) !== 'undefined') {
    prettyPrint();
}
//--><!]]></script>
</body></html>