<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type">
<title>mod_ssl-Apache HTTP服务器版本2.4</title>
<link href="../style/css/manual-zip.css" rel="stylesheet" type="text/css" title="Main stylesheet" media="all">
<link href="../style/css/manual-zip-100pc.css" rel="alternate stylesheet" type="text/css" title="No Sidebar - Default font size" media="all">
<link href="../style/css/manual-print.css" rel="stylesheet" type="text/css" media="print"><link rel="stylesheet" type="text/css" href="../style/css/prettify.css">
<script src="../style/scripts/prettify.min.js" type="text/javascript">
</script>
</head>
<body >
<div id="page-header">
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p>
<p class="apache">Apache HTTP服务器版本2.4</p>
<img alt="" src="../images/feather.png"></div>
<div class="up"><a href="./index.html"><img title="&lt;-" alt="&lt;-" src="../images/left.gif"></a></div>
<div id="path">
<a href="http://www.apache.org/">Apache</a> &gt; <a href="http://httpd.apache.org/">HTTP服务器</a> &gt; <a href="http://httpd.apache.org/docs/">文档</a> &gt; <a href="../index.html">版本2.4</a> &gt; <a href="./index.html">模块</a></div>
<div id="page-content">
<div id="preamble"><h1>Apache模块mod_ssl</h1>

<table class="module"><tr><th><a href="module-dict.html#Description">描述：</a></th><td>使用安全套接字层（SSL）和传输层安全性（TLS）协议的强大加密</td></tr>
<tr><th><a href="module-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="module-dict.html#ModuleIdentifier">模块标识符：</a></th><td>ssl_module</td></tr>
<tr><th><a href="module-dict.html#SourceFile">源文件：</a></th><td>mod_ssl.c</td></tr></table>
<h3>摘要</h3>

<p>该模块为Apache HTTP Server提供SSL v3和TLS v1.x支持。不再支持SSL v2。</p>

<p>该模块依靠<a href="http://www.openssl.org/">OpenSSL</a>提供加密引擎。</p>

<p><a href="../ssl/index.html">SSL文档</a>中提供了更多详细信息，讨论和示例。</p>
</div>
<div id="quickview"><a href="https://www.apache.org/foundation/contributing.html" class="badge"><img src="https://www.apache.org/images/SupportApache-small.png" alt="支持Apache！"></a><h3>话题</h3>
<ul id="topics">
<li><img alt="" src="../images/down.gif"> <a href="#envvars">环境变量</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#logformats">自定义日志格式</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#notes">要求说明</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#expressionparser">表达式解析器扩展</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#authzproviders">与Require一起使用的授权提供者</a></li>
</ul><h3 class="directives">指令</h3>
<ul id="toc">
<li><img alt="" src="../images/down.gif"> <a href="#sslcacertificatefile">SSLCACertificateFile</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslcacertificatepath">SSLCACertificatePath</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslcadnrequestfile">SSLCADNRequestFile</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslcadnrequestpath">SSLCADNRequestPath</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslcarevocationcheck">SSLCARevocationCheck</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslcarevocationfile">SSLCARevocationFile</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslcarevocationpath">SSLCARevocationPath</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslcertificatechainfile">SSLCertificateChainFile</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslcertificatefile">SSLCertificateFile</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslcertificatekeyfile">SSLCertificateKeyFile</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslciphersuite">SSLCipherSuite</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslcompression">SSL压缩</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslcryptodevice">SSLCryptoDevice</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslengine">SSL引擎</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslfips">SSLFIPS</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslhonorcipherorder">SSLHonorCipherOrder</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslinsecurerenegotiation">SSL不安全重新协商</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslocspdefaultresponder">SSLOCSPDefaultResponder</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslocspenable">SSLOCSP启用</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslocspnoverify">SSLOCSPNoverify</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslocspoverrideresponder">SSLOCSPOverrideResponder</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslocspproxyurl">SSLOCSPProxyURL</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslocsprespondercertificatefile">SSLOCSPResponderCertificateFile</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslocsprespondertimeout">SSLOCSPResponderTimeout</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslocspresponsemaxage">SSLOCSPResponseMaxAge</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslocspresponsetimeskew">SSLOCSPResponseTimeSkew</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslocspuserequestnonce">SSLOCSPUseRequestNonce</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslopensslconfcmd">SSLOpenSSLConfCmd</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#ssloptions">SSLOptions</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslpassphrasedialog">SSLPassPhraseDialog</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslprotocol">SSL协议</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxycacertificatefile">SSLProxyCACertificateFile</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxycacertificatepath">SSLProxyCACertificatePath</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxycarevocationcheck">SSLProxyCARevocationCheck</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxycarevocationfile">SSLProxyCARevocationFile</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxycarevocationpath">SSLProxyCARevocationPath</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxycheckpeercn">SSLProxyCheckPeerCN</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxycheckpeerexpire">SSLProxyCheckPeerExpire</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxycheckpeername">SSLProxyCheckPeerName</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxyciphersuite">SSLProxyCipherSuite</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxyengine">SSLProxyEngine</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxymachinecertificatechainfile">SSLProxyMachineCertificateChainFile</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxymachinecertificatefile">SSLProxyMachineCertificateFile</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxymachinecertificatepath">SSLProxyMachineCertificatePath</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxyprotocol">SSLProxy协议</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxyverify">SSLProxyVerify</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslproxyverifydepth">SSLProxyVerifyDepth</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslrandomseed">SSL随机种子</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslrenegbuffersize">SSLRenegBufferSize</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslrequire">SSLRequire</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslrequiressl">SSL要求</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslsessioncache">SSLSessionCache</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslsessioncachetimeout">SSLSessionCacheTimeout</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslsessionticketkeyfile">SSLSessionTicketKeyFile</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslsessiontickets">SSLSessionTickets</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslsrpunknownuserseed">SSLSRPUnknownUserSeed</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslsrpverifierfile">SSLSRPVerifierFile</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslstaplingcache">SSLStaplingCache</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslstaplingerrorcachetimeout">SSLStaplingErrorCacheTimeout</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslstaplingfaketrylater">SSLStaplingFakeTryLater</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslstaplingforceurl">SSLStaplingForceURL</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslstaplingrespondertimeout">SSLStaplingResponderTimeout</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslstaplingresponsemaxage">SSLStaplingResponseMaxAge</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslstaplingresponsetimeskew">SSLStaplingResponseTimeSkew</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslstaplingreturnrespondererrors">SSLStaplingReturnResponderErrors</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslstaplingstandardcachetimeout">SSLStaplingStandardCacheTimeout</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslstrictsnivhostcheck">SSLStrictSNIVHostCheck</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslusername">SSLUserName</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslusestapling">SSLUseStapling</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslverifyclient">SSLVerifyClient</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#sslverifydepth">SSLVerifyDepth</a></li>
</ul>
<h3>错误修正清单</h3><ul class="seealso"><li><a href="https://www.apache.org/dist/httpd/CHANGES_2.4">httpd更新日志</a></li><li><a href="https://bz.apache.org/bugzilla/buglist.cgi?bug_status=__open__&amp;list_id=144532&amp;product=Apache httpd-2&amp;query_format=specific&amp;order=changeddate DESC%2Cpriority%2Cbug_severity&amp;component=mod_ssl">已知的问题</a></li><li><a href="https://bz.apache.org/bugzilla/enter_bug.cgi?product=Apache httpd-2&amp;component=mod_ssl">报告错误</a></li></ul></div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="envvars" id="envvars">环境变量</a></h2>

<p>可以配置该模块以提供几项SSL信息，作为SSI和CGI名称空间的附加环境变量。由于性能原因，默认情况下不提供此信息。（请参阅下面的<code class="directive">SSLOptions</code> StdEnvVars。）下表列出了生成的变量。为了向后兼容，也可以使用其他名称提供该信息。在“ <a href="../ssl/ssl_compat.html">兼容性”</a>一章中查找有关兼容性变量的详细信息。</p>

<table class="bordered">

<tr>
 <th><a name="table3">变量名：</a></th>
 <th>值类型：</th>
 <th>描述：</th>
</tr>
<tr><td><code>HTTPS</code></td>                         <td>旗</td>      <td>正在使用HTTPS。</td></tr>
<tr><td><code>SSL_PROTOCOL</code></td>                  <td>串</td>    <td>SSL协议版本（SSLv3，TLSv1，TLSv1.1，TLSv1.2）</td></tr>
<tr><td><code>SSL_SESSION_ID</code></td>                <td>串</td>    <td>十六进制编码的SSL会话ID</td></tr>
<tr><td><code>SSL_SESSION_RESUMED</code></td>           <td>串</td>    <td>初始或恢复的SSL会话。注意：如果正在使用HTTP KeepAlive，则可以通过同一（初始或恢复）SSL会话处理多个请求</td></tr>
<tr><td><code>SSL_SECURE_RENEG</code></td>              <td>串</td>    <td>如果支持安全重新协商，则为<code>true</code> ，否则为<code>false</code></td></tr>
<tr><td><code>SSL_CIPHER</code></td>                    <td>串</td>    <td>密码规范名称</td></tr>
<tr><td><code>SSL_CIPHER_EXPORT</code></td>             <td>串</td>    <td>如果密码是出口密码，则为<code>true</code></td></tr>
<tr><td><code>SSL_CIPHER_USEKEYSIZE</code></td>         <td>数</td>    <td>密码位数（实际使用）</td></tr>
<tr><td><code>SSL_CIPHER_ALGKEYSIZE</code></td>         <td>数</td>    <td>密码位数（可能）</td></tr>
<tr><td><code>SSL_COMPRESS_METHOD</code></td>           <td>串</td>    <td>协商SSL压缩方法</td></tr>
<tr><td><code>SSL_VERSION_INTERFACE</code></td>         <td>串</td>    <td>mod_ssl程序版本</td></tr>
<tr><td><code>SSL_VERSION_LIBRARY</code></td>           <td>串</td>    <td>OpenSSL程序版本</td></tr>
<tr><td><code>SSL_CLIENT_M_VERSION</code></td>          <td>串</td>    <td>客户端证书的版本</td></tr>
<tr><td><code>SSL_CLIENT_M_SERIAL</code></td>           <td>串</td>    <td>客户端证书的序列号</td></tr>
<tr><td><code>SSL_CLIENT_S_DN</code></td>               <td>串</td>    <td>客户证书中的主题DN</td></tr>
<tr><td><code>SSL_CLIENT_S_DN_</code> <em>x509</em></td> <td>串</td>    <td>客户的主题DN的组成部分</td></tr>
<tr><td><code>SSL_CLIENT_SAN_Email_</code> <em>n</em></td> <td>串</td>  <td>客户端证书的subjectAltName扩展条目，类型为rfc822Name</td></tr>
<tr><td><code>SSL_CLIENT_SAN_DNS_</code> <em>n</em></td> <td>串</td>    <td>客户端证书的dNSName类型的subjectAltName扩展条目</td></tr>
<tr><td><code>SSL_CLIENT_SAN_OTHER_msUPN_</code> <em>n</em></td> <td>串</td>    <td>客户端证书的subjectAltName扩展条目，其类型为otherName，Microsoft用户主体名称形式（OID 1.3.6.1.4.1.311.20.2.3）</td></tr>
<tr><td><code>SSL_CLIENT_I_DN</code></td>               <td>串</td>    <td>客户证书的发行人DN</td></tr>
<tr><td><code>SSL_CLIENT_I_DN_</code> <em>x509</em></td> <td>串</td>    <td>客户发行人DN的组成部分</td></tr>
<tr><td><code>SSL_CLIENT_V_START</code></td>            <td>串</td>    <td>客户证书的有效期（开始时间）</td></tr>
<tr><td><code>SSL_CLIENT_V_END</code></td>              <td>串</td>    <td>客户证书的有效期（结束时间）</td></tr>
<tr><td><code>SSL_CLIENT_V_REMAIN</code></td>           <td>串</td>    <td>直到客户的证书过期的天数</td></tr>
<tr><td><code>SSL_CLIENT_A_SIG</code></td>              <td>串</td>    <td>用于客户证书签名的算法</td></tr>
<tr><td><code>SSL_CLIENT_A_KEY</code></td>              <td>串</td>    <td>用于客户证书公钥的算法</td></tr>
<tr><td><code>SSL_CLIENT_CERT</code></td>               <td>串</td>    <td>PEM编码的客户证书</td></tr>
<tr><td><code>SSL_CLIENT_CERT_CHAIN_</code> <em>n</em></td> <td>串</td>    <td>客户端证书链中的PEM编码证书</td></tr>
<tr><td><code>SSL_CLIENT_CERT_RFC4523_CEA</code></td>   <td>串</td>    <td>证书的序列号和颁发者。格式与RFC4523中的CertificateExactAssertion格式匹配</td></tr>
<tr><td><code>SSL_CLIENT_VERIFY</code></td>             <td>串</td>    <td><code>NONE</code> ， <code>SUCCESS</code> ， <code>GENEROUS</code>或<code>FAILED:</code> <em>原因</em></td></tr>
<tr><td><code>SSL_SERVER_M_VERSION</code></td>          <td>串</td>    <td>服务器证书的版本</td></tr>
<tr><td><code>SSL_SERVER_M_SERIAL</code></td>           <td>串</td>    <td>服务器证书的序列号</td></tr>
<tr><td><code>SSL_SERVER_S_DN</code></td>               <td>串</td>    <td>服务器证书中的主题DN</td></tr>
<tr><td><code>SSL_SERVER_SAN_Email_</code> <em>n</em></td> <td>串</td>  <td>服务器证书的subjectAltName扩展条目，类型为rfc822Name</td></tr>
<tr><td><code>SSL_SERVER_SAN_DNS_</code> <em>n</em></td> <td>串</td>    <td>服务器证书的dNSName类型的subjectAltName扩展条目</td></tr>
<tr><td><code>SSL_SERVER_SAN_OTHER_dnsSRV_</code> <em>n</em></td> <td>串</td>    <td>服务器证书的subjectAltName扩展条目，其类型为otherName，SRVName格式（OID 1.3.6.1.5.5.7.8.7，RFC 4985）</td></tr>
<tr><td><code>SSL_SERVER_S_DN_</code> <em>x509</em></td> <td>串</td>    <td>服务器的主题DN的组件</td></tr>
<tr><td><code>SSL_SERVER_I_DN</code></td>               <td>串</td>    <td>服务器证书的颁发者DN</td></tr>
<tr><td><code>SSL_SERVER_I_DN_</code> <em>x509</em></td> <td>串</td>    <td>服务器的发行者DN的组件</td></tr>
<tr><td><code>SSL_SERVER_V_START</code></td>            <td>串</td>    <td>服务器证书的有效性（开始时间）</td></tr>
<tr><td><code>SSL_SERVER_V_END</code></td>              <td>串</td>    <td>服务器证书的有效期（结束时间）</td></tr>
<tr><td><code>SSL_SERVER_A_SIG</code></td>              <td>串</td>    <td>用于服务器证书签名的算法</td></tr>
<tr><td><code>SSL_SERVER_A_KEY</code></td>              <td>串</td>    <td>用于服务器证书公钥的算法</td></tr>
<tr><td><code>SSL_SERVER_CERT</code></td>               <td>串</td>    <td>PEM编码的服务器证书</td></tr>
<tr><td><code>SSL_SRP_USER</code></td>                  <td>串</td>    <td>SRP用户名</td></tr>
<tr><td><code>SSL_SRP_USERINFO</code></td>              <td>串</td>    <td>SRP用户信息</td></tr>
<tr><td><code>SSL_TLS_SNI</code></td>                   <td>串</td>    <td>SNI TLS扩展的内容（如果ClientHello提供）</td></tr>
</table>

<p><em>x509</em>指定X.509 DN的组件； <code>C,ST,L,O,OU,CN,T,I,G,S,D,UID,Email</code> 。在httpd 2.2.0和更高版本中， <em>x509</em>也可以包含数字<code>_n</code>后缀。如果所讨论的DN包含具有相同名称的多个属性，则此后缀用作从零开始的索引，以选择特定的属性。例如，在服务器证书主题DN包含两个OU属性的情况下，可以使用<code>SSL_SERVER_S_DN_OU_0</code>和<code>SSL_SERVER_S_DN_OU_1</code>来分别引用。不带后缀<code>_n</code>变量名等同于带后缀<code>_0</code>的变量名。第一个（或唯一）属性。当使用<code class="directive"><a href="#ssloptions">SSLOptions</a></code>伪指令的<code>StdEnvVars</code>选项填充环境表时，任何DN的第一个（或唯一）属性仅在未加后缀的名称下添加；否则，将添加第一个（或唯一）属性。即，没有添加<code>_0</code>后缀的条目。</p>

<p>在httpd 2.4.32和更高版本中，可以将可选的<em>_RAW</em>后缀添加到DN组件的<em>x509</em>中，以禁止将属性值转换为UTF-8。必须将其放置在索引后缀（如果有）之后。例如，可以使用<code>SSL_SERVER_S_DN_OU_RAW</code>或<code>SSL_SERVER_S_DN_OU_0_RAW</code> 。</p>

<p><em>* _DN</em>变量的格式在Apache HTTPD 2.3.11中已更改。有关详细信息，请参见<code class="directive"><a href="#ssloptions">SSLOptions</a></code>的<code>LegacyDNStringFormat</code>选项。</p>

<p><code>SSL_CLIENT_V_REMAIN</code>仅在2.1版和更高版本中可用。</p>

<p>还可以在<code class="directive">SSLRequire</code>表达式或自定义日志格式中使用许多其他环境变量：</p>

<div class="note"><pre>HTTP_USER_AGENT        PATH_INFO             AUTH_TYPE
HTTP_REFERER           QUERY_STRING          SERVER_SOFTWARE
HTTP_COOKIE            REMOTE_HOST           API_VERSION
HTTP_FORWARDED         REMOTE_IDENT          TIME_YEAR
HTTP_HOST              IS_SUBREQ             TIME_MON
HTTP_PROXY_CONNECTION  DOCUMENT_ROOT         TIME_DAY
HTTP_ACCEPT            SERVER_ADMIN          TIME_HOUR
THE_REQUEST            SERVER_NAME           TIME_MIN
REQUEST_FILENAME       SERVER_PORT           TIME_SEC
REQUEST_METHOD         SERVER_PROTOCOL       TIME_WDAY
REQUEST_SCHEME         REMOTE_ADDR           TIME
REQUEST_URI            REMOTE_USER</pre></div>

<p>在这些情况下，也可以使用两种特殊格式：</p>

<dl>
  <dt><code>ENV： <em>变量名</em></code></dt>
  <dd>这将扩展为标准环境变量<em>variablename</em> 。</dd>

  <dt><code><em>HTTP：headername</em></code></dt>
  <dd>这将扩展为名称为<em>headername</em>的请求标头的值。</dd>
</dl>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="logformats" id="logformats">自定义日志格式</a></h2>

<p>当将<code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code>内置到Apache中或至少加载（在DSO情况下）时，存在针对<code class="module"><a href="../mod/mod_log_config.html">mod_log_config</a></code>的<a href="mod_log_config.html#formats">自定义日志格式</a>的附加功能。首先，还有一个额外的`` <code>%{</code> <em>varname</em> <code>}x</code> x''eXtension格式函数，可用于扩展任何模块提供的任何变量，尤其是可以在上表中找到的mod_ssl提供的变量。</p>
<p>为了向后兼容，还提供了特殊的“ <code>%{</code> <em>name</em> <code>}c</code> ”加密格式功能。在<a href="../ssl/ssl_compat.html">兼容性</a>一章中提供了有关此功能的信息。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">CustomLog "logs/ssl_request_log" "%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \"%r\" %b"</pre>
</div>
<p>这些格式甚至可以在不设置<code class="directive"><a href="#ssloptions">SSLOptions</a></code>指令的<code>StdEnvVars</code>选项的情况下工作。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="notes" id="notes">要求说明</a></h2>

<p><code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code>为请求设置“注释”，可在<code class="module"><a href="../mod/mod_log_config.html">mod_log_config</a></code>使用<code>%{ <em>name</em> }n</code>格式字符串在<code class="module"><a href="../mod/mod_log_config.html">mod_log_config</a></code> 。</p>

<p>支持的注释如下：</p>

<dl>
  <dt><code>ssl禁止访问</code></dt>
  <dd>如果由于<code class="directive">SSLRequire</code>或<code class="directive">SSLRequireSSL</code>指令而拒绝访问，则此注释的值设置为<code>1</code> 。</dd>

  <dt><code>ssl-secure-reneg</code></dt>
  <dd>如果针对支持安全重新协商扩展的OpenSSL版本构建了<code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code>则如果当前连接使用SSL，则此注释的值设置为<code>1</code> ，并且客户端也支持安全重新协商扩展。如果客户端不支持安全重新协商扩展，则注释将设置为值<code>0</code> 。如果未针对支持安全重新协商的OpenSSL版本构建<code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code> ，或者当前连接未使用SSL，则不会设置注释。</dd>
</dl>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="expressionparser" id="expressionparser">表达式解析器扩展</a></h2>

<p>当将<code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code>内置到Apache中或至少加载（在DSO情况下）时，可以在<a href="../expr.html">ap_expr Expression Parser的</a>表达式中使用<code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code>提供的任何<a name="envvars">变量</a> 。可以使用语法`` <code>%{</code> <em>varname</em> <code>}</code> ''引用变量。从版本2.4.18开始，还可以使用<code class="module"><a href="../mod/mod_rewrite.html">mod_rewrite</a></code>样式语法`` <code>%{SSL:</code> <em>varname</em> <code>}</code> ”或函数样式语法“ <code>ssl(</code> <em>varname</em> <code>)</code> ”。</p>
<div class="example"><h3>示例（使用<code class="module"><a href="../mod/mod_headers.html">mod_headers</a></code> ）</h3><pre class="prettyprint lang-config">Header set X-SSL-PROTOCOL "expr=%{SSL_PROTOCOL}"
Header set X-SSL-CIPHER "expr=%{SSL:SSL_CIPHER}"</pre>
</div>
<p>该功能甚至可以在不设置<code class="directive"><a href="#ssloptions">SSLOptions</a></code>指令的<code>StdEnvVars</code>选项的情况下运行。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="authzproviders" id="authzproviders">与Require一起使用的授权提供者</a></h2>

  <p><code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code>提供了一些身份验证提供程序，可与<code class="module"><a href="../mod/mod_authz_core.html">mod_authz_core</a></code>的<code class="directive"><a href="../mod/mod_authz_core.html#require">Require</a></code>指令一起使用。</p>

  <h3><a name="reqssl" id="reqssl">需要ssl</a></h3>

    <p>如果未使用SSL加密连接，则<code>ssl</code>提供程序将拒绝访问。这类似于<code class="directive">SSLRequireSSL</code>指令。</p>

    <pre class="prettyprint lang-config">Require ssl</pre>


  

  <h3><a name="reqverifyclient" id="reqverifyclient">需要ssl-verify-client</a></h3>

    <p>如果使用有效的客户端证书对用户进行身份验证，则<code>ssl</code>提供程序允许访问。仅当<code>SSLVerifyClient optional</code>有效时， <code>SSLVerifyClient optional</code>才有用。</p>

    <p>如果用户通过客户端证书或用户名和密码进行了身份验证，则以下示例授予访问权限。</p>

    <pre class="prettyprint lang-config">Require ssl-verify-client
Require valid-user</pre>


  

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLCACertificateFile" id="SSLCACertificateFile">SSLCACertificateFile</a> <a name="sslcacertificatefile" id="sslcacertificatefile">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>用于客户端身份验证的串联PEM编码的CA证书文件</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLCACertificateFile <em>文件路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>该指令设置了<em>一个多</em>文件，您可以在其中汇编与您处理其<em>客户</em>的证书颁发机构的证书（CA）。这些用于客户端身份验证。按照优先顺序，此文件只是各种PEM编码的证书文件的串联。可以替代和/或附加使用<code class="directive"><a href="#sslcacertificatepath">SSLCACertificatePath</a></code> 。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLCACertificateFile "/usr/local/apache2/conf/ssl.crt/ca-bundle-client.crt"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLCACertificatePath" id="SSLCACertificatePath">SSLCACertificatePath</a> <a name="sslcacertificatepath" id="sslcacertificatepath">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>用于客户端身份验证的PEM编码的CA证书目录</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLCACertificatePath <em>目录路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此伪指令设置目录，在该目录中保留与您处理客户的证书颁发机构证书（CA）。这些用于验证客户端身份验证上的客户端证书。</p>
<p>此目录中的文件必须经过PEM编码，并可以通过哈希文件名进行访问。因此，通常不能只将证书文件放在此处：还必须创建名为<em>hash-value的</em>符号链接<code>.N</code>并且您应始终确保此目录包含适当的符号链接。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLCACertificatePath "/usr/local/apache2/conf/ssl.crt/"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLCADNRequestFile" id="SSLCADNRequestFile">SSLCADNRequestFile</a> <a name="sslcadnrequestfile" id="sslcadnrequestfile">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>连接的PEM编码的CA证书文件，用于定义可接受的CA名称</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLCADNRequestFile <em>文件路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>当mod_ssl请求客户端证书时， <em>可接受的证书颁发机构名称</em>列表将通过SSL握手发送给客户端。客户端可以使用这些CA名称从可用的证书中选择适当的客户端证书。</p>

<p>如果没有给出伪指令<code class="directive"><a href="#sslcadnrequestpath">SSLCADNRequestPath</a></code>或<code class="directive"><a href="#sslcadnrequestfile">SSLCADNRequestFile</a></code> ，则发送给客户端的可接受的CA名称集就是<code class="directive"><a href="#sslcacertificatefile">SSLCACertificateFile</a></code>和<code class="directive"><a href="#sslcacertificatepath">SSLCACertificatePath</a></code>伪指令所给出的所有CA证书的名称；换句话说，实际上将用于验证客户端证书的CA的名称。</p>

<p>在某些情况下，能够发送一组可接受的CA名称是有用的，该名称与用于验证客户端证书的实际CA不同（例如，如果客户端证书是由中间CA签名的）。在这种情况下，可以使用<code class="directive"><a href="#sslcadnrequestpath">SSLCADNRequestPath</a></code>和/或<code class="directive"><a href="#sslcadnrequestfile">SSLCADNRequestFile</a></code> 。然后，从这对指令指定的目录和/或文件中的完整证书集中获取可接受的CA名称。</p>

<p><code class="directive"><a href="#sslcadnrequestfile">SSLCADNRequestFile</a></code>必须指定一个包含PEM编码的CA证书的串联的<em>多合一</em>文件。</p>

<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLCADNRequestFile "/usr/local/apache2/conf/ca-names.crt"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLCADNRequestPath" id="SSLCADNRequestPath">SSLCADNRequestPath</a> <a name="sslcadnrequestpath" id="sslcadnrequestpath">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>用于定义可接受的CA名称的PEM编码的CA证书目录</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLCADNRequestPath <em>目录路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>

<p>此可选指令可用于指定一组<em>可接受的CA名称</em> ，当请求客户端证书时，这些<em>名称</em>将发送给客户端。有关更多详细信息，请参见<code class="directive"><a href="#sslcadnrequestfile">SSLCADNRequestFile</a></code>指令。</p>

<p>此目录中的文件必须经过PEM编码，并可以通过哈希文件名进行访问。因此，通常不能只将证书文件放在此处：还必须创建名为<em>hash-value的</em>符号链接<code>.N</code>并且您应该始终确保该目录包含适当的符号链接。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLCADNRequestPath "/usr/local/apache2/conf/ca-names.crt/"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLCARevocationCheck" id="SSLCARevocationCheck">SSLCARevocationCheck</a> <a name="sslcarevocationcheck" id="sslcarevocationcheck">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>启用基于CRL的吊销检查</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLCARevocationCheck链|叶|无<em>标志</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLCARevocation检查无</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>在httpd 2.4.21或更高版本中可用的可选<em>标志</em></td></tr>
</table>
<p>启用证书吊销列表（CRL）检查。必须配置<code class="directive"><a href="#sslcarevocationfile">SSLCARevocationFile</a></code>或<code class="directive"><a href="#sslcarevocationpath">SSLCARevocationPath</a></code>至少一个。设置为<code>chain</code> （推荐设置）时，CRL检查将应用于链中的所有证书，而将其设置为<code>leaf</code>则将检查限制为最终实体证书。
</p>
<p>可用的<em>标志</em>为：</p>
<ul>
<li><code>no_crl_for_cert_ok</code>
    <p>在版本2.3.15之前，如果在任何使用<code class="directive"><a href="#sslcarevocationfile">SSLCARevocationFile</a></code>或<code class="directive"><a href="#sslcarevocationpath">SSLCARevocationPath</a></code>配置的位置中均未找到已检查证书的CRL，则mod_ssl中的CRL检查也成功。
    </p>
    <p>随着<code class="directive">SSLCARevocationFile</code>的引入，行为已更改：默认情况下使用<code>chain</code>或<code>leaf</code> ， <strong>必须</strong>存在CRL <strong>才能</strong>使验证成功-否则它将失败，并显示<code>"unable to get certificate CRL"</code>错误。
    </p>
    <p><em>标志</em> <code>no_crl_for_cert_ok</code>允许恢复以前的行为。
    </p>
</li>
</ul>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLCARevocationCheck chain</pre>
</div>
<div class="example"><h3>与2.2版的兼容性</h3><pre class="prettyprint lang-config">SSLCARevocationCheck chain no_crl_for_cert_ok</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLCARevocationFile" id="SSLCARevocationFile">SSLCARevocationFile</a> <a name="sslcarevocationfile" id="sslcarevocationfile">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>用于客户端身份验证的串联PEM编码的CA CRL文件</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLCARevocationFile <em>文件路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>该指令设置了<em>一个多</em>文件，您可以在其中汇编与您处理其<em>客户</em>的证书颁发机构（CA）的证书吊销列表（CRL）。这些用于客户端身份验证。按照优先顺序，此文件只是各种PEM编码的CRL文件的串联。可以替代和/或附加使用<code class="directive"><a href="#sslcarevocationpath">SSLCARevocationPath</a></code> 。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLCARevocationFile "/usr/local/apache2/conf/ssl.crl/ca-bundle-client.crl"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLCARevocationPath" id="SSLCARevocationPath">SSLCARevocationPath</a> <a name="sslcarevocationpath" id="sslcarevocationpath">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>用于客户端身份验证的PEM编码的CA CRL目录</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLCARevocationPath <em>目录路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此伪指令设置目录，在该目录中保留与您处理其客户的证书颁发机构（CA）的证书吊销列表（CRL）。这些用于撤销客户端身份验证上的客户端证书。</p>
<p>此目录中的文件必须经过PEM编码，并可以通过哈希文件名进行访问。因此，通常您不仅要将CRL文件放在此处。另外，您必须创建名为<em>hash-value</em> <code>.rN</code>符号链接。并且您应始终确保此目录包含适当的符号链接。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLCARevocationPath "/usr/local/apache2/conf/ssl.crl/"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLCertificateChainFile" id="SSLCertificateChainFile">SSLCertificateChainFile</a> <a name="sslcertificatechainfile" id="sslcertificatechainfile">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>PEM编码的服务器CA证书文件</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLCertificateChainFile <em>文件路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<div class="note"><h3>不推荐使用SSLCertificateChainFile</h3>
<p><code>SSLCertificateChainFile</code>在版本2.4.8中已过时， <code class="directive"><a href="#sslcertificatefile">SSLCertificateFile</a></code>是因为<code class="directive"><a href="#sslcertificatefile">SSLCertificateFile</a></code>进行了扩展以从服务器证书文件中加载中间CA证书。</p>
</div>

<p>此伪指令设置可选<em>的多合一</em>文件，您可以在其中组装构成服务器证书的证书链的证书颁发机构（CA）的证书。这从服务器证书的颁发CA证书开始，并且可以扩展到根CA证书。这样的文件只是各种PEM编码的CA证书文件的串联，通常以证书链顺序排列。</p>
<p>这应该替代<code class="directive"><a href="#sslcacertificatepath">SSLCACertificatePath</a></code>和/或与<code class="directive"><a href="#sslcacertificatepath">SSLCACertificatePath</a></code>以显式构造服务器证书链，该证书链除了服务器证书外还发送到浏览器。使用客户端身份验证时，避免与CA证书冲突特别有用。因为尽管将服务器证书链的CA证书放入<code class="directive"><a href="#sslcacertificatepath">SSLCACertificatePath</a></code>对证书链构造具有相同的效果，但是它具有副作用，即在客户端身份验证中也接受由同一CA证书颁发的客户端证书。</p>
<p>但请注意：仅在使用<em>单个</em>基于RSA <em>或</em> DSA的服务器证书时，提供证书链才有效。如果您使用耦合的RSA + DSA证书对，则只有在两个证书实际上都使用<em>相同的</em>证书链的情况下，此方法才有效。在这种情况下，其他浏览器会感到困惑。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLCertificateChainFile "/usr/local/apache2/conf/ssl.crt/ca.crt"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLCertificateFile" id="SSLCertificateFile">SSLCertificateFile</a> <a name="sslcertificatefile" id="sslcertificatefile">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>服务器PEM编码的X.509证书数据文件</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLCertificateFile <em>文件路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>该指令指向带有PEM格式的证书数据的文件。至少，该文件必须包含最终实体（叶子）证书。该指令可以多次使用（引用不同的文件名）以支持服务器认证的多种算法-通常为RSA，DSA和ECC。支持的算法数量取决于用于mod_ssl的OpenSSL版本：在1.0.0或更高版本中， <code>openssl list-public-key-algorithms</code>将输出支持的算法列表，另请参见以下有关OpenSSL版本限制的注释1.0.2以及解决这些问题的方法。
</p>

<p>这些文件还可以包括从叶到根排序的中间CA证书。版本2.4.8和更高版本支持此功能，并且已淘汰<code class="directive"><a href="#sslcertificatechainfile">SSLCertificateChainFile</a></code> 。与OpenSSL 1.0.2或更高版本一起运行时，这允许在每个证书的基础上配置中间CA链。
</p>

<p>还可以将自定义DH参数和临时密钥的EC曲线名称添加到使用<code class="directive"><a href="#sslcertificatefile">SSLCertificateFile</a></code>配置的第一个文件的<code class="directive"><a href="#sslcertificatefile">SSLCertificateFile</a></code> 。2.4.7版或更高版本支持此功能。可以使用命令<code>openssl dhparam</code>和<code>openssl ecparam</code>生成此类参数。可以按原样将参数添加到第一个证书文件的末尾。由于第一个文件与身份验证算法类型无关，因此只能将第一个文件用于自定义参数。
</p>

<p>最后，最终实体证书的私钥也可以添加到证书文件中，而不是使用单独的<code class="directive"><a href="#sslcertificatekeyfile">SSLCertificateKeyFile</a></code>指令。不鼓励这种做法。如果使用该证书，则必须在使用单独密钥文件的证书之后配置使用这种嵌入式密钥的证书文件。如果私钥已加密，则在启动时会强制输入密码对话框。
</p>

<div class="note">
<h3>素数&gt; 1024位的DH参数互操作性</h3>
<p>从版本2.4.7开始，mod_ssl使用标准DH参数，素数长度为2048、3072和4096位，附加素数长度为6144和8192位，从版本2.4.10（来自<a href="http://www.ietf.org/rfc/rfc3526.txt">RFC 3526</a> ）开始，并将其<a href="http://www.ietf.org/rfc/rfc3526.txt">分发</a>出去根据证书的RSA / DSA密钥的长度发送给客户端。特别是对于基于Java的客户端（Java 7或更早版本），这可能会导致握手失败-有关解决此类问题的信息，请参阅此<a href="../ssl/ssl_faq.html#javadh">常见问题解答</a> 。
</p>
</div>

<div class="note">
<h3>使用多个证书和1.0.2之前的OpenSSL版本时的默认DH参数</h3>
<p>当使用多个证书来支持不同的身份验证算法（例如RSA，DSA，但主要是ECC）和1.0.2之前的OpenSSL时，建议使用自定义DH参数（最好），方法是将其添加到第一个证书文件中（如所述）以上），或订购<code class="directive">SSLCertificateFile</code>指令，以便将RSA / DSA证书放在ECC证书<strong>之后</strong> 。
</p>
<p>这是由于旧版本的OpenSSL的限制所致，该限制不允许Apache HTTP Server在握手时（必须将DH参数发送给对等方）确定当前选择的证书，而始终提供最后配置的证书。因此，服务器可能会基于错误的证书密钥的长度来选择默认的DH参数（ECC密钥比RSA / DSA密钥小得多，并且它们的长度与选择DH素数无关）。
</p>
<p>由于自定义DH参数始终优先于默认参数，因此可以通过创建和配置它们（如上所述）并使用自定义/合适的长度来避免此问题。
</p>
</div>

<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLCertificateFile "/usr/local/apache2/conf/ssl.crt/server.crt"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLCertificateKeyFile" id="SSLCertificateKeyFile">SSLCertificateKeyFile</a> <a name="sslcertificatekeyfile" id="sslcertificatekeyfile">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>服务器PEM编码的私钥文件</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLCertificateKeyFile <em>文件路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>该指令指向服务器的PEM编码的私钥文件。如果包含的私钥已加密，则在启动时会强制输入密码对话框。</p>

<p>该指令可以多次使用（引用不同的文件名）以支持服务器认证的多种算法。对于每个<code class="directive"><a href="#sslcertificatekeyfile">SSLCertificateKeyFile</a></code>指令，必须有一个匹配的<code class="directive">SSLCertificateFile</code>指令。</p>

<p>私钥也可以与<code class="directive"><a href="#sslcertificatefile">SSLCertificateFile</a></code>给出的文件中的证书结合使用，但是强烈建议不<code class="directive"><a href="#sslcertificatefile">SSLCertificateFile</a></code> 。如果使用它，则必须在使用单独密钥文件的证书之后配置使用这种嵌入式密钥的证书文件。</p>

<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLCertificateKeyFile "/usr/local/apache2/conf/ssl.key/server.key"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLCipherSuite" id="SSLCipherSuite">SSLCipherSuite</a> <a name="sslciphersuite" id="sslciphersuite">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>密码套件可用于SSL握手中的协商</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLCipherSuite <em>密码规范</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLCipherSuite DEFAULT（取决于OpenSSL版本）</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>验证配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此复杂指令使用冒号分隔的，由OpenSSL密码规范组成的<em>密码规范</em>字符串来配置允许客户端在SSL握手阶段进行协商的Cipher Suite。注意，此伪指令可以在每个服务器和每个目录上下文中使用。在每服务器上下文中，当建立连接时，它适用于标准SSL握手。在每个目录上下文中，它会在读取HTTP请求之后但在发送HTTP响应之前，通过重新配置的Cipher Suite强制进行SSL重新协商。</p>
<p><em>cipher-spec中</em>的SSL密码<em>规范</em>由4个主要属性和一些额外的次要属性组成：</p>
<ul>
<li><em>密钥交换算法</em> ：<br>RSA，Diffie-Hellman，椭圆曲线Diffie-Hellman，安全远程密码</li>
<li><em>认证算法</em> ：<br>RSA，Diffie-Hellman，DSS，ECDSA或无。
</li>
<li><em>密码/加密算法</em> ：<br>AES，DES，Triple-DES，RC4，RC2，IDEA等</li>
<li><em>MAC摘要算法</em> ：<br>MD5，SHA或SHA1，SHA256，SHA384。
</li>
</ul>
<p>SSL密码也可以是导出密码。不再支持SSLv2密码。要指定要使用的密码，可以一次指定所有密码，也可以使用别名指定密码的优先级和顺序（请参阅<a href="#table1">表1</a> ）。实际可用的密码和别名取决于所使用的openssl版本。较新的openssl版本可能包含其他密码。</p>

<table class="bordered">

<tr><th><a name="table1">标签</a></th> <th>描述</th></tr>
<tr><td colspan="2"><em>密钥交换算法：</em></td></tr>
<tr><td><code>kRSA</code></td>   <td>RSA密钥交换</td></tr>
<tr><td><code>脱氢酶</code></td>   <td>Diffie-Hellman密钥与RSA密钥交换</td></tr>
<tr><td><code>脱氢酶</code></td>   <td>Diffie-Hellman与DSA密钥的密钥交换</td></tr>
<tr><td><code>EDH</code></td>   <td>临时（临时密钥）Diffie-Hellman密钥交换（无证书）</td>   </tr>
<tr><td><code>建议零售价</code></td>   <td>安全远程密码（SRP）密钥交换</td></tr>
<tr><td colspan="2"><em>认证算法：</em></td></tr>
<tr><td><code>空值</code></td>  <td>不认证</td></tr>
<tr><td><code>RSA</code></td>   <td>RSA认证</td></tr>
<tr><td><code>决策支持系统</code></td>   <td>DSS验证</td> </tr>
<tr><td><code>脱氢酶</code></td>    <td>Diffie-Hellman身份验证</td></tr>
<tr><td colspan="2"><em>密码编码算法：</em></td></tr>
<tr><td><code>空值</code></td>  <td>没有加密</td>         </tr>
<tr><td><code>空值</code></td>   <td>eNULL的别名</td>         </tr>
<tr><td><code>AES</code></td>    <td>AES加密</td>        </tr>
<tr><td><code>DES</code></td>    <td>DES加密</td>        </tr>
<tr><td><code>3DES</code></td>   <td>三重DES加密</td> </tr>
<tr><td><code>RC4</code></td>    <td>RC4加密</td>       </tr>
<tr><td><code>RC2</code></td>    <td>RC2加密</td>       </tr>
<tr><td><code>理念</code></td>   <td>IDEA加密</td>       </tr>
<tr><td colspan="2"><em>MAC摘要算法</em> ：</td></tr>
<tr><td><code>MD5</code></td>    <td>MD5哈希函数</td></tr>
<tr><td><code>SHA1</code></td>   <td>SHA1哈希函数</td></tr>
<tr><td><code>SHA</code></td>    <td>SHA1的别名</td> </tr>
<tr><td><code>SHA256</code></td> <td>SHA256哈希函数</td> </tr>
<tr><td><code>SHA384</code></td> <td>SHA384哈希函数</td> </tr>
<tr><td colspan="2"><em>别名：</em></td></tr>
<tr><td><code>SSLv3</code></td>  <td>所有SSL 3.0版密码</td> </tr>
<tr><td><code>TLSv1</code></td>  <td>所有TLS版本1.0密码</td> </tr>
<tr><td><code>经验值</code></td>    <td>所有出口密码</td>  </tr>
<tr><td><code>出口40</code></td> <td>仅所有40位导出密码</td>  </tr>
<tr><td><code>出口56</code></td> <td>仅所有56位导出密码</td>  </tr>
<tr><td><code>低</code></td>    <td>所有低强度密码（无出口，单个DES）</td></tr>
<tr><td><code>介质</code></td> <td>所有具有128位加密的密码</td> </tr>
<tr><td><code>高</code></td>   <td>所有使用三重DES的密码</td>     </tr>
<tr><td><code>RSA</code></td>    <td>所有使用RSA密钥交换的密码</td> </tr>
<tr><td><code>DH</code></td>     <td>所有使用Diffie-Hellman密钥交换的密码</td> </tr>
<tr><td><code>EDH</code></td>    <td>所有使用临时Diffie-Hellman密钥交换的密码</td> </tr>
<tr><td><code>ECDH</code></td>   <td>椭圆曲线Diffie-Hellman密钥交换</td>   </tr>
<tr><td><code>脱氢酶</code></td>    <td>所有使用匿名Diffie-Hellman密钥交换的密码</td> </tr>
<tr><td><code>亚太经合组织</code></td>    <td>所有使用匿名椭圆曲线Diffie-Hellman密钥交换的密码</td> </tr>
<tr><td><code>建议零售价</code></td>    <td>使用安全远程密码（SRP）密钥交换的所有密码</td> </tr>
<tr><td><code>DSS</code></td>    <td>所有使用DSS身份验证的密码</td> </tr>
<tr><td><code>ECDSA</code></td>    <td>所有使用ECDSA身份验证的密码</td> </tr>
<tr><td><code>空值</code></td>   <td>所有不使用身份验证的密码</td> </tr>
</table>
<p>现在，变得有趣的是可以将它们组合在一起以指定要使用的顺序和密码。为了加快速度，某些密码组还具有别名（ <code>SSLv3, TLSv1, EXP, LOW, MEDIUM, HIGH</code> ）。这些标签可以与前缀结合在一起形成<em>cipher-spec</em> 。可用的前缀是：</p>
<ul>
<li>none：将密码添加到列表</li>
<li><code>+</code> ：将匹配的密码移动到列表中的当前位置</li>
<li><code>-</code> ：从列表中删除密码（可以稍后再添加）</li>
<li><code>!</code> ：完全杀死列表中的密码（以后<strong>不能</strong>再添加）</li>
</ul>

<div class="note">
<h3>始终禁用<code>aNULL</code> ， <code>eNULL</code>和<code>EXP</code>密码</h3>
<p>从版本2.4.7开始，总是禁用null和出口级密码，因为mod_ssl无条件添加<code>!空：！eNULL ：！初始化时将EXP</code>为任何密码字符串。</p>
</div>

<p>一种更简单的方法是使用`` <code>openssl ciphers -v</code> ''命令，该命令提供了一种很好的方法来连续创建正确的<em>密码规范</em>字符串。默认的<em>密码规范</em>字符串取决于所使用的OpenSSL库的版本。我们假设它是`` <code>RC4-SHA:AES128-SHA:HIGH:MEDIUM:!空：！MD5</code> ”，其含义如下：将<code>RC4-SHA</code>和<code>AES128-SHA</code>放在开头。我们这样做是因为这些密码在速度和安全性之间提供了很好的折衷方案。接下来，包括高中安全密码。最后，删除所有未认证的密码，即对于SSL，匿名Diffie-Hellman密码，以及所有使用<code>MD5</code>作为哈希算法的密码，因为已被证明是不够的。</p>
<div class="example"><pre>$ openssl ciphers -v 'RC4-SHA:AES128-SHA:HIGH:MEDIUM:!aNULL:!MD5'
RC4-SHA                 SSLv3 Kx=RSA      Au=RSA  Enc=RC4(128)  Mac=SHA1
AES128-SHA              SSLv3 Kx=RSA      Au=RSA  Enc=AES(128)  Mac=SHA1
DHE-RSA-AES256-SHA      SSLv3 Kx=DH       Au=RSA  Enc=AES(256)  Mac=SHA1
...                     ...               ...     ...           ...
SEED-SHA                SSLv3 Kx=RSA      Au=RSA  Enc=SEED(128) Mac=SHA1
PSK-RC4-SHA             SSLv3 Kx=PSK      Au=PSK  Enc=RC4(128)  Mac=SHA1
KRB5-RC4-SHA            SSLv3 Kx=KRB5     Au=KRB5 Enc=RC4(128)  Mac=SHA1</pre></div>
<p><a href="#table2">表2</a>给出了SSL的特定RSA和DH密码的完整列表。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLCipherSuite RSA:!EXP:!NULL:+HIGH:+MEDIUM:-LOW</pre>
</div>
<table class="bordered">

<tr><th><a name="table2">密码标签</a></th> <th>协议</th> <th>密钥示例</th> <th>验证码</th> <th>恩</th> <th>苹果电脑</th> <th>类型</th> </tr>
<tr><td colspan="7"><em>RSA密码：</em></td></tr>
<tr><td><code>DES-CBC3-SHA</code></td> <td>SSLv3</td> <td>RSA</td> <td>RSA</td> <td>3DES（168）</td> <td>SHA1</td> <td></td> </tr>
<tr><td><code>IDEA-CBC-SHA</code></td> <td>SSLv3</td> <td>RSA</td> <td>RSA</td> <td>创意（128）</td> <td>SHA1</td> <td></td> </tr>
<tr><td><code>RC4-SHA</code></td> <td>SSLv3</td> <td>RSA</td> <td>RSA</td> <td>RC4（128）</td> <td>SHA1</td> <td></td> </tr>
<tr><td><code>RC4-MD5</code></td> <td>SSLv3</td> <td>RSA</td> <td>RSA</td> <td>RC4（128）</td> <td>MD5</td> <td></td> </tr>
<tr><td><code>DES-CBC-SHA</code></td> <td>SSLv3</td> <td>RSA</td> <td>RSA</td> <td>DES（56）</td> <td>SHA1</td> <td></td> </tr>
<tr><td><code>EXP-DES-CBC-SHA</code></td> <td>SSLv3</td> <td>RSA（512）</td> <td>RSA</td> <td>DES（40）</td> <td>SHA1</td> <td>出口</td> </tr>
<tr><td><code>EXP-RC2-CBC-MD5</code></td> <td>SSLv3</td> <td>RSA（512）</td> <td>RSA</td> <td>RC2（40）</td> <td>MD5</td> <td>出口</td> </tr>
<tr><td><code>EXP-RC4-MD5</code></td> <td>SSLv3</td> <td>RSA（512）</td> <td>RSA</td> <td>RC4（40）</td> <td>MD5</td> <td>出口</td> </tr>
<tr><td><code>空SHA</code></td> <td>SSLv3</td> <td>RSA</td> <td>RSA</td> <td>没有</td> <td>SHA1</td> <td></td> </tr>
<tr><td><code>NULL-MD5</code></td> <td>SSLv3</td> <td>RSA</td> <td>RSA</td> <td>没有</td> <td>MD5</td> <td></td> </tr>
<tr><td colspan="7"><em>Diffie-Hellman密码：</em></td></tr>
<tr><td><code>ADH-DES-CBC3-SHA</code></td> <td>SSLv3</td> <td>DH</td> <td>没有</td> <td>3DES（168）</td> <td>SHA1</td> <td></td> </tr>
<tr><td><code>ADH-DES-CBC-SHA</code></td> <td>SSLv3</td> <td>DH</td> <td>没有</td> <td>DES（56）</td> <td>SHA1</td> <td></td> </tr>
<tr><td><code>ADH-RC4-MD5</code></td> <td>SSLv3</td> <td>DH</td> <td>没有</td> <td>RC4（128）</td> <td>MD5</td> <td></td> </tr>
<tr><td><code>EDH-RSA-DES-CBC3-SHA</code></td> <td>SSLv3</td> <td>DH</td> <td>RSA</td> <td>3DES（168）</td> <td>SHA1</td> <td></td> </tr>
<tr><td><code>EDH-DSS-DES-CBC3-SHA</code></td> <td>SSLv3</td> <td>DH</td> <td>DSS</td> <td>3DES（168）</td> <td>SHA1</td> <td></td> </tr>
<tr><td><code>EDH-RSA-DES-CBC-SHA</code></td> <td>SSLv3</td> <td>DH</td> <td>RSA</td> <td>DES（56）</td> <td>SHA1</td> <td></td> </tr>
<tr><td><code>EDH-DSS-DES-CBC-SHA</code></td> <td>SSLv3</td> <td>DH</td> <td>DSS</td> <td>DES（56）</td> <td>SHA1</td> <td></td> </tr>
<tr><td><code>EXP-EDH-RSA-DES-CBC-SHA</code></td> <td>SSLv3</td> <td>DH（512）</td> <td>RSA</td> <td>DES（40）</td> <td>SHA1</td> <td>出口</td> </tr>
<tr><td><code>EXP-EDH-DSS-DES-CBC-SHA</code></td> <td>SSLv3</td> <td>DH（512）</td> <td>DSS</td> <td>DES（40）</td> <td>SHA1</td> <td>出口</td> </tr>
<tr><td><code>EXP-ADH-DES-CBC-SHA</code></td> <td>SSLv3</td> <td>DH（512）</td> <td>没有</td> <td>DES（40）</td> <td>SHA1</td> <td>出口</td> </tr>
<tr><td><code>EXP-ADH-RC4-MD5</code></td> <td>SSLv3</td> <td>DH（512）</td> <td>没有</td> <td>RC4（40）</td> <td>MD5</td> <td>出口</td> </tr>
</table>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLCompression" id="SSLCompression">SSLCompression</a> <a name="sslcompression" id="sslcompression">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>在SSL级别启用压缩</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLCompression开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSL压缩关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.8或更高版本，则在httpd 2.4.3和更高版本中可用；如果使用OpenSSL 1.0.0或更高版本，则虚拟主机范围可用。默认值在版本2.4.3中处于<code>on</code> 。</td></tr>
</table>
<p>此伪指令允许在SSL级别启用压缩。</p>
<div class="warning">
<p>启用压缩会在大多数设置中引起安全问题（所谓的CRIME攻击）。</p>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLCryptoDevice" id="SSLCryptoDevice">SSLCryptoDevice</a> <a name="sslcryptodevice" id="sslcryptodevice">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>启用加密硬件加速器的使用</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLCryptoDevice <em>引擎</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>内置SSLCryptoDevice</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>该指令允许使用加密硬件加速器板来减轻某些SSL处理开销。仅当SSL工具箱是通过“引擎”支持构建的时，才可以使用此伪指令。 OpenSSL 0.9.7和更高版本默认情况下具有“引擎”支持，必须使用单独的OpenSSL 0.9.6“ -engine”版本。</p>

<p>要发现支持哪些引擎名称，请运行命令“ <code>openssl engine</code> ”。</p>

<div class="example"><h3>例</h3><pre class="prettyprint lang-config"># For a Broadcom accelerator:
SSLCryptoDevice ubsec</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLEngine" id="SSLEngine">SSLEngine</a> <a name="sslengine" id="sslengine">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>SSL引擎操作开关</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLEngine on | off |可选</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLEngine关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>该指令切换SSL / TLS协议引擎的用法。应该在<code class="directive"><a href="../mod/core.html#virtualhost">&lt;VirtualHost&gt;</a></code>部分中使用此<code class="directive"><a href="../mod/core.html#virtualhost">&lt;VirtualHost&gt;</a></code> ，以为该虚拟主机启用SSL / TLS。默认情况下，主服务器和所有已配置的虚拟主机均禁用SSL / TLS协议引擎。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">&lt;VirtualHost _default_:443&gt;
SSLEngine on
#...
&lt;/VirtualHost&gt;</pre>
</div>
<p>在Apache 2.1及更高版本中，可以将<code class="directive">SSLEngine</code>设置为<code>optional</code> 。这样可以支持<a href="http://www.ietf.org/rfc/rfc2817.txt">RFC 2817</a> （在HTTP / 1.1内升级到TLS）。目前，没有网络浏览器支持RFC 2817。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLFIPS" id="SSLFIPS">SSLFIPS</a> <a name="sslfips" id="sslfips">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>SSL FIPS模式切换</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLFIPS开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>关闭SSLFIPS</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此伪指令切换SSL库FIPS_mode标志的用法。它必须在全局服务器上下文中设置，并且不能配置有冲突的设置（先打开SSLFIPS，然后关闭SSLFIPS或类似的设置）。该模式适用于所有SSL库操作。
</p>
<p>如果httpd是针对不支持FIPS_mode标志的SSL库编译的，则<code>SSLFIPS on</code>将会失败。有关在FIPS 140-2批准的操作模式下使用mod_ssl的特定要求，请参阅SSL提供程序库的FIPS 140-2安全策略文档。请注意，当所有组件均在适用的安全策略规定的指导下组装和操作时，mod_ssl本身未经验证，但可以描述为使用FIPS 140-2验证的加密模块。
</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLHonorCipherOrder" id="SSLHonorCipherOrder">SSLHonorCipherOrder</a> <a name="sslhonorcipherorder" id="sslhonorcipherorder">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>偏好服务器密码优先顺序的选项</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLHonorCipherOrder开启|关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLHonorCipherOrder关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>在SSLv3或TLSv1握手期间选择密码时，通常使用客户端的首选项。如果启用此指令，则将使用服务器的首选项。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLHonorCipherOrder on</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLInsecureRenegotiation" id="SSLInsecureRenegotiation">SSL不安全重新协商</a> <a name="sslinsecurerenegotiation" id="sslinsecurerenegotiation">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>支持不安全重新协商的选项</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLInsecureRnegotiation开启|关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLInsecureRenegotiation关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.8m或更高版本，则在httpd 2.2.15和更高版本中可用</td></tr>
</table>
<p>如最初指定的那样，在重新协商期间，所有版本的SSL和TLS协议（不超过TLS / 1.2，包括TLS / 1.2）都容易受到中间人攻击（ <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2009-3555">CVE-2009-3555</a> ）。此漏洞使攻击者可以将选定的纯文本“前缀”到Web服务器看到的HTTP请求中。如果客户端和服务器都支持，则开发了协议扩展来修复此漏洞。</p>

<p>如果<code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code>与OpenSSL版本0.9.8m或更高版本链接，则默认情况下仅支持新协议扩展的客户端支持重新协商。如果启用了此伪指令，则将允许与旧的（未打补丁的）客户端进行重新协商，尽管这种方法不安全。</p>

<div class="warning"><h3>安全警告</h3>
<p>如果启用此指令，则SSL连接将容易受到<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2009-3555">CVE-2009-3555中</a>所述的中间人前缀攻击。</p>
</div>

<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLInsecureRenegotiation on</pre>
</div>

<p>可以从SSI或CGI脚本中使用<code>SSL_SECURE_RENEG</code>环境变量来确定给定的SSL连接是否支持安全重新协商。</p>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLOCSPDefaultResponder" id="SSLOCSPDefaultResponder">SSLOCSPDefaultResponder</a> <a name="sslocspdefaultresponder" id="sslocspdefaultresponder">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>设置用于OCSP验证的默认响应者URI</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLOCSDefaultResponder <em>uri</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此选项设置要使用的默认OCSP响应器。如果未启用<code class="directive"><a href="#sslocspoverrideresponder">SSLOCSPOverrideResponder</a></code> ，则仅当在要验证的证书中未指定响应者URI时，才使用给定的URI。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLOCSPEnable" id="SSLOCSPEnable">SSLOCSP启用</a> <a name="sslocspenable" id="sslocspenable">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>启用客户端证书链的OCSP验证</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLOCSP启用开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLOCSP启用关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此选项启用客户端证书链的OCSP验证。如果启用此选项，则在进行常规验证（包括CRL检查）之后，将针对OCSP响应者验证客户端证书链中的证书。</p>

<p>所使用的OCSP响应程序是从证书本身提取的，或者是通过配置派生的。请参阅<code class="directive"><a href="#sslocspdefaultresponder">SSLOCSPDefaultResponder</a></code>和<code class="directive"><a href="#sslocspoverrideresponder">SSLOCSPOverrideResponder</a></code>指令。</p>

<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLVerifyClient on
SSLOCSPEnable on
SSLOCSPDefaultResponder "http://responder.example.com:8888/responder"
SSLOCSPOverrideResponder on</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLOCSPNoverify" id="SSLOCSPNoverify">SSLOCSPNoverify</a> <a name="sslocspnoverify" id="sslocspnoverify">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>跳过OCSP响应者证书验证</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLOCSPNoverify <em>开/关</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLOCSPNoverify关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.7或更高版本，则在httpd 2.4.26和更高版本中可用</td></tr>
</table>
<p>跳过OCSP响应者证书验证，这在测试OCSP服务器时最有用。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLOCSPOverrideResponder" id="SSLOCSPOverrideResponder">SSLOCSPOverrideResponder</a> <a name="sslocspoverrideresponder" id="sslocspoverrideresponder">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>强制使用默认响应者URI进行OCSP验证</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLOCSPOverrideResponder开启|关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLOCSPOverrideResponder关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此选项强制在OCSP证书验证期间使用配置的默认OCSP响应器，而不管被验证的证书是否引用OCSP响应器。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLOCSPProxyURL" id="SSLOCSPProxyURL">SSLOCSPProxyURL</a> <a name="sslocspproxyurl" id="sslocspproxyurl">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>用于OCSP请求的代理URL</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLOCSPProxyURL <em>网址</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>在httpd 2.4.19及更高版本中可用</td></tr>
</table>
<p>此选项允许设置HTTP代理的URL，该HTTP代理应用于对OCSP响应者的所有查询。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLOCSPResponderCertificateFile" id="SSLOCSPResponderCertificateFile">SSLOCSPResponderCertificateFile</a> <a name="sslocsprespondercertificatefile" id="sslocsprespondercertificatefile">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>一组受信任的PEM编码的OCSP响应者证书</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLOCSPResponderCertificateFile <em>文件</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.7或更高版本，则在httpd 2.4.26和更高版本中可用</td></tr>
</table>
<p>这提供了在OCSP响应者证书验证期间要使用的受信任OCSP响应者证书的列表。所提供的证书是隐式可信的，无需进一步验证。通常在OCSP响应者证书是自签名的或从OCSP响应中省略的情况下使用。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLOCSPResponderTimeout" id="SSLOCSPResponderTimeout">SSLOCSPResponderTimeout</a> <a name="sslocsprespondertimeout" id="sslocsprespondertimeout">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>OCSP查询超时</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLOCSPResponderTimeout <em>秒</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLOCSPResponderTimeout 10</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p><code class="directive"><a href="#sslocspenable">SSLOCSPEnable</a></code>时，此选项设置对OCSP响应者的查询超时。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLOCSPResponseMaxAge" id="SSLOCSPResponseMaxAge">SSLOCSPResponseMaxAge</a> <a name="sslocspresponsemaxage" id="sslocspresponsemaxage">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>OCSP响应的最大允许年龄</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLOCSPResponseMaxAge <em>秒</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLOCSPResponseMaxAge -1</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此选项设置OCSP响应的最大允许使用期限（“新鲜度”）。默认值（ <code>-1</code> ）不强制使用最长<code>nextUpdate</code> ，这意味着只要它们的<code>nextUpdate</code>字段在将来，OCSP响应就被视为有效。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLOCSPResponseTimeSkew" id="SSLOCSPResponseTimeSkew">SSLOCSPResponseTimeSkew</a> <a name="sslocspresponsetimeskew" id="sslocspresponsetimeskew">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>OCSP响应验证的最大允许时间偏差</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLOCSPResponseTimeSkew <em>秒</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLOCSPResponseTimeSkew 300</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此选项设置OCSP响应的最大允许时间偏斜（在检查其<code>thisUpdate</code>和<code>nextUpdate</code>字段时）。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLOCSPUseRequestNonce" id="SSLOCSPUseRequestNonce">SSLOCSPUseRequestNonce</a> <a name="sslocspuserequestnonce" id="sslocspuserequestnonce">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>在OCSP查询中使用随机数</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLOCSPUseRequestNonce开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLOCSPUseRequestNonce于</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>在httpd 2.4.10及更高版本中可用</td></tr>
</table>
<p>此选项确定对OCSP响应者的查询是否应包含随机数。默认情况下，始终使用查询随机数并对照响应的随机数进行检查。当响应者不使用随机数（例如Microsoft OCSP Responder）时，应<code>off</code>此选项。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLOpenSSLConfCmd" id="SSLOpenSSLConfCmd">SSLOpenSSLConfCmd</a> <a name="sslopensslconfcmd" id="sslopensslconfcmd">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>通过其<em>SSL_CONF</em> API配置OpenSSL参数</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLOpenSSLConfCmd <em>命令名</em> <em>命令值</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 1.0.2或更高版本，则在httpd 2.4.8和更高版本中可用</td></tr>
</table>
<p>该指令将OpenSSL的<em>SSL_CONF</em> API公开给mod_ssl，从而可以在向OpenSSL添加新功能时灵活地配置OpenSSL参数，而无需实现其他<code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code>指令。</p>

<p>可用的<code class="directive">SSLOpenSSLConfCmd</code>命令集取决于用于<code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code>的OpenSSL版本（至少需要版本1.0.2）。有关受支持的命令名称的列表，请参见<a href="http://www.openssl.org/docs/man1.0.2/ssl/SSL_CONF_cmd.html#SUPPORTED-CONFIGURATION-FILE-COMMANDS">Open_SSL的SSL_CONF_cmd（3）</a>手册页中的“ <em>受支持的配置文件命令</em> ”部分。</p>

<p>一些<code class="directive">SSLOpenSSLConfCmd</code>命令可以用作现有指令的替代方法（例如<code class="directive"><a href="#sslciphersuite">SSLCipherSuite</a></code>或<code class="directive"><a href="#sslprotocol">SSLProtocol</a></code> ），尽管应注意，参数的语法/允许值有时可能会有所不同。</p>

<div class="example"><h3>例子</h3><pre class="prettyprint lang-config">SSLOpenSSLConfCmd Options -SessionTicket,ServerPreference
SSLOpenSSLConfCmd ECDHParameters brainpoolP256r1
SSLOpenSSLConfCmd ServerInfoFile "/usr/local/apache2/conf/server-info.pem"
SSLOpenSSLConfCmd Protocol "-ALL, TLSv1.2"
SSLOpenSSLConfCmd SignatureAlgorithms RSA+SHA384:ECDSA+SHA256</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLOptions" id="SSLOptions">SSLOptions</a> <a name="ssloptions" id="ssloptions">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>配置各种SSL引擎运行时选项</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLOptions [+ |-] <em>选项</em> ...</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>选件</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此伪指令可用于控制每个目录的各种运行时选项。通常，如果多个<code>SSLOptions</code>可以应用于一个目录，则完全采用最具体的一个。选项不会合并。但是，如果<code>SSLOptions</code>指令上的<em>所有</em>选项都以加号（ <code>+</code> ）或减号（ <code>-</code> ）开头，则这些选项将合并。前面带有<code>+</code>所有选项都会添加到当前有效的选项中，而前面带有<code>-</code>所有选项将从当前有效的选项中删除。</p>
<p>可用的<em>选项</em>是：</p>
<ul>
<li><code>标准环境</code>
    <p>启用此选项后，将创建标准的SSL相关CGI / SSI环境变量集。由于性能原因，默认情况下禁用此默认设置，因为信息提取步骤是一项相当昂贵的操作。因此，通常只对CGI和SSI请求启用此选项。</p>
</li>
<li><code>出口证书数据</code>
    <p>启用此选项后，将创建其他CGI / SSI环境变量： <code>SSL_SERVER_CERT</code> ， <code>SSL_CLIENT_CERT</code>和<code>SSL_CLIENT_CERT_CHAIN_</code> <em>n</em> （ <em>n</em> = 0,1,2，..）。这些包含用于当前HTTPS连接的服务器和客户端的PEM编码的X.509证书，并且CGI脚本可以使用它们对证书进行更深入的检查。此外，还提供了客户端证书链的所有其他证书。这会使环境有点膨胀，这就是为什么您必须使用此选项才能按需启用它的原因。</p>
</li>
<li><code>FakeBasicAuth</code>
    <p>启用此选项后，客户端X509证书的主题专有名称（DN）将转换为HTTP基本授权用户名。这意味着可以将标准Apache身份验证方法用于访问控制。用户名只是客户端X509证书的主题（可以通过运行OpenSSL的<code>openssl x509</code>命令确定： <code>openssl x509 -noout -subject -in</code> <em>certificate</em> <code>.crt</code> ）。请注意，没有从用户那里获得密码。用户文件中的每个条目都需要使用以下密码：`` <code>xxj31ZMTZzkVA</code> ''，这是单词`` <code>password</code> ''的DES加密版本。那些使用基于MD5的加密（例如在FreeBSD或BSD / OS等环境下）的人应该使用以下具有相同单词的MD5哈希值：`` <code>$1$OXLyS...$Owx8s2/m9/gfkcRVXzgoE/</code> ''。</p>

    <p>请注意， <code class="module"><a href="../mod/mod_auth_basic.html">mod_auth_basic</a></code>中的<code class="directive"><a href="../mod/mod_auth_basic.html#authbasicfake">AuthBasicFake</a></code>指令可以用作伪造基本身份验证的更通用的机制，从而可以控制用户名和密码的结构。</p>
</li>
<li><code>严格要求</code>
    <p>当<code>SSLRequireSSL</code>或<code>SSLRequire</code>成功确定应禁止访问时，这将<em>强制</em>禁止访问。通常默认设置是在使用`` <code>Satisfy any</code> ''指令并且传递了其他访问限制的情况下，由于<code>SSLRequireSSL</code>或<code>SSLRequire</code>导致的拒绝访问被覆盖（因为这就是Apache <code>Satisfy</code>机制应该起作用的方式）。但是对于严格的访问限制，您可以将<code>SSLRequireSSL</code>和/或<code>SSLRequire</code>与`` <code>SSLOptions +StrictRequire</code> ''结合使用。一旦mod_ssl决定拒绝访问，那么再没有其他`` <code>Satisfy Any</code> ''的机会了。</p>
</li>
<li><code>重新协商</code>
    <p>当在每个目录上下文中使用SSL指令时，这可以优化SSL连接重新协商处理。默认情况下，启用严格的方案，其中<em>每个</em>按目录重新配置SSL参数都会导致<em>完整的</em> SSL重新协商握手。使用此选项时，mod_ssl会通过进行更精细（但仍很安全）的参数检查来避免不必要的握手。但是，有时这些细粒度的检查可能不是用户期望的，因此，请仅基于每个目录启用此检查。</p>
</li>
<li><code>LegacyDNStringFormat</code>
    <p>此选项影响如何<code>SSL_{CLIENT,SERVER}_{I,S}_DN</code>变量的值。从2.3.11版开始，Apache HTTPD默认使用RFC 2253兼容格式。这使用逗号作为属性之间的分隔符，允许使用非ASCII字符（已转换为UTF8），使用反斜杠转义各种特殊字符，最后对属性进行排序，并带有“ C”属性。</p>

    <p>如果设置了<code>LegacyDNStringFormat</code> ，将使用旧格式，该格式首先对“ C”属性进行排序，使用斜杠作为分隔符，并且不以任何一致的方式处理非ASCII和特殊字符。
    </p>
</li>
</ul>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLOptions +FakeBasicAuth -StrictRequire
&lt;Files ~ "\.(cgi|shtml)$"&gt;
    SSLOptions +StdEnvVars -ExportCertData
&lt;/Files&gt;</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLPassPhraseDialog" id="SSLPassPhraseDialog">SSLPassPhraseDialog</a> <a name="sslpassphrasedialog" id="sslpassphrasedialog">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>加密私钥的密码对话框类型</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLPassPhraseDialog <em>类型</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>内置SSLPassPhraseDialog</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>Apache启动时，必须读取启用SSL的虚拟服务器的各种证书（请参阅<code class="directive"><a href="#sslcertificatefile">SSLCertificateFile</a></code> ）和私钥（请参阅<code class="directive"><a href="#sslcertificatekeyfile">SSLCertificateKeyFile</a></code> ）文件。因为出于安全原因，通常会对私钥文件进行加密，所以mod_ssl需要向管理员查询通行短语以解密这些文件。该查询可以通过两种方式完成，可以通过<em>type</em>进行配置：</p>
<ul>
<li><code>内建的</code>
    <p>这是默认的情况，在启动时，在Apache从终端分离之前，交互式终端对话框就会出现。在这里，管理员必须为每个加密的私钥文件手动输入密码短语。因为可以配置许多启用SSL的虚拟主机，所以使用以下重用方案将对话框最小化：对私钥文件进行加密时，将尝试所有已知的通行短语（当然一开始都不存在）。 。如果这些已知的通行短语之一成功，则不会弹出该特定私钥文件的对话框。如果没有成功，则在终端上查询另一个“通行短语”，并记住下一轮（可能可以重复使用）。</p>
    <p>这种方案使mod_ssl具有最大的灵活性（因为N个加密的私钥文件，您<em>可以</em>使用N个不同的通行短语-但当然您必须输入所有的通行短语），同时最小化终端对话框（即，当您使用单个通行证时）对于所有N个私钥文件的短语，此通行短语仅被查询一次。</p></li>

<li><code>| / path / to / program [args ...]</code>

   <p>此模式允许使用外部程序，该程序充当通向特定输入设备的管道。该程序会在<code>stdin</code>上发送用于<code>builtin</code>模式的标准提示文本，并期望在<code>stdout</code>上写入密码字符串。如果需要多个密码（或输入了错误的密码），则在返回第一个密码之后将写入其他提示文本，然后必须写回更多密码。</p></li>

<li><code>exec：/路径/到/程序</code>
    <p>此处配置了一个外部程序，该程序在启动时会为每个加密的私钥文件调用。它用两个参数调用（第一个参数的格式为`` <code>servername:portnumber</code> ''，第二个参数为`` <code>RSA</code> ''，`` <code>DSA</code> ''，`` <code>ECC</code> ''或以3开始的整数索引配置了三个以上的键），表示必须为哪个服务器和算法将相应的通行短语打印到<code>stdout</code> 。在版本2.4.8（未发布）和版本2.4.9中，使用一个参数调用它，该字符串的形式为`` <code>servername:portnumber:index</code> ''（其中<code>index</code>是从零开始的整数），表示服务器，TCP端口和证书号。目的是使此外部程序首先运行安全检查，以确保系统不受攻击者的侵害，只有在成功通过这些检查后，它才会提供“通过短语”。</p>
    <p>这些安全检查以及确定通行短语的方式都可以随您所愿而复杂。Mod_ssl只是定义了接口：一个可执行程序，它在<code>stdout</code>上提供Pass Phrase。或多或少！因此，如果您真的对安全性抱有偏执，那么这里就是您的界面。剩下的任何事情都留给管理员练习，因为本地安全要求是如此不同。</p>
    <p>上面的重用算法也在这里使用。换句话说：每个唯一的通行短语仅调用一次外部程序。</p></li>
</ul>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLPassPhraseDialog "exec:/usr/local/apache/sbin/pp-filter"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProtocol" id="SSLProtocol">SSL协议</a> <a name="sslprotocol" id="sslprotocol">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>配置可用的SSL / TLS协议版本</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProtocol [+ |-] <em>协议</em> ...</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLProtocol all -SSLv3（最高2.4.16：全部）</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此伪指令可用于控制新连接中将接受哪个版本的SSL / TLS协议。</p>
<p>可用的（不区分大小写） <em>协议</em>为：</p>
<ul>
<li><code>SSLv3</code>
    <p>这是来自Netscape Corporation的安全套接字层（SSL）协议版本3.0。它是SSLv2的继承者和TLSv1的继承者，但在<a href="http://www.ietf.org/rfc/rfc7568.txt">RFC 7568中</a>已弃用。</p></li>

<li><code>TLSv1</code>
    <p>这是传输层安全性（TLS）协议，版本1.0。它是SSLv3的继承者，在<a href="http://www.ietf.org/rfc/rfc2246.txt">RFC 2246中</a>定义。几乎每个客户都支持它。</p></li>

<li><code>TLSv1.1</code> （使用OpenSSL 1.0.1和更高版本时）<p><a href="http://www.ietf.org/rfc/rfc4346.txt">RFC 4346中</a>定义的TLS 1.0协议的修订版。</p></li>

<li><code>TLSv1.2</code> （使用OpenSSL 1.0.1和更高版本时）<p><a href="http://www.ietf.org/rfc/rfc5246.txt">RFC 5246中</a>定义的TLS 1.1协议的修订版。</p></li>

<li><code>所有</code>
    <p>这是`` <code>+SSLv3 +TLSv1</code> ''的快捷方式，或者-使用OpenSSL 1.0.1及更高版本时-分别是`` <code>+SSLv3 +TLSv1 +TLSv1.1 +TLSv1.2</code> ''的<code>+SSLv3 +TLSv1 +TLSv1.1 +TLSv1.2</code> （使用``no-ssl3''配置选项，其中<code>all</code>都不包括<code>+SSLv3</code> ）。</p></li>
</ul>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLProtocol TLSv1</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyCACertificateFile" id="SSLProxyCACertificateFile">SSLProxyCACertificateFile</a> <a name="sslproxycacertificatefile" id="sslproxycacertificatefile">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>用于远程服务器身份验证的串联PEM编码的CA证书文件</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyCACertificateFile <em>文件路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>该指令设置了<em>一个多</em>文件，您可以在其中汇编要处理其<em>远程服务器</em>的证书颁发机构（CA）证书。这些用于远程服务器身份验证。按照优先顺序，此文件只是各种PEM编码的证书文件的串联。可以替代和/或附加使用<code class="directive"><a href="#sslproxycacertificatepath">SSLProxyCACertificatePath</a></code> 。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLProxyCACertificateFile "/usr/local/apache2/conf/ssl.crt/ca-bundle-remote-server.crt"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyCACertificatePath" id="SSLProxyCACertificatePath">SSLProxyCACertificatePath</a> <a name="sslproxycacertificatepath" id="sslproxycacertificatepath">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>用于远程服务器身份验证的PEM编码的CA证书目录</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyCACertificatePath <em>目录路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此伪指令设置目录，其中保存要处理其远程服务器的证书颁发机构证书（CA）。这些用于在“远程服务器身份验证”上验证远程服务器证书。</p>
<p>此目录中的文件必须经过PEM编码，并可以通过哈希文件名进行访问。因此，通常不能只将证书文件放在此处：还必须创建名为<em>hash-value的</em>符号链接<code>.N</code>并且您应该始终确保该目录包含适当的符号链接。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLProxyCACertificatePath "/usr/local/apache2/conf/ssl.crt/"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyCARevocationCheck" id="SSLProxyCARevocationCheck">SSLProxyCARevocationCheck</a> <a name="sslproxycarevocationcheck" id="sslproxycarevocationcheck">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>为远程服务器身份验证启用基于CRL的吊销检查</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyCARevocationCheck链|叶|无</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLProxyCARevocation检查无</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>对您处理的<em>远程服务器</em>启用证书吊销列表（CRL）检查。必须配置<code class="directive"><a href="#sslproxycarevocationfile">SSLProxyCARevocationFile</a></code>或<code class="directive"><a href="#sslproxycarevocationpath">SSLProxyCARevocationPath</a></code>至少一个。设置为<code>chain</code> （推荐设置）时，CRL检查将应用于链中的所有证书，而将其设置为<code>leaf</code>则将检查限制为最终实体证书。
</p>
<div class="note">
<h3>设置为<code>chain</code>或<code>leaf</code> ，CRL <em>必须</em>可用以成功进行验证</h3>
<p>在2.3.15版之前，如果在使用<code class="directive"><a href="#sslproxycarevocationfile">SSLProxyCARevocationFile</a></code>或<code class="directive"><a href="#sslproxycarevocationpath">SSLProxyCARevocationPath</a></code>配置的任何位置<code class="directive"><a href="#sslproxycarevocationfile">SSLProxyCARevocationFile</a></code>找到CRL，则mod_ssl中的CRL检查也成功。引入此指令后，行为已更改：启用检查后， <em>必须</em>存在CRL <em>才能</em>使验证成功-否则它将失败，并显示<code>"unable to get certificate CRL"</code>错误。
</p>
</div>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLProxyCARevocationCheck chain</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyCARevocationFile" id="SSLProxyCARevocationFile">SSLProxyCARevocationFile</a> <a name="sslproxycarevocationfile" id="sslproxycarevocationfile">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>用于远程服务器身份验证的串联PEM编码的CA CRL文件</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyCARevocationFile <em>文件路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此伪指令设置了<em>一个多</em>文件，您可以在其中汇编要处理其<em>远程服务器</em>的证书颁发机构（CA）的证书吊销列表（CRL）。这些用于远程服务器身份验证。按照优先顺序，此文件只是各种PEM编码的CRL文件的串联。可以替代和/或附加使用<code class="directive"><a href="#sslproxycarevocationpath">SSLProxyCARevocationPath</a></code> 。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLProxyCARevocationFile "/usr/local/apache2/conf/ssl.crl/ca-bundle-remote-server.crl"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyCARevocationPath" id="SSLProxyCARevocationPath">SSLProxyCARevocationPath</a> <a name="sslproxycarevocationpath" id="sslproxycarevocationpath">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>用于远程服务器身份验证的PEM编码的CA CRL目录</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyCARevocationPath <em>目录路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此伪指令设置目录，在该目录中保留要处理其远程服务器的证书颁发机构（CA）的证书吊销列表（CRL）。这些用于撤销“远程服务器身份验证”上的远程服务器证书。</p>
<p>此目录中的文件必须经过PEM编码，并可以通过哈希文件名进行访问。因此，通常您不仅要将CRL文件放在此处。另外，您必须创建名为<em>hash-value</em> <code>.rN</code>符号链接。并且您应该始终确保该目录包含适当的符号链接。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLProxyCARevocationPath "/usr/local/apache2/conf/ssl.crl/"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyCheckPeerCN" id="SSLProxyCheckPeerCN">SSLProxyCheckPeerCN</a> <a name="sslproxycheckpeercn" id="sslproxycheckpeercn">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>是否检查远程服务器证书的CN字段</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyCheckPeerCN开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>启用SSLProxyCheckPeerCN</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>该指令设置是否将远程服务器证书的CN字段与请求URL的主机名进行比较。如果两者不相等，则会发送502状态代码（错误网关）。<code>SSLProxyCheckPeerCN</code>被取代<code class="directive"><a href="#sslproxycheckpeername">SSLProxyCheckPeerName</a></code>在发布2.4.5及更高版本。
</p>
<p>在所有版本2.4.5到2.4.20中，将<code>SSLProxyCheckPeerName off</code>设置<code>SSLProxyCheckPeerName off</code>足以启用此行为（因为<code>SSLProxyCheckPeerCN</code>默认<code>SSLProxyCheckPeerCN</code> <code>on</code> 。）在这些发行版中，必须将两个指令都设置为<code>off</code>以完全避免远程服务器证书名称验证。许多用户报告这非常令人困惑。
</p>
<p>从版本2.4.21开始，启用<code>SSLProxyCheckPeerName</code>或<code>SSLProxyCheckPeerCN</code>选项之一的所有配置都将使用新的<code class="directive"><a href="#sslproxycheckpeername">SSLProxyCheckPeerName</a></code>行为，而禁用<code>SSLProxyCheckPeerName</code>或<code>SSLProxyCheckPeerCN</code>选项之一的所有配置将禁止所有远程服务器证书名称验证。只有以下配置将触发2.4.21和更高版本中的旧证书CN比较；</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLProxyCheckPeerCN on
SSLProxyCheckPeerName off</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyCheckPeerExpire" id="SSLProxyCheckPeerExpire">SSLProxyCheckPeerExpire</a> <a name="sslproxycheckpeerexpire" id="sslproxycheckpeerexpire">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>是否检查远程服务器证书是否过期</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyCheckPeerExpire开启|关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLProxyCheckPeerExpire于</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此伪指令设置是否检查远程服务器证书是否过期。如果检查失败，则发送502状态代码（错误网关）。
</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLProxyCheckPeerExpire on</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyCheckPeerName" id="SSLProxyCheckPeerName">SSLProxyCheckPeerName</a> <a name="sslproxycheckpeername" id="sslproxycheckpeername">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>为远程服务器证书配置主机名检查</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyCheckPeerName开启|关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLProxyCheckPeerName在</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>Apache HTTP Server 2.4.5及更高版本</td></tr>
</table>
<p>当mod_ssl充当SSL客户端时，此伪指令为服务器证书配置主机名检查。如果来自请求URI的主机名与证书主题的CN属性之一匹配，或者与subjectAltName扩展名匹配，则检查将成功。如果检查失败，则SSL请求将中止，并返回502状态代码（错误网关）。
</p>
<p>在特定情况下支持通配符匹配：dNSName类型的subjectAltName条目，或以<code>*.</code>开头的CN属性<code>*.</code>将与具有相同数量的名称元素和相同后缀的任何主机名匹配。例如<code>*.example.org</code>将匹配<code>foo.example.org</code> ，但是将不匹配<code>foo.bar.example.org</code> ，因为各个主机名中的元素数量不同。
</p>
<p>此功能在2.4.5中引入，并取代了<code class="directive"><a href="#sslproxycheckpeercn">SSLProxyCheckPeerCN</a></code>指令的行为，该指令仅针对主机名测试了第一个CN属性中的确切值。但是，许多用户对单独使用这些指令的行为感到困惑，因此版本2.4.21中改进了<code>SSLProxyCheckPeerName</code>和<code>SSLProxyCheckPeerCN</code>指令的相互行为。有关原始行为和这些改进的详细信息，请参见<code class="directive"><a href="#sslproxycheckpeercn">SSLProxyCheckPeerCN</a></code>指令说明。
</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyCipherSuite" id="SSLProxyCipherSuite">SSLProxyCipherSuite</a> <a name="sslproxyciphersuite" id="sslproxyciphersuite">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>密码套件可用于SSL代理握手中的协商</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyCipherSuite <em>密码规范</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLProxyCipherSuite全部：！ADH：RC4 + RSA：+ HIGH：+ MEDIUM：+ LOW：+ EXP</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>与<code class="directive"><a href="#sslciphersuite">SSLCipherSuite</a></code>等效，但用于代理连接。请参考<code class="directive"><a href="#sslciphersuite">SSLCipherSuite</a></code>了解更多信息。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyEngine" id="SSLProxyEngine">SSLProxyEngine</a> <a name="sslproxyengine" id="sslproxyengine">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>SSL代理引擎操作开关</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyEngine开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLProxyEngine关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>该指令切换SSL / TLS协议引擎对代理的使用。通常在<code class="directive"><a href="../mod/core.html#virtualhost">&lt;VirtualHost&gt;</a></code>部分中使用它来启用SSL / TLS以在特定虚拟主机中使用代理。默认情况下，禁用SSL / TLS协议引擎作为主服务器和所有已配置虚拟主机的代理。</p>

<p>请注意， <code class="directive">SSLProxyEngine</code>不应该将<code class="directive">SSLProxyEngine</code>指令包含在将充当转发代理的虚拟主机中（使用<code class="directive"><a href="../mod/mod_proxy.html#proxy">&lt;Proxy&gt;</a></code>或<code class="directive"><a href="../mod/mod_proxy.html#proxyrequests">ProxyRequests</a></code>指令）。
<code class="directive">SSLProxyEngine</code>即可使转发代理服务器代理SSL / TLS请求。</p>

<div class="example"><h3>例</h3><pre class="prettyprint lang-config">&lt;VirtualHost _default_:443&gt;
    SSLProxyEngine on
    #...
&lt;/VirtualHost&gt;</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyMachineCertificateChainFile" id="SSLProxyMachineCertificateChainFile">SSLProxyMachineCertificateChainFile</a> <a name="sslproxymachinecertificatechainfile" id="sslproxymachinecertificatechainfile">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>代理用来选择证书的级联PEM编码CA证书的文件</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyMachineCertificateChainFile <em>文件名</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此伪指令设置多合一文件，您可以在其中保留所有正在使用的客户端证书的证书链。如果远程服务器显示不是配置的客户端证书之一的直接签名者的CA证书的列表，则需要此伪指令。
</p>
<p>该引用文件只是各种PEM编码的证书文件的串联。启动时，将检查配置的每个客户端证书，并构建信任链。
</p>
<div class="warning"><h3>安全警告</h3>
<p>如果启用此指令，则文件中的所有证书都将受到信任，就像它们也在<code class="directive"><a href="#sslproxycacertificatefile">SSLProxyCACertificateFile</a></code> 。</p>
</div>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLProxyMachineCertificateChainFile "/usr/local/apache2/conf/ssl.crt/proxyCA.pem"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyMachineCertificateFile" id="SSLProxyMachineCertificateFile">SSLProxyMachineCertificateFile</a> <a name="sslproxymachinecertificatefile" id="sslproxymachinecertificatefile">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>代理要使用的级联PEM编码的客户端证书和密钥的文件</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyMachineCertificateFile <em>文件名</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此伪指令设置多合一文件，您可以在其中保留用于对远程服务器进行代理服务器身份验证的证书和密钥。
</p>
<p>按照优先顺序，此引用文件只是各种PEM编码的证书文件的串联。替代<code>SSLProxyMachineCertificatePath</code>使用此伪指令。
</p>
<div class="warning">
<p>当前不支持加密的私钥</p>
</div>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLProxyMachineCertificateFile "/usr/local/apache2/conf/ssl.crt/proxy.pem"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyMachineCertificatePath" id="SSLProxyMachineCertificatePath">SSLProxyMachineCertificatePath</a> <a name="sslproxymachinecertificatepath" id="sslproxymachinecertificatepath">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>代理将使用的PEM编码的客户端证书和密钥的目录</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyMachineCertificatePath <em>目录</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此伪指令设置目录，您在其中保留用于对远程服务器进行代理服务器身份验证的证书和密钥。
</p>
<p>该目录中的文件必须经过PEM编码，并且可以通过哈希文件名进行访问。另外，您必须创建名为<code><em>hash-value .</em>符号链接<code><em>hash-value</em> .N</code>并且您应该始终确保该目录包含适当的符号链接。</p>
<div class="warning">
<p>当前不支持加密的私钥</p>
</div>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLProxyMachineCertificatePath "/usr/local/apache2/conf/proxy.crt/"</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyProtocol" id="SSLProxyProtocol">SSLProxyProtocol</a> <a name="sslproxyprotocol" id="sslproxyprotocol">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>为代理使用配置可用的SSL协议版本</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyProtocol [+ |-] <em>协议</em> ...</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLProxyProtocol全部-SSLv3（最高2.4.16：全部）</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>

<p>此伪指令可用于控制mod_ssl建立代理服务器环境时应使用的SSL协议版本。它将仅使用提供的协议之一连接到服务器。</p>
<p>请参考<code class="directive"><a href="#sslprotocol">SSLProtocol</a></code>以获得更多信息。
</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyVerify" id="SSLProxyVerify">SSLProxyVerify</a> <a name="sslproxyverify" id="sslproxyverify">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>远程服务器证书验证的类型</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyVerify <em>级别</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLProxy验证无</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>

<p>当代理配置为将请求转发到远程SSL服务器时，此伪指令可用于配置远程服务器的证书验证。</p>
<p>以下级别可用于<em>级别</em> ：</p>
<ul>
<li><strong>none</strong> ：完全不需要远程服务器证书</li>
<li><strong>可选</strong> ：远程服务器<em>可以</em>出示有效的证书</li>
<li><strong>要求</strong> ：远程服务器<em>必须</em>出示有效的证书</li>
<li><strong>optional_no_ca</strong> ：远程服务器可以出示有效的证书<br>但它不必（成功）可验证。</li>
</ul>
<p>在实践中，只有级别<strong>none</strong>和<strong>require</strong>才是真正有趣的，因为<strong>可选</strong>级别并非对所有服务器都有效，而<strong>可选</strong> _no_ca级别实际上违背了身份验证的思想（但可用于建立SSL测试页等）。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLProxyVerify require</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLProxyVerifyDepth" id="SSLProxyVerifyDepth">SSLProxyVerifyDepth</a> <a name="sslproxyverifydepth" id="sslproxyverifydepth">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>远程服务器证书验证中CA证书的最大深度</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLProxyVerifyDepth <em>编号</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLProxyVerifyDepth 1</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，代理部分</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>该指令设置了mod_ssl在确定远程服务器没有有效证书之前应验证的深度。</p>
<p>深度实际上是中间证书颁发者的最大数量，即在验证远程服务器证书时允许遵循的最大CA证书数量。深度为0表示仅接受自签名的远程服务器证书，默认深度为1表示远程服务器证书可以是自签名的，或者必须由服务器直接已知的CA签名（即CA的证书位于<code class="directive"><a href="#sslproxycacertificatepath">SSLProxyCACertificatePath</a></code>之下），等等。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLProxyVerifyDepth 10</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLRandomSeed" id="SSLRandomSeed">SSLRandomSeed</a> <a name="sslrandomseed" id="sslrandomseed">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>伪随机数生成器（PRNG）种子源</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLRandomSeed <em>上下文</em> <em>源</em> [ <em>字节</em> ]</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>这将配置一个或多个源，以在启动时（ <em>上下文</em>为<code>startup</code> ）和/或刚建立新的SSL连接（ <em>上下文</em>为<code>connect</code> ）之前在OpenSSL中植入伪随机数生成器（PRNG）。由于PRNG是全局工具，因此只能在全局服务器上下文中使用此伪指令。</p>
<p>提供以下<em>源</em>变体：</p>
<ul>
<li><code>内建的</code>
    <p>这是始终可用的内置种子源。它的使用在运行时消耗最少的CPU周期，因此可以始终使用而没有缺点。用于为PRNG注入种子的源包含当前时间，当前进程ID以及（如果适用）Apache进程间记分板结构的随机选择的1KB摘录。缺点是，这并不是真正的强大资源，并且在启动时（记分板仍然不可用），该资源只会产生几个字节的熵。因此，至少应在启动时始终使用其他种子源。</p></li>
<li><code>文件：/ path / to / source</code>
    <p>此变体使用外部文件<code>/path/to/source</code>作为PRNG种子的源。当指定的<em>字节</em>时，只有文件的字节第一<em>字节</em>数形成所述熵（和<em>字节</em>被提供给<code>/path/to/source</code>作为第一个参数）。当<em>字节</em>未指定整个文件形式的熵（和<code>0</code>被提供给<code>/path/to/source</code>作为第一个参数）。尤其是在启动时使用它，例如，使用可用的<code>/dev/random</code>和/或<code>/dev/urandom</code>设备（通常存在于FreeBSD和Linux等现代Unix衍生产品上）。</p>
    <p>
    <em>但请注意</em> ：通常<code>/dev/random</code>仅提供与实际一样多的熵数据，即，当您请求512字节的熵时，但是设备当前只有100字节可用，可能会发生两种情况：在某些平台上，您只会收到100字节，而在其他平台上，读取将阻塞直到有足够的字节可用（这可能需要很长时间）。在这里，使用现有的<code>/dev/urandom</code>更好，因为它从不阻塞并且实际上提供了所请求的数据量。缺点是接收到的数据质量可能不是最好的。</p></li>

<li><code>exec：/路径/到/程序</code>
    <p>此变体使用外部可执行文件<code>/path/to/program</code>作为PRNG种子的源。指定<em>bytes时</em> ，只有其<code>stdout</code>内容的第一个<em>字节</em>数构成熵。如果未指定<em>字节</em> ，则在<code>stdout</code>生成的全部数据将形成熵。仅在启动时需要外部程序的帮助时才使用此功能（例如，如上例中使用<code>truerand</code>实用程序的示例，您可以在基于AT＆T <em>truerand</em>库的mod_ssl发行版中找到）。当然，在连接上下文中使用它会极大地降低服务器的速度。因此，通常应该避免在这种情况下使用外部程序。</p></li>
<li><code>egd:/path/to/egd-socket</code> （仅Unix）<p>此变体使用外部熵收集守护程序（EGD）的Unix域套接字（请参阅<a href="http://www.lothar.com/tech/crypto/">http://www.lothar.com/tech/crypto/</a> ）来植入PRNG。如果您的平台上不存在随机设备，请使用此选项。</p></li>
</ul>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLRandomSeed startup builtin
SSLRandomSeed startup "file:/dev/random"
SSLRandomSeed startup "file:/dev/urandom" 1024
SSLRandomSeed startup "exec:/usr/local/bin/truerand" 16
SSLRandomSeed connect builtin
SSLRandomSeed connect "file:/dev/random"
SSLRandomSeed connect "file:/dev/urandom" 1024</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLRenegBufferSize" id="SSLRenegBufferSize">SSLRenegBufferSize</a> <a name="sslrenegbuffersize" id="sslrenegbuffersize">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>设置SSL重新协商缓冲区的大小</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLRenegBufferSize <var>字节</var></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLRenegBufferSize 131072</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>目录.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>验证配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>

<p>如果在每个位置的上下文中需要SSL重新协商，例如，在Directory或Location块中使用<code class="directive"><a href="#sslverifyclient">SSLVerifyClient</a></code> ，则<code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code>必须将任何HTTP请求正文缓冲到内存中，直到可以执行新的SSL握手为止。此伪指令可用于设置将用于此缓冲区的内存量。</p>

<div class="warning"><p>请注意，在许多配置中，发送请求正文的客户端将不受信任，因此在更改此配置设置时，必须考虑通过消耗内存来拒绝服务攻击。
</p></div>

<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLRenegBufferSize 262144</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLRequire" id="SSLRequire">SSLRequire</a> <a name="sslrequire" id="sslrequire">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>仅在任意复杂的布尔表达式为true时才允许访问</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLRequire <em>表达式</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>目录.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>验证配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>

<div class="note"><h3>不建议使用SSLRequire</h3>
<p><code>SSLRequire</code>已弃用，通常应由<a href="mod_authz_core.html#reqexpr">Require expr</a>代替。所谓<a href="../expr.html">ap_expr</a>的语法<code>Require expr</code>是对语法的超<code>SSLRequire</code> ，但下列情况除外：</p>

<p>在<code>SSLRequire</code> ，比较运算符<code>&lt;</code> ， <code>&lt;=</code> ，...完全等同于运算符<code>lt</code> ， <code>le</code> ，...，并且以某种特殊的方式工作，首先比较两个字符串的长度，然后比较词法顺序。另一方面， <a href="../expr.html">ap_expr</a>有两组比较运算符：运算符<code>&lt;</code> ， <code>&lt;=</code> ，...做词法字符串比较，而运算符<code>-lt</code> ， <code>-le</code> ，...做整数比较。对于后者，别名也没有前导破折号： <code>lt</code> ， <code>le</code> ，...
</p>

</div>

<p>该指令指定了一般访问要求，为了允许访问，必须满足该要求。这是一个非常强大的指令，因为需求规范是一个任意复杂的布尔表达式，包含任意数量的访问检查。</p>
<p>该<em>表达式</em>必须与以下语法匹配（作为BNF语法符号）：</p>
<blockquote>
<pre>expr     ::= "<strong>true</strong>" | "<strong>false</strong>"
           | "<strong>!</strong>" expr
           | expr "<strong>&amp;&amp;</strong>" expr
           | expr "<strong>||</strong>" expr
           | "<strong>(</strong>" expr "<strong>)</strong>"
           | comp

comp     ::= word "<strong>==</strong>" word | word "<strong>eq</strong>" word
           | word "<strong>!=</strong>" word | word "<strong>ne</strong>" word
           | word "<strong>&lt;</strong>"  word | word "<strong>lt</strong>" word
           | word "<strong>&lt;=</strong>" word | word "<strong>le</strong>" word
           | word "<strong>&gt;</strong>"  word | word "<strong>gt</strong>" word
           | word "<strong>&gt;=</strong>" word | word "<strong>ge</strong>" word
           | word "<strong>in</strong>" "<strong>{</strong>" wordlist "<strong>}</strong>"
           | word "<strong>in</strong>" "<strong>PeerExtList(</strong>" word "<strong>)</strong>"
           | word "<strong>=~</strong>" regex
           | word "<strong>!~</strong>" regex

wordlist ::= word
           | wordlist "<strong>,</strong>" word

word     ::= digit
           | cstring
           | variable
           | function

digit    ::= [0-9]+
cstring  ::= "..."
variable ::= "<strong>%{</strong>" varname "<strong>}</strong>"
function ::= funcname "<strong>(</strong>" funcargs "<strong>)</strong>"</pre>
</blockquote>
<p>对于<code>varname</code> ，可以使用<a href="#envvars">环境</a>变量中描述的任何变量。对于<code>funcname</code> ，可用功能在<a href="../expr.html#functions">ap_expr文档</a>中列出。</p>

<p>加载配置时，该<em>表达式</em>将解析为内部机器表示，然后在请求处理期间对其求值。在.htaccess上下文中，每次在请求处理期间遇到.htaccess文件时，都会对<em>表达式</em>进行解析和执行。</p>

<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLRequire (    %{SSL_CIPHER} !~ m/^(EXP|NULL)-/                   \
            and %{SSL_CLIENT_S_DN_O} eq "Snake Oil, Ltd."          \
            and %{SSL_CLIENT_S_DN_OU} in {"Staff", "CA", "Dev"}    \
            and %{TIME_WDAY} -ge 1 and %{TIME_WDAY} -le 5          \
            and %{TIME_HOUR} -ge 8 and %{TIME_HOUR} -le 20       ) \
           or %{REMOTE_ADDR} =~ m/^192\.76\.162\.[0-9]+$/</pre>
</div>

<p><code>PeerExtList( <em>object-ID</em> )</code>函数期望在客户端证书中找到零个或多个X.509证书扩展实例，这些实例由给定的<em>对象ID</em> （OID） <em>标识</em> 。如果左侧字符串与与此OID标识的扩展名的值完全匹配，则该表达式的计算结果为true。 （如果存在多个具有相同OID的扩展名，则至少一个扩展名必须匹配）。</p>

<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLRequire "foobar" in PeerExtList("1.2.3.4.5.6")</pre>
</div>

<div class="note"><h3>关于PeerExtList函数的注释</h3>

<ul>

<li><p>可以将对象ID指定为SSL库识别的描述性名称（例如<code>"nsComment"</code> ）或数字OID（例如<code>"1.2.3.4.5.6"</code> 。</p></li>

<li><p>比较之前，具有SSL库已知类型的表达式将呈现为字符串。对于具有SSL库无法识别的类型的扩展，如果mod_ssl是原始ASN.1类型UTF8String，IA5String，VisibleString或BMPString之一，则它将解析该值。对于这些类型之一的扩展，如有必要，字符串值将转换为UTF-8，然后与左侧表达式进行比较。</p></li>

</ul>
</div>


<h3>也可以看看</h3>
<ul>
<li>有关其他示例，请<a href="../env.html">参见Apache HTTP Server中的环境变量</a> 。
</li>
<li><a href="mod_authz_core.html#reqexpr">需要expr</a></li>
<li><a href="../expr.html">Apache HTTP Server中的通用表达式语法</a>
</li>
</ul>
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLRequireSSL" id="SSLRequireSSL">SSLRequireSSL</a> <a name="sslrequiressl" id="sslrequiressl">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>未将SSL用于HTTP请求时拒绝访问</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSL要求</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>目录.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>验证配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>除非为当前连接启用了SSL上的HTTP（即HTTPS），否则该指令禁止访问。这在启用SSL的虚拟主机或目录中非常方便，可防止配置错误暴露应受保护的内容。使用此指令时，将拒绝所有未使用SSL的请求。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLRequireSSL</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLSessionCache" id="SSLSessionCache">SSLSessionCache</a> <a name="sslsessioncache" id="sslsessioncache">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>全局/进程间SSL会话缓存的类型</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLSessionCache <em>类型</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLSessionCache无</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>这将配置全局/进程间SSL会话缓存的存储类型。该缓存是可选功能，可加快并行请求处理。对于对同一服务器进程的请求（通过HTTP保持活动），OpenSSL已在本地缓存SSL会话信息。但是，由于现代客户端通过并行请求（通常多达四个并行请求）请求内联图像和其他数据，因此这些请求由<em>不同的</em>预分支服务器进程处理。在此，进程间缓存有助于避免不必要的会话握手。</p>
<p>当前支持以下五种存储<em>类型</em> ：</p>
<ul>
<li><code>没有</code>

    <p>这将禁用全局/进程间会话缓存。如果使用某些浏览器，尤其是启用了客户端证书，这将导致明显的速度损失，并可能导致问题。不建议使用此设置。</p></li>

<li><code>nonenotnull</code>

    <p>这将禁用所有全局/进程间会话缓存。但是，它确实强制OpenSSL发送非空会话ID，以容纳需要一个的错误客户端。</p></li>

<li><code>dbm：/路径/到/数据文件</code>

    <p>这将利用本地磁盘上的DBM哈希文件来同步服务器进程的本地OpenSSL内存缓存。在高负载下，此会话缓存可能会遇到可靠性问题。要使用此功能，请确保已加载<code class="module"><a href="../mod/mod_socache_dbm.html">mod_socache_dbm</a></code> 。</p></li>

<li><code>shmcb:/path/to/datafile</code> [ <code>(</code> <em>size</em> <code>)</code> ]<p>这将利用RAM中的共享内存段（通过<code>/path/to/datafile</code>建立）中的高性能循环缓冲区（ <em>大小</em>约为<em>大小</em>字节）来同步服务器进程的本地OpenSSL内存缓存。这是推荐的会话缓存。要使用此功能，请确保已加载<code class="module"><a href="../mod/mod_socache_shmcb.html">mod_socache_shmcb</a></code> 。</p></li>

<li><code>dc：UNIX：/ path / to / socket</code>

    <p>这利用了<a href="http://distcache.sourceforge.net/">distcache</a>分布式会话缓存库。该参数应使用distcache地址语法指定要使用的服务器或代理的位置。例如， <code>UNIX:/path/to/socket</code>指定UNIX域套接字（通常是本地dc_client代理）； <code>IP:server.example.com:9001</code>指定IP地址。要使用此功能，请确保已加载<code class="module"><a href="../mod/mod_socache_dc.html">mod_socache_dc</a></code> 。</p></li>

</ul>

<div class="example"><h3>例子</h3><pre class="prettyprint lang-config">SSLSessionCache "dbm:/usr/local/apache/logs/ssl_gcache_data"
SSLSessionCache "shmcb:/usr/local/apache/logs/ssl_gcache_data(512000)"</pre>
</div>

<p><code>ssl-cache</code>互斥锁用于序列化对会话缓存的访问，以防止损坏。可以使用<code class="directive"><a href="../mod/core.html#mutex">Mutex</a></code>指令配置此互斥<code class="directive"><a href="../mod/core.html#mutex">Mutex</a></code> 。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLSessionCacheTimeout" id="SSLSessionCacheTimeout">SSLSessionCacheTimeout</a> <a name="sslsessioncachetimeout" id="sslsessioncachetimeout">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>会话高速缓存中SSL会话过期之前的秒数</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLSessionCacheTimeout <em>秒</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLSessionCacheTimeout 300</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>还适用于Apache 2.4.10和更高版本中的RFC 5077 TLS会话恢复</td></tr>
</table>
<p>该指令为存储在全局/进程间SSL会话高速缓存，OpenSSL内部存储器高速缓存中以及通过TLS会话恢复（RFC 5077）恢复的会话设置超时（以秒为单位）。可以将其设置为15以进行测试，但在现实生活中应将其设置为较高的值，例如300。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLSessionCacheTimeout 600</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLSessionTicketKeyFile" id="SSLSessionTicketKeyFile">SSLSessionTicketKeyFile</a> <a name="sslsessionticketkeyfile" id="sslsessionticketkeyfile">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>TLS会话票证的持久加密/解密密钥</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLSessionTicketKeyFile <em>文件路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.8h或更高版本，则在httpd 2.4.0和更高版本中可用</td></tr>
</table>
<p>（可选）配置<a href="http://www.ietf.org/rfc/rfc5077.txt">RFC 5077中</a>定义的用于加密和解密TLS会话票证的密钥。主要适用于在多个节点之间共享TLS会话信息的群集环境。对于单实例httpd设置，建议<em>不要</em>配置票证密钥文件，而应在启动时依靠mod_ssl生成的（随机）密钥。</p>
<p>票证密钥文件必须包含48个字节的随机数据，最好从高熵源创建。在基于Unix的系统上，可以如下创建票证密钥文件：</p>

<div class="example"><p><code>dd if = / dev / random = / path / to / file.tkey bs = 1 count = 48</code></p></div>

<p>工单密钥应经常旋转（替换），因为这是使现有会话工单失效的唯一方法-OpenSSL当前不允许指定工单寿命的限制。仅在重新启动Web服务器后才能使用新的票证密钥。重新启动后，所有现有的会话票证都将变为无效。</p>

<div class="warning">
<p>票证密钥文件包含敏感的密钥资料，并应使用类似于<code class="directive"><a href="#sslcertificatekeyfile">SSLCertificateKeyFile</a></code>文件许可权进行保护。</p>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLSessionTickets" id="SSLSessionTickets">SSLSessionTickets</a> <a name="sslsessiontickets" id="sslsessiontickets">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>启用或禁用TLS会话票证</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLSessionTickets开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLSessionTickets在</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.8f或更高版本，则在httpd 2.4.11和更高版本中可用。</td></tr>
</table>
<p>该指令允许启用或禁用TLS会话票证（RFC 5077）。</p>
<div class="warning">
<p>TLS会话票证默认情况下处于启用状态。使用它们而不以适当的频率（例如每天）重新启动Web服务器会损害完美的前向保密性。</p>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLSRPUnknownUserSeed" id="SSLSRPUnknownUserSeed">SSLSRPUnknownUserSeed</a> <a name="sslsrpunknownuserseed" id="sslsrpunknownuserseed">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>SRP未知用户种子</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLSRPUnknownUserSeed <em>秘密字符串</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 1.0.1或更高版本，则在httpd 2.4.4和更高版本中可用</td></tr>
</table>
<p>该指令设置用于为未知用户伪造SRP用户参数的种子，以避免泄漏给定用户是否存在。指定一个秘密字符串。如果不使用此指令，那么Apache将向指定未知用户名的客户端返回UNKNOWN_PSK_IDENTITY警报。
</p>
<div class="example"><h3>例</h3><p><code>SSLSRPUnknownUserSeed“秘密”</code></p></div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLSRPVerifierFile" id="SSLSRPVerifierFile">SSLSRPVerifierFile</a> <a name="sslsrpverifierfile" id="sslsrpverifierfile">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>SRP验证程序文件的路径</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLSRPVerifierFile <em>文件路径</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 1.0.1或更高版本，则在httpd 2.4.4和更高版本中可用</td></tr>
</table>
<p>此伪指令启用TLS-SRP，并将路径设置为包含TLS-SRP用户名，验证者，盐和组参数的OpenSSL SRP（安全远程密码）验证者文件。</p>
<div class="example"><h3>例</h3><p><code>SSLSRPVerifierFile“ /path/to/file.srpv”</code></p></div>
<p>可以使用<code>openssl</code>命令行实用程序创建验证程序文件：</p>
<div class="example"><h3>创建SRP验证程序文件</h3><p><code>openssl srp -srpvfile passwd.srpv -userinfo“一些信息”-添加用户名</code></p></div>
<p>在<code>SSL_SRP_USERINFO</code>请求环境变量中，可以使用<code>-userinfo</code>可选参数给出的值。</p>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLStaplingCache" id="SSLStaplingCache">SSLStaplingCache</a> <a name="sslstaplingcache" id="sslstaplingcache">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>配置OCSP装订缓存</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLStaplingCache <em>类型</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.8h或更高版本，则可用</td></tr>
</table>
<p>如果启用了<code class="directive"><a href="#sslusestapling">SSLUseStapling</a></code>则配置用于存储OCSP响应的缓存，该缓存将包含在TLS握手中。对于OCSP装订，必须配置缓存。除了<code>none</code>和<code>nonenotnull</code> ，支持与<code class="directive"><a href="#sslsessioncache">SSLSessionCache</a></code>相同的存储类型。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLStaplingErrorCacheTimeout" id="SSLStaplingErrorCacheTimeout">SSLStaplingErrorCacheTimeout</a> <a name="sslstaplingerrorcachetimeout" id="sslstaplingerrorcachetimeout">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>OCSP装订缓存中的无效响应到期前的秒数</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLStaplingErrorCacheTimeout <em>秒</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLStaplingErrorCacheTimeout 600</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.8h或更高版本，则可用</td></tr>
</table>
<p>设置超时（以秒为单位），以使OCSP装订缓存（通过<code class="directive"><a href="#sslstaplingcache">SSLStaplingCache</a></code>配置）中的<em>无效</em>响应到期。要为有效响应设置缓存超时，请参见<code class="directive"><a href="#sslstaplingstandardcachetimeout">SSLStaplingStandardCacheTimeout</a></code> 。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLStaplingFakeTryLater" id="SSLStaplingFakeTryLater">SSLStaplingFakeTryLater</a> <a name="sslstaplingfaketrylater" id="sslstaplingfaketrylater">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>合成失败的OCSP装订查询的“ tryLater”响应</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLStaplingFakeTryLater开启|关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLStaplingFakeTryLater on</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.8h或更高版本，则可用</td></tr>
</table>
<p>启用后，对用于装订目的的OCSP响应器的查询失败时，mod_ssl将为客户端合成“ tryLater”响应。仅当还启用了<code class="directive"><a href="#sslstaplingreturnrespondererrors">SSLStaplingReturnResponderErrors</a></code>时才有效。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLStaplingForceURL" id="SSLStaplingForceURL">SSLStaplingForceURL</a> <a name="sslstaplingforceurl" id="sslstaplingforceurl">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>覆盖证书的AIA扩展名中指定的OCSP响应者URI</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLStaplingForceURL <em>uri</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.8h或更高版本，则可用</td></tr>
</table>
<p>该伪指令将覆盖从证书的authorityInfoAccess（AIA）扩展获得的OCSP响应者的URI。一种潜在的用途是当使用代理检索OCSP查询时。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLStaplingResponderTimeout" id="SSLStaplingResponderTimeout">SSLStaplingResponderTimeout</a> <a name="sslstaplingrespondertimeout" id="sslstaplingrespondertimeout">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>OCSP装订查询超时</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLStaplingResponderTimeout <em>秒</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLStaplingResponderTimeout 10</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.8h或更高版本，则可用</td></tr>
</table>
<p>启用<code class="directive"><a href="#sslusestapling">SSLUseStapling</a></code>且mod_ssl正在查询响应器以进行OCSP装订时，此选项设置对OCSP响应器的查询超时。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLStaplingResponseMaxAge" id="SSLStaplingResponseMaxAge">SSLStaplingResponseMaxAge</a> <a name="sslstaplingresponsemaxage" id="sslstaplingresponsemaxage">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>OCSP装订响应的最大允许年龄</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLStaplingResponseMaxAge <em>秒</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLStaplingResponseMaxAge -1</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.8h或更高版本，则可用</td></tr>
</table>
<p>在考虑出于装订目的而考虑OCSP响应时（即，打开<code class="directive"><a href="#sslusestapling">SSLUseStapling</a></code>时），此选项设置最大允许使用期限（“新鲜度”）。默认值（ <code>-1</code> ）不强制使用最长<code>nextUpdate</code> ，这意味着只要它们的<code>nextUpdate</code>字段在将来，OCSP响应就被视为有效。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLStaplingResponseTimeSkew" id="SSLStaplingResponseTimeSkew">SSLStaplingResponseTimeSkew</a> <a name="sslstaplingresponsetimeskew" id="sslstaplingresponsetimeskew">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>OCSP装订响应验证的最大允许时间偏差</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLStaplingResponseTimeSkew <em>秒</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLStaplingResponseTimeSkew 300</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.8h或更高版本，则可用</td></tr>
</table>
<p>当mod_ssl检查TLS握手（OCSP装订）中包含的OCSP响应的<code>thisUpdate</code>和<code>nextUpdate</code>字段时，此选项设置最大允许时间偏斜。仅在打开<code class="directive"><a href="#sslusestapling">SSLUseStapling</a></code>适用。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLStaplingReturnResponderErrors" id="SSLStaplingReturnResponderErrors">SSLStaplingReturnResponderErrors</a> <a name="sslstaplingreturnrespondererrors" id="sslstaplingreturnrespondererrors">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>将与装订相关的OCSP错误传递给客户端</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLStaplingReturnResponderErrors on | off</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLStaplingReturnResponderErrors on</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.8h或更高版本，则可用</td></tr>
</table>
<p>启用后，mod_ssl会将来自与订书失败相关的OCSP查询的响应（例如，总体状态为“成功”以外的响应，证书状态为“良好”以外的响应，过期的响应等）传递给客户端。如果设置为<code>off</code> ，则仅将证书状态指示为“良好”的响应包括在TLS握手中。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLStaplingStandardCacheTimeout" id="SSLStaplingStandardCacheTimeout">SSLStaplingStandardCacheTimeout</a> <a name="sslstaplingstandardcachetimeout" id="sslstaplingstandardcachetimeout">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>OCSP装订缓存中的响应到期之前的秒数</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLStaplingStandardCacheTimeout <em>秒</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLStaplingStandardCacheTimeout 3600</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.8h或更高版本，则可用</td></tr>
</table>
<p>设置OCSP装订缓存（通过<code class="directive"><a href="#sslstaplingcache">SSLStaplingCache</a></code>配置）中的响应到期之前的超时（以秒为单位）。该指令适用于<em>有效</em>响应，而<code class="directive"><a href="#sslstaplingerrorcachetimeout">SSLStaplingErrorCacheTimeout</a></code>用于控制无效/不可用响应的超时。
</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLStrictSNIVHostCheck" id="SSLStrictSNIVHostCheck">SSLStrictSNIVHostCheck</a> <a name="sslstrictsnivhostcheck" id="sslstrictsnivhostcheck">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>是否允许非SNI客户端访问基于名称的虚拟主机。
</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLStrictSNIVHostCheck开启|关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLStrictSNIVHostCheck关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>在Apache 2.2.12及更高版本中可用</td></tr>
</table>
<p>该指令设置是否允许非SNI客户端访问基于名称的虚拟主机。如果在默认的基于名称的虚拟主机中将其设置为<code>on</code> ，则不允许SNI不感知的客户端访问属于此特定IP /端口组合的<em>任何</em>虚拟主机。如果在任何其他虚拟主机中将其设置为<code>on</code> ，则不允许SNI不知道的客户端访问此特定虚拟主机。
</p>

<div class="warning"><p>仅当httpd是针对具有SNI功能的OpenSSL版本编译的时，此选项才可用。</p></div>

<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLStrictSNIVHostCheck on</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLUserName" id="SSLUserName">SSLUserName</a> <a name="sslusername" id="sslusername">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>变量名确定用户名</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLUserName <em>VARNAME</em></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>验证配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>该伪指令在Apache请求对象中设置“用户”字段。较低的模块使用它来识别带有字符串的用户。特别是，这可能导致设置环境变量<code>REMOTE_USER</code> 。<em>varname</em>可以是任何<a href="#envvars">SSL环境变量</a> 。</p>

<p>请注意，如果使用<code>FakeBasicAuth</code>选项，则此伪指令无效（请参阅<a href="#ssloptions">SSLOptions</a> ）。</p>

<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLUserName SSL_CLIENT_S_DN_CN</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLUseStapling" id="SSLUseStapling">SSLUseStapling</a> <a name="sslusestapling" id="sslusestapling">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>在TLS握手中启用OCSP响应的装订</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLUseStapling开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLUse装订关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
<tr><th><a href="directive-dict.html#Compatibility">兼容性：</a></th><td>如果使用OpenSSL 0.9.8h或更高版本，则可用</td></tr>
</table>
<p>此选项启用OCSP装订，这是由RFC 6066中指定的“证书状态请求” TLS扩展定义的。如果启用（并由客户端请求），mod_ssl将在TLS握手中包含针对其自身证书的OCSP响应。配置<code class="directive"><a href="#sslstaplingcache">SSLStaplingCache</a></code>是启用OCSP装订的先决条件。</p>

<p>OCSP装订减轻了客户端自己查询OCSP响应程序的负担，但应注意，使用RFC 6066规范，服务器的<code>CertificateStatus</code>响应可能仅包含针对单个证书的OCSP响应。对于在其链中具有中间CA证书的服务器证书（当今的典型情况），因此在其当前实现中进行装订只能部分实现“节省往返次数和资源”的既定目标-另请参阅<a href="http://www.ietf.org/rfc/rfc6961.txt">RFC 6961</a> （TLS多个证书状态扩展）。
</p>

<p>启用OCSP装订后，将使用<code>ssl-stapling</code>互斥锁来控制对OCSP装订缓存的访问，以防止损坏，并且使用<code>sss-stapling-refresh</code>互斥锁来控制OCSP响应的刷新。可以使用<code class="directive"><a href="../mod/core.html#mutex">Mutex</a></code>指令配置这些互斥<code class="directive"><a href="../mod/core.html#mutex">Mutex</a></code> 。
</p>


</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLVerifyClient" id="SSLVerifyClient">SSLVerifyClient</a> <a name="sslverifyclient" id="sslverifyclient">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>客户证书验证类型</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLVerifyClient <em>级别</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLVerifyClient无</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>验证配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>此伪指令设置客户端身份验证的证书验证级别。注意，此伪指令可以在每个服务器和每个目录上下文中使用。在每服务器上下文中，它适用于建立连接时在标准SSL握手中使用的客户端身份验证过程。在按目录的上下文中，它将在读取HTTP请求之后但在发送HTTP响应之前，以重新配置的客户端验证级别强制进行SSL重新协商。</p>
<p>以下级别可用于<em>级别</em> ：</p>
<ul>
<li><strong>无</strong> ：完全不需要客户端证书</li>
<li><strong>可选</strong> ：客户<em>可以</em>出示有效的证书</li>
<li><strong>要求</strong> ：客户<em>必须</em>出示有效的证书</li>
<li><strong>optional_no_ca</strong> ：客户端可以出示有效的证书<br>但它不必（成功）可验证。不能使用此选项进行客户端身份验证。</li>
</ul>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLVerifyClient require</pre>
</div>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="SSLVerifyDepth" id="SSLVerifyDepth">SSLVerifyDepth</a> <a name="sslverifydepth" id="sslverifydepth">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>客户证书验证中CA证书的最大深度</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>SSLVerifyDepth <em>编号</em></code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>SSLVerifyDepth 1</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>验证配置</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_ssl</td></tr>
</table>
<p>该指令设置了mod_ssl在确定客户端没有有效证书之前应验证的深度。注意，此伪指令可以在每个服务器和每个目录上下文中使用。在每服务器上下文中，它适用于建立连接时在标准SSL握手中使用的客户端身份验证过程。在每个目录的上下文中，它会在读取HTTP请求之后但在发送HTTP响应之前，以重新配置的客户端验证深度强制进行SSL重新协商。</p>
<p>深度实际上是中间证书颁发者的最大数量，即在验证客户端证书时允许遵循的最大CA证书数量。深度为0表示仅接受自签名客户端证书，默认深度为1表示客户端证书可以是自签名的，或者必须由服务器直接知道的CA签名（即CA的证书为在<code class="directive"><a href="#sslcacertificatepath">SSLCACertificatePath</a></code>下），等等。</p>
<div class="example"><h3>例</h3><pre class="prettyprint lang-config">SSLVerifyDepth 10</pre>
</div>

</div>
</div>
<div id="footer">
<p class="apache">版权所有2018 The Apache Software Foundation。<br>根据<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache许可，版本2.0许可</a> 。</p>
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p></div><script type="text/javascript"><!--//--><![CDATA[//><!--
if (typeof(prettyPrint) !== 'undefined') {
    prettyPrint();
}
//--><!]]></script>
</body></html>