<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type">
<title>mod_expires-Apache HTTP服务器版本2.4</title>
<link href="../style/css/manual-zip.css" rel="stylesheet" type="text/css" title="Main stylesheet" media="all">
<link href="../style/css/manual-zip-100pc.css" rel="alternate stylesheet" type="text/css" title="No Sidebar - Default font size" media="all">
<link href="../style/css/manual-print.css" rel="stylesheet" type="text/css" media="print"><link rel="stylesheet" type="text/css" href="../style/css/prettify.css">
<script src="../style/scripts/prettify.min.js" type="text/javascript">
</script>
</head>
<body >
<div id="page-header">
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p>
<p class="apache">Apache HTTP服务器版本2.4</p>
<img alt="" src="../images/feather.png"></div>
<div class="up"><a href="./index.html"><img title="&lt;-" alt="&lt;-" src="../images/left.gif"></a></div>
<div id="path">
<a href="http://www.apache.org/">Apache</a> &gt; <a href="http://httpd.apache.org/">HTTP服务器</a> &gt; <a href="http://httpd.apache.org/docs/">文档</a> &gt; <a href="../index.html">版本2.4</a> &gt; <a href="./index.html">模块</a></div>
<div id="page-content">
<div id="preamble"><h1>Apache模块mod_expires</h1>

<table class="module"><tr><th><a href="module-dict.html#Description">描述：</a></th><td>根据用户指定的标准生成<code>Expires</code>和<code>Cache-Control</code> HTTP标头</td></tr>
<tr><th><a href="module-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="module-dict.html#ModuleIdentifier">模块�标识符：</a></th><td>expires_module</td></tr>
<tr><th><a href="module-dict.html#SourceFile">源文件：</a></th><td>mod_expires.c</td></tr></table>
<h3>摘要</h3>

    <p>此模块控制服务器响应中<code>Expires</code> HTTP标头的设置和<code>Cache-Control</code> HTTP标头的<code>max-age</code>指令。可以将到期日期设置为相对于上次修改源文件的时间，还是相对于客户端访问的时间。</p>

    <p>这些HTTP标头是对客户端的有关文档有效性和持久性的指令。如果已缓存，则可以从缓存中而不是从源中获取文档，直到该时间过去为止。之后，缓存副本被视为“过期”且无效，并且必须从源中获取新副本。</p>

    <p>要修改<code>max-age</code>以外的<code>Cache-Control</code>指令（请参阅<a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9">RFC 2616第14.9节</a> ），可以使用<code class="directive"><a href="../mod/mod_headers.html#header">Header</a></code>指令。</p>

    <p>当<code>Expires</code>标头已经是服务器生成的响应的一部分时，例如，当由CGI脚本生成或由原始服务器代理时，此模块不会更改或添加<code>Expires</code>或<code>Cache-Control</code>标头。</p>
</div>
<div id="quickview"><a href="https://www.apache.org/foundation/contributing.html" class="badge"><img src="https://www.apache.org/images/SupportApache-small.png" alt="支持Apache！"></a><h3>话题</h3>
<ul id="topics">
<li><img alt="" src="../images/down.gif"> <a href="#AltSyn">备用间隔语法</a></li>
</ul><h3 class="directives">指令</h3>
<ul id="toc">
<li><img alt="" src="../images/down.gif"> <a href="#expiresactive">有效期满</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#expiresbytype">ExpiresByType</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#expiresdefault">过期默认</a></li>
</ul>
<h3>错误修正清单</h3><ul class="seealso"><li><a href="https://www.apache.org/dist/httpd/CHANGES_2.4">httpd更新日志</a></li><li><a href="https://bz.apache.org/bugzilla/buglist.cgi?bug_status=__open__&amp;list_id=144532&amp;product=Apache httpd-2&amp;query_format=specific&amp;order=changeddate DESC%2Cpriority%2Cbug_severity&amp;component=mod_expires">已知的问题</a></li><li><a href="https://bz.apache.org/bugzilla/enter_bug.cgi?product=Apache httpd-2&amp;component=mod_expires">报告错误</a></li></ul></div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="AltSyn" id="AltSyn">备用间隔语法</a></h2>
    <p><code class="directive"><a href="#expiresdefault">ExpiresDefault</a></code>和<code class="directive"><a href="#expiresbytype">ExpiresByType</a></code>指令也可以采用以下形式的可读性更高的语法进行定义：</p>

    <pre class="prettyprint lang-config">ExpiresDefault "<var>base</var>  [plus <var>num</var> <var>type</var>] [<var>num</var> <var>type</var>] ..."
ExpiresByType type/encoding "<var>base</var>  [plus <var>num</var> <var>type</var>] [<var>num</var> <var>type</var>] ..."</pre>


    <p>其中<var>base</var>是以下之一：</p>

    <ul>
      <li><code>访问</code></li>

      <li><code>now</code> （相当于“ <code>access</code> ”）</li>

      <li><code>修改</code></li>
    </ul>

    <p><code>plus</code>关键字是可选的。 <var>num</var>应该是一个整数值[ <code>atoi()</code>可以接受，并且<var>type</var>是以下之一：</p>

    <ul>
      <li><code>年份</code></li>
      <li><code>月</code></li>
      <li><code>周</code></li>
      <li><code>天</code></li>
      <li><code>小时</code></li>
      <li><code>分钟</code></li>
      <li><code>秒</code></li>
    </ul>

    <p>例如，默认情况下，以下任何伪指令可用于使文档在访问后1个月后过期：</p>

    <pre class="prettyprint lang-config">ExpiresDefault "access plus 1 month"
ExpiresDefault "access plus 4 weeks"
ExpiresDefault "access plus 30 days"</pre>


    <p>可以通过添加几个“ <var>num</var> <var>type</var> ”子句来对到期时间进行微调：</p>

    <pre class="prettyprint lang-config">ExpiresByType text/html "access plus 1 month 15 days 2 hours"
ExpiresByType image/gif "modification plus 5 hours 3 minutes"</pre>


    <p>请注意，如果您使用基于修改日期的设置，则Expires标头<strong>不会</strong>添加到不是来自磁盘文件的内容中。这是由于没有针对此类内容的修改时间这一事实。</p>
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ExpiresActive" id="ExpiresActive">有效</a> <a name="expiresactive" id="expiresactive">指令</a> <a name="ExpiresActive" id="ExpiresActive">期满</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>启用<code>Expires</code>标头的生成</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>过期有效开|关</code></td></tr>
<tr><th><a href="directive-dict.html#Default">默认：</a></th><td><code>过期有效关闭</code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>指标</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_expires</td></tr>
</table>
    <p>此伪指令启用或禁用有关文档领域的<code>Expires</code>和<code>Cache-Control</code>标头的生成。（例如，如果在<code>.htaccess</code>文件中找到，则它仅适用于从该目录生成的文档。）如果设置为<code>Off</code> ，则不会为领域中的任何文档生成标头（除非在较低级别上被覆盖，例如<code>.htaccess</code>文件覆盖服务器配置文件）。如果设置为<code>On</code> ，则将根据<code class="directive"><a href="#expiresbytype">ExpiresByType</a></code>和<code class="directive"><a href="#expiresdefault">ExpiresDefault</a></code>指令（ <em>qv</em> ）定义的条件将标头添加到提供的文档中。</p>

    <p>请注意，此伪指令不能保证将生成<code>Expires</code>或<code>Cache-Control</code>标头。如果不符合条件，则不会发送任何标头，其效果就好像没有指定此指令一样。</p>
 
</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ExpiresByType" id="ExpiresByType">ExpiresByType</a> <a name="expiresbytype" id="expiresbytype">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>由MIME类型配置的<code>Expires</code>标头的值</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>ExpiresByType <var>MIME类型</var> <var>&lt;code&gt;秒</var></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>指标</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_expires</td></tr>
</table>
    <p>此伪指令定义为指定类型（ <em>例如</em> <code>text/html</code> ）的文档生成的<code>Expires</code>标头的值和<code>Cache-Control</code>标头的<code>max-age</code>伪指令。第二个参数设置将添加到基准时间以构造到期日期的秒数。<code>Cache-Control: max-age</code>是通过从到期日期中减去请求时间并以秒表示结果来计算的。</p>

    <p>基本时间可以是文件的最后修改时间，也可以是客户端访问文档的时间。应使用哪个由<code><var>&lt;code&gt;</var></code>字段指定； <code>M</code>表示应该将文件的最后修改时间用作基准时间，而<code>A</code>则应该使用客户端的访问时间。</p>

    <p>效果上的差别是微妙的。如果使用<code>M</code>则所有高速缓存中文档的所有当前副本将同时到期，这对于每周都在同一URL上找到的每周通知等很有用。如果使用<code>A</code> ，则每个客户的到期日期都不同；这对于不经常更改的图像文件可能是好的，特别是对于一组都引用相同图像的相关文档（ <em>即</em> ，将在相对较短的时间范围内重复访问图像）而言。</p>

    <div class="example"><h3>例：</h3><pre class="prettyprint lang-config"># enable expirations
ExpiresActive On
# expire GIF images after a month in the client's cache
ExpiresByType image/gif A2592000
# HTML documents are good for a week from the
# time they were changed
ExpiresByType text/html M604800</pre>
</div>

    <p>请注意，仅当指定<code>ExpiresActive On</code> ，此伪指令才有效。<em>仅</em>对于指定的MIME类型，它会覆盖<code class="directive"><a href="#expiresdefault">ExpiresDefault</a></code>指令设置的任何到期日期。</p>

    <p>您还可以使用本文档前面介绍的<a href="#AltSyn">备用语法</a>来指定到期时间计算。</p>

</div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="directive-section"><h2><a name="ExpiresDefault" id="ExpiresDefault">过期默认</a> <a name="expiresdefault" id="expiresdefault">指令</a></h2>
<table class="directive">
<tr><th><a href="directive-dict.html#Description">描述：</a></th><td>计算过期时间的默认算法</td></tr>
<tr><th><a href="directive-dict.html#Syntax">句法：</a></th><td><code>过期默认<var>&lt;code&gt;秒</var></code></td></tr>
<tr><th><a href="directive-dict.html#Context">内容：</a></th><td>服务器配置，虚拟主机，目录，.htaccess</td></tr>
<tr><th><a href="directive-dict.html#Override">覆写：</a></th><td>指标</td></tr>
<tr><th><a href="directive-dict.html#Status">状态：</a></th><td>延期</td></tr>
<tr><th><a href="directive-dict.html#Module">模块：</a></th><td>mod_expires</td></tr>
</table>
    <p>该指令设置默认算法，用于计算受影响领域中所有文档的到期时间。可以使用<code class="directive"><a href="#expiresbytype">ExpiresByType</a></code>伪指令<code class="directive"><a href="#expiresbytype">ExpiresByType</a></code>覆盖它。有关参数语法的详细信息以及<a href="#AltSyn">替代语法</a>描述，请参见该指令的描述。</p>

</div>
</div>
<div id="footer">
<p class="apache">版权所有2018 The Apache Software Foundation。<br>根据<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache许可，版本2.0许可</a> 。</p>
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p></div><script type="text/javascript"><!--//--><![CDATA[//><!--
if (typeof(prettyPrint) !== 'undefined') {
    prettyPrint();
}
//--><!]]></script>
</body></html>