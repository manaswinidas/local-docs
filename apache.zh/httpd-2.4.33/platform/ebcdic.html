<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type">
<title>Apache EBCDIC端口-Apache HTTP Server版本2.4</title>
<link href="../style/css/manual-zip.css" rel="stylesheet" type="text/css" title="Main stylesheet" media="all">
<link href="../style/css/manual-zip-100pc.css" rel="alternate stylesheet" type="text/css" title="No Sidebar - Default font size" media="all">
<link href="../style/css/manual-print.css" rel="stylesheet" type="text/css" media="print"><link rel="stylesheet" type="text/css" href="../style/css/prettify.css">
<script src="../style/scripts/prettify.min.js" type="text/javascript">
</script>
</head>
<body id="manual-page" ><div id="page-header">
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p>
<p class="apache">Apache HTTP服务器版本2.4</p>
<img alt="" src="../images/feather.png"></div>
<div class="up"><a href="./index.html"><img title="<-" alt="<-" src="../images/left.gif"></a></div>
<div id="path">
<a href="http://www.apache.org/">Apache</a> > <a href="http://httpd.apache.org/">HTTP Server</a> > <a href="http://httpd.apache.org/docs/">文档</a> > <a href="../index.html">版本2.4</a> > <a href="./index.html">平台特定说明</a></div><div id="page-content"><div id="preamble"><h1>Apache EBCDIC端口</h1>



    <div class="warning"><strong>警告：</strong>本文档尚未更新，未考虑到Apache HTTP Server 2.0版中所做的更改。一些信息可能仍然有用，但请谨慎使用。
    </div>

  </div>
<div id="quickview"><a href="https://www.apache.org/foundation/contributing.html" class="badge"><img src="https://www.apache.org/images/SupportApache-small.png" alt="支持Apache！"></a><ul id="toc"><li><img alt="" src="../images/down.gif"> <a href="#overview">Apache EBCDIC端口概述</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#design">设计目标</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#technical">技术方案</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#porting">移植说明</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#document">文件存放注意事项</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#modules">Apache模块的状态</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#third-party">第三方模块的状态</a></li>
</ul></div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="overview" id="overview">Apache EBCDIC端口概述</a></h2>

    

    <p>Apache HTTP Server的1.3版是第一个版本，其中包括（非ASCII）大型机机器的端口，该机器使用EBCDIC字符集作为其本机代码集。</p>

    <p>（这是运行<a href="http://www.siemens.de/servers/bs2osd/osdbc_us.htm">BS2000 / OSD操作系统</a>的SIEMENS大型机系列。如今，该大型机OS具有SVR4衍生的POSIX子系统。</p>

    <p>该端口最初是为了</p>

    <ul>
      <li>证明将<a href="http://httpd.apache.org/">Apache HTTP服务器</a>移植到该平台的可行性</li>

      <li>为古老的<a href="http://www.w3.org/Daemon/">CERN-3.0</a>守护程序（几年前移植）找到一个“有价值而有能力的”继承者，并</li>

      <li>证明Apache的预分叉过程模型可以在此平台上轻松胜过CERN所使用的接受-分叉服务模型5倍以上。</li>
    </ul>

    <p>本文档是描述本机端口的一些设计决策的依据。</p>

  </div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="design" id="design">设计目标</a></h2>

    

    <p>EBCDIC端口的一个目标是与（EBCDIC）CERN服务器保持足够的向后兼容性，从而使向新服务器的转换有吸引力且容易。这就需要添加一种可配置的方法来定义HTML文档是以ASCII（旧服务器接受的唯一格式）还是以EBCDIC（POSIX子系统中的本机文档格式）存储，因此是唯一的实际格式。其他POSIX工具，例如<code>grep</code>要么<code>sed</code>可以对文档进行操作）。当前的解决方案是由Apache服务器拦截并解释的“伪MIME格式”（请参阅下文）。将来的版本可能会通过为所有必须转换的文档定义一个“ ebcdic-handler”来解决该问题。</p>

  </div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="technical" id="technical">技术方案</a></h2>

    

    <p>由于所有Apache输入和输出均基于BUFF数据类型及其方法，因此最简单的解决方案是将转换添加到BUFF处理例程中。必须随时可以设置转换，因此添加了BUFF标志，该标志定义BUFF对象当前是否已启用转换。该标志在HTTP协议中的几个地方被修改：</p>

    <ul>
      <li>在接收到请求之前<strong>设置</strong> （因为请求和请求标头行始终为ASCII格式）</li>

      <li>收到请求正文时<strong>设置/取消设置</strong> -取决于请求正文的内容类型（因为请求正文可能包含ASCII文本或二进制文件）</li>

      <li>在发送回复标头之前<strong>设置</strong> （因为响应标头行始终为ASCII格式）</li>

      <li>发送响应正文时<strong>设置/取消设置</strong> -取决于响应正文的内容类型（因为响应正文可能包含文本或二进制文件）</li>
    </ul>

  </div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="porting" id="porting">移植说明</a></h2>

    

    <ol>
      <li>
        <p>来源中的相关更改是<code>#ifdef</code>分为两类：</p>

        <dl>
          <dt><code><strong>#ifdef CHARSET_EBCDIC</strong></code></dt>

          <dd>
            <p>任何基于EBCDIC的机器所需的代码。这包括字符翻译，两个字符集的连续性差异，标志，这些标志指示必须转换HTTP协议的哪个部分而不必转换哪个部分<em>等。</em></p>
          </dd>

          <dt><code><strong>#ifdef _OSD_POSIX</strong></code></dt>

          <dd>
            <p>仅SIEMENS BS2000 / OSD大型机平台所需的代码。这涉及仅在BS2000 / OSD平台上才需要的文件差异和套接字实现主题。</p>
          </dd>
        </dl>
      </li>

      <li>
        <p>故意<em>没有</em>选择在套接字级别（在BS2000 POSIX上，有一个支持该选项的套接字选项）在ASCII和EBCDIC之间进行转换的可能性，因为HTTP协议级别的字节流由协议相关的字符串和非-协议相关的原始文件数据。HTTP协议字符串始终以ASCII编码（ <code>GET</code>请求，任何标题：行，分块信息<em>等</em> ），而文件传输部分（ <em>即</em> GIF图像，CGI输出<em>等</em> ）通常应仅由服务器“通过”。服务器代码中的“协议字符串”和“原始数据”之间的这种分隔通过诸如<code>bgets()</code>要么<code>rvputs()</code>用于字符串，以及类似的函数<code>bwrite()</code>用于二进制数据。因此，对所有内容进行全球翻译是不够的。</p>

        <p>（当然，对于文本文件，必须做出规定，以便始终以ASCII形式提供EBCDIC文档）</p>
      </li>

      <li>
        <p>因此，此端口具有针对服务器内部字符串（编译器将其转换为EBCDIC字符串）以及所有服务器生成的文档的内置协议级别转换的功能。硬编码ASCII转义<code>\012</code>和<code>\015</code>在服务器代码中无处不在的是一个例外：它们已经是ASCII的二进制编码<code>\n</code>和<code>\r</code>并且不得再次转换为ASCII。此异常仅与服务器生成的字符串有关；和<em>外部</em> EBCDIC文档不应包含ASCII换行符。</p>
      </li>

      <li>
        <p>通过检查BUFF管理例程的调用层次结构，我添加了一个“ ebcdic / ascii转换层”，该转换层将在每个puts / write / get / gets上交叉使用，以及一个转换标志，该标志允许在启用/禁用转换的情况下进行转换。飞。通常，文档从其原始源（文件或CGI输出）到其目的地（发出请求的客户端）两次穿过该层： <code>file -> Apache</code>和<code>Apache -> client</code> 。</p>

        <p>现在，服务器可以读取EBCDIC格式的CGI脚本输出的标题行，然后发现脚本输出的其余部分为ASCII（类似于WWW Counter程序的输出：文档主体包含GIF图片）。所有标头处理均以本机EBCDIC格式完成；然后，服务器根据提供的文档类型确定文档主体（当然，分块信息除外）是否已经是ASCII格式，或者是否必须从EBCDIC转换而来。</p>
      </li>

      <li>
        <p>对于文本文档（MIME类型为text / plain，text / html <em>等</em> ），可以使用对ASCII的隐式转换，或者（如果用户更喜欢以原始ASCII格式存储某些文档以加快投放速度，或者因为文件位于无需转换即可提供NFS挂载的目录树）。</p>

        <p><strong>例：</strong></p>

        <p>提供带有后缀的文件<code>.ahtml</code>作为原始ASCII <code>text/html</code>没有隐式转换的文档（和后缀） <code>.ascii</code>作为ASCII <code>text/plain</code> ），请使用以下指令：</p>

        <div class="example"><p><code>AddType text/x-ascii-html .ahtml <br> AddType text/x-ascii-plain .ascii</code></p></div>

        <p>同样，任何<code>text/foo</code> MIME类型可以通过配置MIME类型“ <code>text/x-ascii-foo</code> ”使用<code>AddType</code> 。</p>
      </li>

      <li>
        <p>非文本文档始终以“二进制”形式提供，而不进行转换。对于，，这似乎是最明智的选择。 <em>例如</em> ，GIF / ZIP / AU文件类型。当然，这需要用户使用“ <code>rcp -b</code> ”二进制开关。</p>
      </li>

      <li>
        <p>服务器解析的文件始终假定为机器上使用的本机（ <em>即</em> EBCDIC）格式，并在处理后进行转换。</p>
      </li>

      <li>
        <p>对于CGI输出，CGI脚本确定是否需要转换：通过设置适当的Content-Type，可以转换文本文件，或者可以通过未修改的方式传递GIF输出。后一种情况的一个示例是我们也移植的wwwcount程序。</p>
      </li>

    </ol>

  </div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="document" id="document">文件存放注意事项</a></h2>

    

    <h3><a name="binary" id="binary">二进制文件</a></h3>

      

      <p>所有带有<code>Content-Type:</code>不以<code>text/</code>被服务器视为<em>二进制文件</em> ，并且不进行任何转换。二进制文件的示例是GIF图像，gzip压缩文件等。</p>

      <p>在大型机主机和Unix计算机或Windows PC之间交换二进制文件时，请确保使用ftp“ binary”（ <code>TYPE I</code> ）命令，或使用<code>rcp -b</code>来自大型机主机的命令（ <code>-b</code> Unix不支持该开关<code>rcp</code>的）。</p>

    

    <h3><a name="text" id="text">文字文件</a></h3>

      

      <p>服务器的默认假设是“文本文件”（ <em>即</em> ，其<code>Content-Type:</code>以。。开始<code>text/</code> ）存储在主机EBCDIC的本机字符集中。</p>

    

    <h3><a name="ssi" id="ssi">服务器端随附的文档</a></h3>

      

      <p>SSI文档当前必须仅存储在EBCDIC中。没有规定在处理之前将其从ASCII转换。</p>

    

  </div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="modules" id="modules">Apache模块的状态</a></h2>

    

    <table class="bordered">
      <tbody><tr>
        <th>模组</th>
        <th>状态</th>
        <th>笔记</th>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/core.html">core</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module">mod_access</code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_actions.html">mod_actions</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_alias.html">mod_alias</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_asis.html">mod_asis</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module">mod_auth</code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_authn_anon.html">mod_authn_anon</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_authn_dbm.html">mod_authn_dbm</a></code></td>
        <td class="centered">？</td>
        <td>与自己<code>libdb.a</code></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_authz_dbm.html">mod_authz_dbm</a></code></td>
        <td class="centered">？</td>
        <td>与自己<code>libdb.a</code></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_autoindex.html">mod_autoindex</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_cern_meta.html">mod_cern_meta</a></code></td>
        <td class="centered">？</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_cgi.html">mod_cgi</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code>mod_digest</code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_dir.html">mod_dir</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_so.html">mod_so</a></code></td>
        <td class="centered">--</td>
        <td>没有共享库</td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_env.html">mod_env</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_example.html">mod_example</a></code></td>
        <td class="centered">--</td>
        <td>（仅限测试床）</td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_expires.html">mod_expires</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_headers.html">mod_headers</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_imagemap.html">mod_imagemap</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_include.html">mod_include</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_info.html">mod_info</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code>mod_log_agent</code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code>mod_log_config</code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module">mod_log_referer</code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_mime.html">mod_mime</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_mime_magic.html">mod_mime_magic</a></code></td>
        <td class="centered">？</td>
        <td>尚未移植</td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_negotiation.html">mod_negotiation</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_proxy.html">mod_proxy</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_rewrite.html">mod_rewrite</a></code></td>
        <td class="centered">+</td>
        <td>未经测试</td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_setenvif.html">mod_setenvif</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_speling.html">mod_speling</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_status.html">mod_status</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_unique_id.html">mod_unique_id</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_userdir.html">mod_userdir</a></code></td>
        <td class="centered">+</td>
        <td></td>
      </tr>

      <tr>
        <td><code class="module"><a href="../mod/mod_usertrack.html">mod_usertrack</a></code></td>
        <td class="centered">？</td>
        <td>未经测试</td>
      </tr>
    </tbody></table>

  </div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="third-party" id="third-party">第三方模块的状态</a></h2>

    

    <table class="bordered">
      <tbody><tr>
        <th>模组</th>
        <th>状态</th>
        <th>笔记</th>
      </tr>

      <tr>
        <td><code><a href="https://tomcat.apache.org/connectors-doc-archive/jk2/">JK</a> (Formerly mod_jserv)</code></td>
        <td class="centered">--</td>
        <td>JAVA仍在移植。</td>
      </tr>

      <tr>
        <td><code><a href="http://www.php.net/">mod_php3</a></code></td>
        <td class="centered">+</td>
        <td><code>mod_php3</code>使用LDAP和GD以及FreeType库，运行良好。</td>
      </tr>

      <tr>
        <td><code><a href="http://hpwww.ec-lyon.fr/~vincent/apache/mod_put.html">mod_put</a></code></td>
        <td class="centered">？</td>
        <td>未经测试</td>
      </tr>

      <tr>
        <td><code><a href="ftp://hachiman.vidya.com/pub/apache/">mod_session</a></code></td>
        <td class="centered">--</td>
        <td>未经测试</td>
      </tr>
    </tbody></table>

  </div></div>
<div id="footer">
<p class="apache">版权所有2018 The Apache Software Foundation。<br>根据<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache许可，版本2.0许可</a> 。</p>
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p></div><script type="text/javascript"><!--//--><![CDATA[//><!--
if (typeof(prettyPrint) !== 'undefined') {
    prettyPrint();
}
//--><!]]></script>

</body></html>