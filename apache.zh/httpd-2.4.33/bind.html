<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type">
<title>绑定到地址和端口-Apache HTTP Server版本2.4</title>
<link href="./style/css/manual-zip.css" rel="stylesheet" type="text/css" title="Main stylesheet" media="all">
<link href="./style/css/manual-zip-100pc.css" rel="alternate stylesheet" type="text/css" title="No Sidebar - Default font size" media="all">
<link href="./style/css/manual-print.css" rel="stylesheet" type="text/css" media="print"><link rel="stylesheet" type="text/css" href="./style/css/prettify.css">
<script src="./style/scripts/prettify.min.js" type="text/javascript">
</script>
</head>
<body id="manual-page" ><div id="page-header">
<p class="menu"><a href="./mod/index.html">模块</a> | <a href="./mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="./glossary.html">词汇表</a> | <a href="./sitemap.html">网站地图</a></p>
<p class="apache">Apache HTTP服务器版本2.4</p>
<img alt="" src="./images/feather.png"></div>
<div class="up"><a href="./index.html"><img title="<-" alt="<-" src="./images/left.gif"></a></div>
<div id="path">
<a href="http://www.apache.org/">Apache</a> > <a href="http://httpd.apache.org/">HTTP Server</a> > <a href="http://httpd.apache.org/docs/">文档</a> > <a href="./index.html">版本2.4</a></div><div id="page-content"><div id="preamble"><h1>绑定到地址和端口</h1>


    <p>配置Apache HTTP Server以侦听特定的地址和端口。</p>
  </div>
<div id="quickview"><a href="https://www.apache.org/foundation/contributing.html" class="badge"><img src="https://www.apache.org/images/SupportApache-small.png" alt="支持Apache！"></a><ul id="toc"><li><img alt="" src="./images/down.gif"> <a href="#overview">总览</a></li>
<li><img alt="" src="./images/down.gif"> <a href="#ipv6">IPv6特殊注意事项</a></li>
<li><img alt="" src="./images/down.gif"> <a href="#protocol">使用监听指定协议</a></li>
<li><img alt="" src="./images/down.gif"> <a href="#virtualhost">这与虚拟主机如何配合使用</a></li>
</ul><h3>也可以看看</h3><ul class="seealso"><li><a href="vhosts/index.html">虚拟主机</a></li><li><a href="dns-caveats.html">DNS问题</a></li></ul></div>
<div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="overview" id="overview">总览</a></h2>
    

    <table class="related"><tbody><tr><th>相关模块</th><th>相关指令</th></tr><tr><td><ul><li><code class="module"><a href="./mod/core.html">core</a></code></li><li><code class="module"><a href="./mod/mpm_common.html">mpm_common</a></code></li></ul></td><td><ul><li><code class="directive"><a href="./mod/core.html#virtualhost"><VirtualHost></a></code></li><li><code class="directive"><a href="./mod/mpm_common.html#listen">Listen</a></code></li></ul></td></tr></tbody></table>


    <p>当httpd启动时，它将绑定到本地计算机上的某些端口和地址，并等待传入的请求。默认情况下，它侦听计算机上的所有地址。但是，可能需要告知它侦听特定端口，或仅侦听选定的地址，或者同时侦听两者。这通常与<a href="vhosts/index.html">虚拟主机</a>功能结合使用，该功能决定了如何<code>httpd</code>响应不同的IP地址，主机名和端口。</p>

    <p>的<code class="directive"><a href="./mod/mpm_common.html#listen">Listen</a></code>指令告诉服务器仅在指定的端口或地址和端口组合上接受传入的请求。如果仅在端口号中指定<code class="directive"><a href="./mod/mpm_common.html#listen">Listen</a></code>指令，服务器在所有接口上侦听给定的端口。如果提供了IP地址和端口，则服务器将侦听给定的端口和接口。多<code class="directive"><a href="./mod/mpm_common.html#listen">Listen</a></code>指令可用于指定要侦听的地址和端口的数量。服务器将响应来自任何列出的地址和端口的请求。</p>

    <p>例如，要使服务器在所有接口上都接受端口80和8000上的连接，请使用：</p>

    <div class="example"><pre class="prettyprint lang-config">Listen 80
Listen 8000</pre>
</div>

    <p>要使服务器在一个接口上接受端口80上的连接，而在另一个接口上接受端口8000上的连接，请使用</p>

    <div class="example"><pre class="prettyprint lang-config">Listen 192.0.2.1:80
Listen 192.0.2.5:8000</pre>
</div>

    <p>IPv6地址必须括在方括号中，如以下示例所示：</p>

    <div class="example"><pre class="prettyprint lang-config">Listen [2001:db8::a00:20ff:fea7:ccea]:80</pre>
</div>

    <div class="warning"><p>重叠<code class="directive"><a href="./mod/mpm_common.html#listen">Listen</a></code>指令将导致致命错误，这将阻止服务器启动。</p>

    <div class="example"><p><code>(48)Address already in use: make_sock: could not bind to address [::]:80</code></p></div>

    <p>有关更多故障排除提示，请参见<a href="http://wiki.apache.org/httpd/CouldNotBindToAddress">Wiki中的讨论</a> 。</p>

</div>

  </div><div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="ipv6" id="ipv6">IPv6特殊注意事项</a></h2>
    

    <p>越来越多的平台实现IPv6， <a class="glossarylink" href="./glossary.html#apr" title="见词汇">APR</a>在其中大多数平台上都支持IPv6，从而允许httpd分配IPv6套接字，并处理通过IPv6发送的请求。</p>

    <p>对于httpd管理员来说，一个复杂的因素是IPv6套接字能否同时处理IPv4连接和IPv6连接。使用IPv6套接字处理IPv4连接时，会使用IPv4映射的IPv6地址，大多数平台默认情况下允许使用，但FreeBSD，NetBSD和OpenBSD默认情况下不允许使用这些地址，以匹配这些平台上的系统级策略。在默认情况下不允许使用的系统上， <code class="program"><a href="./programs/configure.html">configure</a></code>参数可以更改httpd的此行为。</p>

    <p>另一方面，在某些平台（例如Linux和Tru64）上，处理IPv6和IPv4的<strong>唯一</strong>方法是使用映射地址。如果你想<code>httpd</code>要使用最少的套接字处理IPv4和IPv6连接（这要求使用IPv4映射的IPv6地址），请指定<code>--enable-v4-mapped</code><code class="program"><a href="./programs/configure.html">configure</a></code>选项。</p>

    <p><code>--enable-v4-mapped</code>是FreeBSD，NetBSD和OpenBSD之外所有平台上的默认设置，因此这可能是httpd的构建方式。</p>

    <p>如果您希望httpd仅处理IPv4连接，无论您的平台和APR将支持什么，请在所有<code class="directive"><a href="./mod/mpm_common.html#listen">Listen</a></code>指令，如以下示例所示：</p>

    <div class="example"><pre class="prettyprint lang-config">Listen 0.0.0.0:80
Listen 192.0.2.1:80</pre>
</div>

    <p>如果您的平台支持它，并且您希望httpd在单独的套接字上处理IPv4和IPv6连接（即，禁用IPv4映射的地址），请指定<code>--disable-v4-mapped</code><code class="program"><a href="./programs/configure.html">configure</a></code>选项。 <code>--disable-v4-mapped</code>是FreeBSD，NetBSD和OpenBSD的默认设置。</p>
  </div><div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="protocol" id="protocol">使用监听指定协议</a></h2>
    
    <p>可选秒<var>protocol</var>的论点<code class="directive"><a href="./mod/mpm_common.html#listen">Listen</a></code>大多数配置不是必需的。如果未指定， <code>https</code>是端口443的默认值， <code>http</code>所有其他端口的默认值。该协议用于确定哪个模块应处理请求，并通过<code class="directive"><a href="./mod/core.html#acceptfilter">AcceptFilter</a></code>指示。</p>

    <p>仅在非标准端口上运行时，才需要设置协议。例如，运行<code>https</code>在端口8443上的站点：</p>

    <div class="example"><pre class="prettyprint lang-config">Listen 192.170.2.1:8443 https</pre>
</div>
  </div><div class="top"><a href="#page-header"><img alt="最佳" src="./images/up.gif"></a></div>
<div class="section">
<h2><a name="virtualhost" id="virtualhost">这与虚拟主机如何配合使用</a></h2>
    

    <p>的<code class="directive"><a href="./mod/mpm_common.html#listen">Listen</a></code>指令不实现虚拟主机-它仅告诉主服务器要侦听的地址和端口。如果不<code class="directive"><a href="./mod/core.html#virtualhost"><VirtualHost></a></code>使用伪指令，对于所有接受的请求，服务器的行为将相同。然而， <code class="directive"><a href="./mod/core.html#virtualhost"><VirtualHost></a></code>可用于为一个或多个地址或端口指定不同的行为。要实现VirtualHost，必须首先告知服务器监听要使用的地址和端口。然后一个<code class="directive"><a href="./mod/core.html#virtualhost"><VirtualHost></a></code>应该为指定的地址和端口创建一个区域，以设置此虚拟主机的行为。请注意，如果<code class="directive"><a href="./mod/core.html#virtualhost"><VirtualHost></a></code>为服务器未监听的地址和端口设置的，无法访问。</p>
  </div></div>
<div id="footer">
<p class="apache">版权所有2018 The Apache Software Foundation。<br>根据<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache许可，版本2.0许可</a> 。</p>
<p class="menu"><a href="./mod/index.html">模块</a> | <a href="./mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="./glossary.html">词汇表</a> | <a href="./sitemap.html">网站地图</a></p></div><script type="text/javascript"><!--//--><![CDATA[//><!--
if (typeof(prettyPrint) !== 'undefined') {
    prettyPrint();
}
//--><!]]></script>

</body></html>