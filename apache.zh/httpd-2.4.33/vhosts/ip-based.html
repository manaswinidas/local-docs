<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type">
<title>基于Apache IP的虚拟主机支持-Apache HTTP Server版本2.4</title>
<link href="../style/css/manual-zip.css" rel="stylesheet" type="text/css" title="Main stylesheet" media="all">
<link href="../style/css/manual-zip-100pc.css" rel="alternate stylesheet" type="text/css" title="No Sidebar - Default font size" media="all">
<link href="../style/css/manual-print.css" rel="stylesheet" type="text/css" media="print"><link rel="stylesheet" type="text/css" href="../style/css/prettify.css">
<script src="../style/scripts/prettify.min.js" type="text/javascript">
</script>
</head>
<body id="manual-page" ><div id="page-header">
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p>
<p class="apache">Apache HTTP服务器版本2.4</p>
<img alt="" src="../images/feather.png"></div>
<div class="up"><a href="./index.html"><img title="<-" alt="<-" src="../images/left.gif"></a></div>
<div id="path">
<a href="http://www.apache.org/">Apache</a> > <a href="http://httpd.apache.org/">HTTP服务器</a> > <a href="http://httpd.apache.org/docs/">文档</a> > <a href="../index.html">版本2.4</a> > <a href="./index.html">虚拟主机</a></div><div id="page-content"><div id="preamble"><h1>基于Apache IP的虚拟主机支持</h1>

</div>
<div id="quickview"><a href="https://www.apache.org/foundation/contributing.html" class="badge"><img src="https://www.apache.org/images/SupportApache-small.png" alt="支持Apache！"></a><ul id="toc"><li><img alt="" src="../images/down.gif"> <a href="#explanation">什么是基于IP的虚拟主机</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#requirements">系统要求</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#howto">如何设置Apache</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#multiple">设置多个守护程序</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#single">使用虚拟主机设置单个守护程序</a></li>
</ul><h3>也可以看看</h3><ul class="seealso"><li>
<a href="name-based.html">基于名称的虚拟主机支持</a>
</li></ul></div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="explanation" id="explanation">什么是基于IP的虚拟主机</a></h2>
<p>基于IP的虚拟主机是一种基于接收请求的IP地址和端口来应用不同指令的方法。最常见的是，它用于在不同端口或接口上为不同的网站提供服务。</p>

<p>在许多情况下， <a href="name-based.html">基于名称的虚拟主机</a>更为方便，因为它们允许许多虚拟主机共享一个地址/端口。请参阅<a href="name-based.html#namevip">基于名称的虚拟主机和基于IP的虚拟主机，</a>以帮助您做出决定。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="requirements" id="requirements">系统要求</a></h2>

    <p>如术语“ <cite>基于IP的”</cite>所示， <strong>对于每个基于IP的虚拟主机</strong> ，服务器<strong>必须具有不同的IP地址/端口组合</strong> 。这可以通过具有多个物理网络连接的计算机或使用大多数现代操作系统支持的虚拟接口来实现（有关详细信息，请参见系统文档，这些通常称为“ ip别名”，而“ ifconfig”命令为（最常用于设置它们）和/或使用多个端口号。</p>

    <p>在Apache HTTP Server的术语中，使用单个IP地址但使用多个TCP端口的也是基于IP的虚拟主机。</p>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="howto" id="howto">如何设置Apache</a></h2>

    <p>有两种方法来配置apache以支持多个主机。通过单独运行<code class="program"><a href="../programs/httpd.html">httpd</a></code>每个主机名的守护程序，或通过运行支持所有虚拟主机的单个守护程序。</p>

    <p>在以下情况下使用多个守护程序：</p>

    <ul>
      <li>存在安全分区问题，例如company1不希望company2中的任何人都可以通过网络读取其数据。在这种情况下，您将需要两个守护程序，每个守护程序以不同的方式运行<code class="directive"><a href="../mod/mod_unixd.html#user">User</a></code> ， <code class="directive"><a href="../mod/mod_unixd.html#group">Group</a></code> ， <code class="directive"><a href="../mod/mpm_common.html#listen">Listen</a></code>和<code class="directive"><a href="../mod/core.html#serverroot">ServerRoot</a></code>设置。</li>

      <li>您可以承受侦听计算机上每个IP别名的内存和文件描述符要求。只能<code class="directive"><a href="../mod/mpm_common.html#listen">Listen</a></code>到“通配符”地址或特定地址。因此，如果出于任何原因需要监听特定的地址，那么您将需要监听所有的特定地址。（虽然一个<code class="program"><a href="../programs/httpd.html">httpd</a></code>可以监听N-1个地址，另一个可以监听剩余的地址。）</li>
    </ul>

    <p>在以下情况下使用单个守护程序：</p>

    <ul>
      <li>可以在虚拟主机之间共享httpd配置。</li>

      <li>该机器处理大量请求，因此运行单独的守护程序时的性能损失可能会很大。</li>
    </ul>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="multiple" id="multiple">设置多个守护程序</a></h2>

    <p>创建一个单独的<code class="program"><a href="../programs/httpd.html">httpd</a></code>每个虚拟主机的安装。对于每次安装，请使用<code class="directive"><a href="../mod/mpm_common.html#listen">Listen</a></code>配置文件中的指令以选择守护程序服务的IP地址（或虚拟主机）。例如</p>

    <pre class="prettyprint lang-config">Listen 192.0.2.100:80</pre>


    <p>建议您使用IP地址而不是主机名（请参阅<a href="../dns-caveats.html">DNS警告</a> ）。</p>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="single" id="single">使用虚拟主机设置单个守护程序</a></h2>

    <p>在这种情况下， <code class="program"><a href="../programs/httpd.html">httpd</a></code>将服务于对主服务器和所有虚拟主机的请求。的<code class="directive"><a href="../mod/core.html#virtualhost">VirtualHost</a></code>配置文件中的伪指令用于设置<code class="directive"><a href="../mod/core.html#serveradmin">ServerAdmin</a></code> ， <code class="directive"><a href="../mod/core.html#servername">ServerName</a></code> ， <code class="directive"><a href="../mod/core.html#documentroot">DocumentRoot</a></code> ， <code class="directive"><a href="../mod/core.html#errorlog">ErrorLog</a></code>和<code class="directive"><a href="../mod/mod_log_config.html#transferlog">TransferLog</a></code>要么<code class="directive"><a href="../mod/mod_log_config.html#customlog">CustomLog</a></code>每个虚拟主机的配置指令具有不同的值。例如</p>

    <pre class="prettyprint lang-config">&lt;VirtualHost 172.20.30.40:80&gt;
    ServerAdmin webmaster@www1.example.com
    DocumentRoot "/www/vhosts/www1"
    ServerName www1.example.com
    ErrorLog "/www/logs/www1/error_log"
    CustomLog "/www/logs/www1/access_log" combined
&lt;/VirtualHost&gt;

&lt;VirtualHost 172.20.30.50:80&gt;
    ServerAdmin webmaster@www2.example.org
    DocumentRoot "/www/vhosts/www2"
    ServerName www2.example.org
    ErrorLog "/www/logs/www2/error_log"
    CustomLog "/www/logs/www2/access_log" combined
&lt;/VirtualHost&gt;</pre>


    <p>建议在<virtualhost>指令中</virtualhost>使用IP地址代替主机名<virtualhost>（请参阅<a href="../dns-caveats.html">DNS警告</a> ）。</virtualhost></p>

    <p>特定的IP地址或端口优先于其通配符等效项，并且匹配的任何虚拟主机均优先于服务器基础配置。</p>

    <p>除了控制进程创建的指令和其他一些指令外，几乎<strong>所有</strong>配置指令都可以放入VirtualHost指令中。要了解是否可以在VirtualHost指令中使用指令，请使用<a href="../mod/quickreference.html">指令index</a>检查<a href="../mod/directive-dict.html#Context">上下文</a> 。</p>

    <p><code class="directive"><a href="../mod/mod_suexec.html#suexecusergroup">SuexecUserGroup</a></code>如果使用<a href="../suexec.html">suEXEC包装器，</a>则可以在VirtualHost指令内使用。</p>

    <p><em>安全性：</em>在指定将日志文件写入何处时，请注意如果启动Apache的用户以外的任何人都具有对其写入目录的写访问权，则存在某些安全风险。有关详细信息，请参阅<a href="../misc/security_tips.html">安全提示</a>文档。</p>

</div></div>
<div id="footer">
<p class="apache">版权所有2018 The Apache Software Foundation。<br>根据<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache许可，版本2.0许可</a> 。</p>
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p></div><script type="text/javascript"><!--//--><![CDATA[//><!--
if (typeof(prettyPrint) !== 'undefined') {
    prettyPrint();
}
//--><!]]></script>

</body></html>