<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type">
<title>rotationlogs-管道记录程序以旋转Apache日志-Apache HTTP Server版本2.4</title>
<link href="../style/css/manual-zip.css" rel="stylesheet" type="text/css" title="Main stylesheet" media="all">
<link href="../style/css/manual-zip-100pc.css" rel="alternate stylesheet" type="text/css" title="No Sidebar - Default font size" media="all">
<link href="../style/css/manual-print.css" rel="stylesheet" type="text/css" media="print"><link rel="stylesheet" type="text/css" href="../style/css/prettify.css">
<script src="../style/scripts/prettify.min.js" type="text/javascript">
</script>
</head>
<body id="manual-page" ><div id="page-header">
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p>
<p class="apache">Apache HTTP服务器版本2.4</p>
<img alt="" src="../images/feather.png"></div>
<div class="up"><a href="./index.html"><img title="<-" alt="<-" src="../images/left.gif"></a></div>
<div id="path">
<a href="http://www.apache.org/">Apache</a> > <a href="http://httpd.apache.org/">HTTP服务器</a> > <a href="http://httpd.apache.org/docs/">文档</a> > <a href="../index.html">版本2.4</a> > <a href="./index.html">程序</a></div><div id="page-content"><div id="preamble"><h1>rotationlogs-管道记录程序以旋转Apache日志</h1>


     <p><code>rotatelogs</code>是与Apache的管道日志文件功能结合使用的简单程序。它支持基于时间间隔或日志的最大大小的轮换。</p>
</div>
<div id="quickview"><a href="https://www.apache.org/foundation/contributing.html" class="badge"><img src="https://www.apache.org/images/SupportApache-small.png" alt="支持Apache！"></a><ul id="toc"><li><img alt="" src="../images/down.gif"> <a href="#synopsis">概要</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#options">选件</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#examples">例子</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#portability">可移植性</a></li>
</ul></div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="synopsis" id="synopsis">概要</a></h2>

     <p><code><strong>rotatelogs</strong> [ -<strong>l</strong> ] [ -<strong>L</strong> <var>linkname</var> ] [ -<strong>p</strong> <var>program</var> ] [ -<strong>f</strong> ] [ -<strong>t</strong> ] [ -<strong>v</strong> ] [ -<strong>e</strong> ] [ -<strong>c</strong> ] [ -<strong>n</strong> <var>number-of-files</var> ] <var>logfile</var> <var>rotationtime</var>|<var>filesize</var>(B|K|M|G) [ <var>offset</var> ]</code></p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="options" id="options">选件</a></h2>

<dl>

<dt><code>-l</code></dt>
<dd>导致使用当地时间而不是GMT作为间隔或<code>strftime(3)</code>使用基于尺寸的旋转进行格式化。</dd>

<dt><code>-L</code> <var>linkname</var></dt>
<dd>导致从当前日志文件到指定链接名称的硬链接。可以使用类似的命令来连续观察旋转日志<code>tail -F linkname</code> 。</dd>

<dt><code>-p</code> <var>program</var></dt>

<dd>如果有的话<code>rotatelogs</code>每次打开新的日志文件时，都会执行指定的程序。新打开文件的文件名作为第一个参数传递给程序。如果在轮换之后执行，则旧日志文件将作为第二个参数传递。 <code>rotatelogs</code>在继续操作之前不会等待指定的程序终止，并且不会记录终止时返回的任何错误代码。生成的程序使用与rotatelogs相同的stdin，stdout和stderr，并且还继承了环境。</dd>

<dt><code>-f</code></dt>
<dd>导致立即打开日志文件<code>rotatelogs</code>启动，而不是等待读取第一个日志文件条目（对于非繁忙站点，在启动服务器和处理第一个请求之间可能会有相当长的延迟，这意味着关联的日志文件不“存在”在此之前，这会导致某些自动日志记录工具出现问题）</dd>

<dt><code>-t</code></dt>
<dd>导致日志文件被截断而不是被旋转。当通过tail之类的命令实时处理日志并且不需要归档数据时，这很有用。没有在文件名中添加后缀，但是将使用包含'％'字符的格式字符串。
</dd>

<dt><code>-v</code></dt>
<dd>在STDERR上产生详细的输出。输出包含配置解析的结果以及所有文件打开和关闭操作。</dd>

<dt><code>-e</code></dt>
<dd>回声登录到标准输出。当需要通过链中的其他工具实时进一步处理日志时，此功能很有用。</dd>

<dt><code>-c</code></dt>
<dd>为每个间隔创建日志文件（即使为空）。</dd>

<dt><code>-n <var>number-of-files</var></code></dt>
<dd>使用没有时间戳记的文件名的循环列表。使用-n 3，打开的一系列日志文件将是“ logfile”，“ logfile.1”，“ logfile.2”，然后覆盖“ logfile”。在2.4.5及更高版本中可用。</dd>

<dt><code><var>logfile</var></code></dt>

<dd><p>日志文件的路径和基本名称。如果<var>logfile</var>包含任何'％'字符，将被视为以下格式的字符串<code>strftime(3)</code> 。否则，后缀<var>.nnnnnnnnnn</var>是自动添加的，并且是时间（以秒为单位）（除非使用-t选项）。两种格式都从当前周期的开始计算开始时间。例如，如果指定的旋转时间为86400，则从<code>strftime(3)</code>格式将全部为零，这是指当前24小时周期的开始（午夜）。</p>
<p>使用时<code>strftime(3)</code>文件名格式，请确保日志文件格式具有足够的粒度，以便每次旋转日志时产生不同的文件名。否则，轮换将覆盖同一文件，而不是启动一个新文件。例如，如果<var>logfile</var>原为<code>/var/log/errorlog.%Y-%m-%d</code>如果日志旋转为5兆字节，但同一天达到两次5兆字节，则将产生相同的日志文件名，并且日志旋转将继续写入同一文件。</p>
</dd>

<dt><code><var>rotationtime</var></code></dt>

<dd>日志文件轮换之间的时间（以秒为单位）。旋转发生在此间隔的开始。例如，如果轮换时间为3600，则日志文件将在每小时开始时轮换；如果轮换时间为86400，则日志文件将在每晚的午夜旋转。（如果在间隔时间内未记录任何数据，则不会创建任何文件。）</dd>

<dt><code><var>filesize</var>(B|K|M|G)</code></dt>

<dd>最大文件大小，后面紧跟一个字母<code>B</code> （字节）， <code>K</code> （KB）， <code>M</code> （兆字节）或<code>G</code> （GB）。
<p>指定时间和大小后，必须在时间之后给出大小。只要达到时间或大小限制，旋转就会发生。
</p>
</dd>

<dt><code><var>offset</var></code></dt>

<dd>从UTC偏移的分钟数。如果省略，则假定为零，并使用UTC。例如，要使用UTC -5小时区域中的本地时间，请指定值为<code>-300</code>对于这个论点。绝大多数情况下， <code>-l</code>应该使用而不是指定偏移量。</dd>

</dl>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="examples" id="examples">例子</a></h2>

<div class="example"><p><code>CustomLog "|bin/rotatelogs /var/log/logfile 86400" common</code></p></div>

     <p>这将创建文件/var/log/logfile.nnnn，其中nnnn是日志名义上开始的系统时间（该时间始终是轮换时间的倍数，因此您可以与其同步cron脚本）。在每个轮换时间结束时（此处为24小时之后），将启动一个新日志。</p>

<div class="example"><p><code>CustomLog "|bin/rotatelogs -l /var/log/logfile.%Y.%m.%d 86400" common</code></p></div>

     <p>这将创建文件/var/log/logfile.yyyy.mm.dd，其中yyyy是年，mm是月，dd是月中的日。日志将在每天本地时间午夜切换到新文件。</p>

<div class="example"><p><code>CustomLog "|bin/rotatelogs /var/log/logfile 5M" common</code></p></div>

     <p>每当日志文件大小达到5 MB时，此配置都会对其进行轮换。</p>

<div class="example"><p><code>ErrorLog "|bin/rotatelogs /var/log/errorlog.%Y-%m-%d-%H_%M_%S 5M"</code></p></div>
     <p>每当错误日志文件的大小达到5 MB时，此配置都会对其进行轮换，并且日志文件名的后缀将以以下格式创建<code>errorlog.YYYY-mm-dd-HH_MM_SS</code> 。</p>

<div class="example"><p><code>CustomLog "|bin/rotatelogs -t /var/log/logfile 86400" common</code></p></div>

     <p>这将创建文件/ var / log / logfile，在启动时将其截断，然后每天将其截断一次。在这种情况下，预计将有一个单独的进程（例如tail）将实时处理文件。</p>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="portability" id="portability">可移植性</a></h2>

<p>所有人都应支持以下日志文件格式的字符串替换<code>strftime(3)</code>实现，请参见<code>strftime(3)</code>特定于库的扩展的手册页。</p>

<table class="bordered"><tbody><tr><td><code>%A</code></td><td>工作日全名（本地化）</td></tr>
<tr class="odd"><td><code>%a</code></td><td>3个字符的工作日名称（本地化）</td></tr>
<tr><td><code>%B</code></td><td>完整的月份名称（本地化）</td></tr>
<tr class="odd"><td><code>%b</code></td><td>3个字符的月份名称（本地化）</td></tr>
<tr><td><code>%c</code></td><td>日期和时间（本地化）</td></tr>
<tr class="odd"><td><code>%d</code></td><td>每月2位数的日期</td></tr>
<tr><td><code>%H</code></td><td>2位小时（24小时制）</td></tr>
<tr class="odd"><td><code>%I</code></td><td>2位小时（12小时制）</td></tr>
<tr><td><code>%j</code></td><td>一年中的三位数</td></tr>
<tr class="odd"><td><code>%M</code></td><td>2位数分钟</td></tr>
<tr><td><code>%m</code></td><td>2位数的月份</td></tr>
<tr class="odd"><td><code>%p</code></td><td>12小时制的上午/下午（本地化）</td></tr>
<tr><td><code>%S</code></td><td>2位数秒</td></tr>
<tr class="odd"><td><code>%U</code></td><td>一年中的两位数（星期几的第一天）</td></tr>
<tr><td><code>%W</code></td><td>每年2位数的星期（星期一的第一天）</td></tr>
<tr class="odd"><td><code>%w</code></td><td>1位数字的工作日（星期日的第一天）</td></tr>
<tr><td><code>%X</code></td><td>时间（本地化）</td></tr>
<tr class="odd"><td><code>%x</code></td><td>日期（本地化）</td></tr>
<tr><td><code>%Y</code></td><td>4位数的年份</td></tr>
<tr class="odd"><td><code>%y</code></td><td>2位数的年份</td></tr>
<tr><td><code>%Z</code></td><td>时区名称</td></tr>
<tr class="odd"><td><code>%%</code></td><td>文字“％”</td></tr>
</tbody></table>

</div></div>
<div id="footer">
<p class="apache">版权所有2018 The Apache Software Foundation。<br>根据<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache许可，版本2.0许可</a> 。</p>
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p></div><script type="text/javascript"><!--//--><![CDATA[//><!--
if (typeof(prettyPrint) !== 'undefined') {
    prettyPrint();
}
//--><!]]></script>

</body></html>