<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type">
<title>身份验证和授权-Apache HTTP Server版本2.4</title>
<link href="../style/css/manual-zip.css" rel="stylesheet" type="text/css" title="Main stylesheet" media="all">
<link href="../style/css/manual-zip-100pc.css" rel="alternate stylesheet" type="text/css" title="No Sidebar - Default font size" media="all">
<link href="../style/css/manual-print.css" rel="stylesheet" type="text/css" media="print"><link rel="stylesheet" type="text/css" href="../style/css/prettify.css">
<script src="../style/scripts/prettify.min.js" type="text/javascript">
</script>
</head>
<body id="manual-page" ><div id="page-header">
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p>
<p class="apache">Apache HTTP服务器版本2.4</p>
<img alt="" src="../images/feather.png"></div>
<div class="up"><a href="./index.html"><img title="<-" alt="<-" src="../images/left.gif"></a></div>
<div id="path">
<a href="http://www.apache.org/">Apache</a> > <a href="http://httpd.apache.org/">HTTP服务器</a> > <a href="http://httpd.apache.org/docs/">文档</a> > <a href="../index.html">版本2.4</a> >操作方法<a href="./index.html">/教程</a></div><div id="page-content"><div id="preamble"><h1>认证与授权</h1>


    <p>身份验证是您用来验证某人是否是他们所声称的身份的任何过程。授权是允许某人进入其想去的地方或获得其想要的信息的任何过程。</p>

    <p>有关常规访问控制，请参阅<a href="access.html">访问控制方法</a> 。</p>
</div>
<div id="quickview"><a href="https://www.apache.org/foundation/contributing.html" class="badge"><img src="https://www.apache.org/images/SupportApache-small.png" alt="支持Apache！"></a><ul id="toc"><li><img alt="" src="../images/down.gif"> <a href="#related">相关模块和指令</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#introduction">介绍</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#theprerequisites">先决条件</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#gettingitworking">使它工作</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#lettingmorethanonepersonin">让一个以上的人进入</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#possibleproblems">可能的问题</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#dbmdbd">备用密码存储</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#multprovider">使用多个提供商</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#beyond">超越授权</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#socache">身份验证缓存</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#moreinformation">更多信息</a></li>
</ul></div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="related" id="related">相关模块和指令</a></h2>

<p>身份验证和授权过程涉及三种类型的模块。通常，您需要从每个组中至少选择一个模块。</p>

<ul>
  <li>身份验证类型（请参阅<code class="directive"><a href="../mod/mod_authn_core.html#authtype">AuthType</a></code>指示）<ul>
      <li><code class="module"><a href="../mod/mod_auth_basic.html">mod_auth_basic</a></code></li>
      <li><code class="module"><a href="../mod/mod_auth_digest.html">mod_auth_digest</a></code></li>
    </ul>
  </li>
  <li>身份验证提供程序（请参阅<code class="directive"><a href="../mod/mod_auth_basic.html#authbasicprovider">AuthBasicProvider</a></code>和<code class="directive"><a href="../mod/mod_auth_digest.html#authdigestprovider">AuthDigestProvider</a></code>指令）<ul>
      <li><code class="module"><a href="../mod/mod_authn_anon.html">mod_authn_anon</a></code></li>
      <li><code class="module"><a href="../mod/mod_authn_dbd.html">mod_authn_dbd</a></code></li>
      <li><code class="module"><a href="../mod/mod_authn_dbm.html">mod_authn_dbm</a></code></li>
      <li><code class="module"><a href="../mod/mod_authn_file.html">mod_authn_file</a></code></li>
      <li><code class="module"><a href="../mod/mod_authnz_ldap.html">mod_authnz_ldap</a></code></li>
      <li><code class="module"><a href="../mod/mod_authn_socache.html">mod_authn_socache</a></code></li>
    </ul>
  </li>
  <li>授权（请参阅<code class="directive"><a href="../mod/mod_authz_core.html#require">Require</a></code>指示）<ul>
      <li><code class="module"><a href="../mod/mod_authnz_ldap.html">mod_authnz_ldap</a></code></li>
      <li><code class="module"><a href="../mod/mod_authz_dbd.html">mod_authz_dbd</a></code></li>
      <li><code class="module"><a href="../mod/mod_authz_dbm.html">mod_authz_dbm</a></code></li>
      <li><code class="module"><a href="../mod/mod_authz_groupfile.html">mod_authz_groupfile</a></code></li>
      <li><code class="module"><a href="../mod/mod_authz_host.html">mod_authz_host</a></code></li>
      <li><code class="module"><a href="../mod/mod_authz_owner.html">mod_authz_owner</a></code></li>
      <li><code class="module"><a href="../mod/mod_authz_user.html">mod_authz_user</a></code></li>
    </ul>
  </li>
</ul>

  <p>除了这些模块之外，还有<code class="module"><a href="../mod/mod_authn_core.html">mod_authn_core</a></code>和<code class="module"><a href="../mod/mod_authz_core.html">mod_authz_core</a></code> 。这些模块实现核心指令，这些指令是所有auth模块的核心。</p>

  <p>模块<code class="module"><a href="../mod/mod_authnz_ldap.html">mod_authnz_ldap</a></code>是身份验证和授权提供者。模块<code class="module"><a href="../mod/mod_authz_host.html">mod_authz_host</a></code>提供基于主机名，IP地址或请求特征的授权和访问控制，但不属于身份验证提供程序系统。为了与mod_access向后兼容，有一个新模块<code class="module"><a href="../mod/mod_access_compat.html">mod_access_compat</a></code> 。</p>

  <p>您可能还想看看<a href="access.html">访问控制方法</a> ，它讨论了控制对服务器访问的各种方法。</p>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="introduction" id="introduction">介绍</a></h2>
    <p>如果您的网站上有敏感信息或仅适合一小部分人使用，则本文中的技术将帮助您确保看到这些页面的人就是您想要看到的人。</p>

    <p>本文介绍了保护您大多数人将要使用的网站部分的“标准”方法。</p>

    <div class="note"><h3>注意：</h3>
    <p>如果您的数据确实需要安全，请考虑使用<code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code>除了任何身份验证。</p>
    </div>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="theprerequisites" id="theprerequisites">先决条件</a></h2>
    <p>本文讨论的指令将需要放在主服务器配置文件中（通常在<code class="directive"><a href="../mod/core.html#directory"><Directory></a></code>部分），或在每个目录的配置文件中（ <code>.htaccess</code>文件）。</p>

    <p>如果您打算使用<code>.htaccess</code>文件，则需要具有允许将身份验证指令放入这些文件的服务器配置。这是通过<code class="directive"><a href="../mod/core.html#allowoverride">AllowOverride</a></code>指令，该指令指定可以在每个目录配置文件中放置哪些指令（如果有）。</p>

    <p>由于我们在这里谈论身份验证，因此您需要<code class="directive"><a href="../mod/core.html#allowoverride">AllowOverride</a></code>指令如下：</p>

    <pre class="prettyprint lang-config">AllowOverride AuthConfig</pre>


    <p>或者，如果仅要将指令直接放入主服务器配置文件中，则当然需要对该文件具有写权限。</p>

    <p>而且，您需要稍微了解一下服务器的目录结构，才能知道某些文件的存放位置。这应该不会很困难，当我们谈到这一点时，我会尽力弄清楚这一点。</p>

    <p>您还需要确保模块<code class="module"><a href="../mod/mod_authn_core.html">mod_authn_core</a></code>和<code class="module"><a href="../mod/mod_authz_core.html">mod_authz_core</a></code>已内置到httpd二进制文件中或由httpd.conf配置文件加载。这两个模块都提供了核心指令和功能，这些指令和功能对于Web服务器中的身份验证和授权的配置以及使用至关重要。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="gettingitworking" id="gettingitworking">使它工作</a></h2>
    <p>这是密码保护服务器上目录的基础。</p>

    <p>首先，您需要创建一个密码文件。确切的操作方式将取决于您选择的身份验证提供程序。以后再说。首先，我们将使用文本密码文件。</p>

    <p>该文件应放置在无法从网络访问的位置。这样一来，人们就无法下载密码文件。例如，如果您的文件没有送达<code>/usr/local/apache/htdocs</code> ，您可能希望将密码文件放入<code>/usr/local/apache/passwd</code> 。</p>

    <p>要创建文件，请使用<code class="program"><a href="../programs/htpasswd.html">htpasswd</a></code> Apache附带的实用程序。这将位于<code>bin</code>安装Apache的目录。如果您是通过第三方软件包安装的，则它可能在您的执行路径中。</p>

    <p>要创建文件，请输入：</p>

    <div class="example"><p><code>htpasswd -c /usr/local/apache/passwd/passwords rbowen</code></p></div>

    <p><code class="program"><a href="../programs/htpasswd.html">htpasswd</a></code>会要求您提供密码，然后要求您再次输入以确认：</p>

    <div class="example"><p><code># htpasswd -c /usr/local/apache/passwd/passwords rbowen<br> New password: mypassword<br> Re-type new password: mypassword<br> Adding password for user rbowen</code></p></div>

    <p>如果<code class="program"><a href="../programs/htpasswd.html">htpasswd</a></code>不在路径中，当然，您必须输入文件的完整路径才能运行它。使用默认安装，它位于<code>/usr/local/apache2/bin/htpasswd</code></p>

    <p>接下来，您需要配置服务器以请求密码，并告诉服务器允许哪些用户访问。您可以通过编辑<code>httpd.conf</code>文件或使用<code>.htaccess</code>文件。例如，如果您想保护目录<code>/usr/local/apache/htdocs/secret</code> ，您可以使用以下指令（放置在文件中） <code>/usr/local/apache/htdocs/secret/.htaccess</code> ，或放置在<code>httpd.conf</code>在一个<directory ="">部分内。</directory></p>

    <pre class="prettyprint lang-config">AuthType Basic
AuthName "Restricted Files"
# (Following line optional)
AuthBasicProvider file
AuthUserFile "/usr/local/apache/passwd/passwords"
Require user rbowen</pre>


    <p>让我们分别检查每个指令。的<code class="directive"><a href="../mod/mod_authn_core.html#authtype">AuthType</a></code>指令选择用于认证用户的方法。最常见的方法是<code>Basic</code> ，这是由<code class="module"><a href="../mod/mod_auth_basic.html">mod_auth_basic</a></code> 。但是，重要的是要知道，基本身份验证未加密地将密码从客户端发送到服务器。因此，除非伴有以下情况，否则该方法不应用于高度敏感的数据<code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code> 。Apache支持另一种身份验证方法： <code>AuthType Digest</code> 。该方法由<code class="module"><a href="../mod/mod_auth_digest.html">mod_auth_digest</a></code>并旨在更加安全。情况不再如此，连接应使用<code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code>代替。</p>

    <p>的<code class="directive"><a href="../mod/mod_authn_core.html#authname">AuthName</a></code>指令设置要在身份验证中使用的<dfn>领域</dfn> 。该领域具有两个主要功能。首先，客户端通常将此信息作为密码对话框的一部分提供给用户。其次，客户端使用它来确定要发送给定认证区域的密码。</p>

    <p>因此，例如，一旦客户端在<code>"Restricted Files"</code>区域，它将自动重试同一服务器上标有的所有区域的相同密码。 <code>"Restricted Files"</code>领域。因此，通过让多个受限区域共享同一领域，可以防止多次提示用户输入密码。当然，出于安全原因，每当服务器的主机名更改时，客户端总是需要再次询问密码。</p>

    <p>的<code class="directive"><a href="../mod/mod_auth_basic.html#authbasicprovider">AuthBasicProvider</a></code>在这种情况下是可选的，因为<code>file</code>是此指令的默认值。如果您选择其他身份验证来源，则需要使用此伪指令，例如<code class="module"><a href="../mod/mod_authn_dbm.html">mod_authn_dbm</a></code>要么<code class="module"><a href="../mod/mod_authn_dbd.html">mod_authn_dbd</a></code> 。</p>

    <p>的<code class="directive"><a href="../mod/mod_authn_file.html#authuserfile">AuthUserFile</a></code>指令将路径设置为我们刚刚创建的密码文件<code class="program"><a href="../programs/htpasswd.html">htpasswd</a></code> 。如果您有大量用户，则在纯文本文件中进行搜索以根据每个请求对用户进行身份验证可能会非常慢。 Apache还具有将用户信息存储在快速数据库文件中的功能。的<code class="module"><a href="../mod/mod_authn_dbm.html">mod_authn_dbm</a></code>模块提供<code class="directive"><a href="../mod/mod_authn_dbm.html#authdbmuserfile">AuthDBMUserFile</a></code>指示。可以使用以下命令创建和操作这些文件<code class="program"><a href="../programs/dbmmanage.html">dbmmanage</a></code>和<code class="program"><a href="../programs/htdbm.html">htdbm</a></code>程式。<a href="http://modules.apache.org/">Apache模块数据库</a>中的第三方模块提供了许多其他类型的身份验证选项。</p>

    <p>最后， <code class="directive"><a href="../mod/mod_authz_core.html#require">Require</a></code>伪指令通过设置允许访问服务器此区域的用户来提供过程的授权部分。在下一节中，我们将讨论各种使用<code class="directive"><a href="../mod/mod_authz_core.html#require">Require</a></code>指示。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="lettingmorethanonepersonin" id="lettingmorethanonepersonin">让一个以上的人进入</a></h2>
    <p>上面的指令仅允许一个人（特别是用户名为<code>rbowen</code> ）进入目录。在大多数情况下，您需要允许多个人进入。这是<code class="directive"><a href="../mod/mod_authz_groupfile.html#authgroupfile">AuthGroupFile</a></code>进来。</p>

    <p>如果要允许一个以上的人员进入，则需要创建一个群组文件，将群组名称与该群组中的用户列表相关联。该文件的格式非常简单，您可以使用自己喜欢的编辑器来创建它。该文件的内容如下所示：</p>

   <div class="example"><p><code>GroupName: rbowen dpitts sungo rshersey</code></p></div>

    <p>那只是长行中由空格分隔的组中成员的列表。</p>

    <p>要将用户添加到您现有的密码文件中，请键入：</p>

    <div class="example"><p><code>htpasswd /usr/local/apache/passwd/passwords dpitts</code></p></div>

    <p>您将获得与以前相同的响应，但是它将添加到现有文件中，而不是创建一个新文件。（这是<code>-c</code>这样就可以创建一个新的密码文件）。</p>

    <p>现在，您需要修改<code>.htaccess</code>文件或<code class="directive"><a href="../mod/core.html#directory"><Directory></a></code>块如下所示：</p>

    <pre class="prettyprint lang-config">AuthType Basic
AuthName "By Invitation Only"
# Optional line:
AuthBasicProvider file
AuthUserFile "/usr/local/apache/passwd/passwords"
AuthGroupFile "/usr/local/apache/passwd/groups"
Require group GroupName</pre>


    <p>现在，该组中列出的任何人<code>GroupName</code> ，并且在<code>password</code>文件，如果他们输入正确的密码，将被允许。</p>

    <p>还有一种让多个用户参与的方式不太明确。除了创建组文件，您还可以使用以下指令：</p>

    <pre class="prettyprint lang-config">Require valid-user</pre>


    <p>用那个而不是<code>Require user rbowen</code>行将允许密码文件中列出的任何人以及正确输入密码的人。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="possibleproblems" id="possibleproblems">可能的问题</a></h2>
    <p>由于指定了基本身份验证的方式，每次您从服务器请求文档时都必须验证用户名和密码。即使您要重新加载同一页面，也需要重新加载页面上的每个图像（如果它们来自受保护的目录）。可以想象，这会使速度变慢。它使事情变慢的数量与密码文件的大小成正比，因为它必须打开该文件，并向下浏览用户列表，直到获得您的名字为止。并且每次页面加载时都必须这样做。</p>

    <p>这样做的结果是，一个密码文件中可以放入多少用户是有实际限制的。此限制将根据您特定服务器计算机的性能而有所不同，但是一旦达到几百个条目，您可能会看到速度变慢，并且此时可能希望考虑使用其他身份验证方法。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="dbmdbd" id="dbmdbd">备用密码存储</a></h2>

    <p>因为将密码存储在纯文本文件中存在上述问题，所以您可能希望将密码存储在其他位置，例如数据库中。</p>

    <p><code class="module"><a href="../mod/mod_authn_dbm.html">mod_authn_dbm</a></code>和<code class="module"><a href="../mod/mod_authn_dbd.html">mod_authn_dbd</a></code>有两个模块使之成为可能。而不是选择<code><code class="directive"><a href="../mod/mod_auth_basic.html#authbasicprovider">AuthBasicProvider</a></code> file</code> ，您可以选择<code>dbm</code>要么<code>dbd</code>作为您的存储格式。</p>

    <p>选择一个dbm文件而不是一个文本文件，例如：</p>

    <pre class="prettyprint lang-config">&lt;Directory "/www/docs/private"&gt;
    AuthName "Private"
    AuthType Basic
    AuthBasicProvider dbm
    AuthDBMUserFile "/www/passwords/passwd.dbm"
    Require valid-user
&lt;/Directory&gt;</pre>


    <p>其他选项可用。咨询<code class="module"><a href="../mod/mod_authn_dbm.html">mod_authn_dbm</a></code>文档以获取更多详细信息。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="multprovider" id="multprovider">使用多个提供商</a></h2>

    <p>随着新的基于提供程序的身份验证和授权体系结构的引入，您不再局限于单一的身份验证或授权方法。实际上，可以将任意数量的提供程序进行混合和匹配，以为您提供完全满足您需求的方案。在以下示例中，同时使用了基于文件和LDAP的身份验证提供程序。</p>

    <pre class="prettyprint lang-config">&lt;Directory "/www/docs/private"&gt;
    AuthName "Private"
    AuthType Basic
    AuthBasicProvider file ldap
    AuthUserFile "/usr/local/apache/passwd/passwords"
    AuthLDAPURL ldap://ldaphost/o=yourorg
    Require valid-user
&lt;/Directory&gt;</pre>


    <p>在此示例中，文件提供者将首先尝试对用户进行身份验证。如果无法验证用户身份，则将调用LDAP提供程序。如果您的组织实施多种类型的身份验证存储，则可以扩大身份验证的范围。其他认证和授权方案可以包括将一种认证类型与另一种认证类型混合。例如，针对密码文件进行身份验证而针对LDAP目录进行授权。</p>

    <p>正如可以实现多个身份验证提供程序一样，也可以使用多种授权方法。在此示例中，同时使用了文件组授权和LDAP组授权。</p>

    <pre class="prettyprint lang-config">&lt;Directory "/www/docs/private"&gt;
    AuthName "Private"
    AuthType Basic
    AuthBasicProvider file
    AuthUserFile "/usr/local/apache/passwd/passwords"
    AuthLDAPURL ldap://ldaphost/o=yourorg
    AuthGroupFile "/usr/local/apache/passwd/groups"
    Require group GroupName
    Require ldap-group cn=mygroup,o=yourorg
&lt;/Directory&gt;</pre>


    <p>为了进一步授权，可以使用授权容器指令，例如<code class="directive"><a href="../mod/mod_authz_core.html#requireall"><RequireAll></a></code>和<code class="directive"><a href="../mod/mod_authz_core.html#requireany"><RequireAny></a></code>允许应用逻辑，以便可以通过配置完全控制处理授权的顺序。有关如何应用它们的示例，请参见<a href="../mod/mod_authz_core.html#logic">授权容器</a> 。</p>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="beyond" id="beyond">超越授权</a></h2>

    <p>与仅对单个数据存储进行一次检查相比，现在可以应用授权的方式更加灵活。现在可以进行排序，逻辑和选择授权方式。</p>

    <h3><a name="authandororder" id="authandororder">应用逻辑和顺序</a></h3>
        <p>过去，控制授权的方式和顺序将是一个谜。在Apache 2.2中，引入了基于提供程序的身份验证机制，以将实际的身份验证过程与授权和支持功能脱钩。附带好处之一是，可以按照不依赖于auth模块本身的加载顺序的特定顺序来配置和调用身份验证提供程序。该基于提供者的相同机制也已被引入授权。这意味着<code class="directive"><a href="../mod/mod_authz_core.html#require">Require</a></code>指令不仅指定应使用的授权方法，还指定调用它们的顺序。多个授权方法的调用顺序相同， <code class="directive"><a href="../mod/mod_authz_core.html#require">Require</a></code>指令出现在配置中。</p>

        <p>随着授权容器指令的引入，例如<code class="directive"><a href="../mod/mod_authz_core.html#requireall"><RequireAll></a></code>和<code class="directive"><a href="../mod/mod_authz_core.html#requireany"><RequireAny></a></code> ，该配置还可以控制何时调用授权方法以及什么条件确定何时授予访问权限。有关如何使用它们表示复杂的授权逻辑的示例，请参见<a href="../mod/mod_authz_core.html#logic">授权容器</a> 。</p>

        <p>默认情况下，全部<code class="directive"><a href="../mod/mod_authz_core.html#require">Require</a></code>指令的处理就好像包含在<code class="directive"><a href="../mod/mod_authz_core.html#requireany"><RequireAny></a></code>容器指令。换句话说，如果任何指定的授权方法成功，则将授予授权。</p>

    

    <h3><a name="reqaccessctrl" id="reqaccessctrl">使用授权提供者进行访问控制</a></h3>
        <p>通过用户名和密码进行身份验证只是故事的一部分。通常，您想让别人根据自己的身份而不是别人。诸如此类的来源。</p>

        <p>授权提供者<code>all</code> ， <code>env</code> ， <code>host</code>和<code>ip</code>使您可以基于其他基于主机的条件（例如请求文档的计算机的主机名或IP地址）来允许或拒绝访问。</p>

        <p>这些提供程序的用法通过<code class="directive"><a href="../mod/mod_authz_core.html#require">Require</a></code>指示。此伪指令注册将在请求处理的授权阶段被调用的授权提供者。例如：</p>

        <pre class="prettyprint lang-config">Require ip <var>address</var></pre>


        <p>哪里<var>address</var>是IP地址（或部分IP地址）或：</p>

        <pre class="prettyprint lang-config">Require host <var>domain_name</var></pre>


        <p>哪里<var>domain_name</var>是完全限定的域名（或部分域名）；如果需要，您可以提供多个地址或域名。</p>

        <p>例如，如果您有某人向您的留言板发送垃圾邮件，并且希望将其拒之门外，则可以执行以下操作：</p>

        <pre class="prettyprint lang-config">&lt;RequireAll&gt;
    Require all granted
    Require not ip 10.252.46.165
&lt;/RequireAll&gt;</pre>


        <p>来自该地址的访问者将看不到该指令所涵盖的内容。相反，如果您拥有计算机名称而不是IP地址，则可以使用该名称。</p>

        <pre class="prettyprint lang-config">&lt;RequireAll&gt;
    Require all granted
    Require not host host.example.com
&lt;/RequireAll&gt;</pre>


        <p>而且，如果您想阻止来自整个域的访问，则可以仅指定地址或域名的一部分：</p>

        <pre class="prettyprint lang-config">&lt;RequireAll&gt;
    Require all granted
    Require not ip 192.168.205
    Require not host phishers.example.com moreidiots.example
    Require not host ke
&lt;/RequireAll&gt;</pre>


        <p>使用<code class="directive"><a href="../mod/mod_authz_core.html#requireall"><RequireAll></a></code>与多个<code class="directive"><a href="../mod/mod_authz_core.html#require"><Require></a></code>指令，每个都与<code>not</code> ，只有在所有否定条件都成立的情况下，才允许访问。换句话说，如果任何否定条件失败，访问将被阻止。</p>

    

    <h3><a name="filesystem" id="filesystem">访问控制向后兼容</a></h3>
        <p>采用基于提供者的身份验证机制的副作用之一是以前的访问控制指令<code class="directive"><a href="../mod/mod_access_compat.html#order">Order</a></code> ， <code class="directive"><a href="../mod/mod_access_compat.html#allow">Allow</a></code> ， <code class="directive"><a href="../mod/mod_access_compat.html#deny">Deny</a></code>和<code class="directive"><a href="../mod/mod_access_compat.html#satisfy">Satisfy</a></code>不再需要。但是，为了向较早的配置提供向后兼容性，这些指令已移至<code class="module"><a href="../mod/mod_access_compat.html">mod_access_compat</a></code>模块。</p>

        <div class="warning"><h3>注意</h3>
        <p>提供的指令<code class="module"><a href="../mod/mod_access_compat.html">mod_access_compat</a></code>已被弃用<code class="module"><a href="../mod/mod_authz_host.html">mod_authz_host</a></code> 。混合旧指令<code class="directive"><a href="../mod/mod_access_compat.html#order">Order</a></code> ， <code class="directive"><a href="../mod/mod_access_compat.html#allow">Allow</a></code>要么<code class="directive"><a href="../mod/mod_access_compat.html#deny">Deny</a></code>与新的像<code class="directive"><a href="../mod/mod_authz_core.html#require">Require</a></code>从技术上讲是可行的，但不鼓励使用。的<code class="module"><a href="../mod/mod_access_compat.html">mod_access_compat</a></code>创建模块以支持仅包含旧指令的配置，以促进2.4升级。请查看<a href="../upgrading.html">升级</a>指南以获取更多信息。
        </p>
        </div>
    

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="socache" id="socache">身份验证缓存</a></h2>
    <p>有时，身份验证会对提供商或网络造成不可接受的负担。这最有可能影响以下用户<code class="module"><a href="../mod/mod_authn_dbd.html">mod_authn_dbd</a></code> （或第三方/自定义提供商）。为了解决这个问题，HTTPD 2.3 / 2.4引入了一个新的缓存提供程序<code class="module"><a href="../mod/mod_authn_socache.html">mod_authn_socache</a></code>缓存凭据并减少源提供者的负担。</p>
    <p>这可能会为某些用户带来实质性的性能提升。</p>
</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="moreinformation" id="moreinformation">更多信息</a></h2>
    <p>您还应该阅读以下文档： <code class="module"><a href="../mod/mod_auth_basic.html">mod_auth_basic</a></code>和<code class="module"><a href="../mod/mod_authz_host.html">mod_authz_host</a></code>其中包含有关这一切工作原理的更多信息。指令<code class="directive"><a href="../mod/mod_authn_core.html#authnprovideralias"><AuthnProviderAlias></a></code>还可以帮助简化某些身份验证配置。</p>

    <p><a href="../misc/password_encryptions.html">密码加密</a>中说明了Apache支持的用于身份验证数据的各种密码。</p>

    <p>您可能需要查看<a href="access.html">访问控制方法</a> ，其中讨论了许多相关主题。</p>

</div></div>
<div id="footer">
<p class="apache">版权所有2018 The Apache Software Foundation。<br>根据<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache许可，版本2.0许可</a> 。</p>
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p></div><script type="text/javascript"><!--//--><![CDATA[//><!--
if (typeof(prettyPrint) !== 'undefined') {
    prettyPrint();
}
//--><!]]></script>

</body></html>