<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type">
<title>访问控制-Apache HTTP Server版本2.4</title>
<link href="../style/css/manual-zip.css" rel="stylesheet" type="text/css" title="Main stylesheet" media="all">
<link href="../style/css/manual-zip-100pc.css" rel="alternate stylesheet" type="text/css" title="No Sidebar - Default font size" media="all">
<link href="../style/css/manual-print.css" rel="stylesheet" type="text/css" media="print"><link rel="stylesheet" type="text/css" href="../style/css/prettify.css">
<script src="../style/scripts/prettify.min.js" type="text/javascript">
</script>
</head>
<body id="manual-page" ><div id="page-header">
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p>
<p class="apache">Apache HTTP服务器版本2.4</p>
<img alt="" src="../images/feather.png"></div>
<div class="up"><a href="./index.html"><img title="<-" alt="<-" src="../images/left.gif"></a></div>
<div id="path">
<a href="http://www.apache.org/">Apache</a> > <a href="http://httpd.apache.org/">HTTP服务器</a> > <a href="http://httpd.apache.org/docs/">文档</a> > <a href="../index.html">版本2.4</a> >操作方法<a href="./index.html">/教程</a></div><div id="page-content"><div id="preamble"><h1>访问控制</h1>


    <p>访问控制是指控制对任何资源的访问的任何方式。这与<a href="auth.html">身份验证和授权</a>是分开的。</p>
</div>
<div id="quickview"><a href="https://www.apache.org/foundation/contributing.html" class="badge"><img src="https://www.apache.org/images/SupportApache-small.png" alt="支持Apache！"></a><ul id="toc"><li><img alt="" src="../images/down.gif"> <a href="#related">相关模块和指令</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#host">主机访问控制</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#env">通过任意变量进行访问控制</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#rewrite">使用mod_rewrite进行访问控制</a></li>
<li><img alt="" src="../images/down.gif"> <a href="#moreinformation">更多信息</a></li>
</ul></div>
<div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="related" id="related">相关模块和指令</a></h2>

    <p>访问控制可以通过几个不同的模块来完成。其中最重要的是<code class="module"><a href="../mod/mod_authz_core.html">mod_authz_core</a></code>和<code class="module"><a href="../mod/mod_authz_host.html">mod_authz_host</a></code> 。本文档中还讨论了使用<code class="module"><a href="../mod/mod_rewrite.html">mod_rewrite</a></code> 。</p>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="host" id="host">主机访问控制</a></h2>
    <p>如果您希望根据访问者的主机地址来限制对网站部分的访问，则最简单的方法是使用<code class="module"><a href="../mod/mod_authz_host.html">mod_authz_host</a></code> 。
    </p>

    <p>的<code class="directive"><a href="../mod/mod_authz_core.html#require">Require</a></code>提供了各种不同的方式来允许或拒绝对资源的访问。结合<code class="directive"><a href="../mod/mod_authz_core.html#requireall">RequireAll</a></code> ， <code class="directive"><a href="../mod/mod_authz_core.html#requireany">RequireAny</a></code>和<code class="directive"><a href="../mod/mod_authz_core.html#requirenone">RequireNone</a></code>指令，这些要求可以以任意复杂的方式组合在一起，以强制执行您的访问策略。</p>

    <div class="warning"><p>的<code class="directive"><a href="../mod/mod_access_compat.html#allow">Allow</a></code> ， <code class="directive"><a href="../mod/mod_access_compat.html#deny">Deny</a></code>和<code class="directive"><a href="../mod/mod_access_compat.html#order">Order</a></code>指令，由<code class="module"><a href="../mod/mod_access_compat.html">mod_access_compat</a></code> ，已弃用，并将在以后的版本中删除。您应该避免使用它们，并避免推荐使用过时的教程。
    </p></div>

    <p>这些指令的用法是：</p>

    <pre class="prettyprint lang-config">Require host address
Require ip ip.address</pre>


    <p>在第一种形式中<var>address</var>是完全限定的域名（或部分域名）；如果需要，您可以提供多个地址或域名。</p>

    <p>在第二种形式中<var>ip.address</var>是IP地址，部分IP地址，网络/网络掩码对或网络/ nnn CIDR规范。可以使用IPv4或IPv6地址。</p>

    <p>有关此语法的更多示例，请参见<a href="../mod/mod_authz_host.html#requiredirectives">mod_authz_host文档</a> 。</p>

    <p>您可以插入<code>not</code>否定特定要求。请注意，由于<code>not</code>是值的否定，不能单独用于允许或拒绝请求，因为<em>true</em>并不表示<em>false</em> 。因此，要使用否定拒绝访问，该块必须具有一个评估为true或false的元素。例如，如果您有某人向您的留言板发送垃圾邮件，并且希望将其拒之门外，则可以执行以下操作：</p>

    <pre class="prettyprint lang-config">&lt;RequireAll&gt;
    Require all granted
    Require not ip 10.252.46.165
&lt;/RequireAll&gt;</pre>


    <p>来自该地址的访问者（ <code>10.252.46.165</code> ）将无法看到该指令涵盖的内容。相反，如果您拥有计算机名称而不是IP地址，则可以使用该名称。</p>

    <pre class="prettyprint lang-config">Require not host <var>host.example.com</var>
    </pre>


    <p>而且，如果您想阻止来自整个域的访问，则可以仅指定地址或域名的一部分：</p>

    <pre class="prettyprint lang-config">Require not ip 192.168.205
Require not host phishers.example.com moreidiots.example
Require not host gov</pre>


    <p>使用<code class="directive"><a href="../mod/mod_authz_core.html#requireall">RequireAll</a></code> ， <code class="directive"><a href="../mod/mod_authz_core.html#requireany">RequireAny</a></code>和<code class="directive"><a href="../mod/mod_authz_core.html#requirenone">RequireNone</a></code>指令可用于强制执行更复杂的要求集。</p>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="env" id="env">通过任意变量进行访问控制</a></h2>

    <p>使用<code class="directive"><a href="../mod/core.html#if"><If></a></code> ，您可以基于任意环境变量或请求标头值来允许或拒绝访问。例如，要基于用户代理（浏览器类型）拒绝访问，可以执行以下操作：</p>

    <pre class="prettyprint lang-config">&lt;If "%{HTTP_USER_AGENT} == 'BadBot'"&gt;
    Require all denied
&lt;/If&gt;</pre>


    <p>使用<code class="directive"><a href="../mod/mod_authz_core.html#require">Require</a></code><code>expr</code>语法，也可以写成：</p>


    <pre class="prettyprint lang-config">Require expr %{HTTP_USER_AGENT} != 'BadBot'</pre>


    <div class="note"><h3>警告：</h3>
    <p>访问控制<code>User-Agent</code>这是一种不可靠的技术，因为<code>User-Agent</code>标头可以设置为最终用户的任何想法。</p>
    </div>

    <p>有关可以使用哪些表达式语法和变量的进一步讨论，请参见<a href="../expr.html">表达式文档</a> 。</p>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="rewrite" id="rewrite">使用mod_rewrite进行访问控制</a></h2>

    <p>的<code>[F]</code><code class="directive"><a href="../mod/mod_rewrite.html#rewriterule">RewriteRule</a></code>标志会导致发送403禁止响应。使用此功能，您可以基于任意条件拒绝对资源的访问。</p>

    <p>例如，如果您希望在晚上8点至早上7点之间阻止对资源的访问，则可以使用<code class="module"><a href="../mod/mod_rewrite.html">mod_rewrite</a></code> 。</p>

    <pre class="prettyprint lang-config">RewriteEngine On
RewriteCond "%{TIME_HOUR}" "&gt;=20" [OR]
RewriteCond "%{TIME_HOUR}" "&lt;07"
RewriteRule "^/fridge"     "-" [F]</pre>


    <p>对于晚上8点之后或早上7点之前的任何请求，这将返回403禁止响应。此技术可用于您希望检查的任何条件。如果首选该方法，则也可以重定向或重写这些请求。</p>

    <p>的<code class="directive"><a href="../mod/core.html#if"><If></a></code> 2.4中添加的指令替换了许多<code class="module"><a href="../mod/mod_rewrite.html">mod_rewrite</a></code>传统上已经习惯了这样做，在使用mod_rewrite之前，您可能应该先看看那里。</p>

</div><div class="top"><a href="#page-header"><img alt="最佳" src="../images/up.gif"></a></div>
<div class="section">
<h2><a name="moreinformation" id="moreinformation">更多信息</a></h2>

    <p><a href="../expr.html">表达式引擎</a>为您提供了基于任意服务器变量执行各种操作的强大功能，您应该查阅该文档以获取更多详细信息。</p>

    <p>另外，您应该阅读<code class="module"><a href="../mod/mod_authz_core.html">mod_authz_core</a></code>有关组合多个访问需求并指定它们如何交互的示例的文档。</p>

    <p>另请参阅“ <a href="auth.html">身份验证和授权”方法</a> 。</p>
</div></div>
<div id="footer">
<p class="apache">版权所有2018 The Apache Software Foundation。<br>根据<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache许可，版本2.0许可</a> 。</p>
<p class="menu"><a href="../mod/index.html">模块</a> | <a href="../mod/directives.html">指令</a> | <a href="http://wiki.apache.org/httpd/FAQ">常见问题</a> | <a href="../glossary.html">词汇表</a> | <a href="../sitemap.html">网站地图</a></p></div><script type="text/javascript"><!--//--><![CDATA[//><!--
if (typeof(prettyPrint) !== 'undefined') {
    prettyPrint();
}
//--><!]]></script>

</body></html>