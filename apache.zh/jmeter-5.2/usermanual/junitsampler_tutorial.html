<html ><head>
<link rel="stylesheet" type="text/css" href="../css/style.css">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="author" value="JMeter developers">
<meta name="email" value="dev@jmeter.apache.org">

<title>Apache JMeter-JUnit Sampler教程</title>
<style>
  .code { font-weight: bold; }
</style>
</head>

<body bgcolor="#ffffff"  text="#000000" link="#525D76">
<table border="0" cellspacing="0">
<tbody><tr>
<td align="left">
<a href="http://www.apache.org"><img title="Apache软件基金会" width="261" height="106" src="../images/asf-logo.png" border="0" style="margin:0px 30px 0px 0px"></a>
</td>
<td align="right">
<a href="http://jmeter.apache.org/"><img width="259" height="88" src="../images/jmeter.png" alt="Apache JMeter" title="Apache JMeter" border="0"></a>
</td>
</tr>
</tbody></table>
<table border="0" cellspacing="4">
<tbody><tr><td>
<hr noshade size="1">
</td></tr>
<tr>
<td align="left" valign="top">
<table>
<tbody><tr>
<td bgcolor="#525D76">
<div align="right"><a href="index.html"><font size="-1" color="#ffffff" face="arial,helvetica,sanserif">指数</font></a></div>
</td>
<td bgcolor="#525D76">
<div align="right"><a href="jmeter_accesslog_sampler_step_by_step.html"><font size="-1" color="#ffffff" face="arial,helvetica,sanserif">下一个</font></a></div>
</td>
<td bgcolor="#525D76">
<div align="right"><a href="jmeter_proxy_step_by_step.html"><font size="-1" color="#ffffff" face="arial,helvetica,sanserif">上一个</font></a></div>
</td>
</tr>
</tbody></table>
<br>
<table border="0" cellspacing="0" cellpadding="2" width="100%">
<tbody><tr><td bgcolor="#525D76">
<font color="#ffffff" face="arial,helvetica,sanserif">
<a name="junit"><strong>27。JUnit Sampler教程</strong></a></font>
</td></tr>
<tr><td>
<blockquote>
<p>本教程试图解释用于JMeter的新JUnit Sampler的基本设计，功能和用法。该采样器是在JMeter的2.1.2版本中引入的。早期版本没有采样器。
</p><table border="0" cellspacing="0" cellpadding="2" width="100%">
<tbody><tr><td bgcolor="#828DA6">
<font color="#ffffff" face="arial,helvetica,sanserif">
<a name="design"><strong>27.1设计</strong></a>
</font>
</td></tr>
<tr><td>
<blockquote>
<p>当前实现支持标准的JUnit约定和扩展，例如<tt class="code">oneTimeSetUp</tt>和<tt class="code">oneTimeTearDown</tt> 。其他功能可以根据要求添加。采样器的工作方式类似于JavaSampler，但有一些区别。
</p><ul>
  <li>它不使用JMeter的测试接口，而是在jar文件中扫描扩展JUnit的<tt class="code">TestCase</tt>类的类。这意味着任何类或子类。</li>
  <li>将JUnit测试jar文件复制到<tt class="code">jmeter / lib / junit</tt>而不是<tt class="code">jmeter / lib</tt></li>
  <li>JUnit采样器不使用名称/值对进行配置。采样器假定<tt class="code">setUp</tt>和<tt class="code">tearDown</tt>将正确配置测试。
      <p>
</p><table border="1" bgcolor="#bbbb00" width="50%" cellspacing="0" cellpadding="2">
<tbody><tr><td>注意：必须将<tt class="code">setUp</tt>和<tt class="code">tearDown</tt>方法声明为<tt class="code">public</tt> ，以便JMeter可以使用它。</td></tr>
</tbody></table>
<p></p>

  </li>
  <li>采样器仅测量测试方法的经过时间，不包括<tt class="code">setUp</tt>和<tt class="code">tearDown</tt> 。
  </li>
  <li>每次调用测试方法时，JMeter会将结果传递给侦听器。</li>
  <li>对<tt class="code">oneTimeSetUp</tt>和<tt class="code">oneTimeTearDown的</tt>支持是通过一种方法完成的。由于JMeter是多线程的，因此我们无法像maven那样调用<tt class="code">oneTimeSetUp</tt> / <tt class="code">oneTimeTearDown</tt> 。</li>
  <li>采样器将意外的异常报告为错误。</li>
</ul></blockquote>
</td></tr>
<tr><td><br></td></tr>
</tbody></table>
<table border="0" cellspacing="0" cellpadding="2" width="100%">
<tbody><tr><td bgcolor="#828DA6">
<font color="#ffffff" face="arial,helvetica,sanserif">
<a name="functionality"><strong>27.2功能</strong></a>
</font>
</td></tr>
<tr><td>
<blockquote>
<p>这是功能的说明。
</p><dl>
  <dt>名称</dt><dd>样品名称。这与所有JMeter采样器相同。</dd>
  <dt>包装过滤器</dt><dd>提供了一种按包名称过滤类的方法。</dd>
  <dt>班级名称</dt><dd>要测试的类的名称。采样器将扫描<tt class="code">jmeter / lib / ext</tt>和<tt class="code">jmeter / lib / junit中</tt>的jar文件，以查找扩展JUnit的<tt class="code">TestCase的</tt>类。</dd>
  <dt>构造函数字符串</dt><dd>传递给测试类的字符串构造函数的字符串。</dd>
  <dt>测试方法</dt><dd>采样器中要测试的方法的名称。</dd>
  <dt>成功讯息</dt><dd>描述成功的含义的描述性消息。</dd>
  <dt>成功代码</dt><dd>表示测试成功的唯一代码。</dd>
  <dt>失败讯息</dt><dd>描述性消息，指示失败的含义。</dd>
  <dt>失败码</dt><dd>表示测试失败的唯一代码</dd>
  <dt>错误信息</dt><dd>错误说明</dd>
  <dt>错误代码</dt><dd>一些错误代码。不需要唯一</dd>
  <dt>不要调用<tt class="code">setUp</tt>和<tt class="code">tearDown</tt></dt><dd>设置采样器不调用<tt class="code">setUp</tt>和<tt class="code">tearDown</tt> 。默认情况下，应调用<tt class="code">setUp</tt>和<tt class="code">tearDown</tt> 。不调用这些方法可能会影响测试并使其不准确。该选项应谨慎使用。
      <p>
</p><table border="1" bgcolor="#bbbb00" width="50%" cellspacing="0" cellpadding="2">
<tbody><tr><td>如果所选方法是<tt class="code">oneTimeSetUp</tt>或<tt class="code">oneTimeTearDown</tt> ，则应选中此选项。</td></tr>
</tbody></table>
<p></p>
</dd>
  <dt>附加断言错误</dt><dd>默认情况下，采样器不会将断言失败附加到失败消息中。要在结果树中查看消息，请选中该选项。</dd>
  <dt>附加运行时异常</dt><dd>默认情况下，采样器不会将异常附加到失败消息中。要查看堆栈跟踪，请检查选项</dd>
</dl><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><img width="397" height="536" src="../images/screenshots/junit_sampler.png"><br>
<font size="-1">JUnit请求</font></td></tr></tbody></table>
<p>采样器的当前实现将首先尝试使用字符串构造函数创建实例。如果测试类未声明字符串构造函数，则采样器将查找空的构造函数。下面的例子：</p><a name="constructor-examples"></a>
<p><b>构造函数示例</b></p>空构造函数：<div align="left">
<table cellspacing="4" cellpadding="0" border="0">
<tbody><tr>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
</tr>
<tr>
<td bgcolor="#023264" width="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#ffffff"><pre>
public class myTestCase {
  public myTestCase() {}
}
</pre></td>
<td bgcolor="#023264" width="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
</tr>
<tr>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
</tr>
</tbody></table>
</div>字符串构造函数：<div align="left">
<table cellspacing="4" cellpadding="0" border="0">
<tbody><tr>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
</tr>
<tr>
<td bgcolor="#023264" width="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#ffffff"><pre>
public class myTestCase {
  public myTestCase(String text) {
    super(text);
  }
}
</pre></td>
<td bgcolor="#023264" width="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
</tr>
<tr>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
</tr>
</tbody></table>
</div>

<p>默认情况下，JMeter将为成功/失败代码和消息提供一些默认值。用户应定义一组唯一的成功和失败代码，并在所有测试中统一使用它们。
</p></blockquote>
</td></tr>
<tr><td><br></td></tr>
</tbody></table>
<table border="0" cellspacing="0" cellpadding="2" width="100%">
<tbody><tr><td bgcolor="#828DA6">
<font color="#ffffff" face="arial,helvetica,sanserif">
<a name="usage"><strong>27.3使用</strong></a>
</font>
</td></tr>
<tr><td>
<blockquote>
<p>这是一个简短的分步说明。
</p><ol>
  <li>编写您的JUnit测试并jar类</li>
  <li>将jar文件复制并粘贴到<tt class="code">jmeter / lib / junit</tt>目录中</li>
  <li>启动JMeter</li>
  <li>选择<tt class="code">测试计划</tt></li>
  <li>右键单击<span class="menuchoice"><span class="guimenuitem">添加</span> → <span class="guimenuitem">线程组</span></span>
</li>
  <li>选择<tt class="code">线程组</tt></li>
  <li>右键单击<span class="menuchoice"><span class="guimenuitem">添加</span> → <span class="guimenuitem">采样器</span> → <span class="guimenuitem">JUnit请求</span></span>
</li>
  <li>输入<tt class="code">我的单元测试</tt>的名称</li>
  <li>输入您的JUnit测试包</li>
  <li>选择您要测试的课程</li>
  <li>选择一种测试方法</li>
  <li>在成功消息中输入<tt class="code">测试成功</tt>消息</li>
  <li>输入成功代码<tt class="code">1000</tt></li>
  <li>在失败消息中输入<tt class="code">测试失败</tt></li>
  <li>在错误代码中输入<tt class="code">0001</tt></li>
  <li>选择线程组</li>
  <li>右键单击<span class="menuchoice"><span class="guimenuitem">添加</span> → <span class="guimenuitem">侦听器</span> → <span class="guimenuitem">查看结果树</span></span>
</li>
</ol><p>JUnit采样器的一个好处是它允许用户从各种单元测试中选择任何方法来创建测试计划。这应该减少用户创建各种测试方案所需编写的代码量。通过一组基本的测试方法，可以使用JMeter的GUI创建不同的序列和测试。</p><p>例如：</p><p>测试计划1</p><div align="left">
<table cellspacing="4" cellpadding="0" border="0">
<tbody><tr>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
</tr>
<tr>
<td bgcolor="#023264" width="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#ffffff"><pre>
TestCase1.testImportCustomer
TestCase2.testUpdateRandomCustomer
TestCase1.testSelect100
TestCase2.testUpdateOrder
TestCase1.testSelect1000
</pre></td>
<td bgcolor="#023264" width="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
</tr>
<tr>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
</tr>
</tbody></table>
</div>

<p></p><p>测试计划2</p><div align="left">
<table cellspacing="4" cellpadding="0" border="0">
<tbody><tr>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
</tr>
<tr>
<td bgcolor="#023264" width="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#ffffff"><pre>
TestCase1.testImportCustomer
TestCase1.testSelect100
TestCase1.testSelect1000
TestCase2.testAdd100Customers
</pre></td>
<td bgcolor="#023264" width="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
</tr>
<tr>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
<td bgcolor="#023264" width="1" height="1"><img src="/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td>
</tr>
</tbody></table>
</div>

<p></p></blockquote>
</td></tr>
<tr><td><br></td></tr>
</tbody></table>
<table border="0" cellspacing="0" cellpadding="2" width="100%">
<tbody><tr><td bgcolor="#828DA6">
<font color="#ffffff" face="arial,helvetica,sanserif">
<a name="guidelines"><strong>27.4一般准则</strong></a>
</font>
</td></tr>
<tr><td>
<blockquote>
<p>这里是一些编写JUnit测试的通用准则，因此它们可以与JMeter一起很好地工作。由于JMeter运行多线程，因此牢记某些事情很重要。
</p><ul>
  <li>编写<tt class="code">setUp</tt>和<tt class="code">tearDown</tt>方法，使它们是线程安全的。这通常意味着避免使用静态成员。</li>
  <li>使测试方法成为离散的工作单元，而不是冗长的动作序列。通过将测试方法保持为离散操作，可以更轻松地组合测试方法以创建新的测试计划。</li>
  <li>避免使测试方法相互依赖。由于JMeter允许对测试方法进行任意排序，因此运行时行为与默认JUnit行为不同。</li>
  <li>如果测试方法是可配置的，请注意属性的存储位置。建议从Jar文件中读取属性。</li>
  <li>每个采样器都会创建测试类的实例，因此编写测试，以便在<tt class="code">oneTimeSetUp</tt>和<tt class="code">oneTimeTearDown中进行设置</tt> 。</li>
  <li>如果选择一个类而没有显示任何方法，则意味着采样器在创建测试类的实例时遇到问题。调试此错误的最佳方法是将一些<tt class="code">System.out</tt>添加到类构造函数中，然后查看发生了什么。</li>
</ul></blockquote>
</td></tr>
<tr><td><br></td></tr>
</tbody></table>
</blockquote>
<p></p>
</td></tr>
<tr><td><br></td></tr>
</tbody></table>
<br>
<table>
<tbody><tr>
<td bgcolor="#525D76">
<div align="right"><a href="index.html"><font size="-1" color="#ffffff" face="arial,helvetica,sanserif">指数</font></a></div>
</td>
<td bgcolor="#525D76">
<div align="right"><a href="jmeter_accesslog_sampler_step_by_step.html"><font size="-1" color="#ffffff" face="arial,helvetica,sanserif">下一个</font></a></div>
</td>
<td bgcolor="#525D76">
<div align="right"><a href="jmeter_proxy_step_by_step.html"><font size="-1" color="#ffffff" face="arial,helvetica,sanserif">上一个</font></a></div>
</td>
</tr>
</tbody></table>
</td>
</tr>
<tr><td>
<hr noshade size="1">
</td></tr>
<tr>
<td>
<table width="100%">
<tbody><tr>
<td>
<font color="#525D76" size="-1"><em>版权所有©1999-2019，Apache软件基金会</em></font>
</td>
<td align="right">
<font color="#525D76" size="-1"><em>$ Id $</em></font>
</td>
</tr>
<tr><td colspan="2">
<div align="center"><font color="#525D76" size="-1">Apache，Apache JMeter，JMeter，Apache Feather和Apache JMeter徽标是Apache Software Foundation的商标。
</font>
</div>
</td></tr>
</tbody></table>
</td>
</tr>
</tbody></table>


<!-- end the processing -->














































</body></html>