<html ><head>
<link rel="stylesheet" type="text/css" href="../../docs/css/style.css">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>Apache JMeter-用户手册：建立简单的数据库测试计划</title>
<style>
  .code { font-weight: bold; }
</style>
</head>

<body bgcolor="#ffffff"  text="#000000" link="#525D76">
<table border="0" cellspacing="0">
<tbody><tr>
<td align="left">
<a href="http://www.apache.org"><img title="Apache软件基金会" width="261" height="106" src="../../docs/images/asf-logo.png" border="0" style="margin:0px 30px 0px 0px"></a>
</td>
<td align="right">
<a href="http://jmeter.apache.org/"><img width="259" height="88" src="../../docs/images/jmeter.png" alt="Apache JMeter" title="Apache JMeter" border="0"></a>
</td>
</tr>
</tbody></table>
<table border="0" cellspacing="4">
<tbody><tr><td>
<hr noshade size="1">
</td></tr>
<tr>
<td align="left" valign="top">
<table>
<tbody><tr>
<td bgcolor="#525D76">
<div align="right"><a href="index.html"><font size="-1" color="#ffffff" face="arial,helvetica,sanserif">指数</font></a></div>
</td>
<td bgcolor="#525D76">
<div align="right"><a href="build-ftp-test-plan.html"><font size="-1" color="#ffffff" face="arial,helvetica,sanserif">下一个</font></a></div>
</td>
<td bgcolor="#525D76">
<div align="right"><a href="build-adv-web-test-plan.html"><font size="-1" color="#ffffff" face="arial,helvetica,sanserif">上一个</font></a></div>
</td>
</tr>
</tbody></table>
<br>
<table border="0" cellspacing="0" cellpadding="2" width="100%">
<tbody><tr><td bgcolor="#525D76">
<font color="#ffffff" face="arial,helvetica,sanserif">
<a name="building"><strong>6。建立数据库测试计划</strong></a></font>
</td></tr>
<tr><td>
<blockquote>
<p>在本节中，您将学习如何创建基本的<a href="build-test-plan.html">测试计划</a>以测试数据库服务器。您将创建五十个用户，这些用户向数据库服务器发送2个SQL请求。另外，您将告诉用户运行其测试100次。因此，请求总数为（50个用户）x（2个请求）x（重复100次）= 10,000个JDBC请求。要构建测试计划，您将使用以下元素： <a href="test_plan.html#thread_group">线程组</a> ， <a href="../usermanual/component_reference.html#JDBC_Request">JDBC请求</a> ， <a href="../usermanual/component_reference.html#Summary_Report">摘要报告</a> 。</p><p>
</p><table border="1" bgcolor="#bbbb00" width="50%" cellspacing="0" cellpadding="2">
<tbody><tr><td>本示例使用MySQL数据库驱动程序。要使用该驱动程序，必须将其包含的<tt class="code">.jar</tt>文件（例如<tt class="code">mysql-connector-java-XXX-bin.jar</tt> ）复制到JMeter <tt class="code">./lib</tt>目录（有关更多详细信息，请参见<a href="get-started.html#classpath">JMeter的Classpath</a> ）。</td></tr>
</tbody></table>
<p></p>
</blockquote>
<p></p>
</td></tr>
<tr><td><br></td></tr>
</tbody></table>
<table border="0" cellspacing="0" cellpadding="2" width="100%">
<tbody><tr><td bgcolor="#525D76">
<font color="#ffffff" face="arial,helvetica,sanserif">
<a name="adding_users"><strong>6.1添加用户</strong></a></font>
</td></tr>
<tr><td>
<blockquote>
<p>您要对每个JMeter测试计划进行的第一步是添加一个<a href="test_plan.html#thread_group">线程组</a>元素。线程组告诉JMeter您要模拟的用户数量，用户应多久发送一次请求以及应发送多少次请求。</p><p>继续并通过首先选择“测试计划”来添加ThreadGroup元素，单击鼠标右键以获取“ <tt class="code">添加”</tt>菜单，然后选择“ <span class="menuchoice"><span class="guimenuitem">添加”</span> →“ <span class="guimenuitem">ThreadGroup”</span></span> 。</p><p>现在，您应该在“测试计划”下看到“线程组”元素。如果没有看到该元素，则通过单击“测试计划”元素来<em>展开</em> “测试计划”树。</p><p>接下来，您需要修改默认属性。如果尚未选择线程组元素，则在树中选择它。现在，您应该在“ JMeter”窗口的右侧部分中看到“线程组控制面板”（请参见下面的图6.1）。</p><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><img src="../../docs/images/screenshots/jdbctest/threadgroup1.png"><br>
<font size="-1">图6.1。具有默认值的线程组</font></td></tr></tbody></table>
<p>首先为我们的线程组提供一个更具描述性的名称。在名称字段中，输入<tt class="code">JDBC Users</tt> 。</p><p>
</p><table border="1" bgcolor="#bbbb00" width="50%" cellspacing="0" cellpadding="2">
<tbody><tr><td>您将需要有效的数据库，数据库表以及对该表的用户级别访问。在此处显示的示例中，数据库为“ <tt class="code">cloud</tt> ”，表名称为“ <tt class="code">vm_instance</tt> ”。</td></tr>
</tbody></table>
<p></p>
<p>接下来，将用户数增加到<tt class="code">50</tt> 。</p><p>在下一个字段（加速时间）中，保留<tt class="code">10</tt>秒的值。该属性告诉JMeter启动每个用户之间要延迟多长时间。例如，如果您输入10秒钟的加速期，JMeter将在10秒钟结束时完成所有用户的启动。因此，如果我们有50个用户和10秒钟的加速期，则启动用户之间的延迟将为200毫秒（10秒/ 50个用户=每个用户0.2秒）。如果将值设置为0，那么JMeter将立即启动所有用户。</p><p>最后，在“循环计数”字段中输入值<tt class="code">100</tt> 。该属性告诉JMeter重复测试多少次。要让JMeter重复运行您的测试计划，请选择永久复选框。</p><p>
</p><table border="1" bgcolor="#bbbb00" width="50%" cellspacing="0" cellpadding="2">
<tbody><tr><td>在大多数应用程序中，您必须手动接受在控制面板中所做的更改。但是，在JMeter中，控制面板会在您进行更改时自动接受它们。如果更改元素的名称，则在离开控制面板后（例如，选择另一个树元素时），树将使用新文本进行更新。</td></tr>
</tbody></table>
<p></p>
<p>有关完整的JDBC用户线程组，请参见图6.2。</p><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><img src="../../docs/images/screenshots/jdbctest/threadgroup2.png"><br>
<font size="-1">图6.2。JDBC用户线程组</font></td></tr></tbody></table>
</blockquote>
<p></p>
</td></tr>
<tr><td><br></td></tr>
</tbody></table>
<table border="0" cellspacing="0" cellpadding="2" width="100%">
<tbody><tr><td bgcolor="#525D76">
<font color="#ffffff" face="arial,helvetica,sanserif">
<a name="adding_requests"><strong>6.2添加JDBC请求</strong></a></font>
</td></tr>
<tr><td>
<blockquote>
<p>现在我们已经定义了用户，是时候定义他们将要执行的任务了。在本部分中，您将指定要执行的JDBC请求。</p><p>首先选择<tt class="code">JDBC Users</tt>元素。单击鼠标右键获得“ <b>添加”</b>菜单，然后选择“ <span class="menuchoice"><span class="guimenuitem">添加”</span> →“ <span class="guimenuitem">配置元素”</span> →“ <span class="guimenuitem">JDBC连接配置”</span></span> 。然后，选择此新元素以查看其控制面板（请参见图6.3）。</p><p>设置以下字段（这些假设我们将使用名为“ <tt class="code">cloud</tt> ”的MySQL数据库）：</p><ul>
<li>绑定到池的变量名称（此处为： <tt class="code">myDatabase</tt> ）。这需要唯一地标识配置。JDBC Sampler使用它来标识要使用的配置。</li>
<li>数据库URL： <tt class="code">jdbc：mysql：// ipOfTheServer：3306 / cloud</tt></li>
<li>JDBC驱动程序类： <tt class="code">com.mysql.jdbc。司机</tt></li>
<li>用户<em>名：数据库的用户名</em></li>
<li>密码： <em>用户名的密码</em></li>
</ul><p>屏幕上的其他字段可以保留为默认值。</p><p>JMeter使用“控制面板”中指定的配置设置创建数据库连接池。在“ <tt class="code">变量名</tt> ”字段的JDBC请求中引用该池。可以使用几种不同的JDBC Configuration元素，但是它们必须具有唯一的名称。每个JDBC请求都必须引用一个JDBC配置池。一个以上的JDBC请求可以引用同一个池。
</p><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><img src="../../docs/images/screenshots/jdbctest/jdbc-config.png"><br>
<font size="-1">图6.3。JDBC配置</font></td></tr></tbody></table>
<p>再次选择JDBC Users元素。单击鼠标右键获得“ <b>添加”</b>菜单，然后选择“ <span class="menuchoice"><span class="guimenuitem">添加”</span> →“ <span class="guimenuitem">采样器”</span> →“ <span class="guimenuitem">JDBC请求”</span></span> 。然后，选择此新元素以查看其控制面板（请参见图6.4）。</p><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><img src="../../docs/images/screenshots/jdbctest/JDBCRequest.png"><br>
<font size="-1">图6.4。JDBC请求</font></td></tr></tbody></table>
<p>在我们的测试计划中，我们将提出两个JDBC请求。第一个用于选择所有“正在运行”的VM实例，第二个用于选择“正在删除”的VM实例（显然，您应将其更改为适合您的特定数据库的示例）。这些说明如下。</p><p>
</p><table border="1" bgcolor="#bbbb00" width="50%" cellspacing="0" cellpadding="2">
<tbody><tr><td>JMeter按照将请求添加到树中的顺序发送请求。</td></tr>
</tbody></table>
<p></p>
<p>首先编辑以下属性（请参见图6.5）：</p><ul>
<li>将名称更改为“ <tt class="code">VM Running</tt> ”。</li>
<li>输入池名称：“ <tt class="code">myDatabase</tt> ”（与配置元素中的相同）</li>
<li>输入“ SQL查询字符串”字段。</li>
<li>在参数值字段输入“ <tt class="code">运行</tt> ”值。</li>
<li>用“ <tt class="code">VARCHAR</tt> ”输入参数类型。</li>
</ul>
<p></p><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><img src="../../docs/images/screenshots/jdbctest/JDBCRequest2.png"><br>
<font size="-1">图6.5。第一个SQL请求的JDBC请求</font></td></tr></tbody></table>
<p>接下来，添加第二个JDBC Request并编辑以下属性（请参见图6.6）：</p><ul>
<li>将名称更改为“ <tt class="code">VM Expunging</tt> ”。</li>
<li>将参数值的值更改为“ <tt class="code">Expunging</tt> ”。</li>
</ul>
<p></p><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><img src="../../docs/images/screenshots/jdbctest/JDBCRequest3.png"><br>
<font size="-1">图6.6。JDBC请求第二个请求</font></td></tr></tbody></table>
</blockquote>
<p></p>
</td></tr>
<tr><td><br></td></tr>
</tbody></table>
<table border="0" cellspacing="0" cellpadding="2" width="100%">
<tbody><tr><td bgcolor="#525D76">
<font color="#ffffff" face="arial,helvetica,sanserif">
<a name="adding_listener"><strong>6.3添加侦听器以查看/存储测试结果</strong></a></font>
</td></tr>
<tr><td>
<blockquote>
<p>您需要添加到测试计划中的最后一个元素是<a href="component_reference.html#listeners">Listener</a> 。该元素负责将JDBC请求的所有结果存储在文件中并显示结果。</p><p>选择<i>JDBC Users</i>元素并添加一个<a href="../usermanual/component_reference.html#Summary_Report">摘要报告</a>侦听器（ <span class="menuchoice"><span class="guimenuitem">添加</span> → <span class="guimenuitem">侦听器</span> → <span class="guimenuitem">摘要报告</span></span> ）。</p><p>保存测试计划，然后使用菜单<span class="menuchoice"><span class="guimenuitem">运行</span> → <span class="guimenuitem">开始</span></span>或<span class="keycombo"><span class="keysym">Ctrl</span> + <span class="keysym">R</span></span>运行测试
</p><p>侦听器显示结果。</p><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><img src="../../docs/images/screenshots/jdbctest/jdbc-results.png"><br>
<font size="-1">图6.7。图结果侦听器</font></td></tr></tbody></table>
</blockquote>
<p></p>
</td></tr>
<tr><td><br></td></tr>
</tbody></table>
<br>
<table>
<tbody><tr>
<td bgcolor="#525D76">
<div align="right"><a href="index.html"><font size="-1" color="#ffffff" face="arial,helvetica,sanserif">指数</font></a></div>
</td>
<td bgcolor="#525D76">
<div align="right"><a href="build-ftp-test-plan.html"><font size="-1" color="#ffffff" face="arial,helvetica,sanserif">下一个</font></a></div>
</td>
<td bgcolor="#525D76">
<div align="right"><a href="build-adv-web-test-plan.html"><font size="-1" color="#ffffff" face="arial,helvetica,sanserif">上一个</font></a></div>
</td>
</tr>
</tbody></table>
</td>
</tr>
<tr><td>
<hr noshade size="1">
</td></tr>
<tr>
<td>
<table width="100%">
<tbody><tr>
<td>
<font color="#525D76" size="-1"><em>版权所有©1999-2019，Apache软件基金会</em></font>
</td>
<td align="right">
<font color="#525D76" size="-1"><em>$ Id $</em></font>
</td>
</tr>
<tr><td colspan="2">
<div align="center"><font color="#525D76" size="-1">Apache，Apache JMeter，JMeter，Apache Feather和Apache JMeter徽标是Apache Software Foundation的商标。
</font>
</div>
</td></tr>
</tbody></table>
</td>
</tr>
</tbody></table>


<!-- end the processing -->














































</body></html>