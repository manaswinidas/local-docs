<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=0">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="Migrating from Tomcat to Geronimo">
    <meta name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Migrating from Tomcat to Geronimo">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2010-05-11">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0文档：从Tomcat迁移到Geronimo</title>
  </head>

  <body  onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">主页</a> > <a href="documentation.html">文档</a> > <a href="migrating-to-apache-geronimo.html">迁移到Apache Geronimo</a> > <a href="migrating-from-tomcat-to-geronimo.html">从Tomcat迁移到Geronimo</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo v3.0</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">从Tomcat迁移到Geronimo</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645425"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645425">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645425"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645425">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645425"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645425">添加新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>
<p>Tomcat是Apache产品系列提供的Web容器。它实现了Java Servlet 3.0 API和Java Server Pages（JSP）2.2 API。 Apache Geronimo是经过Java EE6 Web概要认证的应用程序服务器，它预先集成了Apache Tomcat和Apache OpenEJB。因此，在使用Geronimo时，您将使用与独立版本的Tomcat相同的Tomcat引擎。但是，我们将在接下来的部分中讨论一些差异</p>

<h1 id="MigratingfromTomcattoGeronimo-ImplementationAnalysis">实施分析</h1>
<p>使用Geronimo时，您将使用与独立Tomcat相同的Tomcat。本节将列举Geronimo和Tomcat之间的基本差异/相似之处</p>
<ol><li>两者都实现Servlet 3.0和JSP 2.2 API</li><li>必须在server.xml中为Tomcat手动配置JNDI，而在Geronimo中，JNDI可以访问Geronimo内核管理的所有对象引用。</li><li>在Tomcat的server.xml中手动配置了JMS，而在Geronimo中，可以通过基于GUI的管理控制台来实现JMS。</li><li>JDBC是在server.xml中为Tomcat手动配置的，而在Geronimo中，可以通过基于GUI的管理控制台来实现</li><li>web.xml是两个服务器的默认部署描述符</li><li>Geronimo具有特定于容器的部署描述符，也称为部署计划，而Tomcat没有任何特定于容器的部署描述符</li></ol>


<p>在Geronimo中，大多数配置可以使用部署计划来完成<code>geronimo-web.xml</code> ， <code>config.xml</code>要么<code>config-substitution.properties</code>文件。使用基于Web的管理控制台可以轻松实现添加资源（例如JMS队列，连接工厂，JDBC数据源等）的功能。相对于使用手动配置，这简化了配置管理<code>server.xml</code>和<code>context.xml</code>在Tomcat中。</p>

<h1 id="MigratingfromTomcattoGeronimo-BestPractices">最佳实践</h1>
<p>为了解决大多数与迁移有关的问题，您必须弄清楚每个服务如何在Tomcat中映射并应用于Apache Geronimo。在这方面的方案将被征募。</p>

<h2 id="MigratingfromTomcattoGeronimo-Tomcatonlyapplication">仅限Tomcat应用程序</h2>
<p>在这种情况下，您可能有一些servlet，JSP已添加到您的应用程序中。您可能还配置了安全领域，Tomcat特定的功能（如JSP重新加载等）。</p>
<ul><li>Servlet和JSP的代码将与Tomcat和Geronimo一起很好地工作。因此，这部分不需要任何修改。</li><li>在Tomcat中，您可能已经在<code>server.xml</code> ，还可以使用添加管理员，管理员角色<code>tomcat-users.xml</code>文件。在Geronimo中，可以通过添加以下标签来实现相同的目的<code><security-realm-name>geronimo-admin</security-realm-name> <sec:security> </sec:security></code> in {{geronimo-web.xml}}中（Geronimo特定的部署描述符也称为部署计划）。通过使用Web控制台中的“ <strong>安全性”>“安全领域”</strong>菜单，可以将用户和组添加到默认领域。</li><li>在Tomcat中，您可能已为应用程序配置了上下文级别属性，例如<code><Context cachingAllowed="true"/></code> 。在Geronimo中，可以通过添加以下标签来实现相同的目的<code><contextAttributes cachingAllowed="true"></code>在<code>geronimo-web.xml</code> 。但是请注意，部署计划不支持诸如<strong>className</strong> ， <strong>xmlNamespaceAware</strong> ， <strong>processTlds</strong> ， <strong>unpackWAR</strong> ， <strong>xmlValidation</strong> ， <strong>path</strong> ， <strong>useNaming</strong> ， <strong>javaVMS</strong> ， <strong>server</strong> ， <strong>j2EEApplication</strong> ， <strong>j2EEServer</strong> ， <strong>委托</strong>和<strong>docBase之</strong>类的属性，因为Geronimo明确定义了这些属性或只是不定义这些属性支持<strong>unpackWAR</strong>之类的属性。</li></ul>


<h2 id="MigratingfromTomcattoGeronimo-TomcatandApacheDerby">Tomcat和Apache Derby</h2>
<p>为了使Tomcat与Apache Derby一起使用，您必须下载Apache Derby并配置环境变量（如DERBY_INSTALL），并确保以下jar位于类路径中：</p>
<ul><li>lib / derby.jar</li><li>lib / derbytools.jar</li><li>lib / derbynet.jar</li><li>lib / derbyclient.jar<br clear="none">要执行sql命令，您必须使用Apache Derby随附的<strong>ij</strong>脚本。</li></ul>


<p>关于Apache Geronimo，您不必设置环境变量或类路径。Geronimo对此进行了处理。使用基于Web的管理控制台可以轻松实现创建数据库表和数据库池。但是，您必须包括一个<code><dependency> </dependency></code>标签和<code><resource-ref> </resource-ref></code>标记在<code>geronimo-web.xml</code>以便资源对已部署的应用程序可见。<br clear="none">在仅Tomcat的应用程序部分中提出的所有其他建议在这种情况下同样有效。</p>


<h2 id="MigratingfromTomcattoGeronimo-TomcatandApacheAXIS">Tomcat和Apache AXIS</h2>
<p>为了使Tomcat运行，必须在CLASSPATH环境变量中包括以下元素。如果您已在Eclipse中设置了开发环境，则可以在Eclipse中自动下载下面提到的jar。只需添加一个即可轻松实现<code>.wsdl</code>文件，并使用<strong>Eclipse WSDL to Java工具</strong>生成所有必需的工件，包括Java类。</p>
<ul><li>wsdl4j-1.5.1.jar</li><li>saaj.jar</li><li>jaxrpc.jar</li><li>axis.jar</li></ul>


<p>关于Apache Geronimo，您不必在类路径中设置上面提到的任何库，因为这些库是预先集成的。</p>

<h2 id="MigratingfromTomcattoGeronimo-TomcatandApacheActiveMQ">Tomcat和Apache ActiveMQ</h2>
<p>对于Tomcat，请确保已安装Apache ActiveMQ。在CLASSPATH环境变量中包括以下元素。您必须在以下位置指定队列和连接工厂的JMS资源： <code>context.xml</code>可以在Tomcat安装中使用<code><Resource> </Resource></code>标签。接下来，您使用以下命令指定资源引用，消息目标引用和消息目标<code><resource-ref>, <message-destination-ref>, <message-destination></code>标记在<code>web.xml</code> 。</p>

<ul><li>lib / activeio-core-3.0.0-incubator.jar</li><li>lib / commons-logging-1.1.jar</li><li><activemq_home>/apache-activemq-4.1.1.jar</activemq_home></li></ul>


<p>通过运行<strong>activemq.bat</strong>脚本来启动ActiveMQ代理。该脚本可以在<activemq_home>/ bin中</activemq_home>找到</p>

<p>在Geronimo中，可以使用基于GUI的Web控制台轻松创建连接工厂和队列。ActiveMQ在服务器启动时自动启动。提到的jar不再需要，应该从ClassPath中删除。但是，您必须使用以下命令包含ActiveMQ依赖项<code><dependency> </dependency></code>标签，资源引用使用<code><resource-ref> </resource-ref></code>标签和消息目标使用<code><message-destination> </message-destination></code> geronimo-web.xml中的标签。</p>

<h2 id="MigratingfromTomcattoGeronimo-Configurationsinserver.xml">server.xml中的配置</h2>
<ol><li>如果您在其中修改了端口<code>server.xml</code>用于Tomcat的安装，并且您希望通过Geronimo达到相同的目的。这可以通过修改来完成<code>config-substitution.properties</code>在<geronimo_home>/var/log/config-substitution.properties中可用<geronimo_home>。<em>中的PortOffset</em>变量<code>config-substitution.properties</code>可用于一次性修改所有端口，也可将每个端口配置为自定义值。</geronimo_home></geronimo_home></li><li>对于Tomcat中其余的特定配置，请参见<code>server.xml</code> ，您可以在Geronimo中不变地使用它们。复制<code>server.xml</code>文件从Tomcat到<geronimo_home>/ var / Catalina目录。</geronimo_home></li></ol>


<h2 id="MigratingfromTomcattoGeronimo-Removeunneededjars">取出不需要的罐子</h2>
<p>对于Tomcat，您可能在WEB-INF / lib中的应用程序中包含了各种jar。这些罐子中的大多数已经存在于Geronimo中，可以从应用程序中删除。这还将使您的应用程序大小减少到Geronimo中的几个KB，如果是Tomcat，则为MB。而且，通过删除这些jar，不再需要开发人员支持和集成这些jar。</p>

<h2 id="MigratingfromTomcattoGeronimo-DoNotwanttoremovejars">不想删除罐子</h2>
<p>如果您不想从当前环境中删除罐子。也许您想使用您的jar版本，而Geronimo附带了其他版本的jar。在那种情况下，Geronimo也提供了简单的配置。您可以配置geronimo-web.xml来添加<code><inverse-classloading/></code>标签。使用此标签，类加载层次结构将更改为“子优先”。</p>

<h2 id="MigratingfromTomcattoGeronimo-JSPReloading">JSP重装</h2>
<p>如果您已经配置了Tomcat用于JSP重装，那么您可能希望在Geronimo中使用相同的功能。在Geronimo中，可以通过编辑<geronimo_home>/var/catalina/conf/web.xml</geronimo_home>轻松实现<geronimo_home>。</geronimo_home></p>

<p>搜索<code><servlet-class>org.apache.jasper.servlet.JspServlet </servlet-class></code>并在servlet类下添加以下元素</p>
<parameter ac:name="borderStyle">固体</parameter> <parameter ac:name="title">添加XML片段加到web.xml</parameter> <plain-text-body><init-param><param-name>发展</param-name> <param-value>真正</param-value></init-param> <init-param><param-name>modificationTestInterval</param-name> <param-value>10</param-value></init-param></plain-text-body>
<p>ModifyTestInterval是以秒为单位的时间。</p>

<h2 id="MigratingfromTomcattoGeronimo-PersistJSPCompilation">坚持JSP编译</h2>
<p>如果将Tomcat服务器配置为在服务器重新启动之间持久保留JSP编译，则也可以为其配置Geronimo。您可以通过两种方式在Geronimo中进行配置。</p>

<h3 id="MigratingfromTomcattoGeronimo-Serverscoped">服务器范围</h3>
<p>使用此方法，可以在服务器重新启动后保留服务器中运行的所有Web应用程序的已编译JSP。编辑<geronimo_home>/var/catalina/conf/web.xml。搜索<code>org.apache.jasper.servlet.JspServlet</code>并添加以下元素</geronimo_home></p>
<parameter ac:name="borderStyle">固体</parameter> <parameter ac:name="title">添加XML片段加到web.xml</parameter> <plain-text-body><init-param><param-name>scratchdir</param-name> <param-value>../var/catalina/temp</param-value></init-param> <init-param><param-name>keepgenerated</param-name> <param-value>假</param-value></init-param></plain-text-body>
<p>创建目录<geronimo_home>/ var / catalina / temp。所有的Web应用程序都将被编译并存储在temp目录中。这些将在服务器重新启动后持续存在。</geronimo_home></p>

<h3 id="MigratingfromTomcattoGeronimo-Applicationscoped">应用范围</h3>
<p>在应用程序中配置Web部署描述符web.xml，如下所示</p>
<parameter ac:name="borderStyle">固体</parameter> <parameter ac:name="title">添加XML片段web.xml中</parameter> <plain-text-body><servlet><servlet-name>的jsp</servlet-name> <servlet-class>org.apache.jasper.servlet。JspServlet</servlet-class> <init-param><param-name>发展</param-name> <param-value>假</param-value></init-param> <init-param><param-name>叉</param-name> <param-value>假</param-value></init-param> <init-param><param-name>scratchdir</param-name> <param-value>../var/catalina/temp</param-value></init-param> <init-param><param-name>keepgenerated</param-name> <param-value>假</param-value></init-param> <init-param><param-name>xpoweredBy</param-name> <param-value>假</param-value></init-param> <init-param><param-name>engineOptionsClass</param-name> <param-value>org.apache.geronimo.jasper。JspServletOptions</param-value></init-param> <load-on-startup>3</load-on-startup></servlet> <servlet-mapping><servlet-name>jsp</servlet-name> <url-pattern>* .jsp</url-pattern></servlet-mapping> <servlet-mapping><servlet-name>jsp</servlet-name> <url-pattern>* .jspx</url-pattern></servlet-mapping>
</plain-text-body>
<p><geronimo_home>在这种情况下，</geronimo_home>您还需要创建<geronimo_home>/ var / catalina / temp目录。</geronimo_home></p>

<h1 id="MigratingfromTomcattoGeronimo-References">参考文献</h1>
<p>从Tomcat迁移到Geronimo时，以下资源很有用<br clear="none">1）学习使用方法<code>inverse-classloading</code> <a shape="rect" class="external-link" href="http://geronimo.apache.org/schemas-2.1/docs/geronimo-module-1.2.xsd.html">-http://geronimo.apache.org/schemas-2.1/docs/geronimo-module-1.2.xsd.html</a> 。您可能还想了解有关依赖项，隐藏类，不可覆盖类的更多信息。所有这些元素将有助于修改geronimo-web.xml。<br clear="none">2）了解如何使用apache geronimo配置JMS- <a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDOC30/web-application-for-jms-access.html">http://cwiki.apache.org/GMOxDOC30/web-application-for-jms-access.html</a><br clear="none">3）了解如何使用apache geronimo配置JDBC- <a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDOC30/web-application-for-jdbc-access.html">http://cwiki.apache.org/GMOxDOC30/web-application-for-jdbc-access.html</a><br clear="none">4）有关安全性的主题，您可以参考-http <a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDOC30/Administering-security.html">://cwiki.apache.org/GMOxDOC30/Administering-security.html</a><br clear="none">5）有关配置各种服务的更多信息-JMS，JDBC <a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDOC30/configuring-services.html">http://cwiki.apache.org/GMOxDOC30/configuring-services.html</a></p></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Migrating from Tomcat to Geronimo';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2013，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  

</body></html>