<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link type="text/css" rel="stylesheet" href="http://geronimo.apache.org/style/default.css">
    <LINK rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <META name="Description" content="Migrating from Tomcat to Geronimo" />
    <META name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Migrating from Tomcat to Geronimo" />
    <META name="Owner" content="dev@geronimo.apache.org" />
    <META name="Robots" content="index, follow" />
    <META name="Security" content="Public" />
    <META name="Source" content="wiki template" />
    <META name="DC.Date" scheme="iso8601" content="2010-05-11" />
    <META name="DC.Language" scheme="rfc1766" content="en" />
    <META name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation" />
    <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0 Documentation: Migrating from Tomcat to Geronimo</title>
  </head>

  <body onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tr>
        <td valing="top" align="left">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" align="left" nowrap>
          <a href="/geronimo"> Home</a> >&nbsp;<a href="documentation.html">Documentation</a>&nbsp;&gt;&nbsp;<a href="migrating-to-apache-geronimo.html">Migrating to Apache Geronimo</a>&nbsp;&gt;&nbsp;<a href="migrating-from-tomcat-to-geronimo.html">Migrating from Tomcat to Geronimo</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8" />
            <input type="hidden" name="oe" value="UTF-8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
        </td>
      </tr> 
    </table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div style="margin: 0px 10px 0px 10px" class="smalltext">Apache Geronimo v3.0</div>
        <div style="margin: 0px 10px 8px 10px"  class="pagetitle">Migrating from Tomcat to Geronimo</div>

        <div class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
<!-- -->         
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645425">
            <img src="http://geronimo.apache.org/images/icons/notep_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Edit Page"></a>
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645425">Edit Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">
            <img src="http://geronimo.apache.org/images/icons/browse_space.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Browse Space"></a>
            <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">Browse Space</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645425">
            <img src="http://geronimo.apache.org/images/icons/add_page_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add Page"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645425">Add Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645425">
            <img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add News"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645425">Add News</a>
<!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>
<p>Tomcat is a Web Container available with Apache product family. It implements Java Servlet 3.0 API and Java Server Pages (JSP) 2.2 API. Apache Geronimo is a Java EE6 Web profile certified application server with Apache Tomcat, Apache OpenEJB pre-integrated. As a result, while working with Geronimo you will be working with same Tomcat engine as the standalone version of Tomcat. However there are some differences which we will discuss in upcoming sections</p>

<h1 id="MigratingfromTomcattoGeronimo-ImplementationAnalysis">Implementation Analysis</h1>
<p>While working with Geronimo you will be working with same Tomcat as the standalone Tomcat. This section will enlist the basic differences/similarities between Geronimo and Tomcat</p>
<ol><li>Both implements servlet 3.0 and JSP 2.2 API's</li><li>JNDI has to be configured manually in server.xml for Tomcat whereas in Geronimo, JNDI has access to all the object references managed by Geronimo kernel</li><li>JMS is configured manually in server.xml for Tomcat whereas in Geronimo same can be achieved by GUI based Administrative Console</li><li>JDBC is configured manually in server.xml for Tomcat whereas in Geronimo same can be achieved by GUI based Administrative Console</li><li>web.xml is the default deployment descriptor for both servers</li><li>Geronimo has container specific deployment descriptors also know as deployment plans whereas Tomcat does not have any container specific deployment descriptor</li></ol>


<p>In Geronimo most of the configuration can be done using the deployment plan <code>geronimo-web.xml</code>, <code>config.xml</code> or <code>config-substitution.properties</code> files. Adding resources, such as JMS queues, connection factory, JDBC datasource and so on, can be easily achieved using web based Administrative console. This simplifies the configuration management versus the manual configuration done using <code>server.xml</code> and <code>context.xml</code> in Tomcat.</p>

<h1 id="MigratingfromTomcattoGeronimo-BestPractices">Best Practices</h1>
<p>In order to overcome most migration related issues you must figure out how each service is mapped within Tomcat and applied to Apache Geronimo. The scenarios in this regard will be enlisted.</p>

<h2 id="MigratingfromTomcattoGeronimo-Tomcatonlyapplication">Tomcat only application</h2>
<p>In this case you might have some servlet, JSP's added to your application. You might have also configured security realms, Tomcat specific features like JSP reloading etc. </p>
<ul><li>Servlet and JSP's code will work equally well with Tomcat and Geronimo. So there are no modifications required on this part.</li><li>In Tomcat you may have configured security realms in <code>server.xml</code>, also an admin, manager roles can be added using <code>tomcat-users.xml</code> file. In Geronimo same can be achieved by adding the following tags <code>&lt;security-realm-name&gt;geronimo-admin&lt;/security-realm-name&gt; &lt;sec:security&gt; &lt;/sec:security&gt;</code> in{{ geronimo-web.xml}} (Geronimo specific deployment descriptor also known as deployment plan). Users and Groups can be added to the default realm by using the <strong>Security&gt;Security Realm</strong> menu from the Web console.</li><li>In Tomcat you may have configured context level attributes for your application such as <code>&lt;Context cachingAllowed="true"/&gt;</code>. In Geronimo same can be achieved by adding the following tags <code>&lt;contextAttributes cachingAllowed="true"&gt;</code> in <code>geronimo-web.xml</code>. But be bewared that attributes such as <strong>className</strong>,<strong>xmlNamespaceAware</strong>,<strong>processTlds</strong>,<strong>unpackWAR</strong>,<strong>xmlValidation</strong>,<strong>path</strong>,<strong>useNaming</strong>,<strong>javaVMS</strong>,<strong>server</strong>,<strong>j2EEApplication</strong>,<strong>j2EEServer</strong>,<strong>delegate</strong> and <strong>docBase</strong> are not supported in the deployment plan because Geronimo defines those attributes explicitly or just doesn't support the attribute such as <strong>unpackWAR</strong>.</li></ul>


<h2 id="MigratingfromTomcattoGeronimo-TomcatandApacheDerby">Tomcat and Apache Derby</h2>
<p>For Tomcat to work with Apache Derby you must download Apache Derby and configure environment variables like DERBY_INSTALL, and make sure that the following jars are in the classpath:</p>
<ul><li>lib/derby.jar</li><li>lib/derbytools.jar</li><li>lib/derbynet.jar</li><li>lib/derbyclient.jar<br clear="none">
To execute a sql command you have to use <strong>ij</strong> script which comes packaged with Apache Derby.</li></ul>


<p>With regards to Apache Geronimo, you don't have to set up environment variables or classpath. This is taken care of by Geronimo. Creating database tables and database pools can be easily achieved by using web based Administrative Console. However you have to include a <code>&lt;dependency&gt; &lt;/dependency&gt;</code> tag and <code>&lt;resource-ref&gt; &lt;/resource-ref&gt;</code> tag in <code>geronimo-web.xml</code> so that the resources are visible to the deployed applications.<br clear="none">
All the other suggestions made in Tomcat-only application section is equally valid in this scenario as well.</p>


<h2 id="MigratingfromTomcattoGeronimo-TomcatandApacheAXIS">Tomcat and Apache AXIS</h2>
<p>For Tomcat to work, you must include the following elements in your CLASSPATH environment variable. The jars mentioned below can be automatically downloaded within Eclipse if you have set up the development environment in Eclipse. This can be easily achieved by adding a <code>.wsdl</code> file in your application and using <strong>Eclipse WSDL to Java tool</strong> to generate all the required artifacts including your java classes.</p>
<ul><li>wsdl4j-1.5.1.jar</li><li>saaj.jar</li><li>jaxrpc.jar</li><li>axis.jar</li></ul>


<p>With regards to Apache Geronimo, you don't have to set any of the libraries mentioned above in your classpath as these are pre-integrated.</p>

<h2 id="MigratingfromTomcattoGeronimo-TomcatandApacheActiveMQ">Tomcat and Apache ActiveMQ</h2>
<p>with Tomcat, make sure you have Apache ActiveMQ installed. Include the following elements in your CLASSPATH environment variable. You must specify the JMS resources that is queue and connection factory in <code>context.xml</code> available with Tomcat installation using the <code>&lt;Resource&gt; &lt;/Resource&gt;</code> tags. Next you specify the resource reference, message destination reference and message destination using <code>&lt;resource-ref&gt;, &lt;message-destination-ref&gt;, &lt;message-destination&gt;</code> tag in <code>web.xml</code>. </p>

<ul><li>lib/activeio-core-3.0.0-incubator.jar</li><li>lib/commons-logging-1.1.jar</li><li>&lt;ActiveMQ_HOME&gt;/apache-activemq-4.1.1.jar</li></ul>


<p>Start the ActiveMQ broker by running the <strong>activemq.bat</strong> script. This script can be found in &lt;ActiveMQ_HOME&gt;/bin</p>

<p>In Geronimo, connection factory and queue can be easily created using the GUI based web console. ActiveMQ is automatically started on server start. The jars mentioned are no longer required and should be removed from ClassPath. However you must include an ActiveMQ dependency using <code>&lt;dependency&gt; &lt;/dependency&gt;</code> tags, resource references using <code>&lt;resource-ref&gt; &lt;/resource-ref&gt;</code> tags and message destination using <code>&lt;message-destination&gt; &lt;/message-destination&gt;</code> tags in geronimo-web.xml.</p>

<h2 id="MigratingfromTomcattoGeronimo-Configurationsinserver.xml">Configurations in server.xml</h2>
<ol><li>In case you have modified ports in <code>server.xml</code> for your Tomcat installation and you want to achieve the same with Geronimo. This can be done by modifying <code>config-substitution.properties</code> available in &lt;GERONIMO_HOME&gt;/var/log/config-substitution.properties. <em>PortOffset</em> variable in <code>config-substitution.properties</code> can be used to modify all the ports in one go or else each port can be configured to custom values.</li><li>For the rest of Tomcat specific configurations in <code>server.xml</code>, you can use them unchanged in Geronimo. Copy the <code>server.xml</code> file from Tomcat to &lt;Geronimo_HOME&gt;/var/Catalina directory.</li></ol>


<h2 id="MigratingfromTomcattoGeronimo-Removeunneededjars">Remove unneeded jars</h2>
<p>In the case of Tomcat, you might have included various jars in your application in WEB-INF/lib. Most of these jars are already present in Geronimo and can be removed from the application. This will also reduce the size of your application to few KBs in Geronimo which would have been MBs in case of Tomcat. Also, by removing these jars, developers are no longer required to support and integrate these jars.</p>

<h2 id="MigratingfromTomcattoGeronimo-DoNotwanttoremovejars">Do Not want to remove jars</h2>
<p>In case you don't want to remove jars from your current environment. Maybe you want to use your version of jars and Geronimo ships a different version of jars. In that case Geronimo also provides an easy configuration. You can configure geronimo-web.xml to add <code>&lt;inverse-classloading/&gt;</code> tag. Using this tag the classloading hierarchy will change to Child First.</p>

<h2 id="MigratingfromTomcattoGeronimo-JSPReloading">JSP Reloading</h2>
<p>If you have configured Tomcat for JSP reloading, then you might want the same in Geronimo. This can be easily achieved in Geronimo by editing &lt;geronimo_home&gt;/var/catalina/conf/web.xml.</p>

<p>Search for <code>&lt;servlet-class&gt;org.apache.jasper.servlet.JspServlet &lt;/servlet-class&gt;</code> and add the following elements under the servlet class</p>
<parameter ac:name="borderStyle">solid</parameter><parameter ac:name="title">Add the XML snippet to web.xml</parameter><plain-text-body>
&lt;init-param&gt;
&lt;param-name&gt;development&lt;/param-name&gt;
&lt;param-value&gt;true&lt;/param-value&gt;
&lt;/init-param&gt;

&lt;init-param&gt;
&lt;param-name&gt;modificationTestInterval&lt;/param-name&gt;
&lt;param-value&gt;10&lt;/param-value&gt;
&lt;/init-param&gt;
</plain-text-body>
<p>modificationTestInterval is time in seconds.</p>

<h2 id="MigratingfromTomcattoGeronimo-PersistJSPCompilation">Persist JSP Compilation</h2>
<p>If your Tomcat server is configured to persist JSP compilation between server restarts then you can configure Geronimo as well for the same. There are two ways you can configure this in Geronimo.</p>

<h3 id="MigratingfromTomcattoGeronimo-Serverscoped">Server scoped</h3>
<p>Using this you can retain the compiled JSPs of all Web applications running in the server across server restarts. Edit &lt;geronimo_home&gt;/var/catalina/conf/web.xml. Search for <code>org.apache.jasper.servlet.JspServlet</code> and add the following elements</p>
<parameter ac:name="borderStyle">solid</parameter><parameter ac:name="title">Add the XML snippet to web.xml</parameter><plain-text-body>
&lt;init-param&gt;
&lt;param-name&gt;scratchdir&lt;/param-name&gt;
&lt;param-value&gt;
   ../var/catalina/temp
&lt;/param-value&gt;
&lt;/init-param&gt;
&lt;init-param&gt;
&lt;param-name&gt;keepgenerated&lt;/param-name&gt;
&lt;param-value&gt;false&lt;/param-value&gt;
&lt;/init-param&gt;
</plain-text-body>
<p>Create a directory &lt;geronimo_home&gt;/var/catalina/temp. All the web applications will be compiled and stored in temp directory. These will persist over server restarts.</p>

<h3 id="MigratingfromTomcattoGeronimo-Applicationscoped">Application scoped</h3>
<p>Configure the web deployment descriptor web.xml in application as follows</p>
<parameter ac:name="borderStyle">solid</parameter><parameter ac:name="title">Add the XML snippet to web.xml</parameter><plain-text-body>
&lt;servlet&gt;
&lt;servlet-name&gt;jsp&lt;/servlet-name&gt;
&lt;servlet-class&gt;
  org.apache.jasper.servlet.JspServlet
&lt;/servlet-class&gt;
&lt;init-param&gt;
  &lt;param-name&gt;development&lt;/param-name&gt;
  &lt;param-value&gt;false&lt;/param-value&gt;
&lt;/init-param&gt;
&lt;init-param&gt;
  &lt;param-name&gt;fork&lt;/param-name&gt;
  &lt;param-value&gt;false&lt;/param-value&gt;
&lt;/init-param&gt;
&lt;init-param&gt;
  &lt;param-name&gt;scratchdir&lt;/param-name&gt;
  &lt;param-value&gt;
   ../var/catalina/temp
  &lt;/param-value&gt;
&lt;/init-param&gt;
&lt;init-param&gt;
  &lt;param-name&gt;keepgenerated&lt;/param-name&gt;
  &lt;param-value&gt;false&lt;/param-value&gt;
&lt;/init-param&gt;
&lt;init-param&gt;
  &lt;param-name&gt;xpoweredBy&lt;/param-name&gt;
   &lt;param-value&gt;false&lt;/param-value&gt;
&lt;/init-param&gt;
&lt;init-param&gt;
   &lt;param-name&gt;engineOptionsClass&lt;/param-name&gt;
   &lt;param-value&gt;
      org.apache.geronimo.jasper.JspServletOptions
   &lt;/param-value&gt;  
&lt;/init-param&gt;
  &lt;load-on-startup&gt;3&lt;/load-on-startup&gt;
&lt;/servlet&gt;
&lt;servlet-mapping&gt;
  &lt;servlet-name&gt;jsp&lt;/servlet-name&gt;
  &lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
&lt;servlet-mapping&gt;
  &lt;servlet-name&gt;jsp&lt;/servlet-name&gt;
  &lt;url-pattern&gt;*.jspx&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
</plain-text-body>
<p>You need to create the &lt;geronimo_home&gt;/var/catalina/temp directory in this case as well.</p>

<h1 id="MigratingfromTomcattoGeronimo-References">References</h1>
<p>Following resources can be useful while migrating from Tomcat to Geronimo<br clear="none">
1) Learn how to use <code>inverse-classloading</code> - <a shape="rect" class="external-link" href="http://geronimo.apache.org/schemas-2.1/docs/geronimo-module-1.2.xsd.html">http://geronimo.apache.org/schemas-2.1/docs/geronimo-module-1.2.xsd.html</a>. You may also want to know more on dependencies, hidden-classes, non-overridable-classes. These all elements will be helpful in modifying the geronimo-web.xml.<br clear="none">
2) Learn how to configure JMS with apache geronimo - <a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDOC30/web-application-for-jms-access.html">http://cwiki.apache.org/GMOxDOC30/web-application-for-jms-access.html</a><br clear="none">
3) Learn how to configure JDBC with apache geronimo- <a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDOC30/web-application-for-jdbc-access.html">http://cwiki.apache.org/GMOxDOC30/web-application-for-jdbc-access.html</a><br clear="none">
4) For security related topics you can refer- <a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDOC30/Administering-security.html">http://cwiki.apache.org/GMOxDOC30/Administering-security.html</a><br clear="none">
5) More on configuring various services- JMS, JDBC <a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDOC30/configuring-services.html">http://cwiki.apache.org/GMOxDOC30/configuring-services.html</a></p></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tr>
          <td align="left" valign="middle" class="footer">
            &nbsp;&nbsp;
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="Delicious" />
            <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">Bookmark this on Delicious</a>
            &nbsp;&nbsp;
            <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="Digg!" />
            <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)+'&amp;topic=programming');">Digg this</a>
            <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Migrating from Tomcat to Geronimo';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
            &nbsp;&nbsp;
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;-&nbsp;&nbsp;
            Copyright &#169; 2003-2013, The Apache Software Foundation, Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0.</a>&nbsp;&nbsp;
          </td>
        </tr>
    </table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  </body>
</html>
