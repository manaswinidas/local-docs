<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=0">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="Deploying and running JPA application client">
    <meta name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Deploying and running JPA application client">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2010-05-11">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0文档：部署和运行JPA应用程序客户端</title>
  </head>

  <body  onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">主页</a> > <a href="documentation.html">文档</a> > <a href="developing.html">开发</a> > <a href="tutorials.html">教程</a> > <a href="developing-application-clients.html">开发应用程序客户端</a> > <a href="deploying-and-running-jpa-application-client.html">部署和运行JPA应用程序客户端</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo v3.0</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">部署和运行JPA应用程序客户端</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645241"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645241">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645241"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645241">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645241"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645241">新增新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><p>Java Persistence API（JPA）是EJB3.0规范（JSR220）下的新编程模型，用于管理Java EE和Java SE的持久性和对象/关系映射。使用JPA，开发人员可以轻松地开发Java应用程序，这些应用程序使用Java对象和映射在关系数据库管理系统上执行操作。这样，使用JPA开发的Java应用程序不仅可以跨不同平台移植，而且可以使用JPA提供的简单而强大的编程模型轻松开发应用程序。这极大地提高了应用程序在不断变化的数据库世界中的可维护性。JPA使应用程序与数据库连接和操作中涉及的所有复杂性和不可移植的样板代码隔离。</p>

<p>Apache Geronimo使用<a shape="rect" class="external-link" href="http://openjpa.apache.org/">Apache OpenJPA</a>向部署在服务器中的Java EE应用程序提供Java Persistence API实现。即使JPA是EJB3规范的一部分，它也独立于它。因此，JPA可以以相同的统一方式用于JavaSE，Web和ejb应用程序。考虑一下JPA实现，例如，将Apache OpenJPA作为JPA的驱动程序（JPA驱动程序）类似于JDBC的JDBC驱动程序。</p>

<p>下一节说明了如何开发和部署JEE应用程序客户端，该客户端使用JPA来访问和操作嵌入式derby数据库中的数据库数据。</p>

<p>为了开发，部署和运行该应用程序，需要以下环境。</p>

<ul><li>Sun JDK 5.0+（J2SE 1.5）</li><li>Eclipse 3.3.1.1（Europa发行版的Eclipse Classic软件包），特定于平台</li><li>Web工具平台（WTP）2.0.1</li><li>数据工具平台（DTP）1.5.1</li><li>Eclipse建模框架（EMF）2.3.1</li><li>图形编辑框架（GEF）3.3.1</li></ul>


<p>本文包括以下部分。</p>

<ul><li>设置Eclipse以进行应用程序开发</li><li>发展实体和客户</li><li>准备部署描述符和部署计划</li><li>部署应用程序客户端</li><li>运行应用程序客户端</li></ul>


<p>要下载完整的应用程序，请单击<a shape="rect" href="deploying-and-running-jpa-application-client.data/JPAAppClient.jar?version=1&modificationDate=1212102269000&api=v2" data-linked-resource-id="20873571" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="JPAAppClient.jar" data-nice-type="Java Archive" data-linked-resource-content-type="application/octet-stream" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5">链接</a></p>

<h2 id="DeployingandrunningJPAapplicationclient-SettingEclipseforApplicationdevelopment">设置Eclipse进行应用程序开发</h2>

<p>1。启动Eclipse IDE并创建<code>ApplicationClientJPA</code> java项目。<br clear="none">右键单击<em>Project Explorer</em>窗口，然后单击<em>New> Java Project</em> 。</p>

<p>   <span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/1.JPG" data-image-src="/confluence/download/attachments/20645241/1.JPG?version=1&modificationDate=1211841431000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873567" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="1.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>提供<code>ApplicationClientJPA</code>作为Java项目的名称。</p>

<p>   <span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/2.JPG" data-image-src="/confluence/download/attachments/20645241/2.JPG?version=1&modificationDate=1211841431000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873566" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="2.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>点击<em>完成</em> 。</p>

<p>右键单击项目，然后单击<em>属性</em>选项，这是菜单中的最后一个选项。</p>

<p>   <span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/11.JPG" data-image-src="/confluence/download/attachments/20645241/11.JPG?version=1&modificationDate=1211841466000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873569" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="11.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>这将打开“ <em>属性”</em>窗口。单击右侧的<em>Java Build Path => Libraries</em>选项卡。</p>

<p>   <span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/12.JPG" data-image-src="/confluence/download/attachments/20645241/12.JPG?version=1&modificationDate=1211841497000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873560" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="12.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>单击<em>添加外部JAR</em>按钮并浏览<code>geronimo-jpa_3.0_spec-1.1.1.jar</code>文件应该在<code><geronimo_home>/repository/org/apache/geronimo/specs/geronimo-jpa_3.0_spec/1.1.1</code> 。jar文件仅用于编译要创建的实体和实体客户端类。Geronimo在运行时提供jar。<br clear="none">选择文件，然后单击“ <em>打开”</em>按钮。</p>

<p>   <span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/13.JPG" data-image-src="/confluence/download/attachments/20645241/13.JPG?version=1&modificationDate=1211841497000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873561" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="13.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>这会将库添加到构建路径。单击<em>确定</em> 。</p>

<p>   <span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/14.JPG" data-image-src="/confluence/download/attachments/20645241/14.JPG?version=1&modificationDate=1211841497000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873559" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="14.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>2。创建<code>META-INF</code>项目中的文件夹。右键单击该项目，然后单击<em>新建>文件夹</em></p>

<p>   <span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/3.JPG" data-image-src="/confluence/download/attachments/20645241/3.JPG?version=1&modificationDate=1211841431000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873557" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="3.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>提供<code>META-INF</code>作为文件夹名称，然后单击<em>Finish</em> 。</p>

<p>   <span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/4.JPG" data-image-src="/confluence/download/attachments/20645241/4.JPG?version=1&modificationDate=1211841431000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873555" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="4.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>就这样！开发应用程序客户端所需的设置已结束。</p>

<h2 id="DeployingandrunningJPAapplicationclient-DevelopingEntitiesandtheClient">发展中的实体和客户</h2>
<p>1。右键单击该项目并创建一个<code>Account</code> java类如下。</p>

<p>    <span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/5.JPG" data-image-src="/confluence/download/attachments/20645241/5.JPG?version=1&modificationDate=1211841431000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873574" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="5.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>提供课程的名称为<code>Account</code>包名称为<code>sample.jpa.appclient</code> 。点击<em>完成</em> 。</p>

<p>    <span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/6.JPG" data-image-src="/confluence/download/attachments/20645241/6.JPG?version=1&modificationDate=1211841466000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873564" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="6.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>2。将以下内容复制到<code>Account.java</code> 。</p>

<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px;border-bottom-style:solid"><b>Account.java</b></div><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
package sample.jpa.appclient;

import java.io.Serializable;

import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.Table;

@Entity
@Table(name=&quot;Account1&quot;)
public class Account implements Serializable{

 private static final long serialVersionUID = 1L;

 @Id
 public int accountNo;
 public String name;
 public String address;
 public int branchCode;
 public double balance;

 public Account(){
  this.accountNo = 0;
  this.name = &quot;DUMMY&quot;;
  this.address = &quot;DUMMY&quot;;
  this.branchCode = 0;
 }
	
 public int getAccountNo() {
  return accountNo;
 }
 
 public void setAccountNo(int accountNo) {
  this.accountNo = accountNo;
 }
 
 public String getName() {
  return name;
 }
 
 public void setName(String name) {
  this.name = name;
 }
 
 public String getAddress() {
  return address;
 }
 
 public void setAddress(String address) {
  this.address = address;
 }
 
 public int getBranchCode() {
  return branchCode;
 }

 public void setBranchCode(int branchCode) {
  this.branchCode = branchCode;
 }

 public double getBalance() {
  return balance;
 }

 public void setBalance(double balance) {
  this.balance = balance;
 }

}
]]></script>
</div></div>

<p>3。同样，右键单击该项目并按名称创建另一个Java类<code>AccountClient.java</code> 。另外，提供相同的软件包名称<code>sample.jpa.appclient</code> 。</p>

<p>4。将以下内容复制到<code>AccountClient.java</code> 。</p>
<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px;border-bottom-style:solid"><b>AccountClient.java</b></div><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
package sample.jpa.appclient;

import java.util.List;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.persistence.Query;
import javax.persistence.EntityTransaction;

public class AccountClient {

    private EntityManager em;

    public AccountClient() {

        EntityManagerFactory emf = Persistence.createEntityManagerFactory(&quot;JPA-App-Client&quot;);
        if (emf == null) {
            throw new IllegalStateException(&quot;EntityManagerFactory is unavailable&quot;);
        }

        em = emf.createEntityManager();
        if (em == null) {
            throw new IllegalStateException(&quot;EntityManager is unavailable&quot;);
        }
    }

    public static void main(String[] args) {

        AccountClient client = new AccountClient();

        String opt = args[0];
        if (&quot;create&quot;.equals(opt)) {
            if (args.length != 6) {
                System.err.println(&quot;No values for accountNo, name, address, branchCode and balance. Exiting.&quot;);
                System.exit(0);
            } else {
                int accNo = Integer.parseInt(args[1]);
                String name = args[2];
                String address = args[3];
                int branchCode = Integer.parseInt(args[4]);
                double balance = Double.parseDouble(args[5]);
                client.createAccount(accNo, name, address, branchCode, balance);
            }
        } else if (&quot;list&quot;.equals(opt)) {
            List&lt;Account&gt; accounts = client.listAccounts();
            for (Account account: accounts) {
                System.out.println(&quot;_________________________________&quot;);
                System.out.println(account.getAccountNo());
                System.out.println(account.getName());
                System.out.println(account.getAddress());
                System.out.println(account.getBranchCode());
                System.out.println(account.getBalance());
                System.out.println(&quot;____________________________________________&quot;);
                System.out.println(&quot;&quot;);
            }
        } else if (&quot;update&quot;.equals(opt)) {
            if (args.length != 3) {
                System.out.println(&quot;No values for accountNo and new balace value. Exiting.&quot;);
                System.exit(0);
            } else {
                int accNo = Integer.parseInt(args[1]);
                double newbalance = Double.parseDouble(args[2]);
                client.updateAccountBalance(accNo, newbalance);
            }
        } else if (opt.equals(&quot;delete&quot;)) {
            if (args.length != 2) {
                System.out.println(&quot;No values for accountNo for delete. Exiting.&quot;);
                System.exit(0);
            } else {
                int accNo = Integer.parseInt(args[1]);
                client.deleteAccount(accNo);
            }
        }
        else {
            System.err.println(&quot;Unknown option (&quot; + opt + &quot;) selected&quot;);
        }

    }

    public Account createAccount(int accNo, String name, String address, int branchCode, double balance) {

        Account acc1 = em.find(Account.class, accNo);
        if (acc1 != null) {
            throw new IllegalArgumentException(&quot;Account already exists - account Number (&quot; + accNo + &quot;)&quot;);
        }
        Account acc = new Account();
        acc.setAccountNo(accNo);
        acc.setAddress(address);
        acc.setBalance(balance);
        acc.setBranchCode(branchCode);
        acc.setName(name);
        System.out.println(&quot;Persisting account entity (accNo = &quot; + accNo + &quot;)&quot;);
        EntityTransaction et = em.getTransaction();
        et.begin();
        em.persist(acc);
        et.commit();
        System.out.println(&quot;Persisted successfully account entity (accNo = &quot; + accNo + &quot;)&quot;);
        return acc;

    }

    @SuppressWarnings(&quot;unchecked&quot;)
    public List&lt;Account&gt; listAccounts() {
        Query q = em.createQuery(&quot;SELECT a FROM Account a&quot;);
        List&lt;Account&gt; currList = q.getResultList();
        return currList;
    }

    public Account updateAccountBalance(int accNo, double newBalance) {
        Account acc = em.find(Account.class, accNo);
        if (acc == null) {
            throw new IllegalArgumentException(&quot;Account not found : Account Number (&quot; + accNo + &quot;)&quot;);
        }
        EntityTransaction et = em.getTransaction();
        et.begin();
        acc.setBalance(newBalance);
        et.commit();
        return acc;

    }

    public void deleteAccount(int accNo) {
        EntityTransaction et = em.getTransaction();
        et.begin();
        em.remove(em.getReference(Account.class, accNo));
        et.commit();
    }
}
]]></script>
</div></div>
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>的<code>AccountClient</code>获得<code>EntityManagerFactory</code>对象，然后创建一个<code>EntityManager</code>工厂的物体。的<code>EntityManager</code>这样获得的对象是应用程序托管的EntityManager对象。默认情况下，EntityManager的持久性范围是<code>Extended</code> 。由于应用程序客户端与服务器在不同的JVM中运行，因此事务类型为<code>RESOURCE_LOCAL</code> 。因此<code>AccountClient</code>必须使用<code>EntityTransaction</code>划分交易。</p></div></div>
<h2 id="DeployingandrunningJPAapplicationclient-PreparingDeploymentDescriptorsandDeploymentPlans">准备部署描述符和部署计划</h2>

<p>1。创建<code>persistence.xml</code>文件在<code>META-INF</code>文件夹如下。<br clear="none">右键点击<code>META-INF</code>文件夹，然后单击<em>新建=>文件</em> 。</p>

<p>   <span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/7.JPG" data-image-src="/confluence/download/attachments/20645241/7.JPG?version=1&modificationDate=1211841466000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873563" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="7.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>提供<code>persistence.xml</code>作为文件名，然后单击<em>Finish</em> 。</p>

<p>   <span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/8.JPG" data-image-src="/confluence/download/attachments/20645241/8.JPG?version=1&modificationDate=1211845658000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873556" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="8.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>将以下内容复制到<code>persistence.xml</code> 。</p>

<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px;border-bottom-style:solid"><b>persistence.xml</b></div><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;persistence xmlns=&quot;http://java.sun.com/xml/ns/persistence&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd&quot;
  version=&quot;1.0&quot; &gt;
  &lt;persistence-unit name=&quot;JPA-App-Client&quot;&gt;
    &lt;description&gt;JPA Application Client&lt;/description&gt;
    &lt;provider&gt;org.apache.openjpa.persistence.PersistenceProviderImpl&lt;/provider&gt;
    &lt;class&gt;sample.jpa.appclient.Account&lt;/class&gt;
    &lt;properties&gt;
      &lt;property name=&quot;openjpa.ConnectionURL&quot; value=&quot;jdbc:derby://localhost/AccountDB&quot; /&gt;
      &lt;property name=&quot;openjpa.ConnectionDriverName&quot; value=&quot;org.apache.derby.jdbc.ClientDriver&quot; /&gt;
      &lt;property name=&quot;ConnectionUserName&quot; value=&quot;app&quot; /&gt;
      &lt;property name=&quot;openjpa.jdbc.SynchronizeMappings&quot; value=&quot;false&quot; /&gt;
    &lt;/properties&gt;
  &lt;/persistence-unit&gt;
&lt;/persistence&gt;
]]></script>
</div></div>

<p>2。同样，创建<code>application-client.xml</code>文件在<code>META-INF</code>上一步中指定的文件夹，然后将以下内容复制到文件中。</p>

<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px;border-bottom-style:solid"><b>application-client.xml</b></div><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;application-client xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/application-client_5.xsd&quot;
  version=&quot;5&quot;&gt;
&lt;/application-client&gt;
]]></script>
</div></div>

<p>由于我们使用JPA批注来声明资源，因此我们在文件中不需要任何条目。</p>

<p>3。同样，创建<code>geronimo-application-client.xml</code>文件下<code>META-INF</code>文件并复制以下内容。</p>

<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px;border-bottom-style:solid"><b>geronimo-application-client.xml</b></div><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;application-client xmlns=&quot;http://geronimo.apache.org/xml/ns/j2ee/application-client-2.0&quot; 
  xmlns:sys=&quot;http://geronimo.apache.org/xml/ns/deployment-1.2&quot;
  xmlns:naming=&quot;http://geronimo.apache.org/xml/ns/naming-1.2&quot; 
  xmlns:security=&quot;http://geronimo.apache.org/xml/ns/security-2.0&quot;
  xmlns:connector=&quot;http://geronimo.apache.org/xml/ns/j2ee/connector-1.2&quot;&gt;
  &lt;sys:client-environment&gt;
    &lt;sys:moduleId&gt;
      &lt;sys:groupId&gt;AccountJPA&lt;/sys:groupId&gt;
      &lt;sys:artifactId&gt;AccountJPA-app-client&lt;/sys:artifactId&gt;
      &lt;sys:version&gt;3.0&lt;/sys:version&gt;
      &lt;sys:type&gt;jar&lt;/sys:type&gt;
    &lt;/sys:moduleId&gt;
    &lt;sys:dependencies&gt;
      &lt;sys:dependency&gt;
        &lt;sys:groupId&gt;org.apache.geronimo.configs&lt;/sys:groupId&gt;
        &lt;sys:artifactId&gt;transaction&lt;/sys:artifactId&gt;
        &lt;sys:version&gt;2.1&lt;/sys:version&gt;
        &lt;sys:type&gt;car&lt;/sys:type&gt;
      &lt;/sys:dependency&gt;
    &lt;/sys:dependencies&gt;
  &lt;/sys:client-environment&gt;
  &lt;sys:server-environment&gt;
    &lt;sys:moduleId&gt;
      &lt;sys:groupId&gt;AccountJPA&lt;/sys:groupId&gt;
      &lt;sys:artifactId&gt;AccountJPA-app-client-server&lt;/sys:artifactId&gt;
      &lt;sys:version&gt;3.0&lt;/sys:version&gt;
      &lt;sys:type&gt;jar&lt;/sys:type&gt;
    &lt;/sys:moduleId&gt;
  &lt;/sys:server-environment&gt;
&lt;/application-client&gt;
]]></script>
</div></div>

<h2 id="DeployingandrunningJPAapplicationclient-Deployingtheapplicationclient">部署应用程序客户端</h2>

<p>1。将Java项目导出到jar文件中。启动geronimo服务器并打开管理控制台。 <code><a shape="rect" class="external-link" href="http://localhost:8080/console" rel="nofollow">http://localhost:8080/console</a></code> 。<br clear="none">单击<em>控制台导航</em> portlet上的Embedded <em>DB => DB Manager</em> 。如下所示，这将打开<em>DB Viewer</em>并在右侧<em>运行SQL</em> portlet。</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/19.JPG" data-image-src="/confluence/download/attachments/20645241/19.JPG?version=1&modificationDate=1211851919000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873568" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="19.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>在“ <em>创建数据库”</em>文本框中输入<em>AccountDB</em> ，然后单击“ <em>创建”</em>按钮。这将创建一个新的数据库<em>AccountDB</em> ，并将在<em>DB Viewer</em> Portlet中列出。</p>

<p>在<em>运行SQL</em> portlet的textarea <em>SQL命令中</em> ，输入以下SQL命令，并在“ <em>使用数据库”</em>组合框中选择<em>AccountDB</em> ，然后单击“ <em>运行SQL”</em>按钮。这将在<em>AccountDB</em>数据库中创建<em>Account1</em>表。</p>

<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px;border-bottom-style:solid"><b>帐户1表</b></div><div class="codeContent panelContent pdl">
<script class="brush: sql; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
create table ACCOUNT1 (ACCOUNTNO integer, NAME varchar(50), ADDRESS varchar(225), BRANCHCODE integer, BALANCE decimal(15,2));
]]></script>
</div></div>

<p>遵循上述相同的步骤，使用下面的SQL语句在表中插入一些示例行。</p>

<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px;border-bottom-style:solid"><b>帐户1表</b></div><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
insert into Account1 values (1111, &#39;Joe&#39;, &#39;NewYork&#39;, 10, 30000.0);
insert into Account1 values (2222, &#39;John&#39;, &#39;NewJersy&#39;, 11, 31000.0);
insert into Account1 values (3333, &#39;Jane&#39;, &#39;Raleigh&#39;, 13, 32000.0);
]]></script>
</div></div>


<p>2。按名称导出Java项目<code>ApplicationClientJPA.jar</code>如下。<br clear="none">右键单击Java项目并将其导出为jar文件。</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/15.JPG" data-image-src="/confluence/download/attachments/20645241/15.JPG?version=1&modificationDate=1211841497000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873558" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="15.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>选择<em>Java => jar</em></p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/16.JPG" data-image-src="/confluence/download/attachments/20645241/16.JPG?version=1&modificationDate=1211841497000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873565" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="16.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>单击<em>下一步，</em>然后提供jar文件名和目标文件夹，如下所示，然后单击<em>下一步</em> 。</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/17.JPG" data-image-src="/confluence/download/attachments/20645241/17.JPG?version=1&modificationDate=1211841530000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873573" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="17.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>在下一个屏幕中，单击“ <em>下一步”</em> 。在<em>Jar清单规范</em>向导中，选择<code>sample.jpa.appclient.AccountClient</code>使用<em>浏览</em>按钮。这是有<code>public static void main(String[] args)</code>方法，它是应用程序的入口点。</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="deploying-and-running-jpa-application-client.data/18.JPG" data-image-src="/confluence/download/attachments/20645241/18.JPG?version=1&modificationDate=1211841530000&api=v2" data-unresolved-comment-count="0" data-linked-resource-id="20873572" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="18.JPG" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/jpeg" data-linked-resource-container-id="20645241" data-linked-resource-container-version="5"></span></p>

<p>点击<em>完成</em> 。</p>

<p>3。如下部署应用程序客户端。</p>

<p>将目录更改为<code><geronimo_home>\bin</code> 。<br clear="none">提交以下命令</p>
<div class="preformatted panel" style="border-style:solid;border-width:1px"><div class="preformattedContent panelContent">
<pre>&lt;geronimo_home&gt;/bin&gt;deploy.bat --user system --password manager deploy &lt;location_of_the_ApplicationClientJPA.jar&gt;/ApplicationClientJPA.jar
</pre>
</div></div>

<h2 id="DeployingandrunningJPAapplicationclient-Runningtheapplicationclient">运行应用程序客户端</h2>

<p>1。如下运行应用程序客户端。</p>

<p>该应用程序执行以下操作。使用脚本<code>client</code> （.bat或.sh）来运行应用程序客户端。</p>

<ul><li>列表：此选项当前列出数据库中的帐户。列出的命令如下。
<div class="preformatted panel" style="border-style:solid;border-width:1px"><div class="preformattedContent panelContent">
<pre>&lt;geronimo_home&gt;/bin&gt;client AccountJPA/AccountJPA-app-client/3.0/jar list
</pre>
</div></div></li></ul>


<ul><li>创建：此选项在数据库中创建一个帐户。创建命令如下。
<div class="preformatted panel" style="border-style:solid;border-width:1px"><div class="preformattedContent panelContent">
<pre>&lt;geronimo_home&gt;/bin&gt;client.bat/sh AccountJPA/AccountJPA-app-client/3.0/jar create 2222 Joe NewYork BranchX 20000.0
</pre>
</div></div></li></ul>


<ul><li>更新：此选项更新数据库中具有新余额的帐户。<br clear="none">更新命令如下。
<div class="preformatted panel" style="border-style:solid;border-width:1px"><div class="preformattedContent panelContent">
<pre>&lt;geronimo_home&gt;/bin&gt;client.bat/sh AccountJPA/AccountJPA-app-client/3.0/jar update 2222 30000.00
</pre>
</div></div></li></ul>


<ul><li>删除：此选项删除数据库中的帐户。删除命令如下。
<div class="preformatted panel" style="border-style:solid;border-width:1px"><div class="preformattedContent panelContent">
<pre>&lt;geronimo_home&gt;/bin&gt;client.bat/sh AccountJPA/AccountJPA-app-client/3.0/jar delete 2222.
</pre>
</div></div></li></ul>
</div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Deploying and running JPA application client';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2013，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  

</body></html>