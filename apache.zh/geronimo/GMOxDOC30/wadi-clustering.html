<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=1">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="WADI Clustering">
    <meta name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi WADI Clustering">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2010-05-11">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0文档：WADI群集</title>
  </head>

  <body  onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">主页</a> > <a href="documentation.html">文档</a> > <a href="configuring-and-administering.html">配置和管理</a> > <a href="configuring-and-administering-the-apache-geronimo-server.html">配置和管理Apache Geronimo Server</a> > <a href="clustering-and-farming.html">群集和耕种</a> > <a href="wadi-clustering.html">WADI群集</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo v3.0</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">WADI群集</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645453"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645453">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645453"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645453">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645453"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645453">添加新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>

<p><parameter ac:name="atlassian-macro-output-type">排队</parameter><rich-text-body></rich-text-body></p><p>从Geronimo 2.2版开始，Web应用程序和有状态SessionBeans可以由WADI集群。</p>为了集群这些组件，它们的Geronimo部署描述符增加了特定的XML元素。这些元素定义了各种群集参数，这些参数控制着基础WADI组件如何在应用程序部署时进行连接和设置。<p></p>

<h2 id="WADIClustering-ClusteringConfigurations">集群配置</h2>

<p>安装以下两个配置，这些配置与JEE5程序集一起提供，以支持集群：</p>
<ul><li><em>org.apache.geronimo.configs / clustering // car</em> ：它定义集群Web应用程序或EJB模块必须具有的运行时依赖项。例如，它将geronimo群集JAR导入到此类模块的类路径中。而且，它定义了一个<em>Node</em> GBean，它定义了该Geronimo实例在集群中的唯一名称。<br clear="none">要给您的Geronimo实例一个特定的名称，您可以通过更新<em>var / config / config-substitutions.properties中</em>定义的<em>clusterNodeName</em>属性来重新配置此模块： <plain-text-body>clusterNodeName = MyOwnNodeName</plain-text-body></li><li><em>org.apache.geronimo.configs / wadi-clustering // car</em> ：它定义了WADI特定的GBean，这些GBean用于进一步配置集群应用程序的行为以及所有集群应用程序共享的WADI组通信服务以相互通信。<br clear="none">您可以使用此模块来覆盖<em>DefaultBackingStrategyFactory</em> GBean，以配置默认副本数，该副本数设置为2，并在给定HTTP会话或SFSB实例的整个群集中维护。</li></ul>


<p>启动群集应用程序时，将自动启动这些配置。因此，您不应明确启动它们。</p>



<h2 id="WADIClustering-CreatingaStaticWadiConfiguration">创建静态Wadi配置</h2>

<p>可以将Wadi配置为使用单播而不是多播。要完成此配置，需要在以下位置的wadi-cluster模块配置中添加多个附加项： <code>config.xml</code> 。</p>

<h3 id="WADIClustering-ModifyingDispatchHolderGBeanConfiguration">修改DispatchHolder GBean配置</h3>
<p>要成功使用单播配置，请使用<code>disableMCastService</code>属性以禁用多播广播服务。</p>


<parameter ac:name="">XML为</parameter> <plain-text-body><gbean name="DefaultDispatcherHolder"><attribute name="disableMCastService">真</attribute></gbean></plain-text-body>           

<p>您可以指定接收器端口<code>DispatcherHolder</code>将监听会话更新。如果未指定任何端口，则将自动选择从端口4000开始的第一个可用端口。</p>

<parameter ac:name="">xml</parameter> <plain-text-body><gbean name="DefaultDispatcherHolder"><attribute name="disableMCastService">true</attribute> <attribute name="receiverPort">4003</attribute></gbean></plain-text-body>

<p>对于静态配置，您需要定义静态成员列表。每个静态成员在以下位置都有自己的gbean配置<code>config.xml</code>在wadi-cluster模块中。的<code>DefaultDispatchHolder</code>引用列表中的第一个静态成员。</p>

<parameter ac:name="">xml</parameter> <plain-text-body><gbean name="DefaultDispatcherHolder"><attribute name="disableMCastService">true</attribute> <attribute name="receiverPort">4003</attribute> <reference name="staticMember"><pattern><groupid>org.apache.geronimo.configs</groupid> <name>旱作</name> <artifactid>群集</artifactid> <version>2.2-快照</version> <type>汽车</type> <name>firstStaticMember</name></pattern></reference></gbean></plain-text-body>

<h3 id="WADIClustering-DefiningAStaticMember">定义静态成员</h3>

<p>您需要在配置中定义每个静态成员<code>config.xml</code> 。配置示例如下：</p>

<parameter ac:name="">xml</parameter> <plain-text-body><gbean name="org.apache.geronimo.configs/wadi-clustering/2.2-SNAPSHOT/car?ServiceModule=org.apache.geronimo.configs/wadi-clustering/2.2-SNAPSHOT/car,j2eeType=GBean,name=firstStaticMember" gbeaninfo="org.apache.geronimo.clustering.wadi.WadiStaticMember"><attribute name="className">org.apache.catalina.tribes.membership。StaticMember</attribute> <attribute name="port">4001</attribute> <attribute name="securePort">-1</attribute> <attribute name="domain">测试域</attribute> <attribute name="UniqueId">0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0</attribute> <attribute name="host">9.27.163.151</attribute> <reference name="nextWadiStaticMember"><pattern><groupid>org.apache.geronimo.configs</groupid> <artifactid>wadi-聚类</artifactid> <version>2.2-SNAPSHOT</version> <type>汽车</type> <name>secondStaticMember</name></pattern></reference>
</gbean>
</plain-text-body>

<h4 id="WADIClustering-StaticMemberAttributes">静态成员属性</h4>

<ul><li>className（必填）-Tomcat中的静态成员类名称。</li><li>port-静态成员的接收者端口。</li><li>securePort-安全接收器端口。</li><li>域（必填）=集群域。</li><li>UniqueId（必填）=此静态成员的唯一标识符。</li><li>host（必填）=静态成员的主机名或IP地址。</li><li>nextWadiStaticMember =成员列表中的下一个静态成员。如果没有其他静态成员，则可以将其保留为空白或完全省去。</li></ul>



<h2 id="WADIClustering-ClusteringofWeb-applications">Web应用程序的集群</h2>


<h3 id="WADIClustering-UpdatingyourDeploymentDescriptors">更新您的部署描述符</h3>

<p>部署描述符和部署计划必须进行如下更新：</p>
<ul><li>部署描述符，例如， <code>web.xml</code> ：Web应用程序必须标记为可分发。换句话说，必须定义可选的“可分发”元素： <parameter ac:name="">xml</parameter> <plain-text-body><web-app>.....
    <distributable></distributable> .....
</web-app>
</plain-text-body></li><li>部署计划，例如geronimo-web.xml：如果要将Web应用程序部署到嵌入式Jetty，则必须定义“集群-wadi”替换组。如果要部署到嵌入式Tomcat，则应使用“ tomcat-clustering-wadi”替换组。这些替换组分别由Geronimo服务器安装的<em>schema</em>文件夹中包含的XSD geronimo-clustering-wadi-X.xsd和geronimo-tomcat-clustering-wadi-X.xsd定义。<br clear="none">这两个元素都提供了Web应用程序特定的群集配置，该配置将覆盖默认的群集配置。此默认集群配置由<em>org.apache.geronimo.configs / jetty6-clustering-builder-wadi // car</em>声明的GBean <em>WADIJettyClusteringBuilder</em>定义。<br clear="none">以下是针对Jetty嵌入式的Geronimo部署描述符示例： <parameter ac:name="">xml</parameter> <plain-text-body><!--?xml version="1.0" encoding="UTF-8" ?=""--><web-app xmlns="http://geronimo.apache.org/xml/ns/j2ee/web/jetty-1.2"><environment><moduleid><groupid>yourGroupId</groupid> <artifactid>yourArtifactId</artifactid> <version>YourVersion</version> <type>war</type></moduleid></environment> <context-root>/ yourPath</context-root> <clustering-wadi></clustering-wadi></web-app><!--?xml--></plain-text-body></li></ul>


<rich-text-body>
<p>如果您正在使用Geronimo发行版的Tomcat程序集，请更换<code><clustering-wadi/></code>与<code><tomcat-clustering-wadi/></code>部署计划中的元素。</p></rich-text-body>

<h3 id="WADIClustering-JettyWeb-applicationClusteringConfigurations">Jetty Web应用程序集群配置</h3>

<p>安装以下两个配置，这些配置与JEE5程序集一起提供，以支持集群：</p>
<ul><li><em>org.apache.geronimo.configs / jetty6-clustering-wadi // car</em> ：它定义了运行时依赖项和Jetty6集群契约。</li><li><em>org.apache.geronimo.configs / jetty6-clustering-builder-wadi // car</em> ：它定义部署时间依赖性以及<em>JettyClusteringBuilder</em> GBean来声明默认的集群配置。<br clear="none">启动群集Web应用程序时，此配置必须正在运行。如果未运行，则替换组<em>clustering-wadi</em>无法正确识别，并且部署失败。</li></ul>


<h3 id="WADIClustering-TomcatWeb-applicationClusteringConfigurations">Tomcat Web应用程序集群配置</h3>

<p>Tomcat配置与Jetty的配置相同，只是jetty6-X工件ID应替换为tomcat6-X。</p>

<h2 id="WADIClustering-ClusteringofSFSB">SFSB的群集</h2>

<p>Geronimo使用OpenEJB容器提供EJB服务。Geronimo现在对SFSB集群提供了一些基本支持，例如集群成员之间的状态复制。基本上，服务器集群成员使用多播心跳信号维护成员资格信息，而ejb客户端维护服务器列表，以根据可用性更改目标服务器。每个多播数据包都包含单个URI，以“ cluster1：ejb：ejbd：// thehost：4201”的形式通告服务，其组及其位置。</p>


<h3 id="WADIClustering-UpdatingGeronimoEJBdeploymentplan">更新Geronimo EJB部署计划</h3>
<p>EJB应用程序特定于Geronimo的部署计划（通常打包为EJB JAR文件）被称为<strong>“ openejb-jar.xml”</strong> 。<strong>openejb-jar.xml</strong>部署计划与<strong>ejb-jar.xml</strong> Java EE部署计划结合使用，以将企业应用程序部署到Geronimo应用程序服务器。<br clear="none">要为SFSB启用WADI集群，请按如下所示将<em>openejb-clustering-wadi</em>添加到部署计划中：</p>
<parameter ac:name="">XML</parameter> <plain-text-body><openejb-jar xmlns="http://openejb.apache.org/xml/ns/openejb-jar-2.2" xmlns:sys="http://geronimo.apache.org/xml/ns/deployment-1.2">...
  <openejb-clustering-wadi></openejb-clustering-wadi>
</openejb-jar>
</plain-text-body>

<h3 id="WADIClustering-Updatingserverconfiguration">更新服务器配置</h3>
<p>安装以下两个配置，这些配置与JEE5程序集一起提供，以支持集群：</p>
<ul><li><em>org.apache.geronimo.configs / openejb-clustering-wadi // car</em> ：它定义了运行时依赖项和OpenEJB集群契约。</li><li><em>org.apache.geronimo.configs / openejb-clustering-builder-wadi // car</em> ：它定义了部署时间依赖性以及<em>OpenEJBClusteringBuilder</em> GBean，用于声明默认的集群配置。<br clear="none">启动群集SFSB时，此配置必须正在运行。如果未运行，则无法正确识别替代组<em>openejb-clustering-wadi</em> ，并且部署失败。</li></ul>


</div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : WADI Clustering';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2013，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  

</body></html>