<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=3">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="Accessing EJB in Web applications">
    <meta name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Accessing EJB in Web applications">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2010-05-11">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>

  <link href="asset?aid=6" rel="stylesheet" type="text/css">
  <link href="asset?aid=7" rel="stylesheet" type="text/css">
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shCore.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushJava.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushXml.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushPlain.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushBash.js' type='text/javascript'></script>
  
  <script type="text/javascript">
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
  </script>

    <title>Apache Geronimo v3.0文档：在Web应用程序中访问EJB</title>
  </head>

  <body  onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">主页</a> > <a href="documentation.html">文档</a> > <a href="developing.html">开发</a> > <a href="tutorials.html">教程</a> > <a href="developing-web-applications.html">开发Web应用程序</a> > <a href="accessing-ejb-in-web-applications.html">在Web应用程序中访问EJB</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo v3.0</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">在Web应用程序中访问EJB</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645267"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645267">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645267"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645267">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645267"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645267">添加新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent">
<p>要运行本教程，至少需要您安装以下必备软件：</p>

<ol><li>Sun JDK 6.0+（J2SE 1.6）</li><li>面向特定平台的Java EE开发人员的Eclipse IDE</li><li>Apache Geronimo Eclipse插件2.1.x</li><li>Apache Geronimo服务器2.1.x<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>在本教程中使用了Geronimo 2.1.x版，Java 1.5运行时和Eclipse Ganymede，但是可以使用其他版本（例如Geronimo 2.2版，Java 1.6，Eclipse Europa）</p></div></div></li></ol>


<p><a shape="rect" href="development-environment.html">开发环境</a>部分中提供了有关安装Eclipse的详细信息。本教程分为以下几节：</p>
<style type="text/css">/*<![CDATA[*/
div.rbtoc1572612945439 {padding: 0px;}
div.rbtoc1572612945439 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1572612945439 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class="toc-macro rbtoc1572612945439">
<ul class="toc-indentation"><li><a shape="rect" href="#AccessingEJBinWebapplications-DefineanewGeronimoServerRuntime">定义新的Geronimo Server运行时</a></li><li><a shape="rect" href="#AccessingEJBinWebapplications-CreatingaEJBProject">创建一个EJB项目</a></li><li><a shape="rect" href="#AccessingEJBinWebapplications-CreatingaDynamicWebProject">创建一个动态Web项目</a></li><li><a shape="rect" href="#AccessingEJBinWebapplications-AddingcodetoEJBProject">向EJB项目添加代码</a></li><li><a shape="rect" href="#AccessingEJBinWebapplications-AddingcodetoWebProject">向Web项目添加代码</a></li><li><a shape="rect" href="#AccessingEJBinWebapplications-Somemoreconfigurations">其他一些配置</a></li><li><a shape="rect" href="#AccessingEJBinWebapplications-DeployandRun">部署并运行</a></li></ul>
</div>

<h1 id="AccessingEJBinWebapplications-DefineanewGeronimoServerRuntime">定义新的Geronimo Server运行时</h1>
<ol><li>启动Eclipse并选择<strong>New-> Other-> Server-> Server</strong>并选择<strong>Next</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/NewServer1.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>选择<strong>Apache-> Apache Geronimo v2.1 Server</strong>并选择<strong>Next</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/NewServer2.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>指定现有Geronimo服务器安装的安装目录，然后选择<strong>Finish</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/NewServer3_updated.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>从<em>J2EE</em>角度在Eclipse中启动服务器。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/NewServer4.png"></span> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li></ol>


<h1 id="AccessingEJBinWebapplications-CreatingaEJBProject">创建一个EJB项目</h1>
<ol><li>启动Eclipse并在Project Explorer下右键单击。选择<strong>New-> EJB Project</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/CreateEJB.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将项目命名为<em>CurrencyConvertEJB</em>并选择<strong>Next</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">！<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/ganymede_CreateEJB3a.jpg"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>使用默认值，然后选择<strong>完成</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/CreateEJB4.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> 
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/CreateEJB5.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> </li><li>右键单击<strong>ejbModule</strong>并选择<strong>New-</strong> <strong>> Interface</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/CreateEJB6.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将包命名为<em>ejb</em> ，将接口命名为<em>Converter</em> 。选择<strong>完成</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/CreateEJB7.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>右键单击<strong>ejb</strong>软件包，然后选择<strong>New-</strong> <strong>> Class</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/CreateEJB8.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将类命名为<em>ConverterBean</em>并选择<strong>Finish</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li></ol>


<h1 id="AccessingEJBinWebapplications-CreatingaDynamicWebProject">创建一个动态Web项目</h1>
<ol><li>启动Eclipse。选择<strong>文件->新建->项目</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/createproj.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>选择<strong>Web->动态Web项目</strong> 。选择<strong>下一步</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/createproj2.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>在下一个屏幕上，将项目命名为<em>WebEJB</em> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/ganymede_createproj3.jpg"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>选择所有其他字段的默认值。最后选择<strong>完成</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/createproj4.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>右键单击<strong>WebContent，</strong>然后选择<strong>New-</strong> <strong>> JSP</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/createproj5.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将JSP命名为<em>index.jsp</em> 。选择<strong>下一步->完成</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/createproj6.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/createproj7.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>右键单击<strong>Java Resources，</strong>然后选择<strong>New-> Other</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/createproj8.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> </li><li>选择<strong>Web-> Servlet</strong> 。选择<strong>下一步</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/createproj9.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将包命名为<em>webejb</em> ，将Servlet <em>命名</em>为<em>ConverterHandler</em> 。选择<strong>下一步->完成</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/createproj10.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> 
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/createproj11.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> </li></ol>


<h1 id="AccessingEJBinWebapplications-AddingcodetoEJBProject">向EJB项目添加代码</h1>
<ol><li>将以下代码添加到界面<code>Converter.java</code> 。
<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px;border-bottom-style:solid"><b>Converter.java</b></div><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
package ejb;

import java.math.BigDecimal;
import javax.ejb.Remote;

@Remote
public interface Converter {
	public BigDecimal dollarToRupees(BigDecimal dollars);

	public BigDecimal rupeesToEuro(BigDecimal rupees);
}
</pre>
</div></div>在这里<strong>，@Remote</strong>注释用于其声明为远程接口。<br class="atl-forced-newline" clear="none"></li><li>将以下代码添加到类中<code>ConverterBean.java</code>
<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px;border-bottom-style:solid"><b>ConverterBean.java</b></div><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
package ejb;

import java.math.BigDecimal;
import javax.ejb.*;

@Stateless
public class ConverterBean implements Converter {
	private BigDecimal rupeeRate = new BigDecimal("40.58");
	private BigDecimal euroRate = new BigDecimal("0.018368");

	public BigDecimal dollarToRupees(BigDecimal dollars) {
		BigDecimal result = dollars.multiply(rupeeRate);
		return result.setScale(2, BigDecimal.ROUND_UP);
	}

	public BigDecimal rupeesToEuro(BigDecimal rupees) {
		BigDecimal result = rupees.multiply(euroRate);
		return result.setScale(2, BigDecimal.ROUND_UP);
	}
}
</pre>
</div></div>在这里， <strong>@ Stateless</strong>批注将POJO（普通的旧Java对象）声明为无状态会话Bean。<br clear="none">这样就完成了EJB代码。</li></ol>


<h1 id="AccessingEJBinWebapplications-AddingcodetoWebProject">向Web项目添加代码</h1>
<ol><li>将以下代码添加到<code>index.jsp</code> 。
<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px;border-bottom-style:solid"><b>index.jsp</b></div><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Converter&lt;/title&gt;
&lt;/head&gt;

&lt;body bgcolor="white"&gt;
&lt;h1&gt;Converter&lt;/h1&gt;
&lt;hr&gt;
&lt;p&gt;Enter an amount to convert:&lt;/p&gt;
&lt;form method="get" action="index.jsp"&gt;
	&lt;input type="text" name="amount" size="25"&gt;&lt;br&gt;
	&lt;p&gt;
	&lt;input type="submit" value="Submit"&gt;

	&lt;input type="reset" value="Reset"&gt;
&lt;/form&gt;

&lt;jsp:include page="/ConverterHandler" /&gt;

&lt;/body&gt;
</pre>
</div></div></li></ol>


<ol><li>将以下代码添加到<em>ConverterHandler</em> servlet。
<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px;border-bottom-style:solid"><b>ConverterHandler.java</b></div><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
package webejb;
import ejb.Converter;

import java.io.IOException;
import java.io.PrintWriter;
import java.math.BigDecimal;

import javax.ejb.EJB;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class ConverterHandler extends javax.servlet.http.HttpServlet implements
		javax.servlet.Servlet {
	@EJB(name = "ejb/Converter")
	private Converter converter;

	protected void doGet(HttpServletRequest request,
			HttpServletResponse response) throws ServletException, IOException {
		PrintWriter out = response.getWriter();
		String amount = request.getParameter("amount");
		if (amount != null &amp;&amp; amount.length() &gt; 0) {
			BigDecimal d = new BigDecimal(amount);
			BigDecimal rupeeAmount = converter.dollarToRupees(d);
			out.println("&lt;p&gt;" + amount + " Dollars are " + rupeeAmount + " Rupees.&lt;p&gt;");
			BigDecimal euroAmount = converter.rupeesToEuro(rupeeAmount);
			out.println(amount + " Dollars are " + euroAmount + " Euro.");
		}
	}

	protected void doPost(HttpServletRequest request,
			HttpServletResponse response) throws ServletException, IOException {
		doGet(request, response);
	}
}
</pre>
</div></div>
<br class="atl-forced-newline" clear="none"><strong>@EJB（name =“ ejb / Converter”）</strong>将EJB注入到servlet中。这样就完成了Web项目的代码。</li></ol>


<h1 id="AccessingEJBinWebapplications-Somemoreconfigurations">其他一些配置</h1>

<ol><li>修改部署计划<code>geronimo-web.xml</code>如下：<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px;border-bottom-style:solid"><b>geronimo-web.xml</b></div><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns="http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1" 
xmlns:nam="http://geronimo.apache.org/xml/ns/naming-1.2" 
xmlns:sec="http://geronimo.apache.org/xml/ns/security-2.0" 
xmlns:sys="http://geronimo.apache.org/xml/ns/deployment-1.2"&gt;

    &lt;sys:environment&gt;
        &lt;sys:moduleId&gt;
            &lt;sys:groupId&gt;default&lt;/sys:groupId&gt;
            &lt;sys:artifactId&gt;WebEJB&lt;/sys:artifactId&gt;
            &lt;sys:version&gt;1.0&lt;/sys:version&gt;
            &lt;sys:type&gt;car&lt;/sys:type&gt;
        &lt;/sys:moduleId&gt;
        &lt;sys:dependencies&gt;
            &lt;sys:dependency&gt;
                &lt;sys:groupId&gt;default&lt;/sys:groupId&gt;
                    &lt;sys:artifactId&gt;CurrencyConvertEJB&lt;/sys:artifactId&gt;
      		    &lt;sys:version&gt;1.0&lt;/sys:version&gt;
      		    &lt;sys:type&gt;car&lt;/sys:type&gt;
            &lt;/sys:dependency&gt;        
        &lt;/sys:dependencies&gt;
    &lt;/sys:environment&gt;

    &lt;context-root&gt;/WebEJB&lt;/context-root&gt;

    &lt;nam:ejb-ref xmlns:nam="http://geronimo.apache.org/xml/ns/naming-1.2"&gt;
        &lt;nam:ref-name&gt;ejb/Converter&lt;/nam:ref-name&gt;
        &lt;nam:pattern&gt;
            &lt;nam:groupId&gt;default&lt;/nam:groupId&gt;
            &lt;nam:artifactId&gt;CurrencyConvertEJB&lt;/nam:artifactId&gt;
            &lt;nam:version&gt;1.0&lt;/nam:version&gt;
            &lt;nam:name&gt;ConverterBean&lt;/nam:name&gt;
        &lt;/nam:pattern&gt;
    &lt;/nam:ejb-ref&gt;

&lt;/web-app&gt;
</pre>
</div></div>我们添加了一个dependencies元素（即， <strong><dependencies></dependencies></strong> ）和ejb参考元素（即， <strong><ejb-ref></ejb-ref></strong> ） 至<code>geronimo-web.xml</code> 。这是使我们的CurrencyConvertEJB对我们的Web应用程序可见的必需步骤。</li><li>右键单击<strong>WebEJB</strong>项目，然后选择<strong>properties</strong> 。选择<strong>Java构建路径->项目</strong> 。单击<strong>添加，</strong>然后添加<strong>CurrencyConvertEJB</strong> 。这是编译客户端代码所必需的。以下屏幕截图对此进行了说明。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/AddProj.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/AddProj1.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/AddProj2.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/AddProj3.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/AddProj4.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li></ol>


<h1 id="AccessingEJBinWebapplications-DeployandRun">部署并运行</h1>
<ol><li>在<em>J2EE</em>透视图中右键单击Geronimo服务器，然后选择<strong>Add and Remove Projects...。</strong> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>您的工作区中应该有2个项目。选择<strong>全部添加>></strong> ，然后选择<strong>完成</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/AddProjects.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li></ol>


<ol><li>在Eclipse中启动浏览器（使用Eclipse主窗口顶部的Globe图标），然后使用<strong><a shape="rect" class="external-link" href="http://localhost:8080/WebEJB/" rel="nofollow">http：// localhost：8080 / WebEJB /</a></strong>运行应用程序。这将显示以下页面。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/RunInEclipse1.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>输入<strong>15</strong>作为金额，然后选择<strong>Submit</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/RunInEclipse2.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>这会将美元金额转换为卢比和欧元。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-ejb-in-web-applications.data/RunInEclipse3.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> </li></ol></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Accessing EJB in Web applications';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2013，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  

</body></html>