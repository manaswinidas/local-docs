<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link type="text/css" rel="stylesheet" href="http://geronimo.apache.org/style/default.css">
    <LINK rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <META name="Description" content="JMS application with Message-Driven Bean" />
    <META name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi JMS application with Message-Driven Bean" />
    <META name="Owner" content="dev@geronimo.apache.org" />
    <META name="Robots" content="index, follow" />
    <META name="Security" content="Public" />
    <META name="Source" content="wiki template" />
    <META name="DC.Date" scheme="iso8601" content="2010-05-11" />
    <META name="DC.Language" scheme="rfc1766" content="en" />
    <META name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation" />
    <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0 Documentation: JMS application with Message-Driven Bean</title>
  </head>

  <body onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tr>
        <td valing="top" align="left">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" align="left" nowrap>
          <a href="/geronimo"> Home</a> >&nbsp;<a href="documentation.html">Documentation</a>&nbsp;&gt;&nbsp;<a href="developing.html">Developing</a>&nbsp;&gt;&nbsp;<a href="tutorials.html">Tutorials</a>&nbsp;&gt;&nbsp;<a href="developing-ejb-applications.html">Developing EJB applications</a>&nbsp;&gt;&nbsp;<a href="jms-application-with-message-driven-bean.html">JMS application with Message-Driven Bean</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8" />
            <input type="hidden" name="oe" value="UTF-8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
        </td>
      </tr> 
    </table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div style="margin: 0px 10px 0px 10px" class="smalltext">Apache Geronimo v3.0</div>
        <div style="margin: 0px 10px 8px 10px"  class="pagetitle">JMS application with Message-Driven Bean</div>

        <div class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
<!-- -->         
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645240">
            <img src="http://geronimo.apache.org/images/icons/notep_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Edit Page"></a>
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645240">Edit Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">
            <img src="http://geronimo.apache.org/images/icons/browse_space.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Browse Space"></a>
            <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">Browse Space</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645240">
            <img src="http://geronimo.apache.org/images/icons/add_page_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add Page"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645240">Add Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645240">
            <img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add News"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645240">Add News</a>
<!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>
<p>This application is a simple JMS application where in a user sends information to the administrator for update.</p>

<p>To run this tutorial, as a minimum you will be required to have installed the following prerequisite software.</p>

<ul><li>Sun JDK 5.0+ (J2SE 1.5)</li><li>Eclipse 3.3.1.1 (Eclipse Classic package of Europa distribution), which is platform specific</li><li>Web Tools Platform (WTP) 2.0.1</li><li>Data Tools Platform (DTP) 1.5.1</li><li>Eclipse Modeling Framework (EMF) 2.3.1</li><li>Graphical Editing Framework (GEF) 3.3.1</li></ul>


<p>Details on installing eclipse are provided in the <a shape="rect" href="development-environment.html">Development environment</a> section. This tutorial is organized in the following sections:</p>

<p>The application development will take you through the following</p>

<h1 id="JMSapplicationwithMessage-DrivenBean-CreatingaDynamicWebProject">Creating a Dynamic Web Project</h1>
<ol><li>Launch Eclipse. Select <strong>File-&gt;New-&gt;Project</strong>.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createproj.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Select <strong>Web-&gt;Dynamic Web Project</strong>. Select <strong>Next</strong>.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createproj2.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Name the project as <strong>WebMDB</strong>. Select Next.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createproj4.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Next window displays the various project facets. Keep the default values and select Next.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createproj5.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Keep the default values for the next window. Select Next-&gt;Finish.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createproj6.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createproj7.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Right click on <strong>WebMDB</strong> project and create a new <strong>servlet</strong>.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/AddSource.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Name the servlet as <strong>UserServlet</strong> and package as <strong>webmdb</strong>. This is the producer in the application.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/AddSource1.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Select Next and later <strong>Finish</strong>.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/AddSource2.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Add the following code to UserServlet.java
<parameter ac:name="borderStyle">solid</parameter><parameter ac:name="title">UserServlet.java</parameter><plain-text-body>
package webmdb;

import java.io.IOException;
import java.io.PrintWriter;
import java.util.Enumeration;
import java.util.Properties;

import javax.annotation.Resource;
import javax.jms.Connection;
import javax.jms.ConnectionFactory;
import javax.jms.JMSException;
import javax.jms.MessageListener;
import javax.jms.MessageProducer;
import javax.jms.Queue;
import javax.jms.Session;
import javax.jms.TextMessage;
import javax.naming.Context;
import javax.naming.InitialContext;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import mdb.AdminMDB;

 public class UserServlet extends javax.servlet.http.HttpServlet implements javax.servlet.Servlet {
	 @Resource(name="DefaultActiveMQConnectionFactory")
	 private ConnectionFactory connectionFactory;
	 @Resource(name="SendReceiveQueue")
	 private Queue queue;
	 
	 static final long serialVersionUID = 1L;
   
     public UserServlet() {
		super();
	}   	
	
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		PrintWriter out = response.getWriter();
		if(connectionFactory == null) {
			out.println("Connection Factory lookup has failed");
			return;
		}
		
		if(queue == null) {
			out.println("Queue lookup has failed");
			return;
		}
		
	Connection connection;
		try{
			connection = connectionFactory.createConnection();
			connection.start();
			Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
			MessageProducer producer = session.createProducer(queue);
			TextMessage message = session.createTextMessage();
			Enumeration arr=request.getParameterNames();
			while(arr.hasMoreElements())
			{
			String fields= (String)arr.nextElement();
			String paramname[]=request.getParameterValues(fields);
			String s=null;
			int i;
			for (i=0; i&lt;paramname.length;i++)
			{	
			s=fields+":" + paramname[i];
			message.setText(s);
			producer.send(message);
			}
			}
			}
		catch(Exception e)
			{
				e.printStackTrace();
			}
	}
	
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		doGet(request, response);
	}   	  	    
}
</plain-text-body>
<br clear="none" class="atl-forced-newline"></li><li>Let us walkthrough the code
	<ul><li><strong>@Resource(name="DefaultActiveMQConnectionFactory")</strong>- This is a resource injection wherein connection factory has been injected.</li><li><strong>@Resource(name="SendReceiveQueue")</strong>- a queue has been injected. Resource injection is useful in the sense that we need not include the entries in a deployment descriptor.</li><li>Servlets follow a request response model wherein a request is send to servlet and a response is generated. The  function <strong>protected void doGet(....,....)</strong> follows a request response model.</li><li><strong>PrintWriter out = response.getWriter()</strong>- This statement returns a PrintWriter object which is used to send HTML content to client page.</li><li><strong>connection = connectionFactory.createConnection()</strong>- Creates a connection to <strong>DefaultActiveMQConnectionFactory</strong></li><li><strong>Session session = connection.createSession(..,..)</strong>- A session is a context for producing and consuming messages. Use this statement we create a new session.</li><li><strong>MessageProducer producer = session.createProducer(queue)</strong>- A client uses message producer to send messages to a destination. Queue name is passed to createProducer method provided by session object.</li><li><strong>TextMessage message = session.createTextMessage()</strong>- A TextMessage is used to send a message of java.lang.String type.</li></ul>
	</li></ol>


<ol><li>Right Click on WebContent and create a jsp.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/AddSource5.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Name the jsp as index.jsp. Select <strong>Next</strong>.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/AddSource6.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Select Finish.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/AddSource7.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
Add the following code to index.jsp
<parameter ac:name="borderStyle">solid</parameter><parameter ac:name="title">index.jsp</parameter><plain-text-body>
&lt;%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"&gt;
&lt;title&gt;Sample Web Application accessing JMS Resources&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form action="UserServlet"&gt;
&lt;h1&gt;Please enter the updated information&lt;/h1&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;UserName:&lt;/td&gt;
&lt;td&gt;&lt;input type="text" name="username" size="30"&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;UserID:&lt;/td&gt;
&lt;td&gt;&lt;input type="text" name="userid" size="30"&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Old Address:&lt;/td&gt;
&lt;td&gt;&lt;input type="text" name="oldaddress" size="30"&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;New Address:&lt;/td&gt;
&lt;td&gt;&lt;input type="text" name="newaddress" size="30"&gt;&lt;/td&gt;
&lt;tr&gt;
&lt;/table&gt;
&lt;input type="submit" value="Submit"&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</plain-text-body>
This will create the producer and user interface required by the application.</li></ol>


<h1 id="JMSapplicationwithMessage-DrivenBean-CreatingConnectionFactoryandDestination">Creating Connection Factory and Destination</h1>
<p>In simple terms a Connection Factory is an object which is used by a client to connect to the Service provider. In our case we will be using Active MQ as the provider. Destination is an object which is used by client to provide the target to messages produced and source of the messages to be consumed. In our case the target is going to be a queue. We will use the default connection factory and queue which is already available with Apache Geronimo.</p>

<h1 id="JMSapplicationwithMessage-DrivenBean-CreatingaEJBProject">Creating a EJB Project</h1>
<ol><li>Right click under project explorer and Select New-&gt; Project-&gt; EJB Project.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createejb.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Name the project as MessageDrivenBean and Select Next.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createejb2.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>On the next screen keep defaults and select Next.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createejb3.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>On the next screen uncheck <strong>Generate Deployment Descriptor</strong> and select Next.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createejb4.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Next screen suggests to configure Geronimo Deployment Plan. For current tutorial we are keeping the default values.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createejb5.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
This creates the skeleton of the EJB project. Next step is to add a pojo to our project and annotate it.</li><li>Right click on EJB project and select New-&gt;class.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createejb6.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Name the class as <strong>AdminMDB</strong> and package as <strong>mdb</strong>. Select Finish.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createejb7.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Add the following code to <strong>AdminMDB.java</strong>.
<parameter ac:name="borderStyle">solid</parameter><parameter ac:name="title">AdminMDB.java</parameter><plain-text-body>
package mdb;

//import java.sql.SQLException;

import javax.annotation.PostConstruct;
import javax.annotation.PreDestroy;
import javax.ejb.ActivationConfigProperty;
import javax.ejb.MessageDriven;
import javax.jms.JMSException;
import javax.jms.Message;
import javax.jms.MessageListener;
import javax.jms.TextMessage;

@MessageDriven(name="AdminMDB", activationConfig = {
	    @ActivationConfigProperty(propertyName="destinationType", propertyValue="javax.jms.Queue"),
	    @ActivationConfigProperty(propertyName="destination", propertyValue="SendReceiveQueue")
	})
public class AdminMDB implements MessageListener{
	
	public AdminMDB()
	{
		super();
	}
	@PostConstruct
	public void initialize() {
	}
	@PreDestroy
	public void cleanup()
	{
		
	}

	 public void onMessage(Message message) {
	        TextMessage textMessage = (TextMessage) message;
	        try {
	            System.out.println(textMessage.getText()+ "\n");
	       
	        } catch (JMSException e) {
	            e.printStackTrace();
	        }
	    }
	
}
</plain-text-body>
	<ul><li><strong>@MessageDriven</strong>- @MessageDriven annotation identifies this object as an MDB and specifies the MDB configuration</li><li><strong>@ActivationConfigProperty</strong>- This annotation provides messaging configuration which is a name value pair.</li><li><strong>propertyName="destinationType"</strong>- This suggests that MDB is listening to a queue or a topic. In our case <strong>propertyValue="javax.jms.Queue"</strong> suggesting MDB is listening to queue.</li><li><strong>propertyName="destination"</strong>- This suggests that our MDB is listening to a destination with a JNDI name <strong>SendReceiveQueue</strong> which is suggested by propertyValue="SendReceiveQueue".</li><li><strong>public class AdminMDB implements MessageListener</strong>- It is used by container to register MDB with message provider.</li><li><strong>public void onMessage(Message message)</strong>- This method processes incoming messages.</li></ul>
	</li></ol>


<h1 id="JMSapplicationwithMessage-DrivenBean-ModifyingDeploymentplan">Modifying Deployment plan</h1>
<ol><li>In <strong>WebMDB</strong> project select WebContent/WEB-INF/geronimo-web.xml and modify the content with the one shown below.
<parameter ac:name="borderStyle">solid</parameter><parameter ac:name="title">geronimo-web.xml</parameter><plain-text-body>
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;ns8:web-app xmlns="http://geronimo.apache.org/xml/ns/deployment-1.2" 
xmlns:ns2="http://geronimo.apache.org/xml/ns/j2ee/connector-1.2" 
xmlns:ns3="http://geronimo.apache.org/xml/ns/naming-1.2" 
xmlns:ns4="http://geronimo.apache.org/xml/ns/j2ee/ejb/openejb-2.0" 
xmlns:ns5="http://geronimo.apache.org/xml/ns/j2ee/application-2.0" 
xmlns:ns6="http://geronimo.apache.org/xml/ns/security-2.0" 
xmlns:ns7="http://java.sun.com/xml/ns/persistence" 
xmlns:ns8="http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1" 
xmlns:ns9="http://geronimo.apache.org/xml/ns/j2ee/application-client-2.0"&gt;
    &lt;environment&gt;
        &lt;moduleId&gt;
            &lt;groupId&gt;default&lt;/groupId&gt;
            &lt;artifactId&gt;WebMDB&lt;/artifactId&gt;
            &lt;version&gt;1.0&lt;/version&gt;
            &lt;type&gt;car&lt;/type&gt;
        &lt;/moduleId&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;default&lt;/groupId&gt;
                &lt;artifactId&gt;MessageDrivenBean&lt;/artifactId&gt;
                &lt;version&gt;1.0&lt;/version&gt;
                &lt;type&gt;car&lt;/type&gt;
            &lt;/dependency&gt;
        &lt;dependency&gt;
                &lt;groupId&gt;org.apache.geronimo.configs&lt;/groupId&gt;
                &lt;artifactId&gt;activemq-ra&lt;/artifactId&gt;
                &lt;version&gt;2.1.1&lt;/version&gt;
                &lt;type&gt;car&lt;/type&gt;
            &lt;/dependency&gt; 
        &lt;/dependencies&gt;
    &lt;/environment&gt;
    &lt;ns8:context-root&gt;/WebMDB&lt;/ns8:context-root&gt;
    &lt;ns3:resource-ref&gt;
        &lt;ns3:ref-name&gt;testfactory&lt;/ns3:ref-name&gt;
        &lt;ns3:resource-link&gt;DefaultActiveMQConnectionFactory&lt;/ns3:resource-link&gt;
   		&lt;/ns3:resource-ref&gt;
&lt;/ns8:web-app&gt;
</plain-text-body>
	<ul><li><strong>&lt;dependency&gt;</strong>- Defines the dependency of the application on ActiveMQ and MessageDrivenBean</li><li><strong>&lt;ns3:resource-ref&gt;</strong>- This tag is basically used to define connections that can be JDBC Connection, Java Mail connection or JMS Connection Factory. In our case we are using it for JMS Connection Factory.</li></ul>
	</li><li>In <strong>MessageDrivenBean</strong> project select META-INF/openejb-jar.xml and modify it as follows
<parameter ac:name="borderStyle">solid</parameter><parameter ac:name="title">openejb-jar.xml</parameter><plain-text-body>
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;openejb-jar xmlns="http://www.openejb.org/xml/ns/openejb-jar-2.2" 
xmlns:nam="http://geronimo.apache.org/xml/ns/naming-1.2" 
xmlns:pkgen="http://www.openejb.org/xml/ns/pkgen-2.0" 
xmlns:sec="http://geronimo.apache.org/xml/ns/security-1.2" 
xmlns:sys="http://geronimo.apache.org/xml/ns/deployment-1.2"&gt;
    &lt;sys:environment&gt;
        &lt;sys:moduleId&gt;
            &lt;sys:groupId&gt;default&lt;/sys:groupId&gt;
            &lt;sys:artifactId&gt;MessageDrivenBean&lt;/sys:artifactId&gt;
            &lt;sys:version&gt;1.0&lt;/sys:version&gt;
            &lt;sys:type&gt;car&lt;/sys:type&gt;
        &lt;/sys:moduleId&gt;
        &lt;sys:dependencies&gt;
        &lt;sys:dependency&gt;
        &lt;sys:groupId&gt;org.apache.geronimo.configs&lt;/sys:groupId&gt;
        &lt;sys:artifactId&gt;activemq-ra&lt;/sys:artifactId&gt;
        &lt;sys:version&gt;2.1.1&lt;/sys:version&gt;
        &lt;sys:type&gt;car&lt;/sys:type&gt;
        &lt;/sys:dependency&gt;
        &lt;/sys:dependencies&gt;
        &lt;/sys:environment&gt;
        &lt;enterprise-beans&gt;
          &lt;message-driven&gt;
            &lt;ejb-name&gt;AdminMDB&lt;/ejb-name&gt;
    		&lt;nam:resource-adapter&gt;
     		&lt;nam:resource-link&gt;ActiveMQ RA&lt;/nam:resource-link&gt;
    		&lt;/nam:resource-adapter&gt;
    		
    		&lt;activation-config&gt;

     &lt;activation-config-property&gt;
      &lt;activation-config-property-name&gt;
       destination
      &lt;/activation-config-property-name&gt;
      &lt;activation-config-property-value&gt;
      SendReceiveQueue
      &lt;/activation-config-property-value&gt;
     &lt;/activation-config-property&gt;
      &lt;activation-config-property&gt;
       &lt;activation-config-property-name&gt;
        destinationType
       &lt;/activation-config-property-name&gt;
       &lt;activation-config-property-value&gt;
        javax.jms.Queue&lt;/activation-config-property-value&gt;
       &lt;/activation-config-property&gt;

      &lt;/activation-config&gt;
   			&lt;/message-driven&gt;
            &lt;/enterprise-beans&gt;
&lt;/openejb-jar&gt;
</plain-text-body>
<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
	<ul><li><strong>&lt;enterprise-beans&gt;</strong>- This tag suggests that the usage of EJB's in our application.</li><li><strong>&lt;message-driven&gt;</strong>- This tag suggest the usage of MDB's in our application.</li><li><strong>&lt;ejb-name&gt;</strong>- Name of the ejb.</li><li><strong>&lt;nam:resource-link&gt;</strong>- Link for the resource adapter.<br clear="none">
To learn more on MDB deployment plans refer <a shape="rect" href="creating-deployment-plans.html">Creating deployment plans</a> section.
<h1 id="JMSapplicationwithMessage-DrivenBean-DeployandRun">Deploy and Run</h1></li></ul>
	</li><li>Export MessageDrivenBean.jar and WebMDB.war from eclipse as shown in the figure below<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/run.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/run2.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Launch Administrative console and deploy the EJB and Web Application using Deploy New.</li><li>Once done launch the web application with http://localhost:8080/WebMDB/.\\ <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/run3.png"></span></li><li>Fill the form as suggested in the figure and Select Submit.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/run4.png"></span><br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"></li><li>Once done check out the command prompt. Message Driven Bean has triggered and it displays the message currently on the queue.<br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline"> <br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/run5.png"></span></li></ol></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tr>
          <td align="left" valign="middle" class="footer">
            &nbsp;&nbsp;
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="Delicious" />
            <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">Bookmark this on Delicious</a>
            &nbsp;&nbsp;
            <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="Digg!" />
            <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)+'&amp;topic=programming');">Digg this</a>
            <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : JMS application with Message-Driven Bean';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
            &nbsp;&nbsp;
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;-&nbsp;&nbsp;
            Copyright &#169; 2003-2013, The Apache Software Foundation, Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0.</a>&nbsp;&nbsp;
          </td>
        </tr>
    </table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  </body>
</html>
