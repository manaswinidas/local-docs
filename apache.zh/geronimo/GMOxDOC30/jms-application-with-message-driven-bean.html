<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=2">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="JMS application with Message-Driven Bean">
    <meta name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi JMS application with Message-Driven Bean">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2010-05-11">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0文档：带有消息驱动Bean的JMS应用程序</title>
  </head>

  <body  onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">主页</a> > <a href="documentation.html">文档</a> > <a href="developing.html">开发</a> > <a href="tutorials.html">教程</a> > <a href="developing-ejb-applications.html">开发EJB应用程序</a> > <a href="jms-application-with-message-driven-bean.html">带有消息驱动Bean的JMS应用程序</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo v3.0</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">带有消息驱动Bean的JMS应用程序</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645240"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645240">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645240"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645240">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645240"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645240">添加新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>
<p>该应用程序是一个简单的JMS应用程序，用户可以在其中向管理员发送信息以进行更新。</p>

<p>要运行本教程，至少需要您安装以下必备软件。</p>

<ul><li>Sun JDK 5.0+（J2SE 1.5）</li><li>Eclipse 3.3.1.1（Europa发行版的Eclipse Classic软件包），特定于平台</li><li>Web工具平台（WTP）2.0.1</li><li>数据工具平台（DTP）1.5.1</li><li>Eclipse建模框架（EMF）2.3.1</li><li>图形编辑框架（GEF）3.3.1</li></ul>


<p><a shape="rect" href="development-environment.html">开发环境</a>部分中提供了有关安装Eclipse的详细信息。本教程分为以下几节：</p>

<p>应用程序开发将带您完成以下操作</p>

<h1 id="JMSapplicationwithMessage-DrivenBean-CreatingaDynamicWebProject">创建一个动态Web项目</h1>
<ol><li>启动Eclipse。选择<strong>File-> New-> Project</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createproj.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>选择<strong>Web-> Dynamic Web Project</strong> 。选择<strong>下一步</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createproj2.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将项目命名为<strong>WebMDB</strong> 。选择下一步。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createproj4.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>下一个窗口显示各个项目方面。保留默认值，然后选择下一步。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createproj5.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>保留下一个窗口的默认值。选择下一步->完成。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createproj6.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createproj7.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>右键单击<strong>WebMDB</strong>项目并创建一个新的<strong>servlet</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/AddSource.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将servlet命名为<strong>UserServlet，</strong>并将包<strong>命名</strong>为<strong>webmdb</strong> 。这是应用程序中的生产者。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/AddSource1.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>选择下一步，然后选择<strong>完成</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/AddSource2.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将以下代码添加到UserServlet.java <parameter ac:name="borderStyle">固体</parameter> <parameter ac:name="title">UserServlet.java</parameter> <plain-text-body>包webmdb中；导入java.io。IOException;导入java.io。PrintWriter;导入java.util。列举;导入java.util。属性；导入javax.annotation。资源；导入javax.jms。连接;导入javax.jms。ConnectionFactory;导入javax.jms。JMSException;导入javax.jms。MessageListener;导入javax.jms。MessageProducer;导入javax.jms。队列;导入javax.jms。会议；导入javax.jms。TextMessage;导入javax.naming。上下文；导入javax.naming。InitialContext;导入javax.servlet。ServletException;导入javax.servlet.http。HttpServletRequest;导入javax.servlet.http。HttpServletResponse;导入mdb。AdminMDB；公共类UserServlet扩展了javax.servlet.http。HttpServlet实现javax.servlet。Servlet {@Resource（name =“ DefaultActiveMQConnectionFactory”）私人ConnectionFactory connectionFactory; @Resource（name =“ SendReceiveQueue”）私有队列队列；静态最终长serialVersionUID = 1L;公共UserServlet（）{super（）; }受保护的void doGet（HttpServletRequest请求，HttpServletResponse响应）抛出ServletException，IOException {PrintWriter out = response.getWriter（）; if（connectionFactory == null）{out.println（“连接工厂查找失败”）;返回; } if（queue == null）{out.println（“队列查找失败”）;返回; }连接连接；尝试{connection = connectionFactory.createConnection（）; connection.start（）;会话会话= connection.createSession（false，会话。AUTO_ACKNOWLEDGE）; MessageProducer生产者= session.createProducer（queue）; TextMessage消息= session.createTextMessage（）;枚举arr = request.getParameterNames（）; while（arr.hasMoreElements（））{字符串字段=（String）arr.nextElement（）;字符串paramname [] = request.getParameterValues（fields）;字符串s = null;我对于（i = 0; i <paramname.length;i++) {="" s="fields+":"" +="" paramname[i];="" message.settext(s);="" producer.send(message);="" }="" catch(exception="" e)="" e.printstacktrace();="" protected="" void="" dopost(httpservletrequest="" request,="" httpservletresponse="" response)="" throws="" servletexception,="" ioexception="" doget(request,="" response);=""><="" /plain-text-body="">
<br class="atl-forced-newline" clear="none"></paramname.length;i++)></plain-text-body></li><li>让我们浏览一下代码<ul><li><strong>@Resource（name =“ DefaultActiveMQConnectionFactory”）</strong> -这是资源注入，其中已注入连接工厂。</li><li><strong>@Resource（name =“ SendReceiveQueue”）</strong> -已注入队列。从不需要在部署描述符中包含条目的意义上来说，资源注入很有用。</li><li>Servlet遵循请求响应模型，其中将请求发送到Servlet并生成响应。<strong>受保护的void doGet（....，....）</strong>遵循请求响应模型。</li><li><strong>PrintWriter out = response.getWriter（）</strong> -此语句返回一个PrintWriter对象，该对象用于将HTML内容发送到客户端页面。</li><li><strong>connection = connectionFactory.createConnection（）</strong> -创建与<strong>DefaultActiveMQConnectionFactory</strong>的连接</li><li><strong>会话会话= connection.createSession（..，..）</strong> -会话是用于生成和使用消息的上下文。使用此语句，我们创建一个新会话。</li><li><strong>MessageProducer生产者= session.createProducer（queue）</strong> -客户端使用消息生产者将消息发送到目标。队列名称传递给会话对象提供的createProducer方法。</li><li><strong>TextMessage message = session.createTextMessage（）</strong> -TextMessage用于发送java.lang的消息。字符串类型。</li></ul>
	</li></ol>


<ol><li>右键单击WebContent并创建一个jsp。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/AddSource5.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将jsp命名为index.jsp。选择<strong>下一步</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/AddSource6.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>选择完成。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/AddSource7.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">将以下代码添加到index.jsp <parameter ac:name="borderStyle">固体</parameter> <parameter ac:name="title">index.jsp</parameter> <plain-text-body><％@页面语言=“ java” contentType =“ text / html; charset = ISO-8859-1” pageEncoding =“ ISO-8859-1”％> 

<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>示例Web应用程序访问JMS资源</title>


<form action="UserServlet">
<h1>请输入更新的信息</h1>
<table>
<tbody><tr>
<td>用户名：</td>
<td><input type="text" name="username" size="30"></td>
</tr>
<tr>
<td>用户身份：</td>
<td><input type="text" name="userid" size="30"></td>
</tr>
<tr>
<td>旧地址：</td>
<td><input type="text" name="oldaddress" size="30"></td>
</tr>
<tr>
<td>新地址：</td>
<td><input type="text" name="newaddress" size="30"></td>
</tr><tr>
</tr></tbody></table>
<input type="submit" value="提交">
</form>


</plain-text-body>这将创建应用程序所需的生产者和用户界面。</li></ol>


<h1 id="JMSapplicationwithMessage-DrivenBean-CreatingConnectionFactoryandDestination">创建连接工厂和目标</h1>
<p>简而言之，连接工厂是客户端用于连接服务提供者的对象。在我们的例子中，我们将使用Active MQ作为提供程序。目标是客户端用来为生成的消息提供目标以及要使用的消息源的对象。在我们的例子中，目标将是一个队列。我们将使用Apache Geronimo已提供的默认连接工厂和队列。</p>

<h1 id="JMSapplicationwithMessage-DrivenBean-CreatingaEJBProject">创建一个EJB项目</h1>
<ol><li>右键单击项目浏览器下的，然后选择新建->项目-> EJB项目。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createejb.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将项目命名为MessageDrivenBean，然后选择“下一步”。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createejb2.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>在下一个屏幕上，保留默认值，然后选择“下一步”。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createejb3.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>在下一屏幕上，取消选中“ <strong>生成部署描述符”，</strong>然后选择“下一步”。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createejb4.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>下一个屏幕建议配置Geronimo部署计划。对于当前教程，我们保留默认值。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createejb5.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">这将创建EJB项目的框架。下一步是将pojo添加到我们的项目中并对其进行注释。</li><li>右键单击EJB项目，然后选择New-> class。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createejb6.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将类命名为<strong>AdminMDB</strong> ，将包<strong>命名</strong>为<strong>mdb</strong> 。选择完成。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/createejb7.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将以下代码添加到<strong>AdminMDB.java</strong> 。
<parameter ac:name="borderStyle">坚实的</parameter> <parameter ac:name="title">AdminMDB.java</parameter> <plain-text-body>软件包mdb; //导入java.sql。SQLException;导入javax.annotation。PostConstruct;导入javax.annotation。预销毁；导入javax.ejb。ActivationConfigProperty;导入javax.ejb。MessageDriven;导入javax.jms。JMSException;导入javax.jms。信息;导入javax.jms。MessageListener;导入javax.jms。TextMessage; @MessageDriven（name =“ AdminMDB”，activationConfig = {@ActivationConfigProperty（propertyName =“ destinationType”，propertyValue =“ javax.jms。Queue“），@ActivationConfigProperty（propertyName =” destination“，propertyValue =” SendReceiveQueue“）}）公共类AdminMDB实现MessageListener {public AdminMDB（）{super（）;} @PostConstruct public void initialize（）{} @} PreDestroy public void cleanup（）{} public void onMessage（消息）{TextMessage textMessage =（TextMessage）消息；尝试{System.out.println（textMessage.getText（）+“ \ n”）;}捕获（JMSException e）{e。 printStackTrace（）;}}}</plain-text-body>
	<ul><li><strong>@MessageDriven-@</strong> MessageDriven批注将此对象标识为MDB并指定MDB配置</li><li><strong>@ActivationConfigProperty-</strong>此批注提供消息传递配置，这是一个名称/值对。</li><li><strong>propertyName =“ destinationType”</strong> -这表明MDB正在侦听队列或主题。在我们的示例中为<strong>propertyValue =“ javax.jms。队列”，</strong>表明MDB正在监听队列。</li><li><strong>propertyName =“ destination”</strong> -这表明我们的MDB正在侦听一个由propertyValue =“ SendReceiveQueue”建议的JNDI名称<strong>SendReceiveQueue</strong>的目的地。</li><li><strong>公共类AdminMDB实现MessageListener-</strong>容器用于将MDB注册到消息提供程序。</li><li><strong>public void onMessage（Message message）</strong> -此方法处理传入的消息。</li></ul>
	</li></ol>


<h1 id="JMSapplicationwithMessage-DrivenBean-ModifyingDeploymentplan">修改部署计划</h1>
<ol><li>在<strong>WebMDB</strong>项目中，选择WebContent / WEB-INF / geronimo-web.xml并使用下面显示的内容修改内容。
<parameter ac:name="borderStyle">固态</parameter> <parameter ac:name="title">geronimo-web.xml</parameter> <plain-text-body><!--?xml version="1.0" encoding="UTF-8" standalone="yes" ?=""--><ns8:web-app xmlns="http://geronimo.apache.org/xml/ns/deployment-1.2" xmlns:ns2="http://geronimo.apache.org/xml/ns/j2ee/connector-1.2" xmlns:ns3="http://geronimo.apache.org/xml/ns/naming-1.2" xmlns:ns4="http://geronimo.apache.org/xml/ns/j2ee/ejb/openejb-2.0" xmlns:ns5="http://geronimo.apache.org/xml/ns/j2ee/application-2.0" xmlns:ns6="http://geronimo.apache.org/xml/ns/security-2.0" xmlns:ns7="http://java.sun.com/xml/ns/persistence" xmlns:ns8="http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1" xmlns:ns9="http://geronimo.apache.org/xml/ns/j2ee/application-client-2.0"><environment><moduleid><groupid>默认</groupid> <artifactid>WebMDB</artifactid> <version>1.0</version> <type>汽车</type></moduleid> <dependencies><dependency><groupid>默认</groupid> <artifactid>MessageDrivenBean</artifactid> <version>1.0</version> <type>汽车</type></dependency> <dependency><groupid>org.apache.geronimo.configs</groupid> <artifactid>activemq-ra</artifactid> <version>2.1.1</version> <type>汽车</type></dependency></dependencies></environment> <ns8:context-root>/ WebMDB</ns8:context-root> <ns3:resource-ref><ns3:ref-name>testfactory</ns3:ref-name> <ns3:resource-link>DefaultActiveMQConnectionFactory</ns3:resource-link></ns3:resource-ref></ns8:web-app><!--?xml--></plain-text-body>
	<ul><li><strong><dependency></dependency></strong> -定义应用程序对ActiveMQ和MessageDrivenBean的依赖性</li><li><strong><ns3:resource-ref></ns3:resource-ref></strong> -该标签基本上用于定义可以是JDBC连接，Java Mail连接或JMS连接工厂的连接。在本例中，我们将其用于JMS Connection Factory。</li></ul>
	</li><li>在<strong>MessageDrivenBean</strong>项目中，选择META-INF / openejb-jar.xml，然后按如下所示对其进行修改： <parameter ac:name="borderStyle">固体</parameter> <parameter ac:name="title">openejb-jar.xml</parameter> <plain-text-body><!--?xml version="1.0" encoding="UTF-8" standalone="yes" ?=""--><openejb-jar xmlns="http://www.openejb.org/xml/ns/openejb-jar-2.2" xmlns:nam="http://geronimo.apache.org/xml/ns/naming-1.2" xmlns:pkgen="http://www.openejb.org/xml/ns/pkgen-2.0" xmlns:sec="http://geronimo.apache.org/xml/ns/security-1.2" xmlns:sys="http://geronimo.apache.org/xml/ns/deployment-1.2"><sys:environment><sys:moduleid><sys:groupid>默认</sys:groupid> <sys:artifactid>MessageDrivenBean</sys:artifactid> <sys:version>1.0</sys:version> <sys:type>car</sys:type></sys:moduleid> <sys:dependencies><sys:dependency><sys:groupid>org.apache.geronimo.configs</sys:groupid> <sys:artifactid>activemq-ra</sys:artifactid> <sys:version>2.1.1</sys:version> <sys:type>car</sys:type></sys:dependency></sys:dependencies></sys:environment> <enterprise-beans><message-driven><ejb-name>AdminMDB</ejb-name> <nam:resource-adapter><nam:resource-link>ActiveMQ RA</nam:resource-link></nam:resource-adapter> <activation-config><activation-config-property><activation-config-property-name>目标</activation-config-property-name> <activation-config-property-value>SendReceiveQueue</activation-config-property-value></activation-config-property> <activation-config-property><activation-config-property-name>destinationType</activation-config-property-name> <activation-config-property-value>javax。 jms。队列</activation-config-property-value>
       </activation-config-property>

      </activation-config>
   			</message-driven>
            </enterprise-beans>
</openejb-jar>
<!--?xml--></plain-text-body>
<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
	<ul><li><strong><enterprise-beans></enterprise-beans></strong> -此标签建议在我们的应用程序中使用EJB。</li><li><strong><message-driven></message-driven></strong> -此标签建议在我们的应用程序中使用MDB。</li><li><strong><ejb-name></ejb-name></strong> -ejb的名称。</li><li><strong><nam:resource-link></nam:resource-link></strong> -资源适配器的链接。<br clear="none">要了解有关MDB部署计划的更多信息，请参阅“ <a shape="rect" href="creating-deployment-plans.html">创建部署计划”</a>部分。
<h1 id="JMSapplicationwithMessage-DrivenBean-DeployandRun">部署并运行</h1></li></ul>
	</li><li>从eclipse导出MessageDrivenBean.jar和WebMDB.war，如下图所示<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/run.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/run2.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>启动管理控制台，并使用Deploy New部署EJB和Web应用程序。</li><li>完成后，使用http：// localhost：8080 / WebMDB /启动Web应用程序。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/run3.png"></span></li><li>按照图中的建议填写表单，然后选择提交。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/run4.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>完成后，请检查命令提示符。消息驱动Bean已触发，它显示队列中当前的消息。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jms-application-with-message-driven-bean.data/run5.png"></span></li></ol></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : JMS application with Message-Driven Bean';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2013，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  

</body></html>