<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=0">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="Creating deployment plans for enterprise applications">
    <meta name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Creating deployment plans for enterprise applications">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2010-05-11">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0文档：为企业应用程序创建部署计划</title>
  </head>

  <body  onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">主页</a> > <a href="documentation.html">文档</a> > <a href="creating-deployment-plans.html">创建部署计划</a> > <a href="creating-deployment-plans-for-applications.html">为应用程序</a> <a href="creating-deployment-plans-for-enterprise-applications.html">创建部署计划</a> > <a href="creating-deployment-plans-for-enterprise-applications.html">为企业应用程序创建部署计划</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo v3.0</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">为企业应用程序创建部署计划</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645276"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645276">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645276"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645276">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645276"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645276">添加新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>
<p>企业应用程序归档文件（ <code>EAR</code> ）可以包含许多子模块。子模块可以是Web模块（ <code>WAR</code> ），ejb模块（ <code>JAR</code> ），资源适配器模块（ <code>RAR</code> ）或应用程序客户端模块（ <code>jar</code> ）。<parameter ac:name="atlassian-macro-output-type">排队</parameter><rich-text-body></rich-text-body></p><p>当一个<code>EAR</code>由许多子模块组成，所有子模块的部署计划都可以在一个名为的文件中提供<code>geronimo-application.xml</code> 。</p>该单个文件包含该服务器每个子模块的部署详细信息<code>EAR</code> 。或者，每个子模块都可以在其内部打包其相应的部署计划文件。但是，最好的方法是通过以下方式提供单个部署计划<code>geronimo-application.xml</code>对于所有子模块。这种机制提供了灵活性，允许我们通过一个文件修改所有模块的部署配置。在本节中，我们探索<code>EAR</code>部署计划，并了解其中包含的内容。<p></p>

<rich-text-body>
<p>可以将3个部署计划（部分）与一个耳朵相关联，并按以下顺序使用它们：</p>

<p>1.在部署时指定外部计划<br clear="none">2.耳朵级别geronimo-application.xml<br clear="none">3.模块级geronimo | openejb-*。xml</p>

<p>因此，外部计划中的所有内容都优先于配置同一模块的（2）或（3）中的位。（2）中的任何内容都优先于模块级别的计划。如果（1）中缺少在（2）中寻找的模块级计划，则（3）;如果（1）和（2）中缺少，则在模块（3）中寻找它。</p>

<p>没有尝试合并来自这些不同位置的计划：例如，如果某个模块中的（1）中包含某些内容，那么将忽略任何其他计划。</p></rich-text-body>

<p>企业应用程序归档文件（ <code>EAR</code> ）应在<a shape="rect" class="external-link" href="http://java.sun.com/xml/ns/javaee/application_5.xsd" rel="nofollow">application.xml</a>文件中提供其部署描述符。的<code>application.xml</code>列出了所有子模块<code>EAR</code>文件以及说明。除了标准的部署描述符外， <code>EAR</code>还应该在<a shape="rect" class="external-link" href="http://geronimo.apache.org/xml/ns/j2ee/application-2.0">geronimo-application.xml中</a>提供Geronimo特定的部署计划。连同对每个子模块的描述<code>EAR</code>文件，该文件还提供每个子模块在其部署描述符中引用的JEE资源的映射。的<code>geronimo-application.xml</code>分为几个部分，每个部分中都提供了子模块的部署计划。 <code>geronimo-application.xml</code>是提供所有子模块部署计划的最高级别计划；因此，它可以包含Geronimo应用程序部署程序使用的所有其他Geronimo XML模式的XML元素。的<code>geronimo-application.xml</code>是所有其他部署计划的超级集。</p>

<p>例如，以下是<code>EAR</code>它具有一个Web模块和一个ejb模块。</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="creating-deployment-plans-for-enterprise-applications.data/ear-structure.GIF"></span></p>

<p>的<code>Order.ear</code>上面显示的文件包含两个模块。一个是<code>OrderWEB.war</code>该文件是一个网络模块，另一个是<code>OrderEJB.jar</code>该文件是ejb模块。的<code>META-INF</code>文件夹中<code>Order.ear</code>包含应用程序部署描述符（ <code>application.xml</code> ）和Geronimo应用程序部署计划（ <code>geronimo-application.xml</code> ）。Web应用程序和ejb应用程序仅打包了它们各自的部署描述符。但是这些模块的部署计划在<code>geronimo-application.xml</code> 。<br clear="none">网络应用程序（ <code>OrderWAR.war</code> ）在中查找无状态会话bean <code>OrderEJB.jar</code>模块以检索订单信息。的<code>RetrieveOrderInfoBean</code>在<code>OrderEJB.jar</code>模块使用JDBC连接从DB2数据库读取订单信息。</p>

<p>OrderEJB.jar的部署描述符如下。</p>

<parameter ac:name="title">ejb-jar.xml</parameter> <parameter ac:name="borderStyle">实心的</parameter> <plain-text-body><!--?xml version="1.0" encoding="UTF-8" ?=""--><ejb-jar xmlns="http://java.sun.com/xml/ns/javaee" version="3.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemalocation="http://java.sun.com/xml/ns/javaee 
         http://java.sun.com/xml/ns/javaee/ejb-jar_3_0.xsd"><description>无状态会话Bean示例</description> <display-name>无状态会话Bean示例</display-name> <enterprise-beans><session><ejb-name>RetrieveOrderInfoBean</ejb-name> <business-local>examples.session.stateless_dd。RetrieveOrderInfo</business-local> <ejb-class>examples.session.stateless_dd。RetrieveOrderInfoBean</ejb-class> <session-type>无状态</session-type> <transaction-type>容器</transaction-type> <resource-ref><res-ref-name>jdbc / DB2DataSource</res-ref-name> <res-type>javax.sql。数据源</res-type> <res-auth>容器</res-auth> <res-sharing-scope>可共享的</res-sharing-scope></resource-ref></session></enterprise-beans> <interceptors><interceptor><interceptor-class>examples.session.stateless_dd。RetrieveOrderCallbacks</interceptor-class> <post-construct><lifecycle-callback-method>构造</lifecycle-callback-method></post-construct> <pre-destroy><lifecycle-callback-method>销毁</lifecycle-callback-method></pre-destroy></interceptor></interceptors> <assembly-descriptor><interceptor-binding><ejb-name>RetrieveOrderInfoBean</ejb-name> <interceptor-class>examples.session.stateless_dd。RetrieveOrderCallbacks</interceptor-class>
        </interceptor-binding>
    </assembly-descriptor>  
</ejb-jar>
<!--?xml--></plain-text-body>
<rich-text-body><p>上面的XML文档的默认名称空间是<code><a shape="rect" class="external-link" href="http://java.sun.com/xml/ns/javaee" rel="nofollow">http://java.sun.com/xml/ns/javaee</a></code> 。没有名称空间前缀的XML元素属于默认名称空间。</p></rich-text-body>
<p>在里面<code>RetrieveOrderInfoBean</code> ，以下代码用于查找Datasource对象并获得数据库连接。</p>

<parameter ac:name="">JAVA</parameter> <parameter ac:name="title">examples.session.stateless_dd。RetrieveOrderInfoBean</parameter> <parameter ac:name="borderStyle">固体</parameter> <plain-text-body>......上下文initContext = new InitialContext（）;上下文envContext =（Context）initContext.lookup（“ java：comp / env”）;数据源ds =（DataSource）envContext.lookup（“ jdbc / DB2DataSource”）; System.out.println（“ Got DataSource \ n”）; con = ds.getConnection（）; System.out.println（“ Got Connection \ n”）; ......
</plain-text-body>


<p>的部署描述符<code>OrderWEB.war</code>如下。</p>

<parameter ac:name="title">web.xml</parameter> <parameter ac:name="borderStyle">实体</parameter> <plain-text-body><!--?xml version="1.0" encoding="UTF-8" ?=""--><web-app id="WebApp_ID" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemalocation="http://java.sun.com/xml/ns/javaee
         http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" version="2.5"><display-name>OrderWEB</display-name> <welcome-file-list><welcome-file>index.html</welcome-file> <welcome-file>index.htm</welcome-file> <welcome-file>index.jsp</welcome-file> <welcome-file>default.html</welcome-file> <welcome-file>default.htm</welcome-file> <welcome-file>default.jsp</welcome-file></welcome-file-list> <servlet><description></description> <display-name>RetrieveOrder</display-name> <servlet-name>RetrieveOrder</servlet-name> <servlet-class>examples.web.servlet。RetrieveOrder</servlet-class></servlet> <ejb-local-ref><ejb-ref-name>ejb / RetrieveOrderInfo</ejb-ref-name> <ejb-ref-type>会话</ejb-ref-type> <local>examples.session.stateless_dd。RetrieveOrderInfo</local> <ejb-link>RetrieveOrderInfoBean</ejb-link></ejb-local-ref> <servlet-mapping><servlet-name>RetrieveOrder</servlet-name> <url-pattern>/ RetrieveOrder</url-pattern></servlet-mapping>
</web-app>
<!--?xml--></plain-text-body>
<rich-text-body><p>上面的XML文档的默认名称空间是<code><a shape="rect" class="external-link" href="http://java.sun.com/xml/ns/javaee" rel="nofollow">http://java.sun.com/xml/ns/javaee</a></code> 。没有名称空间前缀的XML元素属于默认名称空间。</p></rich-text-body>
<p>在里面<code>RetrieveOrder</code> servlet，以下代码用于查找ejb以检索订单详细信息。</p>

<parameter ac:name="">JAVA</parameter> <parameter ac:name="title">examples.web.servlet。RetrieveOrder</parameter> <parameter ac:name="borderStyle">固体</parameter> <plain-text-body>......上下文ctx = new InitialContext（）; System.out.println（“ Instantiating beans ...”）; resolveOInfo =（RetrieveOrderInfo）ctx.lookup（“ java：comp / env / ejb / RetrieveOrderInfo”）;字符串orderIdStr = request.getParameter（“ orderid”）; int orderId = Integer.parseInt（orderIdStr）; OrderInfo oInfo = RetrieveOInfo.getOrderInfo（orderId）; ......
</plain-text-body>      


<p>Order.ear的部署描述符如下。</p>

<parameter ac:name="title">application.xml</parameter> <parameter ac:name="borderStyle">solid</parameter> <plain-text-body><!--?xml version="1.0" encoding="UTF-8" ?=""--><application xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:application="http://java.sun.com/xml/ns/javaee/application_5.xsd" xsi:schemalocation="http://java.sun.com/xml/ns/javaee 
			 http://java.sun.com/xml/ns/j2ee/application_5.xsd" version="5"><description>EAR示例</description> <display-name>订单示例</display-name> <module><web><web-uri>OrderWEB.war</web-uri> <context-root>/ OrderDemo</context-root></web></module> <module><ejb>OrderEJB.jar</ejb></module></application><!--?xml--></plain-text-body>
<rich-text-body><p>上面的XML文档的默认名称空间是<code><a shape="rect" class="external-link" href="http://java.sun.com/xml/ns/javaee" rel="nofollow">http://java.sun.com/xml/ns/javaee</a></code> 。没有名称空间前缀的XML元素属于默认名称空间。</p></rich-text-body>
<p>的部署计划<code>Order.ear</code>如下。</p>

<parameter ac:name="title">的geronimo-application.xml中</parameter> <parameter ac:name="borderStyle">固体</parameter> <plain-text-body><!--?xml version="1.0" encoding="UTF-8" ?=""--><application xmlns="http://geronimo.apache.org/xml/ns/j2ee/application-2.0" xmlns:sys="http://geronimo.apache.org/xml/ns/deployment-1.2" application-name="Order"><sys:environment><sys:moduleid><sys:groupid>订单</sys:groupid> <sys:artifactid>OrderEAR</sys:artifactid> <sys:version>5.0</sys:version> <sys:type>汽车</sys:type></sys:moduleid></sys:environment> <module><web>OrderWEB.war</web> <web-app xmlns="http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1"><sys:environment><sys:moduleid><sys:groupid>订单</sys:groupid> <sys:artifactid>OrderWEB</sys:artifactid> <sys:version>2.5</sys:version> <sys:type>战</sys:type></sys:moduleid></sys:environment> <context-root>/ OrderDemo</context-root></web-app></module> <module><ejb>OrderEJB.jar</ejb> <openejb-jar xmlns="http://openejb.apache.org/xml/ns/openejb-jar-2.2" xmlns:naming="http://geronimo.apache.org/xml/ns/naming-1.2"><sys:environment><sys:moduleid><sys:groupid>订单</sys:groupid> <sys:artifactid>OrderEJB的</sys:artifactid> <sys:version>3.0</sys:version> <sys:type>罐子</sys:type></sys:moduleid> <sys:dependencies><sys:dependency><sys:groupid>console.dbpool</sys:groupid> <sys:artifactid>OrderDS</sys:artifactid> <sys:version>1.0</sys:version> <sys:type>RAR</sys:type></sys:dependency></sys:dependencies></sys:environment> <enterprise-beans><session><ejb-name>RetrieveOrderInfoBean</ejb-name> <naming:resource-ref><naming:ref-name>JDBC / DB2DataSource</naming:ref-name> <naming:resource-link>OrderDS</naming:resource-link></naming:resource-ref></session></enterprise-beans></openejb-jar></module></application><!--?xml--></plain-text-body>
<rich-text-body><p>上面的XML文档的默认名称空间是<code><a shape="rect" class="external-link" href="http://geronimo.apache.org/xml/ns/j2ee/application-2.0">http://geronimo.apache.org/xml/ns/j2ee/application-2.0</a></code> 。没有名称空间前缀的XML元素属于默认名称空间。</p></rich-text-body>
<p>观察JEE 5资源名称和ejb名称在<code>ejb-jar.xml</code>和<code>web.xml</code>通过以下方式映射到服务器中部署的实际资源<code>geronimo-application.xml</code> 。</p>

<p>我们可以从<code>geronimo-application.xml</code> ，其中包含了Web和ejb模块的部署计划<code><module> .... </module></code>元素。用于提供Web模块部署计划的xml元素来自模式<a shape="rect" class="external-link" href="http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1">http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1</a> ，该模式是<code>geronimo-web.xml</code> 。同样，用于提供ejb部署计划的xml元素来自模式<a shape="rect" class="external-link" href="http://openejb.apache.org/xml/ns/openejb-jar-2.2">http://openejb.apache.org/xml/ns/openejb-jar-2.2</a> ，该模式是<code>openejb-jar.xml</code> 。因此， <code>geronimo-application.xml</code>从所有其他模式中借用元素以为其子模块提供部署计划。</p>

<p>另外，请注意<code>geronimo-application.xml</code> ，以及用于<code>EAR</code>本身，每个Web和ejb模块都有一个moduleId配置。如果以上<code>EAR</code>部署在服务器上的文件并列出配置，将在控制台上显示以下输出。</p>

<parameter ac:name="borderStyle">固态</parameter> <plain-text-body>C：\ Geronimo-2.1 \ bin> deploy.bat --user system --password manager列表模块使用GERONIMO_BASE：C：\ Geronimo-2.1使用GERONIMO_HOME：C：\ Geronimo-2.1使用GERONIMO_TMPDIR：var \ temp使用JRE_HOME ：C：\ sun \ jre找到92个模块+ Order / OrderEAR / 5.0 / car`-> OrderWEB.war`-> OrderEJB.jar + console.dbpool / OrderDS / 1.0 / rar</plain-text-body>

<p>moduleId <code>Order/OrderEAR/5.0/car</code>是该配置<code>Order.ear</code> 。ejb模块声明了对<code>console.dbpool/OrderDS/1.0/rar</code>在配置<code><sys:dependencies></code>部分。这是连接到存储订单详细信息的DB2数据库的数据库池的moduleId。</p></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Creating deployment plans for enterprise applications';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2013，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  

</body></html>