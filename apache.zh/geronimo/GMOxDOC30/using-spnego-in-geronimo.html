<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link type="text/css" rel="stylesheet" href="http://geronimo.apache.org/style/default.css">
    <LINK rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <META name="Description" content="Using SPNEGO in Geronimo" />
    <META name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Using SPNEGO in Geronimo" />
    <META name="Owner" content="dev@geronimo.apache.org" />
    <META name="Robots" content="index, follow" />
    <META name="Security" content="Public" />
    <META name="Source" content="wiki template" />
    <META name="DC.Date" scheme="iso8601" content="2010-05-11" />
    <META name="DC.Language" scheme="rfc1766" content="en" />
    <META name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation" />
    <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>

  <link href='http://geronimo.apache.org/resources/highlighter/styles/shCoreGeronimo.css' rel='stylesheet' type='text/css' />
  <link href='http://geronimo.apache.org/resources/highlighter/styles/shThemeGeronimo.css' rel='stylesheet' type='text/css' />
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shCore.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushJava.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushXml.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushPlain.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushBash.js' type='text/javascript'></script>
  
  <script type="text/javascript">
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
  </script>

    <title>Apache Geronimo v3.0 Documentation: Using SPNEGO in Geronimo</title>
  </head>

  <body onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tr>
        <td valing="top" align="left">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" align="left" nowrap>
          <a href="/geronimo"> Home</a> >&nbsp;<a href="documentation.html">Documentation</a>&nbsp;&gt;&nbsp;<a href="configuring-and-administering.html">Configuring and administering</a>&nbsp;&gt;&nbsp;<a href="administering-security.html">Administering Security</a>&nbsp;&gt;&nbsp;<a href="using-spnego-in-geronimo.html">Using SPNEGO in Geronimo</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8" />
            <input type="hidden" name="oe" value="UTF-8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
        </td>
      </tr> 
    </table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div style="margin: 0px 10px 0px 10px" class="smalltext">Apache Geronimo v3.0</div>
        <div style="margin: 0px 10px 8px 10px"  class="pagetitle">Using SPNEGO in Geronimo</div>

        <div class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
<!-- -->         
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=21791721">
            <img src="http://geronimo.apache.org/images/icons/notep_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Edit Page"></a>
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=21791721">Edit Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">
            <img src="http://geronimo.apache.org/images/icons/browse_space.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Browse Space"></a>
            <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">Browse Space</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=21791721">
            <img src="http://geronimo.apache.org/images/icons/add_page_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add Page"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=21791721">Add Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=21791721">
            <img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add News"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=21791721">Add News</a>
<!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent">

<p>Using the <a shape="rect" class="external-link" href="ftp://ftp.isi.edu/in-notes/rfc2478.txt" title="SPNEGO" rel="nofollow">Simple and Protected GSS-API Negotiation Mechanism(SPNEGO)</a> in Geronimo allows HTTP users to log in and authenticate only once in their desktop, then they can receive automatic authentication from the Geronimo server. </p>
<style type="text/css">/*<![CDATA[*/
div.rbtoc1572612992952 {padding: 0px;}
div.rbtoc1572612992952 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1572612992952 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class="toc-macro rbtoc1572612992952">
<ul class="toc-indentation"><li><a shape="rect" href="#UsingSPNEGOinGeronimo-Prerequisite">Prerequisite</a></li><li><a shape="rect" href="#UsingSPNEGOinGeronimo-Procedure">Procedure</a>
<ul class="toc-indentation"><li><a shape="rect" href="#UsingSPNEGOinGeronimo-SettinguptheDomainControllerMachine">Setting up the Domain Controller Machine</a></li><li><a shape="rect" href="#UsingSPNEGOinGeronimo-SettinguptheClientApplicationMachine">Setting up the Client Application Machine</a>
<ul class="toc-indentation"><li><a shape="rect" href="#UsingSPNEGOinGeronimo-EnableSPNEGOauthenticationinMicrosoftInternetExplorerbrowser">Enable SPNEGO authentication in Microsoft Internet Explorer browser</a></li><li><a shape="rect" href="#UsingSPNEGOinGeronimo-EnableSPNEGOauthenticationinFirefox">Enable SPNEGO authentication in Firefox</a></li></ul>
</li><li><a shape="rect" href="#UsingSPNEGOinGeronimo-SettinguptheGeronimoserver">Setting up the Geronimo server</a></li></ul>
</li><li><a shape="rect" href="#UsingSPNEGOinGeronimo-Fewveryimportantpointstonote">Few very important points to note</a></li></ul>
</div>

<h1 id="UsingSPNEGOinGeronimo-Prerequisite">Prerequisite</h1>
<p>Using the SPNEGO requires three distinct machines:</p>
<ul><li>A Microsoft Windows 2000 or Windows 2003 Server running the Active Directory Domain Controller and associated Kerberos Key Distribution Center(KDC)</li><li>A domain member with internet browsers for example, a Microsoft Internet Explorer or Firefox browser</li><li>A server Platform with Geronimo running</li></ul>


<p>Note that the clock on clients, Microsoft Active Directory Domain Controller and Geronimo server must be synchronized to within five minutes, and they must be within the same domain.</p>

<h1 id="UsingSPNEGOinGeronimo-Procedure">Procedure</h1>
<h2 id="UsingSPNEGOinGeronimo-SettinguptheDomainControllerMachine">Setting up the Domain Controller Machine</h2>
<ol><li>Create a user account in the active directory. Make sure that the user you create is unique and not listed in Computers or domain controllers. This account will be eventually mapped to the Kerberoes service principal name(SPN).</li><li>Map the user account to the SPN with the command <strong>setspn</strong>. Typically, A SPN looks like <em>HTTP/&lt;Fully_Qualified_Host_Name&gt;</em>. Make sure that you do not have the same SPNs mapping to more than one Microsoft user account. If you map the same SPN to more than one user account, the web browser client can send a <a shape="rect" class="external-link" href="http://en.wikipedia.org/wiki/NTLM" title="NTLM" rel="nofollow">NT LAN Manager(NTLM)</a> authentication request instead of SPNEGO token to Geronimo server. See <a shape="rect" class="external-link" href="http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/TechRef/b3a029a1-7ff0-4f6f-87d2-f2e70294a576.mspx" title="setspn command" rel="nofollow">Windows 2003 Technical Reference (setspn command)</a> for more usages of the command.
<div class="panel" style="border-width: 1px;"><div class="panelContent">
<p>setspn -A HTTP/test.xyz.com testuser.</p>
</div></div>
Where 
	<ul><li><em>testuser</em> is the user account created in step1</li><li><em>HTTP/test.xyz.com</em> is the unique SPN mapped with <em>testuser</em>, <em>test.xyz.com</em> is the host name of Geronimo server.</li></ul>
	</li><li>Create the Kereros keytab file(<code>krb5.keytab</code>) with the command <strong>ktpass</strong> and make the file available to Geronimo server by copying it from the Domain Controller to the Geronimo server. See <a shape="rect" class="external-link" href="http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/TechRef/64042138-9a5a-4981-84e9-d576a8db0d05.mspx" title="ktpass" rel="nofollow">Windows 2003 Technical Reference (ktpass command)</a> for more usages of the command.
<div class="panel" style="border-width: 1px;"><div class="panelContent">
<p>ktpass -out c:\winnt\krb5.keytab -princ HTTP/test.xyz.com@XYZ.COM -mapUser testuser -mapOp set -pass testuser123 -crypto RC4-HMAC-NT -pType KRB5_NT_PRINCIPAL</p>
</div></div>
where
	<ul><li><em>HTTP/test.xyz.com@XYZ.COM</em> is the concatenation of the user logon name, and the realm name which must be in uppercase.</li><li><em>testuser</em> is the user account for mapping.</li><li><em>testuser123</em> is the password of the user <strong>testuser</strong>.</li></ul>
	</li></ol>


<h2 id="UsingSPNEGOinGeronimo-SettinguptheClientApplicationMachine">Setting up the Client Application Machine</h2>
<p>On client machines, the Web browsers are responsible for generating the SPNEGO token for user by the Geronimo server. Perform the following configuration for your browsers. Note that the resources on Geronimo server can only be accessible by the domain name of the Geronimo server, and the client machines must be the members of Domain.</p>
<h3 id="UsingSPNEGOinGeronimo-EnableSPNEGOauthenticationinMicrosoftInternetExplorerbrowser">Enable SPNEGO authentication in Microsoft Internet Explorer browser</h3>
<ol><li>In the Internet Explorer windows, click <strong>Tools&gt;Internet Options&gt;Security</strong> tab.</li><li>Select the <strong>Local Intranet</strong> icon and click <strong>Sites</strong>.</li><li>Make sure all check boxes are selected in the <strong>Local Intranet</strong> windows, then click <strong>Advanced</strong> button.</li><li>Add the URI name of the Geronimo server for example _<a shape="rect" class="external-link" href="http://test.xyz.com_" rel="nofollow">http://test.xyz.com_</a> into the list Web sites so that the Single Sign-On (SSO) can be enabled, then click <strong>OK</strong> to complete this step and close the <strong>Local intranet</strong> window.</li><li>On the <strong>Internet Options</strong> windows, click the <strong>Advanced</strong> tab and go to <strong>Security settings</strong>. Make sure <strong>Enable Integrated Windows Authentication(requires restart)</strong> check box is selected, then click <strong>OK</strong> to close all windows.</li><li>Restart your Microsoft Internet Explorer to activate the configuration.</li></ol>


<h3 id="UsingSPNEGOinGeronimo-EnableSPNEGOauthenticationinFirefox">Enable SPNEGO authentication in Firefox</h3>
<ol><li>In the URL address bar of your Firefox browser, type <strong>about:config</strong> and press the Enter key.</li><li>In the following windows, type <strong>network.nego</strong> in the <strong>Filters</strong>.</li><li>Double click <strong>network.negotiate-auth.trusted-uris</strong> and add http://,https:// in the pop-up window, then click <strong>OK</strong> to close the window.</li><li>Double click <strong>network.negotiate-auth.delegation-ruis</strong> and add http://,https:// in the pop-up window, then click <strong>OK</strong> to close the window.</li><li>Restart your Firefox to activate the configuration.</li></ol>


<h2 id="UsingSPNEGOinGeronimo-SettinguptheGeronimoserver">Setting up the Geronimo server</h2>
<ol><li>Copy the Keroes keytab file <code>krb5.keytab</code> to one of directories of your Geronimo Server. The file was created during <a shape="rect" href="using-spnego-in-geronimo.html">Setting up the Domain Controller Machine</a>.</li><li>Create a basic Kerbeores configuration file named <code>krb5.ini</code> in order to use the SPNEGO for the server. The files should be stored on local server and with the following keys list defining the Kerberoes key distribution center(KDC) name and the realm setting for the SPNEGO authentication.
<div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>krb5.ini</b></div><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default"> 
[libdefaults]
  default_realm = XYZ.COM
     default_keytab_name = FILE:c:\winnt\krb5.keytab
     default_tkt_enctypes = rc4-hmac,des-cbc-md4,des-cbc-crc
     default_tgs_enctypes = rc4-hmac,des-cbc-md4,des-cbc-crc
     forwardable=true 
[realms]
  XYZ.COM = {
        kdc = domaincontroller.xyz.com:88
        default_domain = xyz.com   
        }
[domain_realm]
  xyz.com= XYZ.COM
  .xyz.com = XYZ.COM
</pre>
</div></div></li><li>Configure JVM properties with the following key pairs to make sure the JVM read the Kerberoes configurations successfully.
<div class="panel" style="border-width: 1px;"><div class="panelContent">
<p>set JAVA_OPTS=-Djava.security.krb5.conf=C:\winnt\krb5.ini -Dcom.ibm.security.jgss.debug=all -Dcom.ibm.security.krb5.Krb5Debug=all -Djavax.security.auth.useSubjectCredsOnly=false</p>
</div></div></li><li>Create a system-scope realm for the Geronimo server as followed. The sample code is a combination of SPNEGO and .properties file realms in order that the authentication will fall back on .Properties realm once the SPNEGO authentication fails. You can remove the .properties file realm if unnecessary.
<div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>spnego_properties_realm.xml</b></div><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
&lt;module xmlns="http://geronimo.apache.org/xml/ns/deployment-1.2"&gt;
    &lt;environment&gt;
        &lt;moduleId&gt;
            &lt;groupId&gt;console.realm&lt;/groupId&gt;
            &lt;artifactId&gt;SpnegoTest&lt;/artifactId&gt;
            &lt;version&gt;1.0&lt;/version&gt;
            &lt;type&gt;car&lt;/type&gt;
        &lt;/moduleId&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.apache.geronimo.framework&lt;/groupId&gt;
                &lt;artifactId&gt;j2ee-security&lt;/artifactId&gt;
                &lt;type&gt;car&lt;/type&gt;
            &lt;/dependency&gt;
        &lt;/dependencies&gt;
    &lt;/environment&gt;
    &lt;gbean name="SpnegoTest" class="org.apache.geronimo.security.realm.GenericSecurityRealm" xsi:type="dep:gbeanType" 
                 xmlns:dep="http://geronimo.apache.org/xml/ns/deployment-1.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
        &lt;attribute name="realmName"&gt;SpnegoTest&lt;/attribute&gt;
        &lt;reference name="ServerInfo"&gt;
            &lt;name&gt;ServerInfo&lt;/name&gt;
        &lt;/reference&gt;
        &lt;xml-reference name="LoginModuleConfiguration"&gt;
            &lt;log:login-config xmlns:log="http://geronimo.apache.org/xml/ns/loginconfig-2.0"&gt;
                &lt;log:login-module control-flag="SUFFICIENT" wrap-principals="false"&gt;
                    &lt;log:login-domain-name&gt;SpnegoTest&lt;/log:login-domain-name&gt;
                    &lt;log:login-module-class&gt;org.apache.geronimo.security.realm.providers.SpnegoLoginModule&lt;/log:login-module-class&gt;
                    &lt;log:option name="targetName"&gt;http/test.xyz.com&lt;/log:option&gt;
					&lt;log:option name="ldapUrl"&gt;ldap://domaincontroller.xyz.com:389&lt;/log:option&gt;
					&lt;log:option name="ldapLoginName"&gt;testuser&lt;/log:option&gt;
					&lt;log:option name="ldapLoginPassword"&gt;testuser123&lt;/log:option&gt;
					&lt;log:option name="searchBase"&gt;DC=xyz,DC=com&lt;/log:option&gt;
                &lt;/log:login-module&gt;
                &lt;log:login-module control-flag="SUFFICIENT" wrap-principals="false"&gt;
                    &lt;log:login-domain-name&gt;demo-properties-realm&lt;/log:login-domain-name&gt;
                    &lt;log:login-module-class&gt;org.apache.geronimo.security.realm.providers.PropertiesFileLoginModule&lt;/log:login-module-class&gt;
                    &lt;log:option name="usersURI"&gt;var/security/demo_users.properties&lt;/log:option&gt;
                    &lt;log:option name="groupsURI"&gt;var/security/demo_groups.properties&lt;/log:option&gt;
                &lt;/log:login-module&gt;
            &lt;/log:login-config&gt;
        &lt;/xml-reference&gt;
    &lt;/gbean&gt;
&lt;/module&gt;
</pre>
</div></div></li><li>Configure the deployment plan of your application to make sure the SPNEGO realm is invoked properly. See the sample code below for reference.
<div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>geronimo-web.xml</b></div><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web:web-app xmlns:app="http://geronimo.apache.org/xml/ns/j2ee/application-2.0"    xmlns:client="http://geronimo.apache.org/xml/ns/j2ee/application-client-2.0" 
        xmlns:conn="http://geronimo.apache.org/xml/ns/j2ee/connector-1.2" xmlns:dep="http://geronimo.apache.org/xml/ns/deployment-1.2" 
        xmlns:ejb="http://openejb.apache.org/xml/ns/openejb-jar-2.2" xmlns:name="http://geronimo.apache.org/xml/ns/naming-1.2" 
        xmlns:pers="http://java.sun.com/xml/ns/persistence" xmlns:pkgen="http://openejb.apache.org/xml/ns/pkgen-2.1" 
        xmlns:sec="http://geronimo.apache.org/xml/ns/security-2.0" xmlns:web="http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1"&gt;
    &lt;dep:environment&gt;
        &lt;dep:moduleId&gt;
            &lt;dep:groupId&gt;com.mycompany.samples&lt;/dep:groupId&gt;
            &lt;dep:artifactId&gt;security-demo&lt;/dep:artifactId&gt;
            &lt;dep:version&gt;3.0&lt;/dep:version&gt;
            &lt;dep:type&gt;war&lt;/dep:type&gt;
        &lt;/dep:moduleId&gt;
        &lt;dep:dependencies/&gt;
        &lt;dep:hidden-classes&gt;
            &lt;dep:filter&gt;
	        org.apache.geronimo.security.realm.providers.SpnegoLoginModule
	    &lt;/dep:filter&gt;
        &lt;/dep:hidden-classes&gt;
        &lt;dep:non-overridable-classes/&gt;
    &lt;/dep:environment&gt;
    &lt;web:context-root&gt;/demo&lt;/web:context-root&gt;
    &lt;web:security-realm-name&gt;SpnegoTest&lt;/web:security-realm-name&gt;
    &lt;sec:security&gt;
        &lt;sec:role-mappings&gt;
            &lt;sec:role role-name="content-administrator"&gt;
                &lt;sec:principal class="org.apache.geronimo.security.realm.providers.GeronimoGroupPrincipal" name="Domain Admins"/&gt;
		&lt;sec:principal class="org.apache.geronimo.security.realm.providers.GeronimoUserPrincipal" name="testuser@TEST.XYZ.COM"/&gt;
            &lt;/sec:role&gt;
            &lt;sec:role role-name="Guest-administrator"&gt;
           &lt;sec:principal class="org.apache.geronimo.security.realm.providers.GeronimoGroupPrincipal" name="Domain Admins"/&gt;
             &lt;/sec:role&gt;
        &lt;/sec:role-mappings&gt;
    &lt;/sec:security&gt;
&lt;/web:web-app&gt;
</pre>
</div></div></li><li>Configure the deployment descriptor to make sure your application uses SPNEGO authentication and the respective realm provider that Geronimo server supports.
<div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>excerpt of web.xml</b></div><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
...
   &lt;login-config&gt;
      &lt;auth-method&gt;SPNEGO&lt;/auth-method&gt;
      &lt;realm-name&gt;SpnegoTest&lt;/realm-name&gt;
      ...
   &lt;/login-config&gt;
</pre>
</div></div></li></ol>


<h1 id="UsingSPNEGOinGeronimo-Fewveryimportantpointstonote">Few very important points to note</h1>

<ul><li>Make sure that you use Basic as the authentication mechanism in your web application if you want to configure Spnego with geronimo.</li><li>The realm provided is a combination of 2 login modules which can be easily created through geronimo administrative console.</li><li>While you are creating a security realm for Spnego loginmodule you need to just specify one option that will be of the form "targetName=http/&lt;fully_qualified_host_name&gt;". Have a look at the sample realm. This will give you an idea of the option to be used.</li><li>Make sure you choose sufficient as the control-flag while creating the 2 login modules.</li><li>Make sure you map only one user to SPN as defined in #2 of  "Setting up the Active Directory Domain Controller".</li></ul></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tr>
          <td align="left" valign="middle" class="footer">
            &nbsp;&nbsp;
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="Delicious" />
            <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">Bookmark this on Delicious</a>
            &nbsp;&nbsp;
            <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="Digg!" />
            <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)+'&amp;topic=programming');">Digg this</a>
            <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Using SPNEGO in Geronimo';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
            &nbsp;&nbsp;
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;-&nbsp;&nbsp;
            Copyright &#169; 2003-2013, The Apache Software Foundation, Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0.</a>&nbsp;&nbsp;
          </td>
        </tr>
    </table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  </body>
</html>
