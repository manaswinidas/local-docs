<html lang="zh-Hans"  xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=1">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="singletonejb-javaee6 - A simple JSF+Singleton+ejb injection application">
    <meta name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi singletonejb-javaee6 - A simple JSF+Singleton+ejb injection application">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2010-05-11">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0文档：singletonejb-javaee6-一个简单的JSF + Singleton + ejb注入应用程序</title>
  </head>

  <body  onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">主页</a> > <a href="documentation.html">文档</a> > <a href="reference.html">参考</a> > <a href="samples.html">示例</a> > <a href="java-ee-sample-applications.html">Java EE示例应用程序</a> > <a href="singletonejb-javaee6-a-simple-jsfsingletonejb-injection-application.html">singletonejb-javaee6-一个简单的JSF + Singleton + ejb注入应用程序</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo v3.0</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">singletonejb-javaee6-一个简单的JSF + Singleton + ejb注入应用程序</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=23337815"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=23337815">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=23337815"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=23337815">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=23337815"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=23337815">添加新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>

<h2 id="singletonejb-javaee6-AsimpleJSF+Singleton+ejbinjectionapplication-Applicationoverview">应用概述</h2>

<p>此示例演示<strong>@Singleton</strong>和<strong>@EJB</strong>注释在EJB3.1精简版描述以及JSF框架的使用。<strong>@Singleton</strong>注释定义了一个单例会话bean，该会话bean可以在应用程序之间共享，并且其状态在应用程序的生命周期中得以维护。<strong>@EJB</strong>注释显示了如何将另一个会话Bean注入到您的支持Bean中。</p>

<h2 id="singletonejb-javaee6-AsimpleJSF+Singleton+ejbinjectionapplication-Applicationcontent">申请内容</h2>

<p><strong>singletonejb-javaee6</strong>应用程序由以下软件包和类列表组成。</p>

<p><strong>org.apache.geronimo.samples.javaee6.singletonejb.backbeans</strong></p>
<ul><li>AddCalculatorBackBean.java</li><li>SubtractCalculatorBackBean.java</li></ul>


<p><strong>org.apache.geronimo.samples.javaee6.singletonejb.sessionBeans</strong></p>
<ul><li>SingletonCalculator.java</li></ul>


<p>应用程序中的Web应用程序文件列表如下所示。</p>
<div class="indent0 inline" style="margin-left:0px"><style type="text/css">div.inline p:first-child { display: inline; }</style><p>|-WEB_INF</p></div>
<div class="indent20 inline" style="margin-left:20px"><style type="text/css">div.inline p:first-child { display: inline; }</style><p>+-web.xml</p></div>
<div class="indent20 inline" style="margin-left:20px"><style type="text/css">div.inline p:first-child { display: inline; }</style><p>+-geronimo-web.xml</p></div>
<div class="indent0 inline" style="margin-left:0px"><style type="text/css">div.inline p:first-child { display: inline; }</style><p>|-index.html</p></div>
<div class="indent0 inline" style="margin-left:0px"><style type="text/css">div.inline p:first-child { display: inline; }</style><p>|-index.xhtml</p></div>
<div class="indent0 inline" style="margin-left:0px"><style type="text/css">div.inline p:first-child { display: inline; }</style><p>|-SubtractCal.xhtml</p></div>

<h2 id="singletonejb-javaee6-AsimpleJSF+Singleton+ejbinjectionapplication-Applicationimplementation">应用实施</h2>

<p><strong>web.xml</strong>定义了Web应用程序<strong>index.html</strong>的<strong>欢迎文件</strong> ，并声明JSF框架与用于请求处理的标准Servlet <strong>Faces Servlet</strong>有关。</p>
<parameter ac:name="">xml</parameter> <plain-text-body><web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemalocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"><context-param><param-name>javax.faces。PROJECT_STAGE</param-name> <param-value>开发</param-value></context-param> <servlet><servlet-name>Faces Servlet</servlet-name> <servlet-class>javax.faces.webapp。FacesServlet</servlet-class> <load-on-startup>1</load-on-startup></servlet> <servlet-mapping><servlet-name>Faces Servlet</servlet-name> <url-pattern>/ faces / *</url-pattern></servlet-mapping> <session-config><session-timeout>30</session-timeout></session-config> <welcome-file-list><welcome-file>index.html</welcome-file></welcome-file-list>
</web-app>
</plain-text-body>

<p><strong>geronimo-web.xml</strong>描述了项目内部的有关项目的信息（例如，模块的唯一标识，任何依赖项）。 <strong><sys:environment></sys:environment></strong>标签。为该模块提供某种唯一标识是一个好主意，以便以后可以由其他一些可部署的应用程序引用该模块。* <context-root>*标签中指定的路径<context-root>将是用于访问该Web应用程序的URL的第一段。因此，访问此Web应用程序的URL将为<strong>http：// <hostname>： <port>/ Singletonejb-javaee6</port></hostname></strong> 。 Geronimo将<a shape="rect" class="external-link" href="http://myfaces.apache.org" title="阿帕奇MyFaces">Apache MyFaces</a>用作JSF实现，并且该组件在默认情况下已启动并且在服务器范围内可用。因此，您不必为myFaces组件添加依赖项。</context-root></context-root></p>
<parameter ac:name="">xml</parameter> <plain-text-body><web-app xmlns="http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1" xmlns:naming="http://geronimo.apache.org/xml/ns/naming-1.2" xmlns:sec="http://geronimo.apache.org/xml/ns/security-2.0" xmlns:sys="http://geronimo.apache.org/xml/ns/deployment-1.2"><sys:environment><sys:moduleid><sys:groupid>org.apache.geronimo.samples</sys:groupid> <sys:artifactid>singletonejb-javaee6</sys:artifactid> <sys:version>$ {version}</sys:version> <sys:type>汽车</sys:type></sys:moduleid> <sys:dependencies></sys:dependencies><sys:hidden-classes></sys:hidden-classes><sys:non-overridable-classes></sys:non-overridable-classes></sys:environment> <context-root>/ singletonejb-javaee6</context-root></web-app></plain-text-body>

<p><strong>index.xhtml</strong>使用标准HTML标记库来呈现供用户输入的表单，并将表单上的组件分别与托管bean属性绑定。</p>
<parameter ac:name="">html</parameter> <plain-text-body>
    <h:head>
        <title>小面标题</title>
    </h:head>
	      <h:body>
			<h:form>
				<h:outputtext value="Add Calculator"></h:outputtext>
				<hr>
				<h:inputtext value="#{AddCalculatorBackBean.currentInput}"></h:inputtext>
				<h:commandbutton value="Add" action="#{AddCalculatorBackBean.add}"></h:commandbutton>
				<br>
				<h:outputtext value="#{AddCalculatorBackBean.output}" escape="false"></h:outputtext>
				<h:commandlink value="Go to Subtract Calculator" action="#{AddCalculatorBackBean.goToSubtract}"></h:commandlink>
			</h:form>
		</h:body>


</plain-text-body>

<p><strong>AddCalculatorBackBean.java</strong>和<strong>SubtractCalculatorBackBean.java</strong>保存表单数据，并调用单例会话bean <strong>SingletonCalculator</strong>进行计算。同样，JSF管理的bean使用<strong>@EJB</strong>注释进行bean注入。我们可以看到<strong>SingletonCalculator的</strong>两个引用，分别用于<em>Add</em>和<em>Subtract</em> bean。因为两个后备豆<strong>AddCalculatorBackBean</strong>和<strong>SubtractSingletonCalculatorBackBean都</strong>引用相同的对象标识，所以每次计算都将根据上一次计算的结果进行。</p>
<rich-text-body>
<parameter ac:name="width">50％的</parameter> <rich-text-body><parameter ac:name="">java</parameter> <parameter ac:name="title">AddCalculatorBackBean.java</parameter> <plain-text-body>包org.apache.geronimo.samples.javaee6。SingletonEJB.backbeans;导入org.apache.geronimo.samples.javaee6。SingletonEJB.sessionBeans。SingletonCalculator;导入javax.ejb。EJB;导入javax.faces.bean。ManagedBean;导入javax.faces.bean。RequestScoped; @ManagedBean（name =“ AddCalculatorBackBean”）@RequestScoped公共类AddCalculatorBackBean {@EJB私有SingletonCalculator Calculatorfacade; private String currentInput =“ 0.0”;私有字符串输出； / **创建一个AddCalculatorBackBean的新实例* / public AddCalculatorBackBean（）{currentInput =“ 1.0”; ...}}</plain-text-body></rich-text-body> <parameter ac:name="width">50％</parameter> <rich-text-body><parameter ac:name="">的java</parameter> <parameter ac:name="title">SubtractCalculatorBackBean.java</parameter> <plain-text-body>包org.apache.geronimo.samples.javaee6。SingletonEJB.backbeans;导入org.apache.geronimo.samples.javaee6。SingletonEJB.sessionBeans。SingletonCalculator;导入javax.ejb。EJB;导入javax.faces.bean。ManagedBean;导入javax.faces.bean。RequestScoped; @ManagedBean（name =“ SubtractSingletonCalculatorBackBean”）@RequestScoped公共类SubtractCalculatorBackBean {@EJB私人SingletonCalculator Calculatorfacade; private String currentInput =“ 0.0”;私有字符串输出； / **创建SingletonCalculatorBackBean的新实例* / public SubtractCalculatorBackBean（）{currentInput =“ 1.0”; }公共字符串减去（）{...}}</plain-text-body></rich-text-body></rich-text-body>

<p><strong>SingletonCalculator.java</strong>进行实际计算。这是一个单例会话bean，对于所有请求只能初始化一次。仅当应用程序停止时，它才会被销毁。</p>
<parameter ac:name="">Java</parameter> <plain-text-body>导入javax.ejb。辛格尔顿导入java.text。DecimalFormat; @Singleton公共类SingletonCalculator {字符串输出=“启动计算器过程：<br>“; double result = 0; public double add（double d）{double tmp = result + d; this.output + = result +” +“ + d +”等于“ + tmp +”<br>“; result = tmp;返回结果;} public String getOutput（）{return this.output;} public double sub（double d）{double tmp = result-d; this.output + = result +”-“ + d + “等于” + tmp +“<br>“; result = tmp;返回结果;}}</plain-text-body>

<h2 id="singletonejb-javaee6-AsimpleJSF+Singleton+ejbinjectionapplication-Getthesourcecode">获取源代码</h2>

<p>请参阅<a shape="rect" href="java-ee-sample-applications.html">示例常规信息，</a>以获取有关获取和构建此示例和其他示例的源的信息。</p>

<h2 id="singletonejb-javaee6-AsimpleJSF+Singleton+ejbinjectionapplication-Buildthewebapplication">构建Web应用程序</h2>

<p>一旦所有源都签出，下一步就是构建<strong>singleton-javaee6</strong>示例。需要Maven 2或更高版本来构建二进制文件。</p>

<p>从<strong><</strong> <strong>singletonejb-javaee6</strong> <strong>_home></strong>目录运行以下命令。</p>

<rich-text-body>
<p>mvn全新安装</p></rich-text-body>
<p>此过程将花费几分钟。二进制文件将在相应的<strong>目标</strong>目录中生成。</p>

<h2 id="singletonejb-javaee6-AsimpleJSF+Singleton+ejbinjectionapplication-Deploythewebapplication">部署Web应用程序</h2>

<p>部署示例应用程序非常简单，因为我们将使用Geronimo Console。</p>
<ol><li>从“ <strong>控制台”->“导航”面板</strong>向下滚动至<strong>Deploy New</strong> 。</li><li>从<strong>singletonejb-javaee6-war \ target</strong>文件夹中加载<strong>singletonejb-javaee6-war-</strong> <strong><em>版本</em></strong> <strong>.war</strong>到<strong>Archive</strong>输入框中。</li><li>按<strong>安装</strong>按钮以在服务器中部署应用程序。</li></ol>


<h2 id="singletonejb-javaee6-AsimpleJSF+Singleton+ejbinjectionapplication-Testthewebapplication">测试Web应用程序</h2>

<p>该应用程序位于<a shape="rect" class="external-link" href="http://localhost:8080/singletonejb-javaee6" rel="nofollow">http：// localhost：8080 / singleton-javaee6上</a> 。</p>

<p>输入一个值，然后单击<strong>添加</strong>进行计算。<br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="singletonejb-javaee6-a-simple-jsfsingletonejb-injection-application.data/singletonejb1.jpg"></span></p>

<p>点击<strong>转到减法计算器</strong> ，然后再次输入一个值，然后点击<strong>减</strong> 。您将看到输出基于预览步骤的结果。</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" src="singletonejb-javaee6-a-simple-jsfsingletonejb-injection-application.data/singletonejb2.jpg"></span></p></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : singletonejb-javaee6 - A simple JSF+Singleton+ejb injection application';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2013，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  

</body></html>