<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=0">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="Configuring Virtual Host in Tomcat">
    <meta name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Configuring Virtual Host in Tomcat">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2010-05-11">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0文档：在Tomcat中配置虚拟主机</title>
  </head>

  <body  onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">Home</a> > <a href="documentation.html">文档</a> > <a href="configuring-and-administering.html">配置和管理</a> > <a href="configuring-and-administering-the-apache-geronimo-server.html">配置和管理Apache Geronimo Server</a> > <a href="configuring-the-web-container.html">配置Web容器</a> > <a href="configuring-virtual-host.html">配置虚拟主机</a> > <a href="configuring-virtual-host-in-tomcat.html">在Tomcat中配置虚拟主机</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo v3.0</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">在Tomcat中配置虚拟主机</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645459"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645459">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645459"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645459">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645459"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645459">新增新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><p><plain-text-body>{}滚动条</plain-text-body> <parameter ac:name="atlassian-macro-output-type">INLINE</parameter><rich-text-body></rich-text-body></p><p>本文介绍如何使用Tomcat在Apache Geronimo中配置虚拟主机。</p>默认情况下，当您在Geronimo中部署并启动应用程序时，该应用程序将监听每个可用的主机名。通过配置虚拟主机，可以使应用程序侦听特定的主机名或IP。当您在多个主机名中共享一个IP时，本文介绍的配置步骤也有效。<br clear="none">要在Geronimo中配置虚拟主机，基本上，您需要执行以下操作：<p></p>
<parameter ac:name="minLevel">2</parameter>
<p>本文使用简单的HelloWorld应用程序作为参考。<a shape="rect" href="quick-start-apache-geronimo-for-the-impatient.html">快速入门-不耐烦的Apache Geronimo</a>涵盖了此应用程序。</p>

<h2 id="ConfiguringVirtualHostinTomcat-ConfigurelocalhostorDNS">配置本地主机或DNS</h2>

<p>要使此配置生效，您需要确保Geronimo可以解析您将要定义的虚拟主机名。根据您的网络配置，您可以将条目添加到DNS中，或将别名添加到Geronimo服务器IP中。或者，您可以将条目添加到本地主机表。每个操作系统都有自己的方式来定义本地主机表。例如Windows将具有<code>%SystemRoot%\system32\drivers\etc\hosts</code> ，并且基于UNIX的操作系统通常会有一个<code>/etc/hosts</code> 。</p>

<p>对于此示例，我们将使用在本地主机表中定义的以下主机名：</p>

<p><code><strong>127.0.0.1 localhost virtualhost1.com virtualhost2.com virtualhost3.com virtualhost4.com</strong></code></p>

<p>确保您的系统可以解析这些名称。</p>

<h2 id="ConfiguringVirtualHostinTomcat-DefineVirtualhost">定义虚拟主机</h2>

<p>在Geronimo中定义虚拟主机的方法有以下三种：</p>
<ol><li>通过直接编辑Geronimo的<code>var/config/config.xml</code>设置定义。需要重新启动Geronimo。</li><li>通过部署包含定义的GBean来自动进行。<strong>不需要</strong> Geronimo的重新启动。</li><li>通过编辑Tomcat Catalina手动进行<code>var/catalina/server.xml</code>设置定义。需要重新启动Geronimo。</li></ol>


<p>我们将介绍特定于Geronimo的配置方法的前两个选项。有关执行第三个选项的说明，请参见Apache Tomcat项目网站上的文档。</p>

<h3 id="ConfiguringVirtualHostinTomcat-Manuallyeditingvar/config/config.xml">手动编辑<code>var/config/config.xml</code></h3>

<p>现在，您需要在Geronimo的服务器中定义这些虚拟主机。 <code>config.xml</code>文件，以便Geronimo可以识别它们。本节提供了两种不同的虚拟主机定义，一种定义有多个主机名别名，另一种没有主机名别名。通过在Geronimo配置中创建两个新的<strong>HostGBean</strong> （ <em>TomcatVirtualHost1</em>和<em>TomcatVirtualHost2</em> ）来定义虚拟主机。此示例的目标是让一个应用程序在单个虚拟主机（virtualhost1.com）上侦听，另一个应用程序在另一个具有两个别名（virtualhost3.com和virtualhost4.com）的虚拟主机（virtualhost2.com）上侦听。</p>

<p>打开<code>config.xml</code>文件位于<code><geronimo_home>/var</code>目录并查找以下行<code><module name="org.apache.geronimo.configs/tomcat7/3.0/car"></code> 。这是Tomcat配置模块的开始。在此行之后，将立即完成所有其他虚拟主机配置。</p>

<p>要定义第一个HostGBean <strong>TomcatVirtualHost_1</strong> ，请在后面添加以下行<code><module name="org.apache.geronimo.configs/tomcat7/3.0/car"></code> 。</p>
<parameter ac:name="">xml</parameter> <parameter ac:name="title">摘录自config.xml</parameter> <parameter ac:name="borderStyle">固体</parameter> <plain-text-body>...
<gbean name="org.apache.geronimo.configs/tomcat7/3.0/car?ServiceModule=org.apache.geronimo.configs/tomcat7/3.0/car,j2eeType=Host,name=TomcatVirtualHost_1" gbeaninfo="org.apache.geronimo.tomcat.HostGBean">
    <attribute name="className">org.apache.catalina.core。StandardHost</attribute> <attribute name="initParams">名称= virtualhost1.com appBase = workDir =工作</attribute> <reference name="Engine"><pattern><name>TomcatEngine</name></pattern></reference></gbean> ...
</plain-text-body>
<p>要添加第二个HostGBean <strong>TomcatVirtualHost_2</strong> ，请在第一个HostGBean之后添加以下几行。这两个HostGBean已被拆分，以便于识别它们。这两个HostGBean之间的主要区别是<code><strong><attribute name="aliases">..,..</attribute></strong></code>定义别名的行。</p>
<parameter ac:name="">xml</parameter> <parameter ac:name="title">摘录自config.xml</parameter> <parameter ac:name="borderStyle">固体</parameter> <plain-text-body>...
<gbean name="org.apache.geronimo.configs/tomcat7/3.0/car?ServiceModule=org.apache.geronimo.configs/tomcat7/3.0/car,j2eeType=Host,name=TomcatVirtualHost_2" gbeaninfo="org.apache.geronimo.tomcat.HostGBean">
    <attribute name="className">org.apache.catalina.core。StandardHost</attribute> <attribute name="initParams">名称= virtualhost2.com appBase = workDir = work</attribute> <attribute name="aliases">virtualhost3.com，virtualhost4.com</attribute> <reference name="Engine"><pattern><name>TomcatEngine</name></pattern></reference></gbean> ...
</plain-text-body>
<p>至此，您已经在Geronimo中成功配置了两个不同的虚拟主机。确保将更改保存到<code>config.xml</code>文件，然后<a shape="rect" href="tools-and-commands.html">启动</a> Geronimo。</p>

<p>有关其他参考，请参见以下摘录： <code>config.xml</code>整个<code><module name="org.apache.geronimo.configs/tomcat7/3.0/car"></code>带有两个已经定义的<strong>HostGBean的</strong>条目。</p>
<parameter ac:name="">xml</parameter> <parameter ac:name="title">config.xml</parameter> <parameter ac:name="borderStyle">固体</parameter> <plain-text-body><!--?xml version="1.0" encoding="UTF-8" standalone="yes" ?=""--><attributes xmlns:ns2="http://geronimo.apache.org/xml/ns/plugins-1.3" xmlns="http://geronimo.apache.org/xml/ns/attributes-1.2"><comment>============================================== ====================警告-每当对Geronimo的配置进行更改时，Geronimo都会重新生成此XML文件。如果要包含注释，请创建一个注释元素元素。它们在任何配置级别都是允许的。!!!!Geronimo运行时请勿编辑此文件！================================================== ================</comment> <module name="org.apache.geronimo.framework/j2ee-system/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.framework/client-system/3.0-SNAPSHOT/car" load="false"></module> <module name="org.apache.geronimo.framework/rmi-naming/3.0-SNAPSHOT/car"><gbean name="RMIRegistry"><attribute name="port">$ {NamingPort + PortOffset}</attribute> <attribute name="host">$ {ServerHostname}</attribute></gbean> <gbean name="DefaultThreadPool"><attribute name="keepAliveTime">30000</attribute> <attribute name="minPoolSize">$ {MinThreadPoolSize}</attribute> <attribute name="maxPoolSize">$ {MaxThreadPoolSize}</attribute></gbean></module> <module name="org.apache.geronimo.framework/plugin/3.0-SNAPSHOT/car"><gbean name="DownloadedPluginRepos"><attribute name="repositoryList">http://geronimo.apache.org/plugins/plugin-repository-list-3.0.txt</attribute></gbean></module> <module name="org.apache.geronimo.framework/j2ee-security/3.0-SNAPSHOT/car"><gbean name="JMXService"><attribute name="protocol">rmi</attribute> <attribute name="host">$ {ServerHostname}</attribute> <attribute name="port">$ {JMXPort + PortOffset }</attribute> <attribute name="urlPath">/ jndi / rmi：// $ {ServerHostname}：$ {NamingPort + PortOffset} / JMXConnector</attribute></gbean></module> <module name="org.apache.geronimo.framework/server-security-config/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.framework/shutdown/3.0-SNAPSHOT/car" load="false"></module><module name="org.apache.geronimo.framework/online-deployer/3.0-SNAPSHOT/car" load="false"></module><module name="org.apache.geronimo.framework/bundle-recorder/3.0-SNAPSHOT/car"></module> <module name="org.apache.geronimo.framework/geronimo-gbean-deployer/3.0-SNAPSHOT/car"><gbean name="Deployer"><attribute name="remoteDeployAddress">http：// $ {RemoteDeployHostname}：$ {HTTPPort + PortOffset}</attribute></gbean></module> <module name="org.apache.geronimo.configs/j2ee-server/3.0-SNAPSHOT/car"></module> <module name="org.apache.geronimo.configs/j2ee-deployer/3.0-SNAPSHOT/car"><gbean name="WebBuilder"><attribute name="defaultNamespace">http://geronimo.apache.org/xml/ns/j2ee/web/jetty-2.0</attribute></gbean> <gbean name="EnvironmentEntryBuilder"><attribute name="eeNamespaces">http://java.sun.com/xml/ns/j2ee,http://java.sun.com/xml/ns / javaee</attribute></gbean></module> <module name="org.apache.geronimo.configs/bval-deployer/3.0-SNAPSHOT/car"></module> <module name="org.apache.geronimo.configs/transaction-1_6/3.0-SNAPSHOT/car"><gbean name="XidFactory"><attribute name="tmId">$ {TmId}</attribute></gbean> <gbean name="ResourceBindings"><attribute name="format">$ {ResourceBindingsFormat}</attribute> <attribute name="nameInNamespace">$ {ResourceBindingsNameInNamespace}</attribute> <attribute name="namePattern">$ {ResourceBindingsNamePattern}</attribute> <attribute name="abstractNameQuery">$ {ResourceBindingsQuery}</attribute></gbean></module> <module name="org.apache.geronimo.configs/jasper/3.0-SNAPSHOT/car"></module> <module name="org.apache.geronimo.configs/tomcat7/3.0-SNAPSHOT/car"><!-- Virtual Host 1 definition --> <gbean name="org.apache.geronimo.configs/tomcat7/3.0/car?ServiceModule=org.apache.geronimo.configs/tomcat7/3.0/car,
        j2eeType=Host,name=TomcatVirtualHost_1" gbeaninfo="org.apache.geronimo.tomcat.HostGBean"><attribute name="className">org.apache.catalina.core。StandardHost</attribute> <attribute name="initParams">名称= virtualhost1.com appBase = workDir =工作</attribute> <reference name="Engine"><pattern><name>TomcatEngine</name></pattern></reference></gbean> <!-- Virtual Host 2 and aliases definition --> <gbean name="org.apache.geronimo.configs/tomcat7/3.0/car?ServiceModule=org.apache.geronimo.configs/tomcat7/3.0/car,
        j2eeType=Host,name=TomcatVirtualHost_2" gbeaninfo="org.apache.geronimo.tomcat.HostGBean"><attribute name="className">org.apache.catalina.core。StandardHost</attribute> <attribute name="initParams">名= virtualhost2.com的appBase = =的workDir工作</attribute> <attribute name="aliases">virtualhost3.com，virtualhost4.com</attribute> <reference name="Engine"><pattern><name>TomcatEngine</name></pattern></reference></gbean></module> <module name="org.apache.geronimo.configs/tomcat7-deployer/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/web-extender/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.framework/offline-deployer/3.0-SNAPSHOT/car" load="false"></module> <module name="org.apache.geronimo.configs/hot-deployer/3.0-SNAPSHOT/car"><gbean name="HotDeployer"><attribute name="path">部署/</attribute> <attribute name="pollIntervalMillis">2000</attribute></gbean></module> <module name="org.apache.geronimo.configs/remote-deploy-tomcat/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/jasper-deployer/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/myfaces/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/myfaces-deployer/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/sharedlib-extender/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/sharedlib/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/aries/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/aries-deployer/3.0-SNAPSHOT/car"></module> <module name="org.apache.geronimo.configs/persistence-jpa20-deployer/3.0-SNAPSHOT/car"><gbean name="PersistenceUnitBuilder"><attribute name="defaultPersistenceProviderClassName">org.apache.openjpa.persistence。PersistenceProviderImpl</attribute> <attribute name="defaultPersistenceUnitProperties">openjpa。Log =常见的openjpa.jdbc。SynchronizeMappings = buildSchema（ForeignKeys = true）openjpa.jdbc。UpdateManager =操作顺序openjpa。Sequence = table（Table = OPENJPASEQ，Increment = 100）</attribute> <attribute name="defaultEnvironment" propertyeditor="org.apache.geronimo.deployment.service.EnvironmentBuilder"><environment:environment xmlns="http://geronimo.apache.org/xml/ns/deployment-1.2" xmlns:environment="http://geronimo.apache.org/xml/ns/deployment-1.2"><dependencies><dependency><groupid>org.apache.geronimo.configs</groupid> <artifactid>openjpa2</artifactid> <type>汽车</type></dependency></dependencies></environment:environment></attribute></gbean></module> <module name="org.apache.geronimo.configs/openjpa2/3.0-SNAPSHOT/car"></module> <module name="org.apache.geronimo.configs/system-database/3.0-SNAPSHOT/car"><gbean name="DerbyNetwork"><attribute name="host">$ {ServerHostname}</attribute> <attribute name="port">$ {DerbyPort + PortOffset}</attribute></gbean></module> <module name="org.apache.geronimo.plugins/pluto-support/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.plugins/console-tomcat/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.plugins/plugin-console-tomcat/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.plugins.monitoring/mconsole-ds/3.0-SNAPSHOT/car"></module> <module name="org.apache.geronimo.configs/openejb/3.0-SNAPSHOT/car"><gbean name="EJBNetworkService"><attribute name="port">$ {OpenEJBPort + PortOffset}</attribute> <attribute name="host">$ {ServerHostname}</attribute> <attribute name="multicastHost">$ {MulticastDiscoveryAddress}</attribute> <attribute name="multicastPort">$ {MulticastDiscoveryPort}</attribute> <attribute name="multipointHost">$ {MultipointHost}</attribute> <attribute name="multipointPort">$ {MultipointPort + PortOffset}</attribute> <attribute name="multipointServers">$ {MultipointServers}</attribute> <attribute name="multipointEnabled">$ {MultipointEnabled}</attribute> <attribute name="multicastEnabled">$ {MulticastEnabled}</attribute> <attribute name="clusterName">$ {ClusterName}</attribute></gbean> <gbean name="DefaultStatefulContainer"><attribute name="accessTimeout">30</attribute> <attribute name="timeOut">20</attribute> <attribute name="capacity">1000</attribute> <attribute name="bulkPassivate">100</attribute></gbean> <gbean name="DefaultSingletonContainer"><attribute name="accessTimeout">30</attribute></gbean> <gbean name="DefaultBMPContainer"><attribute name="poolSize">10</attribute></gbean> <gbean name="DefaultStatelessContainer"><attribute name="accessTimeout">30</attribute> <attribute name="closeTimeout">5</attribute> <attribute name="maxSize">10</attribute> <attribute name="minSize">0</attribute> <attribute name="strictPooling">是</attribute> <attribute name="idleTimeout">0</attribute></gbean></module> <module name="org.apache.geronimo.plugins.monitoring/mconsole-tomcat/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/activemq-broker-blueprint/3.0-SNAPSHOT/car"></module> <module name="org.apache.geronimo.configs/activemq-ra/3.0-SNAPSHOT/car"><gbean name="ActiveMQ RA"><attribute name="ServerUrl">tcp：// $ {ActiveMQHostname}：$ {ActiveMQPort + PortOffset}</attribute></gbean></module> <module name="org.apache.geronimo.plugins/activemq-console-tomcat/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.plugins/debugviews-console-tomcat/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.plugins/sysdb-console-tomcat/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.plugins/openejb-console-tomcat/3.0-SNAPSHOT/car"></module> <module name="org.apache.geronimo.configs/openejb-deployer/3.0-SNAPSHOT/car"><gbean name="EjbRefBuilder"><attribute name="eeNamespaces">http://java.sun.com/xml/ns/j2ee,http://java.sun.com/xml/ns/javaee</attribute></gbean> <gbean name="ClientEjbRefBuilder"><attribute name="eeNamespaces">http://java.sun.com/xml/ns/j2ee,http:/ /java.sun.com/xml/ns/javaee</attribute> <attribute name="host">$ {ServerHostname}</attribute> <attribute name="port">$ {OpenEJBPort + PortOffset}</attribute></gbean></module> <module name="org.apache.geronimo.configs/openejb-corba-deployer/3.0-SNAPSHOT/car"></module> <module name="org.apache.geronimo.configs/j2ee-corba-yoko/3.0-SNAPSHOT/car"><gbean name="NameServer"><attribute name="port">$ {COSNamingPort + PortOffset}</attribute> <attribute name="host">$ {ServerHostname}</attribute></gbean> <gbean name="Server"><attribute name="port">$ {ORBSSLPort + PortOffset}</attribute> <attribute name="host">$ {ServerHostname}</attribute></gbean> <gbean name="UnprotectedServer"><attribute name="port">$ {ORBPort + PortOffset}</attribute> <attribute name="host">$ {ServerHostname}</attribute></gbean></module> <module name="org.apache.geronimo.configs/openwebbeans/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/openwebbeans-deployer/3.0-SNAPSHOT/car"></module> <module name="org.apache.geronimo.framework/jmx-security/3.0-SNAPSHOT/car" load="false"><gbean name="JMXSecureConnector"><attribute name="protocol">rmi</attribute> <attribute name="host">$ {ServerHostname}</attribute> <attribute name="port">$ {JMXSecurePort + PortOffset}</attribute> <attribute name="urlPath">/ jndi / rmi：// $ {ServerHostname}：$ {NamingPort + PortOffset} / JMXSecureConnector</attribute> <attribute name="algorithm">默认</attribute> <attribute name="secureProtocol">TLS</attribute> <attribute name="keyStore">geronimo-默认</attribute> <attribute name="keyAlias">geronimo</attribute> <attribute name="trustStore">geronimo-默认</attribute> <attribute name="clientAuth">false</attribute></gbean></module> <module name="org.apache.geronimo.plugins.monitoring/agent-ds/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/mejb/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.plugins.monitoring/agent-car-ejb/3.0-SNAPSHOT/car" load="false"></module><module name="org.apache.geronimo.plugins.monitoring/agent-car-jmx/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/welcome-tomcat/3.0-SNAPSHOT/car"></module> <module name="org.apache.geronimo.configs/javamail/3.0-SNAPSHOT/car"><gbean name="SMTPTransport"><attribute name="host">$ {SMTPHost}</attribute> <attribute name="port">$ {SMTPPort}</attribute></gbean></module> <module name="org.apache.geronimo.plugins/plancreator-console-tomcat/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/client/3.0-SNAPSHOT/car" load="false"></module><module name="org.apache.geronimo.configs/client-security/3.0-SNAPSHOT/car" load="false"></module><module name="org.apache.geronimo.configs/client-corba-yoko/3.0-SNAPSHOT/car" load="false"></module><module name="org.apache.geronimo.configs/client-transaction-1_6/3.0-SNAPSHOT/car" load="false"></module> <module name="org.apache.geronimo.configs/client-deployer/3.0-SNAPSHOT/car"><gbean name="AppClientBuilder"><attribute name="host">$ {ServerHostname}</attribute> <attribute name="port">$ {OpenEJBPort +的PortOffset}</attribute></gbean></module> <module name="org.apache.geronimo.configs/openejb-client/3.0-SNAPSHOT/car" load="false"></module><module name="org.apache.geronimo.configs/webservices-common/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/axis/3.0-SNAPSHOT/car"></module> <module name="org.apache.geronimo.configs/axis-deployer/3.0-SNAPSHOT/car"><gbean name="AxisModuleBuilderExtension"><attribute name="listener">？name = $ {webcontainer}</attribute> <attribute name="defaultEnvironment" propertyeditor="org.apache.geronimo.deployment.service.EnvironmentBuilder"><environment:environment xmlns="http://geronimo.apache.org/xml/ns/deployment-1.2" xmlns:environment="http://geronimo.apache.org/xml/ns/deployment-1.2"><dependencies><dependency><groupid>org.apache.geronimo.configs</groupid> <artifactid>$ {webcontainerName}</artifactid> <type>汽车</type></dependency></dependencies></environment:environment></attribute></gbean></module> <module name="org.apache.geronimo.configs/jaxws-deployer/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/axis2/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/axis2-deployer/3.0-SNAPSHOT/car" condition="props['org.apache.geronimo.jaxws.provider'] == 'axis2' or
      (props['org.apache.geronimo.jaxws.provider'] == null and webcontainerName == 'tomcat7')"></module><module name="org.apache.geronimo.configs/jaxws-ejb-deployer/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/axis2-ejb/3.0-SNAPSHOT/car" load="false"></module><module name="org.apache.geronimo.configs/axis2-ejb-deployer/3.0-SNAPSHOT/car" condition="props['org.apache.geronimo.jaxws.provider'] == 'axis2' or
      (props['org.apache.geronimo.jaxws.provider'] == null and webcontainerName == 'tomcat7')"></module><module name="org.apache.geronimo.configs/jaxws-sun-tools/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/jaxws-tools/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.plugins/uddi-db/3.0-SNAPSHOT/car"></module> <module name="org.apache.geronimo.configs/uddi-tomcat/3.0-SNAPSHOT/car"><gbean name="DerbyProperties"><attribute name="systemProperties">uddi.openjpa。ConnectionURL = jdbc：derby：// localhost：$ {DerbyPort + PortOffset} / UddiDatabase; create = false;</attribute></gbean></module> <module name="org.apache.geronimo.configs/wink/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/wink-deployer/3.0-SNAPSHOT/car"></module><module name="org.apache.geronimo.configs/connector-deployer-1_6/3.0-SNAPSHOT/car"></module>
</attributes>
<!--?xml--></plain-text-body>
<p><strong>注意：这里的</strong>一些标签<code>config.xml</code>此处显示的摘录以多行显示，仅供显示。</p>


<h3 id="ConfiguringVirtualHostinTomcat-DeployingaGBeanconfiguration">部署GBean配置</h3>

<p>首先创建GBean。请注意<code><attribute name="initParams"></code>必须保留的元素。</p>

<parameter ac:name="title">gbean-Virtualhost1_com.xml</parameter> <plain-text-body><module xmlns="http://geronimo.apache.org/xml/ns/deployment-1.2"><environment><moduleid><groupid>org.example.configs.virtualhosts</groupid> <artifactid>virtualhost1</artifactid> <version>1.0</version> <type>汽车</type></moduleid> <dependencies><dependency><groupid>org.apache.geronimo.configs</groupid> <artifactid>tomcat7</artifactid> <type>汽车</type></dependency></dependencies> <hidden-classes></hidden-classes><non-overridable-classes></non-overridable-classes></environment> <gbean name="TomcatVirtualHost_1" class="org.apache.geronimo.tomcat.HostGBean"><attribute name="className">org.apache.catalina.core。StandardHost</attribute> <attribute name="initParams">名称= virtualhost1.com appBase = workDir =工作</attribute> <reference name="Engine"><name>TomcatEngine</name></reference>
    </gbean>
</module>
</plain-text-body>

<p>将GBean部署到Geronimo服务器。</p>
<ul><li>对于没有实例的单个服务器：<ul><li><code><strong>deploy --user system --password manager deploy gbean-Virtualhost1_com.xml</strong></code></li></ul>
	</li><li>对于具有多个实例的服务器：<ul><li><code><strong>deploy --user system --password manager --port <RMI_port> deploy --targets <instance_repo_target> gbean-Virtualhost1_com.xml</strong></code></li></ul>
	</li></ul>


<parameter ac:name="title">部署示例</parameter> <plain-text-body>[root @ server geronimo3]＃env GERONIMO_SERVER = gserv1 bin / deploy-用户系统-密码管理器-端口1199 deploy --targets Localgserv1 gbean-virtualhost1_com.xml使用GERONIMO_HOME：/ opt / geronimo3使用GERONIMO_SERVER：/ opt / geronimo3 / gserv1使用GERONIMO_TMPDIR：/ opt / geronimo3 / gserv1 / var / temp使用JRE_HOME：/usr/jdk1.6.0/jre部署的org.example.configs.virtualhosts / virtualhost1 / 1.0 / car</plain-text-body>

<p>部署的GBean配置是已安装的模块。可以列出所有模块，其中将显示刚刚部署的Virtual Host GBean模块。</p>
<ul><li>对于没有实例的单个服务器，或具有多个实例的服务器：<ul><li><code><strong>deploy --user system --password manager --port <RMI_port> list-modules</strong></code></li></ul>
	</li></ul>


<parameter ac:name="title">列表模块示例</parameter> <plain-text-body>[root @ server geronimo3]＃env GERONIMO_SERVER = gserv1 bin / deploy-用户系统-密码管理器-端口1199列表模块使用GERONIMO_HOME：/ opt / geronimo3使用GERONIMO_SERVER：/ opt / geronimo3 / gserv1使用GERONIMO_TMPDIR：/ opt / geronimo3 / gserv1 / var / temp使用JRE_HOME：/usr/jdk1.6.0/jre找到将83个模块部署到2个目标Target org.apache.geronimo.framework / j2ee-system / 3.0-SNAPSHOT / car？ServiceModule = org.apache.geronimo.framework / j2ee-system / 3.0-SNAPSHOT / car，j2eeType = ConfigurationStore，name = Local + org.apache.geronimo.configs / activemq-broker-blueprint / 3.0-SNAPSHOT / car ...+ org.example.configs.gserv1 / gserv1repo / 2.2 / car ...org.apache.geronimo.plugins.monitoring / agent-car-ejb / 3.0-SNAPSHOT / car目标org.example.configs.gserv1 / gserv1repo / 2.2 / car？ServiceModule = org.example.configs.gserv1 / gserv1repo / 2.2 / car，j2eeType = ConfigurationStore，名称= Localgserv1 + org.example.configs.virtualhosts / virtualhost1 / 1.0 / car</plain-text-body>

<p>要删除配置，请取消部署GBean</p>
<ul><li>对于没有实例的单个服务器，或具有多个实例的服务器：<ul><li><code><strong>deploy --user system --password manager undeploy org.example.configs.virtualhosts/virtualhost1/1.0/car</strong></code></li></ul>
	</li></ul>


<parameter ac:name="title">示例undeploy</parameter> <plain-text-body>[root @ server geronimo3]＃env GERONIMO_SERVER = gserv1 bin / deploy-用户系统-密码管理器-端口1199 undeploy org.example.configs.virtualhosts / virtualhost1 / 1.0 / car使用GERONIMO_HOME：/ opt / geronimo3使用GERONIMO_SERVER：/ opt / geronimo3 / gserv1使用GERONIMO_TMPDIR：/ opt / geronimo3 / gserv1 / var / temp使用JRE_HOME：/usr/jdk1.6.0/jre模块org.example.configs.virtualhosts / virtualhost1 / 1.0 / car已卸载。模块org.example.configs.virtualhosts / virtualhost1 / 1.0 / car已卸载。未部署的org.example.configs.virtualhosts / virtualhost1 / 1.0 / car</plain-text-body>


<h2 id="ConfiguringVirtualHostinTomcat-Declarethevirtualhostinthedeploymentplan">在部署计划中声明虚拟主机</h2>

<p>对于此主题，以<a shape="rect" href="quick-start-apache-geronimo-for-the-impatient.html">快速入门-不耐烦的Apache Geronimo</a>一节中介绍的HelloWorld示例应用程序为例。因为这是一个Web应用程序，所以您需要修改的部署计划是<code>geronimo-web.xml</code>文件。如果您使用其他类型的应用程序，则可能需要修改其他部署计划，例如<code>geronimo-application.xml</code> 。</p>

<p>在上一节中，您定义了两个虚拟主机。现在，您可以配置两个应用程序，以便可以将它们专门部署到这些虚拟主机。</p>

<p>下一节将为两个虚拟主机使用相同的应用程序，但是将通过为它提供不同的<strong>artifactId</strong>来区分一个部署和另一个部署。这样，您可以识别每个部署而无需修改代码。</p>

<p>如果您遵循<a shape="rect" href="quick-start-apache-geronimo-for-the-impatient.html">快速入门-Apache Geronimo的急切</a>部分中介绍的步骤，则HelloWorld应用程序应具有以下结构：</p>
<parameter ac:name="borderStyle">稳定</parameter> <plain-text-body><app_home>\ + HelloWorld.jsp + WEB-INF \ + geronimo-web.xml + web.xml</app_home></plain-text-body>
<p>打开<code>geronimo-web.xml</code>文件并编辑<strong>artifactId</strong>和<strong>上下文根，</strong>以使该部署唯一。内<strong><web-app></web-app></strong>部分中，添加<strong>主机</strong>属性并指定您希望此应用程序侦听的虚拟主机（在这种情况下） <code>virtualhost1.com</code> 。</p>
<parameter ac:name="">xml</parameter> <parameter ac:name="title">geronimo-web.xml用于HelloWorld_1</parameter> <parameter ac:name="borderStyle">固体</parameter> <plain-text-body><!--?xml version="1.0" encoding="UTF-8" ?=""--><web-app xmlns="http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1" xmlns:naming="http://geronimo.apache.org/xml/ns/naming-1.2" xmlns:sec="http://geronimo.apache.org/xml/ns/security-2.0" xmlns:sys="http://geronimo.apache.org/xml/ns/deployment-1.2"><sys:environment><sys:moduleid><sys:groupid>sample.applications</sys:groupid> <sys:artifactid>HelloWorldApp_1</sys:artifactid> <sys:version>2.2</sys:version> <sys:type>战争</sys:type></sys:moduleid> <sys:dependencies></sys:dependencies><sys:hidden-classes></sys:hidden-classes><sys:non-overridable-classes></sys:non-overridable-classes></sys:environment> <context-root>hello_1</context-root> <host>virtualhost1.com</host></web-app><!--?xml--></plain-text-body>
<p>将更改保存到<code>geronimo-web.xml</code>文件，并通过在命令行中键入以下命令来生成WAR文件<code><APP_HOME></code>目录：</p>

<p><strong><code>jar -cvf HelloWorld_1.war *</code></strong></p>

<p>部署HelloWorld应用程序时，该应用程序应仅在名称为<strong>virtualhost1.com</strong>的主机中列出。</p>

<p>现在，重复步骤以创建第二个WAR。编辑<code>geronimo-web.xml</code>再次文件，并复制以下示例中的内容。请注意，我们仅更改<strong><artifactid></artifactid></strong> ， <strong><context-root></context-root></strong>和<strong><host></host></strong> 。</p>
<parameter ac:name="">xml</parameter> <parameter ac:name="title">geronimo-web.xml用于HelloWorld_2</parameter> <parameter ac:name="borderStyle">固体</parameter> <plain-text-body><web-app xmlns="http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1" xmlns:naming="http://geronimo.apache.org/xml/ns/naming-1.2" xmlns:sec="http://geronimo.apache.org/xml/ns/security-2.0" xmlns:sys="http://geronimo.apache.org/xml/ns/deployment-1.2"><sys:environment><sys:moduleid><sys:groupid>sample.applications</sys:groupid> <sys:artifactid>HelloWorldApp_2</sys:artifactid> <sys:version>2.2</sys:version> <sys:type>战争</sys:type></sys:moduleid> <sys:dependencies></sys:dependencies><sys:hidden-classes></sys:hidden-classes><sys:non-overridable-classes></sys:non-overridable-classes></sys:environment> <context-root>hello_2</context-root> <host>virtualhost2.com</host></web-app></plain-text-body>
<p>将更改保存到<code>geronimo-web.xml</code>文件，并通过从键入以下命令来生成第二个WAR文件<code><APP_HOME></code>目录：</p>

<p><strong><code>jar -cvf HelloWorld_2.war *</code></strong></p>

<p>现在，您已经准备好将两个应用程序部署到两个不同的虚拟主机。</p>

<h2 id="ConfiguringVirtualHostinTomcat-Deploytheapplication">部署应用</h2>

<p>此时，您已将Geronimo配置为使用两个不同的虚拟主机，其中一个也配置为在其他别名下进行侦听。您现在要做的就是部署应用程序并对其进行测试。要部署应用程序，请从<code><GERONIMO_HOME>\bin</code>目录：</p>

<p><code><strong>deploy --user system --password manager deploy <APP_HOME>\HelloWorld_1.war</strong></code></p>

<p>您应该收到类似于以下内容的成功确认消息：</p>

<parameter ac:name="borderStyle">固定的</parameter> <plain-text-body>D：\ geronimo-tomcat7-javaee6-3.0-SNAPSHOT \ bin>部署-用户系统-密码管理器使用GERONIMO_HOME部署\ HelloWorld_2.2 \ HelloWorld_1.war：D：\ geronimo-tomcat7-javaee6-3.0-SNAPSHOT使用GERONIMO_SERVER：D：\ geronimo-tomcat7-javaee6-3.0-SNAPSHOT使用GERONIMO_TMPDIR：D：\ geronimo-tomcat7-javaee6-3.0-SNAPSHOT \ var \ temp使用JRE_HOME：C：\ Java \ jdk1.6.0 \ jre部署了sample.applications /HelloWorldApp_1/2.2/war @ / hello_1</plain-text-body>

<p>对第二个应用程序重复部署过程。</p>

<p><code><strong>deploy --user system --password manager deploy <APP_HOME>\HelloWorld_2.war</strong></code></p>

<p>您应该收到类似于以下内容的成功确认消息：</p>

<parameter ac:name="borderStyle">固定</parameter> <plain-text-body>D：\ geronimo-tomcat7-javaee6-3.0-SNAPSHOT \ bin>部署-用户系统-密码管理器使用GERONIMO_HOME部署\ HelloWorld_2.2 \ HelloWorld_2.war：D：\ geronimo-tomcat7-javaee6-3.0-SNAPSHOT使用GERONIMO_SERVER：D：\ geronimo-tomcat7-javaee6-3.0-SNAPSHOT使用GERONIMO_TMPDIR：D：\ geronimo-tomcat7-javaee6-3.0-SNAPSHOT \ var \ temp使用JRE_HOME：C：\ Java \ jdk1.6.0 \ jre部署了sample.applications /HelloWorldApp_2/2.2/war @ / hello_2</plain-text-body>

<p>部署了应用程序之后，您现在可以对其进行测试。要测试第一个具有上下文根<strong>hello_1的</strong>应用程序，请使用下表中的URL访问Geronimo服务器计算机上定义的主机名：</p>
<div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>主机名/虚拟主机</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>访问</p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://localhost:8080/hello_1" rel="nofollow">http：// localhost：8080 / hello_1</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>失败</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost1.com:8080/hello_1" rel="nofollow">http://virtualhost1.com:8080/hello_1</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> <strong>成功！！！</strong> </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost2.com:8080/hello_1" rel="nofollow">http://virtualhost2.com:8080/hello_1</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>失败</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost3.com:8080/hello_1" rel="nofollow">http://virtualhost3.com:8080/hello_1</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>失败</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost4.com:8080/hello_1" rel="nofollow">http://virtualhost4.com:8080/hello_1</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>失败</p></td></tr></tbody></table></div>

<p>现在，对具有上下文根<strong>hello_2</strong>的第二个应用程序重复测试。</p>
<div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>主机名/虚拟主机</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>访问</p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://localhost:8080/hello_2" rel="nofollow">http：// localhost：8080 / hello_2</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>失败</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost1.com:8080/hello_2" rel="nofollow">http://virtualhost1.com:8080/hello_2</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>失败</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost2.com:8080/hello_2" rel="nofollow">http://virtualhost2.com:8080/hello_2</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> <strong>成功！！！</strong> </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost3.com:8080/hello_2" rel="nofollow">http://virtualhost3.com:8080/hello_2</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> <strong>成功！！！</strong> </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost4.com:8080/hello_2" rel="nofollow">http://virtualhost4.com:8080/hello_2</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> <strong>成功！！！</strong> </p></td></tr></tbody></table></div>

<p>恭喜！！！您已经成功配置了两个应用程序并将其部署到两个不同的虚拟主机和别名。</p></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Configuring Virtual Host in Tomcat';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2013，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  

</body></html>