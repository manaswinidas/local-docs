<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link type="text/css" rel="stylesheet" href="http://geronimo.apache.org/style/default.css">
    <LINK rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <META name="Description" content="Configuring Virtual Host in Tomcat" />
    <META name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Configuring Virtual Host in Tomcat" />
    <META name="Owner" content="dev@geronimo.apache.org" />
    <META name="Robots" content="index, follow" />
    <META name="Security" content="Public" />
    <META name="Source" content="wiki template" />
    <META name="DC.Date" scheme="iso8601" content="2010-05-11" />
    <META name="DC.Language" scheme="rfc1766" content="en" />
    <META name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation" />
    <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0 Documentation: Configuring Virtual Host in Tomcat</title>
  </head>

  <body onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tr>
        <td valing="top" align="left">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" align="left" nowrap>
          <a href="/geronimo"> Home</a> >&nbsp;<a href="documentation.html">Documentation</a>&nbsp;&gt;&nbsp;<a href="configuring-and-administering.html">Configuring and administering</a>&nbsp;&gt;&nbsp;<a href="configuring-and-administering-the-apache-geronimo-server.html">Configuring and administering the Apache Geronimo Server</a>&nbsp;&gt;&nbsp;<a href="configuring-the-web-container.html">Configuring the Web Container</a>&nbsp;&gt;&nbsp;<a href="configuring-virtual-host.html">Configuring virtual host</a>&nbsp;&gt;&nbsp;<a href="configuring-virtual-host-in-tomcat.html">Configuring Virtual Host in Tomcat</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8" />
            <input type="hidden" name="oe" value="UTF-8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
        </td>
      </tr> 
    </table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div style="margin: 0px 10px 0px 10px" class="smalltext">Apache Geronimo v3.0</div>
        <div style="margin: 0px 10px 8px 10px"  class="pagetitle">Configuring Virtual Host in Tomcat</div>

        <div class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
<!-- -->         
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645459">
            <img src="http://geronimo.apache.org/images/icons/notep_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Edit Page"></a>
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645459">Edit Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">
            <img src="http://geronimo.apache.org/images/icons/browse_space.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Browse Space"></a>
            <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">Browse Space</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645459">
            <img src="http://geronimo.apache.org/images/icons/add_page_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add Page"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645459">Add Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645459">
            <img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add News"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645459">Add News</a>
<!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><p><plain-text-body>{scrollbar}</plain-text-body><parameter ac:name="atlassian-macro-output-type">INLINE</parameter><rich-text-body><p>This article shows how to configure Virtual Hosts in Apache Geronimo with Tomcat.</p></rich-text-body> By default, when you deploy and start an application in Geronimo, that application will be listening on every available host name. By configuring a virtual host, you can make an application listen on a specific host name or IP. The configuration steps described in this article are also valid when you are sharing a single IP among several host names.<br clear="none">
To configure a virtual host in Geronimo, you basically need to do the following actions:</p>
<parameter ac:name="minLevel">2</parameter>
<p>This article used the simple HelloWorld application as a reference. This application is covered in the <a shape="rect" href="quick-start-apache-geronimo-for-the-impatient.html">Quick start - Apache Geronimo for the impatient</a> section.</p>

<h2 id="ConfiguringVirtualHostinTomcat-ConfigurelocalhostorDNS">Configure local host or DNS</h2>

<p>To make this configuration work, you need to ensure that Geronimo can resolve the virtual host name you are about to define. Depending on your network configuration, you can add an entry to your DNS, or an alias to the Geronimo server IP. Alternatively, you can add an entry to the local host table. Each operating system has its own way to define a local host table. For example Windows will have <code>%SystemRoot%\system32\drivers\etc\hosts</code>, and UNIX based operating systems would normally have an <code>/etc/hosts</code>.</p>

<p>For this example we will be using the following host names defined in the local host table:</p>

<p><code><strong>127.0.0.1    localhost    virtualhost1.com    virtualhost2.com    virtualhost3.com    virtualhost4.com</strong></code></p>

<p>Make sure that your system can resolve these names.</p>

<h2 id="ConfiguringVirtualHostinTomcat-DefineVirtualhost">Define Virtual host</h2>

<p>There are three approaches to defining a virtual host in Geronimo:</p>
<ol><li>Manually by directly editing Geronimo's <code>var/config/config.xml</code> to set the definition. Requires a restart of Geronimo.</li><li>Automatically by deploying a GBean which contains the definition. <strong>Does not</strong> require a restart of Geronimo.</li><li>Manually by editing Tomcat Catalina's <code>var/catalina/server.xml</code> to set the definition. Requires a restart of Geronimo.</li></ol>


<p>We will cover the first two options which are specific to Geronimo's methodology of configuration. Instructions on performing the third option can be found in documentation on the Apache Tomcat project web site.</p>

<h3 id="ConfiguringVirtualHostinTomcat-Manuallyeditingvar/config/config.xml">Manually editing <code>var/config/config.xml</code></h3>

<p>Now you need to define those virtual hosts in Geronimo's <code>config.xml</code> file so that Geronimo can recognize them. This section provides two different virtual host definitions, one defined with multiple host names aliases and one without host names alias. The virtual hosts are defined by creating two new <strong>HostGBean</strong> ( <em>TomcatVirtualHost1</em> and <em>TomcatVirtualHost2</em> ) in the Geronimo configuration. The goal of this example is to have an application listen on a single virtual host ( virtualhost1.com ) and another application listen on a different virtual host ( virtualhost2.com ), which has two aliases ( virtualhost3.com and virtualhost4.com ).</p>

<p>Open the <code>config.xml</code> file located in the <code>&lt;geronimo_home&gt;/var</code> directory and look for the following line <code>&lt;module name="org.apache.geronimo.configs/tomcat7/3.0/car"&gt;</code>. This is the beginning of the Tomcat configuration module. All the additional virtual host configurations will be done immediately after this line.</p>

<p>To define the first HostGBean <strong>TomcatVirtualHost_1</strong>, add the following lines right after <code>&lt;module name="org.apache.geronimo.configs/tomcat7/3.0/car"&gt;</code>.</p>
<parameter ac:name="">xml</parameter><parameter ac:name="title">Excerpt from config.xml</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
...
&lt;gbean gbeanInfo="org.apache.geronimo.tomcat.HostGBean"
    name="org.apache.geronimo.configs/tomcat7/3.0/car?ServiceModule=org.apache.geronimo.configs/tomcat7/3.0/car,j2eeType=Host,name=TomcatVirtualHost_1"&gt;
    &lt;attribute name="className"&gt;org.apache.catalina.core.StandardHost&lt;/attribute&gt;
    &lt;attribute name="initParams"&gt;name=virtualhost1.com
       appBase=
       workDir=work&lt;/attribute&gt;
    &lt;reference name="Engine"&gt;
        &lt;pattern&gt;
            &lt;name&gt;TomcatEngine&lt;/name&gt;
        &lt;/pattern&gt;
    &lt;/reference&gt;
&lt;/gbean&gt;
...
</plain-text-body>
<p>To add the second HostGBean <strong>TomcatVirtualHost_2</strong>, add the following lines right after the first HostGBean. These two HostGBeans have been split so that it is easier to identify them. The main difference between these two HostGBeans is the <code><strong>&lt;attribute name="aliases"&gt;..,..&lt;/attribute&gt;</strong></code> line that defines the aliases.</p>
<parameter ac:name="">xml</parameter><parameter ac:name="title">Excerpt from config.xml</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
...
&lt;gbean gbeanInfo="org.apache.geronimo.tomcat.HostGBean"
    name="org.apache.geronimo.configs/tomcat7/3.0/car?ServiceModule=org.apache.geronimo.configs/tomcat7/3.0/car,j2eeType=Host,name=TomcatVirtualHost_2"&gt;
    &lt;attribute name="className"&gt;org.apache.catalina.core.StandardHost&lt;/attribute&gt;
    &lt;attribute name="initParams"&gt;name=virtualhost2.com
       appBase=
       workDir=work&lt;/attribute&gt;
       &lt;attribute name="aliases"&gt;virtualhost3.com,virtualhost4.com&lt;/attribute&gt;
    &lt;reference name="Engine"&gt;
        &lt;pattern&gt;
            &lt;name&gt;TomcatEngine&lt;/name&gt;
        &lt;/pattern&gt;
    &lt;/reference&gt;
&lt;/gbean&gt;
...
</plain-text-body>
<p>At this point, you have successfully configured two different virtual hosts in Geronimo. Make sure that you save the changes to the <code>config.xml</code> file and then <a shape="rect" href="tools-and-commands.html">start</a> Geronimo.</p>

<p>For additional reference, see the following excerpt from <code>config.xml</code> of the entire <code>&lt;module name="org.apache.geronimo.configs/tomcat7/3.0/car"&gt;</code> entry with the two <strong>HostGBean</strong> already defined.</p>
<parameter ac:name="">xml</parameter><parameter ac:name="title">config.xml</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;attributes xmlns:ns2="http://geronimo.apache.org/xml/ns/plugins-1.3" xmlns="http://geronimo.apache.org/xml/ns/attributes-1.2"&gt;
    &lt;comment&gt;
==================================================================
Warning - This XML file is regenerated by Geronimo whenever
changes are made to Geronimo's configuration.

If you want to include comments, create a single comment element
element.  They are allowable at any level of the configuration.

!!!! Do not edit this file while Geronimo is running !!!!
==================================================================&lt;/comment&gt;
    &lt;module name="org.apache.geronimo.framework/j2ee-system/3.0-SNAPSHOT/car"/&gt;
    &lt;module load="false" name="org.apache.geronimo.framework/client-system/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.framework/rmi-naming/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="RMIRegistry"&gt;
            &lt;attribute name="port"&gt;${NamingPort + PortOffset}&lt;/attribute&gt;
            &lt;attribute name="host"&gt;${ServerHostname}&lt;/attribute&gt;
        &lt;/gbean&gt;
        &lt;gbean name="DefaultThreadPool"&gt;
            &lt;attribute name="keepAliveTime"&gt;30000&lt;/attribute&gt;
            &lt;attribute name="minPoolSize"&gt;${MinThreadPoolSize}&lt;/attribute&gt;
            &lt;attribute name="maxPoolSize"&gt;${MaxThreadPoolSize}&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.framework/plugin/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="DownloadedPluginRepos"&gt;
            &lt;attribute name="repositoryList"&gt;http://geronimo.apache.org/plugins/plugin-repository-list-3.0.txt&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.framework/j2ee-security/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="JMXService"&gt;
            &lt;attribute name="protocol"&gt;rmi&lt;/attribute&gt;
            &lt;attribute name="host"&gt;${ServerHostname}&lt;/attribute&gt;
            &lt;attribute name="port"&gt;${JMXPort + PortOffset}&lt;/attribute&gt;
            &lt;attribute name="urlPath"&gt;/jndi/rmi://${ServerHostname}:${NamingPort + PortOffset}/JMXConnector&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.framework/server-security-config/3.0-SNAPSHOT/car"/&gt;
    &lt;module load="false" name="org.apache.geronimo.framework/shutdown/3.0-SNAPSHOT/car"/&gt;
    &lt;module load="false" name="org.apache.geronimo.framework/online-deployer/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.framework/bundle-recorder/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.framework/geronimo-gbean-deployer/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="Deployer"&gt;
            &lt;attribute name="remoteDeployAddress"&gt;http://${RemoteDeployHostname}:${HTTPPort + PortOffset}&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.configs/j2ee-server/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/j2ee-deployer/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="WebBuilder"&gt;
            &lt;attribute name="defaultNamespace"&gt;http://geronimo.apache.org/xml/ns/j2ee/web/jetty-2.0&lt;/attribute&gt;
        &lt;/gbean&gt;
        &lt;gbean name="EnvironmentEntryBuilder"&gt;
            &lt;attribute name="eeNamespaces"&gt;http://java.sun.com/xml/ns/j2ee,http://java.sun.com/xml/ns/javaee&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.configs/bval-deployer/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/transaction-1_6/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="XidFactory"&gt;
            &lt;attribute name="tmId"&gt;${TmId}&lt;/attribute&gt;
        &lt;/gbean&gt;
        &lt;gbean name="ResourceBindings"&gt;
            &lt;attribute name="format"&gt;${ResourceBindingsFormat}&lt;/attribute&gt;
            &lt;attribute name="nameInNamespace"&gt;${ResourceBindingsNameInNamespace}&lt;/attribute&gt;
            &lt;attribute name="namePattern"&gt;${ResourceBindingsNamePattern}&lt;/attribute&gt;
            &lt;attribute name="abstractNameQuery"&gt;${ResourceBindingsQuery}&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.configs/jasper/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/tomcat7/3.0-SNAPSHOT/car"&gt;

        &lt;!-- Virtual Host 1 definition --&gt;
        &lt;gbean name="org.apache.geronimo.configs/tomcat7/3.0/car?ServiceModule=org.apache.geronimo.configs/tomcat7/3.0/car,
        j2eeType=Host,name=TomcatVirtualHost_1" gbeanInfo="org.apache.geronimo.tomcat.HostGBean"&gt;
            &lt;attribute name="className"&gt;org.apache.catalina.core.StandardHost&lt;/attribute&gt;
            &lt;attribute name="initParams"&gt;name=virtualhost1.com
			                 appBase=
                                         workDir=work&lt;/attribute&gt;
           &lt;reference name="Engine"&gt;
                &lt;pattern&gt;
                    &lt;name&gt;TomcatEngine&lt;/name&gt;
                &lt;/pattern&gt;
           &lt;/reference&gt;
        &lt;/gbean&gt;

        &lt;!-- Virtual Host 2 and aliases definition --&gt;
        &lt;gbean name="org.apache.geronimo.configs/tomcat7/3.0/car?ServiceModule=org.apache.geronimo.configs/tomcat7/3.0/car,
        j2eeType=Host,name=TomcatVirtualHost_2" gbeanInfo="org.apache.geronimo.tomcat.HostGBean"&gt;
            &lt;attribute name="className"&gt;org.apache.catalina.core.StandardHost&lt;/attribute&gt;
            &lt;attribute name="initParams"&gt;name=virtualhost2.com
			                 appBase=
                                         workDir=work&lt;/attribute&gt;
            &lt;attribute name="aliases"&gt;virtualhost3.com,virtualhost4.com&lt;/attribute&gt;
            &lt;reference name="Engine"&gt;
                &lt;pattern&gt;
                    &lt;name&gt;TomcatEngine&lt;/name&gt;
                &lt;/pattern&gt;
           &lt;/reference&gt;
        &lt;/gbean&gt;

    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.configs/tomcat7-deployer/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/web-extender/3.0-SNAPSHOT/car"/&gt;
    &lt;module load="false" name="org.apache.geronimo.framework/offline-deployer/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/hot-deployer/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="HotDeployer"&gt;
            &lt;attribute name="path"&gt;deploy/&lt;/attribute&gt;
            &lt;attribute name="pollIntervalMillis"&gt;2000&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.configs/remote-deploy-tomcat/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/jasper-deployer/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/myfaces/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/myfaces-deployer/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/sharedlib-extender/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/sharedlib/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/aries/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/aries-deployer/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/persistence-jpa20-deployer/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="PersistenceUnitBuilder"&gt;
            &lt;attribute name="defaultPersistenceProviderClassName"&gt;org.apache.openjpa.persistence.PersistenceProviderImpl&lt;/attribute&gt;
            &lt;attribute name="defaultPersistenceUnitProperties"&gt;openjpa.Log=commons
                                        openjpa.jdbc.SynchronizeMappings=buildSchema(ForeignKeys=true)
                                        openjpa.jdbc.UpdateManager=operation-order
                                        openjpa.Sequence=table(Table=OPENJPASEQ, Increment=100)&lt;/attribute&gt;
            &lt;attribute name="defaultEnvironment" propertyEditor="org.apache.geronimo.deployment.service.EnvironmentBuilder"&gt;
                &lt;environment:environment xmlns="http://geronimo.apache.org/xml/ns/deployment-1.2" xmlns:environment="http://geronimo.apache.org/xml/ns/deployment-1.2"&gt;
                    &lt;dependencies&gt;
                        &lt;dependency&gt;
                            &lt;groupId&gt;org.apache.geronimo.configs&lt;/groupId&gt;
                            &lt;artifactId&gt;openjpa2&lt;/artifactId&gt;
                            &lt;type&gt;car&lt;/type&gt;
            &lt;/dependency&gt;
          &lt;/dependencies&gt;
        &lt;/environment:environment&gt;
            &lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.configs/openjpa2/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/system-database/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="DerbyNetwork"&gt;
            &lt;attribute name="host"&gt;${ServerHostname}&lt;/attribute&gt;
            &lt;attribute name="port"&gt;${DerbyPort + PortOffset}&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.plugins/pluto-support/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.plugins/console-tomcat/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.plugins/plugin-console-tomcat/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.plugins.monitoring/mconsole-ds/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/openejb/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="EJBNetworkService"&gt;
            &lt;attribute name="port"&gt;${OpenEJBPort + PortOffset}&lt;/attribute&gt;
            &lt;attribute name="host"&gt;${ServerHostname}&lt;/attribute&gt;
            &lt;attribute name="multicastHost"&gt;${MulticastDiscoveryAddress}&lt;/attribute&gt;
            &lt;attribute name="multicastPort"&gt;${MulticastDiscoveryPort}&lt;/attribute&gt;
            &lt;attribute name="multipointHost"&gt;${MultipointHost}&lt;/attribute&gt;
            &lt;attribute name="multipointPort"&gt;${MultipointPort + PortOffset}&lt;/attribute&gt;
            &lt;attribute name="multipointServers"&gt;${MultipointServers}&lt;/attribute&gt;
            &lt;attribute name="multipointEnabled"&gt;${MultipointEnabled}&lt;/attribute&gt;
            &lt;attribute name="multicastEnabled"&gt;${MulticastEnabled}&lt;/attribute&gt;
            &lt;attribute name="clusterName"&gt;${ClusterName}&lt;/attribute&gt;
        &lt;/gbean&gt;
        &lt;gbean name="DefaultStatefulContainer"&gt;
            &lt;attribute name="accessTimeout"&gt;30&lt;/attribute&gt;
            &lt;attribute name="timeOut"&gt;20&lt;/attribute&gt;
            &lt;attribute name="capacity"&gt;1000&lt;/attribute&gt;
            &lt;attribute name="bulkPassivate"&gt;100&lt;/attribute&gt;
        &lt;/gbean&gt;
        &lt;gbean name="DefaultSingletonContainer"&gt;
            &lt;attribute name="accessTimeout"&gt;30&lt;/attribute&gt;
        &lt;/gbean&gt;
        &lt;gbean name="DefaultBMPContainer"&gt;
            &lt;attribute name="poolSize"&gt;10&lt;/attribute&gt;
        &lt;/gbean&gt;
        &lt;gbean name="DefaultStatelessContainer"&gt;
            &lt;attribute name="accessTimeout"&gt;30&lt;/attribute&gt;
            &lt;attribute name="closeTimeout"&gt;5&lt;/attribute&gt;
            &lt;attribute name="maxSize"&gt;10&lt;/attribute&gt;
            &lt;attribute name="minSize"&gt;0&lt;/attribute&gt;
            &lt;attribute name="strictPooling"&gt;true&lt;/attribute&gt;
            &lt;attribute name="idleTimeout"&gt;0&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.plugins.monitoring/mconsole-tomcat/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/activemq-broker-blueprint/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/activemq-ra/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="ActiveMQ RA"&gt;
            &lt;attribute name="ServerUrl"&gt;tcp://${ActiveMQHostname}:${ActiveMQPort + PortOffset}&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.plugins/activemq-console-tomcat/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.plugins/debugviews-console-tomcat/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.plugins/sysdb-console-tomcat/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.plugins/openejb-console-tomcat/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/openejb-deployer/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="EjbRefBuilder"&gt;
            &lt;attribute name="eeNamespaces"&gt;http://java.sun.com/xml/ns/j2ee,http://java.sun.com/xml/ns/javaee&lt;/attribute&gt;
        &lt;/gbean&gt;
        &lt;gbean name="ClientEjbRefBuilder"&gt;
            &lt;attribute name="eeNamespaces"&gt;http://java.sun.com/xml/ns/j2ee,http://java.sun.com/xml/ns/javaee&lt;/attribute&gt;
            &lt;attribute name="host"&gt;${ServerHostname}&lt;/attribute&gt;
            &lt;attribute name="port"&gt;${OpenEJBPort + PortOffset}&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.configs/openejb-corba-deployer/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/j2ee-corba-yoko/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="NameServer"&gt;
            &lt;attribute name="port"&gt;${COSNamingPort + PortOffset}&lt;/attribute&gt;
            &lt;attribute name="host"&gt;${ServerHostname}&lt;/attribute&gt;
        &lt;/gbean&gt;
        &lt;gbean name="Server"&gt;
            &lt;attribute name="port"&gt;${ORBSSLPort + PortOffset}&lt;/attribute&gt;
            &lt;attribute name="host"&gt;${ServerHostname}&lt;/attribute&gt;
        &lt;/gbean&gt;
        &lt;gbean name="UnprotectedServer"&gt;
            &lt;attribute name="port"&gt;${ORBPort + PortOffset}&lt;/attribute&gt;
            &lt;attribute name="host"&gt;${ServerHostname}&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.configs/openwebbeans/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/openwebbeans-deployer/3.0-SNAPSHOT/car"/&gt;
    &lt;module load="false" name="org.apache.geronimo.framework/jmx-security/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="JMXSecureConnector"&gt;
            &lt;attribute name="protocol"&gt;rmi&lt;/attribute&gt;
            &lt;attribute name="host"&gt;${ServerHostname}&lt;/attribute&gt;
            &lt;attribute name="port"&gt;${JMXSecurePort + PortOffset}&lt;/attribute&gt;
            &lt;attribute name="urlPath"&gt;/jndi/rmi://${ServerHostname}:${NamingPort + PortOffset}/JMXSecureConnector&lt;/attribute&gt;
            &lt;attribute name="algorithm"&gt;Default&lt;/attribute&gt;
            &lt;attribute name="secureProtocol"&gt;TLS&lt;/attribute&gt;
            &lt;attribute name="keyStore"&gt;geronimo-default&lt;/attribute&gt;
            &lt;attribute name="keyAlias"&gt;geronimo&lt;/attribute&gt;
            &lt;attribute name="trustStore"&gt;geronimo-default&lt;/attribute&gt;
            &lt;attribute name="clientAuth"&gt;false&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.plugins.monitoring/agent-ds/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/mejb/3.0-SNAPSHOT/car"/&gt;
    &lt;module load="false" name="org.apache.geronimo.plugins.monitoring/agent-car-ejb/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.plugins.monitoring/agent-car-jmx/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/welcome-tomcat/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/javamail/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="SMTPTransport"&gt;
            &lt;attribute name="host"&gt;${SMTPHost}&lt;/attribute&gt;
            &lt;attribute name="port"&gt;${SMTPPort}&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.plugins/plancreator-console-tomcat/3.0-SNAPSHOT/car"/&gt;
    &lt;module load="false" name="org.apache.geronimo.configs/client/3.0-SNAPSHOT/car"/&gt;
    &lt;module load="false" name="org.apache.geronimo.configs/client-security/3.0-SNAPSHOT/car"/&gt;
    &lt;module load="false" name="org.apache.geronimo.configs/client-corba-yoko/3.0-SNAPSHOT/car"/&gt;
    &lt;module load="false" name="org.apache.geronimo.configs/client-transaction-1_6/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/client-deployer/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="AppClientBuilder"&gt;
            &lt;attribute name="host"&gt;${ServerHostname}&lt;/attribute&gt;
            &lt;attribute name="port"&gt;${OpenEJBPort + PortOffset}&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module load="false" name="org.apache.geronimo.configs/openejb-client/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/webservices-common/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/axis/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/axis-deployer/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="AxisModuleBuilderExtension"&gt;
            &lt;attribute name="listener"&gt;?name=${webcontainer}&lt;/attribute&gt;
            &lt;attribute name="defaultEnvironment" propertyEditor="org.apache.geronimo.deployment.service.EnvironmentBuilder"&gt;
                &lt;environment:environment xmlns="http://geronimo.apache.org/xml/ns/deployment-1.2" xmlns:environment="http://geronimo.apache.org/xml/ns/deployment-1.2"&gt;
                    &lt;dependencies&gt;
                        &lt;dependency&gt;
                            &lt;groupId&gt;org.apache.geronimo.configs&lt;/groupId&gt;
                            &lt;artifactId&gt;${webcontainerName}&lt;/artifactId&gt;
                            &lt;type&gt;car&lt;/type&gt;
            &lt;/dependency&gt;
          &lt;/dependencies&gt;
        &lt;/environment:environment&gt;
            &lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.configs/jaxws-deployer/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/axis2/3.0-SNAPSHOT/car"/&gt;
    &lt;module condition="props['org.apache.geronimo.jaxws.provider'] == 'axis2' or
      (props['org.apache.geronimo.jaxws.provider'] == null and webcontainerName == 'tomcat7')"
      name="org.apache.geronimo.configs/axis2-deployer/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/jaxws-ejb-deployer/3.0-SNAPSHOT/car"/&gt;
    &lt;module load="false" name="org.apache.geronimo.configs/axis2-ejb/3.0-SNAPSHOT/car"/&gt;
    &lt;module condition="props['org.apache.geronimo.jaxws.provider'] == 'axis2' or
      (props['org.apache.geronimo.jaxws.provider'] == null and webcontainerName == 'tomcat7')"
      name="org.apache.geronimo.configs/axis2-ejb-deployer/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/jaxws-sun-tools/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/jaxws-tools/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.plugins/uddi-db/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/uddi-tomcat/3.0-SNAPSHOT/car"&gt;
        &lt;gbean name="DerbyProperties"&gt;
            &lt;attribute name="systemProperties"&gt;uddi.openjpa.ConnectionURL=jdbc:derby://localhost:${DerbyPort + PortOffset}/UddiDatabase;create=false;&lt;/attribute&gt;
        &lt;/gbean&gt;
    &lt;/module&gt;
    &lt;module name="org.apache.geronimo.configs/wink/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/wink-deployer/3.0-SNAPSHOT/car"/&gt;
    &lt;module name="org.apache.geronimo.configs/connector-deployer-1_6/3.0-SNAPSHOT/car"/&gt;
&lt;/attributes&gt;
</plain-text-body>
<p><strong>Note:</strong> Some tags in this <code>config.xml</code> excerpt shown here are presented in multiple lines for displaying purposes only.</p>


<h3 id="ConfiguringVirtualHostinTomcat-DeployingaGBeanconfiguration">Deploying a GBean configuration</h3>

<p>First create the GBean. Note the formatting of the <code>&lt;attribute name="initParams"&gt;</code> element which must be left as seen.</p>

<parameter ac:name="title">gbean-Virtualhost1_com.xml</parameter><plain-text-body>
&lt;module xmlns="http://geronimo.apache.org/xml/ns/deployment-1.2"&gt;
    &lt;environment&gt;
        &lt;moduleId&gt;
            &lt;groupId&gt;org.example.configs.virtualhosts&lt;/groupId&gt;
            &lt;artifactId&gt;virtualhost1&lt;/artifactId&gt;
            &lt;version&gt;1.0&lt;/version&gt;
            &lt;type&gt;car&lt;/type&gt;
        &lt;/moduleId&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.apache.geronimo.configs&lt;/groupId&gt;
                &lt;artifactId&gt;tomcat7&lt;/artifactId&gt;
                &lt;type&gt;car&lt;/type&gt;
            &lt;/dependency&gt;
        &lt;/dependencies&gt;
        &lt;hidden-classes/&gt;
        &lt;non-overridable-classes/&gt;
    &lt;/environment&gt;
    &lt;gbean name="TomcatVirtualHost_1" class="org.apache.geronimo.tomcat.HostGBean"&gt;
        &lt;attribute name="className"&gt;org.apache.catalina.core.StandardHost&lt;/attribute&gt;
        &lt;attribute name="initParams"&gt;name=virtualhost1.com
                                     appBase=
                                     workDir=work&lt;/attribute&gt;
        &lt;reference name="Engine"&gt;
            &lt;name&gt;TomcatEngine&lt;/name&gt;
        &lt;/reference&gt;
    &lt;/gbean&gt;
&lt;/module&gt;
</plain-text-body>

<p>Deploy the GBean to your Geronimo server.</p>
<ul><li>For a single server with no instances:
	<ul><li><code><strong>deploy --user system --password manager deploy gbean-Virtualhost1_com.xml</strong></code></li></ul>
	</li><li>For a server with multiple instances:
	<ul><li><code><strong>deploy --user system --password manager --port &lt;RMI_port&gt; deploy --targets &lt;instance_repo_target&gt; gbean-Virtualhost1_com.xml</strong></code></li></ul>
	</li></ul>


<parameter ac:name="title">Example deploy</parameter><plain-text-body>
[root@server geronimo3]# env GERONIMO_SERVER=gserv1 bin/deploy --user system --password manager --port 1199 deploy --targets Localgserv1 gbean-virtualhost1_com.xml 
Using GERONIMO_HOME:   /opt/geronimo3
Using GERONIMO_SERVER: /opt/geronimo3/gserv1
Using GERONIMO_TMPDIR: /opt/geronimo3/gserv1/var/temp
Using JRE_HOME:        /usr/jdk1.6.0/jre
    Deployed org.example.configs.virtualhosts/virtualhost1/1.0/car
</plain-text-body>

<p>The deployed GBean configuration is an installed module. All modules can be listed, which will show the Virtual Host GBean module just deployed.</p>
<ul><li>For either a single server with no instances, or server with multiple instances:
	<ul><li><code><strong>deploy --user system --password manager --port &lt;RMI_port&gt; list-modules</strong></code></li></ul>
	</li></ul>


<parameter ac:name="title">Example list-modules</parameter><plain-text-body>
[root@server geronimo3]# env GERONIMO_SERVER=gserv1 bin/deploy --user system --password manager --port 1199 list-modules
Using GERONIMO_HOME:   /opt/geronimo3
Using GERONIMO_SERVER: /opt/geronimo3/gserv1
Using GERONIMO_TMPDIR: /opt/geronimo3/gserv1/var/temp
Using JRE_HOME:        /usr/jdk1.6.0/jre
Found 83 modules deployed to 2 targets

 Target org.apache.geronimo.framework/j2ee-system/3.0-SNAPSHOT/car?ServiceModule=org.apache.geronimo.framework/j2ee-system/3.0-SNAPSHOT/car,j2eeType=ConfigurationStore,name=Local
  + org.apache.geronimo.configs/activemq-broker-blueprint/3.0-SNAPSHOT/car
  ...
  + org.example.configs.gserv1/gserv1repo/2.2/car
    ...
    org.apache.geronimo.plugins.monitoring/agent-car-ejb/3.0-SNAPSHOT/car

 Target org.example.configs.gserv1/gserv1repo/2.2/car?ServiceModule=org.example.configs.gserv1/gserv1repo/2.2/car,j2eeType=ConfigurationStore,name=Localgserv1
  + org.example.configs.virtualhosts/virtualhost1/1.0/car
</plain-text-body>

<p>To remove the configuration, undeploy the GBean</p>
<ul><li>For either a single server with no instances, or server with multiple instances:
	<ul><li><code><strong>deploy --user system --password manager undeploy org.example.configs.virtualhosts/virtualhost1/1.0/car</strong></code></li></ul>
	</li></ul>


<parameter ac:name="title">Example undeploy</parameter><plain-text-body>
[root@server geronimo3]# env GERONIMO_SERVER=gserv1 bin/deploy --user system --password manager --port 1199 undeploy org.example.configs.virtualhosts/virtualhost1/1.0/car
Using GERONIMO_HOME:   /opt/geronimo3
Using GERONIMO_SERVER: /opt/geronimo3/gserv1
Using GERONIMO_TMPDIR: /opt/geronimo3/gserv1/var/temp
Using JRE_HOME:        /usr/jdk1.6.0/jre
    Module org.example.configs.virtualhosts/virtualhost1/1.0/car
    unloaded.
    Module org.example.configs.virtualhosts/virtualhost1/1.0/car
    uninstalled.

    Undeployed org.example.configs.virtualhosts/virtualhost1/1.0/car
</plain-text-body>


<h2 id="ConfiguringVirtualHostinTomcat-Declarethevirtualhostinthedeploymentplan">Declare the virtual host in the deployment plan</h2>

<p>For this topic, the HelloWorld sample application covered in the <a shape="rect" href="quick-start-apache-geronimo-for-the-impatient.html">Quick start - Apache Geronimo for the impatient</a> section is used as an example. Because this is a Web application, the deployment plan that you need to modify is a <code>geronimo-web.xml</code> file. If you use a different type of application, you might need to modify a different deployment plan, for example <code>geronimo-application.xml</code>.</p>

<p>In the previous section, you defined two Virtual Hosts. Now, you can configure two applications so that they can be deployed to those Virtual Hosts exclusively.</p>

<p>The following section uses the same application for the two Virtual Hosts, but will differentiate one deployment from the other by giving it a different <strong>artifactId</strong>. This way you can identify each deployment without modifying the code.</p>

<p>If you followed the steps covered in the <a shape="rect" href="quick-start-apache-geronimo-for-the-impatient.html">Quick start - Apache Geronimo for the impatient</a> section, your HelloWorld application should have the following structure:</p>
<parameter ac:name="borderStyle">solid</parameter><plain-text-body>
&lt;APP_HOME&gt;\
          + HelloWorld.jsp
          + WEB-INF\
                    + geronimo-web.xml
                    + web.xml
</plain-text-body>
<p>Open the <code>geronimo-web.xml</code> file and edit the <strong>artifactId</strong> and <strong>context-root</strong> to make this deployment unique. Within the <strong>&lt;web-app&gt;</strong> section, add the <strong>host</strong> attribute and specify the Virtual Host that you want this application to listen on, in this case <code>virtualhost1.com</code>.</p>
<parameter ac:name="">xml</parameter><parameter ac:name="title">geronimo-web.xml for HelloWorld_1</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns="http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1"
         xmlns:naming="http://geronimo.apache.org/xml/ns/naming-1.2"
         xmlns:sec="http://geronimo.apache.org/xml/ns/security-2.0"
         xmlns:sys="http://geronimo.apache.org/xml/ns/deployment-1.2"&gt;

  &lt;sys:environment&gt;
    &lt;sys:moduleId&gt;
      &lt;sys:groupId&gt;sample.applications&lt;/sys:groupId&gt;
      &lt;sys:artifactId&gt;HelloWorldApp_1&lt;/sys:artifactId&gt;
      &lt;sys:version&gt;2.2&lt;/sys:version&gt;
      &lt;sys:type&gt;war&lt;/sys:type&gt;
    &lt;/sys:moduleId&gt;
    &lt;sys:dependencies/&gt;
    &lt;sys:hidden-classes/&gt;
    &lt;sys:non-overridable-classes/&gt;
  &lt;/sys:environment&gt;

  &lt;context-root&gt;hello_1&lt;/context-root&gt;
  &lt;host&gt;virtualhost1.com&lt;/host&gt;
&lt;/web-app&gt;
</plain-text-body>
<p>Save the changed to the <code>geronimo-web.xml</code> file and generate a WAR file by typing the following command from the <code>&lt;APP_HOME&gt;</code> directory:</p>

<p><strong><code>jar -cvf HelloWorld_1.war *</code></strong></p>

<p>When the HelloWorld application is deployed, this application should only be listed in the host with the name <strong>virtualhost1.com</strong>.</p>

<p>Now repeat the steps to create a second WAR. Edit the <code>geronimo-web.xml</code> file once again and copy the content from the following example. Note that we are only changing the <strong>&lt;artifactId&gt;</strong>, <strong>&lt;context-root&gt;</strong> and <strong>&lt;host&gt;</strong>.</p>
<parameter ac:name="">xml</parameter><parameter ac:name="title">geronimo-web.xml for HelloWorld_2</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
&lt;web-app xmlns="http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1"
         xmlns:naming="http://geronimo.apache.org/xml/ns/naming-1.2"
         xmlns:sec="http://geronimo.apache.org/xml/ns/security-2.0"
         xmlns:sys="http://geronimo.apache.org/xml/ns/deployment-1.2"&gt;

  &lt;sys:environment&gt;
    &lt;sys:moduleId&gt;
      &lt;sys:groupId&gt;sample.applications&lt;/sys:groupId&gt;
      &lt;sys:artifactId&gt;HelloWorldApp_2&lt;/sys:artifactId&gt;
      &lt;sys:version&gt;2.2&lt;/sys:version&gt;
      &lt;sys:type&gt;war&lt;/sys:type&gt;
    &lt;/sys:moduleId&gt;
    &lt;sys:dependencies/&gt;
    &lt;sys:hidden-classes/&gt;
    &lt;sys:non-overridable-classes/&gt;
  &lt;/sys:environment&gt;

  &lt;context-root&gt;hello_2&lt;/context-root&gt;
  &lt;host&gt;virtualhost2.com&lt;/host&gt;
&lt;/web-app&gt;
</plain-text-body>
<p>Save the changes to the <code>geronimo-web.xml</code> file and generate a second WAR file by typing the following command from the <code>&lt;APP_HOME&gt;</code> directory:</p>

<p><strong><code>jar -cvf HelloWorld_2.war *</code></strong></p>

<p>You now have two applications ready to be deployed to two different virtual hosts.</p>

<h2 id="ConfiguringVirtualHostinTomcat-Deploytheapplication">Deploy the application</h2>

<p>At this point, you have configured Geronimo to use two different Virtual Hosts, one of which is also configured to listen under additional aliases. All you need to do now is to deploy the applications and test them. To deploy the applications, type the following commands from the <code>&lt;GERONIMO_HOME&gt;\bin</code> directory:</p>

<p><code><strong>deploy --user system --password manager deploy &lt;APP_HOME&gt;\HelloWorld_1.war</strong></code></p>

<p>You should get a successful confirmation message similar to the following one:</p>

<parameter ac:name="borderStyle">solid</parameter><plain-text-body>
D:\geronimo-tomcat7-javaee6-3.0-SNAPSHOT\bin&gt;deploy --user system --password manager deploy \HelloWorld_2.2\HelloWorld_1.war
Using GERONIMO_HOME:   D:\geronimo-tomcat7-javaee6-3.0-SNAPSHOT
Using GERONIMO_SERVER: D:\geronimo-tomcat7-javaee6-3.0-SNAPSHOT
Using GERONIMO_TMPDIR: D:\geronimo-tomcat7-javaee6-3.0-SNAPSHOT\var\temp
Using JRE_HOME:        C:\Java\jdk1.6.0\jre
    Deployed sample.applications/HelloWorldApp_1/2.2/war @ /hello_1
</plain-text-body>

<p>Repeat the deployment process for the second application.</p>

<p><code><strong>deploy --user system --password manager deploy &lt;APP_HOME&gt;\HelloWorld_2.war</strong></code></p>

<p>You should get a successful confirmation message similar to the following one:</p>

<parameter ac:name="borderStyle">solid</parameter><plain-text-body>
D:\geronimo-tomcat7-javaee6-3.0-SNAPSHOT\bin&gt;deploy --user system --password manager deploy \HelloWorld_2.2\HelloWorld_2.war
Using GERONIMO_HOME:   D:\geronimo-tomcat7-javaee6-3.0-SNAPSHOT
Using GERONIMO_SERVER: D:\geronimo-tomcat7-javaee6-3.0-SNAPSHOT
Using GERONIMO_TMPDIR: D:\geronimo-tomcat7-javaee6-3.0-SNAPSHOT\var\temp
Using JRE_HOME:        C:\Java\jdk1.6.0\jre
    Deployed sample.applications/HelloWorldApp_2/2.2/war @ /hello_2
</plain-text-body>

<p>With the applications deployed, you can now test them. To test the first application that has the context-root <strong>hello_1</strong>, access the host names defined on the Geronimo server machine with the URLs in the following table:</p>
<div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p> Host name / Virtual Host </p></th><th colspan="1" rowspan="1" class="confluenceTh"><p> Access </p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://localhost:8080/hello_1" rel="nofollow">http://localhost:8080/hello_1</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> Fail </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost1.com:8080/hello_1" rel="nofollow">http://virtualhost1.com:8080/hello_1</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> <strong>SUCCESS!!!</strong> </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost2.com:8080/hello_1" rel="nofollow">http://virtualhost2.com:8080/hello_1</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> Fail </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost3.com:8080/hello_1" rel="nofollow">http://virtualhost3.com:8080/hello_1</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> Fail </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost4.com:8080/hello_1" rel="nofollow">http://virtualhost4.com:8080/hello_1</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> Fail </p></td></tr></tbody></table></div>

<p>Now repeat the tests for the second application that has the context-root <strong>hello_2</strong>.</p>
<div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p> Host name / Virtual Host </p></th><th colspan="1" rowspan="1" class="confluenceTh"><p> Access </p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://localhost:8080/hello_2" rel="nofollow">http://localhost:8080/hello_2</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> Fail </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost1.com:8080/hello_2" rel="nofollow">http://virtualhost1.com:8080/hello_2</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> Fail </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost2.com:8080/hello_2" rel="nofollow">http://virtualhost2.com:8080/hello_2</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> <strong>SUCCESS!!!</strong> </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost3.com:8080/hello_2" rel="nofollow">http://virtualhost3.com:8080/hello_2</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> <strong>SUCCESS!!!</strong> </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <a shape="rect" class="external-link" href="http://virtualhost4.com:8080/hello_2" rel="nofollow">http://virtualhost4.com:8080/hello_2</a> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> <strong>SUCCESS!!!</strong> </p></td></tr></tbody></table></div>

<p>Congratulations!!! you have successfully configured and deployed two applications to two different virtual hosts and aliases.</p></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tr>
          <td align="left" valign="middle" class="footer">
            &nbsp;&nbsp;
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="Delicious" />
            <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">Bookmark this on Delicious</a>
            &nbsp;&nbsp;
            <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="Digg!" />
            <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)+'&amp;topic=programming');">Digg this</a>
            <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Configuring Virtual Host in Tomcat';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
            &nbsp;&nbsp;
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;-&nbsp;&nbsp;
            Copyright &#169; 2003-2013, The Apache Software Foundation, Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0.</a>&nbsp;&nbsp;
          </td>
        </tr>
    </table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  </body>
</html>
