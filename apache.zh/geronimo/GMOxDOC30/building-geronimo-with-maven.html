<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=0">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="Building Geronimo with Maven">
    <meta name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Building Geronimo with Maven">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2010-05-11">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0文档：使用Maven构建Geronimo</title>
  </head>

  <body  onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">Home</a> > <a href="documentation.html">文档</a> > <a href="installing-and-running.html">安装和运行</a> > <a href="getting-and-installing-geronimo.html">获取和安装Geronimo</a> > <a href="building-geronimo-from-source.html">从源代码</a> <a href="building-geronimo-with-maven.html">构建Geronimo</a> > <a href="building-geronimo-with-maven.html">使用Maven构建Geronimo</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo v3.0</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">用Maven构建Geronimo</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645440"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645440">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645440"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645440">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645440"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645440">新增新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><div class="toc-macro client-side-toc-macro" data-headerelements="H2,H3,H4,H5,H6,H7"></div>

<h2 id="BuildingGeronimowithMaven-Overview">总览</h2>

<p>本文档介绍了如何在命令行中构建Apache Geronimo Server项目。</p>

<p>本指南旨在介绍如何从最新版本构建Geronimo 3.0。 <code>server/trunk</code>和<code>server/branches/3.0</code> 。请参阅“开发”文档中的“ <a shape="rect" href="../GMOxDEV/building-apache-geronimo.html">构建Apache Geronimo”</a> ，以获取有关构建Geronimo的更多信息，包括本分支和其他分支。</p>
<div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>如果您选择从<code>server/trunk</code> ，请注意<a shape="rect" href="../GMOxDEV/building-apache-geronimo.html#BuildingApacheGeronimo-Overview">有关</a>构建SNAPSHOT版本<a shape="rect" href="../GMOxDEV/building-apache-geronimo.html#BuildingApacheGeronimo-Overview">的中继状态</a>的<a shape="rect" href="../GMOxDEV/building-apache-geronimo.html#BuildingApacheGeronimo-Overview">一般警告</a> 。</p></div></div>

<h2 id="BuildingGeronimowithMaven-Prerequisites">先决条件</h2>


<h3 id="BuildingGeronimowithMaven-BuildMachine">成型机</h3>

<p>建议用于构建Geronimo 3.0的专用计算机至少具有2GB的实际内存。该计算机还需要连接到Internet才能下载工件依赖项。</p>


<h3 id="BuildingGeronimowithMaven-JavaDeveloperKit(JDK)">Java开发人员工具包（JDK）</h3>

<p>您将需要<a shape="rect" class="external-link" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" title="Java SE 1.6" rel="nofollow">JDK 6.0+（Java SE 1.6.0+）</a>或兼容的JDK来构建Apache Geronimo。建议您使用SUN的实现，或兼容Apple的实现。其他JDK供应商实现可能会起作用，但使用后果自负。</p>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows提示</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>根据<a shape="rect" class="external-link" href="http://jira.codehaus.org/browse/MAVEN-666" rel="nofollow">MAVEN-666</a> ，Windows用户不应双引号JAVA_HOME（或出于相同原因的MAVEN_HOME）。<br clear="none">设置：<br clear="none">设置JAVA_HOME =“ C：\ Program Files \ Java \ jdk1.6.0_20”<br clear="none">不起作用，但是这样做：<br clear="none">设置JAVA_HOME = C：\ Program Files \ Java \ jdk1.6.0_20</p></div></div>

<h3 id="BuildingGeronimowithMaven-ApacheMaven2">Apache Maven 2</h3>

<p>要执行构建过程，您需要具有<a shape="rect" class="external-link" href="http://maven.apache.org">Apache Maven</a>版本<code>2.2.1</code> （或更新的）版本。</p>

<p>要检查您的安装是否正常运行，并且您具有必需的最低版本，请执行以下操作：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn -version
</pre>
</div></div>
<p>它应该产生如下内容：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>Maven version: 2.2.1
</pre>
</div></div>

<p>如果您使用的版本不兼容，则服务器构建可能会失败并显示一条消息<img class="emoticon emoticon-wink" src="https://cwiki.apache.org/confluence/s/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/_/images/icons/emoticons/wink.png" alt="（眨眼）" data-emoticon-name="wink"></p>


<h3 id="BuildingGeronimowithMaven-Subversion">颠覆</h3>

<p>要获取服务器的源代码，您将需要安装<a shape="rect" class="external-link" href="http://subversion.tigris.org/" rel="nofollow">Subversion</a>客户端1.5版（或更高版本，建议使用1.5版）。</p>
<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows提示</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p><strong>强烈建议</strong> Windows用户将M2本地存储库（下载依赖项的位置）更改为没有空格的较短路径，例如<code>C:\.m2</code> 。<br clear="none">使用更长的路径可能会导致该构建（以及Geronimo本身）在Windows上达到文件名的260个字符限制时表现异常。</p>

<p>为了更改m2本地存储库，请转到<code>%USERPROFILE%\.m2</code>并编辑或创建<code>settings.xml</code>文件包含以下内容：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;settings&gt;
    &lt;localRepository&gt;C:\.m2&lt;/localRepository&gt;
&lt;/settings&gt;
]]></script>
</div></div></div></div>

<h2 id="BuildingGeronimowithMaven-CheckoutGeronimo">结帐Geronimo</h2>

<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>svn co https://svn.apache.org/repos/asf/geronimo/server/trunk server
</pre>
</div></div>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">小费</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>如果您使用的是中文系统，请将您的语言环境更改为en_US。否则，maven 2.0.7（或更低版本）将无法解析汉字。</p></div></div>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows提示</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p><strong>强烈建议</strong> Windows用户将Geronimo签出到<code>c:\g</code> 。<br clear="none">使用更长的路径可能会导致构建（以及Geronimo本身）在Windows上达到文件名的260个字符限制时表现异常。</p></div></div>

<p>您还可以使用Git镜像检出Geronimo源代码，并在使用以下命令之前确保已安装Git客户端：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>git clone git://git.apache.org/geronimo server
</pre>
</div></div>

<h2 id="BuildingGeronimowithMaven-PreparingtoBuildfortheFirstTime">首次准备建造</h2>

<p>您可能需要增加Maven的堆大小。将以下行添加到<code>~/.mavenrc</code> ：</p>
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>仅设置以下剪裁<code>MAVEN_OPTS</code> （如果尚未设置），则可以根据需要在命令行上覆盖这些值。</p></div></div>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre># Increase the heap size Maven
if [ "x$MAVEN_OPTS" = "x" ]; then
    MAVEN_OPTS=-Xmx512m
fi
</pre>
</div></div>
<p>如果您使用的是SUN JDK（或具有兼容标志的JDK，例如Apple JDK），则还应该增加最大永久大小以及堆大小：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre># Increase the heap and max permanent size for Maven
if [ "x$MAVEN_OPTS" = "x" ]; then
    MAVEN_OPTS="-Xmx1024m -XX:PermSize=256m -XX:MaxPermSize=1024m -XX:ReservedCodeCacheSize=64m"
fi
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows提示</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Windows用户应创建<code>mavenrc_pre.bat</code>下<code>c:\documents and settings\<username>\mavenrc_pre.bat</code>要么<code>c:\mavenrc_pre.bat</code>取决于如何<code>%HOME%</code>属性在您的系统上设置。</p>

<p>变量将需要使用批处理集语法：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>set &lt;VARIABLE&gt;=&lt;VALUE&gt;
</pre>
</div></div></div></div>

<h2 id="BuildingGeronimowithMaven-Building">建造</h2>

<p>要逐步建立所有更改：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn install
</pre>
</div></div>
<p>要执行干净的构建，在对源代码树进行一些更改之后，有时有时需要这样做：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn clean install
</pre>
</div></div>


<h3 id="BuildingGeronimowithMaven-BuildingStages">建筑阶段</h3>

<p>在某些情况下，您可能需要分阶段构建Geronimo，例如从源构建OpenEJB来获取本地更改时。大多数用户不需要这样做，但是为了清楚起见，在此进行了记录。</p>

<p>要构建模块，配置和Maven插件：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn install -Dstage=bootstrap
</pre>
</div></div>
<p>要构建插件，配置，插件组和程序集：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn install -Dstage=assemble
</pre>
</div></div>
<p>如前所述，大多数用户将不需要分阶段构建Geronimo。但是在某些情况下，当引导新版本时（当当前版本的远程仓库中没有部署任何构件时），则<strong>必须</strong>为第<em>一个</em>构建分别构建阶段，然后为随后的所有构建分别构建阶段，则不必进行分段构建。</p>
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>如果您从ibiblio maven镜像下载依赖项时遇到错误，请将以下内容添加到您的<code>settings.xml</code>文件可能有助于避免该问题：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
&lt;settings&gt;
  &lt;!-- central repo repo1 is mirrored to ibiblio. explictly overriding that to be repo1 itself --&gt;
    &lt;mirrors&gt;
        &lt;mirror&gt;
            &lt;id&gt;ibiblio.org&lt;/id&gt;
            &lt;name&gt;Mirror of http://repo1.maven.org/maven2/&lt;/name&gt;
            &lt;url&gt;http://repo1.maven.org/maven2&lt;/url&gt;
            &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
        &lt;/mirror&gt;
    &lt;/mirrors&gt;
&lt;/settings&gt;
]]></script>
</div></div></div></div>

<h2 id="BuildingGeronimowithMaven-TestingtheAssembly">测试组装</h2>

<p>完全构建服务器后，将产生许多<code>zip</code>和<code>tar.gz</code>组装模块中的存档，您可以使用<code>geronimo-maven-plugin</code>启动服务器。从项目根目录运行：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn -Ptools geronimo:start
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows提示</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Windows用户可能需要指定替代方法<code>installDirectory</code>避免长途问题：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn -Ptools geronimo:start -DinstallDirectory=c:\g
</pre>
</div></div></div></div>
<p>并停止<code>CTRL-C</code>或从单独的终端，从项目根目录运行：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn -Ptools geronimo:stop
</pre>
</div></div>

<h2 id="BuildingGeronimowithMaven-IDESetup">IDE安装</h2>

<p>服务器项目没有签入任何IDE文件，它们都是由Maven插件生成的。检出服务器树并对其进行一次构建后，即可为IDE生成项目配置文件。</p>

<h3 id="BuildingGeronimowithMaven-IntellijIDEA">Intellij IDEA</h3>

<p>对于基本的IDEA配置：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn idea:idea
</pre>
</div></div>
<p>生成包含依赖项源和javadocs的配置：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn -Pdefault,idea
</pre>
</div></div>

<h3 id="BuildingGeronimowithMaven-Eclipse">日食</h3>

<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn -Pdefault,makeeclipse
</pre>
</div></div>

<h2 id="BuildingGeronimowithMaven-TroubleshootingandTips">故障排除和技巧</h2>

<ul><li>使用-DskipTests = true可以在服务器构建期间关闭测试。</li><li>使用-o避免搜索远程存储库。</li><li>使用-X生成Maven调试信息。</li><li>构建所有Geronimo依赖项，以避免在诸如openEJB，JSF等项目之间过时的代码。</li></ul></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Building Geronimo with Maven';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2013，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  

</body></html>