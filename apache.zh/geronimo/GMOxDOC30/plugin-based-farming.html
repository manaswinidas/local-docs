<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=1">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="Plugin based Farming">
    <meta name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Plugin based Farming">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2010-05-11">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>

  <link href="asset?aid=6" rel="stylesheet" type="text/css">
  <link href="asset?aid=7" rel="stylesheet" type="text/css">
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shCore.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushJava.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushXml.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushPlain.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushBash.js' type='text/javascript'></script>
  
  <script type="text/javascript">
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
  </script>

    <title>Apache Geronimo v3.0文档：基于插件的农场</title>
  </head>

  <body  onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">Home</a> > <a href="documentation.html">文档</a> > <a href="configuring-and-administering.html">配置和管理</a> > <a href="configuring-and-administering-the-apache-geronimo-server.html">配置和管理Apache Geronimo Server</a> > <a href="clustering-and-farming.html">集群和</a> <a href="configuring-and-administering-the-apache-geronimo-server.html">服务器场</a> > <a href="clustering-and-farming.html">基于</a> <a href="plugin-based-farming.html">插件的</a> <a href="configuring-and-administering-the-apache-geronimo-server.html">服务器场</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo v3.0</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">基于插件的农业</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645455"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645455">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645455"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645455">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645455"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645455">添加新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent">

<p>该耕作系统直接使用插件，因此与部署系统分离。它使基于插件的农业管理可以用于不同的服务器或机器。农业信息使用jps存储在数据库中。该数据模型允许单个管理服务器来管理：</p>

<ul><li>多个服务器场，也称为集群</li><li>每个服务器场以MXN关系显示多个插件列表</li><li>每个插件列表有多个插件</li></ul>


<p>节点启动时，它将广播服务广告，其中包括可选的节点名称和服务器场名称。当管理服务器将其检测为新服务器时，它将指示新节点安装与该服务器场关联的所有插件列表。如果已经安装了插件，则系统不提供进一步的操作；否则，将从插件列表中指定的插件存储库下载并安装插件。</p>

<p>农业行政管理活动包括：</p>

<ul><li>将插件列表添加到服务器场</li><li>将插件添加到插件列表</li><li>将插件添加到插件列表，并将列表添加到服务器场</li><li>从服务器场中删除插件列表</li><li>从插件列表中删除插件</li></ul>


<p>这些操作可通过GShell <a shape="rect" href="geronimo-gshell-commands.html">群集/部署</a>命令获得，并在<a shape="rect" href="plugin-based-farming.html">＃添加和删除插件和插件列表</a>部分中详细讨论。</p>

<h3 id="PluginbasedFarming-ArchitecturalConsiderations">建筑考虑</h3>
<p>基于插件的耕作需要两组独立的功能：</p>

<ul><li>插件服务器场控制器，用于跟踪服务器场节点，插件列表和插件，并向节点发出指令。</li><li>所有服务器场节点均可访问的geronimo插件存储库。它可以是运行geronimo-as-maven servlet的geronimo服务器，本地文件系统maven存储库，httpd服务的基于文件的存储库或maven存储库管理器（例如nexus）。如果使用geronimo服务器，则它可以是与插件场控制器相同的服务器，也可以是单独的服务器。</li></ul>


<p>耕作信息存储在场控制器上的PluginFarmDatatabase数据库中。</p>


<h3 id="PluginbasedFarming-Supportingpluginsandassemblies">支持的插件和程序集</h3>
<ul><li><code>org.apache.geronimo.configs/plugin-farm-member//car</code> （plugins / clustering / plugin-farm-member）插件将服务器变成插件场节点。您可以在以下位置配置多播地址和端口，群集名称和节点名称<code><WASCE_HOME>/var/config/config-substitutions.properties</code> 。</li><li><code>org.apache.geronimo.assemblies/geronimo-plugin-farm-node//car</code> （plugins / clustering / geronimo-plugin-farm-node）使用plugin-farm-member插件扩展了框架程序集。这就是启动场节点所需的全部。</li><li><code>org.apache.geronimo.configs/plugin-farm//car</code> （plugins / clustering / plugin-farm）是基于插件的服务器场的管理插件。当前只能通过Gshell <a shape="rect" href="geronimo-gshell-commands.html">cluster / deploy</a>命令访问它。</li><li><code>org.apache.geronimo.configs/plugin-farm-datasource//car</code> （plugins / clustering / plugin-farm-datasource）是插件场使用的derby数据源。打算在生产中将其替换为远程数据源。与往常一样，替换插件应使用一个<artifact-alias>元素将对plugin-farm-datasource的依赖关系重定向到其自身。</artifact-alias></li></ul>


<p>确保插件的版本符合您的服务器。</p>

<h3 id="PluginbasedFarming-Setupsteps">设定步骤</h3>
<p>以下步骤演示了使用共享相同geronimo安装的节点进行的基于插件的耕作。管理服务器充当服务器场控制器，应用程序部署服务器和插件存储库。基于插件的农业的设置步骤包括：</p>
<ol><li><a shape="rect" href="plugin-based-farming.html">＃设置服务器场控制器</a></li><li><a shape="rect" href="plugin-based-farming.html">＃设置服务器场节点</a></li><li><a shape="rect" href="plugin-based-farming.html">＃将示例插件部署到服务器场</a></li><li><a shape="rect" href="plugin-based-farming.html">＃添加和删除插件和插件列表</a></li></ol>


<h4 id="PluginbasedFarming-Setupfarmcontroller">设置服务器场控制器</h4>
<p>1。启动控制器服务器，然后在服务器存储库中安装以下插件。例如，对于2.2版服务器，插件存储在<a shape="rect" class="external-link" href="http://geronimo/apache/org/plugins/geronimo-2.2" rel="nofollow">http：//geronimo/apache/org/plugins/geronimo-2.2</a>存储库中：</p>
<ul><li><code>org.apache.geronimo.configs/plugin-farm//car</code></li><li><code>org.apache.geronimo.configs/plugin-farm-datasource//car</code></li><li><code>org.apache.geronimo.configs/plugin-farm-member//car</code>
<br class="atl-forced-newline" clear="none">2。打开<code>config-substitutions.properties</code>文件并设置以下属性：<div class="panel" style="border-style:solid;border-width:1px"><div class="panelHeader" style="border-bottom-width:1px;border-bottom-style:solid"><b>摘自config-substitutions.properties</b></div><div class="panelContent">
<p>ClusterName = <em>服务器场名称</em><br clear="none">NodeName = <em>名称</em> <br clear="none">ServerHostname = <em>Node_IP</em><br clear="none">DefaultPluginRepository = <em>共享安装插件存储库</em></p>
</div></div>哪里</li><li><code>ClusterName</code> ：定义服务器所在服务器场的名称。</li><li><code>NodeName</code> ：是可选的，默认为<code>host:jndi-port</code> 。例如，如果此服务器的主机IP为9.186.10.157，而jndi-port为1099，则默认值为<code>Nodename=9.186.10.157:1099</code> 。</li><li><code>ServerHostname</code> ：设置此服务器的节点IP。</li><li><code>DefaultPluginRepository</code> ：定义所有服务器场节点均可访问的插件存储库。例如，您可以通过定义以下内容将maven存储库用作共享安装插件存储库<code>DefaultPluginRepository=http\://9.186.10.157\:8080/plugin/maven-repo</code> 。
<br class="atl-forced-newline" clear="none">3。重新启动服务器。</li></ul>


<h4 id="PluginbasedFarming-Setupfarmnode">设置服务器场节点</h4>
<p>使用以下步骤来设置服务器场中的每个节点服务器：<br clear="none">1。启动节点服务器并安装<code>org.apache.geronimo.configs/plugin-farm-member//car</code>服务器存储库中的插件。例如，对于2.2版服务器，该插件存储在<a shape="rect" class="external-link" href="http://geronimo/apache/org/plugins/geronimo-2.2" rel="nofollow">http：//geronimo/apache/org/plugins/geronimo-2.2</a>存储库中。<br clear="none">2。打开<code>config-substitutions.properties</code>文件并设置以下属性：</p>
<div class="panel" style="border-style:solid;border-width:1px"><div class="panelHeader" style="border-bottom-width:1px;border-bottom-style:solid"><b>摘自config-substitutions.properties</b></div><div class="panelContent">
<p>ClusterName = <em>服务器场名称</em><br clear="none">ServerHostname = <em>Node_IP</em></p>
</div></div>

<p>3。将共享安装插件存储库添加到<code>plugin-repositories.properties</code>文件下<code><WASCE_HOME>/var/config/</code>每个服务器场节点，包括访问用户名和密码。例如：</p>
<div class="panel" style="border-style:solid;border-width:1px"><div class="panelHeader" style="border-bottom-width:1px;border-bottom-style:solid"><b>摘自plugin-repositories.properties</b></div><div class="panelContent">
<p>http \：//9.186.10.157 \：8080 / plugin / maven-repo / = system \ = manager</p>
</div></div>
<p>哪里</p>
<ul><li>密码<code>manger</code>在此示例中为纯文本。但是，建议使用<a shape="rect" href="deploy.html">deploy crypto命令</a>加密密码。</li></ul>


<p>4。重新启动服务器。</p>

<h4 id="PluginbasedFarming-Deployasampleplugintothefarm">将示例插件部署到服务器场</h4>
<p>使用命令将插件安装到服务器场控制器。例如，使用以下<a shape="rect" href="geronimo-gshell-commands.html">Gshell命令</a>安装HelloWorld.car插件：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
deploy/install-plugin D:/HelloWorld.car -s 9.186.10.157
</pre>
</div></div>

<ul><li><code>-s</code> ：是一个命令选项，指示服务器的主机名。对于此示例，主机名是9.186.10.157。</li></ul>


<h4 id="PluginbasedFarming-Addandremovepluginsandpluginlists">添加和删除插件和插件列表</h4>
<p>使用<a shape="rect" href="geronimo-gshell-commands.html">cluster / deploy</a> Gshell命令来验证您设置的服务器场。例如，使用以下命令添加和删除插件和插件列表：<br clear="none">使用以下命令将插件列表p1添加到服务器场cluster1：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">cluster/deploy add -c cluster1 -l p1 -s 9.186.10.157 </pre>
</div></div>

<p>使用此命令添加<code>org.apache.geronimo.samples/HelloWorld/1.0/car</code>插件列表p1的插件：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">cluster/deploy add -l p1 -a org.apache.geronimo.samples/HelloWorld/1.0/car -s 9.186.10.157</pre>
</div></div>

<p>使用此命令添加<code>org.apache.geronimo.samples/HelloWorld/1.0/car</code>将插件添加到插件列表p1并将p1添加到服务器场cluster1：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">cluster/deploy add -c cluster1 -l p1 -a org.apache.geronimo.samples/HelloWorld/1.0/car -s 9.186.10.157</pre>
</div></div>

<p>使用此命令从服务器场cluster1删除插件列表p1：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">cluster/deploy remove -c cluster1 -l p1</pre>
</div></div>

<p>使用此命令删除<code>org.apache.geronimo.samples/HelloWorld/1.0/car</code>来自插件列表p1的插件：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">cluster/deploy remove -l p1 -a org.apache.geronimo.samples/HelloWorld/1.0/car -s 9.186.10.157</pre>
</div></div>

<p>从<strong>管理控制台</strong>访问“ <strong>插件”</strong> Portlet，以验证所有服务器场成员的安装结果。</p>


<h3 id="PluginbasedFarming-Futurework">未来的工作</h3>
<p>将来可以添加以下功能：</p>
<ul><li>为<strong>管理</strong>操作提供<strong>管理控制台</strong>支持。</li><li>增强监视控制台以使用多播发现来查找节点。</li><li>为在一个geronimo安装中设置和启动多个服务器提供更好的支持。</li><li>增强car-maven-plugin以在组装中具有多个实例支持的情况下组装服务器。</li></ul></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Plugin based Farming';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2013，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  

</body></html>