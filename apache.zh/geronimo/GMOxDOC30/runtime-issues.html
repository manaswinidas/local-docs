<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=0">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="Runtime issues">
    <meta name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Runtime issues">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2010-05-11">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0文档：运行时问题</title>
  </head>

  <body  onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">主页</a> > <a href="documentation.html">文档</a> > <a href="debugging-and-troubleshooting.html">调试和故障排除</a> > <a href="runtime-issues.html">运行时问题</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo v3.0</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">运行时问题</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645289"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645289">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645289"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645289">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645289"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645289">添加新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>

<p>您在运行Geronimo时可能会发现的大多数问题都将在启动时出现。并且最有可能是由Geronimo所在环境中的一些冲突资源引起的。</p>


<h2 id="Runtimeissues-JVMarguments">JVM参数</h2>
<p>Apache Geronimo v3.0是符合Java EE 6的应用程序服务器。话虽如此，它可能会在不同的JVM版本上运行，但是结果可能无法预测。Geronimo v3.0需要Java 1.6。</p>

<p>与Java有关的另一个常见问题是，有时某些环境变量在Java安装时未定义。例如，Geronimo需要在运行服务器之前定义<strong>JAVA_HOME</strong>和<strong>JRE_HOME</strong> 。为了方便起见，请确保您还添加了<code><JAVA_HOME>/bin</code>目录到系统<strong>PATH</strong> 。</p>

<p>您可以选择以下选项之一在使用以下命令启动Geronimo时传递其他JVM参数： <code>geronimo</code>要么<code>startup</code>脚本：</p>
<ol><li>设置JAVA_OPTS环境变量： <parameter ac:name="borderStyle">实心</parameter> <plain-text-body>jeffchi @ Local：〜/ geronimo-tomcat7-javaee6-3.0-SNAPSHOT $ export JAVA_OPTS =“-Xmx256m -XX：MaxPermSize = 128m -XX：+ HeapDumpOnOutOfMemoryError” jeffchi @ Local：〜/ geronimo-tomcat7- javaee6-3.0-SNAPSHOT $ ./bin/geronimo运行</plain-text-body></li><li>和/或将以下代码附加到<code><GERONIMO_HOME>/bin/setjavaenv.sh(bat)</code>文件： <plain-text-body>如果[-z“ $ JAVA_OPTS”]，则为</plain-text-body> <parameter ac:name="borderStyle">实</parameter> <plain-text-body>；然后JAVA_OPTS =“-Xmx256m -XX：MaxPermSize = 128m -XX：+ HeapDumpOnOutOfMemoryError” fi</plain-text-body></li></ol>


<h2 id="Runtimeissues-ServerhangsduetolowentropyonLinux">服务器由于Linux上的低熵而挂起</h2>
<p>在Linux系统上启动Geronimo服务器时，服务器启动似乎挂起。但是，如果您耐心等待，服务器将最终启动。如果您很好奇，并且转储了Java进程的堆栈跟踪，则会看到类似以下内容的内容：</p>
<plain-text-body>“主要” prio = 10 tid = 0x0000000040c0d800 nid = 0xa79可运行[0x00007f57a04fb000] java.lang。线。状态：java.io上的RUNNABLE。java.io上的FileInputStream.readBytes（本机方法）。sun.security.provider上的FileInputStream.read（FileInputStream.java:220）。sun.security.provider上的NativePRNG $ RandomIO.readFully（NativePRNG.java:185）。NativePRNG $ RandomIO.implGenerateSeed（NativePRNG.java:202）-锁定<0x00000000daad63e0>（java.lang。对象）位于sun.security.provider。位于sun.security.provider的NativePRNG $ RandomIO.access $ 300（NativePRNG.java:108）。Java.security上的NativePRNG.engineGenerateSeed（NativePRNG.java:102）。位于com.sun.net.ssl.internal.pkcs上的SecureRandom.generateSeed（SecureRandom.java:495）。com.sun.net.ssl.internal.pkcs12上的PKCS12KeyStore.getSalt（PKCS12KeyStore.java:477）。com.sun.net.ssl.internal.pkcs12上的PKCS12KeyStore.calculateMac（PKCS12KeyStore.java:834）。PKCS12KeyStore.engineStore（PKCS12KeyStore.java:788）-锁定<0x00000000d3b5a768>（com.sun.net.ssl.internal.pkcs12。PKCS12KeyStore），位于java.security。KeyStore.store（KeyStore.java:1117）...
</plain-text-body>
<p>这个问题不是Geronimo特有的。</p>

<p>基于Sun / Oracle的JVM试图生成一个伪随机数，以用作SSL服务器套接字的种子。为了生成伪随机数，JVM从/ dev / random设备读取以获取种子的一些随机信息。问题是，如果系统没有很好的随机事件源，则将从/ dev / random设备进行的读取将阻塞。因此，Geronimo服务器启动被阻止，等待足够的随机信息从/ dev / random返回。本文可能有助于您理解基本问题– <a shape="rect" class="external-link" href="http://en.wikipedia.org/wiki//dev/random#Linux" rel="nofollow">http://en.wikipedia.org/wiki//dev/random#Linux</a></p>

<p>为避免此问题，可以通过指定以下java属性来选择使用/ dev / urandom设备而不是/ dev / random。 <code>-Djava.security.egd=file:/dev/./urandom</code> 。例如，使用以下命令启动服务器：</p>
<parameter ac:name="borderStyle">固定</parameter> <plain-text-body>$ export GERONIMO_OPTS =“-Djava.security.egd = file：/ dev /./ urandom” $ ./geronimo运行--long</plain-text-body>

<h2 id="Runtimeissues-Portconflicts">港口冲突</h2>
<p>第二个最常见的启动问题与端口冲突有关，请检查是否没有其他应用程序正在使用或阻止Geronimo的默认端口：</p>

<div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>服务</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>港口</p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>SMTP端口</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>25</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>COSNamingPort</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>1050</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>命名港</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>1099</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ORBSSL端口</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>2001</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>OpenEJBPort</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>4201</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>港口</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>6882</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>日本港口</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>8009</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>HTTP端口</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>8080</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>HTTPS端口</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>8443</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>JMXPort</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>9999</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ActiveMQStompPort</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>61613</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ActiveMQPort</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>61616</p></td></tr></tbody></table></div>


<p>如果您发现端口冲突，则可以使用<code><GERONIMO_HOME>/var/config/config-substitutions.properties</code>更改任何这些端口。在此配置文件中，您还可以设置端口偏移，并使所有这些偏移增加该数量。</p>

<p>还请记住，即使您关闭了此类软件，有时这些“规则”仍然有效，个人防火墙，防病毒和间谍软件防护产品也可能会阻止其中某些端口。</p>

<p>有关先决条件和不同配置的更多详细信息，请参阅“ <a shape="rect" href="initial-configuration.html">初始配置”</a>部分。</p>

<h2 id="Runtimeissues-Springversionconflicts">春季版本冲突</h2>

<p>如果您的应用程序包含自己的Spring版本，则可能会在Jetty程序集上部署或运行该应用程序时遇到一些问题。默认情况下，Jetty程序集配置了Apache CXF作为JAX-WS提供程序。Apache CXF使用Spring进行自我配置。有时，CXF使用的Spring版本与应用程序随附的Spring版本冲突。为防止这些冲突，请将以下<hidden-classes>条目</hidden-classes>添加<hidden-classes>到Geronimo部署描述符中：</hidden-classes></p>

<parameter ac:name="">xml</parameter> <plain-text-body><hidden-classes><filter>org.springframework</filter> <filter>META-INF / spring</filter></hidden-classes></plain-text-body>

<h2 id="Runtimeissues-java.lang.UnsatisfiedLinkError:lic(LibraryisalreadyloadedinanotherClassLoader)">java.lang。UnsatisfiedLinkError：lic（库已在另一个ClassLoader中加载）</h2>

<p>这可能是由于在两个单独的类加载器中加载相同的jar（例如使用OCI的Oracle驱动程序）引起的，每个加载器都试图加载系统库。</p>

<p>为了避免该问题，您可以尝试<a shape="rect" href="adding-jars-to-the-geronimo-repository.html">将JAR添加到Geronimo存储库中，</a>并在部署计划中定义依赖项。<br clear="none">另请参阅： <a shape="rect" class="external-link" href="https://issues.apache.org/jira/browse/GERONIMO-4629">https</a> : <a shape="rect" class="external-link" href="https://issues.apache.org/jira/browse/GERONIMO-4629">//issues.apache.org/jira/browse/GERONIMO-4629</a></p>

<h2 id="Runtimeissues-EnablemulticastingforIPv4network">为IPv4网络启用多播</h2>

<p>要在集群环境中正确使用多播，您需要设置系统属性<code>java.net.preferIPv4Stack</code>至<code>true</code>启动Geronimo时。</p>

<h2 id="Runtimeissues-java.io.IOExceptionofremoteEJBonWindows">java.io。Windows上的远程EJB的IOException</h2>

<plain-text-body>javax.naming。NamingException：无法查找“ / MyBeanRemote”。[根异常是java.rmi。RemoteException：无法连接到服务器'ejbd：// localhost：4201“；嵌套的异常是：java.io。IOException：无法连接到服务器：'ejbd：// localhost：4201'。例外：java.net。BindException：地址已在使用中：connect]位于org.apache.openejb.client。javax.naming上的JNDIContext.lookup（JNDIContext.java:214）。java.util.concurrent上MyClientScalabilityTest $ MyClientTest.call（MyClientScalabilityTest.java:1）的InitialContext.lookup（MySourceScalabilityTest $ MyClientTest.call（MyClientScalabilityTest.java:86））。FutureTask $ Sync.innerRun（未知源），位于java.util.concurrent。java.util.concurrent上的FutureTask.run（未知源）。ThreadPoolExecutor $ Worker.runTask（未知源），位于java.util.concurrent。java.lang上的ThreadPoolExecutor $ Worker.run（未知源）。Thread.run（未知源）由：java.rmi。RemoteException：无法连接到服务器'ejbd：// localhost：4201“；嵌套的异常是：java.io。IOException：无法连接到服务器：'ejbd：// localhost：4201'。例外：java.net。BindException：地址已在使用中：connect</plain-text-body>

<p>一种可能性是可用的用户端口号已用尽。在Windows上，当套接字关闭时，它将进入TIME_WAIT状态，并且直到延迟一段时间才真正关闭。默认情况下，最大用户端口地址为5000，TIME_WAIT延迟为4分钟。因此，用尽所有可能的用户端口地址并不是很困难。</p>

<p>您必须更新Windows注册表才能更改这些值。这是有关注册表设置的Windows 2000文档– <a shape="rect" class="external-link" href="http://technet.microsoft.com/en-us/library/bb726981.aspx" rel="nofollow">http://technet.microsoft.com/zh-cn/library/bb726981.aspx</a></p>

<ul class="alternate"><li>MaxUserPorts控制用户端口的上限范围。</li><li>TcpTimedWaitDelay控制TIME_WAIT延迟。</li></ul>


<p>增加MaxUserPorts（例如65534）和减少TcpTimedWaitDelay（例如30）可以解决此问题。</p>
</div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Runtime issues';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2013，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  

</body></html>