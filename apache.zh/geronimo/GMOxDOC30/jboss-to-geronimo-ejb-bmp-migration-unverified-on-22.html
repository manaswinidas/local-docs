<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link type="text/css" rel="stylesheet" href="http://geronimo.apache.org/style/default.css">
    <LINK rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <META name="Description" content="JBoss to Geronimo - EJB-BMP Migration (Unverified on 2.2)" />
    <META name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi JBoss to Geronimo - EJB-BMP Migration (Unverified on 2.2)" />
    <META name="Owner" content="dev@geronimo.apache.org" />
    <META name="Robots" content="index, follow" />
    <META name="Security" content="Public" />
    <META name="Source" content="wiki template" />
    <META name="DC.Date" scheme="iso8601" content="2010-05-11" />
    <META name="DC.Language" scheme="rfc1766" content="en" />
    <META name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation" />
    <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0 Documentation: JBoss to Geronimo - EJB-BMP Migration (Unverified on 2.2)</title>
  </head>

  <body onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tr>
        <td valing="top" align="left">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" align="left" nowrap>
          <a href="/geronimo"> Home</a> >&nbsp;<a href="documentation.html">Documentation</a>&nbsp;&gt;&nbsp;<a href="migrating-to-apache-geronimo.html">Migrating to Apache Geronimo</a>&nbsp;&gt;&nbsp;<a href="migrating-from-jboss-to-geronimo.html">Migrating from JBoss to Geronimo</a>&nbsp;&gt;&nbsp;<a href="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.html">JBoss to Geronimo - EJB-BMP Migration (Unverified on 2.2)</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8" />
            <input type="hidden" name="oe" value="UTF-8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
        </td>
      </tr> 
    </table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div style="margin: 0px 10px 0px 10px" class="smalltext">Apache Geronimo v3.0</div>
        <div style="margin: 0px 10px 8px 10px"  class="pagetitle">JBoss to Geronimo - EJB-BMP Migration (Unverified on 2.2)</div>

        <div class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
<!-- -->         
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645285">
            <img src="http://geronimo.apache.org/images/icons/notep_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Edit Page"></a>
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645285">Edit Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">
            <img src="http://geronimo.apache.org/images/icons/browse_space.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Browse Space"></a>
            <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">Browse Space</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645285">
            <img src="http://geronimo.apache.org/images/icons/add_page_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add Page"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645285">Add Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645285">
            <img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add News"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645285">Add News</a>
<!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>
<p><parameter ac:name="">top</parameter><br clear="none">
An entity bean is defined as a representation of persistent data that has the ability to read from database and populate its fields with data. It can be updated and stored back to the database. There are two types of Entity Beans that come with Enterprise Java Beans: Bean-Managed Persistence(BMP) and Container-Managed Persistent(CMP). This article covers the migration of a BMP sample application. For this type of entity bean, actual code must be written to handle persistent operations such as loading, saving and finding data. The developer must use persistence API such as JDBC to select, insert, update, delete from a database.</p>

<p>This article is organized in the following sections:</p>
<ul><li><a shape="rect" href="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.html">BMP implementation analysis</a></li><li><a shape="rect" href="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.html">Sample application</a></li><li><a shape="rect" href="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.html">The JBoss environment</a></li><li><a shape="rect" href="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.html">The Geronimo environment</a></li><li><a shape="rect" href="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.html">Step-by-step migration</a></li><li><a shape="rect" href="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.html">Summary</a></li></ul>


<h1 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-BMPimplementationanalysisanalysis">BMP implementation analysis <parameter ac:name="">analysis</parameter></h1>

<p>BMP implementation may vary from one vendor to another. The purpose of this section is to provide a BMP specific feature-to-feature comparison between JBoss v4.0.5 and Apache Geronimo, so that you can clearly identify the differences and plan accordingly before migration.</p>

<div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Features</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>JBoss v4.2.1</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Apache Geronimo</p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>EJB Container</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>JBoss comes with its own implementation</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Geronimo uses OpenEJB as its EJB Container</p></td></tr></tbody></table></div>


<p><a shape="rect" href="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.html">Back to Top</a></p>

<h1 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-Sampleapplicationsample">Sample application <parameter ac:name="">sample</parameter></h1>

<p>This is a simple loan registration application which allows users to apply for loans and administrators to approve/reject the loans. Customers can apply for loans using the Web site while the manager uses a simple Java application to approval/reject loans. BMP Entity Bean has been used to manage Loan related persistence data from a database. In addition to that a Stateless Session Bean has been used handle work flow related activities. </p>

<p>The following figure illustrates the loan management Web application flow:<br clear="none">
<span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" src="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.data/loan_web_overview.gif"></span></p>

<p>First page of the loan registration Web application acts as a notice board which displays list of loans and their current status. When a customer decides to apply for a Loan, he/she can use loan registration form. After the registration of the loan, it is categorized under pending status. A manager who has the administrator privileges will use a small application to change the status of loans. Using this application, the manager can change the status of pending loans to either approved or rejected. </p>

<h2 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-ApplicationclassesandJSPpages">Application classes and JSP pages</h2>

<ul><li>org.apache.geronimo.samples.loan.client
	<ul><li>LoanStatusChanger - Standalone application which helps to approve applied loans.</li></ul>
	</li><li>org.apache.geronimo.samples.loan.dto
	<ul><li>LoanDTO - Data transfer object for loan related information between Web and EJB tiers.</li></ul>
	</li><li>org.apache.geronimo.samples.loan.ejb
	<ul><li>LoanBean - BMP to handle loan related persistence data from the database.</li><li>LoanManagerBean - Stateless session bean to handle .</li></ul>
	</li><li>org.apache.geronimo.samples.loan.util
	<ul><li>PropertyLoader - Loads application server related properties to the different types of clients.</li></ul>
	</li><li>org.apache.geronimo.samples.loan.web
	<ul><li>LoanManagerDispatchServlet - A servlet to dispatch loan handling related activities from front end to Web tier.</li></ul>
	</li></ul>


<p>This loan management web application also includes the following JSP pages:</p>
<ul><li>error.jsp -  Common error page to handle unexpected conditions.</li><li>index.jsp - Forward in to the list of loans in the application.</li><li>list_loans.jsp - List of loans and their information are displayed.</li><li>register_loan.jsp - Loan registration form to be filled by a customer.</li></ul>


<h2 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-Toolsused">Tools used</h2>
<p>The tools used for developing and building the Loan Manager application are:</p>

<h3 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-Eclipse">Eclipse</h3>
<p>The Eclipse IDE was used for development of the sample application. This is a very powerful and popular open source development tool. Integration plug-ins are available for both JBoss and Geronimo. Eclipse can be downloaded from the following URL:<br clear="none">
<a shape="rect" class="external-link" href="http://www.eclipse.org" rel="nofollow">http://www.eclipse.org</a></p>

<h3 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-ApacheAnt">Apache Ant</h3>
<p>Ant is a pure Java build tool. It is used for building the war files and populating the database for the Online Brokerage application. Ant can be downloaded from the following URL:<br clear="none">
<a shape="rect" class="external-link" href="http://ant.apache.org">http://ant.apache.org</a></p>

<p><a shape="rect" href="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.html">Back to Top</a></p>

<h1 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-TheJBossenvironmentjboss">The JBoss environment <parameter ac:name="">jboss</parameter></h1>

<p>This section shows you how and where the sample JBoss reference environment was installed so you can map this scenario to your own implementation. Note that for this migration example JBoss v4.2.1 was used.</p>

<p>Detailed instructions for installing, configuring, and managing JBoss are provided in the product documentation. Check the product Web site for the most updated documents.</p>

<p>The following list highlights the general tasks you will need to complete to install and configure the initial environment as the starting point for deploying the sample application.</p>

<ol><li>Download and install JBoss v4.2.1 as explained in the product documentation guides. From now on the installation directory will be referred as <strong>&lt;jboss_home&gt;</strong></li><li>Create a copy of the default JBoss v4.2.1 application server. Copy recursively <strong>&lt;jboss_home&gt;\server\default</strong> to <strong>&lt;jboss_home&gt;\server\&lt;your_server_name&gt;</strong></li><li>Start the new server by running the <strong>run.sh -c &lt;your_server_name&gt;</strong> command from the <strong>&lt;jboss_home&gt;\bin</strong> directory.</li><li>Once the server is started, you can verify that it is running by opening a Web browser and pointing it to this URL: <a shape="rect" class="external-link" href="http://localhost:8080" rel="nofollow">http://localhost:8080</a>. You should see the JBoss Welcome window and be able to access the JBoss console.</li><li>Once the application server is up and running, the next step is to install and configure all the remaining prerequisite software required by the sample application. This step is described in the following section.</li></ol>


<h2 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-Installandconfigureprerequisitesoftware">Install and configure prerequisite software</h2>
<p>In order to build and run the Loan Management application included in this article, you will need to install and configure the build tool and the database that is used by the application.</p>

<h3 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-Modifydatabasesettings">Modify database settings</h3>

<p>This application is using the HSQL database that comes as part of the JBoss bundle. You need to modify the script for creating the database. Edit the <strong>localDB.script</strong> file located in the <strong>&lt;jboss_home&gt;\server\&lt;your_server_name&gt;\data\hypersonic</strong> directory:</p>

<p>Add the top of the <strong>localDB.script</strong> file the content of the following example in order to create the sample HSQL database. Also add the sample data to the same file at the end given in the <strong>config/db.sql</strong> under the JBoss Specific Data.</p>

<rich-text-body><p><strong>Make sure JBoss is not running at the time of modifying this file.</strong></p></rich-text-body>

<h3 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-ConfigureAnt">Configure Ant</h3>

<p>As mentioned before, Apache Ant is used to build the binaries for the Online Brokerage application. If you do not have Ant installed this is a good time for doing it and make sure that <strong>&lt;ant_home&gt;/bin</strong> directory is added to the system's path variable.</p>

<p>Apache Ant can be downloaded from the following URL:</p>

<p><a shape="rect" class="external-link" href="http://ant.apache.org">http://ant.apache.org</a></p>

<h3 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-ConfigureXDoclet">Configure XDoclet</h3>

<p>XDoclet is going to be used as build tool for the configuration file generation. It  is an open source code generation engine. It enables Attribute-Oriented Programming for Java. In short, this means that you can add more significance to your code by adding meta data (attributes) to your Java sources. This is done in special JavaDoc tags.<br clear="none">
Although XDoclet originated as a tool for creating EJBs, it has evolved into a general-purpose code generation engine. XDoclet consists of a core and a constantly growing number of modules. It is fairly straight forward to write new modules if there is a need for a new kind of component.<br clear="none">
<a shape="rect" class="external-link" href="http://xdoclet.sourceforge.net/xdoclet/index.html" rel="nofollow">http://xdoclet.sourceforge.net/xdoclet/index.html</a></p>

<p>Just extract the latest version of the XDoclet and set the <strong>xdoclet.home</strong> parameter in to the <strong>build.properties</strong> file.</p>

<h2 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-Buildthesampleapplication">Build the sample application</h2>

<p>The loan manager application included with this article provides an Ant script that you will use in order to build the application. Download the loan manager application from the following link:</p>

<p><a shape="rect" href="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.data/loan.zip?version=1&amp;modificationDate=1204179892000&amp;api=v2" data-linked-resource-id="20874026" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="loan.zip" data-nice-type="Zip Archive" data-linked-resource-content-type="application/zip" data-linked-resource-container-id="20645285" data-linked-resource-container-version="20">Loan</a></p>

<p>After extracting the zip file, a <strong>loan</strong> directory is created. In that directory open the build.properties file and edit the properties to match your environment as shown in the following example:</p>

<parameter ac:name="">xml</parameter><parameter ac:name="title">build.properties</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
## Set the Geronimo 2.0 home here
geronimo.home=&lt;geronimo_home&gt;

## Set XDoclet 1.2.3 Home 
xdoclet.home=&lt;xdoclet_home&gt;
</plain-text-body>

<p>Before starting the build process just set the correct paths for the <strong>geronimo.home</strong> and <strong>xdoclet.home</strong> entries in the <strong>build.properties</strong> file in the <strong>config</strong> directory.</p>

<p>From a command prompt or shell go to the <strong>loan</strong> directory and run <strong>ant jboss</strong>. This will build the ear file and place it directly in the <strong>releases/jboss</strong> directory.</p>


<h2 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-Deploythesampleapplication">Deploy the sample application</h2>

<p>To deploy the sample application just copy the <strong>Loan.ear</strong> will be created under the <strong>loan/releases/jboss</strong> folder to the <strong>&lt;jboss_home&gt;/server/&lt;your_server_name&gt;/deploy</strong> folder. </p>

<p>If JBoss is already started, it will automatically deploy and start the application; otherwise, the application will be deployed and started at the next startup.</p>

<h2 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-Testthesampleapplication">Test the sample application</h2>

<p>To test the application, open a Web browser and access the following URL:</p>

<p><a shape="rect" class="external-link" href="http://localhost:8080/loan" rel="nofollow">http://localhost:8080/loan</a></p>

<p>This brings up the loan manager main page with the list of loans and their current statuses.<strong>Register</strong> link will forward you to the loan registration form which accepts number of fields before adding loans in to the loan information database. </p>

<p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" src="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.data/loan_screen.gif"></span></p>

<p>To change the status of a loan, manager has to find the loan ID from the Web application and has to provide it in the client application as given below.</p>

<p><strong>java -jar LoanStatusChanger.jar &lt;loanId&gt; &lt;status&gt;</strong></p>

<p>Status filed will change according to the following values. The following are the status values of relevant loans.</p>
<ol><li>0 - Pending</li><li>1 - Accepted</li><li>Other - Rejected</li></ol>


<rich-text-body><p>Make sure you add the <strong>&lt;jboss-home&gt;/client/jbossall-client.jar</strong> file to your class path before running the above command.</p></rich-text-body>

<p><a shape="rect" href="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.html">Back to Top</a></p>

<h1 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-TheGeronimoenvironmentgeronimo">The Geronimo environment <parameter ac:name="">geronimo</parameter></h1>

<p>Download and install Geronimo from the following URL:</p>

<p><a shape="rect" class="external-link" href="http://geronimo.apache.org/downloads.html">http://geronimo.apache.org/downloads.html</a></p>

<p>The release notes available there provide clear instructions on system requirements and how to install and start Geronimo. Throughout the rest of this article we will refer to the Geronimo installation directory as <strong>&lt;geronimo_home&gt;</strong>.</p>

<parameter ac:name="title">TCP/IP ports conflict</parameter><rich-text-body>
<p>If you are planning to run JBoss and Geronimo on the same machine consider to change the default service ports on, at least, one of these servers.</p></rich-text-body>


<p><a shape="rect" href="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.html">Back to Top</a></p>
<h1 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-Step-by-stepmigrationmigration">Step-by-step migration <parameter ac:name="">migration</parameter></h1>

<p>When you built the loan manager sample application, Ant packaged the deployment descriptors for both JBoss <strong>jboss.xml</strong> and Geronimo <strong>openejb-jar.xml</strong> as they were already provided by the sample application. These files are located in the <strong>loan/config</strong> directory.</p>

<p>The following example shows the JBoss deployment descriptor.</p>

<parameter ac:name="">xml</parameter><parameter ac:name="title">jboss.xml</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE jboss PUBLIC "-//JBoss//DTD JBOSS 4.0//EN" "http://www.jboss.org/j2ee/dtd/jboss_4_0.dtd"&gt;

&lt;jboss&gt;

   &lt;enterprise-beans&gt;

      &lt;entity&gt;
         &lt;ejb-name&gt;Loan&lt;/ejb-name&gt;
         &lt;local-jndi-name&gt;Loan&lt;/local-jndi-name&gt;
        &lt;method-attributes&gt;
        &lt;/method-attributes&gt;
      &lt;/entity&gt;

      &lt;session&gt;
         &lt;ejb-name&gt;LoanManager&lt;/ejb-name&gt;
         &lt;jndi-name&gt;org.apache.geronimo.samples.loan.ejb.LoanManager&lt;/jndi-name&gt;
         &lt;local-jndi-name&gt;LoanManager&lt;/local-jndi-name&gt;
        &lt;method-attributes&gt;
        &lt;/method-attributes&gt;
      &lt;/session&gt;

   &lt;/enterprise-beans&gt;

   &lt;resource-managers&gt;
   &lt;/resource-managers&gt;
  
&lt;/jboss&gt;
</plain-text-body>

<p>Compare it with the contents of the Geronimo deployment plan shown in the following example.</p>

<parameter ac:name="">xml</parameter><parameter ac:name="title">openejb-jar.xml</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;openejb-jar xmlns="http://www.openejb.org/xml/ns/openejb-jar-2.1"&gt;
	&lt;dep:environment xmlns:dep="http://geronimo.apache.org/xml/ns/deployment-1.2"&gt;
		&lt;dep:moduleId&gt;
			&lt;dep:groupId&gt;org.apache.geronimo.samples&lt;/dep:groupId&gt;
			&lt;dep:artifactId&gt;LoanManagerEJB&lt;/dep:artifactId&gt;
			&lt;dep:version&gt;1.0&lt;/dep:version&gt;
			&lt;dep:type&gt;car&lt;/dep:type&gt;
		&lt;/dep:moduleId&gt;
		&lt;dep:dependencies/&gt;
		&lt;dep:hidden-classes/&gt;
		&lt;dep:non-overridable-classes/&gt;
	&lt;/dep:environment&gt;
	&lt;enterprise-beans&gt;
		&lt;session&gt;
			&lt;ejb-name&gt;LoanManager&lt;/ejb-name&gt;
			&lt;ejb-ref&gt;
				&lt;ref-name&gt;ejb/LoanLocal&lt;/ref-name&gt;
				&lt;ejb-link&gt;Loan&lt;/ejb-link&gt;
			&lt;/ejb-ref&gt;
		&lt;/session&gt;
		&lt;entity&gt;
			&lt;ejb-name&gt;Loan&lt;/ejb-name&gt;			
			&lt;resource-ref&gt;
				&lt;ref-name&gt;jdbc/LoanDataSource&lt;/ref-name&gt;
				&lt;resource-link&gt;SystemDatasource&lt;/resource-link&gt;
			&lt;/resource-ref&gt;
		&lt;/entity&gt;
	&lt;/enterprise-beans&gt;
&lt;/openejb-jar&gt;
</plain-text-body>

<p>First difference can be clearly noted is Geronimo specific configuration has additional information than JBoss specific one. That part of the Geronimo configuration file is quite similar to a Maven 2 build script. Both of these given configuration files have EJB information. JBoss uses local JNDI names to link the EJBs while Geronimo directly use the EJB's name. In addition to above differences the <strong>openejb-jar.xml</strong> file clearly gives the EJB reference information than the <strong>jboss.xml</strong> file.</p>

<p>The Web archive related configuration files give you few more differences.</p>

<parameter ac:name="">xml</parameter><parameter ac:name="title">jboss-web.xml</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;


&lt;jboss-web&gt;

	&lt;ejb-local-ref&gt;
		&lt;ejb-ref-name&gt;ejb/LoanManagerLocal&lt;/ejb-ref-name&gt;
		&lt;local-jndi-name&gt;LoanManager&lt;/local-jndi-name&gt;
	&lt;/ejb-local-ref&gt;  
&lt;/jboss-web&gt;
</plain-text-body>

<parameter ac:name="">xml</parameter><parameter ac:name="title">geronimo-web.xml</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns="http://geronimo.apache.org/xml/ns/j2ee/web-1.1" xmlns:naming="http://geronimo.apache.org/xml/ns/naming-1.1"&gt;
  &lt;dep:environment xmlns:dep="http://geronimo.apache.org/xml/ns/deployment-1.1"&gt;
    &lt;dep:moduleId&gt;
      &lt;dep:groupId&gt;org.apache.geronimo.samples&lt;/dep:groupId&gt;
      &lt;dep:artifactId&gt;LoanManagerWeb&lt;/dep:artifactId&gt;
      &lt;dep:version&gt;1.0&lt;/dep:version&gt;
      &lt;dep:type&gt;car&lt;/dep:type&gt;
    &lt;/dep:moduleId&gt;
    &lt;dep:dependencies/&gt;	
    &lt;dep:hidden-classes/&gt;
    &lt;dep:non-overridable-classes/&gt;
  &lt;/dep:environment&gt;
 
  &lt;naming:ejb-local-ref&gt;
	  &lt;naming:ref-name&gt;ejb/LoanManagerLocal&lt;/naming:ref-name&gt;
	  &lt;naming:ejb-link&gt;LoanManager&lt;/naming:ejb-link&gt;
  &lt;/naming:ejb-local-ref&gt;
	
&lt;/web-app&gt;
</plain-text-body>

<p><strong>jboss-web.xml</strong> maps the EJBs using JNDI names as given above while <strong>geronimo-web.xml</strong> directly uses the EJB's name. The reference names given in each mapping will be used refer EJBs from the Servlets. <strong>web.xml</strong> file of the WAR file contains more information about each EJB reference name, which will be common to the both Geronimo and JBoss flavors of this application.</p>

<h2 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-Buildthesampleapplication.1">Build the sample application</h2>

<p>Build the migrated Geronimo version of the sample application by running following command from the <strong>loan</strong> directory.<br clear="none">
<strong>ant geronimo</strong><br clear="none">
It will create <strong>Loan.ear</strong> file in the <strong>loan/releases/geronimo</strong> folder.</p>

<h2 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-Deploythemigratedapplication">Deploy the migrated application</h2>

<p>To deploy the migrated Loan Manager application, make sure the Geronimo server is up and running and user has to populate the database and then deploy the sample application.</p>

<h3 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-PopulatingtheDatabase">Populating the Database</h3>
<p>This sample application will use the default Geronimo System database to hold the application specific data.<br clear="none">
In the Geronimo console follow given steps.</p>
<ol><li>Select DB Manager link from the Console Navigation in the left.</li><li>Select the <strong>SystemDatabase</strong> to <strong>Use DB</strong> field.</li><li>Open <strong>db.sql</strong> in the <strong>loan/config</strong> directory from a text editor and copy the content below Geronimo Specific Database SQLs.</li><li>Paste the content the given above SQL Commands text area and press Run SQL button.</li></ol>


<h3 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-DeploySampleApplication">Deploy Sample Application</h3>
<p>Open Geronimo console in your browser and follow the given steps:</p>
<ol><li>Scroll down to <strong>Deploy New</strong> from the <strong>Console Navigation</strong> panel.</li><li>Load <strong>loan.ear</strong> from <strong>loan/releases/geronimo</strong> folder in to the <strong>Archive</strong> input box.</li><li>Press <strong>Install</strong> button to deploy application in the server.</li></ol>


<h2 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-Testthesampleapplication.1">Test the sample application</h2>

<p>To test the application, open a Web browser and access the following URL:</p>

<p><a shape="rect" class="external-link" href="http://localhost:8080/loan" rel="nofollow">http://localhost:8080/loan</a></p>

<p>To change the status of a loan, the user has to find the loan ID from the Web application and has to provide it in the client application as given below.</p>

<p><strong>java -jar LoanStatusChanger.jar &lt;loanId&gt; &lt;status&gt;</strong></p>

<rich-text-body>
<p>Make sure you add the following list of JAR files to your class path before running the above command.</p>
<ol><li>geronimo-kernel-2.0.x.jar</li><li>geronimo-j2ee_connector_1.5_spec-1.x.x.jar</li><li>geronimo-j2ee_management_1.1_spec-1.x.jar</li><li>geronimo-security-2.0.x.jar</li><li>cglib-nodep-2.1_3.jar</li><li>openejb-core-3.0.jar</li></ol>
</rich-text-body>

<p><a shape="rect" href="jboss-to-geronimo-ejb-bmp-migration-unverified-on-22.html">Back to Top</a></p>

<h1 id="JBosstoGeronimo-EJB-BMPMigration(Unverifiedon2.2)-Summarysummary">Summary <parameter ac:name="">summary</parameter></h1>
<p>This article has shown how to migrate a sample application that uses BMP entity beans, from JBoss v4.2.1 to Apache Geronimo. This article provided step-by-step instructions to build the application, deploy and run it, and then migrate it to the Geronimo environment.</p>

<p>The following list summarizes the major differences found during this sample application migration.</p>

<ul><li>In order to deploy an EJB jar file in JBoss you need to just copy the configuration file to the deploy directory but in Geronimo you can use either deployer tool, console or hot deployment directory.</li><li>The contents of the deployment plans for EJB jar files in JBoss and in Geronimo are almost similar except for the starting part of the Geronimo which is more similar to a Maven 2 build file.</li></ul></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tr>
          <td align="left" valign="middle" class="footer">
            &nbsp;&nbsp;
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="Delicious" />
            <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">Bookmark this on Delicious</a>
            &nbsp;&nbsp;
            <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="Digg!" />
            <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)+'&amp;topic=programming');">Digg this</a>
            <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : JBoss to Geronimo - EJB-BMP Migration (Unverified on 2.2)';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
            &nbsp;&nbsp;
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;-&nbsp;&nbsp;
            Copyright &#169; 2003-2013, The Apache Software Foundation, Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0.</a>&nbsp;&nbsp;
          </td>
        </tr>
    </table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  </body>
</html>
