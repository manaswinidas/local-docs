<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=1">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="Classloading">
    <meta name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Classloading">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2010-05-11">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0文档：类加载</title>
  </head>

  <body  onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">Home</a> > <a href="documentation.html">文档</a> > <a href="reference.html">参考</a> > <a href="geronimo-architecture.html">Geronimo体系结构</a> > <a href="classloading.html">类加载</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo v3.0</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">类加载</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645484"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645484">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645484"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645484">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645484"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645484">新增新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><h1 id="Classloading-GeronimoClassloading">Geronimo类加载</h1>

<p>在Geronimo中，每个插件或模块都有一个关联的类加载器。这些类加载器与常规URL类加载器的不同之处在于，它们具有多个父级，并且可以通过多种方式自定义类在其自身及其父级中的可见性。与插件关联的类加载器是Geronimo中唯一的类加载器。通过在所有geronimo计划开始时允许的环境元素，在xml中统一配置类加载器。</p>

<h2 id="Classloading-Specifyingwhatisinaclassloader">指定类加载器中的内容</h2>
<p>通过xml环境元素中的依赖项元素来指定类加载器的内容。所有依赖项都引用geronimo存储库中的工件，使用与maven 2 pom中的依赖项相同的格式。这些依赖性可以是普通jar或其他插件。插件成为类加载器的父类，而jars可以直接在类加载器中使用。</p>

<h2 id="Classloading-Customizingclassloaderbehavior">自定义类加载器行为</h2>
<p>有许多可用于类加载器的自定义项。</p>
<h3 id="Classloading-Inverse-classloading">逆类加载</h3>
<p>通常，在加载课程时，首先会搜索父母。通过包括<inverse-classloading></inverse-classloading>类加载器配置为先搜索自身，然后搜索其父级。此功能可能是Web应用程序类加载器中最熟悉的功能，但可以在任何geronimo类加载器上进行配置。<br clear="none">应谨慎使用此技术，因为它会影响所有类，并且在将模块中构造的对象传递给父级进行处理时会引起冲突。它可能是确定问题和测试的宝贵工具，但对于生产系统应避免使用。在生产系统中，使用<a shape="rect" href="#Classloading-Hiddenclasses"><strong><hidden-classes></hidden-classes></strong></a>而是改为只指定可以使用而不会发生冲突的那些类。</p>

<h3 id="Classloading-non-overridable-classes.">不可覆盖的类。</h3>
<p>如果已配置了反向类加载，则可以通过包含要从父类加载器加载的类的过滤器来覆盖特定类或程序包，即使它们存在于当前类加载器中。<br clear="none">当您希望模块与其他模块共享框架库的公共实例时，这一点很重要。</p>

<h3 id="Classloading-hidden-classes">隐藏类</h3>
<p>在hidden-classes元素中包含过滤器可防止从任何父类加载器加载匹配的类。当当前模块依赖于不同版本或类表示必须独立于父代使用的相同框架进行初始化的框架时，将使用此方法。<br clear="none">这个功能有点奇怪。此外，所有子类加载器将无法从任何父类加载器。</p>

<h3 id="Classloading-private-classes(newin2.2,andexperimental)">私人课程（2.2中的新增功能和实验功能）</h3>
<p>在私有类中包含过滤器可防止子类加载器从该类加载器加载类。它类似于隐藏类，但在父类而不是子类上。</p>

<h2 id="Classloading-Startuppluginclassloaders">启动插件类加载器</h2>
<p>需要几个jar来设置geronimo内核，存储库和日志记录，并且无法从geronimo存储库中加载。这些jar是在启动插件（如j2ee-system和client-system）的jar清单中的manifest-classpath中配置的。这些jar将以更简单的名称复制到bin中，然后在lib目录中找到这些jar。bin和lib目录之间的关系不得更改。</p>

<h2 id="Classloading-Othercomments">其他的建议</h2>
<p>插件是类和服务的组合。依赖关系可以取决于类，服务或两者。通常，两者都依赖。如果不希望这样，可以在依赖项中使用import元素。假设我们有一个依赖于插件A的插件B。</p>
<h3 id="Classloading-importclasses">进口班</h3>
<p>启动插件B将加载插件A，因此其类加载器可用，但不会启动插件A，因此不必启动服务。这在部署程序插件中使用，因此可以使用运行时类，但例如Web服务器未运行。</p>
<h3 id="Classloading-importservices">进口服务</h3>
<p>启动插件B将加载并启动插件A，以便来自A的服务可用。但是，插件A中的类对插件B不可用。仅当A中的服务实现B可用的接口时，这才易于工作。</p>
<h3 id="Classloading-importall(default)">全部导入（默认）</h3>
<p>启动插件B将加载并启动插件A，插件B可以使用A中的类和服务。</p>

<h2 id="Classloading-SpecialCases">特别案例</h2>
<h3 id="Classloading-Xerces,Xalanandotherendorsedpackages">Xerces，Xalan和其他认可的软件包</h3>
<p>vm中包含一些功能，但旨在供用户替换。这包括xml和xsl库。通常，您不能只在应用程序中包含要使用的xerces或xalan版本，而是需要将其放在<geronimo_home>/ lib / endorsed中。不幸的是，这意味着所有geronimo都将使用这些库的相同版本。此问题的典型症状可能是这样的：</geronimo_home></p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
java.lang.ClassCastException: org.apache.xerces.parsers.XIncludeAwareParserConfiguration cannot be cast to org.apache.xerces.xni.parser.XMLParserConfiguration
]]></script>
</div></div></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Classloading';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2013，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  

</body></html>