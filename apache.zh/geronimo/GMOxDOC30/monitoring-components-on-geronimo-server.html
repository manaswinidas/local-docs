<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=0">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="Monitoring components on Geronimo Server">
    <meta name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Monitoring components on Geronimo Server">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2010-05-11">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0文档：Geronimo Server上的监视组件</title>
  </head>

  <body  onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">Home</a> > <a href="documentation.html">文档</a> > <a href="configuring-and-administering.html">配置和管理</a> > <a href="monitoring-the-health-of-the-apache-geronimo-server.html">监视Apache Geronimo服务器的运行状况</a> > <a href="monitoring-components-on-geronimo-server.html">监视Geronimo Server上的组件</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo v3.0</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">监视Geronimo Server上的组件</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645348"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645348">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645348"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645348">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645348"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645348">添加新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>

<p><rich-text-body></rich-text-body></p><p>Geronimo监视插件在服务器和客户端插件之间进行了细分，分别称为“ Agent”和“ Console”。正确设置后，这些插件将提供本地和远程实时JSR77兼容统计监视，以及通过Dojo Toolkit的dojoX Charting软件包以图形形式绘制的可视化表示形式的任何公开统计的历史跟踪。</p><p></p>

<p><strong>代理（服务器）</strong>代理插件可以无头部署在Geronimo的实例上，不需要控制台插件能够从任何与其通信的Geronimo实例轮询管理控制台。有两种可用的代理插件。第一个允许EJB连接，第二个允许控制台和代理之间的JMX连接。</p>

<p>尽管EJB代理是Geronimo的完整JEE5程序集安装的默认插件，但对于那些在其程序集中不需要EJB形式但仍需要监视能力的人，建议使用JMX。</p>

<p><strong>控制台（客户端）</strong>控制台插件需要Geronimo管理控制台，可以跨Geronimo的多个实例连接到多个Agent插件，从而可以集中监视大量机器上的统计信息。相同的控制台能够连接到Agent插件的EJB或JMX风格，甚至可以连接到Geronimo的不同实例上的两种类型。</p>

<h2 id="MonitoringcomponentsonGeronimoServer-WhatcanImonitor?">我可以监视什么？</h2>

<p>在管理控制台的代理插件中，可以定义与已部署了监视代理插件的Geronimo的任何实例的连接。此外，可以跟踪在Geronimo实例上部署的具有提供统计信息的Monitoring Agent的任何MBean，从而可以完全根据定义从任何统计元素生成图形。</p>

<p>监视代理程序的标准行为是对JSR77定义的JVM统计信息以及所使用的Web容器（Jetty或Tomcat）的Web容器统计信息进行快照。可以添加其他MBean，或者可以通过Monitoring Console插件轻松删除这些默认值。</p>

<p>当前可用的统计信息：</p>
<ul><li>TransactionManager统计</li><li>JVM统计信息</li><li>AJP / Web / WebSSL连接器统计</li><li>线程池统计</li><li>Web应用统计</li></ul>


<h2 id="MonitoringcomponentsonGeronimoServer-Whatistheimpactonperformance?">对性能有什么影响？</h2>

<p>一般而言，启用的监视越多，对整体性能的影响就越大。遵循此规则，监视插件在给定服务器上跟踪的MBean越多，影响越大。通常，好的做法是将启用的MBean限制为仅必要的MBean，而不是启用所有功能。</p>

<p>此外，不收集快照时，监视插件处于休眠状态。在默认部署中，它将每5分钟仅消耗一次周期。</p>

<h2 id="MonitoringcomponentsonGeronimoServer-Installation">安装</h2>

<p>代理（服务器）和控制台（客户端）插件均已预安装在完整的JEE发行版中。如果您使用的是Little-G发行版或自定义的服务器程序集，并且想利用监控插件，则可能需要阅读本节以了解如何安装它们。</p>

<p>有两种方法来安装必要的监视插件。第一个（也是最简单的）是登录要安装插件的Geronimo实例的Geronimo管理控制台，然后从左侧导航菜单中选择“插件”。</p>

<p>在插件portlet中：</p>
<ul><li>单击<strong>更新存储库列表</strong></li><li>从可用列表中选择一个有效的Geronimo存储库</li><li>单击<strong>显示所选存储库中的插件</strong></li><li>要安装Monitoring Agent，请从显示的列表中选择适当的插件。<ul><li>如果程序集中尚未存在OpenEJB组件，则使用监视代理程序的JMX风格可能会有所帮助</li></ul>
	</li><li>要安装监视控制台，请从显示的列表中选择适合于所用Web容器的插件。</li><li>如果目标是查看和记录来自同一Geronimo实例的统计信息，则必须同时安装代理和控制台插件</li></ul>


<p>如果从最少的组件开始，或者如果Geronimo管理控制台不可用，则需要第二种方法。</p>

<p>在终端：</p>
<ul><li>转到Geronimo bin目录</li><li>执行：<code>java -jar deployer.jar search-plugins</code></li><li>在提示符下，为所需的插件输入适当的编号</li></ul>


<h2 id="MonitoringcomponentsonGeronimoServer-Customization">客制化</h2>

<p>开发监视和管理插件的主要目标之一是允许管理员监视任何Geronimo服务器上的任何公开组件。</p>

<h3 id="MonitoringcomponentsonGeronimoServer-Datasources">数据源</h3>

<p>用于与服务器和客户端上的数据库进行通信的数据源都打包在单独的插件中。默认情况下，提供的数据源用于连接Apache Derby数据库（其原因是因为Geronimo使用的默认数据库也是Derby）。但是，由于这些数据源打包为插件，因此任何人都可以编写自己的数据源部署描述符，将其打包到插件中，然后使用它代替默认提供的描述符。查看“ <a shape="rect" href="configuring-your-own-monitoring-plugin-datasource.html">配置您自己的监视插件数据源”</a>部分以获取更多详细信息。</p>

<h3 id="MonitoringcomponentsonGeronimoServer-Monitoring">监控方式</h3>
<p>为了监视Web服务器性能，可以通过在左侧的“ <strong>控制台导航”</strong>菜单上选择“ <strong>监视”</strong>来使用“ <strong>监视”</strong> Portlet。通过此功能，您可以通过AJP协议查看系统JVM，Web服务器上的许多服务器统计信息以及信息。图形信息由连接器MBean公开的数据提供。您已经可以在Geronimo中使用预定义的图形和视图。有关详细信息，请参见<a shape="rect" href="monitoring-the-server-with-predefined-graphs-and-views.html">使用预定义的图形和视图监视服务器</a> 。</p>

<p>在此示例中，我们尝试确定服务器JVM堆空间与Web容器下载的字节数之间是否存在关联。换句话说，此监视会话将显示客户端下载后服务器是否释放堆内存。</p>

<p>首先，在“ <strong>控制台导航”</strong>菜单上选择“ <strong>监视”</strong>链接。如果这是您的第一个监视会话，则应该看到一组空的“服务器”，“视图”和“图形”，如图所示。<br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="monitoring-components-on-geronimo-server.data/consoleMonitoringStart.png"></span></p>

<h4 id="MonitoringcomponentsonGeronimoServer-AddingaServer">添加服务器</h4>
<p>通过提供主机名或IP地址来选择要监视的服务器。选择通信协议和所有安全凭证。通过按<strong>Save</strong>保存此服务器定义。<br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="monitoring-components-on-geronimo-server.data/consoleMonitoringServerAdd.png"></span></p>

<p>填写字段，然后点击<strong>添加</strong> 。例如：</p>
<ol><li>名称= GeronimoServer</li><li>IP /主机名=本地主机</li><li>协议= [默认= EJB]</li><li>端口= [默认= 4201]</li><li>用户名=系统</li><li>密码=管理员</li><li>密码（验证）=管理员</li></ol>


<p>请注意，如果将默认协议从<strong>EJB</strong>更改为<strong>JMX</strong> ，则默认端口将为1099。您需要先安装agent-car-jmx插件。<br clear="none">或者，可以使用右侧导航窗格中“ <strong>测试这些设置”</strong>链接提供的信息来测试连接。</p>

<p>成功添加服务器后，浏览器将重定向到主监视控制台页面，再次列出控制台上配置的所有<strong>Views</strong> ， <strong>Servers</strong>和<strong>Graphs</strong> 。</p>

<p>如果在新近部署的监视代理实例上配置监视，则需要单击与添加的服务器关联的“ <strong>启用查询”</strong>链接。这将启用默认时间5分钟的快照收集。</p>


<h4 id="MonitoringcomponentsonGeronimoServer-AddingaGraph">添加图</h4>

<p>通过添加图形来选择要显示的信息。选择要监视的服务器，然后通过从MBean下拉控件中选择一个MBean，选择一个发布服务器信息的MBean。选择了MBean之后，可以通过从“数据系列”下拉控件中选择数据来查看可用的信息。描述数据后，请按<strong>保存以</strong>保存该图。<br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="monitoring-components-on-geronimo-server.data/consoleMonitoringGraphAddJVM.png"></span></p>

<p>选择更多信息以通过添加第二张图来显示。随着两个数据系列的滚动，我们将能够检测到数据之间的任何相关性。再次选择服务器和MBean进行监视。从数据系列下拉控件中选择数据。由于发送的数据随时间增加，因此也请为数据系列选择<strong>增量</strong> ，因此我们可以看到数据随时间的上升和下降。通过按<strong>保存来</strong>保存该图。<br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="monitoring-components-on-geronimo-server.data/consoleMonitoringGraphAddBytes.png"></span></p>

<p>添加图形后，浏览器将重定向到主监视控制台页面，在其中选择图形名称将打开一个显示图形的窗口。</p>

<h4 id="MonitoringcomponentsonGeronimoServer-AddingaView">添加视图</h4>
<p>现在将一个或多个图形组合到一个视图中。在这里，我们通过选择前面步骤中创建的两个图来添加“ JVM与已发送字节数”视图。按<strong>保存</strong>保存视图。<br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="monitoring-components-on-geronimo-server.data/consoleMonitoringViewAdd.png"></span></p>

<p>此图显示了添加服务器，图形和视图后的控制台监视portlet。<br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="monitoring-components-on-geronimo-server.data/consoleMonitoringReady.png"></span></p>

<h4 id="MonitoringcomponentsonGeronimoServer-TheMonitoringGraphView">监控图视图</h4>
<p>单击视图以开始随时间监视服务器信息。此视图显示在一小时内发送的JVM堆和Web服务器字节。如您在示例中看到的，JVM堆内存随时间增加和减少，与用户从Web服务器请求的字节数几乎没有关联。<br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="monitoring-components-on-geronimo-server.data/consoleMonitoringView.png"></span></p></div>
        </div>

                  <div class="tabletitle">儿童<span class="smalltext" id="show" style="display:inline"><a href="javascript:void(0);">节目儿童</a></span> <span class="smalltext" id="hide" style="display:none"><a href="javascript:void(0);">隐藏儿童</a></span>
          </div>
          <div class="greybox" id="children" style="display:none">
                                      <a href="https://cwiki.apache.org/confluence/display/GMOxDOC30/Monitoring+the+server+with+predefined+graphs+and+views" title="使用预定义的图形和视图监视服务器">使用预定义的图形和视图监视服务器</a> <span class="smalltext">（Apache Geronimo v3.0）</span>
              <br>
                          <a href="https://cwiki.apache.org/confluence/display/GMOxDOC30/Configuring+your+own+Monitoring+Plugin+DataSource" title="配置您自己的监视插件数据源">配置您自己的监视插件数据源</a> <span class="smalltext">（Apache Geronimo v3.0）</span>
              <br>
                      </div>
              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Monitoring components on Geronimo Server';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2013，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  

</body></html>