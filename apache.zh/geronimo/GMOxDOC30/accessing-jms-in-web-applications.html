<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=2">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="Accessing JMS in Web applications">
    <meta name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Accessing JMS in Web applications">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2010-05-11">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0文档：在Web应用程序中访问JMS</title>
  </head>

  <body  onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">主页</a> > <a href="documentation.html">文档</a> > <a href="developing.html">开发</a> > <a href="tutorials.html">教程</a> > <a href="developing-web-applications.html">开发Web应用程序</a> > <a href="accessing-jms-in-web-applications.html">在Web应用程序中访问JMS</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo v3.0</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">在Web应用程序中访问JMS</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645268"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645268">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645268"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645268">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645268"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645268">新增新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>
<p>该应用程序是一个简单的JMS应用程序，其中用户将信息发送给管理员以进行升级。在学习本教程时，我们将尝试了解Servlet和JMS的基础知识。</p>

<p>要运行本教程，至少需要您安装以下必备软件：</p>

<ol><li>Sun JDK 5.0+（J2SE 1.5）</li><li>面向特定平台的Java EE开发人员的Eclipse IDE</li><li>Apache Geronimo Eclipse插件2.1.x</li><li>Apache Geronimo服务器2.1.x <rich-text-body>
<p>本教程使用了Geronimo 2.1.x版，Java 1.5运行时和Eclipse Ganymede，但可以使用其他版本（例如Geronimo 2.2版，Java 1.6，Eclipse Europa）</p></rich-text-body></li></ol>


<p><a shape="rect" href="development-environment.html">开发环境</a>部分中提供了有关安装Eclipse的详细信息。本教程分为以下几节：</p>


<h1 id="AccessingJMSinWebapplications-CreatingadynamicWebProject">创建一个动态Web项目</h1>
<ol><li>启动Eclipse。选择<strong>文件->新建->项目</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createproj.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>选择<strong>Web->动态Web项目</strong> 。选择<strong>下一步</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createproj2.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>在下一个屏幕上，将项目名称命名为<em>WebJMS</em> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createproj3.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>选择所有其他字段的默认值。最后选择<strong>完成</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createproj4.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li></ol>


<h1 id="AccessingJMSinWebapplications-CreatingConnectionFactoryandDestination">创建连接工厂和目标</h1>
<p>简而言之， <em>连接工厂</em>是客户端用于连接服务提供者的对象。在我们的例子中，我们将使用<strong>Active MQ</strong>作为提供程序。<em>目标</em>是客户端用来为生成的消息提供目标以及要使用的消息源的对象。在我们的例子中，目标将是一个队列。</p>

<p>让我们看看如何使用管理控制台来创建连接工厂和消息目标。</p>

<ol><li>启动服务器并启动管理控制台。
<rich-text-body>
<p>对于本教程，您应该在Eclipse之外启动服务器并启动管理控制台（由于Eclipse Web浏览器的限制）</p></rich-text-body></li><li>在“ <em>服务”</em>下选择“ <strong>JMS资源</strong> ”。<br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createres.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> </li><li>在“ <em>创建新的JMS资源组”下：</em>选择“ <strong>用于ActiveMQ”</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createres2.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> </li><li>在下一个屏幕上，输入<em>资源组名称</em> 。在我们的例子中，我们使用<strong>WebJMS</strong> 。所有其他值都可以作为默认值。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createres3.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> </li><li>完成后选择<strong>下一步</strong> 。<br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createres4.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>选择下一页上的<strong>添加连接工厂</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createres5.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>在下拉框中选择<strong>javax.jms。QueueConnectionFactory</strong> 。选择<strong>下一步</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createres6.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>接下来，将<em>连接工厂名称命名</em>为<strong>jms / TestConnectionFactory</strong> 。保留所有其他字段的默认值。选择<strong>下一步</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createres7.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>在下一个屏幕上选择<strong>添加目的地</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createres8.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>选择“ <em>JMS目标类型”</em>作为<strong>javax.jms。Queue列</strong> 。选择<strong>下一步</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createres9.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将<em>消息目标名称命名</em>为<strong>jms / TestQueue</strong> 。选择<strong>下一步</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createres10.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>在下一个屏幕上，选择“ <strong>立即部署”</strong> 。这将部署创建的计划。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createres11.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>在<em>JMS资源下，</em>您可以看到新创建的连接工厂和队列。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/createres12.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li></ol>


<h1 id="AccessingJMSinWebapplications-Addingproducer,consumerandUIcodetotheapplication">将生产者，使用者和UI代码添加到应用程序</h1>
<ol><li>右键单击<strong>WebJMS</strong>项目，然后创建一个新的servlet。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/AddSource.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将servlet命名为<em>UserServlet，</em>并将包<em>命名</em>为<em>webjms</em> 。这是应用程序中的生产者。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/AddSource1.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>选择<strong>下一步</strong> ，然后选择<strong>完成</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/AddSource2.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将以下代码添加到<code>UserServlet.java</code> ： <parameter ac:name="borderStyle">坚实的</parameter> <parameter ac:name="title">UserServlet.java</parameter> <plain-text-body>包webjms;导入java.io。IOException;导入java.io。PrintWriter;导入java.util。列举;导入javax.annotation。资源；导入javax.jms。连接;导入javax.jms。ConnectionFactory;导入javax.jms。JMSException;导入javax.jms。MessageProducer;导入javax.jms。队列;导入javax.jms。会议；导入javax.jms。TextMessage;导入javax.servlet。ServletException;导入javax.servlet.http。HttpServletRequest;导入javax.servlet.http。HttpServletResponse; / ** * Servlet的Servlet实现类：UserServlet * * /公共类UserServlet扩展了javax.servlet.http。HttpServlet实现javax.servlet。Servlet {@Resource（name =“ jms / TestConnectionFactory”）私人ConnectionFactory connectionFactory; @Resource（name =“ jms / TestQueue”）私有队列队列；静态最终长serialVersionUID = 1L; / *（非Java-doc）* @see javax.servlet.http。HttpServlet＃HttpServlet（）* / public UserServlet（）{super（）; } / *（非Java-doc）* @请参阅javax.servlet.http。HttpServlet＃doGet（HttpServletRequest请求，HttpServletResponse响应）* /受保护的void doGet（HttpServletRequest请求，HttpServletResponse响应）抛出ServletException，IOException {PrintWriter out = response.getWriter（）; if（connectionFactory == null）{out.println（“连接工厂查找失败”）;返回; } if（queue == null）{out.println（“队列查找失败”）;返回; }连接connection = null;尝试{connection = connectionFactory.createConnection（）; connection.start（）;会话会话= connection.createSession（false，会话。AUTO_ACKNOWLEDGE）; MessageProducer生产者= session.createProducer（queue）; TextMessage消息= session.createTextMessage（）;枚举arr = request.getParameterNames（）; while（arr.hasMoreElements（））{字符串字段=（String）arr.nextElement（）;字符串paramname [] = request.getParameterValues（fields）;为（int i = 0; i <paramname.length;i++) {="" string="" s="null;" +="" paramname[i];="" message.settext(s);="" producer.send(message);="" }="" out.println="your=" );="" ="" send="" a="" non-text="" control="" message="" indicating="" end="" of="" messages.="" producer.send(session.createmessage());="" catch="" (jmsexception="" e)="" e.printstacktrace();="" finally="" if(connection="" !="null)" try="" connection.close();="" e1)="" *="" (non-java-doc)="" @see="" javax.servlet.http.httpservlet#dopost(httpservletrequest="" request,="" httpservletresponse="" response)="" protected="" void="" dopost(httpservletrequest="" throws="" servletexception,="" ioexception="" doget(request,="" response);=""><="" /plain-text-body="">
<br class="atl-forced-newline" clear="none">让我们尝试理解代码：<ul><li><strong>@Resource（name =“ jms / TestConnectionFactory”）</strong> -这是资源注入，其中已注入连接工厂。</li><li><strong>@Resource（name =“ jms / TestQueue”）</strong> -先前创建的队列已注入。从不需要在部署描述符中包含条目的意义上来说，资源注入很有用。</li><li>Servlet遵循请求响应模型，其中将请求发送到Servlet并生成响应。<strong>受保护的void doGet（....，....）</strong>遵循请求响应模型。</li><li><strong>PrintWriter out = response.getWriter（）</strong> -此语句返回一个PrintWriter对象，该对象用于将HTML内容发送到客户端页面。</li><li><strong>connection = connectionFactory.createConnection（）</strong> -创建与<strong>jms / TestConnectionFactory</strong>的连接</li><li><strong>会话会话= connection.createSession（..，..）</strong> -会话是用于生成和使用消息的上下文。使用此语句，我们创建一个新会话。</li><li><strong>MessageProducer生产者= session.createProducer（queue）</strong> -客户端使用消息生产者将消息发送到目标。队列名称传递给会话对象提供的createProducer方法。</li><li><strong>TextMessage message = session.createTextMessage（）</strong> -TextMessage用于发送java.lang的消息。字符串类型。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li></ul>
	</paramname.length;i++)></plain-text-body></li><li>类似地，创建第二个Servlet <em>AdminServlet</em> 。这是应用程序中的使用者。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/AddSource3.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/AddSource4.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">将以下代码添加到<strong>AdminServlet.java中</strong> ： <parameter ac:name="borderStyle">固态</parameter> <parameter ac:name="title">AdminServlet.java</parameter> <plain-text-body>程序包webjms;导入java.io。IOException;导入java.io。PrintWriter;导入javax.annotation。资源；导入javax.jms。连接;导入javax.jms。ConnectionFactory;导入javax.jms。JMSException;导入javax.jms。信息;导入javax.jms。MessageConsumer;导入javax.jms。队列;导入javax.jms。会议；导入javax.jms。TextMessage;导入javax.servlet。ServletException;导入javax.servlet.http。HttpServletRequest;导入javax.servlet.http。HttpServletResponse; / ** * Servlet的Servlet实现类：AdminServlet * * /公共类AdminServlet扩展了javax.servlet.http。HttpServlet实现javax.servlet。Servlet {@Resource（name =“ jms / TestConnectionFactory”）私人ConnectionFactory connectionFactory; @Resource（name =“ jms / TestQueue”）私有队列队列； / *（非Java-doc）* @see javax.servlet.http。HttpServlet＃HttpServlet（）* / public AdminServlet（）{super（）; } / *（非Java-doc）* @请参阅javax.servlet.http。HttpServlet＃doGet（HttpServletRequest请求，HttpServletResponse响应）* /受保护的void doGet（HttpServletRequest请求，HttpServletResponse响应）抛出ServletException，IOException {PrintWriter out = response.getWriter（）; if（connectionFactory == null）{out.println（“连接工厂查找失败”）;返回; } if（queue == null）{out.println（“队列查找失败”）;返回; }连接connection = null;尝试{connection = connectionFactory.createConnection（）;会话会话= connection.createSession（false，会话。AUTO_ACKNOWLEDGE）; MessageConsumer消费者= session.createConsumer（queue）; connection.start（）; out.println（“已收到以下信息：”）; while（true）{消息m = Consumer.receive（）;如果（m MessageMessage实例）{TextMessage消息=（TextMessage）m; out.println（message.getText（））; } else {break; }}} catch（JMSException e）{e.printStackTrace（）; }最后{if（connection！= null）{试试{connection.close（）; } catch（JMSException e1）{}}}} / *（非Java-doc）* @see javax.servlet.http。HttpServlet＃doPost（HttpServletRequest请求，HttpServletResponse响应）* /受保护的void doPost（HttpServletRequest请求，HttpServletResponse响应）抛出ServletException，IOException {doGet（request，response）; }}</plain-text-body>
<br class="atl-forced-newline" clear="none"> </li><li>右键单击<strong>WebContent</strong>并创建一个JSP。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/AddSource5.png"></span> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>将JSP命名为<code>index.jsp</code> 。选择<strong>下一步</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/AddSource6.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"></li><li>选择<strong>完成</strong> 。<br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/AddSource7.png"></span><br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none"> <br class="atl-forced-newline" clear="none">将以下代码添加到<code>index.jsp</code> ： <parameter ac:name="borderStyle">固态</parameter> <parameter ac:name="title">index.jsp</parameter> <plain-text-body><％@页面语言=“ java” contentType =“ text / html; charset = ISO-8859-1” pageEncoding =“ ISO-8859-1”％> 

<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>示例Web应用程序访问JMS资源</title>


<form action="/WebJMS/UserServlet">
<h1>请输入更新的信息</h1>
<table>
<tbody><tr>
<td>用户名：</td>
<td><input type="text" name="username" size="30"></td>
</tr>
<tr>
<td>用户身份：</td>
<td><input type="text" name="userid" size="30"></td>
</tr>
<tr>
<td>旧地址：</td>
<td><input type="text" name="oldaddress" size="30"></td>
</tr>
<tr>
<td>新地址：</td>
<td><input type="text" name="newaddress" size="30"></td>
</tr><tr>
</tr></tbody></table>
<input type="submit" value="提交">
</form>


</plain-text-body>这将创建应用程序所需的生产者，消费者和用户界面。</li></ol>


<h1 id="AccessingJMSinWebapplications-Modifyingthedeploymentplan:">修改部署计划：</h1>
<p>修改<strong>geronimo-web.xml</strong>部署计划，如下所示：</p>
<parameter ac:name="borderStyle">固态</parameter> <parameter ac:name="title">geronimo-web.xml</parameter> <plain-text-body><!--?xml version="1.0" encoding="UTF-8" ?=""--><web-app xmlns="http://geronimo.apache.org/xml/ns/j2ee/web-1.2" xmlns:nam="http://geronimo.apache.org/xml/ns/naming-1.2" xmlns:sec="http://geronimo.apache.org/xml/ns/security-1.1" xmlns:sys="http://geronimo.apache.org/xml/ns/deployment-1.2"><sys:environment><sys:moduleid><sys:groupid>默认</sys:groupid> <sys:artifactid>WebJMS</sys:artifactid> <sys:version>1.0</sys:version> <sys:type>car</sys:type></sys:moduleid> <sys:dependencies><sys:dependency><sys:groupid>org.apache.geronimo.configs</sys:groupid> <sys:artifactid>activemq-ra</sys:artifactid> <sys:version>2.1.3</sys:version> <sys:type>car</sys:type></sys:dependency></sys:dependencies></sys:environment> <context-root>/ WebJMS</context-root> <nam:resource-ref><nam:ref-name>jms / TestConnectionFactory</nam:ref-name> <nam:pattern><nam:groupid>org.apache.geronimo.configs</nam:groupid> <nam:artifactid>activemq-ra</nam:artifactid> <nam:version>2.1.3</nam:version> <nam:name>DefaultActiveMQConnectionFactory</nam:name></nam:pattern></nam:resource-ref> <nam:resource-env-ref><nam:ref-name>jms / TestQueue</nam:ref-name> <nam:pattern><nam:groupid>org.apache。 geronimo.configs</nam:groupid> <nam:artifactid>activemq-ra</nam:artifactid> <nam:version>2.1.3</nam:version> <nam:name>SendReceiveQueue</nam:name></nam:pattern></nam:resource-env-ref></web-app><!--?xml--></plain-text-body>
<p><br class="atl-forced-newline" clear="none">部署计划已修改为包括active-mq依赖关系和队列<strong>TestQueue</strong>和Connection Factory <strong>Test Connection Factory的</strong>资源引用。您可能必须更新每个依赖项的版本号，以符合所使用的Geronimo版本。<br clear="none">
<strong><sys:dependency></sys:dependency></strong> –定义应用程序对<strong>ActiveMQ</strong>的依赖性。<br clear="none">
<strong><nam:resource-ref></nam:resource-ref></strong> –该标签基本上用于定义可以是JDBC连接，Java Mail连接或JMS连接工厂的连接。在本例中，我们将其用于<strong>JMS Connection Factory</strong> 。<br clear="none">
<strong><nam:resource-env-ref></nam:resource-env-ref></strong> –该标签基本上用于定义资源。在我们的例子中，我们已经定义了消息目的地<strong>TestQueue</strong> 。
<br class="atl-forced-newline" clear="none"> </p>
<h1 id="AccessingJMSinWebapplications-DeployandRun">部署并运行</h1>
<ol><li>右键单击<strong>WebJMS</strong>项目，然后选择<strong>Run</strong> <strong>as-</strong> <strong>>在服务器上运行</strong> 。</li><li>使用<a shape="rect" class="external-link" href="http://localhost:8080/WebJMS" rel="nofollow">http：// localhost：8080 / WebJMS</a>启动应用程序。填写必填信息，然后选择<strong>Submit</strong> 。<br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/deploy11.png"></span></li><li>将请求成功发送给管理员后，您将收到以下消息。<br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/deploy12.png"></span></li><li>管理员登录后，他们将收到用户发送的请求。使用以下<a shape="rect" class="external-link" href="http://localhost:8080/WebJMS/AdminServlet" rel="nofollow">http：// localhost：8080 / WebJMS / AdminServlet启动AdminServlet</a> 。<br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="accessing-jms-in-web-applications.data/deploy13.png"></span></li></ol></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Accessing JMS in Web applications';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2013，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  

</body></html>