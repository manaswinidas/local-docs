<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=0">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="Building Apache Geronimo">
    <meta name="Keywords" content="Apache Geronimo development documentation Building Apache Geronimo">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2009-01-06">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2011, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo开发：构建Apache Geronimo</title>

  </head>

  <body  onload="init()">

    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">首页</a> > <a href="index.html">索引</a> > <a href="building-apache-geronimo.html">构建Apache Geronimo</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo开发</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">构建Apache Geronimo</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=7678"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=7678">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=7678"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=7678">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=7678"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=7678">新增新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><div class="toc-macro client-side-toc-macro" data-headerelements="H2,H3,H4,H5,H6,H7"></div>

<h2 id="BuildingApacheGeronimo-Overview">总览</h2>

<p>本文档介绍了如何构建Apache Geronimo Server项目。</p>

<p>本指南旨在介绍如何构建最新版本<code>server/trunk</code> ，不过其他较新的分支机构也应遵循类似的说明。使用相同的基本构建工具的服务器树包括：</p>
<ul><li><code>server/trunk</code></li><li><code>server/branches/3.0</code></li><li><code>server/branches/2.2</code></li><li><code>server/branches/2.1</code></li><li><code>server/branches/2.0</code></li><li><code>server/branches/1.2</code> （最近未测试）</li></ul>


<p><strong><span style="text-decoration:underline">每晚从主干建立的快照</span></strong><br clear="none">如果您只想获取最新的trunk的已编译二进制文件，则该文件已经可用。杰罗尼莫<code>server/trunk</code>是每晚从存储库中构建的，生成的编译二进制文件可作为快照在<a shape="rect" class="external-link" href="https://repository.apache.org/content/groups/snapshots/">Apache的Snapshot Repository上使用</a> 。特别是，您将需要<a shape="rect" class="external-link" href="https://repository.apache.org/content/groups/snapshots/org/apache/geronimo/assemblies/">Apache Geronimo程序集</a> ，该<a shape="rect" class="external-link" href="https://repository.apache.org/content/groups/snapshots/org/apache/geronimo/assemblies/">程序集</a>是在Geronimo作为主要版本发布时发布的。</p>

<p>通常，在测试代码修改时会编译Geronimo，否则Geronimo社区提供的快照足以测试存储库中的最新代码。而且，在提交错误时，社区感谢您是否可以测试这些最新的Geronimo程序集的错误，以确保我们尚未修复该错误。</p>

<p><strong><span style="text-decoration:underline">其他相关文件</span></strong><br clear="none">Geronimo社区还维护特定于每个Geronimo版本的构建文档。当社区尝试使所有这些相关文档彼此保持同步时，您可能会在其中发现一些不同的信息。</p>
<ul><li><a shape="rect" href="../GMOxDOC30/building-geronimo-with-maven.html">Geronimo 3.0：使用Maven构建Geronimo</a></li><li><a shape="rect" href="../GMOxDOC22/building-geronimo-with-maven.html">Geronimo 2.2：使用Maven构建Geronimo</a></li></ul>


<p><strong><span style="text-decoration:underline">有关树干状态的一般警告</span></strong><br clear="none">中的源代码<code>server/trunk</code>通常是SNAPSHOT版本，而不是最终版本。例如3.0-SNAPSHOT与3.0-beta。当社区从主干分支出来时，社区通常会将版本从SNAPSHOT发行版定稿为常规发行版。例如分支<code>server/trunk</code>至<code>server/branches/3.0-beta</code> 。</p>

<p>请注意，在SNAPSHOT版本中从主干构建Geronimo时，源代码通常取决于所有依赖项项目的SNAPSHOT版本。事实有两个风险：</p>
<ol><li>其他项目每天发布SNAPSHOTS。每天构建Geronimo时，构建过程都会下载并针对新发布的工件进行构建。</li><li>SNAPSHOT版本的本质是它们是最新的开发版本。尽管它们将被编译和发布，但它们不一定没有错误。此外，SNAPSHOTS也在积极开发中，可能会引入一些新功能或API，这可能会导致Geronimo在其自身的构建过程中失败。</li></ol>
<ul><li>由于项目＃1的性质，项目＃2可能会在以后的任何一天发生，并且项目＃2可能会持续未知的时间，直到问题得到纠正。<br clear="none">Apache Geronimo社区与依赖项项目一起解决了阻止Geronimo构建或通过测试的问题，但这并不总是可以快速解决的。有时，Geronimo社区必须进行依赖项更改，以解决其他项目的工件问题，这些工件因未解决的问题而持续存在。</li></ul>


<p>为了帮助掩盖此类可能浮出水面的问题，您可以设置本地Maven代理存储库（例如与nexus一起使用），并控制在构建过程中下载和使用哪些工件。本地代理存储库执行Geronimo所依赖的第三方工件的下载，并且Geronimo构建过程从本地代理存储库中获取工件。通过这样做，可以将引起问题的工件回滚到以前的版本，或者通过控制从远程存储库中更新供Geronimo构建过程使用的某些问题工件来暂停某些问题工件的更新。</p>



<h2 id="BuildingApacheGeronimo-Prerequisites">先决条件</h2>

<h3 id="BuildingApacheGeronimo-BuildMachine">成型机</h3>

<p>建议使用专用的计算机来建立<code>server/trunk</code>至少有2GB的实际内存。该计算机还需要连接到Internet才能下载工件依赖项。</p>

<p><strong><span style="text-decoration:underline">建立时间</span></strong><br clear="none">首次构建会将所有工件依赖项下载到本地Maven存储库中，因此构建时间将部分取决于您的Internet连接速度。在第一次完整构建后执行的构建会更快，因为在第一次构建期间已经下载了工件依赖项。由于Geronimo主干正在被开发为SNAPSHOT（例如Geronimo 3.0-SNAPSHOT），因此它也依赖于作为SNAPSHOT发布的第三方工件。结果，随着快照的发布，新的工件将被下载，这是每天发生的事情。</p>

<p>截至2011年6月，记录了以下构建时间结果：</p>
<ul><li>90分钟-1个2.4GHz双核CPU; 2GB的实际内存； 2Mb Internet连接；空的本地Maven存储库（首次构建）</li><li>13小时以上-两个2.0GHz双核CPU； 1GB的实际内存； 2Mb Internet连接；填充的Maven存储库; （不是第一个版本）</li></ul>


<p>可用的实际内存有很大的不同。在构建过程中，maven会自动加载其构建的工件。拥有足够的实际内存可以使构建过程快速启动所构建的依赖项。如果没有足够的内存，则必须交换您的实际内存，以便可以启动依赖项，然后再次交换以返回到构建过程。</p>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">建立提示</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>请参阅下面的“ <strong>构建选项”</strong>部分，以获取更多可以加快构建时间的选项。</p></div></div>


<h3 id="BuildingApacheGeronimo-JavaDeveloperKit(JDK)">Java开发人员工具包（JDK）</h3>

<p>您将需要<a shape="rect" class="external-link" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" title="Java SE 1.6" rel="nofollow">JDK 6.0+（Java SE 1.6.0 + SDK）</a>或兼容的JDK才能从主干构建Apache Geronimo。建议您使用SUN的实现，或兼容Apple的实现。其他JDK供应商实现可能会起作用，但使用后果自负。</p>

<p><strong><span style="text-decoration:underline">Apache Geronimo 2.2</span></strong><br clear="none">
<a shape="rect" class="external-link" href="http://www.oracle.com/technetwork/java/javase/index-jsp-135232.html" rel="nofollow">JDK 5.0+（J2SE 1.5.0+）</a>或兼容的JDK。<br clear="none">Java SE（JDK）6.0与Geronimo 2.2一起使用。</p>

<p><strong><span style="text-decoration:underline">Apache Geronimo 2.1及更早版本</span></strong><br clear="none">
<a shape="rect" class="external-link" href="http://www.oracle.com/technetwork/java/javase/index-jsp-135232.html" rel="nofollow">JDK 5.0+（J2SE 1.5.0+）</a>或兼容的JDK。</p>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows提示</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>根据<a shape="rect" class="external-link" href="http://jira.codehaus.org/browse/MAVEN-666" rel="nofollow">MAVEN-666</a> ，Windows用户不应双引号JAVA_HOME（或出于相同原因的MAVEN_HOME）。<br clear="none">设置：<br clear="none">设置JAVA_HOME =“ C：\ Program Files \ Java \ jdk1.6.0_20”<br clear="none">不起作用，但是这样做：<br clear="none">设置JAVA_HOME = C：\ Program Files \ Java \ jdk1.6.0_20</p></div></div>


<h3 id="BuildingApacheGeronimo-ApacheMaven2">Apache Maven 2</h3>

<p>要执行构建过程，您需要具有<a shape="rect" class="external-link" href="http://maven.apache.org">Apache Maven</a>版本<code>2.2.1</code> （或更高版本）已安装，以便从主干构建Apache Geronimo。Maven 3.0也可以用来构建中继。</p>

<p>要检查您的安装是否正常运行，并且您具有必需的最低版本，请执行以下操作：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn -version
</pre>
</div></div>
<p>它应该产生如下内容：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>Maven version: 2.2.1
</pre>
</div></div>

<p>如果您使用的版本不兼容，则服务器构建可能会失败并显示一条消息<img class="emoticon emoticon-wink" src="https://cwiki.apache.org/confluence/s/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/_/images/icons/emoticons/wink.png" alt="（眨眼）" data-emoticon-name="wink"></p>

<p><strong><span style="text-decoration:underline">Apache Geronimo 2.2</span></strong><br clear="none">
<a shape="rect" class="external-link" href="http://maven.apache.org">Apache Maven</a>版本<code>2.0.10</code> （或更高版本）</p>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Maven仓库</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>在构建Geronimo 2.2时。将以下内容添加到您的<code>settings.xml</code> for maven，这样您就可以避免重定向（从而避免了虚假的poms / jars），并克服了编译失败的问题，从而可以使用maven构建Geronimo。有关更多详细<a shape="rect" class="external-link" href="http://apache-geronimo.328035.n3.nabble.com/Could-not-build-Geronimo-server-from-SVN-branch-2-2-td409663.html" rel="nofollow">信息</a> ，请参<a shape="rect" class="external-link" href="http://apache-geronimo.328035.n3.nabble.com/Could-not-build-Geronimo-server-from-SVN-branch-2-2-td409663.html" rel="nofollow">见此消息</a> 。</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px"><b>Maven的setting.xml的摘录</b></div><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
...
   &lt;mirrors&gt;
       &lt;mirror&gt;
           &lt;id&gt;java.net&lt;/id&gt;
           &lt;name&gt;Mirror of https://maven-repository.dev.java.net/nonav/repository/&lt;/name&gt;
           &lt;url&gt;http://download.java.net/maven/2/&lt;/url&gt;
           &lt;mirrorOf&gt;java.net&lt;/mirrorOf&gt;
       &lt;/mirror&gt;
   &lt;/mirrors&gt;
...
]]></script>
</div></div></div></div>


<h3 id="BuildingApacheGeronimo-Subversion">颠覆</h3>

<p>要获取服务器的源代码，您将需要安装<a shape="rect" class="external-link" href="http://subversion.tigris.org/" rel="nofollow">Subversion</a>客户端1.5版（或更高版本，建议使用1.5版）。</p>
<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows提示</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p><strong>强烈建议</strong> Windows用户将M2本地存储库（下载依赖项的位置）更改为没有空格的较短路径，例如<code>C:\.m2</code> 。<br clear="none">使用更长的路径可能会导致构建（以及Geronimo本身）在Windows上达到文件名的260个字符限制时表现异常。</p>

<p>为了更改m2本地存储库，请转到<code>%USERPROFILE%\.m2</code>并编辑或创建<code>settings.xml</code>文件包含以下内容：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;settings&gt;
    &lt;localRepository&gt;C:\.m2&lt;/localRepository&gt;
&lt;/settings&gt;
]]></script>
</div></div></div></div>

<h2 id="BuildingApacheGeronimo-CheckoutGeronimo">结帐Geronimo</h2>

<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>svn co https://svn.apache.org/repos/asf/geronimo/server/trunk server
</pre>
</div></div>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">小费</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>如果您使用的是中文系统，请将您的语言环境更改为en_US。否则，maven 2.0.7（或更低版本）将无法解析汉字。</p></div></div>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows提示</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p><strong>强烈建议</strong> Windows用户将Geronimo签出到<code>c:\g</code> 。<br clear="none">使用更长的路径可能会导致构建（以及Geronimo本身）在Windows上达到文件名的260个字符限制时表现异常。</p></div></div>

<p>您还可以使用Git镜像检出Geronimo源代码，并在使用以下命令之前确保已安装Git客户端：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>git clone git://git.apache.org/geronimo server
</pre>
</div></div>


<h2 id="BuildingApacheGeronimo-PreparingtoBuildfortheFirstTime">首次准备建造</h2>

<p>您可能需要增加Maven的堆大小。将以下行添加到<code>~/.mavenrc</code> ：</p>
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>仅设置以下剪裁<code>MAVEN_OPTS</code> （如果尚未设置），则可以根据需要在命令行上覆盖这些值。</p></div></div>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre># Increase the heap size Maven
if [ "x$MAVEN_OPTS" = "x" ]; then
    MAVEN_OPTS=-Xmx512m
fi
</pre>
</div></div>
<p>如果您使用的是SUN JDK（或具有兼容标志的JDK，例如Apple JDK），则还应该增加最大永久大小以及堆大小：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre># Increase the heap and max permanent size for Maven
if [ "x$MAVEN_OPTS" = "x" ]; then
    MAVEN_OPTS="-Xmx1024m -XX:PermSize=256m -XX:MaxPermSize=1024m -XX:ReservedCodeCacheSize=64m"
fi
</pre>
</div></div>

<p><strong><span style="text-decoration:underline">对于Apache Geronimo 2.2，至少使用：</span></strong></p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>if [ "x$MAVEN_OPTS" = "x" ]; then
    MAVEN_OPTS="-Xmx512m -XX:MaxPermSize=128m -XX:ReservedCodeCacheSize=64m"
fi
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows提示</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Windows用户应创建<code>mavenrc_pre.bat</code>下<code>c:\documents and settings\<username>\mavenrc_pre.bat</code>要么<code>c:\mavenrc_pre.bat</code>取决于如何<code>%HOME%</code>属性在您的系统上设置。</p>

<p>变量将需要使用批处理集语法：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>set &lt;VARIABLE&gt;=&lt;VALUE&gt;
</pre>
</div></div></div></div>

<h2 id="BuildingApacheGeronimo-Building">建造</h2>

<p>要逐步建立所有更改：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn install
</pre>
</div></div>
<p>要执行干净的构建，在对源代码树进行一些更改之后，有时有时需要这样做：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn clean install
</pre>
</div></div>


<h3 id="BuildingApacheGeronimo-BuildingStages">建筑阶段</h3>

<p>在某些情况下，您可能需要分阶段构建Geronimo，例如在更改geronimo版本时。大多数用户不需要这样做，但是为了清楚起见，在此进行了记录。</p>

<p>要构建模块，testsupport和maven插件：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn install -Dstage=bootstrap
</pre>
</div></div>
<p>要构建应用程序，配置和程序集：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn install -Dstage=assemble
</pre>
</div></div>
<p>如前所述，大多数用户将不需要分阶段构建Geronimo。但是在某些情况下，当引导新版本时（当当前版本的远程仓库中没有部署任何构件时），则<strong>必须</strong>为第<em>一个</em>构建分别构建阶段，然后为随后的所有构建分别构建阶段，则不必进行分段构建。</p>
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>使用Sonatype nexus可以帮助使大型Maven构建更快，更可靠。但是，您必须在nexus实例中配置geronimo poms中指定的所有存储库。</p></div></div>

<h3 id="BuildingApacheGeronimo-BuildOptions">构建选项</h3>

<p><strong><span style="text-decoration:underline">HeapDumpOnOutOfMemoryError</span></strong><br clear="none">将HeapDumpOnOutOfMemoryError标志添加到MAVEN_OPTS以获取OutOfMemory错误的转储</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>-XX:+HeapDumpOnOutOfMemoryError
</pre>
</div></div>

<p><strong><span style="text-decoration:underline">跳过测试</span></strong><br clear="none">使用-DskipTests = true可以在服务器构建期间关闭测试。如果您只是在运行构建以节省更多时间，则可以使用此标志。但是，如果要更改代码，则不应使用此标志，因为您应该使用测试进行构建，以确保所做的更改不会破坏任何内容。如果您要提交补丁或代码更改建议，则必须测试构建。</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn clean install -DskipTests=true
</pre>
</div></div>

<p><strong><span style="text-decoration:underline">离线制作</span></strong><br clear="none">您也可以在离线模式下进行构建。使用-o避免搜索远程存储库以节省更多时间。但是，您必须先完成一个完整的在线构建，然后才能将所有依赖项下载到本地maven存储库中。在第一个完整的构建之后，使用-o标志将使maven仅使用本地拥有的内容，而不搜索远程存储库。</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn -o clean install
</pre>
</div></div>

<p><strong><span style="text-decoration:underline">更多错误和调试信息</span></strong><br clear="none">要使Maven为您提供更多错误详细信息，请使用-e获取有关错误的堆栈跟踪，并使用-X生成执行调试输出。</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn -X clean install
mvn -e clean install
</pre>
</div></div>

<p><strong><span style="text-decoration:underline">将构建限制为仅一个程序集</span></strong><br clear="none">如果您只对tomcat组件或jetty组件感兴趣，则可以通过指示应构建以下哪种组装类型来节省构建时间。有两个配置文件<code>geronimo/server/trunk/assemblies/pom.xml</code>命名<code>tomcat</code>和<code>jetty</code> 。要仅构建tomcat组件而不是码头组件，则应这样表示：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn clean install -Ptomcat
</pre>
</div></div>
<p>您应该能够使用内置的Maven东西执行此操作，请参阅<a shape="rect" class="external-link" href="http://www.sonatype.com/people/2009/10/maven-tips-and-tricks-advanced-reactor-options/" rel="nofollow">Maven提示和技巧高级反应堆选项</a> 。<br clear="none">示例：这应该构建命名程序集所需的所有内容，包括程序集：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn clean install -pl :geronimo-tomcat7-javaee6 -am
</pre>
</div></div>



<h3 id="BuildingApacheGeronimo-GeronimoAssembliesResultingfromtheBuild">生成的Geronimo装配体</h3>

<p>在成功完成完整的构建后，生成的程序集将位于每个程序集的关联目标子目录中。这些与每晚Apache Geronimo快照提供的内容相同。</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>BUILD_ROOT/assemblies/geronimo-jetty8-javaee6/target/geronimo-jetty8-javaee6-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/assemblies/geronimo-jetty8-javaee6-web/target/geronimo-jetty8-javaee6-web-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/assemblies/geronimo-tomcat7-minimal/target/geronimo-tomcat7-minimal-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/assemblies/geronimo-tomcat7-javaee6/target/geronimo-tomcat7-javaee6-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/assemblies/geronimo-tomcat7-javaee6-web/target/geronimo-tomcat7-javaee6-web-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/assemblies/geronimo-jetty8-minimal/target/geronimo-jetty8-minimal-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/plugins/clustering/geronimo-plugin-farm-node/target/geronimo-plugin-farm-node-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/framework/assemblies/geronimo-framework/target/geronimo-framework-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/framework/modules/geronimo-plugin/target/test-resources/ArchiverGBeanTest/server1/bar-1.0-bin(.tar.gz|.zip)
</pre>
</div></div>


<h2 id="BuildingApacheGeronimo-TestingtheAssembly">测试组装</h2>

<h3 id="BuildingApacheGeronimo-usingthegeronimo-maven-plugin">使用geronimo-maven-plugin</h3>

<p>完全构建服务器后，将产生许多<code>zip</code>和<code>tar.gz</code>组装模块中的存档，您可以使用<code>geronimo-maven-plugin</code>启动服务器。从项目根目录运行：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn -Ptools geronimo:start
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows提示</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Windows用户可能需要指定替代方法<code>installDirectory</code>避免长途问题：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn -Ptools geronimo:start -DinstallDirectory=c:\g
</pre>
</div></div></div></div>
<p>并停止<code>CTRL-C</code>或从单独的终端，从项目根目录运行：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn -Ptools geronimo:stop
</pre>
</div></div>

<h3 id="BuildingApacheGeronimo-orbyhand">或用手</h3>

<p>cd程序集/ geronimo / jetty6-javaee5 / target<br clear="none">tar xzf geronimo-jetty6-javaee5- <version>-bin.tar.gz<br clear="none">./geronimo-jetty-javaee5- <version>/ bin /</version> gsh <version>geronimo / start-server</version></version></p>

<h2 id="BuildingApacheGeronimo-IDESetup">IDE安装</h2>

<p>服务器项目没有签入任何IDE文件，因为主要的IDE对maven的支持比对maven的支持要好。</p>

<h3 id="BuildingApacheGeronimo-IntellijIDEA">Intellij IDEA</h3>

<p>对于IDEA 8.1和更高版本：<br clear="none">该项目太大，无法在IDEA中立即打开。通常，框架项目和单个插件都是可以使用的大小。在Maven项目选项卡中，检查它的配置文件以获取更多的Maven项目。</p>

<h3 id="BuildingApacheGeronimo-Eclipse">日食</h3>

<p>使用maven2 eclipse：eclipse插件。有关详细说明，请参见<a shape="rect" href="developing-geronimo-in-eclipse.html">在Eclipse中开发Geronimo</a> 。至于IDEA，打开框架或单个插件比尝试打开整个项目更有可能。</p>

<h2 id="BuildingApacheGeronimo-Troubleshooting">故障排除</h2>

<h3 id="BuildingApacheGeronimo-Buildwasnotabletodownloadandinstallartifacts">Build无法下载和安装工件</h3>
<p>如果由于某种原因maven无法下载和安装工件，并且构建因出现错误而停止，则您将需要手动下载归档文件并将其安装在本地maven存储库中。您可以使用类似于以下内容的maven命令来做到这一点：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn install:install-file
    -DgroupId=org.apache.geronimo.framework
    -DartifactId=geronimo-kernel
    -Dversion=jar
    -Dpackaging=3.0-20110608.081951-139
    -Dfile=/path/to/file-artifact.jar
</pre>
</div></div>

<p>Maven可以为您下载并安装依赖项：</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>mvn dependency:get
    -DrepoUrl=https://repository.apache.org/content/groups/snapshots/
    -Dartifact="org.apache.geronimo.framework:geronimo-kernel:jar:3.0-20110608.081951-139"
</pre>
</div></div>

<p>您将需要确定可从哪个仓库获得工件。看在<code>BUILD_ROOT/pom.xml</code>内的文件<code><repositories></code>标签以查看所使用的主要存储库。您还可以查看构建输出，以查看maven尝试从何处下载工件。</p>

<h3 id="BuildingApacheGeronimo-OverridinglibrariesprovidedbyJVMatcompiletime">JVM在编译时提供的覆盖库</h3>
<p>在某些情况下，Java EE 6需要比Java SE 6提供的库版本更高的库。例如，EE 6需要注释1.1 API，而SE 6提供注释1.0 API。因此，有必要在构建过程中使用较新的版本覆盖JVM提供的库。</p>

<p>您可以使用<code>geronimo-property-plugin</code>在工件的pom.xml文件中设置_ <em>bootClassPath</em> _属性，该属性由<code>maven-compiler-plugin</code>和<code>maven-surefire-plugin</code>如下。的<code>geronimo-property-plugin</code>在<strong>验证</strong>阶段执行并设置_ <em>bootClassPath</em> _系统属性。_ <em>bootClassPath</em> _属性的值设置为_ <em><strong>-Xbootclasspath / p： <path><pathseparator><path>...</path></pathseparator></path></strong></em> _字符串，其中每个<strong><path></path></strong>是放置在引导类路径前面的jar文件。</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px"><b>pom.xml</b></div><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
...
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.geronimo.buildsupport&lt;/groupId&gt;
                &lt;artifactId&gt;geronimo-property-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;propertyName&gt;bootClassPath&lt;/propertyName&gt;
                    &lt;propertyValuePrefix&gt;-Xbootclasspath/p:&lt;/propertyValuePrefix&gt;
                    &lt;classpath&gt;
                        &lt;dependency&gt;
                            &lt;groupId&gt;org.apache.geronimo.specs&lt;/groupId&gt;
                            &lt;artifactId&gt;geronimo-annotation_1.1_spec&lt;/artifactId&gt;
                            &lt;version&gt;1.0.1&lt;/version&gt;
                        &lt;/dependency&gt;
                        &lt;dependency&gt;
                            &lt;groupId&gt;org.apache.geronimo.specs&lt;/groupId&gt;
                            &lt;artifactId&gt;geronimo-jaxws_2.2_spec&lt;/artifactId&gt;
                            &lt;version&gt;${geronimojaxws.version}&lt;/version&gt;
                        &lt;/dependency&gt;
                    &lt;/classpath&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;compilerArgument&gt;${bootClassPath}&lt;/compilerArgument&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;argLine&gt;${bootClassPath}&lt;/argLine&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
...
]]></script>
</div></div>

<p>同时，你可以使用<em>listFiles</em>选项，这样的<strong>一组</strong>属性<code>geronimo-property-plugins</code>可能包含文件或目录。例如，如果您想要<code>geronimo-property-plugins</code>设置“ -Djava.endorsed.dirs”属性，然后使用以下命令配置插件：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
&lt;propertyValuePrefix&gt;-Djava.endorsed.dirs=&lt;/propertyValuePrefix&gt;
&lt;listFiles&gt;false&lt;/listFiles&gt;
]]></script>
</div></div>
<p>如果您希望插件设置“ -Xbootclasspath / p：”属性，请使用以下命令配置插件：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
&lt;propertyValuePrefix&gt;-Xbootclasspath/p:&lt;/propertyValuePrefix&gt;
&lt;listFiles&gt;true&lt;/listFiles&gt;
]]></script>
</div></div>


<h3 id="BuildingApacheGeronimo-Buildcan'tfindxbeanjar">构建找不到xbean jar</h3>
<p><strong><span style="text-decoration:underline">Apache Geronimo 2.0</span></strong><br clear="none">如果您正在构建2.0分支，并且由于找不到xbean jar而导致构建失败（例如org.apache.xbean：xbean-naming：jar：3.2-r579367），请添加</p>
<div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>http://svn.apache.org/repos/asf/openejb/repo/
</pre>
</div></div>
<p>存放到<code>pom.xml</code>文件位于源树的根目录中。有关更多详细<a shape="rect" class="external-link" href="http://mail-archives.apache.org/mod_mbox/geronimo-dev/200710.mbox/%3cAC0FF32B-74DD-4BF1-ADD3-635559FEFB75@hogstrom.org%3e">信息</a> ，请参<a shape="rect" class="external-link" href="http://mail-archives.apache.org/mod_mbox/geronimo-dev/200710.mbox/%3cAC0FF32B-74DD-4BF1-ADD3-635559FEFB75@hogstrom.org%3e">见此消息</a> 。</p></div>
        </div>

        
      </div>
    </div>

    <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo Development : Building Apache Geronimo';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2011，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-4380560-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  

</body></html>