<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link type="text/css" rel="stylesheet" href="http://geronimo.apache.org/style/default.css">
    <LINK rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <META name="Description" content="Building Apache Geronimo" />
    <META name="Keywords" content="Apache Geronimo development documentation Building Apache Geronimo" />
    <META name="Owner" content="dev@geronimo.apache.org" />
    <META name="Robots" content="index, follow" />
    <META name="Security" content="Public" />
    <META name="Source" content="wiki template" />
    <META name="DC.Date" scheme="iso8601" content="2009-01-06" />
    <META name="DC.Language" scheme="rfc1766" content="en" />
    <META name="DC.Rights" content="Copyright Â© 2003-2011, The Apache Software Foundation" />
    <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo Development : Building Apache Geronimo</title>

  </head>

  <body onload="init()">

    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tr>
        <td valing="top" align="left">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </table>

    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" align="left" nowrap>
          <a href="/geronimo"> Home</a> >&nbsp;<a href="index.html">Index</a>&nbsp;&gt;&nbsp;<a href="building-apache-geronimo.html">Building Apache Geronimo</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8" />
            <input type="hidden" name="oe" value="UTF-8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
        </td>
      </tr> 
    </table>

    <div id="PageContent">
      <div class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div style="margin: 0px 10px 0px 10px" class="smalltext">Apache Geronimo Development</div>
        <div style="margin: 0px 10px 8px 10px"  class="pagetitle">Building Apache Geronimo</div>

        <div class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
<!-- -->         
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=7678">
            <img src="http://geronimo.apache.org/images/icons/notep_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Edit Page"></a>
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=7678">Edit Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV">
            <img src="http://geronimo.apache.org/images/icons/browse_space.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Browse Space"></a>
            <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV">Browse Space</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=7678">
            <img src="http://geronimo.apache.org/images/icons/add_page_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add Page"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=7678">Add Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=7678">
            <img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add News"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=7678">Add News</a>
<!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><div class="toc-macro client-side-toc-macro" data-headerelements="H2,H3,H4,H5,H6,H7"></div>

<h2 id="BuildingApacheGeronimo-Overview">Overview</h2>

<p>This documents how to build the Apache Geronimo Server project.</p>

<p>This guide is intended to cover how to build the latest <code>server/trunk</code>, though other newer branches should also follow similar instructions.  Server trees that use the same basic build tooling include:</p>
<ul><li><code>server/trunk</code></li><li><code>server/branches/3.0</code></li><li><code>server/branches/2.2</code></li><li><code>server/branches/2.1</code></li><li><code>server/branches/2.0</code></li><li><code>server/branches/1.2</code> (not tested recently)</li></ul>


<p><strong><span style="text-decoration: underline;">nightly built snapshots from trunk</span></strong><br clear="none">
If you are only interested in obtaining a compiled binary of what is most recent in trunk, this is already made available. Geronimo <code>server/trunk</code> is built from the repository on a nightly basis, and the resulting compiled binaries are available as snapshots on <a shape="rect" class="external-link" href="https://repository.apache.org/content/groups/snapshots/">Apache's Snapshot Repository</a>. Particularly you will want the <a shape="rect" class="external-link" href="https://repository.apache.org/content/groups/snapshots/org/apache/geronimo/assemblies/">Apache Geronimo assemblies</a> which is what is published when Geronimo is released as a major revision.</p>

<p>Typically one would compile Geronimo when testing code modifications, otherwise the snapshots the Geronimo community provides is sufficient for testing the latest code from the repository. And when submitting a bug, the community appreciates if these latest Geronimo assemblies can be tested for the bug to make sure we haven't already fixed it.&#160;</p>

<p><strong><span style="text-decoration: underline;">other relevant documentation</span></strong><br clear="none">
The Geronimo community also maintains build documentation specific to each Geronimo version. While the community attempts to keep all these related docs in sync with each other, you may find some varying information among them.</p>
<ul><li><a shape="rect" href="../GMOxDOC30/building-geronimo-with-maven.html">Geronimo 3.0: Building Geronimo with Maven</a></li><li><a shape="rect" href="../GMOxDOC22/building-geronimo-with-maven.html">Geronimo 2.2: Building Geronimo with Maven</a></li></ul>


<p><strong><span style="text-decoration: underline;">a general warning about the state of trunk</span></strong><br clear="none">
The source code in <code>server/trunk</code> typically will be in SNAPSHOT release, as opposed to a final release. E.g. 3.0-SNAPSHOT versus 3.0-beta. The community typically finalizes the version from SNAPSHOT release to a regular release when it is branched out of trunk. E.g. branch <code>server/trunk</code> to <code>server/branches/3.0-beta</code>.</p>

<p>Please be aware that when building Geronimo from trunk while in SNAPSHOT release the source code typically depends on the SNAPSHOT releases from all dependency projects. There are two risks from this matter-of-fact:</p>
<ol><li>Other projects release SNAPSHOTS on a daily basis. Every day you would build Geronimo, the build process will download and build against newly released artifacts.</li><li>The nature of SNAPSHOT releases is that they are the latest development builds. Though they will be compiled and released, they are not necessarily error free. Additionally, SNAPSHOTS are actively developed and may introduce some new feature or API that might cause Geronimo to fail during its own build.</li></ol>
<ul><li>Due to the nature of item #1, item #2 may occur on any future day, and item #2 may persist for an unknown amount of time until issues are corrected.<br clear="none">
The Apache Geronimo community works with dependency projects to resolve issues that prevent Geronimo from building or passing tests, but this is not always resolvable in a speedy fashion. Sometimes the Geronimo community must make dependency changes to resolve issues with other project's artifacts that persist with issues that go unresolved.</li></ul>


<p>To help mask issues like these that can surface, you can setup a local maven proxy repo (like with nexus) and control what artifacts are downloaded and used in the build process. The local proxy repository performs the download of 3rd party artifacts Geronimo depends on, and the Geronimo build process obtains the artifacts from the local proxy repository. In doing this, artifacts that causes issues can be rolled back to a previous version, or instead you can pause updates on certain problem artifacts by controlling which are updated from the remote repositories for the Geronimo build process to use.</p>



<h2 id="BuildingApacheGeronimo-Prerequisites">Prerequisites</h2>

<h3 id="BuildingApacheGeronimo-BuildMachine">Build Machine</h3>

<p>It is recommended that a dedicated computer used to build <code>server/trunk</code> have a minimum of 2GB of real memory. The computer will also need a connection to the Internet to download artifact dependencies.</p>

<p><strong><span style="text-decoration: underline;">Build Time</span></strong><br clear="none">
The first-time-build will download all artifact dependencies into your local maven repository, so the build time will partly depend on the speed of your internet connection. The builds that are executed after the first complete build will be faster because the artifact dependencies are already downloaded during the first build. As Geronimo trunk is being developed as SNAPSHOT (e.g. Geronimo 3.0-SNAPSHOT), it also depends on 3rd-party artifacts that are being released as SNAPSHOTs. As a result, new artifacts will be downloaded as snapshots are released, which is a daily occurrence.</p>

<p>As of June 2011 the following build time results were recorded:</p>
<ul><li>90 minutes - one 2.4GHz dual-core CPU; 2GB of real memory; 2Mb Internet connection; empty local maven repository (first build)</li><li>13+ hours - two 2.0GHz dual-core CPUs; 1GB of real memory; 2Mb Internet connection; populated maven repository; (not first build)</li></ul>


<p>The available real memory makes a big difference. During the build process, maven self-loads the artifacts it builds. Having enough real memory allows the build process to quickly start up the dependencies that are built. Without enough memory, your real memory must be swapped so the dependencies can be started, and then swapped again to go back to the build process.</p>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Build Tips</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Refer to the <strong>Build Options</strong> section below for more options that can speed up your build time.</p></div></div>


<h3 id="BuildingApacheGeronimo-JavaDeveloperKit(JDK)">Java Developer Kit (JDK)</h3>

<p>You will need a <a shape="rect" class="external-link" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" title="Java SE 1.6" rel="nofollow">JDK 6.0+ (Java SE 1.6.0+ SDK)</a> or compatible JDK to build Apache Geronimo from trunk.  It is recommended you use SUN's implementation, or something compatible like Apples implementation.  Other JDK vendors implementations may work, but use at your own risk.</p>

<p><strong><span style="text-decoration: underline;">Apache Geronimo 2.2</span></strong><br clear="none">
<a shape="rect" class="external-link" href="http://www.oracle.com/technetwork/java/javase/index-jsp-135232.html" rel="nofollow">JDK 5.0+ (J2SE 1.5.0+)</a> or compatible JDK.<br clear="none">
The Java SE (JDK) 6.0 works with Geronimo 2.2.</p>

<p><strong><span style="text-decoration: underline;">Apache Geronimo 2.1 and earlier</span></strong><br clear="none">
<a shape="rect" class="external-link" href="http://www.oracle.com/technetwork/java/javase/index-jsp-135232.html" rel="nofollow">JDK 5.0+ (J2SE 1.5.0+)</a> or compatible JDK.</p>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows Tip</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Windows users should not double-quote JAVA_HOME (or MAVEN_HOME for the same reason), according to <a shape="rect" class="external-link" href="http://jira.codehaus.org/browse/MAVEN-666" rel="nofollow">MAVEN-666</a>.<br clear="none">
Setting:<br clear="none">
set JAVA_HOME="C:\Program Files\Java\jdk1.6.0_20"<br clear="none">
doesn't work, but this does:<br clear="none">
set JAVA_HOME=C:\Program Files\Java\jdk1.6.0_20</p></div></div>


<h3 id="BuildingApacheGeronimo-ApacheMaven2">Apache Maven 2</h3>

<p>To execute the build process you need to have <a shape="rect" class="external-link" href="http://maven.apache.org">Apache Maven</a> version <code>2.2.1</code> (or newer) installed to build Apache Geronimo from trunk. Maven 3.0 can also be used to build trunk.</p>

<p>To check if your installation is working and you have the required minimum version run:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn -version
</pre>
</div></div>
<p>And it should produce something like:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>Maven version: 2.2.1
</pre>
</div></div>

<p>If you have an incompatible version the server build will probably fail with a message complaining <img class="emoticon emoticon-wink" src="https://cwiki.apache.org/confluence/s/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/_/images/icons/emoticons/wink.png" data-emoticon-name="wink" alt="(wink)"></p>

<p><strong><span style="text-decoration: underline;">Apache Geronimo 2.2</span></strong><br clear="none">
<a shape="rect" class="external-link" href="http://maven.apache.org">Apache Maven</a> version <code>2.0.10</code> (or newer)</p>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">maven repository</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>When building Geronimo 2.2. Add the following to your <code>settings.xml</code> for maven so that you can avoid the redirect (and hence avoid the bogus poms/jars) and get beyond compilation failure problem to build Geronimo using maven. See <a shape="rect" class="external-link" href="http://apache-geronimo.328035.n3.nabble.com/Could-not-build-Geronimo-server-from-SVN-branch-2-2-td409663.html" rel="nofollow">this message</a> for more details.</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>excerpt of setting.xml for maven</b></div><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
...
   &lt;mirrors&gt;
       &lt;mirror&gt;
           &lt;id&gt;java.net&lt;/id&gt;
           &lt;name&gt;Mirror of https://maven-repository.dev.java.net/nonav/repository/&lt;/name&gt;
           &lt;url&gt;http://download.java.net/maven/2/&lt;/url&gt;
           &lt;mirrorOf&gt;java.net&lt;/mirrorOf&gt;
       &lt;/mirror&gt;
   &lt;/mirrors&gt;
...
]]></script>
</div></div></div></div>


<h3 id="BuildingApacheGeronimo-Subversion">Subversion</h3>

<p>To fetch the source code for the server, you will need to have a <a shape="rect" class="external-link" href="http://subversion.tigris.org/" rel="nofollow">Subversion</a> client version 1.5 (or newer, 1.5 is recommended) installed.</p>
<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows Tip</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Windows users are <strong>strongly encouraged</strong> to change the M2 local repository (the place where dependencies are downloaded) to a shorter path with no spaces, e.g. <code>C:\.m2</code>.<br clear="none">
Using a longer path may cause the build (and Geronimo itself) to behave very strangely when it hits the 260 char limit for filenames on Windows.</p>

<p>In order to change the m2 local repository go to <code>%USERPROFILE%\.m2</code> and edit or create <code>settings.xml</code> file to contain the following content:</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;settings&gt;
    &lt;localRepository&gt;C:\.m2&lt;/localRepository&gt;
&lt;/settings&gt;
]]></script>
</div></div></div></div>

<h2 id="BuildingApacheGeronimo-CheckoutGeronimo">Checkout Geronimo</h2>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>svn co https://svn.apache.org/repos/asf/geronimo/server/trunk server
</pre>
</div></div>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Tip</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>If you are using Chinese system, please change your locale to en_US. Otherwise, the maven 2.0.7(or below) can't parse Chinese characters.</p></div></div>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows Tip</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Windows users are <strong>strongly encouraged</strong> to checkout Geronimo into <code>c:\g</code>.<br clear="none">
Using a longer path may cause the build (and Geronimo itself) to behave very strangely when it hits the 260 char limit for filenames on Windows.</p></div></div>

<p>You can also use Git mirrors to checkout Geronimo source code, and make sure you have a Git client installed before using the following command:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>git clone git://git.apache.org/geronimo server
</pre>
</div></div>


<h2 id="BuildingApacheGeronimo-PreparingtoBuildfortheFirstTime">Preparing to Build for the First Time</h2>

<p>Chances are you will need to increase the heap size for Maven.  Add the following lines to <code>~/.mavenrc</code>:</p>
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>The following snips only set <code>MAVEN_OPTS</code> if its not already set, so that you can override these values on the command line if needed.</p></div></div>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre># Increase the heap size Maven
if [ "x$MAVEN_OPTS" = "x" ]; then
    MAVEN_OPTS=-Xmx512m
fi
</pre>
</div></div>
<p>If you are using the SUN JDK (or a JDK with compatible flags, like the Apple JDK), you should also increase the maximum permanent size as well as the heap:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre># Increase the heap and max permanent size for Maven
if [ "x$MAVEN_OPTS" = "x" ]; then
    MAVEN_OPTS="-Xmx1024m -XX:PermSize=256m -XX:MaxPermSize=1024m -XX:ReservedCodeCacheSize=64m"
fi
</pre>
</div></div>

<p><strong><span style="text-decoration: underline;">For Apache Geronimo 2.2, use at least:</span></strong></p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>if [ "x$MAVEN_OPTS" = "x" ]; then
    MAVEN_OPTS="-Xmx512m -XX:MaxPermSize=128m -XX:ReservedCodeCacheSize=64m"
fi
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows Tip</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Windows users should create <code>mavenrc_pre.bat</code> under <code>c:\documents and settings\&lt;username&gt;\mavenrc_pre.bat</code> or <code>c:\mavenrc_pre.bat</code> depending on how the <code>%HOME%</code> property is set on your system.</p>

<p>Variables will need to use the batch set syntax:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>set &lt;VARIABLE&gt;=&lt;VALUE&gt;
</pre>
</div></div></div></div>

<h2 id="BuildingApacheGeronimo-Building">Building</h2>

<p>To build all changes incrementally:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn install
</pre>
</div></div>
<p>To perform clean builds, which are sometimes needed after some changes to the source tree:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn clean install
</pre>
</div></div>


<h3 id="BuildingApacheGeronimo-BuildingStages">Building Stages</h3>

<p>In some cases you may need to build Geronimo in stages, such as when you have changed the geronimo version.  Most users will not need to do this, but its documented here for clarity.</p>

<p>To build modules, testsupport and maven-plugins:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn install -Dstage=bootstrap
</pre>
</div></div>
<p>To build apps, configs and assemblies:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn install -Dstage=assemble
</pre>
</div></div>
<p>As mentioned, most users will not need to build Geronimo in stages.  But in some cases, when bootstrapping new versions (when no artifacts are deployed into remote repositories for the current version), then you <strong>must</strong> build the stages separately for the <em>first</em> build and then for all builds afterwards, the staged build is not necessary.</p>
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Using Sonatype nexus can help make large maven builds faster and more reliable.  However you have to configure all the repositories specified in the geronimo poms in your nexus instance.</p></div></div>

<h3 id="BuildingApacheGeronimo-BuildOptions">Build Options</h3>

<p><strong><span style="text-decoration: underline;">HeapDumpOnOutOfMemoryError</span></strong><br clear="none">
Add the HeapDumpOnOutOfMemoryError flag to MAVEN_OPTS to get a dump on OutOfMemory errors</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>-XX:+HeapDumpOnOutOfMemoryError
</pre>
</div></div>

<p><strong><span style="text-decoration: underline;">Skip tests</span></strong><br clear="none">
Use -DskipTests=true to turn off tests during server build. You can use this flag if you are simply running a build to save a little more time. However, you should not use this flag if you are making code changes, as you should want to build with the tests to make sure your changes do not break anything. Testing the build is necessary if you are submitting a patch or code change recommendations.</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn clean install -DskipTests=true
</pre>
</div></div>

<p><strong><span style="text-decoration: underline;">Build offline</span></strong><br clear="none">
You can also build in an offline mode. Use -o to avoid searching remote repositories to save more time. However, you have to complete one full online build before this will work so that all dependencies will be downloaded into your local maven repository. After the first complete build, using the -o flag will cause maven to only use what you have locally and not search remote repositories.</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn -o clean install
</pre>
</div></div>

<p><strong><span style="text-decoration: underline;">More error and debug information</span></strong><br clear="none">
To get Maven to provide you with more error details, use -e to get stack traces on errors, and use -X to produce execution debug output.</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn -X clean install
mvn -e clean install
</pre>
</div></div>

<p><strong><span style="text-decoration: underline;">Restricting a build to only one assembly</span></strong><br clear="none">
If your only interested in either the tomcat or jetty assemblies, you can save build time by indicating which of these assembly types should be built. There are two profiles in the <code>geronimo/server/trunk/assemblies/pom.xml</code> named <code>tomcat</code> and <code>jetty</code>. To only build the tomcat assemblies and not the jetty ones, you would indicate it like this:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn clean install -Ptomcat
</pre>
</div></div>
<p>You should be able to do this with built-in maven stuff, see <a shape="rect" class="external-link" href="http://www.sonatype.com/people/2009/10/maven-tips-and-tricks-advanced-reactor-options/" rel="nofollow">maven tips and tricks advanced reactor options</a>.<br clear="none">
Example: This should build everything needed for the named assembly including the assembly:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn clean install -pl :geronimo-tomcat7-javaee6 -am
</pre>
</div></div>



<h3 id="BuildingApacheGeronimo-GeronimoAssembliesResultingfromtheBuild">Geronimo Assemblies Resulting from the Build</h3>

<p>After a complete build has successfully finished, the resulting assemblies are located in associated target subdirectories of each assembly. These are the same as what are provided from the nightly Apache Geronimo Snapshots.</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>BUILD_ROOT/assemblies/geronimo-jetty8-javaee6/target/geronimo-jetty8-javaee6-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/assemblies/geronimo-jetty8-javaee6-web/target/geronimo-jetty8-javaee6-web-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/assemblies/geronimo-tomcat7-minimal/target/geronimo-tomcat7-minimal-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/assemblies/geronimo-tomcat7-javaee6/target/geronimo-tomcat7-javaee6-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/assemblies/geronimo-tomcat7-javaee6-web/target/geronimo-tomcat7-javaee6-web-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/assemblies/geronimo-jetty8-minimal/target/geronimo-jetty8-minimal-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/plugins/clustering/geronimo-plugin-farm-node/target/geronimo-plugin-farm-node-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/framework/assemblies/geronimo-framework/target/geronimo-framework-3.0-SNAPSHOT-bin(.tar.gz|.zip)
BUILD_ROOT/framework/modules/geronimo-plugin/target/test-resources/ArchiverGBeanTest/server1/bar-1.0-bin(.tar.gz|.zip)
</pre>
</div></div>


<h2 id="BuildingApacheGeronimo-TestingtheAssembly">Testing the Assembly</h2>

<h3 id="BuildingApacheGeronimo-usingthegeronimo-maven-plugin">using the geronimo-maven-plugin</h3>

<p>Once you have build the server fully, which will produce a number of <code>zip</code> and <code>tar.gz</code> archives from the assembly modules, you can use the <code>geronimo-maven-plugin</code> to start the server.  From the project root directory run:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn -Ptools geronimo:start
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows Tip</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Windows users may need to specify an alternative <code>installDirectory</code> to avoid long path problems:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn -Ptools geronimo:start -DinstallDirectory=c:\g
</pre>
</div></div></div></div>
<p>And to stop, either <code>CTRL-C</code> or from a separate terminal, from the project root directory run:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn -Ptools geronimo:stop
</pre>
</div></div>

<h3 id="BuildingApacheGeronimo-orbyhand">or by hand</h3>

<p>cd assemblies/geronimo/jetty6-javaee5/target<br clear="none">
tar xzf geronimo-jetty6-javaee5-&lt;version&gt;-bin.tar.gz<br clear="none">
./geronimo-jetty-javaee5-&lt;version&gt;/bin/gsh geronimo/start-server</p>

<h2 id="BuildingApacheGeronimo-IDESetup">IDE Setup</h2>

<p>The server project does not have any IDE files checked in since major IDEs have better support for maven than maven for them.</p>

<h3 id="BuildingApacheGeronimo-IntellijIDEA">Intellij IDEA</h3>

<p>For the IDEA 8.1 and later:<br clear="none">
The project is too large to easily open at once in IDEA. Generally the framework project and individual plugins are a good size to work with. In the maven projects tab, check the it profile to get more of the maven projects.</p>

<h3 id="BuildingApacheGeronimo-Eclipse">Eclipse</h3>

<p>Use the maven2 eclipse:eclipse plugin.  See <a shape="rect" href="developing-geronimo-in-eclipse.html">Developing Geronimo in Eclipse</a> for detailed instructions. As for IDEA, opening framework or individual plugins is more likely to work than trying to open the whole project.</p>

<h2 id="BuildingApacheGeronimo-Troubleshooting">Troubleshooting</h2>

<h3 id="BuildingApacheGeronimo-Buildwasnotabletodownloadandinstallartifacts">Build was not able to download and install artifacts</h3>
<p>If for some reason maven is unable to download and install an artifact, and the build stops with an error complaining of such, you will need to manually download the archive and install it in your local maven repository. You can do that with a maven command similar to this:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn install:install-file
    -DgroupId=org.apache.geronimo.framework
    -DartifactId=geronimo-kernel
    -Dversion=jar
    -Dpackaging=3.0-20110608.081951-139
    -Dfile=/path/to/file-artifact.jar
</pre>
</div></div>

<p>Maven can download and install dependencies for you:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn dependency:get
    -DrepoUrl=https://repository.apache.org/content/groups/snapshots/
    -Dartifact="org.apache.geronimo.framework:geronimo-kernel:jar:3.0-20110608.081951-139"
</pre>
</div></div>

<p>You will need to figure out which repository the artifact is available from. Look in the <code>BUILD_ROOT/pom.xml</code> file within the <code>&lt;repositories&gt;</code> tag to see the primary repositories utilized. You can also review the build output to see where maven attempted to download the artifact from.</p>

<h3 id="BuildingApacheGeronimo-OverridinglibrariesprovidedbyJVMatcompiletime">Overriding libraries provided by JVM at compile time</h3>
<p>In some cases, Java EE 6 requires newer library versions then what is provided by Java SE 6. For example, EE 6 requires annotations 1.1 api but SE 6 provides annotation 1.0 api. So it is necessary that during a build we override the JVM provided libraries with newer versions.</p>

<p>You can use <code>geronimo-property-plugin</code> in the pom.xml file of artifacts to set _<em>bootClassPath</em>_ property which is used by <code>maven-compiler-plugin</code> and <code>maven-surefire-plugin</code> as followed. The <code>geronimo-property-plugin</code> executes in the <strong>validate</strong> phase and sets _<em>bootClassPath</em>_ system property. The value of _<em>bootClassPath</em>_ property is set to _<em><strong>-Xbootclasspath/p:&lt;path&gt;&lt;pathSeparator&gt;&lt;path&gt;...</strong></em>_ string where each <strong>&lt;path&gt;</strong> is the jar file to place in the front of boot classpath.</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>pom.xml</b></div><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
...
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.geronimo.buildsupport&lt;/groupId&gt;
                &lt;artifactId&gt;geronimo-property-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;propertyName&gt;bootClassPath&lt;/propertyName&gt;
                    &lt;propertyValuePrefix&gt;-Xbootclasspath/p:&lt;/propertyValuePrefix&gt;
                    &lt;classpath&gt;
                        &lt;dependency&gt;
                            &lt;groupId&gt;org.apache.geronimo.specs&lt;/groupId&gt;
                            &lt;artifactId&gt;geronimo-annotation_1.1_spec&lt;/artifactId&gt;
                            &lt;version&gt;1.0.1&lt;/version&gt;
                        &lt;/dependency&gt;
                        &lt;dependency&gt;
                            &lt;groupId&gt;org.apache.geronimo.specs&lt;/groupId&gt;
                            &lt;artifactId&gt;geronimo-jaxws_2.2_spec&lt;/artifactId&gt;
                            &lt;version&gt;${geronimojaxws.version}&lt;/version&gt;
                        &lt;/dependency&gt;
                    &lt;/classpath&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;compilerArgument&gt;${bootClassPath}&lt;/compilerArgument&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;argLine&gt;${bootClassPath}&lt;/argLine&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
...
]]></script>
</div></div>

<p>Meanwhile, you can use <em>listFiles</em> options so that the <strong>set</strong> property of <code>geronimo-property-plugins</code> could contain files or directories. For example, if you want the <code>geronimo-property-plugins</code> to set "-Djava.endorsed.dirs" property, then configure the plugin with:</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
&lt;propertyValuePrefix&gt;-Djava.endorsed.dirs=&lt;/propertyValuePrefix&gt;
&lt;listFiles&gt;false&lt;/listFiles&gt;
]]></script>
</div></div>
<p>If you want the plugin to set "-Xbootclasspath/p:" property configure the plugin with:</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
&lt;propertyValuePrefix&gt;-Xbootclasspath/p:&lt;/propertyValuePrefix&gt;
&lt;listFiles&gt;true&lt;/listFiles&gt;
]]></script>
</div></div>


<h3 id="BuildingApacheGeronimo-Buildcan'tfindxbeanjar">Build can't find xbean jar</h3>
<p><strong><span style="text-decoration: underline;">Apache Geronimo 2.0</span></strong><br clear="none">
If you're building the 2.0 branch and the build fails because it can't find an xbean jar (for example org.apache.xbean:xbean-naming:jar:3.2-r579367), then add the</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>http://svn.apache.org/repos/asf/openejb/repo/
</pre>
</div></div>
<p>repository to the <code>pom.xml</code> file in the root of the source tree.  See <a shape="rect" class="external-link" href="http://mail-archives.apache.org/mod_mbox/geronimo-dev/200710.mbox/%3cAC0FF32B-74DD-4BF1-ADD3-635559FEFB75@hogstrom.org%3e">this message</a> for more details.</p></div>
        </div>

        
      </div>
    </div>

    <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tr>
          <td align="left" valign="middle" class="footer">
            &nbsp;&nbsp;
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="Delicious" />
            <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">Bookmark this on Delicious</a>
            &nbsp;&nbsp;
            <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="Digg!" />
            <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)+'&amp;topic=programming');">Digg this</a>
            <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo Development : Building Apache Geronimo';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
            &nbsp;&nbsp;
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;-&nbsp;&nbsp;
            Copyright &#169; 2003-2011, The Apache Software Foundation, Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0.</a>&nbsp;&nbsp;
          </td>
        </tr>
    </table> 

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-4380560-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  </body>
</html>
