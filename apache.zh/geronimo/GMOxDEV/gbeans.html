<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link type="text/css" rel="stylesheet" href="http://geronimo.apache.org/style/default.css">
    <LINK rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <META name="Description" content="GBeans" />
    <META name="Keywords" content="Apache Geronimo development documentation GBeans" />
    <META name="Owner" content="dev@geronimo.apache.org" />
    <META name="Robots" content="index, follow" />
    <META name="Security" content="Public" />
    <META name="Source" content="wiki template" />
    <META name="DC.Date" scheme="iso8601" content="2009-01-06" />
    <META name="DC.Language" scheme="rfc1766" content="en" />
    <META name="DC.Rights" content="Copyright Â© 2003-2011, The Apache Software Foundation" />
    <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo Development : GBeans</title>

  </head>

  <body onload="init()">

    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tr>
        <td valing="top" align="left">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </table>

    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" align="left" nowrap>
          <a href="/geronimo"> Home</a> >&nbsp;<a href="index.html">Index</a>&nbsp;&gt;&nbsp;<a href="gbeans.html">GBeans</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8" />
            <input type="hidden" name="oe" value="UTF-8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
        </td>
      </tr> 
    </table>

    <div id="PageContent">
      <div class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div style="margin: 0px 10px 0px 10px" class="smalltext">Apache Geronimo Development</div>
        <div style="margin: 0px 10px 8px 10px"  class="pagetitle">GBeans</div>

        <div class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
<!-- -->         
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=13453">
            <img src="http://geronimo.apache.org/images/icons/notep_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Edit Page"></a>
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=13453">Edit Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV">
            <img src="http://geronimo.apache.org/images/icons/browse_space.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Browse Space"></a>
            <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV">Browse Space</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=13453">
            <img src="http://geronimo.apache.org/images/icons/add_page_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add Page"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=13453">Add Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=13453">
            <img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add News"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=13453">Add News</a>
<!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><div class="confluence-information-macro confluence-information-macro-warning"><p class="title">Stale Content</p><span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>The content of this page is growing stale and may or may not contain relevant, useful or correct information.</p></div></div>

<h1 id="GBeans-Overview">Overview</h1>

<p>A GBeanMBean is a J2EE Management Managed Object, and is standard base for Geronimo services. GBean is a class or object that Geronimo the container can manage the lifecycle of. So, for example, when you deploy parts into a container you want to start them and stop them, and they have dependencies: Such as 'Bean A' can only start up when 'Bean B' is ready to go because 'Bean B' provides services that 'Bean A' needs. So, GBeans are Geronimo's way of packaging up things are that need to be managed, and can express dependencies. The GBeans architecture lies at the heart of Geronimo's power to enable developers to move or work with their existing J2EE assets, whether Open Source or commercial.  </p>

<p>GBeans are designed to let you take things you have, put a GBean wrapper around them, and use that to bridge the JSR 77 lifecycle requirements which GBeans support). You can take anything lying around and get it to work with GBeans. In addition, the GBeans will let developers bring other existing Open Source Java projects into the Geronimo orbit.  </p>

<p>This wraps one or more target POJOs and exposes the attributes and operations according to a supplied <a shape="rect" class="unresolved" href="#">GBeanInfo</a> instance.  The GBeanMBean also supports caching of attribute values and invocation results which can reduce the number of calls to a target. </p>

<ul><li>Gbeans are way of providing managements services to Geronimo</li><li>It is implemented on top of the JMX right now but supposes to be independent of JMX. User should be able to use them without knowledge of the JMX. And it can be make independent of GBeans .</li><li>The GBean can be converted into the MBean using the GBeanMBean and use the JMX to give the services</li></ul>


<h1 id="GBeans-SampleGBeans">Sample GBeans</h1>

<p>Grab the source code and search for the implementators of the GBeanLifecycle. It is a good way to find GBeans examples. It's been found that the jetty module and the GBeanTest class are quite helpful. </p>

<p><strong>TODO</strong>: Add the fully qualified class names </p>

<h1 id="GBeans-HowtowriteGBean">How to write GBean</h1>

<ul><li>A GBean may implement the optional org.apache.geronimo.gbean.GBeanLifecycle interface. When a GBean implements this interface, the implementation will get lifecycle callbacks.</li><li>They can have attributes with getters and setters. There are attributes that are final and I think they are standard .. (What is the list of them) e.g. name, Kernel (they can use to get hold of the system info, have a look at the sample GBeans.) There are ordinary attributes .. have getters and setters</li><li>GBeans can have methods ..</li><li>A GBean's constructor <em><strong>MUST NOT</strong></em> call its own member functions which are declared in its G<a shape="rect" class="unresolved" href="#">BeanInfo</a>!!!</li><li>A GBean MUST implement a method having the following signature:
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>public static GBeanInfo getGBeanInfo()
</pre>
</div></div></li></ul>



<p>This method provides meta-data about the attributes, operations and references exposed or used by the GBean. It is standard practice (a Geronimo pattern) to initialize this meta-data in a static block initializer. The following block depicts such an approach:  </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>public static final GBeanInfo GBEAN_INFO;

static {
    GBeanInfoBuilder infoBuilder = new GBeanInfoBuilder("AxisGbean", AxisGbean.class);
    infoBuilder.addAttribute("name", String.class, true);
    infoBuilder.addAttribute("kernel", Kernel.class, false);
    infoBuilder.addOperation("echo", new Class[]{String.class});
    infoBuilder.setConstructor(new String[] {"kernel","Name"});
    GBEAN_INFO = infoBuilder.getBeanInfo();
}
</pre>
</div></div></li></ul>



<p>Attributes and references MUST be compliant wit the following naming conventions: attributes MUST start with a lower case first character; and references must should start with an upper case first character. This simple naming convention should simplify the configuration of a GBean. </p>

<h2 id="GBeans-Step1:YourfirstsimpleGBean">Step 1: Your first simple GBean</h2>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>package example1;

import org.apache.geronimo.gbean.GBeanInfo;
import org.apache.geronimo.gbean.GBeanInfoBuilder;

public class MyGBean {

    public static final GBeanInfo GBEAN_INFO;

    static {
        GBeanInfoBuilder infoBuilder = new GBeanInfoBuilder("MyGBean", MyGBean.class);

        GBEAN_INFO = infoBuilder.getBeanInfo();
    }

    public static GBeanInfo getGBeanInfo() {
        return GBEAN_INFO;
    }
}
</pre>
</div></div></li></ul>



<p>Compile the class using the following command (<strong>TODO</strong>: create a maven task to compile a user's gbeans; simply find a better way). </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>$ javac -classpath &lt;geronimo_home&gt;/assembly/target/geronimo-1.0-SNAPSHOT/lib/geronimo-kernel-1.0-SNAPSHOT.jar example1/MyGBean.java
</pre>
</div></div></li></ul>



<p><strong>TODO</strong>: Change what follows in this section (temporarily useful) </p>

<p>Create a jar with the gbean class and place it into &lt;geronimo_home&gt;/assembly/target/geronimo-1.0-SNAPSHOT/repository/example1. </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>$ jar -Mcvf mygbean.jar example1/*.class
$ mkdir &lt;geronimo_home&gt;/assembly/target/repository
$ cp mygbean.jar &lt;geronimo_home&gt;/assembly/target/repository
</pre>
</div></div></li></ul>



<h1 id="GBeans-HowtodeployGBean">How to deploy GBean</h1>

<p>Deploying a GBean onto Geronimo requires to create a specialised Geronimo plan (aka configuration). It's similar to J2EE deployment descriptors as it also describes what it looks like and what references to other GBean it must have started before it starts up. </p>

<p>The plan has to conform to <em>schema/geronimo-config.xsd</em> (in the repo it's in <em>modules/deployment/src/schema/geronimo-config.xsd</em>) </p>

<p>Here is a part of the deployment descriptor for the gbeans already available in the binary distribution of Geronimo (it's <em>modules/assembly/src/plan/j2ee-server-plan.xml</em> in the repo).  It looks really scary if this is your first time seeing one.  Down below we have a simple one that we'll use for your GBean. </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>    &lt;gbean name="openejb:type=ContainerIndex" class="org.openejb.ContainerIndex"&gt;
        &lt;references name="EJBContainers"&gt;
            &lt;pattern&gt;geronimo.server:j2eeType=StatelessSessionBean,*&lt;/pattern&gt;
            &lt;pattern&gt;geronimo.server:j2eeType=StatefulSessionBean,*&lt;/pattern&gt;
            &lt;pattern&gt;geronimo.server:j2eeType=EntityBean,*&lt;/pattern&gt;
        &lt;/references&gt;
    &lt;/gbean&gt;

    &lt;!-- EJB Protocol --&gt;
    &lt;gbean name="openejb:type=SocketService,name=EJB" class="org.openejb.server.SimpleSocketService"&gt;
        &lt;attribute name="serviceClassName" type="java.lang.String"&gt;org.openejb.server.ejbd.EjbServer&lt;/attribute&gt;
        &lt;attribute name="onlyFrom" type="java.net.InetAddress[]"&gt;127.0.0.1&lt;/attribute&gt;
        &lt;reference name="ContainerIndex"&gt;openejb:type=ContainerIndex&lt;/reference&gt;
    &lt;/gbean&gt;
    &lt;gbean name="openejb:type=ServiceDaemon,name=EJB" class="org.openejb.server.ServiceDaemon"&gt;
        &lt;attribute name="port" type="int"&gt;4201&lt;/attribute&gt;
        &lt;attribute name="inetAddress" type="java.net.InetAddress"&gt;127.0.0.1&lt;/attribute&gt;
        &lt;reference name="SocketService"&gt;openejb:type=SocketService,name=EJB&lt;/reference&gt;
    &lt;/gbean&gt;

    &lt;!-- JSR77 Management Objects --&gt;
    &lt;gbean name="geronimo.server:j2eeType=J2EEDomain,name=geronimo.server" class="org.apache.geronimo.j2ee.management.impl.J2EEDomainImpl"/&gt;
    &lt;gbean name="geronimo.server:j2eeType=J2EEServer,name=geronimo" class="org.apache.geronimo.j2ee.management.impl.J2EEServerImpl"&gt;
        &lt;reference name="ServerInfo"&gt;geronimo.system:role=ServerInfo&lt;/reference&gt;
    &lt;/gbean&gt;
    &lt;gbean name="geronimo.server:j2eeType=JVM,J2EEServer=geronimo" class="org.apache.geronimo.j2ee.management.impl.JVMImpl"/&gt;

    &lt;!-- JMX Remoting --&gt;
    &lt;gbean name="geronimo.server:role=JMXService,name=localhost" class="org.apache.geronimo.jmxremoting.JMXConnector"&gt;
        &lt;attribute name="URL" type="java.lang.String"&gt;service:jmx:rmi://localhost/jndi/rmi:/JMXConnector&lt;/attribute&gt;
        &lt;attribute name="applicationConfigName" type="java.lang.String"&gt;JMX&lt;/attribute&gt;
    &lt;/gbean&gt;
</pre>
</div></div></li></ul>



<p>See also <strong>BROKEN INTERWIKI LINK to wiki:Deployment#head-5cbd584046863bc7b753e57e8681a98a87f36f0f (label = Service configuration and deployment)</strong>. </p>

<p><strong>TODO</strong>: Describe what these elements mean (here or even better in xsd) </p>

<p>So that was scary.  The next section describes the deployment plan necessary for your GBean.  It's really not so bad... </p>

<h2 id="GBeans-Step2:Yourfirstdeploymentplan">Step 2: Your first deployment plan</h2>

<p>Here's the plan of your first simple GBean - MyGBean. The gbean doesn't expose any attributes or have references to other GBean. </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;configuration
    xmlns="http://geronimo.apache.org/xml/ns/deployment"
    configId="example1/MyGBean"
    &gt;

    &lt;dependency&gt;
        &lt;uri&gt;mygbean.jar&lt;/uri&gt;
    &lt;/dependency&gt;

    &lt;gbean name="geronimo.example:name=My first simple GBean" class="example1.MyGBean" /&gt;

&lt;/configuration&gt;
</pre>
</div></div></li></ul>



<p>There are two ways to deploy the GBean to your server, the so-called "offline" mode for when your server isn't running, and the "online" mode, when it is.  Both are outlined below.  Deploying the gbean requires to execute <em>Geronimo Deployer</em>. It boils down to executing an executable jar <em>bin/deployer.jar</em>. </p>

<h3 id="GBeans-OfflineDeployment">Offline Deployment</h3>

<p>When the Geronimo server isn't running, it's possible to add a GBean to it's configuration, and then start the GBean later when the server is running.   </p>

<p>First, 'distribute' the GBean to the server : </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>java -jar bin/deployer.jar distribute mygbean-plan.xml
</pre>
</div></div></li></ul>



<p>This will do all the necessary things to get the GBean to the server, but the GBean won't be running when the server starts.  </p>

<p>Now, start the server : </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>java -jar bin/server.jar
</pre>
</div></div></li></ul>



<p>And when that is complete, start your GBean : </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>java -jar bin/deployer.jar start example1/MyGBean
Username: system
Password: manager
</pre>
</div></div></li></ul>



<p>You'll be prompted for the username and password in order to start the GBean, as shown above.  Use the values shown above. </p>

<p>Note that unless you start the server "in the background", you'll need another command prompt to start your GBean.  </p>

<p>After starting, you should see the following in your server log : </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>11:43:11,652 INFO  [ConfigurationManagerImpl] Loaded Configuration geronimo.config:name="example1/MyGBean"
11:43:11,717 INFO  [Configuration] Started configuration example1/MyGBean
</pre>
</div></div></li></ul>



<h3 id="GBeans-OnlineDeployment">Online Deployment</h3>

<p>When you already have a server running, you can distribute and start the GBean in one step : </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>java -jar bin/deployer.jar deploy  mygbean-plan.xml
Username: system
Password: manager
</pre>
</div></div></li></ul>



<p>And you'll see a slightly different message in the log. </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>11:44:25,340 INFO  [LocalConfigStore:config-store] Installed configuration example1/MyGBean in location 19
11:44:25,432 INFO  [ConfigurationManagerImpl] Loaded Configuration geronimo.config:name="example1/MyGBean"
11:44:25,446 INFO  [Configuration] Started configuration example1/MyGBean
</pre>
</div></div></li></ul>



<h1 id="GBeans-HowtorunGBean">How to run GBean</h1>

<h2 id="GBeans-Step3:YourfirstGBeaninaction">Step 3: Your first GBean in action</h2>

<p>Once the deployment completes, start the following command from the Geronimo home directory: </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>java -jar bin/server.jar example1/MyGBean
</pre>
</div></div></li></ul>



<p>You should see the following output on the console: </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>$ java -jar bin/server.jar example1/MyGBean
15:29:42,376 WARN  [ToolsJarHack] Could not all find java compiler: lib\tools.jar file not found in C:\Program Files\Jav
a\j2re1.4.2_05 or C:\Program Files\Java
15:29:42,386 INFO  [Daemon] Server startup begun
15:29:43,230 INFO  [Kernel] Starting boot
15:29:43,612 INFO  [MBeanServerFactory] Created MBeanServer with ID: 17ce4e7:ff076f1f39:-8000:JLASKOWSKI:1
15:29:43,833 INFO  [Kernel] Booted
15:29:43,963 INFO  [ConfigurationManagerImpl] Loaded Configuration geronimo.config:name="org/apache/geronimo/System"
15:29:44,586 INFO  [Configuration] Started configuration org/apache/geronimo/System
15:29:45,048 INFO  [RMIRegistryService] Started RMI Registry on port 1099
15:29:45,139 INFO  [ReadOnlyRepository] Repository root is file:/C:/projects/geronimo/trunk/modules/assembly/target/geronimo-1.0-SNAPSHOT/repository/
15:29:45,229 INFO  [ConfigurationManagerImpl] Loaded Configuration geronimo.config:name="MyGBean"
15:29:45,249 INFO  [Configuration] Started configuration MyGBean
15:29:45,249 INFO  [Daemon] Server startup completed
</pre>
</div></div></li></ul>



<p>The line <em>Loaded Configuration geronimo.config:name="MyGBean"</em> indicates that your first GBean is really deployed and running! Hurray! </p>

<p>You may also want to see some information about the gbean in the Geronimo Debug Console. Start the server with the following command: </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>java -jar bin/server.jar org/apache/geronimo/DebugConsole example1/MyGBean
</pre>
</div></div></li></ul>



<p>and open up <a shape="rect" class="external-link" href="http://localhost:8080/debug-tool/index.vm?ObjectNameFilter=*%3Aname%3D%22MyGBean%22&amp;MBeanName=geronimo.config%3Aname%3D%22MyGBean%22" rel="nofollow">http://localhost:8080/debug-tool/index.vm?ObjectNameFilter=*%3Aname%3D%22MyGBean%22&amp;MBeanName=geronimo.config%3Aname%3D%22MyGBean%22</a> in your browser. </p>

<p>And here is how to run the gbean programatically: </p>

<p>Having created a GBean like this to start/stop/set values/invoke operations and GBean service use code like follows </p>

<ul><li>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>name = new ObjectName("test:name=AxisGBean");
kernel = new Kernel("test.kernel", "test");
kernel.boot();
ClassLoader cl = getClass().getClassLoader();
ClassLoader myCl = new URLClassLoader(new URL[0], cl);
GBeanMBean gbean = new GBeanMBean(AxisGbean.getGBeanInfo(), myCl);
gbean.setAttribute("name", "Test");

kernel.loadGBean(name, gbean);
Kernel.startGBean(name);
System.out.println(kernel.getMBeanServer().getAttribute(name, "state"));
System.out.println(kernel.getMBeanServer().invoke(name, "echo", new
Object[]{"Hello"}, new String[]{String.class.getName()}));

kernel.stopGBean(name);
kernel.unloadGBean(name)
</pre>
</div></div></li></ul>



<h1 id="GBeans-Otherquestionstobeansweredlater">Other questions to be answered later</h1>

<p>If you feel you can answer some of the questions please do so! </p>

<h2 id="GBeans-WhatisGBeanMetaData?">What is GBean Meta Data?</h2>

<h2 id="GBeans-WhatdoestheGBeanInfoclassrepresent?">What does the GBeanInfo class represent?</h2>

<h2 id="GBeans-CanIconfiguremyGBeanusingaflatfile?">Can I configure my GBean using a flat file?</h2>

<h2 id="GBeans-HowdoImanagetheattributesofmyGBeanremotely?">How do I manage the attributes of my GBean remotely?</h2>

<p>GBeans are exposed as MBeans via the JMX kernel. Hence, it is possible to control/query them as we would have control &#195;&#8218;"standard&#195;&#8218;" MBeans. </p>

<p>For instance, to manage a given MBean remotely, it is possible to leverage the Java Management Extensions Remote API(JSR 160), which is supported by Geronimo. </p>

<p>More accurately, two services need to be up and running in order to enable the RMI Connector defined by JSR 160 on the server-side: </p>

<ul><li><em>org.apache.geronimo.system.RMI<a shape="rect" class="unresolved" href="#">RegistryService</a></em>: starts a RMI registry on the specified port. This service is part of the "system" plan, in other words it is always started; and</li><li><em>org.apache.geronimo.jmxremoting.JMXConnector</em>: it creates a RMI Connector server and exports it to the RMI registry embedded in its URL (see JSR 160 for more details about the format of the URL).  You can have a look to the <em>j2ee-server</em> plan for more details on its GBean definition.</li></ul>


<p>If the two above services are running, then the following snippet will get you an <em>M<a shape="rect" class="unresolved" href="#">BeanServerConnection</a></em>: </p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>        Map environment = new HashMap();
        String[] credentials = new String[]{&lt;username&gt;, &lt;password&gt;};
        environment.put(JMXConnector.CREDENTIALS, credentials);

        JMXServiceURL address = new JMXServiceURL(&lt;URI defined by the JMXConnector  service&gt;);
        JMXConnector jmxConnector = JMXConnectorFactory.connect(address, environment);
        MBeanServerConnection mbServerConnection = jmxConnector.getMBeanServerConnection();
</pre>
</div></div>

<p>Note: <em>username</em> and <em>password</em> must be defined by the <em>org.apache.geronimo.security.jaas.<a shape="rect" class="unresolved" href="#">ConfigurationEntry</a></em> having the name defined by the <em>applicationConfigName</em> attribute of the <em>org.apache.geronimo.jmxremoting.JMXConnector</em> service. </p>

<p>Having said that, if you do not want to write code, you can also use a JMX console supporting JSR 160. </p>

<h2 id="GBeans-HowdoIcallmethodsonaGBeandeployedintheserverfromaJ2EEApp?">How do I call methods on a GBean deployed in the server from a J2EE App?</h2>

<p>First get a handle to the kernel by calling <a shape="rect" class="unresolved" href="#">KernelRegistry</a>.getSingleKernel() and then use the invoke methods in the Kernel interface. eg: </p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>        ObjectName obj = new ObjectName("geronimo.example:name=EchoServer");
        Kernel kernel = KernelRegistry.getSingleKernel();
        String outputs=(String)kernel.invoke(obj,"hello");
</pre>
</div></div>

<p>where hello() is a method on the GBean. This will work provided that the GBean is running in the same server instance where the J2EE application is deployed.  </p>

<h1 id="GBeans-ArticleaboutGBeans">Article about GBeans</h1>

<p><a shape="rect" class="external-link" href="http://wiki.apache.org/geronimo/GBeansArticle1">Geronimo GBeans Architecture</a> </p></div>
        </div>

                  <div class="tabletitle">
            Children
            <span class="smalltext" id="show" style="display: inline;">
              <a href="javascript:showChildren()">Show Children</a></span>
            <span class="smalltext" id="hide" style="display: none;">
              <a href="javascript:hideChildren()">Hide Children</a></span>
          </div>
          <div class="greybox" id="children" style="display: none;">
                                      <a href="https://cwiki.apache.org/confluence/display/GMOxDEV/GBean+Annotations" title="GBean Annotations">GBean Annotations</a>
              <span class="smalltext">(Apache Geronimo Development)</span>
              <br>
                      </div>
        
      </div>
    </div>

    <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tr>
          <td align="left" valign="middle" class="footer">
            &nbsp;&nbsp;
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="Delicious" />
            <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">Bookmark this on Delicious</a>
            &nbsp;&nbsp;
            <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="Digg!" />
            <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)+'&amp;topic=programming');">Digg this</a>
            <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo Development : GBeans';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
            &nbsp;&nbsp;
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;-&nbsp;&nbsp;
            Copyright &#169; 2003-2011, The Apache Software Foundation, Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0.</a>&nbsp;&nbsp;
          </td>
        </tr>
    </table> 

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-4380560-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  </body>
</html>
