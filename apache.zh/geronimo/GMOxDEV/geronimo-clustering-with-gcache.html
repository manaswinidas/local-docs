<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=0">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="Geronimo Clustering with Gcache">
    <meta name="Keywords" content="Apache Geronimo development documentation Geronimo Clustering with Gcache">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2009-01-06">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2011, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo开发：使用Gcache的Geronimo集群</title>

  </head>

  <body  onload="init()">

    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">主页</a> > <a href="index.html">索引</a> > <a href="clustering.html">集群</a> > <a href="geronimo-clustering-with-gcache.html">使用Gcache的Geronimo集群</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo开发</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">使用Gcache的Geronimo集群</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=31368"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=31368">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=31368"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=31368">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=31368"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=31368">新增新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>
<h1 id="GeronimoClusteringwithGcache-GeronimoClusteringwithGcache">使用Gcache的Geronimo集群</h1>


<h2 id="GeronimoClusteringwithGcache-Overview">总览</h2>

<p>Gcache提供了适用于许多不同用途的通用缓存框架。本文探讨了将Gcache用作Geronimo总体群集解决方案的一部分。</p>

<h2 id="GeronimoClusteringwithGcache-Background-ClusteringConcepts">背景-群集概念</h2>

<p>这是基本群集概念的快速描述：</p>
<ul><li>负载平衡器-在可用群集成员之间分配客户端请求的软件/硬件</li><li>会话-与可以跨越多个请求的特定客户端相关联的服务器端状态数据</li><li>状态复制-一种在集群中保留会话状态的机制</li><li>故障转移-一种机制，允许一个集群成员恢复发生故障的集群成员的会话状态，并继续进行而不会中断最终用户</li><li>会话关联性（又称“粘性会话”）-一种机制，允许将针对同一会话的多个请求路由到同一群集成员。</li><li>群集成员发现-自动将群集成员添加到群集的方法</li><li>心跳信号-一种机制，允许客户端/服务器跟踪彼此的可用性</li><li>服务器场-跨集群热部署应用程序</li></ul>


<h2 id="GeronimoClusteringwithGcache-GcacheScope">Gcache范围</h2>
<p>Gcache是一种通用缓存技术，可以在多种环境中使用。尽管从Geronimo集群的角度来看，Gcache将提供状态复制，集群成员发现和心跳。请注意，可以将其他技术与Gcache结合使用，以支持上述列表中的许多其他群集概念。下面的“ Geronimo群集设置”部分将提供有关设置整个群集环境的更多详细信息。</p>

<p>Gcache开发按以下优先级进行：<br clear="none">1）集群EJB工件（即有状态会话Bean和实体Bean）<br clear="none">2）httpsessions的Web层集群</p>

<p>Geronimo的初始Gcache实现提供了复制的缓存，该复制的缓存为状态数据提供了冗余。</p>

<h2 id="GeronimoClusteringwithGcache-ClusterMemberdiscoveryandheartbeat">集群成员发现和心跳</h2>

<p>下图说明了群集成员发现过程以及心跳机制。</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="geronimo-clustering-with-gcache.data/discovery1.jpg"></span></p>

<h4 id="GeronimoClusteringwithGcache-Discovery/HeartbeatDescription">发现/心跳说明</h4>

<p>在此示例中，Gcache服务器由单个主进程和单个从属进程组成。注意拓扑<br clear="none">因为Gcache服务器非常灵活，并且允许Gcache服务器存在于同一物理机和JVM中<br clear="none">作为客户端，也可以是不同机器上的单独进程。在此示例中，我们假设<br clear="none">Gcache服务器是另一台计算机上的单独Java进程。</p>

<p>每个Gcache服务器在一个预先配置的多播地址上广播其可用性。</p>

<p>可选地，Gcache服务器还可以发送一个预配置的序数值，该值表示集群中Gcache服务器的相对优先级。</p>

<p>每个客户端（在本例中为Geronimo服务器）都侦听这些广播，并跟踪可用的Gcache服务器<br clear="none">以及确定当前的Master（最低序数）。请注意，也可以在每个客户端（Geronimo服务器）中预先配置Gcache服务器顺序。</p>

<p>当客户端（Geronimo服务器）首次到达网络时，它将确定谁是Gcache主服务器，并通过Gcache服务器对其进行身份验证。</p>

<h2 id="GeronimoClusteringwithGcache-StateDatareplication">状态数据复制</h2>

<p>每当集群成员需要保存状态数据（即会话数据）时，它就会与GCcache主服务器进行通信<br clear="none">以保存它的状态。可以通过可插入的GCache Client API在geronimo服务器中提供此通信。<br clear="none">每当需要保存状态数据时就可以利用该功能。 <add more="" details="" on="" pluggable="" session="" manager="" here="">。</add></p>

<p>下图显示了与在复制的Gcache服务器中保存状态数据相关的基本数据流。</p>

<p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="geronimo-clustering-with-gcache.data/replication1.jpg"></span></p>

<h4 id="GeronimoClusteringwithGcache-StateDatareplicationdescription">状态数据复制说明</h4>

<p>当geronimo服务器决定需要保存会话状态时，它将调用GCache客户端API。<br clear="none">它将状态数据发送到Gcache主机。为了增加冗余，Gcache主服务器将复制<br clear="none">这种状态交给Gcache的奴隶。请注意，可以有选择地配置Gcache服务器以发送确认信息<br clear="none">所有数据传输。</p>

<p>另外，Gcache主服务器可以选择将复制的数据发送到集群中的其他Geronimo服务器。<br clear="none">对于不具有会话亲缘关系的群集，这允许状态数据在任何情况下立即可用<br clear="none">可能会获得下一个请求的geronimo服务器。但是，这也有缺点<br clear="none">由于每个群集，将更多数据发送到网络上，并增加每个群集成员的内存使用量<br clear="none">成员将包含集群中的所有sesson。</p>

<p>对于可以保证会话亲和性的群集，可以关闭状态数据到另一个的传输。<br clear="none">Geronimo服务器只将状态数据保留在Gcache中。该解决方案将减少流量并<br clear="none">规模可能会更好。如果集群成员失败，则与该集群成员关联的会话<br clear="none">将故障转移到另一个群集成员。新的集群成员将能够检索必要的<br clear="none">来自Gcache的会话数据。</p>

<h2 id="GeronimoClusteringwithGcache-GeronimoClusteringSetup">Geronimo集群设置</h2>
<p>在此处添加详细的设置说明</p>

<ul><li>安装Gcache插件</li><li>配置Gcache设置</li><li>将集群成员添加到集群</li><li>安装应用程序</li><li>SLSB（获取初始上下文，设置负载平衡/故障转移等）</li><li>Web层（配置mod-jk，设置负载平衡/故障转移，配置粘性会话等）</li></ul>


<h2 id="GeronimoClusteringwithGcache-TestingReplicationandfailover">测试复制和故障转移</h2>
<p>在此处添加具体步骤。</p>


<h2 id="GeronimoClusteringwithGcache-GcacheImplementationdetails">Gcache实施细节</h2>
<p>在此处添加详细信息。</p>
<ul><li>字节数据仅通过电线（不是对象）</li><li>会话管理器插件</li><li>基础技术</li><li>ehCache</li><li>认证方式</li><li>米娜</li></ul>


<h2 id="GeronimoClusteringwithGcache-AuthorIssues/Questions/Concerns">作者问题/疑问/疑虑</h2>
<ul><li>将nodeid添加到会话cookie，以便modjk可以提供粘性会话？</li></ul>

</div>
        </div>

        
      </div>
    </div>

    <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo Development : Geronimo Clustering with Gcache';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2011，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-4380560-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  

</body></html>