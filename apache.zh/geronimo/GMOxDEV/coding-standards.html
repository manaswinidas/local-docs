<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=1">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="Coding standards">
    <meta name="Keywords" content="Apache Geronimo development documentation Coding standards">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2009-01-06">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2011, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo开发：编码标准</title>

  </head>

  <body  onload="init()">

    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">首页</a> > <a href="index.html">索引</a> > <a href="coding-standards.html">编码标准</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo开发</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">编码标准</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=11743"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=11743">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=11743"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=11743">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=11743"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=11743">添加新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><h1 id="Codingstandards-CodingStandards">编码标准</h1>

<p>该页面描述了用于Apache Geronimo代码的标准（java，xml等）。与人类实际编写的代码相比，人类阅读代码的频率更高，这使代码具有阅读的乐趣。</p>

<p>在此文档中，您将找到：</p>
<style type="text/css">/*<![CDATA[*/
div.rbtoc1435452705900 {padding: 0px;}
div.rbtoc1435452705900 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1435452705900 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class="toc-macro rbtoc1435452705900">
<ul class="toc-indentation"><li><a shape="rect" href="#Codingstandards-Indentation">缩进</a>
<ul class="toc-indentation"><li><a shape="rect" href="#Codingstandards-Java">爪哇</a></li><li><a shape="rect" href="#Codingstandards-XML">XML格式</a></li></ul>
</li><li><a shape="rect" href="#Codingstandards-Interfaces">介面</a></li><li><a shape="rect" href="#Codingstandards-Exceptions">例外情况</a></li><li><a shape="rect" href="#Codingstandards-PackageNaming">包命名</a></li><li><a shape="rect" href="#Codingstandards-Imports">进口货</a>
<ul class="toc-indentation"><li><a shape="rect" href="#Codingstandards-IDEAuto-Formatting">IDE自动格式化</a></li></ul>
</li><li><a shape="rect" href="#Codingstandards-JavaDocTags">JavaDoc标签</a></li><li><a shape="rect" href="#Codingstandards-UnitTestCases">单元测试用例</a></li><li><a shape="rect" href="#Codingstandards-Logging">记录中</a>
<ul class="toc-indentation"><li><a shape="rect" href="#Codingstandards-Levels">等级</a></li><li><a shape="rect" href="#Codingstandards-Example">例</a></li></ul>
</li><li><a shape="rect" href="#Codingstandards-AbbreviationsandAcronymsinmethods/classes/interfaces'names">方法/类/接口名称中的缩写和首字母缩写</a></li><li><a shape="rect" href="#Codingstandards-GBeanattributeandreferencenamingconvention">GBean属性和引用命名约定</a></li></ul>
</div>

<p>另外，请查看Wiki，以获取有关<a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDEV/developing-geronimo-in-eclipse.html">在Eclipse</a>和<a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDEV/subversion-client-configuration.html">Subversion客户端配置中</a> <a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDEV/developing-geronimo-in-eclipse.html">开发Geronimo的</a>详细信息。</p>

<h2 id="Codingstandards-Indentation">缩进</h2>

<h3 id="Codingstandards-Java">爪哇</h3>

<p>让我们遵循在Java中很常见的Sun编码标准规则。</p>

<p><a shape="rect" class="external-link" href="http://java.sun.com/docs/codeconv/" rel="nofollow">http://java.sun.com/docs/codeconv/</a></p>

<p><a shape="rect" class="external-link" href="http://java.sun.com/docs/codeconv/html/CodeConvTOC.doc.html" rel="nofollow">http://java.sun.com/docs/codeconv/html/CodeConvTOC.doc.html</a></p>

<ul><li>4个字符缩进</li><li>请<strong>没有标签</strong> ！</li></ul>


<p>正确的花括号样式：</p>
<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
public class Foo {
    public void foo(boolean a, int x, int y, int z) {
        do {
            try {
                if (x &gt; 0) {
                    int someVariable = a ?  x : y;
                } else if (x &lt; 0) {
                    int someVariable = (y + z);
                    someVariable = x = x + y;
                } else {
                    for (int i = 0; i &lt; 5; i++) {
                        doSomething(i);
                    }
                }

                switch (a) {
                    case 0:
                        doCase0();
                        break;
                    default:
                        doDefault();
                }
            } catch (Exception e) {
                processException(e.getMessage(), x + y, z, a);
            } finally {
                processFinally();
            }
        } while (true);

        if (2 &lt; 3) {
            return;
        }

        if (3 &lt; 4) {
            return;
        }

        do {
            x++
        } while (x &lt; 10000);

        while (x &lt; 50000) {
            x++;
        }

        for (int i = 0; i &lt; 5; i++) {
            System.out.println(i);
        }
    }

    private class InnerClass implements I1, I2 {
        public void bar() throws E1, E2 {
        }
    }
}
]]></script>
</div></div>

<h3 id="Codingstandards-XML">XML格式</h3>

<ul><li>使用4个字符。这是为了允许Eclipse等IDE使用统一的格式约定</li><li>请<strong>没有标签</strong> ！</li></ul>


<h2 id="Codingstandards-Interfaces">介面</h2>

<p>接口的所有方法都是公共抽象的，因此没有必要指定公共抽象修饰符。同样，所有字段都是public static final。</p>

<p>但是，此行为在大多数工具和IDE中效果最佳，并且似乎是常见的做法，因此我们认为没有理由禁止这种做法。例如：</p>

<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
public interface MyInterface {
    public static final int MY_INTEGER = 0;

    public abstract void doSomething();
}
]]></script>
</div></div>

<p>这具有附加的优点，即可以将接口转换为抽象类（并复制和粘贴单个定义），而无需进行任何更改。</p>

<p>最好在常量上添加public / static / final，在方法上添加public / abstract，但这不是强制性的。但是，如果有，请不要将其取出。</p>

<h2 id="Codingstandards-Exceptions">例外情况</h2>

<ul><li>如果程序无法通过合理的努力进行处理，则情况仅属例外。错误的输入数据应该是常规代码的预期情况，可以妥善处理。</li><li>异常处理的目的是将真正的错误处理与代码的常规部分分开，因此不要强迫调用者将其与不必要的异常混合。</li><li>仅当您的代码确实存在继续问题，例如，当参数无效时，才可以引发异常！</li><li>如果仅假设代码的调用者可能会有特殊结果的问题，请不要引发异常。尝试返回一个特殊的结果值，例如null，然后让调用者使用常规的if-else-statement进行决策。如果呼叫者确实有问题，他将自行抛出异常。</li><li>但是，如果您的代码引发异常，即使它没有任何实际问题，并且可以无例外地继续执行并返回特殊结果值，则您将阻止调用方的决定，无论特殊结果是否确实是错误。</li><li>如果抛出异常（在该异常中，调用方将确定调用方的上下文中没有错误），则可以强制调用方在其常规部分中编写异常处理程序或中止该异常，即，您强制调用方将常规代码与异常处理。这与意图异常处理相反。</li><li>错误的例子：<br clear="none">
<strong><code>java.lang.Class.forName(String) throws ClassNotFoundException</code></strong><br clear="none">在大多数程序/情况下，如果此方法找不到类，则会出错，因此会引发异常并阻止调用者的决定。<br clear="none">但是也许有一个程序应该检查类名列表，无论这些类是否存在。这样的程序被迫将其常规代码与对异常的错误处理混合在一起，在这种情况下根本就没有错误。<br clear="none">该方法应返回一个特殊的结果值：null。该方法的许多调用者已经预料到了这种情况，因此没有处于意外情况/异常状态。他们可以自行决定情况。</li><li>仅抛出检查的异常（不是从<code>RuntimeException</code> ），如果呼叫者有机会处理它。</li><li>通常，无法在运行时处理/修复信号出编程错误或系统故障的异常->未经检查的异常。</li><li>如果您的代码确实有继续执行的问题，例如，当参数无效时，引发未经检查的异常（源自<code>RuntimeException</code> ），请勿抛出受检查的异常，因为即使您的代码也无法处理该问题，在大多数情况下，调用方也没有机会处理该问题。相反，也许有人在最高层的某个地方抓住了所有人<code>RuntimeException</code> ，记录它们并继续常规服务。</li><li>仅当不可能干净地返回特殊结果值时，才使用已检查的异常来强制调用者确定情况。调用方应通过捕获和处理一个或多个已检查的异常（例如具有特殊结果值（？））来降低情况的恶化。或通过处理未经检查的异常升级，因为这种情况是错误，无法处理。</li><li>受检查的异常是接口的正式组成部分，因此请勿将受检查的异常从一个抽象层传播到另一抽象层，因为通常这会破坏较低的抽象。例如，不要将SQLException传播到另一层，因为SQLException是一个实现细节，将来可能会更改，并且此类更改不应影响接口及其调用者。</li><li>永不扔<code>NullPointerException</code>要么<code>RuntimeException</code> 。使用任一<code>IllegalArgumentException</code> ， 要么<code>NullArgumentException</code> （这是的子类<code>IllegalArgumentException</code>无论如何）。如果没有合适的子类来表示异常，请创建自己的子类。</li></ul>


<h2 id="Codingstandards-PackageNaming">包命名</h2>

<ul><li>软件包名称为小写。</li><li>程序包名称只能包含字母数字字符。</li><li>软件包名称应在定义它们的模块的名称后缀</li></ul>


<p>例如，如果模块名称为<em>common</em> ，则基本软件包名称应为<code>org.apache.geronimo.common</code> 。</p>

<p><strong>注意：</strong>这比<em>规则</em>更像是一个<em>准则</em> ，因为某些模块根本不能遵循此约定，但是在适用的情况下应该遵循。</p>

<h2 id="Codingstandards-Imports">进口货</h2>

<ul><li>应该完全合格，例如<code>import java.util.Vector</code>并不是<code>java.util.*</code></li><li>应该按字母顺序排序，并使用<em>java</em> ，然后首先列出<em>javax</em>软件包，然后再按软件包名称对其他软件包进行排序。</li></ul>


<h3 id="Codingstandards-IDEAuto-Formatting">IDE自动格式化</h3>

<ul><li>Eclipse用户可以</li><li>使用<code>Source -> Organise Imports</code>组织进口</li><li>使用<code>Source -> Format</code>格式化代码（请确保您使用的是空格而不是制表符。有关详细信息，请参见<a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDEV/developing-geronimo-in-eclipse.html#DevelopingGeronimoinEclipse-CodeFormatting">在Eclipse中开发Geronimo。</a></li><li>IntelliJ用户可以</li><li>使用<code>Tools -> Organise Imports</code>组织进口</li><li>使用<code>Tools -> Reformat code</code>格式化代码（使用IDE选项中的代码样式设置）</li></ul>


<h2 id="Codingstandards-JavaDocTags">JavaDoc标签</h2>

<p>@version应该是：<code>@version $Revision$ $Date$</code></p>

<p>@author完全不应在源代码中使用。</p>

<h2 id="Codingstandards-UnitTestCases">单元测试用例</h2>

<ul><li>使用命名方案<code>*Test.java</code>用于单元测试。</li><li>不定义<code>public static Test suite()</code>或构造方法，构建系统会自动执行正确的操作，而无需使用它们。</li></ul>


<h2 id="Codingstandards-Logging">记录中</h2>

<ul><li>尽可能多地记录日志，以便别人弄清楚发生了什么<img class="emoticon emoticon-smile" src="https://cwiki.apache.org/confluence/s/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/_/images/icons/emoticons/smile.png" alt="（微笑）" data-emoticon-name="smile"></li><li>使用SLF4J <code>org.slf4j.Logger</code>而不是原始<em>Log4j</em>或<em>JCL</em></li><li>不要记录您抛出的可扔物-留给调用者</li><li>使用标志来避免<em>调试</em>和<em>跟踪的</em>字符串连接</li><li>使用SLF4J varargs {}扩展</li><li>缓存标志（尤其是<em>trace</em> ），以避免过多<code>isTraceEnabled()</code>来电</li></ul>


<h3 id="Codingstandards-Levels">等级</h3>

<ul><li>使用<em>跟踪</em>级别进行详细/诊断日志记录</li><li>使用<em>调试</em>级别进行应用程序开发人员需要了解的事情</li><li>将<em>信息</em>级别用于管理员需要了解的事项</li><li>使用<em>警告</em>级别指示应用程序或暂时性问题</li><li>对表示服务器本身有问题的事物使用<em>错误</em>级别</li></ul>


<h3 id="Codingstandards-Example">例</h3>

<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
private final Logger log = LoggerFactory.getLogger(getClass());

public void doSomeStuff(Stuff stuff) throws StuffException {
    try {
        log.trace(&quot;About to do stuff: {}&quot;, stuff);
        stuff.doSomething();
        log.trace(&quot;Did some stuff&quot;);
    } catch (BadException e) {
        // don&#39;t log - leave it to caller
        throw new StuffException(&quot;Something bad happened&quot;, e);
    } catch (IgnorableException e) {
        // didn&#39;t cache this as we don&#39;t expect to come here a lot
        if (log.isDebugEnabled()) {
            log.debug(&quot;Ignoring problem doing stuff &quot; + stuff, e);
        }
    }
}
]]></script>
</div></div>

<h2 id="Codingstandards-AbbreviationsandAcronymsinmethods/classes/interfaces'names">方法/类/接口名称中的缩写和首字母缩写</h2>

<p>缩写/首字母缩写均以大写形式写在方法/类/接口的名称中。</p>

<div class="code panel pdl" style="border-style:solid;border-width:1px"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
public final class J2EELoader {

    public static EJBRef[] loadEJBRefs(Element parent) {
        //...
    }

}
]]></script>
</div></div>

<h2 id="Codingstandards-GBeanattributeandreferencenamingconvention">GBean属性和引用命名约定</h2>

<p>当前约定是为了使属性遵循Java变量命名约定（即，后接小写的小写字母驼峰），以及遵循Java类命名约定（即，后接大写的首字符驼峰）的引用。</p></div>
        </div>

        
      </div>
    </div>

    <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo Development : Coding standards';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2011，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-4380560-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  

</body></html>