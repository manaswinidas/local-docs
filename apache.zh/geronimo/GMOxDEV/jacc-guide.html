<html lang="zh-Hans" ><head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="asset?aid=0">
    <link rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <meta name="Description" content="JACC Guide">
    <meta name="Keywords" content="Apache Geronimo development documentation JACC Guide">
    <meta name="Owner" content="dev@geronimo.apache.org">
    <meta name="Robots" content="index, follow">
    <meta name="Security" content="Public">
    <meta name="Source" content="wiki template">
    <meta name="DC.Date" scheme="iso8601" content="2009-01-06">
    <meta name="DC.Language" scheme="rfc1766" content="en">
    <meta name="DC.Rights" content="Copyright Â© 2003-2011, The Apache Software Foundation">
    <meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo开发：JACC指南</title>

  </head>

  <body  onload="init()">

    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tbody><tr>
        <td align="left" valing="top">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </tbody></table>

    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tbody><tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" nowrap>
          <a href="/geronimo">首页</a> > <a href="index.html">索引</a> > <a href="jacc-guide.html">JACC指南</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="hidden" name="oe" value="UTF-8">
            <input type="hidden" name="domains" value="">
            <input type="hidden" name="sitesearch" value="">
            <input type="text" name="q" value="" maxlength="255">        
            <input type="submit" name="btnG" value="谷歌搜索">
          </form>
        </td>
      </tr> 
    </tbody></table>

    <div id="PageContent">
      <div class="pageheader" style="padding:6px 0px 0px 0px">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div class="smalltext" style="margin:0px 10px 0px 10px">Apache Geronimo开发</div>
        <div class="pagetitle" style="margin:0px 10px 8px 10px">JACC指南</div>

        <div class="greynavbar" align="right" style="padding:2px 10px;margin:0px">
<!-- --> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=31854"><img src="http://geronimo.apache.org/images/icons/notep_16.gif" height="16" width="16" border="0" title="编辑页面"></a> <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=31854">编辑页面</a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV"><img src="http://geronimo.apache.org/images/icons/browse_space.gif" height="16" width="16" border="0" title="浏览空间"></a> <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV">浏览空间</a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=31854"><img src="http://geronimo.apache.org/images/icons/add_page_16.gif" height="16" width="16" border="0" title="添加页面"></a> <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=31854">添加页面</a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=31854"><img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif" height="16" width="16" border="0" title="新增新闻"></a> <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=31854">新增新闻</a> <!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><h1 id="JACCGuide-GuidetoJACCProviders">JACC提供者指南</h1>

<p>JACC（容器的Java授权合同）是一种规范，允许插入提供程序来处理j2ee应用服务器的安全性决策。您可以一直使用简单的独立系统来管理引擎或委派给外部安全服务器。这概述了JACC提供程序需要实现的内容，提供了哪些部署时间信息，提供了哪些运行时间信息，以及如何使Geronimo使用您的JACC提供程序，包括如何使geronimo为您提供额外的信息。提供者。</p>

<p>在开始使用提供程序之前，请注意，有一堆新的web和ejb权限类，它们基本上封装了您可以在类的spec部署描述符中指定的权限。Geronimo实现了这些，并且Geronimo提供程序不需要了解有关它们的任何特定信息，但是您仍然可能希望对其进行审查。</p>

<p>到目前为止，这只是一个简短的初稿，因此可能存在很多错误和遗漏。</p>

<h1 id="JACCGuide-ClassesaProviderneedstoimplement.">提供者需要实现的类。</h1>

<p>JACC按policyContextID将安全性决策设备分成几位，基本上对应于Web或ejb模块。对于每个policyContextID，都有一个PolicyConfiguration来为该模块做出决策。PolicyConfigurationFactory提供对PolicyConfigurations的访问，用于配置目的和在geronimo中用于运行时决策委派。</p>

<h3 id="JACCGuide-PolicyConfigurationFactory">PolicyConfigurationFactory</h3>

<p>这提供了PolicyConfigurations并在一定程度上管理了它们的生命周期。您可以使用系统属性javax.security.jacc指定实现类。PolicyConfigurationFactory.provider并使用静态getPolicyConfigurationFactory方法获取实现。getPolicyConfiguration（String policyContextId，boolean replace）方法为您提供policyContextId的PolicyConfiguration，其中replace参数指示是否要在获取内容之前先擦除所有内容（以便进行配置）。您可以使用inService（String policyContextId）方法来判断policyContextId是否可供运行时使用。</p>

<h3 id="JACCGuide-PolicyConfiguration">策略配置</h3>

<p>这提供了许多方法来将角色推送到规范部署描述符中指定的权限映射到PolicyConfigurations中。在geronimo中，这是在启动应用程序时完成的。对于j2ee应用程序中的每对模块，还有一个必须由容器（geronimo）调用的链接方法。标准的geronimo jacc实现不需要做任何链接，但是其他实现则可以。</p>

<h3 id="JACCGuide-Policy">政策</h3>

<p>您还必须提供一个策略实现，该实现以某种方式使用提供给PolicyConfigurations的信息来帮助做出安全决策。Geronimo将PolicyConfiguration扩展到GeronimoPolicyConfiguration并提供了一个GeronimoPolicy来委托</p>

<p>公共布尔含义（ProtectionDomain域，权限许可）</p>

<p>决定适当的PolicyConfiguration。如果要编写特定于geronimo的JACC提供程序（或将geronimo拖入工作的Java提供程序），则可以重新使用GeronimoPolicy并让PolicyConfiguration实现GeronimoPolicyConfiguration，或者可以复制GeronimoPolicyConfiguration，或者可以提出一种完全不同的方案。</p>


<h1 id="JACCGuide-Configurationtimeaccess">配置时间访问</h1>

<p>在启动应用程序并对该应用程序的每个PolicyConfiguration进行“提交”之前，容器（geronimo）必须使用该方法为规范部署描述符中定义的角色权限映射中的每个policyContextId和内容获取PolicyConfigurationId</p>

<p>void addToRole（java.lang。字符串字符串，java.security。PermissionCollectionPermissionCollection）抛出javax.security.jacc。PolicyContextException;</p>

<p>void addToRole（java.lang。字符串字符串，java.security。权限权限）抛出javax.security.jacc。PolicyContextException;</p>

<p>void addToUncheckedPolicy（java.security。PermissionCollectionPermissionCollection）抛出javax.security.jacc。PolicyContextException;</p>

<p>void addToUncheckedPolicy（java.security。权限权限）抛出javax.security.jacc。PolicyContextException;</p>

<p>void addToExcludedPolicy（java.security。PermissionCollectionPermissionCollection）抛出javax.security.jacc。PolicyContextException;</p>

<p>void addToExcludedPolicy（java.security。权限权限）抛出javax.security.jacc。PolicyContextException;</p>

<p>void removeRole（java.lang。字符串）抛出javax.security.jacc。PolicyContextException;</p>

<p>void removeUncheckedPolicy（）抛出javax.security.jacc。PolicyContextException;</p>

<p>void removeExcludedPolicy（）抛出javax.security.jacc。PolicyContextException;</p>

<p>（我不知道为什么每个add方法都有2个版本）。部署应用程序后，规范似乎表明您可以从PolicyConfigurationFactory获取PolicyConfiguration（因此将其退出服务并阻止对应用程序的访问）并重新配置这些权限，但是从规范上我不清楚因为规范似乎要求将规范dd中的内容准确地输入到PolicyConfigurations中，所以可以调用它以及您可以实际使用它。从理论上讲，可以编写一个通用的管理界面来在运行时更改角色权限映射，但是除非重新对dd进行相同的更改，否则它们将在重新启动应用程序时重置（至少在geronimo中）。</p>

<p>Geronimo还提供了一种在应用程序启动时将更多信息填充到您的JACC实施中的方法。Geronimo JACC提供程序使用它来安装在geronimo应用程序计划中某处指定的应用程序级委托人角色映射：与spec角色权限映射结合使用，以提供实际上用于“隐含”计算的委托人权限映射。</p>

<p>要实现这样一个特定于JACC提供者的信息填充器，您需要为要添加的信息定义一个架构，并为该命名空间注册一个NamespaceDrivenBuilder GBean并更改对SecurityBuilder的引用，以便它们指向您的安全构建器。通常，您的构建器应在应用程序配置中安装一个gbean，以保存额外的信息，并在启动时将其提供给您的JACC提供程序（使用专有接口）。查看geronimo实现以获取更多详细信息：</p>

<p>构建器：GeronimoSecurityBuilderImpl</p>

<p>包含额外信息的运行时gbean：ApplicationPolicyConfigurationManager</p>

<p>如果您没有任何此类额外信息，则可以将其忽略。</p>

<p>待办事项：需要讨论SecurityBuilder中的其他方法。这些不属于那里，但是现在您可以继续使用内置的GeronimoSecurityBuilderImpl或复制它。基本上，我们应该从登录到应用程序的登录配置中获取默认主题，而不是手动构建它们。</p>

<h1 id="JACCGuide-Runtimepermissionsdecisions">运行时权限决定</h1>

<p>因此，现在您已安装并配置了JACC提供程序，并且您的应用程序正在运行，并且geronimo需要做出安全性决定，因此它暗示了您的策略。您可能会遵循Geronimo将决定委派给PolicyConfiguration的想法。无论如何，让我们看看您的提供商可以使用的信息来做出此决定。其中一些是直接可用的，某些是通过PolicyContextHandlers可用的，该PolicyContextHandlers可以在请求遍历容器时查询geronimo填充的ThreadLocals。您可以从PolicyContext.getContext（String key）获得此信息，并传入所需信息的密钥。</p>

<h3 id="JACCGuide-role-permissionmappingfromthespeccdd">来自特定dd的角色权限映射</h3>
<p>这是未经检查和排除的权限，以及在应用程序启动时安装到PolicyConfiguration中的权限映射角色。</p>

<h3 id="JACCGuide-ThePrincipalsintheSubject">学科负责人</h3>
<p>意味着为您提供当前的ProtectionDomain，并且您可以使用以下方式获取主题的主体<br clear="none">Principal []主体= domain.getPrincipals（）;<br clear="none">如果您具有角色映射的主体，则可以使用它来确定您所处的角色，并使用角色权限映射来确定权限。这就是默认的geronimo JACC提供程序所做的。</p>

<h3 id="JACCGuide-TheSubjectitself">主题本身</h3>
<p>这可以通过Subject PolicyContextHandler PolicyContextHandlerContainerSubject获得。您通过致电获得</p>

<p>PolicyContext.getContext（“ javax.security.auth。Subject.container”）；</p>

<h3 id="JACCGuide-EJBobject">EJB对象</h3>

<p>PolicyContext.getContext（“ javax.ejb。EnterpriseBean”）；</p>

<p>返回请求将要到达的ejb bean的实际对象实例。</p>

<h3 id="JACCGuide-EJBmethodcallarguments">EJB方法调用参数</h3>

<p>PolicyContext.getContext（“ javax.ejb.arguments”）;</p>

<p>返回一个包含ejb方法参数的Object []。这不适用于ejb Web服务请求。ejb方法名称可从您要检查的权限中获得。</p>

<h3 id="JACCGuide-ServletRequest">Servlet请求</h3>

<p>PolicyContext.getContext（“ javax.servlet.http。HttpServletRequest“）;</p>

<p>返回当前的HttpServletRequest。</p>

<h3 id="JACCGuide-SOAPrequest">SOAP请求</h3>

<p>PolicyContext.getContext（“ javax.xml.soap。SOAPMessage“）;</p>

<p>返回当前的SOAP消息。geronimo中尚未实现此功能！参见GERONIMO-2622。</p>



</div>
        </div>

        
      </div>
    </div>

    <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tbody><tr>
          <td align="left" valign="middle" class="footer">
              
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="美味的"> <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&noui&jump=close&url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">在Delicious上添加书签</a> <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="掘客！"> <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title)+'&topic=programming');">挖这个</a> <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo Development : JACC Guide';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
              
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">隐私权政策</a> -版权所有©2003-2011，Apache软件基金会，根据<a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0</a>许可<a href="http://www.apache.org/licenses/LICENSE-2.0">。</a>  
          </td>
        </tr>
    </tbody></table> 

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-4380560-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  

</body></html>