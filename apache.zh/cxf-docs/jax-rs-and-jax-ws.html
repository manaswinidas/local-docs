<html ><head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - JAX-RS and JAX-WS">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script src='/resources/highlighter/scripts/shBrushXml.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>Apache CXF-JAX-RS和JAX-WS</title>
  </head>
<body  onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td id="cell-0-0" colspan="2"> </td>
    <td id="cell-0-1"> </td>
    <td id="cell-0-2" colspan="2"> </td>
  </tr>
  <tr>
    <td id="cell-1-0"> </td>
    <td id="cell-1-1"> </td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight:bold;font-size:170%;color:white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="阿帕奇软件基金会"><img border="0" alt="ASF徽标" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></tbody></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tbody><tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs --> <a href="index.html">索引</a> > <a href="restful-services.html">RESTful服务</a> > <a href="jax-rs.html">JAX-RS</a> > <a href="jax-rs-and-jax-ws.html">JAX-RS和JAX-WS</a> <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">下载</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">文献资料</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </tbody></table>
      </div>
    </td>
    <td id="cell-1-3"> </td>
    <td id="cell-1-4"> </td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2"> </td>
    <td id="cell-2-1">
      <table>
        <tbody><tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">总览</a></li><li><a shape="rect" href="how-tos.html">操作方法</a></li><li><a shape="rect" href="frontends.html">前端</a></li><li><a shape="rect" href="databindings.html">数据绑定</a></li><li><a shape="rect" href="transports.html">运输工具</a></li><li><a shape="rect" href="configuration.html">组态</a></li><li><a shape="rect" href="debugging-and-logging.html">调试和记录</a></li><li><a shape="rect" href="tools.html">工具类</a></li><li><a shape="rect" href="restful-services.html">RESTful服务</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL绑定</a></li><li><a shape="rect" href="service-routing.html">服务路由</a></li><li><a shape="rect" href="dynamic-languages.html">动态语言</a></li><li><a shape="rect" href="ws-support.html">WS- *支持</a></li><li><a shape="rect" href="advanced-integration.html">进阶整合</a></li><li><a shape="rect" href="deployment.html">部署方式</a></li><li><a shape="rect" href="schemas-and-namespaces.html">模式和命名空间的使用</a></li></ul><hr><ul class="alternate"><li><p>搜索</p></li></ul><form id="cse-search-box" enctype="application/x-www-form-urlencoded" method="get" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="搜索">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF网站</a></li></ul><p> </p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><p> </p><p> </p><p> </p><p> </p><p><span style="font-size:2em;font-weight:bold">JAX-RS和JAX-WS</span>


</p><p> </p><p> </p><p> </p><p> </p><p><style type="text/css">/*<![CDATA[*/
div.rbtoc1524513436732 {padding: 0px;}
div.rbtoc1524513436732 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1524513436732 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style></p><div class="toc-macro rbtoc1524513436732">
<ul class="toc-indentation"><li><a shape="rect" href="#JAX-RSandJAX-WS-JAX-RSandJAX-WS">JAX-RS和JAX-WS</a></li><li><a shape="rect" href="#JAX-RSandJAX-WS-Dealingwithcontexts">处理上下文</a></li><li><a shape="rect" href="#JAX-RSandJAX-WS-SharingCXFDataBindings">共享CXF数据绑定</a></li><li><a shape="rect" href="#JAX-RSandJAX-WS-SharingJAX-RSProviders">共享JAX-RS提供程序</a></li><li><a shape="rect" href="#JAX-RSandJAX-WS-Applyingexternalusermodels">应用外部用户模型</a></li></ul>
</div><h1 id="JAX-RSandJAX-WS-JAX-RSandJAX-WS">JAX-RS和JAX-WS</h1><p>这是一个beans.xml，它显示了如何在JAX-WS和JAX-RS的帮助下，使单个服务类同时支持基于SOAP和基于REST的调用：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:jaxrs="http://cxf.apache.org/jaxrs"
  xmlns:jaxws="http://cxf.apache.org/jaxws"
  xsi:schemaLocation="
http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans.xsd
http://cxf.apache.org/jaxrs
http://cxf.apache.org/schemas/jaxrs.xsd
http://cxf.apache.org/jaxws
http://cxf.apache.org/schemas/jaxws.xsd"&gt;

  &lt;import resource="classpath:META-INF/cxf/cxf.xml" /&gt;
  &lt;import resource="classpath:META-INF/cxf/cxf-extension-jaxrs-binding.xml" /&gt;
  &lt;import resource="classpath:META-INF/cxf/cxf-servlet.xml" /&gt;

  &lt;!-- JAX-RS --&gt;
  &lt;jaxrs:server id="customerService" address="/"&gt;
    &lt;jaxrs:serviceBeans&gt;
      &lt;ref bean="customerService" /&gt;
    &lt;/jaxrs:serviceBeans&gt;
  &lt;/jaxrs:server&gt;

  &lt;!-- JAX-WS --&gt;
  &lt;jaxws:endpoint implementor="#customerService"
    address="/CustomerWorld" wsdlLocation="..."/&gt;
  
  &lt;bean id="customerService" class="demo.jaxrs.server.CustomerService" /&gt;
&lt;/beans&gt;
</pre>
</div></div><p>契约优先或Java优先的方法都可以用于JAX-WS。可以将JAX-RS批注添加到现有服务类。根据方法签名的复杂性，可能需要创建一些自定义提供程序。</p><p>当使用WSDL优先方法时，文档文字包装的样式可能适合也可能不合适，因为代码生成器会将所有类型都包装为签名，例如：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">public class CustomerService {
   public void doIt(String a, String b) {...};
}
</pre>
</div></div><p>默认情况下，JAX-RS可能无法处理此类方法，因为它要求签名中的单个参数可用，该签名不能由诸如@PathParam之类的JAX-RS注释之一进行注释。因此，如果<br clear="none">可以将'String a'参数映射到@Path模板变量或查询段之一，则无需更改此签名：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">@Path("/customers/{a}")
public class CustomerService {
   public void doIt(@PathParam("a") String a, String b) {...};
}
</pre>
</div></div><p>请注意，JAXWS和JAXRS服务都支持CXF Continuations API。</p><h1 id="JAX-RSandJAX-WS-Dealingwithcontexts">处理上下文</h1><p>当结合JAXWS和JAXRS时，作为处理给定请求的一部分，可能需要访问一些上下文信息。目前，在使用相同方法同时处理JAXWS和JAXRS请求的情况下，CXF JAXRS不提供可用于访问JAXWS和JAXRS请求共有的特定于请求的信息的上下文实现。请使用JAXWS WebServiceContext和JAXRS上下文或CXF JAXRS复合MessageContext：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">@Path("/customers")
@WebService
public class CustomerService {

   @Context WebServiceContext jaxwsContext;
   @Context MessageContext jaxrsContext;

   @WebMethod
   @POST
   public void doIt(String b) {
       isUserInRole();
   };

   private void isUserInRole() throws WebApplicationException {
       if (jaxwsContext.getSecurityContext() != null) {
           // soap invocation
           jaxwsContext.getSecurityContext().isUserInRole(theRole);
       } else {
           // http-only jaxrs one
           jaxrsContext.getSecurityContext().isUserInRole(theRole);
       }  
   }
}
</pre>
</div></div><p>请注意，注入的上下文实例（jaxwsContext和jaxrsContext）实际上是线程本地代理，因此即使它们不表示给定的请求，它们也不会等于null。例如，即使它不是当前正在处理的JAXWS调用，jaxrsContext也不等于null。</p><p>但是，如果说需要访问（JAXWS或JAXRS）SecurityContext，则仅当它是JAXWS / SOAP调用时，才将其设置在jaxwsContext中。因此，在组合JAXWS和JAXRS时访问复合JAXRS特定的上下文信息时，使用复合CXF JAXRS MessageContext会很方便，因为只需简单地检查单个上下文（例如SecurityContext或UriInfo）是否为null即可轻松检查它是否实际上是一个JAXRS请求。</p><p>使用诸如JAXRS SecurityContext之类的单个上下文可能没有那么吸引人：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">@WebService
public class CustomerService {
   @Context WebServiceContext jaxwsContext;
   // @Resource can be applied too
   @Context SecurityContext jaxrsSecurityContext;  
}
</pre>
</div></div><p>由于SecurityContext的某些方法返回布尔值，因此仅抛出运行时异常可以可靠地指示此上下文实际上不在范围内。</p><p>请注意，如果您在JAXRS和JAXWS调用之间不共享相同的服务方法，则可以直接访问相应的上下文：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">@Path("/customers")
@WebService
public class CustomerService 

   @Context WebServiceContext jaxwsContext;
   @Context MessageContext jaxrsContext;

   @WebMethod
   public void doItSoap(String b) {
       isUserInRole(jaxwsContext.getSecurityContext().getPrincipal());
   };

   @POST
   public void doItSoap(String b) {
       isUserInRole(jaxwsContext.getSecurityContext().getPrincipal());
   }

   private void isUserInRole(Principal p) throws WebApplicationException {
       ...  
   }
}
</pre>
</div></div><p>另一种选择是避免在服务代码中使用上下文，而在CXF拦截器或JAXRS过滤器中对其进行处理。有时有可能完全避免使用上下文。例如，Spring Security可用于在单个方法级别保护给定服务。</p><h1 id="JAX-RSandJAX-WS-SharingCXFDataBindings">共享CXF数据绑定</h1><p>可以将JAX-WS和JAX-RS端点配置为共享单个CXF DataBinding实例，以读取/写入数据。<br clear="none">请参阅<a shape="rect" href="jax-rs-data-bindings.html">CXF DataBindings</a>部分以获取更多信息。</p><h1 id="JAX-RSandJAX-WS-SharingJAX-RSProviders">共享JAX-RS提供程序</h1><p>可以将JAX-WS和JAX-RS端点配置为共享单个JAX-RS提供程序实例，以读取/写入数据。<br clear="none">请参阅<a shape="rect" href="jax-rs-data-bindings.html">JAX-RS DataBinding</a>部分以获取更多信息。</p><h1 id="JAX-RSandJAX-WS-Applyingexternalusermodels">应用外部用户模型</h1><p>当使用WSDL-first方法开发SOAP服务时，您可能不希望或无法将JAX-RS批注添加到生成的服务接口类。通过jaxrs：server端点将外部用户模型间接应用于此服务类，可以无需更改代码即可对服务进行REST验证。</p></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </tbody></table>
   </td>
   <td id="cell-2-2" colspan="2"> </td>
  </tr>
  <tr>
   <td id="cell-3-0"> </td>
   <td id="cell-3-1"> </td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">隐私政策</a> -（ <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=24190959">编辑页面</a> ）（ <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=24190959&showComments=true&showCommentArea=true#addcomment">添加评论</a> ）<br>Apache CXF，CXF，Apache，Apache Feather徽标是The Apache Software Foundation的商标。<br>提及的所有其他商标可能是其各自所有者的商标或注册商标。
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3"> </td>
   <td id="cell-3-4"> </td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2"> </td>
    <td id="cell-4-1"> </td>
    <td id="cell-4-2" colspan="2"> </td>
  </tr>
</tbody></table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>




</body></html>