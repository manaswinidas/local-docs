<html ><head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - Writing a service with Spring">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script src='/resources/highlighter/scripts/shBrushXml.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>Apache CXF-用Spring编写服务</title>
  </head>
<body  onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td id="cell-0-0" colspan="2"> </td>
    <td id="cell-0-1"> </td>
    <td id="cell-0-2" colspan="2"> </td>
  </tr>
  <tr>
    <td id="cell-1-0"> </td>
    <td id="cell-1-1"> </td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight:bold;font-size:170%;color:white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="阿帕奇软件基金会"><img border="0" alt="ASF徽标" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></tbody></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tbody><tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs --> <a href="index.html">指数</a> > <a href="how-tos.html">入门指南</a> > <a href="writing-a-service-with-spring.html">编写服务与Spring</a> <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">下载</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">文献资料</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </tbody></table>
      </div>
    </td>
    <td id="cell-1-3"> </td>
    <td id="cell-1-4"> </td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2"> </td>
    <td id="cell-2-1">
      <table>
        <tbody><tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">总览</a></li><li><a shape="rect" href="how-tos.html">操作方法</a></li><li><a shape="rect" href="frontends.html">前端</a></li><li><a shape="rect" href="databindings.html">数据绑定</a></li><li><a shape="rect" href="transports.html">运输工具</a></li><li><a shape="rect" href="configuration.html">组态</a></li><li><a shape="rect" href="debugging-and-logging.html">调试和记录</a></li><li><a shape="rect" href="tools.html">工具类</a></li><li><a shape="rect" href="restful-services.html">RESTful服务</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL绑定</a></li><li><a shape="rect" href="service-routing.html">服务路由</a></li><li><a shape="rect" href="dynamic-languages.html">动态语言</a></li><li><a shape="rect" href="ws-support.html">WS- *支持</a></li><li><a shape="rect" href="advanced-integration.html">进阶整合</a></li><li><a shape="rect" href="deployment.html">部署方式</a></li><li><a shape="rect" href="schemas-and-namespaces.html">模式和命名空间的使用</a></li></ul><hr><ul class="alternate"><li><p>搜索</p></li></ul><form id="cse-search-box" enctype="application/x-www-form-urlencoded" method="get" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="搜索">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF网站</a></li></ul><p> </p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><p>这个例子将引导您使用<a shape="rect" class="external-link" href="http://springframework.org" rel="nofollow">Spring</a>创建第一个服务。您将学习如何：</p><ul><li>为CXF设置构建</li><li>编写一个简单的JAX-WS服务</li><li>设置HTTP传输</li></ul><p>此示例对应于CXF发行版中的<a shape="rect" class="external-link" href="http://svn.apache.org/viewvc/cxf/trunk/distribution/src/main/release/samples/java_first_spring_support/">java_first_spring_support</a>示例。</p><h1 id="WritingaservicewithSpring-Settingupyourbuild">设置构建</h1><p>建议对您的Web服务项目使用<a shape="rect" class="external-link" href="http://maven.apache.org/">Apache Maven</a> ，因为它将自动为您的Web服务项目引入所有必要的依赖关系。请参阅Maven <a shape="rect" class="external-link" href="http://svn.apache.org/viewvc/cxf/trunk/distribution/src/main/release/samples/java_first_spring_support/pom.xml?view=co">pom.xml</a>以获取所需配置的示例。CXF提供的所有示例都使用Apache Maven，但<a shape="rect" class="external-link" href="http://svn.apache.org/viewvc/cxf/trunk/distribution/src/main/release/samples/antbuild/">antbuild示例</a>除外，该<a shape="rect" class="external-link" href="http://svn.apache.org/viewvc/cxf/trunk/distribution/src/main/release/samples/antbuild/">示例</a>显示了如何使用Apache Ant来构建CXF项目。</p><p><a shape="rect" class="external-link" href="http://maven.apache.org/plugins/maven-dependency-plugin/">Maven依赖插件中</a>的mvn依赖关系：列表和mvn依赖关系：树命令将显示项目使用的所有依赖关系。</p><h1 id="WritingaservicewithSpring-WritingyourService">编写服务</h1><p>首先，我们将编写我们的服务接口。它将执行一个名为“ sayHello”的操作，该操作向提交其名称的任何人说“ Hello”。</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements. See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership. The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */
// START SNIPPET: service
package demo.spring.service;

import javax.jws.WebService;

@WebService
public interface HelloWorld {
    String sayHi(String text);
}
// END SNIPPET: service
</pre>
</div></div><p>我们的实现将如下所示：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements. See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership. The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */
// START SNIPPET: service
package demo.spring.service;

import javax.jws.WebService;

@WebService(endpointInterface = "demo.spring.service.HelloWorld")
public class HelloWorldImpl implements HelloWorld {

    public String sayHi(String text) {
        System.out.println("sayHi called");
        return "Hello " + text;
    }
}
// END SNIPPET: service
</pre>
</div></div><p>的<code>@WebService</code>实现类上的注释使CXF知道在创建WSDL时要使用哪个接口。在这种情况下，它只是我们的HelloWorld接口。</p><h1 id="WritingaservicewithSpring-Declaringyourserverbeans">声明服务器bean</h1><p>CXF在Spring 2.0中包含对“ nice XML”的支持。对于JAX-WS方面，我们有一个<jaxws:endpoint>设置服务器端端点</jaxws:endpoint>的<jaxws:endpoint>bean。</jaxws:endpoint></p><p>让我们在WEB-INF目录中创建一个“ cxf-servlet.xml”文件，该文件声明一个端点bean：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements. See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership. The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License. You may obtain a copy of the License at
        
        http://www.apache.org/licenses/LICENSE-2.0
        
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied. See the License for the
        specific language governing permissions and limitations
        under the License.
--&gt;
&lt;!-- START SNIPPET: beans --&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:jaxws="http://cxf.apache.org/jaxws" xsi:schemaLocation=" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd"&gt;
    &lt;import resource="classpath:META-INF/cxf/cxf.xml"/&gt;
    &lt;import resource="classpath:META-INF/cxf/cxf-servlet.xml"/&gt;
    &lt;jaxws:endpoint id="helloWorld" implementor="demo.spring.service.HelloWorldImpl" address="/HelloWorld"/&gt;
&lt;/beans&gt;
&lt;!-- END SNIPPET: beans --&gt;</pre>
</div></div><p>如果要引用spring托管bean，可以这样编写：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">&lt;bean id="hello" class="demo.spring.service.HelloWorldImpl" /&gt;
&lt;jaxws:endpoint id="helloWorld" implementor="#hello" address="/HelloWorld" /&gt;
</pre>
</div></div><p> </p><p>Bean使用以下属性：</p><ul><li><code>id</code>在Spring上下文中指定bean的ID。</li><li><code>implementor</code>指定实现类。</li><li><code>address</code>指定将托管服务的位置。这应该只是一条相关路径。这是因为CXF无法知道war名称和servlet容器的侦听端口，因此CXF将在运行时使用请求url更新端点地址。</li></ul><p>要提供一个bean名称而不是一个类名称作为实现者，只需提供以“＃”开头的bean名称，例如，Implementor =“＃myBean”。</p><p>您还可以使用<code><jaxws:endpoint></code>元素，例如添加嵌套标签，以将JAX-WS处理程序或CXF拦截器附加到服务。有关更多信息，请参见<a shape="rect" href="jax-ws-configuration.html">JAX-WS配置</a> 。</p><h1 id="WritingaservicewithSpring-SettinguptheServlet">设置Servlet</h1><p>由于我们依赖默认的“ cxf-servlet.xml”文件，因此可以使用许多示例引用的<a shape="rect" rel="nofollow">web.xml</a> 。</p><p>另外，对于任意命名的配置文件（例如beans.xml，application-context.xml等），我们可以添加以下元素：</p><ol><li>春天<code>ContextLoaderLister</code> 。这将启动Spring并显式加载配置文件。我们可以通过指定文件的位置<code>context-param</code>元件。</li></ol><p>一个例子：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">&lt;web-app ...&gt;
...
   &lt;context-param&gt;
      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;WEB-INF/beans.xml&lt;/param-value&gt;
   &lt;/context-param&gt;

   &lt;listener&gt;
      &lt;listener-class&gt;
         org.springframework.web.context.ContextLoaderListener
      &lt;/listener-class&gt;
   &lt;/listener&gt;
&lt;/web-app&gt;
</pre>
</div></div><p>重要的是要注意，为端点bean选择的地址必须是servlet侦听的地址。例如，如果我的Servlet注册了“ / some-services / *”，但我的地址是“ / more-services / HelloWorld”，则CXF无法接收请求。</p><h1 id="WritingaservicewithSpring-CreateaClient(EasyWay)">创建客户（简便方法）</h1><p>就像<code><jaxws:endpoint></code>在服务器端使用，有一个<code><jaxws:client></code>可以在客户端使用。您将为其提供一个Bean名称，服务接口和服务URL，它将创建具有指定名称的Bean，实现服务接口并在幕后调用远程SOAP服务：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:jaxws="http://cxf.apache.org/jaxws"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd"&gt;

    &lt;jaxws:client id="helloClient"
                  serviceClass="demo.spring.HelloWorld"
                  address="http://localhost:9002/HelloWorld" /&gt;
&lt;/beans&gt;</pre>
</div></div><p>您现在可以将“ helloClient” bean注入任何其他Spring Bean中，或者使用以下代码从Spring应用程序上下文中手动查找它：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">ApplicationContext context = ...; // your Spring ApplicationContext
HelloWorld client = (HelloWorld) context.getBean("helloClient");
</pre>
</div></div><p>您还可以使用<code><jaxws:client></code>元素，例如添加嵌套标签，以将JAX-WS处理程序或CXF拦截器附加到客户端。有关更多信息，请参见<a shape="rect" href="jax-ws-configuration.html">JAX-WS配置</a> 。</p><h1 id="WritingaservicewithSpring-CreateaClient(MoreManualWay)">创建客户端（更多手动方式）</h1><p>CXF包括一个JaxWsProxyFactory bean，该bean从服务接口为您创建一个客户端。您只需要告诉它您的服务类是什么（在本例中为HelloWorld接口）和服务的URL。然后，您可以通过调用JaxWsProxyFactory bean的create（）方法来创建它。</p><p>这是一个例子：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements. See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership. The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License. You may obtain a copy of the License at
        
        http://www.apache.org/licenses/LICENSE-2.0
        
        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied. See the License for the
        specific language governing permissions and limitations
        under the License.
--&gt;
&lt;!-- START SNIPPET: beans --&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:jaxws="http://cxf.apache.org/jaxws" xsi:schemaLocation=" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://cxf.apache.org/jaxws http://cxf.apache.org/schema/jaxws.xsd"&gt;
    &lt;bean id="client" class="demo.spring.service.HelloWorld" factory-bean="clientFactory" factory-method="create"/&gt;
    &lt;bean id="clientFactory" class="org.apache.cxf.jaxws.JaxWsProxyFactoryBean"&gt;
        &lt;property name="serviceClass" value="demo.spring.service.HelloWorld"/&gt;
        &lt;property name="address" value="http://localhost:9002/services/HelloWorld"/&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
&lt;!-- END SNIPPET: beans --&gt;
</pre>
</div></div><p> </p><p>如果要访问您的客户端，现在可以简单地将其从Spring上下文中拉出（或者更好的是，使用Spring将其注入到您的应用程序中！）：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">ApplicationContext context = ...; // your Spring ApplicationContext
HelloWorld client = (HelloWorld) context.getBean("client");
</pre>
</div></div><p> </p><p>客户端代码位于<a shape="rect" class="external-link" href="https://github.com/apache/cxf/blob/master/distribution/src/main/release/samples/java_first_spring_support/src/main/java/demo/spring/client/Client.java" rel="nofollow">https://github.com/apache/cxf/blob/master/distribution/src/main/release/samples/java_first_spring_support/src/main/java/demo/spring/client/Client.java</a></p><p>某些使用场景将需要更广泛的配置（而对于<code><jaxws:client></code>上述语法）。有关更多信息，请参见<a shape="rect" href="jax-ws-configuration.html">JAX-WS配置</a> 。</p><h1 id="WritingaservicewithSpring-AdvancedSteps">进阶步骤</h1><p>有关使用Spring的更多信息，您可能需要阅读用户指南的<a shape="rect" href="configuration.html">Configuration</a>和<a shape="rect" href="spring.html">Spring</a>部分。</p></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </tbody></table>
   </td>
   <td id="cell-2-2" colspan="2"> </td>
  </tr>
  <tr>
   <td id="cell-3-0"> </td>
   <td id="cell-3-1"> </td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">隐私政策</a> -（ <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=48729">编辑页面</a> ）（ <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=48729&showComments=true&showCommentArea=true#addcomment">添加评论</a> ）<br>Apache CXF，CXF，Apache，Apache Feather徽标是The Apache Software Foundation的商标。<br>提及的所有其他商标可能是其各自所有者的商标或注册商标。
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3"> </td>
   <td id="cell-3-4"> </td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2"> </td>
    <td id="cell-4-1"> </td>
    <td id="cell-4-2" colspan="2"> </td>
  </tr>
</tbody></table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>




</body></html>