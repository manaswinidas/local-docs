<html ><head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - Defining Contract first webservices with wsdl generation from java">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script src='/resources/highlighter/scripts/shBrushXml.js'></script>
<script src='/resources/highlighter/scripts/shBrushBash.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>Apache CXF-使用Java的wsdl生成来定义合同优先的Web服务</title>
  </head>
<body  onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td id="cell-0-0" colspan="2"> </td>
    <td id="cell-0-1"> </td>
    <td id="cell-0-2" colspan="2"> </td>
  </tr>
  <tr>
    <td id="cell-1-0"> </td>
    <td id="cell-1-1"> </td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight:bold;font-size:170%;color:white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="阿帕奇软件基金会"><img border="0" alt="ASF徽标" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></tbody></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tbody><tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs --> <a href="index.html">指数</a> > <a href="how-tos.html">如何渡</a> > <a href="defining-contract-first-webservices-with-wsdl-generation-from-java.html">定义合同与WSDL生成web服务首先从Java</a> <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">下载</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">文献资料</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </tbody></table>
      </div>
    </td>
    <td id="cell-1-3"> </td>
    <td id="cell-1-4"> </td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2"> </td>
    <td id="cell-2-1">
      <table>
        <tbody><tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">总览</a></li><li><a shape="rect" href="how-tos.html">操作方法</a></li><li><a shape="rect" href="frontends.html">前端</a></li><li><a shape="rect" href="databindings.html">数据绑定</a></li><li><a shape="rect" href="transports.html">运输工具</a></li><li><a shape="rect" href="configuration.html">组态</a></li><li><a shape="rect" href="debugging-and-logging.html">调试和记录</a></li><li><a shape="rect" href="tools.html">工具类</a></li><li><a shape="rect" href="restful-services.html">RESTful服务</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL绑定</a></li><li><a shape="rect" href="service-routing.html">服务路由</a></li><li><a shape="rect" href="dynamic-languages.html">动态语言</a></li><li><a shape="rect" href="ws-support.html">WS- *支持</a></li><li><a shape="rect" href="advanced-integration.html">进阶整合</a></li><li><a shape="rect" href="deployment.html">部署方式</a></li><li><a shape="rect" href="schemas-and-namespaces.html">模式和命名空间的使用</a></li></ul><hr><ul class="alternate"><li><p>搜索</p></li></ul><form id="cse-search-box" enctype="application/x-www-form-urlencoded" method="get" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="搜索">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF网站</a></li></ul><p> </p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><p>在这篇文章中，我将描述如何以一种非常简单有效的方式首先签订合同。Web服务设计中涉及的所有人员都存在问题，该使用什么工具来描述Web服务接口。当然，这里有wsdl编辑器，但是您在使用它们时会出错，而且它们通常不是很直观。<br clear="none"> <a shape="rect" class="external-link" href="http://www.liquid-reality.de/display/liquid/2008/08/20/Defining+Contract+first+webservices+by+generating+wsdl+from+java" rel="nofollow">原始帖子来自Christian Schneider的博客，可以在这里找到</a></p><h2 id="DefiningContractfirstwebserviceswithwsdlgenerationfromjava-Whatwewouldliketohave">我们想拥有什么</h2><p>理想情况下，我会想像使用一种特定于域的语言，这使得设计Web服务非常容易且安全。然后应该有一个支持我编写DSL的IDE。借助内容辅助或图形编辑器。无论如何，IDE应该在输入DSL时检查DSL，并帮助我做正确的事。有些人喜欢使用模型驱动的设计工具来完成这项工作，但是很难找到好的工具并对其进行配置。</p><h2 id="DefiningContractfirstwebserviceswithwsdlgenerationfromjava-WhichtoolsdidIchooseandwhy">我选择了哪些工具，为什么选择</h2><p>我想朝着Web服务的DSL方向发展，但不使用大型MDD工具。因此，我考虑了如何仅使用Java和常规Eclipse IDE来发挥DSL的最大优势。因此，我需要看起来几乎像DSL的Java代码和从中生成Web服务的工具。对于WSDL生成，我使用带有JAXWS和JAXB批注的Apache CXF来描述Web服务。尽管此设置非常标准，但我专注于使语法尽可能简单。</p><h2 id="DefiningContractfirstwebserviceswithwsdlgenerationfromjava-SohowdoestheDSLlooklike">那么DSL看起来如何</h2><p>为了描述数据对象，我使用带有属性的java类。命名空间将来自程序包名称。为了使JAXB理解此语法，仅需要一个注释。当然，如果要使用特殊功能，则需要更多注释。</p><h3 id="DefiningContractfirstwebserviceswithwsdlgenerationfromjava-Customerdatatype">客户数据类型</h3><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">package com.example.customerservice;

@XmlAccessorType( XmlAccessType.FIELD )
public class Customer {
    String name;
    String[] address;
    int numOrders;
    double revenue;
    BigDecimal test;
    Date birthDate;
    CustomerType type;
}
</pre>
</div></div><p>样本类Customer提供了一个很好的概述，可以使用哪些原始数据类型。另外，您可以通过这种方式创建原始或类数据类型的数组。完整的示例还包含一个枚举定义，以表明这是可能的。我认为这段代码与我想像中描述服务的DSL非常接近。</p><h3 id="DefiningContractfirstwebserviceswithwsdlgenerationfromjava-EnumerationCustomerType">枚举CustomerType</h3><p>显示枚举的处理方式：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">package com.example.customerservice;

public enum CustomerType {
    PRIVATE, BUSINESS
}
</pre>
</div></div><h3 id="DefiningContractfirstwebserviceswithwsdlgenerationfromjava-NoSuchCustomerException">NoSuchCustomerException</h3><p>定义异常有点棘手，因为默认行为是在以后生成的Java代码中创建Exception_Exception类。因此，我们必须使用@WebFault批注为数据的Bean提供一个与Exception名称不同的名称。</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">package com.example.customerservice;

@WebFault(name="NoSuchCustomer")
@XmlAccessorType( XmlAccessType.FIELD )
public class NoSuchCustomerException extends RuntimeException {
    /**
      * We only define the fault details here. Additionally each fault has a message
      * that should not be defined separately
      */
    String customerName;
}
</pre>
</div></div><h3 id="DefiningContractfirstwebserviceswithwsdlgenerationfromjava-Servicedefinition">服务定义</h3><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">package com.example.customerservice;

@WebService
public interface CustomerService {
    public Customer[] getCustomersByName(@WebParam(name="name") String name) throws NoSuchCustomerException;
}
</pre>
</div></div><p>如您所见，这里仅需要两个注释。@WebService将接口标记为服务，并且@Webparam是必需的，因为Java否则将丢失参数的名称，而wsdl将包含arg0而不是所需的名称。使用@WebService批注，您还可以自定义端口名称和服务名称。</p><h2 id="DefiningContractfirstwebserviceswithwsdlgenerationfromjava-Howisthewsdlgenerated">wsdl是如何生成的</h2><p>为了生成wsdl，使用了maven插件cxf-java2ws-plugin。有关详细信息，请参见完整示例中的pom.xml。</p><h2 id="DefiningContractfirstwebserviceswithwsdlgenerationfromjava-Let´stakealookattheresultingWSDL">让我们看一下生成的WSDL</h2><p>您可以<a shape="rect" href="defining-contract-first-webservices-with-wsdl-generation-from-java.data/CustomerService.wsdl?version=2&modificationDate=1219326152000&api=v2" data-linked-resource-id="59672633" data-linked-resource-version="2" data-linked-resource-type="attachment" data-linked-resource-default-alias="CustomerService.wsdl" data-linked-resource-content-type="application/wsdl+xml" data-linked-resource-container-id="93162" data-linked-resource-container-version="16">在此处下载此示例创建的wsdl</a> 。</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">&lt;xs:complexType name="customer"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element minOccurs="0" name="name" type="xs:string"/&gt;
        &lt;xs:element maxOccurs="unbounded" minOccurs="0" name="address" nillable="true" type="xs:string"/&gt;
        &lt;xs:element name="numOrders" type="xs:int"/&gt;
        &lt;xs:element name="revenue" type="xs:double"/&gt;
        &lt;xs:element minOccurs="0" name="test" type="xs:decimal"/&gt;
        &lt;xs:element minOccurs="0" name="birthDate" type="xs:dateTime"/&gt;
        &lt;xs:element minOccurs="0" name="type" type="tns:customerType"/&gt;
    &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
</div></div><p>客户类是xsd中的复杂类型。如您所见，Java类型已被描述为它们各自的XSD原语类型。</p><p>每个元素都有minOccurs =“ 0”，将其标记为可选。这是一件好事，因为您可以添加新的可选元素并保持兼容。如果您不希望这种可选项，则可以使用@XmlElement（required = true）。</p><p>地址的字符串数组描述为maxOccurs =“ unbounded”，因此可以在以后的xml中重复该元素以形成数组。</p><h3 id="DefiningContractfirstwebserviceswithwsdlgenerationfromjava-EnumerationcustomerType">枚举customerType</h3><p>枚举customerType被描述为具有限制的简单类型：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">&lt;xs:simpleType name="customerType"&gt;
    &lt;xs:restriction base="xs:string"&gt;
        &lt;xs:enumeration value="PRIVATE"/&gt;
        &lt;xs:enumeration value="BUSINESS"/&gt;
    &lt;/xs:restriction&gt;
&lt;/xs:simpleType&gt;
</pre>
</div></div><h3 id="DefiningContractfirstwebserviceswithwsdlgenerationfromjava-FaultNoSuchCustomerException">错误NoSuchCustomerException</h3><p>我们定义的Exception生成为带有定义的详细信息和故障消息的complexType。在这里重要的是元素和消息具有不同的名称。我们通过使用上面的@WebFault注释来确保这一点。否则，稍后的Java代码生成将产生难看的Exception名称NoSuchCustomerException_Exception。</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">&lt;xs:element name="NoSuchCustomer" type="tns:NoSuchCustomer"/&gt;
&lt;xs:complexType name="NoSuchCustomer"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element name="customerName" nillable="true" type="xs:string"/&gt;
    &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
&lt;wsdl:message name="NoSuchCustomerException"&gt;
    &lt;wsdl:part name="NoSuchCustomerException" element="tns:NoSuchCustomer"&gt;
    &lt;/wsdl:part&gt;
&lt;/wsdl:message&gt;
</pre>
</div></div><p>wsdl默认情况下定义了SOAP / HTTP绑定，但也可以用于基于JMS构建服务，这将在下一篇文章中显示。</p><h2 id="DefiningContractfirstwebserviceswithwsdlgenerationfromjava-Summary">摘要</h2><p>如您所见，生成的WSDL看起来很干净，并且正确表达了我们要描述的服务接口。在大多数情况下，您对转换不满意，可以使用JAX-WS或JAXB批注更正WSDL。但是我建议尽量少使用它们，以使DSL易于阅读。</p><p>在下一篇文章中，我将展示如何使用我们刚刚构建的WSDL构建服务使用者和提供者。</p><p>您可以<a shape="rect" href="defining-contract-first-webservices-with-wsdl-generation-from-java.data/cxfjava2wsexample.zip?version=1&modificationDate=1219326111000&api=v2" data-linked-resource-id="8674" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="cxfjava2wsexample.zip" data-nice-type="Zip Archive" data-linked-resource-content-type="application/x-zip" data-linked-resource-container-id="93162" data-linked-resource-container-version="16">在此处下载完整的示例</a> 。</p><h2 id="DefiningContractfirstwebserviceswithwsdlgenerationfromjava-References">参考文献</h2><ul><li><a shape="rect" href="http://cxf.apache.org/">Apache CXF</a></li><li><a shape="rect" class="external-link" href="http://www.jcp.org/en/jsr/detail?id=224" rel="nofollow">JAX-WS规范</a> </li><li><a shape="rect" class="external-link" href="https://jaxb-architecture-document.dev.java.net/nonav/doc/?jaxb/package-summary.html" rel="nofollow">JAXB体系结构</a></li><li><a shape="rect" class="external-link" href="https://jaxb.dev.java.net/guide/" rel="nofollow">JAXB用户指南</a></li><li><a shape="rect" class="external-link" href="http://java.sun.com/webservices/docs/2.0/tutorial/doc/JAXBWorks.html#wp100322" rel="nofollow">JAXB教程</a></li></ul></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </tbody></table>
   </td>
   <td id="cell-2-2" colspan="2"> </td>
  </tr>
  <tr>
   <td id="cell-3-0"> </td>
   <td id="cell-3-1"> </td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">隐私政策</a> -（ <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=93162">编辑页面</a> ）（ <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=93162&showComments=true&showCommentArea=true#addcomment">添加评论</a> ）<br>Apache CXF，CXF，Apache，Apache Feather徽标是The Apache Software Foundation的商标。<br>提及的所有其他商标可能是其各自所有者的商标或注册商标。
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3"> </td>
   <td id="cell-3-4"> </td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2"> </td>
    <td id="cell-4-1"> </td>
    <td id="cell-4-2" colspan="2"> </td>
  </tr>
</tbody></table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>




</body></html>