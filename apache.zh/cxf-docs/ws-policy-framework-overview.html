<html ><head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - WS-Policy Framework Overview">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script src='/resources/highlighter/scripts/shBrushXml.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>Apache CXF-WS-Policy框架概述</title>
  </head>
<body  onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td id="cell-0-0" colspan="2"> </td>
    <td id="cell-0-1"> </td>
    <td id="cell-0-2" colspan="2"> </td>
  </tr>
  <tr>
    <td id="cell-1-0"> </td>
    <td id="cell-1-1"> </td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight:bold;font-size:170%;color:white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="阿帕奇软件基金会"><img border="0" alt="ASF徽标" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></tbody></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tbody><tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs --> <a href="index.html">索引</a> > <a href="ws-support.html">WS- *支持</a> > <a href="ws-policy.html">WS-Policy</a> > <a href="ws-policy-framework-overview.html">WS-Policy框架概述</a> <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">下载</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">文献资料</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </tbody></table>
      </div>
    </td>
    <td id="cell-1-3"> </td>
    <td id="cell-1-4"> </td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2"> </td>
    <td id="cell-2-1">
      <table>
        <tbody><tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">总览</a></li><li><a shape="rect" href="how-tos.html">操作方法</a></li><li><a shape="rect" href="frontends.html">前端</a></li><li><a shape="rect" href="databindings.html">数据绑定</a></li><li><a shape="rect" href="transports.html">运输工具</a></li><li><a shape="rect" href="configuration.html">组态</a></li><li><a shape="rect" href="debugging-and-logging.html">调试和记录</a></li><li><a shape="rect" href="tools.html">工具类</a></li><li><a shape="rect" href="restful-services.html">RESTful服务</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL绑定</a></li><li><a shape="rect" href="service-routing.html">服务路由</a></li><li><a shape="rect" href="dynamic-languages.html">动态语言</a></li><li><a shape="rect" href="ws-support.html">WS- *支持</a></li><li><a shape="rect" href="advanced-integration.html">进阶整合</a></li><li><a shape="rect" href="deployment.html">部署方式</a></li><li><a shape="rect" href="schemas-and-namespaces.html">模式和命名空间的使用</a></li></ul><hr><ul class="alternate"><li><p>搜索</p></li></ul><form id="cse-search-box" enctype="application/x-www-form-urlencoded" method="get" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="搜索">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF网站</a></li></ul><p> </p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><p>WS-Policy框架提供允许CXF用户和开发人员使用WS-Policy的基础结构和API。</p>

<p>它符合<a shape="rect" class="external-link" href="http://www.w3.org/TR/2007/REC-ws-policy-20070904/" rel="nofollow">Web服务策略1.5-框架</a>和<br clear="none">
<a shape="rect" class="external-link" href="http://www.w3.org/TR/2007/REC-ws-policy-attach-20070904/" rel="nofollow">Web服务策略1.5-附件</a>规范。</p>

<p>该框架由核心运行时和API组成，这些API和API使开发人员可以插入对自己的域断言的支持：</p>

<h2 id="WS-PolicyFrameworkOverview-Core">核心</h2>

<p>核心负责：</p>

<ul><li>从不同来源检索策略（wsdl文档，外部文档）</li><li>计算服务，端点，操作和消息对象的有效策略</li><li>根据特定邮件的有效策略动态提供拦截器</li><li>验证确实支持有效的政策替代方案之一。</li></ul>


<p>诸如合并，规范化和交集之类的策略操作基于<a shape="rect" class="external-link" href="http://ws.apache.org/commons/neethi/index.html">Apache Neethi</a> 。</p>

<h2 id="WS-PolicyFrameworkOverview-APIs">蜜蜂</h2>

<h3 id="WS-PolicyFrameworkOverview-AssertionBuilder">AssertionBuilder</h3>

<p>AssertionBuilder API是Neethi的接口。</p>

<p>AssertionBuilder实现会动态加载并自动向AssertionBuilderRegistry注册，后者可作为Bus扩展使用。当前，CXF支持以下断言类型的AssertionBuilder和Assertion实现：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
{http://schemas.xmlsoap.org/ws/2005/02/rm/policy}RMAssertion
{http://www.w3.org/2007/01/addressing/metadata}Addressing
{http://www.w3.org/2007/01/addressing/metadata}AnonymousResponses
{http://www.w3.org/2007/01/addressing/metadata}NonAnonymousResponses
{http://cxf.apache.org/transports/http/configuration}client
{http://cxf.apache.org/transports/http/configuration}server
</pre>
</div></div>
<p>以及<a shape="rect" href="ws-securitypolicy.html">WS-SecurityPolicy</a>定义的断言。</p>

<p>它们全部基于通用的Assertion实现（PrimitiveAssertion，NestedPrimitiveAssertion，JaxbAssertion），开发人员可以在开发自己的断言时对其进行参数化或扩展，请参阅《 <a shape="rect" href="developing-assertions.html">开发断言》</a> 。</p>

<h3 id="WS-PolicyFrameworkOverview-PolicyInterceptorProvider">PolicyInterceptorProvider</h3>

<p>此API用于在运行时自动启用支持特定于域的断言所需的拦截器，从而大大简化了拦截器配置。</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
public interface PolicyInterceptorProvider extends InterceptorProvider {
  // return the schema types of the asssertions that can be supported
  Collection&lt;QName&gt; getAssertionTypes()
}
</pre>
</div></div>
<p>当前，CXF支持以下断言类型的PolicyInterceptorProvider实现：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
{http://schemas.xmlsoap.org/ws/2005/02/rm/policy}RMAssertion
{http://www.w3.org/2007/01/addressing/metadata}Addressing
{http://www.w3.org/2007/01/addressing/metadata}AnonymousResponses
{http://www.w3.org/2007/01/addressing/metadata}NonAnonymousResponses
</pre>
</div></div>
<p>以及<a shape="rect" href="ws-securitypolicy.html">WS-SecurityPolicy</a>定义的断言。</p>

<p>此外，该框架还提供了一个API，用于优化策略附件中的域表达式（描述策略范围内策略主题的xml元素）。当前只有EndpointReferenceType域表达式（通过地址匹配）的一种实现。正在使用XPath表达式的另一种实现方式。</p>

<h2 id="WS-PolicyFrameworkOverview-InteractionwiththeFramework">与框架的互动</h2>

<p>组件与策略框架进行交互主要是为了：</p>
<ol><li>检索与基础消息有关的断言（至少是组件已知的断言），以便组件可以相应地对消息进行操作</li><li>确认确实支持与基础消息有关的断言。</li></ol>


<p>像大多数其他CXF功能一样，策略框架本身很大程度上基于拦截器。因此，与框架的大多数交互都是通过Message对象间接进行的：策略拦截器通过将AssertionInfo对象（声明的有状态表示）插入到Message对象中，使它们可以随后用于执行策略感知的拦截器。从消息中提取AssertionInfo对象可以使拦截器执行上面的步骤1.和2.。</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
import org.apache.neethi.Assertion;

public class AssertionInfo {
  ...
  public boolean isAsserted() {...}
  public void setAsserted(boolean asserted) {...}
  public Assertion getAssertion() {...}
}
</pre>
</div></div>

<p>WS-Addressing和WS-RM拦截器是这种交互方式的示例。</p>

<p>Somtimes，Conduits和目的地也希望维护其功能。但是，他们通常不能等待通过Message对象向他们提供断言信息：<br clear="none">管道可能表现出特定于消息的行为（例如，应用特定于消息的接收超时），但是在初始化阶段做出的决定可能会限制其这样做的能力。<br clear="none">而且，目的地通常根本无法表现出消息或特定于操作的行为。但是两者都仍然可以支持有效端点策略中的断言。</p>

<p>因此，它们与策略框架的交互通常涉及PolicyEngine，通过它们它们可以获取基础端点的有效策略（对于步骤1）：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;"> 
public interface PolicyEngine {
    ...
    EndpointPolicy getClientEndpointPolicy(EndpointInfo ei, 
        Conduit conduit);    
    EndpointPolicy getServerEndpointPolicy(EndpointInfo ei, 
        Destination destination); 
}

public interface EndpointPolicy {
    ...
    Policy getPolicy(); 
    Collection&lt;Assertion&gt; getChosenAlternative();
}
</pre>
</div></div>

<p>为了执行步骤2，它们实现了Assertor接口（即，其assertMessage方法）：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
public class Assertor {
  ...
  public boolean canAssert(QName name);
  public void assertMessage(Message message);
}
</pre>
</div></div> 

<p>CXF中用于策略感知的管道和目标的示例是HTTP管道和目标。它们确实支持元素类型分别为HTTPClientPolicy和HTTPServerPolicy的断言。</p></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </tbody></table>
   </td>
   <td id="cell-2-2" colspan="2"> </td>
  </tr>
  <tr>
   <td id="cell-3-0"> </td>
   <td id="cell-3-1"> </td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">隐私政策</a> -（ <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=51291">编辑页面</a> ）（ <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=51291&showComments=true&showCommentArea=true#addcomment">添加评论</a> ）<br>Apache CXF，CXF，Apache，Apache Feather徽标是The Apache Software Foundation的商标。<br>提及的所有其他商标可能是其各自所有者的商标或注册商标。
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3"> </td>
   <td id="cell-3-4"> </td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2"> </td>
    <td id="cell-4-1"> </td>
    <td id="cell-4-2" colspan="2"> </td>
  </tr>
</tbody></table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>




</body></html>