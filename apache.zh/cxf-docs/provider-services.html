<html ><head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - Provider Services">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script src='/resources/highlighter/scripts/shBrushBash.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>Apache CXF-提供程序服务</title>
  </head>
<body  onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td id="cell-0-0" colspan="2"> </td>
    <td id="cell-0-1"> </td>
    <td id="cell-0-2" colspan="2"> </td>
  </tr>
  <tr>
    <td id="cell-1-0"> </td>
    <td id="cell-1-1"> </td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight:bold;font-size:170%;color:white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="阿帕奇软件基金会"><img border="0" alt="ASF徽标" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></tbody></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tbody><tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs --> <a href="index.html">索引</a> > <a href="frontends.html">前端</a> > <a href="jax-ws.html">JAX-WS</a> > <a href="provider-services.html">提供程序服务</a> <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">下载</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">文献资料</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </tbody></table>
      </div>
    </td>
    <td id="cell-1-3"> </td>
    <td id="cell-1-4"> </td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2"> </td>
    <td id="cell-2-1">
      <table>
        <tbody><tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">总览</a></li><li><a shape="rect" href="how-tos.html">操作方法</a></li><li><a shape="rect" href="frontends.html">前端</a></li><li><a shape="rect" href="databindings.html">数据绑定</a></li><li><a shape="rect" href="transports.html">运输工具</a></li><li><a shape="rect" href="configuration.html">组态</a></li><li><a shape="rect" href="debugging-and-logging.html">调试和记录</a></li><li><a shape="rect" href="tools.html">工具类</a></li><li><a shape="rect" href="restful-services.html">RESTful服务</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL绑定</a></li><li><a shape="rect" href="service-routing.html">服务路由</a></li><li><a shape="rect" href="dynamic-languages.html">动态语言</a></li><li><a shape="rect" href="ws-support.html">WS- *支持</a></li><li><a shape="rect" href="advanced-integration.html">进阶整合</a></li><li><a shape="rect" href="deployment.html">部署方式</a></li><li><a shape="rect" href="schemas-and-namespaces.html">模式和命名空间的使用</a></li></ul><hr><ul class="alternate"><li><p>搜索</p></li></ul><form id="cse-search-box" enctype="application/x-www-form-urlencoded" method="get" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="搜索">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF网站</a></li></ul><p> </p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><h2 id="ProviderServices-MessagingModes">讯息模式</h2>

<h3 id="ProviderServices-Overview">总览</h3>

<p>实现对象的对象<code>Provider</code>界面有两种<em>消息传递模式</em> ：</p>
<ul><li>讯息模式</li><li>有效负载模式</li></ul>


<p>您指定的消息传递模式确定传递给您的实现的消息传递详细信息的级别。</p>

<h3 id="ProviderServices-Messagemode">讯息模式</h3>

<p>使用<em>消息模式时</em> ， <code>Provider</code>实现可以处理完整的消息。完整的消息包括任何绑定特定的头和包装器。例如，一个<code>Provider</code>使用SOAP绑定的实现将以完全指定的SOAP消息的形式接收请求。从实现返回的任何响应也必须是完全指定的SOAP消息。</p>

<p>您指定一个<code>Provider</code>实现通过提供值使用消息模式<code>java.xml.ws.Service.Mode.MESSAGE</code>作为价值<code>javax.xml.ws.ServiceMode</code>注解。</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
@WebServiceProvider
@ServiceMode(value=Service.Mode.MESSAGE)
public class stockQuoteProvider implements Provider&lt;SOAPMessage&gt;
{
  ...
}
</pre>
</div></div>

<h3 id="ProviderServices-Payloadmode">有效负载模式</h3>

<p>在<em>有效负载模式下</em> <code>Provider</code>实现仅适用于消息的有效负载。例如，一个<code>Provider</code>有效负载模式下的实现仅适用于SOAP消息的主体。绑定层处理任何绑定级别的包装程序和标头。</p>
<div class="confluence-information-macro confluence-information-macro-tip"><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>当使用不使用特殊包装的绑定时，例如XML绑定，有效负载模式和消息模式将提供相同的结果。</p></div></div>
<p>您指定一个<code>Provider</code>实现通过提供值使用有效负载模式<code>java.xml.ws.Service.Mode.PAYLOAD</code>作为价值<code>javax.xml.ws.ServiceMode</code>注解。</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
@WebServiceProvider
@ServiceMode(value=Service.Mode.PAYLOAD)
public class stockQuoteProvider implements Provider&lt;DOMSource&gt;
{
  ...
}
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-tip"><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>如果您不提供<code>@ServiceMode</code>注释， <code>Provider</code>实施将默认为使用有效负载模式。</p></div></div>

<h2 id="ProviderServices-DataTypes">资料类型</h2>


<h3 id="ProviderServices-Overview.1">总览</h3>

<p><code>Provider</code>实现，因为它们是低级对象，所以不能使用与高级使用者API相同的JAXB生成的类型。提供者实现可与以下类型的对象一起使用：</p>
<ul><li><code>javax.xml.transform.Source</code></li><li><code>javax.xml.soap.SOAPMessage</code></li><li><code>javax.activation.DataSource</code></li></ul>


<h3 id="ProviderServices-UsingSourceobjects">使用<code>Source</code>对象</h3>

<p>一种<code>Provider</code>实现可以接受并返回从<code>javax.xml.transform.Source</code>接口。 <code>Source</code>对象是保存XML文档的低级对象。每<code>Source</code>实现提供了访问存储的XML文档并操纵其内容的方法。以下对象实现了<code>Source</code>接口：</p>
<ul><li><code>DOMSource</code>将XML消息保存为文档对象模型（DOM）树。XML消息存储为一组<code>Node</code>可以使用<code>getNode()</code>方法。节点可以使用以下命令进行更新或添加到DOM树中： <code>setNode()</code>方法。</li><li><code>SAXSource</code>将XML消息作为XML的简单API（SAX）对象保存。SAX对象包含一个<code>InputSource</code>包含原始数据和<code>XMLReader</code>解析原始数据的对象。</li><li><code>StreamSource</code>将XML消息保存为数据流。数据流可以像其他任何数据流一样进行操作。
<div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>使用时<code>Source</code>开发人员负责确保所有必需的绑定特定包装器都添加到消息中。例如，当与需要SOAP消息的服务进行交互时，开发人员必须确保将所需的SOAP信封添加到传出请求中，并且SOAP信封的内容正确。</p></div></div></li></ul>


<h3 id="ProviderServices-UsingSOAPMessageobjects">使用<code>SOAPMessage</code>对象</h3>

<p><code>Provider</code>实现可以使用<code>javax.xml.soap.SOAPMessage</code>当满足以下条件时，对象将被拒绝：</p>
<ul><li>的<code>Provider</code>实现是使用SOAP绑定。</li><li>的<code>Provider</code>实现是使用消息模式。</li></ul>


<p>一种<code>SOAPMessage</code>顾名思义，对象包含SOAP消息。它们包含一个<code>SOAPPart</code>对象且零个或多个<code>AttachmentPart</code>对象。的<code>SOAPPart</code>对象包含SOAP消息的SOAP特定部分，包括SOAP信封，任何SOAP标头和SOAP消息主体。的<code>AttachmentPart</code>对象包含作为附件传递的二进制数据。</p>

<h3 id="ProviderServices-UsingDataSourceobjects">使用<code>DataSource</code>对象</h3>

<p>提供者实现可以使用实现以下目标的对象： <code>javax.activation.DataSource</code>满足以下条件时，界面：</p>
<ul><li>该实现使用HTTP绑定。</li><li>该实现使用消息模式。</li></ul>


<p><code>DataSource</code>对象提供了一种机制，用于处理来自各种来源（包括URL，文件和字节数组）的MIME类型的数据。</p>

<h3 id="ProviderServices-ImplementingaProviderObject">实现提供者对象</h3>


<h4 id="ProviderServices-Overview.2">总览</h4>

<p>的<code>Provider</code>接口相对容易实现。它只有一种需要实现的方法invoke（）。此外，它具有三个简单的要求：</p>
<ul><li>实现必须具有<code>@WebServiceProvider</code>注解。</li><li>实现必须具有默认的公共构造函数。</li><li>实现必须实现Provider接口的类型化版本。<br class="atl-forced-newline" clear="none">换句话说，您无法实施<code>Provider<T></code>接口。您必须实现使用具体数据类型的接口版本。例如，您可以实现一个实例<code>Provider<SAXSource></code> 。</li></ul>


<p>实现Provider接口的复杂性在于处理请求消息和构建适当的响应。</p>

<h4 id="ProviderServices-Workingwithmessages">处理消息</h4>

<p>与基于更高级别的SEI的服务实现不同， <code>Provider</code>实现将请求作为原始XML数据接收，并且必须将响应作为原始XML数据发送。这要求开发人员对正在实施的服务所使用的消息有深入的了解。这些详细信息通常可以在描述服务的WSDL文档中找到。</p>

<p>WS-I Basic Profile提供了有关服务使用的消息的准则，包括：</p>
<ul><li>请求的根元素基于该请求的name属性值<code>wsdl:operation</code>对应于被调用的操作的元素。
<div class="confluence-information-macro confluence-information-macro-warning"><span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>如果该服务使用doc / literal裸消息，则请求的根元素将基于该属性的name属性值<code>wsdl:part</code>所指的元素<code>wsdl:operation</code>元件。</p></div></div></li><li>所有消息的根元素将是名称空间限定的。</li><li>如果服务使用rpc / literal消息，则消息中的顶级元素将不符合名称空间要求。
<div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>顶级元素的子级可能是名称空间限定的。可以肯定的是，您需要检查其架构定义。</p></div></div></li><li>如果服务使用rpc /文字消息，则任何顶级元素都不能为null。</li><li>如果服务使用doc / literal消息，则消息的架构定义将确定是否有任何元素符合名称空间要求。</li></ul>


<h3 id="ProviderServices-Implementingtheinvoke()method">实施<code>invoke()</code>方法</h3>

<p>的<code>Provider</code>界面只有一种方法， <code>invoke()</code> ，则需要实施。 <code>invoke()</code>接收传入的请求，该请求打包为的类型声明的对象的类型<code>Provider</code>接口正在实现，并返回打包到相同类型对象中的响应消息。例如， <code>Provider<SOAPMessage></code>介面会以<code>SOAPMessage</code>对象并以a的形式返回响应<code>SOAPMessage</code>宾语。</p>

<p>消息传递模式<code>Provider</code>实现确定请求和响应消息包含的绑定特定信息的数量。使用消息模式的实现将接收所有绑定特定的包装器和标头以及请求。他们还必须将所有绑定特定的包装器和标头添加到响应消息中。使用有效负载模式的实现仅接收请求的主体。使用有效负载模式的实现返回的XML文档将放置在请求消息的主体中。</p>

<h3 id="ProviderServices-Examples">例子</h3>

<p>下面显示了一个<code>Provider</code>适用的实现<code>SOAPMessage</code>消息模式下的对象。</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
import javax.xml.ws.Provider;
import javax.xml.ws.Service;
import javax.xml.ws.ServiceMode;
import javax.xml.ws.WebServiceProvider;

@WebServiceProvider(portName="stockQuoteReporterPort" 
    serviceName="stockQuoteReporter")
@ServiceMode(value="Service.Mode.MESSAGE")
public class  stockQuoteReporterProvider 
    implements Provider&lt;SOAPMessage&gt; 
{
  public stockQuoteReporterProvider() 
  {
  }

  public SOAPMessage invoke(SOAPMessage request) 
  {
    SOAPBody requestBody = request.getSOAPBody();
    if(requestBody.getElementName.getLocalName.equals("getStockPrice"))
    {
      MessageFactory mf = MessageFactory.newInstance();
      SOAPFactory sf = SOAPFactory.newInstance();

      SOAPMessage response = mf.createMessage();
      SOAPBody respBody = response.getSOAPBody();
      Name bodyName = sf.createName("getStockPriceResponse");
      respBody.addBodyElement(bodyName);
      SOAPElement respContent = respBody.addChildElement("price");
      respContent.setValue("123.00");
      response.saveChanges();
      return response;
    }
    ...
  }
}
</pre>
</div></div>
<p>该代码执行以下操作：</p>
<ol><li>指定以下类实现一个<code>Provider</code>实现服务的对象<code>wsdl:service</code>元素被命名<code>stockQuoteReporter</code>和谁<code>wsdl:port</code>元素被命名<code>stockQuoteReporterPort</code> 。</li><li>指定此<code>Provider</code>实现使用消息模式。</li><li>提供所需的默认公共构造函数。</li><li>提供了<code>invoke()</code>需要的方法<code>a SOAPMessage</code>对象并返回一个<code>SOAPMessage</code>宾语。</li><li>从传入的SOAP消息的主体中提取请求消息。</li><li>检查请求消息的根元素以确定如何处理请求。</li><li>创建构建响应所需的工厂。</li><li>构建用于响应的SOAP消息。</li><li>以SOAPMessage对象的形式返回响应。</li></ol>


<p>下面显示了在有效负载模式下使用DOMSource对象的Provider实现的示例。</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
import javax.xml.ws.Provider;
import javax.xml.ws.Service;
import javax.xml.ws.ServiceMode;
import javax.xml.ws.WebServiceProvider;

@WebServiceProvider(portName="stockQuoteReporterPort"
  serviceName="stockQuoteReporter")
@ServiceMode(value="Service.Mode.PAYLOAD")
public class  stockQuoteReporterProvider implements Provider&lt;DOMSource&gt;
{
  public stockQuoteReporterProvider()
  {
  }

  public DOMSource invoke(DOMSource request)
  {
    DOMSource response = new DOMSource();
    ...
    return response;
  }
}
</pre>
</div></div>
<p>该代码执行以下操作：</p>
<ol><li>指定该类实现一个<code>Provider</code>实现服务的对象<code>wsdl:service</code>元素被命名<code>stockQuoteReporter</code>和谁<code>wsdl:port</code>元素被命名<code>stockQuoteReporterPort</code> 。</li><li>指定此Provider实现使用有效负载模式。</li><li>提供所需的默认公共构造函数。</li><li>提供了<code>invoke()</code>需要一个方法<code>DOMSource</code>对象并返回一个<code>DOMSource</code>宾语。</li></ol></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </tbody></table>
   </td>
   <td id="cell-2-2" colspan="2"> </td>
  </tr>
  <tr>
   <td id="cell-3-0"> </td>
   <td id="cell-3-1"> </td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">隐私政策</a> -（ <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=59880">编辑页面</a> ）（ <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=59880&showComments=true&showCommentArea=true#addcomment">添加评论</a> ）<br>Apache CXF，CXF，Apache，Apache Feather徽标是The Apache Software Foundation的商标。<br>提及的所有其他商标可能是其各自所有者的商标或注册商标。
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3"> </td>
   <td id="cell-3-4"> </td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2"> </td>
    <td id="cell-4-1"> </td>
    <td id="cell-4-2" colspan="2"> </td>
  </tr>
</tbody></table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>




</body></html>