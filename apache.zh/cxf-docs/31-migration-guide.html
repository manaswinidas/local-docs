<html ><head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - 3.1 Migration Guide">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>Apache CXF-3.1迁移指南</title>
  </head>
<body  onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td id="cell-0-0" colspan="2"> </td>
    <td id="cell-0-1"> </td>
    <td id="cell-0-2" colspan="2"> </td>
  </tr>
  <tr>
    <td id="cell-1-0"> </td>
    <td id="cell-1-1"> </td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight:bold;font-size:170%;color:white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="阿帕奇软件基金会"><img border="0" alt="ASF徽标" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></tbody></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tbody><tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs --> <a href="index.html">指数</a> > <a href="how-tos.html">入门指南</a> > <a href="migration-guides.html">迁移指南</a> > <a href="31-migration-guide.html">3.1迁移指南</a> <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">下载</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">文献资料</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </tbody></table>
      </div>
    </td>
    <td id="cell-1-3"> </td>
    <td id="cell-1-4"> </td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2"> </td>
    <td id="cell-2-1">
      <table>
        <tbody><tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">总览</a></li><li><a shape="rect" href="how-tos.html">操作方法</a></li><li><a shape="rect" href="frontends.html">前端</a></li><li><a shape="rect" href="databindings.html">数据绑定</a></li><li><a shape="rect" href="transports.html">运输工具</a></li><li><a shape="rect" href="configuration.html">组态</a></li><li><a shape="rect" href="debugging-and-logging.html">调试和记录</a></li><li><a shape="rect" href="tools.html">工具类</a></li><li><a shape="rect" href="restful-services.html">RESTful服务</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL绑定</a></li><li><a shape="rect" href="service-routing.html">服务路由</a></li><li><a shape="rect" href="dynamic-languages.html">动态语言</a></li><li><a shape="rect" href="ws-support.html">WS- *支持</a></li><li><a shape="rect" href="advanced-integration.html">进阶整合</a></li><li><a shape="rect" href="deployment.html">部署方式</a></li><li><a shape="rect" href="schemas-and-namespaces.html">模式和命名空间的使用</a></li></ul><hr><ul class="alternate"><li><p>搜索</p></li></ul><form id="cse-search-box" enctype="application/x-www-form-urlencoded" method="get" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="搜索">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF网站</a></li></ul><p> </p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><h3 id="id-3.1MigrationGuide-MajorNotes">重要事项</h3><ul><li>CXF 3.1不再支持Java 6。您必须使用Java 7或Java 8。</li><li>JAX-WS / Simple前端ServerFactoryBean将在create（）调用结束时自动调用reset。这样可以清理资源并更快地收集垃圾。但是，它也可以防止多次调用create（）共享相同的ServerInfo / EndpointInfo / etc ...对象，就像我们3.0.x一样。由于共享存储在那些对象上的属性（例如令牌缓存），这种共享在过去引起了很多问题，因此新行为更“正确”，但与以前的版本不同，因此在升级时必须小心。</li><li>安装“ cxf”功能部件时，CXF 3.1的Karaf features.xml文件将不再安装spring或spring-dm。如果需要spring / spring-dm，则需要先安装这些功能，然后再安装CXF功能。</li></ul><h3 id="id-3.1MigrationGuide-Securitychanges">安全变更</h3><ul><li>现在，STS（安全令牌服务）默认使用RSA-SHA256签名算法（以前是RSA-SHA1）和SHA-256摘要算法（以前是SHA-1）来发行令牌。</li><li>一些安全配置标签已从“ ws-security。*”重命名为“ security。*”，因为它们现在已与（某些）JAX-RS堆栈共享。旧标签将继续像以前一样工作，但是没有任何更改。有关更多信息，请参见“ <a shape="rect" href="security-configuration.html">安全性配置”</a>页面。</li><li>以前在cxf-rt-security-模块中可用的SAML / XACML功能现在在cxf-rt-security-saml模块中。</li><li>如果要在SAML CallbackHandler中明确指定SAML版本，则由于要使用OpenSAML 3.1进行迁移，因此在CXF 3.1中对此进行了更改。现在使用org.apache.wss4j.common.saml.bean在SAMLCallback上设置该版本。版本类。以前，存在对OpenSAML的SAMLVersion类的依赖。</li><li>如果希望更改特定策略的默认验证逻辑，现在可以“插入”定制WS-SecurityPolicy验证器。</li></ul><h3 id="id-3.1MigrationGuide-NewFeatures">新的功能</h3><ul><li>CXF JAX-WS代码生成器具有一个新选项“ seiSuper”，可用于为SEI指定其他超级接口。这使得代码不可移植到其他JAX-WS容器。主要用途是将AutoCloseable添加到接口，以允许Java7中的客户端尝试使用资源块。</li><li>新的度量标准功能，用于收集有关CXF服务的度量标准。包括基于Codahale / DropWizard的收集器。</li><li>新的限制功能可轻松限制CXF服务。包含的样本使用Metrics组件帮助做出节流决策。</li><li>新的日志记录功能比cxf-core中可用的日志记录提供更高级的日志记录</li><li>SAML SSO的新元数据服务，使您可以为服务提供商发布SAML SSO元数据。</li><li><p>现在，JAX-WS代码生成器的“ cxf”前端（-fe cxf）生成的代码对Java7友好得多，因为getPort（...）调用的返回类型是SEI的子接口。还实现了AutoCloseable，BindingProvider和Client。以前的代码如下：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">(AddNumbersPortType port = service.getAddNumbersPort();
((BindingProvider)port).getRequestContext()
        .put(BindingProvider.ENDPOINT_ADDRESS_PROPERTY, address);
port.addNumbers3(-1, 2);
((Closeable)port).close();</pre>
</div></div><p>可以替换为：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">try (AddNumbersPortTypeProxy port = service.getAddNumbersPort()) {
    port.getRequestContext().put(BindingProvider.ENDPOINT_ADDRESS_PROPERTY, address);
    port.addNumbers3(-1, 2);
}</pre>
</div></div></li></ul><h3 id="id-3.1MigrationGuide-MajorDependencyChanges">主要依赖性变化</h3><ul><li>基于Jetty的HTTP传输已更新为支持Jetty 9和Jetty 8。但是，对Jetty 7的支持已被删除。</li><li>由于Jetty升级，已不再支持在Karaf 2.3.x中运行基于Jetty的端点。</li><li>删除了对使用基于JAX-WS 2.1的API jar的支持。Java 7（现在需要）包括JAX-WS 2.2，因此这不是问题。</li><li>包含WSS4J 2.1，而后者又包含OpenSAML 3.0。</li></ul></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </tbody></table>
   </td>
   <td id="cell-2-2" colspan="2"> </td>
  </tr>
  <tr>
   <td id="cell-3-0"> </td>
   <td id="cell-3-1"> </td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">隐私政策</a> -（ <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=44303725">编辑页面</a> ）（ <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=44303725&showComments=true&showCommentArea=true#addcomment">添加评论</a> ）<br>Apache CXF，CXF，Apache，Apache Feather徽标是The Apache Software Foundation的商标。<br>提及的所有其他商标可能是其各自所有者的商标或注册商标。
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3"> </td>
   <td id="cell-3-4"> </td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2"> </td>
    <td id="cell-4-1"> </td>
    <td id="cell-4-2" colspan="2"> </td>
  </tr>
</tbody></table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>




</body></html>