<html ><head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - JavaScript Client Code">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script src='/resources/highlighter/scripts/shBrushXml.js'></script>
<script src='/resources/highlighter/scripts/shBrushJScript.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>Apache CXF-JavaScript客户端代码</title>
  </head>
<body  onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td id="cell-0-0" colspan="2"> </td>
    <td id="cell-0-1"> </td>
    <td id="cell-0-2" colspan="2"> </td>
  </tr>
  <tr>
    <td id="cell-1-0"> </td>
    <td id="cell-1-1"> </td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight:bold;font-size:170%;color:white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="阿帕奇软件基金会"><img border="0" alt="ASF徽标" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></tbody></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tbody><tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs --> <a href="index.html">索引</a> > <a href="dynamic-languages.html">动态语言</a> > <a href="javascript-clients.html">JavaScript客户端</a> > <a href="javascript-client-code.html">JavaScript客户端代码</a> <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">下载</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">文献资料</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </tbody></table>
      </div>
    </td>
    <td id="cell-1-3"> </td>
    <td id="cell-1-4"> </td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2"> </td>
    <td id="cell-2-1">
      <table>
        <tbody><tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">总览</a></li><li><a shape="rect" href="how-tos.html">操作方法</a></li><li><a shape="rect" href="frontends.html">前端</a></li><li><a shape="rect" href="databindings.html">数据绑定</a></li><li><a shape="rect" href="transports.html">运输工具</a></li><li><a shape="rect" href="configuration.html">组态</a></li><li><a shape="rect" href="debugging-and-logging.html">调试和记录</a></li><li><a shape="rect" href="tools.html">工具类</a></li><li><a shape="rect" href="restful-services.html">RESTful服务</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL绑定</a></li><li><a shape="rect" href="service-routing.html">服务路由</a></li><li><a shape="rect" href="dynamic-languages.html">动态语言</a></li><li><a shape="rect" href="ws-support.html">WS- *支持</a></li><li><a shape="rect" href="advanced-integration.html">进阶整合</a></li><li><a shape="rect" href="deployment.html">部署方式</a></li><li><a shape="rect" href="schemas-and-namespaces.html">模式和命名空间的使用</a></li></ul><hr><ul class="alternate"><li><p>搜索</p></li></ul><form id="cse-search-box" enctype="application/x-www-form-urlencoded" method="get" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="搜索">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF网站</a></li></ul><p> </p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><h1 id="JavaScriptClientCode-StructureoftheCode">守则的结构</h1>

<p>共有三种类型的JavaScript代码：</p>
<ul><li>实用工具</li><li>架构图</li><li>服务</li></ul>


<h1 id="JavaScriptClientCode-Utilities">实用工具</h1>

<p>实用程序代码是一组固定的JavaScript，可提供一些浏览器兼容性和XML管理。该代码在发行版的etc / cxf-utils.js文件中提供。如果您使用的是？js URL处理程序，它将在响应开始时交付（ <em>除非</em>您将＆nojsutils添加到URL）。如果要使用这些工具生成JavaScript，则取决于您是否要复制此文件并使用它。</p>

<h1 id="JavaScriptClientCode-SchemaCode">模式代码</h1>

<p>模式代码为服务中使用的每个“ bean”生成一个对象。此代码由XML Schema进行组织。每个模式的代码均以如下注释开头：</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
//
// Definitions for schema: http://apache.org/hello_world_soap_http/types
//  file:/home/benson/cxf/trunk/distribution/src/main/release/samples/js_browser_client/wsdl/hello_world.wsdl#types1
//
</pre>
</div></div>

<p>生成器为模式中的每个全局复杂类型和元素生成一个JavaScript构造函数。通常，您会发现服务方法是根据类型而不是元素定义的。但是，根据您使用的是Document还是RPC，以及确切地配置部件和类型的方式，您可能会发现一种特定的方法是根据基于“元素”的JavaScript类型而不是基于“ type”的-基础课。</p>

<p>类型的典型JavaScript类如下所示：</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
function apache_org_hello_world_soap_http_types_sayHiResponse () {
    this._responseType = '';
}

function apache_org_hello_world_soap_http_types_sayHiResponse_getResponseType() { return this._responseType;}
apache_org_hello_world_soap_http_types_sayHiResponse.prototype.getResponseType = 
  apache_org_hello_world_soap_http_types_sayHiResponse_getResponseType;
function apache_org_hello_world_soap_http_types_sayHiResponse_setResponseType(value) {this._responseType = value;}
apache_org_hello_world_soap_http_types_sayHiResponse.prototype.setResponseType = 
  apache_org_hello_world_soap_http_types_sayHiResponse_setResponseType;

</pre>
</div></div>

<p>这是一种非常简单的类型，从文档/文字服务的返回部分派生而来。它具有一个称为“ responseType”的数据。请注意，这里的代码风格是在“私有”属性上定义获取器和设置器。该代码没有详细说明使这些属性<em>私有</em> ；它只是在名称的前面加上_。</p>

<h1 id="JavaScriptClientCode-ServiceCode">服务编号</h1>

<p>服务的代码以注释开头，然后是每个服务对象的构造函数：</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
// Javascript for {http://apache.org/hello_world_soap_http}Greeter

function apache_org_hello_world_soap_http_Greeter () {
    this.jsutils = new CxfApacheOrgUtil();
    this.synchronous = false;
    this.url = null;
    this.client = null;
    this.response = null;
    this._onsuccess = null;
    this._onerror = null;
}
</pre>
</div></div>

<p>这里定义了两个重要的属性： <strong>url</strong>和<strong>sync</strong> 。</p>

<h2 id="JavaScriptClientCode-URL">网址</h2>

<p>您负责使用Web服务的URL设置url属性。生成的JavaScript不包含任何服务和端口的概念。您只需将适当的URL放入属性中。<strong>注意：</strong> CXF的JavaScript客户端不支持交叉脚本。如果要交叉脚本，可以选择以下几种：</p>
<ul><li>坚持使用Mozilla / Firefox并签名代码。</li><li>修改utils，以使用一些常见的变通办法，这些变通办法允许在某些情况下在某些浏览器中进行跨脚本编写。</li></ul>


<h2 id="JavaScriptClientCode-SynchronousandAsynchronousprocessing">同步和异步处理</h2>

<p>CXF JavaScript代码生成器旨在促进典型的AJAX异步处理。如下所述，每操作函数将回调作为参数，并在服务器响应时回调它们。如果要使用同步通信，可以将“ synchronous”属性设置为“ true”。那不会改变API，而是会改变行为。使用此设置，直到服务器响应并回调了回调之后，操作函数才返回。</p>

<h2 id="JavaScriptClientCode-Per-OperationFunctions">每种功能</h2>

<p>代码生成器为每个操作生成一个函数。除非该操作是<strong>一种方法</strong> ，否则该函数将使用两个回调参数，以及该操作本身的参数。前两个参数是成功回调和错误回调。OneWay操作没有回调。他们是“生而忘之”。</p>

<p>使用一个参数来回调成功回调：与响应相对应的JavaScript对象。</p>

<p>那是什么东西？好吧，这取决于操作的模式。如果使用的是Document / Literal / Wrapped，它将是与输出部分的包装器对象相对应的JavaScript对象。如果您使用的是“文档/文字/裸露”，它将与输出部分相对应。如果输出部分具有简单类型（例如String），则将使用简单的JavaScript对象调用响应回调。</p>

<p>仅当服务器以HTTP错误状态响应时，才会调用错误回调。将使用两个参数来调用它：HTTP状态号和HTTP状态文本。</p>

<p>当/如果客户端JavaScript生成器经过改进以对错误提供更全面的支持，则协议将更改为通过<br clear="none">故障信息作为错误回调的第三个参数。</p>

<h2 id="JavaScriptClientCode-UnderstandingtheParametersofOperationFunctions">了解运算功能的参数</h2>

<p>如果您在此问题上有选择，并且使用的是“文档/文档”，那么本作者建议使用<strong>裸</strong>方法而不是<strong>包装</strong>方法。这会将所有类型管理从前端（JAX-WS或Simple）推到数据绑定（JAXB或Aegis）。与前端相比，数据绑定提供了对名称空间，minOccurs等更清晰的配置控制。</p>

<p>通常，在复杂的情况下，您可能会觉得需要阅读JavaScript代码来理解绑定。生成器的一种可能的未来增强是生成更多注释，甚至HTML解释，以帮助完成此过程。</p>

<h2 id="JavaScriptClientCode-ExamplesofCallingServices">通话服务示例</h2>

<p>以下是一些服务呼叫摘要。您应该期望检查生成的JavaScript以了解类和函数的名称。</p>

<h3 id="JavaScriptClientCode-ADocument/Literal/BareService">文件/文学/裸露服务</h3>

<p>本作者发现，至少对于JAX-WS，BARE有很多推荐的地方，因为它避免了JAX-WS和JAXB之间令人惊讶的交互。</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">

function errorCallback(httpStatus, httpStatusText) 
{
	globalErrorStatus = httpStatus; // integer HTTP status
	globalStatusText = httpStatusText; // Textual HTTP status
}

function successCallback(responseObject) 
{
// the parameter is an object of the type declared for the
// method.
	globalResponseObject = responseObject;
}

function compliantTest(url)
{
    var intf;
    // class for the service.
    intf = new org_apache_cxf_javascript_fortest_SimpleDocLitBare();
    intf.url = url;
    var bareParam = new my_param_class_object();
    bareParam.setWhatever(someValue);
    // ...
    intf.compliant(successCallback, errorCallback, bareParam); 
}

</pre>
</div></div>

<h3 id="JavaScriptClientCode-xs:anyExample:UsingaDescribedType">xs：any示例：使用描述的类型</h3>

<p>以下函数调用Document / Literal / Bare方法。裸参数元素声明为：</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;element name="acceptAny1"&gt;
 &lt;complexType&gt;
  &lt;sequence&gt;
    &lt;element name='before' type='string' /&gt;
    &lt;any minOccurs='1' maxOccurs='1' namespace='##other' /&gt;
    &lt;element name='after' type='string' /&gt;
  &lt;/sequence&gt;
 &lt;/complexType&gt;
&lt;/element&gt;
</pre>
</div></div>

<p>该模式的目标名称空间是<strong>uri：cxf.apache.org：jstest：types：any</strong> 。</p>

<p>这个特定的xs：any允许来自某个名称空间的任何单个XML元素，而不是包含“ acceptAny1”的架构的目标名称空间。<br clear="none">（请注意，JAXB仅对## other支持xs：any，并将其解释为禁止不合格的元素。如果您需要更大的灵活性，请考虑<br clear="none">另一个数据绑定。）</p>

<p>WSDL包含对另一个模式的引用，其目标命名空间为<strong>uri：cxf.apache.org：jstest：types：any：alts</strong> 。该名称空间包括<br clear="none">一个名为<strong>Alternative1</strong>的元素。在下面的函数中，JavaScript为服务创建一个对象，然后为acceptAny1元素创建一个对象。</p>

<p>它为简单的<strong>before</strong>和<strong>after</strong>元素填充了插槽。</p>

<p>对于xs：any元素，它将创建一个类型为<strong>org_apache_cxf_any_holder</strong>的对象。在cxf-utils.js中定义的此类型包含元素的对象<br clear="none">在WSDL模式中定义。要构造一个，请提供元素的URI和本地名称，然后提供值。对于内置类型，请使用XML模式URI。<br clear="none">（ <a shape="rect" class="external-link" href="http://www.w3.org/2001/XMLSchema" rel="nofollow">http://www.w3.org/2001/XMLSchema</a> ）和类型名称（例如'string'）。</p>


<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
function testAny1ToServerChalk(url)
{
	var service = new cxf_apache_org_jstest_any_AcceptAny();
	service.url = url;
	var param = new cxf_apache_org_jstest_types_any_acceptAny1();
	param.setBefore("before chalk");
	var anyOb = new cxf_apache_org_jstest_types_any_alts_alternative1();
	anyOb.setChalk("bismuth");
	var holder = new org_apache_cxf_any_holder("uri:cxf.apache.org:jstest:types:any:alts", "alternative1", anyOb);
	param.setAny(holder);
	param.setAfter("after chalk");
	service.acceptAny1(param);
}
</pre>
</div></div>

<p>如果您的xs：any要求多个项目怎么办？您提供了一组支架，因为每个支架可能是不同的元素。</p>

<h3 id="JavaScriptClientCode-xs:anyUsingRawXML">xs：any使用原始XML</h3>

<p>CXF还允许您自己提供XML。您提供的XML必须有效。如果元素合格，则必须<br clear="none">使用适当的xmlns属性定义名称空间定义。这是一个例子。请注意，在此示例中，<br clear="none">元素合格；它位于<strong>uri：iam</strong>命名空间中。JAXB不允许使用不合格的元素（至少在当前版本中<br clear="none">CXF使用的参考实现）。</p>

<p>如果您的xs：any接受多个元素，则为单个持有人提供一个包含多个元素的XML片段。</p>

<p>注意使用<strong>org_apache_cxf_raw_any_holder</strong>将XML传递给CXF。</p>

<p>还要注意，CXF不支持从服务器传递到客户端的原始XML。在返回值中，您将始终找到一个<br clear="none">org_apache_cxf_any_holder。但是，原始持有人的“原始”属性值为“ true”，非原始持有人的“原始”属性值为<br clear="none">'假'。可以增强CXF以支持稍后将未描述的元素传递给JavaScript。</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
function testAny1ToServerRaw(url)
{
	var service = new cxf_apache_org_jstest_any_AcceptAny();
	service.url = url;
	var param = new cxf_apache_org_jstest_types_any_acceptAny1();
	param.setBefore("before chalk");
	var holder = new org_apache_cxf_raw_any_holder("&lt;walrus xmlns='uri:iam'&gt;tusks&lt;/walrus&gt;");
	param.setAny(holder);
	param.setAfter("after chalk");
	service.acceptAny1(param);
}
</pre>
</div></div></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </tbody></table>
   </td>
   <td id="cell-2-2" colspan="2"> </td>
  </tr>
  <tr>
   <td id="cell-3-0"> </td>
   <td id="cell-3-1"> </td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">隐私政策</a> -（ <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=72736">编辑页面</a> ）（ <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=72736&showComments=true&showCommentArea=true#addcomment">添加评论</a> ）<br>Apache CXF，CXF，Apache，Apache Feather徽标是The Apache Software Foundation的商标。<br>提及的所有其他商标可能是其各自所有者的商标或注册商标。
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3"> </td>
   <td id="cell-3-4"> </td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2"> </td>
    <td id="cell-4-1"> </td>
    <td id="cell-4-2" colspan="2"> </td>
  </tr>
</tbody></table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>




</body></html>