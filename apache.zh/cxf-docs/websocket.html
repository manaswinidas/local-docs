<html ><head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - WebSocket">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script src='/resources/highlighter/scripts/shBrushBash.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>Apache CXF-WebSocket</title>
  </head>
<body  onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td id="cell-0-0" colspan="2"> </td>
    <td id="cell-0-1"> </td>
    <td id="cell-0-2" colspan="2"> </td>
  </tr>
  <tr>
    <td id="cell-1-0"> </td>
    <td id="cell-1-1"> </td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight:bold;font-size:170%;color:white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="阿帕奇软件基金会"><img border="0" alt="ASF徽标" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></tbody></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tbody><tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs --> <a href="index.html">索引</a> > <a href="transports.html">传输</a> > <a href="websocket.html">WebSocket</a> <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">下载</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">文献资料</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </tbody></table>
      </div>
    </td>
    <td id="cell-1-3"> </td>
    <td id="cell-1-4"> </td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2"> </td>
    <td id="cell-2-1">
      <table>
        <tbody><tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">总览</a></li><li><a shape="rect" href="how-tos.html">操作方法</a></li><li><a shape="rect" href="frontends.html">前端</a></li><li><a shape="rect" href="databindings.html">数据绑定</a></li><li><a shape="rect" href="transports.html">运输工具</a></li><li><a shape="rect" href="configuration.html">组态</a></li><li><a shape="rect" href="debugging-and-logging.html">调试和记录</a></li><li><a shape="rect" href="tools.html">工具类</a></li><li><a shape="rect" href="restful-services.html">RESTful服务</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL绑定</a></li><li><a shape="rect" href="service-routing.html">服务路由</a></li><li><a shape="rect" href="dynamic-languages.html">动态语言</a></li><li><a shape="rect" href="ws-support.html">WS- *支持</a></li><li><a shape="rect" href="advanced-integration.html">进阶整合</a></li><li><a shape="rect" href="deployment.html">部署方式</a></li><li><a shape="rect" href="schemas-and-namespaces.html">模式和命名空间的使用</a></li></ul><hr><ul class="alternate"><li><p>搜索</p></li></ul><form id="cse-search-box" enctype="application/x-www-form-urlencoded" method="get" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="搜索">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF网站</a></li></ul><p> </p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>本页总结了CXF中WebSocket支持的当前状态。该功能当前仅在中继（CXF 3.0.0-SNAPSHOT）中可用。</p></div></div><h1 id="WebSocket-UsingtheWebSockettransport">使用WebSocket传输</h1><p>在CXF中提供WebSocket传输的意图是使CXF端点服务能够通过连接到客户端的套接字读取或写入数据。例如，一旦客户端建立到服务的WebSocket连接，使用WebSocket传输的JAXRS服务就可以连续向客户端推送或写入数据（例如，状态更改，事件等）。</p><p> </p><h1 id="WebSocket-CurrentStatus">当前状态</h1><h3 id="WebSocket-Shortsummary">简短的摘要</h3><ul style="list-style-type:square"><li>该代码位于rt / transport / http-websocket中，它使cxf服务可以通过websockets调用。</li><li>它同时支持嵌入式模式和servlet容器模式。前者可以在使用嵌入式码头服务器的独立设置中使用，而后者可以在使用由容器提供的servlet容器的容器设置中使用。</li><li>一些测试用例位于systests / jaxrs / src / test / java / org / apache / cxf / systest / jaxrs / websocket和systests / jaxws / src / test / java / org / apache / cxf / systest / jaxws / websocket中。在distribution / src / main / release / samples / jax_rs / websocket上还有一个基于浏览器的演示。</li><li>根据使用情况，需要几个其他的库才能启用此功能。具体而言，嵌入式独立模式需要jetty-websocket（即，端点由主机和端口部分指定，如address =“ <a shape="rect" href="javascript:void(0);" rel="nofollow">ws：// host：port / path</a> ”）。对于servlet模式（即，端点是使用相对路径（即address =“ / path”）给出的，它要求jetty-websocket使用jetty或大气运行时，并且需要特定的websocket实现（例如jetty-websocket或tomcat-websocket使用该特定容器的websocket功能。</li></ul><h3 id="WebSocket-UsagePatterns">使用方式</h3><p><span style="font-size:14.0px;line-height:1.4285715">我们具有以下消息交换模式，可将此Websocket传输用于cxf服务调用。</span></p><ol><li>客户端打开一个Websocket到一些托管cxf服务的URL（例如<a shape="rect" href="javascript:void(0);" rel="nofollow">ws：// localhost：8080 / cxf / myapp / books</a> ）</li><li><p><span style="line-height:1.4285715">客户端随后可以通过发送简化HTTP请求消息的请求消息来调用此服务提供的操作（例如，/ myapp / books / order / 123上的书订购操作）。</span><br clear="none"><span style="line-height:1.4285715"><br clear="none"></span></p><div class="code panel pdl" style="border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px"><b>请求语法</b></div><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">Request = Request-Line CRLF
             *(( header ) CRLF)
             CRLF
             [ body ]

Request-Line  = Method SP Request-URI

</pre>
</div></div><p> </p><p>方法使用HTTP方法。</p><p>标头可以包括CXF确定操作所需并由操作本身期望的任何标头（例如Content-Type）。</p><br clear="none"><span style="line-height:1.4285715"><br clear="none"></span></li><li><p><span style="line-height:1.4285715">服务返回的响应消息以以下形式发送回客户端</span><br clear="none"><span style="line-height:1.4285715"><br clear="none"></span></p><div class="code panel pdl" style="border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px"><b>请求语法</b></div><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">Response = [ Status-Line CRLF ]
           *(( header ) CRLF)
           CRLF
           [ body ]

Status-Line = Status-Code
&#160;</pre>
</div></div><p> </p><p>状态代码使用HTTP状态代码。</p><br clear="none"><span style="line-height:1.4285715"><br clear="none"></span></li><li><span style="line-height:1.4285715"> </span>服务随后可以使用jaxrs StreamingOuptut推送进一步的数据，或写入注入的Servlet响应的输出流。在这种情况下，消息只是不带状态行返回给客户端，并且可能包含也可能不包含标头。</li></ol><p>（注意：需要讨论上面的绑定语法）。</p><p> </p><h3 id="WebSocket-Furtherdetails">更多详情</h3><ul style="list-style-type:square"><li>当文本作为字节发送时，文本编码是固定的。<span style="line-height:1.4285715">当前，当以二进制模式发送文本时，假定其编码为utf-8。</span></li></ul><ul style="list-style-type:square"><li>如果客户端和服务要显式交换请求和响应序列，则它们负责在交换的消息的标头中传递一些id和ref-id，以便每个响应都可以与其请求相关联。</li><li>为了使异步返回的请求及其响应相互关联，请求消息可以包括RequestId头，并且相应的响应可以在其ResponseId头中设置此值。</li><li>可以使用websocket传输执行使用http传输使用解耦终结点执行的异步Web服务调用，而无需使用解耦终结点。</li></ul><h3 id="WebSocket-Openquestions">公开问题</h3><ul style="list-style-type:square"><li>content-length标头不用于确定消息的长度，因为可以使用其他方式（即，使用块模式时的长度或片段的指示符）确定websocket消息的消息结尾。因此尚不清楚我们是否可以过滤出内容长度。</li><li>协议格式需要澄清（有关当前使用的协议格式，请参见上文），并可能需要进行多种绑定绑定。</li></ul><h3 id="WebSocket-TODOsofimmediateinterests">切身利益TODO</h3><p> </p><ul><li>允许设置缓冲区大小以通过websocket切换到片段传输模式</li></ul><p>当前，覆盖out.write（byte [] b，int offset，int length）的内容将被写为websocket消息（例如，向客户端触发一个onMessage事件）。我们应该允许发送回一系列片段，并在刷新步骤终止传输（即out.flush（）或某种形式）。</p><ul><li>本地字符串消息传输</li></ul><p>当前，字符串被转换为utf-8字节，并使用websocket的字节传输模式发送。当websocket支持时，我们可以添加本地字符串/文本传输。但是，仅当实体主体不存在或字符串/文本时才应允许这样做。</p><ul><li>添加更多基于浏览器的示例客户端应用程序</li></ul><p>我们可以更新logbrowser示例。示例集合中有一个基于浏览器的演示（请参见上文）。该演示使用当前的默认绑定，该绑定不是javascript友好的。为了支持基于浏览器的应用程序，我们需要不同的绑定。</p><h3 id="WebSocket-TODOsoffutureinterests"><br clear="none">未来利益的待办事项</h3><ul><li>支持从客户端应用程序到服务应用程序的直接输出流连接。当前，从服务应用程序到客户端，在从客户端到服务的初始调用发生之后，直接输出流可以保持打开状态。因此，服务可以继续通过此输出流将数据直接推送到客户端。同样，建立从客户端到服务的直接输出流也很有趣，以便客户端可以继续将数据直接推送到服务。</li></ul><p> </p><p> </p><p> </p></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </tbody></table>
   </td>
   <td id="cell-2-2" colspan="2"> </td>
  </tr>
  <tr>
   <td id="cell-3-0"> </td>
   <td id="cell-3-1"> </td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">隐私政策</a> -（ <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=39621544">编辑页面</a> ）（ <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=39621544&showComments=true&showCommentArea=true#addcomment">添加评论</a> ）<br>Apache CXF，CXF，Apache，Apache Feather徽标是The Apache Software Foundation的商标。<br>提及的所有其他商标可能是其各自所有者的商标或注册商标。
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3"> </td>
   <td id="cell-3-4"> </td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2"> </td>
    <td id="cell-4-1"> </td>
    <td id="cell-4-2" colspan="2"> </td>
  </tr>
</tbody></table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>




</body></html>