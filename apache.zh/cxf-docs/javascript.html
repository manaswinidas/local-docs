<html ><head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - JavaScript">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script src='/resources/highlighter/scripts/shBrushBash.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>Apache CXF-JavaScript</title>
  </head>
<body  onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td id="cell-0-0" colspan="2"> </td>
    <td id="cell-0-1"> </td>
    <td id="cell-0-2" colspan="2"> </td>
  </tr>
  <tr>
    <td id="cell-1-0"> </td>
    <td id="cell-1-1"> </td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight:bold;font-size:170%;color:white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="阿帕奇软件基金会"><img border="0" alt="ASF徽标" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></tbody></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tbody><tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs --> <a href="index.html">索引</a> > <a href="dynamic-languages.html">动态语言</a> > <a href="javascript.html">JavaScript</a> <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">下载</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">文献资料</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </tbody></table>
      </div>
    </td>
    <td id="cell-1-3"> </td>
    <td id="cell-1-4"> </td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2"> </td>
    <td id="cell-2-1">
      <table>
        <tbody><tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">总览</a></li><li><a shape="rect" href="how-tos.html">操作方法</a></li><li><a shape="rect" href="frontends.html">前端</a></li><li><a shape="rect" href="databindings.html">数据绑定</a></li><li><a shape="rect" href="transports.html">运输工具</a></li><li><a shape="rect" href="configuration.html">组态</a></li><li><a shape="rect" href="debugging-and-logging.html">调试和记录</a></li><li><a shape="rect" href="tools.html">工具类</a></li><li><a shape="rect" href="restful-services.html">RESTful服务</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL绑定</a></li><li><a shape="rect" href="service-routing.html">服务路由</a></li><li><a shape="rect" href="dynamic-languages.html">动态语言</a></li><li><a shape="rect" href="ws-support.html">WS- *支持</a></li><li><a shape="rect" href="advanced-integration.html">进阶整合</a></li><li><a shape="rect" href="deployment.html">部署方式</a></li><li><a shape="rect" href="schemas-and-namespaces.html">模式和命名空间的使用</a></li></ul><hr><ul class="alternate"><li><p>搜索</p></li></ul><form id="cse-search-box" enctype="application/x-www-form-urlencoded" method="get" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="搜索">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF网站</a></li></ul><p> </p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><h1 id="JavaScript-UsingDynamicLanguagestoImplementServices">使用动态语言实施服务</h1>


<h2 id="JavaScript-Overview">总览</h2>

<p>JavaScript，也以正式名称ECMAScript着称，是在开发环境中越来越流行的众多动态语言之一。它提供了一种快速，轻量级的方法来创建可以在许多平台上运行的功能。JavaScript的另一个优势是可以快速重写应用程序。</p>

<p>CXF支持使用JavaScript和ECMAScript for XML（E4X）开发服务。用于开发这些服务的模式类似于JAX-WS <code>Provider</code>作为DOM文档处理其请求和响应（SOAP消息或SOAP负载）的实现。</p>

<h2 id="JavaScript-ImplementingaServiceinJavaScript">用JavaScript实施服务</h2>

<p>用JavaScript编写服务需要两个步骤：</p>
<ol><li>定义JAX-WS样式元数据。</li><li>实施服务业务逻辑。</li></ol>


<h3 id="JavaScript-DefiningtheMetadata">定义元数据</h3>

<p>普通的Java提供程序通常使用Java批注来指定JAX-WS元数据。由于JavaScript不支持注释，因此您可以使用普通的JavaScript变量为JavaScript实现指定元数据。CXF会处理代码中名称等于或开头的任何Javascript变量<code>WebServiceProvider</code>作为JAX-WS元数据变量。</p>

<p>变量的属性应指定与JAX-WS相同的元数据<code>WebServiceProvider</code>注释指定，包括：</p>

<ul><li><code>wsdlLocation</code>指定用于定义服务的WSDL的URL。</li><li><code>serviceName</code>指定服务的名称。</li><li><code>portName</code>指定服务的端口/接口名称。</li><li><code>targetNamespace</code>指定服务的目标名称空间。</li></ul>


<p>Javascript <code>WebServiceProvider</code>还可以指定以下可选属性：</p>
<ul><li><code>ServiceMode</code>指示指定的服务是处理SOAP负载文档还是完整的SOAP消息文档。该属性模仿JAX-WS <code>ServiceMode</code>注解。默认值为<code>PAYLOAD</code> 。</li><li><code>BindingMode</code>表示服务绑定ID URL。缺省值为SOAP 1.1 / HTTP绑定。</li><li><code>EndpointAddress</code>指示使用者应用程序用于与此服务进行通信的URL。该属性是可选的，但没有默认值。</li></ul>


<p><a shape="rect" href="javascript.html">示例1</a>显示了JavaScript服务实现的元数据描述。</p>

<p><span class="confluence-anchor-link" id="JavaScript-ex1"></span></p>
<div class="code panel pdl" style="border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px"><b>示例1：JavaScript元数据</b></div><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
var WebServiceProvider1 = {
    'wsdlLocation': 'file:./wsdl/hello_world.wsdl',
    'serviceName': 'SOAPService1',
    'portName': 'SoapPort1',
    'targetNamespace': 'http://apache.org/hello_world_soap_http',
};
</pre>
</div></div>

<h3 id="JavaScript-ImplementingtheServiceLogic">实施服务逻辑</h3>

<p>您可以使用所需的实现服务的逻辑<code>invoke</code>的属性<code>WebServiceProvider</code>变量。此变量是一个函数，它接受一个输入参数，即<code>javax.xml.transform.dom.DOMSource</code>节点，并返回相同类型的文档。的<code>invoke</code>函数可以使用常规Java操作输入或输出文档<code>DOMSource</code>类接口，就像Java应用程序一样。</p>

<p><a shape="rect" href="javascript.html">示例2</a>显示了<code>invoke</code>属性，用于简单的JavaScript服务实现。</p>

<p><span class="confluence-anchor-link" id="JavaScript-ex2"></span></p>
<div class="code panel pdl" style="border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px"><b>示例2：JavaScript服务实现</b></div><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
WebServiceProvider.invoke = function(document) {
    var ns4 = "http://apache.org/hello_world_soap_http/types";
    var list = document.getElementsByTagNameNS(ns4, "requestType");
    var name = list.item(0).getFirstChild().getNodeValue();
    var newDoc = document.getImplementation().createDocument(ns4, "ns4:greetMeResponse", null);
    var el = newDoc.createElementNS(ns4, "ns4:responseType");
    var txt = newDoc.createTextNode("Hi " + name);
    el.insertBefore(txt, null);
    newDoc.getDocumentElement().insertBefore(el, null);
    return newDoc;
}
</pre>
</div></div>
<h2 id="JavaScript-ImplementingaServiceinECMAScriptforXML(E4X)">在ECMAScript for XML（E4X）中实现服务</h2>

<p>使用E4X编写CXF服务与使用JavaScript编写服务非常相似。您使用相同的定义JAX-WS元数据<code>WebServiceProvider</code> JavaScript中的变量。您还可以在<code>WebServiceProvider</code>变量的<code>invoke</code>属性。</p>

<p>两种方法之间的唯一区别是实现操作的文档类型。使用E4X时，实现将请求作为E4X XML文档接收，并返回相同类型的文档。这些文档使用内置的E4X XML功能进行操作。</p>

<p><a shape="rect" href="javascript.html">示例3</a>显示了<code>invoke</code>一个简单的E4X服务实现的属性。</p>

<p><span class="confluence-anchor-link" id="JavaScript-ex3"></span></p>
<div class="code panel pdl" style="border-width:1px"><div class="codeHeader panelHeader pdl" style="border-bottom-width:1px"><b>示例3：E4X服务实现</b></div><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
var SOAP_ENV = new Namespace('SOAP-ENV',
                             'http://schemas.xmlsoap.org/soap/envelope/');
var xs = new Namespace('xs', 'http://www.w3.org/2001/XMLSchema');
var xsi = new Namespace('xsi', 'http://www.w3.org/2001/XMLSchema-instance');
var ns = new Namespace('ns', 'http://apache.org/hello_world_soap_http/types');

WebServiceProvider1.invoke = function(req) {
    default xml namespace = ns;
    var name = (req..requestType)[0];
    default xml namespace = SOAP_ENV;
    var resp = &lt;SOAP-ENV:Envelope xmlns:SOAP-ENV={SOAP_ENV} xmlns:xs={xs} xmlns:xsi={xsi}/&gt;;
    resp.Body = &lt;Body/&gt;;
    resp.Body.ns::greetMeResponse = &lt;ns:greetMeResponse xmlns:ns={ns}/&gt;;
    resp.Body.ns::greetMeResponse.ns::responseType = 'Hi ' + name;
    return resp;
}
</pre>
</div></div>
<h2 id="JavaScript-DeployingScriptedServices">部署脚本服务</h2>

<p>CXF提供了一个轻量级的容器，使您可以部署Javascript和E4X服务并利用CXF的可插拔传输基础结构。</p>
<div class="confluence-information-macro confluence-information-macro-note"><p class="title">注意</p><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>基于脚本的服务只能与SOAP消息一起使用。因此，尽管它们是多路传输，但它们只能使用SOAP绑定。</p></div></div>
<p>使用以下命令将服务部署到容器中：</p>
<div class="panel" style="border-width:1px"><div class="panelContent">
<p><code>java org.apache.cxf.js.rhino.ServerApp [ -a <em>addressURL</em> ] [ -b <em>baseAddressURL</em> ] file.js [ <em>file2.js</em> <em>file3.jsx</em> ... ]</code></p>
</div></div>
<p>的<code>org.apache.cxf.js.rhino.ServerApp</code>类，简称为<code>ServerApp</code>下面的文件采用一个或多个后缀为<code>.js</code>或E4X文件，后缀为<code>.jsx</code> ，并将它们加载到CXF运行时中。如果<code>ServerApp</code>在它创建的文件中找到JAX-WS元数据并注册一个JAX-WS <code>Provider<DOMSource></code>每个服务的对象。的<code>Provider<DOMSource></code>对象将请求的处理委托给存储在关联文件中的实现。 <code>ServerApp</code>也可以使用包含Javascript和E4X文件的目录的名称。它将加载包含JAX-WS元数据的所有脚本，加载它们，并为每个脚本发布服务端点。</p>

<p><code>ServerApp</code>具有三个可选参数：</p>
<div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>争论</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>描述</p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <code>-a <em>addressURL</em></code> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>指定地址<code>ServerApp</code>在URL后面的脚本文件中发布服务端点实现。</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <code>-b <em>baseAddressURL</em></code> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>指定使用的基地址<code>ServerApp</code>发布脚本文件定义的服务端点时。服务端点的完整地址是通过将服务的端口名附加到基地址形成的。</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <code>-v</code> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>指定{ <code>ServerApp</code>是在详细模式下运行。</p></td></tr></tbody></table></div>


<p>可选参数优先于出现在JAX-WS元数据中的{{EndpointAddress}}属性中提供的任何寻址信息。</p>

<p>例如，如果您使用<a shape="rect" href="javascript.html">示例4中</a>所示的命令部署了JavaScript服务，则您的服务将部署在<code><a shape="rect" href="http://cxf.apache.org/goodness">http://cxf.apache.org/goodness</a></code> 。</p>

<p><span class="confluence-anchor-link" id="JavaScript-ex4"></span></p><div class="panel" style="border-width:1px"><div class="panelHeader" style="border-bottom-width:1px"><b>示例4：在指定地址处部署服务</b></div><div class="panelContent">
<p><code>java org.apache.cxf.js.rhino.ServerApp -a <a shape="rect" href="http://cxf.apache.org/goodness">http://cxf.apache.org/goodness</a> hello_world.jsx</code></p>
</div></div>

<p>要使用公共基本URL部署许多服务，可以使用<a shape="rect" href="javascript.html">示例5中</a>所示的命令。如果服务定义为<code>hello_world.jsx</code>的端口名称为<code>helloWorld</code> ， <code>ServerApp</code>会在<code><a shape="rect" href="http://cxf.apache.org/helloWorld">http://cxf.apache.org/helloWorld</a></code> 。如果服务定义为<code>goodbye_moon.js</code>端口名称为<code>blue</code> ， <code>ServerApp</code>将在发布<code><a shape="rect" href="http://cxf.apache.org/blue">http://cxf.apache.org/blue</a></code> 。</p>

<p><span class="confluence-anchor-link" id="JavaScript-ex5"></span></p><div class="panel" style="border-width:1px"><div class="panelHeader" style="border-bottom-width:1px"><b>示例5：将一组服务部署到基址</b></div><div class="panelContent">
<p><code>java org.apache.cxf.js.rhino.ServerApp -b <a shape="rect" href="http://cxf.apache.org">http://cxf.apache.org</a> hello_world.jsx goodbye_moon.js</code></p>
</div></div>

<p>您还可以如<a shape="rect" href="javascript.html">示例6</a>所示组合参数，然后将您的服务部署在<code><a shape="rect" href="http://cxf.apache.org/goodness">http://cxf.apache.org/goodness</a></code> 。 <code>ServerApp</code>将发布三个服务端点：</p>
<ul><li>定义的服务<code>hello_world.jsx</code>在<code><a shape="rect" href="http://cxf.apache.org/helloWorld">http://cxf.apache.org/helloWorld</a></code> 。</li><li>定义的服务<code>goodbye_moon.js</code>在<code><a shape="rect" href="http://cxf.apache.org/blue">http://cxf.apache.org/blue</a></code> 。</li><li>定义的服务<code>chocolate.jsx</code>在<code><a shape="rect" href="http://cxf.apache.org/goodness">http://cxf.apache.org/goodness</a></code> 。</li></ul>


<p><span class="confluence-anchor-link" id="JavaScript-ex6"></span></p><div class="panel" style="border-width:1px"><div class="panelHeader" style="border-bottom-width:1px"><b>示例6：组合命令行参数</b></div><div class="panelContent">
<p><code>java org.apache.cxf.js.rhino.ServerApp -b <a shape="rect" href="http://cxf.apache.org">http://cxf.apache.org</a> hello_world.jsx goodbye_moon.js -a <a shape="rect" href="http://cxf.apache.org/goodness">http://cxf.apache.org/goodness</a> chocolate.jsx</code></p>
</div></div></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </tbody></table>
   </td>
   <td id="cell-2-2" colspan="2"> </td>
  </tr>
  <tr>
   <td id="cell-3-0"> </td>
   <td id="cell-3-1"> </td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">隐私政策</a> -（ <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=28428">编辑页面</a> ）（ <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=28428&showComments=true&showCommentArea=true#addcomment">添加评论</a> ）<br>Apache CXF，CXF，Apache，Apache Feather徽标是The Apache Software Foundation的商标。<br>提及的所有其他商标可能是其各自所有者的商标或注册商标。
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3"> </td>
   <td id="cell-3-4"> </td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2"> </td>
    <td id="cell-4-1"> </td>
    <td id="cell-4-2" colspan="2"> </td>
  </tr>
</tbody></table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>




</body></html>