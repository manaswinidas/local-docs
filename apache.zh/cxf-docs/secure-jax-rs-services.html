<html ><head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - Secure JAX-RS Services">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script src='/resources/highlighter/scripts/shBrushXml.js'></script>
<script src='/resources/highlighter/scripts/shBrushBash.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>Apache CXF-安全的JAX-RS服务</title>
  </head>
<body  onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td id="cell-0-0" colspan="2"> </td>
    <td id="cell-0-1"> </td>
    <td id="cell-0-2" colspan="2"> </td>
  </tr>
  <tr>
    <td id="cell-1-0"> </td>
    <td id="cell-1-1"> </td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight:bold;font-size:170%;color:white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="阿帕奇软件基金会"><img border="0" alt="ASF徽标" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></tbody></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tbody><tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs --> <a href="index.html">索引</a> > <a href="restful-services.html">RESTful服务</a> > <a href="jax-rs.html">JAX-RS</a> > <a href="secure-jax-rs-services.html">安全JAX-RS服务</a> <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">下载</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">文献资料</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </tbody></table>
      </div>
    </td>
    <td id="cell-1-3"> </td>
    <td id="cell-1-4"> </td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2"> </td>
    <td id="cell-2-1">
      <table>
        <tbody><tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">总览</a></li><li><a shape="rect" href="how-tos.html">操作方法</a></li><li><a shape="rect" href="frontends.html">前端</a></li><li><a shape="rect" href="databindings.html">数据绑定</a></li><li><a shape="rect" href="transports.html">运输工具</a></li><li><a shape="rect" href="configuration.html">组态</a></li><li><a shape="rect" href="debugging-and-logging.html">调试和记录</a></li><li><a shape="rect" href="tools.html">工具类</a></li><li><a shape="rect" href="restful-services.html">RESTful服务</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL绑定</a></li><li><a shape="rect" href="service-routing.html">服务路由</a></li><li><a shape="rect" href="dynamic-languages.html">动态语言</a></li><li><a shape="rect" href="ws-support.html">WS- *支持</a></li><li><a shape="rect" href="advanced-integration.html">进阶整合</a></li><li><a shape="rect" href="deployment.html">部署方式</a></li><li><a shape="rect" href="schemas-and-namespaces.html">模式和命名空间的使用</a></li></ul><hr><ul class="alternate"><li><p>搜索</p></li></ul><form id="cse-search-box" enctype="application/x-www-form-urlencoded" method="get" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="搜索">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF网站</a></li></ul><p> </p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><p><span style="font-size:2em;font-weight:bold">JAX-RS：安全性</span>


<br clear="none"></p><p><style type="text/css">/*<![CDATA[*/
div.rbtoc1553687824714 {padding: 0px;}
div.rbtoc1553687824714 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1553687824714 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style></p><div class="toc-macro rbtoc1553687824714">
<ul class="toc-indentation"><li><a shape="rect" href="#SecureJAX-RSServices-HTTPS">HTTPS</a>
<ul class="toc-indentation"><li><a shape="rect" href="#SecureJAX-RSServices-Configuringendpoints">配置端点</a></li><li><a shape="rect" href="#SecureJAX-RSServices-Configuringclients">配置客户端</a></li></ul>
</li><li><a shape="rect" href="#SecureJAX-RSServices-Authentication">认证方式</a></li><li><a shape="rect" href="#SecureJAX-RSServices-Authorization">授权书</a></li><li><a shape="rect" href="#SecureJAX-RSServices-WS-Trustintegration">WS-Trust集成</a>
<ul class="toc-indentation"><li><a shape="rect" href="#SecureJAX-RSServices-ValidatingBasicAuthcredentialswithSTS">使用STS验证BasicAuth凭据</a></li><li><a shape="rect" href="#SecureJAX-RSServices-UsingSTStovalidateSAMLassertions">使用STS验证SAML断言</a></li></ul>
</li><li><a shape="rect" href="#SecureJAX-RSServices-NoteaboutSecurityManager">关于SecurityManager的注意事项</a></li><li><a shape="rect" href="#SecureJAX-RSServices-SecuringJAX-RSmessages">保护JAX-RS消息</a></li><li><a shape="rect" href="#SecureJAX-RSServices-OAuth2.0/OpenIdConnect.">OAuth 2.0 / OpenId Connect。</a></li><li><a shape="rect" href="#SecureJAX-RSServices-Restrictinglargepayloads">限制大负载</a></li><li><a shape="rect" href="#SecureJAX-RSServices-CrossOriginResourceSharing">跨源资源共享</a></li></ul>
</div><h1 id="SecureJAX-RSServices-HTTPS">HTTPS</h1><p>可以通过基础Servlet容器来管理JAX-RS端点的传输级保护，例如，请参阅“ <a shape="rect" class="external-link" href="http://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html">Tomcat SSL配置”部分</a> 。</p><p>此外，CXF支持配置依赖于嵌入式Jetty的端点。还可以将CXF JAX-RS客户端配置为支持SSL。</p><h2 id="SecureJAX-RSServices-Configuringendpoints">配置端点</h2><p>使用嵌入式Jetty的JAX-RS端点可以依靠这样的配置：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:http="http://cxf.apache.org/transports/http/configuration"
       xmlns:httpj="http://cxf.apache.org/transports/http-jetty/configuration"
       xmlns:sec="http://cxf.apache.org/configuration/security"
       xsi:schemaLocation="
        http://www.springframework.org/schema/beans                 http://www.springframework.org/schema/beans/spring-beans.xsd
        http://cxf.apache.org/transports/http/configuration         http://cxf.apache.org/schemas/configuration/http-conf.xsd
        http://cxf.apache.org/transports/http-jetty/configuration   http://cxf.apache.org/schemas/configuration/http-jetty.xsd
        http://cxf.apache.org/configuration/security                http://cxf.apache.org/schemas/configuration/security.xsd"&gt;


    &lt;httpj:engine-factory id="port-9095-tls-config"&gt;
        &lt;httpj:engine port="9095"&gt;
            &lt;httpj:tlsServerParameters&gt;
                &lt;sec:keyManagers keyPassword="password"&gt;
	            &lt;sec:keyStore type="JKS" password="password" 
	                file="src/test/java/org/apache/cxf/systest/http/resources/Bethal.jks"/&gt;
	        &lt;/sec:keyManagers&gt;
	        &lt;sec:trustManagers&gt;
	            &lt;sec:keyStore type="JKS" password="password"
	                file="src/test/java/org/apache/cxf/systest/http/resources/Truststore.jks"/&gt;
	     	&lt;/sec:trustManagers&gt;
            &lt;/httpj:tlsServerParameters&gt;
        &lt;/httpj:engine&gt;
    &lt;/httpj:engine-factory&gt;
&lt;/beans&gt;
</pre>
</div></div><p>而是可以在keyManager中代替keyPassword，也可以指定keyPasswordCallbackHandler属性。在这种情况下，属性必须包含实现JSE <a shape="rect" class="external-link" href="http://docs.oracle.com/javase/7/docs/api/javax/security/auth/callback/CallbackHandler.html" rel="nofollow">CallbackHandler</a>接口并在运行时提供密钥密码的类的全名。可以在<a shape="rect" class="external-link" href="https://github.com/apache/cxf/blob/master/systests/transports/src/test/java/org/apache/cxf/systest/http/KeyPasswordCallbackHandler.java" rel="nofollow">此处</a>找到示例密钥密码回调处理程序实现。</p><p>如果使用JAXRSServerFactoryBean从代码创建和启动JAX-RS端点，则可以像这样利用上述配置：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">JAXRSServerFactoryBean bean = new JAXRSServerFactoryBean();
SpringBusFactory bf = new SpringBusFactory();
Bus bus = bf.createBus("configuration/beans.xml");
bean.setBus(bus);
bean.setAddress("http://localhost:9095/rest");
bean.setServiceClass(CustomerService.class);
</pre>
</div></div><p>如果在上述beans.xml中还声明了一个jaxrs：server端点，请确保设置了一个'depends-on'属性：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">&lt;jaxrs:server serviceClass="CustomerService.class" address="http://localhost:9095/rest"
   depends-on="port-9095-tls-config"/&gt;
</pre>
</div></div><p>结合使用JAX-RS和Jetty HTTPS之后，就可以像这样启动应用程序上下文：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">public class Server {

    public void main(String[] args) throws Exception {
        Bus busLocal = new SpringBusFactory().createBus("configuration/beans.xml");
        BusFactory.setDefaultBus(busLocal);
        new Server();
        Thread.sleep(60000);
    }
}
</pre>
</div></div><p>仅当使用嵌入式Jetty容器时，才需要在CXF Jetty HTTPS配置旁边声明JAX-RS端点。如果您已将应用程序WAR部署到Tomcat或Jetty中，则请遵循特定于容器的指南来设置SSL。</p><p>也请在CXF发行版中查看此<a shape="rect" class="external-link" href="http://svn.apache.org/repos/asf/cxf/trunk/distribution/src/main/release/samples/jax_rs/basic_https/">基于HTTPS的演示</a> 。</p><p>另外，检查“ <a shape="rect" href="http://cxf.apache.org/docs/jetty-configuration.html">CXF码头配置”</a>部分。</p><h2 id="SecureJAX-RSServices-Configuringclients">配置客户端</h2><p>可以按照本<a shape="rect" href="http://cxf.apache.org/docs/client-http-transport-including-ssl-support.html">节中的</a>说明配置用于CXF JAX-RS代理和WebClient的安全HTTPConduits。</p><p>例如，检查此<a shape="rect" class="external-link" href="http://svn.apache.org/repos/asf/cxf/trunk/distribution/src/main/release/samples/jax_rs/basic_https/src/main/resources/ClientConfig.xml">配置文件</a> 。代理或客户端使用的端点地址必须匹配HTTPConduit配置中使用的模式。</p><p>可以在代理或WebClient创建期间引用配置文件：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">final String address = "http://localhost:9095/rest";
final String configLocation;

WebClient client = WebClient.create(address, configLocation);
// or
BookStore proxy = JAXRSClientFactory.create(address, configLocation, BookStore.class);
</pre>
</div></div><p>使用扩展的QName，HTTPConduits也可以“绑定”到代理或WebClient。请参阅本<a shape="rect" href="http://cxf.apache.org/docs/jax-rs-client-api.html#JAX-RSClientAPI-ConfiguringanHTTPConduitfromSpring">节</a>以获取更多信息。</p><p>请参阅<a shape="rect" class="external-link" href="http://aruld.info/programming-ssl-for-jetty-based-cxf-services/" rel="nofollow">此博客条目</a> ，了解如何通过代码设置HTTPConduit TLS属性。在代码中，执行WebClient.getConfig（myClient）.getHTTPConduit（）并从此处继续。</p><h1 id="SecureJAX-RSServices-Authentication">认证方式</h1><p>通常是像Tomcat这样的容器或像Spring Security这样的框架来处理用户身份验证。有时您可能想改做自定义身份验证。CXF HTTP传输将已解码的基本身份验证凭据添加到AuthorizationPolicy扩展实例中，并将其设置在当前消息上。因此，最简单的方法是注册自定义调用程序或<code>@PreMatching ContainerRequestFilter</code>过滤器将提取用户名和密码，如下所示：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">public class AuthenticationHandler implements ContainerRequestFilter {

    @Override
    public void filter(ContainerRequestContext requestContext) throws IOException {
        String authorization = requestContext.getHeaderString("Authorization");
        String[] parts = authValues.authorization(" ");
        if (parts.length != 2 || !"Basic".equals(parts[0])) {
            requestContext.abortWith(createFaultResponse());
            return;
        }
        
        String decodedValue = null;
        try {
            decodedValue = new String(Base64Utility.decode(parts[1]));
        } catch (Base64Exception ex) {
            requestContext.abortWith(createFaultResponse());
            return;
        }
        String[] namePassword = decodedValue.split(":"); 
        if (isAuthenticated(namePassword[0], namePassword[1])) {
            // let request to continue
        } else {
            // authentication failed, request the authetication, add the realm name if needed to the value of WWW-Authenticate 
            requestContext.abortWith(Response.status(401).header("WWW-Authenticate", "Basic").build());
        }
    }
    private Response createFaultResponse() {
        return Response.status(401).header("WWW-Authenticate", "Basic realm=\"service.com\"").build();
    }
&#160;}
</pre>
</div></div><p>验证用户身份后，您可能要做的另一件事是初始化org.apache.cxf.security。具有代表用户及其角色的主体的SecurityContext（如果有）。</p><p>如果您更喜欢使用Spring Security，请在<a shape="rect" class="external-link" href="http://svn.apache.org/repos/asf/cxf/trunk/distribution/src/main/release/samples/jax_rs/spring_security">spring-security</a>演示中查看如何处理身份验证。</p><p>接下来，请参阅“ <a shape="rect" href="securing-cxf-services.html">确保CXF服务安全”</a>部分，以了解CXF安全拦截器如何提供帮助。</p><p>另外，请查看此<a shape="rect" class="external-link" href="http://sberyozkin.blogspot.com/2010/12/authentication-and-authorization-cxf.html" rel="nofollow">博客条目</a> ，以获取有关CXF JAX-RS如何使用辅助过滤器包装CXF安全拦截器的更多信息。</p><p>例如，查看如何使用JAX-RS过滤器包装CXF JAASLoginInterceptor：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">&lt;jaxrs:server address="/jaas"&gt;
    &lt;jaxrs:serviceBeans&gt;
        &lt;bean class="org.apache.cxf.systest.jaxrs.security.SecureBookStoreNoAnnotations"/&gt;
    &lt;/jaxrs:serviceBeans&gt;		   
    &lt;jaxrs:providers&gt;
        &lt;ref bean="authenticationFilter"/&gt;
    &lt;/jaxrs:providers&gt;
&lt;/jaxrs:server&gt;
  
&lt;bean id="authenticationFilter" class="org.apache.cxf.jaxrs.security.JAASAuthenticationFilter"&gt;
    &lt;!-- Name of the JAAS Context --&gt;
    &lt;property name="contextName" value="BookLogin"/&gt;
    &lt;!-- Hint to the filter on how to have Principals representing users and roles separated 
         while initializing a SecurityContext --&gt;
    &lt;property name="rolePrefix" value="ROLE_"/&gt;
        
    &lt;property name="redirectURI" value="/login.jsp"/&gt;
&lt;/bean&gt;
</pre>
</div></div><p>如果认证失败，过滤器会将客户端重定向到“ /login.jsp”。如果未设置'redirectURI'属性，则将返回401。也可以设置“ realmName”属性。</p><p>如果JAAS身份验证成功，则过滤器将在消息上设置一个SecurityContext实例。此上下文可用于授权决策。</p><h1 id="SecureJAX-RSServices-Authorization">授权书</h1><p>通常是像Tomcat这样的容器或像Spring Security这样的框架来处理用户授权，类似于处理身份验证的方式。</p><p>CXF还提供了两个拦截器，可轻松执行授权决策，如“ <a shape="rect" href="securing-cxf-services.html">保护CXF服务”</a>部分所述。<br clear="none">CXF JAX-RS SimpleAuthorizingFilter可用于包装那些拦截器，并在失败的情况下返回403：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">&lt;jaxrs:server address="/jaas"&gt;
    &lt;jaxrs:serviceBeans&gt;
        &lt;bean class="org.apache.cxf.systest.jaxrs.security.SecureBookStoreNoAnnotations"/&gt;
    &lt;/jaxrs:serviceBeans&gt;		   
    &lt;jaxrs:providers&gt;
        &lt;ref bean="authorizationFilter"/&gt;
    &lt;/jaxrs:providers&gt;
&lt;/jaxrs:server&gt;
 
&lt;bean id="authorizationFilter" class="org.apache.cxf.jaxrs.security.SimpleAuthorizingFilter"&gt;
    &lt;property name="methodRolesMap" ref="rolesMap"/&gt;
&lt;/bean&gt;
  
&lt;util:map id="rolesMap"&gt;
    &lt;entry key="getThatBook" value="ROLE_BOOK_OWNER"/&gt;
    &lt;entry key="getBook" value="ROLE_BOOK_OWNER"/&gt;
&lt;/util:map&gt;
</pre>
</div></div><p>SimpleAuthorizingFilter也可以包装CXF SecureAnnotationsInterceptor。</p><p>请注意，不需要使用JAX-RS过滤器包装CXF安全拦截器。它只是使处理身份验证和授权异常以及返回适当的HTTP错误状态变得更加容易。</p><h1 id="SecureJAX-RSServices-WS-Trustintegration">WS-Trust集成</h1><p>将CXF端点部署到安全Web服务环境中的要求之一是确保可以使用现有的WS-Trust STS服务来保护端点。JAX-WS端点可以依赖CXF WS-Security和WS-Trust支持。确保CXF JAX-RS端点可以由STS额外保护是一项具有战略意义的任务。CXF在JAX-WS和JAX-RS前端之间提供了紧密的集成，因此重用CXF JAX-WS和WS-Security是实现这种集成的最有效方法。</p><h2 id="SecureJAX-RSServices-ValidatingBasicAuthcredentialswithSTS">使用STS验证BasicAuth凭据</h2><p>从CXF 2.4.1开始，可以使用STS验证基本身份验证凭据。JAX-RS和JAX-WS服务可以依赖此功能。这是有关如何配置jaxrs端点的示例：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">&lt;jaxrs:server serviceClass="org.customers.CustomerService"
    depends-on="ClientAuthHttpsSettings"
    address="https://localhost:8081/rest"&gt;

    &lt;jaxrs:inInterceptors&gt;
        &lt;ref bean="basicAuthValidator"/&gt;
    &lt;/jaxrs:inInterceptors&gt;
  
    &lt;jaxrs:properties&gt;
         &lt;entry key="ws-security.sts.client"&gt;
            &lt;ref bean="stsclient"/&gt;
         &lt;/entry&gt;
    &lt;/jaxrs:properties&gt;

&lt;/jaxrs:server&gt;
   
&lt;bean id="basicAuthValidator" class="org.apache.cxf.ws.security.trust.AuthPolicyValidatingInterceptor"&gt;
   &lt;property name="validator"&gt;
        &lt;bean class="org.apache.cxf.ws.security.trust.STSTokenValidator"&gt;
             &lt;constructor-arg value="true"/&gt;
        &lt;/bean&gt;
   &lt;/property&gt;
&lt;/bean&gt;

&lt;bean id="stsclient" class="org.apache.cxf.ws.security.trust.STSClient"&gt;
    &lt;constructor-arg ref="cxf"/&gt;
    &lt;property name="wsdlLocation" value="https://localhost:8083/sts?wsdl"/&gt;
    &lt;property name="serviceName" value="{http://tempuri.org/}STSService"/&gt;
    &lt;property name="endpointName" value="{http://tempuri.org/STSServicePort"/&gt;
&lt;/bean&gt; 

&lt;!-- jaxrs:server depends on this SSL configuration --&gt;
&lt;httpj:engine-factory id="ClientAuthHttpsSettings" bus="cxf"&gt;
  &lt;httpj:engine port="8081"&gt;
    &lt;httpj:tlsServerParameters&gt;
      &lt;sec:keyManagers keyPassword="skpass"&gt;
        &lt;sec:keyStore type="jks" password="sspass" resource="servicestore.jks"/&gt;
      &lt;/sec:keyManagers&gt;
      &lt;sec:cipherSuitesFilter&gt;
        &lt;sec:include&gt;.*_EXPORT_.*&lt;/sec:include&gt;
        &lt;sec:include&gt;.*_EXPORT1024_.*&lt;/sec:include&gt;
        &lt;sec:include&gt;.*_WITH_DES_.*&lt;/sec:include&gt;
        &lt;sec:include&gt;.*_WITH_NULL_.*&lt;/sec:include&gt;
        &lt;sec:exclude&gt;.*_DH_anon_.*&lt;/sec:exclude&gt;
        &lt;/sec:cipherSuitesFilter&gt;
      &lt;sec:clientAuthentication want="false" required="false"/&gt;
   &lt;/httpj:tlsServerParameters&gt;
&lt;/httpj:engine&gt;
  
&lt;!-- STSClient depends on this SSL configuration --&gt;
&lt;http:conduit name="https://localhost:8083/.*"&gt;
  &lt;http:tlsClientParameters disableCNCheck="true"&gt;
    &lt;sec:trustManagers&gt;
      &lt;sec:keyStore type="jks" password="sspass" resource="servicestore.jks"/&gt;
    &lt;/sec:trustManagers&gt;
    &lt;sec:keyManagers keyPassword="skpass"&gt;
       &lt;sec:keyStore type="jks" password="sspass" resource="servicestore.jks"/&gt;
    &lt;/sec:keyManagers&gt;
  &lt;/http:tlsClientParameters&gt;
&lt;/http:conduit&gt;
</pre>
</div></div><p>AuthPolicyValidatingInterceptor将基本Auth信息转换为WSS4J UsernameToken并委托给STS进行验证。</p><h2 id="SecureJAX-RSServices-UsingSTStovalidateSAMLassertions">使用STS验证SAML断言</h2><p>请参阅<a shape="rect" href="http://cxf.apache.org/docs/jax-rs-saml.html#JAX-RSSAML-SAMLAssertionValidation">本节</a> ，以获取有关如何使用STSTokenValidator来验证入站SAML断言的更多信息。</p><h1 id="SecureJAX-RSServices-NoteaboutSecurityManager">关于SecurityManager的注意事项</h1><p>如果<code>java.lang.SecurityManager</code>如果已安装，则您可能需要使用'suppressAccessChecks'权限配置受信任的JAX-RS代码库，才能成功注入JAXRS上下文或参数字段。例如，您可能想要使用以下权限更新Tomcat <a shape="rect" class="external-link" href="http://tomcat.apache.org/tomcat-5.5-doc/security-manager-howto.html">catalina.policy</a> ：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">grant codeBase "file:${catalina.home}/webapps/yourwebapp/lib/cxf.jar" {
    permission java.lang.reflect.ReflectPermission "suppressAccessChecks";
};
</pre>
</div></div><h1 id="SecureJAX-RSServices-SecuringJAX-RSmessages">保护JAX-RS消息</h1><p>CXF提供了多种保护JAX-RS消息的方法：</p><ul><li>可以通过XML签名和XML加密来保护XML消息。有关更多信息，请参见<a shape="rect" href="jax-rs-xml-security.html">JAX-RS XML安全性</a> 。</li><li>可以使用JOSE对消息进行签名和/或加密。此外，可以使用JSON Web令牌来实现身份验证和授权。有关更多信息，请参见<a shape="rect" href="jax-rs-jose.html">JAX-RS JOSE</a> 。</li><li>可以通过SAML断言传达安全声明。有关更多信息，请参见<a shape="rect" href="jax-rs-saml.html">JAX-RS SAML</a> 。</li><li>可以通过HTTP签名对消息进行签名。有关更多信息，请参见<a shape="rect" href="jax-rs-http-signature.html">JAX-RS HTTP签名</a> 。</li></ul><h1 id="SecureJAX-RSServices-OAuth2.0/OpenIdConnect.">OAuth 2.0 / OpenId Connect。</h1><p>CXF支持OAuth 2.0和OpenId Connect：</p><ul><li>有关OAuth 2.0的信息，请参见<a shape="rect" href="jax-rs-oauth2.html">JAX-RS OAuth2</a> 。</li><li>有关OpenId Connect的信息，请参见<a shape="rect" href="jax-rs-oidc.html">JAX-RS OIDC</a> 。</li></ul><h1 id="SecureJAX-RSServices-Restrictinglargepayloads">限制大负载</h1><p>请参阅<a shape="rect" href="https://cwiki.apache.org/confluence/display/CXF20DOC/JAX-RS+Data+Bindings#JAX-RSDataBindings-ControllingLargeJAXBXMLandJSONinputpayloads">本节</a>以获取更多信息。</p><h1 id="SecureJAX-RSServices-CrossOriginResourceSharing">跨源资源共享</h1><p>请参阅<a shape="rect" href="jax-rs-cors.html">本节</a>以获取更多信息。还要检查有关JSONP <a shape="rect" href="http://cxf.apache.org/docs/jax-rs-data-bindings.html#JAX-RSDataBindings-JSONWithPadding">的部分</a> 。</p></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </tbody></table>
   </td>
   <td id="cell-2-2" colspan="2"> </td>
  </tr>
  <tr>
   <td id="cell-3-0"> </td>
   <td id="cell-3-1"> </td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">隐私政策</a> -（ <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=26119178">编辑页面</a> ）（ <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=26119178&showComments=true&showCommentArea=true#addcomment">添加评论</a> ）<br>Apache CXF，CXF，Apache，Apache Feather徽标是The Apache Software Foundation的商标。<br>提及的所有其他商标可能是其各自所有者的商标或注册商标。
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3"> </td>
   <td id="cell-3-4"> </td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2"> </td>
    <td id="cell-4-1"> </td>
    <td id="cell-4-2" colspan="2"> </td>
  </tr>
</tbody></table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>




</body></html>