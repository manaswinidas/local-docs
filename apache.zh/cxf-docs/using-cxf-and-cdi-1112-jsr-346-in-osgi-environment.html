<html ><head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - Using CXF and CDI 1.1/1.2 (JSR-346) in OSGi environment">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script src='/resources/highlighter/scripts/shBrushXml.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>Apache CXF-在OSGi环境中使用CXF和CDI 1.1 / 1.2（JSR-346）</title>
  </head>
<body  onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td id="cell-0-0" colspan="2"> </td>
    <td id="cell-0-1"> </td>
    <td id="cell-0-2" colspan="2"> </td>
  </tr>
  <tr>
    <td id="cell-1-0"> </td>
    <td id="cell-1-1"> </td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight:bold;font-size:170%;color:white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="阿帕奇软件基金会"><img border="0" alt="ASF徽标" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></tbody></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tbody><tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs --> <a href="index.html">索引</a> > <a href="deployment.html">部署</a> > <a href="using-cxf-and-cdi-1112-jsr-346-in-osgi-environment.html">在OSGi环境中使用CXF和CDI 1.1 / 1.2（JSR-346）</a> <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">下载</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">文献资料</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </tbody></table>
      </div>
    </td>
    <td id="cell-1-3"> </td>
    <td id="cell-1-4"> </td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2"> </td>
    <td id="cell-2-1">
      <table>
        <tbody><tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">总览</a></li><li><a shape="rect" href="how-tos.html">操作方法</a></li><li><a shape="rect" href="frontends.html">前端</a></li><li><a shape="rect" href="databindings.html">数据绑定</a></li><li><a shape="rect" href="transports.html">运输工具</a></li><li><a shape="rect" href="configuration.html">组态</a></li><li><a shape="rect" href="debugging-and-logging.html">调试和记录</a></li><li><a shape="rect" href="tools.html">工具类</a></li><li><a shape="rect" href="restful-services.html">RESTful服务</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL绑定</a></li><li><a shape="rect" href="service-routing.html">服务路由</a></li><li><a shape="rect" href="dynamic-languages.html">动态语言</a></li><li><a shape="rect" href="ws-support.html">WS- *支持</a></li><li><a shape="rect" href="advanced-integration.html">进阶整合</a></li><li><a shape="rect" href="deployment.html">部署方式</a></li><li><a shape="rect" href="schemas-and-namespaces.html">模式和命名空间的使用</a></li></ul><hr><ul class="alternate"><li><p>搜索</p></li></ul><form id="cse-search-box" enctype="application/x-www-form-urlencoded" method="get" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="搜索">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF网站</a></li></ul><p> </p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><h1 id="UsingCXFandCDI1.1/1.2(JSR-346)inOSGienvironment-Introduction">介绍</h1><p>从3.1.0版本开始，Apache CXF在OSGi容器内支持基于CDI的部署，该容器使用Pax CDI（OSGi的上下文和依赖注入）实现（ <a shape="rect" class="external-link" href="https://github.com/ops4j/org.ops4j.pax.cdi" rel="nofollow">https://github.com/ops4j/org.ops4j.pax.cdi</a> ）。 Apache CXF提供了<strong>cxf-jaxrs-cdi</strong>功能（易于部署到诸如<strong>Apache Karaf之</strong>类的OSGi容器中）以及<strong>cxf-integration-cdi</strong>模块，该模块包括Pax CDI使用的必要OSGi捆绑包元数据。</p><h1 id="UsingCXFandCDI1.1/1.2(JSR-346)inOSGienvironment-Installation">安装</h1><p>对于安装步骤，将使用<strong>Apache Karaf 3.0.3</strong> ，因为它是使用最广泛的OSGi容器。下面显示的所有命令均旨在从Apache Karaf shell执行。第一步是安装<strong>http</strong>和Pax CDI功能，这取决于CDI版本。</p><p>对于CDI 1.1，请使用<strong>pax-cdi-1.1-web-weld</strong>功能：</p><div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>feature:install http pax-cdi-1.1-web-weld</pre>
</div></div><p>对于CDI 1.2，请使用<strong>pax-cdi-1.2-web-weld</strong>功能：</p><div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>feature:install http pax-cdi-1.2-web-weld</pre>
</div></div><p>接下来，应安装Apache CXF 3.1.0+功能：</p><div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>feature:repo-add cxf 3.1.0
feature:install cxf/3.1.0 cxf-jaxrs-cdi/3.1.0</pre>
</div></div><h1 id="UsingCXFandCDI1.1/1.2(JSR-346)inOSGienvironment-BundleMetadata">捆绑元数据</h1><p>为了使该捆绑包被识别为Web CDI，并使用Apache CXF CDI功能，它应提供特殊的捆绑包清单说明（例如，使用<strong>maven-bundle-plugin</strong>插件）。</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">&lt;/instructions&gt;
    ... 
    &lt;Import-Package&gt;
        javax.servlet;version="[2.6,4)", 
        org.apache.cxf.jaxrs;version="[3.1,4)",
        org.apache.cxf.cdi;version="[3.1,4)",  
        *
    &lt;/Import-Package&gt;

    &lt;Require-Capability&gt;
        org.ops4j.pax.cdi.extension; filter:="(&amp;amp;(extension=cxf-integration-cdi))",
        osgi.extender; filter:="(osgi.extender=pax.cdi)"
    &lt;/Require-Capability&gt;
   &#160;&lt;Web-ContextPath&gt;...&lt;/Web-ContextPath&gt;
    &lt;_wab&gt;src/main/webapp&lt;/_wab&gt;
&lt;/instructions&gt;</pre>
</div></div><p>为了使CDI初始化，发现和注入与Apache CXF一起使用， <strong>Require-Capability</strong>指令非常重要。 <strong>Web-ContextPath</strong>是要在其上部署此Web应用程序的上下文路径。<strong>_wab</strong>是指出<strong>web.xml</strong>文件位置的指令。请注意，该应用程序将不会部署在常规<strong>/ cxf</strong>端点（常规Apache CXF服务的公共端点）下。原因是Pax Web用于部署Web CDI应用程序。</p><h1 id="UsingCXFandCDI1.1/1.2(JSR-346)inOSGienvironment-WebApplicationConfiguration">Web应用程序配置</h1><p>目前，Apache CXF OSGi应用程序应显式提供至少<strong>已</strong>定义<strong>CXFCdiServlet的</strong> <strong>web.xml</strong>描述符。例如：</p><div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">&lt;web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;

    &lt;servlet&gt;
        &lt;servlet-name&gt;CXFServlet&lt;/servlet-name&gt;
        &lt;display-name&gt;CXF Servlet&lt;/display-name&gt;
        &lt;servlet-class&gt;org.apache.cxf.cdi.CXFCdiServlet&lt;/servlet-class&gt;    
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;

    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;CXFServlet&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
&lt;/web-app&gt;</pre>
</div></div><h1 id="UsingCXFandCDI1.1/1.2(JSR-346)inOSGienvironment-Discovery">发现</h1><p>Pax CDI使用自己的bean捆绑软件定义，因此，只有遵循这些要求的捆绑软件才可用于发现（提供者，服务和功能）和注入（请参阅<a shape="rect" class="external-link" href="https://ops4j1.jira.com/wiki/display/PAXCDI/Getting+Started+for+OSGi+Users" rel="nofollow">https://ops4j1.jira.com/wiki/display/PAXCDI/入门+适用于+ OSGi +用户+</a>了解更多详细信息）。</p></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </tbody></table>
   </td>
   <td id="cell-2-2" colspan="2"> </td>
  </tr>
  <tr>
   <td id="cell-3-0"> </td>
   <td id="cell-3-1"> </td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">隐私政策</a> -（ <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=55153391">编辑页面</a> ）（ <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=55153391&showComments=true&showCommentArea=true#addcomment">添加评论</a> ）<br>Apache CXF，CXF，Apache，Apache Feather徽标是The Apache Software Foundation的商标。<br>提及的所有其他商标可能是其各自所有者的商标或注册商标。
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3"> </td>
   <td id="cell-3-4"> </td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2"> </td>
    <td id="cell-4-1"> </td>
    <td id="cell-4-2" colspan="2"> </td>
  </tr>
</tbody></table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>




</body></html>