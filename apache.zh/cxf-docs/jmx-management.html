<html ><head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - JMX Management">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script src='/resources/highlighter/scripts/shBrushXml.js'></script>
<script src='/resources/highlighter/scripts/shBrushBash.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>Apache CXF-JMX管理</title>
  </head>
<body  onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td id="cell-0-0" colspan="2"> </td>
    <td id="cell-0-1"> </td>
    <td id="cell-0-2" colspan="2"> </td>
  </tr>
  <tr>
    <td id="cell-1-0"> </td>
    <td id="cell-1-1"> </td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight:bold;font-size:170%;color:white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="阿帕奇软件基金会"><img border="0" alt="ASF徽标" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></tbody></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tbody><tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs --> <a href="index.html">索引</a> > <a href="configuration.html">配置</a> > <a href="jmx-management.html">JMX管理</a> <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">下载</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">文献资料</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </tbody></table>
      </div>
    </td>
    <td id="cell-1-3"> </td>
    <td id="cell-1-4"> </td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2"> </td>
    <td id="cell-2-1">
      <table>
        <tbody><tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">总览</a></li><li><a shape="rect" href="how-tos.html">操作方法</a></li><li><a shape="rect" href="frontends.html">前端</a></li><li><a shape="rect" href="databindings.html">数据绑定</a></li><li><a shape="rect" href="transports.html">运输工具</a></li><li><a shape="rect" href="configuration.html">组态</a></li><li><a shape="rect" href="debugging-and-logging.html">调试和记录</a></li><li><a shape="rect" href="tools.html">工具类</a></li><li><a shape="rect" href="restful-services.html">RESTful服务</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL绑定</a></li><li><a shape="rect" href="service-routing.html">服务路由</a></li><li><a shape="rect" href="dynamic-languages.html">动态语言</a></li><li><a shape="rect" href="ws-support.html">WS- *支持</a></li><li><a shape="rect" href="advanced-integration.html">进阶整合</a></li><li><a shape="rect" href="deployment.html">部署方式</a></li><li><a shape="rect" href="schemas-and-namespaces.html">模式和命名空间的使用</a></li></ul><hr><ul class="alternate"><li><p>搜索</p></li></ul><form id="cse-search-box" enctype="application/x-www-form-urlencoded" method="get" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="搜索">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF网站</a></li></ul><p> </p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><h1 id="JMXManagement-ConfiguringJMXIntegration">配置JMX集成</h1>

<p>要启用JMX集成，请在CXF总线上注册InstrumentationManager扩展。在Tomcat上使用Spring XML，以下最小的XML代码片段将启用JMX集成。</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;import resource="classpath:META-INF/cxf/cxf.xml"/&gt;
...

&lt;bean id="org.apache.cxf.management.InstrumentationManager"
  class="org.apache.cxf.management.jmx.InstrumentationManagerImpl"&gt;
  &lt;property name="enabled" value="true" /&gt;
  &lt;property name="bus" ref="cxf" /&gt;
  &lt;property name="usePlatformMBeanServer" value="true" /&gt;
&lt;/bean&gt;
</pre>
</div></div>

<p>默认的InstrumentationManager接受以下配置选项：</p>

<div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>名称</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>值</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>默认</p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>已启用</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>是否应启用JMX集成</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>假</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>总线</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>用于向其注册JMX扩展的CXF总线实例</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>没有</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>服务器</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>对要向其注册MBean的MBeanServer实例的可选引用。如果未提供，则使用“ usePlatformMBeanServer”和/或“ serverName”视标解析MBeanServer。</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>没有</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>usePlatformMBeanServer</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>如果为true，并且未提供对MBeanServer的引用，则JMX扩展将MBean注册到平台MBean服务器。</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>假</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>服务器名称</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>如果提供，usePlatformMBeanServer为false，并且不提供对MBeanServer的引用，则JMX扩展会向MBean服务器注册带有该名称的MBean。</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>没有</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>createMBServerConnectorFactory</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>如果为true，则在MBeanServer上创建一个连接器。</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>真正</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>螺纹的</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>确定是在该线程中还是在单独的线程中执行MBean连接器的创建。仅当createMBServerConnectorFactory为true时才相关。</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>假</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>守护程序</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>确定是否将MBean连接器创建线程标记为守护程序线程。仅当createMBServerConnectorFactory为true时才相关。</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>假</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>JMXServiceURL</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>要在MBeanServer上创建的连接器的URL。仅当createMBServerConnectorFactory为true时才相关。</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>服务：jmx：rmi：/// jndi / rmi：// localhost：9913 / jmxrmi</p></td></tr></tbody></table></div>


<p>上面的配置提供的MBean工具将提供有关Web服务支持的WSDL以及Web服务管理命令的一般信息。要查看SOAP调用处理的性能指标，需要进行进一步的<a shape="rect" href="jmx-management.html">配置</a> -默认情况下将其禁用，以避免不必要的运行时开销。</p>

<p>如果您使用的是Maven，请确保已将以下依赖项添加到Web服务提供者的pom.xml中：</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;
    &lt;artifactId&gt;cxf-rt-management&lt;/artifactId&gt;
    &lt;version&gt;${cxf.version}&lt;/version&gt;
&lt;/dependency&gt;
</pre>
</div></div>


<h2 id="JMXManagement-ExampleConfiguration">配置示例</h2>

<p>通过将以下XML添加到CXF Spring上下文来启用JMX集成。</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;bean id="org.apache.cxf.management.InstrumentationManager"
  class="org.apache.cxf.management.jmx.InstrumentationManagerImpl"&gt;
  &lt;property name="bus" ref="cxf" /&gt;
  &lt;property name="enabled" value="true" /&gt;
  &lt;property name="JMXServiceURL " value="service:jmx:rmi:///jndi/rmi://localhost:9914/jmxrmi" /&gt;
&lt;/bean&gt;
</pre>
</div></div>

<p>从2.5.2开始，可以使用带有“ bus.jmx”前缀的相应属性名称在总线配置中直接进行上述工具管理器的等效配置，如下所示：</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;cxf:bus bus="cxf"&gt;
  &lt;cxf:properties&gt;
    &lt;entry key="bus.jmx.enabled" value="true"/&gt;
    &lt;entry key="bus.jmx.JMXServiceURL" value="service:jmx:rmi:///jndi/rmi://localhost:9914/jmxrmi" /&gt;
  &lt;/cxf:properties&gt;
&lt;/cxf:bus&gt;

</pre>
</div></div>

<div class="table-wrap"><table class="confluenceTable"><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> <img class="emoticon emoticon-warning" src="https://cwiki.apache.org/confluence/s/en_GB/5997/6f42626d00e36f53fe51440403446ca61552e2a2.1/_/images/icons/emoticons/warning.png" alt="（警告）" data-emoticon-name="warning"> </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> <strong>CXF 2.5.x中的更改</strong> <br class="atl-forced-newline" clear="none">从2.5.0版开始，如果MBeanServer在Spring上下文中可用或作为OSGi服务器（在OSGi中运行）可用，则InstrumentationManger将自动启用并将使用该MBeanServer和CXF MBeans进行注册。因此，在这种情况下，不需要上面显示的仪器管理器配置。</p></td></tr></tbody></table></div>



<p>要测试配置，请启动服务并使用JDK中的JConsole连接到该服务。<br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jmx-management.data/jconsole_connect2.png"></span><br clear="none">
 <br clear="none">然后，您可以浏览到端点：<br clear="none">
 <br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="jmx-management.data/jconsole_service_endpoint.png"></span><br clear="none">
 </p>

<p><span class="confluence-anchor-link" id="JMXManagement-cxf_in_servicemix"></span></p>

<h1 id="JMXManagement-ConfiguringCXFtoUsetheServiceMix4MBeanServer">配置CXF以使用ServiceMix 4 MBeanServer</h1>

<p>如果您将CXF服务嵌入ServiceMix 4容器中，则配置与上面的稍有不同。您不想启动新的MBeanServer，并且您可能不想创建其他连接器，因为容器可以为您管理这两个连接器。您可以通过OSGi框架获得对容器的MBeanServer的引用，并将该引用注入JMX集成扩展中。如果尚未将Spring OSGI命名空间和schemaLocation添加到您的CXF配置文件中，请不要忘记添加它们。</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;!-- OSGi namespace and schemaLocation required --&gt;
&lt;beans ...
       xmlns:osgi="http://www.springframework.org/schema/osgi"
       ...
       xsi:schemaLocation="...
       http://www.springframework.org/schema/osgi  http://www.springframework.org/schema/osgi/spring-osgi.xsd"&gt;

...

&lt;!-- Grab a reference to the current MBeanServer --&gt;
&lt;osgi:reference id="mbeanServer" interface="javax.management.MBeanServer" cardinality="0..1"/&gt;

&lt;bean id="org.apache.cxf.management.InstrumentationManager"
  class="org.apache.cxf.management.jmx.InstrumentationManagerImpl"&gt;
  &lt;property name="bus" ref="cxf" /&gt;
  &lt;property name="enabled" value="true" /&gt;
  &lt;!-- Unless you really want to open an additional connector, set this to false --&gt;
  &lt;property name="createMBServerConnectorFactory " value="false" /&gt;

  &lt;!-- Inject the reference to the MBeanServer --&gt;
  &lt;property name="server" ref="mbeanServer" /&gt;
&lt;/bean&gt;
</pre>
</div></div>

<p><span class="confluence-anchor-link" id="JMXManagement-response_time"></span></p>

<h1 id="JMXManagement-Howtogetwebserviceperformancemetrics(Request/Responsetime,numberofcalls,etc.)?">如何获取Web服务性能指标（请求/响应时间，呼叫次数等）？</h1>

<p>CXF管理模块还提供了一项功能（性能。计数器。服务器MBean），它为CXF总线中运行的服务提供汇总统计信息。默认情况下未启用它，以避免在Web服务调用处理期间不必要的运行时开销。</p>

<p>这是您应该添加到Spring上下文文件中才能查看此信息的配置代码段：</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
    &lt;!-- Wiring the counter repository --&gt;
    &lt;bean id="CounterRepository" class="org.apache.cxf.management.counters.CounterRepository"&gt;
        &lt;property name="bus" ref="cxf" /&gt;
    &lt;/bean&gt;
</pre>
</div></div>

<p>CounterRepository收集以下指标：调用，已检查的应用程序故障，未检查的应用程序故障，运行时故障，逻辑运行时故障，总处理时间，最大处理时间和最小处理时间。请注意，在您将在JMX监视软件中看到MBean之前，将需要针对Web服务进行SOAP调用。</p></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </tbody></table>
   </td>
   <td id="cell-2-2" colspan="2"> </td>
  </tr>
  <tr>
   <td id="cell-3-0"> </td>
   <td id="cell-3-1"> </td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">隐私政策</a> -（ <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=70534">编辑页面</a> ）（ <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=70534&showComments=true&showCommentArea=true#addcomment">添加评论</a> ）<br>Apache CXF，CXF，Apache，Apache Feather徽标是The Apache Software Foundation的商标。<br>提及的所有其他商标可能是其各自所有者的商标或注册商标。
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3"> </td>
   <td id="cell-3-4"> </td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2"> </td>
    <td id="cell-4-1"> </td>
    <td id="cell-4-2" colspan="2"> </td>
  </tr>
</tbody></table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>




</body></html>