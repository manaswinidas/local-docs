<html ><head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - Using CXF-JCA RAR in Application Server">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script src='/resources/highlighter/scripts/shBrushXml.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>Apache CXF-在Application Server中使用CXF-JCA RAR</title>
  </head>
<body  onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td id="cell-0-0" colspan="2"> </td>
    <td id="cell-0-1"> </td>
    <td id="cell-0-2" colspan="2"> </td>
  </tr>
  <tr>
    <td id="cell-1-0"> </td>
    <td id="cell-1-1"> </td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight:bold;font-size:170%;color:white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="阿帕奇软件基金会"><img border="0" alt="ASF徽标" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></tbody></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tbody><tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs --> <a href="index.html">索引</a> > <a href="deployment.html">部署</a> > <a href="using-cxf-jca-rar-in-application-server.html">在应用程序服务器中使用CXF-JCA RAR</a> <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">下载</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">文献资料</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </tbody></table>
      </div>
    </td>
    <td id="cell-1-3"> </td>
    <td id="cell-1-4"> </td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2"> </td>
    <td id="cell-2-1">
      <table>
        <tbody><tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">总览</a></li><li><a shape="rect" href="how-tos.html">操作方法</a></li><li><a shape="rect" href="frontends.html">前端</a></li><li><a shape="rect" href="databindings.html">数据绑定</a></li><li><a shape="rect" href="transports.html">运输工具</a></li><li><a shape="rect" href="configuration.html">组态</a></li><li><a shape="rect" href="debugging-and-logging.html">调试和记录</a></li><li><a shape="rect" href="tools.html">工具类</a></li><li><a shape="rect" href="restful-services.html">RESTful服务</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL绑定</a></li><li><a shape="rect" href="service-routing.html">服务路由</a></li><li><a shape="rect" href="dynamic-languages.html">动态语言</a></li><li><a shape="rect" href="ws-support.html">WS- *支持</a></li><li><a shape="rect" href="advanced-integration.html">进阶整合</a></li><li><a shape="rect" href="deployment.html">部署方式</a></li><li><a shape="rect" href="schemas-and-namespaces.html">模式和命名空间的使用</a></li></ul><hr><ul class="alternate"><li><p>搜索</p></li></ul><form id="cse-search-box" enctype="application/x-www-form-urlencoded" method="get" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="搜索">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF网站</a></li></ul><p> </p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><h1 id="UsingCXF-JCARARinApplicationServer-DeployCXF-JCARAR.">部署CXF-JCA RAR。</h1>
<p>cxf-integration-jca模块已实现JCA1.5出站连接。您可以在$ CXF_HOME / samples / integration / jca中查看示例。</p>

<style type="text/css">/*<![CDATA[*/
div.rbtoc1524513368290 {padding: 0px;}
div.rbtoc1524513368290 ul {list-style: disc;margin-left: 0px;padding-left: 20px;}
div.rbtoc1524513368290 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class="toc-macro rbtoc1524513368290">
<ul class="toc-indentation"><li><a shape="rect" href="#UsingCXF-JCARARinApplicationServer-DeployCXF-JCARAR.">部署CXF-JCA RAR。</a>
<ul class="toc-indentation"><li><a shape="rect" href="#UsingCXF-JCARARinApplicationServer-BuildCXF-JCARAR">生成CXF-JCA RAR</a></li><li><a shape="rect" href="#UsingCXF-JCARARinApplicationServer-DeployRARtoJBOSS.">将RAR部署到JBOSS。</a>
<ul class="toc-indentation"><li><a shape="rect" href="#UsingCXF-JCARARinApplicationServer-DeploythestandaloneRAR.">部署独立的RAR。</a></li><li><a shape="rect" href="#UsingCXF-JCARARinApplicationServer-DeploytheRARinEAR.">在EAR中部署RAR。</a></li></ul>
</li><li><a shape="rect" href="#UsingCXF-JCARARinApplicationServer-DeployRARtoWeblogic.">将RAR部署到Weblogic。</a>
<ul class="toc-indentation"><li><a shape="rect" href="#UsingCXF-JCARARinApplicationServer-PackageRARinanEAR.">将RAR封装在EAR中。</a></li></ul>
</li><li><a shape="rect" href="#UsingCXF-JCARARinApplicationServer-DeployRARtoWebSphere.">将RAR部署到WebSphere。</a></li></ul>
</li><li><a shape="rect" href="#UsingCXF-JCARARinApplicationServer-UsingJCAConnection.">使用JCA连接。</a>
<ul class="toc-indentation"><li><a shape="rect" href="#UsingCXF-JCARARinApplicationServer-GetConnectionfromManagedConnectionFactory.">从ManagedConnectionFactory获取连接。</a></li><li><a shape="rect" href="#UsingCXF-JCARARinApplicationServer-UsingCXF-JCARARtoaccesstheStatelessSessionBean.">使用CXF-JCA RAR访问无状态会话Bean。</a>
<ul class="toc-indentation"><li><a shape="rect" href="#UsingCXF-JCARARinApplicationServer-Activatetheejb_servant.propertiesfile.">激活ejb_servant.properties文件。</a></li></ul>
</li></ul>
</li></ul>
</div>

<h2 id="UsingCXF-JCARARinApplicationServer-BuildCXF-JCARAR">生成CXF-JCA RAR</h2>
<p>jca rar软件包的结构为：</p>
    <div class="preformatted panel" style="border-width:1px"><div class="preformattedContent panelContent">
<pre>    |---META-INF
    |---META-INF/ra.xml
    |---cxf-api-2.1.jar
    |---cxf-integration-jca-2.1.jar
    |---.....
    </pre>
</div></div>

<p>请参考此<a shape="rect" class="external-link" href="https://svn.apache.org/repos/asf/incubator/cxf/trunk/distribution/src/main/release/samples/integration/jca/inbound/build.xml">build.xml</a> “ generate.rar”目标以构建rar详细信息。</p>

<h2 id="UsingCXF-JCARARinApplicationServer-DeployRARtoJBOSS.">将RAR部署到JBOSS。</h2>

<h3 id="UsingCXF-JCARARinApplicationServer-DeploythestandaloneRAR.">部署独立的RAR。</h3>
<p><strong>（注意：这已经针对JBoss4.0.5进行了测试）</strong></p>

<ol><li>您需要将$ JBOSS_HOME / lib / endorsed中的jars放在下面。
	<ul><li>geronimo-activation_1.1_spec-1.0-M1.jar</li><li>geronimo-annotation_1.0_spec-1.1.jar</li><li>geronimo-ws-metadata_2.0_spec-1.1.1.jar</li><li>jaxb-api-2.1.jar</li><li>jaxb-impl-2.1.4.jar</li><li>jaxb-xjc-2.1.4.jar</li><li>jsr181-api-1.0-MR1.jar</li><li>saaj-api-1.3.jar</li><li>saaj-impl-1.3.jar</li><li>stax-api-1.0.1.jar</li><li>stax-utils-20060502.jar</li></ul>
	</li><li>将rar复制到$ JBOSS_HOME / server / default</li><li>如下创建cxfj2ee_1_5-ds.xml，并将其复制到$ JBOSS_HOME / server / default<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;!DOCTYPE connection-factories
    PUBLIC "-//JBoss//DTD JBOSS JCA Config 1.5//EN"
    "http://www.jboss.org/j2ee/dtd/jboss-ds_1_5.dtd"&gt;
&lt;connection-factories&gt;
  &lt;no-tx-connection-factory&gt;
    &lt;jndi-name&gt;CXFConnector&lt;/jndi-name&gt;
    &lt;rar-name&gt;cxf.rar&lt;/rar-name&gt;
    &lt;connection-definition&gt;org.apache.cxf.connector.CXFConnectionFactory&lt;/connection-definition&gt;
  &lt;/no-tx-connection-factory&gt;
&lt;/connection-factories&gt;
</pre>
</div></div></li></ol>


<p>您可以参考jca示例的<a shape="rect" class="external-link" href="https://svn.apache.org/repos/asf/incubator/cxf/trunk/distribution/src/main/release/samples/integration/jca/inbound/README.txt">自述文件</a>了解详细信息。</p>

<h3 id="UsingCXF-JCARARinApplicationServer-DeploytheRARinEAR.">在EAR中部署RAR。</h3>
<p><strong>（注意：已针对JBoss4.0.5和JBoss4.2.1进行了测试）</strong></p>
<ul><li>具有application.xml<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;application&gt;
	&lt;display-name&gt;cxf-jca&lt;/display-name&gt;
	&lt;module&gt;
		&lt;connector&gt;cxf.rar&lt;/connector&gt;
	&lt;/module&gt;
&lt;/application&gt;
</pre>
</div></div></li></ul>


<ul><li>具有jboss-app.xml来配置类加载器。
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;jboss-app&gt;
	&lt;loader-repository&gt;
		apache.cxf:loader=cxf.ear
		&lt;loader-repository-config&gt;
			java2ParentDelegation=true
		&lt;/loader-repository-config&gt;
	&lt;/loader-repository&gt;
	&lt;module&gt;
		&lt;service&gt;cxf-ds.xml&lt;/service&gt;
	&lt;/module&gt;
&lt;/jboss-app&gt;
</pre>
</div></div></li></ul>


<ul><li>在JBoss中有用于jca的cxf-ds。
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
 &lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;connection-factories&gt;
  &lt;no-tx-connection-factory&gt;
    &lt;jndi-name&gt;CXFConnector&lt;/jndi-name&gt;
    &lt;rar-name&gt;cxf.ear#cxf.rar&lt;/rar-name&gt;
    &lt;connection-definition&gt;org.apache.cxf.connector.CXFConnectionFactory&lt;/connection-definition&gt;
  &lt;/no-tx-connection-factory&gt;
&lt;/connection-factories&gt;
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-tip"><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>rar名称应为全名，即ear-name＃rar-name，而不是单独的rar-name。</p></div></div></li><li>将application.xml和jboss-app.xml放在META-INF文件夹中。</li><li>将cxf.rar和cxf-ds.xml放在EAR中。</li></ul>


<ul><li>
	<ul><li>对于JBoss4.0.5，需要将<strong>geronimo-ws-metadata_2.0_spec-1.1.1.jar</strong>放在<strong>$</strong> <strong>JBOSS_HOME</strong> <strong>/ lib / endorsed</strong>文件夹中。<br clear="none">确保cxf.rar库不包含<strong>xml-apis.jar和xml-resolver.jar</strong> 。</li><li>对于JBoss4.2.1，不需要将任何jar放在认可的文件夹中，但是需要确保cxf.rar库<br clear="none">不包含<strong>xml-api.jar</strong> 。</li></ul>
	</li></ul>





<h2 id="UsingCXF-JCARARinApplicationServer-DeployRARtoWeblogic.">将RAR部署到Weblogic。</h2>
<p><strong>（注意：这已经针对WebLogic9.1进行了测试）</strong></p>

<h3 id="UsingCXF-JCARARinApplicationServer-PackageRARinanEAR.">将RAR封装在EAR中。</h3>
<ul><li>在<strong>META-INF</strong>文件夹中添加一个weblogic-ra.xml。
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;weblogic-connector xmlns="http://www.bea.com/ns/weblogic/90"&gt;
    &lt;outbound-resource-adapter&gt;
        &lt;connection-definition-group&gt;
	   &lt;connection-factory-interface&gt;org.apache.cxf.connector.CXFConnectionFactory&lt;/connection-factory-interface&gt;
           &lt;connection-instance&gt;    
		&lt;jndi-name&gt;CXFConnector&lt;/jndi-name&gt;
           &lt;/connection-instance&gt;
        &lt;/connection-definition-group&gt;
    &lt;/outbound-resource-adapter&gt;
&lt;/weblogic-connector&gt;
</pre>
</div></div></li></ul>


<ul><li>使用application.xml将RAR打包在EAR中。</li><li>将<strong>geronimo-ws-metadata_2.0_spec-1.1.1.jar</strong>放入$ WebLogic_HOME / $ JDK_Home / jre / lib / endorsed中</li></ul>



<h2 id="UsingCXF-JCARARinApplicationServer-DeployRARtoWebSphere.">将RAR部署到WebSphere。</h2>

<p>待定</p>

<h1 id="UsingCXF-JCARARinApplicationServer-UsingJCAConnection.">使用JCA连接。</h1>

<h2 id="UsingCXF-JCARARinApplicationServer-GetConnectionfromManagedConnectionFactory.">从ManagedConnectionFactory获取连接。</h2>
<p>下面是获取连接的代码段。</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">

        URL wsdl = getClass().getResource("/wsdl/hello_world.wsdl");                
        CXFConnectionRequestInfo cri = new CXFConnectionRequestInfo(Greeter.class, 
                                           wsdl,
                                           serviceName,
                                           portName);
        ManagedConnectionFactory managedFactory = new ManagedConnectionFactoryImpl();
        Subject subject = new Subject();
        ManagedConnection mc = managedFactory.createManagedConnection(subject, cri);        
        Object o = mc.getConnection(subject, cri);
</pre>
</div></div>

<p>也可以在没有wsdl的情况下获得连接，但是您需要提供地址。</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">

        CXFConnectionRequestInfo requestInfo = new CXFConnectionRequestInfo();
        requestInfo.setInterface(Greeter.class);
        requestInfo.setAddress("http://localhost:9000/SoapContext/SoapPort");
        
        ManagedConnectionFactory factory = new ManagedConnectionFactoryImpl();
        ManagedConnection mc = factory.createManagedConnection(null, requestInfo);
        Object client = mc.getConnection(null, requestInfo);
</pre>
</div></div>

<h2 id="UsingCXF-JCARARinApplicationServer-UsingCXF-JCARARtoaccesstheStatelessSessionBean.">使用CXF-JCA RAR访问无状态会话Bean。</h2>
<p>通过使用cxf-jca RAR，EIS可以通过CXF内部API或JAXWS API访问无状态会话Bean。<br clear="none">如果要部署无状态会话Bean，则需要修改ejb_servant.properties文件。</p>
<h3 id="UsingCXF-JCARARinApplicationServer-Activatetheejb_servant.propertiesfile.">激活ejb_servant.properties文件。</h3>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
# Format: 
# jndi_name={namespace}ServiceName@url_to_swdl
#   
# jndi_name: The JNDI name that an external client uses to contact the bean.
# ServiceName: The string form of the QName for the service in the WSDL file.
# @url_to_wsdl: The string form of a URL that identifies the WSDL file.
#
# Example:
# GreeterBean={http://apache.org/hello_world_soap_http}Greeter@file:c:/wsdl/hello_world.wsdl
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-tip"><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>您可以在$ RAR / META-INF / ra.xml“ EJBServicePropertiesURL”属性值中指定ejb_servant.properties文件位置。</p></div></div>
<div class="confluence-information-macro confluence-information-macro-warning"><span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>您需要在激活ejb_servant.properties文件之前部署ejb，否则，它将找不到JNDI名称。</p></div></div>

</div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </tbody></table>
   </td>
   <td id="cell-2-2" colspan="2"> </td>
  </tr>
  <tr>
   <td id="cell-3-0"> </td>
   <td id="cell-3-1"> </td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">隐私政策</a> -（ <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=67429">编辑页面</a> ）（ <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=67429&showComments=true&showCommentArea=true#addcomment">添加评论</a> ）<br>Apache CXF，CXF，Apache，Apache Feather徽标是The Apache Software Foundation的商标。<br>提及的所有其他商标可能是其各自所有者的商标或注册商标。
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3"> </td>
   <td id="cell-3-4"> </td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2"> </td>
    <td id="cell-4-1"> </td>
    <td id="cell-4-2" colspan="2"> </td>
  </tr>
</tbody></table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>




</body></html>