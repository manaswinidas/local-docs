<html ><head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - HTTP Binding">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script src='/resources/highlighter/scripts/shBrushXml.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>Apache CXF-HTTP绑定</title>
  </head>
<body  onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tbody><tr>
    <td id="cell-0-0" colspan="2"> </td>
    <td id="cell-0-1"> </td>
    <td id="cell-0-2" colspan="2"> </td>
  </tr>
  <tr>
    <td id="cell-1-0"> </td>
    <td id="cell-1-1"> </td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight:bold;font-size:170%;color:white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="阿帕奇软件基金会"><img border="0" alt="ASF徽标" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></tbody></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tbody><tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs --> <a href="index.html">索引</a> > <a href="restful-services.html">RESTful服务</a> > <a href="http-binding.html">HTTP绑定</a> <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">下载</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">文献资料</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </tbody></table>
      </div>
    </td>
    <td id="cell-1-3"> </td>
    <td id="cell-1-4"> </td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2"> </td>
    <td id="cell-2-1">
      <table>
        <tbody><tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">总览</a></li><li><a shape="rect" href="how-tos.html">操作方法</a></li><li><a shape="rect" href="frontends.html">前端</a></li><li><a shape="rect" href="databindings.html">数据绑定</a></li><li><a shape="rect" href="transports.html">运输工具</a></li><li><a shape="rect" href="configuration.html">组态</a></li><li><a shape="rect" href="debugging-and-logging.html">调试和记录</a></li><li><a shape="rect" href="tools.html">工具类</a></li><li><a shape="rect" href="restful-services.html">RESTful服务</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL绑定</a></li><li><a shape="rect" href="service-routing.html">服务路由</a></li><li><a shape="rect" href="dynamic-languages.html">动态语言</a></li><li><a shape="rect" href="ws-support.html">WS- *支持</a></li><li><a shape="rect" href="advanced-integration.html">进阶整合</a></li><li><a shape="rect" href="deployment.html">部署方式</a></li><li><a shape="rect" href="schemas-and-namespaces.html">模式和命名空间的使用</a></li></ul><hr><ul class="alternate"><li><p>搜索</p></li></ul><form id="cse-search-box" enctype="application/x-www-form-urlencoded" method="get" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="搜索">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x（Javadoc）</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF网站</a></li></ul><p> </p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><p>CXF包含一个“ HTTP绑定”，可轻松构建REST样式的服务。HTTP绑定允许您执行任何操作并将其映射到任意URI和HTTP动词（即GET，PUT，POST，DELETE）。</p>

<div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>此绑定已被弃用，并可能在其将来的版本之一中从CXF中删除。</p></div></div>

<h1 id="HTTPBinding-Conventionbasedservices">基于公约的服务</h1>
<p>如果您有一个简单的基于CRUD的Java类，则CXF可以尝试自动为您构建一组资源，而无需注释或配置。最好通过一个例子来解释。让我们看一下典型的CRUD类：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
import javax.jws.WebService;

@WebService
public interface PeopleService {
  Collection&lt;Person&gt; getPeople();
  Person getPerson(long id);
  void addPerson(Person person);
  void updatePerson(long id, Person person);
  void deletePerson(long id);
}
</pre>
</div></div>

<div class="confluence-information-macro confluence-information-macro-note"><p class="title">Web服务注释</p><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>的<code>@WebService</code>注释为必填项。</p></div></div>

<p>使用CXF基于约定的映射，将创建一组资源并将其映射到这些操作。</p>

<p><strong>1：集合<person>getPeople（）</person></strong>映射到/ people上的HTTP GET</p>

<p>这很简单。我们看到“ get”，将其映射到GET操作。然后，从操作名称中提取人员并将其转换为简单的URI。访问<a shape="rect" class="external-link" href="http://server/people" rel="nofollow">http：// server / people</a>将得到如下文档：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;getPeople&gt;
&lt;Person&gt;...&lt;/Person&gt;
&lt;Person&gt;...&lt;/Person&gt;
&lt;/getPeople&gt;
</pre>
</div></div>

<p><strong>2：Person getPerson（id）</strong>映射到/ people / {id}上的HTTP GET。</p>

<p>在这里，我们再次从操作中提取资源名称，但是您会注意到我们正在对其进行复数处理。CXF的封面之下使用的是一个类，该类可以接受大多数英语单词并使它们复数。也可以在钩子中添加自己的签名到复数映射，或者根据需要添加自己的语言。</p>

<p>操作中的所有参数都将附加到资源名称之后。如果有两个参数“ bit”和“ bob”，它将变成/ people / {bit} / {bob}。尽管CXF是XML模式原语（int，string，dateTime等），但CXF仅会映射bit和bob。</p>

<p><strong>3：将void addPerson（Person person）</strong>映射到/ people上的HTTP POST。</p>

<p>我们将“添加”识别为“ POST”操作。 “创建”也是可以接受的。再一次使用一些复数形式的魔术来将添加项映射到/ people。</p>

<p><strong>4：void updatePerson（long id，Person person）</strong>映射到/ people / {id}上的HTTP PUT。</p>

<p>除了将“更新”操作映射到PUT之外，这里的规则与＃2相同。</p>

<p><strong>5：void deletePerson（long id）</strong>映射到/ people / {id}上的HTTP DELETE</p>

<p>除了要在操作中查找“删除”和“删除”并将其映射到HTTP DELETE之外，此处的规则与＃2和＃4相同。</p>

<h2 id="HTTPBinding-Configuringtheservice">配置服务</h2>
<p>您可以通过使用JaxWsFactoryBean创建使用HTTP绑定的服务：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
JaxWsServerFactoryBean sf = new JaxWsServerFactoryBean();
sf.setServiceClass(PeopleService.class);
sf.getServiceFactory().setWrapped(true);
sf.setBindingId(HttpBindingFactory.HTTP_BINDING_ID);
sf.setAddress("http://localhost:9001/");

PeopleService peopleService = new PeopleServiceImpl();
sf.getServiceFactory().setInvoker(new BeanInvoker(peopleService));

Server svr = sf.create();
</pre>
</div></div>

<p>需要注意的几件事：</p>
<ul><li>JaxWsServerFactory bean在CXF内创建一个服务器，该服务器开始侦听指定URL上的请求。</li><li>bindingId指定如何将服务操作映射到资源：在这种情况下，使用http绑定。</li><li>我们告诉ServiceFactory以“包装”模式工作。这仅意味着我们的xml文档将使用操作名称进行包装，从而使我们拥有多个输入参数。关于此的更多信息。</li></ul>


<h1 id="HTTPBinding-JavaRESTAnnotations">Java REST批注</h1>

<p>Java REST注释是为CXF提供有关如何将操作映射到任意URI / HTTP动词组合的信息的注释。</p>

<p>可以说我想建立一个共享和操作客户数据的HTTP服务。我可能要做的第一件事是创建一个URI，该URI返回数据库中所有客户的文档。使用JRA注释，可以这样进行：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
@Get 
@HttpResource(location="/customers")
Collection&lt;Customer&gt; getCustomers();
</pre>
</div></div>

<p>@Get批注将操作映射到GET动词，@ HttpResource将其映射到URI“ / customers”。该列表会从您正在使用的数据绑定实现中发送出去，并将被序列化为文档。到目前为止非常简单！</p>

<p>现在说我想从/ customers / ID下拉特定的客户：</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
@Get 
@HttpResource(location="/customers/{id}") 
Customer getCustomers(GetCustomer getCustomer);
</pre>
</div></div>

<p>此示例中的主要新概念是URI模板。GetCustomer对象具有一个名为“ id”的属性：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
public class GetCustomer {
  String getId() { .. }
  void setId(String id) { .. }
</pre>
</div></div>
<p>URI参数根据其架构和WSDL 2规则映射到XML文档。因此，如果您访问URL，则/ customers / 123 CXF实际上将合成这样的传入XML文档：</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;getCustomer&gt;&lt;id&gt;123&lt;/id&gt;&lt;/getCustomer&gt;
</pre>
</div></div>

<p>然后，数据绑定层将其转换为GetCustomer对象。让我们继续来看一个更复杂的示例-一个更新客户的PUT操作：</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
@Put
@HttpResource(location="/customers/{id}") 
Customer updateCustomer(Customer customer);
</pre>
</div></div>

<p>这次我们没有合成文档，实际上是将URI参数合并到传入的文档中。这意味着{id}将映射到传入客户文档的/ customer / id。由于文档很可能已经在其中包含客户ID，因此{id}主要用于创建外观漂亮的URI。</p>

<p>最后一个例子，让我们看一下添加客户：</p>

<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
@Post 
@HttpResource(location="/customers") 
void addCustomer(Customer customer);
</pre>
</div></div>

<p>这将允许用户使用其文档对/ customers URI进行POST，并将其添加到其中包含的客户集合中。</p>

<h2 id="HTTPBinding-Examplewithmultiplearguments">具有多个参数的示例</h2>
<p>要使用多个参数，必须使用@WebParam批注将url的参数映射到服务参数。<br clear="none">例如：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
@Get
@HttpResource(location="/customers/{first}/{last}") 
void findCustomer(@WebParam(name="first") String firstName, @WebParam(name="last") String lastName);
</pre>
</div></div>

<h2 id="HTTPBinding-ConfiguringtheService">配置服务</h2>
<p>JRA样式服务的配置与基于约定的服务完全相同。但是，在此示例中，服务未处于“包装”模式。因此配置略有不同，因为我们无需显式设置包装设置：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
JaxWsServerFactoryBean sf = new JaxWsServerFactoryBean();
sf.setServiceClass(CustomerService.class);
sf.setBindingFactory(new HttpBindingInfoFactoryBean());
sf.setAddress("http://localhost:9001/");

CustomerService customerService = new CustomerServiceImpl();
sf.getServiceFactory().setInvoker(new BeanInvoker(customerService));

Server svr = sf.create();
</pre>
</div></div>

<h2 id="HTTPBinding-ConfiguringtheserviceincontainerwithSpringconfigurationfile.">使用Spring配置文件在容器中配置服务。</h2>
<h3 id="HTTPBinding-web.xml">web.xml</h3>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;

&lt;!DOCTYPE web-app
    PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
    "http://java.sun.com/dtd/web-app_2_3.dtd"&gt;
&lt;web-app&gt;
	&lt;context-param&gt;
		&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
		&lt;param-value&gt;WEB-INF/beans.xml&lt;/param-value&gt;
	&lt;/context-param&gt;

	&lt;listener&gt;
		&lt;listener-class&gt;
			org.springframework.web.context.ContextLoaderListener
		&lt;/listener-class&gt;
	&lt;/listener&gt;

	&lt;servlet&gt;
		&lt;servlet-name&gt;CXFServlet&lt;/servlet-name&gt;
		&lt;display-name&gt;CXF Servlet&lt;/display-name&gt;
		&lt;servlet-class&gt;
			org.apache.cxf.transport.servlet.CXFServlet
		&lt;/servlet-class&gt;
		&lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
	&lt;/servlet&gt;

	&lt;servlet-mapping&gt;
		&lt;servlet-name&gt;CXFServlet&lt;/servlet-name&gt;
		&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
	&lt;/servlet-mapping&gt;
&lt;/web-app&gt;
</pre>
</div></div>

<h3 id="HTTPBinding-beans.xml">beans.xml</h3>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:jaxws="http://cxf.apache.org/jaxws"
	xsi:schemaLocation="
	http://www.springframework.org/schema/beans 
	http://www.springframework.org/schema/beans/spring-beans.xsd
	http://cxf.apache.org/jaxws 
	http://cxf.apache.org/schemas/jaxws.xsd"&gt;

  &lt;import resource="classpath:META-INF/cxf/cxf.xml"/&gt;
  &lt;import resource="classpath:META-INF/cxf/cxf-extension-http-binding.xml"/&gt;
  &lt;import resource="classpath:META-INF/cxf/cxf-servlet.xml"/&gt;
  
   &lt;jaxws:endpoint id="userService"
		   implementor="org.apache.cxf.CustomerServiceImpl"
		   address="/customerService"
		   bindingUri="http://apache.org/cxf/binding/http"&gt;
       &lt;jaxws:serviceFactory&gt;
           &lt;bean class="org.apache.cxf.jaxws.support.JaxWsServiceFactoryBean"&gt;
               &lt;property name="wrapped" value="true" /&gt;
           &lt;/bean&gt;
       &lt;/jaxws:serviceFactory&gt;
   &lt;/jaxws:endpoint&gt;
	  
&lt;/beans&gt;
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-information"><p class="title">有用的信息</p><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>JaxWsServiceFactoryBean无法在各种服务之间重用。</p></div></div>

<h1 id="HTTPBinding-Wrappedvs.UnwrappedMode">包装模式与非包装模式</h1>
<p>在REST样式服务中，我们只能发送和接收一个XML元素。包装是用操作名称包装XML请求/响应的过程，以允许对您的操作使用多个参数。例如，假设我们有一个操作“ Customer findCustomer（String name，String company）”。创建这样的XML POST请求无效：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;name&gt;Dan&lt;/name&gt;
&lt;company&gt;Acme Inc&lt;/company&gt;
</pre>
</div></div>
<p>那有两个根XML元素，这是不允许的。相反，我们将必须用操作名称“包装” POST：</p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;findCustomers&gt;
&lt;name&gt;Dan&lt;/name&gt;
&lt;company&gt;Acme Inc&lt;/company&gt;
&lt;/findCustomers&gt;
</pre>
</div></div>
<p>您可能想知道为什么我们不总是打开包装纸？包装好会产生难看的XML。以以下操作为例：Collection <customer>getCustomers（）。生成的XML将是：</customer></p>
<div class="code panel pdl" style="border-width:1px"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default" style="font-size:12px;">
&lt;getCustomersResponse&gt;
&lt;Customers&gt;
&lt;Customer&gt;..&lt;/Customer&gt;
&lt;Customer&gt;..&lt;/Customer&gt;
&lt;/Customers&gt;
&lt;/getCustomersResponse&gt;
</pre>
</div></div>
<p>不需要getCustomersResponse元素，并使响应更难看。CXF允许您选择所需的样式。在包装模式下，您可以根据需要编写服务接口。</p>

<p>在展开模式下，您必须仅接收单个输入并以单个输出进行响应。如果希望采用多个参数，则必须将它们组合在一个对象中。在上面的findCustomer示例中，您需要创建一个名称和公司属性的FindCustomer类型。</p></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </tbody></table>
   </td>
   <td id="cell-2-2" colspan="2"> </td>
  </tr>
  <tr>
   <td id="cell-3-0"> </td>
   <td id="cell-3-1"> </td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">隐私政策</a> -（ <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=31896">编辑页面</a> ）（ <a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=31896&showComments=true&showCommentArea=true#addcomment">添加评论</a> ）<br>Apache CXF，CXF，Apache，Apache Feather徽标是The Apache Software Foundation的商标。<br>提及的所有其他商标可能是其各自所有者的商标或注册商标。
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3"> </td>
   <td id="cell-3-4"> </td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2"> </td>
    <td id="cell-4-1"> </td>
    <td id="cell-4-2" colspan="2"> </td>
  </tr>
</tbody></table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>




</body></html>