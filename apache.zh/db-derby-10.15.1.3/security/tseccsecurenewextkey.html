<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Encrypting databases with a new external encryption key">
<meta name="abstract" content="You can apply a new external encryption key to a Derby database by specifying the newEncryptionKey=key attribute on the connection URL when you boot the database.">
<meta name="description" content="You can apply a new external encryption key to a Derby database by specifying the newEncryptionKey=key attribute on the connection URL when you boot the database.">
<meta name="DC.subject" content="encrypting databases, new external key, databases, encrypting, new external key">
<meta name="keywords" content="encrypting databases, new external key, databases, encrypting, new external key">
<meta name="DC.Relation" scheme="URI" content="tseccsecurenewkeyoverview.html">
<meta name="DC.Relation" scheme="URI" content="tseccsecurenewbootpw.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="tseccsecurenewextkey">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>使用新的外部加密密钥加密数据库</title>
</head>
<body id="tseccsecurenewextkey" ><a name="tseccsecurenewextkey"><!-- --></a>


<h1 class="topictitle1">使用新的外部加密密钥加密数据库</h1>



<div><p>您可以通过指定以下选项将新的外部加密密钥应用于<span>Derby</span>数据库： <samp class="codeph">newEncryptionKey=<em>key</em></samp>引导数据库时，连接URL上的“属性”属性。</p>

<div class="p"><ul>
<li>如果为数据库配置了日志归档以进行前滚恢复，则必须先禁用日志归档并执行关闭操作，然后才能使用新的外部加密密钥对数据库进行加密。</li>

<li>恢复后，如果任何全局事务处于准备状态，则无法使用新的加密密钥对数据库进行加密。</li>

<li>如果当前使用启动密码对数据库进行加密，请<a href="tseccsecurenewbootpw.html">使用<samp class="codeph">newBootPassword=<em>newPassword</em></samp>属性</a>以加密数据库。</li>

</ul>
</div>

<div class="section"><p>要使用新的外部加密密钥加密数据库：</p>

</div>


<div class="p"><span>指定<samp class="codeph">newEncryptionKey=<em>key</em></samp>属性中的URL，然后重新启动数据库。</span>例如，如果您使用以下网址重新启动<samp class="codeph">salesdb</samp>数据库，使用新的加密密钥对数据库进行加密<samp class="codeph">6862636465666768</samp> ：<pre>jdbc:derby:salesdb;encryptionKey=6162636465666768;
newEncryptionKey=6862636465666768'</pre>


 
<p>如果同时启用<a href="cseccsecure42374.html">身份验证</a>和<a href="csecauthorfine.html#csecauthorfine">SQL授权</a> ，则还必须提供<a href="cseccsecuredbowner.html">数据库所有者</a>的凭据，因为加密是受限制的操作。</p>


 <p>更改加密密钥后，请务必检查<samp class="codeph">SQLWarning</samp> s。仅当没有更改时更改成功<samp class="codeph">SQLWarning</samp> s或<samp class="codeph">SQLException</samp> s。</p>

<p>如果在应用新的加密密钥之前禁用了日志归档，请在使用新的加密密钥重新配置数据库之后，创建数据库的新备份。有关更多信息，请参阅《 <span><em>Derby服务器和管理指南</em></span> 》中的“备份和还原数据库”部分，尤其是“前滚恢复”。</p>

</div>


</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="tseccsecurenewkeyoverview.html" title="您可以通过指定新的启动密码或新的外部密钥，将新的加密密钥应用于Derby数据库。">用新密钥加密数据库</a></div>
</div>
<div class="reltasks"><strong>相关任务</strong><br>
<div><a href="tseccsecurenewbootpw.html" title="通过在启动数据库时在连接URL上指定newBootPassword = newPassword属性，可以将新的启动密码应用于Derby数据库。">使用新的启动密码加密数据库</a></div>
</div>
</div>



</body></html>