<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Replication failure handling">
<meta name="abstract" content="Replication can encounter several failure situations. The following table lists these situations and describes the actions that Derby takes as a result.">
<meta name="description" content="Replication can encounter several failure situations. The following table lists these situations and describes the actions that Derby takes as a result.">
<meta name="DC.subject" content="replicating databases, failure handling, database replication">
<meta name="keywords" content="replicating databases, failure handling, database replication">
<meta name="DC.Relation" scheme="URI" content="cadminreplication.html">
<meta name="DC.Relation" scheme="URI" content="cadminreplicstartrun.html">
<meta name="DC.Relation" scheme="URI" content="cadminreplicstop.html">
<meta name="DC.Relation" scheme="URI" content="cadminreplicfailover.html">
<meta name="DC.Relation" scheme="URI" content="cadminreplicsecurity.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="cadminreplicfailures">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>复制失败处理</title>
</head>
<body id="cadminreplicfailures" ><a name="cadminreplicfailures"><!-- --></a>


<h1 class="topictitle1">复制失败处理</h1>



<div><p>复制可能会遇到几种故障情况。下表列出了这些情况，并描述了<span>Derby所</span>采取的措施。</p>


<div class="tablenoborder"><table cellspacing="0" cellpadding="4" border="1" summary="This table lists the possible replication failure situations and describes the actions taken as a result." frame="border" rules="all"><caption>表格1。复制失败处理</caption>


<thead align="left">
<tr valign="bottom">
<th valign="bottom" width="30%" id="N1007C">失败情况</th>

<th valign="bottom" width="70%" id="N10083">所采取的行动</th>

</tr>

</thead>

<tbody>
<tr>
<td valign="top" width="30%" headers="N1007C">主站与从站失去连接。</td>

<td valign="top" width="70%" headers="N10083">当主机尝试与从机重新连接时，允许事务继续处理。连接断开时生成的日志记录将缓冲在主内存中。如果在重新建立连接之前日志缓冲区达到其大小限制，则主复制功能将停止。您可以使用该物业<samp class="codeph">derby.replication.logBufferSize</samp>配置缓冲区的大小限制；有关详细信息，请参见《 <span><em>Derby参考手册</em></span> 》。</td>

</tr>

<tr>
<td valign="top" width="30%" headers="N1007C">从站与主机失去连接。</td>

<td valign="top" width="70%" headers="N10083">从服务器尝试通过侦听指定的主机和端口来与主服务器建立连接。除非其中一个明确要求这样做，否则它不会放弃。 <samp class="codeph">failover=true</samp>要么<samp class="codeph">stopSlave=true</samp>连接URL属性。如果请求故障转移，则从服务器将应用所有接收到的日志记录，并按照“ <a href="cadminreplicfailover.html#cadminreplicfailover">强制故障转移”中的</a>描述引导数据库。如果<samp class="codeph">stopSlave=true</samp>如果指定了属性，则将关闭从数据库，而无需执行进一步的操作。</td>

</tr>

<tr>
<td valign="top" width="30%" headers="N1007C">数据库D的两个不同的主服务器尝试复制到同一从服务器。</td>

<td valign="top" width="70%" headers="N10083">从站仅接受来自第一个尝试连接的主站的连接。请注意，同时启动从属服务器和主服务器都需要身份验证，如<a href="cadminreplicsecurity.html#cadminreplicsecurity">复制和安全性中所述</a> 。</td>

</tr>

<tr>
<td valign="top" width="30%" headers="N1007C">主从<span>德比</span>实例是不是在同一<span>德比</span>版本。
</td>

<td valign="top" width="70%" headers="N10083">引发异常，并且复制无法开始。
</td>

</tr>

<tr>
<td valign="top" width="30%" headers="N1007C">主<span>Derby</span>实例崩溃，然后重新启动。</td>

<td valign="top" width="70%" headers="N10083">如<a href="cadminreplicstartrun.html#cadminreplicstartrun">启动和运行复制中</a>所述，必须重新<a href="cadminreplicstartrun.html#cadminreplicstartrun">启动复制</a> 。</td>

</tr>

<tr>
<td valign="top" width="30%" headers="N1007C">主<span>Derby</span>实例无法以与生成日志相同的速度将日志数据发送到从服务器。主内存日志缓冲区逐渐填满，最终变满。</td>

<td valign="top" width="70%" headers="N10083">主服务器注意到主存储器日志缓冲区已满。它首先尝试提高日志传送速度，以使缓冲区中的日志量保持在最大值以下。如果这不足以阻止缓冲区充满，则只要日志传送无法跟上所生成的日志记录的数量，事务的响应时间就可能增加。您可以使用属性来调整日志缓冲区大小以及连续日志发送之间的最小和最大间隔。有关详细信息，请参见《 <span><em>Derby参考手册</em></span> 》中的“ derby.replication.logBufferSize”，“ derby.replication.maxLogShippingInterval”和“ derby.replication.minLogShippingInterval”。</td>

</tr>

<tr>
<td valign="top" width="30%" headers="N1007C">从属<span>Derby</span>实例崩溃。</td>

<td valign="top" width="70%" headers="N10083">主机将其视为与从机的连接断开。主服务器尝试重新建立连接，直到复制日志缓冲区已满。然后在主服务器上停止复制。如<a href="cadminreplicstartrun.html#cadminreplicstartrun">启动和运行复制中</a>所述，必须重新<a href="cadminreplicstartrun.html#cadminreplicstartrun">启动复制</a> 。</td>

</tr>

<tr>
<td valign="top" width="30%" headers="N1007C">遇到意外故障。</td>

<td valign="top" width="70%" headers="N10083">复制停止。通知复制对的另一个<span>Derby</span>实例是否网络连接仍然有效的决定。</td>

</tr>

</tbody>

</table>
</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="cadminreplication.html" title="复制是强大的数据库管理系统的重要功能。在Derby中，使用连接URL属性启动数据库复制。">复制数据库</a></div>
</div>
<div class="relconcepts"><strong>相关概念</strong><br>
<div><a href="cadminreplicstartrun.html" title="每个复制的数据库都从该数据库的主版本复制到从版本。">启动和运行复制</a></div>
<div><a href="cadminreplicstop.html" title="要停止数据库复制，请使用stopMaster = true连接URL属性连接到master数据库。">停止复制</a></div>
<div><a href="cadminreplicfailover.html" title="您可以随时将具有从属角色的Derby数据库转换为可以处理事务的普通Derby数据库。从从服务器转变为活动Derby数据库的这种转换称为故障转移。">强制故障转移</a></div>
<div><a href="cadminreplicsecurity.html" title="如果要在启用安全管理器的情况下执行复制，则必须在主系统和从系统上都修改安全策略文件，以允许主从网络连接。">复制和安全性</a></div>
</div>
</div>



</body></html>