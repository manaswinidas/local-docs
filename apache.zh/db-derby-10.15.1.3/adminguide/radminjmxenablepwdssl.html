<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="reference">
<meta name="DC.Title" content="Enabling remote JMX with password authentication and SSL">
<meta name="abstract" content="This example shows how to start the Network Server as follows.">
<meta name="description" content="This example shows how to start the Network Server as follows.">
<meta name="DC.subject" content="Java Management Extensions (JMX) technology, JMX, enabling with password authentication and SSL">
<meta name="keywords" content="Java Management Extensions (JMX) technology, JMX, enabling with password authentication and SSL">
<meta name="DC.Relation" scheme="URI" content="radminjmxenabledisable.html">
<meta name="DC.Relation" scheme="URI" content="radminjmxenablenoauth.html">
<meta name="DC.Relation" scheme="URI" content="radminjmxenablepwd.html">
<meta name="DC.Relation" scheme="URI" content="radminjmxenablesimpleauth.html">
<meta name="DC.Relation" scheme="URI" content="radminjmxenablepolicy.html">
<meta name="DC.Relation" scheme="URI" content="radminjmxdisable.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="radminjmxenablepwdssl">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>使用密码验证和SSL启用远程JMX</title>
</head>
<body id="radminjmxenablepwdssl" ><a name="radminjmxenablepwdssl"><!-- --></a>


<h1 class="topictitle1">使用密码验证和SSL启用远程JMX</h1>



<div><p>本示例说明如何如下启动网络服务器。</p>

<div class="section">
<ul>
<li>使用Java安全管理器和自定义策略文件，<samp class="codeph">jmx.policy</samp></li>

<li>通过指定允许来自远程主机（即，在所有IPv4网络接口上）的连接<samp class="codeph">-h 0.0.0.0</samp></li>

<li>使用密码验证，如使用仅通过密码验证<a href="radminjmxenablepwd.html#radminjmxenablepwd">启用远程JMX中</a>所述， <samp class="codeph">jmxremote.password</samp>文件</li>

<li>使用SSL（安全套接字层）进行以下操作：<ul>
<li>验证客户</li>

<li>加密所有与JMX相关的网络通信</li>

<li>保护MBean服务器使用的RMI注册表</li>

</ul>

</li>

</ul>

<p>这种保护级别可能对您来说可能足够，也可能不够，但是比前面的示例更安全。</p>

<p>命令行显示在多行上以提高可读性，但是您可以将其输入为一个<samp class="codeph">java</samp>命令。</p>

<pre><strong>java -Dcom.sun.management.jmxremote.port=9999 
-Dcom.sun.management.jmxremote.password.file=jmxremote.password 
-Djavax.net.ssl.keyStore=/home/user/.keystore 
-Djavax.net.ssl.keyStorePassword=myKeyStorePassword 
-Dcom.sun.management.jmxremote.ssl.need.client.auth=true 
-Djavax.net.ssl.trustStore=/home/user/.truststore 
-Djavax.net.ssl.trustStorePassword=myTrustStorePassword 
-Dcom.sun.management.jmxremote.registry.ssl=true 
-Djava.security.manager 
-Djava.security.policy=jmx.policy 
-jar lib/derbyrun.jar server start -h 0.0.0.0</strong></pre>

<div class="p"><div class="note"><span class="notetitle">注意：</span>启用密码认证并安装Java安全管理器后，需要在使用的安全策略中向受信任的用户授予许多与JMX相关的权限。有关详细信息，请参见<a href="radminjmxenablepolicy.html#radminjmxenablepolicy">使用安全策略</a>进行<a href="radminjmxenablepolicy.html#radminjmxenablepolicy">细粒度的授权</a> 。</div>
</div>

<p>在上面的示例中，系统属性指定了包含服务器密钥对的密钥库，密钥库密码，包含客户端证书的信任库以及信任库密码。《 <span><em>Derby安全指南</em></span> 》的“配置SSL / TLS”一节中介绍了如何设置SSL密钥库和信任库，以及有关使用SSL保护数据库网络流量的更多信息。</p>

<p>如上所述配置SSL时，以下要求适用：</p>

<ul>
<li>私钥的密码必须与密钥库的密码相同。</li>

<li>如果密钥库包含多个密钥对，则必须在密钥库中的所有密钥中首先列出要使用的密钥对。否则，您（或客户）可能会看到异常消息，并显示以下消息：<pre>unable to find valid certification path to requested target</pre>

</li>

</ul>

<p>系统属性<samp class="codeph">com.sun.management.jmxremote.ssl.need.client.auth=true</samp>指定客户端必须使用SSL进行身份验证。如果您不想使用SSL对客户端进行身份验证，则可以删除此属性以及信任库属性。但是，可能存在仅使用密码身份验证相关的安全风险。</p>

<p>系统属性<samp class="codeph">com.sun.management.jmxremote.registry.ssl=true</samp>旨在解决与JMX有关的RMI注册中心的安全问题。此属性必须与<samp class="codeph">com.sun.management.jmxremote.ssl.need.client.auth=true</samp>为了完全保护RMI注册表。</p>

<p>客户端还必须指定并使用适当的密钥库和/或信任库（信任库必须包含服务器的SSL证书）。</p>

<p>有关以上使用的系统属性和潜在安全风险的更多信息，请参见<a href="http://docs.oracle.com/javase/7/docs/technotes/guides/management/agent.html" target="_blank">http://docs.oracle.com/javase/7/docs/technotes/guides/management/agent.html上的</a> “使用JMX技术进行监视和管理”。</p>

</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="radminjmxenabledisable.html" title="您可以在本地和远程使用JMX管理和监视。">启用和禁用JMX</a></div>
</div>
<div class="relref"><strong>相关参考</strong><br>
<div><a href="radminjmxenablenoauth.html" title="以下简单示例使用Oracle JDK JVM在命令行上启动了启用了不安全的远程JMX管理和监视的Derby Network Server。">在没有身份验证或SSL的情况下启用远程JMX</a></div>
<div><a href="radminjmxenablepwd.html" title="一些JVM包含对JMX密码身份验证的内置支持。">仅使用密码身份验证启用远程JMX</a></div>
<div><a href="radminjmxenablesimpleauth.html" title="一些JVM支持用于控制JMX访问的简单访问文件系统。">使用访问文件进行简单授权</a></div>
<div><a href="radminjmxenablepolicy.html" title="当您从命令行启动网络服务器时，默认情况下它将安装安全管理器和基本安全策略。">使用安全策略的细粒度授权</a></div>
<div><a href="radminjmxdisable.html" title="您可能希望在注重安全性的环境中禁用或限制对MBean的访问。您可以使用以下两种技术之一来执行此操作。">禁用对MBean的访问</a></div>
</div>
</div>



</body></html>