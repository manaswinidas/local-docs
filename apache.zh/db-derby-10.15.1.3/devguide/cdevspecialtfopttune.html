<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Measuring the cost of Derby-style table functions">
<meta name="abstract" content="This topic shows how to measure the cost of a Derby-style table function.">
<meta name="description" content="This topic shows how to measure the cost of a Derby-style table function.">
<meta name="DC.subject" content="Functions, calculating table function costs, Optimizer">
<meta name="keywords" content="Functions, calculating table function costs, Optimizer">
<meta name="DC.Relation" scheme="URI" content="cdevspecialtfoptimizer.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="cdevspecialtfopttune">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>衡量Derby样式表功能的成本</title>
</head>
<body id="cdevspecialtfopttune" ><a name="cdevspecialtfopttune"><!-- --></a>


<h1 class="topictitle1">衡量<span>Derby</span>样式表功能的成本</h1>



<div><p>本主题显示如何衡量<span>Derby</span>样式表函数的成本。</p>


<p>以下公式描述了如何估算<em>VTICosting.getEstimatedCostPerInstantiation（）</em>返回的值：</p>


<p><strong>C =我* A</strong></p>


<p>哪里</p>


<ul>
<li><strong>C</strong> =创建和运行表函数估计<strong>ÇOST。</strong>即， <em>VTICosting.getEstimatedCostPerInstantiation（）</em>返回的值。通常， <strong>C</strong> ost是时间的度量单位，以毫秒为单位。</li>

<li><strong>I</strong> =优化程序的<strong>I</strong>精度。衡量优化器估算值偏斜程度的一种方法通常是在您的特定环境中进行。见下面关于如何估计这个<strong>我</strong> mprecision指令。</li>

<li><strong>A</strong> = <strong>A</strong>创建和运行此表函数所花费的精算时间（以毫秒为单位）。</li>

</ul>


<div class="section"><h2 class="sectiontitle">计算优化器的不精确度</h2> 

<p>我们将优化程序<strong>I</strong>精度视为整个运行时环境的常量。以下公式对此进行了描述：</p>


<p><strong>我= O / T</strong></p>


<p>哪里</p>


<ul>
<li><strong>O</strong> = <strong>O</strong>优化器的计划估计成本。</li>

<li><strong>T</strong> =以毫秒为单位计划第<strong>t</strong> otal运行时。</li>

</ul>


<p>要估计这些值，请打开<span>Derby</span>统计信息收集并多次运行以下实验，取平均结果：</p>


<ul>
<li><strong>选择</strong> =从一个大表中选择所有行。</li>

<li><strong>记录</strong> =在统计信息输出中，查找代表表扫描的ResultSet。该扫描具有一个标记为“优化器估计成本”的字段。那是<strong>O。</strong>现在，在ResultSet的统计信息中查找标记为“构造时间”，“开放时间”，“下一个时间”和“关闭时间”的字段。将所有这些字段加起来。总数为<strong>T。</strong></li>

</ul>


<p>例如：</p>


<pre>
MAXIMUMDISPLAYWIDTH 7000;

CALL SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1);
CALL SYSCS_UTIL.SYSCS_SET_STATISTICS_TIMING(1);

select * from T;

values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();
</pre>


</div>


<div class="section"><h2 class="sectiontitle">计算表函数的实际运行时成本</h2> 

<p>以下公式说明了如何计算表函数的<strong>A</strong>精算运行时成本：</p>


<p><strong>A =（P * N）+ E</strong></p>


<p>哪里</p>


<ul>
<li><strong>P</strong> =运行时花费的<strong>P</strong> er行（以毫秒为单位）。</li>

<li><strong>N</strong> =表函数中的行数<strong>N。</strong></li>

<li><strong>E</strong> =创建表函数的<strong>E</strong> mpty实例所花费的时间，该实例中没有行。通常， <strong>P * N个</strong>矮人<strong>E。</strong>即，与循环遍历行的实际成本相比，表函数实例化成本非常小。但是，对于某些表函数，当<strong>N</strong>较小时， <strong>E</strong>可能很重要，并且可能主导表函数的成本。</li>

</ul>


<p>您可能知道<strong>E</strong>基本上为0。如果是这样，您可以跳过此步骤。否则，要估算<strong>E</strong> ，请打开<span>Derby</span>统计信息收集并多次运行以下实验，取平均结果：</p>


<ul>
<li><strong>短路</strong> =短路<span>Derby</span>样式表函数返回的<em>ResultSet</em>的next（）方法，以使它在首次调用时返回<em>false</em> 。这使得<em>ResultSet</em>似乎没有行。
</li>

<li><strong>选择</strong> =从表函数中选择所有行。</li>

<li><strong>记录</strong> =在统计信息输出中，查找代表表函数扫描的VTIResultSet。在该VTIResultSet的统计信息中将字段的值相加，即“构造时间”，“开放时间”，“下一个时间”和“关闭时间”。总数为<strong>E。</strong></li>

</ul>


<p>要估算<strong>P</strong> ，请打开<span>Derby</span>统计信息收集并多次运行以下实验，取平均结果：</p>


<ul>
<li><strong>选择</strong> =从表函数中选择所有行。</li>

<li><strong>记录</strong> =在统计信息输出中，查找代表表函数扫描的VTIResultSet。在该VTIResultSet的统计信息中将字段的值相加，即“构造时间”，“开放时间”，“下一个时间”和“关闭时间”。从结果中减去<strong>E。</strong>现在除以“已看到行”字段的值。结果是<strong>P。</strong></li>

</ul>


</div>


<div class="section"><h2 class="sectiontitle">计算<em>getEstimatedCostPerInstantiation（）</em>返回的值</h2> 

<p>综上所述，以下公式描述了表函数的<em>VTICosting.getEstimatedCostPerInstantiation（）</em>方法返回的值。
</p>


<p><strong>C = O / T * [（P * N）+ E]</strong></p>


</div>


</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="cdevspecialtfoptimizer.html" title="本主题说明如何微调Derby优化器关于在联接顺序中放置表函数的位置的决策。">优化程序对Derby样式表功能的支持</a></div>
</div>
</div>



</body></html>