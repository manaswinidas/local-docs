<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Creating a customized collator">
<meta name="abstract" content="You may need to define a collation order different from that of the strengths provided by the collation=collation attribute.">
<meta name="description" content="You may need to define a collation order different from that of the strengths provided by the collation=collation attribute.">
<meta name="DC.subject" content="customizing collation, collation, customized">
<meta name="keywords" content="customizing collation, collation, customized">
<meta name="DC.Relation" scheme="URI" content="cdevcollation.html">
<meta name="DC.Relation" scheme="URI" content="cdevcollationoverview.html">
<meta name="DC.Relation" scheme="URI" content="cdevcollationlocale.html">
<meta name="DC.Relation" scheme="URI" content="cdevcollationattribs.html">
<meta name="DC.Relation" scheme="URI" content="cdevcollationexamples.html">
<meta name="DC.Relation" scheme="URI" content="cdevcollationlikeequal.html">
<meta name="DC.Relation" scheme="URI" content="tdevdvlpcaseinscoll.html">
<meta name="DC.Relation" scheme="URI" content="tdevdvlpcollation.html">
<meta name="DC.Relation" scheme="URI" content="cdevdvlp51654.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="tdevdvlpcustomcollation">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>创建定制的整理器</title>
</head>
<body id="tdevdvlpcustomcollation" ><a name="tdevdvlpcustomcollation"><!-- --></a>


<h1 class="topictitle1">创建定制的整理器</h1>



<div><p>您可能需要定义与<em>collation = collation</em>属性提供的强度不同的排序顺序。</p>

<div class="section">
<p>若要定义新的排序规则，请按照下列步骤。</p>

</div>

<ol>
<li>
<span>创建一个扩展<em>java.text.spi的类<em>。CollatorProvider</em>类，该类将返回一个按所需方式对字符串进行排序的排序规则。</em></span><em>
</em></li><em>

<li>
<span>创建一个名为<em>META-INF / services / java.text.spi的文本文件<em>。CollatorProvider</em> ，其中包含一行带有您的整理程序提供程序类名称的行。</em></span><em>
</em></li><em>

<li>
<span>将已编译的类文件和文本文件放在jar文件中，然后将其放入JRE的<em>lib / ext</em>目录或<em>java.ext.dirs</em>属性指定的目录之一中。</span></li>

</em></em></ol><em><em>

<div class="example">
<p>例如，假设您要定义一个排序顺序，以使希腊字符在其拉丁字母对等字符附近排序（“ a”附近的“α”，“ b”附近的“β”，依此类推）。您可以使用<em>CollatorProvider</em>定义另一个语言环境，该语言环境返回<em>java.text。RuleBasedCollator</em>与您想要的任何规则。有关如何指定规则的详细信息，请参见<em>RuleBasedCollator</em>类的API文档。以最简单的形式，一组规则可能看起来像<samp class="codeph">"a,A < b,B < c,C"</samp> ，这或多或少意味着应将“ a”和“ A”排在“ b”和“ B”之前，应将其排在“ c”和“ C”之前。因此，要使希腊字符在相似的拉丁字符附近排序，请定义一个看起来像这样的<em>CollatorProvider</em> ：</p>

<pre>
public class MyCollatorProvider extends CollatorProvider {
    public Locale[] getAvailableLocales() {
        return new Locale[] {
            new Locale("en", "US", "greek")
        };
    }
    
    public Collator getInstance(Locale locale) {
        StringBuilder rules = new StringBuilder();
        // alpha should go between a and b
        rules.append("&lt; a,A &lt; \u03b1,\u0391 &lt; b,B");
        // beta should go between b and c
        rules.append("&amp; b,B &lt; \u03b2,\u0392 &lt; c,C");
        // add more rules here ....

        try {
            return new RuleBasedCollator(rules.toString());
        } catch (ParseException pe) {
            throw new Error(pe);
        }
    }
}
</pre>

<p>再次，将已编译的类和<em>META-INF / services / java.text.spi放入<em>。将jarlator</em>文件中的CollatorProvider</em>文件，然后启动<samp class="codeph">ij</samp>与工具<samp class="codeph">-Djava.ext.dirs=.</samp> jar文件所在目录中的option选项。创建一个使用新语言环境的数据库，并插入一些带有希腊和拉丁字符的数据：</p>

<pre>
ij&gt; connect 'jdbc:derby:GreekDB;territory=en_US_greek;collation=TERRITORY_BASED;create=true';
ij&gt; create table t (x varchar(12));
0 rows inserted/updated/deleted
ij&gt; insert into t values 'a', 'b', 'c', 'α', 'β';
5 rows inserted/updated/deleted
ij&gt; select * from t order by x;
X           
------------
a
α
b
β
c 

5 rows selected
</pre>

<p>排序与您想要的一样，希腊字符位于拉丁字符之间，而不是通常位于它们的末尾。</p>

<p>请注意：创建数据库后，如果更新自定义<em>CollatorProvider，</em>以便更改顺序，则需要重新创建数据库。之所以必须这样做，是因为数据库中的索引是有序的，并且如果使用与数据库当前使用的排序规则不同的排序规则对索引进行排序，则可能会看到奇怪的结果。</p>

</div>

</em></em></div><em>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="cdevdvlp51654.html" title="您可以在Derby连接URL上指定属性。">使用数据库连接URL属性</a></div>
</div>
<div class="relconcepts"><strong>相关概念</strong><br>
<div><a href="cdevcollation.html" title="字符集是一组符号和编码。字符数据类型在Derby中表示为Unicode 2.0序列。排序规则定义了字符数据的排序方式。">Derby中基于字符的整理</a></div>
<div><a href="cdevcollationoverview.html" title="Derby支持广泛的字符集，并使用java.lang提供的Unicode支持对所有字符集进行编码。运行Derby数据库的Java虚拟机（JVM）中的字符类。">排序规则在Derby中的工作方式</a></div>
<div><a href="cdevcollationlocale.html" title="Derby支持定义适合区域设置的排序规则的功能。这称为基于语言环境的整理。">基于语言环境的整理</a></div>
<div><a href="cdevcollationattribs.html" title="创建Derby数据库时，您设置的属性确定与数据库中所有字符数据一起使用的排序规则。">控制排序规则的数据库连接URL属性</a></div>
<div><a href="cdevcollationexamples.html" title="这些示例显示了对使用各种排序规则和语言环境属性创建的数据库进行排序的结果。">区分大小写和不区分大小写的字符串排序的示例</a></div>
<div><a href="cdevcollationlikeequal.html" title="当您使用基于语言环境的排序规则时，当您使用LIKE和equal（=）运算符时，比较可以返回不同的结果。">LIKE和相等（=）比较之间的差异</a></div>
</div>
<div class="reltasks"><strong>相关任务</strong><br>
<div><a href="tdevdvlpcaseinscoll.html" title="使用基于语言环境的排序规则创建数据库时，collation = collation值TERRITORY_BASED使用语言环境的默认排序规则强度，通常是TERTIARY，它将在搜索和比较中认为字符大小写很重要。">创建不区分大小写的数据库</a></div>
<div><a href="tdevdvlpcollation.html" title="默认情况下，Derby使用Unicode代码点排序规则。但是，您可以在创建数据库时指定基于语言环境的排序规则。">使用基于语言环境的归类创建数据库</a></div>
</div>
</div>



</em></body></html>