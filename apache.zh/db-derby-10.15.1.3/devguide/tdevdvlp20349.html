<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Shutting down the system">
<meta name="abstract" content="In an embedded environment, when an application shuts down, it should first shut down Derby.">
<meta name="description" content="In an embedded environment, when an application shuts down, it should first shut down Derby.">
<meta name="DC.subject" content="Shutting down the system">
<meta name="keywords" content="Shutting down the system">
<meta name="DC.Relation" scheme="URI" content="cdevdvlp27715.html">
<meta name="DC.Relation" scheme="URI" content="cdevdvlp27610.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="tdevdvlp20349">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>关闭系统</title>
</head>
<body id="tdevdvlp20349" ><a name="tdevdvlp20349"><!-- --></a>


<h1 class="topictitle1">关闭系统</h1>



<div><p>在嵌入式环境中，当应用程序关闭时，应首先关闭<span>Derby</span> 。</p>

<div class="section"> <p>如果启动嵌入式<span>Derby</span>的应用程序退出但使Java虚拟机（JVM）运行，则<span>Derby会</span>继续运行并可用于数据库连接。</p>
<p>在嵌入式系统中，应用程序通过发出以下JDBC调用来关闭<span>Derby</span>系统：</p>
<pre>DriverManager.getConnection("jdbc:derby:;shutdown=true");</pre>
<p>关闭命令始终会引发<em>SQLExceptions</em> 。</p>
<p>当<span>Derby</span>系统关闭时，一条消息将发送到日志文件：</p>

<pre>----------------------------------------------------------------
Thu Sep 13 09:53:21 EDT 2012: Shutting down Derby engine
----------------------------------------------------------------
Thu Sep 13 09:53:21 EDT 2012:
Shutting down instance a816c00e-0139-bfe6-bff8-000000a155b8 on 
database directory C:\sampledb with class loader 
sun.misc.Launcher$AppClassLoader@9931f5 
----------------------------------------------------------------</pre>

<p>如果使用安全管理器运行，则必须授予<span>Derby</span>权限才能注销嵌入式驱动程序，以便完全关闭系统。有关详细信息，请参见《 <span><em>Derby安全指南</em></span> 》中的“配置Java安全性”。</p>

<p>通常，使用嵌入式<span>Derby</span>引擎的应用程序会在关闭自身之前关闭<span>Derby</span> 。但是，应用程序可以关闭<span>Derby</span> ，然后在同一JVM会话中重新启动它。要成功重新启动<span>Derby</span> ，应用程序需要重新加载<em>org.apache.derby.jdbc。EmbeddedDriver</em>显式如下：</p>

<pre>Class.forName("org.apache.derby.jdbc.EmbeddedDriver").newInstance();</pre>

<p>这是一个例外，即在启动<span>Derby</span>时无需显式加载驱动程序。</p>

<p>JDBC规范不建议调用<samp class="codeph">newInstance()</samp> ，但添加一个<samp class="codeph">newInstance()</samp>调用保证<span>Derby</span>将在任何JVM上启动。</p>

<div class="note"><span class="notetitle">注意：</span>如果您的应用程序需要重新启动<span>Derby</span> ，则可以将属性<em>deregister = false</em>添加到连接URL以避免重新加载嵌入式驱动程序：<pre>DriverManager.getConnection("jdbc:derby:;shutdown=true;deregister=false");</pre>

</div>

<p>也可以关闭单个数据库而不是整个<span>Derby</span>系统。请参阅<a href="tdevdvlp40464.html#tdevdvlp40464">关闭Derby或单个数据库</a> 。关闭数据库后，可以在同一<span>Derby</span>会话中重新启动数据库。</p>
</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="cdevdvlp27610.html" title="系统中存在一个Derby数据库。">Derby系统</a></div>
</div>
<div class="relconcepts"><strong>相关概念</strong><br>
<div><a href="cdevdvlp27715.html" title="Derby的默认配置是在应用程序首次建立连接时启动（或启动）数据库。Derby引导数据库时，它会检查是否需要在数据库上运行恢复，因此在某些不常见的情况下，引导可能会花费一些时间。">引导数据库</a></div>
</div>
</div>



</body></html>