<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="The MIN() and MAX() optimizations">
<meta name="abstract" content="The optimizer knows that it can avoid iterating through all the source rows in a result to compute a MIN() or MAX() aggregate when data are already in the right order.">
<meta name="description" content="The optimizer knows that it can avoid iterating through all the source rows in a result to compute a MIN() or MAX() aggregate when data are already in the right order.">
<meta name="DC.subject" content="MIN() optimization, MAX() optimization">
<meta name="keywords" content="MIN() optimization, MAX() optimization">
<meta name="DC.Relation" scheme="URI" content="ctunoptimz860097.html">
<meta name="DC.Relation" scheme="URI" content="ctunoptimz22460.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="ctunoptimz22111">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>MIN（）和MAX（）优化</title>
</head>
<body id="ctunoptimz22111" ><a name="ctunoptimz22111"><!-- --></a>


<h1 class="topictitle1">MIN（）和MAX（）优化</h1>



<div><p>优化器知道，当数据已经按正确顺序排列时，它可以避免遍历结果中的所有源行来计算MIN（）或MAX（）聚合。</p>

<p>当保证数据顺序正确时， <span>Derby</span>可以立即转到最小（最小）或最大（最大）行。</p>

<p>必须满足以下条件：</p>

<ul>
<li>MIN（）或MAX（）是SELECT列表中的唯一条目。</li>

<li>MIN（）或MAX（）在简单的列引用上，而不在表达式上。</li>

<li>对于MAX（），必须没有WHERE子句。</li>

<li>对于MIN（）：<ul>
<li>引用的表是优化器为查询块选择的连接顺序中最外面的表。</li>

<li>优化器选择了一个包含所引用列的索引作为访问路径。</li>

<li>被引用的列是该索引中的第一个键列，或者被引用的列是该索引中的键列，并且相等谓词存在于该索引中的简单列引用之前的所有键列上。</li>

</ul>
</li>

</ul>

<p>例如，优化器可以将此优化用于以下查询（如果优化器使用适当的索引作为访问路径）：</p>

<pre><strong><span>-- index on orig_airport</span>
SELECT MIN(orig_airport)
FROM Flights
<span>-- index on orig_airport</span>
SELECT MAX(orig_airport)
FROM Flights
<span>-- index on orig_airport</span>
SELECT miles 
FROM Flights 
WHERE orig_airport = (SELECT MIN(orig_airport)
FROM Flights)
<span>-- index on segment_number, flight_id</span>
SELECT MIN(segment_number) 
FROM Flights 
WHERE flight_id = 'AA1111' 
SELECT * 
FROM Flights 
WHERE segment_number = (SELECT MIN(segment_number) 
FROM Flights 
WHERE flight_id = 'AA1111')</strong></pre>

<p>选择查询计划后，优化器将决定是否实施优化。在计入计划成本时，优化器不会考虑此优化。</p>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="ctunoptimz860097.html" title="优化器进行一些非基于成本的优化，这意味着在确定访问路径和连接顺序时不会考虑它们。">非基于成本的优化</a></div>
</div>
<div class="relconcepts"><strong>相关概念</strong><br>
<div><a href="ctunoptimz22460.html" title="在大多数情况下，Derby需要对使用DISTINCT或GROUP BY的语句执行两个单独的步骤：首先对选定的列进行排序，然后丢弃重复的行或聚合分组的行。有时，它可以避免使用元组过滤对这些语句进行排序。">非基于成本的排序避免（元组过滤）</a></div>
</div>
</div>



</body></html>