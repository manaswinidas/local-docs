<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Join order case study">
<meta name="abstract" content="As an example of how the optimizer chooses a join order, consider the following situation.">
<meta name="description" content="As an example of how the optimizer chooses a join order, consider the following situation.">
<meta name="DC.Relation" scheme="URI" content="ctunoptimz20327.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="ctunoptimz32767">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>加入订单案例研究</title>
</head>
<body id="ctunoptimz32767" ><a name="ctunoptimz32767"><!-- --></a>


<h1 class="topictitle1">加入订单案例研究</h1>



<div><p>作为优化程序如何选择连接顺序的示例，请考虑以下情况。</p>

<p>的<samp class="codeph">Flights</samp>表格（如您所知）存储有关航班分段的信息。它在<samp class="codeph">flight_id</samp>和<samp class="codeph">segment_number</samp>列。该主键约束由这些列上的唯一索引备份。</p>

<p>的<samp class="codeph">FlightAvailability</samp>该表可存储有关特定日期航班段可用性的信息，该表可以在<samp class="codeph">Flights</samp>表（每个日期一个）。</p>

<p>您想查看有关所有航班的信息，然后发出以下查询：</p>

<pre><strong>SELECT *
FROM FlightAvailability AS fa, Flights AS fts
WHERE fa.flight_id = fts.flight_id
AND fa.segment_number = fts.segment_number</strong></pre>

<p>首先想象一下在这种情况下没有有用的索引的情况。 <samp class="codeph">FlightAvailability</samp>表。</p>

<p>使用连接顺序<samp class="codeph">FlightAvailability</samp>作为外表， <samp class="codeph">Flights</samp>因为内表更便宜，因为它允许<samp class="codeph">flight_id</samp> / <samp class="codeph">segment_number</samp>来自的列<samp class="codeph">FlightAvailability</samp>用于探查并找到匹配的行<samp class="codeph">Flights</samp> ，在上使用主键索引<samp class="codeph">Flights.flight_id</samp>和<samp class="codeph">Flights.segment_number</samp> 。</p>

<p>这比相反的连接顺序（带有<samp class="codeph">Flights</samp>作为外表， <samp class="codeph">FlightAvailability</samp>作为内部表），因为在这种情况下，对于<samp class="codeph">Flights</samp> ，系统将必须扫描整个<samp class="codeph">FlightAvailability</samp>表中查找匹配的行（因为没有有用的索引-索引<samp class="codeph">flight_id</samp> / <samp class="codeph">segment_number</samp>列）。</p>

<p>其次，想象一下在这种情况下<samp class="codeph">FlightAvailability</samp>表（实际上是示例数据库中的情况）。 <samp class="codeph">FlightAvailability</samp>上有一个主键索引<samp class="codeph">flight_id</samp> ， <samp class="codeph">segment_number</samp>和<samp class="codeph">booking_date</samp> 。在该索引中， <samp class="codeph">flight_id</samp> / <samp class="codeph">segment_number</samp>组合不是唯一的，因为两者之间存在一对多的对应关系<samp class="codeph">Flights</samp>表和<samp class="codeph">FlightAvailability</samp>表。但是，索引对于查找具有特定行的行仍然非常有用<samp class="codeph">flight_id</samp> / <samp class="codeph">segment_number</samp>价值观。</p>

<p>您发出相同的查询：</p>

<pre><strong>SELECT *
FROM FlightAvailability AS fa, Flights AS fts
WHERE fa.flight_id = fts.flight_id
AND fa.segment_number = fts.segment_number</strong></pre>

<p>尽管成本差异较小，但对于<samp class="codeph">Flights</samp> table是内部表，因为它的索引是唯一的，而<samp class="codeph">FlightAvailability</samp>的索引不是。这是因为对于<span>Derby而言</span> ，通过唯一索引比通过非唯一索引便宜。</p>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="ctunoptimz20327.html" title="优化器为每个表选择最佳的连接顺序以及最佳的索引。">关于优化器的连接顺序选择</a></div>
</div>
</div>



</body></html>