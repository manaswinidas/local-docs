<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Combining ORDER BY and UNION">
<meta name="abstract" content="Without a transformation, a statement that contains both ORDER BY and UNION would require two separate sorting steps-one to satisfy ORDER BY and one to satisfy UNION.">
<meta name="description" content="Without a transformation, a statement that contains both ORDER BY and UNION would require two separate sorting steps-one to satisfy ORDER BY and one to satisfy UNION.">
<meta name="DC.subject" content="UNION, avoiding ordering during">
<meta name="keywords" content="UNION, avoiding ordering during">
<meta name="DC.Relation" scheme="URI" content="ctuntransform16033.html">
<meta name="DC.Relation" scheme="URI" content="ctuntransform16279.html">
<meta name="DC.Relation" scheme="URI" content="ctuntransform21780.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="ctuntransform14044">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>结合ORDER BY和UNION</title>
</head>
<body id="ctuntransform14044" ><a name="ctuntransform14044"><!-- --></a>


<h1 class="topictitle1">结合ORDER BY和UNION</h1>



<div><p>如果不进行转换，则同时包含ORDER BY和UNION的语句将需要两个单独的排序步骤-一个满足ORDER BY，一个满足UNION。</p>

<p>当前， <span>Derby</span>使用排序来消除UNION中的重复项。您可以使用UNION ALL避免排序，但是UNION ALL将返回重复项。因此，如果您知道表中没有重复的行，则仅使用UNION ALL避免排序。</p>

<p>在某些情况下， <span>Derby</span>可以在内部将语句转换为仅包含这些关键字之一的语句（抛出ORDER BY）。要求如下：</p>

<ul>
<li>ORDER BY列表中的列必须是并集左侧选择列表中的列的子集。</li>

<li>ORDER BY列表中的所有列必须按升序排序，并且它们必须是UNION左侧目标列表中列的有序前缀。</li>

</ul>

<p><span>Derby</span>将能够转换以下语句：</p>

<pre><strong>SELECT miles, meal
FROM Flights
UNION VALUES (1000, 'D')
ORDER BY 1</strong></pre>

<p>由于ORDER BY子句中列的顺序， <span>Derby</span>无法避免以下语句中的两个排序节点：</p>

<pre><strong>SELECT flight_id, segment_number FROM Flights
UNION
SELECT flight_id, segment_number FROM FlightAvailability
ORDER BY segment_number , flight_id</strong></pre>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="ctuntransform16033.html" title="排序是一个昂贵的过程。Derby尝试在可能的情况下消除不必要的排序步骤。">避免排序</a></div>
</div>
<div class="relconcepts"><strong>相关概念</strong><br>
<div><a href="ctuntransform16279.html" title="如果存在唯一性条件（可确保不返回任何重复值），则可以从查询中消除DISTINCT（和相应的排序）。">基于唯一性条件的DISTINCT消除</a></div>
<div><a href="ctuntransform21780.html" title="如果不进行转换，则同时包含DISTINCT和ORDER BY的语句将需要两个单独的排序步骤-一个满足DISTINCT，一个满足ORDER BY。 （当前，Derby使用排序来评估DISTINCT。从理论上讲，还有其他方法可以完成此操作。）">结合ORDER BY和DISTINCT</a></div>
</div>
</div>



</body></html>