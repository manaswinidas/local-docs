<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="IN/ANY subquery transformation">
<meta name="abstract" content="An IN or ANY subquery that is guaranteed to return at most one row can be transformed into an equivalent expression subquery (a scalar subquery without the IN or ANY). The subquery must not be correlated.">
<meta name="description" content="An IN or ANY subquery that is guaranteed to return at most one row can be transformed into an equivalent expression subquery (a scalar subquery without the IN or ANY). The subquery must not be correlated.">
<meta name="DC.subject" content="IN/ANY subquery transformation">
<meta name="keywords" content="IN/ANY subquery transformation">
<meta name="DC.Relation" scheme="URI" content="ctuntransform13699.html">
<meta name="DC.Relation" scheme="URI" content="ctuntransform25857.html">
<meta name="DC.Relation" scheme="URI" content="ctuntransform36368.html">
<meta name="DC.Relation" scheme="URI" content="ctuntransform25868.html">
<meta name="DC.Relation" scheme="URI" content="ctuntransform47182.html">
<meta name="DC.Relation" scheme="URI" content="ctuntransform867165.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="ctuntransform867201">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>IN / ANY子查询转换</title>
</head>
<body id="ctuntransform867201" ><a name="ctuntransform867201"><!-- --></a>


<h1 class="topictitle1">IN / ANY子查询转换</h1>



<div><p>可以保证最多返回一行的IN或ANY子查询可以转换为等效表达式子查询（不带IN或ANY的标量子查询）。子查询必须不相关。</p>

<p>保证最多返回一行的子查询是：</p>

<ul>
<li>简单的VALUES子句</li>

<li>SELECT返回非分组聚合</li>

</ul>

<p>例如，</p>

<pre><strong>WHERE C1 IN (SELECT MIN(c1) FROM T)</strong></pre>

<p>可以转化为</p>

<pre><strong>WHERE C1 = (SELECT MIN(c1) FROM T)</strong></pre>

<p>在子查询实现之前考虑此转换。如果执行了转换，则子查询变为可实现的。在该示例中，如果未转换IN子查询，则将为每行重新评估它。</p>

<p>下表显示了子查询类型的转换。</p>
  

<div class="tablenoborder"><table cellspacing="0" cellpadding="4" border="1" summary="This table shows how IN and ANY subqueries are transformed." frame="border" rules="all"><caption>表格1。返回单行的子查询的IN或ANY子查询转换</caption>


<thead align="left">
<tr valign="bottom">
<th valign="bottom" width="50%" id="N100B0">转型前</th>

<th valign="bottom" width="50%" id="N100B7">改造后</th>
</tr>

</thead>

<tbody>
<tr>
<td valign="top" width="50%" headers="N100B0"><strong><samp class="codeph">c1 IN (SELECT ...)</samp></strong></td>

<td valign="top" width="50%" headers="N100B7"><strong><samp class="codeph">c1 = (SELECT ...)</samp></strong></td>
</tr>

<tr>
<td valign="top" width="50%" headers="N100B0"><strong><samp class="codeph">c1 = ANY (SELECT ...)</samp></strong></td>

<td valign="top" width="50%" headers="N100B7"><strong><samp class="codeph">c1 = (SELECT ...)</samp></strong></td>
</tr>

<tr>
<td valign="top" width="50%" headers="N100B0"><strong><samp class="codeph">c1 <> ANY (SELECT ...)</samp></strong></td>

<td valign="top" width="50%" headers="N100B7"><strong><samp class="codeph">c1 <> (SELECT ...)</samp></strong></td>
</tr>

<tr>
<td valign="top" width="50%" headers="N100B0"><strong><samp class="codeph">c1 > ANY (SELECT ...)</samp></strong></td>

<td valign="top" width="50%" headers="N100B7"><strong><samp class="codeph">c1 > (SELECT ...)</samp></strong></td>
</tr>

<tr>
<td valign="top" width="50%" headers="N100B0"><strong><samp class="codeph">c1 >= ANY (SELECT ...)</samp></strong></td>

<td valign="top" width="50%" headers="N100B7"><strong><samp class="codeph">c1 >= (SELECT ...)</samp></strong></td>
</tr>

<tr>
<td valign="top" width="50%" headers="N100B0"><strong><samp class="codeph">c1 < ANY (SELECT ...)</samp></strong></td>

<td valign="top" width="50%" headers="N100B7"><strong><samp class="codeph">c1 < (SELECT ...)</samp></strong></td>
</tr>

<tr>
<td valign="top" width="50%" headers="N100B0"><strong><samp class="codeph">c1 <= ANY (SELECT ...)</samp></strong></td>

<td valign="top" width="50%" headers="N100B7"><strong><samp class="codeph">c1 <= (SELECT ...)</samp></strong></td>
</tr>

</tbody>

</table>
</div>

</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="ctuntransform13699.html" title="众所周知，子查询的评估成本很高。本节描述了Derby内部进行的一些转换，以减少评估它们的成本。">子查询处理和转换</a></div>
</div>
<div class="relconcepts"><strong>相关概念</strong><br>
<div><a href="ctuntransform25857.html" title="实现意味着子查询仅评估一次。可以实现几种类型的子查询。">物化</a></div>
<div><a href="ctuntransform36368.html" title="与IN，EXISTS和ANY一起使用时，允许子查询返回多行。但是，对于外部行中返回的每一行，Derby都会评估子查询，直到它返回一行；它不会评估返回的所有行的子查询。">将子查询展平为普通联接</a></div>
<div><a href="ctuntransform25868.html" title="EXISTS联接是其中联接的右侧仅需要为每个外部行探测一次的联接。">将子查询展平为EXISTS联接</a></div>
<div><a href="ctuntransform47182.html" title="Derby展平VALUES子查询以提高性能。">展平VALUES子查询</a></div>
<div><a href="ctuntransform867165.html" title="如果至少有一行导致子查询的结果为true，则IN，ANY或EXISTS子查询的结果为true。这些语义使得在IN，ANY或EXISTS子查询中不需要DISTINCT。">在IN，ANY和EXISTS子查询中进行DISTINCT消除</a></div>
</div>
</div>



</body></html>