<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="reference">
<meta name="DC.Title" content="Execute command">
<meta name="abstract" content="The Execute command executes an SQL statement or a named prepared statement.">
<meta name="description" content="The Execute command executes an SQL statement or a named prepared statement.">
<meta name="DC.subject" content="Execute command, Prepared statements, executing">
<meta name="keywords" content="Execute command, Prepared statements, executing">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref25570.html">
<meta name="DC.Relation" scheme="URI" content="ctoolsijcomref23268.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref94092.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref11943.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref37862.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref25753.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref79286.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref24423.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref31510.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref22318.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomrefdescribe.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref20382.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref39042.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref18077.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref33358.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref61708.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref36618.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref62772.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref10316.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomrefhold.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref53869.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref88554.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref12281.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref11128.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomrefnohold.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref12333.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref44032.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref27997.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref61092.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref97975.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref33373.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref12297.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref28886.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref39198.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomrefshow.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref17631.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref16653.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref40155.html">
<meta name="DC.Relation" scheme="URI" content="rtoolsijcomref34110.html">
<meta name="DC.Relation" scheme="URI" content="ctoolsijcomref18998.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="rtoolsijcomref30679">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>执行命令</title>
</head>
<body id="rtoolsijcomref30679" ><a name="rtoolsijcomref30679"><!-- --></a>


<h1 class="topictitle1">执行命令</h1>



<div><p>的<samp class="codeph">Execute</samp>命令执行一个SQL语句或一个命名的Prepared语句。</p>

<div class="section"><h2 class="sectiontitle">句法</h2>
<pre><strong>EXECUTE { <em>SQLString</em> | <em><a href="rtoolsijcomref40155.html">PreparedStatementIdentifier</a></em> }
[ USING { <em><a href="rtoolsijcomref34110.html">String</a></em> | <em><a href="rtoolsijcomref40155.html">Identifier</a></em> } ]</strong></pre>

<p>的<samp class="codeph">Execute</samp>该命令可以通过以下两种方式之一使用：</p>

<ul>
<li>执行以<em>SQLString</em>输入的SQL语句。将<em>SQLString</em>传递给连接，而无需进行进一步检查或处理<samp class="codeph">ij</samp> 。
<div class="p"><div class="note"><span class="notetitle">注意：</span>通常，您直接执行SQL语句，而不用<samp class="codeph">Execute</samp>命令。</div>
</div>
</li>

<li>执行<em>PreparedStatementIdentifier</em>标识的命名语句。该命令必须事先准备好<samp class="codeph">ij</samp>的<samp class="codeph"><a href="rtoolsijcomref12333.html">Prepare</a></samp>命令。</li>

</ul>

<p>要在该语句包含动态参数时执行任意一种语句，请在<samp class="codeph">Using</samp>命令的一部分。以这种样式，将使用<em>String</em>或<em>Identifier</em>提供的值执行<em>SQLString</em>或先前准备的<em>PreparedStatementIdentifier</em> 。中的<em>标识符</em> <samp class="codeph">Using</samp>子句必须将结果集作为其结果。结果集的每一行都将应用于要执行的语句的输入参数，因此， <samp class="codeph">Using</samp>子句的结果集必须与<samp class="codeph">Execute</samp>命令的SQL语句。每次执行的结果<samp class="codeph">Execute</samp>命令的SQL语句在生成时显示。如果<samp class="codeph">Using</samp>子句的结果集不包含任何行， <samp class="codeph">Execute</samp>命令的SQL语句未执行。</p>

<p>开启自动提交模式后， <samp class="codeph">Using</samp>子句的结果集在第一次执行时关闭<samp class="codeph">Execute</samp>命令的SQL语句。为了确保多行执行<samp class="codeph">Execute</samp>命令，使用<samp class="codeph"><a href="rtoolsijcomref25753.html">Autocommit</a></samp>关闭自动提交的命令。</p>

</div>

<div class="example"><h2 class="sectiontitle">例子</h2>
<pre>ij&gt;<strong> autocommit off;</strong>
ij&gt; <strong>prepare menuInsert as 'INSERT INTO menu VALUES (?, ?, ?)';</strong>
ij&gt;<strong> execute menuInsert using 'VALUES
    (''entree'', ''lamb chop'', 14),
    (''dessert'', ''creme brulee'', 6)';</strong>
1 row inserted/updated/deleted
1 row inserted/updated/deleted
ij&gt; <strong>commit;</strong> </pre>
 
<pre>ij&gt; <strong>connect 'jdbc:derby:firstdb;create=true';</strong>
ij&gt; <strong>create table firsttable (id int primary key,
    name varchar(12));</strong>
0 rows inserted/updated/deleted
ij&gt; <strong>insert into firsttable values 
    (10,'TEN'),(20,'TWENTY'),(30,'THIRTY');</strong>
3 rows inserted/updated/deleted
ij&gt; <strong>select * from firsttable;</strong>
ID         |NAME        
------------------------
10         |TEN         
20         |TWENTY      
30         |THIRTY      

3 rows selected
ij&gt; <strong>connect 'jdbc:derby:seconddb;create=true';</strong>
ij(CONNECTION1)&gt; <strong>create table newtable (newid int primary key, 
    newname varchar(12));</strong>
0 rows inserted/updated/deleted
ij(CONNECTION1)&gt; <strong>prepare src@connection0 as 'select * from firsttable';</strong>
ij(CONNECTION1)&gt; <strong>autocommit off;</strong>
ij(CONNECTION1)&gt; <strong>execute 'insert into newtable(newid, newname) 
    values(?,?)' using src@connection0;</strong>
1 row inserted/updated/deleted
1 row inserted/updated/deleted
1 row inserted/updated/deleted
ij(CONNECTION1)&gt; <strong>commit;</strong>
ij(CONNECTION1)&gt; <strong>select * from newtable;</strong>
NEWID      |NEWNAME     
------------------------
10         |TEN         
20         |TWENTY      
30         |THIRTY      

3 rows selected
ij(CONNECTION1)&gt; <strong>show connections;</strong>
CONNECTION0 -   jdbc:derby:firstdb
CONNECTION1* -  jdbc:derby:seconddb
ij(CONNECTION1)&gt; <strong>disconnect connection0;</strong>
ij&gt; </pre>

</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="rtoolsijcomref25570.html" title="本节介绍ij工具中的命令和错误。">ij命令和错误参考</a></div>
</div>
<div class="relconcepts"><strong>相关概念</strong><br>
<div><a href="ctoolsijcomref23268.html" title="ij接受几个命令来控制其对JDBC的使用。">ij命令</a></div>
<div><a href="ctoolsijcomref18998.html" title="ij可能会发出消息，以在处理语句期间通知用户错误。">ij错误</a></div>
</div>
<div class="relref"><strong>相关参考</strong><br>
<div><a href="rtoolsijcomref94092.html" title="Absolute命令将光标移动到int参数指定的行，然后获取该行。">绝对命令</a></div>
<div><a href="rtoolsijcomref11943.html" title="“最后一个之后”命令将光标移动到最后一行之后，然后获取该行。">在最后一条命令之后</a></div>
<div><a href="rtoolsijcomref37862.html" title="Async命令使您可以在单独的线程中执行SQL语句。">异步命令</a></div>
<div><a href="rtoolsijcomref25753.html" title="自动提交命令可以打开或关闭连接的自动提交模式。">自动提交命令</a></div>
<div><a href="rtoolsijcomref79286.html" title="“先入先出”命令将光标移动到第一行之前，然后获取该行。">在第一个命令之前</a></div>
<div><a href="rtoolsijcomref24423.html" title="“关闭”命令关闭命名的游标。">关闭命令</a></div>
<div><a href="rtoolsijcomref31510.html" title="提交命令发出一个java.sql。Connection.commit请求。">提交命令</a></div>
<div><a href="rtoolsijcomref22318.html" title="Connect命令连接到由ConnectionURLString参数指示的数据库。">连接命令</a></div>
<div><a href="rtoolsijcomrefdescribe.html" title="Describe命令提供对指定表或视图的解密。">描述命令</a></div>
<div><a href="rtoolsijcomref20382.html" title="“断开连接”命令从数据库断开连接。">断开命令</a></div>
<div><a href="rtoolsijcomref39042.html" title="Driver命令采用DriverNameString参数的值，并发出Class.forName请求以加载命名的类。">驱动命令</a></div>
<div><a href="rtoolsijcomref18077.html" title="如果将Elapsedtime命令设置为ON，则显示语句执行期间经过的总时间。">经过时间命令</a></div>
<div><a href="rtoolsijcomref33358.html" title="Exit命令使ij应用程序完成并停止处理。">退出指令</a></div>
<div><a href="rtoolsijcomref61708.html" title="First命令将光标移动到ResultSet中的第一行，然后获取该行。">第一条命令</a></div>
<div><a href="rtoolsijcomref36618.html" title="Get Cursor命令通过发出java.sql创建具有指定标识符名称的游标。对指定String的值的Statement.executeQuery请求。">获取光标命令</a></div>
<div><a href="rtoolsijcomref62772.html" title="“获取滚动不敏感游标”命令将使用指定标识符的名称创建可滚动不敏感游标。">获取滚动不敏感光标命令</a></div>
<div><a href="rtoolsijcomref10316.html" title="帮助命令将打印出ij命令的简短列表。">帮助命令</a></div>
<div><a href="rtoolsijcomrefhold.html" title="HoldForConnection命令将连接的默认可保留性设置为默认ResultSet。HOLD_CURSORS_OVER_COMMIT。">HoldForConnection命令</a></div>
<div><a href="rtoolsijcomref53869.html" title="Last命令将光标移动到ResultSet中的最后一行，然后获取该行。">最后命令</a></div>
<div><a href="rtoolsijcomref88554.html" title="LocalizedDisplay命令指定ij应该以ij语言环境的本机格式显示对语言环境敏感的数据（例如日期）。">LocalizedDisplay命令</a></div>
<div><a href="rtoolsijcomref12281.html" title="MaximumDisplayWidth命令将列的最大显示宽度设置为指定值。">MaximumDisplayWidth命令</a></div>
<div><a href="rtoolsijcomref11128.html" title="Next命令从指定的命名游标中获取下一行。">下一条命令</a></div>
<div><a href="rtoolsijcomrefnohold.html" title="NoHoldForConnection命令更改ResultSet中连接的默认可保留性。HOLD_CURSORS_OVER_COMMIT到ResultSet。CLOSE_CURSORS_AT_COMMIT。">NoHoldForConnection命令</a></div>
<div><a href="rtoolsijcomref12333.html" title="Prepare命令创建一个java.sql。使用指定字符串的值的PreparedStatement，可通过为其指定的标识符在ij中访问。">准备命令</a></div>
<div><a href="rtoolsijcomref44032.html" title="Previous命令将光标移动到当前光标之前的行，然后获取该行。">上一条命令</a></div>
<div><a href="rtoolsijcomref27997.html" title="Protocol命令指定用于建立连接的协议，并自动加载适当的驱动程序。">协议命令</a></div>
<div><a href="rtoolsijcomref61092.html" title="Readonly命令将当前连接设置为" read-onl="=" ="">只读命令</a></div>
<div><a href="rtoolsijcomref97975.html" title="相对命令将光标移动到相对于当前行为指定行数的行，然后获取该行。">相对命令</a></div>
<div><a href="rtoolsijcomref33373.html" title="Remove命令从ij中删除先前准备的语句。">删除命令</a></div>
<div><a href="rtoolsijcomref12297.html" title="Rollback命令发出一个java.sql。Connection.rollback请求。">回滚命令</a></div>
<div><a href="rtoolsijcomref28886.html" title="“运行”命令将ij处理重定向为从指定文件读取。">运行命令</a></div>
<div><a href="rtoolsijcomref39198.html" title="“设置连接”命令指定当打开多个连接时要使哪个连接成为当前连接。">设置连接命令</a></div>
<div><a href="rtoolsijcomrefshow.html" title="Show命令显示有关活动连接和数据库对象的信息。">显示命令</a></div>
<div><a href="rtoolsijcomref17631.html" title="Wait For命令显示先前启动的异步命令的结果。">等待命令</a></div>
<div><a href="rtoolsijcomref16653.html" title="ij在命令中接受两种形式的注释。">ij命令中注释的语法</a></div>
<div><a href="rtoolsijcomref40155.html" title="一些ij命令需要标识符参数。">ij命令中标识符的语法</a></div>
<div><a href="rtoolsijcomref34110.html" title="一些ij命令需要字符串参数。">ij命令中字符串的语法</a></div>
</div>
</div>



</body></html>