<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="reference">
<meta name="DC.Title" content="DECLARE GLOBAL TEMPORARY TABLE statement">
<meta name="abstract" content="The DECLARE GLOBAL TEMPORARY TABLE statement defines a temporary table for the current connection.">
<meta name="description" content="The DECLARE GLOBAL TEMPORARY TABLE statement defines a temporary table for the current connection.">
<meta name="DC.subject" content="DECLARE GLOBAL TEMPORARY TABLE statement, tables, temporary, DECLARE GLOBAL TEMPORARY TABLE, SQL statements">
<meta name="keywords" content="DECLARE GLOBAL TEMPORARY TABLE statement, tables, temporary, DECLARE GLOBAL TEMPORARY TABLE, SQL statements">
<meta name="DC.Relation" scheme="URI" content="crefsqlj39374.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="rrefdeclaretemptable">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>DECLARE GLOBAL TEMPORARY TABLE语句</title>
</head>
<body id="rrefdeclaretemptable" ><a name="rrefdeclaretemptable"><!-- --></a>


<h1 class="topictitle1">DECLARE GLOBAL TEMPORARY TABLE语句</h1>



<div><p>DECLARE GLOBAL TEMPORARY TABLE语句为当前连接定义一个临时表。</p>

<div class="section">
<p>临时表不驻留在系统目录中，也不持久。临时表仅在声明它们的连接期间存在，并且不能在该连接之外引用。连接关闭时，将删除表的行，并删除临时表的内存中描述。</p>
</div>

<div class="section"><div class="p">在以下情况下，临时表很有用：<ul>
<li>在使用应用程序之前，表结构是未知的。</li>

<li>其他用户不需要相同的表结构。</li>

<li>使用该应用程序时需要临时表中的数据。</li>

<li>可以声明该表并将其删除，而无需保留系统目录上的锁。</li>

</ul>
</div>
</div>

<div class="section"><h2 class="sectiontitle">句法</h2> <pre><strong>DECLARE GLOBAL TEMPORARY TABLE <em><a href="rrefdeclaretemptable.html#rrefdeclaretemptable__tempcoltablename">tempTableName</a></em>
    { <em><a href="rrefdeclaretemptable.html#rrefdeclaretemptable__tempcolcolumndef">columnDefinition</a></em> [ , <em><a href="rrefdeclaretemptable.html#rrefdeclaretemptable__tempcolcolumndef">columnDefinition</a></em> ]* }
[ ON COMMIT { DELETE | PRESERVE } ROWS ]  
NOT LOGGED [ ON ROLLBACK DELETE ROWS ]
 </strong></pre>
</div>

<div class="section" id="rrefdeclaretemptable__tempcoltablename"><a name="rrefdeclaretemptable__tempcoltablename"><!-- --></a><h2 class="sectiontitle">tempTableName</h2><p>命名临时表。如果指定了SESSION以外的<em><a href="rrefschemaname.html#rrefschemaname">schemaName</a></em> ，将发生错误（SQLSTATE 428EK）。如果未指定<em>schemaName</em> ，则分配SESSION。多个连接可以使用相同的名称定义已声明的全局临时表，因为每个连接都有自己的唯一表描述符。</p>
<p>使用SESSION作为物理表的架构名称不会引起错误，但是不建议使用。SESSION模式名称应为临时表模式保留。</p>
</div>

<div class="section" id="rrefdeclaretemptable__tempcolcolumndef"><a name="rrefdeclaretemptable__tempcolcolumndef"><!-- --></a><h2 class="sectiontitle">columnDefinition</h2><p>有关<em><a href="rrefsqlj30540.html#rrefsqlj30540">columnDefinition</a></em>的更多信息，请参见CREATE TABLE的<em>columnDefinition</em> 。DECLARE GLOBAL TEMPORARY TABLE不允许<em>columnDefinition中的</em> <em>generateColumnSpec</em> 。</p>

</div>

<div class="section" id="rrefdeclaretemptable__rreftemptabledatatype"><a name="rrefdeclaretemptable__rreftemptabledatatype"><!-- --></a><h2 class="sectiontitle">数据类型</h2><div class="p">支持的数据类型是：<ul>
<li>比金特</li>

<li>焦炭</li>

<li>日期</li>

<li>十进制</li>

<li>双</li>

<li>双精度</li>

<li>浮动</li>

<li>整数</li>

<li>数字</li>

<li>真实</li>

<li>SMALLINT</li>

<li>时间</li>

<li>时间戳</li>

<li>VARCHAR</li>

</ul>
</div>
</div>

<div class="section" id="rrefdeclaretemptable__rreftemptableoncommit"><a name="rrefdeclaretemptable__rreftemptableoncommit"><!-- --></a><h2 class="sectiontitle">提交时</h2><p>指定执行COMMIT操作时对全局临时表执行的操作。</p>
</div>

<div class="section"><h2 class="sectiontitle">删除行</h2><p>如果在表上没有打开可保持游标，则将删除表的所有行。这是ON COMMIT的默认值。如果指定ON ROLLBACK DELETE ROWS，则仅在使用临时表的情况下，这将删除表中的所有行。即使未使用表（如果表上没有打开可保持的游标），ON COMMIT DELETE ROWS也会删除表中的行。</p>
</div>

<div class="section"><h2 class="sectiontitle">保留行</h2><p>表中的行将被保留。</p>
</div>

<div class="section" id="rrefdeclaretemptable__rreftemptablenotlogged"><a name="rrefdeclaretemptable__rreftemptablenotlogged"><!-- --></a><h2 class="sectiontitle">未记录</h2><p>指定执行回滚操作时对全局临时表执行的操作。执行ROLLBACK（或ROLLBACK TO SAVEPOINT）操作时，如果以工作单位（或保存点）创建表，则该表将被删除。如果该表以工作单位（或保存点）删除，则该表将恢复为无行。</p>
</div>

<div class="section"><h2 class="sectiontitle">回滚删除行</h2> <p>这是“未记录”的默认值。 NOT LOGGED [ON ROLLBACK DELETE ROWS]]指定在执行ROLLBACK或（ROLLBACK TO SAVEPOINT）操作时要对全局临时表执行的操作。如果表数据已更改，则所有行都将被删除。</p>
</div>

<div class="section"><h2 class="sectiontitle">例子</h2><pre><strong>set schema myapp;

create table t1(c11 int, c12 date);

declare global temporary table SESSION.t1(c11 int) not logged;</strong>
-- The SESSION qualification is redundant here because temporary 
-- tables can only exist in the SESSION schema. 

<strong>declare global temporary table t2(c21 int) not logged;</strong> 
-- The temporary table is not qualified here with SESSION because temporary 
-- tables can only exist in the SESSION schema.

<strong>insert into SESSION.t1 values (1); </strong>
-- SESSION qualification is mandatory here if you want to use 
-- the temporary table, because the current schema is "myapp."

<strong>select * from t1;</strong> 
-- This select statement is referencing the "myapp.t1" physical 
-- table since the table was not qualified by SESSION.

</pre>
 <div class="note"><span class="notetitle">注意：</span>临时表只能在SESSION模式中声明。您永远不要使用SESSION名称声明物理模式。</div>
<div class="p">以下是<span>Derby</span>不支持的DB2 UDB DECLARE GLOBAL TEMPORARY TABLE函数的列表：<ul>
<li>IDENTITY列选项</li>

<li>复制选项中的IDENTITY属性</li>

<li>仅作为（全选）定义</li>

<li>未记录在回滚保留行上</li>

<li>IN表空间名称</li>

<li>分区键</li>

<li>更换</li>

</ul>
 </div>
</div>

<div class="section"><h2 class="sectiontitle">对已声明的全局临时表的限制</h2> <p><span>Derby</span>在临时表上不支持以下功能。这些功能中的某些特定于临时表，而某些特定于<span>Derby</span> 。</p>
<div class="p">在以下语句中不能指定临时表：<ul>
<li>更改表</li>

<li>创建索引</li>

<li>创建同步</li>

<li>创建触发器</li>

<li>创建视图</li>

<li>格兰特</li>

<li>锁桌</li>

<li>改名</li>

<li>撤消</li>

</ul>
</div>
<p>您不能对临时表使用以下功能：</p>
<ul>
<li>SESSION模式表（包括物理表和临时表）上的同义词，触发器和视图</li>

<li>引用SESSION模式表和视图的缓存语句</li>

<li>不能在引用约束和主键中指定临时表</li>

<li>不能在<em>触发</em>的SQLStatement或WHEN子句中引用临时表</li>

<li>检查列约束</li>

<li>生成列规格</li>

<li>导入临时表</li>

</ul>
 <p>如果对临时表执行插入，更新或删除的语句遇到错误，则删除临时表的所有行。</p>
<div class="p">以下数据类型不能与声明的全局临时表一起使用：<ul>
<li>BLOB</li>

<li>位数据的字符</li>

<li>CLOB</li>

<li>长VARCHAR</li>

<li>长VARCHAR用于位数据</li>

<li>VARCHAR用于位数据</li>

<li>XML格式</li>

</ul>
</div>

<div class="p">全局临时表可以在XA事务中使用，但是只能在单个XA事务的范围内声明和访问。
只有在<em>javax.transaction.xa的以下方法之一之前， <span>Derby</span>才能支持对表的访问<em>。XAResource</em>接口被称为：<ul>
<li><em>XAResource.end</em></li>

<li><em>XAresource.prepare</em></li>

<li><em>XAResource.commit</em></li>

</ul>
</em></div><em>

<p>当XA事务提交或中止时，临时表将被删除。</p>

</em></div><em>

</em></div><em>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="crefsqlj39374.html" title="">语句</a></div>
</div>
</div>



</em></body></html>