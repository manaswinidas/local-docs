<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="reference">
<meta name="DC.Title" content="IDENTITY_VAL_LOCAL function">
<meta name="abstract" content="The IDENTITY_VAL_LOCAL function is a non-deterministic function that returns the most recently assigned value of an identity column for a connection, where the assignment occurred as a result of a single row INSERT statement using a VALUES clause or a single row UPDATE statement.">
<meta name="description" content="The IDENTITY_VAL_LOCAL function is a non-deterministic function that returns the most recently assigned value of an identity column for a connection, where the assignment occurred as a result of a single row INSERT statement using a VALUES clause or a single row UPDATE statement.">
<meta name="DC.Relation" scheme="URI" content="rrefsyscspeekidentity.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqljgenerationclause.html">
<meta name="DC.Relation" scheme="URI" content="crefjavstateautogen.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqlj29026.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="rrefidentityvallocal">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>IDENTITY_VAL_LOCAL函数</title>
</head>
<body id="rrefidentityvallocal" ><a name="rrefidentityvallocal"><!-- --></a>


<h1 class="topictitle1">IDENTITY_VAL_LOCAL函数</h1>


<div><p>IDENTITY_VAL_LOCAL函数是一种不确定性函数，它返回连接的标识列的最新分配值，该分配是由于使用VALUES子句的单行INSERT语句或单行的UPDATE语句而发生的。</p>

<div class="section"><h2 class="sectiontitle">句法</h2>
<pre><strong>IDENTITY_VAL_LOCAL ( )</strong></pre>

<p>IDENTITY_VAL_LOCAL函数没有输入参数。无论对应的标识列的实际数据类型如何，结果都是DECIMAL（31,0）。</p>

<p>对于连接，由IDENTITY_VAL_LOCAL函数返回的值是分配给在最近的单行INSERT或UPDATE语句中标识的表的标识列的值。INSERT语句必须在包含标识列的表上包含VALUES子句。当尚未为包含标识列的表发出单行UPDATE语句或带VALUES子句的单行INSERT语句时，该函数将返回空值。</p>

<div class="p">该函数的结果不受以下影响：<ul>
<li>不带标识列的表的带有VALUES子句的单行INSERT语句或单行UPDATE语句</li>

<li>具有VALUES子句的多行INSERT语句</li>

<li>多行UPDATE语句</li>

<li>具有全选的INSERT语句</li>

</ul>
</div>如果具有标识列的表的INSERT触发器定义为插入具有另一个标识列的另一个表，或者定义了UPDATE触发器以更新具有另一个标识列的另一个表，则IDENTITY_VAL_LOCAL函数将返回语句表的生成值，而不是触发器修改的表。
</div>

<div class="example"><h2 class="sectiontitle">例子</h2>
<pre><strong>ij&gt; create table t1(c1 int generated always as identity, c2 int);
0 rows inserted/updated/deleted
ij&gt; insert into t1(c2) values (8);
1 row inserted/updated/deleted
ij&gt; values IDENTITY_VAL_LOCAL();
1 
-------------------------------
1                              
1 row selected
ij&gt; select IDENTITY_VAL_LOCAL()+1, IDENTITY_VAL_LOCAL()-1 from t1;
1                                |2                          
-------------------------------------------------------------------
2                                |0                                
1 row selected
ij&gt; insert into t1(c2) values (IDENTITY_VAL_LOCAL());
1 row inserted/updated/deleted
ij&gt; select * from t1;
C1             |C2             
-------------------------------
1              |8              
2              |1              
2 rows selected
ij&gt; values IDENTITY_VAL_LOCAL();
1                        
-------------------------------
2                              
1 row selected
ij&gt; insert into t1(c2) values (8), (9);
2 rows inserted/updated/deleted
ij&gt; -- multi-values insert, return value of the function should not change
values IDENTITY_VAL_LOCAL();
1                        
-------------------------------
2                              
1 row selected
ij&gt; select * from t1;
C1             |C2             
-------------------------------
1              |8              
2              |1              
3              |8              
4              |9              
4 rows selected
ij&gt; insert into t1(c2) select c1 from t1;
4 rows inserted/updated/deleted
-- insert with sub-select, return value should not change
ij&gt; values IDENTITY_VAL_LOCAL();
1                        
-------------------------------
2                              
1 row selected
ij&gt; select * from t1;
C1             |C2             
-------------------------------
1              |8              
2              |1              
3              |8              
4              |9              
5              |1              
6              |2              
7              |3              
8              |4              
8 rows selected
ij&gt; update t1 set c1=default where c2=4;
1 row inserted/updated/deleted
ij&gt; values IDENTITY_VAL_LOCAL();
1
-------------------------------
9
1 row selected
ij&gt; select * from t1;
C1         |C2
-----------------------
1          |8
2          |1
3          |8
4          |9
5          |1
6          |2
7          |3
9          |4
8 rows selected
ij&gt; update t1 set c1=default where c2=8;
2 rows inserted/updated/deleted
ij&gt; values IDENTITY_VAL_LOCAL();
1
-------------------------------
9
1 row selected
ij&gt; select * from t1;
C1         |C2
-----------------------
10         |8
2          |1
11         |8
4          |9
5          |1
6          |2
7          |3
9          |4
</strong></pre>
</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="rrefsqlj29026.html" title="内置函数是一个表达式，其中SQL关键字或特殊运算符执行某些操作。">内置函数</a></div>
</div>
<div class="relconcepts"><strong>相关概念</strong><br>
<div><a href="crefjavstateautogen.html" title="JDBC的自动生成键功能提供了一种从索引的一部分或分配了默认值的列中检索值的方法。">自动生成的密钥</a></div>
</div>
<div class="relref"><strong>相关参考</strong><br>
<div><a href="rrefsyscspeekidentity.html" title="SYSCS_UTIL.SYSCS_PEEK_AT_IDENTITY函数使用户可以观察将为标识列发布的下一个值。">SYSCS_UTIL.SYSCS_PEEK_AT_IDENTITY系统功能</a></div>
<div><a href="rrefsqljgenerationclause.html" title="">世代条款</a></div>
</div>
</div>



</body></html>