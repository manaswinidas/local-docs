<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="reference">
<meta name="DC.Title" content="CREATE DERBY AGGREGATE statement">
<meta name="abstract" content="The CREATE DERBY AGGREGATE statement creates a user-defined aggregate (UDA). A UDA is a custom aggregate operator.">
<meta name="description" content="The CREATE DERBY AGGREGATE statement creates a user-defined aggregate (UDA). A UDA is a custom aggregate operator.">
<meta name="DC.subject" content="CREATE DERBY AGGREGATE statement, SQL statements, CREATE DERBY AGGREGATE, user-defined aggregates, creating, aggregates, user-defined">
<meta name="keywords" content="CREATE DERBY AGGREGATE statement, SQL statements, CREATE DERBY AGGREGATE, user-defined aggregates, creating, aggregates, user-defined">
<meta name="DC.Relation" scheme="URI" content="crefsqlj95081.html">
<meta name="DC.Relation" scheme="URI" content="rrefcreatefunctionstatement.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqlj20937.html">
<meta name="DC.Relation" scheme="URI" content="rrefcreateprocedurestatement.html">
<meta name="DC.Relation" scheme="URI" content="rrefcreaterole.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqlj31580.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqljcreatesequence.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqljcreatesynonym.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqlj24513.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqlj43125.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqljcreatetype.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqlj15446.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="rrefsqljcreateaggregate">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>CREATE DERBY AGGREGATE语句</title>
</head>
<body id="rrefsqljcreateaggregate" ><a name="rrefsqljcreateaggregate"><!-- --></a>


<h1 class="topictitle1">CREATE DERBY AGGREGATE语句</h1>



<div><p>CREATE DERBY AGGREGATE语句创建用户定义的聚合（UDA）。UDA是自定义聚合运算符。</p>

<div class="section"><h2 class="sectiontitle">句法</h2>
<pre><strong>CREATE DERBY AGGREGATE <em><a href="rrefaggregatename.html#rrefaggregatename">aggregateName</a></em> FOR <em>valueDataType</em>
[ RETURNS <em>returnDataType</em> ]
<a href="rrefsqljexternalname.html#rrefsqljexternalname">EXTERNAL NAME</a> <em>singleQuotedString</em></strong></pre>

<p>聚合名称由可选的<em><a href="rrefschemaname.html">schemaName</a></em>和<em><a href="crefsqlj34834.html">SQLIdentifier组成</a></em> 。如果未提供<em>schemaName</em> ，则当前架构为默认架构。如果指定了合格的聚合名称，则架构名称不能以SYS开头。</p>

<p>通常，UDA与一参数用户定义函数位于同一名称空间中（请参阅<a href="rrefcreatefunctionstatement.html#rrefcreatefunctionstatement">CREATE FUNCTION语句</a> ）。模式限定的UDA名称可能不是单参数用户定义函数的模式限定名称。</p>

<p>不合格的UDA名称（即没有其架构名称的UDA名称）可能不是SQL标准第2部分第10.9节中定义的聚合名称：</p>

<pre>ANY
AVG
COLLECT
COUNT
EVERY
FUSION
INTERSECTION
MAX
MIN
SOME
STDDEV_POP
STDDEV_SAMP
SUM
VAR_POP
VAR_SAMP</pre>

<p>另外，不合格的UDA名称可能不是带有一个参数的任何<span>Derby</span>内置函数的名称。</p>

<p>除XML外， <em>valueDataType</em>可以是任何有效的可空<span>Derby</span>数据类型，包括用户定义的类型。</p>

<p><em>returnXMLType</em>可以是XML以外的任何有效的可空<span>Derby</span>数据类型。如果省略<em>returnDataType，</em>则默认为是相同的<em>valueDataType。</em></p>

<p><a href="rrefsqljexternalname.html#rrefsqljexternalname">EXTERNAL NAME子句</a>指定的<em>singleQuotedString</em>是实现<em>org.apache.derby.agg的Java类的全名<em>。聚合器</em>接口。在编译调用UDA的语句之前，不会检查该合同。</em></p><em>

<p><em>org.apache.derby.agg。聚合器</em>接口扩展了<em>java.io。可序列化</em> ，因此您必须确保UDA的所有状态都可序列化。当UDA在大量组上执行分组聚合时，可能会序列化到磁盘。也就是说，可以将中间结果序列化到磁盘以进行如下查询：</p>

<pre>SELECT a, myAggregate( b ) FROM myTable GROUP BY a</pre>

<p>如果UDA包含不可序列化的字段，则序列化将失败。</p>

<p>UDA所在的架构的所有者自动获得UDA的USAGE特权，并可以将此特权授予其他用户和角色。只有<a href="rrefattrib26867.html#rrefattrib26867">数据库所有者</a>和UDA所有者才能授予这些USAGE特权。无法从架构所有者撤消USAGE特权。有关更多信息，请参见<a href="rrefsqljgrant.html#rrefsqljgrant">GRANT语句</a>和<a href="rrefsqljrevoke.html#rrefsqljrevoke">REVOKE语句</a> 。</p>

</em></div><em>

<div class="example"><h2 class="sectiontitle">例子</h2>
<pre><strong>CREATE DERBY AGGREGATE mode FOR INT
EXTERNAL NAME 'com.example.myapp.aggs.Mode';

CREATE DERBY AGGREGATE types.maxPrice FOR PRICE
EXTERNAL NAME 'com.example.myapp.types.PriceMaxer';

CREATE DERBY AGGREGATE types.avgLength FOR VECTOR
RETURNS DOUBLE
EXTERNAL NAME 'com.example.myapp.types.VectorLength';</strong></pre>

<p>有关创建和使用用户定义的聚合的更多详细信息，请参阅《 <span><em>Derby开发人员指南</em></span> 》中的“对用户定义的聚合进行编程”。</p>

</div>

</em></div><em>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="crefsqlj95081.html" title="">CREATE语句</a></div>
</div>
<div class="relref"><strong>相关参考</strong><br>
<div><a href="rrefcreatefunctionstatement.html" title="CREATE FUNCTION语句创建一个Java函数，然后可以在表达式中使用它。">CREATE FUNCTION语句</a></div>
<div><a href="rrefsqlj20937.html" title="CREATE INDEX语句在表上创建索引。索引可以在表中的一列或多列上。">CREATE INDEX语句</a></div>
<div><a href="rrefcreateprocedurestatement.html" title="CREATE PROCEDURE语句创建一个Java存储过程，然后可以使用CALL PROCEDURE语句调用它。">CREATE PROCEDURE语句</a></div>
<div><a href="rrefcreaterole.html" title="CREATE ROLE语句创建一个SQL角色。当数据库有许多用户时，角色对于管理特权很有用。">CREATE ROLE语句</a></div>
<div><a href="rrefsqlj31580.html" title="CREATE SCHEMA语句创建一个模式，该模式是在单个集合中对对象进行逻辑分组并为对象提供唯一名称空间的一种方式。">CREATE SCHEMA语句</a></div>
<div><a href="rrefsqljcreatesequence.html" title="CREATE SEQUENCE语句创建一个序列生成器，该生成器是一种用于一次生成一个精确数值的机制。">CREATE SEQUENCE语句</a></div>
<div><a href="rrefsqljcreatesynonym.html" title="CREATE SYNONYM语句为同一模式或其他模式中存在的表或视图提供了备用名称。">创建SYNONYM语句</a></div>
<div><a href="rrefsqlj24513.html" title="CREATE TABLE语句创建一个表。表包含列和约束，以及数据必须遵循的规则。">CREATE TABLE语句</a></div>
<div><a href="rrefsqlj43125.html" title="CREATE TRIGGER语句创建一个触发器，该触发器定义了在指定表上发生数据库事件时执行的一组操作。">CREATE TRIGGER语句</a></div>
<div><a href="rrefsqljcreatetype.html" title="CREATE TYPE语句创建用户定义的类型（UDT）。UDT是可序列化的Java类，其实例存储在列中。">CREATE TYPE语句</a></div>
<div><a href="rrefsqlj15446.html" title="CREATE VIEW语句创建一个视图，该视图是由查询形成的虚拟表。">CREATE VIEW语句</a></div>
</div>
</div>



</em></body></html>