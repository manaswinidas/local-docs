<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="reference">
<meta name="DC.Title" content="SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE system procedure">
<meta name="abstract" content="Use the SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE system procedure to reclaim unused, allocated space in a table and its indexes.">
<meta name="description" content="Use the SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE system procedure to reclaim unused, allocated space in a table and its indexes.">
<meta name="DC.subject" content="reclaiming unused space, system procedures, SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE">
<meta name="keywords" content="reclaiming unused space, system procedures, SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE">
<meta name="DC.Relation" scheme="URI" content="rrefaltertablecompress.html">
<meta name="DC.Relation" scheme="URI" content="rrefaltertablecompress.html">
<meta name="DC.Relation" scheme="URI" content="rrefdropstatsproc.html">
<meta name="DC.Relation" scheme="URI" content="rrefupdatestatsproc.html">
<meta name="DC.Relation" scheme="URI" content="rrefdropstatsproc.html">
<meta name="DC.Relation" scheme="URI" content="rrefupdatestatsproc.html">
<meta name="DC.Relation" scheme="URI" content="crefsqlbuiltinsystemprocedures.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="rrefproceduresinplacecompress">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE系统过程</title>
</head>
<body id="rrefproceduresinplacecompress" ><a name="rrefproceduresinplacecompress"><!-- --></a>


<h1 class="topictitle1">SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE系统过程</h1>



<div><p>使用<samp class="codeph">SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE</samp>系统过程以回收表及其索引中未使用的，已分配的空间。</p>

<div class="section"><p>通常，当从表中删除大量数据并且没有随后的插入使用删除所创建的空间时，就会存在未使用的分配空间。默认情况下， <span>Derby</span>不会将未使用的空间返回给操作系统。例如，将页面分配给表或索引后，在销毁表或索引之前，页面不会自动返回到操作系统。
<samp class="codeph">SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE</samp>允许您将未使用的空间返回给操作系统。</p>

<p>此系统过程可用于强制对SQL表进行三级就地压缩： <samp class="codeph">PURGE_ROWS</samp> ， <samp class="codeph">DEFRAGMENT_ROWS</samp>和<samp class="codeph">TRUNCATE_END</samp> 。不像<samp class="codeph">SYSCS_UTIL.SYSCS_COMPRESS_TABLE</samp> ，所有工作都在现有表/索引中完成。</p>
</div>

<div class="section"><h2 class="sectiontitle">句法</h2><pre><strong>SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE(
		IN SCHEMANAME VARCHAR(128),
		IN TABLENAME VARCHAR(128),
		IN PURGE_ROWS SMALLINT,
		IN DEFRAGMENT_ROWS SMALLINT,
		IN TRUNCATE_END SMALLINT )</strong></pre>
 <dl>
<dt class="dlterm">模式名称</dt>

<dd>类型为VARCHAR（128）的输入参数，用于指定表的模式。传递null将导致错误。</dd>


<dt class="dlterm">表名</dt>

<dd>类型为VARCHAR（128）的输入参数，用于指定表的表名。该字符串必须与表名的大小写完全匹配，并且参数“ Fred”将作为分隔标识符“ Fred”传递给SQL。传递null将导致错误。</dd>


<dt class="dlterm">PURGE_ROWS</dt>

<dd>如果将PURGE_ROWS设置为非零值，则将对表进行一次遍历，这将清除表中已提交的已删除行。然后，该空间可用于将来插入的行，但仍分配给表。当此选项扫描表的每个页面时，其性能与表的大小线性相关。</dd>


<dt class="dlterm">DEFRAGMENT_ROWS</dt>

<dd>如果将DEFRAGMENT_ROWS设置为非零值，则将执行一次碎片整理过程，该过程将使现有行从表末尾移至表头。碎片整理的目标是在表的末尾清空一组页面，然后可以通过TRUNCATE_END选项将其返回到操作系统。如果还指定了TRUNCATE_END选项，建议仅运行DEFRAGMENT_ROWS。DEFRAGMENT_ROWS选项扫描整个表，并且需要为每个基本表行移动更新索引条目，因此执行时间与表的大小线性相关。</dd>


<dt class="dlterm">TRUNCATE_END</dt>

<dd>如果将TRUNCATE_END设置为非零值，则表末尾的所有连续页面都将返回到操作系统。运行PURGE_ROWS和/或DEFRAGMENT_ROWS选项可能会增加受影响的页面数。此选项本身不对表执行任何扫描。</dd>

</dl>
</div>

<div class="section"><h2 class="sectiontitle">执行权限</h2>
<p>如果同时启用了身份验证和SQL授权，则所有用户都具有此过程的执行特权。但是，为了使过程在给定的表上成功运行，用户必须是<a href="rrefattrib26867.html#rrefattrib26867">数据库</a>或表所在模式的所有者。有关更多信息，请参见《 <span><em>Derby安全指南</em></span> 》中的“配置用户身份验证”和“配置用户授权”。</p>

</div>

<div class="section"><h2 class="sectiontitle">SQL示例</h2><div class="p">使用所有可用的压缩选项，在名为US的模式中压缩名为CUSTOMER的表：<pre><strong>call SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE('US', 'CUSTOMER', 1, 1, 1);</strong></pre>
</div>
<div class="p">要在同一表的末尾返回空的可用空间，以下调用将比运行所有选项快得多，但可能返回的空间要少得多：<pre><strong>call SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE('US', 'CUSTOMER', 0, 0, 1);</strong></pre>
</div>
</div>

<div class="section"><h2 class="sectiontitle">Java示例</h2><div class="p">使用所有可用的压缩选项，在名为US的模式中压缩名为CUSTOMER的表：<pre>CallableStatement cs = conn.prepareCall
("CALL SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE(?, ?, ?, ?, ?)");
cs.setString(1, "US");
cs.setString(2, "CUSTOMER");
cs.setShort(3, (short) 1);
cs.setShort(4, (short) 1);
cs.setShort(5, (short) 1);
cs.execute();</pre>
</div>
<div class="p">要在同一表的末尾返回空的可用空间，以下调用将比运行所有选项快得多，但可能返回的空间要少得多：<pre>CallableStatement cs = conn.prepareCall
("CALL SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE(?, ?, ?, ?, ?)");
cs.setString(1, "US");
cs.setString(2, "CUSTOMER");
cs.setShort(3, (short) 0);
cs.setShort(4, (short) 0);
cs.setShort(5, (short) 1);
cs.execute();</pre>
</div>
</div>

<div class="section"><div class="p"><div class="tip"><span class="tiptitle">提示：</span>我们建议您发布<samp class="codeph">SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE</samp>自动提交模式下的系统过程。</div>

<div class="note"><span class="notetitle">注意：</span>此过程在被压缩的表上获取排他表锁。所有依赖于表或其索引的语句计划都将失效。有关标识未使用空间的信息，请参见《 <span><em>Derby服务器和管理指南》</em></span> 。</div>
</div>
</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="crefsqlbuiltinsystemprocedures.html" title="">内置系统过程</a></div>
</div>
<div class="relref"><strong>相关参考</strong><br>
<div><a href="rrefaltertablecompress.html" title="使用SYSCS_UTIL.SYSCS_COMPRESS_TABLE系统过程来回收表及其索引中未使用的已分配空间。">SYSCS_UTIL.SYSCS_COMPRESS_TABLE系统过程</a></div>
<div><a href="rrefdropstatsproc.html" title="SYSCS_UTIL.SYSCS_DROP_STATISTICS系统过程删除指定索引或表上所有索引的所有现有基数统计信息。">SYSCS_UTIL.SYSCS_DROP_STATISTICS系统过程</a></div>
<div><a href="rrefupdatestatsproc.html" title="SYSCS_UTIL.SYSCS_UPDATE_STATISTICS系统过程更新基数统计信息，或者为您指定的索引或表中的所有索引创建基数统计信息（如果不存在）。">SYSCS_UTIL.SYSCS_UPDATE_STATISTICS系统过程</a></div>
</div>
</div>



</body></html>