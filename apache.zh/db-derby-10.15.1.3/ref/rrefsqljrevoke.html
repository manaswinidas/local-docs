<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="reference">
<meta name="DC.Title" content="REVOKE statement">
<meta name="abstract" content="The REVOKE statement removes privileges from a specific user or role, or from all users, to perform actions on database objects.">
<meta name="description" content="The REVOKE statement removes privileges from a specific user or role, or from all users, to perform actions on database objects.">
<meta name="DC.subject" content="REVOKE statement, syntax, SQL statements, REVOKE, REVOKE statement, limitations, privileges, tables and columns, revoking">
<meta name="keywords" content="REVOKE statement, syntax, SQL statements, REVOKE, REVOKE statement, limitations, privileges, tables and columns, revoking">
<meta name="DC.Relation" scheme="URI" content="rrefsqljgrant.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqljgrant.html">
<meta name="DC.Relation" scheme="URI" content="rrefsistabssyscolperms.html">
<meta name="DC.Relation" scheme="URI" content="rrefsistabssystableperms.html">
<meta name="DC.Relation" scheme="URI" content="rrefsistabssystableperms.html">
<meta name="DC.Relation" scheme="URI" content="rrefsistabssyscolperms.html">
<meta name="DC.Relation" scheme="URI" content="crefsqlj39374.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="rrefsqljrevoke">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>撤销声明</title>
</head>
<body id="rrefsqljrevoke" ><a name="rrefsqljrevoke"><!-- --></a>


<h1 class="topictitle1">撤销声明</h1>



<div><p>REVOKE语句删除特定用户或角色或所有用户的特权，以对数据库对象执行操作。</p>

<div class="section">
<p>您还可以使用REVOKE语句从用户，PUBLIC或另一个角色撤消一个角色。</p>

<div class="p">可以撤销以下类型的特权：<ul>
<li>从特定表中删除数据。</li>

<li>将数据插入到特定表中。</li>

<li>创建对命名表或表中列子集的外键引用。</li>

<li>从表，视图或表中的列子集中选择数据。</li>

<li>在表上创建触发器。</li>

<li>更新表或表中列的子集中的数据。</li>

<li>运行指定的例程（函数或过程）。</li>

<li>使用序列生成器，用户定义的类型或用户定义的聚合。</li>

</ul>
</div>
<p><em><a href="rrefpropersqlauth.html#rrefpropersqlauth">derby.database.sqlAuthorization</a></em>属性必须设置为<samp class="codeph">true</samp>在可以使用GRANT语句或REVOKE语句之前。<em>derby.database.sqlAuthorization</em>属性启用SQL授权模式。</p>
<p>如果您是对象的所有者或<a href="rrefattrib26867.html#rrefattrib26867">数据库所有者，</a>则可以撤消该对象的特权。</p>
<p>用于REVOKE语句的语法取决于您是撤消架构对象的特权还是撤消角色。</p>

<p>有关使用REVOKE语句的更多信息，请参阅《 <span><em>Derby安全指南</em></span> 》中的“使用细粒度的用户授权”。</p>

</div>

<div class="section"><h2 class="sectiontitle">表的语法</h2><pre><strong>REVOKE <em><a href="rrefsqljrevoke.html#rrefsqljrevoke__revokeprivtype">privilegeType</a></em> ON [ TABLE ] { <em><a href="rreftablename.html#rreftablename">tableName</a></em> | <em><a href="rrefviewname.html#rrefviewname">viewName</a></em> } FROM <em><a href="rrefsqljrevoke.html#rrefsqljrevoke__revokerevokees">revokees</a></em></strong></pre>
<p>撤消特权而不指定列列表将撤消表中所有列的特权。</p>
</div>

<div class="section"><h2 class="sectiontitle">例程的语法</h2>
<pre><strong>REVOKE EXECUTE ON FUNCTION <em><a href="rreffunctionname.html#rreffunctionname">functionName</a></em> FROM <em><a href="rrefsqljrevoke.html#rrefsqljrevoke__revokerevokees">revokees</a></em> RESTRICT</strong></pre>

<pre><strong>REVOKE EXECUTE ON PROCEDURE <em><a href="rrefprocedurename.html#rrefprocedurename.dita">procedureName</a></em> FROM <em><a href="rrefsqljrevoke.html#rrefsqljrevoke__revokerevokees">revokees</a></em> RESTRICT</strong></pre>

<p>您必须在例程的REVOKE语句上使用RESTRICT子句。RESTRICT子句指定，如果在视图，触发器或约束中使用了指定的例程，并且正在从视图，触发器或约束的所有者中撤消特权，则不能撤销EXECUTE特权。</p>
</div>

<div class="section" id="rrefsqljrevoke__revokesequencesyn"><a name="rrefsqljrevoke__revokesequencesyn"><!-- --></a><h2 class="sectiontitle">序列生成器的语法</h2>
<pre><strong>REVOKE USAGE ON SEQUENCE <em><a href="rrefsequencename.html#rrefsequencename">sequenceName</a></em> FROM <em><a href="rrefsqljrevoke.html#rrefsqljrevoke__revokerevokees">revokees</a></em> RESTRICT</strong></pre>

<p>为了使用序列生成器，您必须对其具有USAGE特权。可以从用户和角色撤消此特权。仅允许撤消撤销。这意味着REVOKE语句不能使其所有者无法使用视图，触发器或约束。无法从架构所有者撤消USAGE特权。有关更多信息，请参见<a href="rrefsqljcreatesequence.html#rrefsqljcreatesequence">CREATE SEQUENCE语句</a> 。</p>

</div>

<div class="section" id="rrefsqljrevoke__revoketypesyn"><a name="rrefsqljrevoke__revoketypesyn"><!-- --></a><h2 class="sectiontitle">用户定义类型的语法</h2>
<pre><strong>REVOKE USAGE ON TYPE <em><a href="rreftypename.html#rreftypename">typeName</a></em> FROM <em><a href="rrefsqljrevoke.html#rrefsqljrevoke__revokerevokees">revokees</a></em> RESTRICT</strong></pre>

<p>为了使用用户定义的类型，您必须具有USAGE特权。可以从用户和角色撤消此特权。仅允许撤消撤销。这意味着REVOKE语句不能使其所有者无法使用视图，触发器或约束。无法从架构所有者撤消USAGE特权。有关更多信息，请参见<a href="rrefsqljcreatetype.html#rrefsqljcreatetype">CREATE TYPE语句</a> 。</p>

</div>

<div class="section" id="rrefsqljrevoke__revokeaggsyn"><a name="rrefsqljrevoke__revokeaggsyn"><!-- --></a><h2 class="sectiontitle">用户定义的聚合的语法</h2>
<pre><strong>REVOKE USAGE ON DERBY AGGREGATE <em><a href="rrefaggregatename.html#rrefaggregatename">aggregateName</a></em> FROM <em><a href="rrefsqljrevoke.html#rrefsqljrevoke__revokerevokees">revokees</a></em> RESTRICT</strong></pre>

<p>为了使用用户定义的聚合，您必须具有USAGE特权。可以从用户和角色撤消此特权。仅允许撤消撤销。这意味着REVOKE语句不能使视图或触发器对其所有者不可用。无法从架构所有者撤消USAGE特权。有关更多信息，请参见<a href="rrefsqljcreateaggregate.html#rrefsqljcreateaggregate">CREATE DERBY AGGREGATE语句</a> 。</p>

</div>

<div class="section"><h2 class="sectiontitle">角色语法</h2>
<pre><strong>REVOKE <em><a href="rrefrolename.html#rrefrolename">roleName</a></em> [ , <em><a href="rrefrolename.html#rrefrolename">roleName</a></em> ]* FROM <em><a href="rrefsqljrevoke.html#rrefsqljrevoke__revokerevokees">revokees</a></em></strong></pre>

<p>只有<a href="rrefattrib26867.html#rrefattrib26867">数据库所有者</a>可以撤消角色。</p>

</div>

<div class="section" id="rrefsqljrevoke__revokeprivtype"><a name="rrefsqljrevoke__revokeprivtype"><!-- --></a><h2 class="sectiontitle">privilegeType</h2>
<pre><strong>  ALL PRIVILEGES | <em><a href="rrefsqljrevoke.html#rrefsqljrevoke__revokeprivlist">privilegeList</a></em>
</strong></pre>
</div>

<div class="section" id="rrefsqljrevoke__revokeprivlist"><a name="rrefsqljrevoke__revokeprivlist"><!-- --></a><h2 class="sectiontitle">privilegeList</h2>
<pre><strong> <em><a href="rrefsqljrevoke.html#rrefsqljrevoke__revoketablepriv">tablePrivilege</a></em> [ , <em><a href="rrefsqljrevoke.html#rrefsqljrevoke__revoketablepriv">tablePrivilege</a></em> ]*
</strong></pre>
</div>

<div class="section" id="rrefsqljrevoke__revoketablepriv"><a name="rrefsqljrevoke__revoketablepriv"><!-- --></a><h2 class="sectiontitle">table特权</h2>
<pre><strong>  DELETE |
  INSERT |
  REFERENCES [ <em><a href="rrefsqljrevoke.html#rrefsqljrevoke__revokecollist">columnList</a></em> ] |
  SELECT [ <em><a href="rrefsqljrevoke.html#rrefsqljrevoke__revokecollist">columnList</a></em> ] |
  TRIGGER |
  UPDATE [ <em><a href="rrefsqljrevoke.html#rrefsqljrevoke__revokecollist">columnList</a></em> ]
</strong></pre>
</div>

<div class="section" id="rrefsqljrevoke__revokecollist"><a name="rrefsqljrevoke__revokecollist"><!-- --></a><h2 class="sectiontitle">columnList</h2>
<pre><strong>  ( <em>columnIdentifier</em> [ , <em>columnIdentifier</em> ]* ) </strong></pre>
</div>

<div class="section"><p>使用ALL PRIVILEGES特权类型可以撤消用户或角色对指定表的所有特权。您还可以通过指定<em>privilegeList</em>撤销一个或多个表<em>特权</em> 。</p>
<p>使用DELETE特权类型撤消从指定表中删除行的权限。</p>
<p>使用INSERT特权类型来撤消将行插入到指定表的权限。</p>
<p>使用REFERENCES特权类型可以撤消创建对指定表的外键引用的权限。如果使用REFERENCES特权指定了列列表，则仅对指定列的外键引用撤消该权限。</p>
<p>使用SELECT特权类型可以撤消对表或视图执行SELECT语句的权限。如果使用SELECT特权指定了列列表，则仅对那些列撤消该权限。如果未指定任何列列表，则该特权对表中的所有列均有效。</p>
<p>使用TRIGGER特权类型可以撤消在指定表上创建触发器的权限。</p>
<p>使用UPDATE特权类型可以撤消在指定表上使用UPDATE语句的权限。如果指定了列列表，则仅在指定的列上撤销特权。</p>
</div>

<div class="section" id="rrefsqljrevoke__revokerevokees"><a name="rrefsqljrevoke__revokerevokees"><!-- --></a><h2 class="sectiontitle">撤销</h2>
<pre><strong>{ <em><a href="rrefrauthid.html#rrefrauthid">authorizationIdentifier</a></em> | <em><a href="rrefrolename.html#rrefrolename">roleName</a></em> | PUBLIC } 
[ , { <em><a href="rrefrauthid.html#rrefrauthid">authorizationIdentifier</a></em> | <em><a href="rrefrolename.html#rrefrolename">roleName</a></em> | PUBLIC } ]*</strong></pre>
<p>您可以撤消特定用户或角色或所有用户的特权。使用关键字PUBLIC指定所有用户。从PUBLIC和个人用户或角色撤消的特权是独立特权。例如，对表的SELECT特权<samp class="codeph">t</samp>被撤销到PUBLIC和授权ID <samp class="codeph">harry</samp> 。SELECT特权稍后从授权ID中撤消<samp class="codeph">harry</samp> ，但授权ID <samp class="codeph">harry</samp>可以访问表<samp class="codeph">t</samp>通过PUBLIC特权。</p>

<p>您可以从角色，用户或PUBLIC中撤消角色。</p>

<div class="restriction"><span class="restrictiontitle">限制：</span>您不能撤消对象所有者的特权。</div>
</div>

<div class="section"><h2 class="sectiontitle">准备好的语句和开放结果集/光标</h2>
  
  <p>检查特权发生在语句执行时，因此在撤消操作之后，准备好的语句仍然可用。如果会话仍具有足够的特权，则将执行准备好的语句，对于查询，将返回结果集。
  </p>

  <p>结果集返回到应用程序后（通过执行准备好的语句或直接执行），即使特权或角色以导致同一条语句的另一次执行失败的方式被吊销，它也将保持可访问性。
  </p>

</div>


<div class="section"><h2 class="sectiontitle">级联对象的依赖关系</h2><p>对于视图，触发器和约束，如果对象所依赖的特权被吊销，则该对象将被自动删除。<span>Derby</span>不会尝试确定您是否具有其他特权可以代替被撤消的特权。有关更多信息，请参阅《 <span><em>Derby安全指南</em></span> 》中的“配置细粒度的用户授权”和“视图，触发器，约束和生成的列的特权<span><em>”</em></span> 。</p>
</div>

<div class="section"><h2 class="sectiontitle">局限性</h2><p>以下限制适用于REVOKE语句：</p>
<dl>
<dt class="dlterm">表级特权</dt>

<dd>指定的受让人和表ID的所有表级别特权类型都存储在SYSTABLEPERMS系统表的一行中。例如，当<samp class="codeph">user2</samp>被吊销表上的SELECT和DELETE特权<samp class="codeph">user1.t1</samp> ，将一行添加到SYSTABLEPERMS表。GRANTEE字段包含<samp class="codeph">user2</samp>并且TABLEID包含<samp class="codeph">user1.t1</samp> 。SELECTPRIV和DELETEPRIV字段设置为Y。其余特权类型字段设置为N。<p>当被撤销者创建依赖于一种特权类型的对象时， <span>Derby</span>引擎将跟踪该对象对SYSTABLEPERMS表中特定行的依赖关系。例如， <samp class="codeph">user2</samp>创建视图<samp class="codeph">v1</samp>通过使用语句<samp class="codeph">SELECT * FROM user1.t1</samp> ，依赖性管理器跟踪视图的依赖性<samp class="codeph">v1</samp>在SYSTABLEPERMS中用于GRANTEE（ <samp class="codeph">user2</samp> ），TABLEID（ <samp class="codeph">user1.t1</samp> ）。依赖项管理器仅知道该视图依赖于该特定行中的特权类型，但无法准确跟踪该视图所依赖的特权类型。</p>
<p>当针对被撤销者和表ID发出针对表级特权的REVOKE语句时，将删除所有依赖于被撤销者和表ID的对象。例如，如果<samp class="codeph">user1</samp>撤销表的DELETE特权<samp class="codeph">t1</samp>从<samp class="codeph">user2</samp> ，SYSTABLEPERMS中GRANTEE（ <samp class="codeph">user2</samp> ），TABLEID（ <samp class="codeph">user1.t1</samp> ）由REVOKE语句修改。依赖项管理器向视图发送撤销无效消息<samp class="codeph">user2.v1</samp>并且即使该视图不依赖于GRANTEE（ <samp class="codeph">user2</samp> ），TABLEID（ <samp class="codeph">user1.t1</samp> ）。</p>
</dd>


<dt class="dlterm">列级权限</dt>

<dd>SYSCOLPERMS系统表的一行中仅存储了指定的被撤销者和表ID的一种特权。例如，当<samp class="codeph">user2</samp>被吊销表上的SELECT特权<samp class="codeph">user1.t1</samp>对于列c12和c13，将一行添加到SYSCOLPERMS。 GRANTEE字段包含<samp class="codeph">user2</samp> ，TABLEID包含<samp class="codeph">user1.t1</samp> ，TYPE字段包含<samp class="codeph">S</samp> ，并且COLUMNS字段包含<samp class="codeph">c12, c13</samp> 。<p>当被撤销者创建依赖于特权类型和表ID中的列子集的对象时， <span>Derby</span>引擎将跟踪该对象对SYSCOLPERMS表中特定行的依赖关系。例如， <samp class="codeph">user2</samp>创建视图<samp class="codeph">v1</samp>通过使用语句<samp class="codeph">SELECT c11 FROM user1.t1</samp> ，依赖性管理器跟踪视图的依赖性<samp class="codeph">v1</samp>在SYSCOLPERMS for GRANTEE（ <samp class="codeph">user2</samp> ），TABLEID（ <samp class="codeph">user1.t1</samp> ），TYPE（S）。依赖项管理器知道该视图依赖于SELECT特权类型，但不能准确跟踪该视图所依赖的列。</p>
<p>当针对被撤销者，表ID和类型发出针对列级特权的REVOKE语句时，将删除所有与被撤销者，表ID和类型相关的对象。例如，如果<samp class="codeph">user1</samp>撤销列的SELECT特权<samp class="codeph">c12</samp>桌子上<samp class="codeph">user1.t1</samp>从<samp class="codeph">user2</samp> ，SYSCOLPERMS中GRANTEE（ <samp class="codeph">user2</samp> ），TABLEID（ <samp class="codeph">user1.t1</samp> ），TYPE（S）由REVOKE语句修改。依赖项管理器向视图发送撤销无效消息<samp class="codeph">user2.v1</samp>即使该视图不依赖于该列，该视图也将被删除<samp class="codeph">c12</samp>对于GRANTEE（ <samp class="codeph">user2</samp> ），TABLEID（ <samp class="codeph">user1.t1</samp> ），TYPE（S）。</p>
</dd>



<dt class="dlterm">的角色</dt>

<dd><span>Derby会</span>跟踪视图，约束和触发器对定义者当前角色的所有依赖关系。如果在定义相关对象时只能通过当前角色获得特权，则该对象取决于当前角色。如果从定义用户或PUBLIC（视情况而定）撤消了角色，则对象将被删除。同样，如果在这种情况下当前角色的包含角色被吊销，则从属对象将被丢弃。请注意，删除可能太悲观了。这是因为<span>Derby</span>当前不尝试重新检查在这种情况下是否仍然具有必要的特权。</dd>
</dl>
</div>

<div class="example"><h2 class="sectiontitle">撤消示例</h2> <div class="p">撤消对表的SELECT特权<samp class="codeph">t</samp>从授权ID <samp class="codeph">maria</samp>和<samp class="codeph">harry</samp> ，请使用以下语法：<pre><strong>REVOKE SELECT ON TABLE t FROM maria,harry</strong> </pre>
</div>
<div class="p">撤消表上的UPDATE和TRIGGER特权<samp class="codeph">t</samp>从授权ID <samp class="codeph">anita</samp>和<samp class="codeph">zhi</samp> ，请使用以下语法：<pre><strong>REVOKE UPDATE, TRIGGER ON TABLE t FROM anita,zhi</strong> </pre>
</div>
<div class="p">撤消对表的SELECT特权<samp class="codeph">s.v</samp>所有用户使用以下语法：<pre><strong>REVOKE SELECT ON TABLE s.v FROM PUBLIC</strong></pre>
</div>
<div class="p">撤销列的UPDATE特权<samp class="codeph">c1</samp>和<samp class="codeph">c2</samp>表的<samp class="codeph">s.v</samp>所有用户使用以下语法：<pre><strong>REVOKE UPDATE (c1,c2) ON TABLE s.v FROM PUBLIC</strong></pre>
</div>
<p>撤销过程的EXECUTE特权<samp class="codeph">p</samp>从授权ID <samp class="codeph">george</samp> ，请使用以下语法：</p>
<pre><strong>REVOKE EXECUTE ON PROCEDURE p FROM george RESTRICT</strong> </pre>

<p>撤销角色<samp class="codeph">purchases_reader_role</samp>从授权ID <samp class="codeph">george</samp>和<samp class="codeph">maria</samp> ，请使用以下语法：</p>

<pre><strong>REVOKE purchases_reader_role FROM george,maria</strong></pre>

<p>撤消对表的SELECT特权<samp class="codeph">t</samp>从角色<samp class="codeph">purchases_reader_role</samp> ，请使用以下语法：</p>

<pre><strong>REVOKE SELECT ON TABLE t FROM purchases_reader_role</strong></pre>

<p>取消序列生成器的USAGE特权<samp class="codeph">order_id</samp>从角色<samp class="codeph">sales_role</samp> ，请使用以下语法：</p>

<pre><strong>REVOKE USAGE ON SEQUENCE order_id FROM sales_role;</strong></pre>

<p>撤销用户定义类型的USAGE特权<samp class="codeph">price</samp>从角色<samp class="codeph">finance_role</samp> ，请使用以下语法：</p>

<pre><strong>REVOKE USAGE ON TYPE price FROM finance_role;</strong></pre>

<p>取消用户定义的聚合上的USAGE特权<samp class="codeph">types.maxPrice</samp>从角色<samp class="codeph">sales_role</samp> ，请使用以下语法：</p>

<pre><strong>REVOKE USAGE ON DERBY AGGREGATE types.maxPrice FROM sales_role;</strong></pre>

</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="crefsqlj39374.html" title="">语句</a></div>
</div>
<div class="relref"><strong>相关参考</strong><br>
<div><a href="rrefsqljgrant.html" title="GRANT语句授予特定用户或角色或所有用户特权，以对数据库对象执行操作。">GRANT声明</a></div>
<div><a href="rrefsistabssyscolperms.html" title="SYSCOLPERMS表存储已授予但尚未撤消的列权限。">SYSCOLPERMS系统表</a></div>
<div><a href="rrefsistabssystableperms.html" title="SYSTABLEPERMS表存储已授予但尚未撤消的表权限。">SYSTABLEPERMS系统表</a></div>
</div>
</div>



</body></html>