<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="reference">
<meta name="DC.Title" content="XMLQUERY operator">
<meta name="abstract" content="XMLQUERY is a SQL/XML operator that you can use to query XML values in SQL.">
<meta name="description" content="XMLQUERY is a SQL/XML operator that you can use to query XML values in SQL.">
<meta name="DC.subject" content="XMLQUERY operator, operators, XMLQUERY, XML, operators, XMLQUERY">
<meta name="keywords" content="XMLQUERY operator, operators, XMLQUERY, XML, operators, XMLQUERY">
<meta name="DC.Relation" scheme="URI" content="rrefsqlj29026.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="rreffuncxmlquery">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>XMLQUERY运算子</title>
</head>
<body id="rreffuncxmlquery" ><a name="rreffuncxmlquery"><!-- --></a>


<h1 class="topictitle1">XMLQUERY运算子</h1>



<div><p>XMLQUERY是一个SQL / XML运算符，可用于查询SQL中的XML值。</p>

<div class="section"> <p>XMLQUERY运算符具有两个参数，一个XML查询表达式和一个<span>Derby</span> XML值。</p>

<p>有关更多信息，请参见《 <span><em>Derby开发人员指南</em></span> 》中的“ XML数据类型和运算符”。</p>

</div>

<div class="section"><h2 class="sectiontitle">句法</h2>
<pre><strong>XMLQUERY ( <var class="varname">xqueryStringLiteral</var>
    PASSING BY REF <var class="varname">xmlValueExpression</var> 
    [ RETURNING SEQUENCE [ BY REF ] ]
    EMPTY ON EMPTY
    )</strong></pre>
<dl>
<dt class="dlterm"><var class="varname">xqueryStringLiteral</var></dt>

<dd>必须指定为字符串文字。如果将此参数指定为参数，不是文字的表达式或不是字符串（例如整数）的文字，则<span>Derby</span>会引发错误。的<var class="varname">xqueryStringLiteral</var>参数也必须是XPath表达式。<span>Derby</span>不支持完整的XQuery，仅支持XPath子集。如果无法编译或执行查询参数，则<span>Derby</span>引发<em>SQLException</em> 。有关XPath表达式的更多信息，请参见<a href="http://www.w3.org/TR/xpath" target="_blank">http://www.w3.org/TR/xpath</a> 。</dd>


<dt class="dlterm"><var class="varname">xmlValueExpression</var></dt>

<dd>必须是XML数据值，并且必须构成格式正确的SQL / XML文档。的<var class="varname">xmlValueExpression</var>参数不能是参数。
 <span>Derby</span>不会执行隐式解析或XML值转换，因此使用字符串或任何其他数据类型会导致错误。如果参数是<span>Derby</span> XMLQUERY操作返回的序列，则该参数是一个仅一个节点（即文档节点）的序列，则该参数被接受。否则， <span>Derby</span>会引发错误。</dd>


<dt class="dlterm">按参考</dt>

<dd>可选关键字，描述<span>Derby</span>支持的唯一值传递机制。由于BY REF也是默认的传递机制，因此无论关键字是否存在，XMLQUERY运算符的行为都相同。有关传递机制的更多信息，请参见SQL / XML规范。</dd>


<dt class="dlterm">返回顺序</dt>

<dd>可选关键字，描述<span>Derby</span> XMLQUERY运算符返回的唯一XML类型。由于SEQUENCE也是默认的返回类型，因此无论是否存在关键字，XMLQUERY运算符的行为都相同。有关不同的XML返回类型的更多信息，请参见SQL / XML规范。</dd>


<dt class="dlterm">空对空</dt>

<dd>描述XMLQUERY处理空结果序列的方式的必需关键字。XMLQUERY运算符返回一个完全与序列相同的空序列。XMLQUERY运算符不会将空序列转换为空值。当空结果序列被序列化时，结果为空字符串。<span>Derby</span>认为空结果序列不是格式正确的XML文档。</dd>

</dl>
<p>XMLQUERY运算符的结果是XML类型的值。结果表示XML节点或值的序列。诸如字符串之类的原子值可以是结果序列的一部分。XMLQUERY运算符的结果不能保证表示格式正确的XML文档，并且可能无法将XMLQUERY运算符的结果插入XML列。要将结果存储在XML列中，结果必须是序列中恰好有一个项目的序列，并且该项目必须是格式正确的文档节点。通过显式使用<a href="rreffuncxmlserialize.html#rreffuncxmlserialize">XMLSERIALIZE运算符，</a>只能以序列化形式查看结果。</p>
</div>

<div class="section"><h2 class="sectiontitle">例子</h2><div class="p">在里面<samp class="codeph">x_table</samp>表，以搜索XML列<samp class="codeph">xcol</samp>并返回年龄属性大于20的学生，请使用以下语句：<pre><strong>SELECT ID,
    XMLSERIALIZE(
        XMLQUERY('//student[@age&gt;20]' PASSING BY REF xcol EMPTY ON EMPTY)
    AS VARCHAR(50))
FROM x_table</strong></pre>该查询的结果集在其中的每一行都包含一行<samp class="codeph">x_table</samp> ，无论XMLQUERY运算符是否实际返回结果。</div>
<div class="p">在里面<samp class="codeph">x_table</samp>表，以搜索XML列<samp class="codeph">xcol</samp>并返回任何名为BC的学生的年龄，请使用以下语句：<pre><strong>SELECT ID, 
    XMLSERIALIZE(
        XMLQUERY('string(//student[text() = "BC"]/@age)' PASSING BY REF xcol EMPTY ON EMPTY)
    AS VARCHAR(50))
FROM x_table
WHERE
    XMLEXISTS('//student[text() = "BC"]' PASSING BY REF xcol)</strong></pre>此查询的结果集仅包含其中的行<samp class="codeph">x_table</samp>有一个名字叫BC的学生。</div>
</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="rrefsqlj29026.html" title="内置函数是一个表达式，其中SQL关键字或特殊运算符执行某些操作。">内置函数</a></div>
</div>
</div>



</body></html>