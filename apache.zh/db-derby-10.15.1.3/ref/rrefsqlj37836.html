<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="reference">
<meta name="DC.Title" content="generatedColumnSpec">
<meta name="DC.subject" content="Identity column attributes, generatedColumnSpec">
<meta name="keywords" content="Identity column attributes, generatedColumnSpec">
<meta name="DC.Relation" scheme="URI" content="rrefsqlj24513.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqlj30540.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqljgenerationclause.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="rrefsqlj37836">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>generateColumnSpec</title>
</head>
<body id="rrefsqlj37836" ><a name="rrefsqlj37836"><!-- --></a>


<h1 class="topictitle1">generateColumnSpec</h1>


<div>
<div class="example"> <pre><strong>[ GENERATED { ALWAYS | BY DEFAULT } AS IDENTITY 
[ ( START WITH <em>integerConstant</em> 
    | INCREMENT BY <em>integerConstant</em> 
    | [NO] CYCLE )   ] ]
</strong></pre>
</div>

<div class="section" id="rrefsqlj37836__sqlj69411"><a name="rrefsqlj37836__sqlj69411"><!-- --></a><h2 class="sectiontitle">标识列属性</h2>
<p>一个表最多可以有一个标识列。</p>
<p>对于具有标识属性的SMALLINT，INT和BIGINT列， <span>Derby会</span>自动将递增的整数值分配给该列。标识列属性的行为类似于其他默认值，因为当插入语句未为该列指定值时， <span>Derby会</span>自动提供该值。但是，该值不是常数。 <span>Derby</span>在插入时自动增加默认值。</p>
<div class="p">仅当与列关联的数据类型是以下确切的整数类型之一时，才可以指定IDENTITY关键字。<ul>
<li>SMALLINT</li>

<li>INT</li>

<li>比金特</li>

</ul>
</div>
<div class="p"><span>Derby中</span>有两种标识列：始终生成的身份列和默认生成的列。<dl>

<dt class="dlterm">始终生成</dt>

<dd>始终为GENERATED的身份列将在每次插入时增加默认值，并将增加的值存储到该列中。与其他默认值不同，您不能直接将值插入或更新始终生成的标识列。而是在插入标识列时指定DEFAULT关键字，或者将标识列完全排除在插入列列表之外。例如：<pre>create table greetings
	(i int generated always as identity, ch char(50));
insert into greetings values (DEFAULT, 'hello');
insert into greetings(ch) values ('bonjour');</pre>GENERATED ALWAYS标识列中的自动生成的值是唯一的。创建标识列不会在该列上创建索引。</dd>


<dt class="dlterm">默认生成</dt>

<dd><p>如果未指定任何显式值，则GENERATED BY DEFAULT生成的标识列将仅递增，并在插入时使用默认值。与GENERATED ALWAYS列不同，您可以在插入语句中指定要使用的特定值，而不是生成的默认值。</p>
<div class="p">要使用生成的默认值，请在插入到标识列中时指定DEFAULT关键字，或者只是将标识列从插入列列表中排除。要指定一个值，请将其包括在插入语句中。例如：<pre>create table greetings
	(i int generated by default as identity, ch char(50));
<strong>-- specify value "1":</strong>
insert into greetings values (1, 'hi');
<strong>-- use generated default</strong>
insert into greetings values (DEFAULT, 'salut');
<strong>-- use generated default</strong>
insert into greetings(ch) values ('bonjour'); </pre>请注意，与GENERATED ALWAYS列不同，GENERATED BY DEFAULT列不能保证唯一性。因此，在上述示例中， <samp class="codeph">hi</samp>和<samp class="codeph">salut</samp>由于生成的列从“ 1”开始并且用户指定的值也为“ 1”，因此行的标识值均为“ 1”。为避免重复，尤其是在加载或导入数据时，请使用与系统应分配的第一个标识值相对应的START WITH值创建表。要检查并禁止这种情况，可以在GENERATED BY DEFAULT标识列上使用主键或唯一约束。</div>
</dd>


</dl>
</div>

<div class="p">CYCLE子句控制标识列耗尽其范围并回绕时发生的情况。
<dl>

<dt class="dlterm">周期</dt>

<dd>
<p>如果指定了CYCLE，则环绕行为是将标识列的值重新初始化为其最小值或最大值。
</p>

</dd>


<dt class="dlterm">无循环</dt>

<dd>
<p>如果指定了NO CYCLE，或者根本没有指定CYCLE选项，则当生成器回绕时， <span>Derby</span>将引发异常。缺省值为NO CYCLE：标识列不循环。请注意，循环从最小值或最大值而不是从起始值重新开始。</p>

</dd>


</dl>

</div>

<p>默认情况下，标识列的初始值为1，增量为1，并且不循环。当您使用关键字START WITH，INCREMENT BY和CYCLE定义列时，可以为初始值，间隔量和循环选项指定非默认值。并且，如果您为递增值指定了负数，则<span>Derby会</span>在每次插入时<em>递减</em>该值。如果该值为正，则<span>Derby</span>每次插入都会增加该值。值为0引发语句异常。</p>
<p>标识列中允许的最大值和最小值由列的数据类型确定。尝试插入数据类型支持的值范围之外的值会引发异常。下表显示了受支持的范围。</p>


<div class="tablenoborder"><table cellspacing="0" cellpadding="4" border="1" summary="This table lists the maximum and minimum values for each data type for columns with generated column specs." frame="border" rules="all"><caption>表格1。具有生成的列规格的列的最大值和最小值</caption>



<thead align="left">
<tr valign="bottom">
<th valign="bottom" width="16%" id="N10195">数据类型</th>

<th valign="bottom" width="42%" id="N1019C">最大值</th>

<th valign="bottom" width="42%" id="N101A3">最低值</th>

</tr>

</thead>

<tbody>
<tr>
<td valign="top" width="16%" headers="N10195">SMALLINT</td>

<td valign="top" width="42%" headers="N1019C">32767（ <em>java.lang。短。MAX_VALUE</em> ）</td>

<td valign="top" width="42%" headers="N101A3">-32768（ <em>java.lang。短。MIN_VALUE</em> ）</td>

</tr>

<tr>
<td valign="top" width="16%" headers="N10195">INT</td>

<td valign="top" width="42%" headers="N1019C">2147483647（ <em>java.lang。整数。MAX_VALUE</em> ）</td>

<td valign="top" width="42%" headers="N101A3">-2147483648（ <em>java.lang。整数。MIN_VALUE</em> ）</td>

</tr>

<tr>
<td valign="top" width="16%" headers="N10195">比金特</td>

<td valign="top" width="42%" headers="N1019C">9223372036854775807（ <em>java.lang。长。MAX_VALUE</em> ）</td>

<td valign="top" width="42%" headers="N101A3">-9223372036854775808（ <em>java.lang。长。MIN_VALUE</em> ）</td>

</tr>

</tbody>

</table>
</div>

<p>标识列中自动生成的值是唯一的。在列上使用主键或唯一性约束以确保唯一性。创建标识列<em>不会</em>在该列上创建索引。</p>
<p>的<samp class="codeph">IDENTITY_VAL_LOCAL</samp>函数是一个不确定性函数，它为标识列返回最近分配的值。有关更多信息，请参见<a href="rrefidentityvallocal.html#rrefidentityvallocal">IDENTITY_VAL_LOCAL函数</a> 。</p>
<div class="note"><span class="notetitle">注意：</span>使用与存储在系统表中的名称相同的大小写来指定模式，表和列的名称，即所有大写形式，除非在创建这些数据库对象时使用了分隔标识符。</div>
<p><span>Derby</span>跟踪高速缓存中列的最后一个增量值。它还将磁盘上该列的下一个增量值的值存储在<a href="rrefsistabs22441.html#rrefsistabs22441">SYS.SYSCOLUMNS系统表</a>的AUTOINCREMENTVALUE列中。回滚事务不会撤消该值，因此回滚事务会在自动插入到标识列的值中留下“空白”。<span>Derby的</span>行为方式是避免在事务期间锁定SYS.SYSCOLUMNS中的一行并保持高并发性。</p>

<p>当在触发器<em>SQLStatement中</em>进行插入时，仅在触发器代码内， <em>ConnectionInfo</em>才可以使用<em>TriggeredSQLStatement</em>插入到Identity列中的值。触发器代码还能够查看导致触发器触发的语句插入的值。但是，导致触发器触发的语句无法看到由<em>triggeredSQLStatement</em>插入到identity列中的值。同样，触发器可以嵌套（或递归）。SQL语句可能导致触发器T1触发。T1依次执行一条SQL语句，该触发器将触发触发器T2。如果T1和T2都在表中插入导致<span>Derby</span>插入到身份列中的行，则触发器T1无法看到由T2的插入引起的值，但是T2可以看到由T1的插入引起的值。每个嵌套级别都可以看到由自身和以前的嵌套级别生成的增量值，一直到启动递归触发器的顶级SQL语句。您只能有16个级别的触发器递归。</p>
 </div>



<div class="section"><h2 class="sectiontitle">例子1</h2><pre>create table greetings
  (i int generated by default as identity (START WITH 2, INCREMENT BY 1),
  ch char(50));
-- specify value "1":
insert into greetings values (1, 'hi');
-- use generated default
insert into greetings values (DEFAULT, 'salut');
-- use generated default
insert into greetings(ch) values ('bonjour'); </pre>
</div>


<div class="section"><h2 class="sectiontitle">带有循环选项的示例2</h2><pre>create table greetings
    (i int generated by default as identity (START WITH 2147483647, INCREMENT BY 1, CYCLE),
    j int);
-- when values are inserted, the identity column value restarts with minimum value:
insert into t( b ) values ( 1 ), ( 2 ), ( 3 );
</pre>
</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="rrefsqlj24513.html" title="CREATE TABLE语句创建一个表。表包含列和约束，以及数据必须遵循的规则。">CREATE TABLE语句</a></div>
</div>
<div class="relref"><strong>相关参考</strong><br>
<div><a href="rrefsqlj30540.html" title="">columnDefinition</a></div>
<div><a href="rrefsqljgenerationclause.html" title="">世代条款</a></div>
</div>
</div>



</body></html>