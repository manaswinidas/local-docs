<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="reference">
<meta name="DC.Title" content="CREATE PROCEDURE statement">
<meta name="abstract" content="The CREATE PROCEDURE statement creates a Java stored procedure, which you can then call using the CALL PROCEDURE statement.">
<meta name="description" content="The CREATE PROCEDURE statement creates a Java stored procedure, which you can then call using the CALL PROCEDURE statement.">
<meta name="DC.subject" content="CREATE PROCEDURE statement, CREATE PROCEDURE, SQL statements, procedures, creating">
<meta name="keywords" content="CREATE PROCEDURE statement, CREATE PROCEDURE, SQL statements, procedures, creating">
<meta name="DC.Relation" scheme="URI" content="crefsqlj95081.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqljcreateaggregate.html">
<meta name="DC.Relation" scheme="URI" content="rrefcreatefunctionstatement.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqlj20937.html">
<meta name="DC.Relation" scheme="URI" content="rrefcreaterole.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqlj31580.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqljcreatesequence.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqljcreatesynonym.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqlj24513.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqlj43125.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqljcreatetype.html">
<meta name="DC.Relation" scheme="URI" content="rrefsqlj15446.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="rrefcreateprocedurestatement">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>CREATE PROCEDURE语句</title>
</head>
<body id="rrefcreateprocedurestatement" ><a name="rrefcreateprocedurestatement"><!-- --></a>


<h1 class="topictitle1">CREATE PROCEDURE语句</h1>



<div><p>CREATE PROCEDURE语句创建一个Java存储过程，然后可以使用CALL PROCEDURE语句调用它。</p>

<div class="section"><p>过程所有者和<a href="rrefattrib26867.html#rrefattrib26867">数据库所有者</a>自动获得该过程的EXECUTE特权，并能够将此特权授予其他用户。无法从过程所有者和数据库所有者撤消EXECUTE特权。</p>

<p>有关<span>Derby</span>如何将过程与Java方法匹配的详细信息，请参见<a href="rrefsqljargmatching.html#rrefsqljargmatching">参数匹配</a> 。有关存储过程如何与可延迟约束交互的信息，请参见可延迟<a href="rrefsqlj13590.html#rrefsqlj13590__deferrableconstraints">约束</a> 。</p>

</div>

<div class="section"><h2 class="sectiontitle">句法</h2>
<pre><strong>CREATE PROCEDURE <em><a href="rrefprocedurename.html#rrefprocedurename.dita">procedureName</a></em> ( [ <em><a href="rrefcreateprocedurestatement.html#rrefcreateprocedurestatement__rrefcrproprocedureparameter">procedureParameter</a></em>
   [ , <em><a href="rrefcreateprocedurestatement.html#rrefcreateprocedurestatement__rrefcrproprocedureparameter">procedureParameter</a></em> ]* [...] ] )
[ <em><a href="rrefcreateprocedurestatement.html#rrefcreateprocedurestatement__rrefcrproprocedureelement">procedureElement</a></em> ]*</strong>
</pre>

<p>省略号（ <samp class="codeph">...</samp> ）之后的最后一个参数表示Java方法支持尾随可选参数，称为<dfn class="term">varargs</dfn> 。省略号表示可以使用零个或多个尾随值来调用该方法，所有尾随值均具有最后一个参数的数据类型。</p>
</div>

<div class="example" id="rrefcreateprocedurestatement__rrefcrproprocedureparameter"><a name="rrefcreateprocedurestatement__rrefcrproprocedureparameter"><!-- --></a><h2 class="sectiontitle">procedureParameter</h2> <pre><strong>[ { IN | OUT | INOUT } ] [ <em>parameterName</em> ] <em>dataType</em></strong></pre>
</div>

<div class="section"><p>参数的默认值为IN。 <em>parameterName</em>在过程中必须唯一。</p>
<p><em>dataType</em>的语法在<a href="crefsqlj31068.html#crefsqlj31068">Data types中</a>描述。</p>
<div class="note"><span class="notetitle">注意：</span>在CREATE PROCEDURE语句中，不允许将数据类型BLOB，CLOB，LONG VARCHAR，LONG VARCHAR FOR BIT DATA和XML作为参数。</div>
</div>

<div class="example" id="rrefcreateprocedurestatement__rrefcrproprocedureelement"><a name="rrefcreateprocedurestatement__rrefcrproprocedureelement"><!-- --></a><h2 class="sectiontitle">procedureElement</h2> 
<pre><strong>{ 
    [ DYNAMIC ] RESULT SETS <em><a href="rrefsqlj10696.html#rrefsqlj10696">integer</a></em> |
    LANGUAGE JAVA |
    { DETERMINISTIC | NOT DETERMINISTIC } |
    <a href="rrefsqljexternalname.html#rrefsqljexternalname">EXTERNAL NAME</a> <em>singleQuotedString</em> |
    PARAMETER STYLE { JAVA | DERBY } |
    EXTERNAL SECURITY { DEFINER | INVOKER } |
    { NO SQL | MODIFIES SQL DATA | CONTAINS SQL | READS SQL DATA }
}</strong></pre>
</div>

<div class="section"><div class="p">过程元素可以按任何顺序出现，但是每种类型的元素只能出现一次。过程定义必须包含以下元素：<ul>
<li><strong>语言</strong></li>

<li><strong>外部名称</strong></li>

<li><strong>参数样式</strong></li>

</ul>
</div>
</div>

<div class="section"><h2 class="sectiontitle">动态结果集<em>整数</em></h2> <p>指示该过程返回的结果集的估计上限。默认为无（零）动态结果集。如果该过程使用varargs，则该值必须为零。</p>
</div>

<div class="section"><h2 class="sectiontitle">语言JAVA</h2> <p>数据库管理器将在Java类中将该过程作为公共静态方法来调用。</p>
</div>

<div class="section"><h2 class="sectiontitle">确定性的，不是确定性的</h2>
<p>DETERMINISTIC声明该过程是确定性的，这意味着在输入值相同的情况下，该过程始终会计算相同的结果。默认值为NOT DETERMINISTIC。 <span>Derby</span>无法识别操作是否实际上是确定性的，因此您必须注意正确指定此元素。</p>

</div>

<div class="section"><h2 class="sectiontitle">外部名称<em>singleQuotedString</em></h2>
<p>由<a href="rrefsqljexternalname.html#rrefsqljexternalname">EXTERNAL NAME子句</a>指定的<em>singleQuotedString</em>描述了执行该过程时要调用的Java方法。</p>
</div>

<div class="section"><h2 class="sectiontitle">参数样式</h2>
<dl>

<dt class="dlterm">爪哇</dt>

<dd>该过程将使用符合Java语言和SQL Routines规范的参数传递约定。INOUT和OUT参数将作为单个条目数组传递，以方便返回值。结果集通过附加参数返回到类型为<em>java.sql的Java方法<em>。传递单个条目数组的ResultSet []</em> 。
<p><span>Derby</span>不支持长列类型（例如LONG VARCHAR，BLOB等）。如果您尝试使用这些长列类型之一，则会发生错误。</p>
</em></dd><em>



<dt class="dlterm">德比</dt>

<dd>当且仅当省略号（ <samp class="codeph">...</samp> ）出现在参数列表的末尾。</dd>


</em></dl><em>

</em></div><em>

<div class="section" id="rrefcreateprocedurestatement__rrefcrprodefrts"><a name="rrefcreateprocedurestatement__rrefcrprodefrts"><!-- --></a><h2 class="sectiontitle">外部安全</h2>
<p>如果启用了SQL授权模式，则默认情况下，过程将以为调用该过程的用户指定的特权（调用者的权限）运行。若要指定该过程应以为定义该过程的用户指定的特权（定义者的权限）运行，请使用EXTERNAL SECURITY DEFINER创建该过程。这些特权包括将当前角色设置为定义者具有特权的角色的权利。首次调用该过程时，未设置任何角色。即使调用者设置了当前角色，使用定义者权限运行的过程最初也没有设置当前角色。</p>

<p>有关设置SQL授权模式的详细信息，请参见<em><a href="rrefpropersqlauth.html#rrefpropersqlauth">derby.database.sqlAuthorization</a></em> 。</p>

<p>调用具有定义者权限的过程时，当前的默认架构将设置为定义者的同名架构。例如，如果定义用户名为OWNER，则默认架构也将设置为OWNER。</p>

<p>调用具有调用者权限的过程时，当前默认默认方案和当前角色在过程中最初不会更改。同样，如果未启用SQL授权模式，则该过程中的当前默认架构最初不会更改。</p>

<p>调用返回时，将重置（弹出）过程中对默认当前架构（和当前角色，如果相关）所做的任何更改。</p>

<p>如果未启用SQL授权模式，则尝试创建具有EXTERNAL SECURITY的过程将导致错误。</p>

</div>

<div class="section"><h2 class="sectiontitle">否SQL，包含SQL，读取SQL数据，修改SQL数据</h2> <p>指示存储过程是否发出任何SQL语句，如果发出，则键入什么类型。MODIFIES SQL DATA是默认值。如果存储过程发出的语句不符合声明的SQL语句级别，则将导致Derby引发异常。
        </p>
 <dl>

<dt class="dlterm">没有SQL</dt>

<dd>指示存储过程无法执行任何SQL语句</dd>


<dt class="dlterm">包含SQL</dt>

<dd>指示既不读取也不修改SQL数据的SQL语句可以由存储过程执行。
</dd>


<dt class="dlterm">读取SQL数据</dt>

<dd>指示不修改SQL数据的SQL语句（例如SELECT语句）可以包含在存储过程中。
</dd>


<dt class="dlterm">修改SQL数据</dt>

<dd>表示该存储过程可以执行任何SQL语句。</dd>

</dl>
</div>

<div class="section"><h2 class="sectiontitle">例子</h2> <pre><strong>CREATE PROCEDURE SALES.TOTAL_REVENUE(IN S_MONTH INTEGER,
IN S_YEAR INTEGER, OUT TOTAL DECIMAL(10,2))
PARAMETER STYLE JAVA READS SQL DATA LANGUAGE JAVA EXTERNAL NAME 
'com.example.sales.calculateRevenueByMonth'</strong></pre>


<pre><strong>
CREATE PROCEDURE VARARGPROC
( IN a INT, IN b INT, IN c BIGINT ... )
LANGUAGE JAVA
PARAMETER STYLE DERBY
READS SQL DATA
EXTERNAL NAME 'Procs.varargProc'
</strong></pre>

</div>

</em></div><em>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="crefsqlj95081.html" title="">CREATE语句</a></div>
</div>
<div class="relref"><strong>相关参考</strong><br>
<div><a href="rrefsqljcreateaggregate.html" title="CREATE DERBY AGGREGATE语句创建用户定义的聚合（UDA）。UDA是自定义聚合运算符。">CREATE DERBY AGGREGATE语句</a></div>
<div><a href="rrefcreatefunctionstatement.html" title="CREATE FUNCTION语句创建一个Java函数，然后可以在表达式中使用它。">CREATE FUNCTION语句</a></div>
<div><a href="rrefsqlj20937.html" title="CREATE INDEX语句在表上创建索引。索引可以在表中的一列或多列上。">CREATE INDEX语句</a></div>
<div><a href="rrefcreaterole.html" title="CREATE ROLE语句创建一个SQL角色。当数据库有许多用户时，角色对于管理特权很有用。">CREATE ROLE语句</a></div>
<div><a href="rrefsqlj31580.html" title="CREATE SCHEMA语句创建一个模式，该模式是在单个集合中对对象进行逻辑分组并为对象提供唯一名称空间的一种方式。">CREATE SCHEMA语句</a></div>
<div><a href="rrefsqljcreatesequence.html" title="CREATE SEQUENCE语句创建一个序列生成器，该生成器是一种用于一次生成一个精确数值的机制。">CREATE SEQUENCE语句</a></div>
<div><a href="rrefsqljcreatesynonym.html" title="CREATE SYNONYM语句为同一模式或其他模式中存在的表或视图提供了备用名称。">创建SYNONYM语句</a></div>
<div><a href="rrefsqlj24513.html" title="CREATE TABLE语句创建一个表。表包含列和约束，以及数据必须遵循的规则。">CREATE TABLE语句</a></div>
<div><a href="rrefsqlj43125.html" title="CREATE TRIGGER语句创建一个触发器，该触发器定义了在指定表上发生数据库事件时执行的一组操作。">CREATE TRIGGER语句</a></div>
<div><a href="rrefsqljcreatetype.html" title="CREATE TYPE语句创建用户定义的类型（UDT）。UDT是可序列化的Java类，其实例存储在列中。">CREATE TYPE语句</a></div>
<div><a href="rrefsqlj15446.html" title="CREATE VIEW语句创建一个视图，该视图是由查询形成的虚拟表。">CREATE VIEW语句</a></div>
</div>
</div>



</em></body></html>