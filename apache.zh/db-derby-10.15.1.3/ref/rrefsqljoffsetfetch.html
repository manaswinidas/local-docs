<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="reference">
<meta name="DC.Title" content="The result offset and fetch first clauses">
<meta name="abstract" content="The result offset clause provides a way to skip the first N rows in a result set before starting to return any rows. The fetch first clause, which can be combined with the result offset clause if desired, limits the number of rows returned in the result set.">
<meta name="description" content="The result offset clause provides a way to skip the first N rows in a result set before starting to return any rows. The fetch first clause, which can be combined with the result offset clause if desired, limits the number of rows returned in the result set.">
<meta name="DC.subject" content="result offset clause, fetch first clause">
<meta name="keywords" content="result offset clause, fetch first clause">
<meta name="DC.Relation" scheme="URI" content="rrefclauses.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="rrefsqljoffsetfetch">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>结果offset和fetch第一子句</title>
</head>
<body id="rrefsqljoffsetfetch" ><a name="rrefsqljoffsetfetch"><!-- --></a>


<h1 class="topictitle1">结果offset和fetch第一子句</h1>



<div><p><em>结果偏移子句</em>提供了一种在开始返回任何行之前跳过结果集中前<em>N</em>行的方法。如果需要，可以将<em>fetch first子句</em>与<em>result offset子句</em>组合使用，它限制了结果集中返回的行数。</p>

<div class="section"> 
<p>通常，与第一个ORDER BY子句结合使用时， <em>fetch first子句</em>有时对于从较大的结果集中仅检索几行很有用。使用此子句可以提高效率。另外，它可以使应用程序的编程更简单。</p>
 
</div>


<div class="section"><h2 class="sectiontitle">句法</h2>
   
  <pre><strong>OFFSET { <em>integerLiteral</em> | ? } { ROW | ROWS }</strong></pre>
 

  <pre><strong>FETCH { FIRST | NEXT } [ <em>integerLiteral</em> | ? ] { ROW | ROWS } ONLY</strong></pre>
 
<p>ROW与ROWS同义，FIRST与NEXT同义。</p>


<p>对于<em>结果offset子句</em> ，整数文字的值（或动态参数<samp class="codeph">?</samp> ）必须等于0（如果未提供该子句则为默认值）或正数。如果它大于基础结果集中的行数，则不返回任何行。
</p>


<p>对于<em>fetch first子句</em> ，文字值（或动态参数<samp class="codeph">?</samp> ）必须为1或更高。文字可以省略，在这种情况下默认为1。如果该子句被完全省略，则将返回所有行（或者如果还给出了<em>结果偏移子句，</em>则将保留剩余的那些行）。
</p>

</div>

<div class="example"><h2 class="sectiontitle">例子</h2>
  <pre><strong>-- Fetch the first row of T
SELECT * FROM T FETCH FIRST ROW ONLY

-- Sort T using column I, then fetch rows 11 through 20 of the sorted
--   rows (inclusive)
SELECT * FROM T ORDER BY I OFFSET 10 ROWS FETCH NEXT 10 ROWS ONLY

-- Skip the first 100 rows of T
-- If the table has fewer than 101 records, an empty result set is
--   returned
SELECT * FROM T OFFSET 100 ROWS

-- Use of ORDER BY and FETCH FIRST in a subquery
SELECT DISTINCT A.ORIG_AIRPORT, B.FLIGHT_ID FROM 
   (SELECT FLIGHT_ID, ORIG_AIRPORT 
       FROM FLIGHTS 
       ORDER BY ORIG_AIRPORT DESC 
       FETCH FIRST 40 ROWS ONLY) 
    AS A, FLIGHTAVAILABILITY AS B 
   WHERE A.FLIGHT_ID = B.FLIGHT_ID

JDBC (using a dynamic parameter):
PreparedStatement p = 
    con.prepareStatement("SELECT * FROM T ORDER BY I OFFSET ? ROWS");
p.setInt(1, 100);
ResultSet rs = p.executeQuery();
</strong></pre>

<div class="note"><span class="notetitle">注意：</span>如果希望检索排序后的结果集，请确保指定ORDER BY子句。如果不使用ORDER BY子句，则检索到的结果集通常具有插入记录的顺序。</div>
 </div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="rrefclauses.html" title="">SQL子句</a></div>
</div>
</div>



</body></html>