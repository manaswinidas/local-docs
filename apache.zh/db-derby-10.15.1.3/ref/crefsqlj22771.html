<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Interaction with the dependency system">
<meta name="abstract" content="Derby internally tracks the dependencies of prepared statements, which are SQL statements that are precompiled before being executed. Typically they are prepared (precompiled) once and executed multiple times.">
<meta name="description" content="Derby internally tracks the dependencies of prepared statements, which are SQL statements that are precompiled before being executed. Typically they are prepared (precompiled) once and executed multiple times.">
<meta name="DC.subject" content="Dependencies, internal tracking of, Prepared statements, tracking of dependencies">
<meta name="keywords" content="Dependencies, internal tracking of, Prepared statements, tracking of dependencies">
<meta name="DC.Relation" scheme="URI" content="crefsqlj39374.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="crefsqlj22771">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>与依赖系统的交互</title>
</head>
<body id="crefsqlj22771" ><a name="crefsqlj22771"><!-- --></a>


<h1 class="topictitle1">与依赖系统的交互</h1>



<div><p><span>Derby在</span>内部跟踪准备好的语句的依赖关系，这些语句是在执行之前预先编译的SQL语句。通常，它们准备一次（预编译）并执行多次。</p>

<p>准备的语句取决于字典对象和它们引用的语句。（字典对象包括表，列，约束，索引，视图和触发器。）删除或修改它们所依赖的字典对象或语句会在内部使它们无效，这意味着<span>Derby</span>将在执行语句时自动尝试重新编译该语句。如果该语句无法重新编译，则执行请求将失败。但是，如果您采取一些措施来恢复损坏的依赖关系（例如恢复丢失的表），则可以执行相同的准备好的语句，因为<span>Derby</span>会在下一个执行请求时自动重新编译它。</p>

<p>语句彼此依赖-UPDATE WHERE CURRENT语句取决于它引用的语句。删除它所依赖的语句会使UPDATE WHERE CURRENT语句无效。</p>

<p>此外，如果准备好的语句上有开放的结果集，则会阻止某些DDL语句的执行。</p>

<p>每个语句的手册页详细说明了如果准备好了哪些操作会使该语句无效。</p>

<div class="p">这是使用<span>Derby</span>工具ij的示例：<pre>ij&gt; <strong>CREATE TABLE mytable (mycol INT);</strong>
0 rows inserted/updated/deleted
ij&gt; <strong>INSERT INTO mytable VALUES (1), (2), (3);</strong>
3 rows inserted/updated/deleted
-- this example uses the ij command prepare,
-- which prepares a statement
ij&gt; <strong>prepare p1 AS 'INSERT INTO MyTable VALUES (4)';</strong>
-- p1 depends on mytable;
ij&gt; <strong>execute p1;</strong>
1 row inserted/updated/deleted
-- <span>Derby</span>  executes it without recompiling
ij&gt; <strong>CREATE INDEX i1 ON mytable(mycol);</strong>
0 rows inserted/updated/deleted
-- p1 is temporarily invalidated because of new index
ij&gt; <strong>execute p1;</strong>
1 row inserted/updated/deleted
-- <span>Derby</span>  automatically recompiles p1 and executes it
ij&gt; <strong>DROP TABLE mytable;</strong>
0 rows inserted/updated/deleted
-- <span>Derby</span>  permits you to drop table
-- because result set of p1 is closed
-- however, the statement p1 is temporarily invalidated
ij&gt; <strong>CREATE TABLE mytable (mycol INT);</strong>
0 rows inserted/updated/deleted
ij&gt; <strong>INSERT INTO mytable VALUES (1), (2), (3);</strong>
3 rows inserted/updated/deleted
ij&gt; <strong>execute p1;</strong>
1 row inserted/updated/deleted
-- Because p1 is invalid, <span>Derby</span>  tries to recompile it
-- before executing.
-- It is successful and executes.
ij&gt; <strong>DROP TABLE mytable;</strong>
0 rows inserted/updated/deleted
-- statement p1 is now invalid,
-- and this time the attempt to recompile it
-- upon execution will fail
ij&gt; <strong>execute p1;</strong>
ERROR 42X05: Table/View 'MYTABLE' does not exist.</pre>
</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="crefsqlj39374.html" title="">语句</a></div>
</div>
</div>



</body></html>