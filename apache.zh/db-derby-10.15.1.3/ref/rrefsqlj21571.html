<html lang="en-us"  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us"><!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="security" content="public">
<meta name="Robots" content="index,follow">
<meta http-equiv="PICS-Label" content="(PICS-1.1 " http:="" ="" www.icra.org="" ratingsv02.htm="=" www.rsac.org="" ratingsv01.htm="=" (ss~~000="" 1)="=">
<meta name="DC.Type" content="reference">
<meta name="DC.Title" content="query">
<meta name="abstract" content="A query creates a virtual table based on existing tables or constants built into tables.">
<meta name="description" content="A query creates a virtual table based on existing tables or constants built into tables.">
<meta name="DC.subject" content="UNION, UNION ALL">
<meta name="keywords" content="UNION, UNION ALL">
<meta name="DC.Relation" scheme="URI" content="rrefqueries.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="rrefsqlj21571">
<meta name="DC.Language" content="en-us">
<link href="commonltr.css" type="text/css" rel="stylesheet">
<title>询问</title>
</head>
<body id="rrefsqlj21571" ><a name="rrefsqlj21571"><!-- --></a>


<h1 class="topictitle1">询问</h1>



<div><p>查询基于现有表或表中内置的常量创建虚拟表。</p>

<div class="section"><h2 class="sectiontitle">句法</h2><pre><strong>{
    ( <em>query</em> 
         [ <em><a href="rrefsqlj13658.html#rrefsqlj13658">ORDER BY clause</a></em> ]
         [ <em><a href="rrefsqljoffsetfetch.html#rrefsqljoffsetfetch">result offset clause</a></em> ]
         [ <em><a href="rrefsqljoffsetfetch.html#rrefsqljoffsetfetch">fetch first clause</a></em> ]
    ) |
    <em>query</em> INTERSECT [ ALL | DISTINCT ] <em>query</em> |
    <em>query</em> EXCEPT [ ALL | DISTINCT ] <em>query</em> |
    <em>query</em> UNION [ ALL | DISTINCT ] <em>query</em> |
    <em><a href="rrefselectexpression.html#rrefselectexpression">selectExpression</a></em> | <em><a href="rrefsqlj11277.html#rrefsqlj11277">VALUES expression</a></em>
}</strong></pre>
<p>您可以在查询周围任意放置括号，或使用括号控制INTERSECT，EXCEPT或UNION操作的求值顺序。当没有括号时，这些操作从左到右进行评估，但INTERSECT操作除外，INTERSECT操作将在任何UNION或EXCEPT操作之前进行评估。</p>
</div>

<div class="section"><h2 class="sectiontitle">在UNION，INTERSECT和EXCEPT ALL结果中重复</h2><p>ALL和DISTINCT关键字确定是否从操作结果中消除重复项。如果指定DISTINCT关键字，则结果将没有重复的行。如果指定ALL关键字，则结果中可能有重复项，具体取决于输入中是否存在重复项。DISTINCT是默认设置，因此，如果您未指定ALL或DISTINCT，则将消除重复项。例如，UNION使用两个查询中的所有行构建中间<em>ResultSet</em> ，并在返回其余行之前消除重复的行。UNION ALL返回两个查询的所有行作为结果。</p>
<div class="p">根据指定的操作，如果左表中某行的副本数为L，而右表中该行的副本数为R，则输出表包含的该特定行的副本数（假设指定了ALL关键字）为：<ul>
<li>UNION：（L + R）。</li>

<li>除了：（L-R）和0（零）的最大值。</li>

<li>INTERSECT：L和R的最小值。</li>

</ul>
</div>
</div>

<div class="example"><h2 class="sectiontitle">例子</h2><pre><strong><span>-- a Select expression </span>
SELECT *
FROM ORG

<span>-- a subquery </span>
SELECT *
FROM (SELECT CLASS_CODE FROM CL_SCHED) AS CS

-- a subquery
SELECT *
FROM (SELECT CLASS_CODE FROM CL_SCHED) AS CS (CLASS_CODE)

<span>-- a UNION
-- returns all rows from columns DEPTNUMB and MANAGER 
-- in table ORG
-- and (1,2) and (3,4)
-- DEPTNUMB and MANAGER are smallint columns</span>
SELECT DEPTNUMB, MANAGER 
FROM ORG
UNION ALL
VALUES (1,2), (3,4)

<span>-- a values expression</span>
VALUES (1,2,3)

<span>-- Use of ORDER BY and FETCH FIRST in a subquery</span>
SELECT DISTINCT A.ORIG_AIRPORT, B.FLIGHT_ID FROM 
   (SELECT FLIGHT_ID, ORIG_AIRPORT 
       FROM FLIGHTS 
       ORDER BY ORIG_AIRPORT DESC 
       FETCH FIRST 40 ROWS ONLY) 
    AS A, FLIGHTAVAILABILITY AS B 
   WHERE A.FLIGHT_ID = B.FLIGHT_ID</strong>
   
<strong>-- List the employee numbers (EMPNO) of all employees in the EMPLOYEE 
-- table whose department number (WORKDEPT) either begins with 'E' or 
-- who are assigned to projects in the EMP_ACT table 
-- whose project number (PROJNO) equals 'MA2100', 'MA2110', or 'MA2112'
SELECT EMPNO
     FROM EMPLOYEE
     WHERE WORKDEPT LIKE 'E%'
  UNION
  SELECT EMPNO
     FROM EMP_ACT
     WHERE PROJNO IN('MA2100', 'MA2110', 'MA2112')</strong>
<strong>-- Make the same query as in the previous example
-- and "tag" the rows from the EMPLOYEE table with 'emp' and 
-- the rows from the EMP_ACT table with 'emp_act'. 
-- Unlike the result from the previous example, 
-- this query may return the same EMPNO more than once, 
-- identifying which table it came from by the associated "tag"
SELECT EMPNO, 'emp'
     FROM EMPLOYEE
     WHERE WORKDEPT LIKE 'E%'
  UNION
  SELECT EMPNO, 'emp_act' FROM EMP_ACT
     WHERE PROJNO IN('MA2100', 'MA2110', 'MA2112')</strong>
<strong>-- Make the same query as in the previous example, 
-- only use UNION ALL so that no duplicate rows are eliminated
SELECT EMPNO
      FROM EMPLOYEE
      WHERE WORKDEPT LIKE 'E%'
  UNION ALL
  SELECT EMPNO
     FROM EMP_ACT
     WHERE PROJNO IN('MA2100', 'MA2110', 'MA2112')</strong>
<strong>-- Make the same query as in the previous example, 
-- only include an additional two employees currently not in any table
-- and tag these rows as "new"
 SELECT EMPNO, 'emp'
     FROM EMPLOYEE
     WHERE WORKDEPT LIKE 'E%'
  UNION
  SELECT EMPNO, 'emp_act'
     FROM EMP_ACT
     WHERE PROJNO IN('MA2100', 'MA2110', 'MA2112')
  UNION
     VALUES ('NEWAAA', 'new'), ('NEWBBB', 'new')</strong></pre>
 </div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="rrefqueries.html" title="">SQL查询</a></div>
</div>
</div>



</body></html>