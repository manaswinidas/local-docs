<html ><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <title>类路径处理</title>

    <!-- Bootstrap core CSS -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="/assets/css/bootstrap-theme.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="asset?aid=1">
    <link href="/css/style.css" rel="stylesheet">
    <link href="/assets/css/owl.theme.css" rel="stylesheet">
    <link href="/assets/css/owl.carousel.css" rel="stylesheet">
    <script type="text/javascript" src="/assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="/assets/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/assets/js/owl.carousel.min.js"></script>
    <script type="text/javascript" src="/assets/js/storm.js"></script>
    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>


  <body >
    <header>
  <div class="container-fluid">
     <div class="row">
          <div class="col-md-5">
            <a href="/index.html"><img src="/images/logo.png" class="logo"></a>
          </div>
          <div class="col-md-5">
            
              <h1>版本：2.1.0</h1>
            
          </div>
          <div class="col-md-2">
            <a href="/downloads.html" class="btn-std btn-block btn-download">下载</a>
          </div>
        </div>
    </div>
</header>
<!--Header End-->
<!--Navigation Begin-->
<div class="navbar" role="banner">
  <div class="container-fluid">
      <div class="navbar-header">
          <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse"></button>
        </div>
        <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
          <ul class="nav navbar-nav">
              <li><a href="/index.html" id="home">家</a></li>
                <li><a href="/getting-help.html" id="getting-help">获得帮助</a></li>
                <li><a href="/about/integrates.html" id="project-info">项目信息</a></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" id="documentation" data-toggle="dropdown">文献资料<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                      
                        
                          <li><a href="/releases/2.1.0/index.html">2.1.0</a></li>
                        
                      
                        
                          <li><a href="/releases/2.0.0/index.html">2.0.0</a></li>
                        
                      
                        
                          <li><a href="/releases/1.2.3/index.html">1.2.3</a></li>
                        
                      
                    </ul>
                </li>
                <li><a href="/talksAndVideos.html">讲座和幻灯片</a></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" id="contribute" data-toggle="dropdown">社区<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="/contribute/Contributing-to-Storm.html">贡献</a></li>
                        <li><a href="/contribute/People.html">人</a></li>
                        <li><a href="/contribute/BYLAWS.html">按照法律规定</a></li>
                    </ul>
                </li>
                <li><a href="/2019/10/31/storm210-released.html" id="news">新闻</a></li>
            </ul>
        </nav>
    </div>
</div>



    <div class="container-fluid">
    <h1 class="page-title">类路径处理</h1>
          <div class="row">
           	<div class="col-md-12">
	             <!-- Documentation -->

<p class="post-meta"></p>

<div class="documentation-content"><h3 id="storm-is-an-application-container">Storm是一个应用程序容器</h3>

<p>Storm提供了一个应用程序容器环境，例如Apache Tomcat，这为Storm和您的应用程序之间的类路径冲突创造了可能。使用Storm的最常见方法是提交“超级JAR”，其中包含捆绑了其所有依赖项的应用程序代码，然后Storm将此JAR分发给Worker节点。然后，Storm在名为a的Storm进程中运行您的应用程序<code>Worker</code> -因此，JVM的类路径包含JAR的依赖项以及Worker本身具有的任何依赖项。因此，仔细处理类路径和依赖项对于Storm的正确运行至关重要。</p>

<h3 id="adding-extra-dependencies-to-classpath">向类路径添加额外的依赖项</h3>

<p>您不再<em>需要</em>将依赖项捆绑到拓扑中并创建uber JAR，现在有了用于分别处理拓扑的依赖项的工具。此外，还有一些工具可以将外部依赖项添加到Storm守护程序中。</p>

<p>的<code>storm.py</code>启动器脚本允许您通过几种不同的机制将依赖项包含到启动程序的类路径中：</p>

<ol>
<li>的<code>--jar</code>和<code>--artifacts</code>的选项<code>storm jar</code>命令：允许在拓扑中包含非捆绑的依赖关系；即，允许规范未捆绑到拓扑uber-jar中的JAR。当使用<code>storm sql</code>命令，该命令自动构造拓扑，而无需您编写代码和构建拓扑JAR。</li>
<li>的<code>${STORM_DIR}/extlib/</code>和<code>${STORM_DIR}/extlib-daemon/</code>目录中可以添加依赖项，以便将插件和第三方库包含到Storm守护程序中（例如，Nimbus，UI，Supervisor等）–使用<code>extlib-daemon/</code> ）和其他通过<code>storm.py</code>脚本，例如<code>storm sql</code>和<code>storm jar</code> （使用<code>extlib</code> ）。值得注意的是，这意味着Storm Worker进程不包括<code>extlib-daemon/</code>目录放入其类路径。</li>
<li>的<code>STORM_EXT_CLASSPATH</code>和<code>STORM_EXT_CLASSPATH_DAEMON</code>环境变量提供了与那些目录类似的功能，但允许用户将其外部依赖项放置在其他位置。

<ul>
<li>这里有一个问题：因为Supervisor守护程序启动了Worker进程（如果需要） <code>STORM_EXT_CLASSPATH</code>为了影响您的工人，您需要指定<code>STORM_EXT_CLASSPATH</code>主管守护程序。这将允许Supervisor在构造Worker进程的类路径时查阅此环境变量。</li>
</ul></li>
</ol>

<h4 id="which-facility-to-choose">选择哪个设施？</h4>

<p>您可能已经注意到第一种机制与其他机制之间的重叠。如果您考虑<code>--jar</code> / <code>--artifacts</code>选项与<code>extlib/</code> / <code>STORM_EXT_CLASSPATH</code>选择将哪个依赖项与Worker进程一起使用并不明显。即，两种机制都允许包括JAR在内运行您的Worker进程。这是我对区别的理解： <code>--jar</code> / <code>--artifacts</code>将导致依赖项被用于运行<code>storm jar/sql</code>命令， <em>并且</em>依赖项将被上传并在拓扑的类路径中可用<code>Worker</code>流程。而使用<code>extlib/</code> / <code>STORM_EXT_CLASSPATH</code>要求您将JAR依赖项分发到所有Worker节点。另一个区别是<code>extlib/</code> / <code>STORM_EXT_CLASSPATH</code>会影响所有拓扑，而<code>--jar</code> / <code>--artifacts</code>是特定于拓扑的选项。</p>

<h3 id="abbreviation-of-classpaths-and-process-commands">类路径和过程命令的缩写</h3>

<p>当。。。的时候<code>storm.py</code>脚本启动一个<code>java</code>命令，它首先根据上述可选设置构建类路径，并包括一些默认位置，例如<code>${STORM_DIR}/</code> ， <code>${STORM_DIR}/lib/</code> ， <code>${STORM_DIR}/extlib/</code>和<code>${STORM_DIR}/extlib-daemon/</code>目录。在过去的发行版中，Storm会枚举这些目录中的所有JAR，然后将所有这些JAR显式添加到<code>-cp</code> / <code>--classpath</code>对发起的论点<code>java</code>命令。因此，类路径会变得很长，以至于<code>java</code>命令可能会违反Linux内核进程表中记录命令的4096字节限制。导致命令被截断<code>ps</code>输出，很难操作Storm群集，因为您无法轻松地区分流程，也无法轻松查看<code>ps</code>工人正在听哪个端口。</p>

<p>在Storm放弃对Java 5的支持之后，不再需要这种类路径扩展，因为Java 6支持类路径通配符。类路径通配符允许您指定以。结尾的目录<code>*</code>元素，例如<code>foo/bar/*</code> ，并且JVM会自动将类路径扩展为包括所有<code>.jar</code>通配符目录中的文件。从<a href="https://issues.apache.org/jira/browse/STORM-2191">STORM-2191开始，</a> Storm仅使用类路径通配符，而不是显式列出所有JAR，从而缩短了所有命令并简化了Storm集群的操作。</p>
</div>


	          </div>
	       </div>
	  </div>
<footer>
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-3">
                <div class="footer-widget">
                    <h5>聚会</h5>
                    <ul class="latest-news">
                        
                        <li><a href="http://www.meetup.com/Apache-Storm-Apache-Kafka/">Apache Storm和Apache Kafka</a> <span class="small">（加利福尼亚州桑尼维尔）</span></li>
                        
                        <li><a href="http://www.meetup.com/Apache-Storm-Kafka-Users/">Apache Storm和Kafka用户</a> <span class="small">（华盛顿州西雅图）</span></li>
                        
                        <li><a href="http://www.meetup.com/New-York-City-Storm-User-Group/">NYC Storm用户组</a> <span class="small">（纽约州纽约）</span></li>
                        
                        <li><a href="http://www.meetup.com/Bay-Area-Stream-Processing">湾区流处理</a> <span class="small">（加利福尼亚州埃默里维尔）</span></li>
                        
                        <li><a href="http://www.meetup.com/Boston-Storm-Users/">波士顿实时数据</a> <span class="small">（马萨诸塞州波士顿）</span></li>
                        
                        <li><a href="http://www.meetup.com/storm-london">伦敦风暴用户组</a> <span class="small">（英国伦敦）</span></li>
                        
                        <!-- <li><a href="http://www.meetup.com/Apache-Storm-Kafka-Users/">Seatle, WA</a> <span class="small">(27 Jun 2015)</span></li> -->
                    </ul>
                </div>
            </div>
            <div class="col-md-3">
                <div class="footer-widget">
                    <h5>关于Apache Storm</h5>
                    <p>Apache Storm与任何排队系统和任何数据库系统集成。Apache Storm的喷口抽象使集成新排队系统变得容易。同样，将Apache Storm与数据库系统集成很容易。</p>
               </div>
            </div>
            <div class="col-md-3">
                <div class="footer-widget">
                    <h5>第一眼</h5>
                    <ul class="footer-list">
                        <li><a href="/releases/current/Rationale.html">基本原理</a></li>
                        <li><a href="/releases/current/Tutorial.html">讲解</a></li>
                        <li><a href="/releases/current/Setting-up-development-environment.html">搭建开发环境</a></li>
                        <li><a href="/releases/current/Creating-a-new-Storm-project.html">创建一个新的Apache Storm项目</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-3">
                <div class="footer-widget">
                    <h5>文献资料</h5>
                    <ul class="footer-list">
                        <li><a href="/releases/current/index.html">指数</a></li>
                        <li><a href="/releases/current/javadocs/index.html">Java文档</a></li>
                        <li><a href="/releases/current/FAQ.html">常问问题</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <hr>
        <div class="row">   
            <div class="col-md-12">
                <p align="center">版权所有©2019 <a href="http://www.apache.org">Apache Software Foundation</a> 。版权所有。
                    <br>Apache Storm，Apache，Apache Feather徽标和Apache Storm项目徽标是The Apache Software Foundation的商标。
                    <br>提及的所有其他商标可能是其各自所有者的商标或注册商标。</p>
            </div>
        </div>
    </div>
</footer>
<!--Footer End-->
<!-- Scroll to top -->
<span class="totop"><a href="#"><i class="fa fa-angle-up"></i></a></span> 





</body></html>