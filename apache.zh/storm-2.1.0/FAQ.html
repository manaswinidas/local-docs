<html ><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <title>常问问题</title>

    <!-- Bootstrap core CSS -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="/assets/css/bootstrap-theme.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="asset?aid=1">
    <link href="/css/style.css" rel="stylesheet">
    <link href="/assets/css/owl.theme.css" rel="stylesheet">
    <link href="/assets/css/owl.carousel.css" rel="stylesheet">
    <script type="text/javascript" src="/assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="/assets/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/assets/js/owl.carousel.min.js"></script>
    <script type="text/javascript" src="/assets/js/storm.js"></script>
    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>


  <body >
    <header>
  <div class="container-fluid">
     <div class="row">
          <div class="col-md-5">
            <a href="/index.html"><img src="/images/logo.png" class="logo"></a>
          </div>
          <div class="col-md-5">
            
              <h1>版本：2.1.0</h1>
            
          </div>
          <div class="col-md-2">
            <a href="/downloads.html" class="btn-std btn-block btn-download">下载</a>
          </div>
        </div>
    </div>
</header>
<!--Header End-->
<!--Navigation Begin-->
<div class="navbar" role="banner">
  <div class="container-fluid">
      <div class="navbar-header">
          <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse"></button>
        </div>
        <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
          <ul class="nav navbar-nav">
              <li><a href="/index.html" id="home">家</a></li>
                <li><a href="/getting-help.html" id="getting-help">获得帮助</a></li>
                <li><a href="/about/integrates.html" id="project-info">项目信息</a></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" id="documentation" data-toggle="dropdown">文献资料<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                      
                        
                          <li><a href="/releases/2.1.0/index.html">2.1.0</a></li>
                        
                      
                        
                          <li><a href="/releases/2.0.0/index.html">2.0.0</a></li>
                        
                      
                        
                          <li><a href="/releases/1.2.3/index.html">1.2.3</a></li>
                        
                      
                    </ul>
                </li>
                <li><a href="/talksAndVideos.html">讲座和幻灯片</a></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" id="contribute" data-toggle="dropdown">社区<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="/contribute/Contributing-to-Storm.html">贡献</a></li>
                        <li><a href="/contribute/People.html">人</a></li>
                        <li><a href="/contribute/BYLAWS.html">按照法律规定</a></li>
                    </ul>
                </li>
                <li><a href="/2019/10/31/storm210-released.html" id="news">新闻</a></li>
            </ul>
        </nav>
    </div>
</div>



    <div class="container-fluid">
    <h1 class="page-title">常问问题</h1>
          <div class="row">
           	<div class="col-md-12">
	             <!-- Documentation -->

<p class="post-meta"></p>

<div class="documentation-content"><h2 id="best-practices">最佳实践</h2>

<h3 id="what-rules-of-thumb-can-you-give-me-for-configuring-storm-trident">您可以给我什么经验法则来配置Storm + Trident？</h3>

<ul>
<li>工人人数是机器数量的倍数；并行性是工人数量的倍数； kafka分区数是spout并行度的倍数</li>
<li>每台计算机的每个拓扑使用一名工作人员</li>
<li>从更少，更大的聚合器开始，每台机器上有一个聚合器，上面有工人</li>
<li>使用隔离调度程序</li>
<li>每个工作人员使用一个acker-0.9设置为默认值，但较早的版本则不使用。</li>
<li>启用GC日志记录；如果事物的形状合理，您应该会看到很少的主要GC。</li>
<li>将三叉戟批处理毫秒数设置为典型端到端延迟的50％。</li>
<li>首先确定一个最大喷口，该喷口肯定太小（一个用于三叉戟，一个用于暴风雨的执行者），然后增加它直到您停止看到流的变化。您可能最终会遇到一些困难<code>2*(throughput in recs/sec)*(end-to-end latency)</code> （两倍于小法则的能力）。</li>
</ul>

<h3 id="what-are-some-of-the-best-ways-to-get-a-worker-to-mysteriously-and-bafflingly-die">使工人神秘而莫名其妙地死亡的最佳方法是什么？</h3>

<ul>
<li>您是否拥有对日志目录的写权限</li>
<li>你在炸堆吗？</li>
<li>所有工人上都安装了所有正确的库吗？</li>
<li>zookeeper主机名是否仍设置为localhost？</li>
<li>您是否为每个工作人员提供了正确的，唯一的主机名（可以解析回机器的主机名），并将其放入storm conf文件中？</li>
<li>您是否已在a）所有工作人员，b）风暴主服务器，c）动物园管理员之间<em>双向</em>打开防火墙/安全组权限？另外，从工作人员到您的拓扑访问的任何kafka / kestrel / database / etc？使用netcat拨出适当的端口，并确保。</li>
</ul>

<h3 id="halp-i-cannot-see">！我看不见：</h3>

<ul>
<li><strong>我的日志</strong>默认情况下，日志转到$ STORM_HOME / logs。检查您是否对该目录具有写权限。它们在log4j2 / {cluster，worker} .xml中进行配置。</li>
<li><strong>最终的JVM设置</strong> <code>-XX+PrintFlagsFinal</code> childopts中的命令行选项（请参阅conf文件）</li>
<li><strong>Java系统最终属性</strong>添加<code>Properties props = System.getProperties(); props.list(System.out);</code>在您构建拓扑的位置附近。</li>
</ul>

<h3 id="how-many-workers-should-i-use">我应该使用多少个工人？</h3>

<p>工作者的总数由主管确定-每个主管将监督一定数量的JVM插槽。您在拓扑上设置的内容是它将尝试声明多少个工作槽。</p>

<p>没有充分的理由为每台计算机的每个拓扑使用多个工作人员。</p>

<p>一个拓扑在三个8核节点上运行，并具有并行提示24，每个螺栓每台机器将获得8个执行器，即每个核一个。与经营24名工人（每名指派一名执行者）相比，经营三名工人（每名指派一名执行者）有三大好处。</p>

<p>首先，在同一工作线程中重新分区到执行者的数据（混洗或分组）将不必达到传输缓冲区。取而代之的是，元组直接从发送缓冲区存放到接收缓冲区。那是一个很大的胜利。相比之下，如果目标执行程序在同一台计算机上的不同工作程序中，则必须发送->工作程序传输->本地套接字-> worker recv-> exec recv缓冲区。它并没有打到网卡上，但是并没有执行者在同一个工作人员中时那么大。</p>

<p>其次，与具有二十四个具有较小后备缓存的聚合器相比，使用三个具有非常大的后备缓存的聚合器通常要更好。这减少了偏斜的影响，并提高了LRU效率。</p>

<p>最后，更少的工人减少了控制流的颤动。</p>

<h2 id="topology">拓扑结构</h2>

<h3 id="can-a-trident-topology-have-multiple-streams">三叉戟拓扑可以具有多个流吗？</h3>

<blockquote>
<p>Trident拓扑是否可以像具有条件路径的工作流一样工作（如果其他）？例如，喷口（S1）连接到螺栓（B0），螺栓（B1）根据传入的元组中的特定值将其路由到螺栓（B1）或螺栓（B2），但不能同时到达两者。</p>
</blockquote>

<p>Trident“每个”运算符返回一个Stream对象，您可以将其存储在变量中。然后，您可以在同一个Stream上运行多个eache以对其进行拆分，例如：</p>
<div class="highlight"><pre><code class="language-" data-lang="">    Stream s = topology.each(...).groupBy(...).aggregate(...) 
    Stream branch1 = s.each(..., FilterA) 
    Stream branch2 = s.each(..., FilterB) 
</code></pre></div>
<p>您可以使用join，merge或multiReduce加入流。</p>

<p>在撰写本文时，您无法从Trident发出多个输出流-请参阅<a href="https://issues.apache.org/jira/browse/STORM-68">STORM-68</a></p>

<h3 id="why-am-i-getting-a-notserializableexception-illegalstateexception-when-my-topology-is-being-started-up">为什么在启动拓扑时出现NotSerializableException / IllegalStateException？</h3>

<p>在Storm生命周期内，拓扑被实例化，然后序列化为字节格式，以在执行拓扑之前存储在ZooKeeper中。在此步骤中，如果拓扑中的喷嘴或螺栓具有初始化的不可序列化属性，则序列化将失败。如果需要不可序列化的字段，请在螺栓的<code>prepare</code>或喷口的<code>open</code>方法，在将拓扑交付给工作器之后运行。</p>

<h2 id="spouts">喷口</h2>

<h3 id="what-is-a-coordinator-and-why-are-there-several">什么是协调员，为什么有几个？</h3>

<p>一个三叉戟喷口实际上是在防风<em>栓</em>内运行的。三叉戟拓扑的风暴喷口是MasterBatchCoordinator-它协调三叉戟批次，并且无论您使用哪种喷口都是相同的。当MBC将种子元组分配给每个喷口协调器时，一批就诞生了。喷嘴协调器螺栓知道您特定的喷嘴应如何配合-因此在kafka情况下，这有助于确定每个喷嘴应从哪个分区和偏移范围拉出。</p>

<h3 id="what-can-i-store-into-the-spouts-metadata-record">我可以在喷嘴的元数据记录中存储什么？</h3>

<p>您应该只将静态数据（尽可能少的静态数据）存储到元数据记录中（注意：也许您<em>可以</em>存储更多有趣的东西；但是不应该）</p>

<h3 id="how-often-is-the-emitpartitionbatchnew-function-called">“ emitPartitionBatchNew”函数多久调用一次？</h3>

<p>由于MBC是实际的喷嘴，所以批处理中的所有元组都只是其元组树的成员。这意味着Storm的“最大喷口未决”配置有效地定义了三叉戟运行的并发批处理数量。如果MBC的未处理的元组少于最大开销元组，并且自上次批处理以来至少经过了一个<a href="http://github.com/apache/storm/blob/v2.1.0/conf/defaults.yaml#L115">三叉戟批处理间隔</a>秒数，则MBC会发出新批处理。</p>

<h3 id="if-nothing-was-emitted-does-trident-slow-down-the-calls">如果什么都没发出，Trident会降低通话速度吗？</h3>

<p>是的，有一个可插入的“喷嘴等待策略”；默认为休眠一段可<a href="http://github.com/apache/storm/blob/v2.1.0/conf/defaults.yaml#L110">配置的时间</a></p>

<h3 id="ok-then-what-is-the-trident-batch-interval-for">OK，那么三叉戟的间歇间隔是什么？</h3>

<p>您知道486时代的计算机上如何带有<a href="http://en.wikipedia.org/wiki/Turbo_button">Turbo按钮</a>吗？就像那样。</p>

<p>实际上，它有两个实际用途。一种是抑制喷头，该喷头轮询远程源而不限制处理。例如，我们有一个喷口，它在给定的S3存储桶中查找新的批处理上传文件，以进行读取，换行和发射。我们不希望它每隔几秒钟就会遇到S3：文件每隔几分钟显示一次就不会超过一次，而批处理要花费几秒钟的时间。</p>

<p>另一种方法是在启动过程中或在重负载下限制内部队列上的过压-如果喷口弹起并突然卡住了十批的记录到系统中，则可能会产生大量不那么紧急的元组批处理7阻塞了传输缓冲区，并阻止了批处理3中的$ commit元组通过（甚至只是批处理3中的常规旧元组）。我们要做的是将三叉戟批处理间隔设置为典型的端到端处理延迟的一半-如果需要600毫秒来处理批处理，则可以每300毫秒才启动一个批处理。</p>

<p>请注意，这是一个上限，而不是额外的延迟-周期为300毫秒，如果您的批处理花费258毫秒，则Trident只会延迟另外的42毫秒。</p>

<h3 id="how-do-you-set-the-batch-size">您如何设置批量大小？</h3>

<p>Trident并没有对批次数量设置自己的限制。对于Kafka出口，最大读取字节大小除以平均记录大小将定义每个子批处理分区的有效记录。</p>

<h3 id="how-do-i-resize-a-batch">如何调整批量大小？</h3>

<p>三叉戟批次有点过载。连同分区数一起，批大小受约束或用于定义</p>

<ol>
<li>交易安全性的单位（风险元组与时间的关系）</li>
<li>每个分区，用于窗口流分析的有效窗口机制</li>
<li>每个分区，由partitionQuery，partitionPersist等进行的同时查询的数量；</li>
<li>对于每个分区，方便喷口同时分派的记录数；</li>
</ol>

<p>一旦生成，您将无法更改整体批处理大小，但是可以更改分区数-随机播放，然后更改并行度提示</p>

<h2 id="time-series">时间序列</h2>

<h3 id="how-do-i-aggregate-events-by-time">如何按时间汇总事件？</h3>

<p>如果您的记录带有不可更改的时间戳，并且您希望对它们进行计数，平均或以其他方式将它们聚合到离散的时间段中，那么Trident是一个出色的可扩展解决方案。</p>

<p>写一个<code>Each</code>将时间戳转换为时间段的函数：如果存储段大小为“按小时”，则时间戳为<code>2013-08-08 12:34:56</code>将被映射到<code>2013-08-08 12:00:00</code>时间段，其他所有时间也会在十二点钟。然后在该时间段上分组并使用分组的persistentAggregate。persistentAggregate使用由数据存储支持的本地cacheMap。具有许多记录的组几乎不需要从数据存储中读取数据，而是使用有效的批量读取和写入操作；只要您的数据馈送相对及时，Trident将非常有效地利用内存和网络。即使服务器中断一天的时间，然后匆忙地提供一整天的数据，旧的结果也将得到平静地检索和更新，而不会干扰计算当前结果。</p>

<h3 id="how-can-i-know-that-all-records-for-a-time-bucket-have-been-received">我怎么知道一个时段的所有记录都已收到？</h3>

<p>您不知道所有事件都已收集到-这是认识论上的挑战，而不是分布式系统上的挑战。您可以：</p>

<ul>
<li>使用领域知识设置时间限制</li>
<li>引入<em>标点符号</em> ：已知的记录将出现在给定时间段内的所有记录之后。Trident使用此方案来知道批处理何时完成。例如，如果您从一组传感器接收记录，每个传感器按该传感器的顺序排列，那么一旦所有传感器向您发送了3：02：xx或更晚的时间戳，您就会知道可以提交。</li>
<li>在可能的情况下，使您的过程递增：输入的每个值都会使答案越来越真实。Trident ReducerAggregator是一种运算符，可获取先前的结果和一组新记录并返回新结果。这样就可以将结果缓存并序列化到数据存储中；如果服务器下线一天，然后匆忙返回一整天的数据，则旧的结果将被冷静地检索和更新。</li>
<li>Lambda体系结构：收据上将所有事件记录到档案存储中（S3，HBase，HDFS）。在快速层中，一旦时间窗口清除，则对存储桶进行处理以获取可行的答案，并忽略早于时间窗口的所有内容。定期运行全局聚合以计算“正确”答案。</li>
</ul>
</div>


	          </div>
	       </div>
	  </div>
<footer>
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-3">
                <div class="footer-widget">
                    <h5>聚会</h5>
                    <ul class="latest-news">
                        
                        <li><a href="http://www.meetup.com/Apache-Storm-Apache-Kafka/">Apache Storm和Apache Kafka</a> <span class="small">（加利福尼亚州桑尼维尔）</span></li>
                        
                        <li><a href="http://www.meetup.com/Apache-Storm-Kafka-Users/">Apache Storm和Kafka用户</a> <span class="small">（华盛顿州西雅图）</span></li>
                        
                        <li><a href="http://www.meetup.com/New-York-City-Storm-User-Group/">NYC Storm用户组</a> <span class="small">（纽约州纽约）</span></li>
                        
                        <li><a href="http://www.meetup.com/Bay-Area-Stream-Processing">湾区流处理</a> <span class="small">（加利福尼亚州埃默里维尔）</span></li>
                        
                        <li><a href="http://www.meetup.com/Boston-Storm-Users/">波士顿实时数据</a> <span class="small">（马萨诸塞州波士顿）</span></li>
                        
                        <li><a href="http://www.meetup.com/storm-london">伦敦风暴用户组</a> <span class="small">（英国伦敦）</span></li>
                        
                        <!-- <li><a href="http://www.meetup.com/Apache-Storm-Kafka-Users/">Seatle, WA</a> <span class="small">(27 Jun 2015)</span></li> -->
                    </ul>
                </div>
            </div>
            <div class="col-md-3">
                <div class="footer-widget">
                    <h5>关于Apache Storm</h5>
                    <p>Apache Storm与任何排队系统和任何数据库系统集成。Apache Storm的喷口抽象使集成新排队系统变得容易。同样，将Apache Storm与数据库系统集成很容易。</p>
               </div>
            </div>
            <div class="col-md-3">
                <div class="footer-widget">
                    <h5>第一眼</h5>
                    <ul class="footer-list">
                        <li><a href="/releases/current/Rationale.html">基本原理</a></li>
                        <li><a href="/releases/current/Tutorial.html">讲解</a></li>
                        <li><a href="/releases/current/Setting-up-development-environment.html">搭建开发环境</a></li>
                        <li><a href="/releases/current/Creating-a-new-Storm-project.html">创建一个新的Apache Storm项目</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-3">
                <div class="footer-widget">
                    <h5>文献资料</h5>
                    <ul class="footer-list">
                        <li><a href="/releases/current/index.html">指数</a></li>
                        <li><a href="/releases/current/javadocs/index.html">Java文档</a></li>
                        <li><a href="/releases/current/FAQ.html">常问问题</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <hr>
        <div class="row">   
            <div class="col-md-12">
                <p align="center">版权所有©2019 <a href="http://www.apache.org">Apache Software Foundation</a> 。版权所有。
                    <br>Apache Storm，Apache，Apache Feather徽标和Apache Storm项目徽标是The Apache Software Foundation的商标。
                    <br>提及的所有其他商标可能是其各自所有者的商标或注册商标。</p>
            </div>
        </div>
    </div>
</footer>
<!--Footer End-->
<!-- Scroll to top -->
<span class="totop"><a href="#"><i class="fa fa-angle-up"></i></a></span> 





</body></html>