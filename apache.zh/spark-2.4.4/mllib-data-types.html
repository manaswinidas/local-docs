<html class="no-js" ><!--<![endif]--><head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>数据类型-基于RDD的API-Spark 2.4.4文档</title>
        

        

        <link rel="stylesheet" href="css/bootstrap.min.css">
        <style>
            body {
                padding-top: 60px;
                padding-bottom: 40px;
            }
        </style>
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="css/bootstrap-responsive.min.css">
        <link rel="stylesheet" href="css/main.css">

        <script src="js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>

        <link rel="stylesheet" href="css/pygments-default.css">

        
        <!-- Google analytics script -->
        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-32518208-2']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        </script>
        

    </head>
    <body >
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="https://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <!-- This code is taken from http://twitter.github.com/bootstrap/examples/hero.html -->

        <div class="navbar navbar-fixed-top" id="topbar">
            <div class="navbar-inner">
                <div class="container">
                    <div class="brand"><a href="index.html"><img src="img/spark-logo-hd.png" style="height:50px"></a> <span class="version">2.4.4</span>
                    </div>
                    <ul class="nav">
                        <!--TODO(andyk): Add class="active" attribute to li some how.-->
                        <li><a href="index.html">总览</a></li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">编程指南<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="quick-start.html">快速开始</a></li>
                                <li><a href="rdd-programming-guide.html">RDD，累加器，广播变量</a></li>
                                <li><a href="sql-programming-guide.html">SQL，数据框和数据集</a></li>
                                <li><a href="structured-streaming-programming-guide.html">结构化流</a></li>
                                <li><a href="streaming-programming-guide.html">火花流（DStreams）</a></li>
                                <li><a href="ml-guide.html">MLlib（机器学习）</a></li>
                                <li><a href="graphx-programming-guide.html">GraphX（图形处理）</a></li>
                                <li><a href="sparkr.html">SparkR（Spark上的R）</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">API文件<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="api/scala/index.html#org.apache.spark.package">斯卡拉</a></li>
                                <li><a href="api/java/index.html">爪哇</a></li>
                                <li><a href="api/python/index.html">蟒蛇</a></li>
                                <li><a href="api/R/index.html">[R</a></li>
                                <li><a href="api/sql/index.html">SQL，内置函数</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">部署中<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="cluster-overview.html">总览</a></li>
                                <li><a href="submitting-applications.html">提交申请</a></li>
                                <li class="divider"></li>
                                <li><a href="spark-standalone.html">Spark独立</a></li>
                                <li><a href="running-on-mesos.html">梅索斯</a></li>
                                <li><a href="running-on-yarn.html">纱</a></li>
                                <li><a href="running-on-kubernetes.html">Kubernetes</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="api.html" class="dropdown-toggle" data-toggle="dropdown">更多<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="configuration.html">组态</a></li>
                                <li><a href="monitoring.html">监控方式</a></li>
                                <li><a href="tuning.html">调音指南</a></li>
                                <li><a href="job-scheduling.html">作业调度</a></li>
                                <li><a href="security.html">安全</a></li>
                                <li><a href="hardware-provisioning.html">硬件配置</a></li>
                                <li class="divider"></li>
                                <li><a href="building-spark.html">建筑火花</a></li>
                                <li><a href="https://spark.apache.org/contributing.html">为Spark贡献</a></li>
                                <li><a href="https://spark.apache.org/third-party-projects.html">第三方项目</a></li>
                            </ul>
                        </li>
                    </ul>
                    <!--<p class="navbar-text pull-right"><span class="version-text">v2.4.4</span></p>-->
                </div>
            </div>
        </div>

        <div class="container-wrapper">

            
                
                    <div class="left-menu-wrapper">
    <div class="left-menu">
        <h3><a href="ml-guide.html">MLlib：主要指南</a></h3>
        
<ul>

    <li>
        <a href="ml-statistics.html">基本统计</a>
    </li>
    
    

    <li>
        <a href="ml-datasource">数据源</a>
    </li>
    
    

    <li>
        <a href="ml-pipeline.html">流水线</a>
    </li>
    
    

    <li>
        <a href="ml-features.html">提取，转换和选择特征</a>
    </li>
    
    

    <li>
        <a href="ml-classification-regression.html">分类与回归</a>
    </li>
    
    

    <li>
        <a href="ml-clustering.html">聚类</a>
    </li>
    
    

    <li>
        <a href="ml-collaborative-filtering.html">协同过滤</a>
    </li>
    
    

    <li>
        <a href="ml-frequent-pattern-mining.html">频繁模式挖掘</a>
    </li>
    
    

    <li>
        <a href="ml-tuning.html">模型选择和调整</a>
    </li>
    
    

    <li>
        <a href="ml-advanced.html">进阶主题</a>
    </li>
    
    

</ul>

        <h3><a href="mllib-guide.html">MLlib：基于RDD的API指南</a></h3>
        
<ul>

    <li>
        <a href="mllib-data-types.html">
            
                <b>资料类型</b>
            
        </a>
    </li>
    
    

    <li>
        <a href="mllib-statistics.html">基本统计</a>
    </li>
    
    

    <li>
        <a href="mllib-classification-regression.html">分类与回归</a>
    </li>
    
    

    <li>
        <a href="mllib-collaborative-filtering.html">协同过滤</a>
    </li>
    
    

    <li>
        <a href="mllib-clustering.html">聚类</a>
    </li>
    
    

    <li>
        <a href="mllib-dimensionality-reduction.html">降维</a>
    </li>
    
    

    <li>
        <a href="mllib-feature-extraction.html">特征提取和转换</a>
    </li>
    
    

    <li>
        <a href="mllib-frequent-pattern-mining.html">频繁模式挖掘</a>
    </li>
    
    

    <li>
        <a href="mllib-evaluation-metrics.html">评估指标</a>
    </li>
    
    

    <li>
        <a href="mllib-pmml-model-export.html">PMML模型导出</a>
    </li>
    
    

    <li>
        <a href="mllib-optimization.html">优化（开发人员）</a>
    </li>
    
    

</ul>

    </div>
</div>
                
                <input id="nav-trigger" class="nav-trigger" type="checkbox" checked>
                <label for="nav-trigger"></label>
                <div class="content-with-sidebar" id="content">
                    
                        <h1 class="title">数据类型-基于RDD的API</h1>
                    

                    <ul id="markdown-toc">
  <li><a href="#local-vector" id="markdown-toc-local-vector">局部向量</a></li>
  <li><a href="#labeled-point" id="markdown-toc-labeled-point">标记点</a></li>
  <li><a href="#local-matrix" id="markdown-toc-local-matrix">局部矩阵</a></li>
  <li><a href="#distributed-matrix" id="markdown-toc-distributed-matrix">分布式矩阵</a>    <ul>
      <li><a href="#rowmatrix" id="markdown-toc-rowmatrix">行矩阵</a></li>
      <li><a href="#indexedrowmatrix" id="markdown-toc-indexedrowmatrix">IndexedRowMatrix</a></li>
      <li><a href="#coordinatematrix" id="markdown-toc-coordinatematrix">坐标矩阵</a></li>
      <li><a href="#blockmatrix" id="markdown-toc-blockmatrix">块矩阵</a></li>
    </ul>
  </li>
</ul>

<p>MLlib支持存储在一台计算机上的局部向量和矩阵，以及由一个或多个RDD支持的分布式矩阵。局部向量和局部矩阵是充当公共接口的简单数据模型。基本的线性代数运算由<a href="http://www.scalanlp.org/">Breeze</a>提供。监督学习中使用的训练示例在MLlib中称为“标记点”。</p>

<h2 id="local-vector">局部向量</h2>

<p>局部向量具有存储在单个计算机上的整数类型索引和基于0的索引以及双精度类型的值。MLlib支持两种类型的局部向量：密集和稀疏。密集向量由表示其输入值的双精度数组支持，而稀疏向量由两个并行数组支持：索引和值。例如，向量<code>(1.0, 0.0, 3.0)</code>可以用密集格式表示为<code>[1.0, 0.0, 3.0]</code>或稀疏格式为<code>(3, [0, 2], [1.0, 3.0])</code> ，在哪里<code>3</code>是向量的大小。</p>

<div class="codetabs">
<div data-lang="scala">

    <p>局部向量的基类是<a href="api/scala/index.html#org.apache.spark.mllib.linalg.Vector"><code>Vector</code></a> ，我们提供了两种实现： <a href="api/scala/index.html#org.apache.spark.mllib.linalg.DenseVector"><code>DenseVector</code></a>和<a href="api/scala/index.html#org.apache.spark.mllib.linalg.SparseVector"><code>SparseVector</code></a> 。我们建议使用在<a href="api/scala/index.html#org.apache.spark.mllib.linalg.Vectors$"><code>Vectors</code></a>创建局部向量。</p>

    <p>请参阅<a href="api/scala/index.html#org.apache.spark.mllib.linalg.Vector"><code>Vector</code> Scala文档</a>和<a href="api/scala/index.html#org.apache.spark.mllib.linalg.Vectors$"><code>Vectors</code></a>有关API的详细信息，请参见<a href="api/scala/index.html#org.apache.spark.mllib.linalg.Vectors$">Scala文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span></span><span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.</span><span class="o">{</span><span class="nc">Vector</span><span class="o">,</span> <span class="nc">Vectors</span><span class="o">}</span>

<span class="c1">// Create a dense vector (1.0, 0.0, 3.0).</span>
<span class="k">val</span> <span class="n">dv</span><span class="k">:</span> <span class="kt">Vector</span> <span class="o">=</span> <span class="nc">Vectors</span><span class="o">.</span><span class="n">dense</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">)</span>
<span class="c1">// Create a sparse vector (1.0, 0.0, 3.0) by specifying its indices and values corresponding to nonzero entries.</span>
<span class="k">val</span> <span class="n">sv1</span><span class="k">:</span> <span class="kt">Vector</span> <span class="o">=</span> <span class="nc">Vectors</span><span class="o">.</span><span class="n">sparse</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="nc">Array</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">))</span>
<span class="c1">// Create a sparse vector (1.0, 0.0, 3.0) by specifying its nonzero entries.</span>
<span class="k">val</span> <span class="n">sv2</span><span class="k">:</span> <span class="kt">Vector</span> <span class="o">=</span> <span class="nc">Vectors</span><span class="o">.</span><span class="n">sparse</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="nc">Seq</span><span class="o">((</span><span class="mi">0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">),</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">)))</span></code></pre></figure>

    <p><strong><em>注意：</em></strong> Scala进口<code>scala.collection.immutable.Vector</code>默认情况下，因此您必须导入<code>org.apache.spark.mllib.linalg.Vector</code>明确使用MLlib的<code>Vector</code> 。</p>

  </div>

<div data-lang="java">

    <p>局部向量的基类是<a href="api/java/org/apache/spark/mllib/linalg/Vector.html"><code>Vector</code></a> ，我们提供了两种实现： <a href="api/java/org/apache/spark/mllib/linalg/DenseVector.html"><code>DenseVector</code></a>和<a href="api/java/org/apache/spark/mllib/linalg/SparseVector.html"><code>SparseVector</code></a> 。我们建议使用在<a href="api/java/org/apache/spark/mllib/linalg/Vectors.html"><code>Vectors</code></a>创建局部向量。</p>

    <p>请参阅<a href="api/java/org/apache/spark/mllib/linalg/Vector.html"><code>Vector</code> Java文档</a>和<a href="api/java/org/apache/spark/mllib/linalg/Vectors.html"><code>Vectors</code></a>有关该API的详细信息的<a href="api/java/org/apache/spark/mllib/linalg/Vectors.html">Java文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.Vector</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.Vectors</span><span class="o">;</span>

<span class="c1">// Create a dense vector (1.0, 0.0, 3.0).</span>
<span class="n">Vector</span> <span class="n">dv</span> <span class="o">=</span> <span class="n">Vectors</span><span class="o">.</span><span class="na">dense</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">);</span>
<span class="c1">// Create a sparse vector (1.0, 0.0, 3.0) by specifying its indices and values corresponding to nonzero entries.</span>
<span class="n">Vector</span> <span class="n">sv</span> <span class="o">=</span> <span class="n">Vectors</span><span class="o">.</span><span class="na">sparse</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">},</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[]</span> <span class="o">{</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">});</span></code></pre></figure>

  </div>

<div data-lang="python">
    <p>MLlib将以下类型识别为密集向量：</p>

    <ul>
      <li>NumPy的<a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html"><code>array</code></a></li>
      <li>Python的清单，例如，<code>[1, 2, 3]</code></li>
    </ul>

    <p>以下是稀疏向量：</p>

    <ul>
      <li>MLlib的<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.SparseVector"><code>SparseVector</code></a> 。</li>
      <li>SciPy的<a href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csc_matrix.html#scipy.sparse.csc_matrix"><code>csc_matrix</code></a>单列</li>
    </ul>

    <p>我们建议在列表上使用NumPy数组以提高效率，并使用在中实现的工厂方法<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.Vectors"><code>Vectors</code></a>创建稀疏向量。</p>

    <p>请参阅<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.Vectors"><code>Vectors</code></a>有关该API的更多详细信息的<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.Vectors">Python文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.sparse</span> <span class="kn">as</span> <span class="nn">sps</span>
<span class="kn">from</span> <span class="nn">pyspark.mllib.linalg</span> <span class="kn">import</span> <span class="n">Vectors</span>

<span class="c1"># Use a NumPy array as a dense vector.</span>
<span class="n">dv1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="c1"># Use a Python list as a dense vector.</span>
<span class="n">dv2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]</span>
<span class="c1"># Create a SparseVector.</span>
<span class="n">sv1</span> <span class="o">=</span> <span class="n">Vectors</span><span class="o">.</span><span class="n">sparse</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="c1"># Use a single-column SciPy csc_matrix as a sparse vector.</span>
<span class="n">sv2</span> <span class="o">=</span> <span class="n">sps</span><span class="o">.</span><span class="n">csc_matrix</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span></code></pre></figure>

  </div>
</div>

<h2 id="labeled-point">标记点</h2>

<p>标记点是与标记/响应相关联的局部矢量（密集或稀疏）。在MLlib中，标记的点用于监督学习算法中。我们使用双精度来存储标签，因此我们可以在回归和分类中使用带标签的点。对于二进制分类，标签应为<code>0</code> （负）或<code>1</code> （正）。对于多类分类，标签应为从零开始的类索引： <code>0, 1, 2, ...</code> 。</p>

<div class="codetabs">

<div data-lang="scala">

    <p>标记点由案例类表示<a href="api/scala/index.html#org.apache.spark.mllib.regression.LabeledPoint"><code>LabeledPoint</code></a> 。</p>

    <p>请参阅<a href="api/scala/index.html#org.apache.spark.mllib.regression.LabeledPoint"><code>LabeledPoint</code></a>有关API的详细信息，请参见<a href="api/scala/index.html#org.apache.spark.mllib.regression.LabeledPoint">Scala文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span></span><span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.Vectors</span>
<span class="k">import</span> <span class="nn">org.apache.spark.mllib.regression.LabeledPoint</span>

<span class="c1">// Create a labeled point with a positive label and a dense feature vector.</span>
<span class="k">val</span> <span class="n">pos</span> <span class="k">=</span> <span class="nc">LabeledPoint</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="nc">Vectors</span><span class="o">.</span><span class="n">dense</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">))</span>

<span class="c1">// Create a labeled point with a negative label and a sparse feature vector.</span>
<span class="k">val</span> <span class="n">neg</span> <span class="k">=</span> <span class="nc">LabeledPoint</span><span class="o">(</span><span class="mf">0.0</span><span class="o">,</span> <span class="nc">Vectors</span><span class="o">.</span><span class="n">sparse</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="nc">Array</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">)))</span></code></pre></figure>

  </div>

<div data-lang="java">

    <p>标记的点由表示<a href="api/java/org/apache/spark/mllib/regression/LabeledPoint.html"><code>LabeledPoint</code></a> 。</p>

    <p>请参阅<a href="api/java/org/apache/spark/mllib/regression/LabeledPoint.html"><code>LabeledPoint</code></a>有关该API的详细信息的<a href="api/java/org/apache/spark/mllib/regression/LabeledPoint.html">Java文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.Vectors</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.regression.LabeledPoint</span><span class="o">;</span>

<span class="c1">// Create a labeled point with a positive label and a dense feature vector.</span>
<span class="n">LabeledPoint</span> <span class="n">pos</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LabeledPoint</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="n">Vectors</span><span class="o">.</span><span class="na">dense</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">));</span>

<span class="c1">// Create a labeled point with a negative label and a sparse feature vector.</span>
<span class="n">LabeledPoint</span> <span class="n">neg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LabeledPoint</span><span class="o">(</span><span class="mf">0.0</span><span class="o">,</span> <span class="n">Vectors</span><span class="o">.</span><span class="na">sparse</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">},</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[]</span> <span class="o">{</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">}));</span></code></pre></figure>

  </div>

<div data-lang="python">

    <p>标记的点由表示<a href="api/python/pyspark.mllib.html#pyspark.mllib.regression.LabeledPoint"><code>LabeledPoint</code></a> 。</p>

    <p>请参阅<a href="api/python/pyspark.mllib.html#pyspark.mllib.regression.LabeledPoint"><code>LabeledPoint</code></a>有关该API的更多详细信息的<a href="api/python/pyspark.mllib.html#pyspark.mllib.regression.LabeledPoint">Python文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="kn">from</span> <span class="nn">pyspark.mllib.linalg</span> <span class="kn">import</span> <span class="n">SparseVector</span>
<span class="kn">from</span> <span class="nn">pyspark.mllib.regression</span> <span class="kn">import</span> <span class="n">LabeledPoint</span>

<span class="c1"># Create a labeled point with a positive label and a dense feature vector.</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">LabeledPoint</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>

<span class="c1"># Create a labeled point with a negative label and a sparse feature vector.</span>
<span class="n">neg</span> <span class="o">=</span> <span class="n">LabeledPoint</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">SparseVector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span></code></pre></figure>

  </div>
</div>

<p><strong><em>稀疏数据</em></strong></p>

<p>在实践中，很少有训练数据。MLlib支持阅读存储在其中的培训示例<code>LIBSVM</code>格式，这是默认格式<a href="http://www.csie.ntu.edu.tw/~cjlin/libsvm/"><code>LIBSVM</code></a>和<a href="http://www.csie.ntu.edu.tw/~cjlin/liblinear/"><code>LIBLINEAR</code></a> 。它是一种文本格式，其中每行使用以下格式表示标记的稀疏特征向量：</p>

<pre><code>label index1:value1 index2:value2 ...
</code></pre>

<p>索引是从一开始并按升序排列的。加载后，要素索引将转换为基于零的索引。</p>

<div class="codetabs">
<div data-lang="scala">

    <p><a href="api/scala/index.html#org.apache.spark.mllib.util.MLUtils$"><code>MLUtils.loadLibSVMFile</code></a>阅读以LIBSVM格式存储的培训示例。</p>

    <p>请参阅<a href="api/scala/index.html#org.apache.spark.mllib.util.MLUtils$"><code>MLUtils</code></a>有关API的详细信息，请参见<a href="api/scala/index.html#org.apache.spark.mllib.util.MLUtils$">Scala文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span></span><span class="k">import</span> <span class="nn">org.apache.spark.mllib.regression.LabeledPoint</span>
<span class="k">import</span> <span class="nn">org.apache.spark.mllib.util.MLUtils</span>
<span class="k">import</span> <span class="nn">org.apache.spark.rdd.RDD</span>

<span class="k">val</span> <span class="n">examples</span><span class="k">:</span> <span class="kt">RDD</span><span class="o">[</span><span class="kt">LabeledPoint</span><span class="o">]</span> <span class="k">=</span> <span class="nc">MLUtils</span><span class="o">.</span><span class="n">loadLibSVMFile</span><span class="o">(</span><span class="n">sc</span><span class="o">,</span> <span class="s">&quot;data/mllib/sample_libsvm_data.txt&quot;</span><span class="o">)</span></code></pre></figure>

  </div>

<div data-lang="java">
    <p><a href="api/java/org/apache/spark/mllib/util/MLUtils.html"><code>MLUtils.loadLibSVMFile</code></a>阅读以LIBSVM格式存储的培训示例。</p>

    <p>请参阅<a href="api/java/org/apache/spark/mllib/util/MLUtils.html"><code>MLUtils</code></a>有关该API的详细信息的<a href="api/java/org/apache/spark/mllib/util/MLUtils.html">Java文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.mllib.regression.LabeledPoint</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.util.MLUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.api.java.JavaRDD</span><span class="o">;</span>

<span class="n">JavaRDD</span><span class="o">&lt;</span><span class="n">LabeledPoint</span><span class="o">&gt;</span> <span class="n">examples</span> <span class="o">=</span> 
  <span class="n">MLUtils</span><span class="o">.</span><span class="na">loadLibSVMFile</span><span class="o">(</span><span class="n">jsc</span><span class="o">.</span><span class="na">sc</span><span class="o">(),</span> <span class="s">&quot;data/mllib/sample_libsvm_data.txt&quot;</span><span class="o">).</span><span class="na">toJavaRDD</span><span class="o">();</span></code></pre></figure>

  </div>

<div data-lang="python">
    <p><a href="api/python/pyspark.mllib.html#pyspark.mllib.util.MLUtils"><code>MLUtils.loadLibSVMFile</code></a>阅读以LIBSVM格式存储的培训示例。</p>

    <p>请参阅<a href="api/python/pyspark.mllib.html#pyspark.mllib.util.MLUtils"><code>MLUtils</code></a>有关该API的更多详细信息的<a href="api/python/pyspark.mllib.html#pyspark.mllib.util.MLUtils">Python文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="kn">from</span> <span class="nn">pyspark.mllib.util</span> <span class="kn">import</span> <span class="n">MLUtils</span>

<span class="n">examples</span> <span class="o">=</span> <span class="n">MLUtils</span><span class="o">.</span><span class="n">loadLibSVMFile</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="s2">&quot;data/mllib/sample_libsvm_data.txt&quot;</span><span class="p">)</span></code></pre></figure>

  </div>
</div>

<h2 id="local-matrix">局部矩阵</h2>

<p>局部矩阵具有整数类型的行和列索引以及双重类型的值，它们存储在单个计算机上。MLlib支持密集矩阵（其条目值以列优先顺序存储在单个double数组中）和稀疏矩阵（其非零条目值）以压缩列稀疏列（CSC）格式以列优先顺序存储。例如，下面的密集矩阵<code>\[ \begin{pmatrix} 1.0 & 2.0 \\ 3.0 & 4.0 \\ 5.0 & 6.0 \end{pmatrix} \]</code>存储在一维数组中<code>[1.0, 3.0, 5.0, 2.0, 4.0, 6.0]</code>与矩阵大小<code>(3, 2)</code> 。</p>

<div class="codetabs">
<div data-lang="scala">

    <p>本地矩阵的基类是<a href="api/scala/index.html#org.apache.spark.mllib.linalg.Matrix"><code>Matrix</code></a> ，我们提供了两种实现： <a href="api/scala/index.html#org.apache.spark.mllib.linalg.DenseMatrix"><code>DenseMatrix</code></a>和<a href="api/scala/index.html#org.apache.spark.mllib.linalg.SparseMatrix"><code>SparseMatrix</code></a> 。我们建议使用在<a href="api/scala/index.html#org.apache.spark.mllib.linalg.Matrices$"><code>Matrices</code></a>创建本地矩阵。请记住，MLlib中的本地矩阵以列优先顺序存储。</p>

    <p>请参阅<a href="api/scala/index.html#org.apache.spark.mllib.linalg.Matrix"><code>Matrix</code> Scala文档</a>和<a href="api/scala/index.html#org.apache.spark.mllib.linalg.Matrices$"><code>Matrices</code></a>有关API的详细信息，请参见<a href="api/scala/index.html#org.apache.spark.mllib.linalg.Matrices$">Scala文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span></span><span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.</span><span class="o">{</span><span class="nc">Matrix</span><span class="o">,</span> <span class="nc">Matrices</span><span class="o">}</span>

<span class="c1">// Create a dense matrix ((1.0, 2.0), (3.0, 4.0), (5.0, 6.0))</span>
<span class="k">val</span> <span class="n">dm</span><span class="k">:</span> <span class="kt">Matrix</span> <span class="o">=</span> <span class="nc">Matrices</span><span class="o">.</span><span class="n">dense</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="nc">Array</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">,</span> <span class="mf">5.0</span><span class="o">,</span> <span class="mf">2.0</span><span class="o">,</span> <span class="mf">4.0</span><span class="o">,</span> <span class="mf">6.0</span><span class="o">))</span>

<span class="c1">// Create a sparse matrix ((9.0, 0.0), (0.0, 8.0), (0.0, 6.0))</span>
<span class="k">val</span> <span class="n">sm</span><span class="k">:</span> <span class="kt">Matrix</span> <span class="o">=</span> <span class="nc">Matrices</span><span class="o">.</span><span class="n">sparse</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">),</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">),</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">9</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">8</span><span class="o">))</span></code></pre></figure>

  </div>

<div data-lang="java">

    <p>本地矩阵的基类是<a href="api/java/org/apache/spark/mllib/linalg/Matrix.html"><code>Matrix</code></a> ，我们提供了两种实现： <a href="api/java/org/apache/spark/mllib/linalg/DenseMatrix.html"><code>DenseMatrix</code></a>和<a href="api/java/org/apache/spark/mllib/linalg/SparseMatrix.html"><code>SparseMatrix</code></a> 。我们建议使用在<a href="api/java/org/apache/spark/mllib/linalg/Matrices.html"><code>Matrices</code></a>创建本地矩阵。请记住，MLlib中的本地矩阵以列优先顺序存储。</p>

    <p>请参阅<a href="api/java/org/apache/spark/mllib/linalg/Matrix.html"><code>Matrix</code> Java文档</a>和<a href="api/java/org/apache/spark/mllib/linalg/Matrices.html"><code>Matrices</code></a>有关该API的详细信息的<a href="api/java/org/apache/spark/mllib/linalg/Matrices.html">Java文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.Matrix</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.Matrices</span><span class="o">;</span>

<span class="c1">// Create a dense matrix ((1.0, 2.0), (3.0, 4.0), (5.0, 6.0))</span>
<span class="n">Matrix</span> <span class="n">dm</span> <span class="o">=</span> <span class="n">Matrices</span><span class="o">.</span><span class="na">dense</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[]</span> <span class="o">{</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">3.0</span><span class="o">,</span> <span class="mf">5.0</span><span class="o">,</span> <span class="mf">2.0</span><span class="o">,</span> <span class="mf">4.0</span><span class="o">,</span> <span class="mf">6.0</span><span class="o">});</span>

<span class="c1">// Create a sparse matrix ((9.0, 0.0), (0.0, 8.0), (0.0, 6.0))</span>
<span class="n">Matrix</span> <span class="n">sm</span> <span class="o">=</span> <span class="n">Matrices</span><span class="o">.</span><span class="na">sparse</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">},</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">},</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[]</span> <span class="o">{</span><span class="mi">9</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">8</span><span class="o">});</span></code></pre></figure>

  </div>

<div data-lang="python">

    <p>本地矩阵的基类是<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.Matrix"><code>Matrix</code></a> ，我们提供了两种实现： <a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.DenseMatrix"><code>DenseMatrix</code></a>和<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.SparseMatrix"><code>SparseMatrix</code></a> 。我们建议使用在<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.Matrices"><code>Matrices</code></a>创建本地矩阵。请记住，MLlib中的本地矩阵以列优先顺序存储。</p>

    <p>请参阅<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.Matrix"><code>Matrix</code> Python文档</a>和<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.Matrices"><code>Matrices</code></a>有关该API的更多详细信息的<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.Matrices">Python文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="kn">from</span> <span class="nn">pyspark.mllib.linalg</span> <span class="kn">import</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">Matrices</span>

<span class="c1"># Create a dense matrix ((1.0, 2.0), (3.0, 4.0), (5.0, 6.0))</span>
<span class="n">dm2</span> <span class="o">=</span> <span class="n">Matrices</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="c1"># Create a sparse matrix ((9.0, 0.0), (0.0, 8.0), (0.0, 6.0))</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">Matrices</span><span class="o">.</span><span class="n">sparse</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span></code></pre></figure>

  </div>

</div>

<h2 id="distributed-matrix">分布式矩阵</h2>

<p>分布式矩阵具有长型行和列索引以及双型值，这些值分布式存储在一个或多个RDD中。选择正确的格式来存储大型和分布式矩阵非常重要。将分布式矩阵转换为其他格式可能需要全局改组，这非常昂贵。到目前为止，已经实现了四种类型的分布式矩阵。</p>

<p>基本类型称为<code>RowMatrix</code> 。一种<code>RowMatrix</code>是没有有意义的行索引（例如特征向量的集合）的面向行的分布式矩阵。它由其行的RDD支持，其中每一行都是本地向量。我们假设列数对于一个<code>RowMatrix</code>这样就可以将单个本地向量合理地传达给驱动程序，也可以使用单个节点对其进行存储/操作。一个<code>IndexedRowMatrix</code>类似于<code>RowMatrix</code>但具有行索引，可用于标识行和执行联接。一种<code>CoordinateMatrix</code>是以<a href="https://en.wikipedia.org/wiki/Sparse_matrix#Coordinate_list_.28COO.29">坐标列表（COO）</a>格式存储的分布式矩阵，由其条目的RDD支持。一种<code>BlockMatrix</code>是由RDD支持的分布式矩阵<code>MatrixBlock</code>这是一个元组<code>(Int, Int, Matrix)</code> 。</p>

<p><strong><em>注意</em></strong></p>

<p>分布式矩阵的基础RDD必须是确定性的，因为我们缓存了矩阵的大小。通常，使用不确定的RDD可能会导致错误。</p>

<h3 id="rowmatrix">行矩阵</h3>

<p>一种<code>RowMatrix</code>是一个没有意义的行索引的面向行的分布式矩阵，由其行的RDD支持，其中每行都是局部向量。由于每一行都由局部向量表示，因此列数受到整数范围的限制，但实际上它应该小得多。</p>

<div class="codetabs">
<div data-lang="scala">

    <p>一种<a href="api/scala/index.html#org.apache.spark.mllib.linalg.distributed.RowMatrix"><code>RowMatrix</code></a>可以从<code>RDD[Vector]</code>实例。然后，我们可以计算其列摘要统计信息和分解。
<a href="https://en.wikipedia.org/wiki/QR_decomposition">QR分解</a>的形式为A = QR，其中Q为正交矩阵，R为上三角矩阵。有关<a href="https://en.wikipedia.org/wiki/Singular_value_decomposition">奇异值分解（SVD）</a>和<a href="https://en.wikipedia.org/wiki/Principal_component_analysis">主成分分析（PCA）</a> ，请参阅<a href="mllib-dimensionality-reduction.html">降维</a> 。</p>

    <p>请参阅<a href="api/scala/index.html#org.apache.spark.mllib.linalg.distributed.RowMatrix"><code>RowMatrix</code></a>有关API的详细信息，请参见<a href="api/scala/index.html#org.apache.spark.mllib.linalg.distributed.RowMatrix">Scala文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span></span><span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.Vector</span>
<span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.RowMatrix</span>

<span class="k">val</span> <span class="n">rows</span><span class="k">:</span> <span class="kt">RDD</span><span class="o">[</span><span class="kt">Vector</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span> <span class="c1">// an RDD of local vectors</span>
<span class="c1">// Create a RowMatrix from an RDD[Vector].</span>
<span class="k">val</span> <span class="n">mat</span><span class="k">:</span> <span class="kt">RowMatrix</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RowMatrix</span><span class="o">(</span><span class="n">rows</span><span class="o">)</span>

<span class="c1">// Get its size.</span>
<span class="k">val</span> <span class="n">m</span> <span class="k">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">numRows</span><span class="o">()</span>
<span class="k">val</span> <span class="n">n</span> <span class="k">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">numCols</span><span class="o">()</span>

<span class="c1">// QR decomposition </span>
<span class="k">val</span> <span class="n">qrResult</span> <span class="k">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">tallSkinnyQR</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span></code></pre></figure>

  </div>

<div data-lang="java">

    <p>一种<a href="api/java/org/apache/spark/mllib/linalg/distributed/RowMatrix.html"><code>RowMatrix</code></a>可以从<code>JavaRDD<Vector></code>实例。然后，我们可以计算其列摘要统计信息。</p>

    <p>请参阅<a href="api/java/org/apache/spark/mllib/linalg/distributed/RowMatrix.html"><code>RowMatrix</code></a>有关该API的详细信息的<a href="api/java/org/apache/spark/mllib/linalg/distributed/RowMatrix.html">Java文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.api.java.JavaRDD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.Vector</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.RowMatrix</span><span class="o">;</span>

<span class="n">JavaRDD</span><span class="o">&lt;</span><span class="n">Vector</span><span class="o">&gt;</span> <span class="n">rows</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// a JavaRDD of local vectors</span>
<span class="c1">// Create a RowMatrix from an JavaRDD&lt;Vector&gt;.</span>
<span class="n">RowMatrix</span> <span class="n">mat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RowMatrix</span><span class="o">(</span><span class="n">rows</span><span class="o">.</span><span class="na">rdd</span><span class="o">());</span>

<span class="c1">// Get its size.</span>
<span class="kt">long</span> <span class="n">m</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">numRows</span><span class="o">();</span>
<span class="kt">long</span> <span class="n">n</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">numCols</span><span class="o">();</span>

<span class="c1">// QR decomposition </span>
<span class="n">QRDecomposition</span><span class="o">&lt;</span><span class="n">RowMatrix</span><span class="o">,</span> <span class="n">Matrix</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">tallSkinnyQR</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span></code></pre></figure>

  </div>

<div data-lang="python">

    <p>一种<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.distributed.RowMatrix"><code>RowMatrix</code></a>可以从<code>RDD</code>向量。</p>

    <p>请参阅<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.distributed.RowMatrix"><code>RowMatrix</code></a>有关该API的更多详细信息的<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.distributed.RowMatrix">Python文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="kn">from</span> <span class="nn">pyspark.mllib.linalg.distributed</span> <span class="kn">import</span> <span class="n">RowMatrix</span>

<span class="c1"># Create an RDD of vectors.</span>
<span class="n">rows</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]])</span>

<span class="c1"># Create a RowMatrix from an RDD of vectors.</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">RowMatrix</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

<span class="c1"># Get its size.</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">numRows</span><span class="p">()</span>  <span class="c1"># 4</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">numCols</span><span class="p">()</span>  <span class="c1"># 3</span>

<span class="c1"># Get the rows as an RDD of vectors again.</span>
<span class="n">rowsRDD</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">rows</span></code></pre></figure>

  </div>

</div>

<h3 id="indexedrowmatrix">IndexedRowMatrix</h3>

<p>一个<code>IndexedRowMatrix</code>类似于<code>RowMatrix</code>但具有有意义的行索引。它由索引行的RDD支持，因此每一行都由其索引（长型）和局部向量表示。</p>

<div class="codetabs">
<div data-lang="scala">

    <p>一个<a href="api/scala/index.html#org.apache.spark.mllib.linalg.distributed.IndexedRowMatrix"><code>IndexedRowMatrix</code></a>可以从<code>RDD[IndexedRow]</code>例如<a href="api/scala/index.html#org.apache.spark.mllib.linalg.distributed.IndexedRow"><code>IndexedRow</code></a>是一个包装<code>(Long, Vector)</code> 。一个<code>IndexedRowMatrix</code>可以转换为<code>RowMatrix</code>通过删除其行索引。</p>

    <p>请参阅<a href="api/scala/index.html#org.apache.spark.mllib.linalg.distributed.IndexedRowMatrix"><code>IndexedRowMatrix</code></a>有关API的详细信息，请参见<a href="api/scala/index.html#org.apache.spark.mllib.linalg.distributed.IndexedRowMatrix">Scala文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span></span><span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.</span><span class="o">{</span><span class="nc">IndexedRow</span><span class="o">,</span> <span class="nc">IndexedRowMatrix</span><span class="o">,</span> <span class="nc">RowMatrix</span><span class="o">}</span>

<span class="k">val</span> <span class="n">rows</span><span class="k">:</span> <span class="kt">RDD</span><span class="o">[</span><span class="kt">IndexedRow</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span> <span class="c1">// an RDD of indexed rows</span>
<span class="c1">// Create an IndexedRowMatrix from an RDD[IndexedRow].</span>
<span class="k">val</span> <span class="n">mat</span><span class="k">:</span> <span class="kt">IndexedRowMatrix</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IndexedRowMatrix</span><span class="o">(</span><span class="n">rows</span><span class="o">)</span>

<span class="c1">// Get its size.</span>
<span class="k">val</span> <span class="n">m</span> <span class="k">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">numRows</span><span class="o">()</span>
<span class="k">val</span> <span class="n">n</span> <span class="k">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">numCols</span><span class="o">()</span>

<span class="c1">// Drop its row indices.</span>
<span class="k">val</span> <span class="n">rowMat</span><span class="k">:</span> <span class="kt">RowMatrix</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">toRowMatrix</span><span class="o">()</span></code></pre></figure>

  </div>

<div data-lang="java">

    <p>一个<a href="api/java/org/apache/spark/mllib/linalg/distributed/IndexedRowMatrix.html"><code>IndexedRowMatrix</code></a>可以从<code>JavaRDD<IndexedRow></code>例如<a href="api/java/org/apache/spark/mllib/linalg/distributed/IndexedRow.html"><code>IndexedRow</code></a>是一个包装<code>(long, Vector)</code> 。一个<code>IndexedRowMatrix</code>可以转换为<code>RowMatrix</code>通过删除其行索引。</p>

    <p>请参阅<a href="api/java/org/apache/spark/mllib/linalg/distributed/IndexedRowMatrix.html"><code>IndexedRowMatrix</code></a>有关该API的详细信息的<a href="api/java/org/apache/spark/mllib/linalg/distributed/IndexedRowMatrix.html">Java文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.api.java.JavaRDD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.IndexedRow</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.IndexedRowMatrix</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.RowMatrix</span><span class="o">;</span>

<span class="n">JavaRDD</span><span class="o">&lt;</span><span class="n">IndexedRow</span><span class="o">&gt;</span> <span class="n">rows</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// a JavaRDD of indexed rows</span>
<span class="c1">// Create an IndexedRowMatrix from a JavaRDD&lt;IndexedRow&gt;.</span>
<span class="n">IndexedRowMatrix</span> <span class="n">mat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IndexedRowMatrix</span><span class="o">(</span><span class="n">rows</span><span class="o">.</span><span class="na">rdd</span><span class="o">());</span>

<span class="c1">// Get its size.</span>
<span class="kt">long</span> <span class="n">m</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">numRows</span><span class="o">();</span>
<span class="kt">long</span> <span class="n">n</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">numCols</span><span class="o">();</span>

<span class="c1">// Drop its row indices.</span>
<span class="n">RowMatrix</span> <span class="n">rowMat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">toRowMatrix</span><span class="o">();</span></code></pre></figure>

  </div>

<div data-lang="python">

    <p>一个<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.distributed.IndexedRowMatrix"><code>IndexedRowMatrix</code></a>可以从<code>RDD</code>的<code>IndexedRow</code> s，在哪里<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.distributed.IndexedRow"><code>IndexedRow</code></a>是一个包装<code>(long, vector)</code> 。一个<code>IndexedRowMatrix</code>可以转换为<code>RowMatrix</code>通过删除其行索引。</p>

    <p>请参阅<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.distributed.IndexedRowMatrix"><code>IndexedRowMatrix</code></a>有关该API的更多详细信息的<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.distributed.IndexedRowMatrix">Python文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="kn">from</span> <span class="nn">pyspark.mllib.linalg.distributed</span> <span class="kn">import</span> <span class="n">IndexedRow</span><span class="p">,</span> <span class="n">IndexedRowMatrix</span>

<span class="c1"># Create an RDD of indexed rows.</span>
<span class="c1">#   - This can be done explicitly with the IndexedRow class:</span>
<span class="n">indexedRows</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="n">IndexedRow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
                              <span class="n">IndexedRow</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span>
                              <span class="n">IndexedRow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span>
                              <span class="n">IndexedRow</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">])])</span>
<span class="c1">#   - or by using (long, vector) tuples:</span>
<span class="n">indexedRows</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span>
                              <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">])])</span>

<span class="c1"># Create an IndexedRowMatrix from an RDD of IndexedRows.</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">IndexedRowMatrix</span><span class="p">(</span><span class="n">indexedRows</span><span class="p">)</span>

<span class="c1"># Get its size.</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">numRows</span><span class="p">()</span>  <span class="c1"># 4</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">numCols</span><span class="p">()</span>  <span class="c1"># 3</span>

<span class="c1"># Get the rows as an RDD of IndexedRows.</span>
<span class="n">rowsRDD</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">rows</span>

<span class="c1"># Convert to a RowMatrix by dropping the row indices.</span>
<span class="n">rowMat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">toRowMatrix</span><span class="p">()</span></code></pre></figure>

  </div>

</div>

<h3 id="coordinatematrix">坐标矩阵</h3>

<p>一种<code>CoordinateMatrix</code>是由其条目的RDD支持的分布式矩阵。每个条目都是一个元组<code>(i: Long, j: Long, value: Double)</code> ，在哪里<code>i</code>是行索引， <code>j</code>是列索引，并且<code>value</code>是输入值。一种<code>CoordinateMatrix</code>仅当矩阵的两个维度都很大且矩阵非常稀疏时才应使用。</p>

<div class="codetabs">
<div data-lang="scala">

    <p>一种<a href="api/scala/index.html#org.apache.spark.mllib.linalg.distributed.CoordinateMatrix"><code>CoordinateMatrix</code></a>可以从<code>RDD[MatrixEntry]</code>例如<a href="api/scala/index.html#org.apache.spark.mllib.linalg.distributed.MatrixEntry"><code>MatrixEntry</code></a>是一个包装<code>(Long, Long, Double)</code> 。一种<code>CoordinateMatrix</code>可以转换成<code>IndexedRowMatrix</code>通过调用稀疏行<code>toIndexedRowMatrix</code> 。其他计算<code>CoordinateMatrix</code>目前不支持。</p>

    <p>请参阅<a href="api/scala/index.html#org.apache.spark.mllib.linalg.distributed.CoordinateMatrix"><code>CoordinateMatrix</code></a>有关API的详细信息，请参见<a href="api/scala/index.html#org.apache.spark.mllib.linalg.distributed.CoordinateMatrix">Scala文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span></span><span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.</span><span class="o">{</span><span class="nc">CoordinateMatrix</span><span class="o">,</span> <span class="nc">MatrixEntry</span><span class="o">}</span>

<span class="k">val</span> <span class="n">entries</span><span class="k">:</span> <span class="kt">RDD</span><span class="o">[</span><span class="kt">MatrixEntry</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span> <span class="c1">// an RDD of matrix entries</span>
<span class="c1">// Create a CoordinateMatrix from an RDD[MatrixEntry].</span>
<span class="k">val</span> <span class="n">mat</span><span class="k">:</span> <span class="kt">CoordinateMatrix</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CoordinateMatrix</span><span class="o">(</span><span class="n">entries</span><span class="o">)</span>

<span class="c1">// Get its size.</span>
<span class="k">val</span> <span class="n">m</span> <span class="k">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">numRows</span><span class="o">()</span>
<span class="k">val</span> <span class="n">n</span> <span class="k">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">numCols</span><span class="o">()</span>

<span class="c1">// Convert it to an IndexRowMatrix whose rows are sparse vectors.</span>
<span class="k">val</span> <span class="n">indexedRowMatrix</span> <span class="k">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">toIndexedRowMatrix</span><span class="o">()</span></code></pre></figure>

  </div>

<div data-lang="java">

    <p>一种<a href="api/java/org/apache/spark/mllib/linalg/distributed/CoordinateMatrix.html"><code>CoordinateMatrix</code></a>可以从<code>JavaRDD<MatrixEntry></code>例如<a href="api/java/org/apache/spark/mllib/linalg/distributed/MatrixEntry.html"><code>MatrixEntry</code></a>是一个包装<code>(long, long, double)</code> 。一种<code>CoordinateMatrix</code>可以转换成<code>IndexedRowMatrix</code>通过调用稀疏行<code>toIndexedRowMatrix</code> 。其他计算<code>CoordinateMatrix</code>目前不支持。</p>

    <p>请参阅<a href="api/java/org/apache/spark/mllib/linalg/distributed/CoordinateMatrix.html"><code>CoordinateMatrix</code></a>有关该API的详细信息的<a href="api/java/org/apache/spark/mllib/linalg/distributed/CoordinateMatrix.html">Java文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.api.java.JavaRDD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.CoordinateMatrix</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.IndexedRowMatrix</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.MatrixEntry</span><span class="o">;</span>

<span class="n">JavaRDD</span><span class="o">&lt;</span><span class="n">MatrixEntry</span><span class="o">&gt;</span> <span class="n">entries</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// a JavaRDD of matrix entries</span>
<span class="c1">// Create a CoordinateMatrix from a JavaRDD&lt;MatrixEntry&gt;.</span>
<span class="n">CoordinateMatrix</span> <span class="n">mat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CoordinateMatrix</span><span class="o">(</span><span class="n">entries</span><span class="o">.</span><span class="na">rdd</span><span class="o">());</span>

<span class="c1">// Get its size.</span>
<span class="kt">long</span> <span class="n">m</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">numRows</span><span class="o">();</span>
<span class="kt">long</span> <span class="n">n</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">numCols</span><span class="o">();</span>

<span class="c1">// Convert it to an IndexRowMatrix whose rows are sparse vectors.</span>
<span class="n">IndexedRowMatrix</span> <span class="n">indexedRowMatrix</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="na">toIndexedRowMatrix</span><span class="o">();</span></code></pre></figure>

  </div>

<div data-lang="python">

    <p>一种<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.distributed.CoordinateMatrix"><code>CoordinateMatrix</code></a>可以从<code>RDD</code>的<code>MatrixEntry</code>条目，其中<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.distributed.MatrixEntry"><code>MatrixEntry</code></a>是一个包装<code>(long, long, float)</code> 。一种<code>CoordinateMatrix</code>可以转换为<code>RowMatrix</code>通过打电话<code>toRowMatrix</code> ，或<code>IndexedRowMatrix</code>通过调用稀疏行<code>toIndexedRowMatrix</code> 。</p>

    <p>请参阅<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.distributed.CoordinateMatrix"><code>CoordinateMatrix</code></a>有关该API的更多详细信息的<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.distributed.CoordinateMatrix">Python文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="kn">from</span> <span class="nn">pyspark.mllib.linalg.distributed</span> <span class="kn">import</span> <span class="n">CoordinateMatrix</span><span class="p">,</span> <span class="n">MatrixEntry</span>

<span class="c1"># Create an RDD of coordinate entries.</span>
<span class="c1">#   - This can be done explicitly with the MatrixEntry class:</span>
<span class="n">entries</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="n">MatrixEntry</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="n">MatrixEntry</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">),</span> <span class="n">MatrixEntry</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">3.7</span><span class="p">)])</span>
<span class="c1">#   - or using (long, long, float) tuples:</span>
<span class="n">entries</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">3.7</span><span class="p">)])</span>

<span class="c1"># Create an CoordinateMatrix from an RDD of MatrixEntries.</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">CoordinateMatrix</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>

<span class="c1"># Get its size.</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">numRows</span><span class="p">()</span>  <span class="c1"># 3</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">numCols</span><span class="p">()</span>  <span class="c1"># 2</span>

<span class="c1"># Get the entries as an RDD of MatrixEntries.</span>
<span class="n">entriesRDD</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">entries</span>

<span class="c1"># Convert to a RowMatrix.</span>
<span class="n">rowMat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">toRowMatrix</span><span class="p">()</span>

<span class="c1"># Convert to an IndexedRowMatrix.</span>
<span class="n">indexedRowMat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">toIndexedRowMatrix</span><span class="p">()</span>

<span class="c1"># Convert to a BlockMatrix.</span>
<span class="n">blockMat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">toBlockMatrix</span><span class="p">()</span></code></pre></figure>

  </div>

</div>

<h3 id="blockmatrix">块矩阵</h3>

<p>一种<code>BlockMatrix</code>是由RDD支持的分布式矩阵<code>MatrixBlock</code> s，其中<code>MatrixBlock</code>是的元组<code>((Int, Int), Matrix)</code> ，其中<code>(Int, Int)</code>是块的索引，并且<code>Matrix</code>是给定索引处的子矩阵的大小<code>rowsPerBlock</code> X <code>colsPerBlock</code> 。
<code>BlockMatrix</code>支持诸如<code>add</code>和<code>multiply</code>和另外一个<code>BlockMatrix</code> 。
<code>BlockMatrix</code>还具有辅助功能<code>validate</code>可以用来检查<code>BlockMatrix</code>设置正确。</p>

<div class="codetabs">
<div data-lang="scala">

    <p>一种<a href="api/scala/index.html#org.apache.spark.mllib.linalg.distributed.BlockMatrix"><code>BlockMatrix</code></a>可以很容易地从<code>IndexedRowMatrix</code>要么<code>CoordinateMatrix</code>通过打电话<code>toBlockMatrix</code> 。
<code>toBlockMatrix</code>默认情况下创建大小为1024 x 1024的块。用户可以通过以下方式提供值来更改块大小： <code>toBlockMatrix(rowsPerBlock, colsPerBlock)</code> 。</p>

    <p>请参阅<a href="api/scala/index.html#org.apache.spark.mllib.linalg.distributed.BlockMatrix"><code>BlockMatrix</code></a>有关API的详细信息，请参见<a href="api/scala/index.html#org.apache.spark.mllib.linalg.distributed.BlockMatrix">Scala文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span></span><span class="k">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.</span><span class="o">{</span><span class="nc">BlockMatrix</span><span class="o">,</span> <span class="nc">CoordinateMatrix</span><span class="o">,</span> <span class="nc">MatrixEntry</span><span class="o">}</span>

<span class="k">val</span> <span class="n">entries</span><span class="k">:</span> <span class="kt">RDD</span><span class="o">[</span><span class="kt">MatrixEntry</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span> <span class="c1">// an RDD of (i, j, v) matrix entries</span>
<span class="c1">// Create a CoordinateMatrix from an RDD[MatrixEntry].</span>
<span class="k">val</span> <span class="n">coordMat</span><span class="k">:</span> <span class="kt">CoordinateMatrix</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CoordinateMatrix</span><span class="o">(</span><span class="n">entries</span><span class="o">)</span>
<span class="c1">// Transform the CoordinateMatrix to a BlockMatrix</span>
<span class="k">val</span> <span class="n">matA</span><span class="k">:</span> <span class="kt">BlockMatrix</span> <span class="o">=</span> <span class="n">coordMat</span><span class="o">.</span><span class="n">toBlockMatrix</span><span class="o">().</span><span class="n">cache</span><span class="o">()</span>

<span class="c1">// Validate whether the BlockMatrix is set up properly. Throws an Exception when it is not valid.</span>
<span class="c1">// Nothing happens if it is valid.</span>
<span class="n">matA</span><span class="o">.</span><span class="n">validate</span><span class="o">()</span>

<span class="c1">// Calculate A^T A.</span>
<span class="k">val</span> <span class="n">ata</span> <span class="k">=</span> <span class="n">matA</span><span class="o">.</span><span class="n">transpose</span><span class="o">.</span><span class="n">multiply</span><span class="o">(</span><span class="n">matA</span><span class="o">)</span></code></pre></figure>

  </div>

<div data-lang="java">

    <p>一种<a href="api/java/org/apache/spark/mllib/linalg/distributed/BlockMatrix.html"><code>BlockMatrix</code></a>可以很容易地从<code>IndexedRowMatrix</code>要么<code>CoordinateMatrix</code>通过打电话<code>toBlockMatrix</code> 。
<code>toBlockMatrix</code>默认情况下创建大小为1024 x 1024的块。用户可以通过以下方式提供值来更改块大小： <code>toBlockMatrix(rowsPerBlock, colsPerBlock)</code> 。</p>

    <p>请参阅<a href="api/java/org/apache/spark/mllib/linalg/distributed/BlockMatrix.html"><code>BlockMatrix</code></a>有关该API的详细信息的<a href="api/java/org/apache/spark/mllib/linalg/distributed/BlockMatrix.html">Java文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.api.java.JavaRDD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.BlockMatrix</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.CoordinateMatrix</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.spark.mllib.linalg.distributed.IndexedRowMatrix</span><span class="o">;</span>

<span class="n">JavaRDD</span><span class="o">&lt;</span><span class="n">MatrixEntry</span><span class="o">&gt;</span> <span class="n">entries</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// a JavaRDD of (i, j, v) Matrix Entries</span>
<span class="c1">// Create a CoordinateMatrix from a JavaRDD&lt;MatrixEntry&gt;.</span>
<span class="n">CoordinateMatrix</span> <span class="n">coordMat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CoordinateMatrix</span><span class="o">(</span><span class="n">entries</span><span class="o">.</span><span class="na">rdd</span><span class="o">());</span>
<span class="c1">// Transform the CoordinateMatrix to a BlockMatrix</span>
<span class="n">BlockMatrix</span> <span class="n">matA</span> <span class="o">=</span> <span class="n">coordMat</span><span class="o">.</span><span class="na">toBlockMatrix</span><span class="o">().</span><span class="na">cache</span><span class="o">();</span>

<span class="c1">// Validate whether the BlockMatrix is set up properly. Throws an Exception when it is not valid.</span>
<span class="c1">// Nothing happens if it is valid.</span>
<span class="n">matA</span><span class="o">.</span><span class="na">validate</span><span class="o">();</span>

<span class="c1">// Calculate A^T A.</span>
<span class="n">BlockMatrix</span> <span class="n">ata</span> <span class="o">=</span> <span class="n">matA</span><span class="o">.</span><span class="na">transpose</span><span class="o">().</span><span class="na">multiply</span><span class="o">(</span><span class="n">matA</span><span class="o">);</span></code></pre></figure>

  </div>

<div data-lang="python">

    <p>一种<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.distributed.BlockMatrix"><code>BlockMatrix</code></a>可以从<code>RDD</code>子矩阵块，其中子矩阵块是<code>((blockRowIndex, blockColIndex), sub-matrix)</code>元组。</p>

    <p>请参阅<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.distributed.BlockMatrix"><code>BlockMatrix</code></a>有关该API的更多详细信息的<a href="api/python/pyspark.mllib.html#pyspark.mllib.linalg.distributed.BlockMatrix">Python文档</a> 。</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span></span><span class="kn">from</span> <span class="nn">pyspark.mllib.linalg</span> <span class="kn">import</span> <span class="n">Matrices</span>
<span class="kn">from</span> <span class="nn">pyspark.mllib.linalg.distributed</span> <span class="kn">import</span> <span class="n">BlockMatrix</span>

<span class="c1"># Create an RDD of sub-matrix blocks.</span>
<span class="n">blocks</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Matrices</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])),</span>
                         <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Matrices</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]))])</span>

<span class="c1"># Create a BlockMatrix from an RDD of sub-matrix blocks.</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">BlockMatrix</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Get its size.</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">numRows</span><span class="p">()</span>  <span class="c1"># 6</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">numCols</span><span class="p">()</span>  <span class="c1"># 2</span>

<span class="c1"># Get the blocks as an RDD of sub-matrix blocks.</span>
<span class="n">blocksRDD</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">blocks</span>

<span class="c1"># Convert to a LocalMatrix.</span>
<span class="n">localMat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">toLocalMatrix</span><span class="p">()</span>

<span class="c1"># Convert to an IndexedRowMatrix.</span>
<span class="n">indexedRowMat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">toIndexedRowMatrix</span><span class="p">()</span>

<span class="c1"># Convert to a CoordinateMatrix.</span>
<span class="n">coordinateMat</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">toCoordinateMatrix</span><span class="p">()</span></code></pre></figure>

  </div>
</div>


                </div>
            
             <!-- /container -->
        </div>

        <script src="js/vendor/jquery-1.12.4.min.js"></script>
        <script src="js/vendor/bootstrap.min.js"></script>
        <script src="js/vendor/anchor.min.js"></script>
        <script src="js/main.js"></script>

        <!-- MathJax Section -->
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                TeX: { equationNumbers: { autoNumber: "AMS" } }
            });
        </script>
        <script>
            // Note that we load MathJax this way to work with local file (file://), HTTP and HTTPS.
            // We could use "//cdn.mathjax...", but that won't support "file://".
            (function(d, script) {
                script = d.createElement('script');
                script.type = 'text/javascript';
                script.async = true;
                script.onload = function(){
                    MathJax.Hub.Config({
                        tex2jax: {
                            inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ],
                            displayMath: [ ["$$","$$"], ["\\[", "\\]"] ],
                            processEscapes: true,
                            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
                        }
                    });
                };
                script.src = ('https:' == document.location.protocol ? 'https://' : 'http://') +
                    'cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js' +
                    '?config=TeX-AMS-MML_HTMLorMML';
                d.getElementsByTagName('head')[0].appendChild(script);
            }(document));
        </script>
    

</body></html>