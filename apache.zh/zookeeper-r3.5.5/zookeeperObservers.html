<!DOCTYPE html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>ZooKeeper:因为协调分布式系统是动物园</title>
    <link type="text/css" href="skin/basic.css" rel="stylesheet">
    <link type="text/css" href="skin/screen.css" rel="stylesheet" media="screen">
    <link type="text/css" href="skin/print.css" rel="stylesheet" media="print">
    <link type="text/css" href="skin/profile.css" rel="stylesheet">
    <script src="skin/getBlank.js" type="text/javascript" language="javascript"></script>
    <script src="skin/getMenu.js" type="text/javascript" language="javascript"></script>
    <script src="skin/init.js" type="text/javascript" language="javascript"></script>
    <link rel="shortcut icon" href="images/favicon.ico">
</head>
<body dir="ltr" onload="init();">
<div id="top">
    <div class="breadtrail">
        <a href="http://www.apache.org/">Apache</a> &gt; <a href="http://zookeeper.apache.org/">ZooKeeper</a>
    </div>
    <div class="header">
        <div class="grouplogo">
            <a href="http://hadoop.apache.org/"><img class="logoImage" alt="Hadoop" src="images/hadoop-logo.jpg" title="Apache Hadoop"></a>
        </div>
        <div class="projectlogo">
            <a href="http://zookeeper.apache.org/"><img class="logoImage" alt="ZooKeeper" src="images/zookeeper_small.gif" title="ZooKeeper:分布式协调"></a>
        </div>
        <div class="searchbox">
            <form action="http://www.google.com/search" method="get">
                <input value="zookeeper.apache.org" name="sitesearch" type="hidden"><input onFocus="getBlank (this, 'Search the site with google');" size="25" name="q" id="query" type="text" value="Search the site with google">&nbsp;
                <input name="Search" value="搜索" type="submit">
            </form>
        </div>
        <ul id="tabs">
            <li>
                <a class="unselected" href="http://zookeeper.apache.org/">项目</a>
            </li>
            <li>
                <a class="unselected" href="https://cwiki.apache.org/confluence/display/ZOOKEEPER/">维基</a>
            </li>
            <li class="current">
                <a class="selected" href="index.html">ZooKeeper 3.5文档</a>
            </li>
        </ul>
    </div>
</div>
<div id="main">
    <div id="publishedStrip">
        <div id="level2tabs"></div>
        <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
    </div>
    <div class="breadtrail">
         
    </div>
    <div id="menu">
        <div onclick="SwitchMenu('menu_1', 'skin/')" id="menu_1Title" class="menutitle">Overview</div>
        <div id="menu_1" class="menuitemgroup">
            <div class="menuitem">
                <a href="index.html">欢迎</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperOver.html">概观</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperStarted.html">入门</a>
            </div>
            <div class="menuitem">
                <a href="releasenotes.html">发行说明</a>
            </div>
        </div>
        <div onclick="SwitchMenu('menu_2', 'skin/')" id="menu_2Title" class="menutitle">Developer</div>
        <div id="menu_2" class="menuitemgroup">
            <div class="menuitem">
                <a href="api/index.html">API文档</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperProgrammers.html">程序员指南</a>
            </div>
            <div class="menuitem">
                <a href="javaExample.html">Java示例</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperTutorial.html">障碍和队列教程</a>
            </div>
            <div class="menuitem">
                <a href="recipes.html">食谱</a>
            </div>
        </div>
        <div onclick="SwitchMenu('menu_3', 'skin/')" id="menu_3Title" class="menutitle">Admin &amp; Ops</div>
        <div id="menu_3" class="menuitemgroup">
            <div class="menuitem">
                <a href="zookeeperAdmin.html">管理员指南</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperQuotas.html">配额指南</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperJMX.html">JMX</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperObservers.html">观察员指南</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperReconfig.html">动态重新配置</a>
            </div>
        </div>
        <div onclick="SwitchMenu('menu_4', 'skin/')" id="menu_4Title" class="menutitle">Contributor</div>
        <div id="menu_4" class="menuitemgroup">
            <div class="menuitem">
                <a href="zookeeperInternals.html">ZooKeeper Internals</a>
            </div>
        </div>
        <div onclick="SwitchMenu('menu_5', 'skin/')" id="menu_5Title" class="menutitle">Miscellaneous</div>
        <div id="menu_5" class="menuitemgroup">
            <div class="menuitem">
                <a href="https://cwiki.apache.org/confluence/display/ZOOKEEPER">维基</a>
            </div>
            <div class="menuitem">
                <a href="https://cwiki.apache.org/confluence/display/ZOOKEEPER/FAQ">常问问题</a>
            </div>
            <div class="menuitem">
                <a href="http://zookeeper.apache.org/mailing_lists.html">邮件列表</a>
            </div>
        </div>
    </div>
    <div id="content">
<!--
Copyright 2002-2004 The Apache Software Foundation

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
//--><h1>ZooKeeper观察员</h1>
<ul>
  <li><a href="#ch_Introduction">观察者:在不伤害写入性能的情况下扩展ZooKeeper</a></li>
  <li><a href="#sc_UsingObservers">如何使用观察者</a></li>
  <li><a href="#ch_UseCases">用例示例</a></li>
</ul><p><a name="ch_Introduction"></a></p><h2>观察者:在不伤害写入性能的情况下扩展ZooKeeper</h2><p>虽然ZooKeeper通过让客户端直接连接到集合的投票成员来表现得非常好,但这种架构使得很难扩展到大量客户端。问题是,随着我们添加更多投票成员,写入性能下降。这是因为写操作需要(通常)同意整体中至少一半的节点,因此随着更多选民的加入,投票的成本会显着增加。</p><p>我们引入了一种名为<em>Observer</em>的新型ZooKeeper节点,它有助于解决这个问题并进一步提高ZooKeeper的可扩展性。观察员是合唱团的非投票成员,只听取投票结果,而不是导致投票结果的协议协议。除了这个简单的区别,Observers的功能与Followers完全相同 - 客户端可以连接到它们并向它们发送读写请求。观察员将这些请求像追随者一样转发给领导者,但他们只是等待听取投票结果。因此,我们可以在不损害选票表现的情况下尽可能多地增加观察员的数量。</p><p>观察者还有其他优点。因为他们不投票,所以他们不是ZooKeeper合奏的重要组成部分。因此,它们可能会失败,或者与群集断开连接,而不会损害ZooKeeper服务的可用性。对用户的好处是,观察者可能通过不太可靠的网络链接连接而不是追随者。实际上,Observers可能用于与另一个数据中心的ZooKeeper服务器通信。观察者的客户端将看到快速读取,因为所有读取都在本地提供,并且写入导致最小的网络流量,因为在没有投票协议的情况下所需的消息数量较少。</p><p><a name="sc_UsingObservers"></a></p><h2>如何使用观察者</h2><p>设置使用Observers的ZooKeeper集合非常简单,只需要对配置文件进行两次更改。首先,在要成为Observer的每个节点的配置文件中,您必须放置以下行:</p>
<pre><code>peerType=observer
</code></pre><p>该行告诉ZooKeeper服务器是一个Observer。其次,在每个服务器配置文件中,必须将:observer添加到每个Observer的服务器定义行。例如:</p>
<pre><code>server.1:localhost:2181:3181:observer
</code></pre><p>这告诉每个其他服务器server.1是一个观察者,他们不应该期望它投票。这是将Observer添加到ZooKeeper集群所需的所有配置。现在你可以连接到它,好像它是一个普通的追随者。通过运行来试试吧:</p>
<pre><code>$ bin/zkCli.sh -server localhost:2181
</code></pre><p>其中localhost:2181是每个配置文件中指定的Observer的主机名和端口号。您应该看到一个命令行提示符,您可以通过该提示符发出<em>ls等</em>命令来查询ZooKeeper服务。</p><p><a name="ch_UseCases"></a></p><h2>用例示例</h2><p>下面列出了观察员的两个示例用例。实际上,无论您希望扩展ZooKeeper集合的客户端数量,还是希望将集合的关键部分与处理客户端请求的负载隔离开来,Observers都是一个很好的架构选择。</p>
<ul>
  <li>作为数据中心桥:在两个数据中心之间形成ZK集合是一个有问题的尝试,因为数据中心之间的延迟的高度变化可能导致错误的正故障检测和分区。但是,如果集合完全在一个数据中心运行,而第二个数据中心仅运行Observers,则分区不会出现问题,因为整体仍保持连接状态。观察员的客户仍然可以查看和发布提案。</li>
  <li>作为消息总线的链接:一些公司表示有兴趣将ZK用作持久可靠消息总线的组件。观察者将为这项工作提供一个自然的集成点:插件机制可用于将观察者看到的提案流附加到发布 - 订阅系统,同样不加载核心集合。</li>
</ul></div>
<div class="clearboth"> </div>
</div>
<div id="footer">
    <div class="lastmodified">
        <script type="text/javascript">
        <!--
            document.write("Last Published: " + document.lastModified);
        //  -->
        </script>
    </div>
    <div class="copyright">版权所有© <a href="http://www.apache.org/licenses/">Apache Software Foundation。</a>
    </div>
    <div id="logos"></div>
</div>
</body>
</html>