<html lang="zh-Hans" ><head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>JSR 223 javax.script API</title>
<link rel="stylesheet" href="./assets/css/style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
</head>
<body id="jsr223" class="book" >
<div id="header">
<h1>JSR 223 javax.script API</h1>
<div class="details">
<span id="revnumber">版本3.0.0-rc-1</span>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">JSR-223是用于用Java调用脚本框架的标准API。它从Java 6开始可用，其目的是提供一个用于从Java调用多种语言的通用框架。Groovy提供了自己更丰富的集成机制，如果您不打算在同一应用程序中使用多种语言，则建议您使用Groovy集成机制，而不是受限的JSR-223 API。</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>这是初始化JSR-223引擎以从Java与Groovy对话的方法：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;
import javax.script.ScriptException;
...
ScriptEngineManager factory = new ScriptEngineManager();
ScriptEngine engine = factory.getEngineByName("groovy");</code></pre>
</div>
</div>
<div class="paragraph">
<p>然后，您可以轻松执行Groovy脚本：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Integer sum = (Integer) engine.eval("(1..10).sum()");
assertEquals(new Integer(55), sum);</code></pre>
</div>
</div>
<div class="paragraph">
<p>也可以共享变量：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">engine.put("first", "HELLO");
engine.put("second", "world");
String result = (String) engine.eval("first.toLowerCase() + ' ' + second.toUpperCase()");
assertEquals("hello WORLD", result);</code></pre>
</div>
</div>
<div class="paragraph">
<p>下一个示例说明了如何调用可调用函数：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import javax.script.Invocable;
...
ScriptEngineManager factory = new ScriptEngineManager();
ScriptEngine engine = factory.getEngineByName("groovy");
String fact = "def factorial(n) { n == 1 ? 1 : n * factorial(n - 1) }";
engine.eval(fact);
Invocable inv = (Invocable) engine;
Object[] params = {5};
Object result = inv.invokeFunction("factorial", params);
assertEquals(new Integer(120), result);</code></pre>
</div>
</div>
<div class="paragraph">
<p>引擎默认保留对脚本功能的硬引用。要更改此设置，您应该将引擎级别的范围属性设置为名称的脚本上下文<code>#jsr223.groovy.engine.keep.globals</code>有一个字符串<code>phantom</code>使用幻像引用， <code>weak</code>使用弱引用或<code>soft</code>使用软引用-忽略大小写。任何其他字符串都将导致使用硬引用。</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">版本3.0.0-rc-1<br>最近更新时间2019-10-22 17:47:03 AEST</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>

</body></html>