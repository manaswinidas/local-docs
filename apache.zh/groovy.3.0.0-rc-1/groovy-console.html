<html lang="zh-Hans" ><head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>groovy控制台，Groovy摇摆控制台</title>
<link rel="stylesheet" href="./assets/css/style.css">
<link rel="stylesheet" href="asset?aid=3">
</head>
<body class="book toc2 toc-left" >
<div id="header">
<h1>groovy控制台，Groovy摇摆控制台</h1>
<div class="details">
<span id="revnumber">版本3.0.0-rc-1</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">目录</div>
<ul class="sectlevel1">
<li><a href="#title-heading">1。Groovy：Groovy控制台</a></li>
<li><a href="#GroovyConsole-Basics">2。基本</a></li>
<li><a href="#GroovyConsole-Features">3。特征</a>
<ul class="sectlevel2">
<li><a href="#GroovyConsole-Command-lineOptionsandArguments">3.1。命令行选项和参数</a></li>
<li><a href="#GroovyConsole-RunningScripts">3.2。运行脚本</a></li>
<li><a href="#GroovyConsole-EditingFiles">3.3。编辑档案</a></li>
<li><a href="#GroovyConsole-Historyandresults">3.4。历史和结果</a></li>
<li><a href="#GroovyConsole-Interrupt">3.5。中断脚本</a></li>
<li><a href="#GroovyConsole-Andmore">3.6。和更多</a></li>
</ul>
</li>
<li><a href="#GroovyConsole-EmbeddingtheConsole">4。嵌入控制台</a></li>
<li><a href="#GroovyConsole-Visualizingscriptoutputresults">5，可视化脚本输出结果</a></li>
<li><a href="#GroovyConsole-ASTbrowser">6。AST浏览器</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="title-heading"><a class="anchor" href="#title-heading"></a> 1。Groovy：Groovy控制台</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Groovy Swing控制台允许用户输入并运行Groovy脚本。此页面记录了此用户界面的功能。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="GroovyConsole-Basics"><a class="anchor" href="#GroovyConsole-Basics"></a> 2。基本</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><img src="assets/img/GroovyConsole.gif" alt="图片"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Groovy Console通过以下方式启动<code>groovyConsole</code>要么<code>groovyConsole.bat</code> ，均位于<code>$GROOVY_HOME/bin</code></p>
</li>
<li>
<p>控制台具有输入区域和输出区域。</p>
</li>
<li>
<p>您在输入区域中键入一个Groovy脚本。</p>
</li>
<li>
<p>当您选择<code>Run</code>来自<code>Actions</code>菜单，控制台将编译脚本并运行它。</p>
</li>
<li>
<p>通常会印在上面的任何东西<code>System.out</code>打印在输出区域中。</p>
</li>
<li>
<p>如果脚本返回非空结果，则打印该结果。</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="GroovyConsole-Features"><a class="anchor" href="#GroovyConsole-Features"></a> 3。特征</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="GroovyConsole-Command-lineOptionsandArguments"><a class="anchor" href="#GroovyConsole-Command-lineOptionsandArguments"></a> 3.1。命令行选项和参数</h3>
<div class="paragraph">
<p>Groovy控制台支持几个选项来控制类路径和其他功能。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">./bin/groovyConsole --help
Usage: groovyConsole [options] [filename]
The Groovy Swing Console allows a user to enter and run Groovy scripts.
      --configscript=PARAM   A script for tweaking the compiler configuration options
      -cp, -classpath, --classpath
                             Specify where to find the class files - must be first
                               argument
  -D, --define=&lt;name=value&gt;  Define a system property
  -h, --help                 Display this help message
  -i, --indy                 Enable InvokeDynamic (Indy) compilation for scripts
  -pa, --parameters          Generate metadata for reflection on method parameter
                               names (jdk8+ only)
  -pr, --enable-preview             Enable preview Java features (JEP 12) (jdk12+ only)
  -V, --version              Display the version</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="GroovyConsole-RunningScripts"><a class="anchor" href="#GroovyConsole-RunningScripts"></a> 3.2。运行脚本</h3>
<div class="paragraph">
<p>您可以使用几种快捷方式来运行脚本或代码段：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Ctrl+Enter</code>和<code>Ctrl+R</code>都是这两个的快捷键<code>Run Script</code> 。</p>
</li>
<li>
<p>如果仅在输入区域中突出显示部分文本，则Groovy仅运行该文本。</p>
</li>
<li>
<p>脚本的结果是最后执行的表达式的值。</p>
</li>
<li>
<p>您可以通过选择打开和关闭System.out捕获<code>Capture System.out</code>来自<code>Actions</code>菜单</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="GroovyConsole-EditingFiles"><a class="anchor" href="#GroovyConsole-EditingFiles"></a> 3.3。编辑档案</h3>
<div class="paragraph">
<p>您可以打开任何文本文件，对其进行编辑，运行（作为Groovy脚本），然后在完成后再次保存。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>选择<code>File > Open</code> （快捷键<code>ctrl+O</code> ）打开文件</p>
</li>
<li>
<p>选择<code>File > Save</code> （快捷键<code>ctrl+S</code> ）保存文件</p>
</li>
<li>
<p>选择<code>File > New File</code> （快捷键<code>ctrl+Q</code> ）从空白的输入区域重新开始</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="GroovyConsole-Historyandresults"><a class="anchor" href="#GroovyConsole-Historyandresults"></a> 3.4。历史和结果</h3>
<div class="ulist">
<ul>
<li>
<p>您可以通过选择最后一个（非空）结果弹出gui检查器<code>Inspect Last</code>来自<code>Actions</code>菜单。检查器是查看列表和地图的便捷方法。</p>
</li>
<li>
<p>控制台会记住最近运行的十个脚本。您可以通过选择来回浏览历史记录<code>Next</code>和<code>Previous</code>来自<code>Edit</code>菜单。 <code>Ctrl-N</code>和<code>ctrl-P</code>是方便的快捷键。</p>
</li>
<li>
<p>最后一个（非空）结果绑定到名为的变量<code>_</code> （下划线）。</p>
</li>
<li>
<p>历史记录中每次运行的最后结果（空值和非空值）都绑定到名为<code><em></em></code> <em>（两个下划线）。上次运行的结果是<code></code></em> <code>[-1]</code> ，倒数第二次的结果是<code>__[-2]</code>等等。</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="GroovyConsole-Interrupt"><a class="anchor" href="#GroovyConsole-Interrupt"></a> 3.5。中断脚本</h3>
<div class="paragraph">
<p>Groovy控制台是用于开发脚本的非常方便的工具。通常，您会发现自己多次运行脚本，直到脚本按您希望的方式运行为止。但是，如果您的代码花费太长时间才能完成甚至更糟，则会创建一个无限循环？中断脚本执行可以通过单击<code>interrupt</code>执行脚本或通过脚本弹出时弹出的小对话框上的按钮<code>interrupt</code>工具栏中的图标。</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/img/gconsole-toolbar.png" alt="工具列"></span></p>
</div>
<div class="paragraph">
<p>但是，这可能不足以中断脚本：单击按钮将中断执行线程，但是如果您的代码不处理中断标志，则脚本可能会继续运行，而您无法有效地停止脚本。为避免这种情况，您必须确保<code>Script > Allow interruption</code>菜单项已标记。这会自动将AST转换应用于您的脚本，该脚本将负责检查中断标志（ <code>@ThreadInterrupt</code> ）。这样，即使没有显式处理中断，您也可以确保脚本可以被中断，但这会花费额外的执行时间。</p>
</div>
</div>
<div class="sect2">
<h3 id="GroovyConsole-Andmore"><a class="anchor" href="#GroovyConsole-Andmore"></a> 3.6。和更多</h3>
<div class="ulist">
<ul>
<li>
<p>您可以通过选择更改字体大小<code>Smaller Font</code>要么<code>Larger Font</code>来自<code>Actions menu</code></p>
</li>
<li>
<p>该控制台可以作为Applet运行，这要归功于<code>groovy.ui.ConsoleApplet</code></p>
</li>
<li>
<p>当您按回车键时，代码会自动缩进</p>
</li>
<li>
<p>您可以将Groovy脚本拖放到文本区域上以打开文件</p>
</li>
<li>
<p>您可以通过从控制台添加新的JAR或目录到类路径来修改运行控制台中脚本的类路径。 <code>Script</code>菜单</p>
</li>
<li>
<p>当预期发生编译错误或引发异常时，从输出区域的错误超链接</p>
</li>
<li>
<p>您可以通过选择启用InvokeDynamic（Indy）编译模式<code>Enable Indy Compilation</code>来自<code>Script</code>菜单</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="GroovyConsole-EmbeddingtheConsole"><a class="anchor" href="#GroovyConsole-EmbeddingtheConsole"></a> 4。嵌入控制台</h2>
<div class="sectionbody">
<div class="paragraph">
<p>要在应用程序中嵌入Swing控制台，只需创建Console对象，加载一些变量，然后启动它。该控制台可以嵌入Java或Groovy代码中。Java代码是：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import groovy.ui.Console;

    ...
    Console console = new Console();
    console.setVariable("var1", getValueOfVar1());
    console.setVariable("var2", getValueOfVar2());
    console.run();
    ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>启动控制台后，您可以在Groovy代码中使用变量值。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="GroovyConsole-Visualizingscriptoutputresults"><a class="anchor" href="#GroovyConsole-Visualizingscriptoutputresults"></a> 5，可视化脚本输出结果</h2>
<div class="sectionbody">
<div class="paragraph">
<p>您可以自定义脚本输出结果的可视化方式。让我们看看如何定制它。例如，查看地图结果将显示以下内容：</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/img/gconsole-sc-without-visu.png" alt="图片"></span></p>
</div>
<div class="paragraph">
<p>您在这里看到的是地图的通常文本表示形式。但是，如果我们启用某些结果的自定义可视化怎么办？Swing控制台允许您执行此操作。首先，必须确保选中了可视化选项： <code>View → Visualize Script Results</code> —作为记录，Groovy Console的所有设置都可以通过Preference API进行存储和记忆。内置了一些结果可视化效果：如果脚本返回一个<code>java.awt.Image</code> ， 一种<code>javax.swing.Icon</code>或<code>java.awt.Component</code>没有父对象，则显示该对象而不是其<code>toString()</code>表示。否则，其他所有内容仍仅表示为文本。现在，在中创建以下Groovy脚本<code>~/.groovy/OutputTransforms.groovy</code> ：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import javax.swing.*

transforms &lt;&lt; { result -&gt;
    if (result instanceof Map) {
        def table = new JTable(
            result.collect{ k, v -&gt;
                [k, v?.inspect()] as Object[]
            } as Object[][],
            ['Key', 'Value'] as Object[])
        table.preferredViewportSize = table.preferredSize
        return new JScrollPane(table)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Groovy Swing控制台将在启动时执行该脚本，并在脚本的绑定中注入一个转换列表，以便您可以添加自己的脚本结果表示形式。在我们的例子中，我们将Map转换为漂亮的Swing JTable。现在，我们能够以友好和有吸引力的方式可视化地图，如以下屏幕截图所示：</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/img/gconsole-sc-with-visu.png" alt="图片"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="GroovyConsole-ASTbrowser"><a class="anchor" href="#GroovyConsole-ASTbrowser"></a> 6。AST浏览器</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Groovy Console可以可视化表示当前编辑的脚本的AST（抽象语法树），如下面的屏幕快照所示。当您要开发AST转换时，这特别方便。</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/img/astbrowser.png" alt="AST浏览器"></span></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">版本3.0.0-rc-1<br>最近更新时间2019-10-22 17:47:03 AEST</div>
</div>
<link rel="stylesheet" href="asset?aid=4">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>

</body></html>