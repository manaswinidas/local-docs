<html lang="zh-Hans" ><head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>责任链模式</title>
<link rel="stylesheet" href="./assets/css/style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left" >
<div id="header">
<h1>责任链模式</h1>
<div class="details">
<span id="revnumber">版本3.0.0-rc-1</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">目录</div>
<ul class="sectlevel1">
<li><a href="#_example">1。例</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>在责任链模式中，使用和实现接口（一种或多种方法）的对象是有意地松散耦合的。一组<em>实现</em>接口的对象被组织在一个列表中（在极少数情况下是一棵树）。使用该接口的对象从第一个<em>实现者</em>对象发出请求。它将决定是否自行执行任何操作以及是否将请求进一步传递到列表（或树）中的下一行。如果某些实现者均未响应该请求，则有时会将某些请求的默认实现也编码到该模式中。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example"><a class="anchor" href="#_example"></a> 1。例</h2>
<div class="sectionbody">
<div class="paragraph">
<p>在此示例中，脚本将请求发送到<code>lister</code>宾语。的<code>lister</code>指向一个<code>UnixLister</code>宾语。如果无法处理请求，则会将请求发送到<code>WindowsLister</code> 。如果无法处理请求，则会将请求发送到<code>DefaultLister</code> 。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class UnixLister {
    private nextInLine
    UnixLister(next) { nextInLine = next }
    def listFiles(dir) {
        if (System.getProperty('os.name') == 'Linux') {
            println "ls $dir".execute().text
        } else {
            nextInLine.listFiles(dir)
        }
    }
}

class WindowsLister {
    private nextInLine
    WindowsLister(next) { nextInLine = next }
    def listFiles(dir) {
        if (System.getProperty('os.name') == 'Windows XP') {
            println "cmd.exe /c dir $dir".execute().text
        } else {
            nextInLine.listFiles(dir)
        }
    }
}

class DefaultLister {
    def listFiles(dir) {
        new File(dir).eachFile { f -&gt; println f }
    }
}

def lister = new UnixLister(new WindowsLister(new DefaultLister()))

lister.listFiles('Downloads')</code></pre>
</div>
</div>
<div class="paragraph">
<p>输出将是文件列表（格式略有不同，具体取决于操作系统）。</p>
</div>
<div class="paragraph">
<p>这是UML表示形式：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/img/ChainOfResponsibilityClasses.gif" alt="责任链类">
</div>
</div>
<div class="paragraph">
<p>此模式的变化形式：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>我们可以有一个明确的接口，例如<code>Lister</code> ，以静态键入实现，但是由于使用<em>鸭式输入，</em>因此这是可选的</p>
</li>
<li>
<p>我们可以使用链树代替列表，例如<code>if (animal.hasBackbone())</code>委托给<code>VertebrateHandler</code>否则委托给<code>InvertebrateHandler</code></p>
</li>
<li>
<p>即使我们处理了一个请求，我们也总是可以顺其自然</p>
</li>
<li>
<p>我们可以在某个时候决定不回应，也不要顺其自然</p>
</li>
<li>
<p>我们可以使用Groovy的元编程功能将未知的方法传递给链下</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">版本3.0.0-rc-1<br>最近更新时间2019-10-22 17:47:02 AEST</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>

</body></html>