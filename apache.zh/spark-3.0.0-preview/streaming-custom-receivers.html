<html class="no-js" ><!--<![endif]--><head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Spark Streaming自定义接收器-Spark 3.0.0-预览文档</title>
        

        

        <link rel="stylesheet" href="css/bootstrap.min.css">
        <style>
            body {
                padding-top: 60px;
                padding-bottom: 40px;
            }
        </style>
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="css/bootstrap-responsive.min.css">
        <link rel="stylesheet" href="css/main.css">

        <script src="js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>

        <link rel="stylesheet" href="css/pygments-default.css">

        
        <!-- Google analytics script -->
        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-32518208-2']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        </script>
        

    </head>
    <body >
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="https://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <!-- This code is taken from http://twitter.github.com/bootstrap/examples/hero.html -->

        <div class="navbar navbar-fixed-top" id="topbar">
            <div class="navbar-inner">
                <div class="container">
                    <div class="brand"><a href="index.html"><img src="img/spark-logo-hd.png" style="height:50px"></a> <span class="version">3.0.0预览版</span>
                    </div>
                    <ul class="nav">
                        <!--TODO(andyk): Add class="active" attribute to li some how.-->
                        <li><a href="index.html">总览</a></li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">编程指南<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="quick-start.html">快速开始</a></li>
                                <li><a href="rdd-programming-guide.html">RDD，累加器，广播变量</a></li>
                                <li><a href="sql-programming-guide.html">SQL，数据框和数据集</a></li>
                                <li><a href="structured-streaming-programming-guide.html">结构化流</a></li>
                                <li><a href="streaming-programming-guide.html">火花流（DStreams）</a></li>
                                <li><a href="ml-guide.html">MLlib（机器学习）</a></li>
                                <li><a href="graphx-programming-guide.html">GraphX（图形处理）</a></li>
                                <li><a href="sparkr.html">SparkR（Spark上的R）</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">API文件<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="api/scala/index.html#org.apache.spark.package">斯卡拉</a></li>
                                <li><a href="api/java/index.html">爪哇</a></li>
                                <li><a href="api/python/index.html">蟒蛇</a></li>
                                <li><a href="api/R/index.html">[R</a></li>
                                <li><a href="api/sql/index.html">SQL，内置函数</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">部署中<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="cluster-overview.html">总览</a></li>
                                <li><a href="submitting-applications.html">提交申请</a></li>
                                <li class="divider"></li>
                                <li><a href="spark-standalone.html">Spark独立</a></li>
                                <li><a href="running-on-mesos.html">梅索斯</a></li>
                                <li><a href="running-on-yarn.html">纱</a></li>
                                <li><a href="running-on-kubernetes.html">Kubernetes</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="api.html" class="dropdown-toggle" data-toggle="dropdown">更多<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="configuration.html">组态</a></li>
                                <li><a href="monitoring.html">监控方式</a></li>
                                <li><a href="tuning.html">调音指南</a></li>
                                <li><a href="job-scheduling.html">作业调度</a></li>
                                <li><a href="security.html">安全</a></li>
                                <li><a href="hardware-provisioning.html">硬件配置</a></li>
                                <li><a href="migration-guide.html">迁移指南</a></li>
                                <li class="divider"></li>
                                <li><a href="building-spark.html">建筑火花</a></li>
                                <li><a href="https://spark.apache.org/contributing.html">为Spark贡献</a></li>
                                <li><a href="https://spark.apache.org/third-party-projects.html">第三方项目</a></li>
                            </ul>
                        </li>
                    </ul>
                    <!--<p class="navbar-text pull-right"><span class="version-text">v3.0.0-preview</span></p>-->
                </div>
            </div>
        </div>

        <div class="container-wrapper">

            
                <div class="content" id="content">
                    
                        <h1 class="title">Spark Streaming自定义接收器</h1>
                    

                    <p>Spark Streaming可以从其内置支持（即，除了Kafka，Kinesis，文件，套接字等）之外的任何任意数据源接收流数据。这就要求开发人员实现一个定制的接收<em>器</em> ，用于从相关数据源接收数据。本指南介绍了实现自定义接收器并在Spark Streaming应用程序中使用它的过程。请注意，可以在Scala或Java中实现自定义接收器。</p>

<h2 id="implementing-a-custom-receiver">实施自定义接收器</h2>

<p>首先从实现<strong>Receiver</strong> （ <a href="api/scala/index.html#org.apache.spark.streaming.receiver.Receiver">Scala doc</a> ， <a href="api/java/org/apache/spark/streaming/receiver/Receiver.html">Java doc</a> ）开始。自定义接收方必须通过实现两个方法来扩展此抽象类</p>

<ul>
  <li><code>onStart()</code> ：开始接收数据需要做的事情。</li>
  <li><code>onStop()</code> ：停止接收数据的操作。</li>
</ul>

<p>都<code>onStart()</code>和<code>onStop()</code>不能无限期地封锁。通常， <code>onStart()</code>将启动负责接收数据的线程，并且<code>onStop()</code>将确保这些线程停止接收数据。接收线程也可以使用<code>isStopped()</code> ， 一种<code>Receiver</code>方法，以检查是否应停止接收数据。</p>

<p>接收到数据后，可以通过调用将该数据存储在Spark内部<code>store(data)</code> ，这是Receiver类提供的方法。有多种口味<code>store()</code>允许一次存储或整体存储对象/序列化字节的形式存储接收到的数据。注意味道<code>store()</code>用于实现接收器的接收器会影响其可靠性和容错语义。<a href="#receiver-reliability">稍后将</a>对此进行详细讨论。</p>

<p>接收线程中的任何异常都应被捕获并正确处理，以避免接收器出现静默故障。 <code>restart(<exception>)</code>将通过异步调用重新启动接收器<code>onStop()</code>然后打电话<code>onStart()</code>延迟之后。
<code>stop(<exception>)</code>将会通知<code>onStop()</code>并终止接收器。也， <code>reportError(<error>)</code>向驱动程序报告错误消息（在日志和UI中可见），而无需停止/重新启动接收器。</p>

<p>以下是一个自定义接收器，它通过套接字接收文本流。它将文本流中以'\ n'分隔的行视为记录，并将其存储在Spark中。如果接收线程在连接或接收时出现任何错误，则重新启动接收器以进行另一次连接尝试。</p>

<div class="codetabs">
<div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span></span><span class="k">class</span> <span class="nc">CustomReceiver</span><span class="o">(</span><span class="n">host</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">port</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>
  <span class="k">extends</span> <span class="nc">Receiver</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="nc">StorageLevel</span><span class="o">.</span><span class="nc">MEMORY_AND_DISK_2</span><span class="o">)</span> <span class="k">with</span> <span class="nc">Logging</span> <span class="o">{</span>

  <span class="k">def</span> <span class="n">onStart</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// Start the thread that receives data over a connection</span>
    <span class="k">new</span> <span class="nc">Thread</span><span class="o">(</span><span class="s">&quot;Socket Receiver&quot;</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">override</span> <span class="k">def</span> <span class="n">run</span><span class="o">()</span> <span class="o">{</span> <span class="n">receive</span><span class="o">()</span> <span class="o">}</span>
    <span class="o">}.</span><span class="n">start</span><span class="o">()</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="n">onStop</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// There is nothing much to do as the thread calling receive()</span>
    <span class="c1">// is designed to stop by itself if isStopped() returns false</span>
  <span class="o">}</span>

  <span class="cm">/** Create a socket connection and receive data until receiver is stopped */</span>
  <span class="k">private</span> <span class="k">def</span> <span class="n">receive</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">var</span> <span class="n">socket</span><span class="k">:</span> <span class="kt">Socket</span> <span class="o">=</span> <span class="kc">null</span>
    <span class="k">var</span> <span class="n">userInput</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="kc">null</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="c1">// Connect to host:port</span>
      <span class="n">socket</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Socket</span><span class="o">(</span><span class="n">host</span><span class="o">,</span> <span class="n">port</span><span class="o">)</span>

      <span class="c1">// Until stopped or connection broken continue reading</span>
      <span class="k">val</span> <span class="n">reader</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span>
        <span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="n">getInputStream</span><span class="o">(),</span> <span class="nc">StandardCharsets</span><span class="o">.</span><span class="nc">UTF_8</span><span class="o">))</span>
      <span class="n">userInput</span> <span class="k">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readLine</span><span class="o">()</span>
      <span class="k">while</span><span class="o">(!</span><span class="n">isStopped</span> <span class="o">&amp;&amp;</span> <span class="n">userInput</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">store</span><span class="o">(</span><span class="n">userInput</span><span class="o">)</span>
        <span class="n">userInput</span> <span class="k">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readLine</span><span class="o">()</span>
      <span class="o">}</span>
      <span class="n">reader</span><span class="o">.</span><span class="n">close</span><span class="o">()</span>
      <span class="n">socket</span><span class="o">.</span><span class="n">close</span><span class="o">()</span>

      <span class="c1">// Restart in an attempt to connect again when server is active again</span>
      <span class="n">restart</span><span class="o">(</span><span class="s">&quot;Trying to connect again&quot;</span><span class="o">)</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">{</span>
      <span class="k">case</span> <span class="n">e</span><span class="k">:</span> <span class="kt">java.net.ConnectException</span> <span class="o">=&gt;</span>
        <span class="c1">// restart if could not connect to server</span>
        <span class="n">restart</span><span class="o">(</span><span class="s">&quot;Error connecting to &quot;</span> <span class="o">+</span> <span class="n">host</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="n">port</span><span class="o">,</span> <span class="n">e</span><span class="o">)</span>
      <span class="k">case</span> <span class="n">t</span><span class="k">:</span> <span class="kt">Throwable</span> <span class="o">=&gt;</span>
        <span class="c1">// restart if there is any other error</span>
        <span class="n">restart</span><span class="o">(</span><span class="s">&quot;Error receiving data&quot;</span><span class="o">,</span> <span class="n">t</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

  </div>
<div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JavaCustomReceiver</span> <span class="kd">extends</span> <span class="n">Receiver</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="n">String</span> <span class="n">host</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
  <span class="kt">int</span> <span class="n">port</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">JavaCustomReceiver</span><span class="o">(</span><span class="n">String</span> <span class="n">host_</span> <span class="o">,</span> <span class="kt">int</span> <span class="n">port_</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">(</span><span class="n">StorageLevel</span><span class="o">.</span><span class="na">MEMORY_AND_DISK_2</span><span class="o">());</span>
    <span class="n">host</span> <span class="o">=</span> <span class="n">host_</span><span class="o">;</span>
    <span class="n">port</span> <span class="o">=</span> <span class="n">port_</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onStart</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// Start the thread that receives data over a connection</span>
    <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="k">this</span><span class="o">::</span><span class="n">receive</span><span class="o">).</span><span class="na">start</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onStop</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// There is nothing much to do as the thread calling receive()</span>
    <span class="c1">// is designed to stop by itself if isStopped() returns false</span>
  <span class="o">}</span>

  <span class="cm">/** Create a socket connection and receive data until receiver is stopped */</span>
  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">receive</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">Socket</span> <span class="n">socket</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">userInput</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="k">try</span> <span class="o">{</span>
      <span class="c1">// connect to the server</span>
      <span class="n">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Socket</span><span class="o">(</span><span class="n">host</span><span class="o">,</span> <span class="n">port</span><span class="o">);</span>

      <span class="n">BufferedReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span>
        <span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">socket</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">(),</span> <span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>

      <span class="c1">// Until stopped or connection broken continue reading</span>
      <span class="k">while</span> <span class="o">(!</span><span class="n">isStopped</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">userInput</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Received data &#39;&quot;</span> <span class="o">+</span> <span class="n">userInput</span> <span class="o">+</span> <span class="s">&quot;&#39;&quot;</span><span class="o">);</span>
        <span class="n">store</span><span class="o">(</span><span class="n">userInput</span><span class="o">);</span>
      <span class="o">}</span>
      <span class="n">reader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
      <span class="n">socket</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

      <span class="c1">// Restart in an attempt to connect again when server is active again</span>
      <span class="n">restart</span><span class="o">(</span><span class="s">&quot;Trying to connect again&quot;</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">ConnectException</span> <span class="n">ce</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// restart if could not connect to server</span>
      <span class="n">restart</span><span class="o">(</span><span class="s">&quot;Could not connect&quot;</span><span class="o">,</span> <span class="n">ce</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Throwable</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// restart if there is any other error</span>
      <span class="n">restart</span><span class="o">(</span><span class="s">&quot;Error receiving data&quot;</span><span class="o">,</span> <span class="n">t</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<h2 id="using-the-custom-receiver-in-a-spark-streaming-application">在Spark Streaming应用程序中使用自定义接收器</h2>

<p>可以通过以下方式在Spark Streaming应用程序中使用自定义接收器： <code>streamingContext.receiverStream(<instance of custom receiver>)</code> 。这将使用自定义接收器实例接收的数据创建输入DStream，如下所示：</p>

<div class="codetabs">
<div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span></span><span class="c1">// Assuming ssc is the StreamingContext</span>
<span class="k">val</span> <span class="n">customReceiverStream</span> <span class="k">=</span> <span class="n">ssc</span><span class="o">.</span><span class="n">receiverStream</span><span class="o">(</span><span class="k">new</span> <span class="nc">CustomReceiver</span><span class="o">(</span><span class="n">host</span><span class="o">,</span> <span class="n">port</span><span class="o">))</span>
<span class="k">val</span> <span class="n">words</span> <span class="k">=</span> <span class="n">customReceiverStream</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">split</span><span class="o">(</span><span class="s">&quot; &quot;</span><span class="o">))</span>
<span class="o">...</span></code></pre></figure>

    <p>完整的源代码在示例<a href="https://github.com/apache/spark/blob/v3.0.0-preview/examples/src/main/scala/org/apache/spark/examples/streaming/CustomReceiver.scala">CustomReceiver.scala中</a> 。</p>

  </div>
<div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="c1">// Assuming ssc is the JavaStreamingContext</span>
<span class="n">JavaDStream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">customReceiverStream</span> <span class="o">=</span> <span class="n">ssc</span><span class="o">.</span><span class="na">receiverStream</span><span class="o">(</span><span class="k">new</span> <span class="n">JavaCustomReceiver</span><span class="o">(</span><span class="n">host</span><span class="o">,</span> <span class="n">port</span><span class="o">));</span>
<span class="n">JavaDStream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">words</span> <span class="o">=</span> <span class="n">customReceiverStream</span><span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="o">...);</span>
<span class="o">...</span></code></pre></figure>

    <p>完整的源代码在示例<a href="https://github.com/apache/spark/blob/v3.0.0-preview/examples/src/main/java/org/apache/spark/examples/streaming/JavaCustomReceiver.java">JavaCustomReceiver.java中</a> 。</p>

  </div>
</div>

<h2 id="receiver-reliability">接收器可靠性</h2>
<p>正如《 <a href="streaming-programming-guide.html#receiver-reliability">Spark Streaming编程指南》</a>中简要讨论的那样，基于其可靠性和容错语义，有两种接收器。</p>

<ol>
  <li><em>可靠的接收器</em> -对于允许确认已发送数据的<em>可靠源</em> ， <em>可靠的接收器</em>正确地向源确认已可靠地接收并存储了数据（即已成功复制）。通常，实现此接收器需要仔细考虑源确认的语义。</li>
  <li><em>不可靠的接收器</em> -一个<em>不可靠的接收器</em> <em>不</em>发送确认的资源等。它可以用于不支持确认的来源，甚至可以用于不希望或不需要进入确认复杂性的可靠来源。</li>
</ol>

<p>要实现<em>可靠的接收器</em> ，您必须使用<code>store(multiple-records)</code>存储数据。这种味道<code>store</code>是一个阻塞调用，仅在所有给定记录已存储在Spark中后才返回。如果接收方的已配置存储级别使用复制（默认情况下启用），则复制完成后将返回此调用。因此，它可以确保可靠地存储数据，并且接收方现在可以适当地确认源。这样可以确保当接收方在复制数据的过程中发生故障时，不会丢失任何数据-缓冲的数据将不会被确认，因此稍后将由源重新发送。</p>

<p><em>不可靠的接收器</em>不必实现任何这种逻辑。它可以简单地从源中接收记录，并使用一次插入它们<code>store(single-record)</code> 。虽然没有得到可靠性的保证<code>store(multiple-records)</code> ，它具有以下优点：</p>

<ul>
  <li>系统负责将数据分块为适当大小的块（请在《 <a href="streaming-programming-guide.html">Spark Streaming编程指南》中</a>查找块间隔）。</li>
  <li>如果已指定速率限制，则系统会控制接收速率。</li>
  <li>由于这两个原因，不可靠的接收器比可靠的接收器更易于实现。</li>
</ul>

<p>下表总结了两种类型的接收器的特性</p>

<table class="table">
<tbody><tr>
  <th>接收器类型</th>
  <th>特点</th>
</tr>
<tr>
  <td><b>不可靠的接收者</b></td>
  <td>易于实现。<br>系统负责块的生成和速率控制。没有容错保证，会因接收器故障而丢失数据。
  </td>
</tr>
<tr>
  <td><b>可靠的接收者</b></td>
  <td>强大的容错保证，可以确保零数据丢失。<br>接收器实现要处理的块生成和速率控制。<br>实现的复杂性取决于源的确认机制。
  </td>
</tr>
<tr>
  <td></td>
  <td></td>
</tr>
</tbody></table>


                </div>
            
             <!-- /container -->
        </div>

        <script src="js/vendor/jquery-3.4.1.min.js"></script>
        <script src="js/vendor/bootstrap.min.js"></script>
        <script src="js/vendor/anchor.min.js"></script>
        <script src="js/main.js"></script>

        <!-- MathJax Section -->
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                TeX: { equationNumbers: { autoNumber: "AMS" } }
            });
        </script>
        <script>
            // Note that we load MathJax this way to work with local file (file://), HTTP and HTTPS.
            // We could use "//cdn.mathjax...", but that won't support "file://".
            (function(d, script) {
                script = d.createElement('script');
                script.type = 'text/javascript';
                script.async = true;
                script.onload = function(){
                    MathJax.Hub.Config({
                        tex2jax: {
                            inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ],
                            displayMath: [ ["$$","$$"], ["\\[", "\\]"] ],
                            processEscapes: true,
                            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
                        }
                    });
                };
                script.src = ('https:' == document.location.protocol ? 'https://' : 'http://') +
                    'cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js' +
                    '?config=TeX-AMS-MML_HTMLorMML';
                d.getElementsByTagName('head')[0].appendChild(script);
            }(document));
        </script>
    

</body></html>