<html class="no-js" ><!--<![endif]--><head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>NULL语义-Spark 3.0.0-预览文档</title>
        

        

        <link rel="stylesheet" href="css/bootstrap.min.css">
        <style>
            body {
                padding-top: 60px;
                padding-bottom: 40px;
            }
        </style>
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="css/bootstrap-responsive.min.css">
        <link rel="stylesheet" href="css/main.css">

        <script src="js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>

        <link rel="stylesheet" href="css/pygments-default.css">

        
        <!-- Google analytics script -->
        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-32518208-2']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        </script>
        

    </head>
    <body >
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="https://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <!-- This code is taken from http://twitter.github.com/bootstrap/examples/hero.html -->

        <div class="navbar navbar-fixed-top" id="topbar">
            <div class="navbar-inner">
                <div class="container">
                    <div class="brand"><a href="index.html"><img src="img/spark-logo-hd.png" style="height:50px"></a> <span class="version">3.0.0预览版</span>
                    </div>
                    <ul class="nav">
                        <!--TODO(andyk): Add class="active" attribute to li some how.-->
                        <li><a href="index.html">总览</a></li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">编程指南<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="quick-start.html">快速开始</a></li>
                                <li><a href="rdd-programming-guide.html">RDD，累加器，广播变量</a></li>
                                <li><a href="sql-programming-guide.html">SQL，数据框和数据集</a></li>
                                <li><a href="structured-streaming-programming-guide.html">结构化流</a></li>
                                <li><a href="streaming-programming-guide.html">火花流（DStreams）</a></li>
                                <li><a href="ml-guide.html">MLlib（机器学习）</a></li>
                                <li><a href="graphx-programming-guide.html">GraphX（图形处理）</a></li>
                                <li><a href="sparkr.html">SparkR（Spark上的R）</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">API文件<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="api/scala/index.html#org.apache.spark.package">斯卡拉</a></li>
                                <li><a href="api/java/index.html">爪哇</a></li>
                                <li><a href="api/python/index.html">蟒蛇</a></li>
                                <li><a href="api/R/index.html">[R</a></li>
                                <li><a href="api/sql/index.html">SQL，内置函数</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">部署中<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="cluster-overview.html">总览</a></li>
                                <li><a href="submitting-applications.html">提交申请</a></li>
                                <li class="divider"></li>
                                <li><a href="spark-standalone.html">Spark独立</a></li>
                                <li><a href="running-on-mesos.html">梅索斯</a></li>
                                <li><a href="running-on-yarn.html">纱</a></li>
                                <li><a href="running-on-kubernetes.html">Kubernetes</a></li>
                            </ul>
                        </li>

                        <li class="dropdown">
                            <a href="api.html" class="dropdown-toggle" data-toggle="dropdown">更多<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="configuration.html">组态</a></li>
                                <li><a href="monitoring.html">监控方式</a></li>
                                <li><a href="tuning.html">调音指南</a></li>
                                <li><a href="job-scheduling.html">作业调度</a></li>
                                <li><a href="security.html">安全</a></li>
                                <li><a href="hardware-provisioning.html">硬件配置</a></li>
                                <li><a href="migration-guide.html">迁移指南</a></li>
                                <li class="divider"></li>
                                <li><a href="building-spark.html">建筑火花</a></li>
                                <li><a href="https://spark.apache.org/contributing.html">为Spark贡献</a></li>
                                <li><a href="https://spark.apache.org/third-party-projects.html">第三方项目</a></li>
                            </ul>
                        </li>
                    </ul>
                    <!--<p class="navbar-text pull-right"><span class="version-text">v3.0.0-preview</span></p>-->
                </div>
            </div>
        </div>

        <div class="container-wrapper">

            
                
                    <div class="left-menu-wrapper">
    <div class="left-menu">
        <h3><a href="sql-programming-guide.html">Spark SQL指南</a></h3>
        
<ul>

    <li>
        <a href="sql-getting-started.html">入门</a>
    </li>
    
    

    <li>
        <a href="sql-data-sources.html">数据源</a>
    </li>
    
    

    <li>
        <a href="sql-performance-tuning.html">性能调优</a>
    </li>
    
    

    <li>
        <a href="sql-distributed-sql-engine.html">分布式SQL引擎</a>
    </li>
    
    

    <li>
        <a href="sql-pyspark-pandas-with-arrow.html">PySpark使用Apache Arrow的熊猫使用指南</a>
    </li>
    
    

    <li>
        <a href="sql-migration-old.html">迁移指南</a>
    </li>
    
    

    <li>
        <a href="sql-ref.html">SQL参考</a>
    </li>
    
    
        
<ul>

    <li>
        <a href="sql-ref-datatypes.html">资料类型</a>
    </li>
    
    

    <li>
        <a href="sql-ref-null-semantics.html">
            
                <b>空语义</b>
            
        </a>
    </li>
    
    

    <li>
        <a href="sql-ref-nan-semantics.html">NaN语义学</a>
    </li>
    
    

    <li>
        <a href="sql-ref-syntax.html">SQL语法</a>
    </li>
    
    

    <li>
        <a href="sql-ref-functions.html">功能</a>
    </li>
    
    

    <li>
        <a href="sql-ref-arithmetic-ops.html">节肢手术</a>
    </li>
    
    

</ul>

    

</ul>

    </div>
</div>
                
                <input id="nav-trigger" class="nav-trigger" type="checkbox" checked>
                <label for="nav-trigger"></label>
                <div class="content-with-sidebar" id="content">
                    
                        <h1 class="title">空语义</h1>
                    

                    <h3 id="description">描述</h3>
<p>一个表由一组行组成，每行包含一组列。列与数据类型相关联，代表实体的特定属性（例如， <code>age</code>是实体的列，称为<code>person</code> ）。有时，特定于某行的列的值在该行存在时是未知的。在<code>SQL</code> ，这些值表示为<code>NULL</code> 。本节详细介绍了<code>NULL</code>各种运算符，表达式等中的值处理<code>SQL</code>结构体。</p>

<ol>
  <li><a href="#comp-operators">比较运算符中的空处理</a></li>
  <li><a href="#logical-operators">逻辑运算符中的空处理</a></li>
  <li><a href="#expressions">表达式中的空处理</a>
    <ol>
      <li><a href="#null-in-tolerant">容忍为空的表达式中的空值处理</a></li>
      <li><a href="#can-process-null">空值处理可以处理空值操作数的表达式</a></li>
      <li><a href="#built-in-aggregate">内置聚合表达式中的空处理</a></li>
    </ol>
  </li>
  <li><a href="#condition-expressions">在WHERE，HAVING和JOIN条件下进行空处理</a></li>
  <li><a href="#aggregate-operator">GROUP BY和DISTINCT中的空处理</a></li>
  <li><a href="#order-by">ORDER BY中的空处理</a></li>
  <li><a href="#set-operators">UNION，INTERSECT，EXCEPT中的Null处理</a></li>
  <li><a href="#exists-not-exists">EXISTS和NOT EXISTS子查询中的空处理</a></li>
  <li><a href="#in-not-in">IN和NOT IN子查询中的空处理</a></li>
</ol>

<style type="text/css">
.tsclass {font-size:12px;color:#333333;width:40%;border-width: 2px;border-color: #729ea5;border-collapse: collapse;}
.tsclass th {text-align: left;}
</style>

<p>下图说明了名为的表的模式布局和数据<code>person</code> 。数据包含<code>NULL</code>中的值<code>age</code>列，此表将在以下各节的各个示例中使用。
<strong><u>表格：人</u></strong></p>
<table class="tsclass" border="1">
<tbody><tr><th>ID</th><th>名称</th><th>年龄</th></tr>
<tr><td>100</td><td>乔</td><td>30</td></tr>
<tr><td>200</td><td>结婚</td><td>空值</td></tr>
<tr><td>300</td><td>麦克风</td><td>18岁</td></tr>
<tr><td>400</td><td>弗雷德</td><td>50</td></tr>
<tr><td>500</td><td>阿尔伯特</td><td>空值</td></tr>
<tr><td>600</td><td>蜜雪儿</td><td>30</td></tr>
<tr><td>700</td><td>担</td><td>50</td></tr>
</tbody></table>

<h3 id="comparision-operators-">比较运算符<a name="comp-operators"></a></h3>

<p>Apache spark支持标准比较运算符，例如'>'，'> ='，'='，'<'和'<='。这些运算符的结果未知或<code>NULL</code>当其中一个操作数或两个操作数未知时<code>NULL</code> 。为了比较<code>NULL</code>值相等，Spark提供了一个空安全的等于运算符（'<=>'），该运算符返回<code>False</code>当操作数之一是<code>NULL</code>并返回'True <code>when both the operands are</code>空值<code>. The following table illustrates the behaviour of comparison operators when one or both operands are</code> NULL`：</p>

<table class="tsclass" border="1">
  <tbody><tr>
    <th>左操作数</th>
    <th>右操作数</th>
    <th>></th>
    <th>> =</th>
    <th>=</th>
    <th><</th>
    <th><=</th>
    <th><=></th>
  </tr>
  <tr>
    <td>空值</td>
    <td>任何值</td>
    <td>空值</td>
    <td>空值</td>
    <td>空值</td>
    <td>空值</td>
    <td>空值</td>
    <td>假</td>
  </tr>
  <tr>
    <td>任何值</td>
    <td>空值</td>
    <td>空值</td>
    <td>空值</td>
    <td>空值</td>
    <td>空值</td>
    <td>空值</td>
    <td>假</td>
  </tr>
  <tr>
    <td>空值</td>
    <td>空值</td>
    <td>空值</td>
    <td>空值</td>
    <td>空值</td>
    <td>空值</td>
    <td>空值</td>
    <td>真正</td>
  </tr>
</tbody></table>

<h3 id="examples">例子</h3>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span></span><span class="c1">-- Normal comparison operators return `NULL` when one of the operand is `NULL`.</span>
<span class="k">SELECT</span> <span class="mi">5</span> <span class="o">&gt;</span> <span class="k">null</span> <span class="k">AS</span> <span class="n">expression_output</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="n">expression_output</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="k">null</span>             <span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- Normal comparison operators return `NULL` when both the operands are `NULL`.</span>
<span class="k">SELECT</span> <span class="k">null</span> <span class="o">=</span> <span class="k">null</span> <span class="k">AS</span> <span class="n">expression_output</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="n">expression_output</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="k">null</span>             <span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- Null-safe equal operator return `False` when one of the operand is `NULL`</span>
<span class="k">SELECT</span> <span class="mi">5</span> <span class="o">&lt;=&gt;</span> <span class="k">null</span> <span class="k">AS</span> <span class="n">expression_output</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="n">expression_output</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="k">false</span>            <span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- Null-safe equal operator return `True` when one of the operand is `NULL`</span>
<span class="k">SELECT</span> <span class="k">NULL</span> <span class="o">&lt;=&gt;</span> <span class="k">NULL</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="n">expression_output</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="k">true</span>             <span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span></code></pre></figure>

<h3 id="logical-operators-">逻辑运算符<a name="logical-operators"></a></h3>
<p>Spark支持标准逻辑运算符，例如<code>AND</code> ， <code>OR</code>和<code>NOT</code> 。这些运算符<code>Boolean</code>表达式作为参数并返回一个<code>Boolean</code>值。</p>

<p>下表说明了当一个或两个操作数都为逻辑运算符时的逻辑运算符的行为<code>NULL</code> 。</p>

<table class="tsclass" border="1">
  <tbody><tr>
    <th>左操作数</th>
    <th>右操作数</th>
    <th>要么</th>
    <th>和</th>
  </tr>
  <tr>
    <td>真正</td>
    <td>空值</td>
    <td>真正</td>
    <td>空值</td>
  </tr>
  <tr>
    <td>假</td>
    <td>空值</td>
    <td>空值</td>
    <td>假</td>
  </tr>
  <tr>
    <td>空值</td>
    <td>真正</td>
    <td>真正</td>
    <td>空值</td>
  </tr>
  <tr>
    <td>空值</td>
    <td>假</td>
    <td>空值</td>
    <td>空值</td>
  </tr>
  <tr>
    <td>空值</td>
    <td>空值</td>
    <td>空值</td>
    <td>空值</td>
  </tr>
</tbody></table>
<p><br></p>
<table class="tsclass" border="1">
  <tbody><tr>
    <th>操作数</th>
    <th>不</th>
  </tr>
  <tr>
    <td>空值</td>
    <td>空值</td>
  </tr>
</tbody></table>

<h3 id="examples-1">例子</h3>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span></span><span class="c1">-- Normal comparison operators return `NULL` when one of the operands is `NULL`.</span>
<span class="k">SELECT</span> <span class="p">(</span><span class="k">true</span> <span class="k">OR</span> <span class="k">null</span><span class="p">)</span> <span class="k">AS</span> <span class="n">expression_output</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="n">expression_output</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="k">true</span>             <span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- Normal comparison operators return `NULL` when both the operands are `NULL`.</span>
<span class="k">SELECT</span> <span class="p">(</span><span class="k">null</span> <span class="k">OR</span> <span class="k">false</span><span class="p">)</span> <span class="k">AS</span> <span class="n">expression_output</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="n">expression_output</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="k">null</span>             <span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- Null-safe equal operator returns `False` when one of the operands is `NULL`</span>
<span class="k">SELECT</span> <span class="k">NOT</span><span class="p">(</span><span class="k">null</span><span class="p">)</span> <span class="k">AS</span> <span class="n">expression_output</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="n">expression_output</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="k">null</span>             <span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span></code></pre></figure>

<h3 id="expressions-">表达方式<a name="expressions"></a></h3>
<p>比较运算符和逻辑运算符在Spark中被视为表达式。除了这两种表达式，Spark还支持其他形式的表达式，例如函数表达式，强制转换表达式等。Spark中的表达式可大致分为：</p>
<ul>
  <li>空容忍的表达式</li>
  <li>可以处理的表达式<code>NULL</code>值操作数<ul>
      <li>这些表达式的结果取决于表达式本身。</li>
    </ul>
  </li>
</ul>

<h4 id="null-in-tolerant-expressions-">空容忍的表达式<a name="null-in-tolerant"></a></h4>
<p>空容忍的表达式返回<code>NULL</code>当一个或多个表达式参数是<code>NULL</code>并且大多数表达式都属于此类。</p>

<h5 id="examples-2">例子</h5>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span></span><span class="k">SELECT</span> <span class="n">concat</span><span class="p">(</span><span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="k">as</span> <span class="n">expression_output</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="n">expression_output</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="k">null</span>             <span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>

<span class="k">SELECT</span> <span class="n">positive</span><span class="p">(</span><span class="k">null</span><span class="p">)</span> <span class="k">as</span> <span class="n">expression_output</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="n">expression_output</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="k">null</span>             <span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>

<span class="k">SELECT</span> <span class="n">to_date</span><span class="p">(</span><span class="k">null</span><span class="p">)</span> <span class="k">as</span> <span class="n">expression_output</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="n">expression_output</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="k">null</span>             <span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span></code></pre></figure>

<h4 id="expressions-that-can-process-null-value-operands-">可以处理空值操作数的表达式。<a name="can-process-null"></a></h4>

<p>此类表达式旨在处理<code>NULL</code>价值观。表达式的结果取决于表达式本身。例如，函数表达式<code>isnull</code>返回一个<code>true</code>在空输入和<code>false</code>在非空输入上作为函数<code>coalesce</code>返回第一个非<code>NULL</code>其操作数列表中的值。然而， <code>coalesce</code>退货<code>NULL</code>当它的所有操作数都是<code>NULL</code> 。以下是此类别的表达式的不完整列表。</p>
<ul>
  <li>合并</li>
  <li>空值</li>
  <li>空值</li>
  <li>NVL</li>
  <li>NVL2</li>
  <li>伊斯南</li>
  <li>南极</li>
  <li>一片空白</li>
  <li>ISNOTNULL</li>
  <li>ATLEASTNNONNULLS</li>
  <li>在</li>
</ul>

<h5 id="examples-3">例子</h5>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span></span><span class="k">SELECT</span> <span class="k">isnull</span><span class="p">(</span><span class="k">null</span><span class="p">)</span> <span class="k">AS</span> <span class="n">expression_output</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="n">expression_output</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="k">true</span>             <span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- Returns the first occurence of non `NULL` value.</span>
<span class="k">SELECT</span> <span class="n">coalesce</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="k">AS</span> <span class="n">expression_output</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="n">expression_output</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="mi">3</span>                <span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>

<span class="c1">-- Returns `NULL` as all its operands are `NULL`. </span>
<span class="k">SELECT</span> <span class="n">coalesce</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="k">AS</span> <span class="n">expression_output</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="n">expression_output</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="k">null</span>             <span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>

<span class="k">SELECT</span> <span class="n">isnan</span><span class="p">(</span><span class="k">null</span><span class="p">)</span> <span class="k">as</span> <span class="n">expression_output</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="n">expression_output</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span>
  <span class="o">|</span><span class="k">false</span>            <span class="o">|</span>
  <span class="o">+</span><span class="c1">-----------------+</span></code></pre></figure>

<h4 id="builtin-aggregate-expressions-">内置聚合表达式<a name="built-in-aggregate"></a></h4>
<p>聚合函数通过处理一组输入行来计算单个结果。以下是规则<code>NULL</code>值由聚合函数处理。</p>
<ul>
  <li><code>NULL</code>所有聚合函数都会从处理中忽略这些值。
    <ul>
      <li>唯一例外的是COUNT（*）函数。</li>
    </ul>
  </li>
  <li>一些聚合函数返回<code>NULL</code>当所有输入值均为<code>NULL</code>或输入数据集为空。<br>这些功能的列表是：<ul>
      <li>最大值</li>
      <li>最小</li>
      <li>和</li>
      <li>AVG</li>
      <li>每一个</li>
      <li>任何</li>
      <li>一些</li>
    </ul>
  </li>
</ul>

<h4 id="examples-4">例子</h4>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span></span><span class="c1">-- `count(*)` does not skip `NULL` values.</span>
<span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">person</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">--------+</span>
  <span class="o">|</span><span class="k">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+</span>
  <span class="o">|</span><span class="mi">7</span>       <span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- `NULL` values in column `age` are skipped from processing.</span>
<span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">person</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">----------+</span>
  <span class="o">|</span><span class="k">count</span><span class="p">(</span><span class="n">age</span><span class="p">)</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">----------+</span>
  <span class="o">|</span><span class="mi">5</span>         <span class="o">|</span>
  <span class="o">+</span><span class="c1">----------+</span>

<span class="c1">-- `count(*)` on an empty input set returns 0. This is unlike the other</span>
<span class="c1">-- aggregate functions, such as `max`, which return `NULL`.</span>
<span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">where</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">--------+</span>
  <span class="o">|</span><span class="k">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+</span>
  <span class="o">|</span><span class="mi">0</span>       <span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- `NULL` values are excluded from computation of maximum value.</span>
<span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">person</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">--------+</span>
  <span class="o">|</span><span class="k">max</span><span class="p">(</span><span class="n">age</span><span class="p">)</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+</span>
  <span class="o">|</span><span class="mi">50</span>      <span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+</span>

<span class="c1">-- `max` returns `NULL` on an empty input set.</span>
<span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">where</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">--------+</span>
  <span class="o">|</span><span class="k">max</span><span class="p">(</span><span class="n">age</span><span class="p">)</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+</span>
  <span class="o">|</span><span class="k">null</span>    <span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+</span></code></pre></figure>

<h3 id="condition-expressions-in-where-having-and-join-clauses-">WHERE，HAVING和JOIN子句中的条件表达式。<a name="condition-expressions"></a></h3>
<p><code>WHERE</code> ， <code>HAVING</code>运算符根据用户指定的条件过滤行。一种<code>JOIN</code>运算符用于根据联接条件合并两个表中的行。对于所有三个运算符，条件表达式都是布尔表达式，可以返回<code>True, False or Unknown (NULL)</code> 。如果条件的结果是，他们将“满意” <code>True</code> 。</p>

<h4 id="examples-5">例子</h4>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span></span><span class="c1">-- Persons whose age is unknown (`NULL`) are filtered out from the result set.</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">WHERE</span> <span class="n">age</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">--------+---+</span>
  <span class="o">|</span><span class="n">name</span>    <span class="o">|</span><span class="n">age</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+---+</span>
  <span class="o">|</span><span class="n">Michelle</span><span class="o">|</span><span class="mi">30</span> <span class="o">|</span>
  <span class="o">|</span><span class="n">Fred</span>    <span class="o">|</span><span class="mi">50</span> <span class="o">|</span>
  <span class="o">|</span><span class="n">Mike</span>    <span class="o">|</span><span class="mi">18</span> <span class="o">|</span>
  <span class="o">|</span><span class="n">Dan</span>     <span class="o">|</span><span class="mi">50</span> <span class="o">|</span>
  <span class="o">|</span><span class="n">Joe</span>     <span class="o">|</span><span class="mi">30</span> <span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+---+</span>

<span class="c1">-- `IS NULL` expression is used in disjunction to select the persons</span>
<span class="c1">-- with unknown (`NULL`) records.</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">WHERE</span> <span class="n">age</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">OR</span> <span class="n">age</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">--------+----+</span>
  <span class="o">|</span><span class="n">name</span>    <span class="o">|</span><span class="n">age</span> <span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+----+</span>
  <span class="o">|</span><span class="n">Albert</span>  <span class="o">|</span><span class="k">null</span><span class="o">|</span>
  <span class="o">|</span><span class="n">Michelle</span><span class="o">|</span><span class="mi">30</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Fred</span>    <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Mike</span>    <span class="o">|</span><span class="mi">18</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Dan</span>     <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Marry</span>   <span class="o">|</span><span class="k">null</span><span class="o">|</span>
  <span class="o">|</span><span class="n">Joe</span>     <span class="o">|</span><span class="mi">30</span>  <span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+----+</span>

<span class="c1">-- Person with unknown(`NULL`) ages are skipped from processing.</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">age</span> <span class="k">HAVING</span> <span class="k">max</span><span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">18</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">---+--------+                                                                  </span>
  <span class="o">|</span><span class="n">age</span><span class="o">|</span><span class="k">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">---+--------+</span>
  <span class="o">|</span><span class="mi">50</span> <span class="o">|</span><span class="mi">2</span>       <span class="o">|</span>
  <span class="o">|</span><span class="mi">30</span> <span class="o">|</span><span class="mi">2</span>       <span class="o">|</span>
  <span class="o">+</span><span class="c1">---+--------+</span>

<span class="c1">-- A self join case with a join condition `p1.age = p2.age AND p1.name = p2.name`.</span>
<span class="c1">-- The persons with unknown age (`NULL`) are filtered out by the join operator.</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">person</span> <span class="n">p1</span><span class="p">,</span> <span class="n">person</span> <span class="n">p2</span>
<span class="k">WHERE</span> <span class="n">p1</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">p2</span><span class="p">.</span><span class="n">age</span>
  <span class="k">AND</span> <span class="n">p1</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">p2</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">--------+---+--------+---+</span>
  <span class="o">|</span><span class="n">name</span>    <span class="o">|</span><span class="n">age</span><span class="o">|</span><span class="n">name</span>    <span class="o">|</span><span class="n">age</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+---+--------+---+</span>
  <span class="o">|</span><span class="n">Michelle</span><span class="o">|</span><span class="mi">30</span> <span class="o">|</span><span class="n">Michelle</span><span class="o">|</span><span class="mi">30</span> <span class="o">|</span>
  <span class="o">|</span><span class="n">Fred</span>    <span class="o">|</span><span class="mi">50</span> <span class="o">|</span><span class="n">Fred</span>    <span class="o">|</span><span class="mi">50</span> <span class="o">|</span>
  <span class="o">|</span><span class="n">Mike</span>    <span class="o">|</span><span class="mi">18</span> <span class="o">|</span><span class="n">Mike</span>    <span class="o">|</span><span class="mi">18</span> <span class="o">|</span>
  <span class="o">|</span><span class="n">Dan</span>     <span class="o">|</span><span class="mi">50</span> <span class="o">|</span><span class="n">Dan</span>     <span class="o">|</span><span class="mi">50</span> <span class="o">|</span>
  <span class="o">|</span><span class="n">Joe</span>     <span class="o">|</span><span class="mi">30</span> <span class="o">|</span><span class="n">Joe</span>     <span class="o">|</span><span class="mi">30</span> <span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+---+--------+---+</span>

<span class="c1">-- The age column from both legs of join are compared using null-safe equal which</span>
<span class="c1">-- is why the persons with unknown age (`NULL`) are qualified by the join.</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">person</span> <span class="n">p1</span><span class="p">,</span> <span class="n">person</span> <span class="n">p2</span>
<span class="k">WHERE</span> <span class="n">p1</span><span class="p">.</span><span class="n">age</span> <span class="o">&lt;=&gt;</span> <span class="n">p2</span><span class="p">.</span><span class="n">age</span>
  <span class="k">AND</span> <span class="n">p1</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">p2</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------+----+--------+----+</span>
<span class="o">|</span>    <span class="n">name</span><span class="o">|</span> <span class="n">age</span><span class="o">|</span>    <span class="n">name</span><span class="o">|</span> <span class="n">age</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+----+--------+----+</span>
<span class="o">|</span>  <span class="n">Albert</span><span class="o">|</span><span class="k">null</span><span class="o">|</span>  <span class="n">Albert</span><span class="o">|</span><span class="k">null</span><span class="o">|</span>
<span class="o">|</span><span class="n">Michelle</span><span class="o">|</span>  <span class="mi">30</span><span class="o">|</span><span class="n">Michelle</span><span class="o">|</span>  <span class="mi">30</span><span class="o">|</span>
<span class="o">|</span>    <span class="n">Fred</span><span class="o">|</span>  <span class="mi">50</span><span class="o">|</span>    <span class="n">Fred</span><span class="o">|</span>  <span class="mi">50</span><span class="o">|</span>
<span class="o">|</span>    <span class="n">Mike</span><span class="o">|</span>  <span class="mi">18</span><span class="o">|</span>    <span class="n">Mike</span><span class="o">|</span>  <span class="mi">18</span><span class="o">|</span>
<span class="o">|</span>     <span class="n">Dan</span><span class="o">|</span>  <span class="mi">50</span><span class="o">|</span>     <span class="n">Dan</span><span class="o">|</span>  <span class="mi">50</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">Marry</span><span class="o">|</span><span class="k">null</span><span class="o">|</span>   <span class="n">Marry</span><span class="o">|</span><span class="k">null</span><span class="o">|</span>
<span class="o">|</span>     <span class="n">Joe</span><span class="o">|</span>  <span class="mi">30</span><span class="o">|</span>     <span class="n">Joe</span><span class="o">|</span>  <span class="mi">30</span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------+----+--------+----+</span></code></pre></figure>

<h3 id="aggregate-operator-group-by-distinct-">集合运算符（GROUP BY，DISTINCT）<a name="aggregate-operator"></a></h3>
<p>如上一节中所述， <a href="sql-ref-null-semantics.html#comparision-operators">比较运算符</a> ，两个<code>NULL</code>值不相等。但是，出于分组和不同处理的目的，两个或多个值<code>NULL data</code>被组合到同一个存储桶中此行为符合SQL标准和其他企业数据库管理系统。</p>

<h4 id="examples-6">例子</h4>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span></span><span class="c1">-- `NULL` values are put in one bucket in `GROUP BY` processing.</span>
<span class="k">SELECT</span> <span class="n">age</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">age</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">----+--------+                                                                 </span>
  <span class="o">|</span><span class="n">age</span> <span class="o">|</span><span class="k">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">----+--------+</span>
  <span class="o">|</span><span class="k">null</span><span class="o">|</span><span class="mi">2</span>       <span class="o">|</span>
  <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span><span class="mi">2</span>       <span class="o">|</span>
  <span class="o">|</span><span class="mi">30</span>  <span class="o">|</span><span class="mi">2</span>       <span class="o">|</span>
  <span class="o">|</span><span class="mi">18</span>  <span class="o">|</span><span class="mi">1</span>       <span class="o">|</span>
  <span class="o">+</span><span class="c1">----+--------+</span>

<span class="c1">-- All `NULL` ages are considered one distinct value in `DISTINCT` processing.</span>
<span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">age</span> <span class="k">FROM</span> <span class="n">person</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">----+</span>
  <span class="o">|</span><span class="n">age</span> <span class="o">|</span>
  <span class="o">+</span><span class="c1">----+</span>
  <span class="o">|</span><span class="k">null</span><span class="o">|</span>
  <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span>
  <span class="o">|</span><span class="mi">30</span>  <span class="o">|</span>
  <span class="o">|</span><span class="mi">18</span>  <span class="o">|</span>
  <span class="o">+</span><span class="c1">----+</span></code></pre></figure>

<h3 id="sort-operator-order-by-clause-">排序运算符（ORDER BY子句）<a name="order-by"></a></h3>
<p>Spark SQL在中支持空排序规范<code>ORDER BY</code>条款。Spark处理<code>ORDER BY</code>子句将所有<code>NULL</code>值的第一或最后取决于空排序规范。默认情况下，所有<code>NULL</code>值放在第一位。</p>

<h4 id="examples-7">例子</h4>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span></span><span class="c1">-- `NULL` values are shown at first and other values</span>
<span class="c1">-- are sorted in ascending way.</span>
<span class="k">SELECT</span> <span class="n">age</span><span class="p">,</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">age</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">----+--------+</span>
  <span class="o">|</span><span class="n">age</span> <span class="o">|</span><span class="n">name</span>    <span class="o">|</span>
  <span class="o">+</span><span class="c1">----+--------+</span>
  <span class="o">|</span><span class="k">null</span><span class="o">|</span><span class="n">Marry</span>   <span class="o">|</span>
  <span class="o">|</span><span class="k">null</span><span class="o">|</span><span class="n">Albert</span>  <span class="o">|</span>
  <span class="o">|</span><span class="mi">18</span>  <span class="o">|</span><span class="n">Mike</span>    <span class="o">|</span>
  <span class="o">|</span><span class="mi">30</span>  <span class="o">|</span><span class="n">Michelle</span><span class="o">|</span>
  <span class="o">|</span><span class="mi">30</span>  <span class="o">|</span><span class="n">Joe</span>     <span class="o">|</span>
  <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span><span class="n">Fred</span>    <span class="o">|</span>
  <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span><span class="n">Dan</span>     <span class="o">|</span>
  <span class="o">+</span><span class="c1">----+--------+</span>

<span class="c1">-- Column values other than `NULL` are sorted in ascending</span>
<span class="c1">-- way and `NULL` values are shown at the last.</span>
<span class="k">SELECT</span> <span class="n">age</span><span class="p">,</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">age</span> <span class="n">NULLS</span> <span class="k">LAST</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">----+--------+</span>
  <span class="o">|</span><span class="n">age</span> <span class="o">|</span><span class="n">name</span>    <span class="o">|</span>
  <span class="o">+</span><span class="c1">----+--------+</span>
  <span class="o">|</span><span class="mi">18</span>  <span class="o">|</span><span class="n">Mike</span>    <span class="o">|</span>
  <span class="o">|</span><span class="mi">30</span>  <span class="o">|</span><span class="n">Michelle</span><span class="o">|</span>
  <span class="o">|</span><span class="mi">30</span>  <span class="o">|</span><span class="n">Joe</span>     <span class="o">|</span>
  <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span><span class="n">Dan</span>     <span class="o">|</span>
  <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span><span class="n">Fred</span>    <span class="o">|</span>
  <span class="o">|</span><span class="k">null</span><span class="o">|</span><span class="n">Marry</span>   <span class="o">|</span>
  <span class="o">|</span><span class="k">null</span><span class="o">|</span><span class="n">Albert</span>  <span class="o">|</span>
  <span class="o">+</span><span class="c1">----+--------+</span>

<span class="c1">-- Columns other than `NULL` values are sorted in descending</span>
<span class="c1">-- and `NULL` values are shown at the last.</span>
<span class="k">SELECT</span> <span class="n">age</span><span class="p">,</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">age</span> <span class="k">DESC</span> <span class="n">NULLS</span> <span class="k">LAST</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">----+--------+</span>
  <span class="o">|</span><span class="n">age</span> <span class="o">|</span><span class="n">name</span>    <span class="o">|</span>
  <span class="o">+</span><span class="c1">----+--------+</span>
  <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span><span class="n">Fred</span>    <span class="o">|</span>
  <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span><span class="n">Dan</span>     <span class="o">|</span>
  <span class="o">|</span><span class="mi">30</span>  <span class="o">|</span><span class="n">Michelle</span><span class="o">|</span>
  <span class="o">|</span><span class="mi">30</span>  <span class="o">|</span><span class="n">Joe</span>     <span class="o">|</span>
  <span class="o">|</span><span class="mi">18</span>  <span class="o">|</span><span class="n">Mike</span>    <span class="o">|</span>
  <span class="o">|</span><span class="k">null</span><span class="o">|</span><span class="n">Marry</span>   <span class="o">|</span>
  <span class="o">|</span><span class="k">null</span><span class="o">|</span><span class="n">Albert</span>  <span class="o">|</span>
  <span class="o">+</span><span class="c1">----+--------+</span></code></pre></figure>

<h3 id="set-operators-union-intersect-except-">集合运算符（UNION，INTERSECT，EXCEPT）<a name="set-operators"></a></h3>
<p><code>NULL</code>在设置操作的上下文中，以null安全的方式比较值是否相等。这意味着在比较行时，两个<code>NULL</code>值与常规值不同被认为是相等的<code>EqualTo</code> （ <code>=</code> ）运算符。</p>

<h4 id="examples-8">例子</h4>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span></span><span class="k">CREATE</span> <span class="k">VIEW</span> <span class="n">unknown_age</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">WHERE</span> <span class="n">age</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">;</span>

<span class="c1">-- Only common rows between two legs of `INTERSECT` are in the </span>
<span class="c1">-- result set. The comparison between columns of the row are done</span>
<span class="c1">-- in a null-safe manner.</span>
<span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span> <span class="k">FROM</span> <span class="n">person</span>
<span class="k">INTERSECT</span>
<span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span> <span class="k">from</span> <span class="n">unknown_age</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">------+----+                                                                   </span>
  <span class="o">|</span><span class="n">name</span>  <span class="o">|</span><span class="n">age</span> <span class="o">|</span>
  <span class="o">+</span><span class="c1">------+----+</span>
  <span class="o">|</span><span class="n">Albert</span><span class="o">|</span><span class="k">null</span><span class="o">|</span>
  <span class="o">|</span><span class="n">Marry</span> <span class="o">|</span><span class="k">null</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">------+----+</span>

<span class="c1">-- `NULL` values from two legs of the `EXCEPT` are not in output. </span>
<span class="c1">-- This basically shows that the comparison happens in a null-safe manner.</span>
<span class="k">SELECT</span> <span class="n">age</span><span class="p">,</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">person</span>
<span class="k">EXCEPT</span>
<span class="k">SELECT</span> <span class="n">age</span> <span class="k">FROM</span> <span class="n">unknown_age</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">---+--------+                                                                  </span>
  <span class="o">|</span><span class="n">age</span><span class="o">|</span><span class="n">name</span>    <span class="o">|</span>
  <span class="o">+</span><span class="c1">---+--------+</span>
  <span class="o">|</span><span class="mi">30</span> <span class="o">|</span><span class="n">Joe</span>     <span class="o">|</span>
  <span class="o">|</span><span class="mi">50</span> <span class="o">|</span><span class="n">Fred</span>    <span class="o">|</span>
  <span class="o">|</span><span class="mi">30</span> <span class="o">|</span><span class="n">Michelle</span><span class="o">|</span>
  <span class="o">|</span><span class="mi">18</span> <span class="o">|</span><span class="n">Mike</span>    <span class="o">|</span>
  <span class="o">|</span><span class="mi">50</span> <span class="o">|</span><span class="n">Dan</span>     <span class="o">|</span>
  <span class="o">+</span><span class="c1">---+--------+</span>

<span class="c1">-- Performs `UNION` operation between two sets of data. </span>
<span class="c1">-- The comparison between columns of the row ae done in</span>
<span class="c1">-- null-safe manner.</span>
<span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span> <span class="k">FROM</span> <span class="n">person</span>
<span class="k">UNION</span> 
<span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span> <span class="k">FROM</span> <span class="n">unknown_age</span><span class="p">;</span>
  <span class="o">+</span><span class="c1">--------+----+                                                                 </span>
  <span class="o">|</span><span class="n">name</span>    <span class="o">|</span><span class="n">age</span> <span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+----+</span>
  <span class="o">|</span><span class="n">Albert</span>  <span class="o">|</span><span class="k">null</span><span class="o">|</span>
  <span class="o">|</span><span class="n">Joe</span>     <span class="o">|</span><span class="mi">30</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Michelle</span><span class="o">|</span><span class="mi">30</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Marry</span>   <span class="o">|</span><span class="k">null</span><span class="o">|</span>
  <span class="o">|</span><span class="n">Fred</span>    <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Mike</span>    <span class="o">|</span><span class="mi">18</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Dan</span>     <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+----+</span></code></pre></figure>

<h3 id="existsnot-exists-subquery-">EXISTS / NOT EXISTS子查询<a name="exists-not-exists"></a></h3>
<p>在Spark中，可以在WHERE子句中使用EXISTS和NOT EXISTS表达式。这些是布尔表达式，它们返回<code>TRUE</code>要么<code>FALSE</code> 。换句话说，EXISTS是成员资格条件并返回<code>TRUE</code>当它引用的子查询返回一或多个行时。同样，NOT EXISTS是一个非成员条件，当子查询没有返回行或零行时，返回TRUE。</p>

<p>这两个表达式不受子查询结果中是否存在NULL的影响。</p>

<h4 id="examples-9">例子</h4>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span></span><span class="c1">-- Even if subquery produces rows with `NULL` values, the `EXISTS` expression</span>
<span class="c1">-- evaluates to `TRUE` as the subquery produces 1 row.</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">WHERE</span> <span class="k">EXISTS</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">null</span><span class="p">);</span>
  <span class="o">+</span><span class="c1">--------+----+                                                                 </span>
  <span class="o">|</span><span class="n">name</span>    <span class="o">|</span><span class="n">age</span> <span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+----+</span>
  <span class="o">|</span><span class="n">Albert</span>  <span class="o">|</span><span class="k">null</span><span class="o">|</span>
  <span class="o">|</span><span class="n">Michelle</span><span class="o">|</span><span class="mi">30</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Fred</span>    <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Mike</span>    <span class="o">|</span><span class="mi">18</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Dan</span>     <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Marry</span>   <span class="o">|</span><span class="k">null</span><span class="o">|</span>
  <span class="o">|</span><span class="n">Joe</span>     <span class="o">|</span><span class="mi">30</span>  <span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+----+</span>

<span class="c1">-- `NOT EXISTS` expression returns `FALSE`. It returns `TRUE` only when</span>
<span class="c1">-- subquery produces no rows. In this case, it returns 1 row.</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">WHERE</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">null</span><span class="p">);</span>
  <span class="o">+</span><span class="c1">----+---+</span>
  <span class="o">|</span><span class="n">name</span><span class="o">|</span><span class="n">age</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">----+---+</span>
  <span class="o">+</span><span class="c1">----+---+</span>

<span class="c1">-- `NOT EXISTS` expression returns `TRUE`.</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">WHERE</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="p">(</span><span class="k">SELECT</span> <span class="mi">1</span> <span class="k">WHERE</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
  <span class="o">+</span><span class="c1">--------+----+</span>
  <span class="o">|</span><span class="n">name</span>    <span class="o">|</span><span class="n">age</span> <span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+----+</span>
  <span class="o">|</span><span class="n">Albert</span>  <span class="o">|</span><span class="k">null</span><span class="o">|</span>
  <span class="o">|</span><span class="n">Michelle</span><span class="o">|</span><span class="mi">30</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Fred</span>    <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Mike</span>    <span class="o">|</span><span class="mi">18</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Dan</span>     <span class="o">|</span><span class="mi">50</span>  <span class="o">|</span>
  <span class="o">|</span><span class="n">Marry</span>   <span class="o">|</span><span class="k">null</span><span class="o">|</span>
  <span class="o">|</span><span class="n">Joe</span>     <span class="o">|</span><span class="mi">30</span>  <span class="o">|</span>
  <span class="o">+</span><span class="c1">--------+----+</span></code></pre></figure>

<h3 id="innot-in-subquery-">IN / NOT IN子查询<a name="in-not-in"></a></h3>
<p>在Spark中， <code>IN</code>和<code>NOT IN</code>在查询的WHERE子句中允许使用表达式。不像<code>EXISTS</code>表达， <code>IN</code>表达式可以返回一个<code>TRUE</code> ， <code>FALSE</code>要么<code>UNKNOWN (NULL)</code>值。从概念上讲<code>IN</code>表达式在语义上等同于由析取运算符（ <code>OR</code> ）。例如，c1 IN（1、2、3）在语义上等同于<code>(C1 = 1 OR c1 = 2 OR c1 = 3)</code> 。</p>

<p>至于处理<code>NULL</code>就价值而言，语义可以从<code>NULL</code>比较运算符中的值处理（ <code>=</code> ）和逻辑运算符（ <code>OR</code> ）。总而言之，以下是计算结果的规则<code>IN</code>表达。</p>

<ul>
  <li>在列表中找到有问题的非NULL值时，返回TRUE</li>
  <li>当在列表中未找到非NULL值且列表不包含NULL值时，返回FALSE</li>
  <li>值为时返回UNKNOWN <code>NULL</code> ，或者在列表中找不到非NULL值，并且该列表至少包含一个<code>NULL</code>值</li>
</ul>

<h4 id="examples-10">例子</h4>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span></span><span class="c1">-- The subquery has only `NULL` value in its result set. Therefore,</span>
<span class="c1">-- the result of `IN` predicate is UNKNOWN.</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">WHERE</span> <span class="n">age</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">null</span><span class="p">);</span>
  <span class="o">+</span><span class="c1">----+---+</span>
  <span class="o">|</span><span class="n">name</span><span class="o">|</span><span class="n">age</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">----+---+</span>
  <span class="o">+</span><span class="c1">----+---+</span>

<span class="c1">-- The subquery has `NULL` value in the result set as well as a valid </span>
<span class="c1">-- value `50`. Rows with age = 50 are returned. </span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">person</span>
<span class="k">WHERE</span> <span class="n">age</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">age</span> <span class="k">FROM</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="p">(</span><span class="k">null</span><span class="p">)</span> <span class="n">sub</span><span class="p">(</span><span class="n">age</span><span class="p">));</span>
  <span class="o">+</span><span class="c1">----+---+</span>
  <span class="o">|</span><span class="n">name</span><span class="o">|</span><span class="n">age</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">----+---+</span>
  <span class="o">|</span><span class="n">Fred</span><span class="o">|</span><span class="mi">50</span> <span class="o">|</span>
  <span class="o">|</span><span class="n">Dan</span> <span class="o">|</span><span class="mi">50</span> <span class="o">|</span>
  <span class="o">+</span><span class="c1">----+---+</span>

<span class="c1">-- Since subquery has `NULL` value in the result set, the `NOT IN`</span>
<span class="c1">-- predicate would return UNKNOWN. Hence, no rows are</span>
<span class="c1">-- qualified for this query.</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">person</span>
<span class="k">WHERE</span> <span class="n">age</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">age</span> <span class="k">FROM</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="p">(</span><span class="k">null</span><span class="p">)</span> <span class="n">sub</span><span class="p">(</span><span class="n">age</span><span class="p">));</span>
  <span class="o">+</span><span class="c1">----+---+</span>
  <span class="o">|</span><span class="n">name</span><span class="o">|</span><span class="n">age</span><span class="o">|</span>
  <span class="o">+</span><span class="c1">----+---+</span>
  <span class="o">+</span><span class="c1">----+---+</span></code></pre></figure>



                </div>
            
             <!-- /container -->
        </div>

        <script src="js/vendor/jquery-3.4.1.min.js"></script>
        <script src="js/vendor/bootstrap.min.js"></script>
        <script src="js/vendor/anchor.min.js"></script>
        <script src="js/main.js"></script>

        <!-- MathJax Section -->
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                TeX: { equationNumbers: { autoNumber: "AMS" } }
            });
        </script>
        <script>
            // Note that we load MathJax this way to work with local file (file://), HTTP and HTTPS.
            // We could use "//cdn.mathjax...", but that won't support "file://".
            (function(d, script) {
                script = d.createElement('script');
                script.type = 'text/javascript';
                script.async = true;
                script.onload = function(){
                    MathJax.Hub.Config({
                        tex2jax: {
                            inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ],
                            displayMath: [ ["$$","$$"], ["\\[", "\\]"] ],
                            processEscapes: true,
                            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
                        }
                    });
                };
                script.src = ('https:' == document.location.protocol ? 'https://' : 'http://') +
                    'cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js' +
                    '?config=TeX-AMS-MML_HTMLorMML';
                d.getElementsByTagName('head')[0].appendChild(script);
            }(document));
        </script>
    

</body></html>