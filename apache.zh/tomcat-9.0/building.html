<html lang="zh-Hans" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="./images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>Apache Tomcat 9（9.0.21）-构建Tomcat</title><script type="application/javascript" data-comments-identifier="tomcat-9.0-doc/building">
    "use strict"; // Enable strict mode

    (function() {
      var thisScript = document.currentScript;
      if (!thisScript) { // Workaround for IE <= 11
        var scripts = document.getElementsByTagName("script");
        thisScript = scripts[scripts.length - 1];
      }
      document.addEventListener("DOMContentLoaded", (function() {
        var commentsDiv = document.getElementById("comments_thread");
        var commentsShortname = "tomcat";
        var commentsIdentifier = "https://tomcat.apache.org/" +
          thisScript.getAttribute("data-comments-identifier") + ".html";

        (function(w, d) {
          if (w.location.hostname.toLowerCase() == "tomcat.apache.org") {
            var s = d.createElement("script");
            s.type = "application/javascript";
            s.async = true;
            s.src = "https://comments.apache.org/show_comments.lua?site=" +
              encodeURIComponent(commentsShortname) +
              "&page=" + encodeURIComponent(commentsIdentifier);
            d.head.appendChild(s);
          } else {
            commentsDiv.appendChild(d.createTextNode("Comments are disabled for this page at the moment."));
          }
        })(window, document);
      }), false);
    })();
  </script></head><body ><div id="wrapper"><header><div id="header"><div><div><div class="logo noPrint"><a href="https://tomcat.apache.org/"><img alt="Tomcat主页" src="./images/tomcat.png"></a></div><div style="height:1px"></div><div class="asfLogo noPrint"><a href="https://www.apache.org/" target="_blank"><img src="./images/asf-logo.svg" alt="Apache软件基金会" style="width:266px;height:83px"></a></div><h1>Apache Tomcat 9</h1><div class="versionInfo">版本9.0.21， <time datetime="2019-06-04"> 2019年6月4日</time></div><div style="height:1px"></div><div style="clear:left"></div></div></div></div></header><div id="middle"><div><div id="mainLeft" class="noprint"><div><nav><div><h2>链接</h2><ul><li><a href="index.html">文件首页</a></li><li><a href="https://wiki.apache.org/tomcat/FAQ">常问问题</a></li><li><a href="#comments_section">用户评论</a></li></ul></div><div><h2>用户指南</h2><ul><li><a href="introduction.html">1）简介</a></li><li><a href="setup.html">2）设定</a></li><li><a href="appdev/index.html">3）第一个webapp</a></li><li><a href="deployer-howto.html">4）部署者</a></li><li><a href="manager-howto.html">5）经理</a></li><li><a href="host-manager-howto.html">6）主机管理员</a></li><li><a href="realm-howto.html">7）领域和AAA</a></li><li><a href="security-manager-howto.html">8）安全经理</a></li><li><a href="jndi-resources-howto.html">9）JNDI资源</a></li><li><a href="jndi-datasource-examples-howto.html">10）JDBC数据源</a></li><li><a href="class-loader-howto.html">11）类加载</a></li><li><a href="jasper-howto.html">12）JSP</a></li><li><a href="ssl-howto.html">13）SSL / TLS</a></li><li><a href="ssi-howto.html">14）SSI</a></li><li><a href="cgi-howto.html">15）CGI</a></li><li><a href="proxy-howto.html">16）代理支持</a></li><li><a href="mbeans-descriptors-howto.html">17）MBean描述符</a></li><li><a href="default-servlet.html">18）默认Servlet</a></li><li><a href="cluster-howto.html">19）聚类</a></li><li><a href="balancer-howto.html">20）负载均衡器</a></li><li><a href="connectors.html">21）连接器</a></li><li><a href="monitoring.html">22）监控与管理</a></li><li><a href="logging.html">23）记录</a></li><li><a href="apr.html">24）APR /本地</a></li><li><a href="virtual-hosting-howto.html">25）虚拟主机</a></li><li><a href="aio.html">26）高级IO</a></li><li><a href="extras.html">27）附加组件</a></li><li><a href="maven-jars.html">28）行刑</a></li><li><a href="security-howto.html">29）安全注意事项</a></li><li><a href="windows-service-howto.html">30）Windows服务</a></li><li><a href="windows-auth-howto.html">31）Windows身份验证</a></li><li><a href="jdbc-pool.html">32）Tomcat的JDBC池</a></li><li><a href="web-socket-howto.html">33）WebSocket</a></li><li><a href="rewrite.html">34）改写</a></li></ul></div><div><h2>参考</h2><ul><li><a href="RELEASE-NOTES.txt">发行说明</a></li><li><a href="config/index.html">组态</a></li><li><a href="api/index.html">Tomcat Java文档</a></li><li><a href="servletapi/index.html">Servlet Java文档</a></li><li><a href="jspapi/index.html">JSP 2.3 Java文档</a></li><li><a href="elapi/index.html">EL 3.0 Java文档</a></li><li><a href="websocketapi/index.html">WebSocket 1.1 Java文档</a></li><li><a href="https://tomcat.apache.org/connectors-doc/">JK 1.2文档</a></li></ul></div><div><h2>Apache Tomcat开发</h2><ul><li><a href="building.html">建造</a></li><li><a href="changelog.html">变更日志</a></li><li><a href="https://wiki.apache.org/tomcat/TomcatVersions">状态</a></li><li><a href="developers.html">开发者</a></li><li><a href="architecture/index.html">建筑</a></li><li><a href="funcspecs/index.html">功能规格。</a></li><li><a href="tribes/introduction.html">部族</a></li></ul></div></nav></div></div><div id="mainRight"><div id="content"><h2>构建Tomcat</h2><h3 id="Table_of_Contents">目录</h3><div class="text">
<ul><li><a href="#Introduction">介绍</a></li><li><a href="#Download_a_Java_Development_Kit_(JDK)_version_8">下载Java开发工具包（JDK）版本8</a></li><li><a href="#Install_Apache_Ant_1.9.8_or_later">安装Apache Ant 1.9.8或更高版本</a></li><li><a href="#Checkout_or_obtain_the_Tomcat_source_code">签出或获取Tomcat源代码</a></li><li><a href="#Configure_download_area">配置下载区域</a></li><li><a href="#Building_Tomcat">构建Tomcat</a></li><li><a href="#Building_with_Eclipse">使用Eclipse构建</a></li><li><a href="#Building_with_other_IDEs">与其他IDE一起构建</a></li></ul>
</div><h3 id="Introduction">介绍</h3><div class="text">

<p>从源代码构建Apache Tomcat非常容易，这是对Tomcat进行贡献的第一步。文件<a href="BUILDING.txt">BUILDING.txt</a>中提供了完整而全面的说明。以下是快速的分步指南。
</p>

</div><h3 id="Download_a_Java_Development_Kit_(JDK)_version_8">下载Java开发工具包（JDK）版本8</h3><div class="text">

<p>构建Apache Tomcat需要安装JDK（版本8）。您可以从下载一个<br>
<a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a><br>
<a href="http://openjdk.java.net/install/index.html">http://openjdk.java.net/install/index.html</a><br>或其他JDK供应商。
</p>

<p>
<b>重要说明</b> ：将环境变量JAVA_HOME设置为安装JDK版本的目录的路径名。
</p>

</div><h3 id="Install_Apache_Ant_1.9.8_or_later">安装Apache Ant 1.9.8或更高版本</h3><div class="text">

<p>从<a href="https://ant.apache.org/bindownload.cgi">此处</a>下载Ant 1.9.8或更高版本的二进制发行版。
</p>

<p>将二进制分发包解压缩到一个方便的位置，以便Ant发行版驻留在其自己的目录中（通常命名为<code>apache-ant-1.9.x</code> ）。在本指南的其余部分，符号名称<code>${ant.home}</code>用于引用Ant安装目录的完整路径名。
</p>

<p>
<b>重要说明</b> ：创建一个ANT_HOME环境变量以指向目录<code>${ant.home}</code> ，并修改PATH环境变量以包含目录<code>${ant.home}/bin</code>在其列表中。这使得<code>ant</code>可用的命令行脚本，它将用于实际执行构建。
</p>

</div><h3 id="Checkout_or_obtain_the_Tomcat_source_code">签出或获取Tomcat源代码</h3><div class="text">

  <p>Tomcat SVN存储库URL： <a href="https://svn.apache.org/repos/asf/tomcat/trunk/">https</a> : <a href="https://svn.apache.org/repos/asf/tomcat/trunk/">//svn.apache.org/repos/asf/tomcat/trunk/</a>
  </p>
  <p>Tomcat源代码包： <a href="https://tomcat.apache.org/download-90.cgi">https</a> : <a href="https://tomcat.apache.org/download-90.cgi">//tomcat.apache.org/download-90.cgi</a> 。</p>

  <p>使用SVN签出源代码，为当前的开发代码选择发布版本或主干的标签，或者下载并解压缩源代码包。在本指南的其余部分，符号名称<code>${tomcat.source}</code>用于指代放置光源的位置。
  </p>

</div><h3 id="Configure_download_area">配置下载区域</h3><div class="text">

<p>构建Tomcat涉及下载它依赖的许多库。强烈建议为这些库配置下载区域。
</p>

<p>默认情况下，构建配置为将依赖项下载到<code>${user.home}/tomcat-build-libs</code>目录。您可以更改此设置（请参见下文），但是它必须是绝对路径。
</p>

<p>通过创建一个<code>${tomcat.source}/build.properties</code>文件。它可以用来重新定义存在于<code>build.properties.default</code>和<code>build.xml</code>文件。的<code>build.properties</code>文件默认情况下不存在。您必须创建它。
</p>

<p>下载区域由属性定义<code>base.path</code> 。例如：</p>

<div class="codeBox"><pre><code># ----- Default Base Path for Dependent Packages -----
# Replace this path with the directory path where
# dependencies binaries should be downloaded.
base.path=/home/me/some-place-to-download-to</code></pre></div>

<p>允许不同版本的Tomcat共享相同的下载区域。
</p>

<p>另一个例子：</p>

<div class="codeBox"><pre><code>base.path=${user.dir}/../libraries-tomcat9.0</code></pre></div>

<p>通过代理访问Internet的用户必须使用属性文件向Ant指示代理配置：</p>

<div class="codeBox"><pre><code># ----- Proxy setup -----
proxy.host=proxy.domain
proxy.port=8080
proxy.use=on</code></pre></div>

</div><h3 id="Building_Tomcat">构建Tomcat</h3><div class="text">

<p>使用以下命令来构建Tomcat：</p>

<p>
<code>cd ${tomcat.source}</code><br>
<code>ant</code>
</p>

<p>一旦构建成功完成，将在操作系统中生成可用的Tomcat安装。 <code>${tomcat.source}/output/build</code>目录，并且可以使用常用脚本启动和停止。
</p>
</div><h3 id="Building_with_Eclipse">使用Eclipse构建</h3><div class="text">

<p>
<b>重要说明：</b>这不是构建Tomcat的受支持的方法；请参见第4章。此信息不提供任何担保:-)。上面描述的Ant构建是唯一支持构建Tomcat的方法。但是，某些开发人员喜欢使用Java IDE来处理Java代码，并且某些开发人员已使用以下步骤。
</p>

<p>
<b>注意：</b>这不会让您在Eclipse下构建所有内容；构建过程需要在许多阶段中使用Ant，而这些阶段并不是简单的Java编译。但是，它将允许您查看和编辑Java代码，获取警告，重新格式化代码，执行重构，在IDE下运行Tomcat等。
</p>

<p>
<b>警告：</b>不要忘记创建和配置<code>${tomcat.source}/build.properties</code>在运行任何Ant目标之前，请按照上述说明操作文件。
</p>

<p>样本Eclipse项目文件和启动目标在下面提供。 <code>res/ide-support/eclipse</code>源树的目录。以下说明将自动将其复制到所需的位置。
</p>
<p>提供Ant目标是为了方便下载所有二进制依赖项，并在源树的根目录中创建Eclipse项目和类路径文件。
</p>

<p>
<code>cd ${tomcat.source}</code><br>
<code>ant ide-eclipse</code>
</p>

<p>启动Eclipse并创建一个新的Workspace。
</p>

<p>打开“ <em>首选项”</em>对话框，然后选择<em>Java-> Build Path-> Classpath Variables</em>以添加两个新的<em>Classpath变量</em> ：</p>


<table class="defaultTable">
 <tbody><tr><td>TOMCAT_LIBS_BASE</td><td>与位置相同<code>base.path</code>设置<code>build.properties</code> ，其中已下载二进制依赖项</td></tr>
 <tr><td>ANT_HOME</td><td>Ant 1.9.8或更高版本的基本路径</td></tr>
</tbody></table>


<p>使用<em>File-> Import</em>并选择<em>Existing Projects into Workspace</em> 。从那里选择Tomcat源树的根目录（ <code>${tomcat.source}</code> ），然后导入位于此处的Tomcat项目。
</p>

<p>
<code>start-tomcat</code>和<code>stop-tomcat</code>提供启动配置<code>res/ide-support/eclipse</code>并且将在“ <em>运行”->“运行配置”</em>对话框中可用。使用这些来从Eclipse启动和停止Tomcat。如果要自己配置这些（或使用其他IDE），请使用<code>org.apache.catalina.startup.Bootstrap</code>作为主要班级<code>start</code> / <code>stop</code>等作为程序参数，并指定<code>-Dcatalina.home=...</code> （使用您的构建目录的名称）作为VM参数。
</p>

<p>调整一些格式首选项将使与Tomcat编码约定保持一致（并使您的贡献被接受）变得容易得多：</p>

<table class="defaultTable">
  <tbody><tr><td>Java->代码样式->格式化程序->编辑...</td>
  <td>标签政策：仅空格<br>制表符和缩进大小：4</td></tr>
  <tr><td>常规->编辑器->文本编辑器</td>
  <td>显示的标签宽度：2<br>为制表符插入空格<br>显示空格字符（可选）</td></tr>
  <tr><td>XML-> XML文件->编辑器</td><td>缩进使用空格<br>压痕尺寸：2</td></tr>
  <tr><td>蚂蚁->编辑器->格式化程序</td><td>标签大小：2<br>使用制表符而不是空格：未选中</td></tr>
</tbody></table>

<p>推荐的编译器警告配置在以下文档中记录<code>res/ide-support/eclipse/java-compiler-errors-warnings.txt</code>文件。
</p>

</div><h3 id="Building_with_other_IDEs">与其他IDE一起构建</h3><div class="text">
<p>大多数IDE应该使用相同的通用方法。例如，据报道它可以在IntelliJ IDEA中工作。
</p>

</div><div class="noprint"><h3 id="comments_section">评论</h3><div class="text"><p class="notice"><strong>注意：</strong>此注释部分收集有关改进Apache Tomcat文档的建议。<br><br>如果您遇到问题并需要帮助，请阅读“ <a href="https://tomcat.apache.org/findhelp.html">查找帮助”</a>页面，然后在tomcat-users <a href="https://tomcat.apache.org/lists.html">邮件列表中</a>询问您的问题。不要在这里问这样的问题。这不是“问答”部分。<br><br><a href="./comments.html">这里</a>解释<a href="./comments.html">了</a> Apache Comments System。如果评论已被实施或被认为无效/偏离主题，则我们的主持人可能会将其删除。
                  </p><div id="comments_thread"></div></div></div></div></div></div></div><footer><div id="footer">版权所有©1999-2019，Apache软件基金会</div></footer></div></body></html>