<html lang="zh-Hans" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="../images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>Apache Tomcat 9配置参考（9.0.21）-JASPIC</title><script type="application/javascript" data-comments-identifier="tomcat-9.0-doc/config/jaspic">
    "use strict"; // Enable strict mode

    (function() {
      var thisScript = document.currentScript;
      if (!thisScript) { // Workaround for IE <= 11
        var scripts = document.getElementsByTagName("script");
        thisScript = scripts[scripts.length - 1];
      }
      document.addEventListener("DOMContentLoaded", (function() {
        var commentsDiv = document.getElementById("comments_thread");
        var commentsShortname = "tomcat";
        var commentsIdentifier = "https://tomcat.apache.org/" +
          thisScript.getAttribute("data-comments-identifier") + ".html";

        (function(w, d) {
          if (w.location.hostname.toLowerCase() == "tomcat.apache.org") {
            var s = d.createElement("script");
            s.type = "application/javascript";
            s.async = true;
            s.src = "https://comments.apache.org/show_comments.lua?site=" +
              encodeURIComponent(commentsShortname) +
              "&page=" + encodeURIComponent(commentsIdentifier);
            d.head.appendChild(s);
          } else {
            commentsDiv.appendChild(d.createTextNode("Comments are disabled for this page at the moment."));
          }
        })(window, document);
      }), false);
    })();
  </script></head><body ><div id="wrapper"><header><div id="header"><div><div><div class="logo noPrint"><a href="https://tomcat.apache.org/"><img alt="Tomcat主页" src="../images/tomcat.png"></a></div><div style="height:1px"></div><div class="asfLogo noPrint"><a href="https://www.apache.org/" target="_blank"><img src="../images/asf-logo.svg" alt="Apache软件基金会" style="width:266px;height:83px"></a></div><h1>Apache Tomcat 9配置参考</h1><div class="versionInfo">版本9.0.21， <time datetime="2019-06-04"> 2019年6月4日</time></div><div style="height:1px"></div><div style="clear:left"></div></div></div></div></header><div id="middle"><div><div id="mainLeft" class="noprint"><div><nav><div><h2>链接</h2><ul><li><a href="../index.html">文件首页</a></li><li><a href="index.html">配置参考家</a></li><li><a href="https://wiki.apache.org/tomcat/FAQ">常问问题</a></li><li><a href="#comments_section">用户评论</a></li></ul></div><div><h2>顶级元素</h2><ul><li><a href="server.html">服务器</a></li><li><a href="service.html">服务</a></li></ul></div><div><h2>执行者</h2><ul><li><a href="executor.html">执行者</a></li></ul></div><div><h2>连接器</h2><ul><li><a href="http.html">HTTP / 1.1</a></li><li><a href="http2.html">HTTP / 2</a></li><li><a href="ajp.html">AJP</a></li></ul></div><div><h2>货柜</h2><ul><li><a href="context.html">语境</a></li><li><a href="engine.html">发动机</a></li><li><a href="host.html">主办</a></li><li><a href="cluster.html">簇</a></li></ul></div><div><h2>嵌套组件</h2><ul><li><a href="cookie-processor.html">Cookie处理器</a></li><li><a href="credentialhandler.html">凭证处理程序</a></li><li><a href="globalresources.html">全球资源</a></li><li><a href="jar-scanner.html">JarScanner</a></li><li><a href="jar-scan-filter.html">JarScanFilter</a></li><li><a href="listeners.html">听众</a></li><li><a href="loader.html">装载机</a></li><li><a href="manager.html">经理</a></li><li><a href="realm.html">领域</a></li><li><a href="resources.html">资源资源</a></li><li><a href="sessionidgenerator.html">SessionIdGenerator</a></li><li><a href="valve.html">阀</a></li></ul></div><div><h2>集群元素</h2><ul><li><a href="cluster.html">簇</a></li><li><a href="cluster-manager.html">经理</a></li><li><a href="cluster-channel.html">渠道</a></li><li><a href="cluster-membership.html">频道/会员</a></li><li><a href="cluster-sender.html">频道/发件人</a></li><li><a href="cluster-receiver.html">频道/接收器</a></li><li><a href="cluster-interceptor.html">通道/拦截器</a></li><li><a href="cluster-valve.html">阀</a></li><li><a href="cluster-deployer.html">部署者</a></li><li><a href="cluster-listener.html">集群监听器</a></li></ul></div><div><h2>web.xml</h2><ul><li><a href="filter.html">过滤</a></li></ul></div><div><h2>其他</h2><ul><li><a href="systemprops.html">系统属性</a></li><li><a href="jaspic.html">日本宝石</a></li></ul></div></nav></div></div><div id="mainRight"><div id="content"><h2>日本宝石</h2><h3 id="Table_of_Contents">目录</h3><div class="text">
<ul><li><a href="#Introduction">介绍</a></li><li><a href="#Static_configuration">静态配置</a><ol><li><a href="#AuthConfigProvider">AuthConfigProvider</a></li><li><a href="#ServerAuthModule">ServerAuthModule</a></li></ol></li><li><a href="#Dynamic_configuration">动态配置</a></li><li><a href="#3rd_party_modules">第三方模块</a><ol><li><a href="#Philip_Green_II's_module_for_Google_OAuth_2">Philip Green II的Google OAuth 2模块</a></li></ol></li></ul>
</div><h3 id="Introduction">介绍</h3><div class="text">

  <p>Tomcat实现了JASPIC 1.1维护版本B（ <a href="https://www.jcp.org/en/jsr/detail?id=196">JSR 196</a> ）。该实现主要旨在使第三方JASPIC身份验证实现与Tomcat集成。</p>

  <p>JASPIC可以由应用程序动态配置，也可以通过<code>$CATALINA_BASE/conf/jaspic-providers.xml</code>配置文件。如果存在，JASPIC配置将覆盖任何<code><login-config></code>存在于<code>web.xml</code> 。</p>

</div><h3 id="Static_configuration">静态配置</h3><div class="text">

  <div class="subsection"><h4 id="AuthConfigProvider">AuthConfigProvider</h4><div class="text">

    <p>如果第三方实施包含<code>AuthConfigProvider</code>然后可以通过将以下内容嵌套在Web应用程序中来配置Web应用程序以使用它<code><jaspic-providers></code>元素在<code>$CATALINA_BASE/conf/jaspic-providers.xml</code> 。</p>
<div class="codeBox"><pre><code>&lt;provider name="any"
          className="fully.qualified.implementation.class.Name"
          layer="HttpServlet"
          appContext="Catalina/localhost /contextPath"
          description="any"&gt;
  &lt;property name="see-provider-documentation"
            value="see-provider-documentation" /&gt;
&lt;/provider&gt;</code></pre></div>

    <p>的<code>name</code>和<code>description</code> Tomcat不使用属性。</p>

    <p>的<code>className</code>属性必须是的完全限定的类名<code>AuthConfigProvider</code> 。该实现可以与Web应用程序打包在一起，也可以与Tomcat打包在一起。 <code>$CATALINA_BASE/lib</code>目录。</p>

    <p>的<code>layer</code>属性必须是<code>HttpServlet</code> 。</p>

    <p>的<code>appContext</code>属性必须完全是以下内容的串联：</p>
    <ul>
      <li>引擎名称</li>
      <li>正斜杠字符</li>
      <li>主机名</li>
      <li>一个空间</li>
      <li>上下文路径</li>
    </ul>

    <p>如果<code>AuthConfigProvider</code>通过属性支持配置，可以通过以下方式指定<code><property></code>嵌套在内部的元素<code><provide></code>元件。</p>

  </div></div>

  <div class="subsection"><h4 id="ServerAuthModule">ServerAuthModule</h4><div class="text">

    <p>如果第三方实施仅提供了<code>ServerAuthModule</code>那么就需要提供许多支持类。这些可能是自定义实现，或者，Tomcat提供了一个简单的包装实现，用于<code>ServerAuthModule</code> s。
    </p>

    <p>Tomcat的包装<code>ServerAuthModule</code>可以通过将以下内容嵌套在<code><jaspic-providers></code>元素在<code>$CATALINA_BASE/conf/jaspic-providers.xml</code> 。</p>
<div class="codeBox"><pre><code>&lt;provider name="any"
          className="org.apache.catalina.authenticator.jaspic.SimpleAuthConfigProvider"
          layer="HttpServlet"
          appContext="Catalina/localhost /contextPath"
          description="any"&gt;
  &lt;property name="org.apache.catalina.authenticator.jaspic.ServerAuthModule.1"
            value="fully.qualified.implementation.class.Name" /&gt;
  &lt;property name="see-provider-documentation"
            value="see-provider-documentation" /&gt;
&lt;/provider&gt;</code></pre></div>

    <p>配置类似于<code>AuthConfigProvider</code>在上一节中，但有一些主要区别。</p>

    <p>的<code>className</code>属性必须是<code>org.apache.catalina.authenticator.jaspic.SimpleAuthConfigProvider</code> 。</p>

    <p>的<code>ServerAuthModule</code>通过属性指定。属性名称必须为<code>org.apache.catalina.authenticator.jaspic.ServerAuthModule.n</code>哪里<code>n</code>是模块的索引。索引必须从1开始，以1为增量递增，直到定义了所有模块。该属性的值必须是模块的完全限定的类名。</p>
  </div></div>

</div><h3 id="Dynamic_configuration">动态配置</h3><div class="text">

  <p>可以使用Web应用程序将JASPIC模块和配置打包在WAR文件中。然后，Web应用程序开始使用标准JASPIC API时就可以注册所需的JASPIC配置。</p>

  <p>如果使用并行部署，则不应使用动态配置。JASPIC API假定上下文路径对于任何给定主机都是唯一的，而使用并行部署则不是这种情况。使用并行部署时，应使用静态JASPIC配置。这将要求该应用程序的所有版本都使用相同的JASPIC配置。</p>

</div><h3 id="3rd_party_modules">第三方模块</h3><div class="text">

  <p>这不是详尽的清单。Tomcat社区欢迎添加到本节的内容。</p>

  <div class="subsection"><h4 id="Philip_Green_II's_module_for_Google_OAuth_2">Philip Green II的Google OAuth 2模块</h4><div class="text">

    <p>GitHub上提供了此模块的源代码以及包含必需的Google API配置详细信息的<a href="https://github.com/phillipgreenii/google-oauth-2.0-serverauthmodule">文档</a> 。</p>

    <p>将此模块与Tomcat一起使用的示例配置如下所示：</p>
<div class="codeBox"><pre><code>&lt;jaspic-providers xmlns="https://tomcat.apache.org/xml"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xsi:schemaLocation="https://tomcat.apache.org/xml jaspic-providers.xsd"
                  version="1.0"&gt;
  &lt;provider name="google-oauth"
            className="org.apache.catalina.authenticator.jaspic.SimpleAuthConfigProvider"
            layer="HttpServlet"
            appContext="Catalina/localhost /contextPath"
            description="Google OAuth test"&gt;
    &lt;property name="org.apache.catalina.authenticator.jaspic.ServerAuthModule.1"
              value="com.idmworks.security.google.GoogleOAuthServerAuthModule" /&gt;
    &lt;property name="oauth.clientid"
              value="obtained-from-Google-console" /&gt;
    &lt;property name="oauth.clientsecret"
              value="obtained-from-Google-console" /&gt;
    &lt;property name="ignore_missing_login_context"
              value="true" /&gt;
  &lt;/provider&gt;
&lt;/jaspic-providers&gt;</code></pre></div>
  </div></div>

</div><div class="noprint"><h3 id="comments_section">评论</h3><div class="text"><p class="notice"><strong>注意：</strong>此注释部分收集有关改进Apache Tomcat文档的建议。<br><br>如果您遇到麻烦并需要帮助，请阅读“ <a href="https://tomcat.apache.org/findhelp.html">查找帮助”</a>页面，然后在tomcat-users <a href="https://tomcat.apache.org/lists.html">邮件列表中</a>询问您的问题。不要在这里问这样的问题。这不是“问答”部分。<br><br><a href="../comments.html">这里</a>解释<a href="../comments.html">了</a> Apache Comments System。如果评论已实施或被认为无效/偏离主题，我们的主持人可能会将其删除。
                  </p><div id="comments_thread"></div></div></div></div></div></div></div><footer><div id="footer">版权所有©1999-2019，Apache软件基金会</div></footer></div></body></html>