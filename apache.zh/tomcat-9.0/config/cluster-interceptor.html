<html lang="zh-Hans" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="../images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>Apache Tomcat 9配置参考（9.0.21）-通道拦截器对象</title><meta name="author" content="Filip Hanik"><script type="application/javascript" data-comments-identifier="tomcat-9.0-doc/config/cluster-interceptor">
    "use strict"; // Enable strict mode

    (function() {
      var thisScript = document.currentScript;
      if (!thisScript) { // Workaround for IE <= 11
        var scripts = document.getElementsByTagName("script");
        thisScript = scripts[scripts.length - 1];
      }
      document.addEventListener("DOMContentLoaded", (function() {
        var commentsDiv = document.getElementById("comments_thread");
        var commentsShortname = "tomcat";
        var commentsIdentifier = "https://tomcat.apache.org/" +
          thisScript.getAttribute("data-comments-identifier") + ".html";

        (function(w, d) {
          if (w.location.hostname.toLowerCase() == "tomcat.apache.org") {
            var s = d.createElement("script");
            s.type = "application/javascript";
            s.async = true;
            s.src = "https://comments.apache.org/show_comments.lua?site=" +
              encodeURIComponent(commentsShortname) +
              "&page=" + encodeURIComponent(commentsIdentifier);
            d.head.appendChild(s);
          } else {
            commentsDiv.appendChild(d.createTextNode("Comments are disabled for this page at the moment."));
          }
        })(window, document);
      }), false);
    })();
  </script></head><body ><div id="wrapper"><header><div id="header"><div><div><div class="logo noPrint"><a href="https://tomcat.apache.org/"><img alt="Tomcat主页" src="../images/tomcat.png"></a></div><div style="height:1px"></div><div class="asfLogo noPrint"><a href="https://www.apache.org/" target="_blank"><img src="../images/asf-logo.svg" alt="Apache软件基金会" style="width:266px;height:83px"></a></div><h1>Apache Tomcat 9配置参考</h1><div class="versionInfo">版本9.0.21， <time datetime="2019-06-04"> 2019年6月4日</time></div><div style="height:1px"></div><div style="clear:left"></div></div></div></div></header><div id="middle"><div><div id="mainLeft" class="noprint"><div><nav><div><h2>链接</h2><ul><li><a href="../index.html">文件首页</a></li><li><a href="index.html">配置参考家</a></li><li><a href="https://wiki.apache.org/tomcat/FAQ">常问问题</a></li><li><a href="#comments_section">用户评论</a></li></ul></div><div><h2>顶级元素</h2><ul><li><a href="server.html">服务器</a></li><li><a href="service.html">服务</a></li></ul></div><div><h2>执行者</h2><ul><li><a href="executor.html">执行者</a></li></ul></div><div><h2>连接器</h2><ul><li><a href="http.html">HTTP / 1.1</a></li><li><a href="http2.html">HTTP / 2</a></li><li><a href="ajp.html">AJP</a></li></ul></div><div><h2>货柜</h2><ul><li><a href="context.html">语境</a></li><li><a href="engine.html">发动机</a></li><li><a href="host.html">主办</a></li><li><a href="cluster.html">簇</a></li></ul></div><div><h2>嵌套组件</h2><ul><li><a href="cookie-processor.html">Cookie处理器</a></li><li><a href="credentialhandler.html">凭证处理程序</a></li><li><a href="globalresources.html">全球资源</a></li><li><a href="jar-scanner.html">JarScanner</a></li><li><a href="jar-scan-filter.html">JarScanFilter</a></li><li><a href="listeners.html">听众</a></li><li><a href="loader.html">装载机</a></li><li><a href="manager.html">经理</a></li><li><a href="realm.html">领域</a></li><li><a href="resources.html">资源资源</a></li><li><a href="sessionidgenerator.html">SessionIdGenerator</a></li><li><a href="valve.html">阀</a></li></ul></div><div><h2>集群元素</h2><ul><li><a href="cluster.html">簇</a></li><li><a href="cluster-manager.html">经理</a></li><li><a href="cluster-channel.html">渠道</a></li><li><a href="cluster-membership.html">频道/会员</a></li><li><a href="cluster-sender.html">频道/发件人</a></li><li><a href="cluster-receiver.html">频道/接收器</a></li><li><a href="cluster-interceptor.html">通道/拦截器</a></li><li><a href="cluster-valve.html">阀</a></li><li><a href="cluster-deployer.html">部署者</a></li><li><a href="cluster-listener.html">集群监听器</a></li></ul></div><div><h2>web.xml</h2><ul><li><a href="filter.html">过滤</a></li></ul></div><div><h2>其他</h2><ul><li><a href="systemprops.html">系统属性</a></li><li><a href="jaspic.html">日本宝石</a></li></ul></div></nav></div></div><div id="mainRight"><div id="content"><h2>通道拦截器对象</h2><h3 id="Table_of_Contents">目录</h3><div class="text">
<ul><li><a href="#Introduction">介绍</a></li><li><a href="#Available_Interceptors">可用的拦截器</a></li><li><a href="#Static_Membership">静态会员</a></li><li><a href="#Attributes">属性</a><ol><li><a href="#Common_Attributes">共同属性</a></li><li><a href="#org.apache.catalina.tribes.group.interceptors.DomainFilterInterceptor_Attributes">org.apache.catalina.tribes.group.interceptors。DomainFilterInterceptor属性</a></li><li><a href="#org.apache.catalina.tribes.group.interceptors.FragmentationInterceptor_Attributes">org.apache.catalina.tribes.group.interceptors。FragmentationInterceptor属性</a></li><li><a href="#org.apache.catalina.tribes.group.interceptors.MessageDispatchInterceptor_Attributes">org.apache.catalina.tribes.group.interceptors。MessageDispatchInterceptor属性</a></li><li><a href="#org.apache.catalina.tribes.group.interceptors.TcpFailureDetector_Attributes">org.apache.catalina.tribes.group.interceptors。TcpFailureDetector属性</a></li><li><a href="#org.apache.catalina.tribes.group.interceptors.TcpPingInterceptor_Attributes">org.apache.catalina.tribes.group.interceptors。TcpPingInterceptor属性</a></li><li><a href="#org.apache.catalina.tribes.group.interceptors.ThroughputInterceptor_Attributes">org.apache.catalina.tribes.group.interceptors。吞吐量拦截器属性</a></li><li><a href="#org.apache.catalina.tribes.group.interceptors.EncryptInterceptor_Attributes">org.apache.catalina.tribes.group.interceptors。EncryptInterceptor属性</a></li></ol></li><li><a href="#Nested_Components">嵌套组件</a><ol><li><a href="#StaticMember_Attributes">StaticMember属性</a></li></ol></li></ul>
</div><h3 id="Introduction">介绍</h3><div class="text">
  <p>Apache Tribes支持拦截器体系结构来拦截消息和成员资格通知。这种体系结构允许逻辑去耦，并为一些非常有用的功能附件开辟了道路。
  </p>
</div><h3 id="Available_Interceptors">可用的拦截器</h3><div class="text">
   <ul>
    <li><code>org.apache.catalina.tribes.group.interceptors.TcpFailureDetector</code></li>
    <li><code>org.apache.catalina.tribes.group.interceptors.ThroughputInterceptor</code></li>
    <li><code>org.apache.catalina.tribes.group.interceptors.MessageDispatchInterceptor</code></li>
    <li><code>org.apache.catalina.tribes.group.interceptors.NonBlockingCoordinator</code></li>
    <li><code>org.apache.catalina.tribes.group.interceptors.OrderInterceptor</code></li>
    <li><code>org.apache.catalina.tribes.group.interceptors.SimpleCoordinator</code></li>
    <li><code>org.apache.catalina.tribes.group.interceptors.StaticMembershipInterceptor</code></li>
    <li><code>org.apache.catalina.tribes.group.interceptors.TwoPhaseCommitInterceptor</code></li>
    <li><code>org.apache.catalina.tribes.group.interceptors.DomainFilterInterceptor</code></li>
    <li><code>org.apache.catalina.tribes.group.interceptors.FragmentationInterceptor</code></li>
    <li><code>org.apache.catalina.tribes.group.interceptors.GzipInterceptor</code></li>
    <li><code>org.apache.catalina.tribes.group.interceptors.TcpPingInterceptor</code></li>
    <li><code>org.apache.catalina.tribes.group.interceptors.EncryptInterceptor</code></li>
   </ul>
</div><h3 id="Static_Membership">静态会员</h3><div class="text">
  <p>除了动态发现外，Apache Tribes还支持静态成员身份以及成员身份验证。为此，添加<code>org.apache.catalina.tribes.group.interceptors.StaticMembershipInterceptor</code>之后<code>org.apache.catalina.tribes.group.interceptors.TcpFailureDetector</code>拦截器。在 - 的里面<code>StaticMembershipInterceptor</code>您可以添加希望拥有的静态成员。的<code>TcpFailureDetector</code>将对静态成员进行运行状况检查，并监视它们的崩溃，因此它们将具有与自动发现的成员相同级别的通知机制。</p>
   <div class="codeBox"><pre><code>     &lt;Interceptor className="org.apache.catalina.tribes.group.interceptors.StaticMembershipInterceptor"&gt;
       &lt;LocalMember className="org.apache.catalina.tribes.membership.StaticMember"
                  domain="staging-cluster"
                  uniqueId="{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1}"/&gt;
       &lt;Member className="org.apache.catalina.tribes.membership.StaticMember"
                  port="5678"
                  securePort="-1"
                  host="tomcat01.mydomain.com"
                  domain="staging-cluster"
                  uniqueId="{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15}"/&gt;
     &lt;/Interceptor&gt;</code></pre></div>
</div><h3 id="Attributes">属性</h3><div class="text">

  <div class="subsection"><h4 id="Common_Attributes">共同属性</h4><div class="text">
   <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><strong><code class="attributeName">className</code></strong></td><td>必需，因为没有默认值</td></tr><tr><td><code class="attributeName">optionFlag</code></td><td>如果您希望拦截器根据邮件的选项标志在某些邮件上触发，则可以在此处设置拦截器标志。默认值为<code>0</code> ，表示此拦截器将在所有消息上触发。
     </td></tr></tbody></table>
  </div></div>

  <div class="subsection"><h4 id="org.apache.catalina.tribes.group.interceptors.DomainFilterInterceptor_Attributes">org.apache.catalina.tribes.group.interceptors。DomainFilterInterceptor属性</h4><div class="text">
   <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><strong><code class="attributeName">domain</code></strong></td><td>该拦截器接受的逻辑群集域。两种不同类型的值是可能的：<br>1。常规字符串值（例如“ staging-domain”或“ tomcat-cluster”）将使用ISO-8859-1编码转换为字节。<br>2.字符串形式的字节数组，例如{216,123,12,3}<br>
     </td></tr><tr><td><code class="attributeName">logInterval</code></td><td>此值指示记录来自不同域的消息的时间间隔。默认值为100，表示每100条消息记录一次。
     </td></tr></tbody></table>
  </div></div>
  <div class="subsection"><h4 id="org.apache.catalina.tribes.group.interceptors.FragmentationInterceptor_Attributes">org.apache.catalina.tribes.group.interceptors。FragmentationInterceptor属性</h4><div class="text">
   <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><code class="attributeName">expire</code></td><td>我们将碎片保留在内存中多长时间，然后等待其余的碎片到达。默认值为60000 ms。
     </td></tr><tr><td><code class="attributeName">maxSize</code></td><td>最大消息大小（以字节为单位）。如果消息大小超过此值，则此拦截器将对消息进行分段并将其发送。如果小于此值，则此拦截器不会对消息进行分段，也不会将其作为一条消息发送。默认值为1024 * 100。
     </td></tr></tbody></table>
  </div></div>
  <div class="subsection"><h4 id="org.apache.catalina.tribes.group.interceptors.MessageDispatchInterceptor_Attributes">org.apache.catalina.tribes.group.interceptors。MessageDispatchInterceptor属性</h4><div class="text">
   <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><code class="attributeName">optionFlag</code></td><td>默认的硬编码值为<code>8 (org.apache.catalina.tribes.Channel.SEND_OPTIONS_ASYNCHRONOUS)</code> 。调度程序将仅根据Tribes的预定义触发此值。
     </td></tr><tr><td><code class="attributeName">alwaysSend</code></td><td>分派队列已满时应执行什么行为。如果<code>true</code> （默认），则消息将同步发送，如果<code>false</code>引发错误。
     </td></tr><tr><td><code class="attributeName">maxQueueSize</code></td><td>分派队列的大小（以字节为单位），默认值为<code>1024*1024*64 (64MB)</code>设置派遣队列的最大队列大小（如果队列已满），可以触发该行为，如果<code>alwaysSend</code>设置为true，如果标志为false，则将同步发送消息，并引发错误</td></tr><tr><td><code class="attributeName">maxThreads</code></td><td>此池中的最大线程数，默认为10。
     </td></tr><tr><td><code class="attributeName">maxSpareThreads</code></td><td>要保留在池中的线程数，默认为2。
     </td></tr><tr><td><code class="attributeName">keepAliveTime</code></td><td>空闲线程终止之前的最大毫秒数。默认值为5000（5秒）。
     </td></tr></tbody></table>
  </div></div>
  <div class="subsection"><h4 id="org.apache.catalina.tribes.group.interceptors.TcpFailureDetector_Attributes">org.apache.catalina.tribes.group.interceptors。TcpFailureDetector属性</h4><div class="text">
   <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><code class="attributeName">connectTimeout</code></td><td>指定尝试与可疑节点建立TCP连接时使用的超时（以毫秒为单位）。默认值为1000。
     </td></tr><tr><td><code class="attributeName">performSendTest</code></td><td>如果设置为true，则将测试消息发送到可疑节点。默认为true。
     </td></tr><tr><td><code class="attributeName">performReadTest</code></td><td>如果设置为true，则读取发送的测试消息的响应。默认为false。
       <strong>注意：</strong>如果<code>performSendTest</code>为false时，此属性无效。
     </td></tr><tr><td><code class="attributeName">readTestTimeout</code></td><td>指定对可疑节点执行读取测试时要使用的超时（以毫秒为单位）。默认值为5000。
     </td></tr><tr><td><code class="attributeName">removeSuspectsTimeout</code></td><td>从removeSuspects中删除的最长时间（以秒为单位）。removeSuspectsTimeout之后，removeSuspects的成员将被自动删除。如果指定负值，则removeSuspects成员将不会被删除，直到真正消失为止。如果未提供该属性，则使用默认值300秒（5分钟）。
     </td></tr></tbody></table>
  </div></div>
  <div class="subsection"><h4 id="org.apache.catalina.tribes.group.interceptors.TcpPingInterceptor_Attributes">org.apache.catalina.tribes.group.interceptors。TcpPingInterceptor属性</h4><div class="text">
   <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><code class="attributeName">interval</code></td><td>如果useThread == true，则定义发送ping消息的间隔。默认值为1000毫秒。
     </td></tr><tr><td><code class="attributeName">useThread</code></td><td>是否启动线程以发送ping消息的标志。如果设置为true，则此拦截器将启动本地线程以发送ping消息。如果设置为false，则通道心跳将发送ping消息。默认为false。
     </td></tr></tbody></table>
  </div></div>
  <div class="subsection"><h4 id="org.apache.catalina.tribes.group.interceptors.ThroughputInterceptor_Attributes">org.apache.catalina.tribes.group.interceptors。吞吐量拦截器属性</h4><div class="text">
   <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><code class="attributeName">interval</code></td><td>定义当我们报告吞吐量统计信息时的消息数量间隔。该报告已记录到<code>org.apache.juli.logging.LogFactory.getLog(ThroughputInterceptor.class)</code>记录器下<code>INFO</code>水平。默认值是报告每个<code>10000</code>消息。
     </td></tr></tbody></table>
  </div></div>
  <div class="subsection"><h4 id="org.apache.catalina.tribes.group.interceptors.EncryptInterceptor_Attributes">org.apache.catalina.tribes.group.interceptors。EncryptInterceptor属性</h4><div class="text">
   <p>EncryptInterceptor将加密添加到在节点之间承载会话数据的通道消息中。在Tomcat 9.0.13中添加。
   </p>
   <p>如果使用<code>TcpFailureDetector</code> ， <code>EncryptInterceptor</code> <i>必须</i>被插入到拦截器链<i>前</i> <code>TcpFailureDetector</code> 。这是因为验证集群成员时， <code>TcpFailureDetector</code>在不使用拦截器链的其余部分的情况下，将通道数据直接写入其他成员，但是在接收端，消息仍然通过链（相反）。由于这种不对称， <code>EncryptInterceptor</code>必须<i>在</i> <code>TcpFailureDetector</code>在发送方和接收方<i>之后</i> ，否则将发生消息损坏。
   </p>
   <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><code class="attributeName">encryptionAlgorithm</code></td><td>要使用的加密算法，包括模式和填充。请参阅<a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/StandardNames.html">https://docs.oracle.com/javase/8/docs/technotes/guides/security/StandardNames.html</a> ，以获取可以使用的标准JCA名称。EncryptInterceptor当前支持以下<a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">块密码模式</a> ：CBC，OFB，CFB和GCM。密钥的长度将指定要使用的加密算法的风格（如果适用）（例如AES-128与AES-256）。默认算法是<code>AES/CBC/PKCS5Padding</code> 。
     </td></tr><tr><td><strong><code class="attributeName">encryptionKey</code></strong></td><td>与加密算法一起使用的密钥。密钥应指定为算法长度合适的十六进制编码字节（例如，对于AES-128，为16字节/ 32字符/ 128位，对于AES-256，为32字节/ 64字符/ 256位，等等）。
     </td></tr></tbody></table>
  </div></div>
</div><h3 id="Nested_Components">嵌套组件</h3><div class="text">

  <div class="subsection"><h4 id="StaticMember_Attributes">StaticMember属性</h4><div class="text">
    <p><b>LocalMember：</b> <br>静态成员，它是静态群集组的本地成员。
    </p>
    <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><strong><code class="attributeName">className</code></strong></td><td>仅有一种实现方式： <code>org.apache.catalina.tribes.membership.StaticMember</code>
      </td></tr><tr><td><code class="attributeName">port</code></td><td>无需设置。此属性的值继承自群集接收器设置。
      </td></tr><tr><td><code class="attributeName">securePort</code></td><td>无需设置。此属性的值继承自群集接收器设置。
      </td></tr><tr><td><code class="attributeName">host</code></td><td>无需设置。此属性的值继承自群集接收器设置。
      </td></tr><tr><td><code class="attributeName">domain</code></td><td>该静态成员的逻辑集群域侦听集群消息。两种不同类型的值是可能的：<br>1。常规字符串值（例如“ staging-domain”或“ tomcat-cluster”）将使用ISO-8859-1编码转换为字节。2.字符串形式的字节数组，例如{216,123,12,3}<br>
      </td></tr><tr><td><strong><code class="attributeName">uniqueId</code></strong></td><td>此静态成员的通用uniqueId。值必须为16个字节，格式如下：<br>1.字符串形式的字节数组，例如{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15}<br>
      </td></tr></tbody></table>

    <p><b>会员：</b> <br>添加到静态群集组的静态成员。
    </p>
    <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><strong><code class="attributeName">className</code></strong></td><td>仅有一种实现方式： <code>org.apache.catalina.tribes.membership.StaticMember</code>
      </td></tr><tr><td><strong><code class="attributeName">port</code></strong></td><td>该静态成员侦听集群消息的端口</td></tr><tr><td><code class="attributeName">securePort</code></td><td>该静态成员侦听加密群集消息的安全端口，默认值为<code>-1</code> ，此值表示成员未在安全端口上侦听</td></tr><tr><td><strong><code class="attributeName">host</code></strong></td><td>该静态成员侦听群集消息的主机（或网络接口）。三种不同类型的值是可能的：<br>1。格式为“ 216.123.1.23”的IP地址<br>2。只要正确解析主机名，例如“ tomcat01.mydomain.com”或“ tomcat01”<br>3.字符串形式的字节数组，例如{216,123,12,3}<br>
      </td></tr><tr><td><code class="attributeName">domain</code></td><td>该静态成员的逻辑集群域侦听集群消息。两种不同类型的值是可能的：<br>1。常规字符串值（例如“ staging-domain”或“ tomcat-cluster”）将使用ISO-8859-1编码转换为字节。<br>2.字符串形式的字节数组，例如{216,123,12,3}<br>
      </td></tr><tr><td><strong><code class="attributeName">uniqueId</code></strong></td><td>此静态成员的通用uniqueId。值必须为16个字节，格式如下：<br>1.字符串形式的字节数组，例如{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15}<br>
      </td></tr></tbody></table>
  </div></div>
  

</div><div class="noprint"><h3 id="comments_section">评论</h3><div class="text"><p class="notice"><strong>注意：</strong>此注释部分收集有关改进Apache Tomcat文档的建议。<br><br>如果您遇到问题并需要帮助，请阅读“ <a href="https://tomcat.apache.org/findhelp.html">查找帮助”</a>页面，然后在tomcat-users <a href="https://tomcat.apache.org/lists.html">邮件列表中</a>询问您的问题。不要在这里问这样的问题。这不是“问答”部分。<br><br><a href="../comments.html">这里</a>解释<a href="../comments.html">了</a> Apache Comments System。如果评论已被实施或被认为无效/偏离主题，则我们的主持人可能会将其删除。
                  </p><div id="comments_thread"></div></div></div></div></div></div></div><footer><div id="footer">版权所有©1999-2019，Apache软件基金会</div></footer></div></body></html>