<html lang="zh-Hans" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="../images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>Apache Tomcat 9配置参考（9.0.21）-引擎容器</title><meta name="author" content="Craig R. McClanahan"><script type="application/javascript" data-comments-identifier="tomcat-9.0-doc/config/engine">
    "use strict"; // Enable strict mode

    (function() {
      var thisScript = document.currentScript;
      if (!thisScript) { // Workaround for IE <= 11
        var scripts = document.getElementsByTagName("script");
        thisScript = scripts[scripts.length - 1];
      }
      document.addEventListener("DOMContentLoaded", (function() {
        var commentsDiv = document.getElementById("comments_thread");
        var commentsShortname = "tomcat";
        var commentsIdentifier = "https://tomcat.apache.org/" +
          thisScript.getAttribute("data-comments-identifier") + ".html";

        (function(w, d) {
          if (w.location.hostname.toLowerCase() == "tomcat.apache.org") {
            var s = d.createElement("script");
            s.type = "application/javascript";
            s.async = true;
            s.src = "https://comments.apache.org/show_comments.lua?site=" +
              encodeURIComponent(commentsShortname) +
              "&page=" + encodeURIComponent(commentsIdentifier);
            d.head.appendChild(s);
          } else {
            commentsDiv.appendChild(d.createTextNode("Comments are disabled for this page at the moment."));
          }
        })(window, document);
      }), false);
    })();
  </script></head><body ><div id="wrapper"><header><div id="header"><div><div><div class="logo noPrint"><a href="https://tomcat.apache.org/"><img alt="Tomcat主页" src="../images/tomcat.png"></a></div><div style="height:1px"></div><div class="asfLogo noPrint"><a href="https://www.apache.org/" target="_blank"><img src="../images/asf-logo.svg" alt="Apache软件基金会" style="width:266px;height:83px"></a></div><h1>Apache Tomcat 9配置参考</h1><div class="versionInfo">版本9.0.21， <time datetime="2019-06-04"> 2019年6月4日</time></div><div style="height:1px"></div><div style="clear:left"></div></div></div></div></header><div id="middle"><div><div id="mainLeft" class="noprint"><div><nav><div><h2>链接</h2><ul><li><a href="../index.html">文件首页</a></li><li><a href="index.html">配置参考家</a></li><li><a href="https://wiki.apache.org/tomcat/FAQ">常问问题</a></li><li><a href="#comments_section">用户评论</a></li></ul></div><div><h2>顶级元素</h2><ul><li><a href="server.html">服务器</a></li><li><a href="service.html">服务</a></li></ul></div><div><h2>执行者</h2><ul><li><a href="executor.html">执行者</a></li></ul></div><div><h2>连接器</h2><ul><li><a href="http.html">HTTP / 1.1</a></li><li><a href="http2.html">HTTP / 2</a></li><li><a href="ajp.html">AJP</a></li></ul></div><div><h2>货柜</h2><ul><li><a href="context.html">语境</a></li><li><a href="engine.html">发动机</a></li><li><a href="host.html">主办</a></li><li><a href="cluster.html">簇</a></li></ul></div><div><h2>嵌套组件</h2><ul><li><a href="cookie-processor.html">Cookie处理器</a></li><li><a href="credentialhandler.html">凭证处理程序</a></li><li><a href="globalresources.html">全球资源</a></li><li><a href="jar-scanner.html">JarScanner</a></li><li><a href="jar-scan-filter.html">JarScanFilter</a></li><li><a href="listeners.html">听众</a></li><li><a href="loader.html">装载机</a></li><li><a href="manager.html">经理</a></li><li><a href="realm.html">领域</a></li><li><a href="resources.html">资源资源</a></li><li><a href="sessionidgenerator.html">SessionIdGenerator</a></li><li><a href="valve.html">阀</a></li></ul></div><div><h2>集群元素</h2><ul><li><a href="cluster.html">簇</a></li><li><a href="cluster-manager.html">经理</a></li><li><a href="cluster-channel.html">渠道</a></li><li><a href="cluster-membership.html">频道/会员</a></li><li><a href="cluster-sender.html">频道/发件人</a></li><li><a href="cluster-receiver.html">频道/接收器</a></li><li><a href="cluster-interceptor.html">通道/拦截器</a></li><li><a href="cluster-valve.html">阀</a></li><li><a href="cluster-deployer.html">部署者</a></li><li><a href="cluster-listener.html">集群监听器</a></li></ul></div><div><h2>web.xml</h2><ul><li><a href="filter.html">过滤</a></li></ul></div><div><h2>其他</h2><ul><li><a href="systemprops.html">系统属性</a></li><li><a href="jaspic.html">日本宝石</a></li></ul></div></nav></div></div><div id="mainRight"><div id="content"><h2>引擎容器</h2><h3 id="Table_of_Contents">目录</h3><div class="text">
<ul><li><a href="#Introduction">介绍</a></li><li><a href="#Attributes">属性</a><ol><li><a href="#Common_Attributes">共同属性</a></li><li><a href="#Standard_Implementation">标准实施</a></li></ol></li><li><a href="#Nested_Components">嵌套组件</a></li><li><a href="#Special_Features">特殊功能</a><ol><li><a href="#Logging">记录中</a></li><li><a href="#Access_Logs">访问日志</a></li><li><a href="#Lifecycle_Listeners">生命周期侦听器</a></li><li><a href="#Request_Filters">请求过滤器</a></li></ol></li></ul>
</div><h3 id="Introduction">介绍</h3><div class="text">

  <p><strong>Engine</strong>元素表示与特定Catalina <a href="service.html">Service</a>相关的整个请求处理机制。它接收并处理来自一个或多个<strong>连接器的</strong> <em>所有</em>请求，并将完成的响应返回到连接器，以最终传输回客户端。</p>

  <p>在与此服务关联的所有相应连接器元素之后，必须在<a href="service.html">服务</a>元素内嵌套一个<strong>引擎</strong>元素。</p>

</div><h3 id="Attributes">属性</h3><div class="text">

  <div class="subsection"><h4 id="Common_Attributes">共同属性</h4><div class="text">

    <p><strong>Engine的</strong>所有实现都支持以下属性：</p>

    <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><code class="attributeName">backgroundProcessorDelay</code></td><td>
        <p>此值表示在此引擎及其子容器（包括所有主机和上下文）上调用backgroundProcess方法之间的延迟（以秒为单位）。如果子容器的延迟值不为负（则表示它们正在使用自己的处理线程），则不会调用它们。将此值设置为正值将导致产生线程。等待指定的时间后，线程将在此引擎及其所有子容器上调用backgroundProcess方法。如果未指定，则此属性的默认值为10，表示10秒的延迟。</p>
      </td></tr><tr><td><code class="attributeName">className</code></td><td>
        <p>使用的Java类名称。此类必须实现<code>org.apache.catalina.Engine</code>接口。如果未指定，将使用标准值（定义如下）。</p>
      </td></tr><tr><td><strong><code class="attributeName">defaultHost</code></strong></td><td>
        <p>默认的主机名，它标识<a href="host.html">主机</a>将处理针对主机名此服务器上的请求，但在此配置文件中没有配置。此名称必须与<code>name</code> <a href="host.html">Host</a>元素之一的属性立即嵌套在内部。</p>
      </td></tr><tr><td><code class="attributeName">jvmRoute</code></td><td>
        <p>必须在负载平衡方案中使用的标识符才能启用会话亲缘关系。该标识符在参与集群的所有Tomcat服务器之间必须是唯一的，将附加到生成的会话标识符中，因此允许前端代理始终将特定会话转发到同一Tomcat实例。</p>
        <p>请注意<code>jvmRoute</code>也可以使用<code>jvmRoute</code>系统属性。的<code>jvmRoute</code>设置在<code><Engine></code>属性将覆盖任何<code>jvmRoute</code>系统属性。
        </p>
      </td></tr><tr><td><strong><code class="attributeName">name</code></strong></td><td>
        <p>此引擎的逻辑名称，用于日志和错误消息。<em>在同一台<a href="server.html">Server中</a>使用多个<a href="service.html">Service</a>元素时，必须为每个引擎分配一个唯一的名称。</em></p>
      </td></tr><tr><td><code class="attributeName">startStopThreads</code></td><td>
        <p>该<strong>引擎</strong>将用来并行启动子<a href="host.html">Host</a>元素的线程数。特殊值0将导致值<code>Runtime.getRuntime().availableProcessors()</code>正在使用。负值将导致<code>Runtime.getRuntime().availableProcessors() + value</code>除非小于1，否则将使用1个线程。如果未指定，将使用默认值1。如果使用1个线程，则不使用<code>ExecutorService</code>当前线程将被使用。</p>
      </td></tr></tbody></table>

  </div></div>


  <div class="subsection"><h4 id="Standard_Implementation">标准实施</h4><div class="text">

    <p><strong>Engine</strong>的标准实现是<strong>org.apache.catalina.core。标准引擎</strong> 。它支持以下其他属性（除了上面列出的常见属性之外）：</p>

    <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr></tbody></table>

  </div></div>


</div><h3 id="Nested_Components">嵌套组件</h3><div class="text">

  <p>您可以在此<strong>Engine</strong>元素内嵌套一个或多个<a href="host.html">Host</a>元素，每个<a href="host.html">Host</a>元素代表与此服务器关联的不同虚拟主机。至少需要一个<a href="host.html">主机</a> ，并且其中一个嵌套<a href="host.html">主机</a>的名称必须与为<a href="host.html">主机</a>指定的名称匹配<code>defaultHost</code>属性，在上面列出。</p>

  <p>您可以通过在<strong>Engine</strong>元素内嵌套相应的元素，最多嵌套以下实用程序组件的一个实例：</p>
  <ul>
  <li><a href="realm.html"><strong>领域</strong></a> -配置一个领域，以使其用户数据库及其相关角色可以在嵌套在此引擎内的所有<a href="host.html">主机</a>和<a href="context.html">上下文</a>之间共享，除非被较低级别的<a href="realm.html">领域</a>配置覆盖。</li>
  </ul>

</div><h3 id="Special_Features">特殊功能</h3><div class="text">


  <div class="subsection"><h4 id="Logging">记录中</h4><div class="text">

    <p>引擎与<code>org.apache.catalina.core.ContainerBase.[enginename]</code>日志类别。请注意，方括号实际上是名称的一部分，请不要忽略它们。</p>

  </div></div>


  <div class="subsection"><h4 id="Access_Logs">访问日志</h4><div class="text">

    <p>运行Web服务器时，正常生成的输出文件之一是<em>访问日志</em> ，该<em>访问日志</em>以标准格式为服务器处理的每个请求生成一行信息。Catalina包括一个可选的<a href="valve.html">Valve</a>实现，该实现可以创建与Web服务器创建的标准格式相同的访问日志，也可以创建任意数量的自定义格式。</p>

    <p>您可以通过嵌套如下所示的<a href="valve.html">Valve</a>元素，要求Catalina为<a href="engine.html">Engine</a> ， <a href="host.html">Host</a>或<a href="context.html">Context</a>处理的所有请求创建访问日志：</p>

<div class="codeBox"><pre><code>&lt;Engine name="Standalone" ...&gt;
  ...
  &lt;Valve className="org.apache.catalina.valves.AccessLogValve"
         prefix="catalina_access_log" suffix=".txt"
         pattern="common"/&gt;
  ...
&lt;/Engine&gt;</code></pre></div>

    <p>有关支持的配置属性的更多信息，请参见<a href="valve.html#Access_Logging">访问记录阀</a> 。</p>

  </div></div>


  <div class="subsection"><h4 id="Lifecycle_Listeners">生命周期侦听器</h4><div class="text">

    <p>如果实现了需要知道何时启动或停止此<strong>Engine</strong>的Java对象，则可以通过在该元素内嵌套<strong>Listener</strong>元素来声明它。您指定的类名称必须实现<code>org.apache.catalina.LifecycleListener</code>界面，系统会通知其相应生命周期事件的发生。这样的侦听器的配置如下所示：</p>

<div class="codeBox"><pre><code>&lt;Engine name="Standalone" ...&gt;
  ...
  &lt;Listener className="com.mycompany.mypackage.MyListener" ... &gt;
  ...
&lt;/Engine&gt;</code></pre></div>

    <p>请注意，侦听器可以具有可以从此元素配置的任意数量的其他属性。使用标准的属性方法命名模式，将属性名称与相应的JavaBean属性名称匹配。</p>

  </div></div>


  <div class="subsection"><h4 id="Request_Filters">请求过滤器</h4><div class="text">

    <p>您可以要求Catalina在针对周围<a href="engine.html">Engine</a> ， <a href="host.html">Host</a>或<a href="context.html">Context</a>元素的每个传入请求中检查IP地址或主机名。将根据配置的“接受”和/或“拒绝”过滤器检查远程地址或名称，这些过滤器使用<code>java.util.regex</code>正则表达式语法。来自不接受位置的请求将被拒绝，并显示HTTP“禁止”错误。过滤器声明示例：</p>

<div class="codeBox"><pre><code>&lt;Engine name="Standalone" ...&gt;
  ...
  &lt;Valve className="org.apache.catalina.valves.RemoteHostValve"
         allow=".*\.mycompany\.com|www\.yourcompany\.com"/&gt;
  &lt;Valve className="org.apache.catalina.valves.RemoteAddrValve"
         deny="192\.168\.1\.\d+"/&gt;
  ...
&lt;/Engine&gt;</code></pre></div>

  <p>有关支持的配置选项的更多信息，请参见<a href="valve.html#Remote_Address_Filter">远程地址过滤器</a>和<a href="valve.html#Remote_Host_Filter">远程主机过滤器</a> 。</p>

  </div></div>


</div><div class="noprint"><h3 id="comments_section">评论</h3><div class="text"><p class="notice"><strong>注意：</strong>此注释部分收集有关改进Apache Tomcat文档的建议。<br><br>如果您遇到问题并需要帮助，请阅读“ <a href="https://tomcat.apache.org/findhelp.html">查找帮助”</a>页面，然后在tomcat-users <a href="https://tomcat.apache.org/lists.html">邮件列表中</a>询问您的问题。不要在这里问这样的问题。这不是“问答”部分。<br><br><a href="../comments.html">这里</a>解释<a href="../comments.html">了</a> Apache Comments System。如果评论已被实施或被认为无效/偏离主题，则我们的主持人可能会将其删除。
                  </p><div id="comments_thread"></div></div></div></div></div></div></div><footer><div id="footer">版权所有©1999-2019，Apache软件基金会</div></footer></div></body></html>