<html lang="zh-Hans" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="../images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>Apache Tomcat 9配置参考（9.0.21）-GlobalNamingResources组件</title><meta name="author" content="Remy Maucherat"><meta name="author" content="Yoav Shapira"><script type="application/javascript" data-comments-identifier="tomcat-9.0-doc/config/globalresources">
    "use strict"; // Enable strict mode

    (function() {
      var thisScript = document.currentScript;
      if (!thisScript) { // Workaround for IE <= 11
        var scripts = document.getElementsByTagName("script");
        thisScript = scripts[scripts.length - 1];
      }
      document.addEventListener("DOMContentLoaded", (function() {
        var commentsDiv = document.getElementById("comments_thread");
        var commentsShortname = "tomcat";
        var commentsIdentifier = "https://tomcat.apache.org/" +
          thisScript.getAttribute("data-comments-identifier") + ".html";

        (function(w, d) {
          if (w.location.hostname.toLowerCase() == "tomcat.apache.org") {
            var s = d.createElement("script");
            s.type = "application/javascript";
            s.async = true;
            s.src = "https://comments.apache.org/show_comments.lua?site=" +
              encodeURIComponent(commentsShortname) +
              "&page=" + encodeURIComponent(commentsIdentifier);
            d.head.appendChild(s);
          } else {
            commentsDiv.appendChild(d.createTextNode("Comments are disabled for this page at the moment."));
          }
        })(window, document);
      }), false);
    })();
  </script></head><body ><div id="wrapper"><header><div id="header"><div><div><div class="logo noPrint"><a href="https://tomcat.apache.org/"><img alt="Tomcat主页" src="../images/tomcat.png"></a></div><div style="height:1px"></div><div class="asfLogo noPrint"><a href="https://www.apache.org/" target="_blank"><img src="../images/asf-logo.svg" alt="Apache软件基金会" style="width:266px;height:83px"></a></div><h1>Apache Tomcat 9配置参考</h1><div class="versionInfo">版本9.0.21， <time datetime="2019-06-04"> 2019年6月4日</time></div><div style="height:1px"></div><div style="clear:left"></div></div></div></div></header><div id="middle"><div><div id="mainLeft" class="noprint"><div><nav><div><h2>链接</h2><ul><li><a href="../index.html">文件首页</a></li><li><a href="index.html">配置参考家</a></li><li><a href="https://wiki.apache.org/tomcat/FAQ">常问问题</a></li><li><a href="#comments_section">用户评论</a></li></ul></div><div><h2>顶级元素</h2><ul><li><a href="server.html">服务器</a></li><li><a href="service.html">服务</a></li></ul></div><div><h2>执行者</h2><ul><li><a href="executor.html">执行者</a></li></ul></div><div><h2>连接器</h2><ul><li><a href="http.html">HTTP / 1.1</a></li><li><a href="http2.html">HTTP / 2</a></li><li><a href="ajp.html">AJP</a></li></ul></div><div><h2>货柜</h2><ul><li><a href="context.html">语境</a></li><li><a href="engine.html">发动机</a></li><li><a href="host.html">主办</a></li><li><a href="cluster.html">簇</a></li></ul></div><div><h2>嵌套组件</h2><ul><li><a href="cookie-processor.html">Cookie处理器</a></li><li><a href="credentialhandler.html">凭证处理程序</a></li><li><a href="globalresources.html">全球资源</a></li><li><a href="jar-scanner.html">JarScanner</a></li><li><a href="jar-scan-filter.html">JarScanFilter</a></li><li><a href="listeners.html">听众</a></li><li><a href="loader.html">装载机</a></li><li><a href="manager.html">经理</a></li><li><a href="realm.html">领域</a></li><li><a href="resources.html">资源资源</a></li><li><a href="sessionidgenerator.html">SessionIdGenerator</a></li><li><a href="valve.html">阀</a></li></ul></div><div><h2>集群元素</h2><ul><li><a href="cluster.html">簇</a></li><li><a href="cluster-manager.html">经理</a></li><li><a href="cluster-channel.html">渠道</a></li><li><a href="cluster-membership.html">频道/会员</a></li><li><a href="cluster-sender.html">频道/发件人</a></li><li><a href="cluster-receiver.html">频道/接收器</a></li><li><a href="cluster-interceptor.html">通道/拦截器</a></li><li><a href="cluster-valve.html">阀</a></li><li><a href="cluster-deployer.html">部署者</a></li><li><a href="cluster-listener.html">集群监听器</a></li></ul></div><div><h2>web.xml</h2><ul><li><a href="filter.html">过滤</a></li></ul></div><div><h2>其他</h2><ul><li><a href="systemprops.html">系统属性</a></li><li><a href="jaspic.html">日本宝石</a></li></ul></div></nav></div></div><div id="mainRight"><div id="content"><h2>GlobalNamingResources组件</h2><h3 id="Table_of_Contents">目录</h3><div class="text">
<ul><li><a href="#Introduction">介绍</a></li><li><a href="#Attributes">属性</a></li><li><a href="#Nested_Components">嵌套组件</a></li><li><a href="#Special_Features">特殊功能</a><ol><li><a href="#Environment_Entries">环境条目</a></li><li><a href="#Resource_Definitions">资源定义</a></li><li><a href="#Resource_Links">资源链接</a></li><li><a href="#Transaction">交易</a></li></ol></li></ul>
</div><h3 id="Introduction">介绍</h3><div class="text">

  <p><strong>GlobalNamingResources</strong>元素定义<a href="server.html">服务器</a>的全局JNDI资源。</p>

  <p>这些资源在服务器的全局JNDI资源上下文中列出。该上下文不同于《 <a href="../jndi-resources-howto.html">JNDI资源指南》</a>中描述的每个Web应用程序的JNDI上下文。在每个Web应用程序上下文中，此元素中定义的资源是<strong>不</strong>可见的，除非您明确地将它们与<a href="context.html#Resource_Links"><resourcelink></resourcelink></a>元素。
  </p>

</div><h3 id="Attributes">属性</h3><div class="text">

</div><h3 id="Nested_Components">嵌套组件</h3><div class="text">

</div><h3 id="Special_Features">特殊功能</h3><div class="text">


  <div class="subsection"><h4 id="Environment_Entries">环境条目</h4><div class="text">

  <p>您可以通过嵌套配置将所有Web应用程序都可以看到的命名值作为环境条目资源<code><Environment></code>此元素内的条目。例如，您可以创建如下环境条目：</p>
<div class="codeBox"><pre><code>&lt;GlobalNamingResources ...&gt;
  ...
  &lt;Environment name="maxExemptions" value="10"
         type="java.lang.Integer" override="false"/&gt;
  ...
&lt;/GlobalNamingResources&gt;</code></pre></div>

    <p>这等效于在Web应用程序部署描述符中包含以下元素（ <code>/WEB-INF/web.xml</code> ）：</p>
<div class="codeBox"><pre><code>&lt;env-entry&gt;
  &lt;env-entry-name&gt;maxExemptions&lt;/env-entry-name&gt;
  &lt;env-entry-value&gt;10&lt;/env-entry-value&gt;
  &lt;env-entry-type&gt;java.lang.Integer&lt;/env-entry-type&gt;
&lt;/env-entry&gt;</code></pre></div>
    <p>但<em>不需要</em>修改deployment descriptor来定制这个值。</p>

    <p>的有效属性<code><Environment></code>元素如下：</p>

    <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><code class="attributeName">description</code></td><td>
        <p>此环境条目的可选的，易于阅读的描述。</p>
      </td></tr><tr><td><strong><code class="attributeName">name</code></strong></td><td>
        <p>要创建的环境条目的名称，相对于<code>java:comp/env</code>上下文。</p>
      </td></tr><tr><td><code class="attributeName">override</code></td><td>
        <p>设置为<code>false</code>如果你<strong>不</strong>想要的<code><env-entry></code>在Web应用程序部署描述符中找到的相同环境条目名称，以覆盖此处指定的值。默认情况下，允许覆盖。</p>
      </td></tr><tr><td><strong><code class="attributeName">type</code></strong></td><td>
        <p>Web应用程序为此环境条目期望的标准Java类名称。必须是具有法律价值<code><env-entry-type></code>在Web应用程序部署描述符中。</p>
      </td></tr><tr><td><strong><code class="attributeName">value</code></strong></td><td>
        <p>从JNDI上下文请求时将显示给应用程序的参数值。此值必须可转换为由<code>type</code>属性。</p>
      </td></tr></tbody></table>

  </div></div>


  <div class="subsection"><h4 id="Resource_Definitions">资源定义</h4><div class="text">

    <p>您可以声明要为JNDI查找返回的资源的特征<code><resource-ref></code>和<code><resource-env-ref></code> Web应用程序部署描述符中的元素，方法是在此元素中定义它们，然后将它们与<a href="context.html#Resource_Links"><resourcelink></resourcelink></a>中的元素<code><strong><Context></strong></code>元件。您还<strong>必须</strong>使用Resource元素上的属性定义任何其他所需的参数，以配置要使用的对象工厂（如果Tomcat尚不知道）以及用于配置该对象工厂的属性。</p>

    <p>例如，您可以创建如下的资源定义：</p>
<div class="codeBox"><pre><code>&lt;GlobalNamingResources ...&gt;
  ...
  &lt;Resource name="jdbc/EmployeeDB" auth="Container"
            type="javax.sql.DataSource"
     description="Employees Database for HR Applications"/&gt;
  ...
&lt;/GlobalNamingResources&gt;</code></pre></div>

    <p>这等效于在Web应用程序部署描述符中包含以下元素（ <code>/WEB-INF/web.xml</code> ）：</p>
<div class="codeBox"><pre><code>&lt;resource-ref&gt;
  &lt;description&gt;Employees Database for HR Applications&lt;/description&gt;
  &lt;res-ref-name&gt;jdbc/EmployeeDB&lt;/res-ref-name&gt;
  &lt;res-ref-type&gt;javax.sql.DataSource&lt;/res-ref-type&gt;
  &lt;res-auth&gt;Container&lt;/res-auth&gt;
&lt;/resource-ref&gt;</code></pre></div>

    <p>但<em>不需要</em>修改deployment descriptor来定制这个值。</p>

    <p>的有效属性<code><Resource></code>元素如下：</p>

    <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><code class="attributeName">auth</code></td><td>
        <p>指定Web应用程序代码是通过编程方式登录到相应的资源管理器，还是指定容器是否代表该应用程序登录到资源管理器。此属性的值必须为<code>Application</code>要么<code>Container</code> 。如果Web应用程序将使用该属性是<strong>必需的</strong> <code><resource-ref></code> Web应用程序部署描述符中的元素，但如果应用程序使用<code><resource-env-ref></code>代替。</p>
      </td></tr><tr><td><code class="attributeName">closeMethod</code></td><td>
        <p>当不再需要单例资源时调用零参数方法的名称。这是为了加快清理可能会作为垃圾回收一部分而发生的资源的速度。如果<code>singleton</code>属性为假。如果未指定，则不会定义默认值，也不会调用close方法。</p>
        <p>对于Apache Commons DBCP 2和Apache Tomcat JDBC连接池，可以使用<code>closeMethod="close"</code> 。请注意，Apache Commons DBCP 2要求将此设置为干净关闭。使用默认的Tomcat连接池（基于DBCP 2）时，Tomcat会自动设置此属性，除非将其显式设置为空字符串。</p>
      </td></tr><tr><td><code class="attributeName">description</code></td><td>
        <p>此资源的可选的，易于阅读的描述。</p>
      </td></tr><tr><td><strong><code class="attributeName">name</code></strong></td><td>
        <p>要创建的资源的名称，相对于<code>java:comp/env</code>上下文。</p>
      </td></tr><tr><td><code class="attributeName">scope</code></td><td>
        <p>指定是否可以共享通过此资源管理器获得的连接。此属性的值必须为<code>Shareable</code>要么<code>Unshareable</code> 。默认情况下，假定连接是可共享的。</p>
      </td></tr><tr><td><code class="attributeName">singleton</code></td><td>
        <p>指定此资源定义是否针对单例资源，即仅该资源的单个实例的资源。如果此属性是<code>true</code> ，对此资源的多个JNDI查找将返回相同的对象。如果此属性是<code>false</code> ，对此资源的多个JNDI查找将返回不同的对象。此属性必须是<code>true</code>对于<code>javax.sql.DataSource</code>资源以启用数据源的JMX注册。此属性的值必须为<code>true</code>要么<code>false</code> 。默认情况下，此属性为<code>true</code> 。
        </p>
      </td></tr><tr><td><strong><code class="attributeName">type</code></strong></td><td>
        <p>Web应用程序对此资源执行查找时需要的标准Java类名称。</p>
      </td></tr></tbody></table>


  </div></div>

  <div class="subsection"><h4 id="Resource_Links">资源链接</h4><div class="text">
    <p>使用<a href="context.html#Resource_Links"><code><ResourceLink></code></a>用于将资源从全局上下文链接到每个Web应用程序上下文的元素。这是一个基于<a href="../jndi-resources-howto.html#Generic_JavaBean_Resources">JNDI Resource How-To中</a>的示例定义，为应用程序提供定制工厂的示例：</p>

    <div class="codeBox"><pre><code>&lt;Context&gt;
  &lt;ResourceLink
    name="bean/MyBeanFactory"
    global="bean/MyBeanFactory"
    type="com.mycompany.MyBean"
  /&gt;
&lt;/Context&gt;</code></pre></div>

   </div></div>

  <div class="subsection"><h4 id="Transaction">交易</h4><div class="text">

    <p>您可以声明要为JNDI查找返回的UserTransaction的特征。 <code>java:comp/UserTransaction</code> 。您<strong>必须</strong>定义一个对象工厂类来实例化该对象以及所需的资源参数作为对象的属性。 <code>Transaction</code>元素，以及用于配置该对象工厂的属性。</p>

    <p>的有效属性<code><Transaction></code>元素如下：</p>

    <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><strong><code class="attributeName">factory</code></strong></td><td>
        <p>JNDI对象工厂的类名。</p>
      </td></tr></tbody></table>

  </div></div>

</div><div class="noprint"><h3 id="comments_section">评论</h3><div class="text"><p class="notice"><strong>注意：</strong>此注释部分收集有关改进Apache Tomcat文档的建议。<br><br>如果您遇到问题并需要帮助，请阅读“ <a href="https://tomcat.apache.org/findhelp.html">查找帮助”</a>页面，然后在tomcat-users <a href="https://tomcat.apache.org/lists.html">邮件列表中</a>询问您的问题。不要在这里问这样的问题。这不是“问答”部分。<br><br><a href="../comments.html">这里</a>解释<a href="../comments.html">了</a> Apache Comments System。如果评论已被实施或被认为无效/偏离主题，则我们的主持人可能会将其删除。
                  </p><div id="comments_thread"></div></div></div></div></div></div></div><footer><div id="footer">版权所有©1999-2019，Apache软件基金会</div></footer></div></body></html>