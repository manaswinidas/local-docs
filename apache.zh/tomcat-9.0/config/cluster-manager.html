<html lang="zh-Hans" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="../images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>Apache Tomcat 9配置参考（9.0.21）-ClusterManager对象</title><meta name="author" content="Filip Hanik"><script type="application/javascript" data-comments-identifier="tomcat-9.0-doc/config/cluster-manager">
    "use strict"; // Enable strict mode

    (function() {
      var thisScript = document.currentScript;
      if (!thisScript) { // Workaround for IE <= 11
        var scripts = document.getElementsByTagName("script");
        thisScript = scripts[scripts.length - 1];
      }
      document.addEventListener("DOMContentLoaded", (function() {
        var commentsDiv = document.getElementById("comments_thread");
        var commentsShortname = "tomcat";
        var commentsIdentifier = "https://tomcat.apache.org/" +
          thisScript.getAttribute("data-comments-identifier") + ".html";

        (function(w, d) {
          if (w.location.hostname.toLowerCase() == "tomcat.apache.org") {
            var s = d.createElement("script");
            s.type = "application/javascript";
            s.async = true;
            s.src = "https://comments.apache.org/show_comments.lua?site=" +
              encodeURIComponent(commentsShortname) +
              "&page=" + encodeURIComponent(commentsIdentifier);
            d.head.appendChild(s);
          } else {
            commentsDiv.appendChild(d.createTextNode("Comments are disabled for this page at the moment."));
          }
        })(window, document);
      }), false);
    })();
  </script></head><body ><div id="wrapper"><header><div id="header"><div><div><div class="logo noPrint"><a href="https://tomcat.apache.org/"><img alt="Tomcat主页" src="../images/tomcat.png"></a></div><div style="height:1px"></div><div class="asfLogo noPrint"><a href="https://www.apache.org/" target="_blank"><img src="../images/asf-logo.svg" alt="Apache软件基金会" style="width:266px;height:83px"></a></div><h1>Apache Tomcat 9配置参考</h1><div class="versionInfo">版本9.0.21， <time datetime="2019-06-04"> 2019年6月4日</time></div><div style="height:1px"></div><div style="clear:left"></div></div></div></div></header><div id="middle"><div><div id="mainLeft" class="noprint"><div><nav><div><h2>链接</h2><ul><li><a href="../index.html">文件首页</a></li><li><a href="index.html">配置参考家</a></li><li><a href="https://wiki.apache.org/tomcat/FAQ">常问问题</a></li><li><a href="#comments_section">用户评论</a></li></ul></div><div><h2>顶级元素</h2><ul><li><a href="server.html">服务器</a></li><li><a href="service.html">服务</a></li></ul></div><div><h2>执行者</h2><ul><li><a href="executor.html">执行者</a></li></ul></div><div><h2>连接器</h2><ul><li><a href="http.html">HTTP / 1.1</a></li><li><a href="http2.html">HTTP / 2</a></li><li><a href="ajp.html">AJP</a></li></ul></div><div><h2>货柜</h2><ul><li><a href="context.html">语境</a></li><li><a href="engine.html">发动机</a></li><li><a href="host.html">主办</a></li><li><a href="cluster.html">簇</a></li></ul></div><div><h2>嵌套组件</h2><ul><li><a href="cookie-processor.html">Cookie处理器</a></li><li><a href="credentialhandler.html">凭证处理程序</a></li><li><a href="globalresources.html">全球资源</a></li><li><a href="jar-scanner.html">JarScanner</a></li><li><a href="jar-scan-filter.html">JarScanFilter</a></li><li><a href="listeners.html">听众</a></li><li><a href="loader.html">装载机</a></li><li><a href="manager.html">经理</a></li><li><a href="realm.html">领域</a></li><li><a href="resources.html">资源资源</a></li><li><a href="sessionidgenerator.html">SessionIdGenerator</a></li><li><a href="valve.html">阀</a></li></ul></div><div><h2>集群元素</h2><ul><li><a href="cluster.html">簇</a></li><li><a href="cluster-manager.html">经理</a></li><li><a href="cluster-channel.html">渠道</a></li><li><a href="cluster-membership.html">频道/会员</a></li><li><a href="cluster-sender.html">频道/发件人</a></li><li><a href="cluster-receiver.html">频道/接收器</a></li><li><a href="cluster-interceptor.html">通道/拦截器</a></li><li><a href="cluster-valve.html">阀</a></li><li><a href="cluster-deployer.html">部署者</a></li><li><a href="cluster-listener.html">集群监听器</a></li></ul></div><div><h2>web.xml</h2><ul><li><a href="filter.html">过滤</a></li></ul></div><div><h2>其他</h2><ul><li><a href="systemprops.html">系统属性</a></li><li><a href="jaspic.html">日本宝石</a></li></ul></div></nav></div></div><div id="mainRight"><div id="content"><h2>ClusterManager对象</h2><h3 id="Table_of_Contents">目录</h3><div class="text">
<ul><li><a href="#Introduction">介绍</a></li><li><a href="javascript:void(0);">的<manager></manager></a></li><li><a href="#Attributes">属性</a><ol><li><a href="#Common_Attributes">共同属性</a></li><li><a href="#org.apache.catalina.ha.session.DeltaManager_Attributes">org.apache.catalina.ha.session。DeltaManager属性</a></li><li><a href="#org.apache.catalina.ha.session.BackupManager_Attributes">org.apache.catalina.ha.session。BackupManager属性</a></li></ol></li><li><a href="#Nested_Components">嵌套组件</a></li></ul>
</div><h3 id="Introduction">介绍</h3><div class="text">
  <p>集群管理器是Tomcat会话管理器界面的扩展， <code>org.apache.catalina.Manager</code> 。集群管理器必须实施<code>org.apache.catalina.ha.ClusterManager</code>并且完全负责会话的复制方式。<br>当前有两个不同的经理， <code>org.apache.catalina.ha.session.DeltaManager</code>将会话数据增量复制到群集中的所有成员。该实现已被证明并且可以很好地工作，但是有一个局限性，因为它要求集群成员是同构的，所有节点必须部署相同的应用程序并且是精确的副本。的<code>org.apache.catalina.ha.session.BackupManager</code>还复制增量，但仅复制到一个备份节点。群集中的所有节点都知道备份节点的位置。它还支持异构部署，因此管理者知道Web应用程序的部署位置。</p>
</div><h3 id="The_<Manager>">的<manager></manager></h3><div class="text">
  <p>的<code><Manager></code>内部定义的元素<code><Cluster></code>元素是为所有已标记的Web应用程序定义的模板<code><distributable/></code>在他们<code>web.xml</code>文件。但是，您仍然可以按每个Web应用程序覆盖管理器实现，方法是： <code><Manager></code>在 - 的里面<code><Context></code>元素在<code><a href="context.html">context.xml</a></code>文件或<code><a href="index.html">server.xml</a></code>文件。</p>
</div><h3 id="Attributes">属性</h3><div class="text">
  <div class="subsection"><h4 id="Common_Attributes">共同属性</h4><div class="text">
    <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><strong><code class="attributeName">className</code></strong></td><td>
      </td></tr><tr><td><code class="attributeName">name</code></td><td>
        <b>此集群管理器的名称，该名称用于标识节点上的会话管理器。名称可能会被<code>Cluster</code>使其在容器中唯一的元素。</b>
      </td></tr><tr><td><code class="attributeName">notifyListenersOnReplication</code></td><td>调成<code>true</code>如果希望在集群中的Tomcat节点之间复制或删除会话属性时通知会话侦听器。
      </td></tr><tr><td><code class="attributeName">processExpiresFrequency</code></td><td>
        <p>会话到期的频率以及相关的管理员操作。对于指定数量的backgroundProcess调用，管理器操作将执行一次（即，数量越低，检查将越频繁）。最小值为1，默认值为6。
        </p>
      </td></tr><tr><td><code class="attributeName">secureRandomClass</code></td><td>
        <p>扩展的Java类的名称<code>java.security.SecureRandom</code>用于生成会话ID。如果未指定，则默认值为<code>java.security.SecureRandom</code> 。</p>
      </td></tr><tr><td><code class="attributeName">secureRandomProvider</code></td><td>
        <p>提供者的名称，用于创建<code>java.security.SecureRandom</code>生成会话ID的实例。如果指定了无效的算法和/或提供程序，则Manager将使用平台默认提供程序和默认算法。如果未指定，将使用平台默认提供程序。</p>
      </td></tr><tr><td><code class="attributeName">secureRandomAlgorithm</code></td><td>
        <p>用于创建算法的算法名称<code>java.security.SecureRandom</code>生成会话ID的实例。如果指定了无效的算法和/或提供程序，则Manager将使用平台默认提供程序和默认算法。如果未指定，将使用SHA1PRNG的默认算法。如果不支持默认算法，则将使用平台默认值。要指定应使用平台默认值，请不要设置secureRandomProvider属性并将此属性设置为空字符串。</p>
      </td></tr><tr><td><code class="attributeName">recordAllActions</code></td><td>
        <p>标记是否在Tomcat集群节点之间发送所有会话操作。如果设置为false，并且已经对同一属性执行了某些操作，请确保不要跨Tomcat集群节点发送多个操作。在这种情况下，仅发送最后添加的操作。默认为<code>false</code> 。</p>
      </td></tr></tbody></table>
  </div></div>
  <div class="subsection"><h4 id="org.apache.catalina.ha.session.DeltaManager_Attributes">org.apache.catalina.ha.session。DeltaManager属性</h4><div class="text">
    <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><code class="attributeName">expireSessionsOnShutdown</code></td><td>关闭Web应用程序时，Tomcat会向每个会话发出过期调用，以通知所有侦听器。如果您希望当一个节点发生关闭时所有会话在所有节点上到期，请将此值设置为<code>true</code> 。默认值为<code>false</code> 。
      </td></tr><tr><td><code class="attributeName">maxActiveSessions</code></td><td>此管理器将创建的活动会话的最大数目，或-1（默认值）无限制。对于此管理器，无论当前节点是否是该会话的主节点，所有会话均被视为活动会话。
      </td></tr><tr><td><code class="attributeName">notifySessionListenersOnReplication</code></td><td>调成<code>true</code>如果希望在集群中的Tomcat节点之间创建会话并使其过期时通知会话侦听器。
      </td></tr><tr><td><code class="attributeName">notifyContainerListenersOnReplication</code></td><td>调成<code>true</code>如果希望在群集中的Tomcat节点之间通知容器侦听器。
      </td></tr><tr><td><code class="attributeName">stateTransferTimeout</code></td><td>节点启动时等待会话状态从另一个节点完成传输的时间（以秒为单位）。默认值为<code>60</code>秒。
      </td></tr><tr><td><code class="attributeName">sendAllSessions</code></td><td>标记是否将会话作为拆分块发送。如果设置为<code>true</code> ，将所有会话作为一个大块发送。如果设置为<code>false</code> ，将会话作为拆分块发送。默认值为<code>true</code> 。
      </td></tr><tr><td><code class="attributeName">sendAllSessionsSize</code></td><td>会话阻止消息中的会话数。该值仅在以下情况下有效<code>sendAllSessions</code>是<code>false</code> 。默认为<code>1000</code> 。
      </td></tr><tr><td><code class="attributeName">sendAllSessionsWaitTime</code></td><td>发送会话阻止消息之间的等待时间。该值仅在以下情况下有效<code>sendAllSessions</code>是<code>false</code> 。默认为<code>2000</code>毫秒。
      </td></tr><tr><td><code class="attributeName">sessionAttributeNameFilter</code></td><td>
        <p>用于过滤要复制的会话属性的正则表达式。仅当属性名称与此模式匹配时，该属性才会被复制。如果图案是零长度或<code>null</code> ，所有属性都可以复制。该模式已锚定，因此会话属性名称必须与该模式完全匹配。例如，值<code>(userName|sessionHistory)</code>将只复制两个名为<code>userName</code>和<code>sessionHistory</code> 。如果未指定，则默认值为<code>null</code>将会被使用。</p>
      </td></tr><tr><td><code class="attributeName">sessionAttributeValueClassNameFilter</code></td><td>
        <p>用于过滤要复制的会话属性的正则表达式。仅当值的实现类名称与此模式匹配时，才会复制属性。如果图案是零长度或<code>null</code> ，所有属性都可以复制。模式是固定的，因此完全限定的类名称必须与模式完全匹配。如果未指定，则默认值为<code>null</code>除非使用<code>SecurityManager</code>在这种情况下默认启用<code>java\\.lang\\.(?:Boolean|Integer|Long|Number|String)</code> 。</p>
      </td></tr><tr><td><code class="attributeName">stateTimestampDrop</code></td><td>当此节点发送一个<code>GET_ALL_SESSIONS</code>如果消息发送到其他节点，则将作为响应接收的所有会话消息排队。如果此属性设置为<code>true</code> ，收到的会话消息（任何<code>GET_ALL_SESSIONS</code>由其他节点发送）按其时间戳过滤。如果不是<code>GET_ALL_SESSIONS</code>消息及其时间戳早于我们的时间戳<code>GET_ALL_SESSIONS</code>信息。如果设置为<code>false</code> ，将处理所有排队的会话消息。默认为<code>true</code> 。
      </td></tr><tr><td><code class="attributeName">warnOnSessionAttributeFilterFailure</code></td><td>
        <p>如果<strong>sessionAttributeNameFilter</strong>或<strong>sessionAttributeValueClassNameFilter</strong>阻止属性，则应在以下位置记录该属性<code>WARN</code>水平？如果<code>WARN</code>级别的日志记录被禁用，那么它将被记录在<code>DEBUG</code> 。此属性的默认值为<code>false</code>除非<code>SecurityManager</code>在这种情况下默认启用<code>true</code> 。</p>
      </td></tr></tbody></table>
  </div></div>
  <div class="subsection"><h4 id="org.apache.catalina.ha.session.BackupManager_Attributes">org.apache.catalina.ha.session。BackupManager属性</h4><div class="text">
    <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><code class="attributeName">mapSendOptions</code></td><td>备份管理器使用复制的映射，此映射正在发送和接收消息。您可以设置此地图如何发送消息的标志，默认值为<code>6</code> （同步）。<br>请注意，如果您使用异步消息传递，则可能由接收节点以与发送消息的顺序不同的顺序来处理会话的更新消息。
      </td></tr><tr><td><code class="attributeName">maxActiveSessions</code></td><td>此管理器将创建的活动会话的最大数目，或者为-1（默认值）（无限制）。对于此管理器，只有当前节点为该会话的主节点的会话才被视为活动会话。
      </td></tr><tr><td><code class="attributeName">rpcTimeout</code></td><td>RPC消息的超时，用于从另一个映射进行广播和传输状态。默认值为<code>15000</code>毫秒。
      </td></tr><tr><td><code class="attributeName">sessionAttributeNameFilter</code></td><td>
        <p>用于过滤要复制的会话属性的正则表达式。仅当属性名称与此模式匹配时，该属性才会被复制。如果图案是零长度或<code>null</code> ，所有属性都可以复制。该模式已锚定，因此会话属性名称必须与该模式完全匹配。例如，值<code>(userName|sessionHistory)</code>将只复制两个名为<code>userName</code>和<code>sessionHistory</code> 。如果未指定，则默认值为<code>null</code>将会被使用。</p>
      </td></tr><tr><td><code class="attributeName">sessionAttributeValueClassNameFilter</code></td><td>
        <p>用于过滤要复制的会话属性的正则表达式。仅当值的实现类名称与此模式匹配时，才会复制属性。如果图案是零长度或<code>null</code> ，所有属性都可以复制。模式是固定的，因此完全限定的类名称必须与模式完全匹配。如果未指定，则默认值为<code>null</code>除非使用<code>SecurityManager</code>在这种情况下默认启用<code>java\\.lang\\.(?:Boolean|Integer|Long|Number|String)</code> 。</p>
      </td></tr><tr><td><code class="attributeName">terminateOnStartFailure</code></td><td>如果您希望在复制映射启动失败时终止复制映射，请设置为true。如果复制映射终止，则关联的上下文将无法启动。如果将此属性设置为false，则复制映射不会结束。它将尝试在心跳中加入地图成员。默认值为<code>false</code> 。
      </td></tr><tr><td><code class="attributeName">warnOnSessionAttributeFilterFailure</code></td><td>
        <p>如果<strong>sessionAttributeNameFilter</strong>或<strong>sessionAttributeValueClassNameFilter</strong>阻止属性，则应在以下位置记录该属性<code>WARN</code>水平？如果<code>WARN</code>级别的日志记录被禁用，那么它将被记录在<code>DEBUG</code> 。此属性的默认值为<code>false</code>除非<code>SecurityManager</code>在这种情况下默认启用<code>true</code> 。</p>
      </td></tr><tr><td><code class="attributeName">accessTimeout</code></td><td>ping消息超时。如果远程地图在此超时时间内没有响应，则视为已消失。默认值为<code>5000</code>毫秒。
      </td></tr></tbody></table>
  </div></div>
</div><h3 id="Nested_Components">嵌套组件</h3><div class="text">
  <h3>所有经理实施</h3>
  <p>所有Manager的实现都允许嵌套一个<strong><sessionidgenerator></sessionidgenerator></strong>元件。它定义了会话ID生成的行为。<a href="sessionidgenerator.html">SessionIdGenerator的</a>所有实现均具有以下属性：</p>
  <table class="defaultTable"><tbody><tr><th style="width:15%">属性</th><th style="width:85%">描述</th></tr><tr><td><code class="attributeName">sessionIdLength</code></td><td>
      <p>会话ID的长度可以使用<strong>sessionIdLength</strong>属性更改。
      </p>
    </td></tr></tbody></table>
</div><div class="noprint"><h3 id="comments_section">评论</h3><div class="text"><p class="notice"><strong>注意：</strong>此注释部分收集有关改进Apache Tomcat文档的建议。<br><br>如果您遇到问题并需要帮助，请阅读“ <a href="https://tomcat.apache.org/findhelp.html">查找帮助”</a>页面，然后在tomcat-users <a href="https://tomcat.apache.org/lists.html">邮件列表中</a>询问您的问题。不要在这里问这样的问题。这不是“问答”部分。<br><br><a href="../comments.html">这里</a>解释<a href="../comments.html">了</a> Apache Comments System。如果评论已被实施或被认为无效/偏离主题，则我们的主持人可能会将其删除。
                  </p><div id="comments_thread"></div></div></div></div></div></div></div><footer><div id="footer">版权所有©1999-2019，Apache软件基金会</div></footer></div></body></html>