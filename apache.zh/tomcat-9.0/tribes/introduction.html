<html lang="zh-Hans" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="../images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>Apache Tribes-Tomcat集群通信模块（9.0.21）-Apache Tribes-简介</title><meta name="author" content="Filip Hanik"><script type="application/javascript" data-comments-identifier="tomcat-9.0-doc/tribes/introduction">
    "use strict"; // Enable strict mode

    (function() {
      var thisScript = document.currentScript;
      if (!thisScript) { // Workaround for IE <= 11
        var scripts = document.getElementsByTagName("script");
        thisScript = scripts[scripts.length - 1];
      }
      document.addEventListener("DOMContentLoaded", (function() {
        var commentsDiv = document.getElementById("comments_thread");
        var commentsShortname = "tomcat";
        var commentsIdentifier = "https://tomcat.apache.org/" +
          thisScript.getAttribute("data-comments-identifier") + ".html";

        (function(w, d) {
          if (w.location.hostname.toLowerCase() == "tomcat.apache.org") {
            var s = d.createElement("script");
            s.type = "application/javascript";
            s.async = true;
            s.src = "https://comments.apache.org/show_comments.lua?site=" +
              encodeURIComponent(commentsShortname) +
              "&page=" + encodeURIComponent(commentsIdentifier);
            d.head.appendChild(s);
          } else {
            commentsDiv.appendChild(d.createTextNode("Comments are disabled for this page at the moment."));
          }
        })(window, document);
      }), false);
    })();
  </script></head><body ><div id="wrapper"><header><div id="header"><div><div><div class="logo noPrint"><a href="https://tomcat.apache.org/"><img alt="Tomcat主页" src="../images/tomcat.png"></a></div><div style="height:1px"></div><div class="asfLogo noPrint"><a href="https://www.apache.org/" target="_blank"><img src="../images/asf-logo.svg" alt="Apache软件基金会" style="width:266px;height:83px"></a></div><h1>Apache Tribes-Tomcat集群通信模块</h1><div class="versionInfo">版本9.0.21， <time datetime="2019-06-04"> 2019年6月4日</time></div><div style="height:1px"></div><div style="clear:left"></div></div></div></div></header><div id="middle"><div><div id="mainLeft" class="noprint"><div><nav><div><h2>链接</h2><ul><li><a href="../index.html">文件首页</a></li><li><a href="introduction.html">部落文件首页</a></li><li><a href="https://wiki.apache.org/tomcat/FAQ">常问问题</a></li><li><a href="#comments_section">用户评论</a></li></ul></div><div><h2>用户指南</h2><ul><li><a href="introduction.html">1）简介</a></li><li><a href="setup.html">2）设定</a></li><li><a href="faq.html">3）常见问题</a></li></ul></div><div><h2>参考</h2><ul><li><a href="../api/org/apache/catalina/tribes/package-summary.html">Java文档</a></li></ul></div><div><h2>Apache部落开发</h2><ul><li><a href="membership.html">会员资格</a></li><li><a href="transport.html">运输</a></li><li><a href="interceptors.html">拦截器</a></li><li><a href="status.html">状态</a></li><li><a href="developers.html">开发者</a></li></ul></div></nav></div></div><div id="mainRight"><div id="content"><h2>Apache部落-简介</h2><h3 id="Table_of_Contents">目录</h3><div class="text">
<ul><li><a href="#Quick_Start">快速开始</a></li><li><a href="#What_is_Tribes">什么是部落</a></li><li><a href="#Why_another_messaging_framework">为什么要使用其他消息传递框架</a></li><li><a href="#Feature_Overview">功能概述</a></li><li><a href="#Where_can_I_get_Tribes">我在哪里可以得到部落</a></li></ul>
</div><h3 id="Quick_Start">快速开始</h3><div class="text">

  <p>Apache Tribes是一个组或对等通信框架，使您可以轻松地连接远程对象以相互通信。
  </p>
  <ul>
    <li>进口：<code>org.apache.catalina.tribes.Channel</code></li>
    <li>进口：<code>org.apache.catalina.tribes.Member</code></li>
    <li>进口：<code>org.apache.catalina.tribes.MembershipListener</code></li>
    <li>进口：<code>org.apache.catalina.tribes.ChannelListener</code></li>
    <li>进口：<code>org.apache.catalina.tribes.group.GroupChannel</code></li>
    <li>创建一个实现以下内容的类：<code>org.apache.catalina.tribes.ChannelListener</code></li>
    <li>创建一个实现以下内容的类：<code>org.apache.catalina.tribes.MembershipListener</code></li>
    <li>简单的类来演示如何发送消息：<div class="codeBox"><pre><code>//create a channel
Channel myChannel = new GroupChannel();

//create my listeners
ChannelListener msgListener = new MyMessageListener();
MembershipListener mbrListener = new MyMemberListener();

//attach the listeners to the channel
myChannel.addMembershipListener(mbrListener);
myChannel.addChannelListener(msgListener);

//start the channel
myChannel.start(Channel.DEFAULT);

//create a message to be sent, message must implement java.io.Serializable
//for performance reasons you probably want them to implement java.io.Externalizable
Serializable myMsg = new MyMessage();

//retrieve my current members
Member[] group = myChannel.getMembers();

//send the message
myChannel.send(group,myMsg,Channel.SEND_OPTIONS_DEFAULT);</code></pre></div>
    </li>
  </ul>
  <p>简单吗？Tribes的功能远远超过我们所展示的，希望文档能够为您提供更多的解释。请记住，我们一直对建议，改进，错误修复以及您认为对本项目有帮助的任何事物都感兴趣。
  </p>
</div><h3 id="What_is_Tribes">什么是部落</h3><div class="text">
  <p>部落是具有团队沟通能力的消息传递框架。部落允许您通过网络发送和接收消息，还可以动态发现网络中的其他节点。<br>这就是短篇小说，真的很简单。以下部分将介绍使部落有用和独特的原因。<br>
  </p>
  <p>Tribes模块于2006年初启动，一小部分代码库来自2003或2004年以来一直存在的集群模块。当前的群集实现有几个缺点，由于组通信的复杂性，创建了许多解决方法。长话短说，很久以前应该是两个模块，而现在。部落消除了复制模块中消息传递的复杂性，并成为一个完全独立且高度灵活的组通信模块。<br>
  </p>
  <p>在Tomcat中，旧的<code>modules/cluster</code>现在变成了<code>modules/groupcom</code> （部落）和<code>modules/ha</code> （复制）。这将使开发得以继续进行，并使开发人员专注于他们实际正在处理的问题，而不是陷入对他们不感兴趣的模块的细节的困惑中。理解是，通信和复制都足够复杂，并且当尝试在同一模块中进行开发时，众所周知，它成为一个集群:)<br>
  </p>
  <p>部落允许有保证的消息传递，并且可以通过多种方式进行自定义。为什么这很重要？<br>好吧，作为开发人员，您想知道您发送的消息已到达目的地。更重要的是，如果消息未到达目的地，则将通知Tribes顶部的应用程序该消息从未发送过，以及消息发送到哪个节点失败。
  </p>

</div><h3 id="Why_another_messaging_framework">为什么要使用其他消息传递框架</h3><div class="text">
  <p>我是重用代码的忠实拥护者，如果别人已经做过并且我和我尝试服务的社区都可以使用它，那么我永远也不会梦想开发它。<br>当我进行研究以改进集群模块时，我经常遇到一些障碍：<br>1。框架不够灵活<br>2。该框架的许可方式使我和社区都无法使用<br>3。我缺少的几个功能<br>4。消息传递得到了保证，但是没有反馈给我<br>5，我的消息传递的语义必须在运行时之前配置<br>清单还在继续...
  </p>
  <p>因此，我想到了Tribes，以解决这些问题以及随之而来的其他问题。在设计Tribes时，我想确保我不会失去现有框架已经提供的任何灵活性和交付语义。目标是创建一个框架，该框架可以完成其他人已经做的所有事情，但为应用程序开发人员提供更大的灵活性。在下一部分中，将为您简要概述部落提供的功能或将提供的功能。
  </p>
</div><h3 id="Feature_Overview">功能概述</h3><div class="text">
  <p>为了让您对功能集有所了解，我将在此处列出。如果是的话，某些功能尚未完成。
  </p>
  <p>
    <b>可插拔模块</b><br>部落是使用接口构建的。可以替换掉属于Tribes的任何模块或组件，以自定义自己的Tribes实现。
  </p>
  <p>
    <b>保证消息</b><br>在Tribes的默认实现中，使用TCP或UDP进行消息传递。TCP已内置有保证的消息传递和流控制。我相信Java TCP的性能将胜过Java / UDP /流控制/消息保证的实现，因为逻辑发生在堆栈的更下方。已添加UDP消息传递，以便在需要时通过UDP而不是TCP发送消息。如下所述的相同保证方案仍然可以通过UDP使用，但是，如果UDP消息丢失，则认为失败。<br>部落支持非阻塞和阻塞IO操作。推荐的设置是使用非阻塞，因为它在发送和接收消息时会促进更好的并行性。对于那些NIO仍然是麻烦孩子的平台，可以使用阻塞实现。
  </p>
  <p>
    <b>不同的保证等级</b><br>发送消息时，有三种不同级别的传递保证。
  </p>
    <ol>
      <li>基于IO的发送保证。 -最快，最不可靠<br>这意味着，如果消息已发送到套接字发送缓冲区并被接受，则Tribes认为消息传输已成功。<br>在阻止IO时，这将是<code>socket.getOutputStream().write(msg)</code><br>在非阻塞IO上，这将是<code>socketChannel.write()</code> ，然后先清空缓冲区字节缓冲区<code>socketChannel.read()</code>确保通道仍然打开。的<code>read()</code>自从被添加<code>write()</code>如果使用NIO时连接已“关闭”，则将成功。</li>
      <li>基于ACK。 -推荐，有保证的交货<br>当已在远程节点上接收到该消息时，将ACK发送回发送方，指示该消息已成功接收。
      </li>
      <li>基于SYNC_ACK。 -保证交货，保证加工，最慢<br>当已在远程节点上接收到该消息时，该节点将处理该消息，并且如果成功处理了该消息，则会将ACK发送回发送方，指示已成功接收和处理了该消息。如果接收到消息，但处理失败，则将ACK_FAIL发送回发送者。这是一项独特的功能，可为应用程序开发人员增加不可思议的价值。此处的大多数框架都将告诉您消息已传递，并且应用程序开发人员必须建立逻辑，以确定消息是否实际上已由远程节点上的应用程序正确处理。如果配置，则Tribes收到ACK_FAIL并将其与未处理消息的成员相关联时将引发异常。
      </li>
    </ol>
  <p>当然，您可以编写更复杂的担保级别，其中的一些将在文档的稍后部分提到。一个可提及的级别是“两阶段提交”，其中远程应用程序直到所有节点都收到消息后才接收消息。有点像全有或全无的协议。
  </p>
  <p>
    <b>每个邮件传递属性</b><br>也许使Tribes在群体交流框架中脱颖而出的功能。部落使您可以发送消息，以决定每条消息传递消息传递应具有的传递语义。意思是，您的消息不会基于某些静态配置来传递，这些静态配置在消息框架启动后仍保持不变。<br>为了举例说明此功能的强大功能，我将尝试通过一个简单的示例对其进行说明。假设您需要发送10条不同的消息，则可以通过以下方式发送它们：</p>
    <div class="codeBox"><pre><code>Message_1 - asynchronous and fast, no guarantee required, fire and forget
Message_2 - all-or-nothing, either all receivers get it, or none.
Message_3 - encrypted and SYNC_ACK based
Message_4 - asynchronous, SYNC_ACK and call back when the message is processed on the remote nodes
Message_5 - totally ordered, this message should be received in the same order on all nodes that have been
            send totally ordered
Message_6 - asynchronous and totally ordered
Message_7 - RPC message, send a message, wait for all remote nodes to reply before returning
Message_8 - RPC message, wait for the first reply
Message_9 - RPC message, asynchronous, don't wait for a reply, collect them via a callback
Message_10- sent to a member that is not part of this group</code></pre></div>
  <p>正如您现在可以想象的那样，这些仅是示例。可以在每个消息基础上应用的不同语义的数量几乎是无限的。通过“部落”，您可以在一条消息上设置多达28种不同的内容，然后将“部落”配置为使该标志导致对该消息采取何种操作的标志。<br>想象一个共享的事务缓存，读取可能超过90％，并且脏读取应该完全无序，并尽可能快地交付。但另一方面，必须对事务写入进行排序，以确保没有缓存被破坏。使用部落，您可以完全按顺序发送写入消息，而读取消息则可以简单触发以实现最高吞吐量。<br>关于如何使用此强大功能可能会有更好的示例，因此请利用您的想象力和经验来思考如何在应用程序中使您受益。
  </p>
  <p>
    <b>基于拦截器的消息处理</b><br>部落使用可自定义的拦截器堆栈来处理发送和接收的消息。<br>
    <i>那么，所有框架都有这个！</i><br>是的，但是在部落中，拦截器可以根据运行时发送的每个消息属性对消息做出反应。意思是，如果添加加密消息的加密拦截器，则可以决定该拦截器将加密所有消息，还是仅加密由Tribes上运行的应用程序确定的某些消息。<br>这就是Tribes能够发送完全有条不紊的某些消息，而另一些则触发并忘记样式的方法，例如上面的示例。<br>可用的拦截器的数量将持续增长，我们将不胜感激。
  </p>
  <p>
    <b>无线程拦截器堆栈</b>拦截器不需要任何单独的线程来执行其消息操作。<br>发送的消息将背负在通过传输一直发送它们的线程上。唯一的例外是<code>MessageDispatchInterceptor</code>它将使消息排队，并在单独的线程上将其发送以进行异步消息传递。接收到的消息是由线程池中的线程池控制的<code>receiver</code>零件。<br>频道对象可以发送<code>heartbeat()</code>通过拦截器堆栈以允许超时，清理和其他事件。<br>的<code>MessageDispatchInterceptor</code>是默认情况下配置的唯一拦截器。
  </p>
  <p>
    <b>平行交付</b><br>部落支持并行传递消息。这意味着node_A可以并行地向node_B发送三个消息。当发送具有不同传递语义的消息时，此功能很有用。否则，如果Message_1被完全命令发送，则Message_2将不得不等待该消息完成。<br>通过NIO，部落也可以在同一线程上同时向多个接收者发送消息。
  </p>
  <p>
    <b>静默成员消息</b><br>使用部落，您可以将消息发送给不在您的组中的成员。因此，默认情况下，即使当今的动态发现模块通过使用多播进行动态节点发现而仅限于局域网，您仍可以通过广域网发送消息。当然，将来会扩展成员资格组件以支持WAN成员资格。但是，当您要隐藏组中其他成员并仅与他们交流时，这非常有用</p>
</div><h3 id="Where_can_I_get_Tribes">我在哪里可以得到部落</h3><div class="text">
  <p>部落作为Tomcat的模块提供，并作为Apache Tomcat发行版的一部分发布。
  </p>


</div><div class="noprint"><h3 id="comments_section">评论</h3><div class="text"><p class="notice"><strong>注意：</strong>此注释部分收集有关改进Apache Tomcat文档的建议。<br><br>如果您遇到问题并需要帮助，请阅读“ <a href="https://tomcat.apache.org/findhelp.html">查找帮助”</a>页面，然后在tomcat-users <a href="https://tomcat.apache.org/lists.html">邮件列表中</a>询问您的问题。不要在这里问这样的问题。这不是“问答”部分。<br><br><a href="../comments.html">这里</a>解释<a href="../comments.html">了</a> Apache Comments System。如果评论已被实施或被认为无效/偏离主题，则我们的主持人可能会将其删除。
                  </p><div id="comments_thread"></div></div></div></div></div></div></div><footer><div id="footer">版权所有©1999-2019，Apache软件基金会</div></footer></div></body></html>