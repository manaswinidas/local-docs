<html lang="zh-Hans" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="./images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>Apache Tomcat 9（9.0.21）-安全注意事项</title><script type="application/javascript" data-comments-identifier="tomcat-9.0-doc/security-howto">
    "use strict"; // Enable strict mode

    (function() {
      var thisScript = document.currentScript;
      if (!thisScript) { // Workaround for IE <= 11
        var scripts = document.getElementsByTagName("script");
        thisScript = scripts[scripts.length - 1];
      }
      document.addEventListener("DOMContentLoaded", (function() {
        var commentsDiv = document.getElementById("comments_thread");
        var commentsShortname = "tomcat";
        var commentsIdentifier = "https://tomcat.apache.org/" +
          thisScript.getAttribute("data-comments-identifier") + ".html";

        (function(w, d) {
          if (w.location.hostname.toLowerCase() == "tomcat.apache.org") {
            var s = d.createElement("script");
            s.type = "application/javascript";
            s.async = true;
            s.src = "https://comments.apache.org/show_comments.lua?site=" +
              encodeURIComponent(commentsShortname) +
              "&page=" + encodeURIComponent(commentsIdentifier);
            d.head.appendChild(s);
          } else {
            commentsDiv.appendChild(d.createTextNode("Comments are disabled for this page at the moment."));
          }
        })(window, document);
      }), false);
    })();
  </script></head><body ><div id="wrapper"><header><div id="header"><div><div><div class="logo noPrint"><a href="https://tomcat.apache.org/"><img alt="Tomcat主页" src="./images/tomcat.png"></a></div><div style="height:1px"></div><div class="asfLogo noPrint"><a href="https://www.apache.org/" target="_blank"><img src="./images/asf-logo.svg" alt="Apache软件基金会" style="width:266px;height:83px"></a></div><h1>Apache Tomcat 9</h1><div class="versionInfo">版本9.0.21， <time datetime="2019-06-04"> 2019年6月4日</time></div><div style="height:1px"></div><div style="clear:left"></div></div></div></div></header><div id="middle"><div><div id="mainLeft" class="noprint"><div><nav><div><h2>链接</h2><ul><li><a href="index.html">文件首页</a></li><li><a href="https://wiki.apache.org/tomcat/FAQ">常问问题</a></li><li><a href="#comments_section">用户评论</a></li></ul></div><div><h2>用户指南</h2><ul><li><a href="introduction.html">1）简介</a></li><li><a href="setup.html">2）设定</a></li><li><a href="appdev/index.html">3）第一个webapp</a></li><li><a href="deployer-howto.html">4）部署者</a></li><li><a href="manager-howto.html">5）经理</a></li><li><a href="host-manager-howto.html">6）主机管理员</a></li><li><a href="realm-howto.html">7）领域和AAA</a></li><li><a href="security-manager-howto.html">8）安全经理</a></li><li><a href="jndi-resources-howto.html">9）JNDI资源</a></li><li><a href="jndi-datasource-examples-howto.html">10）JDBC数据源</a></li><li><a href="class-loader-howto.html">11）类加载</a></li><li><a href="jasper-howto.html">12）JSP</a></li><li><a href="ssl-howto.html">13）SSL / TLS</a></li><li><a href="ssi-howto.html">14）SSI</a></li><li><a href="cgi-howto.html">15）CGI</a></li><li><a href="proxy-howto.html">16）代理支持</a></li><li><a href="mbeans-descriptors-howto.html">17）MBean描述符</a></li><li><a href="default-servlet.html">18）默认Servlet</a></li><li><a href="cluster-howto.html">19）聚类</a></li><li><a href="balancer-howto.html">20）负载均衡器</a></li><li><a href="connectors.html">21）连接器</a></li><li><a href="monitoring.html">22）监控与管理</a></li><li><a href="logging.html">23）记录</a></li><li><a href="apr.html">24）APR /本地</a></li><li><a href="virtual-hosting-howto.html">25）虚拟主机</a></li><li><a href="aio.html">26）高级IO</a></li><li><a href="extras.html">27）附加组件</a></li><li><a href="maven-jars.html">28）行刑</a></li><li><a href="security-howto.html">29）安全注意事项</a></li><li><a href="windows-service-howto.html">30）Windows服务</a></li><li><a href="windows-auth-howto.html">31）Windows身份验证</a></li><li><a href="jdbc-pool.html">32）Tomcat的JDBC池</a></li><li><a href="web-socket-howto.html">33）WebSocket</a></li><li><a href="rewrite.html">34）改写</a></li></ul></div><div><h2>参考</h2><ul><li><a href="RELEASE-NOTES.txt">发行说明</a></li><li><a href="config/index.html">组态</a></li><li><a href="api/index.html">Tomcat Java文档</a></li><li><a href="servletapi/index.html">Servlet Java文档</a></li><li><a href="jspapi/index.html">JSP 2.3 Java文档</a></li><li><a href="elapi/index.html">EL 3.0 Java文档</a></li><li><a href="websocketapi/index.html">WebSocket 1.1 Java文档</a></li><li><a href="https://tomcat.apache.org/connectors-doc/">JK 1.2文档</a></li></ul></div><div><h2>Apache Tomcat开发</h2><ul><li><a href="building.html">建造</a></li><li><a href="changelog.html">变更日志</a></li><li><a href="https://wiki.apache.org/tomcat/TomcatVersions">状态</a></li><li><a href="developers.html">开发者</a></li><li><a href="architecture/index.html">建筑</a></li><li><a href="funcspecs/index.html">功能规格。</a></li><li><a href="tribes/introduction.html">部族</a></li></ul></div></nav></div></div><div id="mainRight"><div id="content"><h2>安全注意事项</h2><h3 id="Table_of_Contents">目录</h3><div class="text">
<ul><li><a href="#Introduction">介绍</a></li><li><a href="#Non-Tomcat_settings">非Tomcat设置</a><ol><li><a href="#JMX">JMX</a></li></ol></li><li><a href="#Default_web_applications">默认Web应用程序</a><ol><li><a href="#Default_web_applications/General">一般</a></li><li><a href="#ROOT">根</a></li><li><a href="#Documentation">文献资料</a></li><li><a href="#Examples">例子</a></li><li><a href="#Default_web_applications/Manager">经理</a></li><li><a href="#Host_Manager">房东经理</a></li><li><a href="#Securing_Management_Applications">保护管理应用程序</a></li></ol></li><li><a href="#Security_manager">安全经理</a></li><li><a href="#server.xml">server.xml</a><ol><li><a href="#server.xml/General">一般</a></li><li><a href="#Server">服务器</a></li><li><a href="#Listeners">听众</a></li><li><a href="#Connectors">连接器</a></li><li><a href="#Host">主办</a></li><li><a href="#Context">语境</a></li><li><a href="#Valves">阀门</a></li><li><a href="#Realms">境界</a></li><li><a href="#server.xml/Manager">经理</a></li><li><a href="#Cluster">簇</a></li></ol></li><li><a href="#System_Properties">系统属性</a></li><li><a href="#web.xml">web.xml</a></li><li><a href="#General">一般</a></li></ul>
</div><h3 id="Introduction">介绍</h3><div class="text">
    <p>默认情况下，将Tomcat配置为在大多数情况下具有合理的安全性。某些环境可能需要更多或更少的安全配置。该页面旨在为可能影响安全性的配置选项提供单一参考，并就更改这些选项的预期影响提供一些说明。目的是提供评估Tomcat安装的安全性时应考虑的配置选项列表。</p>

    <p><strong>注意</strong> ：阅读此页不能代替阅读和理解详细的配置文档。有关这些属性的完整描述，请参见相关文档页面。</p>
  </div><h3 id="Non-Tomcat_settings">非Tomcat设置</h3><div class="text">
    <p>Tomcat配置不应该是唯一的防线。系统中的其他组件（操作系统，网络，数据库等）也应得到保护。</p>
    <p>Tomcat不应在root用户下运行。为Tomcat进程创建一个专用用户，并为该用户提供操作系统的最低必需权限。例如，应该不可能使用Tomcat用户远程登录。</p>
    <p>文件权限也应适当限制。在里面<code>.tar.gz</code>发行版，文件和目录不可读，并且该组没有写访问权。在像Unix之类的操作系统上，Tomcat以默认的umask运行<code>0027</code>为在Tomcat运行时创建的文件（例如日志文件，扩展的WAR等）维护这些权限。</p>
    <p>以ASF上的Tomcat实例为例（禁用自动部署，并将Web应用程序部署为分解目录），标准配置是使所有Tomcat文件归root用户所有，并具有Tomcat组，而所有者拥有读/写特权。 ，群组只有人阅读，而世界没有任何权限。例外是Tomcat用户而不是root用户拥有的日志，临时目录和工作目录。这意味着即使攻击者破坏了Tomcat进程，他们也无法更改Tomcat配置，部署新的Web应用程序或修改现有的Web应用程序。Tomcat进程以umask 007运行以维护这些权限。</p>
    <p>在网络级别，请考虑使用防火墙将传入和传出连接都限制为仅预期存在的那些连接。</p>

    <div class="subsection"><h4 id="JMX">JMX</h4><div class="text">
      <p>JMX连接的安全性取决于JRE提供的实现，因此不在Tomcat的控制范围内。</p>

      <p>通常，访问控制非常有限（对所有内容只读或对所有内容读写）。Tomcat通过JMX公开了大量内部信息和控制，以帮助调试，监视和管理。考虑到可用的访问控制有限，应将JMX访问等同于本地root / admin访问，并进行相应的限制。</p>

      <p>大多数（全部？）提供的JMX访问控制JRE供应商不会记录失败的身份验证尝试，也不会在重复失败的身份验证后提供帐户锁定功能。这使得暴力攻击易于安装且难以检测。</p>

      <p>鉴于上述所有情况，应注意确保适当保护JMX接口（如果使用）。您可能希望考虑保护JMX接口安全的选项包括：</p>

      <ul>
        <li>为所有JMX用户配置一个强密码；</li>
        <li>仅将JMX侦听器绑定到内部网络；</li>
        <li>将对JMX端口的网络访问限制为受信任的客户端；和</li>
        <li>提供特定于应用程序的运行状况页面，以供外部监视系统使用。</li>
      </ul>
    </div></div>

  </div><h3 id="Default_web_applications">默认Web应用程序</h3><div class="text">

    <div class="subsection"><h4 id="Default_web_applications/General">一般</h4><div class="text">
      <p>Tomcat附带了许多默认启用的Web应用程序。过去已经在这些应用程序中发现了漏洞。应该删除不需要的应用程序，这样如果发现另一个漏洞，系统就不会受到威胁。</p>
    </div></div>

    <div class="subsection"><h4 id="ROOT">根</h4><div class="text">
      <p>ROOT Web应用程序的安全风险非常低，但确实包含正在使用的Tomcat版本。通常，出于安全原因，应从可公开访问的Tomcat实例中删除ROOT Web应用程序，以便向用户显示更合适的默认页面。</p>
    </div></div>

    <div class="subsection"><h4 id="Documentation">文献资料</h4><div class="text">
      <p>该文档Web应用程序的安全风险非常低，但是它确实标识了正在使用的Tomcat版本。通常应从可公开访问的Tomcat实例中将其删除。</p>
    </div></div>

    <div class="subsection"><h4 id="Examples">例子</h4><div class="text">
      <p>示例Web应用程序应始终从任何对安全敏感的安装中删除。尽管示例Web应用程序不包含任何已知漏洞，但已知包含一些功能（尤其是Cookie示例，这些示例显示所有接收到的内容并允许设置新Cookie），攻击者可能会结合使用这些功能在部署在Tomcat实例上的另一个应用程序中获取其他信息，否则这些信息将不可用。</p>
    </div></div>

    <div class="subsection"><h4 id="Default_web_applications/Manager">经理</h4><div class="text">
      <p>Manager应用程序允许远程部署Web应用程序，并且由于启用了Manager应用程序的弱密码和可公开访问的Tomcat实例的广泛使用，攻击者经常将其作为攻击目标。默认情况下，无法访问Manager应用程序，因为没有为用户配置必要的访问权限。如果启用了Manager应用<strong>程序，</strong>则应遵循“ <strong>保护管理应用程序”</strong>部分中的指导。</p>
    </div></div>

    <div class="subsection"><h4 id="Host_Manager">房东经理</h4><div class="text">
      <p>Host Manager应用程序允许创建和管理虚拟主机-包括为虚拟主机启用Manager应用程序。默认情况下，主机管理器应用程序不可访问，因为没有为用户配置必要的访问权限。如果启用了主机管理器应用<strong>程序，</strong>则应遵循“ <strong>保护管理应用程序”</strong>部分中的指导。</p>
    </div></div>

   <div class="subsection"><h4 id="Securing_Management_Applications">保护管理应用程序</h4><div class="text">
     <p>部署提供Tomcat实例管理功能的Web应用程序时，应遵循以下准则：</p>
     <ul>
       <li>确保允许访问管理应用程序的所有用户都使用强密码。</li>
       <li>不要删除<a href="config/realm.html#LockOut_Realm_-_org.apache.catalina.realm.LockOutRealm">LockOutRealm</a>的使用，它可以防止对用户密码的暴力攻击。</li>
       <li>在<a href="config/context.html">context.xml</a>文件中为管理应用程序配置<a href="config/valve.html#Remote_Address_Valve">RemoteAddrValve</a> ，该应用程序默认限制对本地主机的访问。如果需要远程访问，请使用此阀将其限制为特定的IP地址。</li>
     </ul>
   </div></div>
  </div><h3 id="Security_manager">安全经理</h3><div class="text">
    <p>启用安全管理器会使Web应用程序在沙箱中运行，从而严重限制了Web应用程序执行恶意操作的能力，例如调用System.exit（），建立网络连接或访问Web应用程序的根目录和临时目录之外的文件系统。但是，应该注意，存在一些恶意行为，例如通过无限循环触发高CPU消耗，安全管理器无法阻止。</p>

    <p>如果攻击者找到了一种方法来破坏可信任的Web应用程序，通常可以启用安全管理器以限制潜在的影响。安全管理器也可以用来降低运行不受信任的Web应用程序的风险（例如，在托管环境中），但应注意的是，安全管理器仅降低运行不受信任的Web应用程序的风险，而不能消除它们。如果运行多个不受信任的Web应用程序，建议将每个Web应用程序部署到单独的Tomcat实例（最好是单独的主机），以降低恶意Web应用程序影响其他应用程序可用性的能力。</p>

    <p>Tomcat在启用安全管理器的情况下进行了测试；但是大多数Tomcat用户未使用安全管理器运行，因此在此配置中，Tomcat的用户测试效果不佳。报告了并且继续存在由在安全管理器下运行触发的错误。</p>

    <p>如果启用了安全管理器，则由安全管理器施加的限制可能会破坏大多数应用程序。未经广泛测试，不得使用安全管理器。理想情况下，应在开发周期开始时引入安全管理器的使用，因为跟踪和修复由于启用安全管理器用于成熟应用程序而导致的问题可能很耗时。</p>

    <p>启用安全管理器会更改以下设置的默认值：</p>
    <ul>
      <li><strong>Host</strong>元素的<strong>deployXML</strong>属性的默认值更改为<code>false</code> 。</li>
    </ul>
  </div><h3 id="server.xml">server.xml</h3><div class="text">
    <div class="subsection"><h4 id="server.xml/General">一般</h4><div class="text">
      <p>缺省的server.xml包含大量注释，包括一些注释掉的示例组件定义。删除这些注释使阅读和理解server.xml非常容易。</p>
      <p>如果未列出组件类型，则没有该类型的设置会直接影响安全性。</p>
    </div></div>

    <div class="subsection"><h4 id="Server">服务器</h4><div class="text">
      <p>将<strong>端口</strong>属性设置为<code>-1</code>禁用关闭端口。</p>
      <p>如果未禁用shutdown端口，则应为<strong>shutdown</strong>配置一个强密码。</p>
    </div></div>

    <div class="subsection"><h4 id="Listeners">听众</h4><div class="text">
      <p>如果使用gcc在Solaris上编译，则APR Lifecycle Listener不稳定。如果在Solaris上使用APR / native连接器，请使用Sun Studio编译器对其进行编译。</p>
      <p>JNI库加载侦听器可用于加载本机代码。它仅应用于加载受信任的库。</p>
      <p>应启用并适当配置安全生命周期侦听器。
      </p>
    </div></div>

    <div class="subsection"><h4 id="Connectors">连接器</h4><div class="text">
      <p>默认情况下，配置了HTTP和AJP连接器。应从server.xml中删除将不使用的连接器。</p>

      <p><strong>地址</strong>属性可用于控制连接器侦听连接的IP地址。默认情况下，连接器侦听所有已配置的IP地址。</p>

      <p><strong>allowTrace</strong>属性可用于启用TRACE请求，这对于调试很有用。由于某些浏览器处理TRACE请求的响应的方式（使浏览器暴露于XSS攻击），因此默认情况下禁用对TRACE请求的支持。</p>

      <p><strong>maxPostSize</strong>属性控制将为参数解析的POST请求的最大大小。在请求期间将缓存参数，因此默认情况下此参数限制为2MB，以减少遭受DOS攻击的风险。</p>

      <p><strong>maxSavePostSize</strong>属性控制FORM和CLIENT-CERT身份验证期间的POST请求保存。在身份验证期间（可能要花几分钟），将缓存参数，因此默认情况下，此参数限制为4KB，以减少遭受DOS攻击的风险。</p>

      <p><strong>maxParameterCount</strong>属性控制可解析和存储在请求中的参数和值对（GET加POST）的最大数量。过多的参数将被忽略。如果要拒绝此类请求，请配置<a href="config/filter.html">FailedRequestFilter</a> 。</p>

      <p><strong>xpoweredBy</strong>属性控制是否随每个请求一起发送X-Powered-By HTTP标头。如果发送，则标头的值包含Servlet和JSP规范版本，完整的Tomcat版本（例如Apache Tomcat / 9.0），JVM供应商的名称和JVM的版本。默认情况下，此头是禁用的。该标头可以为合法客户端和攻击者提供有用的信息。
      </p>

      <p><strong>服务器</strong>属性控制服务器HTTP标头的值。Tomcat 4.1.x至9.0.x的此标头的默认值为Apache-Coyote / 1.1。此标头可以为合法客户端和攻击者提供有限的信息。</p>

      <p><strong>SSLEnabled</strong> ， <strong>scheme</strong>和<strong>secure</strong>属性都可以独立设置。当Tomcat位于反向代理后面并且代理通过HTTP或HTTPS连接到Tomcat时，通常使用这些命令。它们允许Tomcat查看客户端与代理（而不是代理与Tomcat）之间的连接的SSL属性。例如，客户端可以通过HTTPS连接到代理，但是代理使用HTTP连接到Tomcat。如果Tomcat必须能够区分代理收到的安全连接和非安全连接，则代理必须使用单独的连接器将安全请求和非安全请求传递给Tomcat。如果代理使用AJP，则客户端连接的SSL属性通过AJP协议传递，并且不需要单独的连接器。</p>

      <p><strong>Atom</strong>连接器将<strong>tomcatAuthentication</strong>和<strong>tomcatAuthorization</strong>属性与AJP连接器一起使用，以确定Tomcat是否应处理所有身份验证和授权，或者应将身份验证委派给反向代理（将经过身份验证的用户名作为AJP协议的一部分传递给Tomcat），并带有选项使Tomcat仍然执行授权。</p>

      <p>AJP连接器中的<strong>requiredSecret</strong>属性可配置Tomcat与Tomcat前面的反向代理之间的共享机密。它用于防止通过AJP协议进行未经授权的连接。</p>
    </div></div>

    <div class="subsection"><h4 id="Host">主办</h4><div class="text">
      <p>主机元素控制部署。自动部署不仅可以简化管理，还可以使攻击者更轻松地部署恶意应用程序。自动部署由<strong>autoDeploy</strong>和<strong>deployOnStartup</strong>属性控制。如果两者都是<code>false</code> ，仅将部署server.xml中定义的上下文，任何更改都需要重新启动Tomcat。
      </p>

      <p>在可能不信任Web应用程序的托管环境中，将<strong>deployXML</strong>属性设置为<code>false</code>忽略与Web应用程序打包在一起的任何context.xml，这可能会尝试向Web应用程序分配增加的特权。请注意，如果启用了安全管理器，那么<strong>deployXML</strong>属性将默认为<code>false</code> 。</p>
    </div></div>

    <div class="subsection"><h4 id="Context">语境</h4><div class="text">
      <p>这适用于所有可以定义<a href="config/context.html">上下文</a>元素的地方： <code>server.xml</code>文件，默认<code>context.xml</code>文件，每主机<code>context.xml.default</code>主机配置目录中或Web应用程序内部的文件，Web应用程序上下文文件。</p>

      <p><strong>crossContext</strong>属性控制是否允许一个上下文访问另一个上下文的资源。它是<code>false</code>默认情况下，仅应针对受信任的Web应用程序进行更改。</p>

      <p><strong>特权</strong>属性控制是否允许上下文使用容器提供的servlet（例如Manager servlet）。它是<code>false</code>默认情况下，仅应针对受信任的Web应用程序进行更改。</p>

      <p>嵌套<a href="config/resources.html">Resources</a>元素的<strong>allowLinking</strong>属性控制是否允许上下文使用链接的文件。如果启用并且取消部署上下文，则在删除上下文资源时将遵循链接。从默认设置更改此设置<code>false</code>在不区分大小写的操作系统（包括Windows）上，它将禁用许多安全措施，并且除其他外，还可以直接访问WEB-INF目录。</p>

      <p><strong>sessionCookiePathUsesTrailingSlash</strong>可用于解决许多浏览器（Internet Explorer，Safari和Edge）中的错误，以防止当应用程序共享公共路径前缀时，跨应用程序公开会话cookie。但是，启用此选项可能会对映射到Servlet的应用程序产生问题。 <code>/*</code> 。还应注意，RFC6265第8.5节明确指出，不应将不同的路径视为足以将cookie与其他应用程序隔离开来。</p>
    </div></div>

    <div class="subsection"><h4 id="Valves">阀门</h4><div class="text">
      <p>强烈建议配置AccessLogValve。Tomcat的默认配置包括AccessLogValve。这些通常按主机配置，但也可以根据需要按引擎或上下文进行配置。</p>

      <p>任何管理应用程序都应由RemoteAddrValve保护（此Valve也可以作为过滤器使用）。<strong>allow</strong>属性应用于限制对一组已知可信主机的访问。</p>

      <p>默认的ErrorReportValve在发送给客户端的响应中包括Tomcat版本号。为了避免这种情况，可以在每个Web应用程序中配置自定义错误处理。或者，您可以显式配置<a href="config/valve.html">ErrorReportValve</a>并将其<strong>showServerInfo</strong>属性设置为<code>false</code> 。或者，可以通过创建内容如下的文件CATALINA_BASE / lib / org / apache / catalina / util / ServerInfo.properties来更改版本号：</p>
      <div class="codeBox"><pre><code>server.info=Apache Tomcat/9.0.x</code></pre></div>
      <p>根据需要修改值。请注意，这还将更改某些管理工具中报告的版本号，并可能使确定安装的实际版本更加困难。CATALINA_HOME / bin / version.bat | sh脚本仍将报告正确的版本号。</p>

      <p>发生错误时，默认的ErrorReportValve可以向客户端显示堆栈跟踪和/或JSP源代码。为了避免这种情况，可以在每个Web应用程序中配置自定义错误处理。或者，您可以显式配置<a href="config/valve.html">ErrorReportValve</a>并将其<strong>showReport</strong>属性设置为<code>false</code> 。</p>

      <p>RewriteValve使用正则表达式，格式不正确的正则表达式模式可能容易遭受“灾难性回溯”或“ ReDoS”的攻击。有关更多详细信息，请参见<a href="rewrite.html">重写文档</a> 。</p>
    </div></div>

    <div class="subsection"><h4 id="Realms">境界</h4><div class="text">
      <p>MemoryRealm不适用于生产用途，因为tomcat-users.xml的任何更改都需要重新启动Tomcat才能生效。</p>

      <p>不建议将JDBCRealm用于生产环境，因为它是用于所有身份验证和授权选项的单线程。请改用DataSourceRealm。</p>

      <p>UserDatabaseRealm不适用于大规模安装。它旨在用于小型，相对静态的环境。</p>

      <p>JAASRealm没有得到广泛使用，因此代码不如其他领域成熟。建议在使用此领域之前进行其他测试。</p>

      <p>默认情况下，领域不实施任何形式的帐户锁定。这意味着蛮力攻击可以成功。为了防止暴力攻击，应将选定的领域包装在LockOutRealm中。</p>
    </div></div>

    <div class="subsection"><h4 id="server.xml/Manager">经理</h4><div class="text">
      <p>管理器组件用于生成会话ID。</p>

      <p>可以使用<strong>randomClass</strong>属性更改用于生成随机会话ID的类。</p>

      <p>会话ID的长度可以使用<strong>sessionIdLength</strong>属性更改。</p>
    </div></div>

    <div class="subsection"><h4 id="Cluster">簇</h4><div class="text">
      <p>在将安全，受信任的网络用于所有与群集相关的网络流量的基础上编写群集实现。在不安全，不受信任的网络上运行群集是不安全的。</p>

      <p>如果您在不受信任的网络上运行，或者希望采取过多的谨慎措施，则可以使用<a href="config/cluster-interceptor.html#org.apache.catalina.tribes.group.interceptors.EncryptInterceptor_Attributes">EncryptInterceptor</a>对节点之间的流量进行加密。</p>
    </div></div>
  </div><h3 id="System_Properties">系统属性</h3><div class="text">
    <p>设置<strong>org.apache.catalina.connector。RECYCLE_FACADES</strong>系统属性<code>true</code>将导致为每个请求创建一个新的外观对象。这减少了应用程序中的错误将数据从一个请求暴露到另一个请求的机会。</p>

    <p><strong>org.apache.catalina.connector。土狼适配器。ALLOW_BACKSLASH</strong>和<strong>org.apache.tomcat.util.buf。UDecoder。ALLOW_ENCODED_SLASH</strong>系统属性允许对请求URI进行非标准解析。在反向代理后面使用这些选项可以使攻击者绕过该代理实施的任何安全约束。</p>

    <p><strong>org.apache.catalina.connector。响应。如果禁用ENFORCE_ENCODING_IN_GET_WRITER</strong>系统属性，则具有安全隐患。当应使用规范规定的默认ISO-8859-1时，许多违反RFC2616的用户代理尝试猜测文本媒体类型的字符编码。某些浏览器会将包含对于ISO-8859-1安全的字符的响应解释为UTF-7，但如果将其解释为UTF-7，则会触发XSS漏洞。</p>
  </div><h3 id="web.xml">web.xml</h3><div class="text">
    <p>这适用于默认<code>conf/web.xml</code>文件， <code>/WEB-INF/tomcat-web.xml</code>和<code>/WEB-INF/web.xml</code> Web应用程序中的文件（如果它们定义此处提到的组件）。</p>

    <p><a href="default-servlet.html">DefaultServlet</a>配置为<strong>readonly</strong>设置为<code>true</code> 。更改为<code>false</code>允许客户端删除或修改服务器上的静态资源并上传新资源。通常，在不需要身份验证的情况下不应更改此设置。</p>

    <p>DefaultServlet配置为<strong>清单</strong>设置为<code>false</code> 。这不是因为允许目录列表被认为是不安全的，而是因为生成包含数千个文件的目录列表会消耗大量CPU，从而导致DOS攻击。
    </p>

    <p>将DefaultServlet配置为<strong>showServerInfo</strong>设置为<code>true</code> 。启用目录列表后，发送给客户端的响应中将包含Tomcat版本号。为避免这种情况，可以显式配置DefaultServlet并将其<strong>showServerInfo</strong>属性设置为false。或者，可以通过创建内容如下的文件CATALINA_BASE / lib / org / apache / catalina / util / ServerInfo.properties来更改版本号：</p>
    <div class="codeBox"><pre><code>server.info=Apache Tomcat/9.0.x</code></pre></div>
    <p>根据需要修改值。请注意，这还将更改某些管理工具中报告的版本号，并可能使确定安装的实际版本更加困难。CATALINA_HOME / bin / version.bat | sh脚本仍将报告正确的版本号。
    </p>

    <p>默认情况下，CGI Servlet是禁用的。如果启用，则不应将调试初始化参数设置为<code>10</code>或更高版本，因为调试页面不安全。</p>

    <p>在Windows上将CGI Servlet与<code>enableCmdLineArguments</code>已启用，请查看<code>cmdLineArgumentsDecoded</code>仔细并确保它适合您的环境。默认值为安全。不安全的配置可能会使服务器暴露于远程代码执行中。通过<a href="cgi-howto.html">CGI How To中</a>的链接可以找到有关潜在风险和缓解措施的更多信息。</p>

    <p>可以配置<a href="config/filter.html">FailedRequestFilter</a>并将其用于拒绝在请求参数解析期间出错的请求。如果没有过滤器，则默认行为是忽略无效或过多的参数。</p>

    <p><a href="config/filter.html">HttpHeaderSecurityFilter</a>可用于向响应添加标头以提高安全性。如果客户端直接访问Tomcat，则除非您的应用程序已经设置了过滤器，否则您可能希望启用此过滤器及其设置的所有标头。如果通过反向代理访问Tomcat，则此过滤器的配置需要与反向代理设置的所有标头协调。</p>
  </div><h3 id="General">一般</h3><div class="text">
    <p>BASIC和FORM身份验证以明文形式传递用户名和密码。将这些身份验证机制与通过不可信网络连接的客户端一起使用的Web应用程序应使用SSL。</p>

    <p>与经过身份验证的用户进行会话的会话cookie与攻击者使用的用户密码几乎一样有用，并且在几乎所有情况下，都应提供与密码本身相同级别的保护。这通常意味着通过SSL进行身份验证，并继续使用SSL，直到会话结束。</p>
  </div><div class="noprint"><h3 id="comments_section">评论</h3><div class="text"><p class="notice"><strong>注意：</strong>此注释部分收集有关改进Apache Tomcat文档的建议。<br><br>如果您遇到问题并需要帮助，请阅读“ <a href="https://tomcat.apache.org/findhelp.html">查找帮助”</a>页面，然后在tomcat-users <a href="https://tomcat.apache.org/lists.html">邮件列表中</a>询问您的问题。不要在这里问这样的问题。这不是“问答”部分。<br><br><a href="./comments.html">这里</a>解释<a href="./comments.html">了</a> Apache Comments System。如果评论已被实施或被认为无效/偏离主题，则我们的主持人可能会将其删除。
                  </p><div id="comments_thread"></div></div></div></div></div></div></div><footer><div id="footer">版权所有©1999-2019，Apache软件基金会</div></footer></div></body></html>