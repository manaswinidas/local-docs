<html lang="zh-Hans" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="./images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>Apache Tomcat 9（9.0.21）-Tomcat设置</title><meta name="author" content="Remy Maucherat"><script type="application/javascript" data-comments-identifier="tomcat-9.0-doc/setup">
    "use strict"; // Enable strict mode

    (function() {
      var thisScript = document.currentScript;
      if (!thisScript) { // Workaround for IE <= 11
        var scripts = document.getElementsByTagName("script");
        thisScript = scripts[scripts.length - 1];
      }
      document.addEventListener("DOMContentLoaded", (function() {
        var commentsDiv = document.getElementById("comments_thread");
        var commentsShortname = "tomcat";
        var commentsIdentifier = "https://tomcat.apache.org/" +
          thisScript.getAttribute("data-comments-identifier") + ".html";

        (function(w, d) {
          if (w.location.hostname.toLowerCase() == "tomcat.apache.org") {
            var s = d.createElement("script");
            s.type = "application/javascript";
            s.async = true;
            s.src = "https://comments.apache.org/show_comments.lua?site=" +
              encodeURIComponent(commentsShortname) +
              "&page=" + encodeURIComponent(commentsIdentifier);
            d.head.appendChild(s);
          } else {
            commentsDiv.appendChild(d.createTextNode("Comments are disabled for this page at the moment."));
          }
        })(window, document);
      }), false);
    })();
  </script></head><body ><div id="wrapper"><header><div id="header"><div><div><div class="logo noPrint"><a href="https://tomcat.apache.org/"><img alt="Tomcat主页" src="./images/tomcat.png"></a></div><div style="height:1px"></div><div class="asfLogo noPrint"><a href="https://www.apache.org/" target="_blank"><img src="./images/asf-logo.svg" alt="Apache软件基金会" style="width:266px;height:83px"></a></div><h1>Apache Tomcat 9</h1><div class="versionInfo">版本9.0.21， <time datetime="2019-06-04"> 2019年6月4日</time></div><div style="height:1px"></div><div style="clear:left"></div></div></div></div></header><div id="middle"><div><div id="mainLeft" class="noprint"><div><nav><div><h2>链接</h2><ul><li><a href="index.html">文件首页</a></li><li><a href="https://wiki.apache.org/tomcat/FAQ">常问问题</a></li><li><a href="#comments_section">用户评论</a></li></ul></div><div><h2>用户指南</h2><ul><li><a href="introduction.html">1）简介</a></li><li><a href="setup.html">2）设定</a></li><li><a href="appdev/index.html">3）第一个webapp</a></li><li><a href="deployer-howto.html">4）部署者</a></li><li><a href="manager-howto.html">5）经理</a></li><li><a href="host-manager-howto.html">6）主机管理员</a></li><li><a href="realm-howto.html">7）领域和AAA</a></li><li><a href="security-manager-howto.html">8）安全经理</a></li><li><a href="jndi-resources-howto.html">9）JNDI资源</a></li><li><a href="jndi-datasource-examples-howto.html">10）JDBC数据源</a></li><li><a href="class-loader-howto.html">11）类加载</a></li><li><a href="jasper-howto.html">12）JSP</a></li><li><a href="ssl-howto.html">13）SSL / TLS</a></li><li><a href="ssi-howto.html">14）SSI</a></li><li><a href="cgi-howto.html">15）CGI</a></li><li><a href="proxy-howto.html">16）代理支持</a></li><li><a href="mbeans-descriptors-howto.html">17）MBean描述符</a></li><li><a href="default-servlet.html">18）默认Servlet</a></li><li><a href="cluster-howto.html">19）聚类</a></li><li><a href="balancer-howto.html">20）负载均衡器</a></li><li><a href="connectors.html">21）连接器</a></li><li><a href="monitoring.html">22）监控与管理</a></li><li><a href="logging.html">23）记录</a></li><li><a href="apr.html">24）APR /本地</a></li><li><a href="virtual-hosting-howto.html">25）虚拟主机</a></li><li><a href="aio.html">26）高级IO</a></li><li><a href="extras.html">27）附加组件</a></li><li><a href="maven-jars.html">28）行刑</a></li><li><a href="security-howto.html">29）安全注意事项</a></li><li><a href="windows-service-howto.html">30）Windows服务</a></li><li><a href="windows-auth-howto.html">31）Windows身份验证</a></li><li><a href="jdbc-pool.html">32）Tomcat的JDBC池</a></li><li><a href="web-socket-howto.html">33）WebSocket</a></li><li><a href="rewrite.html">34）改写</a></li></ul></div><div><h2>参考</h2><ul><li><a href="RELEASE-NOTES.txt">发行说明</a></li><li><a href="config/index.html">组态</a></li><li><a href="api/index.html">Tomcat Java文档</a></li><li><a href="servletapi/index.html">Servlet Java文档</a></li><li><a href="jspapi/index.html">JSP 2.3 Java文档</a></li><li><a href="elapi/index.html">EL 3.0 Java文档</a></li><li><a href="websocketapi/index.html">WebSocket 1.1 Java文档</a></li><li><a href="https://tomcat.apache.org/connectors-doc/">JK 1.2文档</a></li></ul></div><div><h2>Apache Tomcat开发</h2><ul><li><a href="building.html">建造</a></li><li><a href="changelog.html">变更日志</a></li><li><a href="https://wiki.apache.org/tomcat/TomcatVersions">状态</a></li><li><a href="developers.html">开发者</a></li><li><a href="architecture/index.html">建筑</a></li><li><a href="funcspecs/index.html">功能规格。</a></li><li><a href="tribes/introduction.html">部族</a></li></ul></div></nav></div></div><div id="mainRight"><div id="content"><h2>Tomcat设置</h2><h3 id="Table_of_Contents">目录</h3><div class="text">
<ul><li><a href="#Introduction">介绍</a></li><li><a href="#Windows">视窗</a></li><li><a href="#Unix_daemon">Unix守护程序</a></li></ul>
</div><h3 id="Introduction">介绍</h3><div class="text">
    <p>有几种方法可以将Tomcat设置为在不同平台上运行。主要文档是一个名为<a href="RUNNING.txt">RUNNING.txt</a>的文件。如果下面的信息不能回答您的某些问题，我们建议您参考该文件。
    </p>
  </div><h3 id="Windows">视窗</h3><div class="text">

    <p>使用Windows安装程序可以轻松地在Windows上安装Tomcat。它的界面和功能与其他基于向导的安装程序相似，仅涉及少数几项。</p>


      <ul>
        <li><strong>作为服务安装</strong> ：无论选择什么设置，Tomcat都将作为Windows服务安装。使用组件页面上的复选框将服务设置为“自动”启动，以便在Windows启动时自动启动Tomcat。为了获得最佳安全性，应该以减少权限的单独用户身份运行服务（请参阅Windows Services管理工具及其文档）。</li>
        <li><strong>Java位置</strong> ：安装程序将提供默认的JRE来运行服务。安装程序使用注册表确定Java 8或更高版本JRE的基本路径，包括作为完整JDK的一部分安装的JRE。在64位操作系统上运行时，安装程序将首先查找64位JRE，如果未找到64位JRE，则仅查找32位JRE。并非必须使用安装程序检测到的默认JRE。可以使用任何已安装的Java 8或更高版本的JRE（32位或64位）。</li>
        <li><strong>任务栏图标</strong> ：当Tomcat作为服务运行时，当Tomcat运行时将不存在任何任务栏图标。请注意，当选择在安装结束时运行Tomcat时，即使将Tomcat作为服务安装，也将使用任务栏图标。</li>
        <li><strong>默认值</strong> ：安装程序使用的默认值可以通过使用<code>/C=<config file></code>命令行参数。配置文件使用以下格式<code>name=value</code>每对都放在单独的行上。可用配置选项的名称为：<ul>
            <li>Java主页</li>
            <li>Tomcat端口关闭</li>
            <li>TomcatPortHttp</li>
            <li>TomcatPortAjp</li>
            <li>TomcatMenuEntriesEnable</li>
            <li>Tomcat快捷方式所有用户</li>
            <li>TomcatServiceDefaultName</li>
            <li>Tomcat服务名</li>
            <li>TomcatServiceFileName</li>
            <li>TomcatServiceManagerFileName</li>
            <li>Tomcat管理启用</li>
            <li>TomcatAdmin用户名</li>
            <li>Tomcat管理员密码</li>
            <li>Tomcat管理员角色</li>
            </ul>通过使用<code>/C=...</code>随着<code>/S</code>和<code>/D=</code>可以执行完全配置的Apache Tomcat无人值守安装。
        </li>
        <li>请参阅<a href="windows-service-howto.html">Windows服务操作方法</a> ，了解如何管理Tomcat作为Windows服务信息。
            </li>
      </ul>


    <p>安装程序将创建允许启动和配置Tomcat的快捷方式。重要的是要注意，Tomcat管理Web应用程序只能在Tomcat运行时使用。</p>

  </div><h3 id="Unix_daemon">Unix守护程序</h3><div class="text">

    <p>可以使用commons-daemon项目中的jsvc工具将Tomcat作为守护程序运行。Tomcat二进制文件中包含jsvc的源tarball，并且需要对其进行编译。构建jsvc需要使用C ANSI编译器（例如GCC），GNU Autoconf和JDK。</p>

    <p>在运行脚本之前， <code>JAVA_HOME</code>环境变量应设置为JDK的基本路径。或者，当调用<code>./configure</code>脚本，可以使用以下命令指定JDK的路径<code>--with-java</code>参数，例如<code>./configure --with-java=/usr/java</code> 。</p>

    <p>使用以下命令应产生一个已编译的jsvc二进制文件，该文件位于<code>$CATALINA_HOME/bin</code>夹。假设使用了GNU TAR，并且<code>CATALINA_HOME</code>是指向Tomcat安装基本路径的环境变量。</p>

    <p>请注意，您应该在FreeBSD系统上使用GNU make（gmake）而不是本机BSD make。</p>

<div class="codeBox"><pre><code>cd $CATALINA_HOME/bin
tar xvfz commons-daemon-native.tar.gz
cd commons-daemon-1.1.x-native-src/unix
./configure
make
cp jsvc ../..
cd ../..</code></pre></div>

    <p>然后，可以使用以下命令将Tomcat作为守护程序运行。</p>

<div class="codeBox"><pre><code>CATALINA_BASE=$CATALINA_HOME
cd $CATALINA_HOME
./bin/jsvc \
    -classpath $CATALINA_HOME/bin/bootstrap.jar:$CATALINA_HOME/bin/tomcat-juli.jar \
    -outfile $CATALINA_BASE/logs/catalina.out \
    -errfile $CATALINA_BASE/logs/catalina.err \
    -Dcatalina.home=$CATALINA_HOME \
    -Dcatalina.base=$CATALINA_BASE \
    -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager \
    -Djava.util.logging.config.file=$CATALINA_BASE/conf/logging.properties \
    org.apache.catalina.startup.Bootstrap</code></pre></div>

    <p>在Java 9上运行时，在启动jsvc时需要另外指定以下内容，以避免在关闭时发出警告。</p>
<div class="codeBox"><pre><code>...
--add-opens=java.base/java.lang=ALL-UNNAMED \
--add-opens=java.base/java.io=ALL-UNNAMED \
--add-opens=java.rmi/sun.rmi.transport=ALL-UNNAMED \
...
</code></pre></div>

    <p>您可能还需要指定<code>-jvm server</code>如果JVM默认使用服务器VM而不是客户端VM。这已在OSX上观察到。</p>

    <p>jsvc还有其他有用的参数，例如<code>-user</code>导致守护程序初始化完成后，它切换到另一个用户。例如，这允许以非特权用户身份运行Tomcat，同时仍然可以使用特权端口。请注意，如果您使用此选项并以root身份启动Tomcat，则需要禁用<code>org.apache.catalina.security.SecurityListener</code>检查是否防止以root身份运行时Tomcat启动。</p>

    <p><code>jsvc --help</code>将返回完整的jsvc使用信息。特别是<code>-debug</code>该选项对于调试运行jsvc的问题很有用。</p>

    <p>文件<code>$CATALINA_HOME/bin/daemon.sh</code>可用作在启动时从以下位置自动启动Tomcat的模板<code>/etc/init.d</code>与jsvc。</p>

    <p>请注意，Commons-Daemon JAR文件必须在您的运行时类路径上，才能以这种方式运行Tomcat。Commons-Daemon JAR文件位于bootstrap.jar清单的Class-Path条目中，但是如果您收到Commons-Daemon类的ClassNotFoundException或NoClassDefFoundError，则在启动jsvc时将Commons-Daemon JAR添加到-cp参数中。</p>

  </div><div class="noprint"><h3 id="comments_section">评论</h3><div class="text"><p class="notice"><strong>注意：</strong>此注释部分收集有关改进Apache Tomcat文档的建议。<br><br>如果您遇到问题并需要帮助，请阅读“ <a href="https://tomcat.apache.org/findhelp.html">查找帮助”</a>页面，然后在tomcat-users <a href="https://tomcat.apache.org/lists.html">邮件列表中</a>询问您的问题。不要在这里问这样的问题。这不是“问答”部分。<br><br><a href="./comments.html">这里</a>解释<a href="./comments.html">了</a> Apache Comments System。如果评论已被实施或被认为无效/偏离主题，则我们的主持人可能会将其删除。
                  </p><div id="comments_thread"></div></div></div></div></div></div></div><footer><div id="footer">版权所有©1999-2019，Apache软件基金会</div></footer></div></body></html>