<html lang="zh-Hans" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="../images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>Catalina功能规格（9.0.21）-MemoryRealm</title><meta name="author" content="Craig McClanahan"><script type="application/javascript" data-comments-identifier="tomcat-9.0-doc/funcspecs/fs-memory-realm">
    "use strict"; // Enable strict mode

    (function() {
      var thisScript = document.currentScript;
      if (!thisScript) { // Workaround for IE <= 11
        var scripts = document.getElementsByTagName("script");
        thisScript = scripts[scripts.length - 1];
      }
      document.addEventListener("DOMContentLoaded", (function() {
        var commentsDiv = document.getElementById("comments_thread");
        var commentsShortname = "tomcat";
        var commentsIdentifier = "https://tomcat.apache.org/" +
          thisScript.getAttribute("data-comments-identifier") + ".html";

        (function(w, d) {
          if (w.location.hostname.toLowerCase() == "tomcat.apache.org") {
            var s = d.createElement("script");
            s.type = "application/javascript";
            s.async = true;
            s.src = "https://comments.apache.org/show_comments.lua?site=" +
              encodeURIComponent(commentsShortname) +
              "&page=" + encodeURIComponent(commentsIdentifier);
            d.head.appendChild(s);
          } else {
            commentsDiv.appendChild(d.createTextNode("Comments are disabled for this page at the moment."));
          }
        })(window, document);
      }), false);
    })();
  </script></head><body ><div id="wrapper"><header><div id="header"><div><div><div class="logo noPrint"><a href="https://tomcat.apache.org/"><img alt="Tomcat主页" src="../images/tomcat.png"></a></div><div style="height:1px"></div><div class="asfLogo noPrint"><a href="https://www.apache.org/" target="_blank"><img src="../images/asf-logo.svg" alt="Apache软件基金会" style="width:266px;height:83px"></a></div><h1>卡塔利娜功能规格</h1><div class="versionInfo">版本9.0.21， <time datetime="2019-06-04"> 2019年6月4日</time></div><div style="height:1px"></div><div style="clear:left"></div></div></div></div></header><div id="middle"><div><div id="mainLeft" class="noprint"><div><nav><div><h2>链接</h2><ul><li><a href="../index.html">文件首页</a></li><li><a href="index.html">功能规格</a></li><li><a href="https://wiki.apache.org/tomcat/FAQ">常问问题</a></li><li><a href="#comments_section">用户评论</a></li></ul></div><div><h2>行政应用</h2><ul><li><a href="fs-admin-apps.html">总体要求</a></li><li><a href="mbean-names.html">Tomcat MBean名称</a></li><li><a href="fs-admin-objects.html">管理对象</a></li><li><a href="fs-admin-opers.html">支持的运营</a></li></ul></div><div><h2>内部Servlet</h2><ul><li><a href="fs-default.html">默认Servlet</a></li></ul></div><div><h2>领域实现</h2><ul><li><a href="fs-jdbc-realm.html">JDBC领域</a></li><li><a href="fs-jndi-realm.html">JNDI领域</a></li><li><a href="fs-memory-realm.html">内存领域</a></li></ul></div></nav></div></div><div id="mainRight"><div id="content"><h2>内存领域</h2><h3 id="Table_of_Contents">目录</h3><div class="text">
<ul><li><a href="#Overview">总览</a><ol><li><a href="#Introduction">介绍</a></li><li><a href="#External_Specifications">外部规格</a></li><li><a href="#Implementation_Requirements">实施要求</a></li></ol></li><li><a href="#Dependencies">依存关系</a><ol><li><a href="#Environmental_Dependencies">环境依赖性</a></li><li><a href="#Container_Dependencies">容器依赖</a></li></ol></li><li><a href="#Functionality">功能性</a><ol><li><a href="#Overview_of_Operation">操作概述</a></li><li><a href="#Detailed_Functional_Requirements">详细功能要求</a></li></ol></li><li><a href="#Testable_Assertions">可测断言</a></li></ul>
</div><h3 id="Overview">总览</h3><div class="text">


  <div class="subsection"><h4 id="Introduction">介绍</h4><div class="text">

    <p><strong>MemoryRealm</strong>实现的目的是提供一种机制，Tomcat可以通过该机制从简单的XML格式的基于文本的配置文件中获取验证Web应用程序用户所需的信息并定义其安全角色。这旨在简化Tomcat的初始安装和操作，而无需配置基于数据库或目录服务器的Realm的复杂性。它不适用于生产用途。</p>

    <p>本规范反映了已存在的功能的组合<code>org.apache.catalina.realm.MemoryRealm</code>类，以及已讨论的增强功能要求。在适当的地方，需求声明会标记为<em>[当前]</em>和<em>[已请求]</em>以区分它们。</p>

    <p>该功能规范的当前状态为“ <strong>建议”</strong> 。尚未在TOMCAT-DEV邮件列表上进行讨论和同意。</p>

  </div></div>


  <div class="subsection"><h4 id="External_Specifications">外部规格</h4><div class="text">

    <p>此功能的实现取决于以下外部规范：</p>
    <ul>
    <li>没有</li>
    </ul>

  </div></div>


  <div class="subsection"><h4 id="Implementation_Requirements">实施要求</h4><div class="text">

    <p>此功能的实现应符合以下要求：</p>
    <ul>
    <li>在一个或多个实现类中实现。</li>
    <li>实施<code>org.apache.catalina.Realm</code>接口。[当前]</li>
    <li>实施<code>org.apache.catalina.Lifecycle</code>接口。[当前]</li>
    <li>子类化<code>org.apache.catalina.realm.RealmBase</code>基类。</li>
    <li>住在<code>org.apache.catalina.realm</code>包。[当前]</li>
    <li>支持可配置的调试详细信息级别。[当前]</li>
    <li>通过以下方式记录调试和操作消息（适当国际化） <code>getContainer().log()</code>方法。[当前]</li>
    </ul>

  </div></div>


</div><h3 id="Dependencies">依存关系</h3><div class="text">


  <div class="subsection"><h4 id="Environmental_Dependencies">环境依赖性</h4><div class="text">

    <p>为了使MemoryRealm正常运行，必须满足以下环境依赖性：</p>
    <ul>
    <li>使用MemoryRealm的愿望必须在<code>$CATALINA_BASE/conf/server.xml</code> ， 在一个<code><Realm></code>嵌套在相应元素内的元素<code><Engine></code> ， <code><Host></code> ， 要么<code><Context></code>元件。（这已经包含在默认<code>server.xml</code>文件。）</li>
    </ul>

  </div></div>


  <div class="subsection"><h4 id="Container_Dependencies">容器依赖</h4><div class="text">

    <p>MemoryRealm的正确操作取决于周围容器的以下特定功能：</p>
    <ul>
    <li>与的互动<code>MemoryRealm</code>将由适当的发起<code>Authenticator</code>实现，基于所选的登录方法。</li>
    <li><code>MemoryRealm</code>必须具有与其可用的JAXP / 1.1 API兼容的XML解析器。通常通过将相应的JAR文件放在目录中来完成此操作<code>$CATALINA_HOME/lib</code> 。</li>
    </ul>

  </div></div>


</div><h3 id="Functionality">功能性</h3><div class="text">


  <div class="subsection"><h4 id="Overview_of_Operation">操作概述</h4><div class="text">

    <p>主要目的<code>MemoryRealm</code>允许Catalina根据XML格式的配置文件中的信息对用户进行身份验证并查找相应的安全角色。该文件的格式如下所述。当一个<code>MemoryRealm</code>实例启动后，它将读取此XML文件的内容，并创建所有有效用户及其关联的安全角色的“内存数据库”。</p>

    <p>每次Catalina需要验证用户身份时，它将调用<code>authenticate()</code>此Realm实现的方法，传递用户指定的用户名和密码。如果我们在数据库中找到该用户（并且密码匹配），那么我们将累积为此用户定义的所有安全角色，并创建一个新的安全角色。 <code>GenericPrincipal</code>要返回的对象。如果用户未通过身份验证，我们将返回<code>null</code>代替。的<code>GenericUser</code>对象会缓存该用户在身份验证时拥有的安全角色集，以便对<code>isUserInRole()</code>可以回答而无需每次都返回数据库。</p>

  </div></div>


  <div class="subsection"><h4 id="Detailed_Functional_Requirements">详细功能要求</h4><div class="text">


    <h3>可配置的属性</h3>

    <p>该实现应支持可以使用JavaBeans属性设置器配置的以下属性：</p>
    <ul>
    <li>可配置的调试详细信息级别。</li>
    <li>可配置的文件路径名（绝对或相对于<code>$CATALINA_BASE</code>包含我们定义的用户的XML文件。[ <code>conf/tomcat-users.xml</code> ]。</li>
    </ul>

    <h3>生命周期功能</h3>

    <p>当执行以下操作时，必须执行以下处理<code>start()</code>方法称为：</p>
    <ul>
    <li>打开并解析指定的XML文件。</li>
    <li>创建XML文件内容的内存数据库表示。</li>
    <li><strong>注</strong> –不需要识别对XML文件内容的后续更改。</li>
    </ul>

    <p>当执行以下操作时，必须执行以下处理<code>stop()</code>方法称为：</p>
    <ul>
    <li>释放对内存数据库表示形式的对象引用。</li>
    </ul>


    <h3>方法authenticate（）功能</h3>

    <p>什么时候<code>authenticate()</code>被调用时，需要进行以下处理：</p>
    <ul>
    <li>根据与指定的用户名匹配，从内存数据库中选择一个也是唯一的“用户”实例。如果没有这种情况，请返回<code>null</code> 。</li>
    <li>通过将接收到的（可能是加密的）密码值与用户提供的密码进行比较，对用户进行身份验证。如果没有匹配项，则返回<code>null</code> 。</li>
    <li>构造一个新的类实例<code>org.apache.catalina.realm.GenericPrincipal</code> （如果尚未使用它作为内部数据库表示形式的话）包含已验证的用户名和<code>List</code>与该用户相关联的安全角色。</li>
    <li>退还新建的<code>GenericPrincipal</code> 。</li>
    </ul>


    <h3>方法hasRole（）功能</h3>

    <p>什么时候<code>hasRole()</code>被调用时，需要进行以下处理：</p>
    <ul>
    <li>的<code>principal</code>作为参数传递的参数应该是我们返回的参数（instanceof类<code>org.apache.catalina.realm.GenericPrincipal</code> ，带有<code>realm</code>属性等于我们的实例。</li>
    <li>如果通过了<code>principal</code>符合这些条件，请对照由返回的列表检查指定的角色<code>getRoles()</code> ，然后返回<code>true</code>如果包括指定的角色；否则，返回<code>false</code> 。</li>
    <li>如果通过了<code>principal</code>不符合这些条件，返回<code>false</code> 。</li>
    </ul>

  </div></div>

</div><h3 id="Testable_Assertions">可测断言</h3><div class="text">

  <p>除了上面列出的功能要求所暗含的断言之外，还应对以下其他断言进行测试，以验证<code>MemoryRealm</code> ：</p>
  <ul>
  </ul>

</div><div class="noprint"><h3 id="comments_section">评论</h3><div class="text"><p class="notice"><strong>注意：</strong>此注释部分收集有关改进Apache Tomcat文档的建议。<br><br>如果您遇到问题并需要帮助，请阅读“ <a href="https://tomcat.apache.org/findhelp.html">查找帮助”</a>页面，然后在tomcat-users <a href="https://tomcat.apache.org/lists.html">邮件列表中</a>询问您的问题。不要在这里问这样的问题。这不是“问答”部分。<br><br><a href="../comments.html">这里</a>解释<a href="../comments.html">了</a> Apache Comments System。如果评论已被实施或被认为无效/偏离主题，则我们的主持人可能会将其删除。
                  </p><div id="comments_thread"></div></div></div></div></div></div></div><footer><div id="footer">版权所有©1999-2019，Apache软件基金会</div></footer></div></body></html>