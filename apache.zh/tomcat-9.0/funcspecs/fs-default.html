<html lang="zh-Hans" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="../images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>Catalina功能规范（9.0.21）-默认Servlet</title><meta name="author" content="Craig McClanahan"><script type="application/javascript" data-comments-identifier="tomcat-9.0-doc/funcspecs/fs-default">
    "use strict"; // Enable strict mode

    (function() {
      var thisScript = document.currentScript;
      if (!thisScript) { // Workaround for IE <= 11
        var scripts = document.getElementsByTagName("script");
        thisScript = scripts[scripts.length - 1];
      }
      document.addEventListener("DOMContentLoaded", (function() {
        var commentsDiv = document.getElementById("comments_thread");
        var commentsShortname = "tomcat";
        var commentsIdentifier = "https://tomcat.apache.org/" +
          thisScript.getAttribute("data-comments-identifier") + ".html";

        (function(w, d) {
          if (w.location.hostname.toLowerCase() == "tomcat.apache.org") {
            var s = d.createElement("script");
            s.type = "application/javascript";
            s.async = true;
            s.src = "https://comments.apache.org/show_comments.lua?site=" +
              encodeURIComponent(commentsShortname) +
              "&page=" + encodeURIComponent(commentsIdentifier);
            d.head.appendChild(s);
          } else {
            commentsDiv.appendChild(d.createTextNode("Comments are disabled for this page at the moment."));
          }
        })(window, document);
      }), false);
    })();
  </script></head><body ><div id="wrapper"><header><div id="header"><div><div><div class="logo noPrint"><a href="https://tomcat.apache.org/"><img alt="Tomcat主页" src="../images/tomcat.png"></a></div><div style="height:1px"></div><div class="asfLogo noPrint"><a href="https://www.apache.org/" target="_blank"><img src="../images/asf-logo.svg" alt="Apache软件基金会" style="width:266px;height:83px"></a></div><h1>卡塔利娜功能规格</h1><div class="versionInfo">版本9.0.21， <time datetime="2019-06-04"> 2019年6月4日</time></div><div style="height:1px"></div><div style="clear:left"></div></div></div></div></header><div id="middle"><div><div id="mainLeft" class="noprint"><div><nav><div><h2>链接</h2><ul><li><a href="../index.html">文件首页</a></li><li><a href="index.html">功能规格</a></li><li><a href="https://wiki.apache.org/tomcat/FAQ">常问问题</a></li><li><a href="#comments_section">用户评论</a></li></ul></div><div><h2>行政应用</h2><ul><li><a href="fs-admin-apps.html">总体要求</a></li><li><a href="mbean-names.html">Tomcat MBean名称</a></li><li><a href="fs-admin-objects.html">管理对象</a></li><li><a href="fs-admin-opers.html">支持的运营</a></li></ul></div><div><h2>内部Servlet</h2><ul><li><a href="fs-default.html">默认Servlet</a></li></ul></div><div><h2>领域实现</h2><ul><li><a href="fs-jdbc-realm.html">JDBC领域</a></li><li><a href="fs-jndi-realm.html">JNDI领域</a></li><li><a href="fs-memory-realm.html">内存领域</a></li></ul></div></nav></div></div><div id="mainRight"><div id="content"><h2>默认Servlet</h2><h3 id="Table_of_Contents">目录</h3><div class="text">
<ul><li><a href="#Overview">总览</a><ol><li><a href="#Introduction">介绍</a></li><li><a href="#External_Specifications">外部规格</a></li><li><a href="#Implementation_Requirements">实施要求</a></li></ol></li><li><a href="#Dependencies">依存关系</a><ol><li><a href="#Environmental_Dependencies">环境依赖性</a></li><li><a href="#Container_Dependencies">容器依赖</a></li></ol></li><li><a href="#Functionality">功能性</a><ol><li><a href="#Initialization_Functionality">初始化功能</a></li><li><a href="#Per-Request_Functionality">按请求功能</a></li><li><a href="#Finalization_Functionality">终结功能</a></li></ol></li><li><a href="#Testable_Assertions">可测断言</a></li></ul>
</div><h3 id="Overview">总览</h3><div class="text">


  <div class="subsection"><h4 id="Introduction">介绍</h4><div class="text">

    <p><strong>Default Servlet</strong>的目的是响应客户端请求提供Web应用程序的静态资源。顾名思义，它通常通过映射到URL模式“ /”而配置为Web应用程序的“默认” servlet。</p>

  </div></div>


  <div class="subsection"><h4 id="External_Specifications">外部规格</h4><div class="text">

    <p>以下外部规范具有部分定义默认Servlet正确行为的规定：</p>
    <ul>
    <li><a href="https://jcp.org/aboutJava/communityprocess/final/jsr340/index.html">Servlet规范</a> （版本4.0）</li>
    <li><a href="https://www.rfc-editor.org/rfc/rfc2046.txt">多用途Internet邮件扩展（MIME）第二部分：媒体类型</a></li>
    <li><a href="https://www.rfc-editor.org/rfc/rfc2616.txt">超文本传输协议– HTTP / 1.1</a></li>
    </ul>

  </div></div>


  <div class="subsection"><h4 id="Implementation_Requirements">实施要求</h4><div class="text">

    <p>此功能的实现应符合以下要求：</p>
    <ul>
    <li>必须实现为servlet。</li>
    <li>必须支持可配置参数，用于调试详细信息级别，输入缓冲区大小，输出缓冲区大小，在不存在欢迎文件时是否生成目录列表以及是否通过DELETE和PUT支持修改。</li>
    <li>通过以下方式记录调试和操作消息（适当国际化） <code>getServletContext().log()</code>方法。</li>
    </ul>

  </div></div>


</div><h3 id="Dependencies">依存关系</h3><div class="text">


  <div class="subsection"><h4 id="Environmental_Dependencies">环境依赖性</h4><div class="text">

    <p>为了使默认servlet正确运行，必须满足以下环境依赖性：</p>
    <ul>
    <li>必须在应用程序部署描述符中注册默认servlet（或文件中的默认部署描述符） <code>$CATALINA_BASE/conf/web.xml</code> ）使用“默认servlet” servlet映射，以网址模式“ /”表示。</li>
    </ul>

  </div></div>


  <div class="subsection"><h4 id="Container_Dependencies">容器依赖</h4><div class="text">

    <p>默认servlet的正确操作取决于周围容器的以下特定功能：</p>
    <ul>
    <li>容器应提供一个Servlet上下文属性，该属性列出为此Web应用程序定义的欢迎文件名。</li>
    <li>容器应提供一个servlet上下文属性，该属性包含<code>javax.naming.directory.DirContext</code>表示此Web应用程序静态资源的实现。</li>
    </ul>

  </div></div>


</div><h3 id="Functionality">功能性</h3><div class="text">


  <div class="subsection"><h4 id="Initialization_Functionality">初始化功能</h4><div class="text">

    <p>当执行以下操作时，必须执行以下处理<code>init()</code>默认servlet的方法称为：</p>
    <ul>
    <li>流程和完整性检查配置参数。</li>
    </ul>

  </div></div>


  <div class="subsection"><h4 id="Per-Request_Functionality">按请求功能</h4><div class="text">


    <p>对于所有HTTP请求方法，资源路径是根据提供给此请求的路径信息（作为请求属性）确定的<code>javax.servlet.include.path_info</code> （用于请求分派器访问静态资源）或通过调用<code>request.getPathInfo()</code>直。</p>

    <p>在此servlet处理的每个HTTP DELETE请求上，应执行以下处理：</p>
    <ul>
    <li>如果不允许修改静态资源（由配置参数设置），则返回HTTP状态403（禁止）。</li>
    <li>如果试图从中删除资源<code>/META-INF</code>要么<code>/WEB-INF</code> ，返回HTTP状态403（禁止）。</li>
    <li>如果请求的资源不存在，则返回HTTP状态404（未找到）</li>
    <li>从包含此Web应用程序静态资源的目录上下文中解除资源绑定。如果成功，则返回HTTP状态204（无内容）。否则，返回HTTP状态405（不允许的方法）。</li>
    </ul>


    <p>在此servlet处理的每个HTTP GET请求上，应执行以下处理：</p>
    <ul>
    <li>如果请求是针对以下资源<code>/META-INF</code>要么<code>/WEB-INF</code> ，返回HTTP状态404（未找到）。</li>
    <li>如果请求的资源不存在，则返回HTTP状态404（未找到）。</li>
    <li>如果请求的资源不是目录，但是资源路径以“ /”或“ \”结尾，则返回HTTP状态404（未找到）。</li>
    <li>如果请求的资源是目录：<ul>
        <li>如果请求路径不是以“ /”结尾，请重定向到带有“ /”的相应路径，以便正确解析欢迎文件中的相对引用。</li>
        <li>如果存在指定的欢迎文件之一，请重定向到该欢迎文件的路径，以便将其显式提供。
            </li>
        </ul></li>
    <li>如果正在处理的请求包含<code>If-Range</code>标头，请执行HTTP / 1.1规范中所述的处理，以确定客户端的信息是否为最新。</li>
    <li>通过在我们的servlet上下文中查找相应的MIME类型，确定响应的内容类型。</li>
    <li>如果请求的资源是目录：<ul>
        <li>如果目录列表被禁止，则返回HTTP状态404（未找到）。</li>
        <li>将内容类型设置为<code>text/html</code> 。</li>
        </ul></li>
    <li>根据是否存在任何问题，确定要返回的范围<code>If-Range</code>和<code>Range</code>标头。</li>
    <li>如果请求的资源是目录，请添加一个<code>ETag</code>响应中的标头，其值基于目录的内容计算。</li>
    <li>包括一个<code>Last-Modified</code>响应中的标头，记录了上次修改资源的日期/时间。</li>
    <li>除非我们正在处理HEAD请求，否则在响应中包括适当的内容（或内容范围）。</li>
    </ul>

    <p>在此servlet处理的每个HTTP HEAD请求上，应执行以下处理：</p>
    <ul>
    <li>除了不在标头之后传输数据内容外，与HTTP GET请求的处理过程相同。</li>
    </ul>

    <p>在此servlet处理的每个HTTP POST请求上，应执行以下处理：</p>
    <ul>
    <li>处理方式与HTTP GET请求相同。</li>
    </ul>


    <p>在此servlet处理的每个HTTP PUT请求上，应执行以下处理：</p>
    <ul>
    <li>如果不允许修改静态资源（由配置参数设置），则返回HTTP状态403（禁止）。</li>
    <li>如果试图从中删除资源<code>/META-INF</code>要么<code>/WEB-INF</code> ，返回HTTP状态403（禁止）。</li>
    <li>从此请求的主体创建一个新资源。</li>
    <li>将指定的路径绑定或重新绑定到新资源（取决于当前是否存在）。返回HTTP状态如下：<ul>
        <li>如果绑定失败，则返回HTTP状态409（冲突）。
            </li>
        <li>如果绑定成功并且该资源先前不存在，则返回HTTP状态201（已创建）。</li>
        <li>如果绑定成功并且资源先前存在，则返回HTTP状态204（无内容）。</li>
        </ul></li>
    </ul>

  </div></div>


  <div class="subsection"><h4 id="Finalization_Functionality">终结功能</h4><div class="text">

    <p>当<code>destroy()</code>方法称为：</p>

  </div></div>


</div><h3 id="Testable_Assertions">可测断言</h3><div class="text">

  <p>除了上面列出的功能要求所隐含的断言之外，还应对以下其他断言进行测试以验证默认servlet的行为：</p>
  <ul>
  <li>对Web应用程序中不存在的资源的请求必须返回HTTP状态404（未找到）。</li>
  <li>对于直接从WAR文件或从解压缩的目录结构中用尽的Web应用程序，默认servlet必须具有相同的操作。</li>
  <li>如果Web应用程序用尽了未压缩的目录结构，则默认Servlet必须识别通过外部手段更新资源的情况。</li>
  </ul>

</div><div class="noprint"><h3 id="comments_section">评论</h3><div class="text"><p class="notice"><strong>注意：</strong>此注释部分收集有关改进Apache Tomcat文档的建议。<br><br>如果您遇到问题并需要帮助，请阅读“ <a href="https://tomcat.apache.org/findhelp.html">查找帮助”</a>页面，然后在tomcat-users <a href="https://tomcat.apache.org/lists.html">邮件列表中</a>询问您的问题。不要在这里问这样的问题。这不是“问答”部分。<br><br><a href="../comments.html">这里</a>解释<a href="../comments.html">了</a> Apache Comments System。如果评论已被实施或被认为无效/偏离主题，则我们的主持人可能会将其删除。
                  </p><div id="comments_thread"></div></div></div></div></div></div></div><footer><div id="footer">版权所有©1999-2019，Apache软件基金会</div></footer></div></body></html>