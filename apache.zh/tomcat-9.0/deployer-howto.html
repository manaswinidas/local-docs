<html lang="zh-Hans" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="./images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>Apache Tomcat 9（9.0.21）-Tomcat Web应用程序部署</title><meta name="author" content="Allistair Crossley"><script type="application/javascript" data-comments-identifier="tomcat-9.0-doc/deployer-howto">
    "use strict"; // Enable strict mode

    (function() {
      var thisScript = document.currentScript;
      if (!thisScript) { // Workaround for IE <= 11
        var scripts = document.getElementsByTagName("script");
        thisScript = scripts[scripts.length - 1];
      }
      document.addEventListener("DOMContentLoaded", (function() {
        var commentsDiv = document.getElementById("comments_thread");
        var commentsShortname = "tomcat";
        var commentsIdentifier = "https://tomcat.apache.org/" +
          thisScript.getAttribute("data-comments-identifier") + ".html";

        (function(w, d) {
          if (w.location.hostname.toLowerCase() == "tomcat.apache.org") {
            var s = d.createElement("script");
            s.type = "application/javascript";
            s.async = true;
            s.src = "https://comments.apache.org/show_comments.lua?site=" +
              encodeURIComponent(commentsShortname) +
              "&page=" + encodeURIComponent(commentsIdentifier);
            d.head.appendChild(s);
          } else {
            commentsDiv.appendChild(d.createTextNode("Comments are disabled for this page at the moment."));
          }
        })(window, document);
      }), false);
    })();
  </script></head><body ><div id="wrapper"><header><div id="header"><div><div><div class="logo noPrint"><a href="https://tomcat.apache.org/"><img alt="Tomcat主页" src="./images/tomcat.png"></a></div><div style="height:1px"></div><div class="asfLogo noPrint"><a href="https://www.apache.org/" target="_blank"><img src="./images/asf-logo.svg" alt="Apache软件基金会" style="width:266px;height:83px"></a></div><h1>Apache Tomcat 9</h1><div class="versionInfo">版本9.0.21， <time datetime="2019-06-04"> 2019年6月4日</time></div><div style="height:1px"></div><div style="clear:left"></div></div></div></div></header><div id="middle"><div><div id="mainLeft" class="noprint"><div><nav><div><h2>链接</h2><ul><li><a href="index.html">文件首页</a></li><li><a href="https://wiki.apache.org/tomcat/FAQ">常问问题</a></li><li><a href="#comments_section">用户评论</a></li></ul></div><div><h2>用户指南</h2><ul><li><a href="introduction.html">1）简介</a></li><li><a href="setup.html">2）设定</a></li><li><a href="appdev/index.html">3）第一个webapp</a></li><li><a href="deployer-howto.html">4）部署者</a></li><li><a href="manager-howto.html">5）经理</a></li><li><a href="host-manager-howto.html">6）主机管理员</a></li><li><a href="realm-howto.html">7）领域和AAA</a></li><li><a href="security-manager-howto.html">8）安全经理</a></li><li><a href="jndi-resources-howto.html">9）JNDI资源</a></li><li><a href="jndi-datasource-examples-howto.html">10）JDBC数据源</a></li><li><a href="class-loader-howto.html">11）类加载</a></li><li><a href="jasper-howto.html">12）JSP</a></li><li><a href="ssl-howto.html">13）SSL / TLS</a></li><li><a href="ssi-howto.html">14）SSI</a></li><li><a href="cgi-howto.html">15）CGI</a></li><li><a href="proxy-howto.html">16）代理支持</a></li><li><a href="mbeans-descriptors-howto.html">17）MBean描述符</a></li><li><a href="default-servlet.html">18）默认Servlet</a></li><li><a href="cluster-howto.html">19）聚类</a></li><li><a href="balancer-howto.html">20）负载均衡器</a></li><li><a href="connectors.html">21）连接器</a></li><li><a href="monitoring.html">22）监控与管理</a></li><li><a href="logging.html">23）记录</a></li><li><a href="apr.html">24）APR /本地</a></li><li><a href="virtual-hosting-howto.html">25）虚拟主机</a></li><li><a href="aio.html">26）高级IO</a></li><li><a href="extras.html">27）附加组件</a></li><li><a href="maven-jars.html">28）行刑</a></li><li><a href="security-howto.html">29）安全注意事项</a></li><li><a href="windows-service-howto.html">30）Windows服务</a></li><li><a href="windows-auth-howto.html">31）Windows身份验证</a></li><li><a href="jdbc-pool.html">32）Tomcat的JDBC池</a></li><li><a href="web-socket-howto.html">33）WebSocket</a></li><li><a href="rewrite.html">34）改写</a></li></ul></div><div><h2>参考</h2><ul><li><a href="RELEASE-NOTES.txt">发行说明</a></li><li><a href="config/index.html">组态</a></li><li><a href="api/index.html">Tomcat Java文档</a></li><li><a href="servletapi/index.html">Servlet Java文档</a></li><li><a href="jspapi/index.html">JSP 2.3 Java文档</a></li><li><a href="elapi/index.html">EL 3.0 Java文档</a></li><li><a href="websocketapi/index.html">WebSocket 1.1 Java文档</a></li><li><a href="https://tomcat.apache.org/connectors-doc/">JK 1.2文档</a></li></ul></div><div><h2>Apache Tomcat开发</h2><ul><li><a href="building.html">建造</a></li><li><a href="changelog.html">变更日志</a></li><li><a href="https://wiki.apache.org/tomcat/TomcatVersions">状态</a></li><li><a href="developers.html">开发者</a></li><li><a href="architecture/index.html">建筑</a></li><li><a href="funcspecs/index.html">功能规格。</a></li><li><a href="tribes/introduction.html">部族</a></li></ul></div></nav></div></div><div id="mainRight"><div id="content"><h2>Tomcat Web应用程序部署</h2><h3 id="Table_of_Contents">目录</h3><div class="text">
<ul><li><a href="#Introduction">介绍</a></li><li><a href="#Installation">安装</a></li><li><a href="#A_word_on_Contexts">语境</a></li><li><a href="#Deployment_on_Tomcat_startup">在Tomcat启动时进行部署</a></li><li><a href="#Deploying_on_a_running_Tomcat_server">在正在运行的Tomcat服务器上进行部署</a></li><li><a href="#Deploying_using_the_Tomcat_Manager">使用Tomcat管理器进行部署</a></li><li><a href="#Deploying_using_the_Client_Deployer_Package">使用客户端部署程序包进行部署</a></li></ul>
</div><h3 id="Introduction">介绍</h3><div class="text">
        <p>部署是用于将Web应用程序（第三方WAR或您自己的自定义Web应用程序）安装到Tomcat服务器的过程的术语。
        </p>
        <p>Web应用程序部署可以在Tomcat服务器中以多种方式完成。
        </p>
        <ul>
                <li>静态地在启动Tomcat之前先设置Web应用程序</li>
                <li>动态地通过直接操作已经部署的Web应用程序（依靠<em>自动部署</em>功能）或通过使用Tomcat Manager Web应用程序远程</li>
        </ul>
        <p><a href="manager-howto.html">Tomcat Manager</a>是一个Web应用程序，可以交互使用（通过HTML GUI）或以编程方式（通过基于URL的API）来部署和管理Web应用程序。
        </p>
        <p>有许多依赖Manager Web应用程序执行部署的方法。Apache Tomcat提供了Apache Ant构建工具的任务。
            <a href="https://tomcat.apache.org/maven-plugin.html">Apache Tomcat Maven插件</a>项目提供了与Apache Maven的集成。还有一个名为Client Deployer的工具，可以从命令行使用它，并提供其他功能，例如编译和验证Web应用程序以及将Web应用程序打包到Web应用程序资源（WAR）文件中。
        </p>
    </div><h3 id="Installation">安装</h3><div class="text">
        <p>静态部署Web应用程序不需要安装，因为Tomcat是开箱即用的。尽管需要某些配置（如<a href="manager-howto.html">Tomcat Manager手册</a>中所述），但使用Tomcat Manager进行部署功能也不需要进行任何安装。但是，如果您想使用Tomcat Client Deployer（TCD），则需要进行安装。
        </p>
        <p>TCD没有与Tomcat核心发行版打包在一起，因此必须从“下载”区域单独下载。该下载通常标有<i>apache-tomcat-9.0.x-deployer</i> 。
        </p>
        <p>TCD具有Apache Ant 1.6.2+和Java安装的先决条件。您的环境应定义一个指向Ant安装根目录的ANT_HOME环境值，以及一个指向Java安装的JAVA_HOME值。此外，您应确保Ant的ant命令，并且Java javac编译器命令是从操作系统提供的命令外壳运行的。
        </p>
        <ol>
            <li>下载TCD发行版</li>
            <li>TCD软件包无需解压缩到任何现有的Tomcat安装中，可以解压缩到任何位置。
            </li>
            <li>阅读使用<a href="#Deploying_using_the_Client_Deployer_Package">Tomcat客户端部署程序</a></li>
        </ol>
    </div><h3 id="A_word_on_Contexts">语境</h3><div class="text">
        <p>在谈论Web应用程序的部署时，需要理解<i>上下文</i>的概念。上下文是Tomcat所谓的Web应用程序。
        </p>
        <p>为了在Tomcat中配置上下文，需要<i>上下文描述符</i> 。上下文描述符只是一个XML文件，其中包含与Tomcat相关的Context配置，例如命名资源或会话管理器配置。在早期版本的Tomcat中，上下文描述符配置的内容通常存储在Tomcat的主配置文件<i>server.xml中，</i>但现在不建议这样做（尽管目前仍然可以使用）。
        </p>
        <p>上下文描述符不仅帮助Tomcat知道如何配置上下文，而且其他工具（例如Tomcat Manager和TCD）经常使用这些上下文描述符来正确执行其角色。
        </p>
        <p>上下文描述符的位置为：</p>
        <ol>
                <li>$ CATALINA_BASE / conf / [引擎名称] / [主机名] / [webappname] .xml</li>
                <li>$ CATALINA_BASE / webapps / [webappname] /META-INF/context.xml</li>
        </ol>
        <p>（1）中的文件名为[webappname] .xml，但（2）中的文件命名为context.xml。如果未为上下文提供上下文描述符，则Tomcat使用默认值配置上下文。
        </p>
    </div><h3 id="Deployment_on_Tomcat_startup">在Tomcat启动时进行部署</h3><div class="text">
        <p>如果您对使用Tomcat Manager或TCD不感兴趣，则需要将Web应用程序静态部署到Tomcat，然后再启动Tomcat。您将Web应用程序部署到这种部署类型的位置称为<code>appBase</code>由主机指定。您可以将所谓的<i>分解Web应用程序</i> （即未压缩的<i>Web应用程序）</i>复制到此位置，也可以将压缩的Web应用程序资源复制到该位置。WAR文件。
        </p>
        <p>存在于主机指定位置的Web应用程序（默认主机为“ localhost”） <code>appBase</code>属性（默认appBase为“ $ CATALINA_BASE / webapps”）仅在主机的<code>deployOnStartup</code>属性为“ true”。
        </p>
        <p>在这种情况下，将在Tomcat启动时执行以下部署顺序：</p>
        <ol>
            <li>任何上下文描述符都将首先部署。</li>
            <li>然后将部署未由任何上下文描述符引用的爆炸性Web应用程序。如果它们有关联。appBase中的WAR文件，它比爆炸的Web应用程序要新，爆炸的目录将被删除，并且Webapp将从中重新部署。战争</li>
            <li>。WAR文件将被部署</li>
        </ol>
    </div><h3 id="Deploying_on_a_running_Tomcat_server">在正在运行的Tomcat服务器上进行部署</h3><div class="text">
        <p>可以将Web应用程序部署到正在运行的Tomcat服务器。
        </p>
        <p>如果主持人<code>autoDeploy</code>如果属性为“ true”，则主机将尝试根据需要动态部署和更新Web应用程序，例如，如果是new。战争掉进了<code>appBase</code> 。为此，主机需要启用后台处理，这是默认配置。
        </p>

        <p>
            <code>autoDeploy</code>设置为“ true”，并且正在运行的Tomcat允许：</p>
        <ul>
            <li>部署。WAR文件复制到主机<code>appBase</code> 。</li>
            <li>部署爆炸性Web应用程序，将其复制到主机中<code>appBase</code> 。
            </li>
            <li>重新部署已经从部署的Web应用程序。新战争时。提供了WAR。在这种情况下，将删除爆炸的Web应用程序，并删除。WAR再次扩展。请注意，如果将Host配置为，则不会发生爆炸。WAR不会与<code>unpackWARs</code>属性设置为“ false”，在这种情况下，将简单地将Web应用程序重新部署为压缩存档。
            </li>
            <li>如果/WEB-INF/web.xml文件（或定义为WatchedResource的任何其他资源）已更新，则重新加载Web应用程序。
            </li>
            <li>如果更新了从中部署Web应用程序的上下文描述符文件，则重新部署Web应用程序。
            </li>
            <li>如果更新了Web应用程序使用的全局或每个主机的上下文描述符文件，则重新部署相关Web应用程序。
            </li>
            <li>如果将上下文描述符文件（文件名与先前部署的Web应用程序的Context路径相对应）添加到Web应用程序中，则重新部署Web应用程序。 <code>$CATALINA_BASE/conf/[enginename]/[hostname]/</code>目录。
            </li>
            <li>如果删除了Web应用程序的文档库（docBase），则将其取消部署。请注意，在Windows上，这假定已启用防锁定功能（请参阅上下文配置），否则无法删除正在运行的Web应用程序的资源。
            </li>
        </ul>
        <p>请注意，也可以在加载程序中配置Web应用程序的重新加载，在这种情况下，将跟踪已加载的类以进行更改。
        </p>
    </div><h3 id="Deploying_using_the_Tomcat_Manager">使用Tomcat管理器进行部署</h3><div class="text">
        <p>Tomcat管理器包含在其<a href="manager-howto.html">自己的手册页中</a> 。
        </p>
    </div><h3 id="Deploying_using_the_Client_Deployer_Package">使用客户端部署程序包进行部署</h3><div class="text">
        <p>最后，可以使用Tomcat Client Deployer来实现Web应用程序的部署。这是一个可用于验证，编译，压缩为的软件包。WAR，并将Web应用程序部署到生产或开发Tomcat服务器。应当注意，此功能使用Tomcat管理器，因此目标Tomcat服务器应正在运行。
        </p>

        <p>假定用户将熟悉使用Apache TCD的Apache Ant。 Apache Ant是一个脚本化的构建工具。TCD预先打包了构建脚本以供使用。仅需要对Apache Ant有一定的了解（如本页面前面列出的安装，并且熟悉使用操作系统命令外壳程序和配置环境变量）。
        </p>

        <p>TCD包括Ant任务，在部署之前用于JSP编译的Jasper页面编译器，以及用于验证Web应用程序上下文描述符的任务。验证器任务（类<code>org.apache.catalina.ant.ValidatorTask</code> ）仅允许使用一个参数：展开的Web应用程序的基本路径。
        </p>

        <p>TCD使用分解的Web应用程序作为输入（请参阅下面使用的属性列表）。通过部署程序以编程方式部署的Web应用程序可能在其中包含上下文描述符<code>/META-INF/context.xml</code> 。
        </p>

        <p>TCD包含一个现成的Ant脚本，其目标如下：</p>
        <ul>
            <li>
                <code>compile</code> （默认）：编译和验证Web应用程序。可以独立使用，不需要运行的Tomcat服务器。编译的应用程序将仅在关联的<em>Tomcat XYZ</em>服务器版本上运行，并且不能保证在另一个Tomcat版本上运行，因为Jasper生成的代码取决于其运行时组件。还应注意，此目标还将自动编译位于<code>/WEB-INF/classes</code> Web应用程序的文件夹。</li>
            <li>
                <code>deploy</code> ：将Web应用程序（已编译或未编译）部署到Tomcat服务器。
            </li>
            <li><code>undeploy</code> ：取消部署Web应用程序</li>
            <li><code>start</code> ：启动Web应用程序</li>
            <li><code>reload</code> ：重新加载Web应用程序</li>
            <li><code>stop</code> ：停止Web应用程序</li>
        </ul>

        <p>为了配置部署，请创建一个名为<code>deployer.properties</code>在TCD安装目录的根目录中。在此文件中，每行添加以下名称=值对：</p>

        <p>此外，您将需要确保已为目标Tomcat Manager（TCD使用的目标用户）设置了用户，否则TCD将不会通过Tomcat Manager进行身份验证，并且部署将失败。为此，请参见“ Tomcat管理器”页面。
        </p>

        <ul>
            <li>
                <code>build</code> ：默认情况下，使用的构建文件夹为<code>${build}/webapp/${path}</code> （ <code>${build}</code> ，默认情况下，指向<code>${basedir}/build</code> ）。执行结束后<code>compile</code>目标，即Web应用程序。WAR将位于<code>${build}/webapp/${path}.war</code> 。
            </li>
            <li>
                <code>webapp</code> ：包含展开的Web应用程序的目录，将对其进行编译和验证。默认情况下，该文件夹为<code>myapp</code> 。
            </li>
            <li>
                <code>path</code> ：默认情况下，Web应用程序的已部署上下文路径<code>/myapp</code> 。
            </li>
            <li>
                <code>url</code> ：指向正在运行的Tomcat服务器的Tomcat Manager Web应用程序的绝对URL，它将用于部署和取消部署Web应用程序。默认情况下，部署者将尝试访问在本地主机上运行的Tomcat实例，地址为<code>http://localhost:8080/manager/text</code> 。
            </li>
            <li>
                <code>username</code> ：Tomcat Manager用户名（用户应具有manager-script角色）</li>
            <li><code>password</code> ：Tomcat管理器密码。</li>
        </ul>
    </div><div class="noprint"><h3 id="comments_section">评论</h3><div class="text"><p class="notice"><strong>注意：</strong>此注释部分收集有关改进Apache Tomcat文档的建议。<br><br>如果您遇到问题并需要帮助，请阅读“ <a href="https://tomcat.apache.org/findhelp.html">查找帮助”</a>页面，然后在tomcat-users <a href="https://tomcat.apache.org/lists.html">邮件列表中</a>询问您的问题。不要在这里问这样的问题。这不是“问答”部分。<br><br><a href="./comments.html">这里</a>解释<a href="./comments.html">了</a> Apache Comments System。如果评论已被实施或被认为无效/偏离主题，则我们的主持人可能会将其删除。
                  </p><div id="comments_thread"></div></div></div></div></div></div></div><footer><div id="footer">版权所有©1999-2019，Apache软件基金会</div></footer></div></body></html>