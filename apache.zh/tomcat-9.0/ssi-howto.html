<html lang="zh-Hans" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="./images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>Apache Tomcat 9（9.0.21）-SSI如何</title><meta name="author" content="Glenn L. Nielsen"><script type="application/javascript" data-comments-identifier="tomcat-9.0-doc/ssi-howto">
    "use strict"; // Enable strict mode

    (function() {
      var thisScript = document.currentScript;
      if (!thisScript) { // Workaround for IE <= 11
        var scripts = document.getElementsByTagName("script");
        thisScript = scripts[scripts.length - 1];
      }
      document.addEventListener("DOMContentLoaded", (function() {
        var commentsDiv = document.getElementById("comments_thread");
        var commentsShortname = "tomcat";
        var commentsIdentifier = "https://tomcat.apache.org/" +
          thisScript.getAttribute("data-comments-identifier") + ".html";

        (function(w, d) {
          if (w.location.hostname.toLowerCase() == "tomcat.apache.org") {
            var s = d.createElement("script");
            s.type = "application/javascript";
            s.async = true;
            s.src = "https://comments.apache.org/show_comments.lua?site=" +
              encodeURIComponent(commentsShortname) +
              "&page=" + encodeURIComponent(commentsIdentifier);
            d.head.appendChild(s);
          } else {
            commentsDiv.appendChild(d.createTextNode("Comments are disabled for this page at the moment."));
          }
        })(window, document);
      }), false);
    })();
  </script></head><body ><div id="wrapper"><header><div id="header"><div><div><div class="logo noPrint"><a href="https://tomcat.apache.org/"><img alt="Tomcat主页" src="./images/tomcat.png"></a></div><div style="height:1px"></div><div class="asfLogo noPrint"><a href="https://www.apache.org/" target="_blank"><img src="./images/asf-logo.svg" alt="Apache软件基金会" style="width:266px;height:83px"></a></div><h1>Apache Tomcat 9</h1><div class="versionInfo">版本9.0.21， <time datetime="2019-06-04"> 2019年6月4日</time></div><div style="height:1px"></div><div style="clear:left"></div></div></div></div></header><div id="middle"><div><div id="mainLeft" class="noprint"><div><nav><div><h2>链接</h2><ul><li><a href="index.html">文件首页</a></li><li><a href="https://wiki.apache.org/tomcat/FAQ">常问问题</a></li><li><a href="#comments_section">用户评论</a></li></ul></div><div><h2>用户指南</h2><ul><li><a href="introduction.html">1）简介</a></li><li><a href="setup.html">2）设定</a></li><li><a href="appdev/index.html">3）第一个webapp</a></li><li><a href="deployer-howto.html">4）部署者</a></li><li><a href="manager-howto.html">5）经理</a></li><li><a href="host-manager-howto.html">6）主机管理员</a></li><li><a href="realm-howto.html">7）领域和AAA</a></li><li><a href="security-manager-howto.html">8）安全经理</a></li><li><a href="jndi-resources-howto.html">9）JNDI资源</a></li><li><a href="jndi-datasource-examples-howto.html">10）JDBC数据源</a></li><li><a href="class-loader-howto.html">11）类加载</a></li><li><a href="jasper-howto.html">12）JSP</a></li><li><a href="ssl-howto.html">13）SSL / TLS</a></li><li><a href="ssi-howto.html">14）SSI</a></li><li><a href="cgi-howto.html">15）CGI</a></li><li><a href="proxy-howto.html">16）代理支持</a></li><li><a href="mbeans-descriptors-howto.html">17）MBean描述符</a></li><li><a href="default-servlet.html">18）默认Servlet</a></li><li><a href="cluster-howto.html">19）聚类</a></li><li><a href="balancer-howto.html">20）负载均衡器</a></li><li><a href="connectors.html">21）连接器</a></li><li><a href="monitoring.html">22）监控与管理</a></li><li><a href="logging.html">23）记录</a></li><li><a href="apr.html">24）APR /本地</a></li><li><a href="virtual-hosting-howto.html">25）虚拟主机</a></li><li><a href="aio.html">26）高级IO</a></li><li><a href="extras.html">27）附加组件</a></li><li><a href="maven-jars.html">28）行刑</a></li><li><a href="security-howto.html">29）安全注意事项</a></li><li><a href="windows-service-howto.html">30）Windows服务</a></li><li><a href="windows-auth-howto.html">31）Windows身份验证</a></li><li><a href="jdbc-pool.html">32）Tomcat的JDBC池</a></li><li><a href="web-socket-howto.html">33）WebSocket</a></li><li><a href="rewrite.html">34）改写</a></li></ul></div><div><h2>参考</h2><ul><li><a href="RELEASE-NOTES.txt">发行说明</a></li><li><a href="config/index.html">组态</a></li><li><a href="api/index.html">Tomcat Java文档</a></li><li><a href="servletapi/index.html">Servlet Java文档</a></li><li><a href="jspapi/index.html">JSP 2.3 Java文档</a></li><li><a href="elapi/index.html">EL 3.0 Java文档</a></li><li><a href="websocketapi/index.html">WebSocket 1.1 Java文档</a></li><li><a href="https://tomcat.apache.org/connectors-doc/">JK 1.2文档</a></li></ul></div><div><h2>Apache Tomcat开发</h2><ul><li><a href="building.html">建造</a></li><li><a href="changelog.html">变更日志</a></li><li><a href="https://wiki.apache.org/tomcat/TomcatVersions">状态</a></li><li><a href="developers.html">开发者</a></li><li><a href="architecture/index.html">建筑</a></li><li><a href="funcspecs/index.html">功能规格。</a></li><li><a href="tribes/introduction.html">部族</a></li></ul></div></nav></div></div><div id="mainRight"><div id="content"><h2>SSI如何</h2><h3 id="Table_of_Contents">目录</h3><div class="text">
<ul><li><a href="#Introduction">介绍</a></li><li><a href="#Installation">安装</a></li><li><a href="#Servlet_Configuration">Servlet配置</a></li><li><a href="#Filter_Configuration">过滤器配置</a></li><li><a href="#Directives">指令</a></li><li><a href="#Variables">变数</a></li></ul>
</div><h3 id="Introduction">介绍</h3><div class="text">

<p>SSI（服务器端包含）是放置在HTML页面中的指令，并在服务页面时在服务器上对其进行评估。它们使您可以将动态生成的内容添加到现有的HTML页面，而不必通过CGI程序或其他动态技术来提供整个页面。
</p>

<p>在将Tomcat用作HTTP服务器并且需要SSI支持时，可以在Tomcat中添加SSI支持。通常，当您不想运行Apache之类的Web服务器时，这是在开发期间完成的。</p>

<p>Tomcat SSI支持实现与Apache相同的SSI指令。有关使用SSI指令的信息，请参见<a href="https://httpd.apache.org/docs/howto/ssi.html#basicssidirectives">Apache SSI简介</a> 。</p>

<p>SSI支持可作为Servlet和过滤器使用。您应该使用一个或另一个来提供SSI支持，但不能同时使用两者。</p>

<p>使用类实现基于Servlet的SSI支持<code>org.apache.catalina.ssi.SSIServlet</code> 。传统上，此servlet映射到URL模式“ * .shtml”。</p>

<p>使用类实现基于过滤器的SSI支持<code>org.apache.catalina.ssi.SSIFilter</code> 。传统上，此过滤器会映射到URL模式“ * .shtml”，尽管它可以映射到“ *”，因为它将基于mime类型选择性地启用/禁用SSI处理。contentType初始化参数使您可以将SSI处理应用于JSP页面，javascript或所需的任何其他内容。</p>
<p>默认情况下，Tomcat中禁用了SSI支持。</p>
</div><h3 id="Installation">安装</h3><div class="text">

<p><strong>注意</strong> -SSI指令可用于执行Tomcat JVM外部的程序。如果您使用的是Java SecurityManager，它将绕过您的安全策略配置<code>catalina.policy.</code>
</p>

<p>要使用SSI servlet，请从SSI servlet和servlet映射配置中删除XML注释。 <code>$CATALINA_BASE/conf/web.xml</code> 。</p>

<p>要使用SSI过滤器，请删除SSI过滤器周围的XML注释，并在其中删除过滤器映射配置<code>$CATALINA_BASE/conf/web.xml</code> 。</p>

<p>只有标记为特权的上下文可以使用SSI功能（请参阅Context元素的特权属性）。</p>

</div><h3 id="Servlet_Configuration">Servlet配置</h3><div class="text">

<p>有几个servlet初始化参数可用于配置SSI servlet的行为。</p>
<ul>
<li><strong>缓冲</strong> -该servlet的输出是否应该缓冲？（0 =假，1 =真）默认0（假）。</li>
<li><strong>debug-</strong>调试此servlet记录的消息的详细信息级别。默认值0。</li>
<li><strong>expires-</strong>具有SSI指令的页面将过期的秒数。默认行为是针对每个请求评估所有SSI指令。</li>
<li><strong>isVirtualWebappRelative-</strong>是否应将“虚拟” SSI指令路径解释为相对于上下文根而不是服务器根？默认为false。</li>
<li><strong>inputEncoding-</strong>如果无法从资源本身确定SSI资源，则假定为编码。默认是默认平台编码。</li>
<li><strong>outputEncoding-</strong>用于SSI处理结果的编码。默认值为UTF-8。</li>
<li><strong>allowExec-</strong>启用了exec命令吗？默认为false。</li>
</ul>


</div><h3 id="Filter_Configuration">过滤器配置</h3><div class="text">

<p>有几个过滤器初始化参数可用于配置SSI过滤器的行为。</p>
<ul>
<li><strong>contentType-</strong>在应用SSI处理之前必须匹配的正则表达式模式。在制作自己的模式时，请不要忘记，在mime内容类型之后，可能要注意一个可选字符集，形式为“ mime / type; charset = set”。默认值为“ text / x-server-parsed-html（;。*）？”。</li>
<li><strong>debug-</strong>调试此servlet记录的消息的详细信息级别。默认值0。</li>
<li><strong>expires-</strong>具有SSI指令的页面将过期的秒数。默认行为是针对每个请求评估所有SSI指令。</li>
<li><strong>isVirtualWebappRelative-</strong>是否应将“虚拟” SSI指令路径解释为相对于上下文根而不是服务器根？默认为false。</li>
<li><strong>allowExec-</strong>启用了exec命令吗？默认为false。</li>
</ul>


</div><h3 id="Directives">指令</h3><div class="text">
<p>通过将SSI指令嵌入HTML文档中来调用“服务器端包含”，其类型将由SSI servlet处理。指令采用HTML注释的形式。在将页面发送到客户端之前，该指令将被解释结果替换。指令的一般形式为：</p>
<p> <code><!--#directive [parm=value] --></code></p>
<p>指令是：</p>
<ul>
<li>
<strong>配置</strong> - <code><!--#config errmsg="Error occured" sizefmt="abbrev" timefmt="%B %Y" --></code>用于设置SSI错误消息，SSI处理的日期格式和文件大小。<br>所有都是可选的，但必须至少使用一个。可用选项如下：<br>
<strong>errmsg-</strong>用于SSI错误的错误消息<br>
<strong>sizefmt</strong> - <strong>fsize</strong>指令中用于大小的格式<br>
<strong>timefmt的</strong> -在<strong>flastmod</strong>指令用于时间戳格式<br>
</li>
<li>
<strong>回声</strong> - <code><!--#echo var="VARIABLE_NAME" encoding="entity" --></code>将被变量的值替换。
<br>可选的<strong>encoding</strong>参数指定要使用的编码类型。有效值是<strong>实体</strong> （默认）， <strong>url</strong>或<strong>none</strong> 。注意：使用除<strong>实体</strong>之外的编码可能会导致安全问题。
</li>
<li>
<strong>执行</strong> - <code><!--#exec cmd="file-name" --></code>用于在主机系统上运行命令。
</li>
<li>
<strong>执行</strong> - <code><!--#exec cgi="file-name" --></code>此行为与<strong>include虚拟</strong>指令相同，并且实际上不执行任何命令。
</li>
<li>
<strong>包括</strong> - <code><!--#include file="file-name" --></code>插入内容。该路径是相对于使用此伪指令的文档解释的，而不是相对于上下文根或服务器根的“虚拟”路径。
</li>
<li>
<strong>包括</strong> - <code><!--#include virtual="file-name" --></code>插入内容。该路径被解释为相对于上下文根或服务器根的“虚拟”路径（取决于<strong>isVirtualWebappRelative</strong>参数）。
</li>
<li>
<strong>flastmod-</strong> <code><!--#flastmod file="filename.shtml" --></code>返回文件的最后修改时间。该路径是相对于使用此伪指令的文档解释的，而不是相对于上下文根或服务器根的“虚拟”路径。
</li>
<li>
<strong>flastmod-</strong> <code><!--#flastmod virtual="filename.shtml" --></code>返回文件的最后修改时间。该路径被解释为相对于上下文根或服务器根的“虚拟”路径（取决于<strong>isVirtualWebappRelative</strong>参数）。
</li>
<li>
<strong>fsize-</strong> <code><!--#fsize file="filename.shtml" --></code>返回文件的大小。该路径是相对于使用此伪指令的文档解释的，而不是相对于上下文根或服务器根的“虚拟”路径。
</li>
<li>
<strong>fsize-</strong> <code><!--#fsize virtual="filename.shtml" --></code>返回文件的大小。该路径被解释为相对于上下文根或服务器根的“虚拟”路径（取决于<strong>isVirtualWebappRelative</strong>参数）。
</li>
<li>
<strong>printenv-</strong> <code><!--#printenv --></code>返回所有已定义变量的列表。
</li>
<li>
<strong>设置</strong> - <code><!--#set var="foo" value="Bar" --></code>用于将值分配给用户定义的变量。
</li>
<li>
<strong>if elif endif else-</strong>用于创建条件部分。例如：<div class="codeBox"><pre><code>&lt;!--#config timefmt="%A" --&gt;
&lt;!--#if expr="$DATE_LOCAL = /Monday/" --&gt;
&lt;p&gt;Meeting at 10:00 on Mondays&lt;/p&gt;
&lt;!--#elif expr="$DATE_LOCAL = /Friday/" --&gt;
&lt;p&gt;Turn in your time card&lt;/p&gt;
&lt;!--#else --&gt;
&lt;p&gt;Yoga class at noon.&lt;/p&gt;
&lt;!--#endif --&gt;</code></pre></div>
</li>
</ul>
<p>有关使用SSI指令的更多信息，请参见<a href="https://httpd.apache.org/docs/howto/ssi.html#basicssidirectives">Apache SSI简介</a> 。</p>
</div><h3 id="Variables">变数</h3><div class="text">
<p>SSI变量通过<b>javax.servlet上的请求属性实现<b>。ServletRequest</b>对象并不限于SSI Servlet。以名称“ java。”，“ javax。”，“ sun”或“ org.apache.catalina.ssi”开头的变量。SSIMediator。”保留，不能使用。
</b></p><b>
<p>SSI servlet当前实现以下变量：</p>
<table class="defaultTable">
<tbody><tr>
<th>变量名</th>
<th>描述</th>
</tr>

<tr>
<td>AUTH_TYPE</td>
<td>用于此用户的身份验证类型：BASIC，FORM等。</td>
</tr>

<tr>
<td>CONTENT_LENGTH</td>
<td>从表单传递的数据长度（字节或字符数）。</td>
</tr>

<tr>
<td>内容类型</td>
<td>查询数据的MIME类型，例如“ text / html”。</td>
</tr>

<tr>
<td>DATE_GMT</td>
<td>格林尼治标准时间的当前日期和时间</td>
</tr>

<tr>
<td>DATE_LOCAL</td>
<td>当地时区的当前日期和时间</td>
</tr>
<tr>
<td>DOCUMENT_NAME</td>
<td>当前文件</td>
</tr>
<tr>
<td>DOCUMENT_URI</td>
<td>文件的虚拟路径</td>
</tr>

<tr>
<td>GATEWAY_INTERFACE</td>
<td>如果启用，服务器使用的通用网关接口的修订：“ CGI / 1.1”。</td>
</tr>

<tr>
<td>HTTP_ACCEPT</td>
<td>客户端可以接受的MIME类型的列表。</td>
</tr>

<tr>
<td>HTTP_ACCEPT_ENCODING</td>
<td>客户端可以接受的压缩类型列表。</td>
</tr>

<tr>
<td>HTTP_ACCEPT_LANGUAGE</td>
<td>客户可以接受的语言列表。</td>
</tr>
<tr>
<td>HTTP_CONNECTION</td>
<td>管理来自客户端的连接的方式：“关闭”或“保持活动”。</td>
</tr>
<tr>
<td>HTTP_HOST</td>
<td>客户请求的网站。</td>
</tr>
<tr>
<td>HTTP_REFERER</td>
<td>客户端链接到的文档的URL。</td>
</tr>
<tr>
<td>HTTP_USER_AGENT</td>
<td>客户端用于发出请求的浏览器。</td>
</tr>
<tr>
<td>上一次更改</td>
<td>当前文件的上次修改日期和时间</td>
</tr>
<tr>
<td>PATH_INFO</td>
<td>传递给servlet的额外路径信息。</td>
</tr>
<tr>
<td>PATH_TRANSLATED</td>
<td>变量PATH_INFO给出的路径的翻译版本。</td>
</tr>
<tr>
<td>请求参数</td>
<td>“？”之后的查询字符串”中的“”。</td>
</tr>
<tr>
<td>QUERY_STRING_UNESCAPED</td>
<td>未解码的查询字符串，其中所有的外壳元字符都以“ \”转义</td>
</tr>
<tr>
<td>REMOTE_ADDR</td>
<td>发出请求的用户的远程IP地址。</td>
</tr>
<tr>
<td>远程主机</td>
<td>发出请求的用户的远程主机名。</td>
</tr>
<tr>
<td>REMOTE_PORT</td>
<td>发出请求的用户的远程IP地址上的端口号。</td>
</tr>
<tr>
<td>REMOTE_USER</td>
<td>用户的身份验证名称。</td>
</tr>
<tr>
<td>REQUEST_METHOD</td>
<td>发出信息请求的方法：“ GET”，“ POST”等。</td>
</tr>
<tr>
<td>REQUEST_URI</td>
<td>客户端最初请求的网页。</td>
</tr>
<tr>
<td>SCRIPT_FILENAME</td>
<td>服务器上当前网页的位置。</td>
</tr>
<tr>
<td>SCRIPT_NAME</td>
<td>网页名称。</td>
</tr>
<tr>
<td>SERVER_ADDR</td>
<td>服务器的IP地址。</td>
</tr>
<tr>
<td>服务器名称</td>
<td>服务器的主机名或IP地址。</td>
</tr>
<tr>
<td>服务器端口</td>
<td>服务器接收请求的端口。</td>
</tr>
<tr>
<td>SERVER_PROTOCOL</td>
<td>服务器使用的协议。例如“ HTTP / 1.1”。</td>
</tr>
<tr>
<td>SERVER_SOFTWARE</td>
<td>响应客户端请求的服务器软件的名称和版本。</td>
</tr>
<tr>
<td>唯一身份</td>
<td>如果已经建立，则用于标识当前会话的令牌。</td>
</tr>
</tbody></table>
</b></div><div class="noprint"><h3 id="comments_section"><b>评论</b></h3><div class="text"><p class="notice"><b><strong>注意：</strong>此注释部分收集有关改进Apache Tomcat文档的建议。<br><br>如果您遇到问题并需要帮助，请阅读“ <a href="https://tomcat.apache.org/findhelp.html">查找帮助”</a>页面，然后在tomcat-users <a href="https://tomcat.apache.org/lists.html">邮件列表中</a>询问您的问题。不要在这里问这样的问题。这不是“问答”部分。<br><br><a href="./comments.html">这里</a>解释<a href="./comments.html">了</a> Apache Comments System。如果评论已被实施或被认为无效/偏离主题，则我们的主持人可能会将其删除。
                  </b></p><div id="comments_thread"></div></div></div></div></div></div></div><footer><div id="footer"><b>版权所有©1999-2019，Apache软件基金会</b></div></footer></div></body></html>