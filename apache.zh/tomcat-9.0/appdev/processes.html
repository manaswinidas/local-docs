<html lang="zh-Hans" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="../images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>应用程序开发人员指南（9.0.21）-开发过程</title><meta name="author" content="Craig R. McClanahan"><script type="application/javascript" data-comments-identifier="tomcat-9.0-doc/appdev/processes">
    "use strict"; // Enable strict mode

    (function() {
      var thisScript = document.currentScript;
      if (!thisScript) { // Workaround for IE <= 11
        var scripts = document.getElementsByTagName("script");
        thisScript = scripts[scripts.length - 1];
      }
      document.addEventListener("DOMContentLoaded", (function() {
        var commentsDiv = document.getElementById("comments_thread");
        var commentsShortname = "tomcat";
        var commentsIdentifier = "https://tomcat.apache.org/" +
          thisScript.getAttribute("data-comments-identifier") + ".html";

        (function(w, d) {
          if (w.location.hostname.toLowerCase() == "tomcat.apache.org") {
            var s = d.createElement("script");
            s.type = "application/javascript";
            s.async = true;
            s.src = "https://comments.apache.org/show_comments.lua?site=" +
              encodeURIComponent(commentsShortname) +
              "&page=" + encodeURIComponent(commentsIdentifier);
            d.head.appendChild(s);
          } else {
            commentsDiv.appendChild(d.createTextNode("Comments are disabled for this page at the moment."));
          }
        })(window, document);
      }), false);
    })();
  </script></head><body ><div id="wrapper"><header><div id="header"><div><div><div class="logo noPrint"><a href="https://tomcat.apache.org/"><img alt="Tomcat主页" src="../images/tomcat.png"></a></div><div style="height:1px"></div><div class="asfLogo noPrint"><a href="https://www.apache.org/" target="_blank"><img src="../images/asf-logo.svg" alt="Apache软件基金会" style="width:266px;height:83px"></a></div><h1>应用程序开发人员指南</h1><div class="versionInfo">版本9.0.21， <time datetime="2019-06-04"> 2019年6月4日</time></div><div style="height:1px"></div><div style="clear:left"></div></div></div></div></header><div id="middle"><div><div id="mainLeft" class="noprint"><div><nav><div><h2>链接</h2><ul><li><a href="../index.html">文件首页</a></li><li><a href="index.html">App开发指南首页</a></li><li><a href="https://wiki.apache.org/tomcat/FAQ">常问问题</a></li><li><a href="#comments_section">用户评论</a></li></ul></div><div><h2>内容</h2><ul><li><a href="index.html">内容</a></li><li><a href="introduction.html">介绍</a></li><li><a href="installation.html">安装</a></li><li><a href="deployment.html">部署方式</a></li><li><a href="source.html">源代码</a></li><li><a href="processes.html">工艺流程</a></li><li><a href="sample/">示例应用</a></li></ul></div></nav></div></div><div id="mainRight"><div id="content"><h2>开发过程</h2><h3 id="Table_of_Contents">目录</h3><div class="text">
<ul><li><a href="#Development_Processes">开发过程</a><ol><li><a href="#One-Time_Setup_of_Ant_and_Tomcat_for_Development">一次性设置Ant和Tomcat进行开发</a></li><li><a href="#Create_Project_Source_Code_Directory">创建项目源代码目录</a></li><li><a href="#Edit_Source_Code_and_Pages">编辑源代码和页面</a></li><li><a href="#Build_the_Web_Application">构建Web应用程序</a></li><li><a href="#Test_Your_Web_Application">测试您的Web应用程序</a></li><li><a href="#Creating_a_Release">创建发布</a></li></ol></li></ul>
</div><h3 id="Development_Processes">开发过程</h3><div class="text">

<p>尽管应用程序开发可以采取多种形式，但本手册提出了使用Tomcat创建Web应用程序的相当通用的过程。以下各节重点介绍您作为代码开发人员将执行的命令和任务。只要您拥有适当的源代码控制系统和内部团队规则（在任何给定时间，谁在处理应用程序的哪些部分），就可以使用相同的基本方法。</p>

<p>下面的任务描述假定您将使用CVS进行源代码控制，并且已经配置了对相应CVS存储库的访问权限。有关说明，超出了本手册的范围。如果使用其他源代码控制环境，则需要找出系统的相应命令。</p>


<div class="subsection"><h4 id="One-Time_Setup_of_Ant_and_Tomcat_for_Development">一次性设置Ant和Tomcat进行开发</h4><div class="text">

<p>为了利用与<em>Manager</em> Web应用程序交互的特殊Ant任务，您需要一次执行以下任务（无论您计划开发多少Web应用程序）。</p>
<ul>
<li><p><em>配置Ant定制任务</em> 。Ant定制任务的实现代码在一个名为JAR的文件中<code>$CATALINA_HOME/lib/catalina-ant.jar</code> ，必须将其复制到<code>lib</code> Ant安装目录。
    </p></li>
<li><p><em>定义一个或多个Tomcat用户</em> 。<em>Manager</em> Web应用程序在安全约束下运行，该约束要求用户登录并具有安全角色<code>manager-script</code>分配给他或她。定义此类用户的方式取决于您在Tomcat的服务器中配置的领域<code>conf/server.xml</code>文件-有关更多信息，请参见<a href="../realm-howto.html">领域配置方法</a> 。您可以使用定义任意数量的用户（使用所需的用户名和密码）。 <code>manager-script</code>角色。
    </p></li>
</ul>

</div></div>


<div class="subsection"><h4 id="Create_Project_Source_Code_Directory">创建项目源代码目录</h4><div class="text">

<p>第一步是创建一个新的项目源目录，并自定义<code>build.xml</code>和<code>build.properties</code>您将使用的文件。目录结构在<a href="source.html">上一节</a>中进行<a href="source.html">了</a>描述，或者您可以将<a href="sample/">示例应用程序</a>用作起点。</p>

<p>创建项目源目录，并在CVS存储库中定义它。这可以通过一系列这样的命令来完成，其中<code>{project}</code>是将项目存储在CVS存储库中的名称，{username}是您的登录用户名：</p>
<div class="codeBox"><pre><code>cd {my home directory}
mkdir myapp &lt;-- Assumed "project source directory"
cd myapp
mkdir docs
mkdir src
mkdir web
mkdir web/WEB-INF
cvs import -m "Initial Project Creation" {project} \
    {username} start</code></pre></div>

<p>现在，要验证它是在CVS中正确创建的，我们将对新项目执行检出：</p>
<div class="codeBox"><pre><code>cd ..
mv myapp myapp.bu
cvs checkout {project}</code></pre></div>

<p>接下来，您将需要创建并签入初始版本的<code>build.xml</code>用于开发的脚本。为了快速而轻松地入门，请根据您的<code>build.xml</code>在本手册随附的<a href="build.xml.txt">基本build.xml文件中</a> ，或从头开始对其进行编码。</p>
<div class="codeBox"><pre><code>cd {my home directory}
cd myapp
emacs build.xml     &lt;-- if you want a real editor :-)
cvs add build.xml
cvs commit</code></pre></div>

<p>在执行CVS提交之前，您的更改位于您自己的开发目录的本地。提交可使那些更改对共享相同CVS存储库的团队中其他开发人员可见。</p>

<p>下一步是自定义，是在指定的Ant <em>属性</em> <code>build.xml</code>脚本。这是通过创建一个名为的文件来完成的<code>build.properties</code>在项目的顶级目录中。受支持的属性在示例内部的注释中列出。 <code>build.xml</code>脚本。至少，您通常需要定义<code>catalina.home</code>属性，定义Tomcat的安装位置以及管理器应用程序的用户名和密码。您可能最终会得到如下结果：</p>
<div class="codeBox"><pre><code># Context path to install this application on
app.path=/hello

# Tomcat installation directory
catalina.home=/usr/local/apache-tomcat-&lt;version-major-minor/&gt;

# Manager webapp username and password
manager.username=myusername
manager.password=mypassword</code></pre></div>

<p>通常，您将<strong>不需要</strong>检查<code>build.properties</code>文件存储到CVS存储库中，因为它对于每个开发人员的环境都是唯一的。</p>

<p>现在，创建Web应用程序部署描述符的初始版本。你可以根据<code>web.xml</code>在<a href="web.xml.txt">基本的web.xml文件上</a> ，或从头开始对其进行编码。</p>
<div class="codeBox"><pre><code>cd {my home directory}
cd myapp/web/WEB-INF
emacs web.xml
cvs add web.xml
cvs commit</code></pre></div>请注意，这只是一个示例web.xml文件。部署描述符文件的完整定义在<a href="https://wiki.apache.org/tomcat/Specifications">Servlet规范中。</a>

</div></div>


<div class="subsection"><h4 id="Edit_Source_Code_and_Pages">编辑源代码和页面</h4><div class="text">

<p>编辑/构建/测试任务通常是开发和维护期间最常见的活动。以下一般原则适用。如“ <a href="source.html">源组织”中所述</a> ，新创建的源文件应位于项目源目录下的相应子目录中。</p>

<p>每当您希望刷新开发目录以反映其他开发人员执行的工作时，您都将要求CVS为您完成：</p>
<div class="codeBox"><pre><code>cd {my home directory}
cd myapp
cvs update -dP</code></pre></div>

<p>要创建一个新文件，请转到相应的目录，创建文件，然后在CVS中注册它。对内容满意后（在构建和测试成功之后），将新文件提交到存储库。例如，要创建一个新的JSP页面：</p>
<div class="codeBox"><pre><code>cd {my home directory}
cd myapp/web        &lt;-- Ultimate destination is document root
emacs mypage.jsp
cvs add mypage.jsp
... build and test the application ...
cvs commit</code></pre></div>

<p>软件包中定义的Java源代码必须按照与软件包名称匹配的目录层次结构（在<strong>src /</strong>子目录下）进行组织。例如，一个名为<code>com.mycompany.mypackage.MyClass.java</code>应该存储在文件中<code>src/com/mycompany/mypackage/MyClass.java</code> 。每当您创建一个新的子目录时，请不要忘记在CVS中注册它。</p>

<p>要编辑现有的源文件，通常只需开始编辑和测试，然后在一切正常的情况下提交更改的文件。尽管可以将CVS配置为要求您“签出”或“锁定”要修改的文件，但是通常不使用。</p>

</div></div>


<div class="subsection"><h4 id="Build_the_Web_Application">构建Web应用程序</h4><div class="text">

<p>准备好编译应用程序时，发出以下命令（通常，您需要打开一个设置为项目源目录的shell窗口，以便仅需要最后一个命令）：</p>
<div class="codeBox"><pre><code>cd {my home directory}
cd myapp        &lt;-- Normally leave a window open here
ant</code></pre></div>

<p>Ant工具将执行您的默认“编译”目标<code>build.xml</code>文件，它将编译任何新的或更新的Java代码。如果这是您在“构建清理”之后第一次进行编译，则将导致重新编译所有内容。</p>

<p>要强制重新编译整个应用程序，请执行以下操作：</p>
<div class="codeBox"><pre><code>cd {my home directory}
cd myapp
ant all</code></pre></div>

<p>在检查更改之前，这是一个很好的习惯，以确保您没有引入Javac条件检查没有发现的任何细微问题。</p>

</div></div>


<div class="subsection"><h4 id="Test_Your_Web_Application">测试您的Web应用程序</h4><div class="text">

<p>要测试您的应用程序，您需要将其安装在Tomcat下。最快的方法是使用样本中包含的定制Ant任务<code>build.xml</code>脚本。使用这些命令可能遵循以下模式：</p>
<ul>
<li><p><em>如果需要，启动Tomcat</em> 。如果Tomcat尚未运行，则需要以通常的方式启动它。
    </p></li>
<li><p><em>编译您的应用程序</em> 。使用<code>ant compile</code>命令（或仅<code>ant</code> ，因为这是默认设置）。确保没有编译错误。
    </p></li>
<li><p><em>安装应用程序</em> 。使用<code>ant install</code>命令。这告诉Tomcat立即在以下路径中定义的上下文路径上开始运行您的应用程序： <code>app.path</code>建立财产。Tomcat <strong>不</strong>具有重新启动，这才会生效。
    </p></li>
<li><p><em>测试应用程序</em> 。使用浏览器或其他测试工具，测试应用程序的功能。
    </p></li>
<li><p><em>根据需要修改和重建</em> 。当您发现需要更改时，请在原始<strong>源</strong>文件中而不是在输出构建目录中进行更改，然后重新发出<code>ant compile</code>命令。这样可以确保您的更改可以保存（通过<code>cvs commit</code> ）-删除输出构建目录并根据需要重新创建。
    </p></li>
<li><p><em>重新加载应用程序</em> 。Tomcat将自动识别JSP页面中的更改，但是它将继续使用任何servlet或JavaBean类的旧版本，直到重新加载应用程序为止。您可以通过执行<code>ant reload</code>命令。
    </p></li>
<li><p><em>完成后删除该应用程序</em> 。当您处理此应用程序时，可以通过运行<code>ant remove</code>命令。
    </p></li>
</ul>

<p>完成测试后，请不要忘记将更改提交到源代码存储库！</p>

</div></div>


<div class="subsection"><h4 id="Creating_a_Release">创建发布</h4><div class="text">

<p>当您通过添加新功能并且已经对所有内容进行了测试（您可以进行测试，而不是:-）时，就该创建可以在生产服务器上部署的Web应用程序的可分发版本。需要执行以下常规步骤：</p>
<ul>
<li><p>发出命令<code>ant all</code>从项目源目录重新构建所有内容。
    </p></li>
<li><p>使用<code>cvs tag</code>命令创建用于创建此发行版的所有源文件的标识符。这使您可以在以后可靠地重建发布（从源）。
    </p></li>
<li><p>发出命令<code>ant dist</code>创建可分发的Web应用程序归档（WAR）文件以及包含相应源代码的JAR文件。
    </p></li>
<li><p>打包内容<code>dist</code>根据组织使用的标准发布过程，使用<strong>tar</strong>或<strong>zip</strong>实用程序创建目录。
    </p></li>
</ul>

</div></div>


</div><div class="noprint"><h3 id="comments_section">评论</h3><div class="text"><p class="notice"><strong>注意：</strong>此注释部分收集有关改进Apache Tomcat文档的建议。<br><br>如果您遇到问题并需要帮助，请阅读“ <a href="https://tomcat.apache.org/findhelp.html">查找帮助”</a>页面，然后在tomcat-users <a href="https://tomcat.apache.org/lists.html">邮件列表中</a>询问您的问题。不要在这里问这样的问题。这不是“问答”部分。<br><br><a href="../comments.html">这里</a>解释<a href="../comments.html">了</a> Apache Comments System。如果评论已被实施或被认为无效/偏离主题，则我们的主持人可能会将其删除。
                  </p><div id="comments_thread"></div></div></div></div></div></div></div><footer><div id="footer">版权所有©1999-2019，Apache软件基金会</div></footer></div></body></html>