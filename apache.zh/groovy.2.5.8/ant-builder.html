<html lang="zh-Hans" ><head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>蚂蚁建筑</title>
<link rel="stylesheet" href="./assets/css/style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
</head>
<body class="book" >
<div id="header">
<h1>蚂蚁建筑</h1>
<div class="details">
<span id="revnumber">版本2.5.8</span>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>尽管<a href="http://ant.apache.org/">Apache Ant</a>主要是一个构建工具，但它却是一个非常实用的工具，用于处理文件，包括zip文件，副本，资源处理等。但是，如果您曾经使用过<code>build.xml</code>文件或某些<em>Jelly脚本</em> ，发现自己受到所有尖括号的限制，或者使用XML作为脚本语言发现它有点怪异，并且想要更简洁，更直接的方法，那么也许使用Groovy编写Ant脚本可能就是你所需要的之后。</p>
</div>
<div class="paragraph">
<p>Groovy有一个名为的帮助器类<code>AntBuilder</code>这使得Ant任务的脚本编写非常容易；允许将真正的脚本语言用于编程构造（变量，方法，循环，逻辑分支，类等）。看起来仍然像Ant的XML的简洁版本，没有那些尖括号。尽管您可以在脚本中混合并匹配此标记。Ant本身是jar文件的集合。通过将它们添加到您的类路径中，您可以轻松地在Groovy中直接使用它们。我们相信使用<code>AntBuilder</code>导致更简洁和易于理解的语法。</p>
</div>
<div class="paragraph">
<p><code>AntBuilder</code>使用我们在Groovy中习惯的便捷构建器符号直接公开Ant任务。这是最基本的示例，它在标准输出上打印一条消息：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def ant = new AntBuilder()          <i class="conum" data-value="1"></i><b>(1)</b>
ant.echo('hello from Ant!')         <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i> <b>1个</b></td>
<td>创建一个实例<code>AntBuilder</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i> <b>2</b></td>
<td>执行<code>echo</code>参数中包含消息的任务</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>假设您需要创建一个ZIP文件。它可以很简单：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def ant = new AntBuilder()
ant.zip(destfile: 'sources.zip', basedir: 'src')</code></pre>
</div>
</div>
<div class="paragraph">
<p>在下一个示例中，我们演示了<code>AntBuilder</code>直接在Groovy中使用经典Ant模式复制文件列表：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// let's just call one task
ant.echo("hello")

// here is an example of a block of Ant inside GroovyMarkup
ant.sequential {
    echo("inside sequential")
    def myDir = "target/AntTest/"
    mkdir(dir: myDir)
    copy(todir: myDir) {
        fileset(dir: "src/test") {
            include(name: "**/*.groovy")
        }
    }
    echo("done")
}

// now let's do some normal Groovy again
def file = new File(ant.project.baseDir,"target/AntTest/some/pkg/MyTest.groovy")
assert file.exists()</code></pre>
</div>
</div>
<div class="paragraph">
<p>另一个示例是遍历匹配特定模式的文件列表：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// let's create a scanner of filesets
def scanner = ant.fileScanner {
    fileset(dir:"src/test") {
        include(name:"**/My*.groovy")
    }
}

// now let's iterate over
def found = false
for (f in scanner) {
    println("Found file $f")
    found = true
    assert f instanceof File
    assert f.name.endsWith(".groovy")
}
assert found</code></pre>
</div>
</div>
<div class="paragraph">
<p>或执行JUnit测试：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ant.junit {
    classpath { pathelement(path: '.') }
    test(name:'some.pkg.MyTest')
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>我们甚至可以通过直接从Groovy编译并执行Java文件来进一步操作：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ant.echo(file:'Temp.java', '''
    class Temp {
        public static void main(String[] args) {
            System.out.println("Hello");
        }
    }
''')
ant.javac(srcdir:'.', includes:'Temp.java', fork:'true')
ant.java(classpath:'.', classname:'Temp', fork:'true')
ant.echo('Done')</code></pre>
</div>
</div>
<div class="paragraph">
<p>值得一提的是<code>AntBuilder</code>包含在<a href="http://gradle.org/">Gradle中</a> ，因此您可以像在Groovy中一样在Gradle中使用它。其他文档可以在<a href="http://gradle.org/docs/current/userguide/ant.html">Gradle手册中</a>找到。</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">版本2.5.8<br>最近更新时间2019-08-02 18:30:30 UTC</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>

</body></html>