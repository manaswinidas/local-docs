<html lang="zh-Hans" ><head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>葡萄的依赖管理</title>
<link rel="stylesheet" href="./assets/css/style.css">
<link rel="stylesheet" href="asset?aid=2">
</head>
<body id="section-grape" class="book toc2 toc-left" >
<div id="header">
<h1>葡萄的依赖管理</h1>
<div class="details">
<span id="revnumber">版本2.5.8</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">目录</div>
<ul class="sectlevel1">
<li><a href="#_quick_start">1。快速开始</a>
<ul class="sectlevel2">
<li><a href="#_add_a_dependency">1.1。添加依赖</a></li>
<li><a href="#Grape-SpecifyAdditionalRepositories">1.2。指定其他存储库</a></li>
<li><a href="#Grape-MavenClassifiers">1.3。Maven分类器</a></li>
<li><a href="#Grape-ExcludingTransitiveDependencies">1.4。排除传递依存关系</a></li>
<li><a href="#Grape-JDBCDrivers">1.5。JDBC驱动程序</a></li>
<li><a href="#Grape-UsingGrapeFromtheGroovyShell">1.6。从Groovy Shell使用葡萄</a></li>
<li><a href="#Grape-Proxysettings">1.7。代理设定</a></li>
<li><a href="#Grape-Logging">1.8。记录中</a></li>
</ul>
</li>
<li><a href="#Grape-Detail">2。详情</a></li>
<li><a href="#Grape-Usage">3。用法</a>
<ul class="sectlevel2">
<li><a href="#Grape-Annotation">3.1。注解</a></li>
<li><a href="#Grape-MultipleGrapeAnnotations">3.2。多个葡萄注释</a></li>
<li><a href="#Grape-Methodcall">3.3。方法调用</a>
<ul class="sectlevel3">
<li><a href="#Grape-grabHashMapParameters">3.3.1。 GC（HashMap）参数</a></li>
<li><a href="#Grape-ArgumentsMaparguments">3.3.2。参数图参数</a></li>
</ul>
</li>
<li><a href="#Grape-CommandLineTool">3.4。命令行工具</a></li>
<li><a href="#Grape-Advancedconfiguration">3.5。进阶设定</a>
<ul class="sectlevel3">
<li><a href="#Grape-RepositoryDirectory">3.5.1。资料库目录</a></li>
<li><a href="#Grape-CustomizeIvysettings">3.5.2。自定义常春藤设置</a></li>
</ul>
</li>
<li><a href="#Grape-MoreExamples">3.6。更多例子</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_quick_start"><a class="anchor" href="#_quick_start"></a> 1。快速开始</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_add_a_dependency"><a class="anchor" href="#_add_a_dependency"></a> 1.1。添加依赖</h3>
<div class="paragraph">
<p>Grape是Groovy中嵌入的JAR依赖项管理器。Grape使您可以快速将maven存储库依赖项添加到类路径中，从而使脚本编写变得更加容易。最简单的用法就像在脚本中添加注释一样简单：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">@Grab(group='org.springframework', module='spring-orm', version='3.2.5.RELEASE')
import org.springframework.jdbc.core.JdbcTemplate</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@Grab</code>还支持一种简写形式：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">@Grab('org.springframework:spring-orm:3.2.5.RELEASE')
import org.springframework.jdbc.core.JdbcTemplate</code></pre>
</div>
</div>
<div class="paragraph">
<p>请注意，我们在这里使用带注释的导入，这是推荐的方法。您也可以搜索依赖于<a href="http://mvnrepository.com">mvnrepository.com</a> ，它会为您提供<code>@Grab</code>的注释形式<code>pom.xml</code>条目。</p>
</div>
</div>
<div class="sect2">
<h3 id="Grape-SpecifyAdditionalRepositories"><a class="anchor" href="#Grape-SpecifyAdditionalRepositories"></a> 1.2。指定其他存储库</h3>
<div class="paragraph">
<p>并非所有依赖项都在Maven Central中。您可以像这样添加新的：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">@GrabResolver(name='restlet', root='http://maven.restlet.org/')
@Grab(group='org.restlet', module='org.restlet', version='1.1.6')</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Grape-MavenClassifiers"><a class="anchor" href="#Grape-MavenClassifiers"></a> 1.3。Maven分类器</h3>
<div class="paragraph">
<p>一些Maven依赖项需要分类器才能解析。您可以这样解决：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">@Grab(group='net.sf.json-lib', module='json-lib', version='2.2.3', classifier='jdk15')</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Grape-ExcludingTransitiveDependencies"><a class="anchor" href="#Grape-ExcludingTransitiveDependencies"></a> 1.4。排除传递依存关系</h3>
<div class="paragraph">
<p>有时您可能想排除传递依赖，因为您可能已经在使用某些工件的稍有不同但兼容的版本。您可以按照以下步骤进行操作：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">@Grab('net.sourceforge.htmlunit:htmlunit:2.8')
@GrabExclude('xml-apis:xml-apis')</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Grape-JDBCDrivers"><a class="anchor" href="#Grape-JDBCDrivers"></a> 1.5。JDBC驱动程序</h3>
<div class="paragraph">
<p>由于JDBC驱动程序的加载方式，您需要配置Grape以将JDBC驱动程序依赖项附加到系统类加载器。即：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">@GrabConfig(systemClassLoader=true)
@Grab(group='mysql', module='mysql-connector-java', version='5.1.6')</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Grape-UsingGrapeFromtheGroovyShell"><a class="anchor" href="#Grape-UsingGrapeFromtheGroovyShell"></a> 1.6。从Groovy Shell使用葡萄</h3>
<div class="paragraph">
<p>从groovysh使用方法调用变量：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">groovy.grape.Grape.grab(group:'org.springframework', module:'spring', version:'2.5.6')</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Grape-Proxysettings"><a class="anchor" href="#Grape-Proxysettings"></a> 1.7。代理设定</h3>
<div class="paragraph">
<p>如果您位于防火墙后面和/或需要通过代理服务器使用Groovy / Grape，则可以在命令中指定这些设置，例如通过<code>http.proxyHost</code>和<code>http.proxyPort</code>系统属性：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>groovy -Dhttp.proxyHost=yourproxy -Dhttp.proxyPort=8080 yourscript.groovy</pre>
</div>
</div>
<div class="paragraph">
<p>或者，您可以通过将以下属性添加到您的JAVA_OPTS环境变量来使该系统更广泛：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>JAVA_OPTS = -Dhttp.proxyHost=yourproxy -Dhttp.proxyPort=8080</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Grape-Logging"><a class="anchor" href="#Grape-Logging"></a> 1.8。记录中</h3>
<div class="paragraph">
<p>如果要查看Grape正在做什么，请设置系统属性<code>groovy.grape.report.downloads</code>至<code>true</code> （例如，添加<code>-Dgroovy.grape.report.downloads=true</code>调用或JAVA_OPTS），Grape会将以下信息打印到System.error中：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>开始解决依赖关系</p>
</li>
<li>
<p>开始下载工件</p>
</li>
<li>
<p>重试下载工件</p>
</li>
<li>
<p>下载工件的下载大小和时间</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>要更详细地记录日志，请增加常春藤日志级别（默认为<code>-1</code> ）。例如<code>-Divy.message.logger.level=4</code> 。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Grape-Detail"><a class="anchor" href="#Grape-Detail"></a> 2。详情</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Grape（ <em>Groovy自适应包装引擎</em>或<em>Groovy高级包装引擎</em> ）是支持Groovy中的catch（）调用的基础结构，Groovy是利用<a href="http://ant.apache.org/ivy/">Ivy</a>来为Groovy进行存储库驱动的模块系统的一组类。这使开发人员可以编写具有本质上任意库要求的脚本，然后仅交付该脚本。当脚本从现有的存储库（例如JCenter，Ibiblio和java.net）运行时，Grape将在运行时根据需要下载并链接命名的库和所有依赖项，从而形成一个传递闭包。</p>
</div>
<div class="paragraph">
<p>Grape遵循Ivy约定进行模块版本识别，但命名有所更改。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>group</code> -模块来自哪个模块组。直接转换为Maven groupId或Ivy Organization。任何组匹配<code>/groovy[x][\..*]^/</code>保留，并且对Groovy认可的模块可能有特殊含义。</p>
</li>
<li>
<p><code>module</code> -要加载的模块的名称。直接转换为Maven工件ID或Ivy工件。</p>
</li>
<li>
<p><code>version</code> -要使用的模块版本。文字版本“ 1.1-RC3”或常春藤范围“ [2.2.1，）”（意味着2.2.1或更高版本）。</p>
</li>
<li>
<p><code>classifier</code> -要使用的可选分类器（例如<em>jdk15</em> ）</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>下载的模块将根据Ivy的标准机制存储，缓存根目录为<code>~/.groovy/grapes</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Grape-Usage"><a class="anchor" href="#Grape-Usage"></a> 3。用法</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="Grape-Annotation"><a class="anchor" href="#Grape-Annotation"></a> 3.1。注解</h3>
<div class="paragraph">
<p>一个或多个<code>groovy.lang.Grab</code>可以在接受注释的任何位置添加注释，以告知编译器此代码依赖于特定的库。这将具有将库添加到groovy编译器的类加载器的效果。该注释在脚本中的类的任何其他解析之前都会被检测和评估，因此导入的类可以由脚本正确解析。 <code>@Grab</code>注解。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import com.jidesoft.swing.JideSplitButton
@Grab(group='com.jidesoft', module='jide-oss', version='[2.2.1,2.3.0)')
public class TestClassAnnotation {
    public static String testMethod () {
        return JideSplitButton.class.name
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>一个合适的<code>grab(…​)</code>调用将被添加到包含类（或带注释的脚本元素的脚本类）的类的静态初始化器中。</p>
</div>
</div>
<div class="sect2">
<h3 id="Grape-MultipleGrapeAnnotations"><a class="anchor" href="#Grape-MultipleGrapeAnnotations"></a> 3.2。多个葡萄注释</h3>
<div class="paragraph">
<p>在Groovy的早期版本中，如果要在同一节点上多次使用Grab批注，则必须使用<code>@Grapes</code>注释，例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">@Grapes([
   @Grab(group='commons-primitives', module='commons-primitives', version='1.0'),
   @Grab(group='org.ccil.cowan.tagsoup', module='tagsoup', version='0.9.7')])
class Example {
// ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>否则，您将遇到以下错误：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Cannot specify duplicate annotation on the same member</pre>
</div>
</div>
<div class="paragraph">
<p>但是在最新版本中，@ Grapes完全是可选的。</p>
</div>
<div class="paragraph">
<p>技术说明：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>最初，Groovy存储了Grab批注以在运行时进行访问，并且字节码中不允许重复。在当前版本中，@ Grab仅具有SOURCE保留，因此不会出现多次问题。</p>
</li>
<li>
<p>Grape的未来版本可能会支持使用Grapes批注提供一定程度的结构化，例如，允许GrabExclude或GrabResolver批注仅应用于Grab批注的子集。</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Grape-Methodcall"><a class="anchor" href="#Grape-Methodcall"></a> 3.3。方法调用</h3>
<div class="paragraph">
<p>通常，在脚本或类初始化的早期会发生抢夺调用。这是为了确保在常规代码依赖该代码之前，这些库可用于ClassLoader。几个典型的呼叫可能如下所示：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import groovy.grape.Grape
// random maven library
Grape.grab(group:'com.jidesoft', module:'jide-oss', version:'[2.2.0,)')
Grape.grab([group:'org.apache.ivy', module:'ivy', version:'2.0.0-beta1', conf:['default', 'optional']],
     [group:'org.apache.ant', module:'ant', version:'1.7.0'])</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>在同一个上下文中使用相同参数进行多次调用应该是幂等的。但是，如果使用不同的代码调用相同的代码<code>ClassLoader</code>然后可以重新运行解决方案。</p>
</li>
<li>
<p>如果<code>args</code>地图传递到<code>grab</code>通话具有属性<code>noExceptions</code>评估为true不会抛出异常。</p>
</li>
<li>
<p><code>grab</code>要求<code>RootLoader</code>要么<code>GroovyClassLoader</code>被指定或位于<code>ClassLoader</code>调用类的链。默认情况下没有这样的<code>ClassLoader</code>可用将导致模块解析并引发异常</p>
<div class="ulist">
<ul>
<li>
<p>通过传入的ClassLoader <code>classLoader:</code>参数，它是父类加载器。</p>
</li>
<li>
<p>对象的ClassLoader作为<code>referenceObject:</code>参数，它是父类加载器。</p>
</li>
<li>
<p>发出调用的类的ClassLoader<code>grab</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="Grape-grabHashMapParameters"><a class="anchor" href="#Grape-grabHashMapParameters"></a> 3.3.1。 GC（HashMap）参数</h4>
<div class="ulist">
<ul>
<li>
<p><code>group:</code> -- <string>模块来自哪个模块组。直接转换为Maven groupId。任何组匹配<code>/groovy(|\..|x|x\..)/</code>保留，并且对Groovy认可的模块可能有特殊含义。</string></p>
</li>
<li>
<p><code>module:</code> -- <string>要加载的模块的名称。直接转换为MavenartifactId。</string></p>
</li>
<li>
<p><code>version:</code> - <string>可能<range>-使用的模块版本。文字版本“ 1.1-RC3”或常春藤范围“ [2.2.1，）”（意味着2.2.1或更高版本）。</range></string></p>
</li>
<li>
<p><code>classifier:</code> -- <string>要解决的Maven分类器。</string></p>
</li>
<li>
<p><code>conf:</code> - <string>，默认<code>default' - The configuration or scope of the module to download. The default conf is `default:</code>映射到行家<code>runtime</code>和<code>master</code>范围。</string></p>
</li>
<li>
<p><code>force:</code> - <boolean>，默认为true-用于表示此版本必须在发生冲突的情况下使用，独立于</boolean></p>
</li>
<li>
<p>冲突经理</p>
</li>
<li>
<p><code>changing:</code> - <boolean>，默认为false-如果不更改版本名称，工件是否可以更改。</boolean></p>
</li>
<li>
<p><code>transitive:</code> - <boolean>，默认为true-是否解析此模块具有的其他依赖项。</boolean></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>有两个主要变体<code>grab</code> ，一个带有一个Map，一个带有一个参数Map和多个依赖关系的map。调用单个映射争夺与调用两次传入同一映射的争夺相同，因此可以在同一映射中混合争夺参数和依赖项，并且可以将其作为具有命名参数的单个方法来调用。</p>
</div>
<div class="paragraph">
<p>这些参数有同义词。提交多个是运行时异常。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>group:</code> ， <code>groupId:</code> ， <code>organisation:</code> ， <code>organization:</code> ，<code>org:</code></p>
</li>
<li>
<p><code>module:</code> ， <code>artifactId:</code> ，<code>artifact:</code></p>
</li>
<li>
<p><code>version:</code> ， <code>revision:</code> ，<code>rev:</code></p>
</li>
<li>
<p><code>conf:</code> ， <code>scope:</code> ，<code>configuration:</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="Grape-ArgumentsMaparguments"><a class="anchor" href="#Grape-ArgumentsMaparguments"></a> 3.3.2。参数图参数</h4>
<div class="ulist">
<ul>
<li>
<p><code>classLoader:</code> - <groovyclasslaoder>或<rootclassloader>-用于将解析的Jar添加到的ClassLoader</rootclassloader></groovyclasslaoder></p>
</li>
<li>
<p><code>refObject:</code> -- <object>与对象类最接近的父类ClassLoader将被视为传入<code>classLoader:</code></object></p>
</li>
<li>
<p><code>validate:</code> - <boolean>，默认为false-应该验证poms或常春藤文件（true），还是我们应该信任缓存（false）。</boolean></p>
</li>
<li>
<p><code>noExceptions:</code> - <boolean>，默认为false-如果ClassLoader解析或存储库查询失败，我们应该抛出异常（false）还是静默失败（true）。</boolean></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Grape-CommandLineTool"><a class="anchor" href="#Grape-CommandLineTool"></a> 3.4。命令行工具</h3>
<div class="paragraph">
<p>葡萄增加了一个命令行可执行文件“葡萄”，它可以检查和管理本地葡萄缓存。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grape install [-hv] &lt;group&gt; &lt;module&gt; [&lt;version&gt;] [&lt;classifier&gt;]</pre>
</div>
</div>
<div class="paragraph">
<p>这将安装指定的groovy模块或Maven构件。如果指定了版本，则将安装特定版本，否则将使用最新版本（就像我们传入的“ *”一样）。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grape list</pre>
</div>
</div>
<div class="paragraph">
<p>列出本地安装的模块（对于groovy模块，使用完整的maven名称）和版本。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grape resolve [-adhisv] (&lt;groupId&gt; &lt;artifactId&gt; &lt;version&gt;)+</pre>
</div>
</div>
<div class="paragraph">
<p>这将返回jar的文件位置，这些jar表示指定模块的构件以及相应的传递依赖项。您可以选择传入-ant，-dos或-shell以获取分别以适用于ant脚本，Windows批处理文件或unix shell脚本的格式表示的依赖性。可以传递-ivy以查看以常春藤格式表示的依赖项。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grape uninstall [-hv] &lt;group&gt; &lt;module&gt; &lt;version&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>这将卸载特定的葡萄：它以非过渡方式从葡萄缓存中删除相应的jar文件。</p>
</div>
</div>
<div class="sect2">
<h3 id="Grape-Advancedconfiguration"><a class="anchor" href="#Grape-Advancedconfiguration"></a> 3.5。进阶设定</h3>
<div class="sect3">
<h4 id="Grape-RepositoryDirectory"><a class="anchor" href="#Grape-RepositoryDirectory"></a> 3.5.1。资料库目录</h4>
<div class="paragraph">
<p>如果需要更改grape用于下载库的目录，则可以指定grape.root系统属性以更改默认值（〜/ .groovy / grapes）</p>
</div>
<div class="listingblock">
<div class="content">
<pre>groovy -Dgrape.root=/repo/grapes yourscript.groovy</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Grape-CustomizeIvysettings"><a class="anchor" href="#Grape-CustomizeIvysettings"></a> 3.5.2。自定义常春藤设置</h4>
<div class="paragraph">
<p>您可以通过创建〜/ .groovy / grapeConfig.xml文件来自定义Grape使用的ivy设置。如果不存在这样的文件，那么<a href="https://github.com/apache/groovy/blob/master/src/resources/groovy/grape/defaultGrapeConfig.xml">这</a>是Grape使用的默认设置。</p>
</div>
<div class="paragraph">
<p>有关如何自定义这些设置的更多信息，请参阅<a href="https://ant.apache.org/ivy/history/latest-milestone/index.html">Ivy文档</a> 。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Grape-MoreExamples"><a class="anchor" href="#Grape-MoreExamples"></a> 3.6。更多例子</h3>
<div class="paragraph">
<p>使用Apache Commons Collections：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// create and use a primitive array list
@Grab(group='commons-primitives', module='commons-primitives', version='1.0')
import org.apache.commons.collections.primitives.ArrayIntList

def createEmptyInts() { new ArrayIntList() }

def ints = createEmptyInts()
ints.add(0, 42)
assert ints.size() == 1
assert ints.get(0) == 42</code></pre>
</div>
</div>
<div class="paragraph">
<p>使用TagSoup：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// find the PDF links of the Java specifications
@Grab(group='org.ccil.cowan.tagsoup', module='tagsoup', version='1.2.1')
def getHtml() {
    def parser = new XmlParser(new org.ccil.cowan.tagsoup.Parser())
    parser.parse("https://docs.oracle.com/javase/specs/")
}
html.body.'**'.a.@href.grep(~/.*\.pdf/).each{ println it }</code></pre>
</div>
</div>
<div class="paragraph">
<p>使用Google收藏集：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import com.google.common.collect.HashBiMap
@Grab(group='com.google.code.google-collections', module='google-collect', version='snapshot-20080530')
def getFruit() { [grape:'purple', lemon:'yellow', orange:'orange'] as HashBiMap }
assert fruit.lemon == 'yellow'
assert fruit.inverse().yellow == 'lemon'</code></pre>
</div>
</div>
<div class="paragraph">
<p>启动Jetty服务器以提供Groovy模板：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">@Grab('org.eclipse.jetty.aggregate:jetty-server:8.1.19.v20160209')
@Grab('org.eclipse.jetty.aggregate:jetty-servlet:8.1.19.v20160209')
@Grab('javax.servlet:javax.servlet-api:3.0.1')
import org.eclipse.jetty.server.Server
import org.eclipse.jetty.servlet.ServletContextHandler
import groovy.servlet.TemplateServlet

def runServer(duration) {
    def server = new Server(8080)
    def context = new ServletContextHandler(server, "/", ServletContextHandler.SESSIONS)
    context.resourceBase = "."
    context.addServlet(TemplateServlet, "*.gsp")
    server.start()
    sleep duration
    server.stop()
}

runServer(10000)</code></pre>
</div>
</div>
<div class="paragraph">
<p>在此脚本首次启动时，Grape将下载Jetty及其依赖项，并将其缓存。我们在端口8080上创建了一个新的Jetty服务器，然后在上下文的根目录下公开Groovy的TemplateServlet-Groovy带有其自身强大的模板引擎机制。我们启动服务器，并使其运行一定时间。每次有人访问http：// localhost：8080 / somepage.gsp时，都会向用户显示somepage.gsp模板-这些模板页面应与此服务器脚本位于同一目录中。</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">版本2.5.8<br>最近更新时间2019-08-02 18:30:30 UTC</div>
</div>
<link rel="stylesheet" href="asset?aid=3">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>

</body></html>