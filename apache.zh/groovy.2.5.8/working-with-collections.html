<html lang="zh-Hans" ><head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>使用收藏</title>
<link rel="stylesheet" href="./assets/css/style.css">
<link rel="stylesheet" href="asset?aid=2">
</head>
<body class="book toc2 toc-left" >
<div id="header">
<h1>使用收藏</h1>
<div class="details">
<span id="revnumber">版本2.5.8</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">目录</div>
<ul class="sectlevel1">
<li><a href="#Collections-Lists">1。清单</a>
<ul class="sectlevel2">
<li><a href="#_list_literals">1.1。列出文字</a></li>
<li><a href="#_list_as_a_boolean_expression">1.2。以布尔表达式形式列出</a></li>
<li><a href="#_iterating_on_a_list">1.3。迭代列表</a></li>
<li><a href="#_manipulating_lists">1.4。操作清单</a>
<ul class="sectlevel3">
<li><a href="#List-Filtering">1.4.1。筛选和搜索</a></li>
<li><a href="#_adding_or_removing_elements">1.4.2。添加或删除元素</a></li>
<li><a href="#_set_operations">1.4.3。设定操作</a></li>
<li><a href="#_sorting">1.4.4。排序</a></li>
<li><a href="#_duplicating_elements">1.4.5。复制元素</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#Collections-Maps">2。地图</a>
<ul class="sectlevel2">
<li><a href="#_map_literals">2.1。地图文字</a></li>
<li><a href="#_map_property_notation">2.2。地图属性符号</a></li>
<li><a href="#_iterating_on_maps">2.3。在地图上迭代</a></li>
<li><a href="#_manipulating_maps">2.4。操纵地图</a>
<ul class="sectlevel3">
<li><a href="#_adding_or_removing_elements_2">2.4.1。添加或删除元素</a></li>
<li><a href="#JN1035-Maps-Collectionviewsofamap">2.4.2。键，值和条目</a></li>
<li><a href="#_filtering_and_searching">2.4.3。筛选和搜索</a></li>
<li><a href="#Maps-Grouping">2.4.4。分组</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#Collections-Ranges">3。范围</a></li>
<li><a href="#_syntax_enhancements_for_collections">4。集合的语法增强</a>
<ul class="sectlevel2">
<li><a href="#_gpath_support">4.1。GPath支持</a></li>
<li><a href="#_spread_operator">4.2。点差运算符</a></li>
<li><a href="#Collections-Gettingefficientwiththestar-dotoperator">4.3。星点“ *”。算子</a></li>
<li><a href="#Collections-Slicingwiththesubscriptoperator">4.4。下标运算符切片</a></li>
</ul>
</li>
<li><a href="#Collections-EnhancedCollectionMethods">5，增强的收集方法</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Groovy为各种集合类型提供本地支持，包括<a href="#Collections-Lists">列表</a> ， <a href="#Collections-Maps">地图</a>或<a href="#Collections-Ranges">范围</a> 。其中大多数基于Java集合类型，并以<a href="http://www.groovy-lang.org/gdk.html">Groovy开发工具包</a>中的其他方法修饰。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Collections-Lists"><a class="anchor" href="#Collections-Lists"></a> 1。清单</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_list_literals"><a class="anchor" href="#_list_literals"></a> 1.1。列出文字</h3>
<div class="paragraph">
<p>您可以如下创建列表。注意<code>[]</code>是空列表表达式。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def list = [5, 6, 7, 8]
assert list.get(2) == 7
assert list[2] == 7
assert list instanceof java.util.List

def emptyList = []
assert emptyList.size() == 0
emptyList.add(5)
assert emptyList.size() == 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>每个列表表达式都会创建<a href="http://docs.oracle.com/javase/8/docs/api/java/util/List.html">java.util的实现</a><a href="http://docs.oracle.com/javase/8/docs/api/java/util/List.html">。清单</a> 。</p>
</div>
<div class="paragraph">
<p>当然，列表可以用作构建另一个列表的源：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def list1 = ['a', 'b', 'c']
//construct a new list, seeded with the same items as in list1
def list2 = new ArrayList&lt;String&gt;(list1)

assert list2 == list1 // == checks that each corresponding element is the same

// clone() can also be called
def list3 = list1.clone()
assert list3 == list1</code></pre>
</div>
</div>
<div class="paragraph">
<p>列表是对象的有序集合：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def list = [5, 6, 7, 8]
assert list.size() == 4
assert list.getClass() == ArrayList     // the specific kind of list being used

assert list[2] == 7                     // indexing starts at 0
assert list.getAt(2) == 7               // equivalent method to subscript operator []
assert list.get(2) == 7                 // alternative method

list[2] = 9
assert list == [5, 6, 9, 8,]           // trailing comma OK

list.putAt(2, 10)                       // equivalent method to [] when value being changed
assert list == [5, 6, 10, 8]
assert list.set(2, 11) == 10            // alternative method that returns old value
assert list == [5, 6, 11, 8]

assert ['a', 1, 'a', 'a', 2.5, 2.5f, 2.5d, 'hello', 7g, null, 9 as byte]
//objects can be of different types; duplicates allowed

assert [1, 2, 3, 4, 5][-1] == 5             // use negative indices to count from the end
assert [1, 2, 3, 4, 5][-2] == 4
assert [1, 2, 3, 4, 5].getAt(-2) == 4       // getAt() available with negative index...
try {
    [1, 2, 3, 4, 5].get(-2)                 // but negative index not allowed with get()
    assert false
} catch (e) {
    assert e instanceof IndexOutOfBoundsException
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_list_as_a_boolean_expression"><a class="anchor" href="#_list_as_a_boolean_expression"></a> 1.2。以布尔表达式形式列出</h3>
<div class="paragraph">
<p>列表可以评估为<code>boolean</code>值：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">assert ![]             // an empty list evaluates as false

//all other lists, irrespective of contents, evaluate as true
assert [1] &amp;&amp; ['a'] &amp;&amp; [0] &amp;&amp; [0.0] &amp;&amp; [false] &amp;&amp; [null]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_iterating_on_a_list"><a class="anchor" href="#_iterating_on_a_list"></a> 1.3。迭代列表</h3>
<div class="paragraph">
<p>迭代列表中的元素通常是通过调用<code>each</code>和<code>eachWithIndex</code>方法，对列表的每个项目执行代码：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">[1, 2, 3].each {
    println "Item: $it" // `it` is an implicit parameter corresponding to the current element
}
['a', 'b', 'c'].eachWithIndex { it, i -&gt; // `it` is the current element, while `i` is the index
    println "$i: $it"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>除了迭代之外，通过将其每个元素转换为其他元素来创建新列表通常也很有用。该操作（通常称为映射）是在Groovy中完成的，这要归功于<code>collect</code>方法：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">assert [1, 2, 3].collect { it * 2 } == [2, 4, 6]

// shortcut syntax instead of collect
assert [1, 2, 3]*.multiply(2) == [1, 2, 3].collect { it.multiply(2) }

def list = [0]
// it is possible to give `collect` the list which collects the elements
assert [1, 2, 3].collect(list) { it * 2 } == [0, 2, 4, 6]
assert list == [0, 2, 4, 6]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_manipulating_lists"><a class="anchor" href="#_manipulating_lists"></a> 1.4。操作清单</h3>
<div class="sect3">
<h4 id="List-Filtering"><a class="anchor" href="#List-Filtering"></a> 1.4.1。筛选和搜索</h4>
<div class="paragraph">
<p><a href="http://www.groovy-lang.org/gdk.html">Groovy开发工具包</a>包含许多关于集合的方法，这些方法通过实用的方法增强了标准集合，其中一些示例如下：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">assert [1, 2, 3].find { it &gt; 1 } == 2           // find 1st element matching criteria
assert [1, 2, 3].findAll { it &gt; 1 } == [2, 3]   // find all elements matching critieria
assert ['a', 'b', 'c', 'd', 'e'].findIndexOf {      // find index of 1st element matching criteria
    it in ['c', 'e', 'g']
} == 2

assert ['a', 'b', 'c', 'd', 'c'].indexOf('c') == 2  // index returned
assert ['a', 'b', 'c', 'd', 'c'].indexOf('z') == -1 // index -1 means value not in list
assert ['a', 'b', 'c', 'd', 'c'].lastIndexOf('c') == 4

assert [1, 2, 3].every { it &lt; 5 }               // returns true if all elements match the predicate
assert ![1, 2, 3].every { it &lt; 3 }
assert [1, 2, 3].any { it &gt; 2 }                 // returns true if any element matches the predicate
assert ![1, 2, 3].any { it &gt; 3 }

assert [1, 2, 3, 4, 5, 6].sum() == 21                // sum anything with a plus() method
assert ['a', 'b', 'c', 'd', 'e'].sum {
    it == 'a' ? 1 : it == 'b' ? 2 : it == 'c' ? 3 : it == 'd' ? 4 : it == 'e' ? 5 : 0
    // custom value to use in sum
} == 15
assert ['a', 'b', 'c', 'd', 'e'].sum { ((char) it) - ((char) 'a') } == 10
assert ['a', 'b', 'c', 'd', 'e'].sum() == 'abcde'
assert [['a', 'b'], ['c', 'd']].sum() == ['a', 'b', 'c', 'd']

// an initial value can be provided
assert [].sum(1000) == 1000
assert [1, 2, 3].sum(1000) == 1006

assert [1, 2, 3].join('-') == '1-2-3'           // String joining
assert [1, 2, 3].inject('counting: ') {
    str, item -&gt; str + item                     // reduce operation
} == 'counting: 123'
assert [1, 2, 3].inject(0) { count, item -&gt;
    count + item
} == 6</code></pre>
</div>
</div>
<div class="paragraph">
<p>以下是惯用的Groovy代码，用于查找集合中的最大值和最小值：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def list = [9, 4, 2, 10, 5]
assert list.max() == 10
assert list.min() == 2

// we can also compare single characters, as anything comparable
assert ['x', 'y', 'a', 'z'].min() == 'a'

// we can use a closure to specify the sorting behaviour
def list2 = ['abc', 'z', 'xyzuvw', 'Hello', '321']
assert list2.max { it.size() } == 'xyzuvw'
assert list2.min { it.size() } == 'z'</code></pre>
</div>
</div>
<div class="paragraph">
<p>除闭包外，您还可以使用<code>Comparator</code>定义比较标准：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">Comparator mc = { a, b -&gt; a == b ? 0 : (a &lt; b ? -1 : 1) }

def list = [7, 4, 9, -6, -1, 11, 2, 3, -9, 5, -13]
assert list.max(mc) == 11
assert list.min(mc) == -13

Comparator mc2 = { a, b -&gt; a == b ? 0 : (Math.abs(a) &lt; Math.abs(b)) ? -1 : 1 }


assert list.max(mc2) == -13
assert list.min(mc2) == -1

assert list.max { a, b -&gt; a.equals(b) ? 0 : Math.abs(a) &lt; Math.abs(b) ? -1 : 1 } == -13
assert list.min { a, b -&gt; a.equals(b) ? 0 : Math.abs(a) &lt; Math.abs(b) ? -1 : 1 } == -1</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_adding_or_removing_elements"><a class="anchor" href="#_adding_or_removing_elements"></a> 1.4.2。添加或删除元素</h4>
<div class="paragraph">
<p>我们可以用<code>[]</code>分配一个新的空列表，并<code><<</code>附加项目：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def list = []
assert list.empty

list &lt;&lt; 5
assert list.size() == 1

list &lt;&lt; 7 &lt;&lt; 'i' &lt;&lt; 11
assert list == [5, 7, 'i', 11]

list &lt;&lt; ['m', 'o']
assert list == [5, 7, 'i', 11, ['m', 'o']]

//first item in chain of &lt;&lt; is target list
assert ([1, 2] &lt;&lt; 3 &lt;&lt; [4, 5] &lt;&lt; 6) == [1, 2, 3, [4, 5], 6]

//using leftShift is equivalent to using &lt;&lt;
assert ([1, 2, 3] &lt;&lt; 4) == ([1, 2, 3].leftShift(4))</code></pre>
</div>
</div>
<div class="paragraph">
<p>我们可以通过多种方式添加到列表中：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">assert [1, 2] + 3 + [4, 5] + 6 == [1, 2, 3, 4, 5, 6]
// equivalent to calling the `plus` method
assert [1, 2].plus(3).plus([4, 5]).plus(6) == [1, 2, 3, 4, 5, 6]

def a = [1, 2, 3]
a += 4      // creates a new list and assigns it to `a`
a += [5, 6]
assert a == [1, 2, 3, 4, 5, 6]

assert [1, *[222, 333], 456] == [1, 222, 333, 456]
assert [*[1, 2, 3]] == [1, 2, 3]
assert [1, [2, 3, [4, 5], 6], 7, [8, 9]].flatten() == [1, 2, 3, 4, 5, 6, 7, 8, 9]

def list = [1, 2]
list.add(3)
list.addAll([5, 4])
assert list == [1, 2, 3, 5, 4]

list = [1, 2]
list.add(1, 3) // add 3 just before index 1
assert list == [1, 3, 2]

list.addAll(2, [5, 4]) //add [5,4] just before index 2
assert list == [1, 3, 5, 4, 2]

list = ['a', 'b', 'z', 'e', 'u', 'v', 'g']
list[8] = 'x' // the [] operator is growing the list as needed
// nulls inserted if required
assert list == ['a', 'b', 'z', 'e', 'u', 'v', 'g', null, 'x']</code></pre>
</div>
</div>
<div class="paragraph">
<p>但是重要的是<code>+</code>列表中的运算符<strong>未更改</strong> 。相比<code><<</code> ，它将创建一个新列表，这通常不是您想要的，并且可能导致性能问题。</p>
</div>
<div class="paragraph">
<p><a href="http://www.groovy-lang.org/gdk.html">Groovy开发工具包</a>还包含一些方法，使您可以轻松地按值从列表中删除元素：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">assert ['a','b','c','b','b'] - 'c' == ['a','b','b','b']
assert ['a','b','c','b','b'] - 'b' == ['a','c']
assert ['a','b','c','b','b'] - ['b','c'] == ['a']

def list = [1,2,3,4,3,2,1]
list -= 3           // creates a new list by removing `3` from the original one
assert list == [1,2,4,2,1]
assert ( list -= [2,4] ) == [1,1]</code></pre>
</div>
</div>
<div class="paragraph">
<p>也可以通过将元素的索引传递给<code>remove</code>方法，在这种情况下，列表会发生突变：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def list = ['a','b','c','d','e','f','b','b','a']
assert list.remove(2) == 'c'        // remove the third element, and return it
assert list == ['a','b','d','e','f','b','b','a']</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果您只想删除列表中具有相同值的第一个元素，而不是删除所有元素，则可以调用<code>remove</code>传递值的方法：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def list= ['a','b','c','b','b']
assert list.remove('c')             // remove 'c', and return true because element removed
assert list.remove('b')             // remove first 'b', and return true because element removed

assert ! list.remove('z')           // return false because no elements removed
assert list == ['a','b','b']</code></pre>
</div>
</div>
<div class="paragraph">
<p>如您所见，有两个<code>remove</code>可用方法。一个使用整数并通过其索引删除元素，另一个将删除与传递的值匹配的第一个元素。那么，当我们有一个整数列表时该怎么办？在这种情况下，您可能希望使用<code>removeAt</code>通过其索引删除元素，以及<code>removeElement</code>删除与值匹配的第一个元素。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def list = [1,2,3,4,5,6,2,2,1]

assert list.remove(2) == 3          // this removes the element at index 2, and returns it
assert list == [1,2,4,5,6,2,2,1]

assert list.removeElement(2)        // remove first 2 and return true
assert list == [1,4,5,6,2,2,1]

assert ! list.removeElement(8)      // return false because 8 is not in the list
assert list == [1,4,5,6,2,2,1]

assert list.removeAt(1) == 4        // remove element at index 1, and return it
assert list == [1,5,6,2,2,1]</code></pre>
</div>
</div>
<div class="paragraph">
<p>当然， <code>removeAt</code>和<code>removeElement</code>适用于任何类型的列表。</p>
</div>
<div class="paragraph">
<p>此外，删除列表中的所有元素都可以通过调用<code>clear</code>方法：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def list= ['a',2,'c',4]
list.clear()
assert list == []</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_set_operations"><a class="anchor" href="#_set_operations"></a> 1.4.3。设定操作</h4>
<div class="paragraph">
<p><a href="http://www.groovy-lang.org/gdk.html">Groovy开发工具包</a>还包括一些使推理更容易的方法：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">assert 'a' in ['a','b','c']             // returns true if an element belongs to the list
assert ['a','b','c'].contains('a')      // equivalent to the `contains` method in Java
assert [1,3,4].containsAll([1,4])       // `containsAll` will check that all elements are found

assert [1,2,3,3,3,3,4,5].count(3) == 4  // count the number of elements which have some value
assert [1,2,3,3,3,3,4,5].count {
    it%2==0                             // count the number of elements which match the predicate
} == 2

assert [1,2,4,6,8,10,12].intersect([1,3,6,9,12]) == [1,6,12]

assert [1,2,3].disjoint( [4,6,9] )
assert ![1,2,3].disjoint( [2,4,6] )</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sorting"><a class="anchor" href="#_sorting"></a> 1.4.4。排序</h4>
<div class="paragraph">
<p>使用集合通常意味着排序。Groovy提供了各种选项来对列表进行排序，从使用闭包到比较器，如以下示例所示：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">assert [6, 3, 9, 2, 7, 1, 5].sort() == [1, 2, 3, 5, 6, 7, 9]

def list = ['abc', 'z', 'xyzuvw', 'Hello', '321']
assert list.sort {
    it.size()
} == ['z', 'abc', '321', 'Hello', 'xyzuvw']

def list2 = [7, 4, -6, -1, 11, 2, 3, -9, 5, -13]
assert list2.sort { a, b -&gt; a == b ? 0 : Math.abs(a) &lt; Math.abs(b) ? -1 : 1 } ==
        [-1, 2, 3, 4, 5, -6, 7, -9, 11, -13]

Comparator mc = { a, b -&gt; a == b ? 0 : Math.abs(a) &lt; Math.abs(b) ? -1 : 1 }

// JDK 8+ only
// list2.sort(mc)
// assert list2 == [-1, 2, 3, 4, 5, -6, 7, -9, 11, -13]

def list3 = [6, -3, 9, 2, -7, 1, 5]

Collections.sort(list3)
assert list3 == [-7, -3, 1, 2, 5, 6, 9]

Collections.sort(list3, mc)
assert list3 == [1, 2, -3, 5, 6, -7, 9]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_duplicating_elements"><a class="anchor" href="#_duplicating_elements"></a> 1.4.5。复制元素</h4>
<div class="paragraph">
<p><a href="http://www.groovy-lang.org/gdk.html">Groovy开发工具包</a>还利用运算符重载来提供允许复制列表元素的方法：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">assert [1, 2, 3] * 3 == [1, 2, 3, 1, 2, 3, 1, 2, 3]
assert [1, 2, 3].multiply(2) == [1, 2, 3, 1, 2, 3]
assert Collections.nCopies(3, 'b') == ['b', 'b', 'b']

// nCopies from the JDK has different semantics than multiply for lists
assert Collections.nCopies(2, [1, 2]) == [[1, 2], [1, 2]] //not [1,2,1,2]</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Collections-Maps"><a class="anchor" href="#Collections-Maps"></a> 2。地图</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_map_literals"><a class="anchor" href="#_map_literals"></a> 2.1。地图文字</h3>
<div class="paragraph">
<p>在Groovy中，可以使用地图文字语法创建地图（也称为关联数组）： <code>[:]</code> ：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def map = [name: 'Gromit', likes: 'cheese', id: 1234]
assert map.get('name') == 'Gromit'
assert map.get('id') == 1234
assert map['name'] == 'Gromit'
assert map['id'] == 1234
assert map instanceof java.util.Map

def emptyMap = [:]
assert emptyMap.size() == 0
emptyMap.put("foo", 5)
assert emptyMap.size() == 1
assert emptyMap.get("foo") == 5</code></pre>
</div>
</div>
<div class="paragraph">
<p>映射键默认为字符串： <code>[a:1]</code>相当于<code>['a':1]</code> 。如果您定义一个名为<code>a</code>而你想要的<strong>价值</strong> <code>a</code>成为地图中的关键。如果是这种情况，则<strong>必须</strong>通过添加括号对键进行转义，如以下示例所示：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def a = 'Bob'
def ages = [a: 43]
assert ages['Bob'] == null // `Bob` is not found
assert ages['a'] == 43     // because `a` is a literal!

ages = [(a): 43]            // now we escape `a` by using parenthesis
assert ages['Bob'] == 43   // and the value is found!</code></pre>
</div>
</div>
<div class="paragraph">
<p>除了地图文字外，还可以获取地图的新副本，以进行克隆：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def map = [
        simple : 123,
        complex: [a: 1, b: 2]
]
def map2 = map.clone()
assert map2.get('simple') == map.get('simple')
assert map2.get('complex') == map.get('complex')
map2.get('complex').put('c', 3)
assert map.get('complex').get('c') == 3</code></pre>
</div>
</div>
<div class="paragraph">
<p>如上一个示例所示，生成的地图是原始地图的<strong>浅表</strong>副本。</p>
</div>
</div>
<div class="sect2">
<h3 id="_map_property_notation"><a class="anchor" href="#_map_property_notation"></a> 2.2。地图属性符号</h3>
<div class="paragraph">
<p>地图的作用也类似于bean，因此您可以使用属性符号来获取/设置<code>Map</code>只要键是有效的Groovy标识符的字符串：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def map = [name: 'Gromit', likes: 'cheese', id: 1234]
assert map.name == 'Gromit'     // can be used instead of map.get('name')
assert map.id == 1234

def emptyMap = [:]
assert emptyMap.size() == 0
emptyMap.foo = 5
assert emptyMap.size() == 1
assert emptyMap.foo == 5</code></pre>
</div>
</div>
<div class="paragraph">
<p>注意：经设计<code>map.foo</code>会一直寻找钥匙<code>foo</code>在地图上。这意味着<code>foo.class</code>将返回<code>null</code>在不包含<code>class</code>键。如果您真的想了解课程，则必须使用<code>getClass()</code> ：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def map = [name: 'Gromit', likes: 'cheese', id: 1234]
assert map.class == null
assert map.get('class') == null
assert map.getClass() == LinkedHashMap // this is probably what you want

map = [1      : 'a',
       (true) : 'p',
       (false): 'q',
       (null) : 'x',
       'null' : 'z']
assert map.containsKey(1) // 1 is not an identifier so used as is
assert map.true == null
assert map.false == null
assert map.get(true) == 'p'
assert map.get(false) == 'q'
assert map.null == 'z'
assert map.get(null) == 'x'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_iterating_on_maps"><a class="anchor" href="#_iterating_on_maps"></a> 2.3。在地图上迭代</h3>
<div class="paragraph">
<p>与<a href="http://www.groovy-lang.org/gdk.html">Groovy开发工具包一样</a> ，地图上的惯用迭代利用了<code>each</code>和<code>eachWithIndex</code>方法。值得注意的是，使用地图文字表示法创建的地图是<strong>有序的</strong> ，也就是说，如果您对地图条目进行迭代，则可以确保返回的条目将与添加到地图中的顺序相同。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def map = [
        Bob  : 42,
        Alice: 54,
        Max  : 33
]

// `entry` is a map entry
map.each { entry -&gt;
    println "Name: $entry.key Age: $entry.value"
}

// `entry` is a map entry, `i` the index in the map
map.eachWithIndex { entry, i -&gt;
    println "$i - Name: $entry.key Age: $entry.value"
}

// Alternatively you can use key and value directly
map.each { key, value -&gt;
    println "Name: $key Age: $value"
}

// Key, value and i as the index in the map
map.eachWithIndex { key, value, i -&gt;
    println "$i - Name: $key Age: $value"
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_manipulating_maps"><a class="anchor" href="#_manipulating_maps"></a> 2.4。操纵地图</h3>
<div class="sect3">
<h4 id="_adding_or_removing_elements_2"><a class="anchor" href="#_adding_or_removing_elements_2"></a> 2.4.1。添加或删除元素</h4>
<div class="paragraph">
<p>可以使用来完成将元素添加到地图的操作<code>put</code>方法，下标运算符或使用<code>putAll</code> ：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def defaults = [1: 'a', 2: 'b', 3: 'c', 4: 'd']
def overrides = [2: 'z', 5: 'x', 13: 'x']

def result = new LinkedHashMap(defaults)
result.put(15, 't')
result[17] = 'u'
result.putAll(overrides)
assert result == [1: 'a', 2: 'z', 3: 'c', 4: 'd', 5: 'x', 13: 'x', 15: 't', 17: 'u']</code></pre>
</div>
</div>
<div class="paragraph">
<p>删除地图的所有元素可以通过调用<code>clear</code>方法：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def m = [1:'a', 2:'b']
assert m.get(1) == 'a'
m.clear()
assert m == [:]</code></pre>
</div>
</div>
<div class="paragraph">
<p>使用地图文字语法生成的地图正在使用对象<code>equals</code>和<code>hashcode</code>方法。这意味着您<strong>永远不要</strong>使用哈希代码随时间变化的对象，否则您将无法找回关联的值。</p>
</div>
<div class="paragraph">
<p>还值得注意的是，您<strong>永远不要</strong>使用<code>GString</code>作为地图的键，因为a的哈希码<code>GString</code>与等效项的哈希码不同<code>String</code> ：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def key = 'some key'
def map = [:]
def gstringKey = "${key.toUpperCase()}"
map.put(gstringKey,'value')
assert map.get('SOME KEY') == null</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="JN1035-Maps-Collectionviewsofamap"><a class="anchor" href="#JN1035-Maps-Collectionviewsofamap"></a> 2.4.2。键，值和条目</h4>
<div class="paragraph">
<p>我们可以检查视图中的键，值和条目：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def map = [1:'a', 2:'b', 3:'c']

def entries = map.entrySet()
entries.each { entry -&gt;
  assert entry.key in [1,2,3]
  assert entry.value in ['a','b','c']
}

def keys = map.keySet()
assert keys == [1,2,3] as Set</code></pre>
</div>
</div>
<div class="paragraph">
<p>不建议更改视图返回的值（无论是映射条目，键还是值），因为操作的成功直接取决于所操纵的映射的类型。特别是，Groovy依赖于JDK的集合，这些集合通常不能保证可以安全地通过<code>keySet</code> ， <code>entrySet</code> ， 要么<code>values</code> 。</p>
</div>
</div>
<div class="sect3">
<h4 id="_filtering_and_searching"><a class="anchor" href="#_filtering_and_searching"></a> 2.4.3。筛选和搜索</h4>
<div class="paragraph">
<p><a href="http://www.groovy-lang.org/gdk.html">Groovy开发工具包</a>包含与<a href="#List-Filtering">列表</a>类似的过滤，搜索和收集方法：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def people = [
    1: [name:'Bob', age: 32, gender: 'M'],
    2: [name:'Johnny', age: 36, gender: 'M'],
    3: [name:'Claire', age: 21, gender: 'F'],
    4: [name:'Amy', age: 54, gender:'F']
]

def bob = people.find { it.value.name == 'Bob' } // find a single entry
def females = people.findAll { it.value.gender == 'F' }

// both return entries, but you can use collect to retrieve the ages for example
def ageOfBob = bob.value.age
def agesOfFemales = females.collect {
    it.value.age
}

assert ageOfBob == 32
assert agesOfFemales == [21,54]

// but you could also use a key/pair value as the parameters of the closures
def agesOfMales = people.findAll { id, person -&gt;
    person.gender == 'M'
}.collect { id, person -&gt;
    person.age
}
assert agesOfMales == [32, 36]

// `every` returns true if all entries match the predicate
assert people.every { id, person -&gt;
    person.age &gt; 18
}

// `any` returns true if any entry matches the predicate

assert people.any { id, person -&gt;
    person.age == 54
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Maps-Grouping"><a class="anchor" href="#Maps-Grouping"></a> 2.4.4。分组</h4>
<div class="paragraph">
<p>我们可以使用一些条件将列表分组到地图中：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">assert ['a', 7, 'b', [2, 3]].groupBy {
    it.class
} == [(String)   : ['a', 'b'],
      (Integer)  : [7],
      (ArrayList): [[2, 3]]
]

assert [
        [name: 'Clark', city: 'London'], [name: 'Sharma', city: 'London'],
        [name: 'Maradona', city: 'LA'], [name: 'Zhang', city: 'HK'],
        [name: 'Ali', city: 'HK'], [name: 'Liu', city: 'HK'],
].groupBy { it.city } == [
        London: [[name: 'Clark', city: 'London'],
                 [name: 'Sharma', city: 'London']],
        LA    : [[name: 'Maradona', city: 'LA']],
        HK    : [[name: 'Zhang', city: 'HK'],
                 [name: 'Ali', city: 'HK'],
                 [name: 'Liu', city: 'HK']],
]</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Collections-Ranges"><a class="anchor" href="#Collections-Ranges"></a> 3。范围</h2>
<div class="sectionbody">
<div class="paragraph">
<p>范围允许您创建顺序值列表。这些可以用作<code>List</code>因为<a href="http://docs.groovy-lang.org/latest/html/api/groovy/lang/Range.html">Range</a>扩展了<a href="http://docs.oracle.com/javase/8/docs/api/java/util/List.html">java.util。清单</a> 。</p>
</div>
<div class="paragraph">
<p>用定义的范围<code>..</code>表示法包含在内（即列表包含from和to值）。</p>
</div>
<div class="paragraph">
<p>用定义的范围<code>..<</code>表示法是半开的，它们包括第一个值，但不包括最后一个值。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// an inclusive range
def range = 5..8
assert range.size() == 4
assert range.get(2) == 7
assert range[2] == 7
assert range instanceof java.util.List
assert range.contains(5)
assert range.contains(8)

// lets use a half-open range
range = 5..&lt;8
assert range.size() == 3
assert range.get(2) == 7
assert range[2] == 7
assert range instanceof java.util.List
assert range.contains(5)
assert !range.contains(8)

//get the end points of the range without using indexes
range = 1..10
assert range.from == 1
assert range.to == 10</code></pre>
</div>
</div>
<div class="paragraph">
<p>请注意，有效地实现了int范围，创建了一个包含from和to值的轻量级Java对象。</p>
</div>
<div class="paragraph">
<p>范围可用于实现java.lang的任何Java对象。可比较，也有方法<code>next()</code>和<code>previous()</code>返回范围中的下一个/上一个项目。例如，您可以创建一系列<code>String</code>元素：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// an inclusive range
def range = 'a'..'d'
assert range.size() == 4
assert range.get(2) == 'c'
assert range[2] == 'c'
assert range instanceof java.util.List
assert range.contains('a')
assert range.contains('d')
assert !range.contains('e')</code></pre>
</div>
</div>
<div class="paragraph">
<p>您可以使用经典迭代范围<code>for</code>环：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">for (i in 1..10) {
    println "Hello ${i}"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>但是您也可以通过迭代范围来以更Groovy惯用的风格实现相同的效果<code>each</code>方法：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">(1..10).each { i -&gt;
    println "Hello ${i}"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>范围也可以用在<code>switch</code>声明：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">switch (years) {
    case 1..10: interestRate = 0.076; break;
    case 11..25: interestRate = 0.052; break;
    default: interestRate = 0.037;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_syntax_enhancements_for_collections"><a class="anchor" href="#_syntax_enhancements_for_collections"></a> 4。集合的语法增强</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gpath_support"><a class="anchor" href="#_gpath_support"></a> 4.1。GPath支持</h3>
<div class="paragraph">
<p>由于列表和地图的属性符号均受支持，Groovy提供了语法糖，使得处理嵌套集合非常容易，如以下示例所示：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def listOfMaps = [['a': 11, 'b': 12], ['a': 21, 'b': 22]]
assert listOfMaps.a == [11, 21] //GPath notation
assert listOfMaps*.a == [11, 21] //spread dot notation

listOfMaps = [['a': 11, 'b': 12], ['a': 21, 'b': 22], null]
assert listOfMaps*.a == [11, 21, null] // caters for null values
assert listOfMaps*.a == listOfMaps.collect { it?.a } //equivalent notation
// But this will only collect non-null values
assert listOfMaps.a == [11,21]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_spread_operator"><a class="anchor" href="#_spread_operator"></a> 4.2。点差运算符</h3>
<div class="paragraph">
<p>传播运算符可用于将一个集合“内联”到另一个集合中。它是语法糖，通常避免调用<code>putAll</code>并促进单线的实现：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">assert [ 'z': 900,
         *: ['a': 100, 'b': 200], 'a': 300] == ['a': 300, 'b': 200, 'z': 900]
//spread map notation in map definition
assert [*: [3: 3, *: [5: 5]], 7: 7] == [3: 3, 5: 5, 7: 7]

def f = { [1: 'u', 2: 'v', 3: 'w'] }
assert [*: f(), 10: 'zz'] == [1: 'u', 10: 'zz', 2: 'v', 3: 'w']
//spread map notation in function arguments
f = { map -&gt; map.c }
assert f(*: ['a': 10, 'b': 20, 'c': 30], 'e': 50) == 30

f = { m, i, j, k -&gt; [m, i, j, k] }
//using spread map notation with mixed unnamed and named arguments
assert f('e': 100, *[4, 5], *: ['a': 10, 'b': 20, 'c': 30], 6) ==
        [["e": 100, "b": 20, "c": 30, "a": 10], 4, 5, 6]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Collections-Gettingefficientwiththestar-dotoperator"><a class="anchor" href="#Collections-Gettingefficientwiththestar-dotoperator"></a> 4.3。星点“ *”。算子</h3>
<div class="paragraph">
<p>“星点”运算符是一种快捷方式运算符，它允许您在集合的所有元素上调用方法或属性：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">assert [1, 3, 5] == ['a', 'few', 'words']*.size()

class Person {
    String name
    int age
}
def persons = [new Person(name:'Hugo', age:17), new Person(name:'Sandra',age:19)]
assert [17, 19] == persons*.age</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Collections-Slicingwiththesubscriptoperator"><a class="anchor" href="#Collections-Slicingwiththesubscriptoperator"></a> 4.4。下标运算符切片</h3>
<div class="paragraph">
<p>您可以使用下标表达式索引到列表，数组，地图中。有趣的是，在这种情况下，字符串被视为特殊的集合：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def text = 'nice cheese gromit!'
def x = text[2]

assert x == 'c'
assert x.class == String

def sub = text[5..10]
assert sub == 'cheese'

def list = [10, 11, 12, 13]
def answer = list[2,3]
assert answer == [12,13]</code></pre>
</div>
</div>
<div class="paragraph">
<p>请注意，您可以使用范围来提取集合的一部分：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">list = 100..200
sub = list[1, 3, 20..25, 33]
assert sub == [101, 103, 120, 121, 122, 123, 124, 125, 133]</code></pre>
</div>
</div>
<div class="paragraph">
<p>下标运算符可用于更新现有集合（对于不可变的集合类型）：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">list = ['a','x','x','d']
list[1..2] = ['b','c']
assert list == ['a','b','c','d']</code></pre>
</div>
</div>
<div class="paragraph">
<p>值得注意的是，允许使用负索引从集合的末尾更轻松地提取：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">text = "nice cheese gromit!"
x = text[-1]
assert x == "!"</code></pre>
</div>
</div>
<div class="paragraph">
<p>您可以使用负索引从列表，数组，字符串等的末尾开始计数。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def name = text[-7..-2]
assert name == "gromit"</code></pre>
</div>
</div>
<div class="paragraph">
<p>最终，如果使用向后范围（起始索引大于终止索引），则答案将相反。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">text = "nice cheese gromit!"
name = text[3..1]
assert name == "eci"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Collections-EnhancedCollectionMethods"><a class="anchor" href="#Collections-EnhancedCollectionMethods"></a> 5，增强的收集方法</h2>
<div class="sectionbody">
<div class="paragraph">
<p>除了<a href="#Collections-Lists">列表</a> ， <a href="#Collections-Maps">地图</a>或<a href="#Collections-Ranges">范围外</a> ，Groovy还提供了许多其他过滤，收集，分组，计数等方法，这些方法可以直接在集合上或更容易迭代的对象上使用。</p>
</div>
<div class="paragraph">
<p>特别是，我们邀请您阅读<a href="http://www.groovy-lang.org/gdk.html">Groovy开发套件</a> API文档，尤其是：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>方法添加到<code>Iterable</code>可以在<a href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/lang/Iterable.html">这里</a>找到</p>
</li>
<li>
<p>方法添加到<code>Iterator</code>可以在<a href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/util/Iterator.html">这里</a>找到</p>
</li>
<li>
<p>方法添加到<code>Collection</code>可以在<a href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/util/Collection.html">这里</a>找到</p>
</li>
<li>
<p>方法添加到<code>List</code>可以在<a href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/util/List.html">这里</a>找到</p>
</li>
<li>
<p>方法添加到<code>Map</code>可以在<a href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/util/Map.html">这里</a>找到</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">版本2.5.8<br>最近更新时间2019-08-02 18:30:30 UTC</div>
</div>
<link rel="stylesheet" href="asset?aid=3">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>

</body></html>