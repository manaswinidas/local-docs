<html lang="zh-Hans" ><head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Bean脚本框架</title>
<link rel="stylesheet" href="./assets/css/style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left" >
<div id="header">
<h1>Bean脚本框架</h1>
<div class="details">
<span id="revnumber">版本2.5.8</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">目录</div>
<ul class="sectlevel1">
<li><a href="#_getting_started">1。入门</a></li>
<li><a href="#_passing_in_variables">2。传递变量</a></li>
<li><a href="#_other_calling_options">3。其他通话选项</a></li>
<li><a href="#_access_to_the_scripting_engine">4。访问脚本引擎</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content"><a href="http://commons.apache.org/proper/commons-bsf/">Bean脚本框架</a>是一种尝试创建API以允许从Java调用脚本语言的尝试。它尚未更新很长时间，为了支持标准<a href="#jsr223">JSR-223</a> API而被放弃。</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Groovy的BSF引擎由<code>org.codehaus.groovy.bsf.GroovyEngine</code>类。但是，BSF API通常掩盖了这一事实。您只需通过BSF API像其他脚本语言一样对待Groovy。</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">由于Groovy拥有与Java集成的本机支持，因此，如果您还希望也能够调用其他语言（例如<a href="https://www.jruby.org/">JRuby），</a>或者希望与脚本语言保持紧密的联系，则只需担心BSF。
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started"><a class="anchor" href="#_getting_started"></a> 1。入门</h2>
<div class="sectionbody">
<div class="paragraph">
<p>如果您在类路径中有Groovy和BSF jar，则可以使用以下Java代码运行示例Groovy脚本：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">String myScript = "println('Hello World')\n  return [1, 2, 3]";
BSFManager manager = new BSFManager();
List answer = (List) manager.eval("groovy", "myScript.groovy", 0, 0, myScript);
assertEquals(3, answer.size());</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_passing_in_variables"><a class="anchor" href="#_passing_in_variables"></a> 2。传递变量</h2>
<div class="sectionbody">
<div class="paragraph">
<p>BSF使您可以在Java和脚本语言之间传递bean。您可以<em>注册</em> / <em>取消注册</em> bean，从而使BSF知道它们。然后，您可以根据需要使用BSF方法来<em>查找</em> bean。另外，您可以<em>声明</em> / <em>取消声明</em> bean。这将注册它们，但也可以直接在您的脚本语言中使用它们。第二种方法是Groovy使用的常规方法。这是一个例子：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">BSFManager manager = new BSFManager();
manager.declareBean("xyz", 4, Integer.class);
Object answer = manager.eval("groovy", "test.groovy", 0, 0, "xyz + 1");
assertEquals(5, answer);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_other_calling_options"><a class="anchor" href="#_other_calling_options"></a> 3。其他通话选项</h2>
<div class="sectionbody">
<div class="paragraph">
<p>前面的示例使用了<em>eval</em>方法。BSF提供了多种方法供您使用（有关更多详细信息，请参见<a href="http://commons.apache.org/proper/commons-bsf/manual.html">BSF文档</a> ）。<em>应用</em>其他可用方法之一。它允许您使用脚本语言定义匿名函数，并将该函数应用于参数。Groovy使用闭包支持此功能。这是一个例子：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">BSFManager manager = new BSFManager();
Vector&lt;String&gt; ignoreParamNames = null;
Vector&lt;Integer&gt; args = new Vector&lt;Integer&gt;();
args.add(2);
args.add(5);
args.add(1);
Integer actual = (Integer) manager.apply("groovy", "applyTest", 0, 0,
        "def summer = { a, b, c -&gt; a * 100 + b * 10 + c }", ignoreParamNames, args);
assertEquals(251, actual.intValue());</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_access_to_the_scripting_engine"><a class="anchor" href="#_access_to_the_scripting_engine"></a> 4。访问脚本引擎</h2>
<div class="sectionbody">
<div class="paragraph">
<p>尽管您通常不需要它，但BSF确实提供了一个钩子，可让您直接使用脚本引擎。引擎可执行的功能之一是在对象上调用单个方法。这是一个例子：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">BSFManager manager = new BSFManager();
BSFEngine bsfEngine = manager.loadScriptingEngine("groovy");
manager.declareBean("myvar", "hello", String.class);
Object myvar = manager.lookupBean("myvar");
String result = (String) bsfEngine.call(myvar, "reverse", new Object[0]);
assertEquals("olleh", result);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">版本2.5.8<br>最近更新时间2019-08-02 18:30:31 UTC</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>

</body></html>