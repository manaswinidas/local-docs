<html ><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>WebAppContext的部署处理</title><link rel="stylesheet" type="text/css" href="css/docbook.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="jetty, servlet, servlet-api, cometd, http, websocket, eclipse, maven, java, server, software"><link rel="home" href="index.html" title="Jetty"><link rel="up" href="configuring-deployment.html" title="Chapter 4. Deploying to Jetty"><link rel="prev" href="configuring-specific-webapp-deployment.html" title="Configuring a Specific Web Application Deployment"><link rel="next" href="static-content-deployment.html" title="Configuring Static Content Deployment"><link rel="shortcut icon" href="images/favicon.ico" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><link rel="stylesheet" href="css/highlighter/foundation.css"><script src="js/highlight.pack.js"></script><script>
      hljs.initHighlightingOnLoad();
    </script><link type="text/css" rel="stylesheet" href="css/font-awesome/font-awesome.min.css"></head><body bgcolor="white"  text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><tbody><tr><td style="width:25%"><a href="http://www.eclipse.org/jetty"><img src="images/jetty-header-logo.png" alt="码头标志"></a><br><span style="font-size:small">版本：9.4.24.v20191120</span></td><td style="width:50%"></td></tr></tbody></table><div class="navheader" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><table width="100%" summary="Navigation header"><tbody><tr><th colspan="3" align="center">WebAppContext的部署处理</th></tr><tr><td width="20%" align="left"><a href="configuring-specific-webapp-deployment.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><th width="60%" align="center">第四章部署到码头<br><a href="index.html" accesskey="p"><i class="fa fa-home" aria-hidden="true"></i>家</a></th><td width="20%" align="right"> <a href="static-content-deployment.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr></tbody></table><hr></div><div class="jetty-callout" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><h5 class="callout"><a href="http://www.webtide.com/">通过<span class="website">www.webtide.com</span>与Jetty核心开发人员联系。</a></h5><p>内部/客户项目的私人支持...自定义扩展和发行版...无限期支持的版本快照...您的应用程序和Ajax / Comet项目的可伸缩性指南...赞助功能开发的开发服务</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear:both"><a name="configuring-webapps"></a> WebAppContext的部署处理</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="configuring-webapps.html#webapp-configurations">配置类</a></span></dt><dt><span class="section"><a href="configuring-webapps.html#webapp-context-attributes">其他配置</a></span></dt></dl></div><p>Web应用程序投入使用之前需要进行一定数量的处理：它们可能需要解压，这是为其jar文件创建的特殊类加载器， <code class="literal">web.xml</code>和<code class="literal">web-fragment.xml</code>处理描述符，以及扫描类以查找注释。随着Web应用程序变得越来越复杂，Jetty通过增加或减少在部署时完成的处理量，增加了协助定制的方法。本节将检查此处理过程，并且可以对其进行定制以适合个人需求。</p><p>相反，如果您正在寻找有关如何配置特定设备的信息<code class="literal">WebAppContext</code> -例如其上下文路径（是否应该解压缩）-然后可以在标题为<a class="link" href="configuring-specific-webapp-deployment.html" title="配置特定的Web应用程序部署">配置特定的WebApp部署</a>的部分中找到它。</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="webapp-configurations"></a>配置类</h3></div></div></div><p>在部署Web应用程序时，将出现一系列<a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/Configuration.html" target="_top">org.eclipse.jetty.webapp。配置</a>类被应用到它，每个执行一个特定的功能。这些配置的顺序很重要，因为后续的配置倾向于以前述配置中提取或设置的信息为基础。这些是依次应用到每个<a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/WebAppContext.html" target="_top">org.eclipse.jetty.webapp的配置的默认列表</a><a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/WebAppContext.html" target="_top">。WebAppContex</a> t：</p><div class="table"><a name="d0e3200"></a><p class="title"><b>表4.1。默认配置类</b></p><div class="table-contents"><table class="table" border="1" summary="Default Configuration classes"><colgroup><col class="col_1"><col class="col_2"></colgroup><tbody><tr><td align="left" valign="top"><p><a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/WebInfConfiguration.html" target="_top">org.eclipse.jetty.webapp。WebInfConfiguration</a></p></td><td align="left" valign="top"><p>提取战争，命令罐子并定义类路径</p></td></tr><tr><td align="left" valign="top"><p><a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/WebXmlConfiguration.html" target="_top">org.eclipse.jetty.webapp。WebXmlConfiguration</a></p></td><td align="left" valign="top"><p>处理WEB-INF / web.xml文件</p></td></tr><tr><td align="left" valign="top"><p><a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/MetaInfConfiguration.html" target="_top">org.eclipse.jetty.webapp。MetaInfConfiguration</a></p></td><td align="left" valign="top"><p>在容器和webapp jar中查找META-INF / resources和META-INF / web-fragment.xml</p></td></tr><tr><td align="left" valign="top"><p><a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/FragmentConfiguration.html" target="_top">org.eclipse.jetty.webapp。片段配置</a></p></td><td align="left" valign="top"><p>处理所有发现的META-INF / web-fragment.xml文件</p></td></tr><tr><td align="left" valign="top"><p><a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/JettyWebXmlConfiguration.html" target="_top">org.eclipse.jetty.webapp。JettyWebXmlConfiguration</a></p></td><td align="left" valign="top"><p>处理WEB-INF / jetty-web.xml文件</p></td></tr></tbody></table></div></div><br class="table-break"><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_anatomy_of_a_configuration_class"></a>配置类剖析</h4></div></div></div><p>在配置的不同阶段，配置类被调用5次<a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/WebAppContext.html" target="_top"><code class="literal">WebAppContext's</code></a>生命周期：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">预配置</span></dt><dd>作为<code class="literal">WebAppContext</code>正在启动，此阶段已执行。的<code class="literal">Configuration</code>应该发现在后续阶段中将需要的任何资源。</dd><dt><span class="term">配置</span></dt><dd>这个阶段是完成类的工作的地方，通常使用在<code class="literal">preConfigure</code>相。</dd><dt><span class="term">postConfigure</span></dt><dd>此阶段允许<code class="literal">Configuration</code>清除在前两个阶段可能已创建的资源，这些资源在整个生命周期中都不需要<code class="literal">WebAppContext</code> 。</dd><dt><span class="term">取消配置</span></dt><dd>只要<code class="literal">WebAppContext</code>正在停止，并允许配置撤消其创建的任何资源/元数据。一种<code class="literal">WebAppContext</code>应该能够干净地启动/停止多次而无需占用资源。</dd><dt><span class="term">破坏</span></dt><dd>当<code class="literal">WebAppContext</code>实际上已从服务中删除。例如，与之相关的战争文件从$ JETTY_HOME / webapps目录中删除。</dd></dl></div><p>每个阶段都在每个阶段被调用<code class="literal">Configuration</code>上课的顺序<code class="literal">Configuration</code>类已列出。使用默认<code class="literal">Configuration</code>类为例， <code class="literal">preConfigure()</code>将被调用<code class="literal">WebInfConfiguration</code> ， <code class="literal">WebXmlConfiguration</code> ， <code class="literal">MetaInfConfiguration</code> ， <code class="literal">FragmentConfiguration</code>然后<code class="literal">JettyWebXmlConfiguration</code> 。循环再次开始<code class="literal">configure()</code>阶段和再次<code class="literal">postConfigure()</code>阶段。该循环<span class="emphasis"><em>以相反的顺序</em></span>重复进行， <code class="literal">deconfigure()</code>最终<code class="literal">destroy()</code>阶段。</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_extending_container_support_by_creating_extra_configurations"></a>通过创建额外的配置扩展容器支持</h4></div></div></div><p>如图所示，存在一组默认配置，这些配置支持Webapp的基本部署。尚未提及JavaEE功能（例如JNDI）和高级Servlet规范功能（例如注释）。Jetty的理念是允许用户根据自己的需求量身定制容器。如果不需要这些功能，那么Jetty不会为它们付出代价-这是一个重要的考虑因素，因为注释等功能需要对扫描进行大量且费时的扫描<code class="literal">WEB-INF/lib</code>罐子。由于现代Web应用程序可能包含大量此类jar，因此可能会导致大量部署延迟。我们将在“ <a class="link" href="configuring-webapps.html#webapp-context-attributes" title="其他配置">其他配置</a> ”部分中看到Jetty提供的另一个有用的webapp工具，以减少用于分析jar的时间。</p><p>Jetty利用Configurations的灵活性使JNDI和注释支持可插入。</p><p>首先，让我们看一下配置如何帮助启用JNDI。</p><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="jndi-configuration-classes"></a>示例：JNDI配置</h5></div></div></div><p>Web应用程序中的JNDI查找要求容器将容器环境中定义的资源与Web应用程序的资源挂钩。为此，我们使用了两个额外的配置：</p><div class="table"><a name="d0e3375"></a><p class="title"><b>表4.2。JNDI配置类</b></p><div class="table-contents"><table class="table" border="1" summary="JNDI Configuration classes"><colgroup><col class="col_1"><col class="col_2"></colgroup><tbody><tr><td align="left" valign="top"><p><a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/plus/webapp/EnvConfiguration.html" target="_top">org.eclipse.jetty.plus.webapp。环境配置</a></p></td><td align="left" valign="top"><p>创造<code class="literal">java:comp/env</code>对于网络应用，应用<code class="literal">WEB-INF/jetty-env.xml</code>文件</p></td></tr><tr><td align="left" valign="top"><p><a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/plus/webapp/PlusConfiguration.html" target="_top">org.eclipse.jetty.plus.webapp。Plus配置</a></p></td><td align="left" valign="top"><p>处理JNDI的相关方面<code class="literal">WEB-INF/web.xml</code>并连接命名条目</p></td></tr></tbody></table></div></div><br class="table-break"><p>这些配置必须<span class="emphasis"><em>完全</em></span>按照上面显示的顺序添加，并且应该在<a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/JettyWebXmlConfiguration.html" target="_top">org.eclipse.jetty.webapp <span class="emphasis"><em>之前</em></span>插入</a><a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/JettyWebXmlConfiguration.html" target="_top">。配置列表中的JettyWebXmlConfiguration</a>类。为了完全支持JNDI，还需要其他配置，有关详细信息，请参见<a class="link" href="jndi.html" title="第十二章配置JNDI">此处</a> 。</p></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="_example_annotation_configurations"></a>示例：注释配置</h5></div></div></div><p>我们只需要一个额外的Configuration类即可帮助提供servlet注释扫描：</p><div class="table"><a name="d0e3426"></a><p class="title"><b>表4.3。注释配置类</b></p><div class="table-contents"><table class="table" border="1" summary="Annotation Configuration classes"><colgroup><col class="col_1"><col class="col_2"></colgroup><tbody><tr><td align="left" valign="top"><p><a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/annotations.AnnotationConfiguration.html" target="_top">org.eclipse.jetty.annotations。注释配置</a></p></td><td align="left" valign="top"><p>扫描容器和Web应用程序jar，查找@ WebServlet，@ WebFilter，@ WebListener等</p></td></tr></tbody></table></div></div><br class="table-break"><p>必须在<a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/JettyWebXmlConfiguration.html" target="_top">org.eclipse.jetty.webapp <span class="emphasis"><em>之前立即插入</em></span>上述配置类</a><a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/JettyWebXmlConfiguration.html" target="_top">。配置列表中的JettyWebXmlConfiguration</a>类。为了完全支持注释，需要进行其他配置，有关详细信息，请参见<a class="link" href="configuring-webapps.html#webapp-context-attributes" title="其他配置">下文。</a></p></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_how_to_set_the_list_of_configurations"></a>如何设置配置列表</h4></div></div></div><p>对于如何使Jetty使用其他配置列表，您有许多选择。</p><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="_setting_the_list_directly_on_the_webappcontext"></a>直接在WebAppContext上设置列表</h5></div></div></div><p>如果您只希望影响一个Web应用程序，这可能是最简单的选择。但是，您要么需要一个表示您的Web应用程序的上下文xml文件，要么需要在代码中调用等效项。让我们看一个如何在JNDI <span class="emphasis"><em>和</em></span>注释中添加配置的示例：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "http://www.eclipse.org/jetty/configure_9_3.dtd"&gt;

&lt;Configure class="org.eclipse.jetty.webapp.WebAppContext"&gt;

  &lt;Set name="war"&gt;&lt;SystemProperty name="jetty.base" default="."/&gt;/webapps/my-cool-webapp&lt;/Set&gt;

  &lt;Set name="configurationClasses"&gt;
    &lt;Array type="java.lang.String"&gt;
      &lt;Item&gt;org.eclipse.jetty.webapp.WebInfConfiguration&lt;/Item&gt;
      &lt;Item&gt;org.eclipse.jetty.webapp.WebXmlConfiguration&lt;/Item&gt;
      &lt;Item&gt;org.eclipse.jetty.webapp.MetaInfConfiguration&lt;/Item&gt;
      &lt;Item&gt;org.eclipse.jetty.webapp.FragmentConfiguration&lt;/Item&gt;
      &lt;Item&gt;org.eclipse.jetty.plus.webapp.EnvConfiguration&lt;/Item&gt;
      &lt;Item&gt;org.eclipse.jetty.plus.webapp.PlusConfiguration&lt;/Item&gt;
      &lt;Item&gt;org.eclipse.jetty.annotations.AnnotationConfiguration&lt;/Item&gt;
      &lt;Item&gt;org.eclipse.jetty.webapp.JettyWebXmlConfiguration&lt;/Item&gt;
    &lt;/Array&gt;
  &lt;/Set&gt;

&lt;/Configure&gt;</code></pre><p>当然，您也可以使用此方法来减少应用于特定<code class="literal">WebAppContext</code> 。</p></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="_setting_the_list_for_all_webapps_via_the_deployer"></a>通过部署程序设置所有Web应用程序的列表</h5></div></div></div><p>如果使用<a class="link" href="deployment-architecture.html" title="部署架构">部署程序</a> ，则可以在<a class="link" href="deployment-architecture.html#default-web-app-provider" title="了解默认的WebAppProvider">WebAppProvider</a>上设置配置类的列表。然后将它们应用于每个<code class="literal">WebAppContext</code>由部署者部署：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "http://www.eclipse.org/jetty/configure_9_3.dtd"&gt;

&lt;Configure id="Server" class="org.eclipse.jetty.server.Server"&gt;

  &lt;Call name="addBean"&gt;
    &lt;Arg&gt;
      &lt;New id="DeploymentManager" class="org.eclipse.jetty.deploy.DeploymentManager"&gt;
        &lt;Set name="contexts"&gt;
          &lt;Ref refid="Contexts" /&gt;
        &lt;/Set&gt;
        &lt;Call id="webappprovider" name="addAppProvider"&gt;
          &lt;Arg&gt;
            &lt;New class="org.eclipse.jetty.deploy.providers.WebAppProvider"&gt;
              &lt;Set name="monitoredDirName"&gt;&lt;Property name="jetty.base" default="." /&gt;/webapps&lt;/Set&gt;
              &lt;Set name="configurationClasses"&gt;
                &lt;Array type="java.lang.String"&gt;
                  &lt;Item&gt;org.eclipse.jetty.webapp.WebInfConfiguration&lt;/Item&gt;
                  &lt;Item&gt;org.eclipse.jetty.webapp.WebXmlConfiguration&lt;/Item&gt;
                  &lt;Item&gt;org.eclipse.jetty.webapp.MetaInfConfiguration&lt;/Item&gt;
                  &lt;Item&gt;org.eclipse.jetty.webapp.FragmentConfiguration&lt;/Item&gt;
                  &lt;Item&gt;org.eclipse.jetty.plus.webapp.EnvConfiguration&lt;/Item&gt;
                  &lt;Item&gt;org.eclipse.jetty.plus.webapp.PlusConfiguration&lt;/Item&gt;
                  &lt;Item&gt;org.eclipse.jetty.annotations.AnnotationConfiguration&lt;/Item&gt;
                  &lt;Item&gt;org.eclipse.jetty.webapp.JettyWebXmlConfiguration&lt;/Item&gt;
                &lt;/Array&gt;
              &lt;/Set&gt;
            &lt;/New&gt;
          &lt;/Arg&gt;
        &lt;/Call&gt;
      &lt;/New&gt;
    &lt;/Arg&gt;
  &lt;/Call&gt;
&lt;/Configure&gt;</code></pre></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="_adding_or_inserting_to_an_existing_list"></a>添加或插入现有列表</h5></div></div></div><p>不必完全枚举列表，您只需指定要添加的类，并在列表中指明要插入的行踪即可。让我们看一个使用此方法添加对JNDI的配置支持的示例-通常，您可以在xml文件中执行此操作，也可以通过等效代码执行此操作。这个例子使用了一个xml文件，实际上它是<code class="literal">$JETTY_HOME/etc/jetty-plus.xml</code> Jetty发行版中的文件：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "http://www.eclipse.org/jetty/configure_9_3.dtd"&gt;

&lt;Configure id="Server" class="org.eclipse.jetty.server.Server"&gt;

  &lt;!-- =========================================================== --&gt;
  &lt;!-- Add plus Configuring classes to all webapps for this Server --&gt;
  &lt;!-- =========================================================== --&gt;
  &lt;Call class="org.eclipse.jetty.webapp.Configuration$ClassList" name="setServerDefault"&gt;
    &lt;Arg&gt;&lt;Ref refid="Server" /&gt;&lt;/Arg&gt;
    &lt;Call name="addAfter"&gt;
      &lt;Arg name="afterClass"&gt;org.eclipse.jetty.webapp.FragmentConfiguration&lt;/Arg&gt;
      &lt;Arg&gt;
        &lt;Array type="String"&gt;
          &lt;Item&gt;org.eclipse.jetty.plus.webapp.EnvConfiguration&lt;/Item&gt;
          &lt;Item&gt;org.eclipse.jetty.plus.webapp.PlusConfiguration&lt;/Item&gt;
        &lt;/Array&gt;
      &lt;/Arg&gt;
    &lt;/Call&gt;
  &lt;/Call&gt;

&lt;/Configure&gt;</code></pre><p><a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/Configuration.html" target="_top">org.eclipse.jetty.webapp。组态。ClassList</a>类提供了以下插入方法：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">addAfter</span></dt><dd>插入提供的清单<code class="literal">Configuration</code>给定的Configuration类名之后的类名。</dd><dt><span class="term">addBefore</span></dt><dd>插入提供的清单<code class="literal">Configuration</code>给定的Configuration类名之前的类名。</dd></dl></div></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="webapp-context-attributes"></a>其他配置</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="container-include-jar-pattern"></a> org.eclipse.jetty.server.webapp。ContainerIncludeJarPattern</h4></div></div></div><p>这是可以在<a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/WebAppContext.html" target="_top">org.eclipse.jetty.webapp上设置的上下文属性</a><a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/WebAppContext.html" target="_top">。WebAppContext</a>来控制应处理<span class="emphasis"><em>容器的</em></span>类路径的哪些部分来处理注释， <code class="literal">META-INF/resources</code> ， <code class="literal">META-INF/web-fragment.xml</code>和<code class="literal">tlds</code>内<code class="literal">META-INF</code> 。</p><p>通常，将不包含来自容器类路径的任何内容进行处理。但是，有时您需要包括一些内容。例如，您可能有一些在Web应用程序之间共享的库，因此已将它们放入一个<code class="literal">$JETTY_HOME/lib</code>目录。这些库包含注释，因此必须对其进行扫描。</p><p>此属性的值是一个regexp，它定义应检查容器的类路径中的哪些<span class="emphasis"><em>jar</em></span>和<span class="emphasis"><em>类目录</em></span> 。</p><p>这是上下文xml文件中的一个示例（尽管像往常一样，您可以在代码中完成同样的工作），该示例将匹配名称以“ foo-”或“ bar-”开头的jar或名为“ classes”的目录：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "http://www.eclipse.org/jetty/configure_9_3.dtd"&gt;

&lt;Configure class="org.eclipse.jetty.webapp.WebAppContext"&gt;

    &lt;Call name="setAttribute"&gt;
      &lt;Arg&gt;org.eclipse.jetty.server.webapp.ContainerIncludeJarPattern&lt;/Arg&gt;
      &lt;Arg&gt;.*/foo-[^/]*\.jar$|.*/bar-[^/]*\.jar$|.*/classes/.*&lt;/Arg&gt;
    &lt;/Call&gt;

&lt;/Configure&gt;</code></pre><p>请注意，模式的顺序定义了jar或类目录的扫描顺序。</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="web-inf-include-jar-pattern"></a> org.eclipse.jetty.server.webapp。WebInfIncludeJarPattern</h4></div></div></div><p>与先前的context属性类似，此属性控制为注释， <code class="literal">META-INF/resources</code> ， <code class="literal">META-INF/web-fragment.xml</code>和<code class="literal">tlds</code>在<code class="literal">META-INF</code> 。但是，此属性控制从网络<span class="emphasis"><em>应用的</em></span>类路径（通常是<code class="literal">WEB-INF/lib</code> ）进行处理。当您有数十个罐子时，此功能特别有用<code class="literal">WEB-INF/lib</code> ，但是您只需要扫描少数几个即可。</p><p>这是一个xml文件中的模式示例，该模式与以<code class="literal">spring-</code> ：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "http://www.eclipse.org/jetty/configure_9_3.dtd"&gt;

&lt;Configure class="org.eclipse.jetty.webapp.WebAppContext"&gt;

    &lt;Call name="setAttribute"&gt;
      &lt;Arg&gt;org.eclipse.jetty.server.webapp.WebInfIncludeJarPattern&lt;/Arg&gt;
      &lt;Arg&gt;.*/spring-[^/]*\.jar$&lt;/Arg&gt;
    &lt;/Call&gt;

&lt;/Configure&gt;</code></pre><p>请注意，模式的顺序定义了jar文件扫描的顺序。</p></div></div></div><script type="text/javascript">
      SyntaxHighlighter.all()
    </script><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tbody><tr><td width="40%" align="left"><a href="configuring-specific-webapp-deployment.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><td width="20%" align="center"><a href="configuring-deployment.html" accesskey="u"><i class="fa fa-chevron-up" aria-hidden="true"></i>最佳</a></td><td width="40%" align="right"> <a href="static-content-deployment.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr><tr><td width="40%" align="left" valign="top">配置特定的Web应用程序部署</td><td width="20%" align="center"><a href="index.html" accesskey="h"><i class="fa fa-home" aria-hidden="true"></i>家</a></td><td width="40%" align="right" valign="top">配置静态内容部署</td></tr></tbody></table></div><p xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"></p><div class="jetty-callout">看到错误或缺少的东西？
            <span class="callout"><a href="http://github.com/eclipse/jetty.project">在以下位置对此文档做出贡献<span class="website"><i class="fa fa-github" aria-hidden="true"></i> Github！</span></a></span> <span style="float:right"><i>（产生：2019-11-20）</i></span></div><p></p></body></html>