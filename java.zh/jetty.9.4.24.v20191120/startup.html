<html ><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>第九章启动Jetty</title><link rel="stylesheet" type="text/css" href="css/docbook.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="jetty, servlet, servlet-api, cometd, http, websocket, eclipse, maven, java, server, software"><link rel="home" href="index.html" title="Jetty"><link rel="up" href="jetty-admin-guide.html" title="Part III. Jetty Administration Guide"><link rel="prev" href="jetty-admin-guide.html" title="Part III. Jetty Administration Guide"><link rel="next" href="start-jar.html" title="Using start.jar"><link rel="shortcut icon" href="images/favicon.ico" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><link rel="stylesheet" href="css/highlighter/foundation.css"><script src="js/highlight.pack.js"></script><script>
      hljs.initHighlightingOnLoad();
    </script><link type="text/css" rel="stylesheet" href="css/font-awesome/font-awesome.min.css"></head><body bgcolor="white"  text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><tbody><tr><td style="width:25%"><a href="http://www.eclipse.org/jetty"><img src="images/jetty-header-logo.png" alt="Jetty标志"></a><br><span style="font-size:small">版本：9.4.24.v20191120</span></td><td style="width:50%"></td></tr></tbody></table><div class="navheader" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><table width="100%" summary="Navigation header"><tbody><tr><th colspan="3" align="center">第九章启动Jetty</th></tr><tr><td width="20%" align="left"><a href="jetty-admin-guide.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><th width="60%" align="center">第三部分Jetty管理指南<br><a href="index.html" accesskey="p"><i class="fa fa-home" aria-hidden="true"></i>家</a></th><td width="20%" align="right"> <a href="start-jar.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr></tbody></table><hr></div><div class="jetty-callout" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><h5 class="callout"><a href="http://www.webtide.com/">通过<span class="website">www.webtide.com</span>与Jetty核心开发人员联系。</a></h5><p>内部/客户项目的私人支持...自定义扩展和发行版...无限期支持的版本快照...您的应用程序和Ajax / Comet项目的可伸缩性指南...赞助功能开发的开发服务</p></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="startup"></a>第九章启动Jetty</h2></div></div></div><div class="toc"><p><b>目录</b></p><dl class="toc"><dt><span class="section"><a href="startup.html#startup-overview">启动概述</a></span></dt><dt><span class="section"><a href="start-jar.html">使用start.jar</a></span></dt><dt><span class="section"><a href="startup-base-and-home.html">管理Jetty基地和Jetty主页</a></span></dt><dt><span class="section"><a href="startup-classpath.html">管理服务器类路径</a></span></dt><dt><span class="section"><a href="startup-modules.html">管理启动模块</a></span></dt><dt><span class="section"><a href="custom-modules.html">定制模块</a></span></dt><dt><span class="section"><a href="startup-xml-config.html">管理基于XML的启动配置</a></span></dt><dt><span class="section"><a href="startup-unix-service.html">使用jetty.sh启动Unix服务</a></span></dt><dt><span class="section"><a href="startup-windows-service.html">通过Windows服务启动</a></span></dt><dt><span class="section"><a href="startup-jpms.html">使用Java平台模块系统（JPMS）启动</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear:both"><a name="startup-overview"></a>启动概述</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="startup.html#_startup_example">启动示例</a></span></dt></dl></div><p>的<code class="literal">start.jar</code> bootstrap管理独立Jetty的启动。它负责：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">建立类路径</span></dt><dd>的<code class="literal">start.jar</code> bootstrap为所有必需的Jetty功能及其依赖关系构建类路径。它使用<code class="literal">--lib</code>选择<code class="literal">start.jar</code>添加单个类路径条目，或使用<code class="literal">--module</code>该选项包括模块的所有库及其依赖项（名为Jetty功能）。</dd><dt><span class="term">实例化服务器组件</span></dt><dd>使用Jetty IoC XML或Spring实例化服务器及其组件。Jetty服务器是服务器，连接器，会话管理器和其他应用程序的POJO的集合。这些文件在XML文件中实例化，注入并连接在一起，通常是每个模块/功能一个，并作为参数传递给<code class="literal">start.jar</code> 。</dd><dt><span class="term">解决服务器文件系统位置</span></dt><dd>的<code class="literal">start.jar</code>机制可解决以下问题的规范位置： <code class="literal">${jetty.home}</code>和<code class="literal">${jetty.base}</code>目录。的<code class="literal">${jetty.home}</code>目录是Jetty标准发行版的位置。的<code class="literal">${jetty.base}</code> directory是本地服务器定制和配置的位置。+如果要修改Jetty发行版，则base和home可以是同一目录。将基本目录和主目录分开，可以使分发保持不变，而所有自定义项都位于基本目录中，从而简化了后续服务器版本的升级。</dd><dt><span class="term">参数化服务器配置</span></dt><dd>XML文件主要决定服务器配置。对这些文件中的许多文件进行了参数化，以允许简单地注入主机名，端口，密码等。的<code class="literal">start.jar</code>该机制允许您在命令行或属性文件中设置参数。</dd></dl></div><p>为了实现这些启动机制， <code class="literal">start.jar</code>用途：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">命令行参数</span></dt><dd>您可以使用指定库，属性和XML文件的命令行参数来配置整个服务器。但是，在实践中，INI和模块机制（如下）会降低命令行的详细程度。</dd><dt><span class="term">INI文件</span></dt><dd>的<code class="literal">start.jar</code>机制使用的内容<code class="literal">${jetty.base}/start.ini</code>和<code class="literal">${jetty.base}/start.d/*.ini</code>每行相当于一个文件<code class="literal">start.jar</code>命令行参数。这意味着无论是全球<code class="literal">start.ini</code>文件或多个<code class="literal">start.d/feature.ini</code>文件控制服务器的配置。</dd></dl></div><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>选择<span class="strong"><strong>其中之一</strong></span>很重要<code class="literal">${jetty.base}/start.ini</code>要么<code class="literal">${jetty.base}/start.d/*.ini</code>管理配置。不建议同时使用两者，这可能会导致服务器出现问题。</p></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">模组</span></dt><dd>除了明确列出功能的所有库，属性和XML文件以外， <code class="literal">start.jar</code>机制允许您创建模块。在一个模块中定义了一个模块<code class="literal">modules/*.mod</code>文件，包括Jetty功能的库，依赖项，XML和模板INI文件。因此，您可以使用一个<code class="literal">--module=name</code>命令行选项等同于指定<code class="literal">--lib=location</code> ， <code class="literal">feature.xml</code>要么<code class="literal">name=value</code>功能及其所有依赖项的参数。模块还使用其依赖性来控制库和XML文件的顺序。Jetty发行版中包含几个模块文件，这些文件涵盖了最常见的服务器功能，例如HTTP，HTTPS，SSL，日志记录，注释等。 <span class="strong"><strong>仅</strong></span>在对功能的执行方式进行结构更改时， <span class="strong"><strong>才</strong></span>应编辑这些模块文件。有关更多信息，请参阅本章后面有关<a class="link" href="startup-modules.html" title="管理启动模块">管理启动模块的</a>部分。</dd><dt><span class="term">XML文件</span></dt><dd>Jetty IoC或Spring格式的XML文件实例化服务器的实际POJO组件。这包括所有主要组件，例如连接器，密钥库，会话管理器和数据源。通常，每个模块有一个或多个XML文件，这些文件在相应的模块中定义和激活。</dd></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_startup_example"></a>启动示例</h3></div></div></div><p>启动Jetty的最简单方法是通过<code class="literal">start.jar</code>使用以下Java命令行的机制：</p><div class="screenexample"><pre class="screen">[user]$ cd jetty-distribution-9.4.24.v20191120
[jetty-distribution-9.4.24.v20191120]$ java -jar start.jar --module=http jetty.http.port=8080</pre></div><p>此命令使用<code class="literal">start.jar</code>引导类路径，属性和XML文件以及从<code class="literal">http</code>模块。具体来说<code class="literal">http</code>模块在<code class="literal">${jetty.home}/modules/http.mod</code>文件，其中包括以下内容：</p><div class="screenexample"><pre class="screen">[jetty-distribution-9.4.24.v20191120]$ cat modules/http.mod
[depend]
server

[xml]
etc/jetty-http.xml

[ini-template]
jetty.http.port=8080
http.timeout=30000</pre></div><p>的<code class="literal">http</code>模块声明<code class="literal">http</code>取决于服务器模块，使用<code class="literal">jetty-http.xml</code>文件，并且可以使用<code class="literal">jetty.http.port</code>和<code class="literal">http.timeout</code>参数。上面的命令并未实际使用INI-template部分，因此<code class="literal">jetty.http.port</code>必须仍然在命令行上定义。</p><p>遵循服务器依赖性之后， <code class="literal">${jetty.home}/modules/server.mod</code>文件包括：</p><div class="screenexample"><pre class="screen">[jetty-distribution-9.4.24.v20191120]$ cat modules/server.mod
[lib]
lib/servlet-api-3.1.jar
lib/jetty-http-${jetty.version}.jar
lib/jetty-server-${jetty.version}.jar
lib/jetty-xml-${jetty.version}.jar
lib/jetty-util-${jetty.version}.jar
lib/jetty-io-${jetty.version}.jar

[xml]
etc/jetty.xml

[ini-template]
threads.min=10
threads.max=200</pre></div><p>的<code class="literal">server</code>模块声明服务器需要和使用的库<code class="literal">jetty.xml</code>文件。的合并元数据<code class="literal">http</code>和<code class="literal">server</code>模块导致<code class="literal">start.jar</code>生成启动Jetty所需的有效Java命令行。</p><p>看到此问题的另一种方法是通过将--list-config附加到命令行来询问Jetty其配置是什么样的：</p><div class="screenexample"><pre class="screen">[jetty-distribution-9.4.24.v20191120]$ java -jar start.jar --module=http jetty.http.port=9099 --list-config

Java Environment:
-----------------
 java.home=/user/lib/jvm/jdk-7u21-x64/jre
 java.vm.vendor=Oracle Corporation
 java.vm.version=23.25-b01
 java.vm.name=Java HotSpot(TM) 64-Bit Server VM
 java.vm.info=mixed mode
 java.runtime.name=Java(TM) SE Runtime Environment
 java.runtime.version=1.7.0_25-b15
 java.io.tmpdir=/tmp

Jetty Environment:
-----------------
 jetty.home=/opt/jetty/jetty-distribution-9.4.24.v20191120
 jetty.base=/opt/jetty/jetty-distribution-9.4.24.v20191120
 jetty.version=9.4.24.v20191120

JVM Arguments:
--------------
 (no jvm args specified)

System Properties:
------------------
 jetty.home = /opt/jetty/jetty-distribution-9.4.24.v20191120
 jetty.base = /opt/jetty/jetty-distribution-9.4.24.v20191120

Properties:
-----------
 jetty.http.port = 9099

Jetty Server Classpath:
-----------------------
Version Information on 7 entries in the classpath.
Note: order presented here is how they would appear on the classpath.
      changes to the --module=name command line options will be reflected here.
 0:                    3.1.0 | ${jetty.home}/lib/servlet-api-3.1.jar
 1:                  3.1.RC0 | ${jetty.home}/lib/jetty-schemas-3.1.jar
 2:               9.4.24.v20191120 | ${jetty.home}/lib/jetty-http-9.4.24.v20191120.jar
 3:               9.4.24.v20191120 | ${jetty.home}/lib/jetty-server-9.4.24.v20191120.jar
 4:               9.4.24.v20191120 | ${jetty.home}/lib/jetty-xml-9.4.24.v20191120.jar
 5:               9.4.24.v20191120 | ${jetty.home}/lib/jetty-util-9.4.24.v20191120.jar
 6:               9.4.24.v20191120 | ${jetty.home}/lib/jetty-io-9.4.24.v20191120.jar

Jetty Active XMLs:
------------------
 ${jetty.home}/etc/jetty.xml
 ${jetty.home}/etc/jetty-http.xml</pre></div><p>这代表了用于启动Jetty的整个配置。</p><p>如果您不想使用<code class="literal">start.jar</code>引导程序，您可以使用传统的Java命令行启动Jetty。</p><p>以下是等效的Java命令行<code class="literal">start.jar</code>上面的引导执行。</p><div class="screenexample"><pre class="screen">[user]$ cd jetty-distribution-9.4.24.v20191120
[jetty-distribution-9.4.24.v20191120]$ echo jetty.http.port=8080 &gt; /tmp/jetty.properties
[jetty-distribution-9.4.24.v20191120]$ export JETTY_HOME=`pwd`
[jetty-distribution-9.4.24.v20191120]$ export JETTY_BASE=`pwd`
[jetty-distribution-9.4.24.v20191120]$ export JETTY_VERSION="${project.version}"
[jetty-distribution-9.4.24.v20191120]$ java -Djetty.home=$JETTY_HOME \
-Djetty.base=$JETTY_BASE \
-cp \
 $JETTY_HOME/lib/servlet-api-3.1.jar\
:$JETTY_HOME/lib/jetty-schemas-3.1.jar\
:$JETTY_HOME/lib/jetty-http-$JETTY_VERSION.jar\
:$JETTY_HOME/lib/jetty-server-$JETTY_VERSION.jar \
:$JETTY_HOME/lib/jetty-xml-$JETTY_VERSION.jar\
:$JETTY_HOME/lib/jetty-util-$JETTY_VERSION.jar\
:$JETTY_HOME/lib/jetty-io-$JETTY_VERSION.jar\
org.eclipse.jetty.xml.XmlConfiguration \
/tmp/jetty.properties \
$JETTY_HOME/etc/jetty.xml \
$JETTY_HOME/etc/jetty-http.xml</pre></div><p>Java命令行使用核心Jetty jar和servlet API设置类路径，执行XmlConfiguration类，并向其传递一些XML文件，这些文件定义了服务器，并在HTTP定义的端口上运行了HTTP连接器。 <code class="literal">jetty.properties</code>文件。</p><p>您可以使用模块定义的INI模板来创建此服务器，从而进一步简化该服务器的启动。 <code class="literal">start.ini</code>使用命令文件：</p><div class="screenexample"><pre class="screen">[user]$ cd jetty-distribution-9.4.24.v20191120
[jetty-distribution-9.4.24.v20191120]$ mkdir example-base
[example-base]$ cd example-base
[example-base]$ ls -la
total 8
drwxrwxr-x  2 user webgroup 4096 Oct  4 11:49 ./
drwxrwxr-x 12 user webgroup 4096 Oct  4 11:49 ../

[example-base]$ java -jar $JETTY_HOME/start.jar --add-to-start=http

WARNING: http            initialised in ${jetty.base}/start.ini (appended)
WARNING: http            enabled in     ${jetty.base}/start.ini
WARNING: server          initialised in ${jetty.base}/start.ini (appended)
WARNING: server          enabled in     ${jetty.base}/start.ini

[example-base]$ ls -la
total 12
drwxrwxr-x  2 user webgroup 4096 Oct  4 11:55 ./
drwxrwxr-x 12 user webgroup 4096 Oct  4 11:49 ../
-rw-rw-r--  1 user webgroup  250 Oct  4 11:55 start.ini</pre></div><p>完成后，您可以编辑<code class="literal">start.ini</code>文件以修改任何参数，您可以使用简单的命令运行服务器：</p><div class="screenexample"><pre class="screen">[example-base]$ java -jar $JETTY_HOME/start.jar</pre></div></div></div></div><script type="text/javascript">
      SyntaxHighlighter.all()
    </script><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tbody><tr><td width="40%" align="left"><a href="jetty-admin-guide.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><td width="20%" align="center"><a href="jetty-admin-guide.html" accesskey="u"><i class="fa fa-chevron-up" aria-hidden="true"></i>最佳</a></td><td width="40%" align="right"> <a href="start-jar.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr><tr><td width="40%" align="left" valign="top">第三部分Jetty管理指南</td><td width="20%" align="center"><a href="index.html" accesskey="h"><i class="fa fa-home" aria-hidden="true"></i>家</a></td><td width="40%" align="right" valign="top">使用start.jar</td></tr></tbody></table></div><p xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"></p><div class="jetty-callout">看到错误或缺少的东西？
            <span class="callout"><a href="http://github.com/eclipse/jetty.project">在以下位置对此文档做出贡献<span class="website"><i class="fa fa-github" aria-hidden="true"></i> Github！</span></a></span> <span style="float:right"><i>（产生：2019-11-20）</i></span></div><p></p></body></html>