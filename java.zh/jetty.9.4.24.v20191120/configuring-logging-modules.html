<html ><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Jetty记录集成（SLF4J，Log4j，Logback，JCL，JUL）</title><link rel="stylesheet" type="text/css" href="css/docbook.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="jetty, servlet, servlet-api, cometd, http, websocket, eclipse, maven, java, server, software"><link rel="home" href="index.html" title="Jetty"><link rel="up" href="configuring-logging.html" title="Chapter 11. Jetty Logging"><link rel="prev" href="configuring-jetty-request-logs.html" title="Configuring Jetty Request Logs"><link rel="next" href="example-logging-logback-centralized.html" title="Centralized Logging using Logback"><link rel="shortcut icon" href="images/favicon.ico" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><link rel="stylesheet" href="css/highlighter/foundation.css"><script src="js/highlight.pack.js"></script><script>
      hljs.initHighlightingOnLoad();
    </script><link type="text/css" rel="stylesheet" href="css/font-awesome/font-awesome.min.css"></head><body bgcolor="white"  text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><tbody><tr><td style="width:25%"><a href="http://www.eclipse.org/jetty"><img src="images/jetty-header-logo.png" alt="Jetty标志"></a><br><span style="font-size:small">版本：9.4.24.v20191120</span></td><td style="width:50%"></td></tr></tbody></table><div class="navheader" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><table width="100%" summary="Navigation header"><tbody><tr><th colspan="3" align="center">Jetty记录集成（SLF4J，Log4j，Logback，JCL，JUL）</th></tr><tr><td width="20%" align="left"><a href="configuring-jetty-request-logs.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><th width="60%" align="center">第十一章Jetty记录<br><a href="index.html" accesskey="p"><i class="fa fa-home" aria-hidden="true"></i>家</a></th><td width="20%" align="right"> <a href="example-logging-logback-centralized.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr></tbody></table><hr></div><div class="jetty-callout" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><h5 class="callout"><a href="http://www.webtide.com/">通过<span class="website">www.webtide.com</span>与Jetty核心开发人员联系。</a></h5><p>内部/客户项目的私人支持...自定义扩展和发行版...无限期支持的版本快照...您的应用程序和Ajax / Comet项目的可伸缩性指南...赞助功能开发的开发服务</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear:both"><a name="configuring-logging-modules"></a>Jetty记录集成（SLF4J，Log4j，Logback，JCL，JUL）</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="configuring-logging-modules.html#example-logging-slf4j">使用SLF4J记录</a></span></dt><dt><span class="section"><a href="configuring-logging-modules.html#example-logging-log4j">使用Log4j和Log4j2记录</a></span></dt><dt><span class="section"><a href="configuring-logging-modules.html#example-logging-logback">使用Logback登录</a></span></dt><dt><span class="section"><a href="configuring-logging-modules.html#_logging_with_java_util_logging">使用Java Util日志记录</a></span></dt><dt><span class="section"><a href="configuring-logging-modules.html#_capturing_console_output">捕获控制台输出</a></span></dt></dl></div><p>Jetty支持多种日志记录框架，包括SLF4J，Java Commons Logging（JCL），Java Util Logging（JUL），Log4j（包括版本2）和Logback。该页面包含有关如何为这些不同框架启用关联模块的示例。这些模块旨在捕获容器/服务器日志； <a class="link" href="configuring-jetty-request-logs.html" title="配置Jetty请求日志">请求日志</a>和应用程序日志需要分别配置。请注意，启用这些模块为每个框架提供了典型的基本功能；高级实现可能需要其<a class="link" href="startup-modules.html" title="管理启动模块">自己的模块</a>或其他配置。</p><p>在Jetty发行版中启用这些框架与激活任何其他模块一样简单，只需添加<code class="literal">--add-to-start=<module name></code>服务器的启动命令，例如：</p><div class="screenexample"><pre class="screen">[my-base]$ java -jar ../start.jar --add-to-start=logging-jetty
INFO  : logging-jetty   initialized in ${jetty.base}/start.d/logging-jetty.ini
INFO  : resources       transitively enabled
MKDIR : ${jetty.base}/resources
COPY  : ${jetty.home}/modules/logging-jetty/resources/jetty-logging.properties to ${jetty.base}/resources/jetty-logging.properties
INFO  : Base directory was modified</pre></div><p>如上所述，Jetty支持多种日志记录技术。如果特定的日志记录框架需要其他jar文件，则Jetty将在启用关联模块的过程中自动下载这些文件，并且所有依赖模块将被可传递地启用。</p><p>通过运行以下基本Jetty日志记录模块的列表<code class="literal">java -jar <path-to-jetty.home>/start.jar --list-modules=logging,-internal</code> 。</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">日志记录</span></dt><dd>使用SLF4J作为绑定，将Jetty日志配置为使用Java Commons Logging（JCL）。</dd><dt><span class="term">伐木Jetty</span></dt><dd>捕获的标准Jetty日志记录<code class="literal">System.err</code>和<code class="literal">System.out</code>输出。</dd><dt><span class="term">日志记录</span></dt><dd>使用SLF4J作为绑定，将Jetty日志配置为使用Java Util日志（JUL）。</dd><dt><span class="term">日志记录log4j</span></dt><dd>使用SLF4J作为绑定，将Jetty日志配置为使用Log4j作为日志实现。</dd><dt><span class="term">日志记录log4j2</span></dt><dd>使用SLF4J作为绑定，将Jetty日志配置为使用Log4j2作为日志实现。</dd><dt><span class="term">记录-回送</span></dt><dd>使用SLF4J作为绑定，将Jetty日志配置为使用Logback作为日志实现。</dd><dt><span class="term">日志记录-slf4j</span></dt><dd>配置Jetty日志以使用SLF4J并提供<code class="literal">slf4j-impl</code>可以由其他日志记录框架使用。如果未配置其他日志记录， <code class="literal">slf4j-simple</code>用来。</dd></dl></div><p>您可以通过运行以下命令查看<span class="strong"><strong>所有</strong></span> Jetty日志记录模块的列表： <code class="literal">java -jar <path-to-jetty.home>/start.jar --list-modules=logging</code> 。这将显示所有日志记录模块，包括实现和绑定模块。</p><p>所有这些模块（ <code class="literal">logging-jetty</code> ）安排将Jetty私有日志记录API路由到实际记录的命名技术。例如，启用<code class="literal">logging-log4j</code>模块将执行以下几项操作：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem">它启用了内部Log4j API模块，以便任何使用Log4j的容器代码都可以找到该API。</li><li class="listitem">它启用了内部Log4j实现，因此使用Log4j API的任何容器代码也将使用Log4j实现来处理日志（以及所有常规Log4j配置机制等）。</li><li class="listitem">它启用内部<code class="literal">slf4j-log4j</code>记录绑定，以便任何使用SLF4j API的容器代码也可以通过Log4j API使用Log4j实现。</li><li class="listitem">它将Jetty日志记录API配置为使用SLF4J API，然后将其绑定到Log4j。</li></ul></div><p>因此，启用后<code class="literal">logging-log4j</code> ，在服务器容器内有3种可用的日志记录API：Jetty，SLF4J和Log4J。但是只有一个日志记录<span class="strong"><strong>实现</strong></span> -Log4j;这3个API仅充当Log4j实现的基础。</p><p>请注意，您可以向此配置添加其他API。例如，启用内部模块<code class="literal">jcl-slf4j</code>将添加Java Commons Logging门面，该门面还将通过SLF4J绑定使用Log4j实现。</p><p>大多数其他顶级日志记录模块以相同的方式工作： <code class="literal">logging-jcl</code> ， <code class="literal">logging-jul</code> ， <code class="literal">logging-slf4j</code> ， <code class="literal">logging-log4j2</code>和<code class="literal">logging-logback</code>全部通过SLF4J绑定其实现。</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="example-logging-slf4j"></a>使用SLF4J记录</h3></div></div></div><p>Jetty使用SLF4J api作为绑定来向其他框架（例如Log4j或Logback）提供日志记录信息。也可以单独使用它来提供简单的服务器日志记录。要启用SLF4J框架，您需要激活<code class="literal">logging-slf4j</code>模块。</p><div class="screenexample"><pre class="screen">[my-base]$ java -jar ../start.jar --add-to-start=logging-slf4j

ALERT: There are enabled module(s) with licenses.
The following 1 module(s):
 + contains software not provided by the Eclipse Foundation!
 + contains software not covered by the Eclipse Public License!
 + has not been audited for compliance with its license

 Module: slf4j-api
  + SLF4J is distributed under the MIT License.
  + Copyright (c) 2004-2013 QOS.ch
  + All rights reserved.
  + Permission is hereby granted, free  of charge, to any person obtaining
  + a  copy  of this  software  and  associated  documentation files  (the
  + "Software"), to  deal in  the Software without  restriction, including
  + without limitation  the rights to  use, copy, modify,  merge, publish,
  + distribute,  sublicense, and/or sell  copies of  the Software,  and to
  + permit persons to whom the Software  is furnished to do so, subject to
  + the following conditions:
  + The  above  copyright  notice  and  this permission  notice  shall  be
  + included in all copies or substantial portions of the Software.
  + THE  SOFTWARE IS  PROVIDED  "AS  IS", WITHOUT  WARRANTY  OF ANY  KIND,
  + EXPRESS OR  IMPLIED, INCLUDING  BUT NOT LIMITED  TO THE  WARRANTIES OF
  + MERCHANTABILITY,    FITNESS    FOR    A   PARTICULAR    PURPOSE    AND
  + NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  + LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
  + OF CONTRACT, TORT OR OTHERWISE,  ARISING FROM, OUT OF OR IN CONNECTION
  + WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

Proceed (y/N)? y
INFO  : slf4j-api       transitively enabled
INFO  : logging-slf4j   initialized in ${jetty.base}/start.d/logging-slf4j.ini
MKDIR : ${jetty.base}/lib/slf4j
DOWNLD: https://repo1.maven.org/maven2/org/slf4j/slf4j-api/1.7.21/slf4j-api-1.7.21.jar to ${jetty.base}/lib/slf4j/slf4j-api-1.7.21.jar
INFO  : Base directory was modified
ERROR : Module logging-slf4j requires a module providing slf4j-impl from one of [slf4j-simple-impl, slf4j-logback, slf4j-jul, slf4j-log4j2, slf4j-log4j]

ERROR : Unsatisfied module dependencies: logging-slf4j

Usage: java -jar $JETTY_HOME/start.jar [options] [properties] [configs]
       java -jar $JETTY_HOME/start.jar --help  # for more information</pre></div><p>您可能已经注意到，系统会提供<code class="literal">ERROR</code>尝试启用<code class="literal">logging-slf4j</code>在其自己的。的<code class="literal">logging-slf4j</code>模块本身提供SLF4J api，但是由于SLF4J通常用作其他日志记录框架的绑定，因此默认情况下不提供实现。要启用简单的SLF4J实现，我们还需要激活<code class="literal">slf4j-simple-impl</code>模块。</p><div class="screenexample"><pre class="screen">[my-base]$ java -jar ../start.jar --add-to-start=slf4j-simple-impl
INFO  : slf4j-simple-impl initialized in ${jetty.base}/start.d/slf4j-simple-impl.ini
INFO  : resources       transitively enabled
DOWNLD: https://repo1.maven.org/maven2/org/slf4j/slf4j-simple/1.7.21/slf4j-simple-1.7.21.jar to ${jetty.base}/lib/slf4j/slf4j-simple-1.7.21.jar
MKDIR : ${jetty.base}/resources
COPY  : ${jetty.home}/modules/slf4j-simple-impl/resources/simplelogger.properties to ${jetty.base}/resources/simplelogger.properties
INFO  : Base directory was modified

[my-base]$ tree
.
&#9500;&#9472;&#9472; lib
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; slf4j
&#9474;&nbsp;&nbsp;     &#9500;&#9472;&#9472; slf4j-api-1.7.21.jar
&#9474;&nbsp;&nbsp;     &#9492;&#9472;&#9472; slf4j-simple-1.7.21.jar
&#9500;&#9472;&#9472; resources
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; simplelogger.properties
&#9492;&#9472;&#9472; start.d
    &#9500;&#9472;&#9472; logging-slf4j.ini
    &#9492;&#9472;&#9472; slf4j-simple-impl.ini</pre></div><p>现在，将Jetty配置为使用SLF4J框架进行日志记录。标准SLF4J属性文件位于<code class="literal">${jetty.base}/resources/simplelogger.properties</code> 。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="example-logging-log4j"></a>使用Log4j和Log4j2记录</h3></div></div></div><p>可以配置Jetty服务器日志记录，以便Log4j或Log4j2控制Jetty生成的日志记录事件的输出。这是通过配置Jetty通过<a class="link" href="http://slf4j.org/manual.html" target="_top">Slf4j</a>登录到<a class="link" href="http://logging.apache.org/log4j/" target="_top">Apache Log4j</a>以及<a class="link" href="http://logging.apache.org/log4j/" target="_top">Log4j</a>的<a class="link" href="http://slf4j.org/manual.html#swapping" target="_top">Slf4j绑定层来实现的</a> 。可以通过启用Log4j来实现<code class="literal">logging-log4j</code>模块。</p><div class="screenexample"><pre class="screen">[my-base]$ java -jar ../start.jar --add-to-start=logging-log4j

ALERT: There are enabled module(s) with licenses.
The following 2 module(s):
 + contains software not provided by the Eclipse Foundation!
 + contains software not covered by the Eclipse Public License!
 + has not been audited for compliance with its license

 Module: log4j-impl
  + Log4j is released under the Apache 2.0 license.
  + http://www.apache.org/licenses/LICENSE-2.0.html

 Module: slf4j-api
  + SLF4J is distributed under the MIT License.
  + Copyright (c) 2004-2013 QOS.ch
  + All rights reserved.
  + Permission is hereby granted, free  of charge, to any person obtaining
  + a  copy  of this  software  and  associated  documentation files  (the
  + "Software"), to  deal in  the Software without  restriction, including
  + without limitation  the rights to  use, copy, modify,  merge, publish,
  + distribute,  sublicense, and/or sell  copies of  the Software,  and to
  + permit persons to whom the Software  is furnished to do so, subject to
  + the following conditions:
  + The  above  copyright  notice  and  this permission  notice  shall  be
  + included in all copies or substantial portions of the Software.
  + THE  SOFTWARE IS  PROVIDED  "AS  IS", WITHOUT  WARRANTY  OF ANY  KIND,
  + EXPRESS OR  IMPLIED, INCLUDING  BUT NOT LIMITED  TO THE  WARRANTIES OF
  + MERCHANTABILITY,    FITNESS    FOR    A   PARTICULAR    PURPOSE    AND
  + NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  + LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
  + OF CONTRACT, TORT OR OTHERWISE,  ARISING FROM, OUT OF OR IN CONNECTION
  + WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

Proceed (y/N)? y
INFO  : slf4j-api       transitively enabled
INFO  : log4j-impl      transitively enabled
INFO  : resources       transitively enabled
INFO  : slf4j-log4j     transitively enabled
INFO  : logging-log4j   initialized in ${jetty.base}/start.d/logging-log4j.ini
MKDIR : ${jetty.base}/lib/slf4j
DOWNLD: https://repo1.maven.org/maven2/org/slf4j/slf4j-api/1.7.21/slf4j-api-1.7.21.jar to ${jetty.base}/lib/slf4j/slf4j-api-1.7.21.jar
MKDIR : ${jetty.base}/lib/log4j
COPY  : /Users/admin/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar to ${jetty.base}/lib/log4j/log4j-1.2.17.jar
MKDIR : ${jetty.base}/resources
COPY  : ${jetty.home}/modules/log4j-impl/resources/log4j.xml to ${jetty.base}/resources/log4j.xml
DOWNLD: https://repo1.maven.org/maven2/org/slf4j/slf4j-log4j12/1.7.21/slf4j-log4j12-1.7.21.jar to ${jetty.base}/lib/slf4j/slf4j-log4j12-1.7.21.jar
INFO  : Base directory was modified

[my-base]$ tree
.
&#9500;&#9472;&#9472; lib
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; log4j
&#9474;&nbsp;&nbsp; &#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; log4j-1.2.17.jar
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; slf4j
&#9474;&nbsp;&nbsp;     &#9500;&#9472;&#9472; slf4j-api-1.7.21.jar
&#9474;&nbsp;&nbsp;     &#9492;&#9472;&#9472; slf4j-log4j12-1.7.21.jar
&#9500;&#9472;&#9472; resources
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; log4j.xml
&#9492;&#9472;&#9472; start.d
    &#9492;&#9472;&#9472; logging-log4j.ini</pre></div><p>现在，将Jetty配置为使用Log4j框架进行日志记录。标准Log4j配置文件位于<code class="literal">${jetty.base}/resources/log4j.xml</code> 。</p><p>或者，要设置Log4j2，请启用<code class="literal">logging-log4j2</code>模块。</p><div class="screenexample"><pre class="screen">[my-base]$ java -jar ../start.jar --add-to-start=logging-log4j2

ALERT: There are enabled module(s) with licenses.
The following 2 module(s):
 + contains software not provided by the Eclipse Foundation!
 + contains software not covered by the Eclipse Public License!
 + has not been audited for compliance with its license

 Module: log4j2-api
  + Log4j is released under the Apache 2.0 license.
  + http://www.apache.org/licenses/LICENSE-2.0.html

 Module: slf4j-api
  + SLF4J is distributed under the MIT License.
  + Copyright (c) 2004-2013 QOS.ch
  + All rights reserved.
  + Permission is hereby granted, free  of charge, to any person obtaining
  + a  copy  of this  software  and  associated  documentation files  (the
  + "Software"), to  deal in  the Software without  restriction, including
  + without limitation  the rights to  use, copy, modify,  merge, publish,
  + distribute,  sublicense, and/or sell  copies of  the Software,  and to
  + permit persons to whom the Software  is furnished to do so, subject to
  + the following conditions:
  + The  above  copyright  notice  and  this permission  notice  shall  be
  + included in all copies or substantial portions of the Software.
  + THE  SOFTWARE IS  PROVIDED  "AS  IS", WITHOUT  WARRANTY  OF ANY  KIND,
  + EXPRESS OR  IMPLIED, INCLUDING  BUT NOT LIMITED  TO THE  WARRANTIES OF
  + MERCHANTABILITY,    FITNESS    FOR    A   PARTICULAR    PURPOSE    AND
  + NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  + LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
  + OF CONTRACT, TORT OR OTHERWISE,  ARISING FROM, OUT OF OR IN CONNECTION
  + WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

Proceed (y/N)? y
INFO  : slf4j-api       transitively enabled
INFO  : logging-log4j2  initialized in ${jetty.base}/start.d/logging-log4j2.ini
INFO  : log4j2-api      transitively enabled
INFO  : resources       transitively enabled
INFO  : slf4j-log4j2    transitively enabled
INFO  : log4j2-impl     transitively enabled
MKDIR : ${jetty.base}/lib/slf4j
DOWNLD: https://repo1.maven.org/maven2/org/slf4j/slf4j-api/1.7.21/slf4j-api-1.7.21.jar to ${jetty.base}/lib/slf4j/slf4j-api-1.7.21.jar
MKDIR : ${jetty.base}/lib/log4j2
DOWNLD: https://repo1.maven.org/maven2/org/apache/logging/log4j/log4j-api/2.6.1/log4j-api-2.6.1.jar to ${jetty.base}/lib/log4j2/log4j-api-2.6.1.jar
MKDIR : ${jetty.base}/resources
DOWNLD: https://repo1.maven.org/maven2/org/apache/logging/log4j/log4j-slf4j-impl/2.6.1/log4j-slf4j-impl-2.6.1.jar to ${jetty.base}/lib/log4j2/log4j-slf4j-impl-2.6.1.jar
DOWNLD: https://repo1.maven.org/maven2/org/apache/logging/log4j/log4j-core/2.6.1/log4j-core-2.6.1.jar to ${jetty.base}/lib/log4j2/log4j-core-2.6.1.jar
COPY  : ${jetty.home}/modules/log4j2-impl/resources/log4j2.xml to ${jetty.base}/resources/log4j2.xml
INFO  : Base directory was modified

[my-base]$ tree
.
&#9500;&#9472;&#9472; lib
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; log4j2
&#9474;&nbsp;&nbsp; &#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; log4j-api-2.6.1.jar
&#9474;&nbsp;&nbsp; &#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; log4j-core-2.6.1.jar
&#9474;&nbsp;&nbsp; &#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; log4j-slf4j-impl-2.6.1.jar
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; slf4j
&#9474;&nbsp;&nbsp;     &#9492;&#9472;&#9472; slf4j-api-1.7.21.jar
&#9500;&#9472;&#9472; resources
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; log4j2.xml
&#9492;&#9472;&#9472; start.d
    &#9492;&#9472;&#9472; logging-log4j2.ini</pre></div><p>此时，已配置了Jetty，以便Jetty服务器本身将使用Log4j2中的Log4j2配置来记录日志。 <code class="literal">{$jetty.base}/resources/log4j2.xml</code> 。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="example-logging-logback"></a>使用Logback登录</h3></div></div></div><p>可以配置Jetty服务器日志记录，以便Logback控制Jetty生成的日志记录事件的输出。这是通过配置Jetty记录到<code class="literal">Logback</code> ，它使用<a class="link" href="http://slf4j.org/manual.html" target="_top">Slf4j</a>和<a class="link" href="http://logback.qos.ch/" target="_top">Slf4j的Logback实现</a> 。</p><p>要通过Logback设置Jetty日志记录，请启用<code class="literal">logging-logback</code>模块。</p><div class="screenexample"><pre class="screen">[my-base]$ java -jar ../start.jar --add-to-start=logging-logback

ALERT: There are enabled module(s) with licenses.
The following 2 module(s):
 + contains software not provided by the Eclipse Foundation!
 + contains software not covered by the Eclipse Public License!
 + has not been audited for compliance with its license

 Module: logback-impl
  + Logback: the reliable, generic, fast and flexible logging framework.
  + Copyright (C) 1999-2012, QOS.ch. All rights reserved.
  + This program and the accompanying materials are dual-licensed under
  + either:
  + the terms of the Eclipse Public License v1.0
  + as published by the Eclipse Foundation:
  + http://www.eclipse.org/legal/epl-v10.html
  + or (per the licensee's choosing) under
  + the terms of the GNU Lesser General Public License version 2.1
  + as published by the Free Software Foundation:
  + http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html

 Module: slf4j-api
  + SLF4J is distributed under the MIT License.
  + Copyright (c) 2004-2013 QOS.ch
  + All rights reserved.
  + Permission is hereby granted, free  of charge, to any person obtaining
  + a  copy  of this  software  and  associated  documentation files  (the
  + "Software"), to  deal in  the Software without  restriction, including
  + without limitation  the rights to  use, copy, modify,  merge, publish,
  + distribute,  sublicense, and/or sell  copies of  the Software,  and to
  + permit persons to whom the Software  is furnished to do so, subject to
  + the following conditions:
  + The  above  copyright  notice  and  this permission  notice  shall  be
  + included in all copies or substantial portions of the Software.
  + THE  SOFTWARE IS  PROVIDED  "AS  IS", WITHOUT  WARRANTY  OF ANY  KIND,
  + EXPRESS OR  IMPLIED, INCLUDING  BUT NOT LIMITED  TO THE  WARRANTIES OF
  + MERCHANTABILITY,    FITNESS    FOR    A   PARTICULAR    PURPOSE    AND
  + NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  + LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
  + OF CONTRACT, TORT OR OTHERWISE,  ARISING FROM, OUT OF OR IN CONNECTION
  + WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

Proceed (y/N)? y
INFO  : slf4j-api       transitively enabled
INFO  : logback-impl    transitively enabled
INFO  : slf4j-logback   transitively enabled
INFO  : logging-logback initialized in ${jetty.base}/start.d/logging-logback.ini
INFO  : resources       transitively enabled
MKDIR : ${jetty.base}/lib/slf4j
DOWNLD: https://repo1.maven.org/maven2/org/slf4j/slf4j-api/1.7.21/slf4j-api-1.7.21.jar to ${jetty.base}/lib/slf4j/slf4j-api-1.7.21.jar
MKDIR : ${jetty.base}/lib/logback
DOWNLD: https://repo1.maven.org/maven2/ch/qos/logback/logback-core/1.1.7/logback-core-1.1.7.jar to ${jetty.base}/lib/logback/logback-core-1.1.7.jar
MKDIR : ${jetty.base}/resources
COPY  : ${jetty.home}/modules/logback-impl/resources/logback.xml to ${jetty.base}/resources/logback.xml
DOWNLD: https://repo1.maven.org/maven2/ch/qos/logback/logback-classic/1.1.7/logback-classic-1.1.7.jar to ${jetty.base}/lib/logback/logback-classic-1.1.7.jar
INFO  : Base directory was modified

[my-base]$ tree
.
&#9500;&#9472;&#9472; lib
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; logback
&#9474;&nbsp;&nbsp; &#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; logback-classic-1.1.7.jar
&#9474;&nbsp;&nbsp; &#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; logback-core-1.1.7.jar
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; slf4j
&#9474;&nbsp;&nbsp;     &#9492;&#9472;&#9472; slf4j-api-1.7.21.jar
&#9500;&#9472;&#9472; resources
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; logback.xml
&#9492;&#9472;&#9472; start.d
    &#9492;&#9472;&#9472; logging-logback.ini</pre></div><p>此时，已配置了Jetty，以便Jetty服务器本身将使用Logback（使用在以下位置找到的Logback配置）进行日志记录： <code class="literal">{$jetty.base}/resources/logback.xml</code> 。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_logging_with_java_util_logging"></a>使用Java Util日志记录</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="example-logging-java-util-logging"></a>使用SLF4J的Java Util日志记录</h4></div></div></div><p>可以配置Jetty服务器日志记录，以便<code class="literal">java.util.logging</code>控制Jetty产生的日志事件的输出。</p><p>本示例演示了如何配置Jetty以登录到<code class="literal">java.util.logging</code>通过<a class="link" href="http://slf4j.org/manual.html" target="_top">SLF4J</a>作为绑定层。</p><div class="screenexample"><pre class="screen">[my-base]$ java -jar ../start.jar --add-to-start=logging-jul

ALERT: There are enabled module(s) with licenses.
The following 1 module(s):
 + contains software not provided by the Eclipse Foundation!
 + contains software not covered by the Eclipse Public License!
 + has not been audited for compliance with its license

 Module: slf4j-api
  + SLF4J is distributed under the MIT License.
  + Copyright (c) 2004-2013 QOS.ch
  + All rights reserved.
  + Permission is hereby granted, free  of charge, to any person obtaining
  + a  copy  of this  software  and  associated  documentation files  (the
  + "Software"), to  deal in  the Software without  restriction, including
  + without limitation  the rights to  use, copy, modify,  merge, publish,
  + distribute,  sublicense, and/or sell  copies of  the Software,  and to
  + permit persons to whom the Software  is furnished to do so, subject to
  + the following conditions:
  + The  above  copyright  notice  and  this permission  notice  shall  be
  + included in all copies or substantial portions of the Software.
  + THE  SOFTWARE IS  PROVIDED  "AS  IS", WITHOUT  WARRANTY  OF ANY  KIND,
  + EXPRESS OR  IMPLIED, INCLUDING  BUT NOT LIMITED  TO THE  WARRANTIES OF
  + MERCHANTABILITY,    FITNESS    FOR    A   PARTICULAR    PURPOSE    AND
  + NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  + LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
  + OF CONTRACT, TORT OR OTHERWISE,  ARISING FROM, OUT OF OR IN CONNECTION
  + WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

Proceed (y/N)? y
INFO  : jul-impl        transitively enabled
INFO  : slf4j-api       transitively enabled
INFO  : slf4j-jul       transitively enabled
INFO  : logging-jul     initialized in ${jetty.base}/start.d/logging-jul.ini
INFO  : resources       transitively enabled
MKDIR : ${jetty.base}/etc
COPY  : ${jetty.home}/modules/jul-impl/etc/java-util-logging.properties to ${jetty.base}/etc/java-util-logging.properties
MKDIR : ${jetty.base}/lib/slf4j
DOWNLD: https://repo1.maven.org/maven2/org/slf4j/slf4j-api/1.7.21/slf4j-api-1.7.21.jar to ${jetty.base}/lib/slf4j/slf4j-api-1.7.21.jar
DOWNLD: https://repo1.maven.org/maven2/org/slf4j/slf4j-jdk14/1.7.21/slf4j-jdk14-1.7.21.jar to ${jetty.base}/lib/slf4j/slf4j-jdk14-1.7.21.jar
INFO  : Base directory was modified

[my-base]$ tree
.
&#9500;&#9472;&#9472; etc
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; java-util-logging.properties
&#9500;&#9472;&#9472; lib
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; slf4j
&#9474;&nbsp;&nbsp;     &#9500;&#9472;&#9472; slf4j-api-1.7.21.jar
&#9474;&nbsp;&nbsp;     &#9492;&#9472;&#9472; slf4j-jdk14-1.7.21.jar
&#9492;&#9472;&#9472; start.d
    &#9492;&#9472;&#9472; logging-jul.ini</pre></div><p>现在，Jetty已配置为使用JUL框架进行日志记录。标准的JUL属性文件位于<code class="literal">${jetty.base}/etc/java-util-logging.properties</code> 。</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_capturing_console_output"></a>捕获控制台输出</h3></div></div></div><p>默认情况下，启用以上模块会将日志信息输出到控制台。分发中包括<code class="literal">console-capture</code>模块，可用于替代所选日志记录模块的其他配置，以将该输出捕获到<code class="literal">logs</code>您的目录<code class="literal">${jetty.base}</code> 。要启用此功能，请激活<code class="literal">console-capture</code>模块。</p><div class="screenexample"><pre class="screen">[my-base]$ java -jar ../start.jar --add-to-start=console-capture
INFO  : console-capture initialized in ${jetty.base}/start.d/console-capture.ini
MKDIR : ${jetty.base}/logs
INFO  : Base directory was modified

[my-base]$ tree
.
&#9500;&#9472;&#9472; logs
&#9492;&#9472;&#9472; start.d
    &#9492;&#9472;&#9472; console-capture.ini</pre></div><p>例如，这是使用之前的Logback的输出<code class="literal">console-capture</code>模块：</p><div class="screenexample"><pre class="screen">[my-base]$ java -jar ../start.jar
419  [main] INFO  org.eclipse.jetty.util.log - Logging initialized @508ms to org.eclipse.jetty.util.log.Slf4jLog
540  [main] INFO  org.eclipse.jetty.server.Server - jetty-9.4.0-SNAPSHOT
575  [main] INFO  o.e.jetty.server.AbstractConnector - Started ServerConnector@3c0ecd4b{HTTP/1.1,[http/1.1]}{0.0.0.0:8080}
575  [main] INFO  org.eclipse.jetty.server.Server - Started @668ms</pre></div><p>启用后<code class="literal">console-capture</code> ，输出如下，其中显示了将日志保存到的位置：</p><div class="screenexample"><pre class="screen">[my-base]$ java -jar ../start.jar
151  [main] INFO  org.eclipse.jetty.util.log - Logging initialized @238ms to org.eclipse.jetty.util.log.Slf4jLog
196  [main] INFO  org.eclipse.jetty.util.log - Console stderr/stdout captured to /installs/jetty-distribution/mybase/logs/2016_10_21.jetty.log</pre></div></div></div><script type="text/javascript">
      SyntaxHighlighter.all()
    </script><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tbody><tr><td width="40%" align="left"><a href="configuring-jetty-request-logs.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><td width="20%" align="center"><a href="configuring-logging.html" accesskey="u"><i class="fa fa-chevron-up" aria-hidden="true"></i>最佳</a></td><td width="40%" align="right"> <a href="example-logging-logback-centralized.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr><tr><td width="40%" align="left" valign="top">配置Jetty请求日志</td><td width="20%" align="center"><a href="index.html" accesskey="h"><i class="fa fa-home" aria-hidden="true"></i>家</a></td><td width="40%" align="right" valign="top">使用Logback进行集中式日志记录</td></tr></tbody></table></div><p xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"></p><div class="jetty-callout">看到错误或缺少的东西？
            <span class="callout"><a href="http://github.com/eclipse/jetty.project">在以下位置对此文档做出贡献<span class="website"><i class="fa fa-github" aria-hidden="true"></i> Github！</span></a></span> <span style="float:right"><i>（产生：2019-11-20）</i></span></div><p></p></body></html>