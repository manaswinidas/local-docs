<html ><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>第八章配置JSP支持</title><link rel="stylesheet" type="text/css" href="css/docbook.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="jetty, servlet, servlet-api, cometd, http, websocket, eclipse, maven, java, server, software"><link rel="home" href="index.html" title="Jetty"><link rel="up" href="jetty-config-guide.html" title="Part II. Jetty Configuration Guide"><link rel="prev" href="spnego-support.html" title="SPNEGO Support"><link rel="next" href="jetty-admin-guide.html" title="Part III. Jetty Administration Guide"><link rel="shortcut icon" href="images/favicon.ico" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><link rel="stylesheet" href="css/highlighter/foundation.css"><script src="js/highlight.pack.js"></script><script>
      hljs.initHighlightingOnLoad();
    </script><link type="text/css" rel="stylesheet" href="css/font-awesome/font-awesome.min.css"></head><body bgcolor="white"  text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><tbody><tr><td style="width:25%"><a href="http://www.eclipse.org/jetty"><img src="images/jetty-header-logo.png" alt="码头标志"></a><br><span style="font-size:small">版本：9.4.24.v20191120</span></td><td style="width:50%"></td></tr></tbody></table><div class="navheader" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><table width="100%" summary="Navigation header"><tbody><tr><th colspan="3" align="center">第八章配置JSP支持</th></tr><tr><td width="20%" align="left"><a href="spnego-support.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><th width="60%" align="center">第二部分码头配置指南<br><a href="index.html" accesskey="p"><i class="fa fa-home" aria-hidden="true"></i>家</a></th><td width="20%" align="right"> <a href="jetty-admin-guide.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr></tbody></table><hr></div><div class="jetty-callout" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><h5 class="callout"><a href="http://www.webtide.com/">通过<span class="website">www.webtide.com</span>与Jetty核心开发人员联系。</a></h5><p>内部/客户项目的私人支持...自定义扩展和发行版...无限期支持的版本快照...您的应用程序和Ajax / Comet项目的可伸缩性指南...赞助功能开发的开发服务</p></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="configuring-jsp"></a>第八章配置JSP支持</h2></div></div></div><div class="toc"><p><b>目录</b></p><dl class="toc"><dt><span class="section"><a href="configuring-jsp.html#jsp-support">配置JSP</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear:both"><a name="jsp-support"></a>配置JSP</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="configuring-jsp.html#which-jsp-implementation">哪个JSP实现</a></span></dt><dt><span class="section"><a href="configuring-jsp.html#_precompiling_jsps">预编译JSP</a></span></dt><dt><span class="section"><a href="configuring-jsp.html#modifying-configuration">修改配置</a></span></dt><dt><span class="section"><a href="configuring-jsp.html#using-jstl-taglibs-for-jetty7-jetty8">使用JSTL Taglibs</a></span></dt><dt><span class="section"><a href="configuring-jsp.html#using-jsf-taglibs">使用JSF Taglibs</a></span></dt></dl></div><p>本文档提供有关为Jetty配置Java服务器页面（JSP）的信息。</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="which-jsp-implementation"></a>哪个JSP实现</h3></div></div></div><p>Jetty使用<a class="link" href="http://tomcat.apache.org/tomcat-8.0-doc/jasper-howto.html" target="_top">Apache的</a> Jasper作为默认的JSP容器实现。</p><p>默认情况下，Jetty发行版启用JSP <a class="link" href="startup-modules.html" title="管理启动模块">模块</a> ，并且默认情况下，此模块设置为Apache Jasper。</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>DO NOT EDIT - See: https://www.eclipse.org/jetty/documentation/current/startup-modules.html

[description]
Enables JSP for all webapplications deployed on the server.

[depend]
servlet
annotations
apache-jsp</code></pre><p>请注意，某些JSP功能的可用性可能取决于您所使用的JSP容器实现。还请注意，可能无法使用一个容器预编译JSP，然后将其部署到另一个容器。</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_jsps_and_embedding"></a> JSP和嵌入</h4></div></div></div><p>如果您的Web应用程序具有嵌入式设置，并且希望使用JSP，则需要确保正确初始化了JSP引擎。</p><p>对于Apache，使用Servlet Specification 3.1样式的<a class="link" href="using-annotations.html#servlet-container-initializers" title="ServletContainerInitializers">ServletContainerInitializer</a>来完成此操作。您将需要确保此ServletContainerInitializer由码头运行。也许最简单的方法是启用注释处理，以便Jetty自动发现并运行它。“ <a class="link" href="embedded-examples.html" title="嵌入式示例">嵌入式示例”</a>部分包含有关如何执行此操作的<a class="link" href="embedded-examples.html#embedded-webapp-jsp" title="使用JSP的Web应用程序">代码示例</a> 。</p><p>或者，您可以手动连接适当的ServletContainerInitializer，如<a class="link" href="https://github.com/jetty-project" target="_top">GitHub上</a>的<a class="link" href="https://github.com/jetty-project/embedded-jetty-jsp/blob/master/src/main/java/org/eclipse/jetty/demo/Main.java" target="_top">Embedded-jetty-jsp</a>示例所示，在这种情况下，您将不需要classpath上的jetty-annotations jar，也无需在<a class="link" href="configuring-webapps.html#webapp-configurations" title="配置类">配置类</a>列表中包括AnnotationConfiguration。</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_precompiling_jsps"></a>预编译JSP</h3></div></div></div><p>您可以按照Apache提供的预编译说明进行操作，或者如果您使用Maven进行构建，则可以使用<a class="link" href="jetty-jspc-maven-plugin.html" title="Jetty Jspc Maven插件">jetty-jspc-maven</a>插件为您完成此操作。</p><p>如果您已经预编译了JSP，并且已经定制了输出包前缀（即<code class="literal">org.apache.jsp</code>默认情况下），您应该配置webapp上下文以告知Jetty此自定义包名称。您可以使用servlet上下文init-param <code class="literal">org.eclipse.jetty.servlet.jspPackagePrefix</code> 。</p><p>例如，假设您已使用自定义软件包前缀预先编译了JSP。 <code class="literal">com.acme</code> ，然后将以下几行添加到您的<code class="literal">web.xml</code>文件：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>  &lt;context-param&gt;
    &lt;param-name&gt;org.eclipse.jetty.servlet.jspPackagePrefix&lt;/param-name&gt;
    &lt;param-value&gt;com.acme&lt;/param-value&gt;
  &lt;/context-param&gt;</code></pre><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>Jetty Maven插件<a class="link" href="jetty-jspc-maven-plugin.html" title="Jetty Jspc Maven Plugin">-jetty-jspc-maven-plugin</a>和<a class="link" href="jetty-maven-plugin.html" title="配置Jetty Maven插件">jetty-maven</a> <a class="link" href="jetty-jspc-maven-plugin.html" title="Jetty Jspc Maven插件">-plugin-</a>都将仅使用Apache Jasper。</p></div></blockquote></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="compiling-jsps"></a> Apache JSP容器</h4></div></div></div><p>默认情况下，Apache JSP容器将查找Eclipse Java编译器（jdt）。Jetty发行版本在<code class="literal">{$jetty.home}/lib/apache-jsp</code> 。如果您希望使用其他编译器，则需要配置<code class="literal">compilerClassName</code>初始化参数<code class="literal">JspServlet</code>与班级名称。</p><div class="table"><a name="d0e8493"></a><p class="title"><b>表8.1。了解Apache JspServlet参数</b></p><div class="table-contents"><table class="table" border="1" summary="Understanding Apache JspServlet Parameters"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"><col class="col_4"></colgroup><thead><tr><th align="left" valign="top">初始化参数</th><th align="left" valign="top">描述</th><th align="left" valign="top">默认</th><th align="left" valign="top"><code class="literal">webdefault.xml</code></th></tr></thead><tbody><tr><td align="left" valign="top"><p>类路径</p></td><td align="left" valign="top"><p><code class="literal">Classpath used for jsp compilation. Only used if org.apache.catalina.jsp_classpath context attribute is not set, which it is in Jetty.</code></p></td><td align="left" valign="top"><p>--</p></td><td align="left" valign="top"><p>–</p></td></tr><tr><td align="left" valign="top"><p>classdebuginfo</p></td><td align="left" valign="top"><p>在类文件中包含调试信息。</p></td><td align="left" valign="top"><p>真正</p></td><td align="left" valign="top"><p>–</p></td></tr><tr><td align="left" valign="top"><p>checkInterval</p></td><td align="left" valign="top"><p>后台重新编译检查之间的间隔（以秒为单位）。仅在“ development = false”时相关。</p></td><td align="left" valign="top"><p>0</p></td><td align="left" valign="top"><p>–</p></td></tr><tr><td align="left" valign="top"><p>发展</p></td><td align="left" valign="top"><p><code class="literal">development=true</code> ，每个请求都会进行重新编译检查。另见`modificationTestInterval`。</p></td><td align="left" valign="top"><p>真正</p></td><td align="left" valign="top"><p>–</p></td></tr><tr><td align="left" valign="top"><p>displaySourceFragment</p></td><td align="left" valign="top"><p>源片段是否应包括在异常消息中</p></td><td align="left" valign="top"><p>真正</p></td><td align="left" valign="top"><p>–</p></td></tr><tr><td align="left" valign="top"><p>errorOnUseBeanInvalidClassAttribute</p></td><td align="left" valign="top"><p>当useBean操作中的class属性的值不是有效的bean类时，Jasper是否应该发出错误？</p></td><td align="left" valign="top"><p>真正</p></td><td align="left" valign="top"><p>–</p></td></tr><tr><td align="left" valign="top"><p>叉子</p></td><td align="left" valign="top"><p>Ant是否应该派生其JSP页面的Java编译？</p></td><td align="left" valign="top"><p>真正</p></td><td align="left" valign="top"><p>假</p></td></tr><tr><td align="left" valign="top"><p>保持生成</p></td><td align="left" valign="top"><p>您是否要保留生成的Java文件？</p></td><td align="left" valign="top"><p>真正</p></td><td align="left" valign="top"><p>–</p></td></tr><tr><td align="left" valign="top"><p>trimSpaces</p></td><td align="left" valign="top"><p>指令或动作之间的空白是否应该修剪？</p></td><td align="left" valign="top"><p>假</p></td><td align="left" valign="top"><p>–</p></td></tr><tr><td align="left" valign="top"><p>enablePooling</p></td><td align="left" valign="top"><p>确定是否启用了标记处理程序池。</p></td><td align="left" valign="top"><p>真正</p></td><td align="left" valign="top"><p>–</p></td></tr><tr><td align="left" valign="top"><p>engineOptionsClass</p></td><td align="left" valign="top"><p>允许指定用于配置Jasper的Options类。如果不存在，将使用默认的EmbeddedServletOptions。</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>映射文件</p></td></tr><tr><td align="left" valign="top"><p>支持映射文件。生成一个servlet，该servlet在JSP文件的每一行都有一个打印语句</p></td><td align="left" valign="top"><p>真正</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>抑制图</p></td></tr><tr><td align="left" valign="top"><p>生成用于JSR45调试的SMAP信息。</p></td><td align="left" valign="top"><p>假</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>dumpSmap</p></td></tr><tr><td align="left" valign="top"><p>将SMAP JSR45信息转储到文件中。</p></td><td align="left" valign="top"><p>假</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>genStrAsCharArray</p></td></tr><tr><td align="left" valign="top"><p>用于生成字符串的选项。</p></td><td align="left" valign="top"><p>假</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>ieClassId</p></td></tr><tr><td align="left" valign="top"><p>使用<jsp:plugin>标签</jsp:plugin>时要发送到Internet Explorer的class-id值<jsp:plugin>。</jsp:plugin></p></td><td align="left" valign="top"><p>clsid：8AD9C840-044E-11D1-B3E9-00805F499D93</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>maxLoadedJsps</p></td></tr><tr><td align="left" valign="top"><p>Web应用程序将加载的最大JSP数量。如果加载的JSP数量超过此数量，则将卸载最近最少使用的JSP，以便在任何一次加载的JSP数量均不超过此限制。零或更少的值表示没有限制。</p></td><td align="left" valign="top"><p>-1</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>jspIdleTimeout</p></td></tr><tr><td align="left" valign="top"><p>JSP在卸载之前可以空闲的时间（以秒为单位）。零或更少的值表示永不卸载。</p></td><td align="left" valign="top"><p>-1</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>scratchDir</p></td></tr><tr><td align="left" valign="top"><p>生成servlet的目录。看到</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>编译器类名</p></td></tr><tr><td align="left" valign="top"><p>如果未设置，则默认为Eclipse jdt编译器。</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>编译器</p></td><td align="left" valign="top"><p>如果在类路径中找不到Eclipse jdt编译器，则使用此方法。它是Ant应该调用的编译器的类名。</p></td></tr><tr><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>editorTargetVM</p></td><td align="left" valign="top"><p>要编译的目标虚拟机。</p></td></tr><tr><td align="left" valign="top"><p>1.7</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>编译器源VM</p></td><td align="left" valign="top"><p>设置jdt编译器的源合规性级别。</p></td></tr><tr><td align="left" valign="top"><p>1.7</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>javaEncoding</p></td><td align="left" valign="top"><p>通过编码进行编译。</p></td></tr><tr><td align="left" valign="top"><p>UTF8</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>ModifyTestInterval</p></td><td align="left" valign="top"><p>如果<code class="literal">development=true</code> ，由请求触发的重新编译检查之间的间隔。</p></td></tr><tr><td align="left" valign="top"><p>4</p></td><td align="left" valign="top"><p>–</p></td><td align="left" valign="top"><p>xpoweredBy</p></td><td align="left" valign="top"><p>生成X-Powered-By响应标头。</p></td></tr><tr><td align="left" valign="top"><p>假</p></td><td align="left" valign="top"><p>假</p></td><td align="left" valign="top"><p>recompileOnFail</p></td><td align="left" valign="top"><p>如果JSP编译失败，是否应该忽略ModifyTestInterval，并且下次访问会触发重新编译尝试？仅在开发模式下使用，并且默认情况下被禁用，因为编译可能很昂贵，并且可能导致过多的资源使用。</p></td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="configuring-jsp-for-jetty"></a>组态</h4></div></div></div><p>JSP引擎具有许多配置参数。一些参数仅影响预编译，而某些则影响运行时重新编译检查。不同版本的JSP引擎之间的参数也有所不同。该页面列出了配置参数，它们的含义以及它们的默认设置。设置所有参数<code class="literal">org.apache.jasper.servlet.JspServlet</code>在中定义的实例<a class="link" href="webdefault-xml.html" title="webdefault.xml"><code class="literal">webdefault.xml</code></a>文件。</p><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>注意：对于所有这些参数，如果您设置的值没有生效，请尝试使用所有小写字母而不是驼峰字母，或仅大写名称中的某些单词，因为JSP的参数命名策略不一致。</p></div></blockquote></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="modifying-configuration"></a>修改配置</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="overriding-webdefault.xml"></a>覆写<code class="literal">webdefault.xml</code></h4></div></div></div><p>您可以复制Jetty附带的<a class="link" href="webdefault-xml.html" title="webdefault.xml">{$ jetty.home} /etc/webdefault.xml</a>的副本，应用您的更改，然后使用它代替出厂的版本。以下示例显示了使用Jetty Maven插件时的操作方法。</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>  &lt;plugin&gt;
    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
    &lt;artifactId&gt;jetty-maven-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
      &lt;webApp&gt;
        &lt;defaultsDescriptor&gt;src/main/resources/webdefault.xml&lt;/defaultsDescriptor&gt;
      &lt;/webApp&gt;
  &lt;/plugin&gt;</code></pre><p>如果您使用的是Jetty发行版，并且只想更改一个或几个Web应用程序的JSP设置，请复制<code class="literal">{$jetty.home}/etc/webdefault.xml</code>文件的某个位置，对其进行修改，然后使用<a class="link" href="quickstart-config-what.html#intro-jetty-configuration-contexts" title="配置上下文">上下文xml</a>文件将此文件设置为<code class="literal">defaultsDescriptor</code>为您的webapp。这是一个片段：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code> &lt;Configure class=&gt;"org.eclipse.jetty.webapp.WebAppContext"&gt;

   &lt;Set name=&gt;"contextPath"&gt;/foo&lt;/Set&gt;
   &lt;Set name=&gt;"war"&gt;&lt;SystemProperty name=&gt;"jetty.home" &gt;default=&gt;"."/&gt;/webapps/foobar.war&lt;/Set&gt;
   &lt;Set name=&gt;"defaultsDescriptor"&gt;/home/smith/dev/webdefault.xml&lt;/Set&gt;

 &lt;/Configure&gt;</code></pre><p>如果要更改所有Web应用程序的JSP设置，请编辑<code class="literal">{$jetty.home}/etc/webdefaults.xml</code>而是直接归档。</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="configuring-jsp-servlet-in-web.xml"></a>在web.xml中配置JSP Servlet</h4></div></div></div><p>另一个选择是将JSPServlet的条目添加到<code class="literal">WEB-INF/web.xml</code>您的webapp文件并更改或添加init-params。您也可以添加（但不能删除）servlet映射。您可以使用<a class="link" href="webdefault-xml.html" title="webdefault.xml">{$ jetty.home} /etc/webdefault.xml中</a>的条目作为起点。</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code> &lt;servlet id="jsp"&gt;
     &lt;servlet-name&gt;jsp&lt;/servlet-name&gt;
     &lt;servlet-class&gt;org.apache.jasper.servlet.JspServlet&lt;/servlet-class&gt;
     &lt;init-param&gt;
         &lt;param-name&gt;logVerbosityLevel&lt;/param-name&gt;
         &lt;param-value&gt;DEBUG&lt;/param-value&gt;
     &lt;/init-param&gt;
     &lt;init-param&gt;
         &lt;param-name&gt;fork&lt;/param-name&gt;
         &lt;param-value&gt;&gt;false&lt;/param-value&gt;
     &lt;/init-param&gt;
     &lt;init-param&gt;
         &lt;param-name&gt;keepgenerated&lt;/param-name&gt;
         &lt;param-value&gt;&gt;true&lt;/param-value&gt;
     &lt;/init-param&gt;
     ...

     &lt;load-on-startup&gt;0&lt;/load-on-startup&gt;
   &lt;/servlet&gt;

   &lt;servlet-mapping&gt;
     &lt;servlet-name&gt;jsp&lt;/servlet-name&gt;
     &lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt;
     &lt;url-pattern&gt;*.jspf&lt;/url-pattern&gt;
     &lt;url-pattern&gt;*.jspx&lt;/url-pattern&gt;
     &lt;url-pattern&gt;*.xsp&lt;/url-pattern&gt;
     &lt;url-pattern&gt;*.JSP&lt;/url-pattern&gt;
     &lt;url-pattern&gt;*.JSPF&lt;/url-pattern&gt;
     &lt;url-pattern&gt;*.JSPX&lt;/url-pattern&gt;
     &lt;url-pattern&gt;*.XSP&lt;/url-pattern&gt;
   &lt;/servlet-mapping&gt;

   &lt;servlet id="my-servlet"&gt;
     &lt;servlet-name&gt;myServlet&lt;/servlet-name&gt;
     &lt;servlet-class&gt;com.acme.servlet.MyServlet&lt;/servlet-class&gt;
      ...</code></pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="jsp-async-support"></a>配置异步支持</h4></div></div></div><p>默认情况下，Jetty不启用对JSP Servlet的异步支持。为异步配置JSP Servlet相对容易-只需定义<code class="literal">async-supported</code>参数为<code class="literal">true</code>在你的<code class="literal">webdefault.xml</code>或者<code class="literal">web.xml</code>针对特定环境。</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;servlet id="jsp"&gt;
  &lt;servlet-name&gt;jsp&lt;/servlet-name&gt;
  &lt;async-supported&gt;true&lt;/async-supported&gt;
&lt;/servlet&gt;</code></pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="using-jstl-taglibs-for-jetty7-jetty8"></a>使用JSTL Taglibs</h3></div></div></div><p>JavaServer Pages Standlard标记库（JSTL）是Jetty发行版的一部分，当您<a class="link" href="configuring-jsp.html#which-jsp-implementation" title="Which JSP Implementation">选择JSP风格</a>时，它会自动放在类路径<a class="link" href="configuring-jsp.html#which-jsp-implementation" title="哪个JSP实现">中</a> 。它还自动在Jetty Maven插件的类路径上，该插件使用Apache JSP引擎。</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_embedding"></a>嵌入</h4></div></div></div><p>如果您在嵌入式场景中使用Jetty，并且需要使用JSTL，则必须确保<span class="emphasis"><em>容器的</em></span>类路径中包含JSTL jar，该类路径是Web应用程序类路径的<span class="emphasis"><em>父</em></span>类。这是JavaEE规范引起的限制。</p><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="_apache_jsp"></a> Apache JSP</h5></div></div></div><p>您需要将存在于<code class="literal">{$jetty.home}/lib/apache-jstl</code>目录到<span class="emphasis"><em>容器的</em></span>类路径中。在启动过程中，Apache JSP引擎将在这些jar中找到JSTL标记定义。</p><p>为了提高效率，您可以让码头检查JSTL罐子以找到标签，然后将它们预送入Apache JSP引擎。这样效率更高，因为jetty只会扫描您告诉它的jar，而Apache JSP引擎将扫描每个jar，这在容器类路径上有很多jar的应用程序中可能会很费时。</p><p>要利用这种效率增强，请设置<a class="link" href="configuring-webapps.html#container-include-jar-pattern" title="org.eclipse.jetty.server.webapp。ContainerIncludeJarPattern">org.eclipse.jetty.server.webapp。ContainerIncludeJarPattern</a>包含与JSTL jar的名称匹配的<a class="link" href="http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html" target="_top">模式</a> 。“ <a class="link" href="embedded-examples.html" title="嵌入式示例">嵌入式示例”</a>部分包含有关如何执行此操作的<a class="link" href="embedded-examples.html#embedded-webapp-jsp" title="使用JSP的Web应用程序">代码示例</a> 。以下是该示例的摘录：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>  webapp.setAttribute("org.eclipse.jetty.server.webapp.ContainerIncludeJarPattern",".*/[^/]*taglibs.*\\.jar$");</code></pre></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="using-jsf-taglibs"></a>使用JSF Taglibs</h3></div></div></div><p>以下各节提供有关将JSF TagLib与Jetty Standalone和Jetty Maven插件一起使用的信息。</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="using-jsf-taglibs-with-jetty-standalone"></a>将JSF Taglibs与Jetty Distribution一起使用</h4></div></div></div><p>如果您想在您的Web应用程序中使用JSF，则需要复制JSF实现Jar（无论Jar包含<code class="literal">META-INF/*.tld</code>您选择的JSF实现中的文件）到Jetty的共享容器lib目录中。您可以将它们放入Apache的lib目录中<code class="literal">{$jetty.home}/lib/apache-jsp</code>或放进去<code class="literal">{$jetty.home}/lib/ext</code> 。</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="using-jsf-taglibs-with-jetty-maven-plugin"></a>将JSF Taglibs与Jetty Maven插件一起使用</h4></div></div></div><p>您应该使您的JSF jars依赖插件而<span class="emphasis"><em>不是</em></span> webapp本身。例如：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>   &lt;plugin&gt;
    &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
    &lt;artifactId&gt;jetty-maven-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
       &lt;webApp&gt;
         &lt;contextPath&gt;/${artifactId}&lt;/contextPath&gt;
       &lt;/webApp&gt;
       &lt;scanIntervalSeconds&gt;5&lt;/scanIntervalSeconds&gt;
    &lt;/configuration&gt;
    &lt;dependencies&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;com.sun.faces&lt;/groupId&gt;
        &lt;artifactId&gt;jsf-api&lt;/artifactId&gt;
        &lt;version&gt;2.0.8&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;com.sun.faces&lt;/groupId&gt;
        &lt;artifactId&gt;jsf-impl&lt;/artifactId&gt;
        &lt;version&gt;2.0.8&lt;/version&gt;
     &lt;/dependency&gt;
    &lt;/dependencies&gt;
  &lt;/plugin&gt;</code></pre></div></div></div></div><script type="text/javascript">
      SyntaxHighlighter.all()
    </script><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tbody><tr><td width="40%" align="left"><a href="spnego-support.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><td width="20%" align="center"><a href="jetty-config-guide.html" accesskey="u"><i class="fa fa-chevron-up" aria-hidden="true"></i>最佳</a></td><td width="40%" align="right"> <a href="jetty-admin-guide.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr><tr><td width="40%" align="left" valign="top">SPNEGO支持</td><td width="20%" align="center"><a href="index.html" accesskey="h"><i class="fa fa-home" aria-hidden="true"></i>家</a></td><td width="40%" align="right" valign="top">第三部分码头管理指南</td></tr></tbody></table></div><p xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"></p><div class="jetty-callout">看到错误或缺少的东西？
            <span class="callout"><a href="http://github.com/eclipse/jetty.project">在以下位置对此文档做出贡献<span class="website"><i class="fa fa-github" aria-hidden="true"></i> Github！</span></a></span> <span style="float:right"><i>（产生：2019-11-20）</i></span></div><p></p></body></html>