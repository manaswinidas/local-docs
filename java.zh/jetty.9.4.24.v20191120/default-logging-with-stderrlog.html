<html ><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>使用Jetty的StdErrLog进行默认日志记录</title><link rel="stylesheet" type="text/css" href="css/docbook.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="jetty, servlet, servlet-api, cometd, http, websocket, eclipse, maven, java, server, software"><link rel="home" href="index.html" title="Jetty"><link rel="up" href="configuring-logging.html" title="Chapter 11. Jetty Logging"><link rel="prev" href="configuring-logging.html" title="Chapter 11. Jetty Logging"><link rel="next" href="configuring-jetty-request-logs.html" title="Configuring Jetty Request Logs"><link rel="shortcut icon" href="images/favicon.ico" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><link rel="stylesheet" href="css/highlighter/foundation.css"><script src="js/highlight.pack.js"></script><script>
      hljs.initHighlightingOnLoad();
    </script><link type="text/css" rel="stylesheet" href="css/font-awesome/font-awesome.min.css"></head><body bgcolor="white"  text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><tbody><tr><td style="width:25%"><a href="http://www.eclipse.org/jetty"><img src="images/jetty-header-logo.png" alt="Jetty标志"></a><br><span style="font-size:small">版本：9.4.24.v20191120</span></td><td style="width:50%"></td></tr></tbody></table><div class="navheader" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><table width="100%" summary="Navigation header"><tbody><tr><th colspan="3" align="center">使用Jetty的StdErrLog进行默认日志记录</th></tr><tr><td width="20%" align="left"><a href="configuring-logging.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><th width="60%" align="center">第十一章Jetty记录<br><a href="index.html" accesskey="p"><i class="fa fa-home" aria-hidden="true"></i>家</a></th><td width="20%" align="right"> <a href="configuring-jetty-request-logs.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr></tbody></table><hr></div><div class="jetty-callout" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><h5 class="callout"><a href="http://www.webtide.com/">通过<span class="website">www.webtide.com</span>与Jetty核心开发人员联系。</a></h5><p>内部/客户项目的私人支持...自定义扩展和发行版...无限期支持的版本快照...您的应用程序和Ajax / Comet项目的可伸缩性指南...赞助功能开发的开发服务</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear:both"><a name="default-logging-with-stderrlog"></a>使用Jetty的StdErrLog进行默认日志记录</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="default-logging-with-stderrlog.html#stderrlog-configuration">StdErrLog配置</a></span></dt><dt><span class="section"><a href="default-logging-with-stderrlog.html#deprecated-parameters">不推荐使用的参数</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="stderrlog-configuration"></a> StdErrLog配置</h3></div></div></div><p>如果您不执行任何操作来配置单独的日志记录框架，Jetty将默认使用内部<code class="literal">org.eclipse.jetty.util.log.StdErrLog</code>实施。这会将所有日志记录事件输出到STDERR（aka <code class="literal">System.err</code> ）。</p><p>只需使用Jetty和<code class="literal">StdErrLog</code>基于日志的日志输出到控制台。</p><p>Jetty发行版中包含一个名为的日志模块<code class="literal">console-capture</code>能够简单捕获所有STDOUT（ <code class="literal">System.out</code> ）和STDERR（ <code class="literal">System.err</code> ）输出到每天轮换的文件。</p><p>要启用此功能，只需激活<code class="literal">console-capture</code>命令行上的模块：</p><div class="screenexample"><pre class="screen">[my-base]$ java -jar ../start.jar --add-to-start=console-capture
INFO  : console-capture initialized in ${jetty.base}/start.d/console-capture.ini
MKDIR : ${jetty.base}/logs
INFO  : Base directory was modified

[my-base]$ tree
.
&#9500;&#9472;&#9472; logs
&#9492;&#9472;&#9472; start.d
    &#9492;&#9472;&#9472; console-capture.ini</pre></div><p>日志输出的默认配置将创建一个文件<code class="literal">${jetty.base}/logs/yyyy_mm_dd.stderrout.log</code>通过设置<code class="literal">jetty.logs</code>属性。</p><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>默认情况下，未将日志设置为附加，这意味着在服务器重新启动后会清除干净日志文件。您可以通过编辑<code class="literal">console-capture.ini</code>并取消注释读取的行<code class="literal">jetty.console-capture.append=true</code> 。</p></div></blockquote></div><p>只是启用<code class="literal">console-capture</code>只会将STDERR和STDOUT的值输出到日志文件。要进一步自定义日志，请使用一个名为<code class="literal">logging-jetty</code>可用于提供要配置的默认属性文件。与<code class="literal">console-capture</code> ，您激活<code class="literal">logging-jetty</code>在命令行上。</p><div class="screenexample"><pre class="screen">[my-base]$ java -jar ../start.jar --add-to-start=logging-jetty
INFO  : logging-jetty   initialized in ${jetty.base}/start.d/logging-jetty.ini
INFO  : resources       transitively enabled
MKDIR : ${jetty.base}/resources
COPY  : ${jetty.home}/modules/logging-jetty/resources/jetty-logging.properties to ${jetty.base}/resources/jetty-logging.properties
INFO  : Base directory was modified

[my-base]$ tree
.
&#9500;&#9472;&#9472; logs
&#9500;&#9472;&#9472; resources
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; jetty-logging.properties
&#9492;&#9472;&#9472; start.d
    &#9500;&#9472;&#9472; console-capture.ini
    &#9492;&#9472;&#9472; logging-jetty.ini</pre></div><p>激活后，您可以在以下位置找到属性文件<code class="literal">${jetty.base}/resources/jetty-logging.properties</code> 。默认情况下，定义以下参数。要更改它们，请取消注释该行，并替换您的命名方案和配置选择。</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>## Force jetty logging implementation
#org.eclipse.jetty.util.log.class=org.eclipse.jetty.util.log.StdErrLog

## Set logging levels from: ALL, DEBUG, INFO, WARN, OFF
#org.eclipse.jetty.LEVEL=INFO
#com.example.LEVEL=INFO

## Hide stacks traces in logs?
#com.example.STACKS=false

## Show the source file of a log location?
#com.example.SOURCE=false</code></pre><p>可以在配置中定义许多属性，这些属性会影响StdErr日志记录的行为。 <code class="literal">console-capture</code> 。</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal"><name>.LEVEL=<level></code></span></dt><dd>设置范围内所有记录器的记录级别<code class="literal">name</code>指定的级别，可以是（按限制顺序递增） <code class="literal">ALL</code> ， <code class="literal">DEBUG</code> ， <code class="literal">INFO</code> ， <code class="literal">WARN</code> ， <code class="literal">OFF</code> 。名称（或层次结构）可以是特定的完全限定的类或包名称空间。例如， <code class="literal">org.eclipse.jetty.http.LEVEL=DEBUG</code>是一种程序包名称空间方法，用于将Jetty HTTP程序包中的所有记录程序转换为DEBUG级别，并且<code class="literal">org.eclipse.jetty.io.ChanelEndPoint.LEVEL=ALL</code>打开特定类的所有日志记录事件，包括<code class="literal">DEBUG</code> ， <code class="literal">INFO</code> ， <code class="literal">WARN</code> （甚至是特殊的内部忽略的异常类）。如果有多个系统属性指定了日志记录级别，则应用最具体的级别。</dd><dt><span class="term"><code class="literal"><name>.SOURCE=<boolean></code></span></dt><dd>命名为特定于Logger的日志，尝试打印Java源文件名和行号，从中记录日志事件。名称必须是完全限定的类名称（此可配置项不支持程序包名称层次结构）。默认为false。请注意，这是一个缓慢的操作，并且会影响性能。</dd><dt><span class="term"><code class="literal"><name>.STACKS=<boolean></code></span></dt><dd>特定于Logger的名称，控制堆栈跟踪的显示。名称必须是完全限定的类名称（此可配置项不支持程序包名称层次结构）。默认为true。</dd><dt><span class="term"><code class="literal">org.eclipse.jetty.util.log.stderr.SOURCE=<boolean></code></span></dt><dd>特殊全局配置。尝试打印记录事件起源的Java源文件名和行号。默认为false。</dd><dt><span class="term"><code class="literal">org.eclipse.jetty.util.log.stderr.LONG=<boolean></code></span></dt><dd><p class="simpara">特殊全局配置。如果为true，则将记录事件输出到<code class="literal">STDERR</code>使用长格式的完全合格的类名。如果为false，则使用缩写的软件包名称。默认为false。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem">设置为false时的示例：</li></ul></div><div class="screenexample"><pre class="screen">2016-10-21 15:31:01.248:INFO::main: Logging initialized @332ms to org.eclipse.jetty.util.log.StdErrLog
2016-10-21 15:31:01.370:INFO:oejs.Server:main: jetty-9.4.0-SNAPSHOT
2016-10-21 15:31:01.400:INFO:oejs.AbstractConnector:main: Started ServerConnector@2c330fbc{HTTP/1.1,[http/1.1]}{0.0.0.0:8080}
2016-10-21 15:31:01.400:INFO:oejs.Server:main: Started @485ms</pre></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem">设置为true时的示例：</li></ul></div><div class="screenexample"><pre class="screen">2016-10-21 15:31:35.020:INFO::main: Logging initialized @340ms to org.eclipse.jetty.util.log.StdErrLog
2016-10-21 15:31:35.144:INFO:org.eclipse.jetty.server.Server:main: jetty-9.4.0-SNAPSHOT
2016-10-21 15:31:35.174:INFO:org.eclipse.jetty.server.AbstractConnector:main: Started ServerConnector@edf4efb{HTTP/1.1,[http/1.1]}{0.0.0.0:8080}
2016-10-21 15:31:35.175:INFO:org.eclipse.jetty.server.Server:main: Started @495ms</pre></div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="deprecated-parameters"></a>不推荐使用的参数</h3></div></div></div><p>这些参数存在于Jetty的早期版本中，不再受支持。出于历史（和搜索引擎）原因，将它们包含在此处。</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">org.eclipse.jetty.util.log.DEBUG</code></span></dt><dd><p class="simpara">以前用于在Jetty中使用的任何记录器（不仅仅是Jetty自己的记录器）上启用DEBUG级别的记录。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem">替换为使用记录器实施特定的配置和级别过滤。</li></ul></div></dd><dt><span class="term"><code class="literal">org.eclipse.jetty.util.log.stderr.DEBUG</code></span></dt><dd><p class="simpara">以前用于在内部Jetty上启用DEBUG级别的日志记录<code class="literal">StdErrLog</code>实施。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem">替换为特定于级别的等效项。例：<code class="literal">org.eclipse.jetty.LEVEL=DEBUG</code></li></ul></div></dd><dt><span class="term"><code class="literal">DEBUG</code></span></dt><dd><p class="simpara">古老的调试标志打开了所有调试，甚至是非日志记录调试。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem">Jetty不再使用，因为许多第三方库都使用了过于简单的属性名，这会产生过多的控制台输出。</li></ul></div></dd></dl></div></div></div><script type="text/javascript">
      SyntaxHighlighter.all()
    </script><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tbody><tr><td width="40%" align="left"><a href="configuring-logging.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><td width="20%" align="center"><a href="configuring-logging.html" accesskey="u"><i class="fa fa-chevron-up" aria-hidden="true"></i>最佳</a></td><td width="40%" align="right"> <a href="configuring-jetty-request-logs.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr><tr><td width="40%" align="left" valign="top">第十一章Jetty记录</td><td width="20%" align="center"><a href="index.html" accesskey="h"><i class="fa fa-home" aria-hidden="true"></i>家</a></td><td width="40%" align="right" valign="top">配置Jetty请求日志</td></tr></tbody></table></div><p xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"></p><div class="jetty-callout">看到错误或缺少的东西？
            <span class="callout"><a href="http://github.com/eclipse/jetty.project">在以下位置对此文档做出贡献<span class="website"><i class="fa fa-github" aria-hidden="true"></i> Github！</span></a></span> <span style="float:right"><i>（产生：2019-11-20）</i></span></div><p></p></body></html>