<html ><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>OSGI</title><link rel="stylesheet" type="text/css" href="css/docbook.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="jetty, servlet, servlet-api, cometd, http, websocket, eclipse, maven, java, server, software"><link rel="home" href="index.html" title="Jetty"><link rel="up" href="frameworks.html" title="Chapter 29. Frameworks"><link rel="prev" href="frameworks.html" title="Chapter 29. Frameworks"><link rel="next" href="framework-weld.html" title="Weld"><link rel="shortcut icon" href="images/favicon.ico" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><link rel="stylesheet" href="css/highlighter/foundation.css"><script src="js/highlight.pack.js"></script><script>
      hljs.initHighlightingOnLoad();
    </script><link type="text/css" rel="stylesheet" href="css/font-awesome/font-awesome.min.css"></head><body bgcolor="white"  text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><tbody><tr><td style="width:25%"><a href="http://www.eclipse.org/jetty"><img src="images/jetty-header-logo.png" alt="码头标志"></a><br><span style="font-size:small">版本：9.4.24.v20191120</span></td><td style="width:50%"></td></tr></tbody></table><div class="navheader" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><table width="100%" summary="Navigation header"><tbody><tr><th colspan="3" align="center">OSGI</th></tr><tr><td width="20%" align="left"><a href="frameworks.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><th width="60%" align="center">章29。构架<br><a href="index.html" accesskey="p"><i class="fa fa-home" aria-hidden="true"></i>家</a></th><td width="20%" align="right"> <a href="framework-weld.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr></tbody></table><hr></div><div class="jetty-callout" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><h5 class="callout"><a href="http://www.webtide.com/">通过<span class="website">www.webtide.com</span>与Jetty核心开发人员联系。</a></h5><p>内部/客户项目的私人支持...自定义扩展和发行版...无限期支持的版本快照...您的应用程序和Ajax / Comet项目的可伸缩性指南...赞助功能开发的开发服务</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear:both"><a name="framework-jetty-osgi"></a> OSGI</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="framework-jetty-osgi.html#_introduction">介绍</a></span></dt><dt><span class="section"><a href="framework-jetty-osgi.html#_general_setup">常规设置</a></span></dt><dt><span class="section"><a href="framework-jetty-osgi.html#_the_jetty_osgi_container">Jetty OSGi容器</a></span></dt><dt><span class="section"><a href="framework-jetty-osgi.html#_deploying_bundles_as_webapps">将捆绑软件作为Webapp部署</a></span></dt><dt><span class="section"><a href="framework-jetty-osgi.html#_deploying_bundles_as_jetty_contexthandlers">将绑定部署为Jetty ContextHandlers</a></span></dt><dt><span class="section"><a href="framework-jetty-osgi.html#services-as-webapps">将服务作为Webapp部署</a></span></dt><dt><span class="section"><a href="framework-jetty-osgi.html#_deploying_services_as_contexthandlers">将服务部署为ContextHandlers</a></span></dt><dt><span class="section"><a href="framework-jetty-osgi.html#_support_for_the_osgi_service_platform_enterprise_specification">支持OSGi服务平台企业规范</a></span></dt><dt><span class="section"><a href="framework-jetty-osgi.html#_using_jsps">使用JSP</a></span></dt><dt><span class="section"><a href="framework-jetty-osgi.html#osgi-annotations">使用Annotations / ServletContainerInitializers</a></span></dt><dt><span class="section"><a href="framework-jetty-osgi.html#_osgi_containers">OSGi容器</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_introduction"></a>介绍</h3></div></div></div><p>Jetty OSGi基础结构在OSGi容器内部提供了一个Jetty容器。除了Jetty之外，还可以部署传统的JavaEE Web应用程序<code class="literal">ContextHandlers</code> ，以及OSGi网络捆绑包。此外，基础架构还支持OSGi <code class="literal">HttpService</code>接口。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_general_setup"></a>常规设置</h3></div></div></div><p>所有的Jetty jar都包含适当的清单条目，以确保可以将它们作为捆绑包部署到OSGi容器中。您将需要在OSGi容器中安装一些码头罐。您始终可以在Maven Central存储库中找到Jetty jar，也可以<a class="link" href="https://www.eclipse.org/jetty/download.html" target="_top">下载</a> Jetty的发行版。这是Jetty jar的绝对最小集：</p><div class="table"><a name="d0e27039"></a><p class="title"><b>表29.1最小捆绑</b></p><div class="table-contents"><table class="table" border="1" summary="Minimal Bundles"><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th align="left" valign="top">罐</th><th align="left" valign="top">捆绑符号名称</th></tr></thead><tbody><tr><td align="left" valign="top"><p>码头工具</p></td><td align="left" valign="top"><p>org.eclipse.jetty.util</p></td></tr><tr><td align="left" valign="top"><p>码头http</p></td><td align="left" valign="top"><p>org.eclipse.jetty.http</p></td></tr><tr><td align="left" valign="top"><p>码头</p></td><td align="left" valign="top"><p>org.eclipse.jetty.io</p></td></tr><tr><td align="left" valign="top"><p>码头安全</p></td><td align="left" valign="top"><p>org.eclipse.jetty.security</p></td></tr><tr><td align="left" valign="top"><p>码头服务员</p></td><td align="left" valign="top"><p>org.eclipse.jetty.server</p></td></tr><tr><td align="left" valign="top"><p>码头小服务程序</p></td><td align="left" valign="top"><p>org.eclipse.jetty.servlet</p></td></tr><tr><td align="left" valign="top"><p>码头网络应用程序</p></td><td align="left" valign="top"><p>org.eclipse.jetty.webapp</p></td></tr><tr><td align="left" valign="top"><p>码头部署</p></td><td align="left" valign="top"><p>org.eclipse.jetty.deploy</p></td></tr><tr><td align="left" valign="top"><p>jetty-xml</p></td><td align="left" valign="top"><p>org.eclipse.jetty.xml</p></td></tr><tr><td align="left" valign="top"><p>jetty-osgi-servlet-api</p></td><td align="left" valign="top"><p>org.eclipse.jetty.osgi-servlet-api</p></td></tr></tbody></table></div></div><br class="table-break"><p>您<span class="strong"><strong>还必须安装与</strong></span> Jetty一样多<span class="strong"><strong>的Apache Aries SPI Fly捆绑软件</strong></span> ，例如ALPN，websocket，注释，请使用<code class="literal">ServiceLoader</code>机制，需要像SPI Fly这样的OSGi服务加载程序介体：</p><div class="table"><a name="spifly"></a><p class="title"><b>表29.2SPI飞包</b></p><div class="table-contents"><table class="table" border="1" summary="SPI Fly Bundles"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top">罐</th><th align="left" valign="top">捆绑符号名称</th><th align="left" valign="top">地点</th></tr></thead><tbody><tr><td align="left" valign="top"><p>org.apache.aries.spifly：org.apache.aries.spifly.dynamic.bundle-1.2.jar</p></td><td align="left" valign="top"><p>org.apache.aries.spifly.dynamic.bundle</p></td><td align="left" valign="top"><p><a class="link" href="https://repo1.maven.org/maven2/org/apache/aries/spifly/org.apache.aries.spifly.dynamic.bundle/" target="_top">Maven中央</a></p></td></tr></tbody></table></div></div><br class="table-break"><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>我们强烈建议您也部署与<a class="link" href="framework-jetty-osgi.html#osgi-annotations" title="使用Annotations / ServletContainerInitializers">注释相关的</a> jar，因为Servlet规范越来越依赖注释来实现功能。</p></div></blockquote></div><p>您还将需要<span class="strong"><strong>OSGi事件管理服务</strong></span>和<span class="strong"><strong>OSGi配置管理服务</strong></span> 。如果您的OSGi容器没有自动使它们可用，则需要以适合您的容器的方式添加它们。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_the_jetty_osgi_container"></a> Jetty OSGi容器</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_the_jetty_osgi_boot_jar"></a>跳船-osgi-boot罐子</h4></div></div></div><p>现在，您已经安装了基本的Jetty jar集合，您可以安装<a class="link" href="https://repo1.maven.org/maven2/org/eclipse/jetty/osgi/jetty-osgi-boot/" target="_top">jetty-osgi-boot.jar</a>捆绑包，可从<a class="link" href="https://repo1.maven.org/maven2/org/eclipse/jetty/osgi/jetty-osgi-boot/" target="_top">此处</a>的Maven中央仓库下载<a class="link" href="https://repo1.maven.org/maven2/org/eclipse/jetty/osgi/jetty-osgi-boot/" target="_top">。</a></p><p>该捆绑包将在启动时实例化并提供Jetty OSGi容器。如果在安装到OSGi容器中时未自动启动此捆绑包，则应使用适合于该容器的命令手动启动它。</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="customize-jetty-container"></a>自定义码头集装箱</h4></div></div></div><p>在继续安装之前，您可能需要自定义Jetty容器。通常，这是通过结合系统属性和常用的Jetty xml配置文件来完成的。定义系统属性的方式将取决于您使用的OSGi容器，因此请确保您熟悉如何为您的环境设置它们。在以下示例中，我们假设OSGi容器允许我们将System属性设置为简单<code class="literal">name=value</code>对。</p><p>可用的系统属性是：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">码头</span></dt><dd>如果未指定，则默认为通常的8080码头端口。</dd><dt><span class="term">码头</span></dt><dd><p class="simpara"><span class="emphasis"><em>必须</em></span>指定此属性<span class="emphasis"><em>或</em></span> <span class="strong"><strong>jetty.home.bundle</strong></span> 。此属性应指向具有以下内容的文件系统位置： <code class="literal">etc/</code>包含xml文件的目录，用于在启动时配置Jetty容器。例如：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>jetty.home=/opt/custom/jetty</code></pre><p class="simpara">哪里<code class="literal">/opt/custom/jetty</code>包含：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>etc/jetty.xml
etc/jetty-selector.xml
etc/jetty-deployer.xml
etc/jetty-special.xml</code></pre></dd><dt><span class="term">jetty.home.bundle</span></dt><dd><p class="simpara">必须指定此属性<span class="emphasis"><em>或</em></span> <span class="strong"><strong>jetty.home</strong></span>属性。此属性应指定包含目录的捆绑软件的符号名称，该目录称为<code class="literal">jettyhome/</code> 。的<code class="literal">jettyhome/</code>目录应该有一个名为<code class="literal">etc/</code>其中包含要在启动时应用于Jetty的xml文件。jetty-osgi-boot.jar包含一个<code class="literal">jettyhome/</code>目录，其中包含一组默认的xml配置文件。指定方式如下：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>jetty.home.bundle=org.eclipse.jetty.osgi.boot</code></pre><p class="simpara">这是该jar的部分清单，向您显示其中包含的xml文件的名称：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>META-INF/MANIFEST.MF
jettyhome/etc/jetty.xml
jettyhome/etc/jetty-deployer.xml
jettyhome/etc/jetty-http.xml</code></pre></dd><dt><span class="term">jetty.etc.config.urls</span></dt><dd><p class="simpara">这指定了要使用的xml文件的路径。如果未指定，则默认为：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>etc/jetty.xml,etc/jetty-http.xml,etc/jetty-deployer.xml</code></pre><p class="simpara">请注意，路径可以是相对路径，也可以是绝对路径，也可以是混合路径。如果路径是相对的，则将根据指定的<span class="strong"><strong>jetty.home</strong></span>或<span class="strong"><strong>jetty.home.bundle</strong></span>对其进行解析。您可以使用此功能来混合和匹配码头配置文件以添加功能，例如添加https连接器。这是一个使用jetty-distribution中的相关文件添加HTTPS连接器的示例：</p><pre class="literallayout">etc/jetty.xml, etc/jetty-http.xml, /opt/jetty/etc/jetty-ssl.xml, /opt/jetty/etc/jetty-https.xml, etc/jetty-deployer.xml</pre><p class="simpara">请注意，无论您设置了<span class="strong"><strong>jetty.home</strong></span>还是<span class="strong"><strong>jetty.home.bundle</strong></span>属性，当Jetty执行配置文件时，它将为<span class="strong"><strong>jetty.home</strong></span>设置一个适当的值，以便xml文件中的引用可以<code class="literal"><property name="jetty.home"></code>将工作。但是，如果要混合并匹配相对和绝对配置文件路径，请小心： <span class="strong"><strong>jetty.home</strong></span>的值仅由<span class="emphasis"><em>相对</em></span>文件的解析位置确定。</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_the_jetty_container_as_an_osgi_service"></a>码头集装箱作为OSGi服务</h4></div></div></div><p>现在，您可以继续并将jetty-osgi-boot.jar部署到OSGi容器中。将创建一个Jetty服务器实例，将xml配置文件应用于该实例，然后将其发布为OSGi服务。通常，您不需要与此服务实例进行交互，但是您可以使用常规的OSGi API检索对它的引用：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>org.osgi.framework.BundleContext bc;
org.osgi.framework.ServiceReference ref = bc.getServiceReference("org.eclipse.jetty.server.Server");</code></pre><p>服务器服务具有与之相关的几个属性，您可以使用<code class="literal">org.osgi.framework.ServiceReference.getProperty(String)</code>方法：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">managedServerName</span></dt><dd>由jetty-osgi-boot.jar创建的Jetty服务器实例将被称为“ defaultJettyServer”</dd><dt><span class="term">jetty.etc.config.urls</span></dt><dd>从<span class="strong"><strong>jetty.home</strong></span>或<span class="strong"><strong>jetty.home.bundle</strong></span> / jettyhome解析的xml文件列表</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_adding_more_jetty_servers"></a>添加更多的Jetty服务器</h4></div></div></div><p>如上一节所述，jetty-osgi-boot代码将创建一个<code class="literal">org.eclipse.jetty.server.Server</code>实例， <span class="strong"><strong>向其应用jetty.etc.config.urls</strong></span>系统属性指定的xml配置文件，然后将其注册为OSGi服务。与此默认实例关联的名称是<code class="literal">defaultJettyServer</code> 。</p><p>您可以创建其他服务器实例，将它们注册为OSGi服务，然后jetty-osgi-boot代码会注意到它们，并对其进行配置，以便它们可以部署<code class="literal">ContextHandlers</code>和webapp捆绑包。部署Web应用程序或<code class="literal">ContextHandlers</code>作为捆绑包或服务（请参阅以下部分），您可以将其定位为通过服务器名称部署到特定服务器实例。</p><p>这是一个如何创建新的Server实例并将其注册到OSGi的示例，以便jetty-osgi-boot代码可以找到它并对其进行配置，使其可以成为部署目标：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>public class Activator implements BundleActivator
{

    public void start(BundleContext context) throws Exception
    {

        Server server = new Server();
        //do any setup on Server in here
        String serverName = "fooServer";
        Dictionary serverProps = new Hashtable();
        //define the unique name of the server instance
        serverProps.put("managedServerName", serverName);
        serverProps.put("jetty.http.port", "9999");
        //let Jetty apply some configuration files to the Server instance
        serverProps.put("jetty.etc.config.urls", "file:/opt/jetty/etc/jetty.xml,file:/opt/jetty/etc/jetty-selector.xml,file:/opt/jetty/etc/jetty-deployer.xml");
        //register as an OSGi Service for Jetty to find
        context.registerService(Server.class.getName(), server, serverProps);

    }
}</code></pre><p>现在，我们已经创建了一个名为“ fooServer”的新服务器，我们可以部署webapp和<code class="literal">ContextHandlers</code>作为捆绑销售商品或服务（请参见下文以获取更多信息）。这是将Web应用程序部署为服务并将其定位到我们上面创建的“ fooServer”服务器的示例：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>public class Activator implements BundleActivator
{

    public void start(BundleContext context) throws Exception
    {

        //Create a webapp context as a Service and target it at the "fooServer" Server instance
        WebAppContext webapp = new WebAppContext();
        Dictionary props = new Hashtable();
        props.put("war",".");
        props.put("contextPath","/acme");
        props.put("managedServerName", "fooServer");
        context.registerService(ContextHandler.class.getName(),webapp,props);
    }
}</code></pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_deploying_bundles_as_webapps"></a>将捆绑软件作为Webapp部署</h3></div></div></div><p>Jetty OSGi容器侦听捆绑软件的安装，并将自动尝试部署任何似乎是webapps的软件。</p><p>以下任何条件都足以让Jetty将捆绑软件部署为Webapp：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">捆绑包包含WEB-INF / web.xml文件</span></dt><dd>如果捆绑包包含Web描述符，则它将自动部署。这是部署经典JavaEE Web应用程序的简便方法。</dd><dt><span class="term">套件清单包含Jetty-WarFolderPath（适用于jetty-9.3之前的版本）或Jetty-WarResourcePath</span></dt><dd><p class="simpara">这是webapp资源包中的位置。通常，如果捆绑包不是纯webapp，而是webapp是捆绑包的组成部分，则将使用此选项。这是捆绑软件的示例，其中webapp的资源不在捆绑软件的根目录中，而是位于子目录中<code class="literal">web/</code> ：</p><p class="simpara"><code class="literal">MANIFEST</code> ：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>Bundle-Name: Web
Jetty-WarResourcePath: web
Import-Package: javax.servlet;version="3.1",
 javax.servlet.resources;version="3.1"
Bundle-SymbolicName: com.acme.sample.web</code></pre><p class="simpara">捆绑内容：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>META-INF/MANIFEST.MF
web/index.html
web/foo.html
web/WEB-INF/web.xml
com/acme/sample/web/MyStuff.class
com/acme/sample/web/MyOtherStuff.class</code></pre></dd><dt><span class="term">套件清单包含Web-ContextPath</span></dt><dd><p class="simpara">该标头可以与前面两个标头中的任何一个一起使用，以控制将webapp部署到的上下文路径，也可以单独使用以标识应将捆绑软件的内容发布为webapp。此标头是RFC-66规范的一部分，用于将Webapp与OSGi一起使用。这是一个基于前一个示例的示例，其中我们使用<code class="literal">Web-ContextPath</code>标头，将其部署上下文路径设置为“ / sample”：</p><p class="simpara"><code class="literal">MANIFEST</code> ：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>Bundle-Name: Web
Jetty-WarResourcePath: web
Web-ContextPath: /sample
Import-Package: javax.servlet;version="3.1",
 javax.servlet.resources;version="3.1"
Bundle-SymbolicName: com.acme.sample.web</code></pre></dd></dl></div><p>您还可以在包MANIFEST中定义其他标头，以帮助自定义要部署的Web应用程序：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Jetty-defaultWebXmlFilePath</span></dt><dd>一个的位置<code class="literal">webdefault.xml</code>文件以应用于Webapp。该位置可以是绝对位置（绝对路径或文件：url），也可以是相对位置（在这种情况下，它被解释为相对于包根）。默认为<code class="literal">webdefault.xml</code>文件内置到Jetty OSGi容器中。</dd><dt><span class="term">Jetty-WebXmlFilePath</span></dt><dd>的位置<code class="literal">web.xml</code>文件。该位置可以是绝对位置（绝对路径或文件：url），也可以是相对位置（在这种情况下，它被解释为相对于包根）。默认为<code class="literal">WEB-INF/web.xml</code></dd><dt><span class="term">Jetty-extraClassPath</span></dt><dd>要添加到Webapp的类加载器的其他项的类路径。</dd><dt><span class="term">码头捆绑安装</span></dt><dd>覆盖计算的包安装的基本文件夹的路径-对于默认情况下解包的OSGi框架最有用。</dd><dt><span class="term">Require-TldBundle</span></dt><dd>以逗号分隔的包含此Web应用程序所依赖的TLD的包的包符号名称列表。</dd><dt><span class="term">managedServerName</span></dt><dd>将此Webapp捆绑包部署到的服务器实例的名称。如果未指定，则默认为名为“ defaultJettyServer”的默认服务器实例。</dd><dt><span class="term">Jetty-WarFragmentResourcePath</span></dt><dd>由网络捆绑包托管的片段中的路径，该片段包含webapp的静态资源。该路径将附加到webapp的基础资源中（请参阅Jetty-WarResourcePath）。</dd><dt><span class="term">Jetty-WarPrependFragmentResourcePath</span></dt><dd>由网络捆绑包托管的片段中的路径，该片段包含webapp的静态资源。该路径位于Web应用程序的基础资源之前（请参阅Jetty-WarResourcePath）。</dd><dt><span class="term">Jetty-ContextFilePath</span></dt><dd>Webapp捆绑包中将应用到Webapp的Jetty上下文文件的路径的逗号分隔路径列表。或者，您可以包括一个名为的Jetty上下文文件。 <code class="literal">jetty-webapp-context.xml</code>在webapp包的META-INF目录中，它将被自动应用到webapp。</dd></dl></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_determining_the_context_path_for_a_webapp_bundle"></a>确定Webapp捆绑包的上下文路径</h4></div></div></div><p>如上一节所述，如果捆绑销售<code class="literal">MANIFEST</code>包含RFC-66标头<span class="strong"><strong>Web-ContextPath</strong></span> ，Jetty将使用它作为上下文路径。如果<code class="literal">MANIFEST</code>不包含该标头，则Jetty将根据包位置的最后一个元素（通过调用<code class="literal">Bundle.getLocation()</code> ），然后删除所有文件扩展名。</p><p>例如，假设我们有一个捆绑包，其位置为：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>file://some/where/over/the/rainbow/oz.war</code></pre><p>相应的综合上下文路径为：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>/oz</code></pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_extra_properties_available_for_webapp_bundles"></a> Webapp捆绑包可用的其他属性</h4></div></div></div><p>您可以通过包括应用于Webapp的Jetty上下文xml文件来进一步自定义Webapp。此xml文件必须放在<code class="literal">META-INF</code>捆绑销售商品，必须调用<code class="literal">jetty-webapp-context.xml</code> 。</p><p>这是一个包含此类文件的webapp捆绑包清单示例：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>META-INF/MANIFEST.MF
META-INF/jetty-webapp-context.xml
web/index.html
web/foo.html
web/WEB-INF/web.xml
com/acme/sample/web/MyStuff.class
com/acme/sample/web/MyOtherStuff.class</code></pre><p>这是一个例子的内容<code class="literal">META-INF/jetty-webapp-context.xml</code>文件：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "http://www.eclipse.org/jetty/configure_9_3.dtd"&gt;

&lt;Configure class="org.eclipse.jetty.webapp.WebAppContext"&gt;
  &lt;Set name="defaultsDescriptor"&gt;&lt;Property name="bundle.root"/&gt;META-INF/webdefault.xml&lt;/Set&gt;
&lt;/Configure&gt;</code></pre><p>如您所见，它是用于设置Web应用程序的常规上下文xml文件。但是，还有一些其他有用的属性可以引用</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">服务器</span></dt><dd>这是对码头的参考<code class="literal">org.eclipse.jetty.server.Server</code>上下文xml文件中配置的webapp将部署到的实例。</dd><dt><span class="term">bundle.root</span></dt><dd>这是对<code class="literal">org.eclipse.jetty.util.resource.Resource</code>表示捆绑包的位置。请注意，如果OSGi容器自动解压缩包，则该目录可能是文件系统中的目录，如果该包仍被打包，则它可能是jar：file：url。</dd></dl></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_deploying_bundles_as_jetty_contexthandlers"></a>将绑定部署为Jetty ContextHandlers</h3></div></div></div><p>除了部署Web应用程序之外，Jetty OSGi容器还侦听不是重量级Web应用程序的捆绑软件的安装，而是使用灵活的Jetty特定概念<code class="literal">ContextHandlers</code> 。</p><p>以下是用于决定是否可以将捆绑软件部署为<code class="literal">ContextHandler</code> ：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">套件清单包含Jetty-ContextFilePath</span></dt><dd><p class="simpara">用逗号分隔的上下文文件名称列表-每个列表代表一个应该由Jetty部署的ContextHandler。上下文文件可以位于包内，文件系统上某个包的外部，或<span class="strong"><strong>jetty.home</strong></span>目录中该包的外部。</p><p class="simpara">捆绑软件内的上下文文件：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>Jetty-ContextFilePath: ./a/b/c/d/foo.xml</code></pre><p class="simpara">文件系统上的上下文文件：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>Jetty-ContextFilePath: /opt/app/contexts/foo.xml</code></pre><p class="simpara">相对于jetty.home的上下文文件：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>Jetty-ContextFilePath: contexts/foo.xml</code></pre><p class="simpara">许多不同的上下文文件：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>Jetty-ContextFilePath: ./a/b/c/d/foo.xml,/opt/app/contexts/foo.xml,contexts/foo.xml</code></pre></dd></dl></div><p>其他<code class="literal">MANIFEST</code>可用于配置部署的属性<code class="literal">ContextHandler</code> ：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">managedServerName</span></dt><dd>将此Webapp捆绑包部署到的服务器实例的名称。如果未指定，则默认为名为“ defaultJettyServer”的默认服务器实例。</dd></dl></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_determining_the_context_path_for_a_contexthandler_bundle"></a>为ContextHandler捆绑包确定上下文路径</h4></div></div></div><p>通常，ContextHandler的上下文路径将由上下文xml文件设置。但是，您可以通过使用以下<span class="strong"><strong>网址中的Web-ContextPath</strong></span>标头覆盖上下文xml文件中设置的任何路径： <code class="literal">MANIFEST</code> 。</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_extra_properties_available_for_context_xml_files"></a>上下文Xml文件可用的其他属性</h4></div></div></div><p>在Jetty OSGi容器应用<span class="strong"><strong>Jetty-ContextFilePath中</strong></span>找到的上下文xml文件<span class="strong"><strong>之前</strong></span> <code class="literal">MANIFEST</code>标头，它设置了一些可以在xml文件中引用的有用属性：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">服务器</span></dt><dd>这是对码头的参考<code class="literal">org.eclipse.jetty.server.Server</code>实例<code class="literal">ContextHandler</code>在上下文xml文件中配置的配置将被部署。</dd><dt><span class="term">bundle.root</span></dt><dd>这是对<code class="literal">org.eclipse.jetty.util.resource.Resource</code>表示捆绑包的位置（通过调用<code class="literal">Bundle.getLocation()</code> ）。请注意，如果OSGi容器自动解压缩包，则该目录可能是文件系统中的目录，如果该包仍被打包，则它可能是jar：file：url。</dd></dl></div><p>这是一个使用这些属性的上下文xml文件的示例：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "http://www.eclipse.org/jetty/configure_9_3.dtd"&gt;

&lt;Configure class="org.eclipse.jetty.server.handler.ContextHandler"&gt;

  &lt;!-- Get root for static content, could be on file system or this bundle --&gt;
  &lt;Call id="res" class="org.eclipse.jetty.util.resource.Resource" name="newResource"&gt;
    &lt;Arg&gt;&lt;Property name="bundle.root"/&gt;&lt;/Arg&gt;
  &lt;/Call&gt;

  &lt;Ref refid="res"&gt;
    &lt;Call id="base" name="addPath"&gt;
      &lt;Arg&gt;/static/&lt;/Arg&gt;
    &lt;/Call&gt;
  &lt;/Ref&gt;

  &lt;Set name="contextPath"&gt;/unset&lt;/Set&gt;

  &lt;!-- Set up the base resource for static files relative to inside bundle --&gt;
  &lt;Set name="baseResource"&gt;
     &lt;Ref refid="base"/&gt;
  &lt;/Set&gt;

  &lt;Set name="handler"&gt;
    &lt;New class="org.eclipse.jetty.server.handler.ResourceHandler"&gt;
      &lt;Set name="welcomeFiles"&gt;
        &lt;Array type="String"&gt;
          &lt;Item&gt;index.html&lt;/Item&gt;
        &lt;/Array&gt;
      &lt;/Set&gt;
      &lt;Set name="cacheControl"&gt;max-age=3600,public&lt;/Set&gt;
    &lt;/New&gt;
  &lt;/Set&gt;

&lt;/Configure&gt;</code></pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="services-as-webapps"></a>将服务作为Webapp部署</h3></div></div></div><p>除了侦听格式或<code class="literal">MANIFEST</code>条目定义一个webapp或<code class="literal">ContextHandler</code>为了进行部署，Jetty OSGi容器还监听作为以下实例的OSGi服务的注册。 <code class="literal">org.eclipse.jetty.webapp.WebAppContext</code> 。因此，您可以以编程方式创建一个<code class="literal">WebAppContext</code> ，将其注册为服务，并让Jetty进行部署。</p><p>这是一个使用提供静态内容的简单捆绑以及一个<code class="literal">org.osgi.framework.BundleActivator</code>实例化<code class="literal">WebAppContext</code> ：</p><p>捆绑内容：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>META-INF/MANIFEST.MF
index.html
com/acme/osgi/Activator.class</code></pre><p>的<code class="literal">MANIFEST.MF</code> ：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>Bundle-Classpath: .
Bundle-Name: Jetty OSGi Test WebApp
DynamicImport-Package: org.eclipse.jetty.*;version="[9.0,10.0)"
Bundle-Activator: com.acme.osgi.Activator
Import-Package: org.eclipse.jetty.server.handler;version="[9.0,10)",
 org.eclipse.jetty.webapp;version="[9.0,10)",
 org.osgi.framework;version= "[1.5,2)",
 org.osgi.service.cm;version="1.2.0",
 org.osgi.service.packag eadmin;version="[1.2,2)",
 org.osgi.service.startlevel;version="1.0.0",
 org.osgi.service.url;version="1.0.0",
 org.osgi.util.tracker;version= "1.3.0",
 org.xml.sax,org.xml.sax.helpers
Bundle-SymbolicName: com.acme.testwebapp</code></pre><p>激活器代码：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>public void start(BundleContext context) throws Exception
{
    WebAppContext webapp = new WebAppContext();
    Dictionary props = new Hashtable();
    props.put("Jetty-WarResourcePath",".");
    props.put("contextPath","/acme");
    context.registerService(WebAppContext.class.getName(),webapp,props);
}</code></pre><p>以上设置足以让Jetty识别并部署<code class="literal">WebAppContext</code>在/ acme。</p><p>如示例所示，您可以使用OSGi服务属性以将额外的配置信息传达给Jetty：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Jetty-WarFolderPath（适用于9.3之前的版本）或Jetty-WarResourcePath</span></dt><dd>Web应用程序静态资源根目录在捆绑软件中的位置</dd><dt><span class="term">Web上下文路径</span></dt><dd>部署Webapp的上下文路径。</dd><dt><span class="term">Jetty-defaultWebXmlFilePath</span></dt><dd>捆绑包中的位置<code class="literal">webdefault.xml</code>文件以应用于Webapp。默认为Jetty OSGi容器的容器。</dd><dt><span class="term">Jetty-WebXmlFilePath</span></dt><dd>捆绑包中的位置<code class="literal">web.xml</code>文件。默认为<code class="literal">WEB-INF/web.xml</code></dd><dt><span class="term">Jetty-extraClassPath</span></dt><dd>要添加到Webapp的类加载器的其他项的类路径。</dd><dt><span class="term">码头捆绑安装</span></dt><dd>覆盖计算的包安装的基本文件夹的路径-对于默认情况下解包的OSGi框架最有用。</dd><dt><span class="term">Require-TldBundle</span></dt><dd>以逗号分隔的包含此Web应用程序所依赖的TLD的包的包符号名称列表。</dd><dt><span class="term">managedServerName</span></dt><dd>将此Webapp部署到的服务器实例的名称。如果未指定，则默认为名为“ defaultJettyServer”的默认服务器实例。</dd><dt><span class="term">Jetty-WarFragmentResourcePath</span></dt><dd>由网络捆绑包托管的片段中的路径，该片段包含webapp的静态资源。该路径将附加到webapp的基础资源中（请参阅Jetty-WarResourcePath）。</dd><dt><span class="term">Jetty-WarPrependFragmentResourcePath</span></dt><dd>由网络捆绑包托管的片段中的路径，该片段包含webapp的静态资源。该路径位于Web应用程序的基础资源之前（请参阅Jetty-WarResourcePath）。</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_deploying_services_as_contexthandlers"></a>将服务部署为ContextHandlers</h3></div></div></div><p>与WebApp的上下文类似，Jetty OSGi容器可以检测代表以下内容的OSGi服务的注册： <code class="literal">ContextHandler</code>并确保已部署。的<code class="literal">ContextHandler</code>可以在将其注册为OSGi服务之前进行完整配置-在这种情况下，Jetty OSGi容器将仅部署它-或<code class="literal">ContextHandler</code>可以通过Jetty OSGi容器通过上下文xml文件和与服务相关联的属性完成部分配置，从而完成部分配置。</p><p>这是一个使用简单捆绑包执行此操作的示例，该捆绑包通过<code class="literal">org.osgi.framework.BundleActivator</code>实例化一个<code class="literal">ContextHandler</code>并将其注册为OSGi服务，并传入定义上下文XML文件和Jetty以便在部署时应用的上下文路径的属性：</p><p>捆绑内容：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>META-INF/MANIFEST.MF
static/index.html
acme.xml
com/acme/osgi/Activator.class
com/acme/osgi/Activator$1.class</code></pre><p>的<code class="literal">MANIFEST</code> ：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>Bundle-Classpath: .
Bundle-Name: Jetty OSGi Test Context
DynamicImport-Package: org.eclipse.jetty.*;version="[9.0,10.0)"
Bundle-Activator: com.acme.osgi.Activator
Import-Package: javax.servlet;version="2.6.0",
 javax.servlet.resources;version="2.6.0",
 org.eclipse.jetty.server.handler;version="[9.0,10)",
 org.osgi.framework;version="[1.5,2)",
 org.osgi.service.cm;version="1.2.0",
 org.osgi.service.packageadmin;version="[1.2,2)",
 org.osgi.service.startlevel;version="1.0.0.o",
 org.osgi.service.url;version="1.0.0",
 org.osgi.util.tracker;version="1.3.0",
 org.xml.sax,org.xml.sax.helpers
Bundle-SymbolicName: com.acme.testcontext</code></pre><p>激活器代码：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>public void start(final BundleContext context) throws Exception
{
    ContextHandler ch = new ContextHandler();
    ch.addEventListener(new ServletContextListener () {

            @Override
            public void contextInitialized(ServletContextEvent sce)
            {
               System.err.println("Context is initialized");
            }

            @Override
            public void contextDestroyed(ServletContextEvent sce)
            {
                System.err.println("Context is destroyed!");
            }

    });
    Dictionary props = new Hashtable();
    props.put("Web-ContextPath","/acme");
    props.put("Jetty-ContextFilePath", "acme.xml");
    context.registerService(ContextHandler.class.getName(),ch,props);
}</code></pre><p>的内容<code class="literal">acme.xml</code>上下文文件：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "http://www.eclipse.org/jetty/configure_9_3.dtd"&gt;

&lt;Configure class="org.eclipse.jetty.server.handler.ContextHandler"&gt;

  &lt;!-- Get root for static content, could be on file system or this bundle --&gt;
  &lt;Call id="res" class="org.eclipse.jetty.util.resource.Resource" name="newResource"&gt;
    &lt;Arg&gt;&lt;Property name="bundle.root"/&gt;&lt;/Arg&gt;
  &lt;/Call&gt;

  &lt;Ref refid="res"&gt;
    &lt;Call id="base" name="addPath"&gt;
      &lt;Arg&gt;/static/&lt;/Arg&gt;
    &lt;/Call&gt;
  &lt;/Ref&gt;

  &lt;Set name="contextPath"&gt;/unset&lt;/Set&gt;

  &lt;!-- Set up the base resource for static files relative to inside bundle --&gt;
  &lt;Set name="baseResource"&gt;
     &lt;Ref refid="base"/&gt;
  &lt;/Set&gt;

  &lt;Set name="handler"&gt;
    &lt;New class="org.eclipse.jetty.server.handler.ResourceHandler"&gt;
      &lt;Set name="welcomeFiles"&gt;
        &lt;Array type="String"&gt;
          &lt;Item&gt;index.html&lt;/Item&gt;
        &lt;/Array&gt;
      &lt;/Set&gt;
      &lt;Set name="cacheControl"&gt;max-age=3600,public&lt;/Set&gt;
    &lt;/New&gt;
  &lt;/Set&gt;

&lt;/Configure&gt;</code></pre><p>您还可以使用以下OSGi服务属性：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">managedServerName</span></dt><dd>将此Webapp部署到的服务器实例的名称。如果未指定，则默认为名为“ defaultJettyServer”的默认服务器实例。</dd></dl></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_extra_properties_available_for_context_xml_files_2"></a>上下文Xml文件可用的其他属性</h4></div></div></div><p>在Jetty OSGi容器应用上下文XML文件之前， <code class="literal">Jetty-ContextFilePath</code>属性，它设置了一些可以在xml文件中引用的有用属性：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">服务器</span></dt><dd>这是对码头的参考<code class="literal">org.eclipse.jetty.server.Server</code>实例<code class="literal">ContextHandler</code>在上下文xml文件中配置的配置将被部署。</dd><dt><span class="term">bundle.root</span></dt><dd>这是对<code class="literal">org.eclipse.jetty.util.resource.Resource</code>代表发布发布的捆绑包的位置<code class="literal">ContextHandler</code>即服务（通过致电获得<code class="literal">Bundle.getLocation()</code> ）。请注意，如果OSGi容器自动解压缩包，则该目录可能是文件系统中的目录，如果该包仍被打包，则它可能是jar：file：url。</dd></dl></div><p>在上面的示例中，您可以看到上下文xml文件中同时使用了这两个属性。</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_support_for_the_osgi_service_platform_enterprise_specification"></a>支持OSGi服务平台企业规范</h3></div></div></div><p>Jetty OSGi容器针对以下方面实现了企业规范v4.2的多个方面： <code class="literal">WebAppContexts</code>和<code class="literal">ContextHandlers</code>如前所述，它是从捆绑软件或OSGi服务进行部署的。</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_context_attributes"></a>上下文属性</h4></div></div></div><p>对于每个<code class="literal">WebAppContext</code>要么<code class="literal">ContextHandler</code> ，根据第<span class="emphasis"><em>128.6.1</em></span>节“ <span class="emphasis"><em>绑定上下文”</em></span>页面427的要求，设置了以下上下文属性：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">osgi-bundleContext</span></dt><dd>此属性的值为<code class="literal">BundleContext</code>代表与<code class="literal">WebAppContext</code>要么<code class="literal">ContextHandler</code> 。</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_service_attributes"></a>服务属性</h4></div></div></div><p>根据规范部分<span class="emphasis"><em>128.3.4的</em></span>要求， <span class="emphasis"><em>发布Servlet上下文</em></span>页面421，每个<code class="literal">WebAppContext</code>和<code class="literal">ContextHandler</code>由Jetty OSGi容器部署的部署也将作为OSGi服务发布（除非已经发布-参见1.6和1.7节）。以下属性与这些服务关联：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">osgi.web.symbolicname</span></dt><dd>与以下内容关联的捆绑包的符号名称<code class="literal">WebAppContext</code>要么<code class="literal">ContextHandler</code></dd><dt><span class="term">osgi.web.version</span></dt><dd>来自Bundle的Bundle-Version标头与<code class="literal">WebAppContext</code>要么<code class="literal">ContextHandler</code></dd><dt><span class="term">osgi.web.contextpath</span></dt><dd>的上下文路径<code class="literal">WebAppContext</code>要么<code class="literal">ContextHandler</code></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_osgi_events"></a> OSGi活动</h4></div></div></div><p>根据规范部分<span class="emphasis"><em>128.5 Events</em></span> pg 426的要求，将发布以下OSGi Event Admin事件：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">org / osgi / service / web / DEPLOYING</span></dt><dd>Jetty OSGi容器即将部署<code class="literal">WebAppContext</code>要么<code class="literal">ContextHandler</code></dd><dt><span class="term">org / osgi / service / web / DEPLOYED</span></dt><dd>Jetty OSGi容器已完成部署<code class="literal">WebAppContext</code>要么<code class="literal">ContextHandler</code>它正在使用中</dd><dt><span class="term">org / osgi / service / web / UNDEPLOYING</span></dt><dd>Jetty OSGi容器即将取消部署<code class="literal">WebAppContext</code>要么<code class="literal">ContextHandler</code></dd><dt><span class="term">org / osgi / service / web / UNDEPLOYED</span></dt><dd>Jetty OSGi容器已取消部署<code class="literal">WebAppContext</code>要么<code class="literal">ContextHandler</code>而且不再使用</dd><dt><span class="term">org / osgi / service / web / FAILED</span></dt><dd>Jetty OSGi容器无法部署<code class="literal">WebAppContext</code>要么<code class="literal">ContextHandler</code></dd></dl></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_using_jsps"></a>使用JSP</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_setup"></a>设定</h4></div></div></div><p>为了将JSP与Web应用程序和捆绑软件一起使用，您需要将JSP和JSTL jar以及它们的依赖项安装到OSGi容器中。您可以在Jetty发行版中找到一些，而另一些则需要从<a class="link" href="https://repo1.maven.org/maven2/org/eclipse/jetty/orbit/" target="_top">Maven central</a>下载。这是推荐的jar列表（注意，将来版本号可能会更改）：</p><div class="table"><a name="osgi-jsp"></a><p class="title"><b>表29.3JSP所需的Jar</b></p><div class="table-contents"><table class="table" border="1" summary="Jars Required for JSP"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top">罐</th><th align="left" valign="top">捆绑符号名称</th><th align="left" valign="top">地点</th></tr></thead><tbody><tr><td align="left" valign="top"><p><a class="link" href="framework-jetty-osgi.html#osgi-annotations" title="使用Annotations / ServletContainerInitializers">注释罐</a></p></td><td align="left" valign="top"> </td><td align="left" valign="top"> </td></tr><tr><td align="left" valign="top"><p>org.mortbay.jasper：apache-el</p></td><td align="left" valign="top"><p>org.mortbay.jasper.apache-el</p></td><td align="left" valign="top"><p>发行版lib / apache-jsp</p></td></tr><tr><td align="left" valign="top"><p>org.mortbay.jasper：apache-jsp</p></td><td align="left" valign="top"><p>org.mortbay.jasper.apache-jsp</p></td><td align="left" valign="top"><p>发行版lib / apache-jsp</p></td></tr><tr><td align="left" valign="top"><p>org.eclipse.jetty：apache-jsp</p></td><td align="left" valign="top"><p>org.eclipse.jetty.apache-jsp</p></td><td align="left" valign="top"><p>发行版lib / apache-jsp</p></td></tr><tr><td align="left" valign="top"><p>org.eclipse.jdt.core-3.8.2.v20130121.jar</p></td><td align="left" valign="top"><p>org.eclipse.jdt.core.compiler.batch</p></td><td align="left" valign="top"><p>发行版lib / apache-jsp</p></td></tr><tr><td align="left" valign="top"><p>org.eclipse.jetty.osgi：jetty-osgi-boot-jsp</p></td><td align="left" valign="top"><p>org.eclipse.jetty.osgi.boot.jsp</p></td><td align="left" valign="top"><p><a class="link" href="https://repo1.maven.org/maven2/org/eclipse/jetty/osgi/jetty-osgi-boot-jsp" target="_top">Maven中央</a></p></td></tr></tbody></table></div></div><br class="table-break"><div class="blockquote"><blockquote class="blockquote"><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">从Jetty 9.2.3开始，jetty-osgi-boot-jsp捆绑包更改为使用Apache Jasper作为JSP实现。在此之前，使用了Glassfish Jasper实现，该实现具有一组不同的依赖关系-请仔细注意此页面顶部和本节中列出的jar，因为部署其他jar可能会导致不完整或不正确的程序包解析。 OSGi容器。</li><li class="listitem">部署顺序很重要。按所示顺序部署这些捆绑包，否则您可能会在jsps编译中遇到奇怪的失败。这可能很难诊断，但几乎总是由<code class="literal">ServletContainerInitializer</code>在里面<code class="literal">org.eclipse.jetty.apache-jsp</code>由于注释jar的错误启动，导致未调用jsp容器的bundle。</li></ol></div></blockquote></div><p>对于JSTL库，我们建议使用Glassfish的实现，因为它的依赖项较少：</p><div class="table"><a name="d0e28119"></a><p class="title"><b>表29.4。Glassfish JSTL所需的罐子</b></p><div class="table-contents"><table class="table" border="1" summary="Jars Required for Glassfish JSTL"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top">罐</th><th align="left" valign="top">捆绑符号名称</th><th align="left" valign="top"><a class="link" href="framework-jetty-osgi.html#osgi-jsp" title="表29.3JSP所需的Jar">JSP罐子</a></th></tr></thead><tbody><tr><td align="left" valign="top"> </td><td align="left" valign="top"><p>org.eclipse.jetty.orbit：javax.servlet.jsp.jstl-1.2.0.v201105211821.jar</p></td><td align="left" valign="top"><p>javax.servlet.jsp.jstl</p></td></tr></tbody></table></div></div><br class="table-break"><p>但是，如果您愿意，则可以改用Apache的JSTL实现，尽管您将需要使用适当的OSGi清单来提供一些依赖项jar：</p><div class="table"><a name="d0e28147"></a><p class="title"><b>表29.5。Apache JSTL所需的Jar</b></p><div class="table-contents"><table class="table" border="1" summary="Jars Required for Apache JSTL"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top">罐</th><th align="left" valign="top">捆绑符号名称</th><th align="left" valign="top">地点</th></tr></thead><tbody><tr><td align="left" valign="top"><p><a class="link" href="framework-jetty-osgi.html#osgi-jsp" title="表29.3JSP所需的Jar">JSP罐子</a></p></td><td align="left" valign="top"> </td><td align="left" valign="top"> </td></tr><tr><td align="left" valign="top"><p>org.apache.taglibs：taglibs-standard-spec：jar：1.2.1</p></td><td align="left" valign="top"><p>org.apache.taglibs.taglibs-standard-spec</p></td><td align="left" valign="top"><p>发行版lib / apache-jstl</p></td></tr><tr><td align="left" valign="top"><p>org.apache.taglibs：taglibs-standard-spec：jar：1.2.1</p></td><td align="left" valign="top"><p>org.apache.taglibs.standard-impl</p></td><td align="left" valign="top"><p>发行版lib / apache-jstl</p></td></tr><tr><td align="left" valign="top"><p>org.apache.xalan 2.7.1</p></td><td align="left" valign="top"> </td><td align="left" valign="top"><p>尝试<a class="link" href="http://download.eclipse.org/tools/orbit/downloads/drops/R20140525021250/repository/plugins/org.apache.xalan_2.7.1.v201005080400.jar" target="_top">Eclipse Orbit</a></p></td></tr><tr><td align="left" valign="top"><p>org.apache.xml.serializer 2.7.1</p></td><td align="left" valign="top"> </td><td align="left" valign="top"><p>尝试<a class="link" href="http://download.eclipse.org/tools/orbit/downloads/drops/R20140525021250/repository/plugins/org.apache.xml.serializer_2.7.1.v201005080400.jar" target="_top">Eclipse Orbit</a></p></td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_the_jetty_osgi_boot_jsp_jar"></a> jetty-osgi-boot-jsp jar</h4></div></div></div><p>为了能够使用JSP，您还需要将<a class="link" href="https://repo1.maven.org/maven2/org/eclipse/jetty/osgi/jetty-osgi-boot-jsp/" target="_top">jetty-osgi-boot-jsp.jar安装</a>到OSGi容器中。这个罐子可以从<a class="link" href="https://repo1.maven.org/maven2/org/eclipse/jetty/osgi/jetty-osgi-boot-jsp/" target="_top">这里的</a> Maven Central获得。</p><p>该捆绑包充当jetty-osgi-boot.jar的片段扩展，并增加了对使用JSP的支持。</p><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="_using_taglibs"></a>使用TagLib</h5></div></div></div><p>Jetty JSP OSGi容器将使JSTL标签库可用于所有webapp。如果您仅使用此标记库，则您的Web应用将无需任何进一步修改即可运行。</p><p>但是，如果您使用其他标记库，则需要确保将它们安装在OSGi容器中，并定义一些系统属性和/或<code class="literal">MANIFEST</code> Webapp中的标题。这是必要的，因为OSGi容器使用的类加载机制与JSP容器使用的类加载机制非常不同，并且<code class="literal">MANIFEST</code>正常的Webapp所包含的OSGi环境信息不足，因此JSP容器无法查找和解析Webapp的.jsp文件中引用的TLD。</p><p>首先，让我们看一下Web捆绑软件修改后的示例<code class="literal">MANIFEST</code>文件，以便您了解所需的内容。此示例是一个使用Spring servlet框架的Web捆绑包：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>Bundle-SymbolicName: com.acme.sample
Bundle-Name: WebSample
Web-ContextPath: taglibs
Import-Bundle: org.springframework.web.servlet
Require-TldBundle: org.springframework.web.servlet
Bundle-Version: 1.0.0
Import-Package: org.eclipse.virgo.web.dm;version="[3.0.0,4.0.0)",org.s
 pringframework.context.config;version="[2.5.6,4.0.0)",org.springframe
 work.stereotype;version="[2.5.6,4.0.0)",org.springframework.web.bind.
 annotation;version="[2.5.6,4.0.0)",org.springframework.web.context;ve
 rsion="[2.5.6,4.0.0)",org.springframework.web.servlet;version="[2.5.6
 ,4.0.0)",org.springframework.web.servlet.view;version="[2.5.6,4.0.0)"</code></pre><p><span class="strong"><strong>Require-TldBundle</strong></span>标头告诉Jetty OSGi容器此捆绑包包含需要传递到JSP容器进行处理的TLD。<span class="strong"><strong>Import-Bundle</strong></span>标头可确保OSGi类路径上的webapp可以使用这些TLD的实现类。</p><p><span class="strong"><strong>Require-TldBundle</strong></span>标头的格式是用逗号分隔的包含TLD的捆绑包的一个或多个符号名称的列表。</p></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="_container_path_taglibs"></a>容器路径标签库</h5></div></div></div><p>需要在Jetty OSGi容器的类路径上找到一些TLD jar，而不是将其视为Web捆绑软件的类路径的一部分。例如，JSTL和Java Server Faces就是这样。Jetty OSGi容器为您处理了JSTL，但是您可以使用System属性<span class="strong"><strong>org.eclipse.jetty.osgi.tldbundles</strong></span>来控制将哪些其他jar视为容器的类路径的一部分：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">org.eclipse.jetty.osgi.tldbundles</span></dt><dd><p class="simpara">在OSGi环境上定义的系统属性，该属性是用逗号分隔的包含taglib的包的符号名称列表，这些标签库将被视为在web包的容器的类路径上。例如：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>org.eclipse.jetty.osgi.tldbundles=com.acme.special.tags,com.foo.web,org.bar.web.framework</code></pre><p class="simpara">你仍然需要在定义<span class="strong"><strong>导入-Bundle</strong></span>头部<code class="literal">MANIFEST</code> Web捆绑包的文件，以确保TLD捆绑包在OSGi类路径上。</p></dd></dl></div><p>替代地或附加地，您可以将模式定义为上下文属性，该模式将与OSGi环境中的符号束名称匹配，该符号束名称包含应视为从容器的类路径中发现的TLD。</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">org.eclipse.jetty.server.webapp.containerIncludeBundlePattern</span></dt><dd><p class="simpara">此模式必须指定为<code class="literal">WebAppContext</code>代表网络捆绑包。除非您自己部署<code class="literal">WebAppContext</code> （请参阅将<a class="link" href="framework-jetty-osgi.html#services-as-webapps" title="将服务作为Webapp部署">服务部署为Webapp</a> ），您将没有对<code class="literal">WebAppContext</code>去做这个。在这种情况下，可以在<code class="literal">org.eclipse.jetty.deploy.DeploymentManager</code> ，它将应用于Jetty OSGi容器部署的<span class="emphasis"><em>每个</em></span> Web应用程序。的<code class="literal">jetty-osgi-boot.jar</code>包含默认<code class="literal">jettyhome/etc/jetty-deploy.xml</code>文件在哪里<code class="literal">DeploymentManager</code>被定义为。要设置模式，您将需要提供自己的etc文件-有关如何执行此操作，请参阅有关<a class="link" href="framework-jetty-osgi.html#customize-jetty-container" title="自定义码头集装箱">定制码头容器</a>的部分。这是<code class="literal">jetty-deploy.xml</code>如果我们定义了一个模式，以匹配所有以“ tag”和“ web”结尾的捆绑符号名称，则文件将看起来：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "http://www.eclipse.org/jetty/configure_9_3.dtd"&gt;
&lt;Configure id="Server" class="org.eclipse.jetty.server.Server"&gt;
    &lt;Call name="addBean"&gt;
      &lt;Arg&gt;
        &lt;New id="DeploymentManager" class="org.eclipse.jetty.deploy.DeploymentManager"&gt;
          &lt;Set name="contexts"&gt;
            &lt;Ref refid="Contexts" /&gt;
          &lt;/Set&gt;
          &lt;Call name="setContextAttribute"&gt;
            &lt;Arg&gt;org.eclipse.jetty.server.webapp.ContainerIncludeBundlePattern&lt;/Arg&gt;
            &lt;Arg&gt;.*\.tag$|.*\.web$&lt;/Arg&gt;
          &lt;/Call&gt;
        &lt;/New&gt;
      &lt;/Arg&gt;
    &lt;/Call&gt;
&lt;/Configure&gt;</code></pre><p class="simpara">同样，您仍然需要在网络捆绑包中定义合适的<span class="strong"><strong>Import-Bundle</strong></span>标头<code class="literal">MANIFEST</code>以确保与模式匹配的包在OSGi类路径上可用。</p></dd></dl></div></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="osgi-annotations"></a>使用Annotations / ServletContainerInitializers</h3></div></div></div><p>注释是Servlet 3.0和3.1规范的大部分内容。为了在OSGi中将它们与Jetty一起使用，您将需要在OSGi容器中部署一些额外的jar：</p><div class="table"><a name="d0e28339"></a><p class="title"><b>表29.6。注释所需的罐子</b></p><div class="table-contents"><table class="table" border="1" summary="Jars Required for Annotations"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top">罐</th><th align="left" valign="top">捆绑符号名称</th><th align="left" valign="top">地点</th></tr></thead><tbody><tr><td align="left" valign="top"><p><a class="link" href="framework-jetty-osgi.html#spifly" title="表29.2SPI飞包">罐子</a></p></td><td align="left" valign="top"> </td><td align="left" valign="top"> </td></tr><tr><td align="left" valign="top"><p>org.ow2.asm：asm-7.0.jar</p></td><td align="left" valign="top"><p>org.objectweb.asm</p></td><td align="left" valign="top"><p><a class="link" href="https://repo1.maven.org/maven2/org/ow2/asm/asm" target="_top">Maven中央</a></p></td></tr><tr><td align="left" valign="top"><p>org.ow2.asm：asm-commons-7.0.jar</p></td><td align="left" valign="top"><p>org.objectweb.asm.commons</p></td><td align="left" valign="top"><p><a class="link" href="https://repo1.maven.org/maven2/org/ow2/asm/asm-commons" target="_top">Maven中央</a></p></td></tr><tr><td align="left" valign="top"><p>org.ow2.asm：asm-tree-7.0.jar</p></td><td align="left" valign="top"><p>org.objectweb.asm.tree</p></td><td align="left" valign="top"><p><a class="link" href="https://repo1.maven.org/maven2/org/ow2/asm/asm-tree" target="_top">Maven中央</a></p></td></tr><tr><td align="left" valign="top"><p>javax.annotation：javax.annotation-api-1.2.jar</p></td><td align="left" valign="top"><p>javax.annotation-api</p></td><td align="left" valign="top"><p><a class="link" href="https://repo1.maven.org/maven2/javax/annotation/javax.annotation-api/" target="_top">Maven中央</a></p></td></tr><tr><td align="left" valign="top"><p>jta api版本1.1.1（例如org.apache.geronimo.specs：geronimo-jta_1.1_spec-1.1.1.jar） <sup>*</sup></p></td><td align="left" valign="top"> </td><td align="left" valign="top"><p>Maven中央</p></td></tr><tr><td align="left" valign="top"><p>javax邮件api版本1.4.1（例如org.eclipse.jetty.orbit：javax.mail.glassfish-1.4.1.v201005082020.jar） <sup>*</sup></p></td><td align="left" valign="top"> </td><td align="left" valign="top"><p>Maven中央</p></td></tr><tr><td align="left" valign="top"><p>码头</p></td><td align="left" valign="top"><p>org.eclipse.jetty.jndi</p></td><td align="left" valign="top"><p>发行版lib /</p></td></tr><tr><td align="left" valign="top"><p>码头</p></td><td align="left" valign="top"><p>org.eclipse.jetty.plus</p></td><td align="left" valign="top"><p>发行版lib /</p></td></tr><tr><td align="left" valign="top"><p>码头注释</p></td><td align="left" valign="top"><p>org.eclipse.jetty.annotations</p></td><td align="left" valign="top"><p>发行版lib /</p></td></tr></tbody></table></div></div><br class="table-break"><div class="blockquote"><blockquote class="blockquote"><div class="important" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-plus" aria-hidden="true"></i>重要</h3><p>如果您希望使用JSP，则需要部署这些与注释相关的jar。</p></div></blockquote></div><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>您也许可以部署这些规范的更高版本或其他提供程序，但是已知这些特定版本具有正确的清单，并且已经过测试，可以与OSGi一起使用。</p></div></blockquote></div><p>即使您的webapp本身不使用注释，您可能也需要部署这些jar，因为您的webapp依赖于Jetty模块或使用<a class="link" href="http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContainerInitializer.html" target="_top">javax.servlet的第3方库</a><a class="link" href="http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContainerInitializer.html" target="_top">。ServletContainerInitializer</a> 。此接口需要注释支持。它由扩展容器功能的代码提供者实现。一个示例是Jetty JSR356 Websocket实现，尽管在诸如<a class="link" href="http://projects.spring.io/spring-framework/" target="_top">Spring</a> ， <a class="link" href="https://jersey.java.net/" target="_top">Jersey</a>和JSP容器之类的流行库中越来越多地使用它。</p><p>寻找<code class="literal">ServletContainerInitializers</code>在类路径上，Jetty使用Java <a class="link" href="http://docs.oracle.com/javase/7/docs/api/java/util/ServiceLoader.html" target="_top"><code class="literal">ServiceLoader</code></a>机制。为了使此功能在OSGi中起作用，您需要一个与OSGi R5兼容的容器，并支持<a class="link" href="http://blog.osgi.org/2013/02/javautilserviceloader-in-osgi.html" target="_top">Service Loader介体</a> 。Jetty已使用<a class="link" href="http://aries.apache.org/modules/spi-fly.html" target="_top">Aries SpiFly</a>模块进行了测试，该模块是Service Loader中介程序的参考实现，在上面的jar中列出。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_osgi_containers"></a> OSGi容器</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_felix"></a>费利克斯</h4></div></div></div><p>Jetty OSGi集成已针对<a class="link" href="http://felix.apache.org/" target="_top">Felix</a> 5.0.0成功进行了测试。</p><p>您将需要以下额外的Felix服务，这些服务可作为单独下载的jar来使用：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem"><a class="link" href="http://felix.apache.org/documentation/subprojects/apache-felix-config-admin.html" target="_top">Felix配置管理服务</a></li><li class="listitem"><a class="link" href="http://felix.apache.org/documentation/subprojects/apache-felix-event-admin.html" target="_top">Felix活动管理服务</a></li></ul></div><p>不幸的是，从Felix 4.x开始，它的分辨率很难<code class="literal">javax.transaction</code>包。[ <a class="link" href="http://mail-archives.apache.org/mod_mbox/felix-users/201211.mbox/%3CCAPr=90M+5vYjPqAvyTU+gYHr64y_FosBYELeUYcU_rFEJF3Cxw@mail.gmail.com%3E" target="_top">这里</a> ] <a class="link" href="http://mail-archives.apache.org/mod_mbox/felix-users/201211.mbox/%3CCAPr=90M+5vYjPqAvyTU+gYHr64y_FosBYELeUYcU_rFEJF3Cxw@mail.gmail.com%3E" target="_top">描述了问题</a>的<a class="link" href="http://mail-archives.apache.org/mod_mbox/felix-users/201211.mbox/%3CCAPr=90M+5vYjPqAvyTU+gYHr64y_FosBYELeUYcU_rFEJF3Cxw@mail.gmail.com%3E" target="_top">描述</a>和解决<a class="link" href="http://mail-archives.apache.org/mod_mbox/felix-users/201211.mbox/%3CCAPr=90M+5vYjPqAvyTU+gYHr64y_FosBYELeUYcU_rFEJF3Cxw@mail.gmail.com%3E" target="_top">问题的</a>提示。</p><p>最简单的解决方案是提取<code class="literal">default.properties</code>来自的文件<code class="literal">felix.jar</code> ，更改的声明<code class="literal">javax.sql</code>和<code class="literal">javax.transaction</code>打包并将更改的行设置为<code class="literal">org.osgi.framework.system.packages</code>物业<code class="literal">conf/config.properties</code>文件。</p><p>的<code class="literal">default.properties</code>文件定义默认<code class="literal">org.osgi.framework.system.packages</code>像这样的属性：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code># Default packages exported by system bundle.
org.osgi.framework.system.packages=org.osgi.framework; version=1.7.0, \
 org.osgi.framework.hooks.bundle; version=1.1.0, \
 org.osgi.framework.hooks.resolver; version=1.0.0, \
 org.osgi.framework.hooks.service; version=1.1.0, \
 org.osgi.framework.hooks.weaving; version=1.0.0, \
 org.osgi.framework.launch; version=1.1.0, \
 org.osgi.framework.namespace; version=1.0.0, \
 org.osgi.framework.startlevel; version=1.0.0, \
 org.osgi.framework.wiring; version=1.1.0, \
 org.osgi.resource; version=1.0.0, \
 org.osgi.service.packageadmin; version=1.2.0, \
 org.osgi.service.startlevel; version=1.1.0, \
 org.osgi.service.url; version=1.0.0, \
 org.osgi.util.tracker; version=1.5.1 \
 ${jre-${java.specification.version}}</code></pre><p>最后一行必须替换文件中最适合您正在使用的jvm的定义之一。</p><p>您将采用这些行并将其复制到<code class="literal">conf/config.properties</code>文件，替换行之后<code class="literal">$\{jre-$\{java.specification.version}}</code>与所有与您的jvm版本相关的行。</p><p>例如，对于1.7 jvm，您将找到以下属性定义：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>jre-1.7=, \
 javax.accessibility;uses:="javax.swing.text";version="0.0.0.1_007_JavaSE", \
 javax.activation;version="0.0.0.1_007_JavaSE", \
 javax.activity;version="0.0.0.1_007_JavaSE", \
 javax.annotation.processing;uses:="javax.tools,javax.lang.model,javax.lang.model.element,javax.lang.model.util";version="0.0.0.1_007_JavaSE", \
 javax.annotation;version="0.0.0.1_007_JavaSE", \
 javax.crypto.interfaces;uses:="javax.crypto.spec,javax.crypto";version="0.0.0.1_007_JavaSE", \
 javax.crypto.spec;uses:="javax.crypto";version="0.0.0.1_007_JavaSE", \
 javax.crypto;uses:="javax.crypto.spec";version="0.0.0.1_007_JavaSE", \
 javax.imageio.event;uses:="javax.imageio";version="0.0.0.1_007_JavaSE", \
 javax.imageio.metadata;uses:="org.w3c.dom,javax.imageio";version="0.0.0.1_007_JavaSE", \
 javax.imageio.plugins.bmp;uses:="javax.imageio";version="0.0.0.1_007_JavaSE", \
 javax.imageio.plugins.jpeg;uses:="javax.imageio";version="0.0.0.1_007_JavaSE", \
 javax.imageio.spi;uses:="javax.imageio.stream,javax.imageio,javax.imageio.metadata";version="0.0.0.1_007_JavaSE", \
 javax.imageio.stream;uses:="javax.imageio";version="0.0.0.1_007_JavaSE", \
 javax.imageio;uses:="javax.imageio.metadata,javax.imageio.stream,javax.imageio.spi,javax.imageio.event";version="0.0.0.1_007_JavaSE", \
 javax.jws.soap;version="0.0.0.1_007_JavaSE", \
 javax.jws;version="0.0.0.1_007_JavaSE", \
 javax.lang.model.element;uses:="javax.lang.model.type,javax.lang.model";version="0.0.0.1_007_JavaSE", \
 javax.lang.model.type;uses:="javax.lang.model.element,javax.lang.model";version="0.0.0.1_007_JavaSE", \
 javax.lang.model.util;uses:="javax.lang.model,javax.lang.model.element,javax.annotation.processing,javax.lang.model.type";version="0.0.0.1_007_JavaSE", \
 javax.lang.model;version="0.0.0.1_007_JavaSE", \
 javax.management.loading;uses:="javax.management";version="0.0.0.1_007_JavaSE", \
 javax.management.modelmbean;uses:="javax.management,javax.management.loading";version="0.0.0.1_007_JavaSE", \
 javax.management.monitor;uses:="javax.management";version="0.0.0.1_007_JavaSE", \
 javax.management.openmbean;uses:="javax.management";version="0.0.0.1_007_JavaSE", \
 javax.management.relation;uses:="javax.management";version="0.0.0.1_007_JavaSE", \
 javax.management.remote.rmi;uses:="javax.management.remote,javax.security.auth,javax.management,javax.management.loading,javax.naming,javax.rmi.ssl,org.omg.CORBA,org.omg.CORBA_2_3.portable,org.omg.CORBA.portable,javax.rmi.CORBA,javax.rmi";version="0.0.0.1_007_JavaSE", \
 javax.management.remote;uses:="javax.security.auth,javax.management";version="0.0.0.1_007_JavaSE", \
 javax.management.timer;uses:="javax.management";version="0.0.0.1_007_JavaSE", \
 javax.management;uses:="javax.management.loading,javax.management.openmbean";version="0.0.0.1_007_JavaSE", \
 javax.naming.directory;uses:="javax.naming";version="0.0.0.1_007_JavaSE", \
 javax.naming.event;uses:="javax.naming,javax.naming.directory";version="0.0.0.1_007_JavaSE", \
 javax.naming.ldap;uses:="javax.naming,javax.naming.directory,javax.net.ssl,javax.naming.event";version="0.0.0.1_007_JavaSE", \
 javax.naming.spi;uses:="javax.naming,javax.naming.directory";version="0.0.0.1_007_JavaSE", \
 javax.naming;uses:="javax.naming.spi";version="0.0.0.1_007_JavaSE", \
 javax.net.ssl;uses:="javax.security.cert,javax.security.auth.x500,javax.net";version="0.0.0.1_007_JavaSE", \
 javax.net;version="0.0.0.1_007_JavaSE", \
 javax.print.attribute.standard;uses:="javax.print.attribute";version="0.0.0.1_007_JavaSE", \
 javax.print.attribute;version="0.0.0.1_007_JavaSE", \
 javax.print.event;uses:="javax.print,javax.print.attribute";version="0.0.0.1_007_JavaSE", \
 javax.print;uses:="javax.print.attribute,javax.print.event,javax.print.attribute.standard";version="0.0.0.1_007_JavaSE", \
 javax.rmi.CORBA;uses:="org.omg.CORBA,org.omg.CORBA_2_3.portable,org.omg.CORBA.portable,org.omg.SendingContext";version="0.0.0.1_007_JavaSE", \
 javax.rmi.ssl;uses:="javax.net,javax.net.ssl";version="0.0.0.1_007_JavaSE", \
 javax.rmi;uses:="org.omg.CORBA,javax.rmi.CORBA";version="0.0.0.1_007_JavaSE", \
 javax.script;version="0.0.0.1_007_JavaSE", \
 javax.security.auth.callback;version="0.0.0.1_007_JavaSE", \
 javax.security.auth.kerberos;uses:="javax.security.auth,javax.crypto";version="0.0.0.1_007_JavaSE", \
 javax.security.auth.login;uses:="javax.security.auth,javax.security.auth.callback";version="0.0.0.1_007_JavaSE", \
 javax.security.auth.spi;uses:="javax.security.auth.callback,javax.security.auth.login,javax.security.auth";version="0.0.0.1_007_JavaSE", \
 javax.security.auth.x500;uses:="javax.security.auth";version="0.0.0.1_007_JavaSE", \
 javax.security.auth;version="0.0.0.1_007_JavaSE", \
 javax.security.cert;version="0.0.0.1_007_JavaSE", \
 javax.security.sasl;uses:="javax.security.auth.callback";version="0.0.0.1_007_JavaSE", \
 javax.sound.midi.spi;uses:="javax.sound.midi";version="0.0.0.1_007_JavaSE", \
 javax.sound.midi;uses:="javax.sound.midi.spi";version="0.0.0.1_007_JavaSE", \
 javax.sound.sampled.spi;uses:="javax.sound.sampled";version="0.0.0.1_007_JavaSE", \
 javax.sound.sampled;uses:="javax.sound.sampled.spi";version="0.0.0.1_007_JavaSE", \
 javax.sql.rowset.serial;uses:="javax.sql.rowset";version="0.0.0.1_007_JavaSE", \
 javax.sql.rowset.spi;uses:="javax.sql,javax.naming,javax.sql.rowset";version="0.0.0.1_007_JavaSE", \
 javax.sql.rowset;uses:="javax.sql,javax.sql.rowset.serial,javax.sql.rowset.spi";version="0.0.0.1_007_JavaSE", \
 javax.sql;uses:="javax.transaction.xa";version="0.0.0.1_007_JavaSE", \
 javax.swing.border;uses:="javax.swing";version="0.0.0.1_007_JavaSE", \
 javax.swing.colorchooser;uses:="javax.swing,javax.swing.border,javax.swing.event,javax.swing.text";version="0.0.0.1_007_JavaSE", \
 javax.swing.event;uses:="javax.swing,javax.swing.text,javax.swing.table,javax.swing.tree,javax.swing.undo";version="0.0.0.1_007_JavaSE", \
 javax.swing.filechooser;uses:="javax.swing";version="0.0.0.1_007_JavaSE", \
 javax.swing.plaf.basic;uses:="javax.swing.border,javax.swing,javax.swing.plaf,javax.swing.text,javax.swing.event,javax.swing.colorchooser,javax.accessibility,javax.swing.filechooser,javax.swing.text.html,javax.sound.sampled,javax.swing.table,javax.swing.plaf.synth,javax.swing.tree";version="0.0.0.1_007_JavaSE", \
 javax.swing.plaf.metal;uses:="javax.swing.plaf,javax.swing,javax.swing.border,javax.swing.text,javax.swing.plaf.basic,javax.swing.filechooser,javax.swing.event,javax.swing.tree";version="0.0.0.1_007_JavaSE", \
 javax.swing.plaf.multi;uses:="javax.accessibility,javax.swing,javax.swing.plaf,javax.swing.filechooser,javax.swing.text,javax.swing.tree";version="0.0.0.1_007_JavaSE", \
 javax.swing.plaf.nimbus;uses:="javax.swing,javax.swing.plaf,javax.swing.border,javax.swing.plaf.synth";version="0.0.0.1_007_JavaSE", \
 javax.swing.plaf.synth;uses:="javax.swing,javax.swing.plaf,javax.swing.text,javax.swing.border,javax.swing.plaf.basic,javax.swing.colorchooser,javax.swing.event,javax.xml.parsers,org.xml.sax,org.xml.sax.helpers,javax.swing.table,javax.swing.tree";version="0.0.0.1_007_JavaSE", \
 javax.swing.plaf;uses:="javax.swing,javax.swing.border,javax.accessibility,javax.swing.filechooser,javax.swing.text,javax.swing.tree";version="0.0.0.1_007_JavaSE", \
 javax.swing.table;uses:="javax.swing.event,javax.swing.plaf,javax.swing.border,javax.swing,javax.accessibility";version="0.0.0.1_007_JavaSE", \
 javax.swing.text.html.parser;uses:="javax.swing.text,javax.swing.text.html";version="0.0.0.1_007_JavaSE", \
 javax.swing.text.html;uses:="javax.swing.event,javax.swing.text,javax.accessibility,javax.swing,javax.swing.plaf,javax.swing.border,javax.swing.undo";version="0.0.0.1_007_JavaSE", \
 javax.swing.text.rtf;uses:="javax.swing.text";version="0.0.0.1_007_JavaSE", \
 javax.swing.text;uses:="javax.swing.event,javax.swing.tree,javax.swing.undo,javax.swing,javax.swing.plaf,javax.swing.plaf.basic,javax.print,javax.print.attribute,javax.accessibility,javax.swing.text.html";version="0.0.0.1_007_JavaSE", \
 javax.swing.tree;uses:="javax.swing.event,javax.swing,javax.swing.border,javax.swing.plaf,javax.swing.plaf.basic";version="0.0.0.1_007_JavaSE", \
 javax.swing.undo;uses:="javax.swing,javax.swing.event";version="0.0.0.1_007_JavaSE", \
 javax.swing;uses:="javax.swing.event,javax.accessibility,javax.swing.text,javax.swing.plaf,javax.swing.border,javax.swing.tree,javax.swing.table,javax.swing.colorchooser,javax.swing.plaf.basic,javax.swing.text.html,javax.swing.filechooser,javax.print,javax.print.attribute,javax.swing.plaf.metal";version="0.0.0.1_007_JavaSE", \
 javax.tools;uses:="javax.lang.model.element,javax.annotation.processing,javax.lang.model";version="0.0.0.1_007_JavaSE", \
 javax.transaction.xa;version="0.0.0.1_007_JavaSE", \
 javax.transaction;version="0.0.0.1_007_JavaSE", \
 javax.xml.bind.annotation.adapters;uses:="javax.xml.bind";version="0.0.0.1_007_JavaSE", \
 javax.xml.bind.annotation;uses:="javax.xml.transform,javax.xml.bind,javax.xml.parsers,javax.xml.transform.dom,org.w3c.dom";version="0.0.0.1_007_JavaSE", \
 javax.xml.bind.attachment;uses:="javax.activation";version="0.0.0.1_007_JavaSE", \
 javax.xml.bind.helpers;uses:="javax.xml.bind.annotation.adapters,javax.xml.transform.dom,org.w3c.dom,org.xml.sax,javax.xml.bind.attachment,javax.xml.stream,javax.xml.transform,javax.xml.transform.stream,javax.xml.validation,javax.xml.transform.sax,javax.xml.bind,javax.xml.parsers";version="0.0.0.1_007_JavaSE", \
 javax.xml.bind.util;uses:="javax.xml.transform.sax,javax.xml.bind,org.xml.sax,org.xml.sax.ext,org.xml.sax.helpers";version="0.0.0.1_007_JavaSE", \
 javax.xml.bind;uses:="javax.xml.validation,javax.xml.namespace,javax.xml.datatype,javax.xml.transform,javax.xml.bind.annotation,javax.xml.transform.stream,org.w3c.dom,javax.xml.bind.attachment,javax.xml.stream,javax.xml.bind.annotation.adapters,org.xml.sax";version="0.0.0.1_007_JavaSE", \
 javax.xml.crypto.dom;uses:="javax.xml.crypto,org.w3c.dom";version="0.0.0.1_007_JavaSE", \
 javax.xml.crypto.dsig.dom;uses:="javax.xml.crypto.dsig,javax.xml.crypto,org.w3c.dom,javax.xml.crypto.dom";version="0.0.0.1_007_JavaSE", \
 javax.xml.crypto.dsig.keyinfo;uses:="javax.xml.crypto";version="0.0.0.1_007_JavaSE", \
 javax.xml.crypto.dsig.spec;uses:="javax.xml.crypto";version="0.0.0.1_007_JavaSE", \
 javax.xml.crypto.dsig;uses:="javax.xml.crypto,javax.xml.crypto.dsig.spec,javax.xml.crypto.dsig.keyinfo";version="0.0.0.1_007_JavaSE", \
 javax.xml.crypto;uses:="javax.xml.crypto.dsig.keyinfo";version="0.0.0.1_007_JavaSE", \
 javax.xml.datatype;uses:="javax.xml.namespace";version="0.0.0.1_007_JavaSE", \
 javax.xml.namespace;version="0.0.0.1_007_JavaSE", \
 javax.xml.parsers;uses:="javax.xml.validation,org.w3c.dom,org.xml.sax,org.xml.sax.helpers";version="0.0.0.1_007_JavaSE", \
 javax.xml.soap;uses:="javax.activation,javax.xml.namespace,org.w3c.dom,javax.xml.transform.dom,javax.xml.transform";version="0.0.0.1_007_JavaSE", \
 javax.xml.stream.events;uses:="javax.xml.namespace,javax.xml.stream";version="0.0.0.1_007_JavaSE", \
 javax.xml.stream.util;uses:="javax.xml.stream,javax.xml.stream.events,javax.xml.namespace";version="0.0.0.1_007_JavaSE", \
 javax.xml.stream;uses:="javax.xml.stream.events,javax.xml.namespace,javax.xml.stream.util,javax.xml.transform";version="0.0.0.1_007_JavaSE", \
 javax.xml.transform.dom;uses:="javax.xml.transform,org.w3c.dom";version="0.0.0.1_007_JavaSE", \
 javax.xml.transform.sax;uses:="org.xml.sax.ext,javax.xml.transform,org.xml.sax,javax.xml.transform.stream";version="0.0.0.1_007_JavaSE", \
 javax.xml.transform.stax;uses:="javax.xml.stream,javax.xml.transform,javax.xml.stream.events";version="0.0.0.1_007_JavaSE", \
 javax.xml.transform.stream;uses:="javax.xml.transform";version="0.0.0.1_007_JavaSE", \
 javax.xml.transform;version="0.0.0.1_007_JavaSE", \
 javax.xml.validation;uses:="org.w3c.dom.ls,javax.xml.transform,javax.xml.transform.stream,org.xml.sax,org.w3c.dom";version="0.0.0.1_007_JavaSE", \
 javax.xml.ws.handler.soap;uses:="javax.xml.ws.handler,javax.xml.namespace,javax.xml.soap,javax.xml.bind";version="0.0.0.1_007_JavaSE", \
 javax.xml.ws.handler;uses:="javax.xml.ws,javax.xml.namespace";version="0.0.0.1_007_JavaSE", \
 javax.xml.ws.http;uses:="javax.xml.ws";version="0.0.0.1_007_JavaSE", \
 javax.xml.ws.soap;uses:="javax.xml.ws.spi,javax.xml.ws,javax.xml.soap";version="0.0.0.1_007_JavaSE", \
 javax.xml.ws.spi.http;version="0.0.0.1_007_JavaSE", \
 javax.xml.ws.spi;uses:="javax.xml.ws,javax.xml.ws.wsaddressing,javax.xml.transform,org.w3c.dom,javax.xml.namespace,javax.xml.ws.handler,javax.xml.bind";version="0.0.0.1_007_JavaSE", \
 javax.xml.ws.wsaddressing;uses:="javax.xml.bind.annotation,javax.xml.namespace,org.w3c.dom,javax.xml.transform,javax.xml.bind,javax.xml.ws,javax.xml.ws.spi";version="0.0.0.1_007_JavaSE", \
 javax.xml.ws;uses:="javax.xml.ws.handler,javax.xml.ws.spi,javax.xml.ws.spi.http,javax.xml.transform,org.w3c.dom,javax.xml.bind.annotation,javax.xml.transform.stream,javax.xml.bind,javax.xml.namespace";version="0.0.0.1_007_JavaSE", \
 javax.xml.xpath;uses:="org.xml.sax,javax.xml.namespace";version="0.0.0.1_007_JavaSE", \
 javax.xml;version="0.0.0.1_007_JavaSE", \
 org.ietf.jgss;version="0.0.0.1_007_JavaSE", \
 org.omg.CORBA.DynAnyPackage;uses:="org.omg.CORBA";version="0.0.0.1_007_JavaSE", \
 org.omg.CORBA.ORBPackage;uses:="org.omg.CORBA";version="0.0.0.1_007_JavaSE", \
 org.omg.CORBA.TypeCodePackage;uses:="org.omg.CORBA";version="0.0.0.1_007_JavaSE", \
 org.omg.CORBA.portable;uses:="org.omg.CORBA,org.omg.CORBA_2_3.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.CORBA;uses:="org.omg.CORBA.portable,org.omg.CORBA.DynAnyPackage,org.omg.CORBA.ORBPackage,org.omg.CORBA_2_3.portable,org.omg.CORBA.TypeCodePackage";version="0.0.0.1_007_JavaSE", \
 org.omg.CORBA_2_3.portable;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.CORBA_2_3;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.CosNaming.NamingContextExtPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.CosNaming.NamingContextPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable,org.omg.CosNaming";version="0.0.0.1_007_JavaSE", \
 org.omg.CosNaming;uses:="org.omg.CORBA.portable,org.omg.CORBA,org.omg.PortableServer,org.omg.CosNaming.NamingContextPackage,org.omg.CosNaming.NamingContextExtPackage";version="0.0.0.1_007_JavaSE", \
 org.omg.Dynamic;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.DynamicAny.DynAnyFactoryPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.DynamicAny.DynAnyPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.DynamicAny;uses:="org.omg.CORBA,org.omg.CORBA.portable,org.omg.DynamicAny.DynAnyFactoryPackage,org.omg.DynamicAny.DynAnyPackage";version="0.0.0.1_007_JavaSE", \
 org.omg.IOP.CodecFactoryPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.IOP.CodecPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.IOP;uses:="org.omg.CORBA,org.omg.CORBA.portable,org.omg.IOP.CodecFactoryPackage,org.omg.IOP.CodecPackage";version="0.0.0.1_007_JavaSE", \
 org.omg.Messaging;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.PortableInterceptor.ORBInitInfoPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.PortableInterceptor;uses:="org.omg.CORBA,org.omg.CORBA.portable,org.omg.IOP,org.omg.PortableInterceptor.ORBInitInfoPackage,org.omg.CORBA_2_3.portable,org.omg.Dynamic";version="0.0.0.1_007_JavaSE", \
 org.omg.PortableServer.CurrentPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.PortableServer.POAManagerPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.PortableServer.POAPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.PortableServer.ServantLocatorPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.PortableServer.portable;uses:="org.omg.CORBA,org.omg.PortableServer";version="0.0.0.1_007_JavaSE", \
 org.omg.PortableServer;uses:="org.omg.CORBA,org.omg.CORBA.portable,org.omg.PortableServer.CurrentPackage,org.omg.PortableServer.POAManagerPackage,org.omg.PortableServer.POAPackage,org.omg.PortableServer.portable,org.omg.CORBA_2_3,org.omg.PortableServer.ServantLocatorPackage";version="0.0.0.1_007_JavaSE", \
 org.omg.SendingContext;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", \
 org.omg.stub.java.rmi;uses:="javax.rmi.CORBA";version="0.0.0.1_007_JavaSE", \
 org.w3c.dom.bootstrap;uses:="org.w3c.dom";version="0.0.0.1_007_JavaSE", \
 org.w3c.dom.events;uses:="org.w3c.dom,org.w3c.dom.views";version="0.0.0.1_007_JavaSE", \
 org.w3c.dom.ls;uses:="org.w3c.dom,org.w3c.dom.events,org.w3c.dom.traversal";version="0.0.0.1_007_JavaSE", \
 org.w3c.dom;version="0.0.0.1_007_JavaSE", \
 org.xml.sax.ext;uses:="org.xml.sax,org.xml.sax.helpers";version="0.0.0.1_007_JavaSE", \
 org.xml.sax.helpers;uses:="org.xml.sax";version="0.0.0.1_007_JavaSE", \
 org.xml.sax;version="0.0.0.1_007_JavaSE"</code></pre><p>删除的定义<code class="literal">javax.transaction</code>包，然后删除<code class="literal">uses:=</code>的条款<code class="literal">javax.sql</code>包（但离开<code class="literal">version</code>条款）。将所有行连接在一起。您最终会在自己的电脑中看到类似的内容<code class="literal">conf/config.properties</code>文件：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>org.osgi.framework.system.packages=org.osgi.framework;version=1.7.0, org.osgi.framework.hooks.bundle;version=1.1.0, org.osgi.framework.hooks.resolver;version=1.0.0, org.osgi.framework.hooks.service;version=1.1.0, org.osgi.framework.hooks.weaving;version=1.0.0, org.osgi.framework.launch;version=1.1.0, org.osgi.framework.namespace;version=1.0.0, org.osgi.framework.startlevel;version=1.0.0, org.osgi.framework.wiring;version=1.1.0, org.osgi.resource;version=1.0.0, org.osgi.service.packageadmin; version=1.2.0, org.osgi.service.startlevel; version=1.1.0, org.osgi.service.url;version=1.0.0, org.osgi.util.tracker;version=1.5.1 javax.accessibility;uses:="javax.swing.text";version="0.0.0.1_007_JavaSE", javax.activation;version="0.0.0.1_007_JavaSE", javax.activity;version="0.0.0.1_007_JavaSE", javax.annotation.processing;uses:="javax.tools,javax.lang.model,javax.lang.model.element,javax.lang.model.util";version="0.0.0.1_007_JavaSE", javax.annotation;version="0.0.0.1_007_JavaSE", javax.crypto.interfaces;uses:="javax.crypto.spec,javax.crypto";version="0.0.0.1_007_JavaSE", javax.crypto.spec;uses:="javax.crypto";version="0.0.0.1_007_JavaSE", javax.crypto;uses:="javax.crypto.spec";version="0.0.0.1_007_JavaSE", javax.imageio.event;uses:="javax.imageio";version="0.0.0.1_007_JavaSE", javax.imageio.metadata;uses:="org.w3c.dom,javax.imageio";version="0.0.0.1_007_JavaSE", javax.imageio.plugins.bmp;uses:="javax.imageio";version="0.0.0.1_007_JavaSE", javax.imageio.plugins.jpeg;uses:="javax.imageio";version="0.0.0.1_007_JavaSE", javax.imageio.spi;uses:="javax.imageio.stream,javax.imageio,javax.imageio.metadata";version="0.0.0.1_007_JavaSE", javax.imageio.stream;uses:="javax.imageio";version="0.0.0.1_007_JavaSE", javax.imageio;uses:="javax.imageio.metadata,javax.imageio.stream,javax.imageio.spi,javax.imageio.event";version="0.0.0.1_007_JavaSE", javax.jws.soap;version="0.0.0.1_007_JavaSE", javax.jws;version="0.0.0.1_007_JavaSE", javax.lang.model.element;uses:="javax.lang.model.type,javax.lang.model";version="0.0.0.1_007_JavaSE", javax.lang.model.type;uses:="javax.lang.model.element,javax.lang.model";version="0.0.0.1_007_JavaSE", javax.lang.model.util;uses:="javax.lang.model,javax.lang.model.element,javax.annotation.processing,javax.lang.model.type";version="0.0.0.1_007_JavaSE", javax.lang.model;version="0.0.0.1_007_JavaSE", javax.management.loading;uses:="javax.management";version="0.0.0.1_007_JavaSE", javax.management.modelmbean;uses:="javax.management,javax.management.loading";version="0.0.0.1_007_JavaSE", javax.management.monitor;uses:="javax.management";version="0.0.0.1_007_JavaSE", javax.management.openmbean;uses:="javax.management";version="0.0.0.1_007_JavaSE", javax.management.relation;uses:="javax.management";version="0.0.0.1_007_JavaSE", javax.management.remote.rmi;uses:="javax.management.remote,javax.security.auth,javax.management,javax.management.loading,javax.naming,javax.rmi.ssl,org.omg.CORBA,org.omg.CORBA_2_3.portable,org.omg.CORBA.portable,javax.rmi.CORBA,javax.rmi";version="0.0.0.1_007_JavaSE", javax.management.remote;uses:="javax.security.auth,javax.management";version="0.0.0.1_007_JavaSE", javax.management.timer;uses:="javax.management";version="0.0.0.1_007_JavaSE", javax.management;uses:="javax.management.loading,javax.management.openmbean";version="0.0.0.1_007_JavaSE", javax.naming.directory;uses:="javax.naming";version="0.0.0.1_007_JavaSE", javax.naming.event;uses:="javax.naming,javax.naming.directory";version="0.0.0.1_007_JavaSE", javax.naming.ldap;uses:="javax.naming,javax.naming.directory,javax.net.ssl,javax.naming.event";version="0.0.0.1_007_JavaSE", javax.naming.spi;uses:="javax.naming,javax.naming.directory";version="0.0.0.1_007_JavaSE", javax.naming;uses:="javax.naming.spi";version="0.0.0.1_007_JavaSE", javax.net.ssl;uses:="javax.security.cert,javax.security.auth.x500,javax.net";version="0.0.0.1_007_JavaSE", javax.net;version="0.0.0.1_007_JavaSE", javax.print.attribute.standard;uses:="javax.print.attribute";version="0.0.0.1_007_JavaSE", javax.print.attribute;version="0.0.0.1_007_JavaSE", javax.print.event;uses:="javax.print,javax.print.attribute";version="0.0.0.1_007_JavaSE", javax.print;uses:="javax.print.attribute,javax.print.event,javax.print.attribute.standard";version="0.0.0.1_007_JavaSE", javax.rmi.CORBA;uses:="org.omg.CORBA,org.omg.CORBA_2_3.portable,org.omg.CORBA.portable,org.omg.SendingContext";version="0.0.0.1_007_JavaSE", javax.rmi.ssl;uses:="javax.net,javax.net.ssl";version="0.0.0.1_007_JavaSE", javax.rmi;uses:="org.omg.CORBA,javax.rmi.CORBA";version="0.0.0.1_007_JavaSE", javax.script;version="0.0.0.1_007_JavaSE", javax.security.auth.callback;version="0.0.0.1_007_JavaSE", javax.security.auth.kerberos;uses:="javax.security.auth,javax.crypto";version="0.0.0.1_007_JavaSE", javax.security.auth.login;uses:="javax.security.auth,javax.security.auth.callback";version="0.0.0.1_007_JavaSE", javax.security.auth.spi;uses:="javax.security.auth.callback,javax.security.auth.login,javax.security.auth";version="0.0.0.1_007_JavaSE", javax.security.auth.x500;uses:="javax.security.auth";version="0.0.0.1_007_JavaSE", javax.security.auth;version="0.0.0.1_007_JavaSE", javax.security.cert;version="0.0.0.1_007_JavaSE", javax.security.sasl;uses:="javax.security.auth.callback";version="0.0.0.1_007_JavaSE", javax.sound.midi.spi;uses:="javax.sound.midi";version="0.0.0.1_007_JavaSE", javax.sound.midi;uses:="javax.sound.midi.spi";version="0.0.0.1_007_JavaSE", javax.sound.sampled.spi;uses:="javax.sound.sampled";version="0.0.0.1_007_JavaSE", javax.sound.sampled;uses:="javax.sound.sampled.spi";version="0.0.0.1_007_JavaSE", javax.sql.rowset.serial;version="0.0.0.1_007_JavaSE", javax.sql.rowset.spi;version="0.0.0.1_007_JavaSE", javax.sql.rowset;version="0.0.0.1_007_JavaSE", javax.sql;version="0.0.0.1_007_JavaSE", javax.swing.border;uses:="javax.swing";version="0.0.0.1_007_JavaSE", javax.swing.colorchooser;uses:="javax.swing,javax.swing.border,javax.swing.event,javax.swing.text";version="0.0.0.1_007_JavaSE", javax.swing.event;uses:="javax.swing,javax.swing.text,javax.swing.table,javax.swing.tree,javax.swing.undo";version="0.0.0.1_007_JavaSE", javax.swing.filechooser;uses:="javax.swing";version="0.0.0.1_007_JavaSE", javax.swing.plaf.basic;uses:="javax.swing.border,javax.swing,javax.swing.plaf,javax.swing.text,javax.swing.event,javax.swing.colorchooser,javax.accessibility,javax.swing.filechooser,javax.swing.text.html,javax.sound.sampled,javax.swing.table,javax.swing.plaf.synth,javax.swing.tree";version="0.0.0.1_007_JavaSE", javax.swing.plaf.metal;uses:="javax.swing.plaf,javax.swing,javax.swing.border,javax.swing.text,javax.swing.plaf.basic,javax.swing.filechooser,javax.swing.event,javax.swing.tree";version="0.0.0.1_007_JavaSE", javax.swing.plaf.multi;uses:="javax.accessibility,javax.swing,javax.swing.plaf,javax.swing.filechooser,javax.swing.text,javax.swing.tree";version="0.0.0.1_007_JavaSE", javax.swing.plaf.nimbus;uses:="javax.swing,javax.swing.plaf,javax.swing.border,javax.swing.plaf.synth";version="0.0.0.1_007_JavaSE", javax.swing.plaf.synth;uses:="javax.swing,javax.swing.plaf,javax.swing.text,javax.swing.border,javax.swing.plaf.basic,javax.swing.colorchooser,javax.swing.event,javax.xml.parsers,org.xml.sax,org.xml.sax.helpers,javax.swing.table,javax.swing.tree";version="0.0.0.1_007_JavaSE", javax.swing.plaf;uses:="javax.swing,javax.swing.border,javax.accessibility,javax.swing.filechooser,javax.swing.text,javax.swing.tree";version="0.0.0.1_007_JavaSE", javax.swing.table;uses:="javax.swing.event,javax.swing.plaf,javax.swing.border,javax.swing,javax.accessibility";version="0.0.0.1_007_JavaSE", javax.swing.text.html.parser;uses:="javax.swing.text,javax.swing.text.html";version="0.0.0.1_007_JavaSE", javax.swing.text.html;uses:="javax.swing.event,javax.swing.text,javax.accessibility,javax.swing,javax.swing.plaf,javax.swing.border,javax.swing.undo";version="0.0.0.1_007_JavaSE", javax.swing.text.rtf;uses:="javax.swing.text";version="0.0.0.1_007_JavaSE", javax.swing.text;uses:="javax.swing.event,javax.swing.tree,javax.swing.undo,javax.swing,javax.swing.plaf,javax.swing.plaf.basic,javax.print,javax.print.attribute,javax.accessibility,javax.swing.text.html";version="0.0.0.1_007_JavaSE", javax.swing.tree;uses:="javax.swing.event,javax.swing,javax.swing.border,javax.swing.plaf,javax.swing.plaf.basic";version="0.0.0.1_007_JavaSE", javax.swing.undo;uses:="javax.swing,javax.swing.event";version="0.0.0.1_007_JavaSE", javax.swing;uses:="javax.swing.event,javax.accessibility,javax.swing.text,javax.swing.plaf,javax.swing.border,javax.swing.tree,javax.swing.table,javax.swing.colorchooser,javax.swing.plaf.basic,javax.swing.text.html,javax.swing.filechooser,javax.print,javax.print.attribute,javax.swing.plaf.metal";version="0.0.0.1_007_JavaSE", javax.tools;uses:="javax.lang.model.element,javax.annotation.processing,javax.lang.model";version="0.0.0.1_007_JavaSE", javax.xml.bind.annotation.adapters;uses:="javax.xml.bind";version="0.0.0.1_007_JavaSE", javax.xml.bind.annotation;uses:="javax.xml.transform,javax.xml.bind,javax.xml.parsers,javax.xml.transform.dom,org.w3c.dom";version="0.0.0.1_007_JavaSE", javax.xml.bind.attachment;uses:="javax.activation";version="0.0.0.1_007_JavaSE", javax.xml.bind.helpers;uses:="javax.xml.bind.annotation.adapters,javax.xml.transform.dom,org.w3c.dom,org.xml.sax,javax.xml.bind.attachment,javax.xml.stream,javax.xml.transform,javax.xml.transform.stream,javax.xml.validation,javax.xml.transform.sax,javax.xml.bind,javax.xml.parsers";version="0.0.0.1_007_JavaSE", javax.xml.bind.util;uses:="javax.xml.transform.sax,javax.xml.bind,org.xml.sax,org.xml.sax.ext,org.xml.sax.helpers";version="0.0.0.1_007_JavaSE", javax.xml.bind;uses:="javax.xml.validation,javax.xml.namespace,javax.xml.datatype,javax.xml.transform,javax.xml.bind.annotation,javax.xml.transform.stream,org.w3c.dom,javax.xml.bind.attachment,javax.xml.stream,javax.xml.bind.annotation.adapters,org.xml.sax";version="0.0.0.1_007_JavaSE", javax.xml.crypto.dom;uses:="javax.xml.crypto,org.w3c.dom";version="0.0.0.1_007_JavaSE", javax.xml.crypto.dsig.dom;uses:="javax.xml.crypto.dsig,javax.xml.crypto,org.w3c.dom,javax.xml.crypto.dom";version="0.0.0.1_007_JavaSE", javax.xml.crypto.dsig.keyinfo;uses:="javax.xml.crypto";version="0.0.0.1_007_JavaSE", javax.xml.crypto.dsig.spec;uses:="javax.xml.crypto";version="0.0.0.1_007_JavaSE", javax.xml.crypto.dsig;uses:="javax.xml.crypto,javax.xml.crypto.dsig.spec,javax.xml.crypto.dsig.keyinfo";version="0.0.0.1_007_JavaSE", javax.xml.crypto;uses:="javax.xml.crypto.dsig.keyinfo";version="0.0.0.1_007_JavaSE", javax.xml.datatype;uses:="javax.xml.namespace";version="0.0.0.1_007_JavaSE", javax.xml.namespace;version="0.0.0.1_007_JavaSE", javax.xml.parsers;uses:="javax.xml.validation,org.w3c.dom,org.xml.sax,org.xml.sax.helpers";version="0.0.0.1_007_JavaSE", javax.xml.soap;uses:="javax.activation,javax.xml.namespace,org.w3c.dom,javax.xml.transform.dom,javax.xml.transform";version="0.0.0.1_007_JavaSE", javax.xml.stream.events;uses:="javax.xml.namespace,javax.xml.stream";version="0.0.0.1_007_JavaSE", javax.xml.stream.util;uses:="javax.xml.stream,javax.xml.stream.events,javax.xml.namespace";version="0.0.0.1_007_JavaSE", javax.xml.stream;uses:="javax.xml.stream.events,javax.xml.namespace,javax.xml.stream.util,javax.xml.transform";version="0.0.0.1_007_JavaSE", javax.xml.transform.dom;uses:="javax.xml.transform,org.w3c.dom";version="0.0.0.1_007_JavaSE", javax.xml.transform.sax;uses:="org.xml.sax.ext,javax.xml.transform,org.xml.sax,javax.xml.transform.stream";version="0.0.0.1_007_JavaSE", javax.xml.transform.stax;uses:="javax.xml.stream,javax.xml.transform,javax.xml.stream.events";version="0.0.0.1_007_JavaSE", javax.xml.transform.stream;uses:="javax.xml.transform";version="0.0.0.1_007_JavaSE", javax.xml.transform;version="0.0.0.1_007_JavaSE", javax.xml.validation;uses:="org.w3c.dom.ls,javax.xml.transform,javax.xml.transform.stream,org.xml.sax,org.w3c.dom";version="0.0.0.1_007_JavaSE", javax.xml.ws.handler.soap;uses:="javax.xml.ws.handler,javax.xml.namespace,javax.xml.soap,javax.xml.bind";version="0.0.0.1_007_JavaSE", javax.xml.ws.handler;uses:="javax.xml.ws,javax.xml.namespace";version="0.0.0.1_007_JavaSE", javax.xml.ws.http;uses:="javax.xml.ws";version="0.0.0.1_007_JavaSE", javax.xml.ws.soap;uses:="javax.xml.ws.spi,javax.xml.ws,javax.xml.soap";version="0.0.0.1_007_JavaSE", javax.xml.ws.spi.http;version="0.0.0.1_007_JavaSE", javax.xml.ws.spi;uses:="javax.xml.ws,javax.xml.ws.wsaddressing,javax.xml.transform,org.w3c.dom,javax.xml.namespace,javax.xml.ws.handler,javax.xml.bind";version="0.0.0.1_007_JavaSE", javax.xml.ws.wsaddressing;uses:="javax.xml.bind.annotation,javax.xml.namespace,org.w3c.dom,javax.xml.transform,javax.xml.bind,javax.xml.ws,javax.xml.ws.spi";version="0.0.0.1_007_JavaSE", javax.xml.ws;uses:="javax.xml.ws.handler,javax.xml.ws.spi,javax.xml.ws.spi.http,javax.xml.transform,org.w3c.dom,javax.xml.bind.annotation,javax.xml.transform.stream,javax.xml.bind,javax.xml.namespace";version="0.0.0.1_007_JavaSE", javax.xml.xpath;uses:="org.xml.sax,javax.xml.namespace";version="0.0.0.1_007_JavaSE", javax.xml;version="0.0.0.1_007_JavaSE", org.ietf.jgss;version="0.0.0.1_007_JavaSE", org.omg.CORBA.DynAnyPackage;uses:="org.omg.CORBA";version="0.0.0.1_007_JavaSE", org.omg.CORBA.ORBPackage;uses:="org.omg.CORBA";version="0.0.0.1_007_JavaSE", org.omg.CORBA.TypeCodePackage;uses:="org.omg.CORBA";version="0.0.0.1_007_JavaSE", org.omg.CORBA.portable;uses:="org.omg.CORBA,org.omg.CORBA_2_3.portable";version="0.0.0.1_007_JavaSE", org.omg.CORBA;uses:="org.omg.CORBA.portable,org.omg.CORBA.DynAnyPackage,org.omg.CORBA.ORBPackage,org.omg.CORBA_2_3.portable,org.omg.CORBA.TypeCodePackage";version="0.0.0.1_007_JavaSE", org.omg.CORBA_2_3.portable;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.CORBA_2_3;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.CosNaming.NamingContextExtPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.CosNaming.NamingContextPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable,org.omg.CosNaming";version="0.0.0.1_007_JavaSE", org.omg.CosNaming;uses:="org.omg.CORBA.portable,org.omg.CORBA,org.omg.PortableServer,org.omg.CosNaming.NamingContextPackage,org.omg.CosNaming.NamingContextExtPackage";version="0.0.0.1_007_JavaSE", org.omg.Dynamic;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.DynamicAny.DynAnyFactoryPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.DynamicAny.DynAnyPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.DynamicAny;uses:="org.omg.CORBA,org.omg.CORBA.portable,org.omg.DynamicAny.DynAnyFactoryPackage,org.omg.DynamicAny.DynAnyPackage";version="0.0.0.1_007_JavaSE", org.omg.IOP.CodecFactoryPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.IOP.CodecPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.IOP;uses:="org.omg.CORBA,org.omg.CORBA.portable,org.omg.IOP.CodecFactoryPackage,org.omg.IOP.CodecPackage";version="0.0.0.1_007_JavaSE", org.omg.Messaging;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.PortableInterceptor.ORBInitInfoPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.PortableInterceptor;uses:="org.omg.CORBA,org.omg.CORBA.portable,org.omg.IOP,org.omg.PortableInterceptor.ORBInitInfoPackage,org.omg.CORBA_2_3.portable,org.omg.Dynamic";version="0.0.0.1_007_JavaSE", org.omg.PortableServer.CurrentPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.PortableServer.POAManagerPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.PortableServer.POAPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.PortableServer.ServantLocatorPackage;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.PortableServer.portable;uses:="org.omg.CORBA,org.omg.PortableServer";version="0.0.0.1_007_JavaSE", org.omg.PortableServer;uses:="org.omg.CORBA,org.omg.CORBA.portable,org.omg.PortableServer.CurrentPackage,org.omg.PortableServer.POAManagerPackage,org.omg.PortableServer.POAPackage,org.omg.PortableServer.portable,org.omg.CORBA_2_3,org.omg.PortableServer.ServantLocatorPackage";version="0.0.0.1_007_JavaSE", org.omg.SendingContext;uses:="org.omg.CORBA,org.omg.CORBA.portable";version="0.0.0.1_007_JavaSE", org.omg.stub.java.rmi;uses:="javax.rmi.CORBA";version="0.0.0.1_007_JavaSE", org.w3c.dom.bootstrap;uses:="org.w3c.dom";version="0.0.0.1_007_JavaSE", org.w3c.dom.events;uses:="org.w3c.dom,org.w3c.dom.views";version="0.0.0.1_007_JavaSE", org.w3c.dom.ls;uses:="org.w3c.dom,org.w3c.dom.events,org.w3c.dom.traversal";version="0.0.0.1_007_JavaSE", org.w3c.dom;version="0.0.0.1_007_JavaSE", org.xml.sax.ext;uses:="org.xml.sax,org.xml.sax.helpers";version="0.0.0.1_007_JavaSE", org.xml.sax.helpers;uses:="org.xml.sax";version="0.0.0.1_007_JavaSE", org.xml.sax;version="0.0.0.1_007_JavaSE"</code></pre><p>现在，您应该能够启动Felix，并部署此页面上列出的所有jar。您应该在控制台上看到类似于此的输出<code class="literal">felix:lb</code>命令：</p><pre class="literallayout">    ID|State      |Level|Name
    0|Active     |    0|System Bundle (4.4.1)
    1|Active     |    1|ASM (7.0)
    2|Active     |    1|ASM commons classes (7.0)
    3|Active     |    1|ASM Tree class visitor (7.0)
    4|Active     |    1|geronimo-jta_1.1_spec (1.1.1)
    5|Active     |    1|javax.annotation API (1.2.0)
    6|Active     |    1|javax.mail bundle from Glassfish (1.4.1.v201005082020)
    7|Active     |    1|Java Server Pages Standard Tag Library API Bundle (1.2.0.v201105211821)
    8|Active     |    1|JavaServer Pages (TM) TagLib Implementation (1.2.2)
    9|Active     |    1|Jetty :: Servlet Annotations (9.4.14)
   10|Active     |    1|Jetty :: Deployers (9.4.14)
   11|Active     |    1|Jetty :: Http Utility (9.4.14)
   12|Active     |    1|Jetty :: IO Utility (9.4.14)
   13|Active     |    1|Jetty :: JNDI Naming (9.4.14)
   14|Active     |    1|Jetty :: OSGi :: Boot (9.4.14)
   15|Resolved   |    1|Jetty-OSGi-Jasper Integration (9.4.14)
   16|Active     |    1|Jetty Servlet API and Schemas for OSGi (3.1.0)
   17|Active     |    1|Jetty :: Plus (9.4.14)
   18|Active     |    1|Jetty :: Security (9.4.14)
   19|Active     |    1|Jetty :: Server Core (9.4.14)
   20|Active     |    1|Jetty :: Servlet Handling (9.4.14)
   21|Active     |    1|Jetty :: Utility Servlets and Filters (9.4.14)
   22|Active     |    1|Jetty :: Utilities (9.4.14)
   23|Active     |    1|Jetty :: Webapp Application Support (9.4.14)
   24|Active     |    1|Jetty :: XML utilities (9.4.14)
   25|Active     |    1|Apache Aries SPI Fly Dynamic Weaving Bundle (1.2)
   27|Active     |    1|Apache Felix Bundle Repository (2.0.2)
   28|Active     |    1|Apache Felix Configuration Admin Service (1.8.0)
   29|Active     |    1|Apache Felix EventAdmin (1.3.2)
   30|Active     |    1|Apache Felix Gogo Command (0.14.0)
   31|Active     |    1|Apache Felix Gogo Runtime (0.12.1)
   32|Active     |    1|Apache Felix Gogo Shell (0.10.0)
   33|Active     |    1|Apache Felix Log Service (1.0.1)
   34|Active     |    1|Jetty :: Apache JSP (9.4.14)
   35|Active     |    1|Eclipse Compiler for Java(TM) (3.8.2.v20130121-145325)
   36|Active     |    1|Mortbay EL API and Implementation (8.5.33.1)
   37|Active     |    1|Mortbay Jasper (8.5.33.1)</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_eclipse"></a>日食</h4></div></div></div><p>Jetty OSGi集成已通过<a class="link" href="https://www.eclipse.org/equinox/" target="_top">Equinox</a> Mars RC1成功测试。</p><p>确保存在以下服务：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem"><a class="link" href="https://www.eclipse.org/equinox/bundles/" target="_top">配置管理员</a></li><li class="listitem"><a class="link" href="https://www.eclipse.org/equinox/bundles/" target="_top">活动管理员</a></li></ul></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="_eclipse_update_site"></a> Eclipse更新站点</h5></div></div></div><p>在<a class="link" href="http://download.eclipse.org/jetty/updates/jetty-bundles-9.x/" target="_top">http://download.eclipse.org/jetty/updates/jetty-bundles-9.x/上</a>维护了关于码头发行版的Eclipse P2网站列表。</p><p>每个P2存储库都有一个大功能组，该功能组定义了大多数Jetty jars。
<span class="strong"><strong>当心：不包括第三方依赖罐，因此您将需要安装本文档前面列出的依赖。</strong></span></p><p>此外，由于功能组包括websocket，因此您需要下载并安装<code class="literal">javax.websocket-api</code>罐：</p><div class="table"><a name="d0e28629"></a><p class="title"><b>表29.7。Websocket所需的额外罐子</b></p><div class="table-contents"><table class="table" border="1" summary="Extra Jars Required for Websocket"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th align="left" valign="top">罐</th><th align="left" valign="top">捆绑符号名称</th><th align="left" valign="top">地点</th></tr></thead><tbody><tr><td align="left" valign="top"><p>javax.websocket-api</p></td><td align="left" valign="top"><p>javax.websocket-api</p></td><td align="left" valign="top"><p><a class="link" href="https://repo1.maven.org/maven2/javax/websocket/websocket-api" target="_top">Maven中央</a></p></td></tr></tbody></table></div></div><br class="table-break"></div></div></div></div><script type="text/javascript">
      SyntaxHighlighter.all()
    </script><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tbody><tr><td width="40%" align="left"><a href="frameworks.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><td width="20%" align="center"><a href="frameworks.html" accesskey="u"><i class="fa fa-chevron-up" aria-hidden="true"></i>最佳</a></td><td width="40%" align="right"> <a href="framework-weld.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr><tr><td width="40%" align="left" valign="top">章29。构架</td><td width="20%" align="center"><a href="index.html" accesskey="h"><i class="fa fa-home" aria-hidden="true"></i>家</a></td><td width="40%" align="right" valign="top">焊接</td></tr></tbody></table></div><p xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"></p><div class="jetty-callout">看到错误或缺少的东西？
            <span class="callout"><a href="http://github.com/eclipse/jetty.project">在以下位置对此文档做出贡献<span class="website"><i class="fa fa-github" aria-hidden="true"></i> Github！</span></a></span> <span style="float:right"><i>（产生：2019-11-20）</i></span></div><p></p></body></html>