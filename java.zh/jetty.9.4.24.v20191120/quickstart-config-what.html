<html ><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>在Jetty中配置什么</title><link rel="stylesheet" type="text/css" href="css/docbook.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="jetty, servlet, servlet-api, cometd, http, websocket, eclipse, maven, java, server, software"><link rel="home" href="index.html" title="Jetty"><link rel="up" href="quick-start-configure.html" title="Chapter 3. An Introduction to Jetty Configuration"><link rel="prev" href="quick-start-configure.html" title="Chapter 3. An Introduction to Jetty Configuration"><link rel="next" href="jetty-config-guide.html" title="Part II. Jetty Configuration Guide"><link rel="shortcut icon" href="images/favicon.ico" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><link rel="stylesheet" href="css/highlighter/foundation.css"><script src="js/highlight.pack.js"></script><script>
      hljs.initHighlightingOnLoad();
    </script><link type="text/css" rel="stylesheet" href="css/font-awesome/font-awesome.min.css"></head><body bgcolor="white"  text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><tbody><tr><td style="width:25%"><a href="http://www.eclipse.org/jetty"><img src="images/jetty-header-logo.png" alt="Jetty标志"></a><br><span style="font-size:small">版本：9.4.24.v20191120</span></td><td style="width:50%"></td></tr></tbody></table><div class="navheader" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><table width="100%" summary="Navigation header"><tbody><tr><th colspan="3" align="center">在Jetty中配置什么</th></tr><tr><td width="20%" align="left"><a href="quick-start-configure.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><th width="60%" align="center">第3章。Jetty配置简介<br><a href="index.html" accesskey="p"><i class="fa fa-home" aria-hidden="true"></i>家</a></th><td width="20%" align="right"> <a href="jetty-config-guide.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr></tbody></table><hr></div><div class="jetty-callout" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><h5 class="callout"><a href="http://www.webtide.com/">通过<span class="website">www.webtide.com</span>与Jetty核心开发人员联系。</a></h5><p>内部/客户项目的私人支持...自定义扩展和发行版...无限期支持的版本快照...您的应用程序和Ajax / Comet项目的可伸缩性指南...赞助功能开发的开发服务</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear:both"><a name="quickstart-config-what"></a>在Jetty中配置什么</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="quickstart-config-what.html#intro-jetty-configuration-server">配置服务器</a></span></dt><dt><span class="section"><a href="quickstart-config-what.html#intro-jetty-configuration-connectors">配置连接器</a></span></dt><dt><span class="section"><a href="quickstart-config-what.html#intro-jetty-configuration-contexts">配置上下文</a></span></dt></dl></div><p>本节概述了通常使用上一节概述的机制配置的Jetty组件。
<a class="xref" href="architecture.html#basic-architecture" title="Jetty建筑">Jetty体系结构</a>描述了Jetty服务器的结构，这是阅读背景知识以了解配置的基础，对于您要更改Jetty发行版中默认配置所设置的服务器结构至关重要。但是，对于大多数目的而言，配置是确定正确的配置文件并修改现有配置值的问题。</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="intro-jetty-configuration-server"></a>配置服务器</h3></div></div></div><p>Server实例是Jetty服务器的中央协调对象。它为所有其他Jetty服务器组件提供服务和生命周期管理。在标准Jetty发行版中，核心服务器配置位于<code class="literal">etc/jetty.xml</code>文件，但您可以混入其他服务器配置，包括：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">线程池</span></dt><dd>Server实例提供了一个ThreadPool实例，该实例是其他Jetty服务器组件使用的默认执行器服务。线程池的主要配置是最大和最小大小，并且在<code class="literal">start.ini</code>要么<code class="literal">start.d/server.ini</code> 。</dd><dt><span class="term">处理程序</span></dt><dd>Jetty服务器只能有一个Handler实例来处理传入的HTTP请求。但是，处理程序可能是其他处理程序的容器或包装，形成了处理程序树，这些处理程序树通常将请求作为处理程序之间的协作（从树的根到叶的分支）进行处理。设置中的默认处理程序树<code class="literal">etc/jetty.xml</code>文件是一个处理程序集合，其中包含上下文处理程序集合和默认处理程序。上下文处理程序集合通过上下文路径选择下一个处理程序，并在其中将部署的上下文处理程序和Web应用程序上下文添加到处理程序树中。默认处理程序将处理所有尚未处理的请求，并生成标准404页面。其他配置文件可能会将处理程序添加到此树中（例如， <code class="literal">jetty-rewrite.xml</code> ， <code class="literal">jetty-requestlog.xml</code> ）或将组件配置为热部署处理程序（例如， <code class="literal">jetty-deploy.xml</code> ）。</dd><dt><span class="term">服务器属性</span></dt><dd>服务器拥有字符串到对象的通用属性映射，以便其他Jetty组件可以将命名对象与服务器关联，并且如果值对象实现LifeCycle接口，则它们将随服务器启动和停止。通常，服务器属性保存服务器范围的默认值。</dd><dt><span class="term">服务器字段</span></dt><dd>服务器还具有您在其中设置的一些特定配置字段<code class="literal">start.ini</code>要么<code class="literal">start.d/server.ini</code>用于控制HTTP响应中日期和版本的发送等。</dd><dt><span class="term">连接器</span></dt><dd>服务器包含一组连接器，这些连接器接收HTTP和Jetty支持的其他协议的连接。下一节“ <a class="xref" href="quickstart-config-what.html#intro-jetty-configuration-connectors" title="配置连接器">配置连接器”</a>描述了连接器本身的配置。对于服务器，您可以设置所有连接器的集合，也可以添加/删除单个连接器。</dd><dt><span class="term">服务</span></dt><dd>服务器可以容纳其他服务对象，有时作为属性，但通常作为聚合的LifeCycle bean。服务示例包括“登录服务”和“数据源”，您可以在服务器级别对其进行配置，然后将其注入使用它们的Web应用程序中。</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="intro-jetty-configuration-connectors"></a>配置连接器</h3></div></div></div><p>Jetty服务器连接器是一个网络端点，它接受一个或多个协议的连接，这些协议会为Jetty服务器生成请求和/或消息。在标准Jetty服务器分发中，几个提供的配置文件为各种协议和协议组合添加了到服务器的连接器： <code class="literal">http.ini</code> ， <code class="literal">https.ini</code>和<code class="literal">jetty-http2.xml</code> 。连接器所需的配置通常为：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">港口</span></dt><dd>连接器在其上侦听连接的TCP / IP端口是使用XML属性元素设置的，该元素查找<code class="literal">jetty.http.port</code> （要么<code class="literal">jetty.ssl.port</code> ）属性，如果找不到，则默认为8080（对于TLS，则默认为8443）。</dd><dt><span class="term">主办</span></dt><dd>您可以将主机配置为主机名或IP地址，以标识要侦听的特定网络接口。如果未设置或设置为0.0.0.0，则连接器在所有本地接口上侦听。XML属性元素用于从<code class="literal">jetty.host</code>属性。</dd><dt><span class="term">空闲超时</span></dt><dd>连接器在采取操作以关闭连接之前可以空闲的连接时间（以毫秒为单位）。</dd><dt><span class="term">HTTP配置</span></dt><dd>接受HTTP语义的连接器类型（包括HTTP，HTTPS和HTTP2）配置有一个<code class="literal">HttpConfiguration</code>实例，该实例包含独立于所使用的特定有线协议的通用HTTP配置。由于这些值通常是多种连接器类型所共有的，因此标准的Jetty服务器发行版会创建一个<code class="literal">HttpConfiguration</code>在里面<code class="literal">jetty.xml</code>通过特定连接器文件中的XML Ref元素使用的文件。</dd><dt><span class="term">SSL上下文工厂</span></dt><dd>TLS连接器类型（HTTPS和HTTP2）使用服务器密钥库和信任库的位置配置SSL上下文工厂，以获取服务器证书。</dd></dl></div><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>未在连接器上配置虚拟主机。您必须使用它们响应的虚拟主机配置各个上下文。</p></div></blockquote></div><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>在Jetty 9之前，连接器的类型既反映所支持的协议（HTTP，HTTPS，AJP，SPDY），又反映实现的性质（NIO或BIO）。从Jetty 9开始，只有一种主要连接器类型（ <code class="literal">ServerConnector</code> ），它是基于NIO的，并使用连接工厂来处理一个或多个协议。</p></div></blockquote></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="intro-jetty-configuration-contexts"></a>配置上下文</h3></div></div></div><p>Jetty上下文是将上下文路径下的其他处理程序与关联资源组合在一起的处理程序，大致等同于标准ServletContext API。上下文可以包含标准Jetty处理程序或自定义应用程序处理程序。</p><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>Servlet规范定义了一个Web应用程序。在Jetty中，标准的Web应用程序是使用标准布局的专用上下文，并且<code class="literal">WEB-INF/web.xml</code>实例化和配置用于会话，安全性和Servlet的类路径，资源库和处理程序，以及用于JSP和静态内容的Servlet。标准Web应用程序通常不需要或不需要其他配置，但是您也可以将这些技术用于任意上下文，以完善或修改标准Web应用程序的配置。</p></div></blockquote></div><p>所有上下文共有的配置值是：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">contextPath</span></dt><dd><p class="simpara">contextPath是一个URL前缀，用于标识HTTP请求所针对的上下文。例如，如果上下文具有上下文路径<code class="literal">/foo</code> ，它处理对<code class="literal">/foo</code> ， <code class="literal">/foo/index.html</code> ， <code class="literal">/foo/bar/</code>和<code class="literal">/foo/bar/image.png</code>但它无法处理类似<code class="literal">/</code> ， <code class="literal">/other/</code> ， 要么<code class="literal">/favicon.ico</code> 。上下文路径为/的上下文称为根上下文。</p><p class="simpara">默认情况下，可以从部署程序设置上下文路径（部署程序使用文件名作为上下文路径的基础）；或用代码；或者可以由部署者应用的Jetty IoC XML来设置，也可以在<code class="literal">WEB-INF/jetty-web.xml</code>标准Web应用程序上下文的文件。</p></dd><dt><span class="term">虚拟主机</span></dt><dd>上下文可以选择设置一个或多个虚拟主机。与在连接器上设置的主机（用于选择要侦听的网络接口）不同，虚拟主机不会设置任何网络参数。相反，虚拟主机代表由名称服务分配给IP地址的别名，该别名可能具有许多别名。为了确定请求的目标虚拟主机，HTTP客户端（浏览器）在请求中包括用于查找网络地址的名称。设置了虚拟主机的上下文仅处理其请求标头中具有匹配虚拟主机的请求。</dd><dt><span class="term">classPath</span></dt><dd>上下文可以选择具有类路径，以便在上下文中执行处理程序的任何线程都具有设置了类路径的线程上下文类加载器。标准的Web应用程序具有由<code class="literal">WEB-INF/lib</code>和<code class="literal">WEB-INF/classes</code>目录，并具有有关将类加载委托给父类加载器的其他规则。所有上下文都可以添加其他类路径条目。</dd><dt><span class="term">属性</span></dt><dd>属性是与上下文关联的任意命名对象，通常用于在Web应用程序及其容器之间传递实体。例如属性<code class="literal">javax.servlet.context.tempdir</code>用于传递File实例，该实例代表为Web应用程序分配的临时目录。</dd><dt><span class="term">resourceBase</span></dt><dd>资源库是一个目录（或目录或URL的集合），其中包含上下文的静态资源。这些可以是准备提供的图像和HTML文件，也可以是准备编译的JSP源文件。在传统的Web服务器中，此值通常称为docroot。</dd></dl></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_context_configuration_by_api"></a>通过API进行上下文配置</h4></div></div></div><p>在嵌入式服务器中，可以通过直接调用<a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/server/handler/ContextHandler.html" target="_top">ContextHandler</a> API来配置上下文，如以下示例所示：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>//
//  ========================================================================
//  Copyright (c) 1995-2019 Mort Bay Consulting Pty. Ltd.
//  ------------------------------------------------------------------------
//  All rights reserved. This program and the accompanying materials
//  are made available under the terms of the Eclipse Public License v1.0
//  and Apache License v2.0 which accompanies this distribution.
//
//      The Eclipse Public License is available at
//      http://www.eclipse.org/legal/epl-v10.html
//
//      The Apache License v2.0 is available at
//      http://www.opensource.org/licenses/apache2.0.php
//
//  You may elect to redistribute this code under either of these licenses.
//  ========================================================================
//

package org.eclipse.jetty.embedded;

import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.server.handler.ContextHandler;

public class OneContext
{
    public static Server createServer(int port)
    {
        Server server = new Server(port);

        // Add a single handler on context "/hello"
        ContextHandler context = new ContextHandler();
        context.setContextPath("/hello");
        context.setHandler(new HelloHandler());

        // Can be accessed using http://localhost:8080/hello

        server.setHandler(context);
        return server;
    }

    public static void main(String[] args) throws Exception
    {
        int port = ExampleUtil.getPort(args, "jetty.http.port", 8080);
        Server server = createServer(port);

        // Start the server
        server.start();
        server.join();
    }
}</code></pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_context_configuration_by_ioc_xml"></a>通过IoC XML进行上下文配置</h4></div></div></div><p>您可以完全通过IoC XML（Jetty或Spring）创建和配置上下文。部署者发现并热部署上下文IoC描述符，如下所示，该描述符创建了一个上下文来服务Jetty发行版中的Javadoc：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;?xml version="1.0"  encoding="UTF-8"?&gt;
&lt;!DOCTYPE Configure PUBLIC
    "-//Mort Bay Consulting//DTD Configure//EN"
    "http://www.eclipse.org/jetty/configure_9_3.dtd"&gt;

&lt;!--
  Configure a custom context for serving javadoc as static resources
--&gt;

&lt;Configure class="org.eclipse.jetty.server.handler.ContextHandler"&gt;
  &lt;Set name="contextPath"&gt;/javadoc&lt;/Set&gt;
  &lt;Set name="resourceBase"&gt;&lt;SystemProperty name="jetty.home" default="."/&gt;/javadoc/&lt;/Set&gt;
  &lt;Set name="handler"&gt;
    &lt;New class="org.eclipse.jetty.server.handler.ResourceHandler"&gt;
      &lt;Set name="welcomeFiles"&gt;
        &lt;Array type="String"&gt;
          &lt;Item&gt;index.html&lt;/Item&gt;
        &lt;/Array&gt;
      &lt;/Set&gt;
      &lt;Set name="cacheControl"&gt;max-age=3600,public&lt;/Set&gt;
    &lt;/New&gt;
  &lt;/Set&gt;
&lt;/Configure&gt;</code></pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="intro-jetty-configuration-webapps"></a>配置Web应用程序</h4></div></div></div><p>Servlet规范定义了一个Web应用程序，将其打包为zip时称为WAR文件（Web应用程序ARchive）。Jetty将WAR文件和解包的Web应用程序都实现为通过以下方式配置的专用上下文：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem">一种标准布局，用于设置resourceBase的位置（WAR的根）并从在以下位置找到的jar初始化类路径<code class="literal">WEB-INF/lib</code>和在中找到的类<code class="literal">WEB-INF/classes</code> 。</li><li class="listitem">标准<code class="literal">WEB-INF/web.xml</code>部署描述符，用于定义和配置初始化参数，过滤器，Servlet，侦听器，安全性约束，欢迎文件和要注入的资源。</li><li class="listitem">默认值<code class="literal">web.xml</code>由Jetty或在配置中提供的格式部署描述符配置JSP Servlet和用于处理静态内容的默认Servlet。标准<code class="literal">web.xml</code>可能会覆盖默认值<code class="literal">web.xml</code> 。</li><li class="listitem">在包含在Jars中的类上发现的注释<code class="literal">WEB-INF/lib</code>可以声明其他过滤器，Servlet和侦听器。</li><li class="listitem">在包含在Jars中的标准部署描述符片段<code class="literal">WEB-INF/lib</code>可以声明其他初始化参数，过滤器，Servlet，侦听器，安全性约束，欢迎文件和要注入的资源。</li><li class="listitem">可选的<code class="literal">WEB-INF/jetty-web.xml</code>该文件可能包含Jetty IoC配置，以配置上下文和处理程序的Jetty特定API。</li></ul></div><p>由于这些配置机制包含在WAR文件（或解包的Web应用程序）中，因此通常Web应用程序包含其自己的许多配置，并且部署WAR通常仅是将WAR文件放入由以下程序扫描的webapps目录中的问题： <a class="link" href="quickstart-config-what.html#quickstart-config-deployer" title="Web应用程序部署">Jetty部署员</a> 。</p><p>如果您需要在Web应用程序中进行配置，通常可以通过解压缩WAR文件并编辑<code class="literal">web.xml</code>和其他配置文件。但是，servlet标准和一些Jetty功能都允许将其他配置从WAR外部应用于Web应用程序：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem">可以显式地或通过名称匹配将服务器中已配置的数据源和安全领域注入到Web应用程序中。</li><li class="listitem">Jetty允许一个或多个覆盖部署描述符， <code class="literal">web.xml</code>格式，可以在上下文中设置（通过代码或IoC XML）以修改默认和标准设置<code class="literal">web.xml</code> 。</li><li class="listitem">可以通过代码或IoC XML调用普通的Jetty Java API，以修改Web应用程序的配置。</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_setting_the_context_path"></a>设置上下文路径</h4></div></div></div><p>Web应用程序标准不提供用于Web应用程序或WAR文件设置自己的配置机制<code class="literal">contextPath</code> 。默认情况下，部署者使用约定来设置上下文路径：如果部署的WAR文件名为<code class="literal">foobar.WAR</code> ，上下文路径为<code class="literal">/foobar</code> ;如果您部署了一个名为<code class="literal">ROOT.WAR</code>上下文路径是<code class="literal">/</code> 。</p><p>但是，通常希望显式设置上下文路径，以便可以将信息（例如，版本号）包含在WAR的文件名中。 Jetty允许在内部（由WAR本身）或在外部（由WAR的部署者）设置WAR文件的上下文路径。</p><p>要从WAR文件中设置contextPath，可以添加一个<code class="literal">WEB-INF/jetty-web.xml</code>包含用于设置上下文路径的IoC XML的文件：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;?xml version="1.0"  encoding="UTF-8"?&gt;
&lt;!DOCTYPE Configure PUBLIC
    "-//Mort Bay Consulting//DTD Configure//EN"
    "http://www.eclipse.org/jetty/configure_9_3.dtd"&gt;

&lt;Configure class="org.eclipse.jetty.webapp.WebAppContext"&gt;
    &lt;Set name="contextPath"&gt;/contextpath&lt;/Set&gt;
&lt;/Configure&gt;</code></pre><p>或者，您可以在外部配置类路径，而无需修改WAR文件本身。代替部署者发现WAR文件，可以部署IoC XML文件，该文件既可以设置上下文路径，又可以声明适用于以下对象的WAR文件：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;?xml version="1.0"  encoding="UTF-8"?&gt;
&lt;!DOCTYPE Configure PUBLIC
    "-//Mort Bay Consulting//DTD Configure//EN"
    "http://www.eclipse.org/jetty/configure_9_3.dtd"&gt;

&lt;Configure class="org.eclipse.jetty.webapp.WebAppContext"&gt;
  &lt;Set name="war"&gt;&lt;SystemProperty name="jetty.home" default="."/&gt;/webapps/test.war&lt;/Set&gt;
  &lt;Set name="contextPath"&gt;/test&lt;/Set&gt;
&lt;/Configure&gt;</code></pre><p>Jetty发行版中包含设置上下文路径的示例。 <code class="literal">$JETTY_HOME/webapps/test.xml</code> 。</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="quickstart-config-deployer"></a> Web应用程序部署</h4></div></div></div><p>Jetty能够部署各种Web应用程序格式。这是通过扫描<code class="literal">${jetty.base}/webapps</code>用于部署上下文的目录。</p><p>上下文可以是以下任意一种：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem">标准的WAR文件。 （必须在“ <code class="literal">.war</code> ”）。</li><li class="listitem">包含扩展的WAR文件的目录。 （必须包含<code class="literal">{dir}/WEB-INF/web.xml</code>文件）。</li><li class="listitem">包含静态内容的目录。</li><li class="listitem"><a class="xref" href="reference-section.html#jetty-xml-syntax" title="Jetty XML语法">Jetty XML语法</a>中的XML描述符，用于配置<a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/server/handler/ContextHandler.html" target="_top">ContextHandler</a>实例（例如<a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/webapp/WebAppContext.html" target="_top">WebAppContext</a> ）。</li></ul></div><p>新的WebAppProvider将尝试使用以下试探法在目录扫描期间避免重复部署：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem">隐藏文件（以<code class="literal">"."</code> ）被忽略</li><li class="listitem">名称以结尾的目录<code class="literal">".d"</code>被忽略</li><li class="listitem">如果目录和匹配的WAR文件存在相同的基本名称（例如： <code class="literal">foo/</code>和<code class="literal">foo.war</code> ），则假定该目录为解压缩的WAR，并且仅部署了WAR（可能会重复使用解压缩的目录）</li><li class="listitem">如果目录和匹配的XML文件存在（例如： <code class="literal">foo/</code>和<code class="literal">foo.xml</code> ），则假定该目录为解压缩的WAR，并且仅部署XML（可以在其自己的配置中使用该目录）</li><li class="listitem">如果存在WAR文件和匹配的XML文件（例如： <code class="literal">foo.war</code>和<code class="literal">foo.xml</code> ），则假定WAR由XML配置，并且仅部署XML。</li></ul></div><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>在早期版本的Jetty中，有一个单独的ContextDeployer提供基于XML的部署。从Jetty 9开始，ContextDeployer不再存在，其功能已与新的<a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/deploy/providers/WebAppProvider.html" target="_top">WebAppProvider</a>合并以避免双重部署方案。</p></div></blockquote></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_setting_an_authentication_realm"></a>设置身份验证领域</h4></div></div></div><p>标准Web应用程序的身份验证方法和领域名称可以在<code class="literal">web.xml</code>具有以下元素的部署描述符：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>...
&lt;login-config&gt;
  &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
  &lt;realm-name&gt;Test Realm&lt;/realm-name&gt;
&lt;/login-config&gt;
...</code></pre><p>此示例声明将使用BASIC身份验证机制和针对称为“测试领域”的领域进行验证的凭据。但是，该标准未描述领域本身是如何实现或配置的。在Jetty中，有几个领域实现（称为LoginServices），其中最简单的是HashLoginService，它可以从Java属性文件中读取用户名和凭据。</p><p>要配置与上面配置的“测试领域”匹配的HashLoginService实例，请执行以下操作<code class="literal">$JETTY_BASE/etc/test-realm.xml</code> IoC XML文件应在命令行中传递或设置为<code class="literal">start.ini</code>要么<code class="literal">start.d/server.ini</code> 。</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;?xml version="1.0"?&gt;&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "http://www.eclipse.org/jetty/configure_9_3.dtd"&gt;
&lt;Configure id="Server" class="org.eclipse.jetty.server.Server"&gt;
    &lt;!-- =========================================================== --&gt;
    &lt;!-- Configure Authentication Login Service                      --&gt;
    &lt;!-- Realms may be configured for the entire server here, or     --&gt;
    &lt;!-- they can be configured for a specific web app in a context  --&gt;
    &lt;!-- configuration (see $(jetty.home)/webapps/test.xml for an    --&gt;
    &lt;!-- example).                                                   --&gt;
    &lt;!-- =========================================================== --&gt;
    &lt;Call name="addBean"&gt;
      &lt;Arg&gt;
        &lt;New class="org.eclipse.jetty.security.HashLoginService"&gt;
          &lt;Set name="name"&gt;Test Realm&lt;/Set&gt;
          &lt;Set name="config"&gt;&lt;Property name="jetty.demo.realm" default="etc/realm.properties"/&gt;&lt;/Set&gt;
          &lt;Set name="hotReload"&gt;false&lt;/Set&gt;
        &lt;/New&gt;
      &lt;/Arg&gt;
    &lt;/Call&gt;

    &lt;Get class="org.eclipse.jetty.util.log.Log" name="rootLogger"&gt;
      &lt;Call name="warn"&gt;&lt;Arg&gt;demo test-realm is deployed. DO NOT USE IN PRODUCTION!&lt;/Arg&gt;&lt;/Call&gt;
    &lt;/Get&gt;
&lt;/Configure&gt;</code></pre><p>这将在服务器上将LoginService创建和配置为聚合Bean。部署声明一个称为“测试领域”的领域的Web应用程序时，将在服务器bean中搜索匹配的Login Service。</p></div></div></div><script type="text/javascript">
      SyntaxHighlighter.all()
    </script><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tbody><tr><td width="40%" align="left"><a href="quick-start-configure.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><td width="20%" align="center"><a href="quick-start-configure.html" accesskey="u"><i class="fa fa-chevron-up" aria-hidden="true"></i>最佳</a></td><td width="40%" align="right"> <a href="jetty-config-guide.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr><tr><td width="40%" align="left" valign="top">第3章。Jetty配置简介</td><td width="20%" align="center"><a href="index.html" accesskey="h"><i class="fa fa-home" aria-hidden="true"></i>家</a></td><td width="40%" align="right" valign="top">第二部分Jetty配置指南</td></tr></tbody></table></div><p xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"></p><div class="jetty-callout">看到错误或缺少的东西？
            <span class="callout"><a href="http://github.com/eclipse/jetty.project">在以下位置对此文档做出贡献<span class="website"><i class="fa fa-github" aria-hidden="true"></i> Github！</span></a></span> <span style="float:right"><i>（产生：2019-11-20）</i></span></div><p></p></body></html>