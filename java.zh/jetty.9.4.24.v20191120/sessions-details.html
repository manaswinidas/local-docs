<html ><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>会话组件</title><link rel="stylesheet" type="text/css" href="css/docbook.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="jetty, servlet, servlet-api, cometd, http, websocket, eclipse, maven, java, server, software"><link rel="home" href="index.html" title="Jetty"><link rel="up" href="session-management.html" title="Chapter 10. Session Management"><link rel="prev" href="session-management.html" title="Chapter 10. Session Management"><link rel="next" href="session-configuration-housekeeper.html" title="The SessionIdManager and the Housekeeper"><link rel="shortcut icon" href="images/favicon.ico" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><link rel="stylesheet" href="css/highlighter/foundation.css"><script src="js/highlight.pack.js"></script><script>
      hljs.initHighlightingOnLoad();
    </script><link type="text/css" rel="stylesheet" href="css/font-awesome/font-awesome.min.css"></head><body bgcolor="white"  text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><tbody><tr><td style="width:25%"><a href="http://www.eclipse.org/jetty"><img src="images/jetty-header-logo.png" alt="码头标志"></a><br><span style="font-size:small">版本：9.4.24.v20191120</span></td><td style="width:50%"></td></tr></tbody></table><div class="navheader" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><table width="100%" summary="Navigation header"><tbody><tr><th colspan="3" align="center">会话组件</th></tr><tr><td width="20%" align="left"><a href="session-management.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><th width="60%" align="center">第十章会话管理<br><a href="index.html" accesskey="p"><i class="fa fa-home" aria-hidden="true"></i>家</a></th><td width="20%" align="right"> <a href="session-configuration-housekeeper.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr></tbody></table><hr></div><div class="jetty-callout" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><h5 class="callout"><a href="http://www.webtide.com/">通过<span class="website">www.webtide.com</span>与Jetty核心开发人员联系。</a></h5><p>内部/客户项目的私人支持...自定义扩展和发行版...无限期支持的版本快照...您的应用程序和Ajax / Comet项目的可伸缩性指南...赞助功能开发的开发服务</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear:both"><a name="sessions-details"></a>会话组件</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="sessions-details.html#_sessionidmanager">SessionIdManager</a></span></dt><dt><span class="section"><a href="sessions-details.html#_housekeeper">管家</a></span></dt><dt><span class="section"><a href="sessions-details.html#_sessioncache">会话缓存</a></span></dt><dt><span class="section"><a href="sessions-details.html#_sessiondatastore">SessionDataStore</a></span></dt><dt><span class="section"><a href="sessions-details.html#_cachingsessiondatastore">CachingSessionDataStore</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_sessionidmanager"></a> SessionIdManager</h3></div></div></div><p>最多一（1） <code class="literal">SessionIdManager</code>每个Jetty服务器实例。其目的是生成新的唯一会话ID，并在合作环境之间协调会话ID的重用。</p><p>与之前的Jetty版本不同， <code class="literal">SessionIdManager</code>对于选择的群集技术的类型是不可知的。</p><p>Jetty提供了一个默认实现- <code class="literal">DefaultSessionIdManager</code> -应该可以满足大多数用户的需求。如果您未明确启用会话模块之一，或以其他方式配置<code class="literal">SessionIdManager</code> ， <code class="literal">DefaultSessionIdManager</code>将会被使用。</p><p>如果<code class="literal">DefaultSessionIdManager</code>不符合您的需求，您可以延长<code class="literal">org.eclipse.jetty.server.session.AbstractSessionIdManager</code>或重新执行<code class="literal">org.eclipse.jetty.server.session.SessionIdManager</code>接口。</p><p>有关<a class="link" href="session-configuration-housekeeper.html" title="The SessionIdManager and the Housekeeper">配置的</a>详细信息，请参阅<a class="link" href="session-configuration-housekeeper.html" title="SessionIdManager和管家">配置SessionIdManager和HouseKeeper</a> 。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_housekeeper"></a>管家</h3></div></div></div><p>最多一（1） <code class="literal">HouseKeeper</code>每<code class="literal">SessionIdManager</code> 。其目的是定期轮询<code class="literal">SessionHandlers</code>清理过期的会话。</p><p>默认情况下<code class="literal">HouseKeeper</code>将轮询<code class="literal">SessionHandlers</code>每隔10分钟查找和删除过期的会话，尽管该时间间隔是可配置的。</p><p>有关<a class="link" href="session-configuration-housekeeper.html" title="The SessionIdManager and the Housekeeper">配置的</a>详细信息，请参阅<a class="link" href="session-configuration-housekeeper.html" title="SessionIdManager和管家">配置SessionIdManager和HouseKeeper</a> 。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_sessioncache"></a>会话缓存</h3></div></div></div><p>一（1） <code class="literal">SessionCache</code> <span class="strong"><strong>每个上下文。</strong></span>其目的是提供会话对象的L1缓存。在内存中具有一组工作的Session对象可以使对同一会话的多个同时请求共享同一Session对象。</p><p>码头提供两（2） <code class="literal">SessionCache</code>实现： <code class="literal">DefaultSessionCache</code>和<code class="literal">NullSessionCache</code> 。的<code class="literal">DefaultSessionCache</code>在缓存中将会话对象保留在内存中，并具有许多<a class="link" href="session-configuration-sessioncache.html" title="L1会话缓存">配置选项</a>来控制缓存行为。如果没有其他选项，则使用默认值<code class="literal">SessionCache</code>已配置。它适用于具有粘性负载平衡器的非群集和群集部署，以及具有非粘性负载平衡器的群集部署。</p><p>的<code class="literal">NullSessionCache</code>实际上并不缓存任何对象：每个请求都使用一个新的Session对象。当仅需要对会话的最小支持时，它适用于没有粘性负载均衡器的群集部署和非群集部署。</p><p><code class="literal">SessionCaches</code>总是向<code class="literal">SessionDataStore</code>每当会话的最后一个请求退出时。</p><p>还可以将它们配置为立即，急切地写入新创建的会话。如果您可能会遇到多个同时引用同一会话的请求（例如使用HTTP / 2）并且没有粘性负载均衡器，则可能很有用。或者，如果不执行急切的写操作，则在单个请求内创建会话然后使会话无效的应用程序路径绝不会增加写入持久性存储的成本。</p><p>此外，如果<code class="literal">EVICT_ON_INACTIVITY</code>驱逐策略正在使用中，您可以<a class="link" href="session-configuration-sessioncache.html" title="L1会话缓存">配置</a> <code class="literal">DefaultSessionCache</code>强制将会话写入<code class="literal">SessionDataStore</code>在会议被驱逐之前。</p><p>有关更多信息，请参见<a class="link" href="session-configuration-sessioncache.html" title="L1会话缓存">L1会话缓存</a> 。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_sessiondatastore"></a> SessionDataStore</h3></div></div></div><p>一（1） <code class="literal">SessionDataStore</code>每个上下文。其目的是处理会话上所有与持久性相关的操作。</p><p>所有人的共同特征<code class="literal">SessionDataStores</code>它们是否支持钝化以及宽限期的长短。</p><p>支持钝化意味着会话数据被序列化。一些持久化机制可以序列化，例如JDBC，GCloud Datastore等，而其他持久化机制可以在配置了本地缓存时将对象存储在共享内存中，例如Infinispan。</p><p>集群技术是否需要钝化控制是否将调用会话钝化/激活侦听器。</p><p>宽限期是一个间隔（以秒为单位），该间隔尝试在发现已过期的会话方面处理会话的非事务性质。由于缺乏事务性，因此在群集配置中，即使使用粘性负载平衡器，会话始终有可能存在于节点上，但尚未在持久性存储中进行更新。什么时候<code class="literal">SessionDataStores</code>搜索其持久性存储以查找已过期的会话，它们通常会执行一些顺序搜索：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem">第一个验证SessionCache建议的候选会话ID列表的到期时间</li><li class="listitem">第二个在商店中找到已过期的会话，这些会话最后一次存在于当前节点上</li><li class="listitem">第三部分查找在“ while”之前过期的会话，而不管它们最后使用的是哪个节点：“ while”的定义基于宽限期。</li></ul></div><p>码头实例化琐碎的事<code class="literal">NullSessionDataStore</code> -不保留会话-默认。</p><p>该发行版提供了多种选择<code class="literal">SessionDataStore</code>实现，例如<a class="link" href="configuring-sessions-file-system.html" title="持久会话：文件系统">FileSessionDataStore</a> ， <a class="link" href="configuring-sessions-gcloud.html" title="持久会话：Google Cloud DataStore">GCloudSessionDataStore</a> ， <a class="link" href="configuring-sessions-jdbc.html" title="持久会话：JDBC">JDBCSessionDataStore</a> ，MongoSessionDataStore， <a class="link" href="configuring-sessions-infinispan.html" title="持久会话：Inifinspan">InfinispanSessionDataStore</a> ， <a class="link" href="configuring-sessions-hazelcast.html" title="持续会议：Hazelcast">HazelcastSessionDataStore</a> 。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_cachingsessiondatastore"></a> CachingSessionDataStore</h3></div></div></div><p>的<code class="literal">CachingSessionDataStore</code>是一种特殊的<code class="literal">SessionDataStore</code>插入会话数据的二级缓存- <code class="literal">SessionDataMap</code> -在代表面前<code class="literal">SessionDataStore</code> 。的<code class="literal">SessionDataMap</code>优先在实际SessionDataStore读取之前进行查询。这样可以提高慢速存储的性能。</p><p>Jetty根据以下内容提供了此L2缓存的一种实现<code class="literal">Memcached</code> ， <code class="literal">MemcachedSessionDataMap</code> 。</p><p>有关其他信息，请参见<a class="link" href="session-configuration-memcachedsessiondatastore.html" title="持久会话：L2会话数据缓存">L2 SessionData缓存</a> 。</p></div></div><script type="text/javascript">
      SyntaxHighlighter.all()
    </script><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tbody><tr><td width="40%" align="left"><a href="session-management.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><td width="20%" align="center"><a href="session-management.html" accesskey="u"><i class="fa fa-chevron-up" aria-hidden="true"></i>最佳</a></td><td width="40%" align="right"> <a href="session-configuration-housekeeper.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr><tr><td width="40%" align="left" valign="top">第十章会话管理</td><td width="20%" align="center"><a href="index.html" accesskey="h"><i class="fa fa-home" aria-hidden="true"></i>家</a></td><td width="40%" align="right" valign="top">SessionIdManager和管家</td></tr></tbody></table></div><p xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"></p><div class="jetty-callout">看到错误或缺少的东西？
            <span class="callout"><a href="http://github.com/eclipse/jetty.project">在以下位置对此文档做出贡献<span class="website"><i class="fa fa-github" aria-hidden="true"></i> Github！</span></a></span> <span style="float:right"><i>（产生：2019-11-20）</i></span></div><p></p></body></html>