<html ><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>配置SSL / TLS</title><link rel="stylesheet" type="text/css" href="css/docbook.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="jetty, servlet, servlet-api, cometd, http, websocket, eclipse, maven, java, server, software"><link rel="home" href="index.html" title="Jetty"><link rel="up" href="configuring-connectors.html" title="Chapter 6. Configuring Jetty Connectors"><link rel="prev" href="configuring-connectors.html" title="Chapter 6. Configuring Jetty Connectors"><link rel="next" href="jetty-ssl-distribution.html" title="SSL in the Jetty Distribution"><link rel="shortcut icon" href="images/favicon.ico" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><link rel="stylesheet" href="css/highlighter/foundation.css"><script src="js/highlight.pack.js"></script><script>
      hljs.initHighlightingOnLoad();
    </script><link type="text/css" rel="stylesheet" href="css/font-awesome/font-awesome.min.css"></head><body bgcolor="white"  text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><tbody><tr><td style="width:25%"><a href="http://www.eclipse.org/jetty"><img src="images/jetty-header-logo.png" alt="Jetty标志"></a><br><span style="font-size:small">版本：9.4.24.v20191120</span></td><td style="width:50%"></td></tr></tbody></table><div class="navheader" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><table width="100%" summary="Navigation header"><tbody><tr><th colspan="3" align="center">配置SSL / TLS</th></tr><tr><td width="20%" align="left"><a href="configuring-connectors.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><th width="60%" align="center">第六章配置Jetty连接器<br><a href="index.html" accesskey="p"><i class="fa fa-home" aria-hidden="true"></i>家</a></th><td width="20%" align="right"> <a href="jetty-ssl-distribution.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr></tbody></table><hr></div><div class="jetty-callout" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><h5 class="callout"><a href="http://www.webtide.com/">通过<span class="website">www.webtide.com</span>与Jetty核心开发人员联系。</a></h5><p>内部/客户项目的私人支持...自定义扩展和发行版...无限期支持的版本快照...您的应用程序和Ajax / Comet项目的可伸缩性指南...赞助功能开发的开发服务</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear:both"><a name="configuring-ssl"></a>配置SSL / TLS</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="configuring-ssl.html#configuring-jetty-for-ssl">为SSL配置Jetty</a></span></dt><dt><span class="section"><a href="configuring-ssl.html#tls-and-ssl-versions">TLS和SSL版本</a></span></dt><dt><span class="section"><a href="configuring-ssl.html#understanding-certificates-and-keys">了解证书和密钥</a></span></dt><dt><span class="section"><a href="configuring-ssl.html#configuring-sslcontextfactory">配置Jetty SslContextFactory</a></span></dt><dt><span class="section"><a href="configuring-ssl.html#conscrypt">加密SSL</a></span></dt><dt><span class="section"><a href="configuring-ssl.html#_configuring_sni">配置SNI</a></span></dt><dt><span class="section"><a href="configuring-ssl.html#configuring-sslcontextfactory-cipherSuites">禁用/启用特定密码套件</a></span></dt></dl></div><p>本文档概述了如何为Jetty配置SSL和TLS。</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configuring-jetty-for-ssl"></a>为SSL配置Jetty</h3></div></div></div><p>要为Jetty配置SSL，请完成以下部分的任务：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem"><a class="xref" href="configuring-ssl.html#generating-key-pairs-and-certificates" title="生成密钥对和证书">生成密钥对和证书</a></li><li class="listitem"><a class="xref" href="configuring-ssl.html#requesting-trusted-certificate" title="申请受信任的证书">申请受信任的证书</a></li><li class="listitem"><a class="xref" href="configuring-ssl.html#loading-keys-and-certificates" title="加载密钥和证书">加载密钥和证书</a></li><li class="listitem"><a class="xref" href="configuring-ssl.html#configuring-sslcontextfactory" title="配置Jetty SslContextFactory">配置Jetty SslContextFactory</a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="tls-and-ssl-versions"></a> TLS和SSL版本</h3></div></div></div><p>哪个浏览器/操作系统支持哪些协议，可以<a class="link" href="https://en.wikipedia.org/wiki/Transport_Layer_Security#Web_browsers" target="_top">在Wikipedia</a>上<a class="link" href="https://en.wikipedia.org/wiki/Transport_Layer_Security#Web_browsers" target="_top">找到</a> 。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem">TLS v1.2：应尽可能使用的协议。从Java 7开始支持所有基于CBC的密码，从Java 8开始支持新的GCM模式。</li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_older_protocols"></a>较旧的协议</h4></div></div></div><p>默认情况下不再支持TLS v1.0，v1.1和SSL v3。如果您的Jetty实施需要这些协议提供旧版支持，则可以手动启用它们。</p><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>TLS v1.3发布后，将无法使用TLS v1.0或v1.1的解决方法。TLS v1.3的计划包括禁止在任何级别出现具有已知漏洞的密码。建议尽快使用这些密码升级任何客户端，否则将被锁定在Jetty，Java甚至OS的过时版本中。</p></div></blockquote></div><p>默认情况下，Jetty将这些密码排除在<a class="link" href="https://github.com/eclipse/jetty.project/tree/jetty-9.4.x/jetty-util/src/main/java/org/eclipse/jetty/util/ssl/SslContextFactory.java#L249-L256" target="_top"><code class="literal">SslContextFactory</code> 。</a>您可以通过重新声明要在代码中排除的密码来重新启用这些密码：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>SslContextFactory.Server sslContextFactory = new SslContextFactory.Server();
sslContextFactory.setExcludeCipherSuites("^.*_(MD5|SHA|SHA1)$");</code></pre><p>在进行了这些更改之后，如果您仍然在使用这些密码时遇到问题，则它们很可能在JVM级别被阻止。找到<code class="literal">$JAVA_HOME/jre/lib/security/</code>目录<code class="literal">java.security</code>文件并检查它是否包含<span class="emphasis"><em>密码</em></span>或<span class="emphasis"><em>算法</em></span>之外的任何配置（取决于您使用的术语的JVM版本，可能有所不同）。</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="understanding-certificates-and-keys"></a>了解证书和密钥</h3></div></div></div><p>配置SSL可能会给密钥，证书，协议和格式带来混乱的体验，因此有助于合理了解基本知识。以下链接提供了一些良好的起点：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem"><p class="simpara">证书：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:circle"><li class="listitem"><a class="link" href="http://en.tldp.org/HOWTO/SSL-Certificates-HOWTO/index.html" target="_top">SSL凭证说明</a></li><li class="listitem"><a class="link" href="http://mindprod.com/jgloss/certificate.html" target="_top">Mindprod Java词汇表：证书</a></li></ul></div></li><li class="listitem"><p class="simpara">关键工具：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:circle"><li class="listitem"><a class="link" href="http://docs.oracle.com/javase/8/docs/technotes/tools/unix/keytool.html" target="_top">Unix的Keytool</a></li><li class="listitem"><a class="link" href="http://docs.oracle.com/javase/8/docs/technotes/tools/windows/keytool.html" target="_top">Windows的Keytool</a></li></ul></div></li><li class="listitem"><p class="simpara">其他工具：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:circle"><li class="listitem"><a class="link" href="https://www.ibm.com/developerworks/mydeveloperworks/groups/service/html/communityview?communityUuid=6fb00498-f6ea-4f65-bf0c-adc5bd0c5fcc" target="_top">IBM Keyman</a></li></ul></div></li><li class="listitem"><p class="simpara">OpenSSL：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:circle"><li class="listitem"><a class="link" href="http://www.openssl.org/support/faq.html" target="_top">OpenSSL常见问题解答</a></li></ul></div></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="openssl-vs-keytool"></a> OpenSSL与Keytool</h4></div></div></div><p>为了进行测试， <code class="literal">keytool</code>与JDK捆绑在一起的实用程序提供了生成所需密钥和证书的最简单方法。</p><p>您还可以使用OpenSSL工具生成密钥和证书，或转换与Apache或其他服务器一起使用的密钥和证书。由于Apache和其他服务器通常使用OpenSSL工具套件来生成和操作密钥和证书，因此您可能已经有一些由OpenSSL创建的密钥和证书，或者您可能还更喜欢OpenSSL生成的格式。</p><p>如果要与Jetty或非Apache用Java编写的Web服务器（例如Apache）一起使用同一证书，则可能希望使用OpenSSL生成私钥和证书。</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="generating-key-pairs-and-certificates"></a>生成密钥对和证书</h4></div></div></div><p>生成密钥和证书的最简单方法是使用<code class="literal">keytool</code> JDK附带的应用程序，因为它直接在密钥库中生成密钥和证书。请参阅<a class="xref" href="configuring-ssl.html#generating-key-pairs-and-certificates-JDK-keytool" title="使用JDK的keytool生成密钥和证书">使用JDK的keytool生成密钥和证书</a> 。</p><p>如果您已经拥有密钥和证书，请参阅<a class="xref" href="configuring-ssl.html#loading-keys-and-certificates" title="加载密钥和证书">加载密钥和证书</a>以将其加载到JSSE密钥库中。如果您有续约证书来替换即将到期的证书，则本节也适用。</p><p>下面的示例仅生成基本密钥和证书。如果要指定以下内容，则应阅读所用工具的完整手册：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem">密钥大小</li><li class="listitem">证书到期日期</li><li class="listitem">备用安全提供者</li></ul></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="generating-key-pairs-and-certificates-JDK-keytool"></a>使用JDK的keytool生成密钥和证书</h5></div></div></div><p>以下命令将密钥对和证书直接生成到文件中<code class="literal">keystore</code> ：</p><div class="screenexample"><pre class="screen">$ keytool -keystore keystore -alias jetty -genkey -keyalg RSA</pre></div><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>加载几页后，DSA密钥算法证书会产生错误。在浏览器中，它显示一条消息“由于本地主机提供的证书为无效签名而无法建立加密连接”。解决方案是将RSA用于密钥算法。</p></div></blockquote></div><p>该命令提示输入有关证书的信息和密码，以保护密钥库和其中的密钥。唯一的强制性响应是在“名字和姓氏”提示下提供服务器的标准主机名。例如：</p><div class="screenexample"><pre class="screen">$ keytool -keystore keystore -alias jetty -genkey -keyalg RSA -sigalg SHA256withRSA
 Enter keystore password:  password
 What is your first and last name?
   [Unknown]:  jetty.eclipse.org
 What is the name of your organizational unit?
   [Unknown]:  Jetty
 What is the name of your organization?
   [Unknown]:  Mort Bay Consulting Pty. Ltd.
 What is the name of your City or Locality?
   [Unknown]:
 What is the name of your State or Province?
   [Unknown]:
 What is the two-letter country code for this unit?
   [Unknown]:
 Is CN=jetty.eclipse.org, OU=Jetty, O=Mort Bay Consulting Pty. Ltd.,
 L=Unknown, ST=Unknown, C=Unknown correct?
   [no]:  yes

 Enter key password for &lt;jetty&gt;
         (RETURN if same as keystore password):
 $</pre></div><p>现在，您具有运行SSL连接的最低要求，并且可以直接继续<a class="link" href="configuring-ssl.html#configuring-sslcontextfactory" title="配置Jetty SslContextFactory">配置SSL连接器</a> 。但是，浏览器<span class="emphasis"><em>将不</em></span>信任您生成的证书，并提示用户执行此操作。尽管您现在拥有的东西通常足以进行测试，但是大多数公共站点都需要受信任的证书，这在<a class="link" href="configuring-ssl.html#generating-csr-from-keytool" title="使用keytool生成CSR">使用keytool生成CSR</a>的部分中进行了演示。</p><p>如果您只想对某种内部管理面板使用自签名证书， <days>请在上面的keytool调用中</days>添加-validity <days>，否则您的证书仅有效一个月。</days></p><p>如果使用的是Java 8或更高版本，则还可以使用SAN扩展设置证书适用的一个或多个名称：</p><div class="screenexample"><pre class="screen">$ keytool -keystore keystore -alias jetty -genkey -keyalg RSA -sigalg SHA256withRSA -ext 'SAN=dns:jetty.eclipse.org,dns:*.jetty.org'
 ...</pre></div></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="generating-keys-and-certificates-openssl"></a>使用OpenSSL生成密钥和证书</h5></div></div></div><p>以下命令在文件中生成密钥对<code class="literal">jetty.key</code> ：</p><div class="screenexample"><pre class="screen">$ openssl genrsa -aes128 -out jetty.key</pre></div><p>您可能还想使用<code class="literal">-rand</code> file参数提供任意文件，以帮助播种随机数生成器。</p><p>以下命令为文件生成密钥证书<code class="literal">jetty.crt</code> ：</p><div class="screenexample"><pre class="screen">$ openssl req -new -x509 -newkey rsa:2048 -sha256 -key jetty.key -out jetty.crt</pre></div><p>添加-sha256可确保使用现在推荐的SHA-256签名算法来获取证书。对于那些注重安全性的用户，请添加-b4096以获取4069位密钥。</p><p>下一条命令提示输入有关证书的信息和密码，以保护密钥库和其中的密钥。唯一的强制性响应是在“公用名”提示下提供服务器的标准主机名。例如：</p><div class="screenexample"><pre class="screen">$ openssl genrsa -aes128 -out jetty.key
Generating RSA private key, 2048 bit long modulus
..............+++
......................................................................+++
e is 65537 (0x10001)
Enter pass phrase for jetty.key:
Verifying - Enter pass phrase for jetty.key:

$ openssl req -new -x509 -newkey rsa:2048 -sha256 -key jetty.key -out jetty.crt
Enter pass phrase for jetty.key:
You are about to be asked to enter information that will be incorporated into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank.
For some fields there will be a default value.
If you enter '.', the field will be left blank.

Country Name (2 letter code) [AU]:
State or Province Name (full name) [Some-State]:
Locality Name (eg, city) []:
Organization Name (eg, company) [Internet Widgits Pty Ltd]:Mort Bay Consulting Pty. Ltd.
Organizational Unit Name (eg, section) []:Jetty
Common Name (e.g. server FQDN or YOUR name) []:jetty.eclipse.org
Email Address []:

$</pre></div><p>现在，您具有运行SSL连接的最低要求，可以直接进入<a class="link" href="configuring-ssl.html#loading-keys-and-certificates" title="加载密钥和证书">]将这些密钥和证书加载到JSSE密钥库中。但是，浏览器<span class="emphasis"><em>将不</em></span>信任您生成的证书，并提示用户执行此操作。尽管您现在拥有的东西通常足以进行测试，但是大多数公共站点都需要受信任的证书，这在xref：generating-csr-from-openssl [部分中进行了演示，</a>以获取证书。</p></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="using-keys-and-certificates-from-other-sources"></a>使用其他来源的密钥和证书</h5></div></div></div><p>如果您有其他来源的密钥和证书，则可以直接进入<a class="xref" href="configuring-ssl.html#loading-keys-and-certificates" title="加载密钥和证书">加载密钥和证书</a> 。</p></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="requesting-trusted-certificate"></a>申请受信任的证书</h4></div></div></div><p>用JDK生成的密钥和证书<code class="literal">keytool</code>和OpenSSL足以运行SSL连接器。但是，浏览器将不信任您生成的证书，并且将提示用户此效果。</p><p>要获得大多数普通浏览器将信任的证书，您需要请求一个著名的证书颁发机构（CA）来对您的密钥/证书进行签名。此类受信任的CA包括：AddTrust，Entrust，GeoTrust，RSA Data Security，Thawte，VISA，VariCert，Verisign和beTRUSTed等。每个CA都有其自己的指令（查找JSSE或OpenSSL部分），但是每个CA都涉及一个生成证书签名请求（CSR）的步骤。</p><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="generating-csr-from-keytool"></a>使用keytool生成CSR</h5></div></div></div><p>以下命令生成文件<code class="literal">jetty.csr</code>使用<code class="literal">keytool</code>对于密钥库中已存在的密钥/证书：</p><div class="screenexample"><pre class="screen">$ keytool -certreq -alias jetty -keystore keystore -file jetty.csr</pre></div></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="generating-csr-from-openssl"></a>从OpenSSL生成CSR</h5></div></div></div><p>以下命令生成文件<code class="literal">jetty.csr</code>使用OpenSSL作为文件中的密钥<code class="literal">jetty.key</code> ：</p><div class="screenexample"><pre class="screen">$ openssl req -new -key jetty.key -out jetty.csr</pre></div><p>请注意，此命令仅使用来自<code class="literal">jetty.key</code>文件，而不是证书<code class="literal">jetty.crt</code>由OpenSSL生成。您需要再次输入证书的详细信息。</p></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="loading-keys-and-certificates"></a>加载密钥和证书</h4></div></div></div><p>一旦CA向您发送了证书，或者您生成了自己的证书而没有<code class="literal">keytool</code> ，您需要将其加载到JSSE密钥库中。</p><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>您需要JSSE密钥库中的私钥和证书。您应该将证书加载到用于生成CSR的密钥库中<code class="literal">keytool</code> 。如果您的密钥对还不在密钥库中（例如，因为它是使用OpenSSL生成的），则需要使用PKCS12格式来加载密钥和证书（请参阅<a class="link" href="configuring-ssl.html#loading-keys-and-certificates-via-pkcks12" title="通过PKCS12加载密钥和证书">PKCKS12密钥和证书</a> ）。</p></div></blockquote></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="loading-certificates-with-keytool"></a>使用keytool加载证书</h5></div></div></div><p>您可以使用<code class="literal">keytool</code>将PEM形式的证书直接加载到密钥库中。PEM格式是证书的文本编码；它由OpenSSL生成，并由某些CA返回。PEM文件的示例是：</p><div class="screenexample"><pre class="screen">jetty.crt
-----BEGIN CERTIFICATE-----
MIICSDCCAfKgAwIBAgIBADANBgkqhkiG9w0BAQQFADBUMSYwJAYDVQQKEx1Nb3J0
IEJheSBDb25zdWx0aW5nIFB0eS4gTHRkLjEOMAwGA1UECxMFSmV0dHkxGjAYBgNV
BAMTEWpldHR5Lm1vcnRiYXkub3JnMB4XDTAzMDQwNjEzMTk1MFoXDTAzMDUwNjEz
MTk1MFowVDEmMCQGA1UEChMdTW9ydCBCYXkgQ29uc3VsdGluZyBQdHkuIEx0ZC4x
DjAMBgNVBAsTBUpldHR5MRowGAYDVQQDExFqZXR0eS5tb3J0YmF5Lm9yZzBcMA0G
CSqGSIb3DQEBAQUAA0sAMEgCQQC5V4oZeVdhdhHqa9L2/ZnKySPWUqqy81riNfAJ
7uALW0kEv/LtlG34dOOcVVt/PK8/bU4dlolnJx1SpiMZbKsFAgMBAAGjga4wgasw
HQYDVR0OBBYEFFV1gbB1XRvUx1UofmifQJS/MCYwMHwGA1UdIwR1MHOAFFV1gbB1
XRvUx1UofmifQJS/MCYwoVikVjBUMSYwJAYDVQQKEx1Nb3J0IEJheSBDb25zdWx0
aW5nIFB0eS4gTHRkLjEOMAwGA1UECxMFSmV0dHkxGjAYBgNVBAMTEWpldHR5Lm1v
cnRiYXkub3JnggEAMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEEBQADQQA6NkaV
OtXzP4ayzBcgK/qSCmF44jdcARmrXhiXUcXzjxsLjSJeYPJojhUdC2LQKy+p4ki8
Rcz6oCRvCGCe5kDB
-----END CERTIFICATE-----</pre></div><p>以下命令将PEM编码的证书加载到<code class="literal">jetty.crt</code>文件到JSSE密钥库中：</p><div class="screenexample"><pre class="screen">$ keytool -keystore keystore -import -alias jetty -file jetty.crt -trustcacerts</pre></div><p>如果您从CA收到的证书的格式不是<code class="literal">keytool</code>了解，您可以使用<code class="literal">openssl</code>转换格式的命令：</p><div class="screenexample"><pre class="screen">$ openssl x509 -in jetty.der -inform DER -outform PEM -out jetty.crt</pre></div></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="loading-keys-and-certificates-via-pkcks12"></a>通过PKCS12加载密钥和证书</h5></div></div></div><p>如果您在单独的文件中具有密钥和证书，则需要将它们组合成PKCS12格式的文件以加载到新的密钥库中。该证书可以是您自己生成的证书，也可以是CA为响应CSR而返回的证书。</p><p>以下OpenSSL命令在<code class="literal">jetty.key</code>和证书中的<code class="literal">jetty.crt</code>归档到<code class="literal">jetty.pkcs12</code>文件：</p><div class="screenexample"><pre class="screen">$ openssl pkcs12 -inkey jetty.key -in jetty.crt -export -out jetty.pkcs12</pre></div><p>如果您具有证书链，则因为您的CA是中介机构，请按如下所示构建PKCS12文件：</p><div class="screenexample"><pre class="screen">$ cat example.crt intermediate.crt [intermediate2.crt] ... rootCA.crt &gt; cert-chain.txt
$ openssl pkcs12 -export -inkey example.key -in cert-chain.txt -out example.pkcs12</pre></div><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>根据<a class="link" href="https://www.ietf.org/rfc/rfc2246.txt" target="_top">RFC2246第7.4.2节</a> ，证书的顺序必须是从服务器到rootCA <a class="link" href="https://www.ietf.org/rfc/rfc2246.txt" target="_top">。</a></p></div></blockquote></div><p>OpenSSL要求输入<span class="emphasis"><em>导出密码</em></span> 。需要非空密码才能进行下一步。使用以下命令将结果PKCS12文件加载到JSSE密钥库中<code class="literal">keytool</code> ：</p><div class="screenexample"><pre class="screen">$ keytool -importkeystore -srckeystore jetty.pkcs12 -srcstoretype PKCS12 -destkeystore keystore</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="renewing-certificates"></a>续订证书</h4></div></div></div><p>如果您要更新配置以使用较新的证书（如旧证书即将到期），请按照“ <a class="xref" href="configuring-ssl.html#loading-keys-and-certificates" title="Loading Keys and Certificates">加载密钥和证书</a> ”部分中的说明<a class="xref" href="configuring-ssl.html#loading-keys-and-certificates" title="Loading Keys and Certificates">加载</a>较新的<a class="xref" href="configuring-ssl.html#loading-keys-and-certificates" title="加载密钥和证书">证书</a> 。如果最初使用PKCS12方法导入密钥和证书，请使用别名“ 1”而不是“ jetty”，因为这是PKCS12进程输入到密钥库中的别名。</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="layout-of-keystore-and-truststore"></a>密钥库和信任库的布局</h4></div></div></div><p>的<code class="literal">keystore</code>仅包含服务器的私钥和证书。</p><div class="figure"><a name="img-certificate-chain"></a><p class="title"><b>图6.1。证书链</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/certificate-chain.png" alt="证书链"></div></div></div><br class="figure-break"><p><b>KeyStore文件的结构：</b>
</p><pre class="literallayout">&#9500;&#9472;&#9472; PrivateKeyEntry
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; PrivateKey
&#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; Certificate chain
&#9474;&nbsp;&nbsp; &#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; Server certificate (end entity)
&#9474;&nbsp;&nbsp; &#9474;&nbsp;&nbsp; &#9500;&#9472;&#9472; Intermediary CA certificate
&#9474;&nbsp;&nbsp; &#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; Root CA certificate
&#9500;&#9472;&#9472; TrustedCertEntry
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; Intermediary CA certificate
&#9492;&#9472;&#9472; TrustedCertEntry
 &nbsp;&nbsp; &#9492;&#9472;&#9472; Root CA certificate</pre><p>
</p><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>这俩<code class="literal">Intermediary CA certificate</code>和<code class="literal">Root CA certificate</code>是可选的。</p></div></blockquote></div><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>$ cd $JETTY_BASE
$ keytool -list -keystore etc/keystore -storetype jks -storepass '' -v

Keystore type: JKS
Keystore provider: SUN

Your keystore contains 3 entries

Alias name: *.example.com
Creation date: Sep 20, 2016
Entry type: PrivateKeyEntry
Certificate chain length: 3
Certificate[1]:
Owner: CN=*.example.com, OU=Web Servers, O="Example.com Co.,Ltd.", C=CN
Issuer: CN="Example.com Co.,Ltd. ETP CA", OU=CA Center, O="Example.com Co.,Ltd.", C=CN
Serial number: b63af619ff0b4c368735113ba5db8997
Valid from: Mon Sep 12 15:09:49 CST 2016 until: Wed Sep 12 15:09:49 CST 2018
Certificate fingerprints:
	 MD5:  D9:26:CC:27:77:9D:26:FE:67:4C:BE:FF:E3:95:1E:97
	 SHA1: AF:DC:D2:65:6A:33:42:E3:81:9E:4D:19:0D:22:20:C7:6F:2F:11:D0
	 SHA256: 43:E8:21:5D:C6:FB:A0:7D:5D:7B:9C:8B:8D:E9:4B:52:BF:50:0D:90:4F:61:C2:18:9E:89:AA:4C:C2:93:BD:32
	 Signature algorithm name: SHA256withRSA
	 Version: 3

Extensions:

#1: ObjectId: 2.5.29.35 Criticality=false
AuthorityKeyIdentifier [
KeyIdentifier [
0000: 44 9B AD 31 E7 FE CA D5   5A 8E 17 55 F9 F0 1D 6B  D..1....Z..U...k
0010: F5 A5 8F C1                                        ....
]
]

#2: ObjectId: 2.5.29.19 Criticality=true
BasicConstraints:[
  CA:false
  PathLen: undefined
]

#3: ObjectId: 2.5.29.37 Criticality=true
ExtendedKeyUsages [
  serverAuth
  clientAuth
]

#4: ObjectId: 2.5.29.15 Criticality=true
KeyUsage [
  DigitalSignature
  Key_Encipherment
  Data_Encipherment
]

#5: ObjectId: 2.5.29.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: 7D 26 36 73 61 5E 08 94   AD 25 13 46 DB DB 95 25  .&amp;6sa^...%.F...%
0010: BF 82 5A CA                                        ..Z.
]
]

Certificate[2]:
Owner: CN="Example.com Co.,Ltd. ETP CA", OU=CA Center, O="Example.com Co.,Ltd.", C=CN
Issuer: CN="Example.com Co.,Ltd. Root CA", OU=CA Center, O="Example.com Co.,Ltd.", C=CN
Serial number: f6e7b86f6fdb467f9498fb599310198f
Valid from: Wed Nov 18 00:00:00 CST 2015 until: Sun Nov 18 00:00:00 CST 2035
Certificate fingerprints:
	 MD5:  ED:A3:91:57:D8:B8:6E:B1:01:58:55:5C:33:14:F5:99
	 SHA1: D9:A4:93:9D:A6:F8:A3:F9:FD:85:51:E2:C5:2E:0B:EE:80:E7:D0:22
	 SHA256: BF:54:7A:F6:CA:0C:FA:EF:93:B6:6B:6E:2E:D7:44:A8:40:00:EC:69:3A:2C:CC:9A:F7:FE:8E:6F:C0:FA:22:38
	 Signature algorithm name: SHA256withRSA
	 Version: 3

Extensions:

#1: ObjectId: 2.5.29.35 Criticality=false
AuthorityKeyIdentifier [
KeyIdentifier [
0000: A6 BD 5F B3 E8 7D 74 3D   20 44 66 1A 16 3B 1B DF  .._...t= Df..;..
0010: E6 E6 04 46                                        ...F
]
]

#2: ObjectId: 2.5.29.19 Criticality=true
BasicConstraints:[
  CA:true
  PathLen:2147483647
]

#3: ObjectId: 2.5.29.15 Criticality=true
KeyUsage [
  Key_CertSign
  Crl_Sign
]

#4: ObjectId: 2.5.29.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: 44 9B AD 31 E7 FE CA D5   5A 8E 17 55 F9 F0 1D 6B  D..1....Z..U...k
0010: F5 A5 8F C1                                        ....
]
]

Certificate[3]:
Owner: CN="Example.com Co.,Ltd. Root CA", OU=CA Center, O="Example.com Co.,Ltd.", C=CN
Issuer: CN="Example.com Co.,Ltd. Root CA", OU=CA Center, O="Example.com Co.,Ltd.", C=CN
Serial number: f0a45bc9972c458cbeae3f723055f1ac
Valid from: Wed Nov 18 00:00:00 CST 2015 until: Sun Nov 18 00:00:00 CST 2114
Certificate fingerprints:
	 MD5:  50:61:62:22:71:60:F7:69:2E:27:42:6B:62:31:82:79
	 SHA1: 7A:6D:A6:48:B1:43:03:3B:EA:A0:29:2F:19:65:9C:9B:0E:B1:03:1A
	 SHA256: 05:3B:9C:5B:8E:18:61:61:D1:9C:AA:0E:8C:B1:EA:44:C2:6E:67:5D:96:30:EC:8C:F6:6F:E1:EC:AD:00:60:F1
	 Signature algorithm name: SHA256withRSA
	 Version: 3

Extensions:

#1: ObjectId: 2.5.29.35 Criticality=false
AuthorityKeyIdentifier [
KeyIdentifier [
0000: A6 BD 5F B3 E8 7D 74 3D   20 44 66 1A 16 3B 1B DF  .._...t= Df..;..
0010: E6 E6 04 46                                        ...F
]
]

#2: ObjectId: 2.5.29.19 Criticality=true
BasicConstraints:[
  CA:true
  PathLen:2147483647
]

#3: ObjectId: 2.5.29.15 Criticality=true
KeyUsage [
  Key_CertSign
  Crl_Sign
]

#4: ObjectId: 2.5.29.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: A6 BD 5F B3 E8 7D 74 3D   20 44 66 1A 16 3B 1B DF  .._...t= Df..;..
0010: E6 E6 04 46                                        ...F
]
]



*******************************************
*******************************************


Alias name: example.com co.,ltd. etp ca
Creation date: Sep 20, 2016
Entry type: trustedCertEntry

Owner: CN="Example.com Co.,Ltd. ETP CA", OU=CA Center, O="Example.com Co.,Ltd.", C=CN
Issuer: CN="Example.com Co.,Ltd. Root CA", OU=CA Center, O="Example.com Co.,Ltd.", C=CN
Serial number: f6e7b86f6fdb467f9498fb599310198f
Valid from: Wed Nov 18 00:00:00 CST 2015 until: Sun Nov 18 00:00:00 CST 2035
Certificate fingerprints:
	 MD5:  ED:A3:91:57:D8:B8:6E:B1:01:58:55:5C:33:14:F5:99
	 SHA1: D9:A4:93:9D:A6:F8:A3:F9:FD:85:51:E2:C5:2E:0B:EE:80:E7:D0:22
	 SHA256: BF:54:7A:F6:CA:0C:FA:EF:93:B6:6B:6E:2E:D7:44:A8:40:00:EC:69:3A:2C:CC:9A:F7:FE:8E:6F:C0:FA:22:38
	 Signature algorithm name: SHA256withRSA
	 Version: 3

Extensions:

#1: ObjectId: 2.5.29.35 Criticality=false
AuthorityKeyIdentifier [
KeyIdentifier [
0000: A6 BD 5F B3 E8 7D 74 3D   20 44 66 1A 16 3B 1B DF  .._...t= Df..;..
0010: E6 E6 04 46                                        ...F
]
]

#2: ObjectId: 2.5.29.19 Criticality=true
BasicConstraints:[
  CA:true
  PathLen:2147483647
]

#3: ObjectId: 2.5.29.15 Criticality=true
KeyUsage [
  Key_CertSign
  Crl_Sign
]

#4: ObjectId: 2.5.29.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: 44 9B AD 31 E7 FE CA D5   5A 8E 17 55 F9 F0 1D 6B  D..1....Z..U...k
0010: F5 A5 8F C1                                        ....
]
]



*******************************************
*******************************************


Alias name: example.com co.,ltd. root ca
Creation date: Sep 20, 2016
Entry type: trustedCertEntry

Owner: CN="Example.com Co.,Ltd. Root CA", OU=CA Center, O="Example.com Co.,Ltd.", C=CN
Issuer: CN="Example.com Co.,Ltd. Root CA", OU=CA Center, O="Example.com Co.,Ltd.", C=CN
Serial number: f0a45bc9972c458cbeae3f723055f1ac
Valid from: Wed Nov 18 00:00:00 CST 2015 until: Sun Nov 18 00:00:00 CST 2114
Certificate fingerprints:
	 MD5:  50:61:62:22:71:60:F7:69:2E:27:42:6B:62:31:82:79
	 SHA1: 7A:6D:A6:48:B1:43:03:3B:EA:A0:29:2F:19:65:9C:9B:0E:B1:03:1A
	 SHA256: 05:3B:9C:5B:8E:18:61:61:D1:9C:AA:0E:8C:B1:EA:44:C2:6E:67:5D:96:30:EC:8C:F6:6F:E1:EC:AD:00:60:F1
	 Signature algorithm name: SHA256withRSA
	 Version: 3

Extensions:

#1: ObjectId: 2.5.29.35 Criticality=false
AuthorityKeyIdentifier [
KeyIdentifier [
0000: A6 BD 5F B3 E8 7D 74 3D   20 44 66 1A 16 3B 1B DF  .._...t= Df..;..
0010: E6 E6 04 46                                        ...F
]
]

#2: ObjectId: 2.5.29.19 Criticality=true
BasicConstraints:[
  CA:true
  PathLen:2147483647
]

#3: ObjectId: 2.5.29.15 Criticality=true
KeyUsage [
  Key_CertSign
  Crl_Sign
]

#4: ObjectId: 2.5.29.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: A6 BD 5F B3 E8 7D 74 3D   20 44 66 1A 16 3B 1B DF  .._...t= Df..;..
0010: E6 E6 04 46                                        ...F
]
]



*******************************************
*******************************************</code></pre><p>此外，您可以拆分<code class="literal">$JETTY/etc/keystore</code>作为两个文件。一个是<code class="literal">$JETTY/etc/keystore</code>其中仅包含服务器的私钥和证书，另一个是<code class="literal">$JETTY/etc/truststore</code>其中包含中间CA和根CA。</p><p><b>的结构<code class="literal">$JETTY/etc/keystore</code> 。</b>
</p><pre class="literallayout">&#9492;&#9472;&#9472; PrivateKeyEntry
 &nbsp;&nbsp; &#9500;&#9472;&#9472; PrivateKey
 &nbsp;&nbsp; &#9492;&#9472;&#9472; Certificate chain
 &nbsp;&nbsp;  &nbsp;&nbsp; &#9492;&#9472;&#9472; Server certificate (end entity)</pre><p>
</p><p><b>的结构<code class="literal">$JETTY/etc/truststore</code> 。</b>
</p><pre class="literallayout">&#9500;&#9472;&#9472; TrustedCertEntry
&#9474;&nbsp;&nbsp; &#9492;&#9472;&#9472; Intermediary CA certificate
&#9492;&#9472;&#9472; TrustedCertEntry
 &nbsp;&nbsp; &#9492;&#9472;&#9472; Root CA certificate</pre><p>
</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configuring-sslcontextfactory"></a>配置Jetty SslContextFactory</h3></div></div></div><p>从上面生成的SSL证书保存在密钥存储区中，并在<a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/util/ssl/SslContextFactory.Server.html" target="_top">SslContextFactory实例中进行配置</a><a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/util/ssl/SslContextFactory.Server.html" target="_top">。服务器</a>对象。</p><p>的<code class="literal">SslContextFactory</code>为...负责：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type:disc"><li class="listitem">创建Java <code class="literal">SslEngine</code>由Jetty的连接器和Jetty的客户端（HTTP / 1，HTTP / 2和WebSocket）使用。</li><li class="listitem">管理密钥库访问</li><li class="listitem">管理信任库访问</li><li class="listitem">通过排除/包含列表管理协议选择</li><li class="listitem">通过排除/包含列表管理密码套件选择</li><li class="listitem">管理提供的密码的顺序（对于TLS / 1.2和HTTP / 2支持很重要）</li><li class="listitem">SSL会话缓存选项</li><li class="listitem">证书<a class="link" href="https://en.wikipedia.org/wiki/Revocation_list" target="_top">吊销列表</a>和分发点（CRLDP）</li><li class="listitem"><a class="link" href="https://en.wikipedia.org/wiki/Online_Certificate_Status_Protocol" target="_top">OCSP</a>支持</li><li class="listitem">客户端身份验证支持</li></ul></div><p>对于Jetty连接器，已配置<code class="literal">SslContextFactory.Server</code>被注入到特定的ServerConnector中<code class="literal">SslConnectionFactory</code> 。</p><p>对于Jetty客户端，各种构造函数都支持使用已配置的<code class="literal">SslContextFactory.Client</code> 。</p><p>而<code class="literal">SslContextFactory</code>可以在没有密钥库的情况下运行（此模式最适合各种Jetty客户端），最佳做法是至少配置所使用的密钥库。</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">setKeyStorePath</span></dt><dd>已配置的密钥库，可用于已配置的Jetty连接器（或客户端）中的所有SSL / TLS。</dd></dl></div><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>作为一个密钥是重要的安全信息，可以期望找到一个目录中的文件具有<span class="strong"><strong>非常</strong></span>限制访问。</p></div></blockquote></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">setKeyStorePassword</span></dt><dd>密钥库密码可以在此处以纯文本格式设置，或者出于某种保护措施，以防偶然观察，可以使用<a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/util/security/Password.html" target="_top">Password</a>类对其进行混淆。</dd><dt><span class="term">setTrustStorePath</span></dt><dd>如果用于验证客户端证书，则使用此证书，通常将其设置为与密钥库相同的路径。</dd><dt><span class="term">setKeyManagerPassword</span></dt><dd>传递给<code class="literal">KeyManagerFactory.init(...)</code> 。如果没有<code class="literal">keymanagerpassword</code> ，然后<code class="literal">keystorepassword</code>改为使用。如果没有<code class="literal">trustmanager</code>设置，然后将密钥库用作信任库，并且将<code class="literal">keystorepassword</code>用作信任库密码。</dd><dt><span class="term">setExcludeCipherSuites / setIncludeCipherSuites</span></dt><dd>这允许自定义将由SSL / TLS使用的所选密码套件。</dd><dt><span class="term">setExcludeProtocols / setIncludeProtocols</span></dt><dd>这允许自定义将由SSL / TLS使用的所选协议。</dd></dl></div><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>当使用“包含/排除”时，重要的是要知道“ <span class="strong"><strong>排除”将永远获胜。</strong></span>选择过程是针对包含列表处理可用密码套件或协议的JVM列表，然后删除被排除的JVM列表。请注意，每个“包含/排除”列表都有一个Set方法（替换列表）或Add方法（追加列表）。</p></div></blockquote></div><div class="blockquote"><blockquote class="blockquote"><div class="caution" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-exclamation" aria-hidden="true"></i>警告</h3><p>密钥库和信任库密码也可以使用系统属性来设置： <code class="literal">org.eclipse.jetty.ssl.keypassword</code><code class="literal">org.eclipse.jetty.ssl.password</code> 。这<span class="emphasis"><em>不是</em></span>建议的用法。</p></div></blockquote></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="conscrypt"></a>加密SSL</h3></div></div></div><p>Jetty包括对Google <a class="link" href="https://github.com/google/conscrypt/" target="_top">Conscrypt SSL的支持</a> ，该协议建立在他们的<a class="link" href="https://www.openssl.org/" target="_top">OpenSSL</a> <a class="link" href="https://boringssl.googlesource.com/boringssl/" target="_top">分支BoringSSL之上</a> 。为<a class="link" href="https://github.com/eclipse/jetty.project/tree/jetty-9.4.x/jetty-alpn/jetty-alpn-conscrypt-server/src/test/java/org/eclipse/jetty/alpn/conscrypt/server/ConscryptHTTP2Server.java" target="_top">服务器</a>或<a class="link" href="https://github.com/eclipse/jetty.project/tree/jetty-9.4.x/jetty-alpn/jetty-alpn-conscrypt-client/src/test/java/org/eclipse/jetty/alpn/java/client/ConscryptHTTP2Client.java" target="_top">客户端</a>实现Conscrypt的过程非常简单-只需实例化Conscrypt的实例即可<code class="literal">OpenSSLProvider</code>并设置<code class="literal">Conscrypt</code>作为Jetty的供应商<code class="literal">SslContextFactory</code> ：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>...
Security.addProvider(new OpenSSLProvider());
...
SslContextFactory.Server sslContextFactory = new SslContextFactory.Server();
sslContextFactory.setKeyStorePath("path/to/keystore");
sslContextFactory.setKeyStorePassword("CleverKeyStorePassword");
sslContextFactory.setKeyManagerPassword("OBF:VerySecretManagerPassword");
sslContextFactory.setProvider("Conscrypt");
...</code></pre><p>如果您正在使用Jetty发行版，请参阅有关启用<a class="link" href="jetty-ssl-distribution.html#jetty-conscrypt-distribution" title="加密SSL配置">Conscrypt SSL模块的部分。</a></p><p>如果您将Conscrypt与Java 8结合使用，则必须排除<code class="literal">TLSv1.3</code>协议，因为现在默认情况下已使用Conscrypt 2.0.0启用该协议，但Java 8不支持该协议。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_configuring_sni"></a>配置SNI</h3></div></div></div><p>从Java 8开始，JVM包含对<a class="link" href="http://en.wikipedia.org/wiki/Server_Name_Indication" target="_top">服务器名称指示器（SNI）</a>扩展的支持，该扩展允许SSL连接握手指示其适用的一个或多个DNS名称。</p><p>为此， <code class="literal">SslContextFactory</code>用来。的<code class="literal">SslContextFactory</code>会在密钥库中查找多个X509证书，每个证书中可能都有与<a class="link" href="http://en.wikipedia.org/wiki/SubjectAltName" target="_top">主题备用名称</a>扩展名关联的多个DNS名称（包括通配符）。使用时<code class="literal">SslContextFactory</code> ，如果握手中存在SNI扩展名，则会自动选择正确的证书。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="configuring-sslcontextfactory-cipherSuites"></a>禁用/启用特定密码套件</h3></div></div></div><p>总是在开发新的密码套件，以保持攻击的领先地位。不过，利用最佳套件只是时间问题，对于任何实施而言，确保服务器在这方面都是最新的至关重要。例如，为了避免BEAST攻击，必须配置一组特定的密码套件。这可以通过<a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/util/ssl/SslContextFactory.html#setIncludeCipherSuites(java.lang.String%E2%80%A6%E2%80%8B)" target="_top">SslContext.setIncludeCipherSuites（java.lang。字符串...）</a>或通过<a class="link" href="http://www.eclipse.org/jetty/javadoc/9.4.24.v20191120/org/eclipse/jetty/util/ssl/SslContextFactory.html#setExcludeCipherSuites(java.lang.String%E2%80%A6%E2%80%8B)" target="_top">SslContext.setExcludeCipherSuites（java.lang。字符串...</a></p><p>至关重要的是，使用JDK使用/已知的密码套件的<span class="emphasis"><em>确切</em></span>名称。您可以通过获取SSLEngine实例并调用来获取它们<code class="literal">getSupportedCipherSuites()</code> 。诸如<a class="link" href="https://www.ssllabs.com/" target="_top">ssllabs.com之类的</a>工具可能会报告略有不同的名称，这些名称将被忽略。</p><div class="blockquote"><blockquote class="blockquote"><div class="important" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-plus" aria-hidden="true"></i>重要</h3><p>重要的是要保持最新以支持最新的密码套件。请确保经常查阅Oracle的<a class="link" href="https://java.com/en/jre-jdk-cryptoroadmap.html" target="_top">JRE和JDK加密路线图，</a>以了解最近和即将发生的对受支持密码的更改。</p></div></blockquote></div><div class="blockquote"><blockquote class="blockquote"><div class="important" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-plus" aria-hidden="true"></i>重要</h3><p>建议在您的JRE中安装Java密码学扩展（JCE）无限强度策略文件，以获得完整强度的密码，例如AES-256。这些文件可以在<a class="link" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_top">Java下载页面</a>上找到。只需覆盖其中的两个当前JAR文件<code class="literal"><JRE_HOME>/lib/security/</code> 。</p></div></blockquote></div><p>都<code class="literal">setIncludeCipherSuites</code>和<code class="literal">setExcludeCipherSuites</code>可以通过JDK中使用的确切密码套件名称或使用正则表达式来馈送。如果您需要调整“包含”或“排除”，则最好使用配置XML的自定义XML来完成。 <code class="literal">SslContextFactory</code>满足您的需求。</p><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>Jetty <span class="strong"><strong>确实</strong></span>允许用户启用弱/已弃用的密码套件（甚至根本没有密码套件）。默认情况下，如果启用了这些套件，则警告消息将出现在服务器日志中。</p></div></blockquote></div><p>为此，首先创建一个新<code class="literal">${jetty.base}/etc/tweak-ssl.xml</code>文件（可以是任何名称，只需避免在文件名前加上“ jetty-”）。</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN"
          "http://www.eclipse.org/jetty/configure_9_3.dtd"&gt;
&lt;!-- Tweak SsslContextFactory Includes / Excludes --&gt;
&lt;Configure id="sslContextFactory" class="org.eclipse.jetty.util.ssl.SslContextFactory$Server"&gt;
  &lt;!-- Mitigate SLOTH Attack --&gt;
  &lt;Call name="addExcludeCipherSuites"&gt;
    &lt;Arg&gt;
      &lt;Array type="String"&gt;
        &lt;Item&gt;.*_RSA_.*SHA1$&lt;/Item&gt;
        &lt;Item&gt;.*_RSA_.*SHA$&lt;/Item&gt;
        &lt;Item&gt;.*_RSA_.*MD5$&lt;/Item&gt;
      &lt;/Array&gt;
    &lt;/Arg&gt;
  &lt;/Call&gt;
&lt;/Configure&gt;</code></pre><p>这个新的XML将配置id <code class="literal">sslContextFactory</code>进一步（此ID首先由<code class="literal">ssl</code>模块及其关联<code class="literal">${jetty.home}/etc/jetty-ssl-context.xml</code> ）。您可以使用<code class="literal">SslContextFactory</code>由Jetty发行版通过此经过调整的XML使用。</p><p>为了确保您的<code class="literal">${jetty.base}</code>使用这个新的XML，将其添加到您的末尾<code class="literal">${jetty.base}/start.ini</code>要么<code class="literal">${jetty.base}/start.d/server.ini</code> 。</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>$ cd /path/to/mybase
$ ls -l
drwxrwxr-x.  2 user group  4096 Feb  2 11:47 etc/
-rw-rw-r--.  1 user group  4259 Feb  2 11:47 start.ini
$ tail start.ini
# Module: https
--module=https
etc/tweak-ssl.xml
$</code></pre><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>默认值<code class="literal">SslContextFactory</code>实施会针对SSL / TLS中的漏洞应用最新的SSL / TLS建议。查看发行说明（ <code class="literal">VERSION.txt</code>可以在Jetty发行<a class="link" href="http://search.maven.org/#search|gav|1|g%3A"org.eclipse.jetty" AND a%3A"jetty-project"" target="_top"><span class="emphasis"><em>版</em></span></a>的根目录中找到，也<a class="link" href="http://search.maven.org/#search|gav|1|g%3A"org.eclipse.jetty" AND a%3A"jetty-project"" target="_top">可以在<code class="literal">jetty-project</code></a> Maven Central上的<a class="link" href="http://search.maven.org/#search|gav|1|g%3A"org.eclipse.jetty" AND a%3A"jetty-project"" target="_top">组件</a> ）进行更新。Java JVM还在JVM级别应用排除，因此，如果您需要启用业界通常认为不安全或易受攻击的功能，则可能必须在Java JVM和您的Jetty中<span class="strong"><strong>都</strong></span>启用它组态。</p></div></blockquote></div><div class="blockquote"><blockquote class="blockquote"><div class="tip" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-lightbulb-o" aria-hidden="true"></i>小费</h3><p>您可以启用<code class="literal">org.eclipse.jetty.util.ssl</code>在命名记录器<code class="literal">DEBUG</code>级别，以查看Jetty启动时所选协议和密码套件的列表。</p></div></blockquote></div><p>其他包含/排除示例：</p><p><span class="strong"><strong>示例</strong></span> ：包括所有使用正则表达式支持<a class="link" href="https://en.wikipedia.org/wiki/Forward_secrecy" target="_top">正向保密的</a>密码：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>  &lt;!-- Enable Forward Secrecy Ciphers.
       Note: this replaces the default Include Cipher list --&gt;
  &lt;Set name="IncludeCipherSuites"&gt;
    &lt;Array type="String"&gt;
      &lt;Item&gt;TLS_DHE_RSA.*&lt;/Item&gt;
      &lt;Item&gt;TLS_ECDHE.*&lt;/Item&gt;
    &lt;/Array&gt;
  &lt;/Set&gt;</code></pre><p><span class="strong"><strong>示例</strong></span> ：排除所有旧的，不安全的或匿名密码套件：</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>  &lt;!-- Eliminate Old / Insecure / Anonymous Ciphers --&gt;
  &lt;Call name="addExcludeCipherSuites"&gt;
    &lt;Arg&gt;
      &lt;Array type="String"&gt;
        &lt;Item&gt;.*NULL.*&lt;/Item&gt;
        &lt;Item&gt;.*RC4.*&lt;/Item&gt;
        &lt;Item&gt;.*MD5.*&lt;/Item&gt;
        &lt;Item&gt;.*DES.*&lt;/Item&gt;
        &lt;Item&gt;.*DSS.*&lt;/Item&gt;
      &lt;/Array&gt;
    &lt;/Arg&gt;
  &lt;/Call&gt;</code></pre><p><span class="strong"><strong>示例</strong></span> ：自2014年以来，SSLv3被认为是不安全的，应禁用。</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>  &lt;!-- Eliminate Insecure Protocols --&gt;
  &lt;Call name="addExcludeProtocols"&gt;
    &lt;Arg&gt;
     &lt;Array type="java.lang.String"&gt;
       &lt;Item&gt;SSL&lt;/Item&gt;
       &lt;Item&gt;SSLv2&lt;/Item&gt;
       &lt;Item&gt;SSLv2Hello&lt;/Item&gt;
       &lt;Item&gt;SSLv3&lt;/Item&gt;
     &lt;/Array&gt;
    &lt;/Arg&gt;
  &lt;/Call&gt;</code></pre><div class="blockquote"><blockquote class="blockquote"><div class="note" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" style="margin-left:0.5in;margin-right:0.5in"><h3 class="title"><i class="fa fa-asterisk" aria-hidden="true"></i>注意</h3><p>请注意，禁用SSLv3会阻止非常老的浏览器（例如Windows XP上的Internet Explorer 6）连接。</p></div></blockquote></div><p><span class="strong"><strong>示例</strong></span> ：也可以禁用TLS重新协商，以防止基于此功能的攻击。</p><pre xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><code>  &lt;Set name="renegotiationAllowed"&gt;FALSE&lt;/Set&gt;</code></pre><p><a name="ssl-dump-ciphers"></a>您可以通过执行服务器转储查看启用和禁用的密码套件。</p><p>要在服务器启动时执行服务器转储，请添加<code class="literal">jetty.server.dumpAfterStart=true</code>启动服务器时转到命令行。您还可以在关闭服务器实例时通过添加以下命令来转储服务器<code class="literal">jetty.server.dumpBeforeStop</code> 。</p><p>具体来说，您将需要寻找<code class="literal">SslConnectionFactory</code>转储的一部分。</p><div class="screenexample"><pre class="screen">[my-base]$ java -jar ${JETTY_HOME}/start.jar jetty.server.dumpAfterStart=true

...
|   += SslConnectionFactory@18be83e4{SSL-&gt;http/1.1} - STARTED
|   |   += SslContextFactory@42530531(null,null) trustAll=false
|   |       +- Protocol Selections
|   |       |   +- Enabled (size=3)
|   |       |   |   +- TLSv1
|   |       |   |   +- TLSv1.1
|   |       |   |   +- TLSv1.2
|   |       |   +- Disabled (size=2)
|   |       |       +- SSLv2Hello - ConfigExcluded:'SSLv2Hello'
|   |       |       +- SSLv3 - JreDisabled:java.security, ConfigExcluded:'SSLv3'
|   |       +- Cipher Suite Selections
|   |           +- Enabled (size=15)
|   |           |   +- TLS_DHE_DSS_WITH_AES_128_CBC_SHA256
|   |           |   +- TLS_DHE_DSS_WITH_AES_128_GCM_SHA256
|   |           |   +- TLS_DHE_RSA_WITH_AES_128_CBC_SHA256
|   |           |   +- TLS_DHE_RSA_WITH_AES_128_GCM_SHA256
|   |           |   +- TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
|   |           |   +- TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
|   |           |   +- TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256
|   |           |   +- TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
|   |           |   +- TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256
|   |           |   +- TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256
|   |           |   +- TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256
|   |           |   +- TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256
|   |           |   +- TLS_EMPTY_RENEGOTIATION_INFO_SCSV
|   |           |   +- TLS_RSA_WITH_AES_128_CBC_SHA256
|   |           |   +- TLS_RSA_WITH_AES_128_GCM_SHA256
|   |           +- Disabled (size=42)
|   |               +- SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA - ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- SSL_DHE_DSS_WITH_DES_CBC_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA - ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- SSL_DHE_RSA_WITH_DES_CBC_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- SSL_DH_anon_WITH_3DES_EDE_CBC_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- SSL_DH_anon_WITH_DES_CBC_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- SSL_RSA_EXPORT_WITH_DES40_CBC_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- SSL_RSA_WITH_3DES_EDE_CBC_SHA - ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- SSL_RSA_WITH_DES_CBC_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- SSL_RSA_WITH_NULL_MD5 - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- SSL_RSA_WITH_NULL_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_DHE_DSS_WITH_AES_128_CBC_SHA - ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_DHE_RSA_WITH_AES_128_CBC_SHA - ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_DH_anon_WITH_AES_128_CBC_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_DH_anon_WITH_AES_128_CBC_SHA256 - JreDisabled:java.security
|   |               +- TLS_DH_anon_WITH_AES_128_GCM_SHA256 - JreDisabled:java.security
|   |               +- TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA - ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA - ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_ECDHE_ECDSA_WITH_NULL_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA - ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA - ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_ECDHE_RSA_WITH_NULL_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA - ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA - ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_ECDH_ECDSA_WITH_NULL_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA - ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_ECDH_RSA_WITH_AES_128_CBC_SHA - ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_ECDH_RSA_WITH_NULL_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_ECDH_anon_WITH_AES_128_CBC_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_ECDH_anon_WITH_NULL_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5 - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_KRB5_WITH_3DES_EDE_CBC_MD5 - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_KRB5_WITH_3DES_EDE_CBC_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_KRB5_WITH_DES_CBC_MD5 - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_KRB5_WITH_DES_CBC_SHA - JreDisabled:java.security, ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_RSA_WITH_AES_128_CBC_SHA - ConfigExcluded:'^.*_(MD5|SHA|SHA1)$'
|   |               +- TLS_RSA_WITH_NULL_SHA256 - JreDisabled:java.security
...</pre></div><p>在上面的示例中，您可以同时看到已启用/已禁用的协议以及包含/排除的密码套件。对于禁用或排除的协议和密码，给出了禁用它们的原因-是由于JVM限制，配置或两者兼而有之。提醒一下，配置包含/排除项时， <span class="strong"><strong>排除项始终为win</strong></span> 。</p><p>可以将转储配置为<code class="literal">jetty.xml</code>服务器的配置。请参阅<a class="link" href="jetty-dump-tool.html" title="Jetty卸货工具">Jetty Dump Tool</a>上的文档以获取更多信息。</p></div></div><script type="text/javascript">
      SyntaxHighlighter.all()
    </script><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tbody><tr><td width="40%" align="left"><a href="configuring-connectors.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><td width="20%" align="center"><a href="configuring-connectors.html" accesskey="u"><i class="fa fa-chevron-up" aria-hidden="true"></i>最佳</a></td><td width="40%" align="right"> <a href="jetty-ssl-distribution.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr><tr><td width="40%" align="left" valign="top">第六章配置Jetty连接器</td><td width="20%" align="center"><a href="index.html" accesskey="h"><i class="fa fa-home" aria-hidden="true"></i>家</a></td><td width="40%" align="right" valign="top">Jetty配送中的SSL</td></tr></tbody></table></div><p xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"></p><div class="jetty-callout">看到错误或缺少的东西？
            <span class="callout"><a href="http://github.com/eclipse/jetty.project">在以下位置对此文档做出贡献<span class="website"><i class="fa fa-github" aria-hidden="true"></i> Github！</span></a></span> <span style="float:right"><i>（产生：2019-11-20）</i></span></div><p></p></body></html>