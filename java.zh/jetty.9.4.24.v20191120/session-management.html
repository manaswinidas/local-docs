<html ><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>第十章会话管理</title><link rel="stylesheet" type="text/css" href="css/docbook.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="keywords" content="jetty, servlet, servlet-api, cometd, http, websocket, eclipse, maven, java, server, software"><link rel="home" href="index.html" title="Jetty"><link rel="up" href="jetty-admin-guide.html" title="Part III. Jetty Administration Guide"><link rel="prev" href="startup-jpms.html" title="Startup using the Java Platform Module System (JPMS)"><link rel="next" href="sessions-details.html" title="Session Components"><link rel="shortcut icon" href="images/favicon.ico" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><link rel="stylesheet" href="css/highlighter/foundation.css"><script src="js/highlight.pack.js"></script><script>
      hljs.initHighlightingOnLoad();
    </script><link type="text/css" rel="stylesheet" href="css/font-awesome/font-awesome.min.css"></head><body bgcolor="white"  text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><tbody><tr><td style="width:25%"><a href="http://www.eclipse.org/jetty"><img src="images/jetty-header-logo.png" alt="Jetty标志"></a><br><span style="font-size:small">版本：9.4.24.v20191120</span></td><td style="width:50%"></td></tr></tbody></table><div class="navheader" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><table width="100%" summary="Navigation header"><tbody><tr><th colspan="3" align="center">第十章会话管理</th></tr><tr><td width="20%" align="left"><a href="startup-jpms.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><th width="60%" align="center">第三部分Jetty管理指南<br><a href="index.html" accesskey="p"><i class="fa fa-home" aria-hidden="true"></i>家</a></th><td width="20%" align="right"> <a href="sessions-details.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr></tbody></table><hr></div><div class="jetty-callout" xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><h5 class="callout"><a href="http://www.webtide.com/">通过<span class="website">www.webtide.com</span>与Jetty核心开发人员联系。</a></h5><p>内部/客户项目的私人支持...自定义扩展和发行版...无限期支持的版本快照...您的应用程序和Ajax / Comet项目的可伸缩性指南...赞助功能开发的开发服务</p></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="session-management"></a>第十章会话管理</h2></div></div></div><div class="toc"><p><b>目录</b></p><dl class="toc"><dt><span class="section"><a href="session-management.html#jetty-sessions-architecture">会话架构</a></span></dt><dt><span class="section"><a href="sessions-details.html">会话组件</a></span></dt><dt><span class="section"><a href="session-configuration-housekeeper.html">SessionIdManager和管家</a></span></dt><dt><span class="section"><a href="session-configuration-sessioncache.html">L1会话缓存</a></span></dt><dt><span class="section"><a href="configuring-sessions-memory.html">非永久性会议</a></span></dt><dt><span class="section"><a href="configuring-sessions-file-system.html">持久会话：文件系统</a></span></dt><dt><span class="section"><a href="configuring-sessions-jdbc.html">持久会话：JDBC</a></span></dt><dt><span class="section"><a href="configuring-sessions-mongo.html">持久会话：MongoDB</a></span></dt><dt><span class="section"><a href="configuring-sessions-infinispan.html">持久会话：Inifinspan</a></span></dt><dt><span class="section"><a href="configuring-sessions-hazelcast.html">持续会议：Hazelcast</a></span></dt><dt><span class="section"><a href="configuring-sessions-gcloud.html">持久会话：Google Cloud DataStore</a></span></dt><dt><span class="section"><a href="session-configuration-memcachedsessiondatastore.html">持久会话：L2会话数据缓存</a></span></dt><dt><span class="section"><a href="sessions-usecases.html">会话用例</a></span></dt></dl></div><p>会话是Servlet api中的一个概念，它允许请求跨用户在应用程序中花费的时间来存储和检索信息。对于每个应用程序来说，选择正确的会话管理器实现都是重要的考虑因素，因为每个应用程序都可以在不同情况下适应并以最佳状态运行。如果您需要一个可以持久保存到磁盘的简单的内存中会话管理器，那么使用本地文件系统进行会话管理可能是一个不错的起点。如果您需要一个可以在具有多个Jetty实例的集群方案中工作的会话管理器，那么JDBC会话管理器将是一个很好的选择。Jetty还提供了更多利基的会话管理器，它们利用了MongoDB，Inifinispan甚至Google的Cloud Data Store等后端。</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear:both"><a name="jetty-sessions-architecture"></a>会话架构</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="session-management.html#_changes_in_session_architecture">会话架构的变化</a></span></dt><dt><span class="section"><a href="session-management.html#_session_architecture_hierarchy">会话架构层次结构</a></span></dt><dt><span class="section"><a href="session-management.html#_configuring_sessions_in_the_jetty_distribution">在Jetty发行版中配置会话</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_changes_in_session_architecture"></a>会话架构的变化</h3></div></div></div><p>会话管理Jetty的体系结构在Jetty 9.4中发生了重大变化。这些更改使Sessions不仅更易于配置，而且使它们对于各种技术的可插拔性更高。</p><p>在早期版本的Jetty中，要求用户配置单独的<code class="literal">SessionIdManager</code>适用于正在实施的每种会话群集技术（JDBC，MongoDB等）。在Jetty 9.4中，现在只有一个<code class="literal">SessionIdManager</code>适用于所有类型的会话群集技术的实现。同样，在Jetty 9.4之前，有几种不同的实例<code class="literal">SessionManager</code>类。而不是一个<code class="literal">SessionManager</code>不过，它已完全被淘汰，大部分功能已移至<code class="literal">SesssionHandler</code>类。此外，Jetty 9.4引入了<code class="literal">SessionCache</code>和一个相关的<code class="literal">SessionDataStore</code> （均在下面说明）。</p><p>最后，会话清理已重新进行。以前每个<code class="literal">SessionManager</code>实例会定期扫描内存（或群集）会话中是否有过期的会话，现在有一个通用的清除线程来指示<code class="literal">SessionHandler</code>清理过期的会话。会话过期已更改为使用更加高效的基于计时器的机制，该机制可避免清除剂对内存中的所有当前会话进行恒定迭代。</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_session_architecture_hierarchy"></a>会话架构层次结构</h3></div></div></div><p>每个Jetty实例都有一个单数<code class="literal">SessionIdManager</code>处理所有会话请求，而不考虑群集技术。对于服务器上的每个上下文，都有一个（1） <code class="literal">SessionCache</code>其中包含给定上下文的所有Session对象。的好处<code class="literal">SessionCache</code>这是为了确保在同一上下文中访问同一会话ID的同时请求始终在同一Session对象上运行。Jetty发行版随附的SessionCache实现就是这样做的：将Session对象保留在内存中，以便可以在同时进行的请求之间共享它们。但是，可以提供您自己的实现，如果您需要的话，它绝不会共享Session对象。</p><p>哪里<code class="literal">SessionCache</code>处理会话信息，会话数据存储在<code class="literal">SessionDataStore</code>特定于正在实施的群集技术。只有一（1） <code class="literal">SessionDataStore</code>每<code class="literal">SessionCache</code> 。</p><p>在视觉上，会话架构可以这样表示：</p><div class="informalfigure"><div class="mediaobject"><img src="images/SessionsHierarchy.png" alt="会议层次"></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_configuring_sessions_in_the_jetty_distribution"></a>在Jetty发行版中配置会话</h3></div></div></div><p>配置会话管理包括选择<a class="link" href="startup-modules.html" title="管理启动模块">模块</a>用于所需类型的<a class="link" href="session-configuration-sessioncache.html" title="L1会话缓存">会话缓存</a>行为，以及用于会话持久性的类型的模块。</p><p>Jetty提供了两种不同的会话缓存： <code class="literal">DefaultSessionCache</code>将会话保存在内存中， <code class="literal">NullSessionCache</code>哪个没有。有关这两种类型的会话缓存以及可能导致您在“ <a class="link" href="sessions-details.html" title="会话组件">会话组件”</a>部分中选择一个或多个情况的详细信息，而在<a class="link" href="session-configuration-sessioncache.html" title="The L1 Session Cache">“ L1会话缓存”</a>部分中提供<a class="link" href="session-configuration-sessioncache.html" title="L1会话缓存">了</a>有关每种配置选项的更多信息。</p><p>对于会话持久性，Jetty提供了许多不同的实现方式供您选择，包括<a class="link" href="configuring-sessions-memory.html" title="非永久性会议">非持久性</a> ， <a class="link" href="configuring-sessions-file-system.html" title="持久会话：文件系统">本地文件存储</a> ，集群技术（如<a class="link" href="configuring-sessions-jdbc.html" title="持久会话：JDBC">JDBC</a> ， <a class="link" href="configuring-sessions-mongo.html" title="持久会话：MongoDB">MongoDB</a> ， <a class="link" href="configuring-sessions-infinispan.html" title="持久会话：Inifinspan">Inifinispan</a> ， <a class="link" href="configuring-sessions-gcloud.html" title="持久会话：Google Cloud DataStore">Google Cloud Datastore</a>和<a class="link" href="configuring-sessions-hazelcast.html" title="持续会议：Hazelcast">Hazelcast）</a> 。</p><p>根据您的持久性技术，为提高性能，您可能需要对会话数据使用L2缓存，在这种情况下，Jetty提供了<a class="link" href="session-configuration-memcachedsessiondatastore.html" title="持久会话：L2会话数据缓存">内存缓存的L2会话数据缓存</a> 。</p></div></div></div><script type="text/javascript">
      SyntaxHighlighter.all()
    </script><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tbody><tr><td width="40%" align="left"><a href="startup-jpms.html" accesskey="p"><i class="fa fa-chevron-left" aria-hidden="true"></i>以前</a> </td><td width="20%" align="center"><a href="jetty-admin-guide.html" accesskey="u"><i class="fa fa-chevron-up" aria-hidden="true"></i>最佳</a></td><td width="40%" align="right"> <a href="sessions-details.html" accesskey="n">下一个<i class="fa fa-chevron-right" aria-hidden="true"></i></a></td></tr><tr><td width="40%" align="left" valign="top">使用Java平台模块系统（JPMS）启动</td><td width="20%" align="center"><a href="index.html" accesskey="h"><i class="fa fa-home" aria-hidden="true"></i>家</a></td><td width="40%" align="right" valign="top">会话组件</td></tr></tbody></table></div><p xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"></p><div class="jetty-callout">看到错误或缺少的东西？
            <span class="callout"><a href="http://github.com/eclipse/jetty.project">在以下位置对此文档做出贡献<span class="website"><i class="fa fa-github" aria-hidden="true"></i> Github！</span></a></span> <span style="float:right"><i>（产生：2019-11-20）</i></span></div><p></p></body></html>