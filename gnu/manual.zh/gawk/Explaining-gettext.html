<html ><!-- 
Copyright (C) 1989, 1991, 1992, 1993, 1996-2005, 2007, 2009-2019 

Free Software Foundation, Inc.



This is Edition 5.0 of GAWK: Effective AWK Programming: A User's Guide for GNU Awk,
for the 5.0.0 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License", with the
Front-Cover Texts being "A GNU Manual", and with the Back-Cover Texts
as in (a) below.
A copy of the license is included in the section entitled
"GNU Free Documentation License".

a. The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual." --><!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>解释gettext（《 GNU Awk用户指南》）</title>

<meta name="description" content="Explaining gettext (The GNU Awk User’s Guide)">
<meta name="keywords" content="Explaining gettext (The GNU Awk User’s Guide)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Internationalization.html#Internationalization" rel="up" title="Internationalization">
<link href="Programmer-i18n.html#Programmer-i18n" rel="next" title="Programmer i18n">
<link href="I18N-and-L10N.html#I18N-and-L10N" rel="prev" title="I18N and L10N">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="manual.css">


</head>

<body lang="zh-Hans" >
<a name="Explaining-gettext"></a>
<div class="header">
<p>下一篇： <a href="Programmer-i18n.html#Programmer-i18n" rel="next" accesskey="n">程序员i18n</a> ，上一篇： <a href="I18N-and-L10N.html#I18N-and-L10N" rel="prev" accesskey="p">I18N和L10N</a> ，上一篇： <a href="Internationalization.html#Internationalization" rel="up" accesskey="u">国际化</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<a name="GNU-gettext"></a>
<h3 class="section">13.2 GNU<code>gettext</code></h3>

<a name="index-internationalizing-a-program"></a>
<a name="index-gettext-library"></a>
<p><code>gawk</code>使用GNU <code>gettext</code>提供其国际化功能。GNU中的设施<code>gettext</code>专注于消息：程序直接或通过使用以下命令格式化打印的字符串<code>printf</code>要么<code>sprintf()</code> 。 <a name="DOCF88" href="#FOOT88"><sup>88</sup></a>
</p>
<a name="index-portability_002c-gettext-library-and"></a>
<p>使用GNU时<code>gettext</code> ，每个应用程序都有其自己的<em>文本域</em> 。这是一个唯一名称，例如“ <samp>kpilot</samp> ' 要么 ' <samp>gawk</samp> '，用于标识应用程序。一个完整的应用程序可能包含多个组件，这些组件是用C或C ++编写的程序以及用<code>sh</code>要么<code>awk</code> 。所有组件都使用相同的文本域。
</p>
<p>为了使讨论更加具体，假设我们正在编写一个名为<code>guide</code> 。国际化按以下顺序包括以下步骤：</p>
<ol>
<li>程序员检查所有<code>guide</code>的组成部分，并标记每个要翻译的字符串。例如， <code>"`-F': option required"</code>是翻译的好人选。带有选项名称字符串的表不是（例如， <code>gawk</code>的<samp>--profile</samp>选项，无论使用哪种本地语言，都应保持不变。

</li><li> <a name="index-textdomain_0028_0029-function-_0028C-library_0029"></a>程序员指出应用程序的文本域（ <code>"guide"</code> ）到<code>gettext</code>库，方法是调用<code>textdomain()</code>功能。

</li><li> <a name="index-_002epot-files"></a><a name="index-files_002c-_002epot"></a><a name="index-portable-object-template-files"></a><a name="index-files_002c-portable-object-template"></a>来自应用程序的消息将从源代码中提取，并收集到可移植对象模板文件中（ <samp>guide.pot</samp> ），其中列出了字符串及其翻译。最初的翻译是空的。原始消息（通常是英语）是查找翻译的关键。

</li><li> <a name="index-_002epo-files"></a><a name="index-files_002c-_002epo"></a><a name="index-portable-object-files"></a><a name="index-files_002c-portable-object"></a>对于有翻译的每种语言， <samp>guide.pot</samp>复制到便携式目标文件（ <code>.po</code> ），然后创建翻译并随应用程序一起提供。例如，可能有一个<samp>fr.po</samp>进行法语翻译。

</li><li> <a name="index-_002egmo-files"></a><a name="index-files_002c-_002egmo"></a><a name="index-message-object-files"></a><a name="index-files_002c-message-object"></a>每种语言的<samp>.po</samp>文件转换为二进制消息对象（ <samp>.gmo</samp> ）文件。消息对象文件以二进制格式包含原始消息及其翻译，从而可以在运行时快速查找翻译。

</li><li>什么时候<code>guide</code>如果已构建并安装了二进制翻译文件，则将其安装在标准位置。

</li><li> <a name="index-bindtextdomain_0028_0029-function-_0028C-library_0029"></a>对于测试和开发，可以告诉<code>gettext</code>使用<samp>.gmo</samp>通过使用<code>bindtextdomain()</code>功能。

</li><li> <a name="index-_002egmo-files_002c-specifying-directory-of"></a><a name="index-files_002c-_002egmo_002c-specifying-directory-of"></a><a name="index-message-object-files_002c-specifying-directory-of"></a><a name="index-files_002c-message-object_002c-specifying-directory-of"></a>在运行时， <code>guide</code>通过调用来查找每个字符串<code>gettext()</code> 。返回的字符串（如果可用）是转换后的字符串，如果没有则返回原始字符串。

</li><li>如有必要，可以从与应用程序不同的文本域访问消息，而不必来回切换应用程序的默认文本域。
</li></ol>

<a name="index-gettext_0028_0029-function-_0028C-library_0029"></a>
<p>在C（或C ++）中，字符串标记和动态翻译查找是通过将每个字符串包装在对<code>gettext()</code> ：</p>
<div class="example">
<pre class="example">printf(&quot;%s&quot;, gettext(&quot;Don't Panic!\n&quot;));
</pre></div>

<p>从源代码提取消息的工具会提取对的调用中包含的所有字符串<code>gettext()</code> 。
</p>
<a name="index-_005f-_0028underscore_0029_002c-C-macro"></a>
<a name="index-underscore-_0028_005f_0029_002c-C-macro"></a>
<p>GNU <code>gettext</code>开发人员，他们意识到键入“ <samp>gettext(…)</samp> “一遍又一遍既痛苦又丑陋，使用宏” <samp>_</samp> '（下划线）可以使事情变得简单：</p>
<div class="example">
<pre class="example">/* In the standard header file: */
#define _(str) gettext(str)

/* In the program text: */
printf(&quot;%s&quot;, _(&quot;Don't Panic!\n&quot;));
</pre></div>

<a name="index-internationalization_002c-localization_002c-locale-categories"></a>
<a name="index-gettext-library_002c-locale-categories"></a>
<a name="index-locale-categories"></a>
<p>这样可以将键入的开销减少到每个字符串仅三个额外的字符，并且也很容易阅读。
</p>
<p>对于不同类型的与语言环境相关的信息，存在语言环境<em>类别</em> 。定义的语言环境类别<code>gettext</code>知道的是：</p>
<dl compact>
<dd><a name="index-LC_005fMESSAGES-locale-category"></a>
</dd>
<dt><code>LC_MESSAGES</code></dt>
<dd><p>短信。这是默认的类别<code>gettext</code>操作，但如有必要，可以显式提供另一种操作。（几乎从来没有必要提供其他类别。）
</p>
<a name="index-sorting-characters-in-different-languages"></a>
<a name="index-LC_005fCOLLATE-locale-category"></a>
</dd>
<dt><code>LC_COLLATE</code></dt>
<dd><p>文本归类信息（即，不同字符和/或字符组如何以给定语言排序）。
</p>
<a name="index-LC_005fCTYPE-locale-category"></a>
</dd>
<dt><code>LC_CTYPE</code></dt>
<dd><p>字符类型信息（字母，数字，大写或小写等）以及字符编码。可通过正则表达式中的POSIX字符类访问此信息，例如<code>/[[:alnum:]]/</code> （请参阅<a href="Bracket-Expressions.html#Bracket-Expressions">使用括号表达式</a>部分）。
</p>
<a name="index-monetary-information_002c-localization"></a>
<a name="index-currency-symbols_002c-localization"></a>
<a name="index-LC_005fMONETARY-locale-category"></a>
</dd>
<dt><code>LC_MONETARY</code></dt>
<dd><p>货币信息，例如货币符号，以及该符号在数字之前还是之后。
</p>
<a name="index-LC_005fNUMERIC-locale-category"></a>
</dd>
<dt><code>LC_NUMERIC</code></dt>
<dd><p>数字信息，例如用于小数点和千位分隔符的字符。 <a name="DOCF89" href="#FOOT89"><sup>89</sup></a>
</p>
<a name="index-time_002c-localization-and"></a>
<a name="index-dates_002c-information-related-to_002c-localization"></a>
<a name="index-LC_005fTIME-locale-category"></a>
</dd>
<dt><code>LC_TIME</code></dt>
<dd><p>与时间和日期有关的信息，例如12或24小时制，日期中一天之前或之后打印的月份，本地月份的缩写等等。
</p>
<a name="index-LC_005fALL-locale-category"></a>
</dd>
<dt><code>LC_ALL</code></dt>
<dd><p>上述所有的。（在以下情况下不太有用） <code>gettext</code> ）
</p></dd>
</dl>

<blockquote>
<a name="index-LANGUAGE-environment-variable"></a>
<p><b>注意：</b>如<a href="Locales.html#Locales">“您</a>在<a href="Locales.html#Locales">哪里与众不同”中所述</a> ，与区域设置类别同名的环境变量（ <code>LC_CTYPE</code> ， <code>LC_ALL</code>等）影响<code>gawk</code>的行为（以及其他实用程序的行为）。
</p>
<p>通常，这些变量还会影响<code>gettext</code>图书馆查找翻译。然而<code>LANGUAGE</code>环境变量覆盖<code>LC_<var>xxx</var></code>变量。许多GNU / Linux系统可能会在您不知情的情况下定义此变量，从而导致<code>gawk</code>找不到正确的翻译。如果您遇到这种情况，请查看是否<code>LANGUAGE</code>是定义的，如果是，则使用外壳的<code>unset</code>命令将其删除。
</p></blockquote>

<p>用于测试的翻译<code>gawk</code>本身，您可以设置<code>GAWK_LOCALE_DIR</code>环境变量。请参阅C的文档<code>bindtextdomain()</code>函数并参见<a href="Other-Environment-Variables.html#Other-Environment-Variables">其他环境变量</a> 。
</p>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">脚注</h4>

<h3><a name="FOOT88" href="#DOCF88">（88）</a></h3>
<p>对于某些操作系统， <code>gawk</code>端口不支持GNU <code>gettext</code> 。因此，如果您使用的是这些操作系统之一，则这些功能将不可用。抱歉。</p>
<h3><a name="FOOT89" href="#DOCF89">（89）</a></h3>
<p>美国人每三个小数点使用一个逗号，小数点用一个句点，而许多欧洲人则恰好相反：1,234.56与1.234,56。</p>
</div>
<hr>
<div class="header">
<p>下一篇： <a href="Programmer-i18n.html#Programmer-i18n" rel="next" accesskey="n">程序员i18n</a> ，上一篇： <a href="I18N-and-L10N.html#I18N-and-L10N" rel="prev" accesskey="p">I18N和L10N</a> ，上一篇： <a href="Internationalization.html#Internationalization" rel="up" accesskey="u">国际化</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>