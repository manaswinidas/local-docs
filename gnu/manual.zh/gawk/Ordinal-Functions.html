<html ><!-- 
Copyright (C) 1989, 1991, 1992, 1993, 1996-2005, 2007, 2009-2019 

Free Software Foundation, Inc.



This is Edition 5.0 of GAWK: Effective AWK Programming: A User's Guide for GNU Awk,
for the 5.0.0 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License", with the
Front-Cover Texts being "A GNU Manual", and with the Back-Cover Texts
as in (a) below.
A copy of the license is included in the section entitled
"GNU Free Documentation License".

a. The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual." --><!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>序数函数（《 GNU Awk用户指南》）</title>

<meta name="description" content="Ordinal Functions (The GNU Awk User’s Guide)">
<meta name="keywords" content="Ordinal Functions (The GNU Awk User’s Guide)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="General-Functions.html#General-Functions" rel="up" title="General Functions">
<link href="Join-Function.html#Join-Function" rel="next" title="Join Function">
<link href="Cliff-Random-Function.html#Cliff-Random-Function" rel="prev" title="Cliff Random Function">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="/software/gnulib/manual.css">


</head>

<body lang="zh-Hans" >
<a name="Ordinal-Functions"></a>
<div class="header">
<p>下一篇： <a href="Join-Function.html#Join-Function" rel="next" accesskey="n">联接函数</a> ，上一篇： <a href="Cliff-Random-Function.html#Cliff-Random-Function" rel="prev" accesskey="p">悬崖随机函数</a> ，上一篇： <a href="General-Functions.html#General-Functions" rel="up" accesskey="u">通用函数</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<a name="Translating-Between-Characters-and-Numbers"></a>
<h4 class="subsection">10.2.5字符与数字之间的转换</h4>

<a name="index-libraries-of-awk-functions_002c-character-values-as-numbers"></a>
<a name="index-functions_002c-library_002c-character-values-as-numbers"></a>
<a name="index-characters_002c-values-of-as-numbers"></a>
<a name="index-numbers_002c-as-values-of-characters"></a>
<p>一种商业实现<code>awk</code>提供内置功能<code>ord()</code> ，它接受一个字符并返回机器字符集中该字符的数值。如果字符串传递给<code>ord()</code>具有多个字符，仅使用第一个字符。
</p>
<p>此函数的反函数是<code>chr()</code> （来自Pascal中同名的函数），该函数接受一个数字并返回相应的字符。这两个函数都很好地写在<code>awk</code> ;没有真正的理由将它们构建到<code>awk</code>口译员：</p>
<a name="index-ord_0028_0029-user_002ddefined-function"></a>
<a name="index-chr_0028_0029-user_002ddefined-function"></a>
<a name="index-_005ford_005finit_0028_0029-user_002ddefined-function"></a>
<div class="example">
<pre class="example"># ord.awk --- do ord and chr

# Global identifiers:
#    _ord_:        numerical values indexed by characters
#    _ord_init:    function to initialize _ord_

BEGIN    { _ord_init() }

function _ord_init(    low, high, i, t)
{
    low = sprintf(&quot;%c&quot;, 7) # BEL is ascii 7
    if (low == &quot;\a&quot;) {    # regular ascii
        low = 0
        high = 127
    } else if (sprintf(&quot;%c&quot;, 128 + 7) == &quot;\a&quot;) {
        # ascii, mark parity
        low = 128
        high = 255
    } else {        # ebcdic(!)
        low = 0
        high = 255
    }

    for (i = low; i &lt;= high; i++) {
        t = sprintf(&quot;%c&quot;, i)
        _ord_[t] = i
    }
}
</pre></div>

<a name="index-character-sets-_0028machine-character-encodings_0029"></a>
<a name="index-ASCII"></a>
<a name="index-EBCDIC"></a>
<a name="index-Unicode"></a>
<a name="index-mark-parity"></a>
<p>有关使用的数字的一些解释<code>_ord_init()</code>是值得的。今天使用的最突出的字符集是ASCII。 <a name="DOCF68" href="#FOOT68"><sup>68</sup></a>尽管8位字节可以容纳256个不同的值（从0到255），但是ASCII仅定义使用从0到127的值的字符<a name="DOCF69" href="#FOOT69"><sup>。69</sup></a>在当今遥远的过去，至少有一家小型计算机制造商使用ASCII，但带有标记奇偶校验，表示字节的最左位始终为1。这意味着在这些系统上，字符的数字值为128到255。最后，大型主机系统使用EBCDIC字符集，该字符集使用所有256个值。在某些较旧的系统上，还有其他字符集正在使用中，但是它们确实不值得担心：</p>
<div class="example">
<pre class="example">function ord(str,    c)
{
    # only first character is of interest
    c = substr(str, 1, 1)
    return _ord_[c]
}

function chr(c)
{
    # force c to be numeric by adding 0
    return sprintf(&quot;%c&quot;, c + 0)
}

#### test code ####
# BEGIN {
#    for (;;) {
#        printf(&quot;enter a character: &quot;)
#        if (getline var &lt;= 0)
#            break
#        printf(&quot;ord(%s) = %d\n&quot;, var, ord(var))
#    }
# }
</pre></div>

<p>这些功能的一个明显改进是将<code><span class="nolinebreak">_ord_init</span>
<!-- /@w --></code>功能进入身体<code>BEGIN</code>规则。最初以这种方式编写它是为了易于开发。有一个“测试程序” <code>BEGIN</code>规则，以测试功能。已注释掉以供生产使用。
</p>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">脚注</h4>

<h3><a name="FOOT68" href="#DOCF68">（68）</a></h3>
<p>这正在改变；许多系统使用Unicode，这是一个非常大的字符集，其中包含ASCII作为子集。在完全支持Unicode的系统上，一个字符最多可以占用32位，从而使得简单的测试（如此处使用的测试）非常昂贵。</p>
<h3><a name="FOOT69" href="#DOCF69">（69）</a></h3>
<p>ASCII在许多国家/地区已得到扩展，可以将128到255的值用于特定国家/地区的字符。如果您的系统使用这些扩展名，则可以简化<code>_ord_init()</code>从0到255循环播放。</p>
</div>
<hr>
<div class="header">
<p>下一篇： <a href="Join-Function.html#Join-Function" rel="next" accesskey="n">联接函数</a> ，上一篇： <a href="Cliff-Random-Function.html#Cliff-Random-Function" rel="prev" accesskey="p">悬崖随机函数</a> ，上一篇： <a href="General-Functions.html#General-Functions" rel="up" accesskey="u">通用函数</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>