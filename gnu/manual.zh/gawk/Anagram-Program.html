<html ><!-- 
Copyright (C) 1989, 1991, 1992, 1993, 1996-2005, 2007, 2009-2019 

Free Software Foundation, Inc.



This is Edition 5.0 of GAWK: Effective AWK Programming: A User's Guide for GNU Awk,
for the 5.0.0 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License", with the
Front-Cover Texts being "A GNU Manual", and with the Back-Cover Texts
as in (a) below.
A copy of the license is included in the section entitled
"GNU Free Documentation License".

a. The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual." --><!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Anagram程序（《 GNU Awk用户指南》）</title>

<meta name="description" content="Anagram Program (The GNU Awk User’s Guide)">
<meta name="keywords" content="Anagram Program (The GNU Awk User’s Guide)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Miscellaneous-Programs.html#Miscellaneous-Programs" rel="up" title="Miscellaneous Programs">
<link href="Signature-Program.html#Signature-Program" rel="next" title="Signature Program">
<link href="Igawk-Program.html#Igawk-Program" rel="prev" title="Igawk Program">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="manual.css">


</head>

<body lang="zh-Hans" >
<a name="Anagram-Program"></a>
<div class="header">
<p>下一个： <a href="Signature-Program.html#Signature-Program" rel="next" accesskey="n">签名程序</a> ，上一个： <a href="Igawk-Program.html#Igawk-Program" rel="prev" accesskey="p">Igawk程序</a> ，上： <a href="Miscellaneous-Programs.html#Miscellaneous-Programs" rel="up" accesskey="u">其他程序</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<a name="Finding-Anagrams-from-a-Dictionary"></a>
<h4 class="subsection">11.3.10从字典中查找字词</h4>

<a name="index-anagrams_002c-finding"></a>
<p>一个有趣的编程挑战是在单词列表中搜索<em>字谜</em> （例如<samp>/usr/share/dict/words</samp>在许多GNU / Linux系统上）。如果两个单词都包含相同的字母（例如“冒泡”和“冒泡”），则该单词为另一个词的变位字。
</p>
<p>乔恩·本特利（Jon Bentley）的《 <cite>编程珍珠》</cite> （ <cite>Programming Pearls）</cite> ，第二版，问题C，第2列提出了一种优雅的算法。这样做的想法是给字谜词提供一个共同的签名，将所有单词按其签名排序，然后打印出来。本特利博士观察到，将每个单词中的字母都排序并排序会产生这些共同的签名。
</p>
<p>以下程序使用数组数组将具有相同签名和单词排序的单词组合在一起，以按排序顺序打印单词：</p>
<a name="index-anagram_002eawk-program"></a>
<div class="example">
<pre class="example"># anagram.awk --- An implementation of the anagram-finding algorithm
#                 from Jon Bentley's &quot;Programming Pearls,&quot; 2nd edition.
#                 Addison Wesley, 2000, ISBN 0-201-65788-0.
#                 Column 2, Problem C, section 2.8, pp 18-20.

/'s$/   { next }        # Skip possessives
</pre></div>

<p>该程序从头开始，然后是跳过字典文件中所有格的规则。下一条规则将建立数据结构。数组的第一维由签名索引；第二个维度是单词本身：</p>
<div class="example">
<pre class="example">{
    key = word2key($1)  # Build signature
    data[key][$1] = $1  # Store word with signature
}
</pre></div>

<p>的<code>word2key()</code>函数创建签名。它将单词拆分成单个字母，对字母进行排序，然后将它们重新组合在一起：</p>
<div class="example">
<pre class="example"># word2key --- split word apart into letters, sort, and join back together

function word2key(word,     a, i, n, result)
{
    n = split(word, a, &quot;&quot;)
    asort(a)

    for (i = 1; i &lt;= n; i++)
        result = result a[i]

    return result
}
</pre></div>

<p>最后， <code>END</code>规则遍历数组并打印出字谜列表。它将输出发送到系统<code>sort</code>命令，因为否则字谜将以任意顺序出现：</p>
<div class="example">
<pre class="example">END {
    sort = &quot;sort&quot;
    for (key in data) {
        # Sort words with same key
        nwords = asorti(data[key], words)
        if (nwords == 1)
            continue

        # And print. Minor glitch: trailing space at end of each line
        for (j = 1; j &lt;= nwords; j++)
            printf(&quot;%s &quot;, words[j]) | sort
        print &quot;&quot; | sort
    }
    close(sort)
}
</pre></div>

<p>这是程序运行时的部分输出：</p>
<div class="example">
<pre class="example">$ <kbd>gawk -f anagram.awk /usr/share/dict/words | grep '^b'</kbd>
&hellip;
babbled blabbed
babbler blabber brabble
babblers blabbers brabbles
babbling blabbing
babbly blabby
babel bable
babels beslab
babery yabber
&hellip;
</pre></div>


<hr>
<div class="header">
<p>下一个： <a href="Signature-Program.html#Signature-Program" rel="next" accesskey="n">签名程序</a> ，上一个： <a href="Igawk-Program.html#Igawk-Program" rel="prev" accesskey="p">Igawk程序</a> ，上： <a href="Miscellaneous-Programs.html#Miscellaneous-Programs" rel="up" accesskey="u">其他程序</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>