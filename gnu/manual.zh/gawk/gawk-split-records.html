<html ><!-- 
Copyright (C) 1989, 1991, 1992, 1993, 1996-2005, 2007, 2009-2019 

Free Software Foundation, Inc.



This is Edition 5.0 of GAWK: Effective AWK Programming: A User's Guide for GNU Awk,
for the 5.0.0 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License", with the
Front-Cover Texts being "A GNU Manual", and with the Back-Cover Texts
as in (a) below.
A copy of the license is included in the section entitled
"GNU Free Documentation License".

a. The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual." --><!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>gawk拆分记录（《 GNU Awk用户指南》）</title>

<meta name="description" content="gawk split records (The GNU Awk User’s Guide)">
<meta name="keywords" content="gawk split records (The GNU Awk User’s Guide)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Records.html#Records" rel="up" title="Records">
<link href="Fields.html#Fields" rel="next" title="Fields">
<link href="awk-split-records.html#awk-split-records" rel="prev" title="awk split records">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="/software/gnulib/manual.css">


</head>

<body lang="zh-Hans" >
<a name="gawk-split-records"></a>
<div class="header">
<p>上一个： <a href="awk-split-records.html#awk-split-records" rel="prev" accesskey="p">awk拆分记录</a> ，上一个： <a href="Records.html#Records" rel="up" accesskey="u">记录</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<a name="Record-Splitting-with-gawk"></a>
<h4 class="subsection">4.1.2记录分割<code>gawk</code></h4>

<a name="index-common-extensions_002c-RS-as-a-regexp"></a>
<a name="index-extensions_002c-common_002c-RS-as-a-regexp"></a>
<p>使用时<code>gawk</code> ， 的价值<code>RS</code>不限于一个字符的字符串。如果它包含一个以上的字符，则将其视为一个正则表达式（见<a href="Regexp.html#Regexp">正则表达式</a> ）。 （ce）通常，每个记录都在与正则表达式匹配的下一个字符串处结束；下一条记录从匹配字符串的末尾开始。该一般规则实际上在通常情况下起作用，其中<code>RS</code>仅包含一个换行符：一条记录在下一个匹配字符串的开头（输入中的下一个换行符）结束，而下一条记录在该字符串的结尾之后（在下一行的第一个字符处）开始。换行符，因为它匹配<code>RS</code> ，不属于任何一条记录。
</p>
<p>什么时候<code>RS</code>是一个字符， <code>RT</code>包含相同的单个字符。但是，当<code>RS</code>是一个正则表达式<code>RT</code>包含与正则表达式匹配的实际输入文本。
</p>
<p>如果输入文件结尾没有任何文本匹配<code>RS</code> ， <code>gawk</code>套<code>RT</code>为空字符串。
</p>
<p>下面的示例说明了这两个功能。它设置<code>RS</code>等于一个正则表达式，该表达式与换行符或一系列的一个或多个大写字母匹配，并带有可选的前导和/或尾随空白：</p>
<div class="example">
<pre class="example">$ <kbd>echo record 1 AAAA record 2 BBBB record 3 |</kbd>
&gt; <kbd>gawk 'BEGIN { RS = &quot;\n|( *[[:upper:]]+ *)&quot; }</kbd>
&gt;             <kbd>{ print &quot;Record =&quot;, $0,&quot;and RT = [&quot; RT &quot;]&quot; }'</kbd>
</pre><pre class="example">-| Record = record 1 and RT = [ AAAA ]
-| Record = record 2 and RT = [ BBBB ]
-| Record = record 3 and RT = [
-| ]
</pre></div>

<p>方括号描述了内容<code>RT</code> ，让您看到开头和结尾的空格。的最终值<code>RT</code>是换行符。有关更有用的示例，请参见<a href="Simple-Sed.html#Simple-Sed">“简单流编辑器”</a>部分。 <code>RS</code>作为正则表达式和<code>RT</code> 。
</p>
<p>如果您设定<code>RS</code>到允许可选的尾随文本的正则表达式，例如“ <samp>RS = "abc(XYZ)?"</samp> '，由于实施限制， <code>gawk</code>可能匹配正则表达式的开头部分，但不匹配结尾部分，特别是如果可以匹配结尾部分的输入文本相当长。
<code>gawk</code>尝试避免此问题，但目前无法保证永远不会发生。
</p>
<blockquote>
<p><b>注意：</b>请记住<code>awk</code> ， <samp>^</samp> '和' <samp>$</samp> “锚元字符开头和<em>字符串</em>的结束，而不是开始和<em>行</em>尾匹配。结果，类似“ <samp>RS = "^[[:upper:]]"</samp> '只能在文件开头匹配。这是因为<code>gawk</code>将输入文件查看为一个恰好包含换行符的长字符串。因此，最好避免锚定元字符的价值<code>RS</code> 。
</p></blockquote>

<a name="index-gawk_002c-RT-variable-in-1"></a>
<a name="index-RT-variable-1"></a>
<a name="index-differences-in-awk-and-gawk_002c-RS_002fRT-variables-1"></a>
<p>指某东西的用途<code>RS</code>作为正则表达式和<code>RT</code>变量是<code>gawk</code>扩展；它们在兼容模式下不可用（请参阅“ <a href="Options.html#Options">命令行选项”</a>一节）。在兼容模式下，仅值的第一个字符<code>RS</code>确定记录的结尾。
</p>
<a name="index-sidebar_002c-RS-_003d-_0022_005c0_0022-Is-Not-Portable"></a>

<table class="cartouche" border="1"><tbody><tr><td>
<div align="center"><b><code>RS = "\0"</code>不便携</b>
</div>

<a name="index-portability_002c-data-files-as-single-record"></a>
<p>有时您可能希望将整个数据文件视为一条记录。做到这一点的唯一方法是给予<code>RS</code>您知道输入文件中不会出现的值。通常很难做到这一点，以使程序始终可用于任意输入文件。
</p>
<p>您可能认为对于文本文件， <small>NUL</small>字符（由所有位等于零的字符组成）是一个很好的值，可用于<code>RS</code>在这种情况下：</p>
<div class="example">
<pre class="example">BEGIN { RS = &quot;\0&quot; }  # whole file becomes one record?
</pre></div>

<a name="index-differences-in-awk-and-gawk_002c-strings_002c-storing"></a>
<p><code>gawk</code>实际上接受了这一点，并将<small>NUL</small>字符用作记录分隔符。这适用于某些特殊文件，例如<samp>/proc/environ</samp>在GNU / Linux系统上，实际上<small>NUL</small>字符是记录分隔符。但是，此用法<em>不适</em>用于大多数其他对象<code>awk</code>实现。
</p>
<a name="index-dark-corner_002c-strings_002c-storing"></a>
<p>几乎所有其他<code>awk</code>实现<a name="DOCF19" href="#FOOT19"><sup>19在</sup></a>内部将字符串存储为C样式的字符串。C字符串使用<small>NUL</small>字符作为字符串终止符。实际上，这意味着“ <samp>RS = "\0"</samp> ' 是相同的 ' <samp>RS = ""</samp> '。（直流）
</p>
<p>碰巧的是， <code>mawk</code>可以使用<small>NUL</small>字符作为记录分隔符。但是，这是一个特例： <code>mawk</code>不允许在字符串中嵌入<small>NUL</small>字符。（这可能会在将来版本的<code>mawk</code> ）
</p>
<a name="index-records_002c-treating-files-as"></a>
<a name="index-treating-files_002c-as-single-records"></a>
<a name="index-single-records_002c-treating-files-as"></a>
<p>有关<a href="Readfile-Function.html#Readfile-Function">一次</a>读取整个文件的有趣方式，请参阅<a href="Readfile-Function.html#Readfile-Function">一次</a>读取整个文件部分。如果您正在使用<code>gawk</code> ，请参阅<a href="Extension-Sample-Readfile.html#Extension-Sample-Readfile">读取整个文件</a>以获取其他选项。
</p></td></tr></tbody></table>

<div class="footnote">
<hr>
<h4 class="footnotes-heading">脚注</h4>

<h3><a name="FOOT19" href="#DOCF19">（19）</a></h3>
<p>至少我们知道。</p>
</div>
<hr>
<div class="header">
<p>上一个： <a href="awk-split-records.html#awk-split-records" rel="prev" accesskey="p">awk拆分记录</a> ，上一个： <a href="Records.html#Records" rel="up" accesskey="u">记录</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>