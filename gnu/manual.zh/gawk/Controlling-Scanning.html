<html ><!-- 
Copyright (C) 1989, 1991, 1992, 1993, 1996-2005, 2007, 2009-2019 

Free Software Foundation, Inc.



This is Edition 5.0 of GAWK: Effective AWK Programming: A User's Guide for GNU Awk,
for the 5.0.0 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License", with the
Front-Cover Texts being "A GNU Manual", and with the Back-Cover Texts
as in (a) below.
A copy of the license is included in the section entitled
"GNU Free Documentation License".

a. The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual." --><!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>控制扫描（《 GNU Awk用户指南》）</title>

<meta name="description" content="Controlling Scanning (The GNU Awk User’s Guide)">
<meta name="keywords" content="Controlling Scanning (The GNU Awk User’s Guide)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Array-Basics.html#Array-Basics" rel="up" title="Array Basics">
<link href="Numeric-Array-Subscripts.html#Numeric-Array-Subscripts" rel="next" title="Numeric Array Subscripts">
<link href="Scanning-an-Array.html#Scanning-an-Array" rel="prev" title="Scanning an Array">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="/software/gnulib/manual.css">


</head>

<body lang="zh-Hans" >
<a name="Controlling-Scanning"></a>
<div class="header">
<p>上一页： <a href="Scanning-an-Array.html#Scanning-an-Array" rel="prev" accesskey="p">扫描阵列</a> ，上一页： <a href="Array-Basics.html#Array-Basics" rel="up" accesskey="u">阵列基础</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<a name="Using-Predefined-Array-Scanning-Orders-with-gawk"></a>
<h4 class="subsection">8.1.6将预定义阵列扫描顺序与<code>gawk</code></h4>

<p>本小节介绍了特定于<code>gawk</code> 。
</p>
<p>默认情况下，当<code>for</code>循环遍历数组，顺序未定义，这意味着<code>awk</code>实现确定数组的遍历顺序。此顺序通常基于数组的内部实现，并且与一个版本的<code>awk</code>到下一个。
</p>
<a name="index-array-scanning-order_002c-controlling"></a>
<a name="index-controlling-array-scanning-order"></a>
<p>但是，通常，您可能希望做一些简单的事情，例如“通过以升序比较索引来遍历数组”或“通过以降序比较值来遍历数组”。
<code>gawk</code>提供了两种机制来控制您：</p>
<ul>
<li>组<code>PROCINFO["sorted_in"]</code>到一组预定义值中的一个。我们现在对此进行描述。

</li><li>组<code>PROCINFO["sorted_in"]</code>用来比较数组元素的用户定义函数的名称。稍后在<a href="Array-Sorting.html#Array-Sorting">控制数组遍历和数组排序</a>中将描述此高级功能。
</li></ul>

<a name="index-PROCINFO_002c-values-of-sorted_005fin"></a>
<p>以下特殊值<code>PROCINFO["sorted_in"]</code>可用：</p>
<dl compact>
<dt><code>"@unsorted"</code></dt>
<dd><p>数组元素以任意顺序处理，这是默认设置<code>awk</code>行为。
</p>
</dd>
<dt><code>"@ind_str_asc"</code></dt>
<dd><p>按索引升序排序，与字符串相比；这是最基本的排序。（在内部，数组索引始终是字符串，因此对于' <samp>a[2*5] = 1</samp> '索引是<code>"10"</code>而不是数字10。）
</p>
</dd>
<dt><code>"@ind_num_asc"</code></dt>
<dd><p>按索引升序排列，但在过程中将其强制视为数字。任何具有非数字值的索引都将最终定位为零。
</p>
</dd>
<dt><code>"@val_type_asc"</code></dt>
<dd><p>按元素值升序排列（而不是按索引）。排序是根据分配给元素的类型进行的（请参见“ <a href="Typing-and-Comparison.html#Typing-and-Comparison">变量</a>类型<a href="Typing-and-Comparison.html#Typing-and-Comparison">和比较表达式”部分</a> ）。所有数字值都在所有字符串值之前，而字符串值又在所有子数组之前。（尚未描述子<a href="Arrays-of-Arrays.html#Arrays-of-Arrays">数组</a> ；请参见“ <a href="Arrays-of-Arrays.html#Arrays-of-Arrays">数组的数组”</a>一节。）
</p>
</dd>
<dt><code>"@val_str_asc"</code></dt>
<dd><p>按元素值升序排列（而不是按索引）。标量值将作为字符串进行比较。子数组（如果存在）最后出现。
</p>
</dd>
<dt><code>"@val_num_asc"</code></dt>
<dd><p>按元素值升序排列（而不是按索引）。标量值比较为数字。子数组（如果存在）最后出现。当数值相等时，字符串值用于提供排序：这样可确保在不同版本的C中结果一致<code>qsort()</code>功能<a name="DOCF41" href="#FOOT41"><sup>41</sup></a> <code>gawk</code>在内部使用以执行排序。
</p>
</dd>
<dt><code>"@ind_str_desc"</code></dt>
<dd><p>喜欢<code>"@ind_str_asc"</code> ，但字符串索引从高到低排序。
</p>
</dd>
<dt><code>"@ind_num_desc"</code></dt>
<dd><p>喜欢<code>"@ind_num_asc"</code> ，但数字索引从高到低排序。
</p>
</dd>
<dt><code>"@val_type_desc"</code></dt>
<dd><p>喜欢<code>"@val_type_asc"</code> ，但是元素值根据类型从高到低排序。子阵列（如果存在）首先出现。
</p>
</dd>
<dt><code>"@val_str_desc"</code></dt>
<dd><p>喜欢<code>"@val_str_asc"</code> ，但将元素值（视为字符串）从高到低排序。子阵列（如果存在）首先出现。
</p>
</dd>
<dt><code>"@val_num_desc"</code></dt>
<dd><p>喜欢<code>"@val_num_asc"</code> ，但将元素值（视为数字）从高到低排序。子阵列（如果存在）首先出现。
</p></dd>
</dl>

<p>数组遍历顺序在<code>for</code>循环开始运行。改变中<code>PROCINFO["sorted_in"]</code>在循环体中不会影响循环。例如：</p>
<div class="example">
<pre class="example">$ <kbd>gawk '</kbd>
&gt; <kbd>BEGIN {</kbd>
&gt; <kbd>   a[4] = 4</kbd>
&gt; <kbd>   a[3] = 3</kbd>
&gt; <kbd>   for (i in a)</kbd>
&gt; <kbd>       print i, a[i]</kbd>
&gt; <kbd>}'</kbd>
-| 4 4
-| 3 3
$ <kbd>gawk '</kbd>
&gt; <kbd>BEGIN {</kbd>
&gt; <kbd>   PROCINFO[&quot;sorted_in&quot;] = &quot;@ind_str_asc&quot;</kbd>
&gt; <kbd>   a[4] = 4</kbd>
&gt; <kbd>   a[3] = 3</kbd>
&gt; <kbd>   for (i in a)</kbd>
&gt; <kbd>       print i, a[i]</kbd>
&gt; <kbd>}'</kbd>
-| 3 3
-| 4 4
</pre></div>

<p>在按元素值对数组进行排序时，如果一个值恰好是一个子数组，则无论该子数组本身包含什么，它都被认为大于任何字符串或数字值，并且所有子数组都被视为彼此相等。它们之间的相对顺序由它们的索引字符串确定。
</p>
<p>以下是有关排序数组遍历的一些其他注意事项：</p>
<ul>
<li>的价值<code>PROCINFO["sorted_in"]</code>是全球性的也就是说，它影响所有数组遍历<code>for</code>循环。如果需要在自己的代码中进行更改，则应查看是否已定义并保存并恢复值：<div class="example">
<pre class="example">&hellip;
if (&quot;sorted_in&quot; in PROCINFO) {
    save_sorted = PROCINFO[&quot;sorted_in&quot;]
    PROCINFO[&quot;sorted_in&quot;] = &quot;@val_str_desc&quot; # or whatever
}
&hellip;
if (save_sorted)
    PROCINFO[&quot;sorted_in&quot;] = save_sorted
</pre></div>

</li><li>如前所述，默认的数组遍历顺序由<code>"@unsorted"</code> 。您还可以通过将null字符串分配给<code>PROCINFO["sorted_in"]</code>或仅删除<code>"sorted_in"</code>来自的元素<code>PROCINFO</code>与数组<code>delete</code>声明。（ <code>delete</code>声明尚未被描述；见<a href="Delete.html#Delete">的<code>delete</code>声明</a> 。）
</li></ul>

<p>此外， <code>gawk</code>提供用于对数组进行排序的内置函数；请参阅使用以下命令<a href="Array-Sorting-Functions.html#Array-Sorting-Functions">对数组值和索引进行排序<code>gawk</code></a> 。
</p>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">脚注</h4>

<h3><a name="FOOT41" href="#DOCF41">（41）</a></h3>
<p>当两个元素比较相等时，C <code>qsort()</code>函数不能保证它们将在排序后保持其原始相对顺序。当数值相等时，使用字符串值提供唯一的顺序可确保<code>gawk</code>在不同环境中表现一致。</p>
</div>
<hr>
<div class="header">
<p>上一页： <a href="Scanning-an-Array.html#Scanning-an-Array" rel="prev" accesskey="p">扫描阵列</a> ，上一页： <a href="Array-Basics.html#Array-Basics" rel="up" accesskey="u">阵列基础</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>