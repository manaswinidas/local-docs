<html ><!-- 
Copyright (C) 1989, 1991, 1992, 1993, 1996-2005, 2007, 2009-2019 

Free Software Foundation, Inc.



This is Edition 5.0 of GAWK: Effective AWK Programming: A User's Guide for GNU Awk,
for the 5.0.0 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License", with the
Front-Cover Texts being "A GNU Manual", and with the Back-Cover Texts
as in (a) below.
A copy of the license is included in the section entitled
"GNU Free Documentation License".

a. The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual." --><!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>定义语法（《 GNU Awk用户指南》）</title>

<meta name="description" content="Definition Syntax (The GNU Awk User’s Guide)">
<meta name="keywords" content="Definition Syntax (The GNU Awk User’s Guide)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="User_002ddefined.html#User_002ddefined" rel="up" title="User-defined">
<link href="Function-Example.html#Function-Example" rel="next" title="Function Example">
<link href="User_002ddefined.html#User_002ddefined" rel="prev" title="User-defined">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="/software/gnulib/manual.css">


</head>

<body lang="zh-Hans" >
<a name="Definition-Syntax"></a>
<div class="header">
<p>下一页： <a href="Function-Example.html#Function-Example" rel="next" accesskey="n">函数示例</a> ，上一篇： <a href="User_002ddefined.html#User_002ddefined" rel="up" accesskey="u">用户定义的</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<a name="Function-Definition-Syntax"></a>
<h4 class="subsection">9.2.1函数定义语法</h4>

<blockquote>
<p><i>可以肯定地说，用于局部变量定义的awk语法令人震惊。</i>
</p></blockquote>
<div align="center">— <em>布赖恩·克尼根</em> （ <em>Brian Kernighan）</em>
</div>
<a name="index-functions_002c-defining"></a>
<p>函数的定义可以出现在规则之间的任何位置<code>awk</code>程序。因此， <code>awk</code>程序被扩展为包括规则序列<em>和</em>用户定义的函数定义。无需将函数的定义放在函数的所有使用之前。这是因为<code>awk</code>在开始执行任何程序之前，先读取整个程序。
</p>
<p>名为的函数的定义<var>name</var>看起来像这样：</p>
<div class="display">
<pre class="display"><code>function</code> <var>name</var><code>(</code>[<var>parameter-list</var>]<code>)</code>
<code>{</code>
     <var>body-of-function</var>
<code>}</code>
</pre></div>

<a name="index-names_002c-functions"></a>
<a name="index-functions_002c-names-of"></a>
<a name="index-namespace-issues_002c-functions"></a>
<p>这里， <var>name</var>是要定义的函数的名称。有效的函数名称就像有效的变量名称：字母，数字和下划线的序列，它们不以数字开头。在这里，函数名称也只能使用52个大小写英文字母。在一个内<code>awk</code>程序中，任何特定名称都只能用作变量，数组或函数。
</p>
<p><var>parameter-list</var>是函数的参数和局部变量名称的可选列表，以逗号分隔。调用函数时，参数名称用于保存调用中给定的参数值。
</p>
<p>函数不能有两个具有相同名称的参数，也不能具有与函数本身具有相同名称的参数。
</p>
<blockquote>
<p><b>注意：</b>根据POSIX标准，功能参数不能与特殊的预定义变量之一具有相同的名称（请参阅“ <a href="Built_002din-Variables.html#Built_002din-Variables">预定义变量”</a>部分），功能参数也不能与另一个功能具有相同的名称。
</p>
<p>并非所有版本<code>awk</code>强制执行这些限制。
<code>gawk</code>始终强制执行第一个限制。用<samp>--posix</samp> （请参阅“ <a href="Options.html#Options">命令行选项”部分</a> ），它还强制执行第二个限制。
</p></blockquote>

<p>如果在需要字符串值的地方引用，局部变量的作用类似于空字符串；在需要数字值的地方引用，局部变量的作用为零。这与从未分配值的常规变量的行为相同。（有关局部变量的更多信息，请参见“ <a href="Dynamic-Typing.html#Dynamic-Typing">函数及其对变量键入的影响”</a>一节。）
</p>
<p>的<var>body-of-function</var>由组成<code>awk</code>陈述。这是定义中最重要的部分，因为它说明了该函数应实际<em>执行的操作</em> 。参数名称的存在为主体提供了一种讨论参数的方式。存在局部变量以赋予主体保留临时值的位置。
</p>
<p>参数名称与本地变量名称在语法上没有区别。相反，调用函数时提供的参数数量决定了有多少个参数变量。因此，如果给出三个自变量值，则前三个名称<var>parameter-list</var>是参数，其余的是局部变量。
</p>
<p>因此，如果在所有对该函数的调用中参数的数量不同，则其中的一些名称<var>parameter-list</var>在某些情况下可能是参数，而在其他情况下可能是局部变量。另一种思考方式是，省略的参数默认为空字符串。
</p>
<a name="index-programming-conventions_002c-functions_002c-writing"></a>
<p>通常，在编写函数时，您会知道打算将多少个名称用作参数，以及打算将多少个名称用作局部变量。通常会在参数和局部变量之间放置一些额外的空间，以记录应如何使用您的函数。
</p>
<a name="index-variables_002c-shadowing"></a>
<a name="index-shadowing-of-variable-values"></a>
<p>在函数体中，参数和局部变量值隐藏或<em>阴影</em>的执行，在程序的其余部分使用的相同名称的任何变量。在函数定义中无法访问阴影变量，因为在为参数和局部变量取走了其名称后，无法命名它们。所有其他变量<code>awk</code>程序可以在函数体内正常引用或设置。
</p>
<p>参数和局部变量仅在函数体执行时才存在。主体完成后，您可以再次访问函数运行时阴影的变量。
</p>
<a name="index-recursive-functions"></a>
<a name="index-functions_002c-recursive"></a>
<p>函数主体可以包含调用函数的表达式。他们甚至可以直接或通过另一个函数来调用此函数。发生这种情况时，我们说该函数是<em>递归的</em> 。函数调用自身的行为称为<em>递归</em> 。
</p>
<p>所有内置函数都向其调用者返回一个值。用户定义的函数也可以使用<code>return</code>语句，其详细描述<a href="Return-Statement.html#Return-Statement">的<code>return</code>声明</a> 。本节中的许多后续示例都使用<code>return</code>声明。
</p>
<a name="index-common-extensions_002c-func-keyword"></a>
<a name="index-extensions_002c-common_002c-func-keyword"></a>
<a name="index-POSIX-awk_002c-function-keyword-in"></a>
<p>在许多<code>awk</code>实现，包括<code>gawk</code> ，关键字<code>function</code>可以缩写<code>func</code> 。 （ce）但是，POSIX仅指定使用关键字<code>function</code> 。这实际上具有一些实际含义。如果<code>gawk</code>在POSIX兼容模式（参见<a href="Options.html#Options">命令行选项</a> ），然后下面的语句<em>没有</em>定义的函数：</p>
<div class="example">
<pre class="example">func foo() { a = sqrt($1) ; print a }
</pre></div>

<p>相反，它定义了一条规则，该规则为每条记录连接变量' <samp>func</samp> '带有函数的返回值' <samp>foo</samp> '。如果结果字符串为非null，则执行该操作。这可能不是所希望的。 （ <code>awk</code>接受此输入在语法上是有效的，因为可以在函数定义之前使用这些函数<code>awk</code>程式。 <a name="DOCF60" href="#FOOT60"><sup>60</sup></a> ）</p>
<a name="index-portability_002c-functions_002c-defining"></a>
<p>为了确保您的<code>awk</code>程序是可移植的，始终使用关键字<code>function</code>定义函数时。
</p>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">脚注</h4>

<h3><a name="FOOT60" href="#DOCF60">（60）</a></h3>
<p>该程序实际上不会运行，因为<code>foo()</code>未定义。</p>
</div>
<hr>
<div class="header">
<p>下一页： <a href="Function-Example.html#Function-Example" rel="next" accesskey="n">函数示例</a> ，上一篇： <a href="User_002ddefined.html#User_002ddefined" rel="up" accesskey="u">用户定义的</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>