<html ><!-- 
Copyright (C) 1989, 1991, 1992, 1993, 1996-2005, 2007, 2009-2019 

Free Software Foundation, Inc.



This is Edition 5.0 of GAWK: Effective AWK Programming: A User's Guide for GNU Awk,
for the 5.0.0 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License", with the
Front-Cover Texts being "A GNU Manual", and with the Back-Cover Texts
as in (a) below.
A copy of the license is included in the section entitled
"GNU Free Documentation License".

a. The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual." --><!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>作业分配（《 GNU Awk用户指南》）</title>

<meta name="description" content="Assignment Ops (The GNU Awk User’s Guide)">
<meta name="keywords" content="Assignment Ops (The GNU Awk User’s Guide)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="All-Operators.html#All-Operators" rel="up" title="All Operators">
<link href="Increment-Ops.html#Increment-Ops" rel="next" title="Increment Ops">
<link href="Concatenation.html#Concatenation" rel="prev" title="Concatenation">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="/software/gnulib/manual.css">


</head>

<body lang="zh-Hans" >
<a name="Assignment-Ops"></a>
<div class="header">
<p>下一篇： <a href="Increment-Ops.html#Increment-Ops" rel="next" accesskey="n">Increment Ops</a> ，上一篇： <a href="Concatenation.html#Concatenation" rel="prev" accesskey="p">串联</a> ，上一篇： <a href="All-Operators.html#All-Operators" rel="up" accesskey="u">所有运算符</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<a name="Assignment-Expressions"></a>
<h4 class="subsection">6.2.3赋值表达式</h4>
<a name="index-assignment-operators"></a>
<a name="index-operators_002c-assignment"></a>
<a name="index-expressions_002c-assignment"></a>
<a name="index-_003d-_0028equals-sign_0029_002c-_003d-operator"></a>
<a name="index-equals-sign-_0028_003d_0029_002c-_003d-operator"></a>
<p><em>赋值</em>是一种将（通常是不同的）值存储到变量中的表达式。例如，让我们将值1分配给变量<code>z</code> ：</p>
<div class="example">
<pre class="example">z = 1
</pre></div>

<p>执行此表达式后，变量<code>z</code>具有值一。不管旧值<code>z</code>忘记作业之前的时间。
</p>
<p>分配也可以存储字符串值。例如，以下存储值<code>"this food is good"</code>在变量中<code>message</code> ：</p>
<div class="example">
<pre class="example">thing = &quot;food&quot;
predicate = &quot;good&quot;
message = &quot;this &quot; thing &quot; is &quot; predicate
</pre></div>

<p><a name="index-side-effects_002c-assignment-expressions"></a>这也说明了字符串连接。' <samp>=</samp> '符号称为<em>赋值运算符</em> 。它是最简单的赋值运算符，因为右侧操作数的值保持不变。大多数运算符（加法，串联等）除计算值外均无效。如果未使用该值，则没有理由使用该运算符。赋值运算符是不同的。它确实会产生一个值，但是即使您忽略它，该赋值仍然可以通过更改变量来感觉到。我们称这为<em>副作用</em> 。
</p>
<a name="index-lvalues_002frvalues"></a>
<a name="index-rvalues_002flvalues"></a>
<a name="index-assignment-operators_002c-lvalues_002frvalues"></a>
<a name="index-operators_002c-assignment-1"></a>
<p>赋值的左侧操作数不必是变量（请参见“ <a href="Variables.html#Variables">变量”</a>一节）；它也可以是一个字段（参见<a href="Changing-Fields.html#Changing-Fields">更改字段的内容</a> ）或数组元素（见<a href="Arrays.html#Arrays">阵列在<code>awk</code></a> ）。这些都是所谓的<em>左值</em> ，这意味着他们可以在赋值运算符的左侧的出现。右侧操作数可以是任何表达式；它产生新值，该赋值存储在指定的变量，字段或数组元素中。（此类值称为<em>rvalues</em> 。）
</p>
<a name="index-variables_002c-types-of"></a>
<p>重要的是要注意，变量<em>没有</em>永久类型。变量的类型只是最后分配给它的任何值的类型。在以下程序片段中，变量<code>foo</code>首先有一个数字值，后来有一个字符串值：</p>
<div class="example">
<pre class="example">foo = 1
print foo
</pre><pre class="example">foo = &quot;bar&quot;
print foo
</pre></div>

<p>当第二个作业给出<code>foo</code>字符串值，它以前具有数字值的事实被遗忘了。
</p>
<p>不以数字开头的字符串值的数字值为零。执行以下代码后， <code>foo</code>是五：</p>
<div class="example">
<pre class="example">foo = &quot;a string&quot;
foo = foo + 5
</pre></div>

<blockquote>
<p><b>注意：</b>将变量用作数字，然后再将其用作字符串可能会造成混淆，并且编程风格不佳。前两个示例说明了<code>awk</code>有效， <em>而不是</em>应该如何编写程序！
</p></blockquote>

<p>赋值是一个表达式，因此它具有一个值-与赋值相同。因此， <samp>z = 1</samp> '是值为1的表达式。这样的结果之一是，您可以一起编写多个作业，例如：</p>
<div class="example">
<pre class="example">x = y = z = 5
</pre></div>

<p>本示例将值5存储在所有三个变量中（ <code>x</code> ， <code>y</code>和<code>z</code> ）。这样做是因为“ <samp>z = 5</samp> '，即五个，存储到<code>y</code>然后是' <samp>y = z = 5</samp> '，即五个，存储到<code>x</code> 。
</p>
<p>可以在需要表达式的任何地方使用分配。例如，写“ <samp>x != (y = 1)</samp> ' 设置<code>y</code>到一个，然后测试是否<code>x</code>等于一。但是这种风格会使程序难以阅读。除了单次程序之外，应该避免这种嵌套的分配。
</p>
<a name="index-_002b-_0028plus-sign_0029_002c-_002b_003d-operator"></a>
<a name="index-plus-sign-_0028_002b_0029_002c-_002b_003d-operator"></a>
<p>除了 ' <samp>=</samp> '，还有其他几种赋值运算符可以对变量的旧值进行算术运算。例如，运算符“ <samp>+=</samp> '通过将右侧值添加到变量的旧值来计算新值。因此，以下赋值将以下值加五<code>foo</code> ：</p>
<div class="example">
<pre class="example">foo += 5
</pre></div>

<p>这等效于以下内容：</p>
<div class="example">
<pre class="example">foo = foo + 5
</pre></div>

<p>使用任何一种可以使程序的含义更清楚。
</p>
<p>在某些情况下，使用“ <samp>+=</samp> '（或任何赋值运算符）是<em>不</em>一样的简单重复左手操作数在右侧的表达。例如：</p>
<a name="index-Rankin_002c-Pat-1"></a>
<div class="example">
<pre class="example"># Thanks to Pat Rankin for this example
BEGIN  {
    foo[rand()] += 5
    for (x in foo)
       print x, foo[x]
</pre><pre class="example">

</pre><pre class="example">    bar[rand()] = bar[rand()] + 5
    for (x in bar)
       print x, bar[x]
}
</pre></div>

<a name="index-operators_002c-assignment_002c-evaluation-order"></a>
<a name="index-assignment-operators_002c-evaluation-order"></a>
<p>的指数<code>bar</code>实际上保证是不同的，因为<code>rand()</code>每次调用时都会返回不同的值。（数组和<code>rand()</code>功能尚未涵盖。请参阅中的<a href="Arrays.html#Arrays">数组</a>部分<a href="Arrays.html#Arrays"><code>awk</code></a> ，请参阅“ <a href="Numeric-Functions.html#Numeric-Functions">数字函数”</a>部分以获取更多信息。）此示例说明了有关赋值运算符的重要事实：左手表达式仅计算<em>一次</em> 。
</p>
<p>具体取决于哪个表达式首先被评估（左手还是右手）。考虑以下示例：</p>
<div class="example">
<pre class="example">i = 1
a[i += 2] = i + 1
</pre></div>

<p>的价值<code>a[3]</code>可以是两个或四个。
</p>
<p><a href="#table_002dassign_002dops">表6.2</a>列出了算术赋值运算符。在每种情况下，右侧操作数都是一个表达式，其值将转换为数字。
</p>
<a name="index-_002d-_0028hyphen_0029_002c-_002d_003d-operator"></a>
<a name="index-hyphen-_0028_002d_0029_002c-_002d_003d-operator"></a>
<a name="index-_002a-_0028asterisk_0029_002c-_002a_003d-operator"></a>
<a name="index-asterisk-_0028_002a_0029_002c-_002a_003d-operator"></a>
<a name="index-_002f-_0028forward-slash_0029_002c-_002f_003d-operator"></a>
<a name="index-forward-slash-_0028_002f_0029_002c-_002f_003d-operator"></a>
<a name="index-_0025-_0028percent-sign_0029_002c-_0025_003d-operator"></a>
<a name="index-percent-sign-_0028_0025_0029_002c-_0025_003d-operator"></a>
<a name="index-_005e-_0028caret_0029_002c-_005e_003d-operator"></a>
<a name="index-caret-_0028_005e_0029_002c-_005e_003d-operator"></a>
<a name="index-_002a-_0028asterisk_0029_002c-_002a_002a_003d-operator"></a>
<a name="index-asterisk-_0028_002a_0029_002c-_002a_002a_003d-operator"></a>
<div class="float"><a name="table_002dassign_002dops"></a>

<table>
<thead><tr><th width="30%">操作员</th><th width="70%">影响</th></tr></thead>
<tbody><tr><td width="30%"><var>lvalue</var> <code>+=</code> <var>increment</var></td><td width="70%">加<var>increment</var>的价值<var>lvalue</var> 。</td></tr>
<tr><td width="30%"><var>lvalue</var> <code>-=</code> <var>decrement</var></td><td width="70%">减去<var>decrement</var>从...的价值<var>lvalue</var> 。</td></tr>
<tr><td width="30%"><var>lvalue</var> <code>*=</code> <var>coefficient</var></td><td width="70%">乘以<var>lvalue</var>通过<var>coefficient</var> 。</td></tr>
<tr><td width="30%"><var>lvalue</var> <code>/=</code> <var>divisor</var></td><td width="70%">除以<var>lvalue</var>通过<var>divisor</var> 。</td></tr>
<tr><td width="30%"><var>lvalue</var> <code>%=</code> <var>modulus</var></td><td width="70%">组<var>lvalue</var>到剩余<var>modulus</var> 。
<a name="index-common-extensions_002c-_002a_002a_003d-operator"></a>
<a name="index-extensions_002c-common_002c-_002a_002a_003d-operator"></a>
<a name="index-awk-language_002c-POSIX-version"></a>
<a name="index-POSIX-awk-1"></a></td></tr>
<tr><td width="30%"><var>lvalue</var> <code>^=</code> <var>power</var></td><td width="70%">提高<var>lvalue</var>权力<var>power</var> 。</td></tr>
<tr><td width="30%"><var>lvalue</var> <code>**=</code> <var>power</var></td><td width="70%">提高<var>lvalue</var>权力<var>power</var> 。 （ce）</td></tr>
</tbody></table>
<div class="float-caption"><p><strong>表6.2：</strong>算术赋值运算符</p></div></div>
<a name="index-POSIX-awk_002c-_002a_002a_003d-operator-and"></a>
<a name="index-portability_002c-_002a_002a_003d-operator-and"></a>
<blockquote>
<p><b>注意：</b>只有' <samp>^=</samp> '运算符由POSIX指定。为了获得最大的便携性，请勿使用“ <samp>**=</samp> '运算符。
</p></blockquote>

<a name="index-sidebar_002c-Syntactic-Ambiguities-Between-_002f_003d-and-Regular-Expressions"></a>

<table class="cartouche" border="1"><tbody><tr><td>
<div align="center"><b>'之间的句法歧义<samp>/=</samp> '和正则表达式</b>
</div>

<a name="index-dark-corner_002c-regexp-constants_002c-_002f_003d-operator-and"></a>
<a name="index-_002f-_0028forward-slash_0029_002c-_002f_003d-operator_002c-vs_002e-_002f_003d_2026_002f-regexp-constant"></a>
<a name="index-forward-slash-_0028_002f_0029_002c-_002f_003d-operator_002c-vs_002e-_002f_003d_2026_002f-regexp-constant"></a>
<a name="index-regexp-constants_002c-_002f_003d_2026_002f_002c-_002f_003d-operator-and"></a>


<a name="index-dark-corner_002c-_002f_003d-operator-vs_002e-_002f_003d_2026_002f-regexp-constant"></a>
<a name="index-ambiguity_002c-syntactic_003a-_002f_003d-operator-vs_002e-_002f_003d_2026_002f-regexp-constant"></a>
<a name="index-syntactic-ambiguity_003a-_002f_003d-operator-vs_002e-_002f_003d_2026_002f-regexp-constant"></a>
<a name="index-_002f_003d-operator-vs_002e-_002f_003d_2026_002f-regexp-constant"></a>
<p>两者之间存在句法歧义。 <code>/=</code>赋值运算符和正则表达式常量，其第一个字符为' <samp>=</samp> '。（直流）这在某些商业广告中最为明显<code>awk</code>版本。例如：</p>
<div class="example">
<pre class="example">$ <kbd>awk /==/ /dev/null</kbd>
error&rarr; awk: syntax error at source line 1
error&rarr;  context is
error&rarr;         &gt;&gt;&gt; /= &lt;&lt;&lt;
error&rarr; awk: bailing out at source line 1
</pre></div>

<p>解决方法是：</p>
<div class="example">
<pre class="example">awk '/[=]=/' /dev/null
</pre></div>

<p><code>gawk</code>没有这个问题；宝马<code>awk</code>和<code>mawk</code>也不要。
</p></td></tr></tbody></table>

<hr>
<div class="header">
<p>下一篇： <a href="Increment-Ops.html#Increment-Ops" rel="next" accesskey="n">Increment Ops</a> ，上一篇： <a href="Concatenation.html#Concatenation" rel="prev" accesskey="p">串联</a> ，上一篇： <a href="All-Operators.html#All-Operators" rel="up" accesskey="u">所有运算符</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>