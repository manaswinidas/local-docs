<html ><!-- 
Copyright (C) 1989, 1991, 1992, 1993, 1996-2005, 2007, 2009-2019 

Free Software Foundation, Inc.



This is Edition 5.0 of GAWK: Effective AWK Programming: A User's Guide for GNU Awk,
for the 5.0.0 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License", with the
Front-Cover Texts being "A GNU Manual", and with the Back-Cover Texts
as in (a) below.
A copy of the license is included in the section entitled
"GNU Free Documentation License".

a. The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual." --><!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>标签程序（《 GNU Awk用户指南》）</title>

<meta name="description" content="Labels Program (The GNU Awk User’s Guide)">
<meta name="keywords" content="Labels Program (The GNU Awk User’s Guide)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Miscellaneous-Programs.html#Miscellaneous-Programs" rel="up" title="Miscellaneous Programs">
<link href="Word-Sorting.html#Word-Sorting" rel="next" title="Word Sorting">
<link href="Translate-Program.html#Translate-Program" rel="prev" title="Translate Program">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="manual.css">


</head>

<body lang="zh-Hans" >
<a name="Labels-Program"></a>
<div class="header">
<p>下一篇： <a href="Word-Sorting.html#Word-Sorting" rel="next" accesskey="n">单词排序</a> ，上一篇： <a href="Translate-Program.html#Translate-Program" rel="prev" accesskey="p">翻译程序</a> ，上一篇： <a href="Miscellaneous-Programs.html#Miscellaneous-Programs" rel="up" accesskey="u">其他程序</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<a name="Printing-Mailing-Labels"></a>
<h4 class="subsection">11.3.4打印邮件标签</h4>

<a name="index-printing_002c-mailing-labels"></a>
<a name="index-mailing-labels_002c-printing"></a>
<p>这是一个“真实世界”的<a name="DOCF79" href="#FOOT79"><sup>79</sup></a>程序。该脚本读取名称和地址列表并生成邮件标签。标签的每一页上都有20个标签，两个标签横跨且10个向下。地址保证不超过五行数据。每个地址都用空行与下一个地址分隔。
</p>
<p>基本思想是读取20个标签的数据。每个标签的每一行都存储在<code>line</code>数组。单个规则负责填充<code>line</code>读取20个标签后，排列并打印页面。
</p>
<p>的<code>BEGIN</code>规则简单地设置<code>RS</code>到空字符串，这样<code>awk</code>在空白行处拆分记录（请参见<a href="Records.html#Records">如何将输入拆分为记录部分</a> ）。它设置<code>MAXLINES</code>到100，因为100是页面上的最大行数（20 * 5 = 100）。
</p>
<p>大多数工作是在<code>printpage()</code>功能。标签行顺序存储在<code>line</code>数组。但是它们必须水平打印： <code>line[1]</code>旁边的<code>line[6]</code> ， <code>line[2]</code>旁边的<code>line[7]</code> ， 等等。有两个循环可完成此操作。外循环，由<code>i</code> ，每10行数据浏览一次；这是标签的每一行。内循环，由<code>j</code> ，经过该行内的所有行。如<code>j</code>从0到4， <samp>i+j</samp> ' 是个<code>j</code>行中的第<samp>i+j+5</samp> '是它旁边的条目。输出最终看起来像这样：</p>
<div class="example">
<pre class="example">line 1          line 6
line 2          line 7
line 3          line 8
line 4          line 9
line 5          line 10
&hellip;
</pre></div>

<p>的<code>printf</code>格式字符串“ <samp>%-41s</samp> '将数据左对齐并在固定宽度的字段中打印。
</p>
<p>最后要注意的是，在第21和61行上打印了一个额外的空白行，以使输出在标签上对齐。这取决于编写程序时使用的特定商标品牌。您还将注意到，顶部有两个空行，底部有两个空行。
</p>
<p>的<code>END</code>规则安排冲洗标签的最后一页；数据中可能没有20个标签的偶数个：</p>
<a name="index-labels_002eawk-program"></a>
<div class="example">
<pre class="example"># labels.awk --- print mailing labels

# Each label is 5 lines of data that may have blank lines.
# The label sheets have 2 blank lines at the top and 2 at
# the bottom.

BEGIN    { RS = &quot;&quot; ; MAXLINES = 100 }

function printpage(    i, j)
{
    if (Nlines &lt;= 0)
        return

    printf &quot;\n\n&quot;        # header

    for (i = 1; i &lt;= Nlines; i += 10) {
        if (i == 21 || i == 61)
            print &quot;&quot;
        for (j = 0; j &lt; 5; j++) {
            if (i + j &gt; MAXLINES)
                break
            printf &quot;   %-41s %s\n&quot;, line[i+j], line[i+j+5]
        }
        print &quot;&quot;
    }

    printf &quot;\n\n&quot;        # footer

    delete line
}

# main rule
{
    if (Count &gt;= 20) {
        printpage()
        Count = 0
        Nlines = 0
    }
    n = split($0, a, &quot;\n&quot;)
    for (i = 1; i &lt;= n; i++)
        line[++Nlines] = a[i]
    for (; i &lt;= 5; i++)
        line[++Nlines] = &quot;&quot;
    Count++
}

END {
    printpage()
}
</pre></div>

<div class="footnote">
<hr>
<h4 class="footnotes-heading">脚注</h4>

<h3><a name="FOOT79" href="#DOCF79">（79）</a></h3>
<p>“现实世界”定义为“实际上用于完成某项任务的程序。”</p>
</div>
<hr>
<div class="header">
<p>下一篇： <a href="Word-Sorting.html#Word-Sorting" rel="next" accesskey="n">单词排序</a> ，上一篇： <a href="Translate-Program.html#Translate-Program" rel="prev" accesskey="p">翻译程序</a> ，上一篇： <a href="Miscellaneous-Programs.html#Miscellaneous-Programs" rel="up" accesskey="u">其他程序</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>