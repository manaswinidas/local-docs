<html ><!-- 
Copyright (C) 1989, 1991, 1992, 1993, 1996-2005, 2007, 2009-2019 

Free Software Foundation, Inc.



This is Edition 5.0 of GAWK: Effective AWK Programming: A User's Guide for GNU Awk,
for the 5.0.0 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License", with the
Front-Cover Texts being "A GNU Manual", and with the Back-Cover Texts
as in (a) below.
A copy of the license is included in the section entitled
"GNU Free Documentation License".

a. The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual." --><!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>内部文件说明（《 GNU Awk用户指南》）</title>

<meta name="description" content="Internal File Description (The GNU Awk User’s Guide)">
<meta name="keywords" content="Internal File Description (The GNU Awk User’s Guide)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Extension-Example.html#Extension-Example" rel="up" title="Extension Example">
<link href="Internal-File-Ops.html#Internal-File-Ops" rel="next" title="Internal File Ops">
<link href="Extension-Example.html#Extension-Example" rel="prev" title="Extension Example">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="/software/gnulib/manual.css">


</head>

<body lang="zh-Hans" >
<a name="Internal-File-Description"></a>
<div class="header">
<p>下一页： <a href="Internal-File-Ops.html#Internal-File-Ops" rel="next" accesskey="n">内部文件操作</a> ，上： <a href="Extension-Example.html#Extension-Example" rel="up" accesskey="u">扩展示例</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<a name="Using-chdir_0028_0029-and-stat_0028_0029"></a>
<h4 class="subsection">17.6.1使用<code>chdir()</code>和<code>stat()</code></h4>

<p>本节说明如何在<code>awk</code>将它们集成到跑步中之后<code>gawk</code>口译员。使用<code>chdir()</code>非常简单。它需要一个参数，即新目录更改为：</p>
<div class="example">
<pre class="example">@load &quot;filefuncs&quot;
&hellip;
newdir = &quot;/home/arnold/funstuff&quot;
ret = chdir(newdir)
if (ret &lt; 0) {
    printf(&quot;could not change to %s: %s\n&quot;, newdir, ERRNO) &gt; &quot;/dev/stderr&quot;
    exit 1
}
&hellip;
</pre></div>

<p>如果返回值是负数<code>chdir()</code>失败了，并且<code>ERRNO</code> （请参阅<a href="Built_002din-Variables.html#Built_002din-Variables">预定义变量</a>部分）设置为指示错误的字符串。
</p>
<p>使用<code>stat()</code>有点复杂。C <code>stat()</code>函数填充具有大量信息的结构。在其中建模的正确方法<code>awk</code>是用适当的信息填充关联数组：</p>
<div class="example">
<pre class="example">file = &quot;/home/arnold/.profile&quot;
ret = stat(file, fdata)
if (ret &lt; 0) {
    printf(&quot;could not stat %s: %s\n&quot;,
             file, ERRNO) &gt; &quot;/dev/stderr&quot;
    exit 1
}
printf(&quot;size of %s is %d bytes\n&quot;, file, fdata[&quot;size&quot;])
</pre></div>

<p>的<code>stat()</code>函数始终清除数据数组，即使<code>stat()</code>失败。它填写以下元素：</p>
<dl compact>
<dt><code>"name"</code></dt>
<dd><p>该文件的名称是<code>stat()</code> ed。
</p>
</dd>
<dt><code>"dev"</code></dt>
<dt><code>"ino"</code></dt>
<dd><p>文件的设备号和索引号。
</p>
</dd>
<dt><code>"mode"</code></dt>
<dd><p>文件的模式，以数值表示。这包括文件的类型及其权限。
</p>
</dd>
<dt><code>"nlink"</code></dt>
<dd><p>文件具有的硬链接（目录条目）的数量。
</p>
</dd>
<dt><code>"uid"</code></dt>
<dt><code>"gid"</code></dt>
<dd><p>文件所有者的数字用户和组ID号。
</p>
</dd>
<dt><code>"size"</code></dt>
<dd><p>文件的字节大小。
</p>
</dd>
<dt><code>"blocks"</code></dt>
<dd><p>文件实际占用的磁盘块数。如果文件有孔，这可能不是文件大小的函数。
</p>
</dd>
<dt><code>"atime"</code></dt>
<dt><code>"mtime"</code></dt>
<dt><code>"ctime"</code></dt>
<dd><p>文件的最后访问时间，修改时间和inode更新时间。这些是数字时间戳，适用于使用<code>strftime()</code> （请参阅<a href="Time-Functions.html#Time-Functions">时间功能</a>一节）。
</p>
</dd>
<dt><code>"pmode"</code></dt>
<dd><p>文件的“可打印模式”。这是文件类型和权限的字符串表示形式，例如由' <samp>ls -l</samp> '-例如， <code>"drwxr-xr-x"</code> 。
</p>
</dd>
<dt><code>"type"</code></dt>
<dd><p>文件类型的可打印字符串表示形式。该值为以下之一：</p>
<dl compact>
<dt><code>"blockdev"</code></dt>
<dt><code>"chardev"</code></dt>
<dd><p>该文件是块或字符设备（“特殊文件”）。
</p>

</dd>
<dt><code>"directory"</code></dt>
<dd><p>该文件是一个目录。
</p>
</dd>
<dt><code>"fifo"</code></dt>
<dd><p>该文件是一个命名管道（也称为FIFO）。
</p>
</dd>
<dt><code>"file"</code></dt>
<dd><p>该文件只是普通文件。
</p>
</dd>
<dt><code>"socket"</code></dt>
<dd><p>该文件是<code>AF_UNIX</code> （“ Unix域”）文件系统中的套接字。
</p>
</dd>
<dt><code>"symlink"</code></dt>
<dd><p>该文件是符号链接。
</p></dd>
</dl>

</dd>
<dt><code>"devbsize"</code></dt>
<dd><p>索引元素的块大小<code>"blocks"</code> 。此信息来自<code>DEV_BSIZE</code>定义于<code><sys/param.h></code>在大多数系统上<code>S_BLKSIZE</code>恒定在<code><sys/stat.h></code>在BSD系统上。对于某些其他系统， <em>使用先验</em>知识来提供价值。如果无法确定任何值，则默认为512。
</p></dd>
</dl>

<p>根据操作系统和文件类型，可能会出现几个其他元素。您可以在其中测试它们<code>awk</code>通过使用<code>in</code>运算符（请参阅“ <a href="Reference-to-Elements.html#Reference-to-Elements">引用数组元素”一节</a> ）：</p>
<dl compact>
<dt><code>"blksize"</code></dt>
<dd><p>文件I / O的首选块大小。C中并非所有类似POSIX的系统上都存在此字段<code>stat</code>结构体。
</p>
</dd>
<dt><code>"linkval"</code></dt>
<dd><p>如果文件是符号链接，则此元素是链接指向的文件的名称（即，链接的值）。
</p>
</dd>
<dt><code>"rdev"</code></dt>
<dt><code>"major"</code></dt>
<dt><code>"minor"</code></dt>
<dd><p>如果文件是块文件或字符设备文件，则这些值分别代表数字设备编号以及该编号的主要和次要组成部分。
</p></dd>
</dl>

<hr>
<div class="header">
<p>下一页： <a href="Internal-File-Ops.html#Internal-File-Ops" rel="next" accesskey="n">内部文件操作</a> ，上： <a href="Extension-Example.html#Extension-Example" rel="up" accesskey="u">扩展示例</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>