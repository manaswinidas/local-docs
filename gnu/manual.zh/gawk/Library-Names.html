<html ><!-- 
Copyright (C) 1989, 1991, 1992, 1993, 1996-2005, 2007, 2009-2019 

Free Software Foundation, Inc.



This is Edition 5.0 of GAWK: Effective AWK Programming: A User's Guide for GNU Awk,
for the 5.0.0 (or later) version of the GNU
implementation of AWK.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License", with the
Front-Cover Texts being "A GNU Manual", and with the Back-Cover Texts
as in (a) below.
A copy of the license is included in the section entitled
"GNU Free Documentation License".

a. The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual." --><!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>库名称（《 GNU Awk用户指南》）</title>

<meta name="description" content="Library Names (The GNU Awk User’s Guide)">
<meta name="keywords" content="Library Names (The GNU Awk User’s Guide)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Library-Functions.html#Library-Functions" rel="up" title="Library Functions">
<link href="General-Functions.html#General-Functions" rel="next" title="General Functions">
<link href="Library-Functions.html#Library-Functions" rel="prev" title="Library Functions">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="/software/gnulib/manual.css">


</head>

<body lang="zh-Hans" >
<a name="Library-Names"></a>
<div class="header">
<p>下一页： <a href="General-Functions.html#General-Functions" rel="next" accesskey="n">常规功能</a> ，上一页： <a href="Library-Functions.html#Library-Functions" rel="up" accesskey="u">库函数</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<a name="Naming-Library-Function-Global-Variables"></a>
<h3 class="section">10.1命名库函数全局变量</h3>

<a name="index-names_002c-arrays_002fvariables"></a>
<a name="index-names_002c-functions-1"></a>
<a name="index-namespace-issues"></a>
<a name="index-awk-programs_002c-documenting-1"></a>
<a name="index-documentation_002c-of-awk-programs"></a>
<p>由于方式<code>awk</code>随着语言的发展，变量可以是<em>全局的</em> （可用于整个程序）或<em>局部的</em> （仅可用于特定功能）。没有类似于以下的中间状态<code>static</code> C中的变量</p>
<a name="index-variables_002c-global_002c-for-library-functions"></a>
<a name="index-private-variables"></a>
<a name="index-variables_002c-private"></a>
<p>库函数通常需要具有全局变量，它们可用于保存函数调用之间的状态信息，例如， <code>getopt()</code>的变量<code>_opti</code> （请参阅“ <a href="Getopt-Function.html#Getopt-Function">处理命令行选项”一节</a> ）。此类变量称为<em>private</em> ，因为唯一需要使用它们的函数就是库中的那些函数。
</p>
<p>编写库函数时，应尝试为自己的私有变量选择名称，该名称应与另一个库函数或用户主程序使用的任何变量不冲突。例如，类似<code>i</code>要么<code>j</code>这不是一个好选择，因为用户程序通常出于自己的目的使用此类变量名。
</p>
<a name="index-programming-conventions_002c-private-variable-names"></a>
<p>本章中显示的示例程序均以下划线（' <samp>_</samp> '）。用户通常在变量名中不使用前划线，因此该约定立即减少了变量名与用户程序意外共享的可能性。
</p>
<a name="index-_005f-_0028underscore_0029_002c-in-names-of-private-variables"></a>
<a name="index-underscore-_0028_005f_0029_002c-in-names-of-private-variables"></a>
<p>此外，一些库函数使用前缀来帮助指示哪些函数或一组函数使用变量-例如， <code>_pw_byname()</code>在用户数据库例程中（请参阅<a href="Passwd-Functions.html#Passwd-Functions">阅读用户数据库部分</a> ）。建议使用此约定，因为它甚至进一步减少了变量名之间无意冲突的机会。请注意，此约定对于变量名和私有函数名同样适用。 <a name="DOCF66" href="#FOOT66"><sup>66</sup></a>
</p>
<p>关于变量命名的最后注解，如果函数使全局变量可供主程序使用，则习惯上以大写字母开头这些变量的名称，例如， <code>getopt()</code>的<code>Opterr</code>和<code>Optind</code>变量（请参阅“ <a href="Getopt-Function.html#Getopt-Function">处理命令行选项”一节</a> ）。前导大写字母表示它是全局的，而变量名不是全部大写字母这一事实表示变量不是以下之一<code>awk</code>的预定义变量，例如<code>FS</code> 。
</p>
<a name="index-_002d_002ddump_002dvariables-option_002c-using-for-library-functions"></a>
<p>实际上，必须将库函数中不需要保存状态的<em>所有</em>变量声明为局部变量，这一点也很重要。 <a name="DOCF67" href="#FOOT67"><sup>67</sup></a>如果不这样做，则变量可能会意外地在用户程序中使用，从而导致很难跟踪的错误：</p>
<div class="example">
<pre class="example">function lib_func(x, y,    l1, l2)
{
    &hellip;
    # some_var should be local but by oversight is not
    <var>use variable</var> some_var
    &hellip;
}
</pre></div>

<a name="index-arrays_002c-associative_002c-library-functions-and"></a>
<a name="index-libraries-of-awk-functions_002c-associative-arrays-and"></a>
<a name="index-functions_002c-library_002c-associative-arrays-and"></a>
<a name="index-Tcl"></a>
<p>Tcl社区中常见的另一种约定是使用单个关联数组来保存库函数或“包”所需的值。这大大减少了实际使用的全局名称的数量。例如， <a href="Passwd-Functions.html#Passwd-Functions">读取用户数据库中</a>描述的功能可能使用了数组元素<code><span class="nolinebreak">PW_data["inited"]</span>
<!-- /@w --></code> ， <code><span class="nolinebreak">PW_data["total"]</span>
<!-- /@w --></code> ， <code><span class="nolinebreak">PW_data["count"]</span>
<!-- /@w --></code>和<code><span class="nolinebreak">PW_data["awklib"]</span>
<!-- /@w --></code> ， 代替<code><span class="nolinebreak">_pw_inited</span>
<!-- /@w --></code> ， <code><span class="nolinebreak">_pw_awklib</span>
<!-- /@w --></code> ， <code><span class="nolinebreak">_pw_total</span>
<!-- /@w --></code>和<code><span class="nolinebreak">_pw_count</span>
<!-- /@w --></code> 。
</p>
<p>本节中提供的约定正是：约定。您无需以这种方式编写程序，我们只建议您这样做。
</p>
<p>从5.0版开始， <code>gawk</code>提供了解决此部分中描述的问题的强大机制： <em>名称空间</em> 。命名空间及其使用在“ <a href="Namespaces.html#Namespaces">命名空间”中有</a>详细说明<a href="Namespaces.html#Namespaces">。 <code>gawk</code></a> 。
</p>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">脚注</h4>

<h3><a name="FOOT66" href="#DOCF66">（66）</a></h3>
<p>尽管可以重写所有库例程以使用此约定，但是为了说明我们自己的库例程，并没有这样做<code>awk</code>编程风格已经演变，并为该讨论提供了一些基础。</p>
<h3><a name="FOOT67" href="#DOCF67">（67）</a></h3>
<p><code>gawk</code>的<samp>--dump-variables</samp>命令行选项对于验证这一点很有用。</p>
</div>
<hr>
<div class="header">
<p>下一页： <a href="General-Functions.html#General-Functions" rel="next" accesskey="n">常规功能</a> ，上一页： <a href="Library-Functions.html#Library-Functions" rel="up" accesskey="u">库函数</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Index.html#Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>