<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>POSIX安全概念（GNU C库）</title>

<meta name="description" content="POSIX Safety Concepts (The GNU C Library)">
<meta name="keywords" content="POSIX Safety Concepts (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="POSIX.html#POSIX" rel="up" title="POSIX">
<link href="Unsafe-Features.html#Unsafe-Features" rel="next" title="Unsafe Features">
<link href="POSIX.html#POSIX" rel="prev" title="POSIX">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="POSIX-Safety-Concepts"></span><div class="header">
<p>下一页： <a href="Unsafe-Features.html#Unsafe-Features" rel="next" accesskey="n">不安全的功能</a> ，向上： <a href="POSIX.html#POSIX" rel="up" accesskey="u">POSIX</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="POSIX-Safety-Concepts-1"></span><h4 class="subsubsection">1.2.2.1 POSIX安全概念</h4>
<span id="index-POSIX-Safety-Concepts"></span>

<p>本手册在遵循其原型的代码行中记录了GNU C库函数的各种安全属性，如下所示：</p>
<p>初步： MT安全| AS安全交流安全</p>


<p>这些属性是根据POSIX标准中针对诸如线程安全，异步信号安全和异步取消安全之类的安全上下文中列出的标准评估的。接下来是这些属性的直观定义，试图抓住标准定义的含义。
</p>
<ul>
<li> <span id="index-MT_002dSafe"></span><span id="index-Thread_002dSafe"></span><code>MT-Safe</code>如果存在其他线程，则可以安全地调用或线程安全函数。MT-Safe中的MT代表多线程。

<p>成为MT-Safe并不意味着功能是原子的，也不意味着它使用POSIX公开给用户的任何内存同步机制。甚至有可能依次调用MT-Safe功能不会产生MT-Safe组合。例如，让一个线程一个接一个地调用两个MT-Safe功能并不能保证等同于两个功能的组合的原子执行的行为，因为其他线程中的并发调用可能会以破坏性方式进行干扰。
</p>
<p>可跨库接口内联函数的整个程序优化可能会暴露不安全的重新排序，因此不建议跨GNU C库接口执行内联。在整个程序优化中，不能保证已记录的MT安全状态。但是，用户可见的标头中定义的函数被设计为可以安全地进行内联。
</p>

</li><li> <span id="index-AS_002dSafe"></span><span id="index-Async_002dSignal_002dSafe"></span><code>AS-Safe</code>或Async-Signal-Safe函数可以安全地从异步信号处理程序中调用。在AS-Safe中，AS代表异步信号。

<p>可以设置许多AS安全功能<code>errno</code>或修改浮点环境，因为这样做不会使它们不适合在信号处理程序中使用。但是，如果异步信号处理程序修改了此线程本地状态，则程序可能会行为不当，并且无法依靠信号处理机制来保留它。因此，信号处理程序调用可能设置的功能<code>errno</code>或修改浮点环境<em>必须</em>保存其原始值，并在返回之前将其还原。
</p>

</li><li> <span id="index-AC_002dSafe"></span><span id="index-Async_002dCancel_002dSafe"></span><code>AC-Safe</code>启用异步取消后，可以安全地调用或取消安全函数。AC-Safe中的AC代表异步取消。

<p>POSIX标准仅将三个功能定义为AC安全的，即<code>pthread_cancel</code> ， <code>pthread_setcancelstate</code>和<code>pthread_setcanceltype</code> 。目前，GNU C库不提供除这三个功能之外的任何保证，但确实记录了当前哪些功能是AC安全的。本文档供GNU C库开发人员使用。
</p>
<p>就像信号处理程序一样，取消清除例程必须配置所需的浮点环境。例程不能假定浮点环境，尤其是在启用异步取消时。如果无法原子地执行浮点环境的配置，则遇到的环境也可能在内部不一致。
</p>

</li><li> <span id="index-MT_002dUnsafe"></span><span id="index-Thread_002dUnsafe"></span><span id="index-AS_002dUnsafe"></span><span id="index-Async_002dSignal_002dUnsafe"></span><span id="index-AC_002dUnsafe"></span><span id="index-Async_002dCancel_002dUnsafe"></span><code>MT-Unsafe</code> ， <code>AS-Unsafe</code> ， <code>AC-Unsafe</code>在上述安全上下文中调用这些功能并不安全。在这样的上下文中调用它们会调用未定义的行为。

<p>在安全范围内未明确记录为安全的功能应视为不安全。
</p>

</li><li> <span id="index-Preliminary"></span><code>Preliminary</code>安全属性已记录在案，表明在将来的GNU C库发行版中可能<em>不会</em>考虑这些属性。

<p>这些初步属性是对我们当前实施的属性进行评估的结果，而不是对当前和未来标准所要求和允许的内容的评估。
</p>
<p>尽管我们努力遵守标准，但在某些情况下，即使标准不要求安全，我们的实施也是安全的；在其他情况下，我们的实施不符合标准的安全要求。后者很可能是错误；前者标记为<code>Preliminary</code> ，则不应指望：将来的标准可能会要求进行与当前实施方案提供的其他安全属性不兼容的更改。
</p>
<p>此外，POSIX标准未提供安全性的详细定义。我们假设，通过“安全调用”，POSIX意味着，只要程序不调用未定义的行为，“安全调用”功能就按照指定的方式运行，并且不会导致其他功能偏离其指定的行为。我们选择使用其宽松的安全性定义，不是因为它们是使用的最佳定义，而是因为选择它们会使本手册与POSIX保持一致。</p>
<p>请记住，这些只是初步的定义和注释，并且这些定义的某些方面仍在讨论中，可能需要澄清或更改。
</p>
<p>随着时间的流逝，我们设想将初步的安全注意事项发展为与我们的界面一样稳定的承诺。这样做时，我们将删除<code>Preliminary</code>安全说明中的关键字。但是，只要保留关键字，就不应将它们视为对未来行为的承诺。
</p>

</li></ul>

<p>安全说明中出现的其他关键字将在后续章节中定义。
</p>

<hr>
<div class="header">
<p>下一页： <a href="Unsafe-Features.html#Unsafe-Features" rel="next" accesskey="n">不安全的功能</a> ，向上： <a href="POSIX.html#POSIX" rel="up" accesskey="u">POSIX</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>