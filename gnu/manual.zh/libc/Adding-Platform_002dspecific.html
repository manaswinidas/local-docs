<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>添加特定于平台的（GNU C库）</title>

<meta name="description" content="Adding Platform-specific (The GNU C Library)">
<meta name="keywords" content="Adding Platform-specific (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Source-Layout.html#Source-Layout" rel="up" title="Source Layout">
<link href="Symbol-handling.html#Symbol-handling" rel="next" title="Symbol handling">
<link href="Source-Layout.html#Source-Layout" rel="prev" title="Source Layout">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Adding-Platform_002dspecific"></span><div class="header">
<p>上一篇： <a href="Source-Layout.html#Source-Layout" rel="up" accesskey="u">源代码布局</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="Platform_002dspecific-types_002c-macros-and-functions"></span><h4 class="appendixsubsec">D.1.1特定于平台的类型，宏和功能</h4>

<p>有时有必要向开发人员提供非标准的，特定于平台的功能。传统上，C库是最低的库层，因此提供这些低级功能很有意义。但是，如果另一个软件包提供了这些功能，则将这些功能包含在C库中可能会很不利，并且它们会有两个相互矛盾的版本。而且，这些功能将不适用于不使用GNU C库但使用其他GNU工具（例如GCC）的项目。</p>
<p>当前的准则是：</p><ul>
<li>如果头文件提供的功能仅在特定的计算机体系结构上有意义，而与操作系统无关，那么最终应将这些功能作为GCC内置功能提供。在此之前，GNU C库可以在头文件中提供它们。当GCC内置功能可用时，应在提供内置功能的GCC版本之前有条件地使头文件中提供的那些功能有条件地可用。

</li><li>如果头文件提供了特定于操作系统的功能，则GCC和GNU C库都可以提供该文件，但是首选GNU C库，因为它已经具有许多有关操作系统的信息。

</li><li>如果头文件提供了特定于操作系统但由GNU C库使用的功能，则GNU C库应提供它们。
</li></ul>

<p>提供低级功能的一般解决方案是按以下方式导出它们：</p>
<ul>
<li>应该调用定义宏和内联函数的非标准，低级头文件<samp>sys/platform/<var>name</var>.h</samp> 。

</li><li>每个头文件的名称都应包括平台名称，以避免用户认为针对不同平台的不同头文件之间存在任何共同点。例如，一个<samp>sys/platform/<var>arch</var>.h</samp>诸如<samp>sys/platform/ppc.h</samp>胜过<samp>sys/platform.h</samp> 。

</li><li>由GNU C库提供的特定于平台的头文件应与GCC协调，这样，如果可用，则首选内置函数和宏的编译器版本。这意味着用户程序将只需要包含<samp>sys/platform/<var>arch</var>.h</samp> ，为方便起见和可移植性，保持类型，宏和函数的名称相同。

</li><li>每个包含的符号必须具有前缀<code>__<var>arch</var>_</code> ， 如<code>__ppc_get_timebase</code> 。
</li></ul>


<p>提供头文件的最简单方法是将其添加到<code>sysdep_headers</code>变量。例如，可以在PowerPC上提供特定于Linux的头文件的组合，如下所示：</p>
<div class="example">
<pre class="example">sysdep_headers += sys/platform/ppc.h
</pre></div>

<p>然后确保您已添加<samp>sys/platform/ppc.h</samp>机器专用目录中的头文件，例如<samp>sysdeps/powerpc/sys/platform/ppc.h</samp> 。
</p>

<hr>
<div class="header">
<p>上一篇： <a href="Source-Layout.html#Source-Layout" rel="up" accesskey="u">源代码布局</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>