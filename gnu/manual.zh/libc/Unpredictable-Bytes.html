<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>不可预测的字节（GNU C库）</title>

<meta name="description" content="Unpredictable Bytes (The GNU C Library)">
<meta name="keywords" content="Unpredictable Bytes (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Cryptographic-Functions.html#Cryptographic-Functions" rel="up" title="Cryptographic Functions">
<link href="Debugging-Support.html#Debugging-Support" rel="next" title="Debugging Support">
<link href="Passphrase-Storage.html#Passphrase-Storage" rel="prev" title="Passphrase Storage">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Unpredictable-Bytes"></span><div class="header">
<p>上<a href="Passphrase-Storage.html#Passphrase-Storage" rel="prev" accesskey="p">一篇</a> ： <a href="Passphrase-Storage.html#Passphrase-Storage" rel="prev" accesskey="p">密码存储</a> ，上<a href="Passphrase-Storage.html#Passphrase-Storage" rel="prev" accesskey="p">一篇</a> ： <a href="Cryptographic-Functions.html#Cryptographic-Functions" rel="up" accesskey="u">密码功能</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="Generating-Unpredictable-Bytes"></span><h3 class="section">33.2生成不可预测的字节</h3>
<span id="index-randomness-source"></span>
<span id="index-random-numbers_002c-cryptographic"></span>
<span id="index-pseudo_002drandom-numbers_002c-cryptographic"></span>
<span id="index-cryptographic-random-number-generator"></span>
<span id="index-deterministic-random-bit-generator"></span>
<span id="index-CRNG"></span>
<span id="index-CSPRNG"></span>
<span id="index-DRBG"></span>

<p>加密应用程序通常需要一些随机数据，这些数据对于敌对的窃听者来说将尽可能地难以猜测。例如，应该随机选择加密密钥，并且使用“盐”字符串<code>crypt</code> （请参阅<a href="Passphrase-Storage.html#Passphrase-Storage">密码短语存储</a> ）也应随机选择。
</p>
<p>某些伪随机数生成器无法为密码应用程序提供足够的不可预测的输出。请参阅<a href="Pseudo_002dRandom-Numbers.html#Pseudo_002dRandom-Numbers">伪随机数</a> 。此类应用程序需要使用<em>加密随机数生成器</em> （CRNG），有时也称为<em>加密强伪随机数生成器</em> （CSPRNG）或<em>确定性随机比特生成器</em> （DRBG）。
</p>
<p>当前，GNU C库不提供加密随机数生成器，但确实提供了从操作系统提供的<em>随机性源</em>中读取随机数据的函数。随机源本质上是CRNG，但它也不断从物理随机源（例如电子噪声和时钟抖动）中“重新种子化”。这意味着应用程序无需执行任何操作即可确保每次运行时产生的随机数都不同。
</p>
<p>但是要注意的是，这些函数在任何一个调用中只会产生相对较短的随机字符串。通常这不是问题，但是需要超过几千字节的加密强随机数据的应用程序应调用这些函数一次，并使用其输出来播种CRNG。</p>
<p>大多数应用程序应使用<code>getentropy</code> 。的<code>getrandom</code>该功能适用于需要对阻塞行为进行额外控制的低级应用程序。
</p>
<dl>
<dt id="index-getentropy">函数： <em>int</em> <strong>熵</strong> <em>（无效* <var>buffer</var> ，size_t <var>length</var> ）</em></dt>
<dd>
<p>| MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>


<p>该函数写的准确<var>length</var>从数组开始的随机数据字节数<var>buffer</var> 。 <var>length</var>不能超过256。成功时，它返回零。失败时，它返回<em>-1</em> ，并且<code>errno</code>设置为指示问题。下面列出了一些可能的错误。
</p>
<dl compact>
<dt><code>ENOSYS</code></dt>
<dd><p>操作系统没有实现随机性源，或者不支持这种访问方式。（例如，此功能使用的系统调用已添加到版本3.17的Linux内核中。）
</p>
</dd>
<dt><code>EFAULT</code></dt>
<dd><p>的结合<var>buffer</var>和<var>length</var>参数指定无效的内存范围。
</p>
</dd>
<dt><code>EIO</code></dt>
<dd><p><var>length</var>大于256，或者内核熵池遭受了灾难性故障。
</p></dd>
</dl>

<p>致电<code>getentropy</code>只能在系统刚刚启动且随机源尚未初始化时阻止。但是，如果确实发生阻塞，则不能通过信号或线程取消来中断它。打算在引导过程的早期阶段运行的程序可能需要使用<code>getrandom</code>而是使用非阻塞模式，并准备好应对根本不可用的随机数据。
</p>
<p>的<code>getentropy</code>函数在头文件中声明<samp>sys/random.h</samp> 。它源自OpenBSD。</p></dd></dl>

<dl>
<dt id="index-getrandom">函数： <em>ssize_t</em> <strong>getrandom</strong> <em>（无效* <var>buffer</var> ，size_t <var>length</var> ，unsigned int <var>flags</var> ）</em></dt>
<dd>
<p>| MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>


<p>该功能写到<var>length</var>从数组开始的随机数据字节数<var>buffer</var> 。的<var>flags</var>参数应为零，或为以下某些标志的按位或：</p>
<dl compact>
<dt><code>GRND_RANDOM</code></dt>
<dd><p>使用<samp>/dev/random</samp> （屏蔽）源，而不是<samp>/dev/urandom</samp> （非阻塞）源以获得随机性。
</p>
<p>如果指定了此标志，则即使初始化了随机源，该调用也可能会阻塞一段时间。如果未指定，则仅在系统刚刚启动且随机源尚未初始化时，该调用才能阻塞。
</p>
</dd>
<dt><code>GRND_NONBLOCK</code></dt>
<dd><p>如果没有可用数据，请立即阻止返回调用者而不是阻止它。
</p></dd>
</dl>

<p>不像<code>getentropy</code> ， <code>getrandom</code>该功能是一个取消点，如果阻塞，则可能会被信号中断。
</p>
<p>成功的话<code>getrandom</code>返回已写入缓冲区的字节数，该字节数可能小于<var>length</var> 。如果出错，则返回<em>-1</em> ，并且<code>errno</code>设置为指示问题。一些可能的错误是：</p>
<dl compact>
<dt><code>ENOSYS</code></dt>
<dd><p>操作系统没有实现随机性源，或者不支持这种访问方式。（例如，此功能使用的系统调用已添加到版本3.17的Linux内核中。）
</p>
</dd>
<dt><code>EAGAIN</code></dt>
<dd><p>没有可用的随机数据， <code>GRND_NONBLOCK</code>在中指定<var>flags</var> 。
</p>
</dd>
<dt><code>EFAULT</code></dt>
<dd><p>的结合<var>buffer</var>和<var>length</var>参数指定无效的内存范围。
</p>
</dd>
<dt><code>EINTR</code></dt>
<dd><p>系统调用被中断。在系统引导过程中，初始化内核随机池之前，即使<var>flags</var>是零。
</p>
</dd>
<dt><code>EINVAL</code></dt>
<dd><p>的<var>flags</var>参数包含无效的标志组合。
</p></dd>
</dl>

<p>的<code>getrandom</code>函数在头文件中声明<samp>sys/random.h</samp> 。它是GNU扩展。
</p>
</dd></dl>
<hr>
<div class="header">
<p>上<a href="Passphrase-Storage.html#Passphrase-Storage" rel="prev" accesskey="p">一篇</a> ： <a href="Passphrase-Storage.html#Passphrase-Storage" rel="prev" accesskey="p">密码存储</a> ，上<a href="Passphrase-Storage.html#Passphrase-Storage" rel="prev" accesskey="p">一篇</a> ： <a href="Cryptographic-Functions.html#Cryptographic-Functions" rel="up" accesskey="u">密码功能</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>