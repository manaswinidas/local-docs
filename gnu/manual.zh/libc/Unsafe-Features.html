<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>不安全的功能（GNU C库）</title>

<meta name="description" content="Unsafe Features (The GNU C Library)">
<meta name="keywords" content="Unsafe Features (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="POSIX.html#POSIX" rel="up" title="POSIX">
<link href="Conditionally-Safe-Features.html#Conditionally-Safe-Features" rel="next" title="Conditionally Safe Features">
<link href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts" rel="prev" title="POSIX Safety Concepts">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Unsafe-Features"></span><div class="header">
<p>下一篇： <a href="Conditionally-Safe-Features.html#Conditionally-Safe-Features" rel="next" accesskey="n">有条件的安全功能</a> ，上一篇： <a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts" rel="prev" accesskey="p">POSIX安全概念</a> ，上一篇： <a href="POSIX.html#POSIX" rel="up" accesskey="u">POSIX</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="Unsafe-Features-1"></span><h4 class="subsubsection">1.2.2.2不安全功能</h4>
<span id="index-Unsafe-Features"></span>

<p>在某些上下文中不安全调用的函数用关键字注释，这些关键字记录了使它们不安全调用的功能。本节中的AS-Unsafe功能指示启用异步信号后，这些功能永远不会安全调用。AC不安全功能指示启用异步取消后，它们永远不会安全地呼叫。本节中没有MT-不安全标记。
</p>
<ul>
<li> <code>lock</code>
<span id="index-lock"></span>

<p>标有功能<code>lock</code>持有非递归锁时，AS-Unsafe功能可能会被信号打断。如果信号处理程序调用另一个获得相同锁的此类函数，则结果将导致死锁。
</p>
<p>带注释的功能<code>lock</code>因为如果不异步取消AC不安全功能，则可能无法释放如果异步线程取消并未中断其执行的情况下将释放的锁。留下锁后，尝试取该锁将无限期地阻塞。
</p>

</li><li> <code>corrupt</code>
<span id="index-corrupt"></span>

<p>标有功能<code>corrupt</code>因为不安全AS的功能可能会破坏数据结构，并在它们中断或被另一个此类功能中断时出现异常。与标有功能的功能不同<code>lock</code> ，它们采取递归锁定来避免MT安全问题，但这不足以阻止信号处理程序观察部分更新的数据结构。中断的函数无法注意到信号处理程序所做的更新，可能会导致进一步的损坏。
</p>
<p>标有功能<code>corrupt</code>因为AC不安全功能可能会使数据结构处于损坏的，部分更新的状态。数据结构的后续使用可能会发生错误。
</p>


</li><li> <code>heap</code>
<span id="index-heap"></span>

<p>标有功能<code>heap</code>可以从中调用堆内存管理功能<code>malloc</code> / <code>free</code>系列功能，并且仅与这些功能一样安全。因此，此注释等效于：</p>
<p>| AS不安全锁| AC不安全锁fd mem |</p>



</li><li> <code>dlopen</code>
<span id="index-dlopen"></span>

<p>标有功能<code>dlopen</code>使用动态加载程序将共享库加载到当前执行映像中。这涉及打开文件，将它们映射到内存，分配额外的内存，解析符号，应用重定位等等，所有这些都保持内部动态加载程序锁。
</p>
<p>这些锁足以使这些功能处于AS和AC不安全状态，但是可能会出现其他问题。目前，这是占位符提出的所有潜在安全问题的占位符<code>dlopen</code> 。
</p>


</li><li> <code>plugin</code>
<span id="index-plugin"></span>

<p>带注释的功能<code>plugin</code>可以从GNU C库外部的插件中运行代码。假定此类插件功能为MT安全，AS不安全和AC不安全。此类插件的示例是堆栈<span id="index-NSS"></span>展开库，名称服务开关（NSS）和字符集<span id="index-iconv"></span>转换（iconv）后端。
</p>
<p>尽管作为示例提到的插件都是通过dlopen引入的， <code>plugin</code>关键字并不意味着动态加载程序或<code>libdl</code>接口，这些都由<code>dlopen</code> 。例如，如果一个函数加载一个模块并找到其某些函数的地址，而另一个函数仅调用那些已经解析的函数，则前者将标记为<code>dlopen</code> ，而后者将获得<code>plugin</code> 。当单个函数执行所有这些操作时，它将同时获得两个标记。
</p>

</li><li> <code>i18n</code>
<span id="index-i18n"></span>

<p>标有功能<code>i18n</code>可以称为<code>gettext</code>家庭，只会和这些功能一样安全。因此，此注释等效于：</p>
<p>| MT安全环境| AS不安全损坏的堆dlopen | AC不安全的腐败|</p>



</li><li> <code>timer</code>
<span id="index-timer"></span>

<p>标有功能<code>timer</code>使用<code>alarm</code>功能或类似功能来设置系统调用或长时间运行的操作的超时时间。在多线程程序中，存在超时信号将传递到其他线程的风险，从而无法中断预期的线程。除了MT不安全之外，此类功能始终为AS不安全，因为在信号处理程序中调用它们可能会干扰在中断代码中设置的计时器以及AC不安全，因为没有安全的方法可以确保在其中重置较早的计时器异步取消的情况。
</p>
</li></ul>


<hr>
<div class="header">
<p>下一篇： <a href="Conditionally-Safe-Features.html#Conditionally-Safe-Features" rel="next" accesskey="n">有条件的安全功能</a> ，上一篇： <a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts" rel="prev" accesskey="p">POSIX安全概念</a> ，上一篇： <a href="POSIX.html#POSIX" rel="up" accesskey="u">POSIX</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>