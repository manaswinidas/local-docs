<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>向NSS添加另一个服务（GNU C库）</title>

<meta name="description" content="Adding another Service to NSS (The GNU C Library)">
<meta name="keywords" content="Adding another Service to NSS (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Extending-NSS.html#Extending-NSS" rel="up" title="Extending NSS">
<link href="NSS-Module-Function-Internals.html#NSS-Module-Function-Internals" rel="next" title="NSS Module Function Internals">
<link href="Extending-NSS.html#Extending-NSS" rel="prev" title="Extending NSS">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Adding-another-Service-to-NSS"></span><div class="header">
<p>下一篇： <a href="NSS-Module-Function-Internals.html#NSS-Module-Function-Internals" rel="next" accesskey="n">NSS模块功能内部知识</a> ，上一篇： <a href="Extending-NSS.html#Extending-NSS" rel="prev" accesskey="p">扩展NSS</a> ，上一篇： <a href="Extending-NSS.html#Extending-NSS" rel="up" accesskey="u">扩展NSS</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="Adding-another-Service-to-NSS-1"></span><h4 class="subsection">29.4.1向NSS添加另一个服务</h4>

<p>新服务的源不必（也不应）是GNU C库本身的一部分。开发人员保留对源代码及其开发的完全控制。C库和新服务模块之间的链接仅由接口功能组成。
</p>
<p>每个模块均按照特定的接口规范进行设计。现在，版本为2（版本1中的接口还不够），这体现在NSS模块的共享库对象的版本号中：它们具有扩展名<code>.2</code> 。如果接口以不兼容的方式再次更改，则此数字将增加。使用旧界面的模块仍然可以使用。
</p>
<p>新服务的开发人员必须确保使用正确的接口号创建其模块。这意味着文件本身必须具有正确的名称，并且在ELF系统上， <em>soname</em> （共享对象名称）也必须具有该编号。使用GNU CC在ELF系统上从一堆目标文件构建模块可以像这样完成：</p>
<div class="example">
<pre class="example">gcc -shared -o libnss_NAME.so.2 -Wl,-soname,libnss_NAME.so.2 OBJECTS
</pre></div>

<p><cite>GNU CC中</cite> <a href="https://gcc.gnu.org/onlinedocs/gcc/Link-Options.html#Link-Options">用于链接的选项</a> ，以了解有关此命令行的更多信息。
</p>
<p>要使用新模块，库必须能够找到它。这可以通过使用动态链接程序的选项来实现，以便它可以搜索二进制文件所在的目录。对于ELF系统，可以通过将所需目录添加到以下值来完成： <code>LD_LIBRARY_PATH</code> 。
</p>
<p>但这并不总是可能的，因为某些程序（那些以不属于用户的ID运行的程序）会忽略此变量。因此，应将模块的稳定版本放在动态链接程序搜索的目录中。通常这应该是目录<samp>$prefix/lib</samp> ，在哪里<samp>$prefix</samp>对应于使用<code>--prefix</code>选项。但是要小心：只有在明确模块不会造成任何伤害的情况下，才应这样做。系统管理员应小心。
</p>

<hr>
<div class="header">
<p>下一篇： <a href="NSS-Module-Function-Internals.html#NSS-Module-Function-Internals" rel="next" accesskey="n">NSS模块功能内部知识</a> ，上一篇： <a href="Extending-NSS.html#Extending-NSS" rel="prev" accesskey="p">扩展NSS</a> ，上一篇： <a href="Extending-NSS.html#Extending-NSS" rel="up" accesskey="u">扩展NSS</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>