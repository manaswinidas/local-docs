<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>环境访问（GNU C库）</title>

<meta name="description" content="Environment Access (The GNU C Library)">
<meta name="keywords" content="Environment Access (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Environment-Variables.html#Environment-Variables" rel="up" title="Environment Variables">
<link href="Standard-Environment.html#Standard-Environment" rel="next" title="Standard Environment">
<link href="Environment-Variables.html#Environment-Variables" rel="prev" title="Environment Variables">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Environment-Access"></span><div class="header">
<p>下一页： <a href="Standard-Environment.html#Standard-Environment" rel="next" accesskey="n">标准环境</a> ，上一页： <a href="Environment-Variables.html#Environment-Variables" rel="up" accesskey="u">环境变量</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="Environment-Access-1"></span><h4 class="subsection">25.4.1环境访问</h4>
<span id="index-environment-access"></span>
<span id="index-environment-representation"></span>

<p>可以使用以下命令访问环境变量的值<code>getenv</code>功能。在头文件中声明<samp>stdlib.h</samp> 。
<span id="index-stdlib_002eh-20"></span>
</p>
<p>图书馆应使用<code>secure_getenv</code>代替<code>getenv</code> ，这样他们就不会意外使用不受信任的环境变量。多线程程序中不允许修改环境变量。的<code>getenv</code>和<code>secure_getenv</code>函数可以安全地在多线程程序中使用。
</p>
<dl>
<dt id="index-getenv">函数： <em>char *</em> <strong>getenv</strong> <em>（const char * <var>name</var> ）</em></dt>
<dd>
<p>初步： MT安全环境| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>此函数返回一个字符串，该字符串是环境变量的值<var>name</var> 。您不得修改此字符串。在某些未使用GNU C库的非Unix系统中，随后的调用可能会覆盖它。 <code>getenv</code> （但其他任何库函数都没有）。如果环境变量<var>name</var>未定义，该值为空指针。
</p></dd></dl>

<dl>
<dt id="index-secure_005fgetenv">函数： <em>char *</em> <strong>secure_getenv</strong> <em>（const char * <var>name</var> ）</em></dt>
<dd>
<p>初步： MT安全环境| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>该功能类似于<code>getenv</code> ，但是如果环境不受信任，它将返回空指针。当程序文件设置了SUID或SGID位时，会发生这种情况。通用库应始终偏爱此功能<code>getenv</code>如果从SUID / SGID程序引用了库，则可以避免漏洞。
</p>
<p>此函数是GNU扩展。
</p></dd></dl>


<dl>
<dt id="index-putenv">函数： <em>int</em> <strong>putenv</strong> <em>（char * <var>string</var> ）</em></dt>
<dd>
<p>初步： MT不安全const：env | AS不安全堆锁| AC不安全损坏的锁内存|请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>putenv</code>函数从环境中添加或删除定义。如果<var>string</var>格式为“ <samp><var>name</var>=<var>value</var></samp> '，将定义添加到环境中。否则， <var>string</var>被解释为环境变量的名称，并且该变量在环境中的任何定义都将被删除。
</p>
<p>如果函数成功，则返回<code>0</code> 。否则，返回值为非零，并且<code>errno</code>设置为指示错误。
</p>
<p>区别于<code>setenv</code>函数是作为参数给出的确切字符串<var>string</var>被放入环境。如果用户应该在<code>putenv</code>调用它将自动反映在环境中。这也要求<var>string</var>不能是将其范围从环境中删除之前保留其作用域的自动变量。当然，这同样适用于以后释放的动态分配变量。
</p>
<p>此功能是扩展Unix接口的一部分。你应该定义<var>_XOPEN_SOURCE</var>包括任何标题之前。
</p></dd></dl>


<dl>
<dt id="index-setenv">函数： <em>int</em> <strong>setenv</strong> <em>（const char * <var>name</var> ，const char * <var>value</var> ，int <var>replace</var> ）</em></dt>
<dd>
<p>初步： MT不安全const：env | AS不安全堆锁| AC不安全损坏的锁内存|请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>setenv</code>函数可用于向环境添加新定义。名称条目<var>name</var>替换为值“ <samp><var>name</var>=<var>value</var></samp> '。请注意，如果<var>value</var>是空字符串。为此，将创建一个新字符串，然后将字符串<var>name</var>和<var>value</var>被复制。的空指针<var>value</var>参数非法。如果环境已经包含带有密钥的条目<var>name</var>的<var>replace</var>参数控制动作。如果replace为零，则什么也不会发生。否则，旧条目将被新条目替换。
</p>
<p>请注意，您无法使用此功能完全删除条目。
</p>
<p>如果函数成功，则返回<code>0</code> 。否则环境不变，返回值为<code>-1</code>和<code>errno</code>被设置。
</p>
<p>该函数最初是BSD库的一部分，但现在是Unix标准的一部分。
</p></dd></dl>

<dl>
<dt id="index-unsetenv">函数： <em>int</em> <strong>unsetenv</strong> <em>（const char * <var>name</var> ）</em></dt>
<dd>
<p>初步： MT不安全const：env | AS不安全锁| AC不安全锁|请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>使用此功能，可以从环境中完全删除一项。如果环境包含带有密钥的条目<var>name</var>这整个条目将被删除。对该函数的调用等效于对<code>putenv</code>当。。。的时候<var>value</var>字符串的一部分为空。
</p>
<p>函数返回<code>-1</code>如果<var>name</var>是一个空指针，指向一个空字符串，或指向一个包含<code>=</code>字符。它返回<code>0</code>如果呼叫成功。
</p>
<p>该函数最初是BSD库的一部分，但现在是Unix标准的一部分。但是，BSD版本没有返回值。
</p></dd></dl>

<p>还有一个功能可以修改整个环境。据说此功能已在POSIX.9（用于Fortran 77的POSIX绑定）中使用，因此应该期望它确实已将其集成到POSIX.1中。但这从来没有发生过。但是我们仍然提供此功能作为GNU扩展，以支持编写符合标准的Fortran环境。
</p>
<dl>
<dt id="index-clearenv">函数： <em>int</em> <strong>clearenv</strong> <em>（void）</em></dt>
<dd>
<p>初步： MT不安全const：env | AS不安全堆锁| AC不安全锁记忆|请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>clearenv</code>函数从环境中删除所有条目。使用<code>putenv</code>和<code>setenv</code>以后可以再次添加新条目。
</p>
<p>如果函数成功，则返回<code>0</code> 。否则，返回值为非零。
</p></dd></dl>


<p>您可以直接处理环境对象的基础表示形式，以向环境中添加更多变量（例如，与要执行的另一个程序进行通信；请参阅<a href="Executing-a-File.html#Executing-a-File">执行文件</a> ）。
</p>
<dl>
<dt id="index-environ">变量： <em>char **</em> <strong>environ</strong></dt>
<dd>
<p>环境表示为字符串数组。每个字符串的格式为“ <samp><var>name</var>=<var>value</var></samp> '。字符串在环境中出现的顺序并不重要，但是相同<var>name</var>不得出现多次。数组的最后一个元素是空指针。
</p>
<p>该变量在头文件中声明<samp>unistd.h</samp> 。
</p>
<p>如果只想获取环境变量的值，请使用<code>getenv</code> 。
</p></dd></dl>

<p>Unix系统和GNU系统传递初始值<code>environ</code>作为第三个论点<code>main</code> 。请参阅<a href="Program-Arguments.html#Program-Arguments">程序参数</a> 。
</p>
<hr>
<div class="header">
<p>下一页： <a href="Standard-Environment.html#Standard-Environment" rel="next" accesskey="n">标准环境</a> ，上一页： <a href="Environment-Variables.html#Environment-Variables" rel="up" accesskey="u">环境变量</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>