<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>mtab（GNU C库）</title>

<meta name="description" content="mtab (The GNU C Library)">
<meta name="keywords" content="mtab (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Mount-Information.html#Mount-Information" rel="up" title="Mount Information">
<link href="Other-Mount-Information.html#Other-Mount-Information" rel="next" title="Other Mount Information">
<link href="fstab.html#fstab" rel="prev" title="fstab">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="mtab"></span><div class="header">
<p>下一篇： <a href="Other-Mount-Information.html#Other-Mount-Information" rel="next" accesskey="n">其他安装信息</a> ，上一篇： <a href="fstab.html#fstab" rel="prev" accesskey="p">fstab</a> ，上一篇： <a href="Mount-Information.html#Mount-Information" rel="up" accesskey="u">安装信息</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="The-mtab-file"></span><h4 class="subsubsection">31.3.1.2 <samp>mtab</samp>文件</h4>
<p>以下功能和数据结构访问<samp>mtab</samp>文件。
</p>
<dl>
<dt id="index-struct-mntent">数据类型： <strong>struct mntent</strong></dt>
<dd>
<p>此结构与<code>getmntent</code> ， <code>getmntent_r</code> ， <code>addmntent</code>和<code>hasmntopt</code>功能。
</p>
<dl compact>
<dt><code>char *mnt_fsname</code></dt>
<dd><p>该元素包含一个指向字符串的指针，该字符串描述从中挂载文件系统的特殊设备的名称。它对应于<code>fs_spec</code>元素在<code>struct fstab</code> 。
</p>
</dd>
<dt><code>char *mnt_dir</code></dt>
<dd><p>该元素指向描述文件系统安装点的字符串。它对应于<code>fs_file</code>元素在<code>struct fstab</code> 。
</p>
</dd>
<dt><code>char *mnt_type</code></dt>
<dd><p><code>mnt_type</code>描述文件系统类型，因此等效于<code>fs_vfstype</code>在<code>struct fstab</code> 。<samp>mntent.h</samp>为该字符串可以具有的某些值定义一些符号名称。但是由于内核可以支持任意文件系统，因此给它们指定符号名没有多大意义。如果知道符号名称，那么也知道文件系统名称。不过，以下是提供的符号列表<samp>mntent.h</samp> 。
</p>
<dl compact>
<dt><code>MNTTYPE_IGNORE</code>
<span id="index-MNTTYPE_005fIGNORE"></span>
</dt>
<dd><p>此符号扩展为<code>"ignore"</code> 。该值有时用于<samp>fstab</samp>文件以确保不删除条目就不会使用它们。
</p></dd>
<dt><code>MNTTYPE_NFS</code>
<span id="index-MNTTYPE_005fNFS"></span>
</dt>
<dd><p>扩展到<code>"nfs"</code> 。有时使用此宏可能很有意义，因为它可以命名默认的NFS实现，以防同时支持版本2和3。
</p></dd>
<dt><code>MNTTYPE_SWAP</code>
<span id="index-MNTTYPE_005fSWAP"></span>
</dt>
<dd><p>此符号扩展为<code>"swap"</code> 。它的名字特别<samp>fstab</samp>该条目命名可能为多个交换分区之一。
</p></dd>
</dl>

</dd>
<dt><code>char *mnt_opts</code></dt>
<dd><p>元素包含一个字符串，描述安装文件系统时使用的选项。至于等效元素<code>fs_mntops</code>的<code>struct fstab</code>最好使用该功能<code>getsubopt</code> （请参阅<a href="Suboptions.html#Suboptions">Suboptions</a> ）以访问此字符串的各个部分。
</p>
<p>的<samp>mntent.h</samp>文件定义了许多带有字符串值的宏，这些字符串值与内核可以理解的某些选项相对应。可能还有更多选项，因此依赖这些宏没有太大意义，但要保持一致，请参见以下列表：</p>
<dl compact>
<dt><code>MNTOPT_DEFAULTS</code>
<span id="index-MNTOPT_005fDEFAULTS"></span>
</dt>
<dd><p>扩展到<code>"defaults"</code> 。此选项应单独使用，因为它指示所有可定制值的值均被选择为默认值。
</p></dd>
<dt><code>MNTOPT_RO</code>
<span id="index-MNTOPT_005fRO"></span>
</dt>
<dd><p>扩展到<code>"ro"</code> 。见<code>FSTAB_RO</code>值，表示文件系统是只读安装的。
</p></dd>
<dt><code>MNTOPT_RW</code>
<span id="index-MNTOPT_005fRW"></span>
</dt>
<dd><p>扩展到<code>"rw"</code> 。见<code>FSTAB_RW</code>值，表示文件系统已安装，具有读写权限。
</p></dd>
<dt><code>MNTOPT_SUID</code>
<span id="index-MNTOPT_005fSUID"></span>
</dt>
<dd><p>扩展到<code>"suid"</code> 。这意味着从文件系统启动程序时，应遵守SUID位（请参阅<a href="How-Change-Persona.html#How-Change-Persona">如何更改角色</a> ）。
</p></dd>
<dt><code>MNTOPT_NOSUID</code>
<span id="index-MNTOPT_005fNOSUID"></span>
</dt>
<dd><p>扩展到<code>"nosuid"</code> 。这是相反的<code>MNTOPT_SUID</code> ，将忽略文件系统中所有文件的SUID位。
</p></dd>
<dt><code>MNTOPT_NOAUTO</code>
<span id="index-MNTOPT_005fNOAUTO"></span>
</dt>
<dd><p>扩展到<code>"noauto"</code> 。在启动时<code>mount</code>如果该程序以<code>-a</code>安装挂载中提到的所有文件系统的选项<samp>fstab</samp>文件。
</p></dd>
</dl>

<p>至于<code>FSTAB_*</code>以上介绍的条目非常重要<code>strcmp</code>检查是否平等。
</p>
</dd>
<dt><code>mnt_freq</code></dt>
<dd><p>该元素对应于<code>fs_freq</code>并指定以天为单位的转储频率。
</p>
</dd>
<dt><code>mnt_passno</code></dt>
<dd><p>该元素等效于<code>fs_passno</code>具有相同的含义，这对所有程序都没有意义<code>dump</code> 。
</p></dd>
</dl>
</dd></dl>

<p>用于访问<samp>mtab</samp>文件中又有一组三个函数来访问一行中的所有条目。不像要处理的功能<samp>fstab</samp>这些函数不访问固定文件，甚至没有get函数的线程安全变体。除此之外，GNU C库还包含更改文件和测试特定选项的功能。
</p>
<dl>
<dt id="index-setmntent">功能： <em>FILE *</em> <strong>setmntent</strong> <em>（const char * <var>file</var> ，const char * <var>mode</var> ）</em></dt>
<dd>
<p>初步： MT安全| AS不安全堆锁| AC不安全的内存fd锁|请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>setmntent</code>函数准备名为的文件<var>FILE</var>必须采用以下格式<samp>fstab</samp>和<samp>mtab</samp>通过家族的其他功能处理文件。的<var>mode</var>可以通过以下方式选择参数<var>opentype</var>的参数<code>fopen</code> （请参见<a href="Opening-Streams.html#Opening-Streams">打开流</a> ）。如果打开了用于写入的文件，则也允许该文件为空。
</p>
<p>如果文件成功打开<code>setmntent</code>返回文件句柄以备将来使用。否则返回值为<code>NULL</code>和<code>errno</code>被相应地设置。
</p></dd></dl>

<dl>
<dt id="index-endmntent">函数： <em>int</em> <strong>endmntent</strong> <em>（FILE * <var>stream</var> ）</em></dt>
<dd>
<p>初步： MT安全| AS不安全堆锁| AC不安全锁内存fd |请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>此功能用于<var>stream</var>参数文件句柄，该文件句柄以前是从<code>setmntent</code>呼叫。
<code>endmntent</code>关闭流并释放所有资源。
</p>
<p>除非发生错误，否则返回值为<em>1，</em>否则为<em>0</em> 。
</p></dd></dl>

<dl>
<dt id="index-getmntent">功能： <em>struct mntent *</em> <strong>getmntent</strong> <em>（FILE * <var>stream</var> ）</em></dt>
<dd>
<p>初步： MT不安全种族：mntentbuf语言环境| AS不安全的损坏堆初始化| AC不安全的初始化损坏的锁内存|请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>getmntent</code>函数将成功调用之前返回的文件句柄作为参数<code>setmntent</code> 。它返回一个指向类型为静态变量的指针<code>struct mntent</code>其中填充了当前读取文件中下一个条目的信息。
</p>
<p>所使用的文件格式规定使用空格或制表符分隔字段。这使得使用包含这些字符之一的名称更加困难（例如，使用空格的安装点）。因此，这些字符被编码在文件中，并且<code>getmntent</code>函数在读回条目时负责解码。
<code>'\040'</code>用于编码空格字符， <code>'\011'</code>编码制表符， <code>'\012'</code>编码换行符，以及<code>'\\'</code>编码反斜杠。
</p>
<p>如果出现错误或到达文件末尾，则返回值为<code>NULL</code> 。
</p>
<p>此函数不是线程安全的，因为对该函数的所有调用都返回指向同一静态变量的指针。 <code>getmntent_r</code>应该在多个线程访问文件的情况下使用。
</p></dd></dl>

<dl>
<dt id="index-getmntent_005fr">功能： <em>struct mntent *</em> <strong>getmntent_r</strong> <em>（FILE * <var>stream</var> ，结构* <var>result</var> ，字符* <var>buffer</var> ，int <var>bufsize</var> ）</em></dt>
<dd>
<p>初步： MT安全区域| AS不安全的损坏堆| AC不安全损坏的锁内存|请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>getmntent_r</code>函数是的可重入变量<code>getmntent</code> 。它还返回文件中的下一个条目并返回一个指针。但是，值存储在其中的实际变量不是静态的。取而代之的是，函数将值存储在变量所指向的变量中。 <var>result</var>参数。附加信息（例如，结果元素所指向的字符串）保存在size的缓冲区中<var>bufsize</var>指向<var>buffer</var> 。
</p>
<p>转义字符（空格，制表符，反斜杠）的转换方式与<code>getmentent</code> 。
</p>
<p>该函数返回一个<code>NULL</code>错误情况下的指针。错误可能是：</p><ul>
<li>读取文件时出错，</li><li>到达文件末尾，</li><li> <var>bufsize</var>太小，无法阅读完整的新条目。
</li></ul>
</dd></dl>

<dl>
<dt id="index-addmntent">功能： <em>int</em> <strong>addmntent</strong> <em>（FILE * <var>stream</var> ，const struct mntent * <var>mnt</var> ）</em></dt>
<dd>
<p>初步： MT安全竞赛：流语言环境|不安全AS损坏| AC不安全的腐败|请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>addmntent</code>功能允许将新条目添加到以前使用以下文件打开的文件中<code>setmntent</code> 。新条目始终被附加。即，即使文件描述符的位置不在文件末尾，此功能也不会覆盖当前位置之后的现有条目。
</p>
<p>这就意味着要从文件中删除一项，必须创建一个新文件，同时保留要删除的项，并且在关闭文件后，删除旧项并将新文件重命名为所选名称。
</p>
<p>此功能照顾要写入文件的名称中的空格和制表符。它将它们和反斜杠字符转换为<code>getmntent</code>以上说明。
</p>
<p>如果操作成功，此函数将返回<em>0</em> 。否则，返回值为<em>1</em>并<code>errno</code>设置适当。
</p></dd></dl>

<dl>
<dt id="index-hasmntopt">功能： <em>char *</em> <strong>hasmntopt</strong> <em>（const struct mntent * <var>mnt</var> ，const char * <var>opt</var> ）</em></dt>
<dd>
<p>初步： MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>此函数可用于检查是否由字符串指向的字符串。 <code>mnt_opts</code>指向的变量的元素<var>mnt</var>包含选项<var>opt</var> 。如果为真，则指向该选项开头的指针<code>mnt_opts</code>元素被返回。如果不存在这样的选项，函数将返回<code>NULL</code> 。
</p>
<p>此功能对于测试是否存在特定选项很有用，但是当必须处理所有选项时，最好使用<code>getsubopt</code>函数遍历字符串中的所有选项。
</p></dd></dl>

<hr>
<div class="header">
<p>下一篇： <a href="Other-Mount-Information.html#Other-Mount-Information" rel="next" accesskey="n">其他安装信息</a> ，上一篇： <a href="fstab.html#fstab" rel="prev" accesskey="p">fstab</a> ，上一篇： <a href="Mount-Information.html#Mount-Information" rel="up" accesskey="u">安装信息</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>