<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Setuid的技巧（GNU C库）</title>

<meta name="description" content="Tips for Setuid (The GNU C Library)">
<meta name="keywords" content="Tips for Setuid (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Users-and-Groups.html#Users-and-Groups" rel="up" title="Users and Groups">
<link href="Who-Logged-In.html#Who-Logged-In" rel="next" title="Who Logged In">
<link href="Setuid-Program-Example.html#Setuid-Program-Example" rel="prev" title="Setuid Program Example">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Tips-for-Setuid"></span><div class="header">
<p>下一篇： <a href="Who-Logged-In.html#Who-Logged-In" rel="next" accesskey="n">登录者</a> ，上一篇： <a href="Setuid-Program-Example.html#Setuid-Program-Example" rel="prev" accesskey="p">Setuid程序示例</a> ，上一篇： <a href="Users-and-Groups.html#Users-and-Groups" rel="up" accesskey="u">用户和组</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="Tips-for-Writing-Setuid-Programs"></span><h3 class="section">30.10编写Setuid程序的技巧</h3>

<p>setuid程序很容易为用户提供非预期的访问权限-实际上，如果要避免这种情况，则需要小心。以下是一些指南，用于防止意外访问并在发生访问时将其影响降至最低：</p>
<ul>
<li>没有<code>setuid</code>具有特权用户ID的程序，例如<code>root</code>除非绝对必要。如果资源是特定于您的特定程序的，则最好只定义一个新的非特权用户ID或组ID来管理该资源。如果您可以编写程序以使用特殊组而不是特殊用户，那会更好。

</li><li>使用时请谨慎<code>exec</code>与更改有效用户ID结合使用。不要让您的程序用户在更改的用户ID下执行任意程序。执行shell尤其是个坏消息。不太明显的是<code>execlp</code>和<code>execvp</code>功能具有潜在风险（因为它们执行的程序取决于用户的<code>PATH</code>环境变量）。

<p>如果你必须<code>exec</code>另一个具有更改ID的程序，请为该可执行文件指定一个绝对文件名（请参阅“ <a href="File-Name-Resolution.html#File-Name-Resolution">文件名解析”</a> ），并确保对该可执行文件和<em>所有</em>包含目录的保护都使普通用户无法将其替换为其他程序。
</p>
<p>您还应该检查传递给程序的参数，以确保它们不会产生意外的影响。同样，您应该检查环境变量。确定哪些参数和变量是安全的，并拒绝所有其他参数和变量。
</p>
<p>你永远不要使用<code>system</code>在特权程序中，因为它调用外壳程序。
</p>
</li><li>仅在实际使用该资源的程序部分中使用控制资源的用户ID。完成后，将有效用户ID还原回实际用户的用户ID。请参阅<a href="Enable_002fDisable-Setuid.html#Enable_002fDisable-Setuid">启用/禁用Setuid</a> 。

</li><li>如果<code>setuid</code>程序的一部分需要访问除受控资源之外的其他文件，它应验证真实用户通常是否具有访问这些文件的权限。您可以使用<code>access</code>功能（请参阅<a href="Access-Permission.html#Access-Permission">访问权限</a> ）进行检查；它使用真实的用户和组ID，而不是有效的ID。
</li></ul>

<hr>
<div class="header">
<p>下一篇： <a href="Who-Logged-In.html#Who-Logged-In" rel="next" accesskey="n">登录者</a> ，上一篇： <a href="Setuid-Program-Example.html#Setuid-Program-Example" rel="prev" accesskey="p">Setuid程序示例</a> ，上一篇： <a href="Users-and-Groups.html#Users-and-Groups" rel="up" accesskey="u">用户和组</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>