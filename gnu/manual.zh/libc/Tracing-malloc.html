<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>跟踪malloc（GNU C库）</title>

<meta name="description" content="Tracing malloc (The GNU C Library)">
<meta name="keywords" content="Tracing malloc (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Allocation-Debugging.html#Allocation-Debugging" rel="up" title="Allocation Debugging">
<link href="Using-the-Memory-Debugger.html#Using-the-Memory-Debugger" rel="next" title="Using the Memory Debugger">
<link href="Allocation-Debugging.html#Allocation-Debugging" rel="prev" title="Allocation Debugging">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Tracing-malloc"></span><div class="header">
<p>下一页： <a href="Using-the-Memory-Debugger.html#Using-the-Memory-Debugger" rel="next" accesskey="n">使用内存调试器</a> ，上一篇： <a href="Allocation-Debugging.html#Allocation-Debugging" rel="up" accesskey="u">分配调试</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="How-to-install-the-tracing-functionality"></span><h4 class="subsubsection">3.2.4.1如何安装跟踪功能</h4>

<dl>
<dt id="index-mtrace">函数： <em>void</em> <strong>mtrace</strong> <em>（void）</em></dt>
<dd>
<p>初步： MT不安全的环境race：mtrace const：malloc_hooks init | AS不安全的初始化堆损坏锁AC不安全初始化损坏的锁fd mem |请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>


<p>当。。。的时候<code>mtrace</code>调用该函数会查找一个名为<code>MALLOC_TRACE</code> 。该变量应该包含有效的文件名。用户必须具有写访问权限。如果该文件已经存在，它将被截断。如果未设置环境变量或未命名环境变量，则可以打开该文件以进行任何写操作。的行为<code>malloc</code>等保持不变。出于明显的原因，如果应用程序的SUID或SGID位置1，则也会发生这种情况。
</p>
<p>如果命名文件成功打开， <code>mtrace</code>为功能安装特殊的处理程序<code>malloc</code> ， <code>realloc</code>和<code>free</code> （请参阅<a href="Hooks-for-Malloc.html#Hooks-for-Malloc">Hooks for Malloc</a> ）。从那时起，将跟踪这些功能的所有使用并将其协议化到文件中。当然，现在对跟踪函数的所有调用都会受到速度的影响，因此在正常使用期间不应启用跟踪。
</p>
<p>此功能是GNU扩展，通常在其他系统上不可用。原型可以在<samp>mcheck.h</samp> 。
</p></dd></dl>

<dl>
<dt id="index-muntrace">函数： <em>void</em> <strong>muntrace</strong> <em>（void）</em></dt>
<dd>
<p>初步： MT不安全种族：mtrace const：malloc_hooks语言环境| AS不安全的损坏堆| AC不安全损坏的内存锁fd |请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>


<p>的<code>muntrace</code>函数可以在之后调用<code>mtrace</code>用于启用跟踪<code>malloc</code>电话。如果没有（成功）呼叫<code>mtrace</code>被制造<code>muntrace</code>什么也没做。
</p>
<p>否则，它将卸载<code>malloc</code> ， <code>realloc</code>和<code>free</code>然后关闭协议文件。不再协议呼叫，程序再次全速运行。
</p>
<p>此功能是GNU扩展，通常在其他系统上不可用。原型可以在<samp>mcheck.h</samp> 。
</p></dd></dl>

<hr>
<div class="header">
<p>下一页： <a href="Using-the-Memory-Debugger.html#Using-the-Memory-Debugger" rel="next" accesskey="n">使用内存调试器</a> ，上一篇： <a href="Allocation-Debugging.html#Allocation-Debugging" rel="up" accesskey="u">分配调试</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>