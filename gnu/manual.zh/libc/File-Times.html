<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>文件时间（GNU C库）</title>

<meta name="description" content="File Times (The GNU C Library)">
<meta name="keywords" content="File Times (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="File-Attributes.html#File-Attributes" rel="up" title="File Attributes">
<link href="File-Size.html#File-Size" rel="next" title="File Size">
<link href="Testing-File-Access.html#Testing-File-Access" rel="prev" title="Testing File Access">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="File-Times"></span><div class="header">
<p>下一篇： <a href="File-Size.html#File-Size" rel="next" accesskey="n">文件大小</a> ，上一篇： <a href="Testing-File-Access.html#Testing-File-Access" rel="prev" accesskey="p">测试文件访问</a> ，上一篇： <a href="File-Size.html#File-Size" rel="next" accesskey="n">文件</a> <a href="File-Attributes.html#File-Attributes" rel="up" accesskey="u">属性</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="File-Times-1"></span><h4 class="subsection">14.9.9文件时间</h4>

<span id="index-file-access-time"></span>
<span id="index-file-modification-time"></span>
<span id="index-file-attribute-modification-time"></span>
<p>每个文件都有三个与之关联的时间戳记：访问时间，修改时间和属性修改时间。这些对应于<code>st_atime</code> ， <code>st_mtime</code>和<code>st_ctime</code>的成员<code>stat</code>结构体;请参阅<a href="File-Attributes.html#File-Attributes">文件属性</a> 。
</p>
<p>所有这些时间均以日历时间格式表示，例如<code>time_t</code>对象。此数据类型在<samp>time.h</samp> 。有关时间值的表示和操作的更多信息，请参见<a href="Calendar-Time.html#Calendar-Time">日历时间</a> 。
<span id="index-time_002eh"></span>
</p>
<p>从文件读取将更新其访问时间属性，而写入将更新其修改时间。创建文件时，该文件的所有三个时间戳记都设置为当前时间。此外，包含新条目的目录的属性更改时间和修改时间字段也会更新。
</p>
<p>使用以下命令为文件添加新名称<code>link</code>函数更新链接文件的属性更改时间字段，并更新包含新名称的目录的属性更改时间和修改时间字段。如果使用以下命令删除文件名，则会影响这些相同的字段<code>unlink</code> ， <code>remove</code>要么<code>rmdir</code> 。重命名文件<code>rename</code>仅影响所涉及的两个父目录的属性更改时间和修改时间字段，而不影响文件重命名的时间。
</p>
<p>更改文件的属性（例如，使用<code>chmod</code> ）更新其属性更改时间字段。
</p>
<p>您还可以使用以下命令显式更改文件的某些时间戳： <code>utime</code>功能-除属性更改时间外的所有功能。您需要包括头文件<samp>utime.h</samp>使用此功能。
<span id="index-utime_002eh"></span>
</p>
<dl>
<dt id="index-struct-utimbuf">数据类型： <strong>struct utimbuf</strong></dt>
<dd>
<p>的<code>utimbuf</code>结构与<code>utime</code>用于指定文件的新访问和修改时间的函数。它包含以下成员：</p>
<dl compact>
<dt><code>time_t actime</code></dt>
<dd><p>这是文件的访问时间。
</p>
</dd>
<dt><code>time_t modtime</code></dt>
<dd><p>这是文件的修改时间。
</p></dd>
</dl>
</dd></dl>

<dl>
<dt id="index-utime">函数： <em>int</em> <strong>utime</strong> <em>（const char * <var>filename</var> ，const struct utimbuf * <var>times</var> ）</em></dt>
<dd>
<p>初步： MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>此功能用于修改与名为的文件关联的文件时间<var>filename</var> 。
</p>
<p>如果<var>times</var>如果为空指针，则将文件的访问和修改时间设置为当前时间。否则，将它们设置为来自<code>actime</code>和<code>modtime</code> （分别）成员<code>utimbuf</code>指向的结构<var>times</var> 。
</p>
<p>在任何一种情况下，文件的属性修改时间都设置为当前时间（因为更改时间戳本身就是对文件属性的修改）。
</p>
<p>的<code>utime</code>函数返回<code>0</code>如果成功，并且<code>-1</code>失败。除了常见的文件名错误（请参阅“ <a href="File-Name-Errors.html#File-Name-Errors">文件名错误”</a> ）之外，以下内容<code>errno</code>为此功能定义了错误条件：</p>
<dl compact>
<dt><code>EACCES</code></dt>
<dd><p>在将空指针作为参数传递的情况下，存在权限问题。 <var>times</var>论点。为了更新文件上的时间戳，您必须是文件的所有者，具有文件的写许可权，或者是特权用户。
</p>
</dd>
<dt><code>ENOENT</code></dt>
<dd><p>该文件不存在。
</p>
</dd>
<dt><code>EPERM</code></dt>
<dd><p>如果<var>times</var>参数不是空指针，您必须是文件的所有者或特权用户。
</p>
</dd>
<dt><code>EROFS</code></dt>
<dd><p>该文件位于只读文件系统上。
</p></dd>
</dl>
</dd></dl>

<p>三个时间戳中的每个时间戳都有一个相应的微秒部分，这扩大了它的分辨率。这些字段称为<code>st_atime_usec</code> ， <code>st_mtime_usec</code>和<code>st_ctime_usec</code> ;每个值的范围都在0到999,999之间，以毫秒为单位表示时间。它们对应于<code>tv_usec</code>一个领域<code>timeval</code>结构体;请参阅<a href="High_002dResolution-Calendar.html#High_002dResolution-Calendar">高分辨率日历</a> 。
</p>
<p>的<code>utimes</code>功能就像<code>utime</code> ，还可以指定文件时间的小数部分。该函数的原型在头文件中<samp>sys/time.h</samp> 。
<span id="index-sys_002ftime_002eh"></span>
</p>
<dl>
<dt id="index-utimes">函数： <em>int</em> <strong>utimes</strong> <em>（const char * <var>filename</var> ，const struct timeval <var>tvp</var> <tt>[2]</tt> ）</em></dt>
<dd>
<p>初步： MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>此功能设置文件的访问和修改时间<var>filename</var> 。新文件的访问时间由<code><var>tvp</var>[0]</code> ，以及新的修改时间<code><var>tvp</var>[1]</code> 。相似<code>utime</code>如果<var>tvp</var>如果为空指针，则文件的访问和修改时间将设置为当前时间。此功能来自BSD。</p>
<p>返回值和错误条件与<code>utime</code>功能。
</p></dd></dl>

<dl>
<dt id="index-lutimes">函数： <em>int</em> <strong>lutimes</strong> <em>（const char * <var>filename</var> ，const struct timeval <var>tvp</var> <tt>[2]</tt> ）</em></dt>
<dd>
<p>初步： MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>这个功能就像<code>utimes</code> ，只是它不遵循符号链接。如果<var>filename</var>是符号链接的名称， <code>lutimes</code>设置符号链接特殊文件本身的文件访问和修改时间（如<code>lstat</code> ;参见<a href="Symbolic-Links.html#Symbolic-Links">符号链接</a> <code>utimes</code>设置符号链接引用的文件的文件访问和修改时间。该功能来自FreeBSD，并非在所有平台上都可用（如果不可用，它将在<code>ENOSYS</code> ）。
</p>
<p>返回值和错误条件与<code>utime</code>功能。
</p></dd></dl>

<dl>
<dt id="index-futimes">函数： <em>int</em> <strong>futimes</strong> <em>（int <var>fd</var> ，const struct timeval <var>tvp</var> <tt>[2]</tt> ）</em></dt>
<dd>
<p>初步： MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>这个功能就像<code>utimes</code> ，不同之处在于它使用打开的文件描述符作为参数而不是文件名。请参阅<a href="Low_002dLevel-I_002fO.html#Low_002dLevel-I_002fO">低级I / O。</a>该功能来自FreeBSD，并非在所有平台上都可用（如果不可用，它将在<code>ENOSYS</code> ）。
</p>
<p>喜欢<code>utimes</code> ， <code>futimes</code>退货<code>0</code>成功与<code>-1</code>失败。下列<code>errno</code>错误条件是为<code>futimes</code> ：</p>
<dl compact>
<dt><code>EACCES</code></dt>
<dd><p>在将空指针作为参数传递的情况下，存在权限问题。 <var>times</var>论点。为了更新文件上的时间戳，您必须是文件的所有者，具有文件的写许可权，或者是特权用户。
</p>
</dd>
<dt><code>EBADF</code></dt>
<dd><p>的<var>filedes</var>参数不是有效的文件描述符。
</p>
</dd>
<dt><code>EPERM</code></dt>
<dd><p>如果<var>times</var>参数不是空指针，您必须是文件的所有者或特权用户。
</p>
</dd>
<dt><code>EROFS</code></dt>
<dd><p>该文件位于只读文件系统上。
</p></dd>
</dl>
</dd></dl>

<hr>
<div class="header">
<p>下一篇： <a href="File-Size.html#File-Size" rel="next" accesskey="n">文件大小</a> ，上一篇： <a href="Testing-File-Access.html#Testing-File-Access" rel="prev" accesskey="p">测试文件访问</a> ，上一篇： <a href="File-Size.html#File-Size" rel="next" accesskey="n">文件</a> <a href="File-Attributes.html#File-Attributes" rel="up" accesskey="u">属性</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>