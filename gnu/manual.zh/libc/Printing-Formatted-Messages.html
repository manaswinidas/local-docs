<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>打印格式化的消息（GNU C库）</title>

<meta name="description" content="Printing Formatted Messages (The GNU C Library)">
<meta name="keywords" content="Printing Formatted Messages (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Formatted-Messages.html#Formatted-Messages" rel="up" title="Formatted Messages">
<link href="Adding-Severity-Classes.html#Adding-Severity-Classes" rel="next" title="Adding Severity Classes">
<link href="Formatted-Messages.html#Formatted-Messages" rel="prev" title="Formatted Messages">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Printing-Formatted-Messages"></span><div class="header">
<p>下一页： <a href="Adding-Severity-Classes.html#Adding-Severity-Classes" rel="next" accesskey="n">添加严重性类</a> ，上一篇： <a href="Formatted-Messages.html#Formatted-Messages" rel="up" accesskey="u">格式化的消息</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="Printing-Formatted-Messages-1"></span><h4 class="subsection">12.22.1打印格式化的消息</h4>

<p>可以将消息打印到标准错误和/或控制台。为了选择目标，程序员可以使用以下两个值，如果需要，可以按位或组合<var>classification</var>的参数<code>fmtmsg</code> ：</p>
<dl compact>
<dt><code>MM_PRINT</code>
<span id="index-MM_005fPRINT"></span>
</dt>
<dd><p>以标准错误显示消息。
</p></dd>
<dt><code>MM_CONSOLE</code>
<span id="index-MM_005fCONSOLE"></span>
</dt>
<dd><p>在系统控制台上显示消息。
</p></dd>
</dl>

<p>系统的错误部分可以通过以下值之一准确地发出信号，该值也与<var>classification</var>参数<code>fmtmsg</code> ：</p>
<dl compact>
<dt><code>MM_HARD</code>
<span id="index-MM_005fHARD"></span>
</dt>
<dd><p>条件的来源是某些硬件。
</p></dd>
<dt><code>MM_SOFT</code>
<span id="index-MM_005fSOFT"></span>
</dt>
<dd><p>条件的来源是某些软件。
</p></dd>
<dt><code>MM_FIRM</code>
<span id="index-MM_005fFIRM"></span>
</dt>
<dd><p>条件的来源是某些固件。
</p></dd>
</dl>

<p>第三部分<var>classification</var>参数<code>fmtmsg</code>可以描述系统中检测到问题的部分。通过完全使用以下值之一来完成此操作：</p>
<dl compact>
<dt><code>MM_APPL</code>
<span id="index-MM_005fAPPL"></span>
</dt>
<dd><p>应用程序检测到错误情况。
</p></dd>
<dt><code>MM_UTIL</code>
<span id="index-MM_005fUTIL"></span>
</dt>
<dd><p>实用程序检测到错误情况。
</p></dd>
<dt><code>MM_OPSYS</code>
<span id="index-MM_005fOPSYS"></span>
</dt>
<dd><p>操作系统检测到错误情况。
</p></dd>
</dl>

<p>最后一个组成部分<var>classification</var>可以表示此消息的结果。可以使用以下值之一：</p>
<dl compact>
<dt><code>MM_RECOVER</code>
<span id="index-MM_005fRECOVER"></span>
</dt>
<dd><p>这是可恢复的错误。
</p></dd>
<dt><code>MM_NRECOV</code>
<span id="index-MM_005fNRECOV"></span>
</dt>
<dd><p>这是不可恢复的错误。
</p></dd>
</dl>

<dl>
<dt id="index-fmtmsg">函数： <em>int</em> <strong>fmtmsg</strong> <em>（长整数<var>classification</var> ，const char * <var>label</var> ，int <var>severity</var> ，const char * <var>text</var> ，const char * <var>action</var> ，const char * <var>tag</var> ）</em></dt>
<dd>
<p>初步： MT安全| AS不安全锁|交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>在设备中指定的设备上显示一条由其参数描述的消息。 <var>classification</var>参数。的<var>label</var>参数标识消息的来源。该字符串应由两个冒号分隔的部分组成，其中第一部分不超过10个字符，第二部分不超过14个字符。的<var>text</var>参数描述了错误的情况， <var>action</var>参数从错误中恢复的可能步骤和<var>tag</var>参数是对在线文档的引用，可以在其中找到更多信息。它应该包含<var>label</var>值和唯一的标识号。
</p>
<p>每个参数可以是一个特殊值，这意味着该值将被省略。这些值的符号名称为：</p>
<dl compact>
<dt><code>MM_NULLLBL</code>
<span id="index-MM_005fNULLLBL"></span>
</dt>
<dd><p>忽视<var>label</var>参数。
</p></dd>
<dt><code>MM_NULLSEV</code>
<span id="index-MM_005fNULLSEV"></span>
</dt>
<dd><p>忽视<var>severity</var>参数。
</p></dd>
<dt><code>MM_NULLMC</code>
<span id="index-MM_005fNULLMC"></span>
</dt>
<dd><p>忽视<var>classification</var>参数。这意味着实际上没有打印任何内容。
</p></dd>
<dt><code>MM_NULLTXT</code>
<span id="index-MM_005fNULLTXT"></span>
</dt>
<dd><p>忽视<var>text</var>参数。
</p></dd>
<dt><code>MM_NULLACT</code>
<span id="index-MM_005fNULLACT"></span>
</dt>
<dd><p>忽视<var>action</var>参数。
</p></dd>
<dt><code>MM_NULLTAG</code>
<span id="index-MM_005fNULLTAG"></span>
</dt>
<dd><p>忽视<var>tag</var>参数。
</p></dd>
</dl>

<p>还有另一种方法可以从输出到标准错误中省略某些字段。下面在影响行为的环境变量的描述中对此进行了描述。
</p>
<p>的<var>severity</var>参数可以具有下表中的值之一： <span id="index-severity-class"></span>
</p>
<dl compact>
<dt><code>MM_NOSEV</code>
<span id="index-MM_005fNOSEV"></span>
</dt>
<dd><p>没有打印任何内容，该值与<code>MM_NULLSEV</code> 。
</p></dd>
<dt><code>MM_HALT</code>
<span id="index-MM_005fHALT"></span>
</dt>
<dd><p>该值打印为<code>HALT</code> 。
</p></dd>
<dt><code>MM_ERROR</code>
<span id="index-MM_005fERROR"></span>
</dt>
<dd><p>该值打印为<code>ERROR</code> 。
</p></dd>
<dt><code>MM_WARNING</code>
<span id="index-MM_005fWARNING"></span>
</dt>
<dd><p>该值打印为<code>WARNING</code> 。
</p></dd>
<dt><code>MM_INFO</code>
<span id="index-MM_005fINFO"></span>
</dt>
<dd><p>该值打印为<code>INFO</code> 。
</p></dd>
</dl>

<p>这五个宏的数值介于<code>0</code>和<code>4</code> 。使用环境变量<code>SEV_LEVEL</code>或使用<code>addseverity</code>功能一可以添加更多严重级别及其相应的字符串进行打印。下面对此进行了描述（请参阅<a href="Adding-Severity-Classes.html#Adding-Severity-Classes">添加严重性类</a> ）。
</p>
<p>如果没有忽略任何参数，则输出如下所示：</p>
<div class="example">
<pre class="example"><var>label</var>: <var>severity-string</var>: <var>text</var>
TO FIX: <var>action</var> <var>tag</var>
</pre></div>

<p>冒号，换行符和<code>TO FIX</code>必要时插入字符串，即，如果不忽略相应的参数。
</p>
<p>X / Open可移植性指南中指定了此功能。在从System V派生的所有系统上也可用。</p>
<p>该函数返回值<code>MM_OK</code>如果没有错误发生。如果仅打印至标准错误失败，则返回<code>MM_NOMSG</code> 。如果打印到控制台失败，它将返回<code>MM_NOCON</code> 。如果没有打印<code>MM_NOTOK</code>返回。在所有输出均失败的情况下，如果参数值不正确，也会返回最后一个值。
</p></dd></dl>

<p>有两个环境变量会影响行为<code>fmtmsg</code> 。首先是<code>MSGVERB</code> 。它用于控制在标准错误下实际发生的输出（ <em>不是</em>控制台输出）。五个字段中的每一个都可以显式启用。为此，用户必须将<code>MSGVERB</code>在环境中使用以下格式的变量，然后调用<code>fmtmsg</code>第一次运行：</p>
<div class="example">
<pre class="example">MSGVERB=<var>keyword</var>[:<var>keyword</var>[:&hellip;]]
</pre></div>

<p>有效<var>keyword</var> s是<code>label</code> ， <code>severity</code> ， <code>text</code> ， <code>action</code>和<code>tag</code> 。如果未给出环境变量或为空字符串，则给出了不受支持的关键字，或者该值在其他方面无效，则消息的任何部分都不会被屏蔽掉。
</p>
<p>影响环境行为的第二个环境变量<code>fmtmsg</code>是<code>SEV_LEVEL</code> 。这个变量和行为的变化<code>fmtmsg</code> X / Open可移植性指南中未指定。但是，它在System V系统中可用。它可用于引入新的严重性级别。默认情况下，仅上述五个严重级别可用。任何其他数值将使<code>fmtmsg</code>什么都不打印。
</p>
<p>如果用户放<code>SEV_LEVEL</code>格式如</p>
<div class="example">
<pre class="example">SEV_LEVEL=[<var>description</var>[:<var>description</var>[:&hellip;]]]
</pre></div>

<p>在第一次调用之前的过程环境中<code>fmtmsg</code> ，在哪里<var>description</var>具有以下形式的值</p>
<div class="example">
<pre class="example"><var>severity-keyword</var>,<var>level</var>,<var>printstring</var>
</pre></div>

<p>的<var>severity-keyword</var>部分未被使用<code>fmtmsg</code>但它必须存在。的<var>level</var>部分是数字的字符串表示形式。数值必须大于4。此值必须在<var>severity</var>的参数<code>fmtmsg</code>选择此类。不可能覆盖任何预定义的类。的<var>printstring</var>是在处理此类消息时打印的字符串<code>fmtmsg</code> （往上看， <code>fmtsmg</code>不打印数值，而是打印字符串表示形式）。
</p>

<hr>
<div class="header">
<p>下一页： <a href="Adding-Severity-Classes.html#Adding-Severity-Classes" rel="next" accesskey="n">添加严重性类</a> ，上一篇： <a href="Formatted-Messages.html#Formatted-Messages" rel="up" accesskey="u">格式化的消息</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>