<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>系统参数（GNU C库）</title>

<meta name="description" content="System Parameters (The GNU C Library)">
<meta name="keywords" content="System Parameters (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="System-Management.html#System-Management" rel="up" title="System Management">
<link href="System-Configuration.html#System-Configuration" rel="next" title="System Configuration">
<link href="Mount_002dUnmount_002dRemount.html#Mount_002dUnmount_002dRemount" rel="prev" title="Mount-Unmount-Remount">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="System-Parameters"></span><div class="header">
<p>Previous： <a href="Filesystem-Handling.html#Filesystem-Handling" rel="prev" accesskey="p">文件系统处理</a> ，Up： <a href="System-Management.html#System-Management" rel="up" accesskey="u">系统管理</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="System-Parameters-1"></span><h3 class="section">31.4系统参数</h3>

<p>本节介绍<code>sysctl</code>函数，该函数获取并设置各种系统参数。
</p>
<p>本节中使用的符号在文件中声明<samp>sys/sysctl.h</samp> 。
</p>
<dl>
<dt id="index-sysctl">函数： <em>int</em> <strong>sysctl</strong> <em>（int * <var>names</var> ，int <var>nlen</var> ，无效* <var>oldval</var> ，size_t * <var>oldlenp</var> ，无效* <var>newval</var> ，size_t <var>newlen</var> ）</em></dt>
<dd>
<p>初步： MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>


<p><code>sysctl</code>获取或设置指定的系统参数。这些参数太多了，以至于无法在此处列出所有参数，但以下是一些示例：</p>
<ul>
<li>网络域名</li><li>分页参数</li><li>网络地址解析协议超时时间</li><li>可以打开的最大文件数</li><li>根文件系统设备</li><li>何时构建内核</li></ul>

<p>可用参数集取决于内核配置，并且可以在系统运行时更改，尤其是在加载和卸载可加载内核模块时。
</p>
<p>系统参数<code>sysctl</code>所关心的是按诸如分层文件系统之类的分层结构排列。要标识特定参数，您可以通过指定文件的路径名的方式指定通过结构的路径。路径的每个组成部分均由一个整数指定，并且这些整数中的每一个都有一个由其定义的宏<samp>sys/sysctl.h</samp> 。 <var>names</var>是路径，以整数数组的形式。路径的每个组成部分依次是数组的一个元素。 <var>nlen</var>是路径中组件的数量。
</p>
<p>例如，所有分页参数的路径的第一部分是值<code>CTL_VM</code> 。对于可用页面阈值，路径的第二部分是<code>VM_FREEPG</code> 。因此，要获取免费页面阈值，请<var>names</var>包含两个元素的数组<code>CTL_VM</code>和<code>VM_FREEPG</code>和做<var>nlen</var> = 2。
</p>

<p>参数值的格式取决于参数。有时它是整数；有时是ASCII字符串；有时这是一个精心设计的结构。在上面的示例中使用空闲页面阈值的情况下，参数值是包含几个整数的结构。
</p>
<p>无论如何，您都可以通过以下方式确定返回参数值的位置<var>oldval</var>并将该位置的可用存储量指定为* <var>oldlenp</var> 。 * <var>oldlenp</var>执行双重任务，因为它也是包含返回值的实际长度的输出位置。
</p>
<p>如果您不希望返回参数值，请为指定一个空指针<var>oldval</var> 。
</p>
<p>要设置参数，请指定新值的地址和长度为<var>newval</var>和<var>newlen</var> 。如果您不想设置参数，请指定一个空指针作为<var>newval</var> 。
</p>
<p>如果在同一位置获取并设置参数<code>sysctl</code>调用时，返回的值是设置之前参数的值。
</p>
<p>每个系统参数都有一组与文件的权限（包括文件路径中的目录的权限）相似的权限，这些权限决定您是否可以获取或设置该文件。出于这些权限的目的，每个参数均被视为由超级用户和组0拥有，因此具有该有效uid或gid的进程可能具有对系统参数的更多访问权限。与文件不同，超级用户并非始终具有对所有系统参数的完全许可权，因为其中一些参数被设计为永远不可更改。
</p>

<p><code>sysctl</code>如果成功，则返回零返回值。否则返回<code>-1</code>和集<code>errno</code>适当地。除了适用于所有系统调用的故障外，以下是<code>errno</code>所有可能的故障代码：</p>
<dl compact>
<dt><code>EPERM</code></dt>
<dd><p>不允许该过程访问系统参数路径的组成部分之一，或者不允许该过程以其请求的方式（读取或写入）访问系统参数本身。
</p></dd>
<dt><code>ENOTDIR</code></dt>
<dd><p>没有与之对应的系统参数<var>name</var> 。
</p></dd>
<dt><code>EFAULT</code></dt>
<dd><p><var>oldval</var>不为null，表示进程想要读取参数，但是* <var>oldlenp</var>为零，因此无处返回它。
</p></dd>
<dt><code>EINVAL</code></dt>
<dd><ul>
<li>该过程试图将系统参数设置为对该参数无效的值。
</li><li>为返回系统参数提供的空间不是该参数的正确大小。
</li></ul>
</dd>
<dt><code>ENOMEM</code></dt>
<dd><p>可能会返回此值，而不是更正确的值<code>EINVAL</code>在某些情况下，用于返回系统参数的空间太小。
</p>
</dd>
</dl>

</dd></dl>

<p>如果您的Linux内核带有<code>proc</code>文件系统，您可以通过读写文件中的文件来获取和设置大多数相同的参数<code>sys</code>目录<code>proc</code>文件系统。在里面<code>sys</code>目录，目录结构代表参数的层次结构。例如，您可以使用</p><div class="example">
<pre class="example">cat /proc/sys/vm/freepages
</pre></div>

<p>GNU C库提供了一些更传统和更广泛使用的（尽管不太通用）功能，它们用于获取和设置一些相同的系统参数：</p>
<ul>
<li> <code>getdomainname</code> ， <code>setdomainname</code>
</li><li> <code>gethostname</code> ， <code>sethostname</code> （请参阅<a href="Host-Identification.html#Host-Identification">主机标识</a> 。）
</li><li> <code>uname</code> （请参阅<a href="Platform-Type.html#Platform-Type">平台类型</a> 。）
</li></ul>
<hr>
<div class="header">
<p>Previous： <a href="Filesystem-Handling.html#Filesystem-Handling" rel="prev" accesskey="p">文件系统处理</a> ，Up： <a href="System-Management.html#System-Management" rel="up" accesskey="u">系统管理</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>