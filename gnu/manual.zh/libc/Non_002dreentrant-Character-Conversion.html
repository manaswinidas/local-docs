<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>非重入字符转换（GNU C库）</title>

<meta name="description" content="Non-reentrant Character Conversion (The GNU C Library)">
<meta name="keywords" content="Non-reentrant Character Conversion (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Non_002dreentrant-Conversion.html#Non_002dreentrant-Conversion" rel="up" title="Non-reentrant Conversion">
<link href="Non_002dreentrant-String-Conversion.html#Non_002dreentrant-String-Conversion" rel="next" title="Non-reentrant String Conversion">
<link href="Non_002dreentrant-Conversion.html#Non_002dreentrant-Conversion" rel="prev" title="Non-reentrant Conversion">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Non_002dreentrant-Character-Conversion"></span><div class="header">
<p>下一页： <a href="Non_002dreentrant-String-Conversion.html#Non_002dreentrant-String-Conversion" rel="next" accesskey="n">非重入字符串转换</a> ，上一篇： <a href="Non_002dreentrant-String-Conversion.html#Non_002dreentrant-String-Conversion" rel="next" accesskey="n">非重入字符串</a> <a href="Non_002dreentrant-Conversion.html#Non_002dreentrant-Conversion" rel="up" accesskey="u">转换</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="Non_002dreentrant-Conversion-of-Single-Characters"></span><h4 class="subsection">6.4.1单个字符的不可重入转换</h4>

<dl>
<dt id="index-mbtowc">函数： <em>int</em> <strong>mbtowc</strong> <em>（wchar_t * restrict <var>result</var> ，const char *限制<var>string</var> ，size_t <var>size</var> ）</em></dt>
<dd>
<p>初步： MT不安全竞赛| AS不安全损坏的堆锁dlopen | AC不安全损坏的锁内存fd |请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>mbtowc</code>使用非null调用时（“多字节转宽字符”）功能<var>string</var>转换第一个多字节字符，从<var>string</var>为其相应的宽字符代码。将结果存储在<code>*<var>result</var></code> 。
</p>
<p><code>mbtowc</code>从来没有检查超过<var>size</var>个字节。（这个想法是为了<var>size</var>您手中的数据字节数。）
</p>
<p><code>mbtowc</code>非空<var>string</var>区分三种可能性：第一种<var>size</var>的字节数<var>string</var>以有效的多字节字符开始，以无效的字节序列或字符的一部分开始，或者<var>string</var>指向一个空字符串（一个空字符）。
</p>
<p>对于有效的多字节字符， <code>mbtowc</code>将其转换为宽字符并将其存储在<code>*<var>result</var></code> ，并返回该字符中的字节数（始终至少为<em>1，</em>且不得超过<var>size</var> ）。
</p>
<p>对于无效的字节序列， <code>mbtowc</code>返回<em>-1</em> 。对于空字符串，它返回<em>0</em> ，同时存储<code>'\0'</code>在<code>*<var>result</var></code> 。
</p>
<p>如果多字节字符代码使用移位字符，则<code>mbtowc</code>在扫描时保持并更新换档状态。如果你打电话<code>mbtowc</code>用一个空指针<var>string</var> ，将变速状态初始化为其标准初始值。如果正在使用的多字节字符代码实际上具有移位状态，则它还会返回非零值。请参阅<a href="Shift-State.html#Shift-State">Shift State</a> 。
</p></dd></dl>

<dl>
<dt id="index-wctomb">功能： <em>int</em> <strong>wctomb</strong> <em>（char * <var>string</var> ，wchar_t <var>wchar</var> ）</em></dt>
<dd>
<p>初步： MT不安全竞赛| AS不安全损坏的堆锁dlopen | AC不安全损坏的锁内存fd |请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>wctomb</code> （“宽字符到多字节”）功能转换宽字符代码<var>wchar</var>转换为其相应的多字节字符序列，并将结果存储在以以下位置的字节开头<var>string</var> 。最多<code>MB_CUR_MAX</code>字符被存储。
</p>
<p><code>wctomb</code>非空<var>string</var>区分三种可能性<var>wchar</var> ：有效的宽字符代码（可以转换为多字节字符的代码），无效的代码，以及<code>L'\0'</code> 。
</p>
<p>给定一个有效的代码， <code>wctomb</code>将其转换为多字节字符，存储从以下位置开始的字节<var>string</var> 。然后，它返回该字符中的字节数（始终至少为<em>1，</em>且永远不大于<code>MB_CUR_MAX</code> ）。
</p>
<p>如果<var>wchar</var>是无效的宽字符代码， <code>wctomb</code>返回<em>-1</em> 。如果<var>wchar</var>是<code>L'\0'</code> ，它返回<code>0</code> ，还存储<code>'\0'</code>在<code>*<var>string</var></code> 。
</p>
<p>如果多字节字符代码使用移位字符，则<code>wctomb</code>在扫描时保持并更新换档状态。如果你打电话<code>wctomb</code>用一个空指针<var>string</var> ，将变速状态初始化为其标准初始值。如果正在使用的多字节字符代码实际上具有移位状态，则它还会返回非零值。请参阅<a href="Shift-State.html#Shift-State">Shift State</a> 。
</p>
<p>用一个<var>wchar</var>零时的参数<var>string</var>不为null的副作用是重新初始化存储的移位状态<em>以及</em>存储多字节字符<code>'\0'</code>并返回<em>0</em> 。
</p></dd></dl>

<p>相似<code>mbrlen</code>还有一个不可重入函数，用于计算多字节字符的长度。可以定义为<code>mbtowc</code> 。
</p>
<dl>
<dt id="index-mblen">函数： <em>int</em> <strong>mblen</strong> <em>（const char * <var>string</var> ，size_t <var>size</var> ）</em></dt>
<dd>
<p>初步： MT不安全竞赛| AS不安全损坏的堆锁dlopen | AC不安全损坏的锁内存fd |请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>mblen</code>非空函数<var>string</var>参数返回组成多字节字符的字节数，从此处开始<var>string</var> ，从不检查超过<var>size</var>个字节。（这个想法是为了<var>size</var>您手中的数据字节数。）
</p>
<p>的返回值<code>mblen</code>区分三种可能性：第一种<var>size</var>的字节数<var>string</var>以有效的多字节字符开始，以无效的字节序列或字符的一部分开始，或者<var>string</var>指向一个空字符串（一个空字符）。
</p>
<p>对于有效的多字节字符， <code>mblen</code>返回该字符中的字节数（始终至少<code>1</code>而且不超过<var>size</var> ）。对于无效的字节序列， <code>mblen</code>返回<em>-1</em> 。对于空字符串，它返回<em>0</em> 。
</p>
<p>如果多字节字符代码使用移位字符，则<code>mblen</code>在扫描时保持并更新换档状态。如果你打电话<code>mblen</code>用一个空指针<var>string</var> ，将变速状态初始化为其标准初始值。如果正在使用的多字节字符代码实际上具有移位状态，则它还会返回一个非零值。请参阅<a href="Shift-State.html#Shift-State">Shift State</a> 。
</p>
<span id="index-stdlib_002eh-7"></span>
<p>功能<code>mblen</code>在中声明<samp>stdlib.h</samp> 。
</p></dd></dl>


<hr>
<div class="header">
<p>下一页： <a href="Non_002dreentrant-String-Conversion.html#Non_002dreentrant-String-Conversion" rel="next" accesskey="n">非重入字符串转换</a> ，上一篇： <a href="Non_002dreentrant-String-Conversion.html#Non_002dreentrant-String-Conversion" rel="next" accesskey="n">非重入字符串</a> <a href="Non_002dreentrant-Conversion.html#Non_002dreentrant-Conversion" rel="up" accesskey="u">转换</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>