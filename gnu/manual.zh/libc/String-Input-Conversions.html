<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>字符串输入转换（GNU C库）</title>

<meta name="description" content="String Input Conversions (The GNU C Library)">
<meta name="keywords" content="String Input Conversions (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Formatted-Input.html#Formatted-Input" rel="up" title="Formatted Input">
<link href="Dynamic-String-Input.html#Dynamic-String-Input" rel="next" title="Dynamic String Input">
<link href="Numeric-Input-Conversions.html#Numeric-Input-Conversions" rel="prev" title="Numeric Input Conversions">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="String-Input-Conversions"></span><div class="header">
<p>下一个： <a href="Dynamic-String-Input.html#Dynamic-String-Input" rel="next" accesskey="n">动态字符串输入</a> ，上一个： <a href="Numeric-Input-Conversions.html#Numeric-Input-Conversions" rel="prev" accesskey="p">数字输入转换</a> ，上一个： <a href="Formatted-Input.html#Formatted-Input" rel="up" accesskey="u">格式化输入</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="String-Input-Conversions-1"></span><h4 class="subsection">12.14.5字符串输入转换</h4>

<p>本节介绍<code>scanf</code>读取字符串和字符值的输入转换：' <samp>%s</samp> '，' <samp>%S</samp> '，' <samp>%[</samp> '，' <samp>%c</samp> '和' <samp>%C</samp> '。
</p>
<p>对于如何从这些转换中接收输入，您有两个选择：</p>
<ul>
<li>提供一个缓冲区来存储它。这是默认值。您应该提供一个类型的参数<code>char *</code>要么<code>wchar_t *</code> （如果“ <samp>l</samp> '修饰符存在）。

<p><strong>警告：</strong>为使程序健壮，必须确保输入（加上其终止null）不能超过您提供的缓冲区的大小。通常，执行此操作的唯一方法是指定最大字段宽度，该宽度小于缓冲区大小。<strong>如果提供缓冲区，请始终指定最大字段宽度以防止溢出。</strong>
</p>
</li><li>问<code>scanf</code>通过指定“来分配足够大的缓冲区<samp>a</samp> '标志字符。这是一个GNU扩展。您应该提供一个类型的参数<code>char **</code>用于存储缓冲区地址。请参见<a href="Dynamic-String-Input.html#Dynamic-String-Input">动态字符串输入</a> 。
</li></ul>

<p>' <samp>%c</samp> '转换是最简单的：始终匹配固定数量的字符。最大字段宽度表示要读取的字符数。如果未指定最大值，则默认值为1。此转换不会在读取的文本末尾添加空字符。它还不会跳过初始空白字符。它精确地读取下一个<var>n</var>字符，如果无法获得那么多字符，则失败。由于总是有一个最大字段宽度<samp>%c</samp> '（无论是否指定，默认情况下为1），始终可以通过使缓冲区足够长来防止溢出。
</p>
<p>如果格式为“ <samp>%lc</samp> ' 要么 ' <samp>%C</samp>该函数存储宽字符，这些宽字符使用从外部字节流打开流时确定的转换来转换。从介质读取的字节数受以下条件限制： <code>MB_CUR_LEN * <var>n</var></code>但最多<var>n</var>宽字符存储在输出字符串中。
</p>
<p>' <samp>%s</samp> '转换匹配一串非空白字符。它会跳过并丢弃初始的空格，但在读取内容后遇到更多的空格时会停止。它在读取的文本末尾存储一个空字符。
</p>
<p>例如，读取输入：</p>
<div class="example">
<pre class="example"> hello, world
</pre></div>

<p>与转换“ <samp>%10c</samp>产生<code>" hello, wo"</code> ，但读取与转换相同的输入' <samp>%10s</samp>产生<code>"hello,"</code> 。
</p>
<p><strong>警告：</strong>如果您未为“ <samp>%s</samp> '，那么读取的字符数仅受下一个空白字符出现的位置限制。几乎可以肯定，这意味着无效输入会导致程序崩溃—这是一个错误。
</p>
<p>' <samp>%ls</samp> '和' <samp>%S</samp> '格式就像' <samp>%s</samp>除了使用与流相关联的转换将外部字节序列转换为具有自己编码的宽字符外，用格式指定的宽度或精度不能直接确定从流中读取多少个字节，因为它们测量的是宽字符。但是上限可以通过将宽度或精度值乘以<code>MB_CUR_MAX</code> 。
</p>
<p>要读入属于您选择的任意字符集的字符，请使用“ <samp>%[</samp>转换。您可以在“ <samp>[</samp> '人物和跟随者' <samp>]</samp> '字符，使用正则表达式中用于显式字符集的语法相同。作为特殊情况：</p>
<ul>
<li>文字' <samp>]</samp>可以将'字符指定为该集合的第一个字符。

</li><li>嵌入式“ <samp>-</samp> '字符（即不是集合的第一个或最后一个字符的字符）用于指定字符范围。

</li><li>如果插入符号' <samp>^</samp> “立即跟随最初的” <samp>[</samp> '，则允许的输入字符集是<em>除</em>列出字符<em>之外</em>的所有内容。
</li></ul>

<p>' <samp>%[</samp> '转换不会跳过初始空格字符。
</p>
<p>请注意，出现的正则表达式内（如“中的字符集可用<em>字符类</em>语法<samp>[:alpha:]</samp> '）在'中<em>不可</em>用<samp>%[</samp>转换。
</p>
<p>以下是一些“ <samp>%[</samp>转换及其含义：</p>
<dl compact>
<dt>' <samp>%25[1234567890]</samp> '</dt>
<dd><p>匹配最多25个数字的字符串。
</p>
</dd>
<dt>' <samp>%25[][]</samp> '</dt>
<dd><p>匹配最多25个方括号的字符串。
</p>
</dd>
<dt>' <samp>%25[^ \f\n\r\t\v]</samp> '</dt>
<dd><p>匹配不超过任何标准空白字符的最长25个字符的字符串。这与“ <samp>%s</samp> '，因为如果输入以空格字符开头，则' <samp>%[</samp> '报告匹配失败，而' <samp>%s</samp> '只是丢弃初始空白。
</p>
</dd>
<dt>' <samp>%25[a-z]</samp> '</dt>
<dd><p>最多匹配25个小写字符。
</p></dd>
</dl>

<p>至于“ <samp>%c</samp> '和' <samp>%s</samp> ' <samp>%[</samp>如果将' <samp>l</samp> '修饰符存在。关于“ <samp>%ls</samp> '以上是对' <samp>%l[</samp> '。
</p>
<p>还有一点提醒： <samp>%s</samp> '和' <samp>%[</samp> “转换是<strong>危险的</strong> ，如果你不指定最大宽度或使用” <samp>a</samp> '标志，因为输入时间过长会溢出您为其提供的任何缓冲区。无论缓冲区有多长，用户都可以提供更长的输入。编写良好的程序会通过无效的错误消息报告无效的输入，而不是崩溃。
</p>
<hr>
<div class="header">
<p>下一个： <a href="Dynamic-String-Input.html#Dynamic-String-Input" rel="next" accesskey="n">动态字符串输入</a> ，上一个： <a href="Numeric-Input-Conversions.html#Numeric-Input-Conversions" rel="prev" accesskey="p">数字输入转换</a> ，上一个： <a href="Formatted-Input.html#Formatted-Input" rel="up" accesskey="u">格式化输入</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>