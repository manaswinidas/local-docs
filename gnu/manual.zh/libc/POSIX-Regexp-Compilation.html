<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>POSIX Regexp编译（GNU C库）</title>

<meta name="description" content="POSIX Regexp Compilation (The GNU C Library)">
<meta name="keywords" content="POSIX Regexp Compilation (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Regular-Expressions.html#Regular-Expressions" rel="up" title="Regular Expressions">
<link href="Flags-for-POSIX-Regexps.html#Flags-for-POSIX-Regexps" rel="next" title="Flags for POSIX Regexps">
<link href="Regular-Expressions.html#Regular-Expressions" rel="prev" title="Regular Expressions">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="POSIX-Regexp-Compilation"></span><div class="header">
<p>下一页： <a href="Flags-for-POSIX-Regexps.html#Flags-for-POSIX-Regexps" rel="next" accesskey="n">POSIX Regexps的标志</a> ，上： <a href="Regular-Expressions.html#Regular-Expressions" rel="up" accesskey="u">正则表达式</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="POSIX-Regular-Expression-Compilation"></span><h4 class="subsection">10.3.1 POSIX正则表达式编译</h4>

<p>在实际匹配正则表达式之前，必须对其进行<em>编译</em> 。这不是真正的编译-它产生特殊的数据结构，而不是机器指令。但这就像普通编译一样，其目的是使您能够快速“执行”模式。（有关如何使用已编译的正则表达式进行匹配的信息，请参阅<a href="Matching-POSIX-Regexps.html#Matching-POSIX-Regexps">Matching POSIX Regexps</a> 。）
</p>
<p>编译后的正则表达式有一种特殊的数据类型：</p>
<dl>
<dt id="index-regex_005ft">数据类型： <strong>regex_t</strong></dt>
<dd>
<p>这种类型的对象包含一个已编译的正则表达式。它实际上是一个结构。您的程序应该关注的只是一个领域：</p>
<dl compact>
<dt><code>re_nsub</code></dt>
<dd><p>此字段保存已编译的正则表达式中带括号的子表达式的数量。
</p></dd>
</dl>

<p>还有其他几个字段，但是我们不在这里描述它们，因为只有库中的函数才应使用它们。
</p></dd></dl>

<p>创建一个<code>regex_t</code>对象，您可以通过调用将正则表达式编译到其中<code>regcomp</code> 。
</p>
<dl>
<dt id="index-regcomp">函数： <em>int</em> <strong>regcomp</strong> <em>（regex_t * restrict <var>compiled</var> ，const char *限制<var>pattern</var> ，int <var>cflags</var> ）</em></dt>
<dd>
<p>初步： MT安全区域| AS不安全损坏的堆锁dlopen | AC不安全损坏的锁内存fd |请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>功能<code>regcomp</code>将正则表达式“编译”为可用于的数据结构<code>regexec</code>与字符串匹配。编译后的正则表达式格式旨在实现高效匹配。 <code>regcomp</code>存储到<code>*<var>compiled</var></code> 。
</p>
<p>分配类型的对象由您决定<code>regex_t</code>并将其地址传递给<code>regcomp</code> 。
</p>
<p>争论<var>cflags</var>使您可以指定各种选项来控制正则表达式的语法和语义。请参阅<a href="Flags-for-POSIX-Regexps.html#Flags-for-POSIX-Regexps">POSIX正则表达式标志</a> 。
</p>
<p>如果使用标志<code>REG_NOSUB</code> ， 然后<code>regcomp</code>编译后的正则表达式省略了记录子表达式实际匹配所需的信息。在这种情况下，您最好通过<code>0</code>为了<var>matchptr</var>和<var>nmatch</var>调用时的参数<code>regexec</code> 。
</p>
<p>如果你不使用<code>REG_NOSUB</code> ，则编译后的正则表达式确实具有记录子表达式匹配方式的能力。也， <code>regcomp</code>告诉您多少个子表达式<var>pattern</var>通过将数字存储在<code><var>compiled</var>->re_nsub</code> 。您可以使用该值来决定要分配多长时间来保存有关子表达式匹配信息的数组。
</p>
<p><code>regcomp</code>退货<code>0</code>如果成功编译了正则表达式；否则，它返回一个非零的错误代码（请参见下表）。您可以使用<code>regerror</code>产生一个错误消息字符串，描述非零值的原因；请参阅<a href="Regexp-Cleanup.html#Regexp-Cleanup">Regexp Cleanup</a> 。
</p>
</dd></dl>

<p>这是可能的非零值<code>regcomp</code>可以返回：</p>
<dl compact>
<dt><code>REG_BADBR</code>
<span id="index-REG_005fBADBR"></span>
</dt>
<dd>
<p>无效的“ <samp>\{…\}</samp> '在正则表达式中构造。一个有效的 ' <samp>\{…\}</samp>结构必须包含一个数字或两个以逗号分隔的升序数字。
</p>
</dd>
<dt><code>REG_BADPAT</code>
<span id="index-REG_005fBADPAT"></span>
</dt>
<dd>
<p>正则表达式中存在语法错误。
</p>
</dd>
<dt><code>REG_BADRPT</code>
<span id="index-REG_005fBADRPT"></span>
</dt>
<dd>
<p>重复运算符，例如“ <samp>?</samp> ' 要么 ' <samp>*</samp>出现在错误的位置（之前没有子表达式可以执行）。
</p>
</dd>
<dt><code>REG_ECOLLATE</code>
<span id="index-REG_005fECOLLATE"></span>
</dt>
<dd>
<p>正则表达式引用了无效的排序规则元素（当前在语言环境中未定义的字符串排序规则元素）。请参阅<a href="Locale-Categories.html#Locale-Categories">区域设置类别</a> 。
</p>
</dd>
<dt><code>REG_ECTYPE</code>
<span id="index-REG_005fECTYPE"></span>
</dt>
<dd>
<p>正则表达式引用了无效的字符类名称。
</p>
</dd>
<dt><code>REG_EESCAPE</code>
<span id="index-REG_005fEESCAPE"></span>
</dt>
<dd>
<p>正则表达式以“ <samp>\</samp> '。
</p>
</dd>
<dt><code>REG_ESUBREG</code>
<span id="index-REG_005fESUBREG"></span>
</dt>
<dd>
<p>“ <samp>\<var>digit</var></samp>的构造。
</p>
</dd>
<dt><code>REG_EBRACK</code>
<span id="index-REG_005fEBRACK"></span>
</dt>
<dd>
<p>正则表达式中有不平衡的方括号。
</p>
</dd>
<dt><code>REG_EPAREN</code>
<span id="index-REG_005fEPAREN"></span>
</dt>
<dd>
<p>扩展的正则表达式带有不平衡的括号，或者基本的正则表达式具有不平衡的' <samp>\(</samp> '和' <samp>\)</samp> '。
</p>
</dd>
<dt><code>REG_EBRACE</code>
<span id="index-REG_005fEBRACE"></span>
</dt>
<dd>
<p>正则表达式不平衡' <samp>\{</samp> '和' <samp>\}</samp> '。
</p>
</dd>
<dt><code>REG_ERANGE</code>
<span id="index-REG_005fERANGE"></span>
</dt>
<dd>
<p>范围表达式中的端点之一无效。
</p>
</dd>
<dt><code>REG_ESPACE</code>
<span id="index-REG_005fESPACE"></span>
</dt>
<dd>
<p><code>regcomp</code>内存不足。
</p></dd>
</dl>

<hr>
<div class="header">
<p>下一页： <a href="Flags-for-POSIX-Regexps.html#Flags-for-POSIX-Regexps" rel="next" accesskey="n">POSIX Regexps的标志</a> ，上： <a href="Regular-Expressions.html#Regular-Expressions" rel="up" accesskey="u">正则表达式</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>