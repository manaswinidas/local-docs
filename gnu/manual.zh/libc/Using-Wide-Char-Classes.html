<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>使用宽字符类（GNU C库）</title>

<meta name="description" content="Using Wide Char Classes (The GNU C Library)">
<meta name="keywords" content="Using Wide Char Classes (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Character-Handling.html#Character-Handling" rel="up" title="Character Handling">
<link href="Wide-Character-Case-Conversion.html#Wide-Character-Case-Conversion" rel="next" title="Wide Character Case Conversion">
<link href="Classification-of-Wide-Characters.html#Classification-of-Wide-Characters" rel="prev" title="Classification of Wide Characters">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Using-Wide-Char-Classes"></span><div class="header">
<p>下一篇： <a href="Wide-Character-Case-Conversion.html#Wide-Character-Case-Conversion" rel="next" accesskey="n">宽字符大小写转换</a> ，上一篇： <a href="Wide-Character-Case-Conversion.html#Wide-Character-Case-Conversion" rel="next" accesskey="n">宽字符</a> <a href="Classification-of-Wide-Characters.html#Classification-of-Wide-Characters" rel="prev" accesskey="p">分类</a> ，上一篇： <a href="Character-Handling.html#Character-Handling" rel="up" accesskey="u">字符处理</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="Notes-on-using-the-wide-character-classes"></span><h3 class="section">4.4使用宽字符类的注意事项</h3>

<p>第一个音符可能并不令人惊讶，但仍然偶尔会引起问题。的<code>isw<var>XXX</var></code>函数可以使用宏来实现，实际上，GNU C库可以做到这一点。它们仍然可以用作实际功能，但是当<samp>wctype.h</samp>标头包含在内，将使用宏。这与<code>char</code>这些函数的类型版本。
</p>
<p>第二个说明涵盖了一些新内容。最好通过一个（实际的）示例来说明。第一部分代码是原始代码的摘录。它被截断了一点，但意图应该明确。
</p>
<div class="example">
<pre class="example">int
is_in_class (int c, const char *class)
{
  if (strcmp (class, &quot;alnum&quot;) == 0)
    return isalnum (c);
  if (strcmp (class, &quot;alpha&quot;) == 0)
    return isalpha (c);
  if (strcmp (class, &quot;cntrl&quot;) == 0)
    return iscntrl (c);
  &hellip;
  return 0;
}
</pre></div>

<p>现在，随着<code>wctype</code>和<code>iswctype</code>你可以避免<code>if</code>级联，但是按如下所示重写代码是错误的：</p>
<div class="example">
<pre class="example">int
is_in_class (int c, const char *class)
{
  wctype_t desc = wctype (class);
  return desc ? iswctype ((wint_t) c, desc) : 0;
}
</pre></div>

<p>问题是不能保证可以使用强制转换找到单字节字符的宽字符表示形式。实际上，通常这很惨。解决此问题的正确方法是编写如下代码：</p>
<div class="example">
<pre class="example">int
is_in_class (int c, const char *class)
{
  wctype_t desc = wctype (class);
  return desc ? iswctype (btowc (c), desc) : 0;
}
</pre></div>

<p>有关更多信息，请参见<a href="Converting-a-Character.html#Converting-a-Character">转换字符</a> 。 <code>btowc</code> 。请注意，此更改可能不会在很大程度上改善程序的性能，因为<code>wctype</code>函数仍然必须进行字符串比较。如果真的很有趣<code>is_in_class</code>对于相同的类名，函数被多次调用。在这种情况下，变量<var>desc</var>可以计算一次，并可以重复用于所有调用。因此，函数的上述形式可能不是最终形式。
</p>

<hr>
<div class="header">
<p>下一篇： <a href="Wide-Character-Case-Conversion.html#Wide-Character-Case-Conversion" rel="next" accesskey="n">宽字符大小写转换</a> ，上一篇： <a href="Wide-Character-Case-Conversion.html#Wide-Character-Case-Conversion" rel="next" accesskey="n">宽字符</a> <a href="Classification-of-Wide-Characters.html#Classification-of-Wide-Characters" rel="prev" accesskey="p">分类</a> ，上一篇： <a href="Character-Handling.html#Character-Handling" rel="up" accesskey="u">字符处理</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>