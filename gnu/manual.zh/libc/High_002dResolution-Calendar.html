<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>高分辨率日历（GNU C库）</title>

<meta name="description" content="High-Resolution Calendar (The GNU C Library)">
<meta name="keywords" content="High-Resolution Calendar (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Calendar-Time.html#Calendar-Time" rel="up" title="Calendar Time">
<link href="Broken_002ddown-Time.html#Broken_002ddown-Time" rel="next" title="Broken-down Time">
<link href="Simple-Calendar-Time.html#Simple-Calendar-Time" rel="prev" title="Simple Calendar Time">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="High_002dResolution-Calendar"></span><div class="header">
<p>下一个： <a href="Broken_002ddown-Time.html#Broken_002ddown-Time" rel="next" accesskey="n">细分时间</a> ，上一个： <a href="Simple-Calendar-Time.html#Simple-Calendar-Time" rel="prev" accesskey="p">简单的日历时间</a> ，上一个： <a href="Calendar-Time.html#Calendar-Time" rel="up" accesskey="u">日历时间</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="High_002dResolution-Calendar-1"></span><h4 class="subsection">21.4.2高分辨率日历</h4>

<p>的<code>time_t</code>用于表示简单时间的数据类型的分辨率只有一秒。一些应用程序需要更高的精度。
</p>
<p>因此，GNU C库还包含能够以比一秒更高的分辨率表示日历时间的功能。本节中描述的函数和关联的数据类型在中声明<samp>sys/time.h</samp> 。
<span id="index-sys_002ftime_002eh-1"></span>
</p>
<dl>
<dt id="index-struct-timezone">数据类型： <strong>结构时区</strong></dt>
<dd>
<p>的<code>struct timezone</code>结构用于保存有关本地时区的最少信息。它具有以下成员：</p>
<dl compact>
<dt><code>int tz_minuteswest</code></dt>
<dd><p>这是UTC以西的分钟数。</p>
</dd>
<dt><code>int tz_dsttime</code></dt>
<dd><p>如果不为零，则夏令时适用于一年中的某些时间。
</p></dd>
</dl>

<p>的<code>struct timezone</code>类型已过时，永远不要使用。而是使用<a href="Time-Zone-Functions.html#Time-Zone-Functions">时区功能中</a>描述的<a href="Time-Zone-Functions.html#Time-Zone-Functions">功能</a> 。
</p></dd></dl>

<dl>
<dt id="index-gettimeofday">函数： <em>int</em> <strong>gettimeofday</strong> <em>（struct timeval * <var>tp</var> ，结构时区* <var>tzp</var> ）</em></dt>
<dd>
<p>初步： MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>gettimeofday</code>函数返回当前日历时间作为自<code>struct timeval</code>表示的结构<var>tp</var> 。 （见<a href="Elapsed-Time.html#Elapsed-Time">执行时间</a>为一个说明<code>struct timeval</code> ）。有关时区的信息将在指向的结构中返回<var>tzp</var> 。如果<var>tzp</var>参数是一个空指针，时区信息将被忽略。
</p>
<p>返回值为<code>0</code>成功与<code>-1</code>失败。下列<code>errno</code>为此功能定义了错误条件：</p>
<dl compact>
<dt><code>ENOSYS</code></dt>
<dd><p>操作系统不支持获取时区信息，并且<var>tzp</var>不是空指针。GNU系统不支持使用<code>struct timezone</code> <!-- /@w -->代表时区信息；这是4.3 BSD的过时功能。而是使用<a href="Time-Zone-Functions.html#Time-Zone-Functions">时区功能中</a>描述的<a href="Time-Zone-Functions.html#Time-Zone-Functions">功能</a> 。
</p></dd>
</dl>
</dd></dl>

<dl>
<dt id="index-settimeofday">函数： <em>int</em> <strong>settimeofday</strong> <em>（const struct timeval * <var>tp</var> ，const struct timezone * <var>tzp</var> ）</em></dt>
<dd>
<p>初步： MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>settimeofday</code>函数根据参数在系统时钟中设置当前日历时间。至于<code>gettimeofday</code> ，日历时间表示为从纪元开始经过的时间。至于<code>gettimeofday</code> ，如果时区信息被忽略， <var>tzp</var>是一个空指针。
</p>
<p>您必须是特权用户才能使用<code>settimeofday</code> 。
</p>
<p>一些内核在启动时会自动从某些来源（例如硬件时钟）设置系统时钟。其他包括Linux在内的系统则将系统时钟置于“无效”状态（在这种状态下，尝试读取时钟失败）。的呼吁<code>stime</code>从无效状态中删除系统时钟，并且系统启动脚本通常运行一个程序，该程序调用<code>stime</code> 。
</p>
<p><code>settimeofday</code>导致突然的向前或向后跳跃，这可能会导致系统出现各种问题。使用<code>adjtime</code> （下图）通过暂时加快或降低时钟速度，从一个时间平滑过渡到另一个时间。
</p>
<p>有了Linux内核， <code>adjtimex</code>做同样的事情，并且还可以永久更改系统时钟的速度，因此不需要经常进行更正。
</p>
<p>返回值为<code>0</code>成功与<code>-1</code>失败。下列<code>errno</code>为此功能定义了错误条件：</p>
<dl compact>
<dt><code>EPERM</code></dt>
<dd><p>此过程无法设置时钟，因为它没有特权。
</p>
</dd>
<dt><code>ENOSYS</code></dt>
<dd><p>操作系统不支持设置时区信息，并且<var>tzp</var>不是空指针。
</p></dd>
</dl>
</dd></dl>

<dl>
<dt id="index-adjtime">函数： <em>int</em> <strong>adjtime</strong> <em>（const struct timeval * <var>delta</var> ，struct timeval * <var>olddelta</var> ）</em></dt>
<dd>
<p>初步： MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>此功能可加快或减慢系统时钟，以进行逐步调整。这样可以确保系统时钟报告的日历时间始终单调增加，如果仅设置时钟就不会发生。
</p>
<p>的<var>delta</var>参数指定要对时钟时间进行的相对调整。如果为负，则将系统时钟放慢一段时间，直到失去了这么多的时间。如果为正，则系统时钟会加速一会儿。
</p>
<p>如果<var>olddelta</var>参数不是空指针， <code>adjtime</code>函数返回有关尚未完成的任何先前时间调整的信息。
</p>
<p>此功能通常用于同步本地网络中计算机的时钟。您必须是特权用户才能使用它。
</p>
<p>对于Linux内核，您可以使用<code>adjtimex</code>功能永久更改时钟速度。
</p>
<p>返回值为<code>0</code>成功与<code>-1</code>失败。下列<code>errno</code>为此功能定义了错误条件：</p>
<dl compact>
<dt><code>EPERM</code></dt>
<dd><p>您无权设置时间。
</p></dd>
</dl>
</dd></dl>

<p><strong>便携性注：</strong> <code>gettimeofday</code> ， <code>settimeofday</code>和<code>adjtime</code>函数是从BSD派生的。</p>

<p>以下函数的符号在中声明<samp>sys/timex.h</samp> 。
</p>
<dl>
<dt id="index-adjtimex">功能： <em>int</em> <strong>adjtimex</strong> <em>（struct timex * <var>timex</var> ）</em></dt>
<dd>
<p>初步： MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>


<p><code>adjtimex</code>在功能上与<code>ntp_adjtime</code> 。请参见<a href="High-Accuracy-Clock.html#High-Accuracy-Clock">高精度时钟</a> 。
</p>
<p>该功能仅在Linux内核中存在。
</p>
</dd></dl>

<hr>
<div class="header">
<p>下一个： <a href="Broken_002ddown-Time.html#Broken_002ddown-Time" rel="next" accesskey="n">细分时间</a> ，上一个： <a href="Simple-Calendar-Time.html#Simple-Calendar-Time" rel="prev" accesskey="p">简单的日历时间</a> ，上一个： <a href="Calendar-Time.html#Calendar-Time" rel="up" accesskey="u">日历时间</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>