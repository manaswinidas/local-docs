<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>替换malloc（GNU C库）</title>

<meta name="description" content="Replacing malloc (The GNU C Library)">
<meta name="keywords" content="Replacing malloc (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Memory-Allocation.html#Memory-Allocation" rel="up" title="Memory Allocation">
<link href="Obstacks.html#Obstacks" rel="next" title="Obstacks">
<link href="Interpreting-the-traces.html#Interpreting-the-traces" rel="prev" title="Interpreting the traces">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Replacing-malloc"></span><div class="header">
<p>下一篇： <a href="Obstacks.html#Obstacks" rel="next" accesskey="n">Obstacks</a> ，上一篇： <a href="Allocation-Debugging.html#Allocation-Debugging" rel="prev" accesskey="p">分配调试</a> ，上一篇： <a href="Memory-Allocation.html#Memory-Allocation" rel="up" accesskey="u">内存分配</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="Replacing-malloc-1"></span><h4 class="subsection">3.2.5更换<code>malloc</code></h4>

<span id="index-malloc-replacement"></span>
<span id="index-LD_005fPRELOAD-and-malloc"></span>
<span id="index-alternative-malloc-implementations"></span>
<span id="index-customizing-malloc"></span>
<span id="index-interposing-malloc"></span>
<span id="index-preempting-malloc"></span>
<span id="index-replacing-malloc"></span>
<p>GNU C库支持替换内置的<code>malloc</code>具有相同接口的其他分配器实现。对于动态链接的程序，这是通过使用共享对象相关性或<code>LD_PRELOAD</code> 。对于静态链接， <code>malloc</code>链接之前，必须先链接替换库<code>libc.a</code> （显式或隐式）。
</p>
<p><strong>注意：</strong>如果未能提供完整的替换功能集（即应用程序，GNU C库和其他链接的库使用的所有功能），则可能导致静态链接失败，并在运行时堆积损坏和应用程序崩溃。
</p>
<p>定制必须提供的最少功能集<code>malloc</code>在下表中给出。
</p>
<dl compact>
<dt><code>malloc</code></dt>
<dt><code>free</code></dt>
<dt><code>calloc</code></dt>
<dt><code>realloc</code></dt>
</dl>

<p>这些<code>malloc</code>与GNU C库相关的功能是必需的。 <a id="DOCF1" href="#FOOT1"><sup>1个</sup></a>
</p>
<p>的<code>malloc</code> GNU C库中的实现提供了库本身未使用的其他功能，但其他系统库和应用程序经常使用该功能。通用替代品<code>malloc</code>实现也应该提供这些功能的定义。下表中列出了它们的名称。
</p>
<dl compact>
<dt><code>aligned_alloc</code></dt>
<dt><code>malloc_usable_size</code></dt>
<dt><code>memalign</code></dt>
<dt><code>posix_memalign</code></dt>
<dt><code>pvalloc</code></dt>
<dt><code>valloc</code></dt>
</dl>

<p>此外，非常老的应用程序可能会过时<code>cfree</code>功能。
</p>
<p>进一步<code>malloc</code>相关功能，例如<code>mallopt</code>要么<code>mallinfo</code>替换时不会有任何影响或返回错误的统计信息<code>malloc</code>正在使用中。但是，未能替换这些功能通常不会导致崩溃或其他不正确的应用程序行为，但是可能导致静态链接失败。
</p>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">脚注</h4>

<h3><a id="FOOT1" href="#DOCF1">（1）</a></h3>
<p>2.25之前的GNU C库版本需要自定义<code>malloc</code>定义<code>__libc_memalign</code> （具有与<code>memalign</code>功能）。</p>
</div>
<hr>
<div class="header">
<p>下一篇： <a href="Obstacks.html#Obstacks" rel="next" accesskey="n">Obstacks</a> ，上一篇： <a href="Allocation-Debugging.html#Allocation-Debugging" rel="prev" accesskey="p">分配调试</a> ，上一篇： <a href="Memory-Allocation.html#Memory-Allocation" rel="up" accesskey="u">内存分配</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>