<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>基本信号处理（GNU C库）</title>

<meta name="description" content="Basic Signal Handling (The GNU C Library)">
<meta name="keywords" content="Basic Signal Handling (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Signal-Actions.html#Signal-Actions" rel="up" title="Signal Actions">
<link href="Advanced-Signal-Handling.html#Advanced-Signal-Handling" rel="next" title="Advanced Signal Handling">
<link href="Signal-Actions.html#Signal-Actions" rel="prev" title="Signal Actions">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Basic-Signal-Handling"></span><div class="header">
<p>下一页： <a href="Advanced-Signal-Handling.html#Advanced-Signal-Handling" rel="next" accesskey="n">高级信号处理</a> ，向上： <a href="Signal-Actions.html#Signal-Actions" rel="up" accesskey="u">信号动作</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="Basic-Signal-Handling-1"></span><h4 class="subsection">24.3.1基本信号处理</h4>
<span id="index-signal-function"></span>

<p>的<code>signal</code>功能提供了用于为特定信号建立动作的简单接口。函数和关联的宏在头文件中声明<samp>signal.h</samp> 。
<span id="index-signal_002eh-2"></span>
</p>
<dl>
<dt id="index-sighandler_005ft">数据类型： <strong>sighandler_t</strong></dt>
<dd>
<p>这是信号处理程序函数的类型。信号处理程序采用一个整数参数指定信号编号，并具有返回类型<code>void</code> 。因此，您应该定义如下处理程序函数：</p>
<div class="example">
<pre class="example">void <var>handler</var> (int <code>signum</code>) { &hellip; }
</pre></div>

<p>名字<code>sighandler_t</code>此数据类型是GNU扩展。
</p></dd></dl>

<dl>
<dt id="index-signal-2">函数： <em>sighandler_t</em> <strong>信号</strong> <em>（int <var>signum</var> ，sighandler_t <var>action</var> ）</em></dt>
<dd>
<p>初步： MT-Safe警报器| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>signal</code>功能建立<var>action</var>作为信号的作用<var>signum</var> 。
</p>
<p>第一个论点， <var>signum</var> ，标识要控制其行为的信号，应为信号编号。指定信号编号的正确方法是使用符号信号名称之一（请参阅“ <a href="Standard-Signals.html#Standard-Signals">标准信号”</a> ）-不要使用显式数字，因为给定信号类型的数字代码可能会因操作系统而异。
</p>
<p>第二个论点<var>action</var> ，指定用于信号的动作<var>signum</var> 。可以是以下之一：</p>
<dl compact>
<dt><code>SIG_DFL</code></dt>
<dd><span id="index-SIG_005fDFL"></span>
<span id="index-default-action-for-a-signal"></span>
<p><code>SIG_DFL</code>指定特定信号的默认操作。<a href="Standard-Signals.html#Standard-Signals">标准信号</a>中说明了各种信号的默认操作。
</p>
</dd>
<dt><code>SIG_IGN</code></dt>
<dd><span id="index-SIG_005fIGN"></span>
<span id="index-ignore-action-for-a-signal"></span>
<p><code>SIG_IGN</code>指定应忽略信号。
</p>
<p>您的程序通常不应忽略代表严重事件或通常用于请求终止的信号。你不能忽略<code>SIGKILL</code>要么<code>SIGSTOP</code>信号。您可以忽略程序错误信号，例如<code>SIGSEGV</code> ，但是忽略该错误将无法使程序继续有意义地执行。忽略用户请求，例如<code>SIGINT</code> ， <code>SIGQUIT</code>和<code>SIGTSTP</code>是不友好的。
</p>
<p>如果您不希望在程序的特定部分发送信号，则要做的是阻止它们，而不是忽略它们。请参阅<a href="Blocking-Signals.html#Blocking-Signals">阻止信号</a> 。
</p>
</dd>
<dt><code><var>handler</var></code></dt>
<dd><p>提供程序中处理程序函数的地址，以指定运行该处理程序作为传递信号的方式。
</p>
<p>有关定义信号处理程序功能的更多信息，请参见<a href="Defining-Handlers.html#Defining-Handlers">定义处理程序</a> 。
</p></dd>
</dl>

<p>如果您将信号的动作设置为<code>SIG_IGN</code> ，或者将其设置为<code>SIG_DFL</code>并且默认操作是忽略该信号，则该类型的所有未决信号都将被丢弃（即使它们被阻止）。丢弃待处理信号意味着即使您随后指定其他操作并取消阻止此类信号，也将永远不会将其发送出去。
</p>
<p>的<code>signal</code>函数返回先前对指定对象有效的操作<var>signum</var> 。您可以保存此值并稍后通过调用恢复它<code>signal</code>再次。
</p>
<p>如果<code>signal</code>无法接受请求，它返回<code>SIG_ERR</code>代替。下列<code>errno</code>为此功能定义了错误条件：</p>
<dl compact>
<dt><code>EINVAL</code></dt>
<dd><p>您指定的无效<var>signum</var> ;或者您尝试忽略或提供以下内容的处理程序<code>SIGKILL</code>要么<code>SIGSTOP</code> 。
</p></dd>
</dl>
</dd></dl>

<p><strong>兼容性说明：</strong>使用<code>signal</code>功能是在BSD和SVID系统上具有不同的语义。区别在于，在SVID系统上，信号处理程序在信号传送后被卸载。在BSD系统上，必须明确卸载处理程序。在GNU C库中，默认情况下使用BSD版本。要使用SVID版本，您可以使用函数<code>sysv_signal</code> （请参见下文）或使用<code>_XOPEN_SOURCE</code>功能选择宏（请参阅<a href="Feature-Test-Macros.html#Feature-Test-Macros">功能测试宏</a> ）。通常，由于兼容性问题，应避免使用这些功能。最好用<code>sigaction</code>是否可用，因为结果要可靠得多。
</p>
<p>这是一个设置处理程序以在发生某些致命信号时删除临时文件的简单示例：</p>
<div class="example">
<pre class="example">#include &lt;signal.h&gt;

void
termination_handler (int signum)
{
  struct temp_file *p;

  for (p = temp_file_list; p; p = p-&gt;next)
    unlink (p-&gt;name);
}

int
main (void)
{
  &hellip;
  if (signal (SIGINT, termination_handler) == SIG_IGN)
    signal (SIGINT, SIG_IGN);
  if (signal (SIGHUP, termination_handler) == SIG_IGN)
    signal (SIGHUP, SIG_IGN);
  if (signal (SIGTERM, termination_handler) == SIG_IGN)
    signal (SIGTERM, SIG_IGN);
  &hellip;
}
</pre></div>

<p>请注意，如果先前已将给定信号设置为忽略，则此代码避免更改该设置。这是因为非作业控制外壳程序在启动孩子时通常会忽略某些信号，因此对于孩子来说要遵守这一点很重要。
</p>
<p>我们不处理<code>SIGQUIT</code>或本例中的程序错误信号，因为它们旨在提供调试信息（核心转储），并且临时文件可能会提供有用的信息。
</p>
<dl>
<dt id="index-sysv_005fsignal">函数： <em>sighandler_t</em> <strong>sysv_signal</strong> <em>（int <var>signum</var> ，sighandler_t <var>action</var> ）</em></dt>
<dd>
<p>初步： MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>sysv_signal</code>实现标准的行为<code>signal</code>功能与SVID系统上的功能相同。与BSD系统的区别在于，在传送信号之后，将卸载处理程序。
</p>
<p><strong>兼容性说明：</strong>如上所述<code>signal</code> ，应尽可能避免使用此功能。 <code>sigaction</code>是首选方法。
</p></dd></dl>

<dl>
<dt id="index-ssignal">功能： <em>sighandler_t</em> <strong>信号</strong> <em>（int <var>signum</var> ，sighandler_t <var>action</var> ）</em></dt>
<dd>
<p>初步： MT-Safe警报器| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>ssignal</code>函数与<code>signal</code> ;提供它仅是为了与SVID兼容。</p></dd></dl>

<dl>
<dt id="index-SIG_005fERR">巨集： <em>sighandler_t</em> <strong>SIG_ERR</strong></dt>
<dd>
<p>此宏的值用作来自的返回值<code>signal</code>表示错误。
</p></dd></dl>



<hr>
<div class="header">
<p>下一页： <a href="Advanced-Signal-Handling.html#Advanced-Signal-Handling" rel="next" accesskey="n">高级信号处理</a> ，向上： <a href="Signal-Actions.html#Signal-Actions" rel="up" accesskey="u">信号动作</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>