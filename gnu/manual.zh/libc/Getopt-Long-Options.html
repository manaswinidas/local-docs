<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Getopt长选项（GNU C库）</title>

<meta name="description" content="Getopt Long Options (The GNU C Library)">
<meta name="keywords" content="Getopt Long Options (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Getopt.html#Getopt" rel="up" title="Getopt">
<link href="Getopt-Long-Option-Example.html#Getopt-Long-Option-Example" rel="next" title="Getopt Long Option Example">
<link href="Example-of-Getopt.html#Example-of-Getopt" rel="prev" title="Example of Getopt">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Getopt-Long-Options"></span><div class="header">
<p>下一页： <a href="Getopt-Long-Option-Example.html#Getopt-Long-Option-Example" rel="next" accesskey="n">Getopt Long选项示例</a> ，Previous： <a href="Example-of-Getopt.html#Example-of-Getopt" rel="prev" accesskey="p">Getopt示例</a> ，Up： <a href="Getopt.html#Getopt" rel="up" accesskey="u">Getopt</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="Parsing-Long-Options-with-getopt_005flong"></span><h4 class="subsection">25.2.3使用以下命令解析长选项<code>getopt_long</code></h4>

<p>要接受GNU风格的长选项以及单字符选项，请使用<code>getopt_long</code>代替<code>getopt</code> 。该函数在<samp>getopt.h</samp> ，不是<samp>unistd.h</samp> 。如果每个程序都使用长选项，则应使它接受长选项，因为这几乎不需要额外的工作，并且可以帮助初学者记住如何使用该程序。
</p>
<dl>
<dt id="index-struct-option">数据类型： <strong>struct选项</strong></dt>
<dd>
<p>为了便于说明，此结构描述了一个长选项名称<code>getopt_long</code> 。争论<var>longopts</var>必须是这些结构的数组，每个长选项一个。用包含全零的元素终止数组。
</p>
<p>的<code>struct option</code>结构具有以下字段：</p>
<dl compact>
<dt><code>const char *name</code></dt>
<dd><p>此字段是选项的名称。它是一个字符串。
</p>
</dd>
<dt><code>int has_arg</code></dt>
<dd><p>该字段说明选项是否接受参数。它是一个整数，并且有三个合法值： <code><span class="nolinebreak">no_argument</span></code> <!-- /@w --> ， <code>required_argument</code>和<code>optional_argument</code> 。
</p>
</dd>
<dt><code>int *flag</code></dt>
<dt><code>int val</code></dt>
<dd><p>这些字段控制选项发生时如何报告或采取行动。
</p>
<p>如果<code>flag</code>是一个空指针，则<code>val</code>是标识此选项的值。通常选择这些值来唯一地标识特定的长期权。
</p>
<p>如果<code>flag</code>不是空指针，它应该是<code>int</code>变量，它是此选项的标志。中的值<code>val</code>是要存储在标志中的值，以指示该选项已被查看。
</p></dd>
</dl>
</dd></dl>

<dl>
<dt id="index-getopt_005flong">函数： <em>int</em> <strong>getopt_long</strong> <em>（int <var>argc</var> ，char * const * <var>argv</var> ，const char * <var>shortopts</var> ，const struct选项* <var>longopts</var> ，int * <var>indexptr</var> ）</em></dt>
<dd>
<p>初步： MT不安全种族：getopt env | AS不安全堆i18n锁损坏| AC不安全的内存锁损坏|请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>从向量解码选项<var>argv</var> （其长度为<var>argc</var> ）。争论<var>shortopts</var>描述接受的简短选项，就像在<code>getopt</code> 。争论<var>longopts</var>描述了接受的长选项（请参见上文）。
</p>
<p>什么时候<code>getopt_long</code>遇到一个简短的选择，它做同样的事情<code>getopt</code>可以：返回选项的字符代码，并将选项的参数（如果有）存储在<code>optarg</code> 。
</p>
<p>什么时候<code>getopt_long</code>遇到一个很长的选择，它会根据<code>flag</code>和<code>val</code>该选项的定义的字段。
</p>
<p>如果<code>flag</code>是一个空指针，然后<code>getopt_long</code>返回的内容<code>val</code>指出找到的选项。您应该在<code>val</code>字段用于具有不同含义的选项，因此您可以在之后解码这些值<code>getopt_long</code>返回。如果long选项等效于short选项，则可以在其中使用short选项的字符代码。 <code>val</code> 。
</p>
<p>如果<code>flag</code>不是一个空指针，这意味着该选项应仅在程序中设置一个标志。标志是类型的变量<code>int</code>您定义的。将标志的地址放在<code>flag</code>领域。放在<code>val</code>字段将您希望此选项存储在标志中的值。在这种情况下， <code>getopt_long</code>退货<code>0</code> 。
</p>
<p>对于任何长选项， <code>getopt_long</code>告诉你数组中的索引<var>longopts</var>将选项定义存储到<code>*<var>indexptr</var></code> 。您可以使用以下方式获取选项名称<code><var>longopts</var>[*<var>indexptr</var>].name</code> 。因此，您可以通过长选项中的值来区分长选项<code>val</code>字段或按其索引。您还可以通过这种方式在设置标志的长选项之间进行区分。
</p>
<p>当长选项有参数时， <code>getopt_long</code>将参数值放入变量中<code>optarg</code>返回之前。当选项没有参数时， <code>optarg</code>是一个空指针。这样可以确定是否提供了可选参数。
</p>
<p>什么时候<code>getopt_long</code>没有更多要处理的选项，它将返回<code>-1</code> ，并留在变量中<code>optind</code>索引<var>argv</var>剩下的下一个参数。
</p></dd></dl>

<p>由于以前使用过长的选项名称<code>getopt_long</code>发明了程序接口，要求程序识别诸如“ <samp><span class="nolinebreak">-option</span> value</samp> ' <!-- /@w -->代替' <samp><span class="nolinebreak">--option</span> value</samp> ' <!-- /@w --> 。为了使这些程序能够使用GNU getopt功能，还有一个可用的功能。
</p>
<dl>
<dt id="index-getopt_005flong_005fonly">函数： <em>int</em> <strong>getopt_long_only</strong> <em>（int <var>argc</var> ，char * const * <var>argv</var> ，const char * <var>shortopts</var> ，const struct选项* <var>longopts</var> ，int * <var>indexptr</var> ）</em></dt>
<dd>
<p>初步： MT不安全种族：getopt env | AS不安全堆i18n锁损坏| AC不安全的内存锁损坏|请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>


<p>的<code>getopt_long_only</code>功能相当于<code>getopt_long</code>功能，但允许应用程序的用户仅使用' <samp>-</samp> ' 代替 ' <samp>--</samp> '。' <samp>--</samp> '前缀仍然可以识别，但是如果' <samp>-</samp>可以看到，首先尝试使用此参数是否命名长选项。如果不是，则将其解析为短选项。
</p>
<p>假设<code>getopt_long_only</code>用于启动应用程序</p>
<div class="example">
<pre class="example">  app -foo
</pre></div>

<p>的<code>getopt_long_only</code>首先会寻找一个名为“ <samp>foo</samp> '。如果未找到，则短选项' <samp>f</samp> '，' <samp>o</samp> '， 然后再次 ' <samp>o</samp>被认可。
</p></dd></dl>

<hr>
<div class="header">
<p>下一页： <a href="Getopt-Long-Option-Example.html#Getopt-Long-Option-Example" rel="next" accesskey="n">Getopt Long选项示例</a> ，Previous： <a href="Example-of-Getopt.html#Example-of-Getopt" rel="prev" accesskey="p">Getopt示例</a> ，Up： <a href="Getopt.html#Getopt" rel="up" accesskey="u">Getopt</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>