<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>使用gettext进行翻译（GNU C库）</title>

<meta name="description" content="Translation with gettext (The GNU C Library)">
<meta name="keywords" content="Translation with gettext (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Message-catalogs-with-gettext.html#Message-catalogs-with-gettext" rel="up" title="Message catalogs with gettext">
<link href="Locating-gettext-catalog.html#Locating-gettext-catalog" rel="next" title="Locating gettext catalog">
<link href="Message-catalogs-with-gettext.html#Message-catalogs-with-gettext" rel="prev" title="Message catalogs with gettext">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Translation-with-gettext"></span><div class="header">
<p>下一页： <a href="Locating-gettext-catalog.html#Locating-gettext-catalog" rel="next" accesskey="n">查找gettext目录</a> ，上： <a href="Message-catalogs-with-gettext.html#Message-catalogs-with-gettext" rel="up" accesskey="u">具有gettext的消息目录</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="What-has-to-be-done-to-translate-a-message_003f"></span><h4 class="subsubsection">8.2.1.1必须执行什么翻译消息？</h4>

<p>的<code>gettext</code>函数具有非常简单的界面。最基本的功能只是将要翻译的字符串作为参数，并返回翻译结果。这与<code>catgets</code>需要额外密钥且原始字符串仅用于错误情况的一种方法。
</p>
<p>如果必须翻译的字符串是唯一的参数，则这当然意味着字符串本身就是键。即，将根据原始字符串选择翻译。因此，消息目录必须包含原始字符串以及任何此类字符串的一个翻译。的任务<code>gettext</code>函数是将参数字符串与目录中的可用字符串进行比较，并返回适当的转换。当然，此过程已经过优化，因此该过程不会比使用原子键的访问（例如， <code>catgets</code> 。
</p>
<p>的<code>gettext</code>这种方法既有优点也有缺点。请参阅GNU <samp>gettext</samp>手册详细讨论了利弊。
</p>
<p>的所有定义和声明<code>gettext</code>可以在<samp>libintl.h</samp>头文件。在这些函数不属于C库的系统上，可以在名为C的单独库中找到它们<samp>libintl.a</samp> （或相应地对于共享库而言也不同）。
</p>
<dl>
<dt id="index-gettext">函数： <em>char *</em> <strong>gettext</strong> <em>（const char * <var>msgid</var> ）</em></dt>
<dd>
<p>初步： MT安全环境| AS不安全损坏的堆锁dlopen | AC不安全损坏的锁fd mem |请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>gettext</code>函数在当前选择的消息目录中搜索等于的字符串<var>msgid</var> 。如果有这样的字符串可用，则将其返回。否则参数字符串<var>msgid</var>返回。
</p>
<p>请注意，尽管返回值为<code>char *</code>返回的字符串不得更改。这种损坏的类型是由功能历史记录引起的，并不反映应使用功能的方式。
</p>
<p>请注意，上面我们写了“消息目录”（复数）。这是这些功能的GNU实现的一个特长，当我们谈论选择消息目录的方式时，我们将对此进行详细介绍（请参阅<a href="Locating-gettext-catalog.html#Locating-gettext-catalog">查找gettext目录</a> ）。
</p>
<p>的<code>gettext</code>函数不会修改全局值<code>errno</code>变量。这是使写类似的东西所必需的</p>
<div class="example">
<pre class="example">  printf (gettext (&quot;Operation failed: %m\n&quot;));
</pre></div>

<p>在这里<code>errno</code>值用于<code>printf</code>在处理<code>%m</code>格式元素，如果<code>gettext</code>函数将更改此值（在之前调用<code>printf</code>被称为），我们会收到错误消息。
</p>
<p>因此，除了将参数字符串与结果进行比较之外，没有简便的方法来检测丢失的消息目录。但是通常，用户的任务是对丢失的目录做出反应。该程序无法猜测何时确实需要消息目录，因为对于使用该程序所使用语言的用户而言，该消息不需要任何翻译。
</p></dd></dl>

<p>其余两个访问消息目录的功能添加了一些功能来选择不是默认目录的消息目录。如果程序的某些部分是独立开发的，则这一点很重要。每个部分都可以有自己的消息目录，并且所有这些都可以同时使用。C库本身就是一个例子：在内部它使用<code>gettext</code>功能，但是由于它一定不能依赖当前选择的默认消息目录，因此必须指定所有不明确的信息。
</p>
<dl>
<dt id="index-dgettext">函数： <em>char *</em> <strong>dgettext</strong> <em>（const char * <var>domainname</var> ，const char * <var>msgid</var> ）</em></dt>
<dd>
<p>初步： MT安全环境| AS不安全损坏的堆锁dlopen | AC不安全损坏的锁fd mem |请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>dgettext</code>功能就像<code>gettext</code>功能。只需要一个额外的第一个参数<var>domainname</var>它指导选择要搜索翻译的消息目录。如果<var>domainname</var>参数是空指针<code>dgettext</code>功能完全等同于<code>gettext</code>因为使用了域名的默认值。
</p>
<p>至于<code>gettext</code>返回值类型是<code>char *</code>这是不合时宜的。返回的字符串绝不能修改。
</p></dd></dl>

<dl>
<dt id="index-dcgettext">函数： <em>char *</em> <strong>dcgettext</strong> <em>（const char * <var>domainname</var> ，const char * <var>msgid</var> ，int <var>category</var> ）</em></dt>
<dd>
<p>初步： MT安全环境| AS不安全损坏的堆锁dlopen | AC不安全损坏的锁fd mem |请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>dcgettext</code>给那些添加了另一个参数<code>dgettext</code>需要。这个论点<var>category</var>指定本地化消息目录所需的最后一条信息。即，域名和语言环境类别准确地指定了必须使用的消息目录（相对于给定目录，请参见下文）。
</p>
<p>的<code>dgettext</code>功能可以表示为<code>dcgettext</code>通过使用</p>
<div class="example">
<pre class="example">dcgettext (domain, string, LC_MESSAGES)
</pre></div>

<p>代替</p>
<div class="example">
<pre class="example">dgettext (domain, string)
</pre></div>

<p>这也显示了第三个参数需要哪些值。必须使用可用的选择器来选择<samp>locale.h</samp> 。通常可用的值是<code>LC_CTYPE</code> ， <code>LC_COLLATE</code> ， <code>LC_MESSAGES</code> ， <code>LC_MONETARY</code> ， <code>LC_NUMERIC</code>和<code>LC_TIME</code> 。请注意<code>LC_ALL</code>绝对不能使用，即使名称可能暗示了这一点，也与该名称的环境变量无关。
</p>
<p>的<code>dcgettext</code>实现该功能仅是为了与具有以下功能的其他系统兼容<code>gettext</code>功能。实际上，在任何情况下都没有必要（或有用）使用与<code>LC_MESSAGES</code>为了<var>category</var>参数。我们在这里处理消息，任何其他选择都只会令人烦恼。
</p>
<p>至于<code>gettext</code>返回值类型是<code>char *</code>这是不合时宜的。返回的字符串绝不能修改。
</p></dd></dl>

<p>在程序中使用上述三个功能时，经常会出现<var>msgid</var>参数是一个常量字符串。因此优化这种情况是值得的。简短地考虑这一点将意识到，只要没有加载新的消息目录，消息的翻译就不会改变。该优化实际上是由<code>gettext</code> ， <code>dgettext</code>和<code>dcgettext</code>功能。
</p>

<hr>
<div class="header">
<p>下一页： <a href="Locating-gettext-catalog.html#Locating-gettext-catalog" rel="next" accesskey="n">查找gettext目录</a> ，上： <a href="Message-catalogs-with-gettext.html#Message-catalogs-with-gettext" rel="up" accesskey="u">具有gettext的消息目录</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>