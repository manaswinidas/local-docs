<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>功能测试宏（GNU C库）</title>

<meta name="description" content="Feature Test Macros (The GNU C Library)">
<meta name="keywords" content="Feature Test Macros (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Using-the-Library.html#Using-the-Library" rel="up" title="Using the Library">
<link href="Roadmap-to-the-Manual.html#Roadmap-to-the-Manual" rel="next" title="Roadmap to the Manual">
<link href="Reserved-Names.html#Reserved-Names" rel="prev" title="Reserved Names">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Feature-Test-Macros"></span><div class="header">
<p>上一篇： <a href="Reserved-Names.html#Reserved-Names" rel="prev" accesskey="p">保留名称</a> ，上一篇： <a href="Using-the-Library.html#Using-the-Library" rel="up" accesskey="u">使用库</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="Feature-Test-Macros-1"></span><h4 class="subsection">1.3.4功能测试宏</h4>

<span id="index-feature-test-macros"></span>
<p>编译源文件时可用的确切功能集由定义的<em>功能测试宏</em>控制。
</p>
<p>如果您使用“ <samp>gcc -ansi</samp> ”，则仅获得ISO C <!-- /@w -->库功能，除非您通过定义一个或多个功能宏来明确请求其他功能。有关GCC选项的更多信息，请参见<a href="https://gcc.gnu.org/onlinedocs/gcc/Invoking-GCC.html#Invoking-GCC">GNU CC</a> <cite>手册</cite>中<cite>的</cite> <a href="https://gcc.gnu.org/onlinedocs/gcc/Invoking-GCC.html#Invoking-GCC">GNU CC命令选项</a> 。
</p>
<p>您应该使用'定义这些宏<samp>#define</samp> '预处理器指令位于源代码文件的顶部。这些指令<em>必须</em>先于<code>#include</code>系统头文件。最好使它们成为文件中的第一件事，仅在注释之前。您也可以使用“ <samp>-D</samp> '选项作为GCC，但是最好使源文件以独立的方式表明其自身含义。
</p>
<p>存在该系统以允许库符合多种标准。尽管通常将不同的标准描述为彼此的超集，但它们通常不兼容，因为较大的标准要求使用名称较小的功能保留给用户程序的功能。这不仅仅是纯粹的脚手架-在实践中一直是一个问题。例如，某些非GNU程序定义了名为<code>getline</code>与该库的无关<code>getline</code> 。如果不加选择地启用所有功能，它们将不可编译。
</p>
<p>这不应用于验证程序是否符合受限标准。这不足以实现此目的，因为它不能保护您避免在标准之外包括头文件，也不能依赖于标准内未定义的语义。
</p>
<dl>
<dt id="index-_005fPOSIX_005fSOURCE">巨集： <strong>_POSIX_SOURCE</strong></dt>
<dd>
<p>如果定义此宏，则可以使用POSIX.1标准（IEEE标准1003.1）的功能以及所有ISO C <!-- /@w -->功能。
</p>
<p>的状态<code>_POSIX_SOURCE</code>如果定义宏，则无关紧要<code>_POSIX_C_SOURCE</code>到一个正整数。
</p></dd></dl>

<dl>
<dt id="index-_005fPOSIX_005fC_005fSOURCE">巨集： <strong>_POSIX_C_SOURCE</strong></dt>
<dd>
<p>将此宏定义为正整数，以控制哪些POSIX功能可用。该宏的值越大，可用的功能越多。
</p>
<p>如果您将此宏定义为大于或等于的值<code>1</code> ，则可以使用1990版POSIX.1标准（IEEE标准1003.1-1990）中的功能。
</p>
<p>如果您将此宏定义为大于或等于的值<code>2</code> ，则可以使用POSIX.2标准的1992版（IEEE标准1003.2-1992）的功能。
</p>
<p>如果您将此宏定义为大于或等于的值<code>199309L</code> ，则可以使用POSIX.1b标准1993年版本（IEEE标准1003.1b-1993）中的功能。
</p>
<p>如果您将此宏定义为大于或等于的值<code>199506L</code> ，则可以使用1995版POSIX.1c标准（IEEE标准1003.1c-1995）中的功能。
</p>
<p>如果您将此宏定义为大于或等于的值<code>200112L</code> ，则可以使用POSIX标准的2001版（IEEE标准1003.1-2001）中的功能。
</p>
<p>如果您将此宏定义为大于或等于的值<code>200809L</code> ，则可以使用POSIX标准2008版（IEEE标准1003.1-2008）中的功能。
</p>
<p>更高的价值<code>_POSIX_C_SOURCE</code>将启用将来的扩展。POSIX标准过程将根据需要定义这些值，并且GNU C库在它们标准化之后应支持它们。POSIX.1（ISO / IEC 9945-1：1996）的1996年版规定： <code>_POSIX_C_SOURCE</code>大于或等于<code>199506L</code> ，然后提供1996版的功能。通常，在GNU C库中，指定基本版本时会包含对标准的错误修正。例如POSIX.1-2004将始终包含值为<code>200112L</code> 。
</p></dd></dl>

<dl>
<dt id="index-_005fXOPEN_005fSOURCE">巨集： <strong>_XOPEN_SOURCE</strong></dt>
<dt id="index-_005fXOPEN_005fSOURCE_005fEXTENDED">巨集： <strong>_XOPEN_SOURCE_EXTENDED</strong></dt>
<dd>
<p>如果定义此宏，则包含《 X / Open可移植性指南》中描述的功能。这是POSIX.1和POSIX.2功能的超集，实际上<code>_POSIX_SOURCE</code>和<code>_POSIX_C_SOURCE</code>是自动定义的。
</p>
<p>作为所有Unices的统一，还包括仅在BSD和SVID中可用的功能。
</p>
<p>如果宏<code>_XOPEN_SOURCE_EXTENDED</code>还定义了，甚至有更多功能可用。额外的功能将使X / Open Unix品牌所需的所有功能可用。
</p>
<p>如果宏<code>_XOPEN_SOURCE</code>的值为<em>500，</em>其中包括到目前为止描述的所有功能以及Single Unix Specification版本2 <!-- /@w -->一些新定义。值<em>600</em> （对应于第六个修订版）包含SUSv3的定义，而值<em>700</em> （第七个修订版）包含SUSv4的定义。
</p></dd></dl>

<dl>
<dt id="index-_005fLARGEFILE_005fSOURCE">巨集： <strong>_LARGEFILE_SOURCE</strong></dt>
<dd>
<p>如果定义了此宏，则可以使用一些额外的功能，这些功能可以纠正所有先前标准中的一些缺点。具体来说，功能<code>fseeko</code>和<code>ftello</code>可用。没有这些功能，ISO C <!-- /@w -->接口（ <code>fseek</code> ， <code>ftell</code> ）和底层POSIX接口（ <code>lseek</code> ）会导致问题。
</p>
<p>此宏是作为大文件支持扩展（LFS）的一部分引入的。
</p></dd></dl>

<dl>
<dt id="index-_005fLARGEFILE64_005fSOURCE">巨集： <strong>_LARGEFILE64_SOURCE</strong></dt>
<dd>
<p>如果定义此宏，则将提供一组附加功能，这些功能使32位<!-- /@w -->系统能够使用大小通常超出2GB的文件。如果系统不支持那么大的文件，则此接口不可用。在自然文件大小限制大于2GB的系统上（即，在64位<!-- /@w -->系统上），新功能与替换的功能相同。
</p>
<p>一组新的类型和功能取代了现有的功能，从而提供了新功能。这些新对象的名称包含<code>64</code>表示意图，例如<code>off_t</code>与<code>off64_t</code>和<code>fseeko</code>与<code>fseeko64</code> 。
</p>
<p>此宏是作为大文件支持扩展（LFS）的一部分引入的。它是一段时间内的过渡接口，通常不使用64位<!-- /@w -->偏移量（请参见<code>_FILE_OFFSET_BITS</code> ）。
</p></dd></dl>

<dl>
<dt id="index-_005fFILE_005fOFFSET_005fBITS">巨集： <strong>_FILE_OFFSET_BITS</strong></dt>
<dd>
<p>此宏确定应使用哪个文件系统接口，一个替代另一个。鉴于<code>_LARGEFILE64_SOURCE</code>使64位<!-- /@w -->接口可用作附加接口， <code>_FILE_OFFSET_BITS</code>允许64位<!-- /@w -->接口替换旧接口。
</p>
<p>如果<code>_FILE_OFFSET_BITS</code>是未定义的，或者是否已定义为值<code>32</code> ， 没有什么改变。使用了32位<!-- /@w -->接口，类型如下<code>off_t</code>在32位<!-- /@w -->系统上，其大小为32位<!-- /@w --> 。
</p>
<p>如果宏定义为该值<code>64</code> ，大文件界面替代了旧界面。即，这些功能不能以不同的名称使用（因为它们与<code>_LARGEFILE64_SOURCE</code> ）。相反，旧函数名称现在引用了新函数，例如，对<code>fseeko</code>现在确实在打电话<code>fseeko64</code> 。
</p>
<p>仅当系统提供了处理大文件的机制时，才应选择此宏。在64位<!-- /@w -->系统上，此宏无效，因为<code>*64</code>功能与正常功能相同。
</p>
<p>此宏是作为大文件支持扩展（LFS）的一部分引入的。
</p></dd></dl>

<dl>
<dt id="index-_005fISOC99_005fSOURCE">巨集： <strong>_ISOC99_SOURCE</strong></dt>
<dd>
<p>如果定义了此宏，则包含ISO C99中的功能。由于默认情况下包括这些功能，因此当编译器使用较早的语言版本时，此宏与大多数情况相关。
</p></dd></dl>

<dl>
<dt id="index-_005fISOC11_005fSOURCE">巨集： <strong>_ISOC11_SOURCE</strong></dt>
<dd>
<p>如果定义了此宏，则包括对ISO C99的ISO C11扩展。
</p></dd></dl>

<dl>
<dt id="index-_005f_005fSTDC_005fWANT_005fLIB_005fEXT2_005f_005f">巨集： <strong>__ STDC_WANT_LIB_EXT2__</strong></dt>
<dd>
<p>如果您将此宏定义为值<code>1</code> ，启用了ISO / IEC TR 24731-2：2010（动态分配功能）中的功能。GNU C库仅支持该TR中的某些功能。
</p></dd></dl>

<dl>
<dt id="index-_005f_005fSTDC_005fWANT_005fIEC_005f60559_005fBFP_005fEXT_005f_005f">巨集： <strong>__ STDC_WANT_IEC_60559_BFP_EXT__</strong></dt>
<dd>
<p>如果定义此宏，则会启用ISO / IEC TS 18661-1：2014（C的浮点扩展：二进制浮点算术）中的功能。GNU C库仅支持此TS中的某些功能。
</p></dd></dl>

<dl>
<dt id="index-_005f_005fSTDC_005fWANT_005fIEC_005f60559_005fFUNCS_005fEXT_005f_005f">巨集： <strong>__ STDC_WANT_IEC_60559_FUNCS_EXT__</strong></dt>
<dd>
<p>如果定义此宏，则会启用ISO / IEC TS 18661-4：2015中的功能（C的浮点扩展：补充功能）。GNU C库仅支持此TS中的某些功能。
</p></dd></dl>

<dl>
<dt id="index-_005f_005fSTDC_005fWANT_005fIEC_005f60559_005fTYPES_005fEXT_005f_005f">巨集： <strong>__ STDC_WANT_IEC_60559_TYPES_EXT__</strong></dt>
<dd>
<p>如果定义此宏，则会启用ISO / IEC TS 18661-3：2015中的功能（C的浮点扩展：交换和扩展类型）。GNU C库仅支持此TS中的某些功能。
</p></dd></dl>

<dl>
<dt id="index-_005fGNU_005fSOURCE">巨集： <strong>_GNU_SOURCE</strong></dt>
<dd>
<p>如果定义此宏，则将包括所有内容：ISO C89 <!-- /@w --> ，ISO C99 <!-- /@w --> ，POSIX.1，POSIX.2，BSD，SVID，X / Open，LFS和GNU扩展。在POSIX.1与BSD冲突的情况下，POSIX定义优先。
</p></dd></dl>

<dl>
<dt id="index-_005fDEFAULT_005fSOURCE">巨集： <strong>_DEFAULT_SOURCE</strong></dt>
<dd>
<p>如果定义此宏，则除了X / Open，LFS和GNU扩展之外，大多数功能都包括在内：效果是启用POSIX 2008版中的功能以及某些BSD和SVID功能，而无需单独的功能测试宏来控制他们。
</p>
<p>请注意，编译器选项还会影响所包含的功能：</p>
<ul>
<li>如果使用严格一致性选项，则将禁用编译器语言版本之外的功能，尽管可以使用功能测试宏来启用它们。

</li><li>编译器选项启用的功能不会被功能测试宏覆盖。
</li></ul>
</dd></dl>

<dl>
<dt id="index-_005fATFILE_005fSOURCE">巨集： <strong>_ATFILE_SOURCE</strong></dt>
<dd>
<p>如果定义了此宏，则附加<code>*at</code>包括接口。
</p></dd></dl>

<dl>
<dt id="index-_005fFORTIFY_005fSOURCE">巨集： <strong>_FORTIFY_SOURCE</strong></dt>
<dd>
<p>如果将此宏定义为<em>1</em> ，则将安全性增强添加到各种库函数中。如果定义为<em>2</em> ，则将应用更严格的检查。
</p></dd></dl>

<dl>
<dt id="index-_005fREENTRANT">巨集： <strong>_REENTRANT</strong></dt>
<dt id="index-_005fTHREAD_005fSAFE">巨集： <strong>_THREAD_SAFE</strong></dt>
<dd>
<p>这些宏已过时。它们具有与定义相同的效果<code>_POSIX_C_SOURCE</code>具有价值<code>199506L</code> 。
</p>
<p>一些非常老的C库要求为基本功能定义这些宏之一（例如<code>getchar</code> ）以确保线程安全。
</p></dd></dl>

<p>我们建议您使用<code>_GNU_SOURCE</code>在新程序中。如果您未指定“ <samp>-ansi</samp> 'GCC的选项，或其他符合性选项，例如<samp>-std=c99</samp> ，并且无需明确定义任何这些宏，其效果与定义相同<code>_DEFAULT_SOURCE</code>到1。
</p>
<p>当您定义功能测试宏以请求更大的功能类别时，另外为那些功能的子集定义功能测试宏是无害的。例如，如果您定义<code>_POSIX_C_SOURCE</code> ，然后定义<code>_POSIX_SOURCE</code>也没有任何作用。同样地，如果您定义<code>_GNU_SOURCE</code> ，然后定义<code>_POSIX_SOURCE</code>要么<code>_POSIX_C_SOURCE</code>也没有任何作用。
</p>
<hr>
<div class="header">
<p>上一篇： <a href="Reserved-Names.html#Reserved-Names" rel="prev" accesskey="p">保留名称</a> ，上一篇： <a href="Using-the-Library.html#Using-the-Library" rel="up" accesskey="u">使用库</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>