<html ><!-- This file documents the GNU C Library.

This is
The GNU C Library Reference Manual, for version
2.30.

Copyright (C) 1993-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version
1.3 or any later version published by the Free
Software Foundation; with the Invariant Sections being "Free Software
Needs Free Documentation" and "GNU Lesser General Public License",
the Front-Cover texts being "A GNU Manual", and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to
copy and modify this GNU manual.  Buying copies from the FSF
supports it in developing GNU and promoting software freedom." --><!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>参数宏（GNU C库）</title>

<meta name="description" content="Argument Macros (The GNU C Library)">
<meta name="keywords" content="Argument Macros (The GNU C Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="How-Variadic.html#How-Variadic" rel="up" title="How Variadic">
<link href="Variadic-Example.html#Variadic-Example" rel="next" title="Variadic Example">
<link href="Calling-Variadics.html#Calling-Variadics" rel="prev" title="Calling Variadics">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="zh-Hans" >
<span id="Argument-Macros"></span><div class="header">
<p>上一页： <a href="Calling-Variadics.html#Calling-Variadics" rel="prev" accesskey="p">调用可变参数</a> ，向上： <a href="How-Variadic.html#How-Variadic" rel="up" accesskey="u">可变参数</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>
<hr>
<span id="Argument-Access-Macros"></span><h4 class="subsubsection">A.2.2.5参数访问宏</h4>

<p>以下是用于检索变量参数的宏的描述。这些宏在头文件中定义<samp>stdarg.h</samp> 。
<span id="index-stdarg_002eh-1"></span>
</p>
<dl>
<dt id="index-va_005flist">数据类型： <strong>va_list</strong></dt>
<dd>
<p>类型<code>va_list</code>用于参数指针变量。
</p></dd></dl>

<dl>
<dt id="index-va_005fstart">巨集： <em>void</em> <strong>va_start</strong> <em>（va_list <var>ap</var> ， <var>last-required</var> ）</em></dt>
<dd>
<p>初步： MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>该宏初始化参数指针变量<var>ap</var>指向当前函数的第一个可选参数； <var>last-required</var>必须是该函数的最后一个必需参数。
</p></dd></dl>

<dl>
<dt id="index-va_005farg">巨集： <em><var>type</var></em> <strong>va_arg</strong> <em>（va_list <var>ap</var> ， <var>type</var> ）</em></dt>
<dd>
<p>初步： MT安全竞赛：ap | AS安全AC不安全的腐败|请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>va_arg</code>宏返回下一个可选参数的值，并修改<var>ap</var>指向随后的论点。因此，连续使用<code>va_arg</code>返回连续的可选参数。
</p>
<p>传回值的类型<code>va_arg</code>是<var>type</var>根据通话中的指定。 <var>type</var>必须是自我推广类型（不是<code>char</code>要么<code>short int</code>要么<code>float</code> ）匹配实际参数的类型。
</p></dd></dl>

<dl>
<dt id="index-va_005fend">巨集： <em>无效</em> <strong>va_end</strong> <em>（va_list <var>ap</var> ）</em></dt>
<dd>
<p>初步： MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>这样就结束了<var>ap</var> 。之后<code>va_end</code>打电话，进一步<code>va_arg</code>用相同的电话<var>ap</var>可能不起作用。您应该调用<code>va_end</code>从其中的函数返回之前<code>va_start</code>被相同的调用<var>ap</var>论点。
</p>
<p>在GNU C库中， <code>va_end</code>什么都不做，除了可移植性之外，您不需要使用它。

</p></dd></dl>

<p>有时有必要多次分析参数列表，或者一个人想记住参数列表中的某个位置。为此，必须复制该参数的当前值。但<code>va_list</code>是一种不透明类型，不一定必须分配一个类型变量的值<code>va_list</code>到另一个相同类型的变量。
</p>
<dl>
<dt id="index-va_005fcopy-1">巨集： <em>void</em> <strong>va_copy</strong> <em>（va_list <var>dest</var> ，va_list <var>src</var> ）</em></dt>
<dt id="index-_005f_005fva_005fcopy">巨集： <em>void</em> <strong>__va_copy</strong> <em>（va_list <var>dest</var> ，va_list <var>src</var> ）</em></dt>
<dd>

<p>初步： MT安全| AS安全交流安全请参阅<a href="POSIX-Safety-Concepts.html#POSIX-Safety-Concepts">POSIX安全概念</a> 。
</p>

<p>的<code>va_copy</code>宏允许复制类型的对象<code>va_list</code>即使这不是整数类型。中的参数指针<var>dest</var>初始化为指向与中的指针相同的参数<var>src</var> 。
</p>
<p><code>va_copy</code>已在ISO C99中添加。严格按照ISO C90进行构建时（' <samp>gcc -std=c90</samp> '），则不可用。GCC提供<code>__va_copy</code> ，作为扩展，在任何标准模式下；在GCC 3.0之前，它是此功能的唯一宏。
</p>
<p>这些宏不再由GNU C库提供，而是由编译器提供。
</p></dd></dl>

<p>如果要使用<code>va_copy</code>并且可移植到C99之前的系统中，因此应始终做好准备以防止该宏不可用。希望在简单分配无效的架构上<code>va_copy</code> <em>将</em>可用，因此如果担心C99之前的可移植性，应该总是这样写：</p>
<div class="example">
<pre class="example">{
  va_list ap, save;
  &hellip;
#ifdef va_copy
  va_copy (save, ap);
#else
  save = ap;
#endif
  &hellip;
}
</pre></div>


<hr>
<div class="header">
<p>上一页： <a href="Calling-Variadics.html#Calling-Variadics" rel="prev" accesskey="p">调用可变参数</a> ，向上： <a href="How-Variadic.html#How-Variadic" rel="up" accesskey="u">可变参数</a> [ <a href="index.html#SEC_Contents" title="目录" rel="contents">目录</a> ] [ <a href="Concept-Index.html#Concept-Index" title="指数" rel="index">索引</a> ]</p>
</div>





</body></html>