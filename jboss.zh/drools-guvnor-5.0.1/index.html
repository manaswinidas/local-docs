<html  xmlns="http://www.w3.org/1999/xhtml"><head></head><body >﻿<title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">德鲁斯·古诺（Drools Guvnor）</title><link rel="stylesheet" href="css/jbossorg.css" type="text/css"><meta name="generator" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" content="DocBook XSL-NS Stylesheets V1.74.0"><div class="book" lang="en-US"><div class="titlepage"><div><p id="title"><a href="http://www.jboss.org" class="site_href"><strong>JBoss.org</strong></a> <a href="http://docs.jboss.org/" class="doc_href"><strong>社区文档</strong></a></p></div><hr></div><div class="toc"><dl><dt><span class="chapter"><a href="#d0e9">1。Guvnor（业务规则管理系统）</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e12">1.1。介绍</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e23">1.1.1。什么是BRMS？</a></span></dt><dt><span class="section"><a href="#d0e59">1.1.2。功能概述</a></span></dt></dl></dd><dt><span class="section"><a href="#d0e78">1.2。行政指南</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e85">1.2.1。安装</a></span></dt><dt><span class="section"><a href="#d0e107">1.2.2。数据库配置</a></span></dt><dt><span class="section"><a href="#d0e149">1.2.3。安全性-身份验证和基本访问</a></span></dt><dt><span class="section"><a href="#d0e185">1.2.4。精细的权限和安全性</a></span></dt><dt><span class="section"><a href="#d0e233">1.2.5。数据管理</a></span></dt></dl></dd><dt><span class="section"><a href="#d0e281">1.3。建筑</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e298">1.3.1。从源头建造</a></span></dt><dt><span class="section"><a href="#d0e356">1.3.2。可重复使用的组件</a></span></dt><dt><span class="section"><a href="#d0e383">1.3.3。版本和存储</a></span></dt><dt><span class="section"><a href="#d0e400">1.3.4。贡献</a></span></dt></dl></dd><dt><span class="section"><a href="#d0e405">1.4。快速入门指南</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e408">1.4.1。快速入门指南</a></span></dt><dt><span class="section"><a href="#d0e523">1.4.2。BRMS概念</a></span></dt><dt><span class="section"><a href="#d0e990">1.4.3。创建业务用户视图</a></span></dt><dt><span class="section"><a href="#d0e995">1.4.4。事实模型（对象模型）</a></span></dt><dt><span class="section"><a href="#d0e1035">1.4.5。业务用户角度</a></span></dt><dt><span class="section"><a href="#d0e1048">1.4.6。规则包中的高级配置选项</a></span></dt><dt><span class="section"><a href="#d0e1053">1.4.7。部署：将规则与您的应用程序集成</a></span></dt><dt><span class="section"><a href="#d0e1172">1.4.8。WebDAV和HTTP</a></span></dt><dt><span class="section"><a href="#d0e1193">1.4.9。Eclipse Guvnor集成</a></span></dt></dl></dd></dl></dd><dt><span class="index"><a href="#d0e1484">指数</a></span></dt></dl></div><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e9"></a>第1章。Guvnor（业务规则管理系统）</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#d0e12">1.1。介绍</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e23">1.1.1。什么是BRMS？</a></span></dt><dt><span class="section"><a href="#d0e59">1.1.2。功能概述</a></span></dt></dl></dd><dt><span class="section"><a href="#d0e78">1.2。行政指南</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e85">1.2.1。安装</a></span></dt><dt><span class="section"><a href="#d0e107">1.2.2。数据库配置</a></span></dt><dt><span class="section"><a href="#d0e149">1.2.3。安全性-身份验证和基本访问</a></span></dt><dt><span class="section"><a href="#d0e185">1.2.4。精细的权限和安全性</a></span></dt><dt><span class="section"><a href="#d0e233">1.2.5。数据管理</a></span></dt></dl></dd><dt><span class="section"><a href="#d0e281">1.3。建筑</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e298">1.3.1。从源头建造</a></span></dt><dt><span class="section"><a href="#d0e356">1.3.2。可重复使用的组件</a></span></dt><dt><span class="section"><a href="#d0e383">1.3.3。版本和存储</a></span></dt><dt><span class="section"><a href="#d0e400">1.3.4。贡献</a></span></dt></dl></dd><dt><span class="section"><a href="#d0e405">1.4。快速入门指南</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e408">1.4.1。快速入门指南</a></span></dt><dt><span class="section"><a href="#d0e523">1.4.2。BRMS概念</a></span></dt><dt><span class="section"><a href="#d0e990">1.4.3。创建业务用户视图</a></span></dt><dt><span class="section"><a href="#d0e995">1.4.4。事实模型（对象模型）</a></span></dt><dt><span class="section"><a href="#d0e1035">1.4.5。业务用户角度</a></span></dt><dt><span class="section"><a href="#d0e1048">1.4.6。规则包中的高级配置选项</a></span></dt><dt><span class="section"><a href="#d0e1053">1.4.7。部署：将规则与您的应用程序集成</a></span></dt><dt><span class="section"><a href="#d0e1172">1.4.8。WebDAV和HTTP</a></span></dt><dt><span class="section"><a href="#d0e1193">1.4.9。Eclipse Guvnor集成</a></span></dt></dl></dd></dl></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e12"></a> 1.1。介绍</h2></div></div></div><p>本节介绍BRMS。有关安装，使用和管理，请参阅其他相关部分。</p><div class="figure"><a id="d0e17"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/NewMainScreen.png" align="middle" alt="BRMS主屏幕"></div></div><p class="title"><b>图1.1。BRMS主屏幕</b></p></div><br class="figure-break"><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e23"></a> 1.1.1。什么是BRMS？</h3></div></div></div><p>BRMS代表业务规则管理系统。</p><p>BRMS允许人们在多用户环境中管理规则，这是您的业务规则的单一事实，并通过用户友好的界面以受控方式进行更改。</p><p>Guvnor是与网络和网络相关的组件的名称，用于管理流口水的规则。这与核心Drools引擎和其他工具结合在一起，形成了“ BRMS”。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e32"></a> 1.1.1.1。何时使用Guvnor</h4></div></div></div><p>如果满足以下任一条件，则应考虑使用Guvnor：您需要管理规则的版本/部署，需要让具有不同技能水平的多个用户访问和编辑规则，没有任何现有的基础结构来管理规则，您有很多“业务”规则（与作为应用程序一部分的技术规则相对）。</p><p>Guvnor可以单独使用，也可以与IDE工具一起使用（通常同时使用）。</p><p>Guvnor可以被“打上商标”并成为您的应用程序的一部分，也可以是中央规则存储库。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="d0e41"></a> 1.1.1.1.1。何时不使用Guvnor</h5></div></div></div><p>在某些情况下，可能存在在数据库中具有规则的应用程序（例如，作为现有应用程序的一部分），并且不需要新的应用程序来管理规则。</p><p>在这种情况下，值得一看的是drools-template库-您可以定义用于从任何表格数据源生成的规则的模板。</p><p>否则，也许已经存在一个现有的规则管理系统和用户界面（并且已经针对您的环境进行了调整）-在这种情况下，可能不需要迁移到Guvnor。</p><p>如果您要使用规则来解决复杂的算法问题，那么这些规则本质上是应用程序的组成部分（不需要与代码分开管理）。</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e52"></a> 1.1.1.2。谁使用Guvnor</h4></div></div></div><p>使用BRMS的人员的主要角色是：业务分析师，规则专家，开发人员，管理员（规则管理员等）。</p><p>Guvnor的设计方式是可以容纳这些不同的角色，并且可以控制以安全的方式向不同用户公开多少内容。</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e59"></a> 1.1.2。功能概述</h3></div></div></div><div class="itemizedlist"><ul><li><p>多种类型的规则编辑器（GUI，文本）</p></li><li><p>版本控制（历史资产）</p></li><li><p>分类</p></li><li><p>构建和部署</p></li><li><p>将多个规则“资产”作为一个包存储在一起</p></li></ul></div></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e78"></a> 1.2。行政指南</h2></div></div></div><p>本章介绍BRMS的安装和管理问题。</p><p>BRMS是一个Web应用程序，可以在多种环境中运行，并且可以配置为适合大多数情况。也有一些数据的初始设置，以及导出/导入功能。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e85"></a> 1.2.1。安装</h3></div></div></div><p>对于大多数人来说，安装非常简单。Guvnor应用程序部署为.war文件，如果对默认设置满意，则可以将其部署在应用程序服务器或servlet容器中，而无需进行任何配置。</p><p>下载Guvnor发行版（可从http://www.jboss.org/drools获得）后，您会在zip文件中找到drools-jbrms.war文件。将WAR文件复制到应用程序服务器的部署目录中，然后启动应用程序服务器。如果需要自定义某些设置，则可以首先“分解”（解压缩）war文件，并更改任何配置设置，然后将其压缩或“分解”。（请注意，在JBoss Application Server中，您需要确保展开的文件夹名称以“ .war”结尾）</p><p>将drools-guvnor.war放置在部署目录中，并且启动应用程序服务器后，您应该导航到http：// localhost / drools-jbrms并检查是否显示了Guvnor。（显然，将URL替换为您的应用程序服务器配置的URL）。</p><p>一旦显示出来，就可以部署并准备就绪！</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e96"></a> 1.2.1.1。支持和推荐的平台</h4></div></div></div><p>Guvnor能够在任何支持Java SE5的应用服务器中运行（不需要JEE 5）-其中包括Tomcat容器之类的servlet容器。</p><p>它是在JBoss应用服务器平台上积极测试/开发的，如果您可以使用它们或没有任何现有的基础架构，建议使用它们。但是，可以使用任何容器/应用程序服务器，在某些情况下，只需进行较小的配置调整即可（请向Wiki获取特定提示-社区中的许多人已经能够使其在各种平台上运行）。</p><p>当然，您可以从www.jboss.com为每个操作系统下载这些应用程序服务器。</p><p>部署到JBoss平台：如果要安装新的JBoss平台，则可以将WAR复制到[app服务器目录] / server / default / deploy。然后，通过运行[app服务器目录/ bin]目录中的run.sh或run.bat来启动服务器。</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e107"></a> 1.2.2。数据库配置</h3></div></div></div><p>Guvnor使用JCR标准来存储资产（例如规则）。默认实现是Apache Jackrabbit（http://jackrabbit.apache.org/）。这包括一个开箱即用的存储引擎/数据库，您可以直接使用它，也可以根据需要配置为使用现有的RDBMS。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e112"></a> 1.2.2.1。更改数据存储的位置</h4></div></div></div><p>首次运行Guvnor（启动应用服务器）时，它将在[应用服务器目录] / bin /目录（假设您在JBoss平台上使用过）中创建一个数据库。有一个repository.xml文件和一个自动创建的存储库目录。</p><p>数据存储的位置应为已备份的安全位置。默认位置可能不适合此设置，因此最简单的方法是设置一个更合适的位置。如果要更改此设置，请确保已停止Guvnor（即停止了应用程序服务器或取消部署了该应用程序）。</p><p>要更改位置，请解压缩WAR文件，然后在WEB-INF目录中找到components.xml文件。这是一个JBoss Seam配置文件（Seam是所使用的框架），它允许自定义系统的各个部分。找到components.xml文件后，应该看到类似以下内容的内容：</p><pre class="programlisting">&lt;component name="repositoryConfiguration"&gt;
 &lt;!--
  *** This is for configuring the "home" directory for the repository storage. the directory must exist. ***
     &lt;property name="homeDirectory"&gt;/home/michael/RulesRepository_001&lt;/property&gt;
   --&gt;  

   ...
&lt;/component&gt;
</pre><p>查找名称为“ repositoryConfiguration”的组件以及名称为“ homeDirectory”的属性。</p><p>如果未对此注释（如上面的示例中已被注释掉），则可以设置存储存储库数据所需的任何路径。您也可以使用它来移动存储库。在这种情况下，当您在components.xml中设置位置后，只需将repository.xml和存储库目录移动到您在components.xml中设置的新位置即可。</p><p>如果在指定的位置（或默认位置）没有存储库，那么Guvnor将创建一个新的空存储库。</p><p>在repository.xml中可以配置更多选项，但是在大多数情况下，建议您不要更改默认值。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e131"></a> 1.2.2.2。配置Guvnor以使用外部RDBMS</h4></div></div></div><p>在某些情况下，可能要求您使用外部RDBMS（例如Oracle，MySQL或Microsoft SQL Server）作为数据存储-这是允许的。在这种情况下，最简单的方法是使用默认值（或使用上面指定的合适的主目录）启动Guvnor，以使其生成默认的repository.xml支架。</p><p>找到所生成的repository.xml文件，然后将其打开-将使用注释来注释该文件，其中描述了许多不同的选项。从这里开始，您将需要对Jackrabbit持久性管理器有所了解：http://jackrabbit.apache.org/doc/config.html</p><p>有一些持久性管理器，一些是特定于数据库的（例如Oracle）。有一个SimpleDBPersistenceManager可以与任何支持JDBC的数据库一起使用-您还可以指定数据库类型，因此它使用特定的DDL创建表结构（支持所有主要数据库）。</p><p>如果针对新的（空）RDBMS运行，Guvnor将在第一次启动时创建表-因此，请务必注意，所提供的用户凭据具有创建表的权限（至少在最初运行时是这样）他们可能会被锁定）。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e142"></a> 1.2.2.3。搜索和索引，版本存储</h4></div></div></div><p>Jackrabbit有一个单独的存储区用于版本存储（随着时间的流逝，旧版本的数量会增加，但不应降低主数据存储的性能）。版本存储在repository.xml中也有其自己的持久性管理配置，但是对于大多数目的，您可以使用与主存储相同的数据库（只是使用不同的模式对象前缀-即，在数据库中，所有版本数据都将是前缀为“ version_”，但在同一表空间中）。有关更多详细信息，请参见repository.xml。</p><p>Lucene用于在半结构化数据和版本之间提供索引。通常，最好将这种索引存储在Guvnor本地的文件系统中（按照repository.xml中的默认值）-在大多数情况下，默认值是可以的。</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e149"></a> 1.2.3。安全性-身份验证和基本访问</h3></div></div></div><p>请注意，授予某人访问Guvnor的权限表示信任程度。能够编辑和建立规则为用户提供了强大的功能。因此，您不应向整个组织开放Guvnor，而应向少数组织开放。尽可能使用https（带有TLS / SSL的http）（即使在公司网络内部也是个好主意）。明智地使用此功能-这不是提供对数据库的读/写访问权限的“运行中的”应用程序，但功能更多。试想一下，您是蜘蛛侠-强大的力量带来巨大的责任（对于超人来说当然更是如此）。</p><p>通过使用war文件中的components.xml文件配置安全性。要对此进行自定义，您需要解压缩war文件，并找到WEB-INF目录中的components.xml文件。</p><p>JAAS标准用作基础的身份验证和授权机制，其结果意味着它非常灵活并且能够集成到大多数现有环境中。</p><p>Guvnor开箱即用，显示一个登录屏幕，但是没有强制执行安全凭证-使用了用户名，但未执行密码检查。要强制执行身份验证，您需要将其配置为使用适当的用户目录（您可能已经具有Active Directory或类似目录）。</p><p>在components.xml文件中，应该找到一个安全配置部分，如下所示：</p><pre class="programlisting">&lt;!-- SECURITY CONFIGURATION --&gt;
    
&lt;!-- default (will take any username, useful if you want to keep track of users but not authenticate --&gt;
&lt;security:identity authenticate-method="#{defaultAuthenticator.authenticate}"/&gt;

&lt;!-- NO authentication. This will bypass the login screen when you hit the app. Everyone is "guest" --&gt;
&lt;!-- &lt;security:identity authenticate-method="#{nilAuthenticator.authenticate}"/&gt; --&gt;   </pre><p>从上方可以看到，两个“开箱即用”选项都可以通过-这意味着任何用户都可以进入或跳过，在这种情况下，没有登录屏幕（例如，您可以通过网络服务器）。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e166"></a> 1.2.3.1。使用容器安全性和LDAP</h4></div></div></div><p>每个应用程序服务器都支持可以与您现有的安全基础结构一起使用的高级配置。这里以JBoss AS的情况为例。</p><pre class="programlisting">&lt;security:identity authenticate-method="#{authenticator.authenticate}" 
                      jaas-config-name="other"/&gt;</pre><p>这将使用JBoss AS中的“其他” jaas配置。如果查看[jboss安装目录] / server / default / conf，将看到一个login-config.xml文件。该文件包含各种配置。如果您像上面那样使用“ other”，那么它将在conf目录中的users.properties和Roles.properties中查找要进行身份验证的用户名和密码（这对于固定的少数用户来说是很好的选择）。</p><p>LDAP可能是大型企业最受欢迎的选择，因此以下是与Active Directory配合使用的示例。您可以从http://wiki.jboss.org/wiki/Wiki.jsp?page=LdapLoginModule和http://wiki.jboss.org/wiki/获得有关如何针对所有场景使用LDAP配置JBoss AS的更多信息。 Wiki.jsp？page = LdapExtLoginModule。</p><pre class="programlisting">&lt;application-policy name="brms"&gt;
    &lt;authentication&gt;
        &lt;login-module code="org.jboss.security.auth.spi.LdapExtLoginModule" flag="required" &gt;
            &lt;!--
                Some AD configurations may require searching against
                the Global Catalog on port 3268 instead of the usual
                port 389.  This is most likely when the AD forest
                includes multiple domains.
            --&gt;
            &lt;module-option name="java.naming.provider.url"&gt;ldap://ldap.jboss.org:389&lt;/module-option&gt;
            &lt;module-option name="bindDN"&gt;JBOSS\someadmin&lt;/module-option&gt;
            &lt;module-option name="bindCredential"&gt;password&lt;/module-option&gt;
            &lt;module-option name="baseCtxDN"&gt;cn=Users,dc=jboss,dc=org&lt;/module-option&gt;
            &lt;module-option name="baseFilter"&gt;(sAMAccountName={0})&lt;/module-option&gt;

            &lt;module-option name="rolesCtxDN"&gt;cn=Users,dc=jboss,dc=org&lt;/module-option&gt;
            &lt;module-option name="roleFilter"&gt;(sAMAccountName={0})&lt;/module-option&gt;
            &lt;module-option name="roleAttributeID"&gt;memberOf&lt;/module-option&gt;
            &lt;module-option name="roleAttributeIsDN"&gt;true&lt;/module-option&gt;
            &lt;module-option name="roleNameAttributeID"&gt;cn&lt;/module-option&gt;

            &lt;module-option name="roleRecursion"&gt;-1&lt;/module-option&gt;
            &lt;module-option name="searchScope"&gt;ONELEVEL_SCOPE&lt;/module-option&gt;
        &lt;/login-module&gt;
    &lt;/authentication&gt;
&lt;/application-policy&gt;</pre><p>要使用上述内容，您可以将jaas-config-name =“ brms”放在Guvnor的components.xml中的security：identity标记中。</p><p>对于其他目录服务，可以找到类似的配置示例。</p><p>LDAP不是硬道理，您可以对用户名数据库使用JDBC，也可以编写自己的登录模块以使用可能需要处理的任何种类的奇怪而出色的身份验证和授权系统（极端情况，但有可能）。请参考JBoss AS文档（或现有应用程序服务器的文档）。</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e185"></a> 1.2.4。精细的权限和安全性</h3></div></div></div><p>上一节讨论了为用户建立身份和访问。本节讨论向这些用户授予特定权限（以控制数据的可见性和访问权限）。这可用于对数据进行分区，或控制“非超级用户”的访问，这可以限制他们可能造成的损害。</p><div class="figure"><a id="d0e190"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/AdminPermissions.png" align="middle" alt="管理用户权限"></div></div><p class="title"><b>图1.2。管理用户权限</b></p></div><br class="figure-break"><p>Guvnor Web界面的共同需求是，能够使具有不同技术能力的用户与之交互。另一个需求是能够为人们分配不同的数据集以“拥有”。</p><p>通常，用户身份是在集中目录中管理的-应用程序服务器可以与这些目录（例如，活动目录，LDAP）集成，因此可以对要进行认证的用户进行身份验证，而不必创建另一个重复的身份。还可以（由于使用JAAS）定义哪些用户具有Guvnor的“ admin”角色（请注意，Guvnor的Admin用户不必真正是系统管理员）。除此之外，guvnor还通过数据专用权限扩展了该身份，该权限由Guvnor本身进行管理。</p><div class="figure"><a id="d0e200"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/AdminPermissionsList.png" align="middle" alt="用户列表"></div></div><p class="title"><b>图1.3。用户列表</b></p></div><br class="figure-break"><p>请注意，以上用户身份未存储在Guvnor中，只有他们的权限映射才是针对Guvnor的。</p><p>实际上，有2个系统范围的角色：管理员用户和非管理员用户。简单 ！管理员可以查看和执行任何操作。开箱即用，权限系统关闭，并且每个用户都是管理员（这几乎就是以前的工作方式）。components.xml中还有一个系统设置，可以打开和关闭权限系统（因此，如果需要，人们可以手动覆盖）。管理员还可以向其他用户授予管理员权限，无论他们在外部目录服务中的角色如何。</p><div class="figure"><a id="d0e210"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/AdminPermissionEdit.png" align="middle" alt="编辑中"></div></div><p class="title"><b>图1.4。编辑中</b></p></div><br class="figure-break"><p>权限有几种类型：每个软件包：软件包管理员（“拥有”一个软件包-可以部署等，但对系统没有管理权限）。包开发人员-此权限允许用户创建新项目，编辑等-但仅在包级别（不部署）。他们还可以运行和创建测试。软件包只读-好吧，这很明显。每个类别：这是“有趣的”类别-因为可以用多个类别标记资产（规则），所以您可以使用这些类别将权限分配给“分析师”类型的用户。可以为用户分配多个类别。然后，用户可以编辑和查看在该类别中标记的任何资产（与包装无关）。仅具有类别权限的用户将不会显示任何程序包视图或详细信息，并且只会看到简单的类别视图。这使管理员和经理可以完全控制这些用户可以看到和看不到的内容。请注意，也可以将每个类别的权限设置为“只读”，以便用户可以查看类别中的所有资产，但不能对其进行更改。</p><div class="figure"><a id="d0e218"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/AdminAnalyst.png" align="middle" alt="分析师观点"></div></div><p class="title"><b>图1.5。分析师观点</b></p></div><br class="figure-break"><p>每个类别的“分析师”权限非常有用-您还可以使用特定的程序包来扩展其权限（因此，除了其类别权限之外，他们还可以查看和使用特定的程序包-可以用作“练习”区域，或测试区域）。这提供了几种以粗略或细粒度方式管理权限的方法，以适合不同类型的用户。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e226"></a> 1.2.4.1。启用细粒度授权</h4></div></div></div><p>默认情况下，不启用授权。要启用它，请编辑WEB-INF目录中的components.xml文件：</p><pre class="programlisting">
    &lt;security:role-based-permission-resolver enable-role-based-authorization="true"/&gt;	  
</pre></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e233"></a> 1.2.5。数据管理</h3></div></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e236"></a> 1.2.5.1。后备</h4></div></div></div><p>如何执行备份取决于您使用的持久性管理器方案。使用默认目录-然后就可以备份存储库目录（无论您将其配置为哪个目录）。还原只是在整个存储库目录中复制的问题。</p><p>理想情况下，您可以在完成文件备份时停止Guvnor应用程序，或者确保没有人在使用它。</p><p>在使用外部数据库（例如Oracle，MySQL）的情况下，可以采用通常的方案来备份那些数据库（您要备份它们，对吗？）。在这种情况下，还原时，最好清除索引（删除索引所在的目录），以便从数据中重新创建它们（从而保证同步）。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e245"></a> 1.2.5.2。资产清单定制</h4></div></div></div><p>在Guvnor的一些地方，有一个资产列表：可以通过查找AssetListTable.properties文件来自定义此列表。然后，您可以设置标题名称和用于填充列的“ getter”方法。例如，如果使用它们，则可以添加getCreator或getExternalSource作为额外字段。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e250"></a> 1.2.5.3。定制的包装选择器</h4></div></div></div><p>在构建软件包时（通过“软件包”功能），您可以选择指定“选择器”的名称。该选择器将过滤软件包中内置的规则列表。在选择器文本框中输入的是服务器上配置的选择器名称。</p><p>要配置选择器，您将需要“爆炸” Guvnor的war文件，并找到selectors.properties文件（请注意，如果您愿意，也可以将自己的selectors.properties文件放在系统类路径中）。在此文件中，您将找到有关如何配置自定义选择器的详细信息。选项是使用drl文件或您编写的类的名称（在类路径中可用）。类必须实现AssetSelector接口。也可以使用DRL文件（selectors.properties文件中有一个示例）。您配置的每个选择器在此属性文件中都有一个唯一的名称-这是您在构建软件包时可以使用的名称。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e257"></a> 1.2.5.4。在Guvnor Web GUI中添加自己的徽标或样式</h4></div></div></div><p>为此，您可以“分解”部署war文件，然后找到Guvnor.html文件，该文件的外观如下所示：。</p><pre class="programlisting">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
   &lt;head&gt;
      &lt;!-- Note you can append #asset=UUID to the end of the URL to preload a given asset.
         Also, if you appent #asset=UUID&amp;nochrome it will only show the asset without all the GUI "chrome"

         To select a locale, specify &amp;locale=en_US at the end of the URL to pick the appropriate bundle.
         --&gt;
      &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
      &lt;meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /&gt;
      &lt;title&gt;JBoss Guvnor&lt;/title&gt;

      ..........

   &lt;/body&gt;
&lt;/html&gt;</pre><p>请注意，上面的Guvnor.html文件很小（因为大部分工作是由GWT完成的-GUI是在浏览器中动态构建的）。您可以自定义的部分是样式表-您可以编辑Guvnor.css（或更好的是，复制副本，然后将样式更改为所需的样式），“快捷方式图标”（地址中显示的内容）浏览器等中的-栏，也将“ icon”链接更改为相同，以便它在IE中有效）和标题徽标。其余部分应保留原样，以允许GWT组件加载并附加到页面上。当用户访问Guvnor Web GUI时，该html页面仅由浏览器加载一次。</p><p>最好的自定义方法是复制Guvnor.html-然后进行编辑。您也可以通过常规方法编辑web.xml来更改URL。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e268"></a> 1.2.5.5。进出口</h4></div></div></div><p>Web界面的“管理”部分提供了JCR标准导出/导入功能。</p><p>这会将整个存储库导出为JCR标准定义的XML格式。</p><p>如果是导入，它将清除数据库中的所有现有内容。</p><p>这不能替代备份，但是在迁移时很有用。重要的是要注意，版本历史记录不是以这种方式导出的，只是当前状态。因此，仍然建议始终在存储库数据库本身上使用正式的备份机制。</p><p>请注意，当导入具有成千上万项的存储库时，将需要额外的内存（仅用于导入）。
      </p></div></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e281"></a> 1.3。建筑</h2></div></div></div><p>本节介绍了Guvnor（以前称为业务规则管理系统或BRMS）的技术方面，如果您是BRMS应用程序的集成用户或最终用户，则不必使用它。但是，Drools是开源的，因此构建说明构成了手册的一部分。</p><p>如果您想重用组件或将应用程序嵌入另一个应用程序，则可能需要从源代码构建。</p><div class="figure"><a id="d0e288"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/Architecture.png" align="middle" alt="建筑图"></div></div><p class="title"><b>图1.6。建筑图</b></p></div><br class="figure-break"><p>上图显示了系统的主要组件以及它们如何集成和部署。用户指南提供了有关高度可配置的部件（例如数据库）的更多详细信息。</p><p>BRMS被部署为战争，它通过Web提供用户界面，并通过URL（或文件）提供二进制程序包。它利用JSR-170标准进行数据存储（JCR）。JBoss Seam被用作组件框架，而GWT被用作构建基于ajax的Web用户界面的小部件工具包。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e298"></a> 1.3.1。从源头建造</h3></div></div></div><p>本节将介绍构建各种组件所需的步骤。通常，这是自动化的，但是为全面起见对手动过程进行了描述。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e303"></a> 1.3.1.1。模组</h4></div></div></div><p>有2个模块：drools-repository（后端）和drools-guvnor（前端和规则集成）。drools-guvnor模块依赖于drools-repository模块以及其他组件。Guvnor是所有Drools的主要版本的一部分-在构建Drools时，Guvnor与其并存。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e308"></a> 1.3.1.2。使用Maven 2</h4></div></div></div><p>Maven 2被用作构建系统。首先，需要检出JBoss规则的源代码树的整体。这包括其他模块，以及顶层lib和存储库目录（构建所需的）；因为BRMS构建是主要流口水构建的一部分。</p><p>最初，进入已检出源代码树的jboss-rules的根目录，然后运行mvn install来安装项目间依赖项的所有组件。如果构建被破坏（请小心不要发生这种情况），可以使用-Dmaven.test.skip = true标志来防止失败的单元测试阻止构建。</p><p>希望构建BRMS时，进入drools-jbrms目录并运行<code class="code">mvn package</code> 。这将运行测试，然后建立可部署的战争。唯一不会做的就是重建GWT前端（有关详细信息，请参阅下一节）。一旦war文件位于目标目录中，BRMS就可以使用了。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e320"></a> 1.3.1.3。与GWT合作</h4></div></div></div><p>Web前端的GUI小部件是使用GWT（Google Web工具包）开发的。如果需要更改或构建GUI，则需要单独下载GWT。下载GWT后， <code class="filename">build.properties</code> drools-jbrms目录中的文件指向安装GWT的位置。完成此操作后，可以使用ant任务构建GWT组件，并在需要时以调试/托管模式启动GWT。如果运行构建，它将使用新的<span class="emphasis"><em>编译</em></span>工件更新项目中的webapp目录（GWT在运行时不使用JSP，仅使用html和javascript）。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e331"></a> 1.3.1.4。使用Eclipse进行调试，编辑和运行</h4></div></div></div><p>每个模块都有随时可用的最新Eclipse项目配置，因此它们只能导入到Eclipse工作区中。这些项目是由Maven（ <code class="code">mvn eclipse:eclipse</code>以刷新它们，以防它们错误或过时。它们已被手动修改为具有项目依赖性（这意味着在调试时可以单步执行代码）。</p><p>在eclipse中需要一些环境变量（对于Window：> Preferences-> Java-> Build path-> Classpath变量）：M2_REPO，通常指向Maven下载共享依赖项的位置。GWT_HOME应该指向您安装GWT的位置。 GWT_DEV必须指向与您拥有的GWT版本一起提供的特定于平台的“ dev” jar。</p><p>如何从Eclipse中启动：可以正常启动单元测试（在这种情况下，仅需要M2_REPO设置，不需要单独下载GWT），也可以使用GWT浏览器以<span class="emphasis"><em>托管模式</em></span>启动它。非常适合调试（从GUI到后端，可以单步执行代码，并即时进行更改，只需刷新即可）。有一个<code class="filename">Guvnor.launch</code>文件放在drools-jbrms目录中。要以调试模式启动Guvnor，请打开“运行”对话框（运行->运行），然后从列表中选择<span class="emphasis"><em>JBRMS</em></span> 。启动它会打开一个新窗口，其中BRMS处于调试模式，可以开始使用</p><p>一般</p><p>使用GWT下载和调试BRMS是可选的，因此，如果没有正在处理的GUI问题，则可以安全地跳过此步骤。</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e356"></a> 1.3.2。可重复使用的组件</h3></div></div></div><p>BRMS使用服务接口将GUI与后端功能分开。在这种情况下，后端都包括资产存储库（drools-repository和JCR）以及用于处理规则的编译器详细信息。</p><p>主要接口是RepositoryService，该接口在ServiceImplementation中实现。GWT ajax前端与此接口通信（通过GWT使用的异步回调机制）。接缝配置文件是<code class="filename">components.xml</code> （有关详细信息，请咨询Seam文档和components.xml文件）。</p><p>该服务接口可以由替代组件或前端重复使用。</p><p>GWT用户界面可以重复使用，因为GWT只是一个html页面： <code class="filename">Guvnor.html</code> 。</p><p>通常，Guvnor打算作为自己的战争部署，但是可以与其他应用程序结合使用（需要谨慎），但将其作为单独的战争保存起来会更容易。单独部署Guvnor也将使其更容易升级到新版本（建议使用）。</p><p>的<code class="filename">JBRMS.html</code>文件可以自定义。例如，更改徽标或将BRMS嵌入另一个页面。看看<code class="filename">Guvnor.html</code>文件以获取详细信息。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e383"></a> 1.3.3。版本和存储</h3></div></div></div><p>《用户指南》的“管理”部分详细介绍了数据库和文件系统的配置选项。</p><p>资产的版本与数据一起存储在数据库中。</p><p>创建<span class="emphasis"><em>快照时</em></span> ，会将整个程序包的副本复制到JCR数据库中的单独位置。</p><p>对于那些熟悉jcr和jackrabbit的人，*。cnd文件位于节点类型定义的源代码中，因为有些人希望查看这些文件。简而言之，包是一个<span class="emphasis"><em>文件夹</em></span> ，每个资产是一个文件：资产可以是文本资产，也可以具有二进制附件。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e400"></a> 1.3.4。贡献</h3></div></div></div><p>作为一个开源项目，鼓励更广泛的社区做出贡献。为了做出贡献，请查阅Wiki和项目主页。一种有用的贡献方式是通过在JIRA中记录问题或功能请求。要使用的JIRA链接为：https://jira.jboss.org/jira/browse/GUVNOR</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e405"></a> 1.4。快速入门指南</h2></div></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e408"></a> 1.4.1。快速入门指南</h3></div></div></div><p>如果您正在阅读本文，那么您必须是不耐烦的人，他想踢轮胎（并点燃火）并尽快环顾四周。本节将提供一个快速的从头到尾的浏览步骤（但不会详细介绍这些概念）。这假设您已经正确安装了存储库，并且能够访问主登录屏幕。</p><p>您还可以查阅Wiki：http：//wiki.jboss.org/wiki/Wiki.jsp？page = RulesRepository，以获取一些教程和用户技巧（它是Wiki，因此您甚至可以贡献自己的技巧和示例，甚至如果需要，请上传文件！）。</p><div class="figure"><a id="d0e415"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/Features.png" align="middle" alt="古凡诺的主要特色区域"></div></div><p class="title"><b>图1.7。古凡诺的主要特色区域</b></p></div><br class="figure-break"><p>上图显示了Guvnor的主要特征区域。</p><div class="itemizedlist"><ul><li><p>信息：这是初始屏幕，带有资源链接。</p></li><li><p>规则：这是类别和业务用户角度。</p></li><li><p>软件包：这是配置和管理软件包的地方。</p></li><li><p>部署：这是管理部署快照的位置。</p></li><li><p>管理员：管理功能（类别，状态，导入和导出）</p></li></ul></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e439"></a> 1.4.1.1。支持的浏览器平台</h4></div></div></div><p>安装指南中提到了受支持的服务器端平台。对于浏览器-支持的主要浏览器包括Firefox（1.5和更高版本），IE7和更高版本，Opera，Safari，Google Chrome等。大多数平台的首选浏览器是firefox，它可以广泛使用且免费，如果您有的话Firefox是首选平台，其次是Mac上的safari。IE6用户可能会遇到一些性能不佳的情况，因为这是一种危险的，不安全的IE7浏览器，所以建议使用高级浏览器（例如Google Chrome，Firefox，Safari）。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e444"></a> 1.4.1.2。BRMS还是Guvnor？</h4></div></div></div><p>在Drools的早期版本中，经常使用“ BRMS”来指代Drools管理功能的Web界面。如今，我们使用BRMS来指代“整个程序包”（运行时，Web工具等），但是在某些情况下，您可以将“ BRMS”读为Guvnor Web控制台和相关工具。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e449"></a> 1.4.1.3。初始配置</h4></div></div></div><p>第一次需要一些初始设置。服务器第一次启动时，它将创建一个空的存储库，然后执行以下步骤：</p><div class="itemizedlist"><ul><li><p>部署后，转到“ http：// <your server="">/ drools-guvnor /”（这将显示初始信息屏幕-或取决于配置的登录屏幕）。</your></p></li><li><p>如果它是全新的存储库，则需要转到“管理员”，然后选择“管理类别”</p><p>（添加您选择的一些类别，类别仅用于分类，而不用于执行或其他任何操作。）</p></li><li><p>规则需要一个事实模型（对象模型）才能工作，因此下一步，您将要转到包管理功能。在这里，您可以单击该图标来创建一个新的程序包（给它一个有意义的名称，没有空格）。</p></li><li><p>要上传模型，请使用一个具有事实模型（API）的jar，您将在规则和代码中使用该模型（如果需要，请立即创建一个）。在模型编辑器屏幕中时，可以上载jar文件，从上一步中创建的列表中选择包名称。</p></li><li><p>现在，编辑包配置（刚创建的）以导入刚上传的事实类型（添加导入语句），并保存更改。</p></li><li><p>至此，该软件包已配置好并可以使用了（通常不必经常执行该步骤）。</p><p>（请注意，您还可以导入现有的drl程序包-它将规则存储在资源库中作为单个资产）。</p></li></ul></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e477"></a> 1.4.1.4。编写一些规则</h4></div></div></div><div class="itemizedlist"><ul><li><p>一旦有了至少一个类别和一个程序包设置，就可以编写规则。</p></li><li><p>有多种规则“格式”，但是从BRMS的角度来看，它们都是“资产”。</p></li><li><p>通过单击带有规则徽标的图标（头部）来创建规则，然后从中输入名称。</p></li><li><p>您还必须选择一个类别。类别提供了一种查看规则的方法，该规则与包分开（您可以使规则出现在多个包中）-将其视为标记。</p></li><li><p>选择“业务规则（向导编辑器）”格式。</p></li><li><p>这将打开一个规则建模器，它是一个指导编辑器。您可以基于当前包中使用的模型来添加和编辑条件和动作。另外，该软件包的任何DSL句子模板设置都将可用。</p></li><li><p>完成规则编辑后，您可以签入更改（保存），或者可以验证或“查看源代码”（对于有效源代码）。</p></li><li><p>您还可以从规则编辑器中添加/删除类别，以及其他属性（例如文档）（如果不确定该怎么做，请以自然语言编写描述该规则的文档并进行检入，这也可以用作模板）</p></li></ul></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e505"></a> 1.4.1.5。寻找东西</h4></div></div></div><p>在导航方面，您可以使用“规则”功能（按类别显示事物），也可以使用“打包”功能，然后按打包（和规则类型）查看。如果您知道资产的名称或名称的一部分，也可以使用“快速查找”，开始输入规则名称，键入时它将返回匹配项列表（因此，如果您使用明智的命名方案，这样可以很快找到东西）。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e510"></a> 1.4.1.6。部署方式</h4></div></div></div><div class="itemizedlist"><ul><li><p>编辑包中的某些规则后，可以单击包功能，打开所需的包，然后构建整个包。</p></li><li><p>如果成功，那么您将能够下载二进制程序包文件，该文件可以部署到运行时系统中。</p></li><li><p>您还可以对软件包进行“快照”以进行部署。这会在该时间点冻结程序包，因此任何并发更改都不会影响程序包。它还使该程序包在以下形式的URL上可用：“ http：// <your server="">/drools-guvnor/org.drools.guvnor.Guvnor/packages/ <packagename>/ <snapshotname>”（您可以在其中使用该URL，本节将介绍下载内容）部署）。</snapshotname></packagename></your></p></li></ul></div></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e523"></a> 1.4.2。BRMS概念</h3></div></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e526"></a> 1.4.2.1。规则就是资产</h4></div></div></div><p>由于BRMS可以管理许多不同类型的规则（甚至更多），因此它们都被归为“资产”。资产是可以作为版本存储在资源库中的任何内容。这包括决策表，模型，DSL等。有时，“规则”一词实际上是指“资产”（即您可以做的事情也适用于其他资产类型）。您可以将资产视为文件夹中的文件。资产被分组在一起以供查看或打包以进行部署等。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e531"></a> 1.4.2.2。分类</h4></div></div></div><div class="figure"><a id="d0e534"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/CatZoom.png" align="middle" alt="分类目录"></div></div><p class="title"><b>图1.8。分类目录</b></p></div><br class="figure-break"><p>类别允许使用您定义的任意数量的类别来标记（或标记）规则（资产）。这意味着您可以随后查看与特定类别匹配的规则列表。规则可以属于任意多个类别。在上图中，您可以看到它实际上可以创建类似于资产视图的文件夹/资源管理器。名称可以是您想要的任何名称，并由BRMS管理员定义（您也可以删除/添加新类别-仅当它们当前未使用时才可以删除它们）。</p><p>通常，使用有意义的名称创建类别，这些名称与规则适用的业务领域相匹配（如果规则适用于多个领域，则可以附加多个类别）。类别还可以用于在其生命周期中“标记”规则，例如，将其标记为“草稿”或“供审阅”。</p><div class="figure"><a id="d0e544"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/CatEdit.png" align="middle" alt="资产可以有多个类别"></div></div><p class="title"><b>图1.9。资产可以有多个类别</b></p></div><br class="figure-break"><p>上面的视图显示了打开资产时看到的类别编辑器/查看器。在此示例中，您可以看到资产属于2个类别，并带有“ +”按钮以添加其他项目（使用垃圾桶项目将其删除）。这意味着当使用任一类别显示资产列表时，您将看到该资产。</p><p>在上面的示例中，第一个类别“财务”是“顶级”类别。第二个：“ HR / Awards / QAS”仍然是单个类别，但它是一个嵌套类别：类别是分层的。这意味着存在一个名为“ HR”的类别，其中包含一个类别“ Awards”（当然，实际上会有更多的子类别），而“ Awards”则有一个QAS子类别。屏幕上显示为“ HR / Awards / QAS”-非常类似于硬盘上的文件夹结构（值得注意的例外当然是规则可以出现在多个位置）。</p><p>当您打开资产进行查看或编辑时，该资产将显示其当前所属类别的列表。如果您进行更改（删除或添加类别），则需要保存该资产-这将在版本历史。更改规则的类别对其执行没有影响。</p><div class="figure"><a id="d0e556"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/AdminCats.png" align="middle" alt="创建类别"></div></div><p class="title"><b>图1.10。创建类别</b></p></div><br class="figure-break"><p>上面的视图显示了用于设置类别的管理屏幕（默认情况下，系统中没有类别）。由于类别可以是分层的，因此您选择了要为其创建子类别的“父”类别。也可以从此处删除类别（但前提是当前版本的资产未使用任何类别）。</p><p>通常，资产一次只能属于1个或2个类别。在您拥有大量规则的情况下，类别至关重要。层次结构不必太深，但是应该能够看到它如何帮助您将规则/资产分解为可管理的块。如果一开始不清楚，还可以，您可以随时更改类别。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e566"></a> 1.4.2.3。资产编辑器</h4></div></div></div><div class="figure"><a id="d0e569"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/AssetEditor.png" align="middle" alt="资产编辑器视图"></div></div><p class="title"><b>图1.11。资产编辑器视图</b></p></div><br class="figure-break"><p>上图显示了带有某些注释区域的“资产编辑器”。资产编辑器是所有规则更改的地方。以下是描述编辑器不同部分的列表。</p><div class="itemizedlist"><ul><li><p>一种</p><p>这就是“编辑器小部件”的存放位置-编辑器采用的格式确切取决于资产或规则类型。</p></li><li><p>乙</p><p>这是文档区域-一个自由的文本区域，其中可以包含规则的描述。建议在编辑之前在此处在规则中编写简单的描述。</p></li><li><p>C</p><p>这些是操作-用于保存，归档，更改状态等。归档等同于删除资产。</p></li><li><p>d</p><p>它具有资产名称以及资产所属类别的列表。</p></li><li><p>Ë</p><p>本部分包含只读元数据，包括何时进行更改以及由谁进行更改。</p><p>“修改日期：”-这是最后修改日期。</p><p>“依据：”-谁做了最后更改。</p><p>“注意：”-这是资产上次更新时的注释（即进行更改的原因）</p><p>“版本：”-这是一个数字，每次签入（保存）更改时，数字都会增加1。</p><p>“创建日期：”-创建资产的日期和时间。</p><p>“创建者：”-资产的初始作者。</p><p>“格式：”-资产类型的简称格式名称。</p></li><li><p>F</p><p>这显示了资产所属的包（您也可以从此处更改它）。</p></li><li><p>G</p><p>这是更多（可选）元数据（取自都柏林核心元数据标准）</p></li><li><p>H</p><p>根据要求将显示版本历史记录列表。</p></li></ul></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e632"></a> 1.4.2.4。规则创作</h4></div></div></div><p>BRMS支持资产（规则）格式的（不断增加的）列表。这里描述关键的。其中一些内容在本手册的其他部分中进行了介绍，此处不再赘述。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="d0e637"></a> 1.4.2.4.1。指导编辑的业务规则</h5></div></div></div><p>指导的编辑器样式“业务规则” ：（也称为“ BRL格式”）。这些规则使用引导的GUI，该GUI基于对象模型的知识来控制和提示用户输入。这也可以通过DSL语句来增强。</p><p>重要说明：要使用BRL指导的编辑器，需要有人预先配置您的软件包。</p><p>还要注意，Eclipse插件中有一个向导式编辑器，本节中的大多数详细信息也适用于它。</p><div class="figure"><a id="d0e646"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/GuidedEditor.png" align="middle" alt="指导性BRL编辑器"></div></div><p class="title"><b>图1.12。指导性BRL编辑器</b></p></div><br class="figure-break"><p>上图显示了运行中的编辑器。以下说明适用于上图中的信箱：</p><p>答：规则的不同部分。“时间”部分是条件，“时间”动作和“（选项）”是可影响规则操作的可选属性。</p><p>B：这显示了一种模式，该模式声明该规则正在寻找“驱动程序”事实（字段在下面列出，在本例中为“年龄”）。注意绿色三角形，它将弹出一个要添加到事实声明的选项列表：您可以添加更多字段（例如，它们的“位置”），或者可以为事实分配变量名称（以后可以在以下情况下使用）需要）。除了向此模式添加更多字段外，您还可以添加“多个字段”约束-即跨多个字段的约束（例如，年龄> 42或风险> 2）。弹出对话框显示选项。</p><p>C：小的“-”图标表示您可以删除某些内容-在这种情况下，它将删除整个Driver事实声明。如果它是下面的一个，它将仅删除年龄限制。</p><p>D：“ +”号允许您向规则的条件或操作部分或更多属性添加更多模式。在所有情况下，都会提供一个弹出选项框。对于规则的“时间”部分，您可以选择在事实上添加约束（它将为您提供事实列表），也可以使用其他条件元素，这些选择包括：“没有”-这表示事实+约束一定不存在，“存在”-表示至少存在一个匹配项（但只需要存在一个-不会为每个匹配项触发），“任何一个”-表示存在任何模式都可以匹配的模式（然后将模式添加到这些更高级别的模式）。如果您只是提出一个事实（如上图所示），那么所有模式都将组合在一起，因此它们都是真实的（“和”）。</p><p>E：这显示了“年龄”字段的约束。（从左向右看）绿色三角形可让您将变量名“分配”到“年龄”字段，稍后可在规则中使用。接下来是约束操作列表-该列表根据数据类型而变化。在那之后是值字段-该值字段将是以下值之一：a）文字值（例如数字，文本），b）“公式”-在这种情况下，它是一个已计算的表达式（适用于高级用户） ）或b）变量（在这种情况下，将提供一个列表以从中选择值）。在这之后有一个水平箭头图标，用于“连接约束”：这些约束使您可以使用替代值来检查字段，例如：“年龄小于42或年龄不等于39”可能是这种方式。</p><p>F：这表示规则的“动作”，规则由动作列表组成。在这种情况下，我们要声明/插入一个新事实，这是一个拒绝（将“原因”字段设置为解释）。您可以使用多种其他类型的操作：您可以修改现有事实（告诉引擎事实已经更改）-或者您可以仅在事实上设置字段（在这种情况下，引擎不知道关于更改-通常是因为您要设置结果）。您也可以撤消事实。在大多数情况下，绿色箭头会为您提供可以添加的字段列表，以便您可以更改值。您输入的值是“文字”-在某种意义上，您键入的是值。如果需要进行计算，则在值的开头添加“ =”-这将被解释为“公式”（仅适用于高级用户）！然后将执行计算（与电子表格不同）。</p><p>G：这是规则选项所在的位置。在这种情况下，仅使用显着性，该显着性是表示规则“优先级”的数值。这可能是最常用的选项。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h6 class="title"><a id="d0e668"></a> 1.4.2.4.1.1。用户驱动的下拉列表</h6></div></div></div><div class="figure"><a id="d0e671"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EnumDropDown.png" align="middle" alt="数据枚举显示为下拉列表"></div></div><p class="title"><b>图1.13。数据枚举显示为下拉列表</b></p></div><br class="figure-break"><p>注意，可以将字段值限制为预配置列表中的项目。此列表被配置为包的一部分（使用数据枚举为下拉列表提供值）。这些值可以是固定列表，也可以是（例如）从数据库加载的值。这对于代码以及具有设置值的其他字段很有用。还可以在屏幕上的下拉菜单中显示与规则中使用的值（或代码）不同的内容。请参阅有关数据枚举的部分以了解如何配置它们。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h6 class="title"><a id="d0e679"></a> 1.4.2.4.1.2。DSL句子增强</h6></div></div></div><p>如果规则所在的程序包具有dsl配置，则当您添加条件或操作时，它将提供“ DSL语句”列表，您可以从中选择-当您选择一个包时，它将在该列表中添加一行规则-DSL指定值来自用户时，将显示一个编辑框（文本）（因此最终看起来有点像表单）。这是可选的，并且还有另一个DSL编辑器。请注意，此编辑器中的DSL功能比全套DSL功能略少（基本上，您只能执行DSL的[when]和[then]部分，这与实际的Drool 3没有区别）。</p><p>下图显示了指导编辑器中正在运行的DSL句子：</p><div class="figure"><a id="d0e686"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/GuidedDSL.png" align="middle" alt="DSL在向导式编辑器中"></div></div><p class="title"><b>图1.14。DSL在向导式编辑器中</b></p></div><br class="figure-break"></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h6 class="title"><a id="d0e692"></a> 1.4.2.4.1.3。一个更复杂的示例：</h6></div></div></div><div class="figure"><a id="d0e695"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/GuidedComplex.png" align="middle" alt="一个更复杂的BRL示例"></div></div><p class="title"><b>图1.15。一个更复杂的BRL示例</b></p></div><br class="figure-break"><p>在上面的示例中，您可以看到它使用了文字值和公式的混合。关于“人”事实的第二个约束条件是公式（在这种情况下，它对人的年龄进行了愚蠢的计算，并对照其姓名进行检查-“年龄”和“姓名”都是“人”事实中的字段这个案例。在第三行（表示“年龄小于..”）中，它也使用了公式，尽管在这种情况下，公式会进行计算并返回一个值（用于比较）-在前一种情况下，则必须返回True或False（在这种情况下，其值为一个值）。显而易见的公式基本上是代码的一部分，因此仅适用于有经验的用户。</p><p>查看“ Board”模式（带有水平灰色条的第二个模式）：这使用顶级条件元素（“ There's no”）-这意味着该模式实际上是在寻找事实的“不存在”匹配模式。注意“ Any of：”-这意味着“ type”字段约束匹配，或者“ name”字段匹配（在上述情况下为“ myname”）。这就是所谓的“多字段约束”（您可以嵌套它们，并使其复杂程度取决于您希望下一个人讨厌您的程度）：一些措辞建议：以如下方式编写规则：必须阅读/维护它们的人是精神病患者，拥有枪支，并且知道您的住所）。</p><div class="figure"><a id="d0e705"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/GuidedLHSConstraints.png" align="middle" alt="增加约束"></div></div><p class="title"><b>图1.16。增加约束</b></p></div><br class="figure-break"><p>上面的对话框是您要向Person事实添加约束时将看到的对话框。上半部分是简单的选项：您可以立即添加一个字段（将显示Person事实的字段列表），也可以添加给定类型的“多字段约束”（描述如下）以上）。Advanced选项：您可以添加一个公式（解析为True或False-类似于上面的示例：“ age <（age * 2）....”）。您还可以为“个人”事实分配一个变量名称（这意味着您随后可以在规则的操作部分访问该变量，以设置值等）。</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="d0e713"></a> 1.4.2.4.2。DSL规则</h5></div></div></div><p>DSL规则是文本规则，使用语言配置资产来控制它们的显示方式。</p><div class="figure"><a id="d0e718"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/DSLRule.png" align="middle" alt="DSL规则"></div></div><p class="title"><b>图1.17。DSL规则</b></p></div><br class="figure-break"><p>DSL规则是单个规则。参考上图，您可以使用文本编辑器。您可以使用右侧的图标来提供条件和操作的列表，以供选择（或者同时按Control + Space来弹出列表）。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="d0e726"></a> 1.4.2.4.3。电子表格决策表</h5></div></div></div><p>多个规则可以存储在电子表格中（每行是一个规则）。电子表格的详细信息不在本章中介绍（因为有单独的章节）。</p><div class="figure"><a id="d0e731"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/DecisionTable.png" align="middle" alt="电子表格决策表"></div></div><p class="title"><b>图1.18。电子表格决策表</b></p></div><br class="figure-break"><p>要使用电子表格，请上传xls（并可以根据上面的图片下载当前版本）。要创建新的决策表，请在启动规则向导时选择创建一个决策表（此后，您可以上载xls文件）。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="d0e739"></a> 1.4.2.4.4。指导决策表（基于Web）</h5></div></div></div><p>指导性决策表功能允许决策表在Web上进行适当编辑。通过内省哪些事实和字段可用来指导决策表的创建，此工作类似于向导编辑器。</p><div class="figure"><a id="d0e744"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/WebDT.png" align="middle" alt="决策表"></div></div><p class="title"><b>图1.19。决策表</b></p></div><br class="figure-break"><p>右上角有一个按钮，显示指导决策表的配置区域：</p><div class="figure"><a id="d0e752"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/WebDT-config.png" align="middle" alt="决策表配置"></div></div><p class="title"><b>图1.20。决策表配置</b></p></div><br class="figure-break"><p>在此部分中配置了条件和操作列。 “属性列”用于按规则（行）设置属性，例如显着性。与其他所有规则资产一样，基于Web的决策表被编译为DRL。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="d0e760"></a> 1.4.2.4.5。规则流</h5></div></div></div><p>规则流：规则流使您可以直观地描述所采取的步骤-因此，并非所有规则都可以立即进行评估，而是有逻辑流。有关BRMS的本章未涉及规则流，但是您可以使用IDE以图形方式绘制规则流，然后将.rfm文件上载到BRMS。</p><p>与电子表格类似，您可以上载/下载规则流文件（eclipse IDE具有用于它们的图形编辑器）。此处不讨论规则流的详细信息。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="d0e767"></a> 1.4.2.4.6。技术规则（DRL）</h5></div></div></div><p>技术（drl）规则存储为文本-可以在BRMS中进行管理。 DRL可以是整条规则，也可以是一条规则。如果它是一个单独的规则，则不需要package语句或导入（实际上，您可以完全跳过“ rule”语句，仅使用“ when”和“ then”分别标记条件和操作部分）。通常，您将使用IDE编辑原始DRL文件，因为它具有所有高级工具以及内容帮助和调试功能。但是，有时规则可能必须处理Guvnor软件包中相当技术性的内容。在任何典型的规则包中，通常都需要一些“技术规则”-当然，您可以混合并匹配所有规则类型。</p><div class="figure"><a id="d0e772"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/DRLRule.png" align="middle" alt="DRL技术规则"></div></div><p class="title"><b>图1.21。DRL技术规则</b></p></div><br class="figure-break"></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="d0e778"></a> 1.4.2.4.7。功能</h5></div></div></div><p>函数是另一种资产类型。它们不是规则，仅应在必要时使用。函数编辑器是文本编辑器。功能</p><div class="figure"><a id="d0e783"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/Function.png" align="middle" alt="功能"></div></div><p class="title"><b>图1.22。功能</b></p></div><br class="figure-break"></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="d0e789"></a> 1.4.2.4.8。数据枚举（下拉列表配置）</h5></div></div></div><p>数据枚举是技术人员可以配置的可选资产类型，以为向导式编辑器提供下拉列表。它们像其他资产一样被存储和编辑，并应用于它们所属的程序包。</p><p>枚举配置的内容是Fact.field到下拉列表中要使用的值列表的映射。该列表可以是文字的，也可以使用实用程序类（放在类路径中）来加载字符串列表。字符串可以是要显示在下拉列表中的值，也可以是代码值（规则中最终使用的值）与显示值（请参见下面的示例，使用“ =”）之间的映射。</p><div class="figure"><a id="d0e796"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EnumConfig.png" align="middle" alt="数据枚举"></div></div><p class="title"><b>图1.23。数据枚举</b></p></div><br class="figure-break"><p>在上图中-“ MM”表示将在规则中使用的值，而“ Mini Mal”将在GUI中显示。</p><p>从外部数据源获取数据列表：可以让BRMS调用一段代码，该代码将加载字符串列表。为此，您将需要一些返回java.util的代码。列表（字符串）位于BRMS的类路径上。该代码可以返回字符串列表（而不是在BRMS本身中指定值列表）（如果您希望像平常一样使用与规则值不同的显示值，则可以在字符串内部使用“ =”）。例如，在上面的“ Person.age”行中，您可以将其更改为：</p><pre class="programlisting"> 'Person.age' : (new com.yourco.DataHelper()).getListOfAges()</pre><p>假设您有一个名为“ DataHelper”的类，该类具有一个方法“ getListOfAges（）”，该方法返回一个字符串列表（位于类路径上）。您当然可以将这些“动态”枚举与固定列表混合使用。例如，您可以使用JDBC从数据库中加载。第一次在会话中使用引导式编辑器时，将加载数据枚举。如果您打开了任何指导的编辑器会话，则需要关闭然后打开规则以查看更改。要检查枚举是否已加载-如果转到“程序包配置”屏幕，则可以“保存并验证”程序包-这将对其进行检查并提供任何错误反馈。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="d0e809"></a> 1.4.2.4.9。高级枚举概念</h5></div></div></div><p>您还可以使用数据枚举进行其他一些高级操作。</p><p>取决于字段值的下拉列表：让我们想象一个简单的事实模型，我们有一个名为Vehicle的类，它具有2个字段：“ engineType”和“ fuelType”。我们希望选择“汽油”或“柴油”的“引擎类型”。现在，显然，燃料的选择类型必须取决于发动机类型（因此，对于汽油，我们有ULP和PULP，对于柴油我们有BIO和NORMAL）。我们可以通过枚举来表示这种依赖性：</p><pre class="programlisting">
 'Vehicle.engineType' : ['Petrol', 'Diesel']
 'Vehicle.fuelType[engineType=Petrol]' : ['ULP', 'PULP' ]
 'Vehicle.fuelType[engineType=Diesel]' : ['BIO', 'NORMAL' ]  
</pre><p>这显示了如何根据其他字段值进行选择。请注意，一旦选择engineType，就会确定fuelType的选择列表。</p><p>以编程方式加载枚举：在某些情况下，人们可能希望完全从外部数据源（例如关系数据库）加载枚举数据。为此，您可以实现一个返回Map的类。映射的键是一个字符串（如上所示是Fact.field名称），值是一个java.util。字符串列表。</p><pre class="programlisting">
public class SampleDataSource2 {

  public Map&lt;String&gt;, List&lt;String&gt;&gt; loadData() {
    Map data = new HashMap();

    List d = new ArrayList();
    d.add("value1");
    d.add("value2");
    data.put("Fact.field", d);

    return data;
 }

}
</pre><p>在brms的枚举中，您输入：</p><pre class="programlisting">=(new SampleDataSource2()).loadData()
</pre><p>“ =”告诉它通过执行代码来加载数据。</p><p>模式高级枚举：在上述情况下，列表中的值是预先计算的。对于相对静态的数据或少量数据，这很好。想象一下这样一个场景：您有一个国家/地区列表，每个国家/地区都有一个州列表，每个州都有一个地区列表，每个地区都有一个街道列表，依此类推...您会看到这是很多数据，并且无法加载。应根据选择的国家/地区加载列表。</p><p>可以通过以下方式解决以上问题：</p><pre class="programlisting">
      'Fact.field[dependentField1, dependentField2]' : '(new com.yourco.DataHelper()).getListOfAges("@{dependentField1}", "@{dependentField2}")'
    </pre><p>与上述类似，但请注意，我们刚刚指定了需要哪些字段，并且在“：”的右侧也有表达式引号。然后，仅当需要时，才使用指定字段中的值替换该表达式。这意味着您可以使用GUI中的字段值来驱动数据库查询，并向下钻取数据等。加载下拉列表或加载规则时，它将基于字段刷新列表。 “ depenentField1”和“ dependentField2”是“事实”类型的字段名称-这些字段用于计算值列表，如果“字段”的值显示在下拉列表中。</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e837"></a> 1.4.2.5。资产/规则模板</h4></div></div></div><p>提示：由于您可能有许多相似的规则，因此可以创建规则模板，这些规则只是保存在非活动包中的规则-然后可以对模板进行相应的分类，并根据需要复制它们（选择活动包作为目标包） 。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e842"></a> 1.4.2.6。状态管理</h4></div></div></div><p>Guvnor中的每个资产（以及包装）都设置了状态标志。状态标志的值在BRMS的“管理”部分中设置。 （您可以添加自己的状态名称）。与类别类似，状态不会以任何方式影响执行，而只是提供信息。与类别不同，资产一次仅具有一种状态。</p><p>使用状态是完全可选的。您可以使用它来管理资产的生命周期（可以根据需要选择类别）。</p><div class="figure"><a id="d0e849"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/AssetChangeStatus.png" align="middle" alt="资产状况"></div></div><p class="title"><b>图1.24。资产状况</b></p></div><br class="figure-break"><p>您可以更改单个资产的状态（如上图所示）。其更改立即生效，无需单独保存。</p><div class="figure"><a id="d0e857"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/PackageChangeStatus.png" align="middle" alt="资产状况"></div></div><p class="title"><b>图1.25。资产状况</b></p></div><br class="figure-break"><p>您可以更改整个程序包的状态-这会在程序包本身上设置状态标志，但也可以一键更改所有属于该程序包的资产的状态（与您将程序包设置为相同） ）。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e865"></a> 1.4.2.7。包装管理</h4></div></div></div><p>配置软件包通常是一次完成的工作，并且只有具有一定规则/模型经验的人才能完成。一般而言，很少有人需要配置软件包，并且一旦安装，便可以根据需要一遍又一遍地复制它们。软件包配置绝对是一项需要适当专业知识的技术任务。</p><p>所有资产都位于BRMS的“程序包”中-程序包就像一个文件夹（它也用作“命名空间”）。用于存放规则资产的主文件夹。规则尤其需要知道事实模型是什么，名称空间是什么等。</p><div class="figure"><a id="d0e873"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/PackageExplorer.png" align="middle" alt="包浏览器"></div></div><p class="title"><b>图1.26。包浏览器</b></p></div><p><br class="figure-break">上图显示了软件包浏览器。单击资产类型将显示匹配项列表（对于具有数千个规则的软件包，显示该列表可能需要几秒钟的时间，因此使用类别来帮助您找到解决方法的重要性）。</p><p>因此，虽然规则（和一般而言的资产）可以出现在许多类别中，但它们仅存在于一个包中。如果您将BRMS视为文件系统，则每个包都是一个文件夹，资产位于该文件夹中-作为文件的一大堆清单。创建程序包的部署快照时，实际上是将该“文件夹”中的所有资产复制到另一个特殊的“文件夹”中。</p><p>程序包管理功能使您可以查看程序包列表，然后“展开”它们，以显示每种“类型”资产的列表（有很多资产，因此其中一些分组在一起）：</p><p>资产类型：</p><div class="itemizedlist"><ul><li><p>业务资产：显示所有“业务规则”类型的列表，包括决策表，业务规则等。</p></li><li><p>技术资产：这是将被视为技术性项目的列表（例如DRL规则，数据枚举和规则流）。</p></li><li><p>功能：在BRMS中，您还可以定义功能（当然是可选的）。</p></li><li><p>DSL：领域特定语言也可以存储为资产。如果它们存在（通常只有一个），则将在适当的编辑器GUI中使用它们。</p></li><li><p>模型：程序包至少需要一个模型-用于规则。</p></li></ul></div><div class="figure"><a id="d0e903"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/PackageNewItemTooltip.png" align="middle" alt="创建新资产"></div></div><p class="title"><b>图1.27。创建新资产</b></p></div><p><br class="figure-break">在包浏览器中，您可以创建新规则或新资产。您只能从包资源管理器中创建一些资产。上图显示了为此目的启动向导的图标。如果将鼠标悬停在它们上方，则工具提示将告诉您它们的作用。</p><div class="figure"><a id="d0e911"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/PackageConfig.png" align="middle" alt="套餐配置"></div></div><p class="title"><b>图1.28。套餐配置</b></p></div><p><br class="figure-break">您需要做的最关键的事情之一就是配置程序包。这主要是导入规则使用的类以及全局变量。进行更改后，需要将其保存，然后对该程序包进行配置并准备好进行构建。例如，您可以添加一个模型，该模型具有一个名为“ com.something”的类。您好”，然后添加“ import com.something”。您好”，然后保存更改。</p><div class="figure"><a id="d0e919"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/PackageBuild.png" align="middle" alt="包装制作"></div></div><p class="title"><b>图1.29。包装制作</b></p></div><p><br class="figure-break">最后，您将“构建”一个程序包。此时将显示捕获到的所有错误。如果构建成功，则可以选择创建快照以进行部署。您还可以查看此程序包导致的“ drl”。警告：在大量规则的情况下，所有这些操作可能需要一些时间。</p><p>在此阶段可以选择输入“选择器”的名称-有关如何为系统配置自定义选择器的详细信息，请参阅管理部分（如果需要，请使用-选择器可过滤掉构建到程序包中的内容-如果您不知道它们的用途，则可能不需要使用它们）。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="d0e928"></a> 1.4.2.7.1。导入Drl包</h5></div></div></div><p>也可以通过导入现有的“ drl”文件来创建程序包。选择创建新程序包时，可以选择上载.drl文件的选项。然后，BRMS将尝试了解该drl，然后为您创建一个包。其中的规则将作为单个资产存储（但仍作为drl文本内容存储）。请注意，要真正构建该软件包，您将需要单独上传一个适当的模型（以jar形式）以进行验证。</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e933"></a> 1.4.2.8。版本管理</h4></div></div></div><p>BRMS中的资产和整个资产包都“版本化”，但是机制略有不同。单个资产的保存有点像源控制系统中文件的版本。但是，通过拍摄快照（通常用于部署）来“按需”对资产包进行版本控制。下一节将讨论部署管理和快照。</p><div class="figure"><a id="d0e938"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/AssetVersionHistory.png" align="middle" alt="资产版本"></div></div><p class="title"><b>图1.30。资产版本</b></p></div><br class="figure-break"><p>每次更改资产时，资产都会在版本历史记录中创建一个新项目。这有点像无限制的撤消。您可以像上面的列表一样回顾单个资产的历史，并从该时间点查看（并还原）它。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e946"></a> 1.4.2.9。部署管理</h4></div></div></div><p>快照，URLS和二进制软件包：</p><p>URL是如何提供内置软件包的中心。BRMS通过URL提供软件包（供知识代理下载和使用）。这些URL的形式为：http：// <server>/drools-guvnor/org.drools.guvnor.Guvnor/package/ <packagename>/<packageversion></packageversion></packagename></server></p><p><packagename>是您给包裹的名称。
      <packageversion>是快照的名称，也可以是“ LATEST”（如果是LATEST，则为“最新”，它将是主软件包中的最新构建版本，而不是快照）。您可以在代理中使用它们，也可以将它们粘贴到浏览器中，它将以文件形式下载。</packageversion></packagename></p><p>有关如何在应用程序中使用这些URL（和二进制下载）以及如何实时更新规则的详细信息，请参阅知识代理部分。</p><div class="figure"><a id="d0e957"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/Snapshots.png" align="middle" alt="部署快照"></div></div><p class="title"><b>图1.31。部署快照</b></p></div><br class="figure-break"><p>上面显示了部署快照视图。左侧是软件包列表。单击特定的程序包将为您显示该程序包的快照列表（如果有）。您可以从那里复制，删除或查看资产快照。每个快照均可通过URL下载或访问以进行部署。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e965"></a> 1.4.2.10。导航和查找规则</h4></div></div></div><p>查看存储库的两种主要方法是使用上面概述的用户驱动的分类（标记）和程序包浏览器视图。</p><p>类别视图提供了一种以对组织有意义的方式浏览规则的方法。</p><div class="figure"><a id="d0e972"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/CategoryExplorer.png" align="middle" alt="分类视图"></div></div><p class="title"><b>图1.32。分类视图</b></p></div><br class="figure-break"><p>上图显示了正在使用的类别。通常，如果可能的话，在每个类别下，您应该没有多少条规则。</p><p>另一种更具技术性的观点是使用包资源管理器。这将显示规则（资产）更接近它们在数据库中的实际存储方式，还将规则分为包（名称空间）及其类型（格式，因为规则可以采用许多不同的格式）。</p><div class="figure"><a id="d0e982"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/PackageExplorer.png" align="middle" alt="包视图"></div></div><p class="title"><b>图1.33。包视图</b></p></div><br class="figure-break"><p>上面显示了探索的另一种方法-使用软件包。</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e990"></a> 1.4.3。创建业务用户视图</h3></div></div></div><p>在大多数情况下，并非所有用户都希望看到此处描述的所有功能。您可以拥有一部分用户，而这些用户只希望他们查看或编辑某些规则集，而不会被其他所有内容弄糊涂。在这种情况下，您可以使用细粒度的授权（有关如何初始化此授权的信息，请参阅管理指南）。通过基于每个类别设置权限，仅具有类别权限的用户将看到功能的有限子集，并且只会看到带有这些类别标记的项目。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e995"></a> 1.4.4。事实模型（对象模型）</h3></div></div></div><p>对于任何基于规则的应用程序，都需要一个事实模型来驱动规则。事实模型通常与应用程序领域模型重叠，但通常会将其与应用程序模型分离（因为随着时间的推移，它使规则更易于管理）。</p><p>有两种方法可以执行此操作：您可以上传jar文件，其中包含应用程序和规则都使用的类，或者可以使用与规则一起声明的模型。</p><div class="figure"><a id="d0e1002"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/ModelChooseType.png" align="middle" alt="选择模型类型"></div></div><p class="title"><b>图1.34。选择模型类型</b></p></div><br class="figure-break"><p>上载jar时，它将在包配置中添加导入语句（您可以查看并更改它们）。</p><p>使用声明的模型，您将看到如下编辑器：</p><div class="figure"><a id="d0e1012"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/ModelEdit.png" align="middle" alt="选择模型类型"></div></div><p class="title"><b>图1.35。选择模型类型</b></p></div><br class="figure-break"><p>在这里，您可以定义类型，并添加字段（每个字段都有一个类型）。字段的类型由列表建议（但此列表并不详尽）：</p><div class="figure"><a id="d0e1020"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/ModelChooseFieldType.png" align="middle" alt="选择模型类型"></div></div><p class="title"><b>图1.36。选择模型类型</b></p></div><br class="figure-break"><p>这些事实模型可以像普通事实对象一样使用，但是创建它们的方式不同（因为它们不在应用程序的类路径中）。要创建这些对象，可以从RuleBase实例中使用它们。</p><pre class="programlisting">
          // Retrieve the generated fact type
        FactType cheeseFact = ruleBase.getFactType( "org.drools.generatedbeans.Cheese" );

        // Create a new Fact instance
        Object cheese = cheeseFact.newInstance();

        cheeseFact.set( cheese,
                        "type",
                        "stilton" );

</pre><p>然后可以像普通基于pojo的事实一样，将上面的“奶酪”对象插入工作存储器。</p><p>请注意，已声明类型的名称空间是声明它的包名称空间（在上述情况下为“ org.drools.generationbeans”）。</p><p>为什么要在jar文件上选择声明的类型：通常，这会强化以下事实，即模型“属于”规则库（而不是应用程序）属于规则库，并允许模型的生命周期与应用程序分开。它还消除了在规则和使用规则的应用程序之间保持jar文件同步的麻烦。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1035"></a> 1.4.5。业务用户角度</h3></div></div></div><p>从本手册中可以看到，使用Guvnor需要一些专业知识和实践。实际上，从某种意义上讲，任何软件系统都要求人们具有“技术性”，即使它具有漂亮的GUI也是如此。话虽如此，在正确的手腕上，可以设置Guvnor以为非技术用户提供合适的环境。</p><p>为此使用的最合适的规则格式是使用向导编辑器，决策表和DSL规则。您还可以在向导式编辑器中使用一些DSL表达式（因此它为人们提供了输入值的“表单”）。</p><p>您可以使用类别将规则和资产与非技术用户隔离。只有分配了类别的资产才会显示在“类别”视图中。</p><p>Guvnor的初始设置将需要由开发人员/技术人员来完成，他们将为所有规则奠定基础。他们还可以创建“模板”，它们是可以复制的规则（它们通常位于“虚拟”程序包中，并且具有“模板”的类别-这也可以帮助简化方法）。</p><p>非技术用户也不应进行部署（如前所述，这是“打包”功能引起的）。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1048"></a> 1.4.6。规则包中的高级配置选项</h3></div></div></div><p>由于drools支持软件包的各种配置选项（例如，添加“累加”功能等），因此可以通过在软件包中添加X.package或X.conf文件来完成，这些文件在“属性”样式。然后，这些将自动添加到软件包配置中。请参阅主要的Drools文档以了解您可以做的所有事情。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1053"></a> 1.4.7。部署：将规则与您的应用程序集成</h3></div></div></div><p>管理规则非常有趣，但是如何在应用程序中使用或“使用”规则？本部分介绍了KnowledgeAgent部署组件的用法，该组件可自动为您实现大部分自动化。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1058"></a> 1.4.7.1。知识代理</h4></div></div></div><p>知识代理是嵌入在Drools API中的组件。要使用它，您不需要任何额外的组件。实际上，如果您使用的是Guvnor，则您的应用程序只需要在其类路径中包含drools-api和drools-core依赖项（仅适用于drools和mvel jars），而无需其他特定于规则的依赖项。</p><p>请注意，还有一个drools-ant ant任务，因此您可以将规则作为ant脚本的一部分构建规则（例如，在IDE中编辑规则的情况下），而无需使用Guvnor-drools-ant任务将生成.pkg文件与Guvnor相同。</p><p>一旦在Guvnor中的软件包中（或通过ant任务）“构建”了规则，就可以在目标应用程序中使用代理了。</p><p>以下示例构造了一个代理，该代理将从路径String中指定的文件构建新的KnowledgeBase。它将每60秒轮询一次这些文件，这是默认设置，以查看它们是否已更新。如果找到新文件，它将构建一个新的知识库。如果更改集指定的资源是目录，则其内容也会被扫描以查找更改。</p><pre class="programlisting">
 KnowledgeAgent kagent = KnowledgeAgentFactory.newKnowledgeAgent( "MyAgent" );
 kagent.applyChangeSet( ResourceFactory.newUrlResource( url ) );
 KnowledgeBase kbase = kagent.getKnowledgeBase();
</pre><p>KnowledgeAgent可以接受允许更改某些默认设置的配置。一个示例属性是“ drools.agent.scanDirectories”，默认情况下会扫描所有指定目录以查找新添加的目录，可以禁用此目录。</p><pre class="programlisting">KnowledgeBase kbase = KnowledgeBaseFactory.newKnowledgeBase();

 KnowledgeAgentConfiguration kaconf = KnowledgeAgentFactory.newKnowledgeAgentConfiguration();
 kaconf.setProperty( "drools.agent.scanDirectories",
                     "false" ); // we do not want to scan directories, just files
       
 KnowledgeAgent kagent = KnowledgeAgentFactory.newKnowledgeAgent( "test agent", // the name of the agent
                                                                  kaconf );
 kagent.applyChangeSet( ResourceFactory.newUrlResource( url ) ); // resource to the change-set xml for the resources to add</pre><p>change-set.xml的示例。</p><pre class="programlisting">&lt;change-set xmlns='http://drools.org/drools-5.0/change-set'";
        xmlns:xs='http://www.w3.org/2001/XMLSchema-instance'
        xs:schemaLocation='http://drools.org/drools-5.0/change-set drools-change-set-5.0.xsd' &gt;
        &lt;add&gt; 
          &lt;resource source='http://localhost:9000/TEST.pkg' type='PKG' /&gt;
        &lt;/add&gt; 
&lt;/change-set&gt;</pre><p>默认情况下，资源扫描未打开，它是一项服务，必须启动，对于通知也是如此。这可以通过ResourceFactory完成。</p><pre class="programlisting">ResourceFactory.getResourceChangeNotifierService().start();
ResourceFactory.getResourceChangeScannerService().start();</pre><p>以下显示了Guvnor的部署屏幕，其中提供URL和软件包下载。</p><div class="figure"><a id="d0e1085"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/SnapshotDeploy.png" align="middle" alt="快照部署"></div></div><p class="title"><b>图1.37。快照部署</b></p></div><br class="figure-break"><p>您可以看到“软件包URI”-这是您将复制并粘贴到change-set.xml文件中以指定您想要此软件包的URL。它指定了确切的版本（在这种情况下为快照）-每个快照都有其自己的URL。如果要使用“最新”，则将“ NewSnapshot”替换为“ LATEST”。</p><p>您也可以从此处下载.pkg文件，您可以将其放置在目录中，并根据需要使用KnowledgeAgent的“文件”或“目录”功能（在某些情况下，人们不希望运行时自动与Guvnor联系以获取更新-但这通常是许多人最简单的方法）。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1095"></a> 1.4.7.2。Drools执行服务器</h4></div></div></div><p>重要说明：此处描述的确切消息格式可能会稍微改变后流口水5（因为添加了对流程和有状态会话的支持）。出于兼容性考虑，将保留以下内容，但可能不赞成使用以下内容，以支持管道中更灵活的格式。
      </p><p>Drools执行服务器（drools-server）模块是一场战争，您可以部署它来远程执行任何类型的客户端应用程序的知识库（rulebase）。这不限于JVM应用程序客户端，而是可以使用HTTP以及XML或JSON的任何技术。当前，该执行服务器用于无状态会话（这也使得扩展很容易）。</p><p>提供了一种“轻松”的界面风格，其中的URL定义了正在访问的知识库。然后，客户端应用程序通过HTTP（S）远程执行知识库。规则执行服务器使用上面各节中描述的知识代理。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="d0e1104"></a> 1.4.7.2.1。配置和部署</h5></div></div></div><p>drools-server是一个war文件，可以将其部署在应用程序服务器（例如JBoss AS）中。由于该服务是无状态的，因此可以根据您的需要为客户负载部署尽可能多的这些服务。war文件应扩展到用于部署的文件夹（稍后将清除）-因此您可以将其部署为名为drools-server.war的文件夹。</p><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/running_execution_server.png" align="middle"></div><p>部署完战争之后，您应该可以转到http：// localhost：8080 / drools-server并看到与上述类似的页面（显然用正确的服务器地址代替）。显示的页面应提供有关如何使用它的信息，并表明它是健康的。</p><p>要配置“知识库”，请创建一个带有知识代理配置的属性文件（有关知识代理配置中选项的详细信息，请参见上面的部分）。该属性文件的名称将是您用来访问此服务的URL中的名称。因此，以teamallocation.properties为例：服务的代理配置，它将为团队分配一些工作。 teamallocation.properties应该包含有关要加载哪些软件包以及从何处加载的详细信息。</p><p>将teamallocation.properties放置在war目录的WEB-INF / classes目录中（并在需要时重新启动服务器）。重要的是，您还将需要将规则需要放置在每个执行服务器实例的WEB-INF / lib目录中的所有jar文件（例如，模型（如果使用pojo模型）或支持类（如果需要）-您可能不需要任何）。通常，如果您正在使用执行服务器，则您的客户端代码将不会使用对象模型jar与服务进行通讯，因此</p><p>完成此操作后，可通过以下格式的网址访问服务器：http：//您的服务器/ drools-server / knowledgebase / {代理配置名称}。因此，在上面的示例中将是：</p><pre class="programlisting">http://your-server/drools-server/knowledgebase/teamallocation</pre><p>从中可以看出，您可以根据需要配置尽可能多的代理，也许可以用于许多并发版本的知识库。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="d0e1123"></a> 1.4.7.2.2。消费服务</h5></div></div></div><p>使用该服务非常简单，您需要选择使用XML或JSON。默认情况下，使用XML，但是通过将Content-Type HTTP标头设置为application / json，将使用JSON（在某些情况下JSON的性能更高）。</p><p>客户端库：REST服务的优点之一是，无论使用哪种语言，都不需要特殊的客户端库。但是，在Java中，建议使用Apache commons“ HttpClient”作为比默认值更易于使用的API。仅需要HTTP（如果在不受信任的网络上，当然https可用于安全传输）。</p><p>样品要求：</p><pre class="programlisting">&lt;knowledgebase-request&gt;
  &lt;globals&gt;
    &lt;named-fact&gt;
      &lt;id&gt;myglobal&lt;/id&gt;
      &lt;fact class="org.drools.server.ExampleFact"&gt;
        &lt;carType&gt;Saab&lt;/carType&gt;
        &lt;carPrice&gt;42&lt;/carPrice&gt;
      &lt;/fact&gt;
    &lt;/named-fact&gt;
  &lt;/globals&gt;
  &lt;inOutFacts&gt;
    &lt;named-fact&gt;
      &lt;id&gt;myfact&lt;/id&gt;
      &lt;fact class="org.drools.server.ExampleFact"&gt;
        &lt;carType&gt;BMW&lt;/carType&gt;
        &lt;carPrice&gt;50&lt;/carPrice&gt;
      &lt;/fact&gt;
    &lt;/named-fact&gt;
  &lt;/inOutFacts&gt;
  &lt;inFacts&gt;
    &lt;anon-fact&gt;
      &lt;fact class="org.drools.server.ExampleFact"&gt;
        &lt;carType&gt;Audi&lt;/carType&gt;
        &lt;carPrice&gt;55&lt;/carPrice&gt;
      &lt;/fact&gt;
    &lt;/anon-fact&gt;
    &lt;anon-fact&gt;
      &lt;fact class="org.drools.server.ExampleFact"&gt;
        &lt;carType&gt;Mercedes&lt;/carType&gt;
        &lt;carPrice&gt;65&lt;/carPrice&gt;
      &lt;/fact&gt;
    &lt;/anon-fact&gt;
  &lt;/inFacts&gt;
&lt;/knowledgebase-request&gt;</pre><p>请求的元素：请注意，包含3个部分：全局变量，inOutFacts和inFacts。全局消息和inOutFacts都在响应消息中返回。为此，将全局变量和inOutFacts命名（每个名称必须唯一）（对于全局变量，全局名称是规则中使用的名称）。名称使用“ id”标签。请注意，“事实”标记是指知识库所使用的事实-封闭标记中的字段由事实类本身定义。如果事实类具有嵌套类，则该嵌套数据的数据将显示为<nestedfactfieldname>-其中nestedFactFieldName是“父”类中字段的名称。在该标签内是带有该嵌套数据的字段值的标签（不需要类名，因为它是从父事实派生的）。</nestedfactfieldname></p><p>样本响应：</p><pre class="programlisting">&lt;knowledgebase-response&gt;
  &lt;globals&gt;
    &lt;named-fact&gt;
      &lt;id&gt;myglobal&lt;/id&gt;
      &lt;fact class="org.drools.server.ExampleFact"&gt;
        &lt;carType&gt;Saab&lt;/carType&gt;
        &lt;carPrice&gt;42&lt;/carPrice&gt;
      &lt;/fact&gt;
    &lt;/named-fact&gt;
  &lt;/globals&gt;
  &lt;inOutFacts&gt;
    &lt;named-fact&gt;
      &lt;id&gt;myfact&lt;/id&gt;
      &lt;fact class="org.drools.server.ExampleFact"&gt;
        &lt;carType&gt;BMW&lt;/carType&gt;
        &lt;carPrice&gt;50&lt;/carPrice&gt;
      &lt;/fact&gt;
    &lt;/named-fact&gt;
  &lt;/inOutFacts&gt;
&lt;/knowledgebase-response&gt;</pre><p>响应元素：与请求类似（请注意，封装标签不同）-当然，仅全局和inOutFacts会返回其状态。</p><p>JSON：（JavaScript对象表示法）遵循与上述请求相同的基本对象图布局。一些注意事项：在JSON中，@ class用于指示规则使用的事实的类型。另外，在javascript中，关联数组（映射）用“ {”和“}”表示，而数组通过“ [”和“]”表示。在某些情况下，如果存在一个列表（数组），但是仅存在1个数据元素，则不会显示“ [”。例如，结果中的{“ a”：“ b”}可以与[{“ a”：“ b”}]具有相同的含义。</p><p>样品要求：</p><pre class="programlisting">{"knowledgebase-request":
{"globals":{"named-fact":{"id":"myglobal","fact":{"@class":"org.drools.server.ExampleFact","carType":"Saab","carPrice":42}}},
"inOutFacts":{"named-fact":{"id":"myfact","fact":{"@class":"org.drools.server.ExampleFact","carType":"BMW","carPrice":50}}},
"inFacts":{"anon-fact":[{"fact":{"@class":"org.drools.server.ExampleFact","carType":"Audi","carPrice":55}},{"fact":{"@class":"org.drools.server.ExampleFact","carType":"Mercedes","carPrice":65}}]}}}</pre><p>样本响应：</p><pre class="programlisting">{"knowledgebase-response":
{"globals":{"named-fact":{"id":"myglobal","fact":{"@class":"org.drools.server.ExampleFact","carType":"Saab","carPrice":42}}},
"inOutFacts":{"named-fact":{"id":"myfact","fact":{"@class":"org.drools.server.ExampleFact","carType":"BMW","carPrice":50}}}}}</pre><p>以下是示例代码片段，显示了如何使用Ruby中的JSON访问知识库：</p><pre class="programlisting">
    require 'json'
    http = Net::HTTP.new('localhost', 8080)
    path = "/drools-server/knowledgebase/teamallocation"
    post_data = {"knowledgebase-request" =&gt; {                     
                  :globals =&gt; {"named-fact" =&gt; [{:id =&gt; "a", :fact =&gt; {"@class" =&gt; "teamallocation.Assignment"}}]},
                  :inFacts =&gt; {"anon-fact" =&gt; [{:fact =&gt; {"@class" =&gt; "teamallocation.Claim", "value" =&gt; 150}}]},
                  :inOutFacts =&gt; {"named-fact" =&gt; [{:id =&gt; "x", :fact =&gt; {"@class" =&gt; "teamallocation.Team", "specialty" =&gt; "FATAL"}},
                                                   {:id =&gt; "y", :fact =&gt; {"@class" =&gt; "teamallocation.Team"}}]}
                                            }                    
                 }
    headers = {
      "Content-Type" =&gt; "application/json"
    }
    resp, data = http.post(path, post_data.to_json, headers)
    
    
    answer = JSON.parse(data)
    #digging out the results:
    puts answer["knowledgebase-response"]["globals"]["named-fact"]["fact"]["teamName"]
    #if there is more then one fact, they are a list
    puts answer["knowledgebase-response"]["inOutFacts"]["named-fact"][0]["fact"]["specialty"]
</pre></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1156"></a> 1.4.7.3。JMS，SOAP / WSDL集成</h4></div></div></div><p>无状态规则执行服务器可能不足以满足您的需求。如果您需要WSDL + SOAP，JMS或其他集成，则可以使用JBoss ESB（http://www.jboss.org/JBossESB/）。</p><p>esb可以根据需要通过多种传输机制（例如http / soap或JMS，以及更多）提供状态和无状态规则服务。还提供了负载平衡，故障转移，监视等功能。有关此方面的更多信息，请参见ESB网站（http://www.jboss.org/JBossESB/）（本手册中不会涉及）。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1163"></a> 1.4.7.4。手动部署</h4></div></div></div><p>只有将部署集成到自己的机制中的高级用户才需要此部分。通常，您应该使用知识代理。</p><p>对于那些不想使用自动部署KnowledgeAgent的人，“自己动手”非常简单。Guvnor发出的二进制程序包是序列化的Package对象。您可以反序列化它们并将它们添加到任何知识库中-本质上这就是您需要做的。</p><p>从Guvnor，二进制软件包是从软件包的最新版本（一旦您成功验证并构建了软件包）或从部署快照中提供的。Guvnor Web应用程序公开的URL通过http提供二进制程序包。您还可以发出“ HEAD”命令以获取上次更新包的时间。</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1172"></a> 1.4.8。WebDAV和HTTP</h3></div></div></div><p>存储库后端也可以通过webdav访问。 WebDAV是基于http的文件系统API-在所有平台上都有客户端（某些操作系统（例如Windows）可以像文件系统一样直接连接到WebDAV存储库。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1177"></a> 1.4.8.1。WebDAV</h4></div></div></div><div class="figure"><a id="d0e1180"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/WebDAVWindows.png" align="middle" alt="Windows WebDAV"></div></div><p class="title"><b>图1.38。Windows WebDAV</b></p></div><br class="figure-break"><p>在Windows中，可以使用“网络文件夹”功能。在OSX上-免费的cyberduck客户端可以正常运行。要以webdav的身份访问存储库，您的URL与Web界面相同，仅以/ webdav结尾，而不是Guvnor.html。要通过这种方式访问，将需要进行身份验证。这将显示一个包和快照目录-快照目录是只读的（创建的包快照的视图）。软件包目录将包含存储库中的软件包列表，钻取到它们会将单个资产显示为文件。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1188"></a> 1.4.8.2。网址</h4></div></div></div><p>还有一些其他容易知道的URL。关于知识代理部署的部分中提到的程序包部署URL还具有其他一些功能：通过将.drl附加到URL的末尾，您将显示该程序包生成的DRL。例如：/package/testPDSGetPackage/LATEST.drl-将显示最新软件包的DRL（不是二进制软件包）。除此之外，您可以附加/assetName.drl-它将显示该项目的生成的DRL。 （即使它不是drl文件）。例如/package/testPDSGetPackage/LATEST/SomeFile.drl。</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1193"></a> 1.4.9。Eclipse Guvnor集成</h3></div></div></div><p>Eclipse Guvnor工具（EGT）提供了从Guvnor存储库服务器和Eclipse中的开发人员工作区推入/拉出工件的能力。因此，既可以通过Guvnor进行管理，也可以通过传统的对开发人员友好的SCM系统（例如Subversion）来管理工件。Guvnor存储库不打算用作源代码管理（SCM）解决方案，而EGT也不希望成为Eclipse的“团队提供者”扩展或替换。相反，Guvnor存储库是一个位置，其中某些工件（例如规则和SOA策略定义）由部署环境定义的策略进行控制（“控制”）。然后，EGT的目的是允许访问Guvnor存储库所拥有的资源，以便可以在开发中使用它们。因此，EGT中提供了用于读取，写入，添加和删除Guvnor存储库资源的有限功能。</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1198"></a> 1.4.9.1。源代码和插件详细信息</h4></div></div></div><p>EGT的源代码位于： <code class="code">http://anonsvn.jboss.org/repos/labs/labs/jbossrules/trunk/drools-eclipse/</code> EGT由两个插件组成：org.guvnor.tools org.eclipse.webdav，需要Eclipse3.3.x。当前的Eclipse Drools插件对于查看Guvnor存储库资源（例如规则定义）也很有用，但对于EGT的操作不是必需的。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1206"></a> 1.4.9.2。功能概述</h4></div></div></div><p>视图和透视图：EGT包含两个视图–资源库浏览器和版本历史记录–将成为与Guvnor进行大多数交互的中心。Eclipse标准视图（例如“属性”和“资源导航器”）也很有用。虽然可以在Eclipse工作台中独立打开和放置这些视图中的每个视图，但Guvnor透视图提供了一种获取建议布局的便捷方法。在Eclipse工作台菜单中，选择“窗口”，“打开透视图”，“其他”以获取透视图列表：</p><div class="figure"><a id="d0e1211"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT1.png" align="middle" alt="观点和观点"></div></div><p class="title"><b>图1.39。观点和观点</b></p></div><br class="figure-break"><p>然后选择“ Guvnor存储库浏览”。这将打开Guvnor透视图：</p><div class="figure"><a id="d0e1219"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT2.png" align="middle" alt="观点和观点"></div></div><p class="title"><b>图1.40。观点和观点</b></p></div><br class="figure-break"><p>左侧是Guvnor Repository Explorer和Eclipse Properties视图，Guvnor Resource History视图在底部，而Eclipse Resource Navigator在右侧。Guvnor资源库资源管理器的目的是允许以标准树格式访问Guvnor资源库资源，并且Guvnor资源历史记录视图显示资源库中可用的特定资源的修订版。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1227"></a> 1.4.9.3。Guvnor连接向导</h4></div></div></div><p>打开Guvnor透视图后，第一个任务是建立与Guvnor存储库的连接。这由Guvnor连接向导处理。该向导出现在EGT中的许多位置（如下所述），但是在本节中，我们将仅介绍两个最基本的入口点。Guvnor连接向导可以使用Eclipse菜单启动：File，New，Other，Guvnor，Guvnor存储库位置，或在Guvnor Explorer中使用下拉菜单启动：</p><div class="figure"><a id="d0e1232"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT3.png" align="middle" alt="连接向导"></div></div><p class="title"><b>图1.41。连接向导</b></p></div><br class="figure-break"><p>或菜单按钮：</p><div class="figure"><a id="d0e1240"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT4.png" align="middle" alt="连接向导"></div></div><p class="title"><b>图1.42。连接向导</b></p></div><br class="figure-break"><p>选择以下任一选项将启动Guvnor连接向导：</p><div class="figure"><a id="d0e1248"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT5.png" align="middle" alt="连接向导"></div></div><p class="title"><b>图1.43。连接向导</b></p></div><br class="figure-break"><p>默认值显示在“位置”，“端口”和“存储库”字段中。（有关如何更改这些默认值的详细信息，请参见下面的“ Guvnor首选项”部分。）当然，可以通过在相应的文本框中键入来编辑任何这些字段。拖放或粘贴到典型的Guvnor存储库URL的“位置”字段中，例如： <code class="code">http://localhost:8080/drools-guvnor/org.drools.guvnor.Guvnor/webdav</code>结果也将URL解析为相应的字段。根据对“保存用户名和密码”的选择，可以选择将认证信息（用户名和密码）存储在Eclipse工作台的密钥环文件中。如果认证信息未存储在密钥环中，则EGT使用会话认证，这意味着所提供的凭证仅在Eclipse工作台实例的生命周期内使用。</p><p>如果身份验证信息未存储在密钥环中或身份验证信息（密钥环或会话）无效，则EGT在必须访问Guvnor存储库时将提示输入身份验证信息：</p><div class="figure"><a id="d0e1261"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT6.png" align="middle" alt="登录"></div></div><p class="title"><b>图1.44。登录</b></p></div><br class="figure-break"><p>如果身份验证失败，则EGT将重试一次，然后发出身份验证失败错误。（如果发生身份验证失败错误，则可以重试相同的操作并提供不同的身份验证信息。）请注意，EGT会在不同时间调用Guvnor存储库，例如在确定资源更新是否可用时，因此，如果您使用会话身份验证，身份验证对话框将在Eclipse工作台会话期间的不同时间出现，具体取决于您执行的操作。为了易于使用，建议将身份验证信息保存在Eclipse密钥环中。（Eclipse密钥环文件不同于在某些平台（例如Mac OS X和许多形式的Linux）中找到的密钥环文件。因此，有时，如果您访问EGT外部的Guvnor存储库，则密钥环文件可能变得不同步，并且会意外地提示您在Eclipse中进行身份验证。这很麻烦，但在这种情况下，您的常规凭据应适用。）</p><p>Guvnor连接向导完成后，新的Guvnor存储库连接将出现在Guvnor存储库资源管理器中。然后，您可以展开树以查看Guvnor存储库内容。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1271"></a> 1.4.9.4。Guvnor资料库浏览器</h4></div></div></div><div class="figure"><a id="d0e1274"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT7.png" align="middle" alt="探险者"></div></div><p class="title"><b>图1.45。探险者</b></p></div><br class="figure-break"><p>Guvnor资源库资源管理器视图包含Guvnor资源库内容的树结构。如上所述，有用于创建Guvnor存储库连接的菜单和工具栏操作。工具栏中的红色“ X”和菜单中的“删除”将删除Guvnor存储库连接，“刷新”菜单项将重新加载所选节点的树内容。最后，有许多工具栏/菜单项支持“钻取”功能：其中一个工具栏由房屋（“返回顶层/房屋”）和箭头（进入/背部）。当使用深度嵌套的树结构时，以及当您只想专注于树的分支时，向下钻取很有用。例如，钻入上面显示的“ defaultPackage”节点，可将树视图更改为：</p><div class="figure"><a id="d0e1282"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT8.png" align="middle" alt="探险者"></div></div><p class="title"><b>图1.46。探险者</b></p></div><br class="figure-break"><p>也就是说，我们仅在树中看到“ defaultPackage”的内容。单击房屋按钮，或选择“回家”，将树返回到上图所示的顶层结构。</p><p>Guvnor存储库文件上可以执行许多操作。在Guvnor存储库中选择一个文件会导致Eclipse Properties视图更新有关该文件的详细信息：</p><div class="figure"><a id="d0e1292"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT9.png" align="middle" alt="性质"></div></div><p class="title"><b>图1.47。性质</b></p></div><br class="figure-break"><p>双击树中的文件夹（目录）将导致该文件夹在折叠时扩展，在折叠时收缩。双击树中的文件将导致在Eclipse中打开一个只读编辑器，显示该文件的内容：</p><div class="figure"><a id="d0e1300"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT10.png" align="middle" alt="评论"></div></div><p class="title"><b>图1.48。评论</b></p></div><br class="figure-break"><p>将文件从Guvnor存储库树拖到Eclipse本地项目（例如，在Eclipse Resource Navigator视图中）的文件夹中，将导致在本地Eclipse工作区中创建该文件的副本。（注意：当文件在只读编辑器中打开时，您也可以“另存为...”，以保存内容的本地可写副本。但是，这样做不会将创建的文件与其Guvnor源关联。）最后，您可以使用“显示历史记录”上下文菜单项查看在树中选择的文件的修订历史记录。（资源历史记录的详细信息将在下面讨论。）</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1308"></a> 1.4.9.5。Guvnor文件的本地副本</h4></div></div></div><p>如引言中所述，EGT的主要目的是允许使用Guvnor存储库中保存的资源进行开发。有两种获取Guvnor存储库资源的本地副本的方法：</p><p>1。如上所述，从Guvnor存储库资源管理器中进行拖放。</p><p>2。如下所述，使用“从Guvnor导入”向导。</p><p>创建Guvnor存储库文件的本地副本后，EGT会在本地副本和存储库中的主文件之间设置关联。（此信息保存在本地项目的（通常）隐藏的“ .guvnorinfo”文件夹中，并且像所有元数据一样，最终用户不应更改。）这种关联允许与Guvnor信息库中保存的主副本同步进行更新和提交等操作。EGT装饰与Guvnor存储库主副本关联的本地资源。这种修饰出现在符合Eclipse Common Navigator框架的Eclipse视图中，例如Eclipse Resource Navigator和Java Package Explorer。下图显示了Eclipse Resource Navigator中的装饰：</p><div class="figure"><a id="d0e1319"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT11.png" align="middle" alt="航海家"></div></div><p class="title"><b>图1.49。航海家</b></p></div><br class="figure-break"><p>注意文件图像右上角的Guvnor图标装饰器，并且Guvnor修订版详细信息附加在文件名之后。（这些的存在/位置可以更改。有关详细信息，请参见下面的“ Guvnor首选项”。）在这里，我们看到，例如，“ simpleRule.drl”与Guvnor存储库资源相关联，本地副本基于版本3，带有7 / 15-2008，15:37:34日期/时间戳。但是，文件“ deleteTest.txt”与Guvnor存储库文件没有关联。有关关联的更多详细信息，可以在标准的Eclipse属性页面中通过上下文菜单“属性”选择找到：</p><div class="figure"><a id="d0e1327"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT12.png" align="middle" alt="性质"></div></div><p class="title"><b>图1.50。性质</b></p></div><br class="figure-break"><p>EGT将属性页面添加到标准Eclipse属性对话框中，其内容如上所示。将显示特定的Guvnor存储库，存储库中的位置，版本（日期/时间戳）和修订号。</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1335"></a> 1.4.9.6。Guvnor当地资源的行动</h4></div></div></div><p>EGT提供了许多操作（通过文件的“ Guvnor”上下文菜单提供）来处理文件，包括与Guvnor存储库主副本相关联的操作和与文档无关的操作。这些动作是： <code class="code">1.Update 2.Add 3.Commit 4.Show History 5.Compare with Version 6.Switch to Version 7.Delete 8.Disconnect</code>这些动作中的每一个将在下面描述。</p><p>更新动作：</p><p>更新操作可用于与Guvnor存储库主副本不同步的一个或多个Guvnor资源。这些资源将不会同步，因为（1）这些资源有本地更改，或者（2）Guvnor存储库中的主副本已更改。执行更新操作会将本地文件内容替换为Guvnor存储库主副本中的当前内容（对于最新版本，等效于“切换到版本”）。</p><p>添加动作</p><p>“添加”操作可用于一个或多个与Guvnor存储库主副本无关的本地文件。选择“添加”操作将启动“添加到Guvnor”向导：</p><div class="figure"><a id="d0e1351"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT13.png" align="middle" alt="添加动作"></div></div><p class="title"><b>图1.51。添加动作</b></p></div><br class="figure-break"><p>向导的第一页要求选择目标Guvnor存储库，并提供选择以创建新的Guvnor存储库连接（在这种情况下，第二页与上述的Guvnor Connection向导相同）。选择目标Guvnor存储库后，向导将询问文件夹位置以添加选择文件：</p><div class="figure"><a id="d0e1359"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT14.png" align="middle" alt="添加动作"></div></div><p class="title"><b>图1.52。添加动作</b></p></div><br class="figure-break"><p>在这里，我选择文件夹“ anotherPackage”作为目标位置1。单击“完成”将所选文件添加到Guvnor存储库，并在本地和Guvnor存储库文件之间创建关联。（并非该向导不允许覆盖现有的Guvnor存储库文件-必须选择另一个目标位置。）</p><p>与版本操作比较：</p><p>为一个Guvnor存储库关联文件启用了“与版本比较”操作。此操作首先打开一个向导，要求提供要比较的版本（带有本地文件内容）：</p><div class="figure"><a id="d0e1371"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT15.png" align="middle" alt="比较"></div></div><p class="title"><b>图1.53。比较</b></p></div><br class="figure-break"><p>选择修订版后，该操作将打开Eclipse比较编辑器（只读）：</p><div class="figure"><a id="d0e1379"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT16.png" align="middle" alt="比较"></div></div><p class="title"><b>图1.54。比较</b></p></div><br class="figure-break"><p>该编辑器使用Eclipse标准的比较技术来显示两个版本的差异。在没有差异的情况下，将不会打开编辑器：而是会出现一个对话框，指出没有差异。</p><p>切换到版本操作：</p><p>已为一个Guvnor储存库关联文件启用了“切换到版本”操作。首先，切换到版本操作会提示您选择版本：</p><div class="figure"><a id="d0e1391"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT17.png" align="middle" alt="版本号"></div></div><p class="title"><b>图1.55。版本号</b></p></div><br class="figure-break"><p>选择版本后，“切换到版本”操作会将本地文件内容替换为所选版本中的内容。</p><p>删除动作：</p><p>为一个或多个Guvnor存储库相关文件启用了Delete操作。通过对话框确认后，“删除”操作将删除Guvnor存储库中的文件，并删除Guvnor存储库关联的本地元数据。</p><p>断开连接动作：</p><p>已为一个或多个Guvnor存储库关联文件启用了Disconnect操作，并删除了Guvnor存储库关联的本地元数据。</p><p>Guvnor资源历史记录视图：</p><p>“ Govnor资源历史记录”视图应详细说明所选文件的修订历史记录，包括本地文件和Guvnor存储库中的文件。该视图的初始状态为：</p><div class="figure"><a id="d0e1411"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT18.png" align="middle" alt="历史"></div></div><p class="title"><b>图1.56。历史</b></p></div><br class="figure-break"><p>在本地“ Guvnor”上下文菜单或Guvnor存储库资源管理器中的Guvnor存储库文件的上下文菜单中，通过“显示历史记录”操作填充“ Guvnor资源历史记录”视图。执行此操作后，“ Govnor资源历史记录”视图将更新以显示修订历史记录：</p><div class="figure"><a id="d0e1419"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT19.png" align="middle" alt="历史"></div></div><p class="title"><b>图1.57。历史</b></p></div><br class="figure-break"><p>在这里，我们看到文件“ simpleRule.drl”具有三个修订版本。双击修订版行（或上下文菜单“打开（只读）”）将打开带有修订版内容的Eclipse只读编辑器。（注意：当文件在只读编辑器中打开时，您也可以“另存为...”，以保存内容的本地可写副本。但是，这样做不会将创建的文件与其Guvnor源关联。）</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1427"></a> 1.4.9.7。导入Guvnor存储库资源</h4></div></div></div><p>除了从Guvnor存储库资源管理器视图中拖放单个文件外，EGT还包括一个向导，用于将一个或多个文件从Guvnor存储库复制到本地工作空间（并设置与Guvnor存储库的关联）。可以从Eclipse Import，Guvnor，来自Guvnor的资源和Eclipse File，New，Other，Guvnor，来自Guvnor的菜单项中使用此向导。（注意：该向导是相同的，但同时出现在两个位置，以适应倾向于将其视为任一类别的用户。）向导的第一页要求选择源Guvnor存储库，并提供选择以创建新的Guvnor存储库连接（在这种情况下，第二页与上述的Guvnor连接向导相同）。</p><div class="figure"><a id="d0e1432"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT20.png" align="middle" alt="进口"></div></div><p class="title"><b>图1.58。进口</b></p></div><br class="figure-break"><p>选择源Guvnor存储库后，向导将提示您选择资源：</p><div class="figure"><a id="d0e1440"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT21.png" align="middle" alt="进口"></div></div><p class="title"><b>图1.59。进口</b></p></div><br class="figure-break"><p>最后，选择本地工作空间中的目标位置：</p><div class="figure"><a id="d0e1448"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT22.png" align="middle" alt="进口"></div></div><p class="title"><b>图1.60。进口</b></p></div><br class="figure-break"><p>完成后，向导会将所选文件从Guvnor存储库复制到本地工作空间。如果目标中已经存在同名文件，则向导将使用Eclipse标准的“提示重命名”对话框：</p><div class="figure"><a id="d0e1456"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT23.png" align="middle" alt="复制"></div></div><p class="title"><b>图1.61。复制</b></p></div><br class="figure-break"></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1462"></a> 1.4.9.8。Guvnor插件首选项</h4></div></div></div><p>EGT在“ Guvnor”类别中提供了一个首选项页面：</p><div class="figure"><a id="d0e1467"></a><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/Chapter-Guvnor/EGT24.png" align="middle" alt="优先"></div></div><p class="title"><b>图1.62。优先</b></p></div><br class="figure-break"><p>首选项涵盖两类：Guvnor存储库连接和本地Guvnor存储库资源修饰。</p><p>Guvnor存储库连接首选项</p><p>可以为Guvnor存储库连接设置两个首选项，这些首选项在创建新连接时使用。第一个是默认的Guvnor存储库URL模板，通过更改字段的一部分（例如主机名），可以更轻松地创建多个类似的连接。第二个是默认情况下是否应启用将身份验证信息保存在Eclipse平台密钥环中的功能。与Guvnor存储库URL模板一样，实际上可以在实际创建连接时确定是否在Eclipse平台密钥环中保存特定的身份验证信息实例。也就是说，这两个首选项都是简单的便捷值，设置为合理的默认值。</p><p>Guvnor本地存储库资源装饰首选项</p><p>EGT提供的第二类首选项涉及如何显示与Guvnor存储库资源相关联的本地资源的修饰。由于Guvnor存储库不能替代SCM，并且由于Eclipse中的SCM工具倾向于修饰本地资源，因此能够控制EGT如何修饰其本地资源以避免与SCM包的混乱冲突非常有用。在首选项页面的“文件修饰”部分中，可以选择修饰图标的位置（右上，右下，左上，左下），也可以选择不显示它。在“文本”部分中，您可以格式化文件名后面附加的Guvnor元数据：当本地文件的更改未提交回Guvnor存储库时，是否显示指示符（>）。是否显示修订号。是否显示日期/时间戳。单击“应用”或“确定”按钮后，对这些首选项的任何更改都会立即生效。</p></div></div></div></div><div class="index"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1484"></a>指数</h2></div></div></div><div class="index"></div></div></div></body></html>