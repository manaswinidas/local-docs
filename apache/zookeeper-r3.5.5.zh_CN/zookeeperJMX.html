<html dir="ltr">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta>
    <title>ZooKeeper：因为协调分布式系统是动物园</title>
    <link type="text/css" href="skin/basic.css" rel="stylesheet"></link>
    <link type="text/css" href="skin/screen.css" rel="stylesheet" media="screen"></link>
    <link type="text/css" href="skin/print.css" rel="stylesheet" media="print"></link>
    <link type="text/css" href="skin/profile.css" rel="stylesheet"></link>
    <script src="skin/getBlank.js" type="text/javascript" language="javascript"></script>
    <script src="skin/getMenu.js" type="text/javascript" language="javascript"></script>
    <script src="skin/init.js" type="text/javascript" language="javascript"></script>
    <link rel="shortcut icon" href="images/favicon.ico"></link>
</head>
<body dir="ltr" onload="init();">
<div id="top">
    <div class="breadtrail">
        <a href="http://www.apache.org/">Apache</a> &gt; <a href="http://zookeeper.apache.org/">ZooKeeper</a>
    </div>
    <div class="header">
        <div class="grouplogo">
            <a href="http://hadoop.apache.org/"><img class="logoImage" alt="Hadoop的" src="images/hadoop-logo.jpg" title="Apache Hadoop"></a>
        </div>
        <div class="projectlogo">
            <a href="http://zookeeper.apache.org/"><img class="logoImage" alt="动物园管理员" src="images/zookeeper_small.gif" title="ZooKeeper：分布式协调"></a>
        </div>
        <div class="searchbox">
            <form action="http://www.google.com/search" method="get">
                <input value="zookeeper.apache.org" name="sitesearch" type="hidden"><input size="25" name="q" id="query" type="text" value="用谷歌搜索网站" onfocus="getBlank (this, &#39;Search the site with google&#39;);"> 
                <input name="Search" value="搜索" type="submit">
            </form>
        </div>
        <ul id="tabs">
            <li>
                <a class="unselected" href="http://zookeeper.apache.org/">项目</a>
            </li>
            <li>
                <a class="unselected" href="https://cwiki.apache.org/confluence/display/ZOOKEEPER/">维基</a>
            </li>
            <li class="current">
                <a class="selected" href="index.html">ZooKeeper 3.5文档</a>
            </li>
        </ul>
    </div>
</div>
<div id="main">
    <div id="publishedStrip">
        <div id="level2tabs"></div>
        <script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
    </div>
    <div class="breadtrail">
         
    </div>
    <div id="menu">
        <div id="menu_1Title" class="menutitle" onclick="SwitchMenu(&#39;menu_1&#39;, &#39;skin/&#39;)">概观</div>
        <div id="menu_1" class="menuitemgroup">
            <div class="menuitem">
                <a href="index.html">欢迎</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperOver.html">概观</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperStarted.html">入门</a>
            </div>
            <div class="menuitem">
                <a href="releasenotes.html">发行说明</a>
            </div>
        </div>
        <div id="menu_2Title" class="menutitle" onclick="SwitchMenu(&#39;menu_2&#39;, &#39;skin/&#39;)">开发人员</div>
        <div id="menu_2" class="menuitemgroup">
            <div class="menuitem">
                <a href="api/index.html">API文档</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperProgrammers.html">程序员指南</a>
            </div>
            <div class="menuitem">
                <a href="javaExample.html">Java示例</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperTutorial.html">障碍和队列教程</a>
            </div>
            <div class="menuitem">
                <a href="recipes.html">食谱</a>
            </div>
        </div>
        <div id="menu_3Title" class="menutitle" onclick="SwitchMenu(&#39;menu_3&#39;, &#39;skin/&#39;)">管理员和行动</div>
        <div id="menu_3" class="menuitemgroup">
            <div class="menuitem">
                <a href="zookeeperAdmin.html">管理员指南</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperQuotas.html">配额指南</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperJMX.html">JMX</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperObservers.html">观察员指南</a>
            </div>
            <div class="menuitem">
                <a href="zookeeperReconfig.html">动态重新配置</a>
            </div>
        </div>
        <div id="menu_4Title" class="menutitle" onclick="SwitchMenu(&#39;menu_4&#39;, &#39;skin/&#39;)">贡献者</div>
        <div id="menu_4" class="menuitemgroup">
            <div class="menuitem">
                <a href="zookeeperInternals.html">ZooKeeper Internals</a>
            </div>
        </div>
        <div id="menu_5Title" class="menutitle" onclick="SwitchMenu(&#39;menu_5&#39;, &#39;skin/&#39;)">杂</div>
        <div id="menu_5" class="menuitemgroup">
            <div class="menuitem">
                <a href="https://cwiki.apache.org/confluence/display/ZOOKEEPER">维基</a>
            </div>
            <div class="menuitem">
                <a href="https://cwiki.apache.org/confluence/display/ZOOKEEPER/FAQ">常问问题</a>
            </div>
            <div class="menuitem">
                <a href="http://zookeeper.apache.org/mailing_lists.html">邮件列表</a>
            </div>
        </div>
    </div>
    <div id="content">
<!--
Copyright 2002-2004 The Apache Software Foundation

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
//--><h1>ZooKeeper JMX</h1>
<ul>
  <li><a href="#ch_jmx">JMX</a></li>
  <li><a href="#ch_starting">在启用JMX的情况下启动ZooKeeper</a></li>
  <li><a href="#ch_console">运行JMX控制台</a></li>
  <li><a href="#ch_reference">ZooKeeper MBean参考</a></li>
</ul><p><a name="ch_jmx"></a></p><h2>JMX</h2><p>Apache ZooKeeper对JMX提供了广泛的支持，允许您查看和管理ZooKeeper服务集合。</p><p>本文档假定您具有JMX的基本知识。请参阅<a href="http://java.sun.com/javase/technologies/core/mntr-mgmt/javamanagement/">Sun JMX技术</a>页面以开始使用JMX。</p><p>有关设置VM实例的本地和远程管理的详细信息，请参阅“ <a href="http://java.sun.com/javase/6/docs/technotes/guides/management/agent.html">JMX管理指南”</a> 。默认情况下，包含的<em>zkServer.sh</em>仅支持本地管理 - 查看链接的文档以启用对远程管理的支持（超出本文档的范围）。</p><p><a name="ch_starting"></a></p><h2>在启用JMX的情况下启动ZooKeeper</h2><p>类<em>org.apache.zookeeper.server.quorum。QuorumPeerMain</em>将启动JMX可管理的ZooKeeper服务器。此类在初始化期间注册适当的MBean，以支持JMX监视和实例管理。有关使用QuorumPeerMain启动ZooKeeper的一个示例，请参阅<em>bin /</em> zkServer.sh。</p><p><a name="ch_console"></a></p><h2>运行JMX控制台</h2><p>有许多可用的JMX控制台可以连接到正在运行的服务器。在本例中，我们将使用Sun的<em>jconsole</em> 。</p><p>Java JDK附带一个名为<a href="http://java.sun.com/developer/technicalArticles/J2SE/jconsole.html">jconsole</a>的简单JMX控制台，可用于连接ZooKeeper并检查正在运行的服务器。一旦你使用QuorumPeerMain启动ZooKeeper启动<em>jconsole</em> ，它通常位于<em>JDK_HOME / bin / jconsole中</em></p><p>显示“新连接”窗口时，要么连接到本地进程（如果jconsole在与服务器相同的主机上启动），要么使用远程进程连接。</p><p>默认情况下，将显示VM的“概述”选项卡（这是深入了解VM btw的好方法）。选择“MBeans”选项卡。</p><p>你现在应该看到<em>org.apache。ZooKeeperService</em>在左侧。展开此项目，根据您启动服务器的方式，您将能够监视和管理各种服务相关功能。</p><p>另请注意，ZooKeeper也会注册log4j MBean。在左侧的同一部分，您将看到“log4j”。展开它以通过JMX管理log4j。特别感兴趣的是能够动态更改编辑appender和根阈值所使用的日志记录级别。通过在启动ZooKeeper时将<em>-Dzookeeper.jmx.log4j.disable = true</em>传递给JVM，可以禁用Log4j MBean注册。此外，我们可以使用<em>-Dzookeeper.jmx.log4j.mbean = log4j：hierarchy = default</em>选项指定MBean的名称，以防我们需要使用旧的MBean名称升级集成系统（ <code>log4j:hiearchy = default</code> ） 。</p><p><a name="ch_reference"></a></p><h2>ZooKeeper MBean参考</h2><p>此表详细介绍了参与复制的ZooKeeper集合的服务器的JMX（即不是独立的）。这是生产环境的典型案例。</p><h3>MBean，他们的名字和描述</h3>
<table>
  <thead>
    <tr>
      <th>的MBean</th>
      <th>MBean对象名称</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>法定人数</td>
      <td>ReplicatedServer_id &lt;＃&gt;</td>
      <td>表示Quorum或Ensemble  - 所有集群成员的父级。请注意，对象名称包含JMX代理已连接到的服务器（名称后缀）的“myid”。</td>
    </tr>
    <tr>
      <td>LocalPeer /远程同级</td>
      <td>复制品。&lt;＃&gt;</td>
      <td>表示本地或远程对等方（即参与集合的服务器）。请注意，对象名称包含服务器的“myid”（名称后缀）。</td>
    </tr>
    <tr>
      <td>LeaderElection</td>
      <td>LeaderElection</td>
      <td>表示正在进行的ZooKeeper集群领导者选举。提供有关选举的信息，例如何时开始。</td>
    </tr>
    <tr>
      <td>领导</td>
      <td>领导</td>
      <td>表示父副本是领导者，并为该服务器提供属性/操作。请注意，Leader是ZooKeeperServer的子类，因此它提供了通常与ZooKeeperServer节点关联的所有信息。</td>
    </tr>
    <tr>
      <td>信徒</td>
      <td>信徒</td>
      <td>表示父副本是关注者，并为该服务器提供属性/操作。请注意，Follower是ZooKeeperServer的子类，因此它提供了通常与ZooKeeperServer节点关联的所有信息。</td>
    </tr>
    <tr>
      <td>的Datatree</td>
      <td>InMemoryDataTree</td>
      <td>内存znode数据库的统计信息，也用于访问数据的更精细（和计算密集度更高）的统计信息（例如短暂计数）。InMemoryDataTrees是ZooKeeperServer节点的子节点。</td>
    </tr>
    <tr>
      <td>ServerCnxn</td>
      <td><session_id> </session_id></td>
      <td>每个客户端连接的统计信息，以及这些连接上的操作（例如终止）。请注意，对象名称是十六进制形式的连接的会话ID。</td>
    </tr>
  </tbody>
</table><p>此表详细介绍了独立服务器的JMX。通常，独立仅用于开发情况。</p><h3>MBean，他们的名字和描述</h3>
<table>
  <thead>
    <tr>
      <th>的MBean</th>
      <th>MBean对象名称</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ZooKeeperServer</td>
      <td>StandaloneServer_port &lt;＃&gt;</td>
      <td>运行服务器的统计信息，以及重置这些属性的操作。请注意，对象名称包括服务器的客户端端口（名称后缀）。</td>
    </tr>
    <tr>
      <td>的Datatree</td>
      <td>InMemoryDataTree</td>
      <td>内存znode数据库的统计信息，也用于访问数据的更精细（和计算密集度更高）的统计信息（例如短暂计数）。</td>
    </tr>
    <tr>
      <td>ServerCnxn</td>
      <td>&lt;session_id&gt;</td>
      <td>每个客户端连接的统计信息，以及这些连接上的操作（例如终止）。请注意，对象名称是十六进制形式的连接的会话ID。</td>
    </tr>
  </tbody>
</table></div>
<div class="clearboth"> </div>
</div>
<div id="footer">
    <div class="lastmodified">
        <script type="text/javascript">
        <!--
            document.write("Last Published: " + document.lastModified);
        //  -->
        </script>
    </div>
    <div class="copyright">版权所有© <a href="http://www.apache.org/licenses/">Apache Software Foundation。</a>
    </div>
    <div id="logos"></div>
</div>
</body>
</html>