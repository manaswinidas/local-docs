<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link type="text/css" rel="stylesheet" href="http://geronimo.apache.org/style/default.css">
    <LINK rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <META name="Description" content="3 - Geronimo Kernel" />
    <META name="Keywords" content="Apache Geronimo development documentation 3 - Geronimo Kernel" />
    <META name="Owner" content="dev@geronimo.apache.org" />
    <META name="Robots" content="index, follow" />
    <META name="Security" content="Public" />
    <META name="Source" content="wiki template" />
    <META name="DC.Date" scheme="iso8601" content="2009-01-06" />
    <META name="DC.Language" scheme="rfc1766" content="en" />
    <META name="DC.Rights" content="Copyright Â© 2003-2011, The Apache Software Foundation" />
    <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo Development : 3 - Geronimo Kernel</title>

  </head>

  <body onload="init()">

    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tr>
        <td valing="top" align="left">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </table>

    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" align="left" nowrap>
          <a href="/geronimo"> Home</a> >&nbsp;<a href="index.html">Index</a>&nbsp;&gt;&nbsp;<a href="geronimo-architecture.html">Geronimo Architecture</a>&nbsp;&gt;&nbsp;<a href="3-geronimo-kernel.html">3 - Geronimo Kernel</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8" />
            <input type="hidden" name="oe" value="UTF-8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
        </td>
      </tr> 
    </table>

    <div id="PageContent">
      <div class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div style="margin: 0px 10px 0px 10px" class="smalltext">Apache Geronimo Development</div>
        <div style="margin: 0px 10px 8px 10px"  class="pagetitle">3 - Geronimo Kernel</div>

        <div class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
<!-- -->         
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=31158">
            <img src="http://geronimo.apache.org/images/icons/notep_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Edit Page"></a>
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=31158">Edit Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV">
            <img src="http://geronimo.apache.org/images/icons/browse_space.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Browse Space"></a>
            <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV">Browse Space</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=31158">
            <img src="http://geronimo.apache.org/images/icons/add_page_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add Page"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=31158">Add Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=31158">
            <img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add News"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=31158">Add News</a>
<!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>

<h1 id="id-3-GeronimoKernel-Overview">Overview</h1>

<p>This section discusses the Geronimo Kernel.  Before getting into the higher level overview of the Geronimo architecture as a whole, it's important to understand the kernel.  Through the kernel, GBeans in Geronimo can communicate with the management utilities while being loosely coupled and not tied to JMX.  This loose coupling that the kernel provides also makes testing much easier, and allows dependency management and injection.  The kernel keeps track of the various GBeans in the system along with the various dependencies, references to other GBeans, attributes and methods.  Below is a high level overview of the Geronimo kernel:</p>

<p><br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="3-geronimo-kernel.data/kernel_component_diagram.png"></span>
<br clear="none" class="atl-forced-newline"></p>

<p>The Geronimo Console is a web based way to deploy/start/stop applications, change JMS information etc.  In addition to the Geronimo console, this could be some custom written tool, or some other J2EE management software.  If a user wanted to stop an application using the Geronimo Console, the user would log into the web console and select the application to stop.  When the action to stop the application occurred, the web  console wouldn't access Tomcat directly.  Instead the web console would query the kernel (through an MBeanServer) for the Tomcat GBean and then the kernel would reflectively execute the appropriate stop function in Tomcat.  Note that this allows testing of the web console, the kernel and Tomcat separately from each other.  All of the operations on the GBean occur via calls to an implementation of the Kernel interface allowing the implementation details of the kernel to change with minimal impact to the system.  Behind the scenes, the BasicKernel class that implements the Kernel interface and employs the assistance of many other classes.  These other classes are all hidden behind the Kernel interface.</p>

<h2 id="id-3-GeronimoKernel-Kernel">Kernel</h2>

<p>The Kernel interface is where it all starts.  Below is a class diagram of Geronimo Kernel.  Note that many details have been ommitted, such as each of the methods of the Kernel interface, so as to not cloud the core concepts of the kernel.</p>

<p><br clear="none" class="atl-forced-newline">
<span class="confluence-embedded-file-wrapper image-left-wrapper"><img class="confluence-embedded-image image-left" src="3-geronimo-kernel.data/basic_kernel_class_diagram.png"></span>
<br clear="none" class="atl-forced-newline"></p>


<p>The purpose of the kernel is to operate on GBeans that are hooked into Geronimo.  In the above diagram, Kernel is an Interface and BasicKernel and KernelGBean are shown to implement that interface.  The kernel is wrapped in a GBean just like Tomcat or ActiveMQ are.  To achieve this, KernelGBean is a <a shape="rect" class="external-link" href="http://en.wikipedia.org/wiki/Decorator_pattern" rel="nofollow">Decorator</a> of Kernel.  An instance of Kernel is passed in via the constructor and so all of the methods of Kernel are delegated to that instance.  The new  functionality that is added to Kernel is the getGBeanInfo() method, needed to make Kernel a GBean.  BasicKernel is the concrete implementation of Kernel and has the functionality to manipulate GBeans.  Calling getAttribute() for a given GBean will return the results of calling the getter method passed in via the method parameters (those parameters will be discussed in detail below).  The invoke() methods, similar to the getAttribute() methods, will execute a particular method on the GBean.  Note that other normal operations that you'd want are there as well, like starting or stopping a GBean.</p>

<h2 id="id-3-GeronimoKernel-ReferencingGBeans">Referencing GBeans </h2>

<p>In the above class diagram, the Kernel class has a method named loadGBean().  This method takes an instance of GBeanData (which is essentially just a wrapper around GBean information) and a classloader as input.  Recall from <a shape="rect" href="2-gbeans-architecture.html">GBeans</a> that GBeans aren't required to implement any interface.  So the GBeanData object wraps information on how the GBean should be accessed (it's name) and methods/attributes of that GBean.  BasicKernel takes the GBeanData and passes it to GBeanInstance to create the object that will be used for all references to that GBean.  GBeanInstance has all of the methods that are able to be called, links to the references and dependencies on the other GBeans etc.  Dependencies are injected here as well.  One of the most important pieces of information that is contained in the GBeanInstance is how it's referenced.  Looking through the javadocs for the kernel (link here) will reveal that many of the methods in the interface are overridden four times.  Each of the overridden methods have similar method signatures.  This is because there are four possible ways to reference a GBean.  There is the abstract name, the short name, the object name (looking up GBeans by object name has now been deprecated) and the class type.  Below is a table of the four types with definitions of each of the names:</p>

<div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Name</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Object Type</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>Abstract Name</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>AbstractName</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Geronimo specific name of the object.  It's a URI that uniquely identifies a given GBean.  From the javadocs, it is defined by: [vendorId]/artifactId/[version]/[type]?key=value[,key=value][,...]</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>Object Name</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>ObjectName</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>JMX name for a GBean.  This is required by the JMX spec and would be used by JMX based tools to reference GBean objects</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>Short Name</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>String</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Will reference a GBean by name (a key/value pair of the Abstract Name)</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>Type</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Class</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>References based on type from the URI in the Abstract Name</p></td></tr></tbody></table></div>


<p>Although there are four ways to access a GBean, essentially there are only two, and then two short-hand ways.  If a bean is referenced via a Short Name, or via it's Type, all of the abstract names are queried looking for which abstract name the type or short name belongs to.  Then once that is found, it is referenced by Abstract Name.  In the BasicRegistry, there are two data structures of GBean references.  One for Object Names and one for GBeans.  When a GBean is added an entry is made for both to enable fast searching by Abstract Name or by Object Name.</p>
</div>
        </div>

        
      </div>
    </div>

    <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tr>
          <td align="left" valign="middle" class="footer">
            &nbsp;&nbsp;
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="Delicious" />
            <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">Bookmark this on Delicious</a>
            &nbsp;&nbsp;
            <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="Digg!" />
            <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)+'&amp;topic=programming');">Digg this</a>
            <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo Development : 3 - Geronimo Kernel';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
            &nbsp;&nbsp;
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;-&nbsp;&nbsp;
            Copyright &#169; 2003-2011, The Apache Software Foundation, Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0.</a>&nbsp;&nbsp;
          </td>
        </tr>
    </table> 

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-4380560-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  </body>
</html>
