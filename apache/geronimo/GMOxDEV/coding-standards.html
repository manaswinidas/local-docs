<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link type="text/css" rel="stylesheet" href="http://geronimo.apache.org/style/default.css">
    <LINK rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <META name="Description" content="Coding standards" />
    <META name="Keywords" content="Apache Geronimo development documentation Coding standards" />
    <META name="Owner" content="dev@geronimo.apache.org" />
    <META name="Robots" content="index, follow" />
    <META name="Security" content="Public" />
    <META name="Source" content="wiki template" />
    <META name="DC.Date" scheme="iso8601" content="2009-01-06" />
    <META name="DC.Language" scheme="rfc1766" content="en" />
    <META name="DC.Rights" content="Copyright Â© 2003-2011, The Apache Software Foundation" />
    <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo Development : Coding standards</title>

  </head>

  <body onload="init()">

    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tr>
        <td valing="top" align="left">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </table>

    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" align="left" nowrap>
          <a href="/geronimo"> Home</a> >&nbsp;<a href="index.html">Index</a>&nbsp;&gt;&nbsp;<a href="coding-standards.html">Coding standards</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8" />
            <input type="hidden" name="oe" value="UTF-8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
        </td>
      </tr> 
    </table>

    <div id="PageContent">
      <div class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div style="margin: 0px 10px 0px 10px" class="smalltext">Apache Geronimo Development</div>
        <div style="margin: 0px 10px 8px 10px"  class="pagetitle">Coding standards</div>

        <div class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
<!-- -->         
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=11743">
            <img src="http://geronimo.apache.org/images/icons/notep_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Edit Page"></a>
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=11743">Edit Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV">
            <img src="http://geronimo.apache.org/images/icons/browse_space.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Browse Space"></a>
            <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV">Browse Space</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=11743">
            <img src="http://geronimo.apache.org/images/icons/add_page_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add Page"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=11743">Add Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=11743">
            <img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add News"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=11743">Add News</a>
<!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><h1 id="Codingstandards-CodingStandards">Coding Standards</h1>

<p>This page describes the standards used for Apache Geronimo code (java, xml, whatever). Code is read by a human being more often than it is actually written by a human being, make the code a pleasure to read.</p>

<p>In this doc you will find:</p>
<style type="text/css">/*<![CDATA[*/
div.rbtoc1435452705900 {padding: 0px;}
div.rbtoc1435452705900 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1435452705900 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class="toc-macro rbtoc1435452705900">
<ul class="toc-indentation"><li><a shape="rect" href="#Codingstandards-Indentation">Indentation</a>
<ul class="toc-indentation"><li><a shape="rect" href="#Codingstandards-Java">Java</a></li><li><a shape="rect" href="#Codingstandards-XML">XML</a></li></ul>
</li><li><a shape="rect" href="#Codingstandards-Interfaces">Interfaces</a></li><li><a shape="rect" href="#Codingstandards-Exceptions">Exceptions</a></li><li><a shape="rect" href="#Codingstandards-PackageNaming">Package Naming</a></li><li><a shape="rect" href="#Codingstandards-Imports">Imports</a>
<ul class="toc-indentation"><li><a shape="rect" href="#Codingstandards-IDEAuto-Formatting">IDE Auto-Formatting</a></li></ul>
</li><li><a shape="rect" href="#Codingstandards-JavaDocTags">JavaDoc Tags</a></li><li><a shape="rect" href="#Codingstandards-UnitTestCases">Unit Test Cases</a></li><li><a shape="rect" href="#Codingstandards-Logging">Logging</a>
<ul class="toc-indentation"><li><a shape="rect" href="#Codingstandards-Levels">Levels</a></li><li><a shape="rect" href="#Codingstandards-Example">Example</a></li></ul>
</li><li><a shape="rect" href="#Codingstandards-AbbreviationsandAcronymsinmethods/classes/interfaces'names">Abbreviations and Acronyms in methods/classes/interfaces' names</a></li><li><a shape="rect" href="#Codingstandards-GBeanattributeandreferencenamingconvention">GBean attribute and reference naming convention</a></li></ul>
</div>

<p>In addition, check the wiki for details on <a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDEV/developing-geronimo-in-eclipse.html">Developing Geronimo in Eclipse</a> and <a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDEV/subversion-client-configuration.html">Subversion Client Configuration</a>.</p>

<h2 id="Codingstandards-Indentation">Indentation</h2>

<h3 id="Codingstandards-Java">Java</h3>

<p>Lets follow Sun's coding standard rules which are pretty common in Java.</p>

<p><a shape="rect" class="external-link" href="http://java.sun.com/docs/codeconv/" rel="nofollow">http://java.sun.com/docs/codeconv/</a></p>

<p><a shape="rect" class="external-link" href="http://java.sun.com/docs/codeconv/html/CodeConvTOC.doc.html" rel="nofollow">http://java.sun.com/docs/codeconv/html/CodeConvTOC.doc.html</a></p>

<ul><li>4 characters indentation</li><li><strong>No tabs</strong> please!</li></ul>


<p>Correct brace style:</p>
<div class="code panel pdl" style="border-style: solid;border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
public class Foo {
    public void foo(boolean a, int x, int y, int z) {
        do {
            try {
                if (x &gt; 0) {
                    int someVariable = a ?  x : y;
                } else if (x &lt; 0) {
                    int someVariable = (y + z);
                    someVariable = x = x + y;
                } else {
                    for (int i = 0; i &lt; 5; i++) {
                        doSomething(i);
                    }
                }

                switch (a) {
                    case 0:
                        doCase0();
                        break;
                    default:
                        doDefault();
                }
            } catch (Exception e) {
                processException(e.getMessage(), x + y, z, a);
            } finally {
                processFinally();
            }
        } while (true);

        if (2 &lt; 3) {
            return;
        }

        if (3 &lt; 4) {
            return;
        }

        do {
            x++
        } while (x &lt; 10000);

        while (x &lt; 50000) {
            x++;
        }

        for (int i = 0; i &lt; 5; i++) {
            System.out.println(i);
        }
    }

    private class InnerClass implements I1, I2 {
        public void bar() throws E1, E2 {
        }
    }
}
]]></script>
</div></div>

<h3 id="Codingstandards-XML">XML</h3>

<ul><li>Use 4 characters.  This is to allow IDEs such as Eclipse to use a unified formatting convention</li><li><strong>No tabs</strong> please!</li></ul>


<h2 id="Codingstandards-Interfaces">Interfaces</h2>

<p>All methods of an interface are public abstract, therefore it is not necessary to specify public abstract modifiers. Similarly all fields are public static final.</p>

<p>However this behavior works best with most tools and IDEs and seems to be common practice so we see no reason to disallow this practice. e.g:</p>

<div class="code panel pdl" style="border-style: solid;border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
public interface MyInterface {
    public static final int MY_INTEGER = 0;

    public abstract void doSomething();
}
]]></script>
</div></div>

<p>This has the added advantage that the interface can be converted into an abstract class (and copy and paste individual definitions) without changing anything.</p>

<p>Preferably add public/static/final to constants, and public/abstract to methods, but it's not mandatory. However, if it's there, don't take it out.</p>

<h2 id="Codingstandards-Exceptions">Exceptions</h2>

<ul><li>A situation is only exceptional, if the program can not handle it with reasonably effort. Wrong input data should be an expected situation of the regular code, that could be handled gracefully.</li><li>The intention of exception-handling is to separate real error-handling from the regular part of the code, so don't force the caller to mix it with unnecessary exceptions.</li><li>Only if your code really has a problem to continue e.g., when a parameter is invalid, feel free to throw an exception!</li><li>Do NOT throw an exception, if you only suppose the caller of your code could have a problem with a special result. Try to return a special result value instead e.g., null, and let the caller decide with a regular if-else-statement. If the caller really has a problem, HE WILL throw an exception on his own.</li><li>But if your code throws an exception, even though it has no real problem and it could continue without an exception and return a special result value, you forestall the decision of the caller, whether the special result is really an error or not.</li><li>If you throw an exception, where the caller would decide that it is no error in the context of the caller, you force the caller to write an exception handler in his regular part or to abort i.e., you force the caller to mix regular code with exception handling. That is the opposite of the intentention of exception handling.</li><li>Bad example:<br clear="none">
<strong><code>java.lang.Class.forName(String) throws ClassNotFoundException</code></strong><br clear="none">
In most programs/situations it is an error if this method does not find the class, therefore it throws an exception and forestalls the decision of the caller.<br clear="none">
But maybe there is a program that should check a list of class names, whether the classes are present or not. Such a program is forced to mix its regular code with error handling of an exception, that is no error at all in that context. <br clear="none">
The method should return a special result value instead: null. Many callers of that method have expected that situation and therefore are not in an unexpected situation/exceptional state. They could decide the situation on their own.</li><li>Only throw checked exceptions (not derived from <code>RuntimeException</code>), if the caller has a chance to handle it.</li><li>Exceptions that signal programming errors or system failures usually cannot be handled/repaired at runtime -&gt; unchecked exception.</li><li>If your code really has a problem to continue e.g., when a parameter is invalid, throw an unchecked exception (derived from <code>RuntimeException</code>) and do NOT throw a checked exception, because if not even your code can handle the problem, in the very most cases the caller has no chance to handle the problem, too. Instead there maybe somebody somewhere in the highest layers who catches all <code>RuntimeException</code>'s, logs them and continues the regular service.</li><li>Only if it is not possible to return special result values cleanly, use checked exceptions to force the caller to decide the situation. The caller should deescalate the situation by catching and handling one or more checked exceptions, e.g. with special result values(?) or by escalating with an unchecked exception, because the situation is an error, that can not be handled.</li><li>Checked exceptions are an official part of the interface, therefore do not propagate checked exceptions from one abstraction layer to another, because usually this would break the lower abstraction. E.g. do not propagate SQLException to another layer, because SQLExceptions are an implementation detail, that may change in the future and such changes should not affect the interfaces and their callers.</li><li>Never throw <code>NullPointerException</code> or <code>RuntimeException</code>. Use either <code>IllegalArgumentException</code>, or <code>NullArgumentException</code> (which is a subclass of <code>IllegalArgumentException</code> anyway). If there isn't a suitable subclass available for representing an exception, create your own.</li></ul>


<h2 id="Codingstandards-PackageNaming">Package Naming</h2>

<ul><li>Package names are lowercase.</li><li>Package names should only contain alpha-numberic characters.</li><li>Package names should be suffixed with the name of the module in which they are defined</li></ul>


<p>For example, if the module name is <em>common</em>, then the base package name should be <code>org.apache.geronimo.common</code>.</p>

<p><strong>Note:</strong> This is more of a <em>guideline</em> than a <em>rule</em>, as some modules simply can not follow this convention, but where applicable they should.</p>

<h2 id="Codingstandards-Imports">Imports</h2>

<ul><li>Should be fully qualified e.g. <code>import java.util.Vector</code> and not <code>java.util.*</code></li><li>Should be sorted alphabetically, with <em>java</em>, then <em>javax</em> packages listed first, and then other packages sorted by package name.</li></ul>


<h3 id="Codingstandards-IDEAuto-Formatting">IDE Auto-Formatting</h3>

<ul><li>Eclipse users can</li><li>use <code>Source -&gt; Organise Imports</code> to organize imports</li><li>use <code>Source -&gt; Format</code> to format code (please make sure you are using spaces instead of tabs. See <a shape="rect" class="external-link" href="http://cwiki.apache.org/GMOxDEV/developing-geronimo-in-eclipse.html#DevelopingGeronimoinEclipse-CodeFormatting">Developing Geronimo in Eclipse</a> for details)</li><li>IntelliJ users can</li><li>use <code>Tools -&gt; Organise Imports</code> to organize imports</li><li>use <code>Tools -&gt; Reformat code</code> to format code (uses the code style setting in IDE options)</li></ul>


<h2 id="Codingstandards-JavaDocTags">JavaDoc Tags</h2>

<p> @version  Should be: <code>@version $Revision$ $Date$</code></p>

<p> @author  Should not be used in source code at all.</p>

<h2 id="Codingstandards-UnitTestCases">Unit Test Cases</h2>

<ul><li>Use the naming scheme <code>*Test.java</code> for unit tests.</li><li>Do not define <code>public static Test suite()</code> or constructor methods, the build system will automatically do the right thing without them.</li></ul>


<h2 id="Codingstandards-Logging">Logging</h2>

<ul><li>Log as much as necessary for someone to figure out what broke <img class="emoticon emoticon-smile" src="https://cwiki.apache.org/confluence/s/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/_/images/icons/emoticons/smile.png" data-emoticon-name="smile" alt="(smile)"></li><li>Use SLF4J <code>org.slf4j.Logger</code> rather than raw <em>Log4j</em> or <em>JCL</em></li><li>Do not log throwables that you throw - leave it to the caller</li><li>Use flags to avoid string concatenation for <em>debug</em> and <em>trace</em></li><li>Use SLF4J varargs {} expansion</li><li>Cache flags (especially for <em>trace</em>) to avoid excessive <code>isTraceEnabled()</code> calls</li></ul>


<h3 id="Codingstandards-Levels">Levels</h3>

<ul><li>Use <em>trace</em> level for detailed/diagnostic logging</li><li>Use <em>debug</em> level for things an application developer would need to know</li><li>Use <em>info</em> level for things an administrator would need to know</li><li>Use <em>warn</em> level for things indicating an application or transient problem</li><li>Use <em>error</em> level for things indicating a problem with the server itself</li></ul>


<h3 id="Codingstandards-Example">Example</h3>

<div class="code panel pdl" style="border-style: solid;border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
private final Logger log = LoggerFactory.getLogger(getClass());

public void doSomeStuff(Stuff stuff) throws StuffException {
    try {
        log.trace(&quot;About to do stuff: {}&quot;, stuff);
        stuff.doSomething();
        log.trace(&quot;Did some stuff&quot;);
    } catch (BadException e) {
        // don&#39;t log - leave it to caller
        throw new StuffException(&quot;Something bad happened&quot;, e);
    } catch (IgnorableException e) {
        // didn&#39;t cache this as we don&#39;t expect to come here a lot
        if (log.isDebugEnabled()) {
            log.debug(&quot;Ignoring problem doing stuff &quot; + stuff, e);
        }
    }
}
]]></script>
</div></div>

<h2 id="Codingstandards-AbbreviationsandAcronymsinmethods/classes/interfaces'names">Abbreviations and Acronyms in methods/classes/interfaces' names</h2>

<p>Abbreviations/acronyms are all written in capitals in methods/classes/interfaces' names.</p>

<div class="code panel pdl" style="border-style: solid;border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
public final class J2EELoader {

    public static EJBRef[] loadEJBRefs(Element parent) {
        //...
    }

}
]]></script>
</div></div>

<h2 id="Codingstandards-GBeanattributeandreferencenamingconvention">GBean attribute and reference naming convention</h2>

<p>The current convention is for attributes to follow Java variable naming conventions (i.e., lower case first character camel cased after) and for references to follow Java class naming conventions (i.e., capital first character camel cased after).</p></div>
        </div>

        
      </div>
    </div>

    <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tr>
          <td align="left" valign="middle" class="footer">
            &nbsp;&nbsp;
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="Delicious" />
            <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">Bookmark this on Delicious</a>
            &nbsp;&nbsp;
            <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="Digg!" />
            <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)+'&amp;topic=programming');">Digg this</a>
            <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo Development : Coding standards';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
            &nbsp;&nbsp;
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;-&nbsp;&nbsp;
            Copyright &#169; 2003-2011, The Apache Software Foundation, Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0.</a>&nbsp;&nbsp;
          </td>
        </tr>
    </table> 

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-4380560-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  </body>
</html>
