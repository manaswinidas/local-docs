<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link type="text/css" rel="stylesheet" href="http://geronimo.apache.org/style/default.css">
    <LINK rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <META name="Description" content="Integration Testing" />
    <META name="Keywords" content="Apache Geronimo development documentation Integration Testing" />
    <META name="Owner" content="dev@geronimo.apache.org" />
    <META name="Robots" content="index, follow" />
    <META name="Security" content="Public" />
    <META name="Source" content="wiki template" />
    <META name="DC.Date" scheme="iso8601" content="2009-01-06" />
    <META name="DC.Language" scheme="rfc1766" content="en" />
    <META name="DC.Rights" content="Copyright Â© 2003-2011, The Apache Software Foundation" />
    <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo Development : Integration Testing</title>

  </head>

  <body onload="init()">

    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tr>
        <td valing="top" align="left">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </table>

    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" align="left" nowrap>
          <a href="/geronimo"> Home</a> >&nbsp;<a href="index.html">Index</a>&nbsp;&gt;&nbsp;<a href="integration-testing.html">Integration Testing</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8" />
            <input type="hidden" name="oe" value="UTF-8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
        </td>
      </tr> 
    </table>

    <div id="PageContent">
      <div class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div style="margin: 0px 10px 0px 10px" class="smalltext">Apache Geronimo Development</div>
        <div style="margin: 0px 10px 8px 10px"  class="pagetitle">Integration Testing</div>

        <div class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
<!-- -->         
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=26297">
            <img src="http://geronimo.apache.org/images/icons/notep_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Edit Page"></a>
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=26297">Edit Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV">
            <img src="http://geronimo.apache.org/images/icons/browse_space.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Browse Space"></a>
            <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDEV">Browse Space</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=26297">
            <img src="http://geronimo.apache.org/images/icons/add_page_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add Page"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDEV&fromPageId=26297">Add Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=26297">
            <img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add News"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDEV&fromPageId=26297">Add News</a>
<!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><div class="confluence-information-macro confluence-information-macro-warning"><p class="title">Stale Content</p><span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>The content of this page is growing stale and may or may not contain relevant, useful or correct information.</p></div></div>

<div class="toc-macro client-side-toc-macro" data-headerelements="H1,H2,H3,H4,H5,H6,H7"></div>

<h1 id="IntegrationTesting-Objective">Objective</h1>

<p>We have tests at the module level tests perform basic unit testing of the code in each module. We then have TCK tests that ensure Geronimo's compliance with the J2EE spec.&#160;&#160;Now the integration tests introduces a level of testing that falls beyond the scope of the unit tests or the TCK tests.&#160;It&#160;performs system level tests of features and functionalities that Geronimo provides to the end users. Since Geronimo is an integration platform for the various open source technologies, this integration tests verifies and ensures such a succesful aggregation.</p>

<p>The integration test is designed to be run after the assemblies are built but as a part of the same build process. So a quick run through the integration tests will also ensure and certify a "really" successful build. The integration test can also run standalone against a previously assembled Geronimo&#160;archive (for now, *.zip only).</p>

<h1 id="IntegrationTesting-Gettingstarted">Getting started</h1>

<p>Checkout or update the trunk.<br clear="none">
Build it top down (until we have all the 2.0-SNAPSHOT artifacts published)</p>

<p><strong>Creating an archetype (template) testsuite</strong></p>
<div class="code panel pdl" style="border-style: solid;border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;border-bottom-style: solid;"><b>command</b></div><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
$&gt;cd geronimo/testsuite
$&gt;mvn archetype:create \
    -DarchetypeGroupId=org.apache.geronimo.plugins \
    -DarchetypeArtifactId=geronimo-archetype-testsuite \
    -DarchetypeVersion=2.0-SNAPSHOT \
    -DartifactId=newFunc-testsuite \
    -Dversion=2.0-SNAPSHOT
]]></script>
</div></div>
<p>You should now have a template testsuite named <em>newFunc-testsuite</em> under your geronimo/testsuite directory.<br clear="none">
This maven project is wholly self-sufficient. It starts and stops the server. It does not have any tests to run yet. It even has surefire reports for the server start/stop executions.</p>

<p><strong>Modifying the template to suit your function tests</strong></p>
<ol><li>Change the <em>newFunc-testsuite</em>/<em>testset-1</em> directory name to reflect your testset name (say, <em>basic-testset</em>).</li><li>Edit the <em>newFunc-testsuite</em>/<em>basic-testset</em>/pom.xml and replace the &lt;artifactId&gt; element value to match the new directory name.</li><li>Populate <em>newFunc-testsuite</em>/<em>basic-testset</em> project with your tests. Any executions in the <em>basic-testset</em>/pom.xml will have to be inside a profile whose id is "child".</li></ol>


<p><strong>NOTE</strong> Steps 1 &amp; 2 above can be skipped. But there is a possibility that this artifactId will conflict with another artifactId created similarly from archetype. Hence it is recommended.</p>

<p><strong>Running tests</strong></p>
<div class="code panel pdl" style="border-style: solid;border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;border-bottom-style: solid;"><b>command</b></div><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
$&gt;cd geronimo/testsuite
$&gt;mvn [-DinstallDirectory=/path/to/geronimoHome]
]]></script>
</div></div>
<p>Maven will run through all the testsuites. For every testsuite, it will invoke all the testsets under it. By the time it is done, it should have created surefire xmls in every target/surefire-reports directory.</p>

<p>Using the -DinstallDirectory parameter will install Geronimo in one location and the same server instance will be used for each <em>foo-testsuite</em>. The server will be started/stopped for each of them too. The default is for every <em>foo-testsuite</em> to have it's own installation of the server in it's target directory. All testsets under it will use this same instance of the running server.</p>

<p>You may go to any single testsuite and execute 'mvn' from it to run only it's tests.</p>

<p><strong>Viewing test results</strong></p>
<div class="code panel pdl" style="border-style: solid;border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;border-bottom-style: solid;"><b>command</b></div><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
$&gt;cd geronimo/testsuite
$&gt;mvn site-deploy -DbuildNumber=&lt;a timestamp&gt;
]]></script>
</div></div>
<p>This will generate a website for the entire testsuite and deploy it to a site under geronimo.apache.org. See the summary of the results <a shape="rect" class="external-link" href="http://geronimo.apache.org/maven/server/testsuite/ResultsSummary.html">here</a>.</p>

<h1 id="IntegrationTesting-Framework">Framework</h1>

<p>The integration test is part of the regular geronimo tree and it resides under <em>geronimo/testsuite</em>. The child modules under this pom.xml are organized into various functional categories of the server. For eg., console-testsuite will perform tests on the console while the web-testsuites will perform tests against the web container.</p>

<p>&#160;<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="integration-testing.data/testsuite-framework.jpg" data-image-src="/confluence/download/attachments/26297/testsuite-framework.jpg?version=2&amp;modificationDate=1163934091000&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="2487" data-linked-resource-version="2" data-linked-resource-type="attachment" data-linked-resource-default-alias="testsuite-framework.jpg" data-base-url="https://cwiki.apache.org/confluence" data-linked-resource-content-type="image/pjpeg" data-linked-resource-container-id="26297" data-linked-resource-container-version="35"></span></p>

<p>Each <em>foo-testsuite</em> will contain another set of child modules that will actually perform the&#160;tests. Also each <em>foo-testsuite</em> will&#160;perform the following basic steps</p>
<ul><li>installing the server.</li><li>starting it.</li><li>invoking the tests under <em>testset-</em><em>n.</em></li><li>stopping the server.</li><li>creating surefire-reports for the tests in this suite.</li></ul>


<h1 id="IntegrationTesting-Pluginssupport.">Plugins support.</h1>

<ul><li><a shape="rect" href="#IntegrationTesting-geronimo-maven-plugin">#geronimo-maven-plugin</a>: install/start/stop server. deploy/undeploy modules</li><li><a shape="rect" href="#IntegrationTesting-selenium-maven-plugin">#selenium-maven-plugin</a>: start selenium server</li><li><a shape="rect" href="#IntegrationTesting-maven-maven-plugin">#maven-maven-plugin</a>: invoke <em>testset-n</em>/pom.xml and run the tests.</li><li><a shape="rect" href="#IntegrationTesting-testsuite-maven-plugin">#testsuite-maven-plugin</a>: generate surefire-report.html for <em>foo-testsuite</em></li></ul>


<p><span class="confluence-anchor-link" id="IntegrationTesting-geronimo-maven-plugin"></span></p>

<h2 id="IntegrationTesting-geronimo-maven-plugin">geronimo-maven-plugin</h2>

<p><a shape="rect" class="external-link" href="http://geronimo.apache.org/maven/server/maven-plugins/geronimo-maven-plugin/index.html">http://geronimo.apache.org/maven/server/maven-plugins/geronimo-maven-plugin/index.html</a></p>

<p>The goals to install/start/stop&#160;the server and deploy/undeploy modules are provided by the <strong>geronimo-maven-plugin</strong>. It has configuration option to either install a separate Geronimo server for each <em>foo-testsuite</em> or reuse one instance of the server installation. It also has configuration option to log the results for the purpose of generating surefire reports xml.&#160;The goals from this plugin are invoked by the pre-integration-test and post-integration-test phase of the Maven lifecycle appropriately.</p>

<p>A set of modules are provided for testing purposes. They are in the <em>geronimo/testsupport</em> directory. This pom.xml gets built during the beginning of the build cycle and provides various j2ee archives for use by the testsuite.</p>

<p>See deployment-testsuite for an example</p>

<p><span class="confluence-anchor-link" id="IntegrationTesting-selenium-maven-plugin"></span></p>

<h2 id="IntegrationTesting-selenium-maven-plugin">selenium-maven-plugin</h2>

<p><a shape="rect" class="external-link" href="http://geronimo.apache.org/maven/server/maven-plugins/selenium-maven-plugin/index.html">http://geronimo.apache.org/maven/server/maven-plugins/selenium-maven-plugin/index.html</a></p>

<p>The console-testsuite under geronimo/testsuite tests the console using Selenium (<a shape="rect" class="external-link" href="http://openqa.org/" rel="nofollow">http://openqa.org</a>).&#160; This requires a special server process started which is provided by our <strong>selenium-maven-plugin</strong>.&#160;&#160;</p>

<p>See console-testsuite for an example</p>

<p><span class="confluence-anchor-link" id="IntegrationTesting-maven-maven-plugin"></span></p>

<h2 id="IntegrationTesting-maven-maven-plugin">maven-maven-plugin</h2>

<p><a shape="rect" class="external-link" href="http://geronimo.apache.org/maven/genesis/plugins/maven-maven-plugin/index.html">http://geronimo.apache.org/maven/genesis/plugins/maven-maven-plugin/index.html</a></p>

<p>This plugin invokes each of the <em>testset-n</em>/pom.xml in the integration-test phase of the maven lifecycle. The testcases are defined in those projects. The tests can be either junit or <a shape="rect" class="external-link" href="http://www.testng.org/" rel="nofollow">testng</a> testcases. <strong>maven-surefire-plugin</strong> is configured to skip the tests during the test phase and run in the integration-test phase. surefire-report xmls are generated after the tests.</p>

<p><span class="confluence-anchor-link" id="IntegrationTesting-testsuite-maven-plugin"></span></p>

<h2 id="IntegrationTesting-testsuite-maven-plugin">testsuite-maven-plugin</h2>

<p><a shape="rect" class="external-link" href="http://geronimo.apache.org/maven/server/maven-plugins/testsuite-maven-plugin/index.html">http://geronimo.apache.org/maven/server/maven-plugins/testsuite-maven-plugin/index.html</a></p>

<p>Maven does not generate&#160;surefire-reports for pom packagings. <em>foo-testsuite</em> is a pom packaging with executions in pre-integration-test and post-integration-test phases. The results of those tests will not be captured by Maven. Also, the surefire reports from the <em>testset</em>-n projects should be rolled up into it's parent foo-testsuite. This is done by generate-surefire-xml goal in the testsuite-maven-plugin. Another goal, generate-surefire-report will generate the surefire-report.html from those surefire&#160;xmls. Finaly fix-menu goal will fix the menu for this html file.</p></div>
        </div>

        
      </div>
    </div>

    <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tr>
          <td align="left" valign="middle" class="footer">
            &nbsp;&nbsp;
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="Delicious" />
            <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">Bookmark this on Delicious</a>
            &nbsp;&nbsp;
            <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="Digg!" />
            <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)+'&amp;topic=programming');">Digg this</a>
            <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo Development : Integration Testing';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
            &nbsp;&nbsp;
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;-&nbsp;&nbsp;
            Copyright &#169; 2003-2011, The Apache Software Foundation, Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0.</a>&nbsp;&nbsp;
          </td>
        </tr>
    </table> 

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-4380560-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  </body>
</html>
