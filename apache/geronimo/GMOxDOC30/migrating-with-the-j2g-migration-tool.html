<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link type="text/css" rel="stylesheet" href="http://geronimo.apache.org/style/default.css">
    <LINK rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <META name="Description" content="Migrating with the J2G Migration Tool" />
    <META name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Migrating with the J2G Migration Tool" />
    <META name="Owner" content="dev@geronimo.apache.org" />
    <META name="Robots" content="index, follow" />
    <META name="Security" content="Public" />
    <META name="Source" content="wiki template" />
    <META name="DC.Date" scheme="iso8601" content="2010-05-11" />
    <META name="DC.Language" scheme="rfc1766" content="en" />
    <META name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation" />
    <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0 Documentation: Migrating with the J2G Migration Tool</title>
  </head>

  <body onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tr>
        <td valing="top" align="left">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" align="left" nowrap>
          <a href="/geronimo"> Home</a> >&nbsp;<a href="documentation.html">Documentation</a>&nbsp;&gt;&nbsp;<a href="migrating-to-apache-geronimo.html">Migrating to Apache Geronimo</a>&nbsp;&gt;&nbsp;<a href="migrating-from-jboss-to-geronimo.html">Migrating from JBoss to Geronimo</a>&nbsp;&gt;&nbsp;<a href="migrating-with-the-j2g-migration-tool.html">Migrating with the J2G Migration Tool</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8" />
            <input type="hidden" name="oe" value="UTF-8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
        </td>
      </tr> 
    </table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div style="margin: 0px 10px 0px 10px" class="smalltext">Apache Geronimo v3.0</div>
        <div style="margin: 0px 10px 8px 10px"  class="pagetitle">Migrating with the J2G Migration Tool</div>

        <div class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
<!-- -->         
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645278">
            <img src="http://geronimo.apache.org/images/icons/notep_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Edit Page"></a>
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645278">Edit Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">
            <img src="http://geronimo.apache.org/images/icons/browse_space.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Browse Space"></a>
            <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">Browse Space</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645278">
            <img src="http://geronimo.apache.org/images/icons/add_page_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add Page"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645278">Add Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645278">
            <img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add News"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645278">Add News</a>
<!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>
<parameter ac:name="indent">20px</parameter><parameter ac:name="style">disc</parameter>

<h1 id="MigratingwiththeJ2GMigrationTool-Overview">Overview</h1>
<p>JBoss to Geronimo (J2G) is a tool set built as Eclipse SDK plug-ins designed to assist in migrating the sources of an application written for the JBoss application server or written for Java 2 Enterprise Edition (J2EE) to the Apache Geronimo platform.</p>

<h1 id="MigratingwiththeJ2GMigrationTool-Downloading">Downloading</h1>
<p>For information on downloading J2G, visit the <a shape="rect" class="external-link" href="http://geronimo.apache.org/development-tools.html">Geronimo Development Tools</a> page.<br clear="none">
For information on building J2G from source visit <a shape="rect" href="building-j2g-from-source.html">Building J2G from source</a>.</p>

<h1 id="MigratingwiththeJ2GMigrationTool-Components">Components</h1>

<p>J2G consists of three executable utilities with basic Eclipse IDE UI extensions. The "Configurator" component, and the three major components, each of which have relatively specific functions, and must be run in the order as follows.</p>

<h2 id="MigratingwiththeJ2GMigrationTool-Dependencies">Dependencies</h2>

<p>The J2G tool set requires at least the following application versions<br clear="none">
(these are the versions J2G is known to work on)</p>
<ul><li>Sun JDK 5.0+ (J2SE 1.5)</li><li>Eclipse SDK 3.3M7 with JDT Core Plug-in</li><li>Apache Geronimo 1.1.1 and up</li><li>Application written for JBoss 3.2 and up or J2EE 1.2 and up.</li></ul>


<h3 id="MigratingwiththeJ2GMigrationTool-EnvironmentVariables">Environment Variables</h3>

<p>The tools in J2G require that the following environment variables be set to the proper locations:</p>
<ul><li>JAVA_HOME (Location of the JDK)</li><li>ECLIPSE_HOME (Location of the Eclipse SDK)</li><li>WORKSPACE (Location for a temporary eclipse workspace)</li></ul>


<h2 id="MigratingwiththeJ2GMigrationTool-Configurator">Configurator</h2>

<p>To run this component, navigate to bin, and run j2g-configure</p>
<parameter ac:name="borderStyle">solid</parameter><plain-text-body>
user@lappy-486:~/j2g$ cd bin
user@lappy-486:~/j2g/bin$ ./j2g-configure.sh

Copying J2G plugins to /home/user/.m2/repository/eclipse/eclipse/plugins/ ...

`../plugins/org.apache.geronimo.j2g.common_1.0.0-SNAPSHOT.jar' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.common_1.0.0-SNAPSHOT.jar'
`../plugins/org.apache.geronimo.j2g.descriptors_1.0.0-SNAPSHOT.jar' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.descriptors_1.0.0-SNAPSHOT.jar'
`../plugins/org.apache.geronimo.j2g.jasper_1.0.0-SNAPSHOT.jar' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.jasper_1.0.0-SNAPSHOT.jar'
`../plugins/org.apache.geronimo.j2g.resources_1.0.0-SNAPSHOT.jar' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.resources_1.0.0-SNAPSHOT.jar'
`../plugins/org.apache.geronimo.j2g.sources_1.0.0-SNAPSHOT.jar' -&gt;
/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.sources_1.0.0-SNAPSHOT.jar'
`../plugins/org.apache.geronimo.j2g.util_1.0.0-SNAPSHOT.jar' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.util_1.0.0-SNAPSHOT.jar'
`../properties/org.apache.geronimo.j2g.descriptors.ejb/persistence_differences.properties' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.descriptors.ejb/persistence_differences.properties'
`../properties/org.apache.geronimo.j2g.descriptors.ejb.annotation/annotation_differences.properties' -&gt;
/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.descriptors.ejb.annotation/annotation_differences.properties'
`../properties/org.apache.geronimo.j2g.sources.dependence/default_jars.properties' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.sources.dependence/default_jars.properties'
`../properties/org.apache.geronimo.j2g.sources.dependence/class_analogies.properties' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.sources.dependence/class_analogies.properties'
`../properties/org.apache.geronimo.j2g.sources.dependence/compatible_sources.properties' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.sources.dependence/compatible_sources.properties'
`../properties/org.apache.geronimo.j2g.sources.environment/beans-types.properties' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.sources.environment/beans-types.properties'
`../properties/org.apache.geronimo.j2g.sources.environment/beans-interfaces.properties' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.sources.environment/beans-interfaces.properties'
`../properties/org.apache.geronimo.j2g.sources.environment/beans-references.properties' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.sources.environment/beans-references.properties'
`../compatibility/org.apache.geronimo.j2g.sources.dependence.compatibility/DigestCallback.java' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.sources.dependence.compatibility/DigestCallback.java'
`../compatibility/org.apache.geronimo.j2g.sources.dependence.compatibility/GeronimoLoginModule.java' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.sources.dependence.compatibility/GeronimoLoginModule.java'
`../compatibility/org.apache.geronimo.j2g.sources.dependence.compatibility/PasswordHasher.java' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.sources.dependence.compatibility/PasswordHasher.java'
`../compatibility/org.apache.geronimo.j2g.sources.dependence.compatibility/Nobody.java' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.sources.dependence.compatibility/Nobody.java'
`../compatibility/org.apache.geronimo.j2g.sources.dependence.compatibility/GeronimoSimpleGroup.java' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.sources.dependence.compatibility/GeronimoSimpleGroup.java'
`../compatibility/org.apache.geronimo.j2g.sources.dependence.compatibility/Anybody.java' -&gt;
`/home/user/.m2/repository/eclipse/eclipse/plugins/org.apache.geronimo.j2g.sources.dependence.compatibility/Anybody.java'

A backup of your configuration file has been written to /home/user/.m2/repository/eclipse/eclipse/configuration/config.bak

Configuration complete.
user@lappy-486:~/j2g/bin$
</plain-text-body>
<p>This will automatically copy the contents of the ./plugins, ./properties, and ./compatibility directories to ECLIPSE_HOME/plugins, as well as make changes to (or create, if necessary) ECLIPSE_HOME/configuration/config.ini.</p>

<h2 id="MigratingwiththeJ2GMigrationTool-SourceIdentificationToolSummary">Source Identification Tool Summary</h2>

<p>This tool parses through source code (.java and .jsp files) recursively in directories passed to it as command line arguments. While doing this, it replaces any JBoss classes and dependencies for which there are Geronimo equivalents. If there is no equivalent, it will alert the user of this issue which must be resolved either through manual creation of a replacement class or rewriting the segment of code dependent on the JBoss class.</p>

<h2 id="MigratingwiththeJ2GMigrationTool-DescriptorsConversionToolSummary">Descriptors Conversion Tool Summary</h2>

<p>This tool converts JBoss specific deployment descriptors and J2EE standard deployment descriptors (if necessary) to their Geronimo equivalents.</p>

<h2 id="MigratingwiththeJ2GMigrationTool-ResourceConversionToolSummary">Resource Conversion Tool Summary</h2>

<p>This tool converts JBoss specific resources, such as Java Messaging Services (JMS) Queues, JMS Topics, Java Database Connectivity (JDBC) data sources to their Geronimo equivalents.</p>

<h1 id="MigratingwiththeJ2GMigrationTool-SourceIdentificationTool">Source Identification Tool</h1>

<rich-text-body>
<p>It is <strong>strongly advised</strong> to create a backup of the application source before running J2G</p></rich-text-body>

<h2 id="MigratingwiththeJ2GMigrationTool-Description">Description</h2>

<p>The Source Identification Tool should be started first. It scans the sources and identifies files that need to be changed during the migration process. These files include Java classes (.java files), JSPs (.jsp files), as well as files with an overridden JSP file extension, specified with the argument -jspext. (For example: -jspext html for .html files)</p>

<p>In these files, the tool checks for:</p>
<ul><li>Use of APIs incompatible with Geronimo (e.g. JBoss internal APIs);</li><li>Violation of J2EE naming principles.</li></ul>


<p>When the tool checks for usage of APIs incompatible with Geronimo, these JBoss classes are automatically replaced with Geronimo compatible classes</p>
<div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p> JBoss Class </p></th><th colspan="1" rowspan="1" class="confluenceTh"><p> Geronimo Compatible Class </p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> org.jboss.security.SimplePrincipal </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> org.apache.geronimo.security.realm.providers.GeronimoUserPrincipal </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> org.jboss.security.auth.spi.DigestCallback </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> org.apache.geronimo.j2g.sources.dependence.compatibility.DigestCallback </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> org.jboss.security.Nobody </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> org.apache.geronimo.j2g.sources.dependence.compatibility.Nobody </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> org.jboss.security.Anybody </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> org.apache.geronimo.j2g.sources.dependence.compatibility.Anybody </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> org.jboss.security.auth.spi.UsernamePasswordLoginModule </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> org.apache.geronimo.j2g.sources.dependence.compatibility.GeronimoLoginModule </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> org.jboss.security.SimpleGroup </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> org.apache.geronimo.j2g.sources.dependence.compatibility.GeronimoSimpleGroup </p></td></tr></tbody></table></div>

<p>Any references beyond the table above must be manually corrected so that they are no longer dependent on parts of JBoss. It's important to note that JSP file processing is limited to the identification of problems, and automatic correction is not currently supported.</p>

<p>When the tool validates J2EE naming it detects cases in which a component (a class or JSP) refers to a named object that is not a part of the application being converted (For example: a data source, JMS, or Email provider reference). In simple cases, when a component requests an external resource with a direct, full path and does not have any environment reference, the tool tries to fix this problem automatically by adding the resource reference to the component's deployment descriptor and replaces the direct path with the name of the added reference.</p>

<p>When a source file is changed automatically by the Source Identification Tool, the original version is saved with the .j2g extension and an informational message is printed out. In all other cases, when a problem needs to be fixed manually, the tool simply prints a warning message.</p>

<h3 id="MigratingwiththeJ2GMigrationTool-Specifyingadditionalclasses">Specifying additional classes</h3>

<p>Additional drop-in replacements for JBoss specific classes can be user-defined by modifying <strong>&lt;ECLIPSE_HOME&gt;/plugins/org.apache.geronimo.j2g.sources.dependence/class_analogies.properties</strong> to include the proper relationship, as well as <strong>&lt;ECLIPSE_HOME&gt;/plugins/org.apache.geronimo.j2g.sources.dependence/compatible_sources.properties</strong> to include the class name. The source code for these replacement classes must be placed in the directory <strong>&lt;ECLIPSE_HOME&gt;/plugins/org.apache.geronimo.j2g.sources.dependence.compatibility</strong> for proper inclusion.</p>

<p>Classes that already exist within Geronimo jars can also be added into the class-analogies.properties file.  These classes do not need to be placed within the compatibility directory but a dependency will have to be added to the corresponding xml in the converted application.</p>

<p>Below is an example of the default class_analogies.properties file</p>
<parameter ac:name="">xml</parameter><parameter ac:name="title">class_analogies.properties</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
#
#  Licensed to the Apache Software Foundation (ASF) under one or more
#  contributor license agreements.  See the NOTICE file distributed with
#  this work for additional information regarding copyright ownership.
#  The ASF licenses this file to You under the Apache License, Version 2.0
#  (the "License"); you may not use this file except in compliance with
#  the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#
###########################################################################################################
# Jboss classes and it's analogies.
###########################################################################################################
org.jboss.security.SimplePrincipal = org.apache.geronimo.security.realm.providers.GeronimoUserPrincipal
org.jboss.security.auth.spi.DigestCallback = org.apache.geronimo.j2g.sources.dependence.compatibility.DigestCallback
org.jboss.security.Nobody = org.apache.geronimo.j2g.sources.dependence.compatibility.Nobody
org.jboss.security.Anybody = org.apache.geronimo.j2g.sources.dependence.compatibility.Anybody
org.jboss.security.auth.spi.UsernamePasswordLoginModule = org.apache.geronimo.j2g.sources.dependence.compatibility.GeronimoLoginModule
org.jboss.security.SimpleGroup = org.apache.geronimo.j2g.sources.dependence.compatibility.GeronimoSimpleGroup
</plain-text-body>
<p>Below is an example of the default compatible_sources.properties file</p>
<parameter ac:name="">xml</parameter><parameter ac:name="title">compatible_sources.properties</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
#
#  Licensed to the Apache Software Foundation (ASF) under one or more
#  contributor license agreements.  See the NOTICE file distributed with
#  this work for additional information regarding copyright ownership.
#  The ASF licenses this file to You under the Apache License, Version 2.0
#  (the "License"); you may not use this file except in compliance with
#  the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#
######################################################################
# List of compatibility sources
######################################################################
org.apache.geronimo.j2g.sources.dependence.compatibility.DigestCallback
org.apache.geronimo.j2g.sources.dependence.compatibility.Nobody
org.apache.geronimo.j2g.sources.dependence.compatibility.Anybody
org.apache.geronimo.j2g.sources.dependence.compatibility.GeronimoLoginModule
org.apache.geronimo.j2g.sources.dependence.compatibility.GeronimoSimpleGroup
org.apache.geronimo.j2g.sources.dependence.compatibility.PasswordHasher
</plain-text-body>

<h2 id="MigratingwiththeJ2GMigrationTool-RunningtheSourceIdentificationTool-EclipseGUI">Running the Source Identification Tool - Eclipse GUI</h2>

<p>To run this component within the Eclipse IDE GUI, the left panel must first be in Navigator view.</p>

<p>Once in the Navigator view, it is possible to right click and select J2G Migration from the context menu.<br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="migrating-with-the-j2g-migration-tool.data/menu.png"></span></p>

<p>Within the J2G Migration sub menu, select "1. Source Identification Tool (jsrc2g)", and follow the prompts given.</p>

<p>Output will be displayed in the bottom portion of the Eclipse IDE, within the integrated Console window.<br clear="none">
<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="migrating-with-the-j2g-migration-tool.data/output.png"></span></p>

<h2 id="MigratingwiththeJ2GMigrationTool-RunningtheSourceIdentificationTool-CommandLine">Running the Source Identification Tool - Command Line</h2>

<p>To run this component, execute the following command from the j2g bin directory, with &lt;APPLICATION&gt; representing the path to the application you are converting, and &lt;GERONIMO_HOME&gt; representing the path to Geronimo 2.0.</p>

<p>*<strong>nix</strong></p>
<parameter ac:name="borderStyle">solid</parameter><plain-text-body>
./jsrc2g.sh -src &lt;APPLICATION&gt;/src -web &lt;APPLICATION&gt;/web -geronimo &lt;GERONIMO_HOME&gt;
</plain-text-body>
<p><strong>Windows</strong></p>
<parameter ac:name="borderStyle">solid</parameter><plain-text-body>
jsrc2g.bat -src &lt;APPLICATION&gt;\src -web &lt;APPLICATION&gt;\web -geronimo &lt;GERONIMO_HOME&gt;
</plain-text-body>
<p>Note: To specify multiple sources for conversion, simply separate them with ,s (commas), as follows.</p>
<parameter ac:name="borderStyle">solid</parameter><plain-text-body>
jsrc2g.cmd -src &lt;APPLICATION&gt;/src,&lt;APPLICATION&gt;/src2,...&lt;APPLICATION&gt;/srcn -web &lt;APPLICATION&gt;/web -geronimo &lt;GERONIMO_HOME&gt;
</plain-text-body>
<p>After the tool runs (which may take a few seconds, depending on system speed and the complexity of the application), it will display all warnings and errors to console output. These messages should be interpreted and corrected as seen fit by the user. Once changes have been made, the sources tool can be ran again to verify correctness.</p>

<h1 id="MigratingwiththeJ2GMigrationTool-DescriptorsConversionTool">Descriptors Conversion Tool</h1>


<h2 id="MigratingwiththeJ2GMigrationTool-Description.1">Description</h2>

<p>The Descriptors Conversion Tool finds and tries to automatically convert the following deployment descriptors so that they are accepted by Geronimo:</p>
<div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p> Filename </p></th><th colspan="1" rowspan="1" class="confluenceTh"><p> Purpose </p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> application.xml </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> J2EE application deployment descriptor </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> jboss-app.xml </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> JBoss specific descriptor for elements such as security domain, class loader configuration as well as some others </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> web.xml </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> Web application descriptor </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> jboss-web.xml </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> JBoss specific descriptor for elements such as security roles, session settings, web service configuration. It is used to integrate a web application into JBoss deployment </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> ejb-jar.xml </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> EJB deployment descriptor </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> jboss.xml </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> JBoss descriptor providing any optional information like custom container configurations for the beans or JNDI names. It is used by JBoss but not described in the respective ejb-jar.xml </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> jbosscmp-jdbc.xml </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> JBossCMP-JDBC configuration file describing CMP-Database mappings, and key generation information </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> standardjbosscmp-jdbc.xml </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> Default JBossCMP-JDBC configuration file </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> persistence.xml </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> Datasource connection configuration file </p></td></tr></tbody></table></div>

<p>Note: Geronimo uses OpenEJB, which requires its own descriptor (openejb-jar.xml). There may be some instances where a jboss.xml is not given. In these cases, the openejb-jar.xml will be created on the top-most level directory in the source path that is specified to J2G.</p>

<h3 id="MigratingwiththeJ2GMigrationTool-Annotations(forEJB3.0)">Annotations (for EJB 3.0)</h3>

<p>The standard EJB annotations are supported by both Geronimo and JBoss. There are differences, however, in the attributes provided in some of the annotations.<br clear="none">
Below is a list of all standard attribute differences provided that may occur within the specified annotations.</p>
<div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p> Annotation </p></th><th colspan="1" rowspan="1" class="confluenceTh"><p> JBoss Attribute </p></th><th colspan="1" rowspan="1" class="confluenceTh"><p> Geronimo Attribute </p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> Resource </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> mappedName </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> name </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> EJB </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> mappedName </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> name </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> MessageDriven </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> mappedName </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> name </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> Stateful </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> mappedName </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> name </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> Stateless </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> mappedName </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> name </p></td></tr></tbody></table></div>

<p>Any references beyond the table above must be manually corrected so that they are no longer dependent on parts of JBoss.</p>
<rich-text-body>
<p>JBoss has their own EJB annotation extensions. These must be manually corrected as needed</p></rich-text-body>

<h3 id="MigratingwiththeJ2GMigrationTool-Specifyingadditionalannotations">Specifying additional annotations</h3>

<p>Additional drop-in replacements for JBoss specific annotation attributes can be user-defined by modifying <strong>&lt;ECLIPSE_HOME&gt;/plugins/org.apache.geronimo.j2g.descriptors.ejb.annotation/annotation_differences.properties</strong> to include the proper relationship. Because the nature of these mappings are not one-to-one, we cannot format the properties in the traditional format of <em>&lt;annotation&gt;=&lt;attribute&gt;</em>. Instead, the proper formatting is as follows:</p>

<p>In the case of a standard EJB annotation</p>
<parameter ac:name="">xml</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
&lt;property&gt; :: &lt;annotation&gt;=&lt;mapping&gt;
</plain-text-body>
<p>Where <strong>&lt;annotation&gt;</strong> is a standard EJB annotation</p>

<p>In the case of a standard jBoss specific to Geronimo compatible relationship</p>
<parameter ac:name="">xml</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
&lt;mapping&gt; :: &lt;j_attribute&gt;--&gt;&lt;g_attribute&gt;
</plain-text-body>
<p>Where <strong>&lt;j_attribute&gt;</strong> is a JBoss supported attribute and <strong>&lt;g_attribute&gt;</strong> is a Geronimo supported attribute</p>

<p>Finally, in the case of needing multiple attribute mappings for a single annotation</p>
<parameter ac:name="">xml</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
&lt;mapping&gt; :: &lt;j_attribute&gt;--&gt;&lt;g_attribute&gt;,&lt;mapping&gt;
</plain-text-body>
<p>Where <strong>&lt;j_attribute&gt;</strong> is a JBoss supported attribute and <strong>&lt;g_attribute&gt;</strong> is a Geronimo supported attribute</p>

<p>Below is an example of the default annotation_differences.properties file</p>
<parameter ac:name="">xml</parameter><parameter ac:name="title">annotation_differences.properties</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
#
#  Licensed to the Apache Software Foundation (ASF) under one or more
#  contributor license agreements.  See the NOTICE file distributed with
#  this work for additional information regarding copyright ownership.
#  The ASF licenses this file to You under the Apache License, Version 2.0
#  (the "License"); you may not use this file except in compliance with
#  the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#
###########################################################################
# Jboss classes and it's analogies.
###########################################################################
Resource = mappedName--&gt;name
EJB = mappedName--&gt;name
MessageDriven = mappedName--&gt;name
Stateful = mappedName--&gt;name
Stateless = mappedName--&gt;name
</plain-text-body>

<h3 id="MigratingwiththeJ2GMigrationTool-OpenEJB">OpenEJB</h3>

<p>When the tool checks for usage of EJB references incompatible with Geronimo, these JBoss EJB references are automatically replaced with Geronimo compatible OpenEJB references. Here is are the differences specified to change in the persistence.xml (used in EJB 3.0) so that the configurations are consistent.</p>
<div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p> JBoss EJB </p></th><th colspan="1" rowspan="1" class="confluenceTh"><p> Geronimo OpenEJB </p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> hibernate.connection.url </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> openjpa.ConnectionURL </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> hibernate.connection.driver_class </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> openjpa.ConnectionDriverName </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> hibernate.connection.password </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> openjpa.ConnectionPassword </p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p> hibernate.connection.username </p></td><td colspan="1" rowspan="1" class="confluenceTd"><p> openjpa.ConnectionUserName </p></td></tr></tbody></table></div>

<p>Any references beyond the table above must be manually corrected so that they are no longer dependent on parts of JBoss.</p>

<h3 id="MigratingwiththeJ2GMigrationTool-SpecifyingadditionalOpenEJBassociationsforpersistence.xml">Specifying additional OpenEJB associations for persistence.xml</h3>

<p>Additional drop-in replacements for JBoss specific annotations can be user-defined by modifying <strong>&lt;ECLIPSE_HOME&gt;/plugins/org.apache.geronimo.j2g.descriptors.ejb/persistence_differences.properties</strong> to include the proper relationship</p>

<p>Below is an example of the default persistence_differences.properties file</p>
<parameter ac:name="">xml</parameter><parameter ac:name="title">persistence_differences.properties</parameter><parameter ac:name="borderStyle">solid</parameter><plain-text-body>
#
#  Licensed to the Apache Software Foundation (ASF) under one or more
#  contributor license agreements.  See the NOTICE file distributed with
#  this work for additional information regarding copyright ownership.
#  The ASF licenses this file to You under the Apache License, Version 2.0
#  (the "License"); you may not use this file except in compliance with
#  the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#
###########################################################################
# Jboss persistence.xml property names and its analogies.
###########################################################################
hibernate.connection.url = openjpa.ConnectionURL
hibernate.connection.driver_class = openjpa.ConnectionDriverName
hibernate.connection.password = openjpa.ConnectionPassword
hibernate.connection.username = openjpa.ConnectionUserName
hibernate.hbm2ddl.auto = suggestion:openjpa.jdbc.SynchronizeMappings
</plain-text-body>
<p>In order to just suggest to the user that X may be a replacement for Y (this is conditional because this is not a direct translation) the property can be written as <strong>&lt;Y&gt; = suggestion:&lt;X&gt;</strong>.</p>

<h2 id="MigratingwiththeJ2GMigrationTool-RunningtheDescriptorsConversionTool-EclipseGUI">Running the Descriptors Conversion Tool - Eclipse GUI</h2>

<p>To run this component within the Eclipse IDE GUI, the left panel must first be in Navigator view.</p>

<p>Once in the Navigator view, it is possible to right click and select J2G Migration from the context menu.</p>

<p>Within the J2G Migration sub menu, select "2. Descriptors Conversion Tool (jdes2g)", and follow the prompts given.<br clear="none">
Output will be displayed in the bottom portion of the Eclipse IDE, within the integrated Console window.</p>

<h2 id="MigratingwiththeJ2GMigrationTool-RunningtheDescriptorsConversionTool-CommandLine">Running the Descriptors Conversion Tool - Command Line</h2>

<p>To start the Descriptors Conversion Tool run the following command from the j2g bin directory, again where &lt;APPLICATION&gt; represents the path to the application to be converted</p>

<p>*<strong>nix</strong></p>
<parameter ac:name="borderStyle">solid</parameter><plain-text-body>
./jdesc2g.sh &lt;APPLICATION&gt;
</plain-text-body>
<p><strong>Windows</strong></p>
<parameter ac:name="borderStyle">solid</parameter><plain-text-body>
jdesc2g.bat &lt;APPLICATION&gt;
</plain-text-body>
<p>The warnings given in the output of this tool will report only unsupported elements that cannot be automatically converted, and must therefore be manually resolved and converted. This process is heavily dependent on the structure of the application being converted, and is therefore beyond the scope of this document.</p>

<h1 id="MigratingwiththeJ2GMigrationTool-ResourceMigrationTool">Resource Migration Tool</h1>


<h2 id="MigratingwiththeJ2GMigrationTool-Description.2">Description</h2>

<p>The Resource Migration Tool converts JBoss specific resources to their Geronimo equivalents. It processes the following types of resources:</p>
<ul><li>JBoss/JCA data source descriptors (*-ds.xml files) defining JDBC connection pools and data sources. Since a data source depends on a database type, the tool performs automatic migration for the following well-known databases
	<ul><li>DB2</li><li>Derby</li><li>Hypersonic</li><li>Informix</li><li>Microsoft SQL</li><li>MySQL</li><li>Oracle</li><li>PostgreSQL</li><li>Other data source definitions must be migrated manually. If a definition contains unknown parameters, the tool will indicate this with a warning message.</li></ul>
	</li></ul>


<ul><li>JBoss MBean descriptors (*-service.xml files). Only the following resource definitions will be migrated
	<ul><li>javax.mail.Session</li><li>javax.jms.QueueConnectionFactory</li><li>javax.jms.TopicConnectionFactory</li><li>javax.transaction.TransactionManager</li></ul>
	</li></ul>


<ul><li>JBoss security policy descriptors (login-config.xml) that provide JAAS login module configuration. The tool migrates Role and Policy definitions as well as User and Groups for the following JBoss login modules
	<ul><li>org.jboss.security.auth.spi.IdentityLoginModule</li><li>org.jboss.security.auth.spi.UsersRolesLoginModule</li><li>org.jboss.security.auth.spi.LdapLoginModule</li><li>org.jboss.security.auth.spi.DatabaseServerLoginModule</li></ul>
	</li></ul>


<h2 id="MigratingwiththeJ2GMigrationTool-RunningtheResourceMigrationTool-EclipseGUI">Running the Resource Migration Tool - Eclipse GUI</h2>

<p>To run this component within the Eclipse IDE GUI, the left panel must first be in Navigator view.</p>

<p>Once in the Navigator view, it is possible to right click and select J2G Migration from the context menu.</p>

<p>Within the J2G Migration sub menu, select "3. Resource Migration Tool (jres2g)", and follow the prompts given.<br clear="none">
Output will be displayed in the bottom portion of the Eclipse IDE, within the integrated Console window.</p>

<h2 id="MigratingwiththeJ2GMigrationTool-RunningtheResourceMigrationTool-CommandLine">Running the Resource Migration Tool - Command Line</h2>

<p>To start the Resource Migration Tool run the following command from the j2g bin directory, again where &lt;APPLICATION&gt; represents the path to the application to be converted</p>

<p>*<strong>nix</strong></p>
<parameter ac:name="borderStyle">solid</parameter><plain-text-body>
./jres2g.sh &lt;APPLICATION&gt;
</plain-text-body>
<p><strong>Windows</strong></p>
<parameter ac:name="borderStyle">solid</parameter><plain-text-body>
jres2g.bat &lt;APPLICATION&gt;
</plain-text-body>
<p>The tool will output the name of each resource that is to be migrated, as well as informational, error, and warning messages with associated file names and line numbers. If migration of a resource is completed without errors, the tool will output a success message and generate the migrated resource in the same folder as the original one.</p>

<p>As with the other tools, the Error and Warning messages must be manually corrected to complete the conversion process, again which is heavily application specific and is beyond the scope of this document.</p>

<h1 id="MigratingwiththeJ2GMigrationTool-Completion">Completion</h1>

<p>Once all of the above tools have been properly executed and there are no more errors or warnings, the converted application may now be built for Geronimo. Again, this is something that is extremely application specific and must be completely custom tailored in each individual situation.</p>

<p>After a successful build, the application should be able to be deployed in a running instance of Geronimo 2.0 without issue, however if it is not the errors displayed at deployment time must be resolved and the application must be rebuilt.</p></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tr>
          <td align="left" valign="middle" class="footer">
            &nbsp;&nbsp;
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="Delicious" />
            <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">Bookmark this on Delicious</a>
            &nbsp;&nbsp;
            <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="Digg!" />
            <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)+'&amp;topic=programming');">Digg this</a>
            <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Migrating with the J2G Migration Tool';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
            &nbsp;&nbsp;
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;-&nbsp;&nbsp;
            Copyright &#169; 2003-2013, The Apache Software Foundation, Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0.</a>&nbsp;&nbsp;
          </td>
        </tr>
    </table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  </body>
</html>
