<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link type="text/css" rel="stylesheet" href="http://geronimo.apache.org/style/default.css">
    <LINK rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <META name="Description" content="Building Geronimo with Maven" />
    <META name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Building Geronimo with Maven" />
    <META name="Owner" content="dev@geronimo.apache.org" />
    <META name="Robots" content="index, follow" />
    <META name="Security" content="Public" />
    <META name="Source" content="wiki template" />
    <META name="DC.Date" scheme="iso8601" content="2010-05-11" />
    <META name="DC.Language" scheme="rfc1766" content="en" />
    <META name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation" />
    <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0 Documentation: Building Geronimo with Maven</title>
  </head>

  <body onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tr>
        <td valing="top" align="left">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" align="left" nowrap>
          <a href="/geronimo"> Home</a> >&nbsp;<a href="documentation.html">Documentation</a>&nbsp;&gt;&nbsp;<a href="installing-and-running.html">Installing and running</a>&nbsp;&gt;&nbsp;<a href="getting-and-installing-geronimo.html">Getting and installing Geronimo</a>&nbsp;&gt;&nbsp;<a href="building-geronimo-from-source.html">Building Geronimo from source</a>&nbsp;&gt;&nbsp;<a href="building-geronimo-with-maven.html">Building Geronimo with Maven</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8" />
            <input type="hidden" name="oe" value="UTF-8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
        </td>
      </tr> 
    </table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div style="margin: 0px 10px 0px 10px" class="smalltext">Apache Geronimo v3.0</div>
        <div style="margin: 0px 10px 8px 10px"  class="pagetitle">Building Geronimo with Maven</div>

        <div class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
<!-- -->         
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645440">
            <img src="http://geronimo.apache.org/images/icons/notep_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Edit Page"></a>
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645440">Edit Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">
            <img src="http://geronimo.apache.org/images/icons/browse_space.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Browse Space"></a>
            <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">Browse Space</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645440">
            <img src="http://geronimo.apache.org/images/icons/add_page_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add Page"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645440">Add Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645440">
            <img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add News"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645440">Add News</a>
<!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><div class="toc-macro client-side-toc-macro" data-headerelements="H2,H3,H4,H5,H6,H7"></div>

<h2 id="BuildingGeronimowithMaven-Overview">Overview</h2>

<p>This documents how to build the Apache Geronimo Server project in command line.</p>

<p>This guide is intended to cover how to build Geronimo 3.0 from the latest <code>server/trunk</code> and <code>server/branches/3.0</code>. Refer to <a shape="rect" href="../GMOxDEV/building-apache-geronimo.html">Building Apache Geronimo</a> in the Development documents for more information on building Geronimo, including this and other branches.</p>
<div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>If you choose to build from <code>server/trunk</code>, take note of the <a shape="rect" href="../GMOxDEV/building-apache-geronimo.html#BuildingApacheGeronimo-Overview">general warning about the state of trunk</a> for building SNAPSHOT releases.</p></div></div>

<h2 id="BuildingGeronimowithMaven-Prerequisites">Prerequisites</h2>


<h3 id="BuildingGeronimowithMaven-BuildMachine">Build Machine</h3>

<p>It is recommended that a dedicated computer used to build Geronimo 3.0 have a minimum of 2GB of real memory. The computer will also need a connection to the Internet to download artifact dependencies.</p>


<h3 id="BuildingGeronimowithMaven-JavaDeveloperKit(JDK)">Java Developer Kit (JDK)</h3>

<p>You will need a <a shape="rect" class="external-link" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" title="Java SE 1.6" rel="nofollow">JDK 6.0+ (Java SE 1.6.0+)</a> or compatible JDK to build Apache Geronimo.  It is recommended you use SUN's implementation, or something compatible like Apples implementation.  Other JDK vendors implementations may work, but use at your own risk.</p>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows Tip</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Windows users should not double-quote JAVA_HOME (or MAVEN_HOME for the same reason), according to <a shape="rect" class="external-link" href="http://jira.codehaus.org/browse/MAVEN-666" rel="nofollow">MAVEN-666</a>.<br clear="none">
Setting:<br clear="none">
set JAVA_HOME="C:\Program Files\Java\jdk1.6.0_20"<br clear="none">
doesn't work, but this does:<br clear="none">
set JAVA_HOME=C:\Program Files\Java\jdk1.6.0_20</p></div></div>

<h3 id="BuildingGeronimowithMaven-ApacheMaven2">Apache Maven 2</h3>

<p>To execute the build process you need to have <a shape="rect" class="external-link" href="http://maven.apache.org">Apache Maven</a> version <code>2.2.1</code> (or newer) installed.</p>

<p>To check if your installation is working and you have the required minimum version run:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn -version
</pre>
</div></div>
<p>And it should produce something like:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>Maven version: 2.2.1
</pre>
</div></div>

<p>If you have an incompatible version the server build will probably fail with a message complaining <img class="emoticon emoticon-wink" src="https://cwiki.apache.org/confluence/s/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/_/images/icons/emoticons/wink.png" data-emoticon-name="wink" alt="(wink)"></p>


<h3 id="BuildingGeronimowithMaven-Subversion">Subversion</h3>

<p>To fetch the source code for the server, you will need to have a <a shape="rect" class="external-link" href="http://subversion.tigris.org/" rel="nofollow">Subversion</a> client version 1.5 (or newer, 1.5 is recommended) installed.</p>
<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows Tip</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Windows users are <strong>strongly encouraged</strong> to change the M2 local repository (the place where dependencies are downloaded) to a shorter path with no spaces, e.g. <code>C:\.m2</code>.<br clear="none">
Using a longer path may cause the build (and Geronimo itself) to behave very strangely when it hits the 260 character limit for filenames on Windows.</p>

<p>In order to change the m2 local repository go to <code>%USERPROFILE%\.m2</code> and edit or create <code>settings.xml</code> file to contain the following content:</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;settings&gt;
    &lt;localRepository&gt;C:\.m2&lt;/localRepository&gt;
&lt;/settings&gt;
]]></script>
</div></div></div></div>

<h2 id="BuildingGeronimowithMaven-CheckoutGeronimo">Checkout Geronimo</h2>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>svn co https://svn.apache.org/repos/asf/geronimo/server/trunk server
</pre>
</div></div>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Tip</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>If you are using Chinese system, please change your locale to en_US. Otherwise, the maven 2.0.7(or below) can't parse Chinese characters.</p></div></div>

<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows Tip</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Windows users are <strong>strongly encouraged</strong> to checkout Geronimo into <code>c:\g</code>.<br clear="none">
Using a longer path may cause the build (and Geronimo itself) to behave very strangely when it hits the 260 char limit for filenames on Windows.</p></div></div>

<p>You can also use Git mirrors to checkout Geronimo source code, and make sure you have a Git client installed before using the following command:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>git clone git://git.apache.org/geronimo server
</pre>
</div></div>

<h2 id="BuildingGeronimowithMaven-PreparingtoBuildfortheFirstTime">Preparing to Build for the First Time</h2>

<p>Chances are you will need to increase the heap size for Maven.  Add the following lines to <code>~/.mavenrc</code>:</p>
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>The following snips only set <code>MAVEN_OPTS</code> if its not already set, so that you can override these values on the command line if needed.</p></div></div>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre># Increase the heap size Maven
if [ "x$MAVEN_OPTS" = "x" ]; then
    MAVEN_OPTS=-Xmx512m
fi
</pre>
</div></div>
<p>If you are using the SUN JDK (or a JDK with compatible flags, like the Apple JDK), you should also increase the maximum permanent size as well as the heap:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre># Increase the heap and max permanent size for Maven
if [ "x$MAVEN_OPTS" = "x" ]; then
    MAVEN_OPTS="-Xmx1024m -XX:PermSize=256m -XX:MaxPermSize=1024m -XX:ReservedCodeCacheSize=64m"
fi
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows Tip</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Windows users should create <code>mavenrc_pre.bat</code> under <code>c:\documents and settings\&lt;username&gt;\mavenrc_pre.bat</code> or <code>c:\mavenrc_pre.bat</code> depending on how the <code>%HOME%</code> property is set on your system.</p>

<p>Variables will need to use the batch set syntax:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>set &lt;VARIABLE&gt;=&lt;VALUE&gt;
</pre>
</div></div></div></div>

<h2 id="BuildingGeronimowithMaven-Building">Building</h2>

<p>To build all changes incrementally:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn install
</pre>
</div></div>
<p>To perform clean builds, which are sometimes needed after some changes to the source tree:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn clean install
</pre>
</div></div>


<h3 id="BuildingGeronimowithMaven-BuildingStages">Building Stages</h3>

<p>In some cases you may need to build Geronimo in stages, such as when building OpenEJB from source to pick up local changes.  Most users will not need to do this, but its documented here for clarity.</p>

<p>To build modules, configs and maven-plugins:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn install -Dstage=bootstrap
</pre>
</div></div>
<p>To build plugins, configs, plugingroups and assemblies:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn install -Dstage=assemble
</pre>
</div></div>
<p>As mentioned, most users will not need to build Geronimo in stages.  But in some cases, when bootstrapping new versions (when no artifacts are deployed into remote repositories for the current version), then you <strong>must</strong> build the stages separately for the <em>first</em> build and then for all builds afterwards, the staged build is not necessary.</p>
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>If you encounter errors downloading dependencies from the ibiblio maven mirror, adding the following to your <code>settings.xml</code> file may help avoid the problem:</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[
&lt;settings&gt;
  &lt;!-- central repo repo1 is mirrored to ibiblio. explictly overriding that to be repo1 itself --&gt;
    &lt;mirrors&gt;
        &lt;mirror&gt;
            &lt;id&gt;ibiblio.org&lt;/id&gt;
            &lt;name&gt;Mirror of http://repo1.maven.org/maven2/&lt;/name&gt;
            &lt;url&gt;http://repo1.maven.org/maven2&lt;/url&gt;
            &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
        &lt;/mirror&gt;
    &lt;/mirrors&gt;
&lt;/settings&gt;
]]></script>
</div></div></div></div>

<h2 id="BuildingGeronimowithMaven-TestingtheAssembly">Testing the Assembly</h2>

<p>Once you have build the server fully, which will produce a number of <code>zip</code> and <code>tar.gz</code> archives from the assembly modules, you can use the <code>geronimo-maven-plugin</code> to start the server.  From the project root directory run:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn -Ptools geronimo:start
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Windows Tip</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>Windows users may need to specify an alternative <code>installDirectory</code> to avoid long path problems:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn -Ptools geronimo:start -DinstallDirectory=c:\g
</pre>
</div></div></div></div>
<p>And to stop, either <code>CTRL-C</code> or from a separate terminal, from the project root directory run:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn -Ptools geronimo:stop
</pre>
</div></div>

<h2 id="BuildingGeronimowithMaven-IDESetup">IDE Setup</h2>

<p>The server project does not have any IDE files checked in, they are all generated by Maven plugins.  Once you have checked out the server tree and built it once, you can generate the project configuration files for your IDE.</p>

<h3 id="BuildingGeronimowithMaven-IntellijIDEA">Intellij IDEA</h3>

<p>For the basic IDEA configuration:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn idea:idea
</pre>
</div></div>
<p>To generate a configuration which includes dependency sources and javadocs:</p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn -Pdefault,idea
</pre>
</div></div>

<h3 id="BuildingGeronimowithMaven-Eclipse">Eclipse</h3>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>mvn -Pdefault,makeeclipse
</pre>
</div></div>

<h2 id="BuildingGeronimowithMaven-TroubleshootingandTips">Troubleshooting and Tips</h2>

<ul><li>Use -DskipTests=true to turn off tests during server build.</li><li>Use -o to avoid searching remote repository.</li><li>Use -X to produce maven debug information.</li><li>Build all Geronimo dependencies to avoid out-of-date code among projects such as openEJB, JSF and so on.</li></ul></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tr>
          <td align="left" valign="middle" class="footer">
            &nbsp;&nbsp;
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="Delicious" />
            <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">Bookmark this on Delicious</a>
            &nbsp;&nbsp;
            <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="Digg!" />
            <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)+'&amp;topic=programming');">Digg this</a>
            <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Building Geronimo with Maven';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
            &nbsp;&nbsp;
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;-&nbsp;&nbsp;
            Copyright &#169; 2003-2013, The Apache Software Foundation, Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0.</a>&nbsp;&nbsp;
          </td>
        </tr>
    </table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  </body>
</html>
