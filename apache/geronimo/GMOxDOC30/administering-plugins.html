<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link type="text/css" rel="stylesheet" href="http://geronimo.apache.org/style/default.css">
    <LINK rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <META name="Description" content="Administering plugins" />
    <META name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Administering plugins" />
    <META name="Owner" content="dev@geronimo.apache.org" />
    <META name="Robots" content="index, follow" />
    <META name="Security" content="Public" />
    <META name="Source" content="wiki template" />
    <META name="DC.Date" scheme="iso8601" content="2010-05-11" />
    <META name="DC.Language" scheme="rfc1766" content="en" />
    <META name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation" />
    <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>


    <title>Apache Geronimo v3.0 Documentation: Administering plugins</title>
  </head>

  <body onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tr>
        <td valing="top" align="left">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" align="left" nowrap>
          <a href="/geronimo"> Home</a> >&nbsp;<a href="documentation.html">Documentation</a>&nbsp;&gt;&nbsp;<a href="configuring-and-administering.html">Configuring and administering</a>&nbsp;&gt;&nbsp;<a href="deploying-and-administering-assets-in-geronimo.html">Deploying and administering assets in Geronimo</a>&nbsp;&gt;&nbsp;<a href="deploying-and-administering-plugins.html">Deploying and administering plugins</a>&nbsp;&gt;&nbsp;<a href="administering-plugins.html">Administering plugins</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8" />
            <input type="hidden" name="oe" value="UTF-8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
        </td>
      </tr> 
    </table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div style="margin: 0px 10px 0px 10px" class="smalltext">Apache Geronimo v3.0</div>
        <div style="margin: 0px 10px 8px 10px"  class="pagetitle">Administering plugins</div>

        <div class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
<!-- -->         
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645472">
            <img src="http://geronimo.apache.org/images/icons/notep_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Edit Page"></a>
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645472">Edit Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">
            <img src="http://geronimo.apache.org/images/icons/browse_space.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Browse Space"></a>
            <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">Browse Space</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645472">
            <img src="http://geronimo.apache.org/images/icons/add_page_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add Page"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645472">Add Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645472">
            <img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add News"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645472">Add News</a>
<!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent"><plain-text-body>{scrollbar}</plain-text-body>

<h1 id="Administeringplugins-Administeringplugins">Administering plugins</h1>


<h2 id="Administeringplugins-Creatingaplugin">Creating a plugin</h2>
<ul><li>You can create a plugin as part of a maven build by using the car-maven-plugin.</li><li>You can create a plugin "virtually" by installing a deployed application from a running Geronimo server acting as a plugin repository.</li><li>You can create a plugin by using the Geronimo administration console to create or edit the plugin metadata.</li></ul>


<p>By far the easiest way to build a Geronimo plugin is with maven using the car-maven-plugin.  Any such module includes a <code>geronimo-plugin.xml</code> descriptor with at least minimal information.  When possible, this information, such as the description and license imformation, is taken from the pom file itself.  Normally, you will build the dependency list from the modules dependencies that are constructed from the maven dependencies plus whatever additional dependencies the deployer determine that are needed.  For instance, an ejb application will have the openejb plugin added as a dependency by the openejb deployer.  If necessary, you can specify the dependencies for both the module and plugin descriptor explicitly in the car-maven-plugin configuration.</p>

<p>Here's an example of a car-maven-plugin configuration using maven dependencies and configuring most of the additional information possible:</p>

<parameter ac:name="">xml</parameter><parameter ac:name="title">excerpt from pom.xml</parameter><plain-text-body>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" 
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
         xsi:schemaLofcation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"&gt;

    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;parent&gt;
        &lt;groupId&gt;org.apache.geronimo.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;plugins&lt;/artifactId&gt;
        &lt;version&gt;2.2-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;

    &lt;groupId&gt;org.apache.geronimo.configs&lt;/groupId&gt;
    &lt;artifactId&gt;sharedlib&lt;/artifactId&gt;
    &lt;name&gt;Geronimo Plugins, Shared Library&lt;/name&gt;
    &lt;description&gt;Shared Library GBean&lt;/description&gt;
    &lt;packaging&gt;car&lt;/packaging&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.geronimo.buildsupport&lt;/groupId&gt;
                &lt;artifactId&gt;car-maven-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;category&gt;Shared&lt;/category&gt;
                    &lt;useMavenDependencies&gt;
                        &lt;value&gt;true&lt;/value&gt;
                        &lt;includeVersion&gt;true&lt;/includeVersion&gt;
                    &lt;/useMavenDependencies&gt;
                    &lt;instance&gt;
                        &lt;plugin-artifact&gt;
                            &lt;copy-file relative-to="server" dest-dir="var"&gt;shared&lt;/copy-file&gt;
                        &lt;/plugin-artifact&gt;
                    &lt;/instance&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

&lt;/project&gt;

</plain-text-body>

<p>As you use maven to build plugins, a <code>geronimo-plugins.xml</code> plugin catalog is automatically maintained in your local maven repository.  You can force this to be rebuilt by running the following command:</p>

<plain-text-body>
mvn org.apache.geronimo.buildsupport:car-maven-plugin:create-pluginlist
</plain-text-body>

<p>This might be necessary if you prune your maven repository and remove plugins listed in the catalog.</p>

<p>Alternatively, you can construct the <code>geronimo-plugin.xml</code> file by hand and include it in a deployed module in a geronimo server.</p>

<p>The administration console also allows limited editing of the <code>geronimo-plugin.xml</code> files, but editing the information about how the plugin fits into the server is not yet supported.</p>


<h2 id="Administeringplugins-Installingaplugin">Installing a plugin</h2>

<p>If the appropriate administration console plugin is installed (and your Geronimo server includes Web application support), you can install plugins from a plugin repository. After selecting the <strong>Plugins</strong> page from the navigation menu, select the plugin repository that you want, such as your local maven repository if you have been building your own plugins.  Next, you will see a list of available plugins from the repository.  Select multiple plugins using the check boxes or a single plugin as a link, and on the next page you will see more information about the plugins.  On your approval the plugins will be downloaded and installed.</p>

<p>Alternatively you can use GShell to install plugins using the <strong>deploy/install-plugin</strong> command. This can be run with a command line or interactively.  Interactively you can select the plugin repository to use (if more than one is known), and then select the plugins to install.  Again, they will be downloaded and installed.  An example of command line usage will be seen as followed: </p>

<p>You can install a plugin into an existing server in different ways:</p>
<ul><li>GShell <a shape="rect" href="geronimo-gshell-commands.html">deploy/install-plugin</a> command</li><li>Geronimo administrative console</li><li>Using maven and the geronimo-maven-plugin</li></ul>


<p>You can also install a plugin into a new server assembly by using the car-maven-plugin.<br clear="none">
Note that in all cases the dependency system assure that if you install a plugin, everything that is needed to run the plugin will also be installed.  For instance, if you install a Java EE application plugin, such as one of the samples, into the framework server,  openejb, openjpa, the transaction manager and connector framework, and the appropriate Web container will also be installed as dependencies.</p>


<h2 id="Administeringplugins-Updatingaplugin">Updating a plugin</h2>
<p>At times, you might need to upgrade a plugin or jar version without rereleasing all the artifacts that depend on it.  Here are some methods to upgrade jar versions.</p>

<h3 id="Administeringplugins-Simplejarupgrade">Simple jar upgrade</h3>
<p>If you want to install the upgraded jar as part of a plugin installation, see the following <a shape="rect" href="administering-plugins.html">#Upgrading a jar while releasing a plugin</a> section. Otherwise, use the following steps to upgrade the jar file: </p>
<ol><li>If the server is running, stop the server.</li><li>Copy the new jar into the appropriate directory in your geronimo server's repository. For instance:
<plain-text-body>
mkdir -p repository/org/foo/myjar/1.1/
cp ~/newFooJar/myjar-1.1.jar repository/org/foo/myjar/1.1/
</plain-text-body>
Alternatively, you can use the <strong>Services-&gt;Repository</strong> portlet on the administration console to add artifacts to the server's repository.</li></ol>


<p>Finally, after the new jar is installed in the server's repository, add a line to <code>var/config/artifact_aliases.properties</code> (or the equivalent file, if the server is using a non-standard alias file) to configure the server to substitute the version for any old version dependency . For instance, to replace <code>myjar-1.0.jar</code> with <code>myjar-1.1.jar</code>, add the following line:</p>
<plain-text-body>
org.foo/myjar/1.0/jar=org.foo/myjar/1.1/jar
</plain-text-body>
<p>With this configuration, the server will substitute myjar-1.1.jar for any myjar-1.0.jar dependency.</p>

<h3 id="Administeringplugins-Upgradingajarwhilereleasingaplugin">Upgrading a jar while releasing a plugin</h3>
<p>If the jar is installed as part of a plugin installation, you can include configuration upgrade information in the <code>geronimo-plugin.xml</code>. During plugin installation, the upgraded jar will be automatically installed. This is the easiest way to specify in the car-maven-config configuration in the pom.xml, prior to building the plugin.</p>
<plain-text-body>
&lt;artifact-alias key="org.foo/myjar/1.0/jar"&gt;org.foo/myjar/1.1/jar&lt;/artifact-alias&gt;
</plain-text-body>
</div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tr>
          <td align="left" valign="middle" class="footer">
            &nbsp;&nbsp;
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="Delicious" />
            <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">Bookmark this on Delicious</a>
            &nbsp;&nbsp;
            <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="Digg!" />
            <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)+'&amp;topic=programming');">Digg this</a>
            <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Administering plugins';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
            &nbsp;&nbsp;
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;-&nbsp;&nbsp;
            Copyright &#169; 2003-2013, The Apache Software Foundation, Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0.</a>&nbsp;&nbsp;
          </td>
        </tr>
    </table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  </body>
</html>
