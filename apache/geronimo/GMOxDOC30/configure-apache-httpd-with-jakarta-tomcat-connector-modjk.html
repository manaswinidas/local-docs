<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<html lang="en">
  <head>
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <link type="text/css" rel="stylesheet" href="http://geronimo.apache.org/style/default.css">
    <LINK rel="SHORTCUT ICON" href="http://geronimo.apache.org/images/favicon.ico">
    <LINK rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
    <META name="Description" content="Configure Apache HTTPd with Jakarta Tomcat Connector (mod_jk)" />
    <META name="Keywords" content="Apache Geronimo 3.0 Documentation JavaEE6 OSGi Configure Apache HTTPd with Jakarta Tomcat Connector (mod_jk)" />
    <META name="Owner" content="dev@geronimo.apache.org" />
    <META name="Robots" content="index, follow" />
    <META name="Security" content="Public" />
    <META name="Source" content="wiki template" />
    <META name="DC.Date" scheme="iso8601" content="2010-05-11" />
    <META name="DC.Language" scheme="rfc1766" content="en" />
    <META name="DC.Rights" content="Copyright Â© 2003-2013, The Apache Software Foundation" />
    <META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))'/>

    <script src="http://geronimo.apache.org/functions.js" type="text/javascript"></script>

  <link href='http://geronimo.apache.org/resources/highlighter/styles/shCoreGeronimo.css' rel='stylesheet' type='text/css' />
  <link href='http://geronimo.apache.org/resources/highlighter/styles/shThemeGeronimo.css' rel='stylesheet' type='text/css' />
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shCore.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushJava.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushXml.js' type='text/javascript'></script>
  <script src='http://geronimo.apache.org/resources/highlighter/scripts/shBrushPlain.js' type='text/javascript'></script>
  
  <script type="text/javascript">
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
  </script>

    <title>Apache Geronimo v3.0 Documentation: Configure Apache HTTPd with Jakarta Tomcat Connector (mod_jk)</title>
  </head>

  <body onload="init()">

        <!-- banner -->
    <table valign="top" border="0" cellspacing="0" cellpadding="0" width="100%" background="http://geronimo.apache.org/images/top_bgstretch_1x64.gif">
      <tr>
        <td valing="top" align="left">
          <img src="http://geronimo.apache.org/images/topleft_logo_437x64.gif" border="0">
        </td>
      </tr>
    </table>

        <!-- topNav -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
      <tr class="topBar">
        <td align="left" valign="middle" class="topBarDiv" align="left" nowrap>
          <a href="/geronimo"> Home</a> >&nbsp;<a href="documentation.html">Documentation</a>&nbsp;&gt;&nbsp;<a href="configuring-and-administering.html">Configuring and administering</a>&nbsp;&gt;&nbsp;<a href="configuring-and-administering-the-apache-geronimo-server.html">Configuring and administering the Apache Geronimo Server</a>&nbsp;&gt;&nbsp;<a href="configuring-a-remote-apache-http-server.html">Configuring a remote Apache HTTP server</a>&nbsp;&gt;&nbsp;<a href="configure-apache-httpd-with-jakarta-tomcat-connector-modjk.html">Configure Apache HTTPd with Jakarta Tomcat Connector (mod_jk)</a>
        </td>
        <td align="right" valign="middle" nowrap>
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF-8" />
            <input type="hidden" name="oe" value="UTF-8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
        </td>
      </tr> 
    </table>

        <!-- pageContent -->
    <div id="PageContent">
      <div class="pageheader" style="padding: 6px 0px 0px 0px;">
        <!-- We'll enable this once we figure out how to access (and save) the logo resource -->
        <!--img src="http://geronimo.apache.org/images/confluence_logo.gif" style="float: left; margin: 4px 4px 4px 10px;" border="0"-->
        <div style="margin: 0px 10px 0px 10px" class="smalltext">Apache Geronimo v3.0</div>
        <div style="margin: 0px 10px 8px 10px"  class="pagetitle">Configure Apache HTTPd with Jakarta Tomcat Connector (mod_jk)</div>

        <div class="greynavbar" align="right" style="padding: 2px 10px; margin: 0px;">
<!-- -->         
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645305">
            <img src="http://geronimo.apache.org/images/icons/notep_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Edit Page"></a>
            <a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=20645305">Edit Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">
            <img src="http://geronimo.apache.org/images/icons/browse_space.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Browse Space"></a>
            <a href="https://cwiki.apache.org/confluence/pages/listpages.action?key=GMOxDOC30">Browse Space</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645305">
            <img src="http://geronimo.apache.org/images/icons/add_page_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add Page"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createpage.action?spaceKey=GMOxDOC30&fromPageId=20645305">Add Page</a>
          &nbsp;
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645305">
            <img src="http://geronimo.apache.org/images/icons/add_blogentry_16.gif"
                 height="16" width="16" border="0" align="absmiddle" title="Add News"></a>
          <a href="https://cwiki.apache.org/confluence/pages/createblogpost.action?spaceKey=GMOxDOC30&fromPageId=20645305">Add News</a>
<!-- -->	 
        </div>
      </div>

      <div class="pagecontent">
        <div class="wiki-content">
          <div class="wiki-content maincontent">
<p><span class="confluence-anchor-link" id="ConfigureApacheHTTPdwithJakartaTomcatConnector(mod_jk)-top"></span></p>

<p>The communication between the HTTP server and Geronimo can also be done via AJP connectors. By default, both Apache Geronimo distributions (Jetty and Tomcat) have already predefined one AJP13 connector listening on port 8009.</p>

<p>The Jakarta Tomcat Connector <strong>mod_jk</strong> module is provided as a connector from Apache Tomcat source. Both Jetty and Tomcat are fully compatible with this connector. This module is available when you download the Tomcat source, but you can also download it separately. See <a shape="rect" class="external-link" href="http://tomcat.apache.org/download-connectors.cgi">http://tomcat.apache.org/download-connectors.cgi</a> for the proper version for your system.</p>


<p>In addition to <strong>mod_jk</strong>, you will require a <code>workers.properties</code> file, also available with the Apache Tomcat source distribution. This properties file tells the <strong>mod_jk</strong> plugin how to connect to the Geronimo server. For a detailed explanation on all the available options for configuring the Jakarta Tomcat Connector, visit <a shape="rect" class="external-link" href="http://tomcat.apache.org/connectors-doc/config/workers.html">http://tomcat.apache.org/connectors-doc/config/workers.html</a>.</p>

<div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>For practical purposes, the module <a shape="rect" href="configure-apache-httpd-with-jakarta-tomcat-connector-modjk.data/mod_jk-apache-2.2.3.so?version=1&amp;modificationDate=1203494952000&amp;api=v2" data-linked-resource-id="20874112" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="mod_jk-apache-2.2.3.so" data-linked-resource-content-type="application/octet-stream" data-linked-resource-container-id="20645305" data-linked-resource-container-version="46">mod_jk-apache-2.2.3.so</a> for Windows and the <a shape="rect" href="configure-apache-httpd-with-jakarta-tomcat-connector-modjk.data/workers.properties?version=1&amp;modificationDate=1203494952000&amp;api=v2" data-linked-resource-id="20874113" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="workers.properties" data-linked-resource-content-type="application/octet-stream" data-linked-resource-container-id="20645305" data-linked-resource-container-version="46">workers.properties</a> are included in the <strong>Attachments</strong> section in this article.</p></div></div>

<p><a shape="rect" href="configure-apache-httpd-with-jakarta-tomcat-connector-modjk.html">Back to Top</a></p>

<h1 id="ConfigureApacheHTTPdwithJakartaTomcatConnector(mod_jk)-ConfigureApacheHTTPd">Configure Apache HTTPd</h1>
<p>Download the appropriate <strong>mod_jk</strong> for your platform from the <a shape="rect" class="external-link" href="http://tomcat.apache.org/download-connectors.cgi">Tomcat</a> web site. For this particular example, rename it to <strong>mod_jk.so</strong> and copy it into the <code>&lt;httpd_home&gt;\modules</code> directory. Download and extract the <strong>workers.properties</strong> file from the Apache Tomcat source (alternatively, download it from the <strong>Attachments</strong> section) to the <code>&lt;httpd_home&gt;\conf</code> directory.</p>

<p>Edit the <code>httpd.conf</code> file located in the <code>&lt;httpd_home&gt;\conf</code> directory to load the Jakarta Tomcat Connector <strong>mod_jk</strong> module. Add the following lines at the end of the <code>httpd.conf</code> file.</p>

<div class="preformatted panel" style="border-style: solid;border-width: 1px;"><div class="preformattedHeader panelHeader" style="border-bottom-width: 1px;border-bottom-style: solid;"><b>Excerpt from httpd.conf</b></div><div class="preformattedContent panelContent">
<pre>LoadModule jk_module modules/mod_jk.so			
# Loads the Jakarta Tomcat Connector module

JkWorkersFile &lt;httpd_home&gt;\conf\workers.properties
# Tells the module the location of the workers.properties file

JkLogFile     &lt;httpd_home&gt;\logs\mod_jk.log
# Specifies the location for this module's specific log file

JkLogLevel    info
# Sets the module's log level to info

JkMount /console/* ajp13
# Sets a mount point from a context to a Tomcat worker. In this case will allow access (forward the request) to the console.
</pre>
</div></div> 

<p><strong>JkMount</strong> will map anything behind <strong>/console/</strong> to the worker <strong>ajp13</strong>. The name <strong>ajp13</strong> is defined in the <code>workers.properties file</code>, which is described in the following section. You might need to add more <strong>JkMount</strong> directives depending on the applications you want to be accessed via the remote HTTPd.</p>

<div class="confluence-information-macro confluence-information-macro-warning"><span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p> In this example, the <strong>console</strong> has been enabled just for demonstration purposes. In a production environment, you do not want to have the <strong>console</strong> accessible from the other network (normally the Internet). Having the <strong>console</strong> accessible represents a big security exposure.</p>

<p>The rule is that everything should have restricted access. Normally, a firewall would be placed in between the HTTP and the application server (depending on the topology) and you should map just the minimum resources necessary to have your application working from the other side.</p></div></div>

<p><a shape="rect" href="configure-apache-httpd-with-jakarta-tomcat-connector-modjk.html">Back to Top</a></p>

<h1 id="ConfigureApacheHTTPdwithJakartaTomcatConnector(mod_jk)-Configureworkers.properties">Configure workers.properties</h1>
<p>The <code>workers.properties</code> file, among other things, tells the HTTPd where the Geronimo server is, what version of AJP to use and the port where Geronimo is listening.</p>

<p>Edit the <code>workers.properties</code> file located in the <code>&lt;httpd_home&gt;\conf</code> directory to match your environment. The following example is an excerpt from the <code>workers.properties</code> file with just the variables you should focus on.</p>

<div class="preformatted panel" style="border-style: solid;border-width: 1px;"><div class="preformattedHeader panelHeader" style="border-bottom-width: 1px;border-bottom-style: solid;"><b>Minimum requirements for the workers.properties</b></div><div class="preformattedContent panelContent">
<pre>worker.ajp13.type=ajp13
# Sets the version of AJP used. The AJP listeners defined in Geronimo are AJP v13.

worker.ajp13.host=localhost
# Specifies the location of the Geronimo server. Use default localhost for single-tier scenarios. Specify the
# hostname of the Geronimo server for multi-tier environments.

worker.ajp13.port=8009
# Both Tomcat and Jetty come with a predefined AJP13 listener on port 8009
</pre>
</div></div>

<p>From this example, note how the name of the worker is defined. Look at the variables definition <strong>worker.ajp13</strong> , where <strong>ajp13</strong> is the worker name you specified earlier in the <code>httpd.conf</code> file.</p>

<p>As the last step, stop and restart the Apache HTTPd to ensure these changes are loaded.</p>

<p><a shape="rect" href="configure-apache-httpd-with-jakarta-tomcat-connector-modjk.html">Back to Top</a></p>

<h1 id="ConfigureApacheHTTPdwithJakartaTomcatConnector(mod_jk)-Testing">Testing</h1>
<p>For testing this configuration, make sure both Geronimo and HTTPd are up and running. </p>

<ol><li>Check Geronimo connectivity by accessing <a shape="rect" class="external-link" href="http://localhost:8080/console" rel="nofollow">http://localhost:8080/console</a> , you should see the Geronimo Administration Console.</li><li>Check HTTPd connectivity by accessing <a shape="rect" class="external-link" href="http://localhost" rel="nofollow">http://localhost</a> , you should see the Apache HTTPd welcome page.</li><li>Check the HTTPd - Geronimo request forwarding by accessing <a shape="rect" class="external-link" href="http://localhost/console/" rel="nofollow">http://localhost/console/</a> , you shoud be redirected to the Geronimo Administration Console. Note that at the end of the URL, there is a "/", failing to include this / will result in a <strong>Not Found</strong> error triggered by the Jakarta Tomcat Connector module.</li></ol>


<p><a shape="rect" href="configure-apache-httpd-with-jakarta-tomcat-connector-modjk.html">Back to Top</a></p></div>
        </div>

              </div>
    </div>

        <!-- footer -->
    <table border="0" cellpadding="2" cellspacing="0" width="100%">
        <tr>
          <td align="left" valign="middle" class="footer">
            &nbsp;&nbsp;
            <img src="http://static.delicious.com/img/delicious.small.gif" height="10" width="10" alt="Delicious" />
            <a href="http://delicious.com/save" onclick="window.open('http://delicious.com/save?v=5&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title),'delicious','toolbar=no,width=550,height=550'); return false;">Bookmark this on Delicious</a>
            &nbsp;&nbsp;
            <img src="http://digg.com/img/badges/16x16-digg-guy.gif" width="16" height="16" alt="Digg!" />
            <a href="" onclick="window.open('http://digg.com/submit?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)+'&amp;topic=programming');">Digg this</a>
            <!-- Slicker, but no text
            <script type="text/javascript">
              digg_skin = 'icon';
              digg_window = 'new';
              digg_title = 'Apache Geronimo v3.0 Documentation : Configure Apache HTTPd with Jakarta Tomcat Connector (mod_jk)';
              digg_topic = 'programming';
            </script>
            <script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>
            -->
            &nbsp;&nbsp;
          </td>
          <td align="right" valign="middle" class="footer">
            <a href="http://cwiki.apache.org/GMOxPMGT/geronimo-privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;-&nbsp;&nbsp;
            Copyright &#169; 2003-2013, The Apache Software Foundation, Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">ASL 2.0.</a>&nbsp;&nbsp;
          </td>
        </tr>
    </table> 

        <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-4380560-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>

  </body>
</html>
