<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>67.&nbsp;Using the CLI</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="Spring Boot Reference Guide"><link rel="up" href="cli.html" title="Part&nbsp;VII.&nbsp;Spring Boot CLI"><link rel="prev" href="cli-installation.html" title="66.&nbsp;Installing the CLI"><link rel="next" href="cli-groovy-beans-dsl.html" title="68.&nbsp;Developing Applications with the Groovy Beans DSL"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">67.&nbsp;Using the CLI</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="cli-installation.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;VII.&nbsp;Spring Boot CLI</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="cli-groovy-beans-dsl.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="cli-using-the-cli" href="#cli-using-the-cli"></a>67.&nbsp;Using the CLI</h2></div></div></div><p>Once you have installed the CLI, you can run it by typing <code class="literal">spring</code> and pressing Enter at
the command line. If you run <code class="literal">spring</code> without any arguments, a simple help screen is
displayed, as follows:</p><pre class="screen">$ spring
usage: spring [--help] [--version]
       &lt;command&gt; [&lt;args&gt;]

Available commands are:

  run [options] &lt;files&gt; [--] [args]
    Run a spring groovy script

  <span class="emphasis"><em>... more command help is shown here</em></span></pre><p>You can type <code class="literal">spring help</code> to get more details about any of the supported commands, as
shown in the following example:</p><pre class="screen">$ spring help run
spring run - Run a spring groovy script

usage: spring run [options] &lt;files&gt; [--] [args]

Option                     Description
------                     -----------
--autoconfigure [Boolean]  Add autoconfigure compiler
                             transformations (default: true)
--classpath, -cp           Additional classpath entries
-e, --edit                 Open the file with the default system
                             editor
--no-guess-dependencies    Do not attempt to guess dependencies
--no-guess-imports         Do not attempt to guess imports
-q, --quiet                Quiet logging
-v, --verbose              Verbose logging of dependency
                             resolution
--watch                    Watch the specified file for changes</pre><p>The <code class="literal">version</code> command provides a quick way to check which version of Spring Boot you are
using, as follows:</p><pre class="screen">$ spring version
Spring CLI v2.1.4.RELEASE</pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cli-run" href="#cli-run"></a>67.1&nbsp;Running Applications with the CLI</h2></div></div></div><p>You can compile and run Groovy source code by using the <code class="literal">run</code> command. The Spring Boot CLI
is completely self-contained, so you do not need any external Groovy installation.</p><p>The following example shows a &#8220;hello world&#8221; web application written in Groovy:</p><p><b>hello.groovy.&nbsp;</b>
</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RestController</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> WebApplication {

	<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RequestMapping("/")</xslthl:annotation>
	String home() {
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"Hello World!"</span>
	}

}</pre><p>
</p><p>To compile and run the application, type the following command:</p><pre class="screen">$ spring run hello.groovy</pre><p>To pass command-line arguments to the application, use <code class="literal">--</code> to separate the commands
from the &#8220;spring&#8221; command arguments, as shown in the following example:</p><pre class="screen">$ spring run hello.groovy -- --server.port=9000</pre><p>To set JVM command line arguments, you can use the <code class="literal">JAVA_OPTS</code> environment variable, as
shown in the following example:</p><pre class="screen">$ JAVA_OPTS=-Xmx1024m spring run hello.groovy</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>When setting <code class="literal">JAVA_OPTS</code> on Microsoft Windows, make sure to quote the entire
instruction, such as <code class="literal">set "JAVA_OPTS=-Xms256m -Xmx2048m"</code>. Doing so ensures the values
are properly passed to the process.</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="cli-deduced-grab-annotations" href="#cli-deduced-grab-annotations"></a>67.1.1&nbsp;Deduced &#8220;grab&#8221; Dependencies</h3></div></div></div><p>Standard Groovy includes a <code class="literal">@Grab</code> annotation, which lets you declare dependencies on
third-party libraries. This useful technique lets Groovy download jars in the same way as
Maven or Gradle would but without requiring you to use a build tool.</p><p>Spring Boot extends this technique further and tries to deduce which libraries to &#8220;grab&#8221;
based on your code. For example, since the <code class="literal">WebApplication</code> code shown previously uses
<code class="literal">@RestController</code> annotations, Spring Boot grabs "Tomcat" and "Spring MVC".</p><p>The following items are used as &#8220;grab hints&#8221;:</p><div class="informaltable"><table class="informaltable" style="border-collapse: collapse;border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col class="col_1"><col class="col_2"></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top">Items</th><th style="border-bottom: 1px solid ; " align="left" valign="top">Grabs</th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p><code class="literal">JdbcTemplate</code>, <code class="literal">NamedParameterJdbcTemplate</code>, <code class="literal">DataSource</code></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>JDBC Application.</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p><code class="literal">@EnableJms</code></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>JMS Application.</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p><code class="literal">@EnableCaching</code></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Caching abstraction.</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p><code class="literal">@Test</code></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>JUnit.</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p><code class="literal">@EnableRabbit</code></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>RabbitMQ.</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p>extends <code class="literal">Specification</code></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Spock test.</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p><code class="literal">@EnableBatchProcessing</code></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Spring Batch.</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p><code class="literal">@MessageEndpoint</code> <code class="literal">@EnableIntegration</code></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Spring Integration.</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p><code class="literal">@Controller</code> <code class="literal">@RestController</code> <code class="literal">@EnableWebMvc</code></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Spring MVC + Embedded Tomcat.</p></td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; " align="left" valign="top"><p><code class="literal">@EnableWebSecurity</code></p></td><td style="border-bottom: 1px solid ; " align="left" valign="top"><p>Spring Security.</p></td></tr><tr><td style="border-right: 1px solid ; " align="left" valign="top"><p><code class="literal">@EnableTransactionManagement</code></p></td><td style="" align="left" valign="top"><p>Spring Transaction Management.</p></td></tr></tbody></table></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>See subclasses of
<a class="link" href="https://github.com/spring-projects/spring-boot/tree/v2.1.4.RELEASE/spring-boot-project/spring-boot-cli/src/main/java/org/springframework/boot/cli/compiler/CompilerAutoConfiguration.java" target="_top"><code class="literal">CompilerAutoConfiguration</code></a>
in the Spring Boot CLI source code to understand exactly how customizations are applied.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="cli-default-grab-deduced-coordinates" href="#cli-default-grab-deduced-coordinates"></a>67.1.2&nbsp;Deduced &#8220;grab&#8221; Coordinates</h3></div></div></div><p>Spring Boot extends Groovy&#8217;s standard <code class="literal">@Grab</code> support by letting you specify a dependency
without a group or version (for example, <code class="literal">@Grab('freemarker')</code>). Doing so consults Spring
Boot&#8217;s default dependency metadata to deduce the artifact&#8217;s group and version.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The default metadata is tied to the version of the CLI that you use. it changes only
when you move to a new version of the CLI, putting you in control of when the versions of
your dependencies may change. A table showing the dependencies and their versions that are
included in the default metadata can be found in the <a class="link" href="appendix-dependency-versions.html" title="Appendix&nbsp;F.&nbsp;Dependency versions">appendix</a>.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="cli-default-import-statements" href="#cli-default-import-statements"></a>67.1.3&nbsp;Default Import Statements</h3></div></div></div><p>To help reduce the size of your Groovy code, several <code class="literal">import</code> statements are automatically
included. Notice how the preceding example refers to <code class="literal">@Component</code>, <code class="literal">@RestController</code>, and
<code class="literal">@RequestMapping</code> without needing to use fully-qualified names or <code class="literal">import</code> statements.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>Many Spring annotations work without using <code class="literal">import</code> statements. Try running your
application to see what fails before adding imports.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="cli-automatic-main-method" href="#cli-automatic-main-method"></a>67.1.4&nbsp;Automatic Main Method</h3></div></div></div><p>Unlike the equivalent Java application, you do not need to include a
<code class="literal">public static void main(String[] args)</code> method with your <code class="literal">Groovy</code> scripts. A
<code class="literal">SpringApplication</code> is automatically created, with your compiled code acting as the
<code class="literal">source</code>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="cli-default-grab-deduced-coordinates-custom-dependency-management" href="#cli-default-grab-deduced-coordinates-custom-dependency-management"></a>67.1.5&nbsp;Custom Dependency Management</h3></div></div></div><p>By default, the CLI uses the dependency management declared in <code class="literal">spring-boot-dependencies</code>
when resolving <code class="literal">@Grab</code> dependencies. Additional dependency management, which overrides
the default dependency management, can be configured by using the
<code class="literal">@DependencyManagementBom</code> annotation. The annotation&#8217;s value should specify the
coordinates (<code class="literal">groupId:artifactId:version</code>) of one or more Maven BOMs.</p><p>For example, consider the following declaration:</p><pre class="programlisting">@DependencyManagementBom(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"com.example.custom-bom:1.0.0"</span>)</pre><p>The preceding declaration picks up <code class="literal">custom-bom-1.0.0.pom</code> in a Maven repository under
<code class="literal">com/example/custom-versions/1.0.0/</code>.</p><p>When you specify multiple BOMs, they are applied in the order in which you declare them,
as shown in the following example:</p><pre class="programlisting">@DependencyManagementBom([<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"com.example.custom-bom:1.0.0"</span>,
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"com.example.another-bom:1.0.0"</span>])</pre><p>The preceding example indicates that the dependency management in <code class="literal">another-bom</code> overrides
the dependency management in <code class="literal">custom-bom</code>.</p><p>You can use <code class="literal">@DependencyManagementBom</code> anywhere that you can use <code class="literal">@Grab</code>. However, to
ensure consistent ordering of the dependency management, you can use
<code class="literal">@DependencyManagementBom</code> at most once in your application. A useful source of dependency
management (which is a superset of Spring Boot&#8217;s dependency management) is the
<a class="link" href="https://platform.spring.io/" target="_top">Spring IO Platform</a>, which you might include with the following
line:</p><pre class="programlisting">@DependencyManagementBom(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">'io.spring.platform:platform-bom:1.1.2.RELEASE'</span>)</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cli-multiple-source-files" href="#cli-multiple-source-files"></a>67.2&nbsp;Applications with Multiple Source Files</h2></div></div></div><p>You can use &#8220;shell globbing&#8221; with all commands that accept file input. Doing so lets
you use multiple files from a single directory, as shown in the following example:</p><pre class="screen">$ spring run *.groovy</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cli-jar" href="#cli-jar"></a>67.3&nbsp;Packaging Your Application</h2></div></div></div><p>You can use the <code class="literal">jar</code> command to package your application into a self-contained executable
jar file, as shown in the following example:</p><pre class="screen">$ spring jar my-app.jar *.groovy</pre><p>The resulting jar contains the classes produced by compiling the application and all of
the application&#8217;s dependencies so that it can then be run by using <code class="literal">java -jar</code>. The jar
file also contains entries from the application&#8217;s classpath. You can add and remove
explicit paths to the jar by using <code class="literal">--include</code> and <code class="literal">--exclude</code>. Both are comma-separated,
and both accept prefixes, in the form of &#8220;+&#8221; and &#8220;-&#8221;, to signify that they should be
removed from the defaults. The default includes are as follows:</p><pre class="screen">public/**, resources/**, static/**, templates/**, META-INF/**, *</pre><p>The default excludes are as follows:</p><pre class="screen">.*, repository/**, build/**, target/**, **/*.jar, **/*.groovy</pre><p>Type <code class="literal">spring help jar</code> on the command line for more information.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cli-init" href="#cli-init"></a>67.4&nbsp;Initialize a New Project</h2></div></div></div><p>The <code class="literal">init</code> command lets you create a new project by using <a class="link" href="https://start.spring.io" target="_top">start.spring.io</a> without
leaving the shell, as shown in the following example:</p><pre class="screen">$ spring init --dependencies=web,data-jpa my-project
Using service at https://start.spring.io
Project extracted to '/Users/developer/example/my-project'</pre><p>The preceding example creates a <code class="literal">my-project</code> directory with a Maven-based project that
uses <code class="literal">spring-boot-starter-web</code> and <code class="literal">spring-boot-starter-data-jpa</code>. You can list the
capabilities of the service by using the <code class="literal">--list</code> flag, as shown in the following example:</p><pre class="screen">$ spring init --list
=======================================
Capabilities of https://start.spring.io
=======================================

Available dependencies:
-----------------------
actuator - Actuator: Production ready features to help you monitor and manage your application
...
web - Web: Support for full-stack web development, including Tomcat and spring-webmvc
websocket - Websocket: Support for WebSocket development
ws - WS: Support for Spring Web Services

Available project types:
------------------------
gradle-build -  Gradle Config [format:build, build:gradle]
gradle-project -  Gradle Project [format:project, build:gradle]
maven-build -  Maven POM [format:build, build:maven]
maven-project -  Maven Project [format:project, build:maven] (default)

...</pre><p>The <code class="literal">init</code> command supports many options. See the <code class="literal">help</code> output for more details. For
instance, the following command creates a Gradle project that uses Java 8 and <code class="literal">war</code>
packaging:</p><pre class="screen">$ spring init --build=gradle --java-version=1.8 --dependencies=websocket --packaging=war sample-app.zip
Using service at https://start.spring.io
Content saved to 'sample-app.zip'</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cli-shell" href="#cli-shell"></a>67.5&nbsp;Using the Embedded Shell</h2></div></div></div><p>Spring Boot includes command-line completion scripts for the BASH and zsh shells. If you
do not use either of these shells (perhaps you are a Windows user), you can use the
<code class="literal">shell</code> command to launch an integrated shell, as shown in the following example:</p><pre class="screen">$ spring shell
<span class="strong"><strong>Spring Boot</strong></span> (v2.1.4.RELEASE)
Hit TAB to complete. Type \'help' and hit RETURN for help, and \'exit' to quit.</pre><p>From inside the embedded shell, you can run other commands directly:</p><pre class="screen">$ version
Spring CLI v2.1.4.RELEASE</pre><p>The embedded shell supports ANSI color output as well as <code class="literal">tab</code> completion. If you need to
run a native command, you can use the <code class="literal">!</code> prefix. To exit the embedded shell, press
<code class="literal">ctrl-c</code>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cli-install-uninstall" href="#cli-install-uninstall"></a>67.6&nbsp;Adding Extensions to the CLI</h2></div></div></div><p>You can add extensions to the CLI by using the <code class="literal">install</code> command. The command takes one
or more sets of artifact coordinates in the format <code class="literal">group:artifact:version</code>, as shown in
the following example:</p><pre class="screen">$ spring install com.example:spring-boot-cli-extension:1.0.0.RELEASE</pre><p>In addition to installing the artifacts identified by the coordinates you supply, all of
the artifacts' dependencies are also installed.</p><p>To uninstall a dependency, use the <code class="literal">uninstall</code> command. As with the <code class="literal">install</code> command, it
takes one or more sets of artifact coordinates in the format of <code class="literal">group:artifact:version</code>,
as shown in the following example:</p><pre class="screen">$ spring uninstall com.example:spring-boot-cli-extension:1.0.0.RELEASE</pre><p>It uninstalls the artifacts identified by the coordinates you supply and their
dependencies.</p><p>To uninstall all additional dependencies, you can use the <code class="literal">--all</code> option, as shown in the
following example:</p><pre class="screen">$ spring uninstall --all</pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="cli-installation.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="cli.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="cli-groovy-beans-dsl.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">66.&nbsp;Installing the CLI&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;68.&nbsp;Developing Applications with the Groovy Beans DSL</td></tr></table></div></body></html>