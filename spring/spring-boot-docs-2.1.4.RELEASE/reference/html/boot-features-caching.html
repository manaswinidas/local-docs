<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>33.&nbsp;Caching</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="Spring Boot Reference Guide"><link rel="up" href="boot-features.html" title="Part&nbsp;IV.&nbsp;Spring Boot features"><link rel="prev" href="boot-features-nosql.html" title="32.&nbsp;Working with NoSQL Technologies"><link rel="next" href="boot-features-messaging.html" title="34.&nbsp;Messaging"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">33.&nbsp;Caching</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="boot-features-nosql.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;IV.&nbsp;Spring Boot features</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="boot-features-messaging.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="boot-features-caching" href="#boot-features-caching"></a>33.&nbsp;Caching</h2></div></div></div><p>The Spring Framework provides support for transparently adding caching to an application.
At its core, the abstraction applies caching to methods, thus reducing the number of
executions based on the information available in the cache. The caching logic is applied
transparently, without any interference to the invoker.  Spring Boot auto-configures the
cache infrastructure as long as caching support is enabled via the <code class="literal">@EnableCaching</code>
annotation.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Check the <a class="link" href="https://docs.spring.io/spring/docs/5.1.6.RELEASE/spring-framework-reference/integration.html#cache" target="_top">relevant section</a> of the Spring
Framework reference for more details.</p></td></tr></table></div><p>In a nutshell, adding caching to an operation of your service is as easy as adding the
relevant annotation to its method, as shown in the following example:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">import</span> org.springframework.cache.annotation.Cacheable;
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">import</span> org.springframework.stereotype.Component;

<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Component</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> MathService {

	<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Cacheable("piDecimals")</xslthl:annotation>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">int</span> computePiDecimal(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">int</span> i) {
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment">// ...</span>
	}

}</pre><p>This example demonstrates the use of caching on a potentially costly operation. Before
invoking <code class="literal">computePiDecimal</code>, the abstraction looks for an entry in the <code class="literal">piDecimals</code> cache
that matches the <code class="literal">i</code> argument. If an entry is found, the content in the cache is
immediately returned to the caller, and the method is not invoked. Otherwise, the method
is invoked, and the cache is updated before returning the value.</p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Caution"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Caution]" src="images/caution.png"></td><th align="left">Caution</th></tr><tr><td align="left" valign="top"><p>You can also use the standard JSR-107 (JCache) annotations (such as
<code class="literal">@CacheResult</code>) transparently. However, we strongly advise you to not mix and match the
Spring Cache and JCache annotations.</p></td></tr></table></div><p>If you do not add any specific cache library, Spring Boot auto-configures a
<a class="link" href="boot-features-caching.html#boot-features-caching-provider-simple" title="33.1.9&nbsp;Simple">simple provider</a> that uses concurrent maps in
memory. When a cache is required (such as <code class="literal">piDecimals</code> in the preceding example), this
provider creates it for you. The simple provider is not really recommended for
production usage, but it is great for getting started and making sure that you understand
the features. When you have made up your mind about the cache provider to use, please
make sure to read its documentation to figure out how to configure the caches that your
application uses. Nearly all providers require you to explicitly configure every cache
that you use in the application. Some offer a way to customize the default caches defined
by the <code class="literal">spring.cache.cache-names</code> property.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>It is also possible to transparently
<a class="link" href="https://docs.spring.io/spring/docs/5.1.6.RELEASE/spring-framework-reference/integration.html#cache-annotations-put" target="_top">update</a> or
<a class="link" href="https://docs.spring.io/spring/docs/5.1.6.RELEASE/spring-framework-reference/integration.html#cache-annotations-evict" target="_top">evict</a> data from the cache.</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="boot-features-caching-provider" href="#boot-features-caching-provider"></a>33.1&nbsp;Supported Cache Providers</h2></div></div></div><p>The cache abstraction does not provide an actual store and relies on abstraction
materialized by the <code class="literal">org.springframework.cache.Cache</code> and
<code class="literal">org.springframework.cache.CacheManager</code> interfaces.</p><p>If you have not defined a bean of type <code class="literal">CacheManager</code> or a <code class="literal">CacheResolver</code> named
<code class="literal">cacheResolver</code> (see
<a class="link" href="https://docs.spring.io/spring/docs/5.1.6.RELEASE/javadoc-api/org/springframework/cache/annotation/CachingConfigurer.html" target="_top"><code class="literal">CachingConfigurer</code></a>),
Spring Boot tries to detect the following providers (in the indicated order):</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><a class="link" href="boot-features-caching.html#boot-features-caching-provider-generic" title="33.1.1&nbsp;Generic">Generic</a></li><li class="listitem"><a class="link" href="boot-features-caching.html#boot-features-caching-provider-jcache" title="33.1.2&nbsp;JCache (JSR-107)">JCache (JSR-107)</a> (EhCache 3, Hazelcast,
Infinispan, and others)</li><li class="listitem"><a class="link" href="boot-features-caching.html#boot-features-caching-provider-ehcache2" title="33.1.3&nbsp;EhCache 2.x">EhCache 2.x</a></li><li class="listitem"><a class="link" href="boot-features-caching.html#boot-features-caching-provider-hazelcast" title="33.1.4&nbsp;Hazelcast">Hazelcast</a></li><li class="listitem"><a class="link" href="boot-features-caching.html#boot-features-caching-provider-infinispan" title="33.1.5&nbsp;Infinispan">Infinispan</a></li><li class="listitem"><a class="link" href="boot-features-caching.html#boot-features-caching-provider-couchbase" title="33.1.6&nbsp;Couchbase">Couchbase</a></li><li class="listitem"><a class="link" href="boot-features-caching.html#boot-features-caching-provider-redis" title="33.1.7&nbsp;Redis">Redis</a></li><li class="listitem"><a class="link" href="boot-features-caching.html#boot-features-caching-provider-caffeine" title="33.1.8&nbsp;Caffeine">Caffeine</a></li><li class="listitem"><a class="link" href="boot-features-caching.html#boot-features-caching-provider-simple" title="33.1.9&nbsp;Simple">Simple</a></li></ol></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>It is also possible to <span class="emphasis"><em>force</em></span> a particular cache provider by setting the
<code class="literal">spring.cache.type</code> property. Use this property if you need to
<a class="link" href="boot-features-caching.html#boot-features-caching-provider-none" title="33.1.10&nbsp;None">disable caching altogether</a> in certain environment
(such as tests).</p></td></tr></table></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>Use the <code class="literal">spring-boot-starter-cache</code> &#8220;Starter&#8221; to quickly add basic caching
dependencies. The starter brings in <code class="literal">spring-context-support</code>. If you add dependencies
manually, you must include <code class="literal">spring-context-support</code> in order to use the JCache,
EhCache 2.x, or Guava support.</p></td></tr></table></div><p>If the <code class="literal">CacheManager</code> is auto-configured by Spring Boot, you can further tune its
configuration before it is fully initialized by exposing a bean that implements the
<code class="literal">CacheManagerCustomizer</code> interface. The following example sets a flag to say that null
values should be passed down to the underlying map:</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Bean</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> CacheManagerCustomizer&lt;ConcurrentMapCacheManager&gt; cacheManagerCustomizer() {
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> CacheManagerCustomizer&lt;ConcurrentMapCacheManager&gt;() {
		<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Override</xslthl:annotation>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> customize(ConcurrentMapCacheManager cacheManager) {
			cacheManager.setAllowNullValues(false);
		}
	};
}</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>In the preceding example, an auto-configured <code class="literal">ConcurrentMapCacheManager</code> is expected. If
that is not the case (either you provided your own config or a different cache provider
was auto-configured), the customizer is not invoked at all. You can have as many
customizers as you want, and you can also order them by using <code class="literal">@Order</code> or <code class="literal">Ordered</code>.</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="boot-features-caching-provider-generic" href="#boot-features-caching-provider-generic"></a>33.1.1&nbsp;Generic</h3></div></div></div><p>Generic caching is used if the context defines <span class="emphasis"><em>at least</em></span> one
<code class="literal">org.springframework.cache.Cache</code> bean. A <code class="literal">CacheManager</code> wrapping all beans of that type
is created.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="boot-features-caching-provider-jcache" href="#boot-features-caching-provider-jcache"></a>33.1.2&nbsp;JCache (JSR-107)</h3></div></div></div><p><a class="link" href="https://jcp.org/en/jsr/detail?id=107" target="_top">JCache</a> is bootstrapped through the presence of a
<code class="literal">javax.cache.spi.CachingProvider</code> on the classpath (that is, a JSR-107 compliant caching
library exists on the classpath), and the <code class="literal">JCacheCacheManager</code> is provided by the
<code class="literal">spring-boot-starter-cache</code> &#8220;Starter&#8221;. Various compliant libraries are available, and
Spring Boot provides dependency management for Ehcache 3, Hazelcast, and Infinispan. Any
other compliant library can be added as well.</p><p>It might happen that more than one provider is present, in which case the provider must
be explicitly specified. Even if the JSR-107 standard does not enforce a standardized way
to define the location of the configuration file, Spring Boot does its best to
accommodate setting a cache with implementation details, as shown in the following
example:</p><pre class="programlisting">   <span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># Only necessary if more than one provider is present</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cache.jcache.provider</span>=com.acme.MyCachingProvider
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cache.jcache.config</span>=classpath:acme.xml</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>When a cache library offers both a native implementation and JSR-107 support,
Spring Boot prefers the JSR-107 support, so that the same features are available if you
switch to a different JSR-107 implementation.</p></td></tr></table></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>Spring Boot has <a class="link" href="boot-features-hazelcast.html" title="40.&nbsp;Hazelcast">general support for Hazelcast</a>. If a
single <code class="literal">HazelcastInstance</code> is available, it is automatically reused for the
<code class="literal">CacheManager</code> as well, unless the <code class="literal">spring.cache.jcache.config</code> property is specified.</p></td></tr></table></div><p>There are two ways to customize the underlying <code class="literal">javax.cache.cacheManager</code>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Caches can be created on startup by setting the <code class="literal">spring.cache.cache-names</code> property. If
a custom <code class="literal">javax.cache.configuration.Configuration</code> bean is defined, it is used to
customize them.</li><li class="listitem"><code class="literal">org.springframework.boot.autoconfigure.cache.JCacheManagerCustomizer</code> beans are
invoked with the reference of the <code class="literal">CacheManager</code> for full customization.</li></ul></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>If a standard <code class="literal">javax.cache.CacheManager</code> bean is defined, it is wrapped
automatically in an <code class="literal">org.springframework.cache.CacheManager</code> implementation that the
abstraction expects. No further customization is applied to it.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="boot-features-caching-provider-ehcache2" href="#boot-features-caching-provider-ehcache2"></a>33.1.3&nbsp;EhCache 2.x</h3></div></div></div><p><a class="link" href="https://www.ehcache.org/" target="_top">EhCache</a> 2.x is used if a file named <code class="literal">ehcache.xml</code> can be found at
the root of the classpath. If EhCache 2.x is found, the <code class="literal">EhCacheCacheManager</code> provided by
the <code class="literal">spring-boot-starter-cache</code> &#8220;Starter&#8221; is used to bootstrap the cache manager. An
alternate configuration file can be provided as well, as shown in the following example:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cache.ehcache.config</span>=classpath:config/another-config.xml</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="boot-features-caching-provider-hazelcast" href="#boot-features-caching-provider-hazelcast"></a>33.1.4&nbsp;Hazelcast</h3></div></div></div><p>Spring Boot has <a class="link" href="boot-features-hazelcast.html" title="40.&nbsp;Hazelcast">general support for Hazelcast</a>. If a
<code class="literal">HazelcastInstance</code> has been auto-configured, it is automatically wrapped in a
<code class="literal">CacheManager</code>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="boot-features-caching-provider-infinispan" href="#boot-features-caching-provider-infinispan"></a>33.1.5&nbsp;Infinispan</h3></div></div></div><p><a class="link" href="https://infinispan.org/" target="_top">Infinispan</a> has no default configuration file location, so it must
be specified explicitly. Otherwise, the default bootstrap is used.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cache.infinispan.config</span>=infinispan.xml</pre><p>Caches can be created on startup by setting the <code class="literal">spring.cache.cache-names</code> property. If a
custom <code class="literal">ConfigurationBuilder</code> bean is defined, it is used to customize the caches.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The support of Infinispan in Spring Boot is restricted to the embedded mode and is quite
basic. If you want more options, you should use the official Infinispan Spring Boot
starter instead. See
<a class="link" href="https://github.com/infinispan/infinispan-spring-boot" target="_top">Infinispan&#8217;s documentation</a> for more
details.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="boot-features-caching-provider-couchbase" href="#boot-features-caching-provider-couchbase"></a>33.1.6&nbsp;Couchbase</h3></div></div></div><p>If the <a class="link" href="https://www.couchbase.com/" target="_top">Couchbase</a> Java client and the <code class="literal">couchbase-spring-cache</code>
implementation are available and Couchbase is <a class="link" href="boot-features-nosql.html#boot-features-couchbase" title="32.8&nbsp;Couchbase">configured</a>, a
<code class="literal">CouchbaseCacheManager</code> is auto-configured. It is also possible to create additional
caches on startup by setting the <code class="literal">spring.cache.cache-names</code> property. These caches
operate on the <code class="literal">Bucket</code> that was auto-configured. You can <span class="emphasis"><em>also</em></span> create additional caches
on another <code class="literal">Bucket</code> by using the customizer. Assume you need two caches (<code class="literal">cache1</code> and
<code class="literal">cache2</code>) on the "main" <code class="literal">Bucket</code> and one (<code class="literal">cache3</code>) cache with a custom time to live of 2
seconds on the &#8220;another&#8221; <code class="literal">Bucket</code>. You can create the first two caches through
configuration, as follows:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cache.cache-names</span>=cache1,cache2</pre><p>Then you can define a <code class="literal">@Configuration</code> class to configure the extra <code class="literal">Bucket</code> and the
<code class="literal">cache3</code> cache, as follows:</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Configuration</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> CouchbaseCacheConfiguration {

	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">private</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">final</span> Cluster cluster;

	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> CouchbaseCacheConfiguration(Cluster cluster) {
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">this</span>.cluster = cluster;
	}

	<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Bean</xslthl:annotation>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> Bucket anotherBucket() {
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">this</span>.cluster.openBucket(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"another"</span>, <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"secret"</span>);
	}

	<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Bean</xslthl:annotation>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> CacheManagerCustomizer&lt;CouchbaseCacheManager&gt; cacheManagerCustomizer() {
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> c -&gt; {
			c.prepareCache(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"cache3"</span>, CacheBuilder.newInstance(anotherBucket())
					.withExpiration(<xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">2</xslthl:number>));
		};
	}

}</pre><p>This sample configuration reuses the <code class="literal">Cluster</code> that was created through
auto-configuration.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="boot-features-caching-provider-redis" href="#boot-features-caching-provider-redis"></a>33.1.7&nbsp;Redis</h3></div></div></div><p>If <a class="link" href="https://redis.io/" target="_top">Redis</a> is available and configured, a <code class="literal">RedisCacheManager</code> is
auto-configured. It is possible to create additional caches on startup by setting the
<code class="literal">spring.cache.cache-names</code> property and cache defaults can be configured by using
<code class="literal">spring.cache.redis.*</code> properties. For instance, the following configuration creates
<code class="literal">cache1</code> and <code class="literal">cache2</code> caches with a <span class="emphasis"><em>time to live</em></span> of 10 minutes:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cache.cache-names</span>=cache1,cache2
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cache.redis.time-to-live</span>=600000</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>By default, a key prefix is added so that, if two separate caches use the same
key, Redis does not have overlapping keys and cannot return invalid values. We strongly
recommend keeping this setting enabled if you create your own <code class="literal">RedisCacheManager</code>.</p></td></tr></table></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>You can take full control of the configuration by adding a <code class="literal">RedisCacheConfiguration</code>
<code class="literal">@Bean</code> of your own. This can be useful if you&#8217;re looking for customizing the
serialization strategy.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="boot-features-caching-provider-caffeine" href="#boot-features-caching-provider-caffeine"></a>33.1.8&nbsp;Caffeine</h3></div></div></div><p><a class="link" href="https://github.com/ben-manes/caffeine" target="_top">Caffeine</a> is a Java 8 rewrite of Guava&#8217;s cache that
supersedes support for Guava. If Caffeine is present, a <code class="literal">CaffeineCacheManager</code> (provided
by the <code class="literal">spring-boot-starter-cache</code> &#8220;Starter&#8221;) is auto-configured. Caches can be created
on startup by setting the <code class="literal">spring.cache.cache-names</code> property and can be customized by one
of the following (in the indicated order):</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">A cache spec defined by <code class="literal">spring.cache.caffeine.spec</code></li><li class="listitem">A <code class="literal">com.github.benmanes.caffeine.cache.CaffeineSpec</code> bean is defined</li><li class="listitem">A <code class="literal">com.github.benmanes.caffeine.cache.Caffeine</code> bean is defined</li></ol></div><p>For instance, the following configuration creates <code class="literal">cache1</code> and <code class="literal">cache2</code> caches with a
maximum size of 500 and a <span class="emphasis"><em>time to live</em></span> of 10 minutes</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cache.cache-names</span>=cache1,cache2
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cache.caffeine.spec</span>=maximumSize=500,expireAfterAccess=600s</pre><p>If a <code class="literal">com.github.benmanes.caffeine.cache.CacheLoader</code> bean is defined, it is
automatically associated to the <code class="literal">CaffeineCacheManager</code>. Since the <code class="literal">CacheLoader</code> is going
to be associated with <span class="emphasis"><em>all</em></span> caches managed by the cache manager, it must be defined as
<code class="literal">CacheLoader&lt;Object, Object&gt;</code>. The auto-configuration ignores any other generic type.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="boot-features-caching-provider-simple" href="#boot-features-caching-provider-simple"></a>33.1.9&nbsp;Simple</h3></div></div></div><p>If none of the other providers can be found, a simple implementation using a
<code class="literal">ConcurrentHashMap</code> as the cache store is configured. This is the default if no caching
library is present in your application. By default, caches are created as needed, but you
can restrict the list of available caches by setting the <code class="literal">cache-names</code> property. For
instance, if you want only <code class="literal">cache1</code> and <code class="literal">cache2</code> caches, set the <code class="literal">cache-names</code> property
as follows:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cache.cache-names</span>=cache1,cache2</pre><p>If you do so and your application uses a cache not listed, then it fails at runtime when
the cache is needed, but not on startup. This is similar to the way the "real" cache
providers behave if you use an undeclared cache.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="boot-features-caching-provider-none" href="#boot-features-caching-provider-none"></a>33.1.10&nbsp;None</h3></div></div></div><p>When <code class="literal">@EnableCaching</code> is present in your configuration, a suitable cache configuration is
expected as well. If you need to disable caching altogether in certain environments,
force the cache type to <code class="literal">none</code> to use a no-op implementation, as shown in the following
example:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cache.type</span>=none</pre></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="boot-features-nosql.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="boot-features.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="boot-features-messaging.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">32.&nbsp;Working with NoSQL Technologies&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;34.&nbsp;Messaging</td></tr></table></div></body></html>