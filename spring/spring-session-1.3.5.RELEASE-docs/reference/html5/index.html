<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="Rob Winch, Vedran PaviÄ‡, Jakub Kubrynski">
<title>Spring Session</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{font-weight: normal}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#00}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Spring Session</h1>
<div class="details">
<span id="author" class="author">Rob Winch, Vedran PaviÄ‡, Jakub Kubrynski</span><br>
<span id="revnumber">version 1.3.5.RELEASE</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-s-new-in-1-3">What&#8217;s New in 1.3</a></li>
<li><a href="#samples">Samples and Guides (Start Here)</a></li>
<li><a href="#httpsession">HttpSession Integration</a>
<ul class="sectlevel2">
<li><a href="#httpsession-why">Why Spring Session &amp; HttpSession?</a></li>
<li><a href="#httpsession-redis">HttpSession with Redis</a></li>
<li><a href="#httpsession-gemfire">HttpSession with Pivotal GemFire</a></li>
<li><a href="#httpsession-jdbc">HttpSession with JDBC</a></li>
<li><a href="#httpsession-mongo">HttpSession with Mongo</a></li>
<li><a href="#httpsession-hazelcast">HttpSession with Hazelcast</a></li>
<li><a href="#httpsession-how">How HttpSession Integration Works</a></li>
<li><a href="#httpsession-multi">Multiple HttpSessions in Single Browser</a></li>
<li><a href="#httpsession-rest">HttpSession &amp; RESTful APIs</a></li>
<li><a href="#httpsession-httpsessionlistener">HttpSessionListener</a></li>
</ul>
</li>
<li><a href="#websocket">WebSocket Integration</a>
<ul class="sectlevel2">
<li><a href="#websocket-why">Why Spring Session &amp; WebSockets?</a></li>
<li><a href="#websocket-usage">WebSocket Usage</a></li>
</ul>
</li>
<li><a href="#spring-security">Spring Security Integration</a>
<ul class="sectlevel2">
<li><a href="#spring-security-rememberme">Spring Security Remember-Me Support</a></li>
<li><a href="#spring-security-concurrent-sessions">Spring Security Concurrent Session Control</a></li>
<li><a href="#spring-security-concurrent-sessions-limitations">Limitations</a></li>
</ul>
</li>
<li><a href="#api">API Documentation</a>
<ul class="sectlevel2">
<li><a href="#api-session">Session</a></li>
<li><a href="#api-expiringsession">ExpiringSession</a></li>
<li><a href="#api-sessionrepository">SessionRepository</a></li>
<li><a href="#api-findbyindexnamesessionrepository">FindByIndexNameSessionRepository</a></li>
<li><a href="#api-enablespringhttpsession">EnableSpringHttpSession</a></li>
<li><a href="#api-redisoperationssessionrepository">RedisOperationsSessionRepository</a></li>
<li><a href="#api-gemfireoperationssessionrepository">GemFireOperationsSessionRepository</a></li>
<li><a href="#api-mapsessionrepository">MapSessionRepository</a></li>
<li><a href="#api-jdbcoperationssessionrepository">JdbcOperationsSessionRepository</a></li>
<li><a href="#api-hazelcastsessionrepository">HazelcastSessionRepository</a></li>
</ul>
</li>
<li><a href="#community">Spring Session Community</a>
<ul class="sectlevel2">
<li><a href="#community-support">Support</a></li>
<li><a href="#community-source">Source Code</a></li>
<li><a href="#community-issues">Issue Tracking</a></li>
<li><a href="#community-contributing">Contributing</a></li>
<li><a href="#community-license">License</a></li>
<li><a href="#community-extensions">Community Extensions</a></li>
</ul>
</li>
<li><a href="#minimum-requirements">Minimum Requirements</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div id="abstract" class="paragraph">
<p>Spring Session provides an API and implementations for managing a user&#8217;s session information.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides an API and implementations for managing a user&#8217;s session information. It also provides transparent integration with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#httpsession">HttpSession</a> - allows replacing the HttpSession in an application container (i.e. Tomcat) neutral way.
Additional features include:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Clustered Sessions</strong> - Spring Session makes it trivial to support <a href="#httpsession-redis">clustered sessions</a> without being tied to an application container specific solution.</p>
</li>
<li>
<p><strong>Multiple Browser Sessions</strong> - Spring Session supports <a href="#httpsession-multi">managing multiple users' sessions</a> in a single browser instance (i.e. multiple authenticated accounts similar to Google).</p>
</li>
<li>
<p><strong>RESTful APIs</strong> - Spring Session allows providing session ids in headers to work with <a href="#httpsession-rest">RESTful APIs</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#websocket">WebSocket</a> - provides the ability to keep the <code>HttpSession</code> alive when receiving WebSocket messages</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-s-new-in-1-3"><a class="anchor" href="#what-s-new-in-1-3"></a>What&#8217;s New in 1.3</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Below are the highlights of what is new in Spring Session 1.3. You can find a complete list of what&#8217;s new by referring to the changelogs of
<a href="https://github.com/spring-projects/spring-session/milestone/6?closed=1">1.3.0.M1</a>,
<a href="https://github.com/spring-projects/spring-session/milestone/18?closed=1">1.3.0.M2</a>,
<a href="https://github.com/spring-projects/spring-session/milestone/16?closed=1">1.3.0.RC1</a>, and
<a href="https://github.com/spring-projects/spring-session/milestone/19?closed=1">1.3.0.RELEASE</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First class support for <a href="http://docs.spring.io/spring-session/docs/1.3.0.RELEASE/reference/html5/#httpsession-hazelcast">Hazelcast</a></p>
</li>
<li>
<p>First class support for <a href="http://docs.spring.io/spring-session/docs/1.3.0.RELEASE/reference/html5/#spring-security-concurrent-sessions-how">Spring Security&#8217;s concurrent session management</a></p>
</li>
<li>
<p>Added <a href="https://github.com/maseev/spring-session-orientdb">OrientDB Community Extension</a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-session/tree/1.3.0.RELEASE/samples/httpsession-redis-json">GenericJackson2JsonRedisSerializer sample</a> with Spring Security&#8217;s new Jackson Support</p>
</li>
<li>
<p>Guides now <a href="https://github.com/spring-projects/spring-session/pull/652">use Lettuce</a></p>
</li>
<li>
<p><code>spring.session.cleanup.cron.expression</code> can be used to override the cleanup taskâ€™s cron expression</p>
</li>
<li>
<p>Lots of performance improvements and bug fixes</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="samples"><a class="anchor" href="#samples"></a>Samples and Guides (Start Here)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you are looking to get started with Spring Session, the best place to start is our Sample Applications.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Sample Applications</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Source</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Guide</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/httpsession">HttpSession</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a Redis store.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/httpsession.html">HttpSession Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/httpsession-xml">HttpSession XML</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a Redis store using XML based configuration.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/httpsession-xml.html">HttpSession XML Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/httpsession-gemfire-boot">HttpSession with GemFire using Spring Boot</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with GemFire using a Client/Server topology in a Spring Boot application.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/httpsession-gemfire-boot.html">HttpSession GemFire Boot Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/httpsession-gemfire-clientserver">HttpSession with GemFire (Client/Server)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with GemFire using a Client/Server topology.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/httpsession-gemfire-clientserver.html">HttpSession GemFire Client/Server Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/httpsession-gemfire-clientserver-xml">HttpSession with GemFire (Client/Server) using XML</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with GemFire using a Client/Server topology configured with XML.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/httpsession-gemfire-clientserver-xml.html">HttpSession GemFire Client/Server XML Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/httpsession-gemfire-p2p">HttpSession with GemFire (P2P)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with GemFire using a P2P topology.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/httpsession-gemfire-p2p.html">HttpSession GemFire P2P Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/httpsession-gemfire-p2p-xml">HttpSession with GemFire (P2P) using XML</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with GemFire using a P2P topology configured with XML.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/httpsession-gemfire-p2p-xml.html">HttpSession GemFire P2P XML Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/custom-cookie">Custom Cookie</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session and customize the cookie.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/custom-cookie.html">Custom Cookie Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/boot">Spring Boot</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with Spring Boot.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/boot.html">Spring Boot Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/grails3">Grails 3</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with Grails 3.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/grails3.html">Grails 3 Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/security">Spring Security</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with an existing Spring Security application.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/security.html">Spring Security Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/rest">REST</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session in a REST application to support authenticating with a header.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/rest.html">REST Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/findbyusername">Find by Username</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to find sessions by username.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/findbyusername.html">Find by Username</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/users">Multiple Users</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to manage multiple simultaneous browser sessions (i.e Google Accounts).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/users.html">Manage Multiple Users Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/websocket">WebSocket</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with WebSockets.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/websocket.html">WebSocket Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/mongo">Mongo</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with Mongo.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/mongo.html">Mongo Guide</a>
</p><p class="tableblock"><a id="samples-hazelcast"></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/hazelcast">Hazelcast</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session with Hazelcast.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD
</p><p class="tableblock"><a id="samples-hazelcast-spring"></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/hazelcast-spring">Hazelcast Spring</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session and Hazelcast with an existing Spring Security application.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/hazelcast-spring.html">Hazelcast Spring Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/httpsession-jdbc">HttpSession JDBC</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a relational database store.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/httpsession-jdbc.html">HttpSession JDBC Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/httpsession-jdbc-xml">HttpSession JDBC XML</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a relational database store using XML based configuration.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/httpsession-jdbc-xml.html">HttpSession JDBC XML Guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-session/tree/1.3.5.RELEASE//samples/httpsession-jdbc-boot">HttpSession JDBC Spring Boot</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Demonstrates how to use Spring Session to replace the <code>HttpSession</code> with a relational database store when using Spring Boot.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guides/httpsession-jdbc-boot.html">HttpSession JDBC Spring Boot Guide</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="httpsession"><a class="anchor" href="#httpsession"></a>HttpSession Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides transparent integration with <code>HttpSession</code>.
This means that developers can switch the <code>HttpSession</code> implementation out with an implementation that is backed by Spring Session.</p>
</div>
<div class="sect2">
<h3 id="httpsession-why"><a class="anchor" href="#httpsession-why"></a>Why Spring Session &amp; HttpSession?</h3>
<div class="paragraph">
<p>We have already mentioned that Spring Session provides transparent integration with <code>HttpSession</code>, but what benefits do we get out of this?</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Clustered Sessions</strong> - Spring Session makes it trivial to support <a href="#httpsession-redis">clustered sessions</a> without being tied to an application container specific solution.</p>
</li>
<li>
<p><strong>Multiple Browser Sessions</strong> - Spring Session supports <a href="#httpsession-multi">managing multiple users' sessions</a> in a single browser instance (i.e. multiple authenticated accounts similar to Google).</p>
</li>
<li>
<p><strong>RESTful APIs</strong> - Spring Session allows providing session ids in headers to work with <a href="#httpsession-rest">RESTful APIs</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-redis"><a class="anchor" href="#httpsession-redis"></a>HttpSession with Redis</h3>
<div class="paragraph">
<p>Using Spring Session with <code>HttpSession</code> is enabled by adding a Servlet Filter before anything that uses the <code>HttpSession</code>.
You can choose from enabling this using either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#httpsession-redis-jc">Java Based Configuration</a></p>
</li>
<li>
<p><a href="#httpsession-redis-xml">XML Based Configuration</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="httpsession-redis-jc"><a class="anchor" href="#httpsession-redis-jc"></a>Redis Java Based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use Redis to back <code>HttpSession</code> using Java based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">HttpSession Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using Java configuration.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed HttpSession Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="httpsession-spring-configuration"><a class="anchor" href="#httpsession-spring-configuration"></a>Spring Java Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EnableRedisHttpSession</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Config</span> {

        <span class="annotation">@Bean</span>
        <span class="directive">public</span> LettuceConnectionFactory connectionFactory() {
                <span class="keyword">return</span> <span class="keyword">new</span> LettuceConnectionFactory(); <i class="conum" data-value="2"></i><b>(2)</b>
        }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableRedisHttpSession</code> annotation creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by Redis.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>RedisConnectionFactory</code> that connects Spring Session to the Redis Server.
We configure the connection to connect to localhost on the default port (6379)
For more information on configuring Spring Data Redis, refer to the <a href="http://docs.spring.io/spring-data/data-redis/docs/current/reference/html/">reference documentation</a>.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="java-servlet-container-initialization"><a class="anchor" href="#java-servlet-container-initialization"></a>Java Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="#httpsession-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class.
Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
Fortunately, Spring Session provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> both of these steps extremely easy.
You can find an example below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Initializer</span> <span class="directive">extends</span> AbstractHttpSessionApplicationInitializer { <i class="conum" data-value="1"></i><b>(1)</b>

        <span class="directive">public</span> Initializer() {
                <span class="local-variable">super</span>(Config.class); <i class="conum" data-value="2"></i><b>(2)</b>
        }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (Initializer) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</table>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The first step is to extend <code>AbstractHttpSessionApplicationInitializer</code>.
This ensures that the Spring Bean by the name <code>springSessionRepositoryFilter</code> is registered with our Servlet Container for every request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>AbstractHttpSessionApplicationInitializer</code> also provides a mechanism to easily ensure Spring loads our <code>Config</code>.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="httpsession-redis-xml"><a class="anchor" href="#httpsession-redis-xml"></a>Redis XML Based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use Redis to back <code>HttpSession</code> using XML based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">HttpSession XML Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using XML configuration.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed HttpSession XML Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="httpsession-xml-spring-configuration"><a class="anchor" href="#httpsession-xml-spring-configuration"></a>Spring XML Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/spring/session.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><i class="conum" data-value="1"></i><b>(1)</b>
<span class="tag">&lt;context:annotation-config</span><span class="tag">/&gt;</span>
<span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.session.data.redis.config.annotation.web.http.RedisHttpSessionConfiguration</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

<i class="conum" data-value="2"></i><b>(2)</b>
<span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We use the combination of <code>&lt;context:annotation-config/&gt;</code> and <code>RedisHttpSessionConfiguration</code> because Spring Session does not yet provide XML Namespace support (see <a href="https://github.com/spring-projects/spring-session/issues/104">gh-104</a>).
This creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by Redis.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>RedisConnectionFactory</code> that connects Spring Session to the Redis Server.
We configure the connection to connect to localhost on the default port (6379)
For more information on configuring Spring Data Redis, refer to the <a href="http://docs.spring.io/spring-data/data-redis/docs/current/reference/html/">reference documentation</a>.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="xml-servlet-container-initialization"><a class="anchor" href="#xml-servlet-container-initialization"></a>XML Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="#httpsession-xml-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, we need to instruct Spring to load our <code>session.xml</code> configuration.
We do this with the following configuration:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>contextConfigLocation<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>
        /WEB-INF/spring/*.xml
    <span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;listener&gt;</span>
    <span class="tag">&lt;listener-class&gt;</span>
        org.springframework.web.context.ContextLoaderListener
    <span class="tag">&lt;/listener-class&gt;</span>
<span class="tag">&lt;/listener&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#context-create">ContextLoaderListener</a> reads the contextConfigLocation and picks up our session.xml configuration.</p>
</div>
<div class="paragraph">
<p>Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
The following snippet performs this last step for us:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>springSessionRepositoryFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;filter-class&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span class="tag">&lt;/filter-class&gt;</span>
<span class="tag">&lt;/filter&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>springSessionRepositoryFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>/*<span class="tag">&lt;/url-pattern&gt;</span>
    <span class="tag">&lt;dispatcher&gt;</span>REQUEST<span class="tag">&lt;/dispatcher&gt;</span>
    <span class="tag">&lt;dispatcher&gt;</span>ERROR<span class="tag">&lt;/dispatcher&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="http://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/filter/DelegatingFilterProxy.html">DelegatingFilterProxy</a> will look up a Bean by the name of <code>springSessionRepositoryFilter</code> and cast it to a <code>Filter</code>.
For every request that <code>DelegatingFilterProxy</code> is invoked, the <code>springSessionRepositoryFilter</code> will be invoked.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-gemfire"><a class="anchor" href="#httpsession-gemfire"></a>HttpSession with Pivotal GemFire</h3>
<div class="paragraph">
<p>When <a href="https://pivotal.io/big-data/pivotal-gemfire">Pivotal GemFire</a> is used with Spring Session, a web application&#8217;s
<code>HttpSession</code> can be replaced with a <strong>clustered</strong> implementation managed by GemFire and conveniently accessed
with Spring Session&#8217;s API.</p>
</div>
<div class="paragraph">
<p>The two most common topologies to manage Spring Sessions using GemFire include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#httpsession-gemfire-clientserver">Client-Server</a></p>
</li>
<li>
<p><a href="#httpsession-gemfire-p2p">Peer-To-Peer (P2P)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additionally, GemFire supports site-to-site replication using <a href="http://gemfire.docs.pivotal.io/docs-gemfire/latest/topologies_and_comm/multi_site_configuration/chapter_overview.html">WAN functionality</a>.
The ability to configure and use GemFire&#8217;s WAN support is independent of Spring Session, and is beyond the scope
of this document. More details on GemFire WAN functionality can be found <a href="http://docs.spring.io/spring-data-gemfire/docs/current/reference/html/#bootstrap:gateway">here</a>.</p>
</div>
<div class="sect3">
<h4 id="httpsession-gemfire-clientserver"><a class="anchor" href="#httpsession-gemfire-clientserver"></a>GemFire Client-Server</h4>
<div class="paragraph">
<p>The <a href="http://gemfire.docs.pivotal.io/docs-gemfire/latest/topologies_and_comm/cs_configuration/chapter_overview.html">Client-Server</a>
topology will probably be the more common configuration preference for users when using GemFire as a provider in
Spring Session since a GemFire server will have significantly different and unique JVM heap requirements when compared
to the application. Using a client-server topology enables an application to manage (e.g. replicate) application state
independently from other application processes.</p>
</div>
<div class="paragraph">
<p>In a client-server topology, an application using Spring Session will open a client cache connection to a (remote)
GemFire server cluster to manage and provide consistent access to all <code>HttpSession</code> state.</p>
</div>
<div class="paragraph">
<p>You can configure a Client-Server topology with either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#httpsession-gemfire-clientserver-java">Java-based Configuration</a></p>
</li>
<li>
<p><a href="#httpsession-gemfire-clientserver-xml">XML-based Configuration</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="httpsession-gemfire-clientserver-java"><a class="anchor" href="#httpsession-gemfire-clientserver-java"></a>GemFire Client-Server Java-based Configuration</h5>
<div class="paragraph">
<p>This section describes how to use GemFire&#8217;s Client-Server topology to back an <code>HttpSession</code> with Java-based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">HttpSession with GemFire (Client-Server) Sample</a> provides a working sample on how to integrate
Spring Session and GemFire to replace the HttpSession using Java configuration. You can read the basic steps for
integration below, but you are encouraged to follow along with the detailed HttpSession with GemFire (Client-Server)
Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="httpsession-spring-java-configuration"><a class="anchor" href="#httpsession-spring-java-configuration"></a>Spring Java Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies and repository declarations, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code>
with an implementation backed by Spring Session and GemFire.</p>
</div>
<div class="paragraph">
<p>Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EnableGemFireHttpSession</span>(maxInactiveIntervalInSeconds = <span class="integer">30</span>, poolName = <span class="string"><span class="delimiter">&quot;</span><span class="content">DEFAULT</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ClientConfig</span> {

        <span class="directive">static</span> <span class="directive">final</span> <span class="type">long</span> DEFAULT_WAIT_DURATION = <span class="predefined-type">TimeUnit</span>.SECONDS.toMillis(<span class="integer">20</span>);

        <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">CountDownLatch</span> latch = <span class="keyword">new</span> <span class="predefined-type">CountDownLatch</span>(<span class="integer">1</span>);

        <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> DEFAULT_GEMFIRE_LOG_LEVEL = <span class="string"><span class="delimiter">&quot;</span><span class="content">warning</span><span class="delimiter">&quot;</span></span>;

        <span class="annotation">@Bean</span>
        <span class="directive">static</span> PropertySourcesPlaceholderConfigurer propertySourcesPlaceholderConfigurer() {
                <span class="keyword">return</span> <span class="keyword">new</span> PropertySourcesPlaceholderConfigurer();
        }

        <span class="predefined-type">Properties</span> gemfireProperties() { <i class="conum" data-value="2"></i><b>(2)</b>
                <span class="predefined-type">Properties</span> gemfireProperties = <span class="keyword">new</span> <span class="predefined-type">Properties</span>();
                gemfireProperties.setProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, applicationName());
                gemfireProperties.setProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">log-level</span><span class="delimiter">&quot;</span></span>, logLevel());
                <span class="keyword">return</span> gemfireProperties;
        }

        <span class="predefined-type">String</span> applicationName() {
                <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">samples:httpsession-gemfire-clientserver:</span><span class="delimiter">&quot;</span></span>
                        .concat(getClass().getSimpleName());
        }

        <span class="predefined-type">String</span> logLevel() {
                <span class="keyword">return</span> <span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">sample.httpsession.gemfire.log-level</span><span class="delimiter">&quot;</span></span>,
                        DEFAULT_GEMFIRE_LOG_LEVEL);
        }

        <span class="annotation">@Bean</span>
        ClientCacheFactoryBean gemfireCache(
                        <span class="annotation">@Value</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">${spring.session.data.gemfire.port:</span><span class="delimiter">&quot;</span></span> + ServerConfig.SERVER_PORT + <span class="string"><span class="delimiter">&quot;</span><span class="content">}</span><span class="delimiter">&quot;</span></span>) <span class="type">int</span> port) { <i class="conum" data-value="3"></i><b>(3)</b>

                ClientCacheFactoryBean clientCacheFactory = <span class="keyword">new</span> ClientCacheFactoryBean();

                clientCacheFactory.setClose(<span class="predefined-constant">true</span>);
                clientCacheFactory.setProperties(gemfireProperties());

                <span class="comment">// GemFire Pool settings </span><i class="conum" data-value="4"></i><b>(4)</b>
                clientCacheFactory.setKeepAlive(<span class="predefined-constant">false</span>);
                clientCacheFactory.setPingInterval(<span class="predefined-type">TimeUnit</span>.SECONDS.toMillis(<span class="integer">5</span>));
                clientCacheFactory.setReadTimeout(<span class="integer">2000</span>); <span class="comment">// 2 seconds</span>
                clientCacheFactory.setRetryAttempts(<span class="integer">1</span>);
                clientCacheFactory.setSubscriptionEnabled(<span class="predefined-constant">true</span>);
                clientCacheFactory.setThreadLocalConnections(<span class="predefined-constant">false</span>);

                clientCacheFactory.setServers(<span class="predefined-type">Collections</span>.singletonList(
                        newConnectionEndpoint(ServerConfig.SERVER_HOST, port)));

                <span class="keyword">return</span> clientCacheFactory;
        }

        ConnectionEndpoint newConnectionEndpoint(<span class="predefined-type">String</span> host, <span class="type">int</span> port) {
                <span class="keyword">return</span> <span class="keyword">new</span> ConnectionEndpoint(host, port);
        }

        <span class="annotation">@Bean</span>
        BeanPostProcessor gemfireCacheServerReadyBeanPostProcessor() { <i class="conum" data-value="5"></i><b>(5)</b>
                <span class="keyword">return</span> <span class="keyword">new</span> BeanPostProcessor() {

                        <span class="directive">public</span> <span class="predefined-type">Object</span> postProcessBeforeInitialization(<span class="predefined-type">Object</span> bean, <span class="predefined-type">String</span> beanName)
                                <span class="directive">throws</span> BeansException {

                                <span class="keyword">if</span> (<span class="string"><span class="delimiter">&quot;</span><span class="content">gemfirePool</span><span class="delimiter">&quot;</span></span>.equals(beanName)) {
                                        ClientMembership.registerClientMembershipListener(
                                                <span class="keyword">new</span> ClientMembershipListenerAdapter() {
                                                        <span class="annotation">@Override</span>
                                                        <span class="directive">public</span> <span class="type">void</span> memberJoined(ClientMembershipEvent event) {
                                                                latch.countDown();
                                                        }
                                                });
                                }

                                <span class="keyword">return</span> bean;
                        }

                        <span class="directive">public</span> <span class="predefined-type">Object</span> postProcessAfterInitialization(<span class="predefined-type">Object</span> bean, <span class="predefined-type">String</span> beanName)
                                <span class="directive">throws</span> BeansException {

                                <span class="keyword">if</span> (bean <span class="keyword">instanceof</span> Pool &amp;&amp; <span class="string"><span class="delimiter">&quot;</span><span class="content">gemfirePool</span><span class="delimiter">&quot;</span></span>.equals(beanName)) {
                                        <span class="keyword">try</span> {
                                                Assert.state(latch.await(DEFAULT_WAIT_DURATION, <span class="predefined-type">TimeUnit</span>.MILLISECONDS),
                                                        <span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">GemFire Cache Server failed to start on host [%1$s] and port [%2$d]</span><span class="delimiter">&quot;</span></span>,
                                                                ServerConfig.SERVER_HOST, ServerConfig.SERVER_PORT));
                                        }
                                        <span class="keyword">catch</span> (<span class="exception">InterruptedException</span> e) {
                                                <span class="predefined-type">Thread</span>.currentThread().interrupt();
                                        }
                                }

                                <span class="keyword">return</span> bean;
                        }
                };
        }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableGemFireHttpSession</code> annotation creates a Spring bean named <code>springSessionRepositoryFilter</code> that
implements <code>Filter</code>. The filter is what replaces the <code>HttpSession</code> with an implementation backed by Spring Session
and GemFire.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Next, we register a <code>Properties</code> bean that allows us to configure certain aspects of the GemFire client cache
using <a href="http://gemfire.docs.pivotal.io/docs-gemfire/latest/reference/topics/gemfire_properties.html">GemFire&#8217;s System properties</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We use the <code>Properties</code> to configure an instance of a GemFire <code>ClientCache</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Then, we configure a <code>Pool</code> of client connections to talk to the GemFire Server in our Client/Server topology. In our
configuration, we have used sensible settings for timeouts, number of connections and so on. Also, the <code>Pool</code> has been
configured to connect directly to a server. Learn more about various <code>Pool</code> configuration settings from the
<a href="http://data-docs-samples.cfapps.io/docs-gemfire/latest/javadocs/japi/com/gemstone/gemfire/cache/client/PoolFactory.html">PoolFactory API</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Finally, we include a Spring <code>BeanPostProcessor</code> to block the client until our GemFire Server is up and running,
listening for and accepting client connections.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>gemfireCacheServerReadyBeanPostProcessor</code> is necessary in order to coordinate the client and server in
an automated fashion during testing, but unnecessary in situations where the GemFire cluster is already presently
running, such as in production.</p>
</div>
<div class="paragraph">
<p>The <code>BeanPostProcessor</code> uses a GemFire <a href="https://data-docs-samples.cfapps.io/docs-gemfire/latest/javadocs/japi/com/gemstone/gemfire/management/membership/ClientMembershipListener.html">ClientMembershipListener</a>
that will be notified when the client has successfully connected to the server. Once a connection has been established,
the listener releases the latch that the <code>BeanPostProcessor</code> will wait on (up to the specified timeout) in the
<code>postProcessAfterInitialization</code> callback to block the client.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
In typical GemFire deployments, where the cluster includes potentially hundreds of GemFire data nodes (servers),
it is more common for clients to connect to one or more GemFire Locators running in the cluster. A Locator passes meta-data
to clients about the servers available, load and which servers have the client&#8217;s data of interest, which is particularly
important for single-hop, direct data access.  See more details about the <a href="http://gemfire.docs.pivotal.io/docs-gemfire/latest/topologies_and_comm/cs_configuration/chapter_overview.html">Client/Server Topology in GemFire&#8217;s User Guide</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more information on configuring <em>Spring Data GemFire</em>, refer to the <a href="http://docs.spring.io/spring-data-gemfire/docs/current/reference/html/">reference guide</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>@EnableGemFireHttpSession</code> annotation enables a developer to configure certain aspects of both Spring Session
and GemFire out-of-the-box using the following attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>maxInactiveIntervalInSeconds</code> - controls <em>HttpSession</em> idle-timeout expiration (defaults to <strong>30 minutes</strong>).</p>
</li>
<li>
<p><code>regionName</code> - specifies the name of the GemFire Region used to store <code>HttpSession</code> state (defaults is "<strong>ClusteredSpringSessions</strong>").</p>
</li>
<li>
<p><code>clientRegionShort</code> - specifies GemFire&#8217;s <a href="http://gemfire.docs.pivotal.io/docs-gemfire/latest/developing/management_all_region_types/chapter_overview.html">data management policy</a>
with a GemFire <a href="https://data-docs-samples.cfapps.io/docs-gemfire/latest/javadocs/japi/com/gemstone/gemfire/cache/client/ClientRegionShortcut.html">ClientRegionShortcut</a>
(default is <code>PROXY</code>).  This attribute is only used when configuring client Region.</p>
</li>
<li>
<p><code>poolName</code> - name of the dedicated GemFire Pool used to connect a client to the cluster of servers.  The attribute
is only used when the application is a GemFire cache client.  Defaults to <code>gemfirePool</code>.</p>
</li>
<li>
<p><code>serverRegionShort</code> - specifies GemFire&#8217;s <a href="http://gemfire.docs.pivotal.io/docs-gemfire/latest/developing/management_all_region_types/chapter_overview.html">data management policy</a>
using a GemFire <a href="http://data-docs-samples.cfapps.io/docs-gemfire/latest/javadocs/japi/com/gemstone/gemfire/cache/RegionShortcut.html">RegionShortcut</a>
(default is <code>PARTITION</code>).  This attribute is only used when configuring server Regions, or when a p2p topology is employed.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is important to note that the GemFire client Region name must match a server Region by the same name if
the client Region is a <code>PROXY</code> or <code>CACHING_PROXY</code>.  Names are not required to match if the client Region used to
store Spring Sessions is <code>LOCAL</code>, however, keep in mind that your session state will not be propagated to the server
and you lose all benefits of using GemFire to store and manage distributed, replicated session state information
in a cluster.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>serverRegionShort</code> is ignored in a client/server cache configuration and only applies when
a peer-to-peer (P2P) topology, and more specifically, a GemFire peer cache is used.
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="server-configuration"><a class="anchor" href="#server-configuration"></a>Server Configuration</h6>
<div class="paragraph">
<p>We have only covered one side of the equation.  We also need a GemFire Server for our client to talk to and send
session state to the server to manage.</p>
</div>
<div class="paragraph">
<p>In this sample, we will use the following GemFire Server Java Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EnableGemFireHttpSession</span>(maxInactiveIntervalInSeconds = <span class="integer">30</span>) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ServerConfig</span> {

        <span class="directive">static</span> <span class="directive">final</span> <span class="type">int</span> SERVER_PORT = <span class="integer">12480</span>;

        <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> DEFAULT_GEMFIRE_LOG_LEVEL = <span class="string"><span class="delimiter">&quot;</span><span class="content">warning</span><span class="delimiter">&quot;</span></span>;
        <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> SERVER_HOST = <span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span>;

        <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">resource</span><span class="delimiter">&quot;</span></span>)
        <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">IOException</span> { <i class="conum" data-value="5"></i><b>(5)</b>
                <span class="keyword">new</span> AnnotationConfigApplicationContext(ServerConfig.class)
                        .registerShutdownHook();
        }

        <span class="annotation">@Bean</span>
        <span class="directive">static</span> PropertySourcesPlaceholderConfigurer propertyPlaceholderConfigurer() {
                <span class="keyword">return</span> <span class="keyword">new</span> PropertySourcesPlaceholderConfigurer();
        }

        <span class="predefined-type">Properties</span> gemfireProperties() { <i class="conum" data-value="2"></i><b>(2)</b>
                <span class="predefined-type">Properties</span> gemfireProperties = <span class="keyword">new</span> <span class="predefined-type">Properties</span>();

                gemfireProperties.setProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, applicationName());
                gemfireProperties.setProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">mcast-port</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span>);
                gemfireProperties.setProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">log-level</span><span class="delimiter">&quot;</span></span>, logLevel());
                gemfireProperties.setProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">jmx-manager</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>);
                gemfireProperties.setProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">jmx-manager-start</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>);

                <span class="keyword">return</span> gemfireProperties;
        }

        <span class="predefined-type">String</span> applicationName() {
                <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">samples:httpsession-gemfire-clientserver:</span><span class="delimiter">&quot;</span></span>
                        .concat(getClass().getSimpleName());
        }

        <span class="predefined-type">String</span> logLevel() {
                <span class="keyword">return</span> <span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">sample.httpsession.gemfire.log-level</span><span class="delimiter">&quot;</span></span>,
                        DEFAULT_GEMFIRE_LOG_LEVEL);
        }

        <span class="annotation">@Bean</span>
        CacheFactoryBean gemfireCache() { <i class="conum" data-value="3"></i><b>(3)</b>
                CacheFactoryBean gemfireCache = <span class="keyword">new</span> CacheFactoryBean();

                gemfireCache.setClose(<span class="predefined-constant">true</span>);
                gemfireCache.setProperties(gemfireProperties());

                <span class="keyword">return</span> gemfireCache;
        }

        <span class="annotation">@Bean</span>
        CacheServerFactoryBean gemfireCacheServer(Cache gemfireCache,
                        <span class="annotation">@Value</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">${spring.session.data.gemfire.port:</span><span class="delimiter">&quot;</span></span> + SERVER_PORT + <span class="string"><span class="delimiter">&quot;</span><span class="content">}</span><span class="delimiter">&quot;</span></span>) <span class="type">int</span> port) { <i class="conum" data-value="4"></i><b>(4)</b>

                CacheServerFactoryBean gemfireCacheServer = <span class="keyword">new</span> CacheServerFactoryBean();

                gemfireCacheServer.setAutoStartup(<span class="predefined-constant">true</span>);
                gemfireCacheServer.setBindAddress(SERVER_HOST);
                gemfireCacheServer.setCache(gemfireCache);
                gemfireCacheServer.setHostNameForClients(SERVER_HOST);
                gemfireCacheServer.setMaxTimeBetweenPings(<span class="predefined-type">Long</span>.valueOf(<span class="predefined-type">TimeUnit</span>.SECONDS.toMillis(<span class="integer">60</span>)).intValue());
                gemfireCacheServer.setPort(port);

                <span class="keyword">return</span> gemfireCacheServer;
        }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>On the server, we also configure Spring Session using the <code>@EnableGemFireHttpSession</code> annotation. This ensures
the Region names on both the client and server match (in this sample, we use the default "<em>ClusteredSpringSessions</em>").
We have also set the session timeout to <strong>30 seconds</strong>. Later, we will see how this timeout is used.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Next, we configure the GemFire Server using GemFire System Properties very much like our P2P samples.
With the <code>mcast-port</code> set to 0 and no <code>locators</code> property specified, our server will be standalone. We also allow a
JMX client (e.g. <em>Gfsh</em>) to connect to our server with the use of the GemFire-specific JMX System properties.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Then, we create an instance of a GemFire peer <code>Cache</code> initialized with our GemFire System Properties.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We also setup a GemFire <code>CacheServer</code> instance running on <strong>localhost</strong>, listening to port <strong>12480</strong>,
ready to accept our client connection.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Finally, we declare a <code>main</code> method as an entry point for launching and running our GemFire Server
from the command-line.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="java-servlet-container-initialization-2"><a class="anchor" href="#java-servlet-container-initialization-2"></a>Java Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="#httpsession-spring-java-configuration">Spring Java Configuration</a> created a Spring bean named <code>springSessionRepositoryFilter</code>
that implements <code>Filter</code>. The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code>
with a custom implementation backed by Spring Session and GemFire.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>ClientConfig</code> class. We also need to ensure our
Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request. Fortunately, Spring Session
provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> to make both of these steps extremely easy.</p>
</div>
<div class="paragraph">
<p>You can find an example below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Initializer</span> <span class="directive">extends</span> AbstractHttpSessionApplicationInitializer { <i class="conum" data-value="1"></i><b>(1)</b>

        <span class="directive">public</span> Initializer() {
                <span class="local-variable">super</span>(ClientConfig.class); <i class="conum" data-value="2"></i><b>(2)</b>
        }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (<code>Initializer</code>) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</table>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The first step is to extend <code>AbstractHttpSessionApplicationInitializer</code>.
This ensures that a Spring bean named <code>springSessionRepositoryFilter</code> is registered with our Servlet Container
and used for every request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>AbstractHttpSessionApplicationInitializer</code> also provides a mechanism to easily allow Spring to load our <code>ClientConfig</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="http-session-gemfire-clientserver-xml"><a class="anchor" href="#http-session-gemfire-clientserver-xml"></a>GemFire Client-Server XML-based Configuration</h5>
<div class="paragraph">
<p>This section describes how to use GemFire&#8217;s Client-Server topology to back an <code>HttpSession</code> with XML-based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">HttpSession with GemFire (Client-Server) using XML Sample</a> provides a working sample on how to
integrate Spring Session and GemFire to replace the <code>HttpSession</code> using XML configuration. You can read the basic steps
for integration below, but you are encouraged to follow along with the detailed HttpSession with GemFire (Client-Server)
using XML Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="httpsession-spring-xml-configuration"><a class="anchor" href="#httpsession-spring-xml-configuration"></a>Spring XML Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies and repository declarations, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code>
with an implementation backed by Spring Session and GemFire.</p>
</div>
<div class="paragraph">
<p>Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">        <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="tag">&lt;context:annotation-config</span><span class="tag">/&gt;</span>

        <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="tag">&lt;context:property-placeholder</span> <span class="attribute-name">location</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">classpath:META-INF/spring/application.properties</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

        <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sample.GemFireCacheServerReadyBeanPostProcessor</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

        <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="tag">&lt;util:properties</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">gemfireProperties</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;prop</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">log-level</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>${sample.httpsession.gemfire.log-level:warning}<span class="tag">&lt;/prop&gt;</span>
        <span class="tag">&lt;/util:properties&gt;</span>

        <i class="conum" data-value="5"></i><b>(5)</b>
        <span class="tag">&lt;gfe:client-cache</span> <span class="attribute-name">properties-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">gemfireProperties</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">pool-name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">gemfirePool</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

        <i class="conum" data-value="6"></i><b>(6)</b>
        <span class="tag">&lt;gfe:pool</span> <span class="attribute-name">keep-alive</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span>
              <span class="attribute-name">ping-interval</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5000</span><span class="delimiter">&quot;</span></span>
              <span class="attribute-name">read-timeout</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5000</span><span class="delimiter">&quot;</span></span>
              <span class="attribute-name">retry-attempts</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>
              <span class="attribute-name">subscription-enabled</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>
              <span class="attribute-name">thread-local-connections</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;gfe:server</span> <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${application.gemfire.client-server.host}</span><span class="delimiter">&quot;</span></span>
                    <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${spring.session.data.gemfire.port:${application.gemfire.client-server.port}}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/gfe:pool&gt;</span>

        <i class="conum" data-value="7"></i><b>(7)</b>
        <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.session.data.gemfire.config.annotation.web.http.GemFireHttpSessionConfiguration</span><span class="delimiter">&quot;</span></span>
                  <span class="attribute-name">p:maxInactiveIntervalInSeconds</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">30</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">p:poolName</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">DEFAULT</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Spring annotation configuration support is enabled with <code>&lt;context:annotation-config/&gt;</code> element so that any
Spring beans declared in the XML config that are annotated with either Spring or Standard Java annotations supported
by Spring will be configured appropriately.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>META-INF/spring/application.properties</code> file are used along with the <code>PropertySourcesPlaceholderConfigurer</code>
bean to replace placeholders in the Spring XML configuration meta-data with the approrpriate property values.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Then the `GemFireCacheSeverReadyBeanPostProcessor`is registered to determine whether a GemFire Server
at the designated host/port is running and listening for client connections, blocking client startup until
the server is available and ready.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Next, we include a <code>Properties</code> bean to configure certain aspects of the GemFire client cache using
<a href="http://gemfire.docs.pivotal.io/docs-gemfire/latest/reference/topics/gemfire_properties.html">GemFire&#8217;s System Properties</a>.
In this case, we are just setting GemFire&#8217;s <code>log-level</code> from a application-specific System property, defaulting
to <code>warning</code> if unspecified.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Then we create a instance of a GemFire <code>ClientCache</code> initialized with our <code>gemfireProperties</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>We configure a Pool of client connections to talk to the GemFire Server in our Client/Server topology.
In our configuration, we use sensible settings for timeouts, number of connections and so on. Also, our <code>Pool</code>
has been configured to connect directly to a server.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Finally, the <code>GemFireHttpSessionConfiguration</code> is registered to enable Spring Session functionality.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
In typical GemFire deployments, where the cluster includes potentially hundreds of GemFire data nodes (servers),
it is more common for clients to connect to one or more GemFire Locators running in the cluster. A Locator passes meta-data
to clients about the servers available, load and which servers have the client&#8217;s data of interest, which is particularly
important for single-hop, direct data access.  See more details about the <a href="http://gemfire.docs.pivotal.io/docs-gemfire/latest/topologies_and_comm/cs_configuration/chapter_overview.html">Client/Server Topology in GemFire&#8217;s User Guide</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more information on configuring <em>Spring Data GemFire</em>, refer to the <a href="http://docs.spring.io/spring-data-gemfire/docs/current/reference/html/">reference guide</a>.
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="server-configuration-2"><a class="anchor" href="#server-configuration-2"></a>Server Configuration</h6>
<div class="paragraph">
<p>We have only covered one side of the equation.  We also need a GemFire Server for our client to talk to and send
session state information to the server to manage.</p>
</div>
<div class="paragraph">
<p>In this sample, we will use the following GemFire Server Java Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">        <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="tag">&lt;context:annotation-config</span><span class="tag">/&gt;</span>

        <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="tag">&lt;context:property-placeholder</span> <span class="attribute-name">location</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">classpath:META-INF/spring/application.properties</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

        <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="tag">&lt;util:properties</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">gemfireProperties</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                <span class="tag">&lt;prop</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>GemFireClientServerHttpSessionXmlSample<span class="tag">&lt;/prop&gt;</span>
                <span class="tag">&lt;prop</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mcast-port</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>0<span class="tag">&lt;/prop&gt;</span>
                <span class="tag">&lt;prop</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">log-level</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>${sample.httpsession.gemfire.log-level:warning}<span class="tag">&lt;/prop&gt;</span>
                <span class="tag">&lt;prop</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jmx-manager</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>true<span class="tag">&lt;/prop&gt;</span>
                <span class="tag">&lt;prop</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jmx-manager-start</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>true<span class="tag">&lt;/prop&gt;</span>
        <span class="tag">&lt;/util:properties&gt;</span>

        <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="tag">&lt;gfe:cache</span> <span class="attribute-name">properties-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">gemfireProperties</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

        <i class="conum" data-value="5"></i><b>(5)</b>
        <span class="tag">&lt;gfe:cache-server</span> <span class="attribute-name">auto-startup</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">bind-address</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${application.gemfire.client-server.host}</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">host-name-for-clients</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${application.gemfire.client-server.host}</span><span class="delimiter">&quot;</span></span>
                      <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${spring.session.data.gemfire.port:${application.gemfire.client-server.port}}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

        <i class="conum" data-value="6"></i><b>(6)</b>
        <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.session.data.gemfire.config.annotation.web.http.GemFireHttpSessionConfiguration</span><span class="delimiter">&quot;</span></span>
                  <span class="attribute-name">p:maxInactiveIntervalInSeconds</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">30</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>First, we enable Spring annotation config support with the <code>&lt;context:annotation-config&gt;</code> element so that any
Spring beans declared in the XML config that are annotated with either Spring or Standard Java annotations supported
by Spring will be configured appropriately.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>A <code>PropertySourcesPlaceholderConfigurer</code> is registered to replace placeholders in our Spring XML configuration
meta-data with property values in the <code>META-INF/spring/application.properties</code> file.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Next, we configure the GemFire Server using GemFire System Properties very much like our P2P samples.
With the <code>mcast-port</code> set to 0 and no <code>locators</code> property specified, our server will be standalone. We also allow a
JMX client (e.g. <em>Gfsh</em>) to connect to our server with the use of the GemFire-specific JMX System properties.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Then we create an instance of a GemFire peer <code>Cache</code> initialized with our GemFire System Properties.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We also setup a GemFire <code>CacheServer</code> instance running on <strong>localhost</strong>, listening to port <strong>11235</strong>,
ready to accept our client connection.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Finally, we enable the same Spring Session functionality we used on the client by registering an instance of
<code>GemFireHttpSessionConfiguration</code>, except that we set the session expiration timeout to <strong>30 seconds</strong>.
We will explain later what this means.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The GemFire Server configuration gets bootstrapped with the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@ImportResource</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">META-INF/spring/session-server.xml</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="2"></i><b>(2)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Application</span> {

        <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="directive">final</span> <span class="predefined-type">String</span><span class="type">[]</span> args) {
                <span class="keyword">new</span> AnnotationConfigApplicationContext(Application.class)
                        .registerShutdownHook();
        }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Instead of a simple Java class with a main method, you could also use <em>Spring Boot</em>.
</td>
</tr>
</table>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@Configuration</code> annotation designates this Java class as a source for Spring configuration meta-data using
Spring&#8217;s annotation configuration support.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Primarily, the configuration comes from the <code>META-INF/spring/session-server.xml</code> file, which is also the reason
why <em>Spring Boot</em> was not used in this sample, since using XML seemingly defeats the purpose and benefits
of using Spring Boot. However, this sample is about demonstrating how to use Spring XML to configure
the GemFire client and server.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="xml-servlet-container-initialization-2"><a class="anchor" href="#xml-servlet-container-initialization-2"></a>XML Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="#httpsession-spring-xml-configuration">Spring XML Configuration</a> created a Spring bean named <code>springSessionRepositoryFilter</code>
that implements <code>Filter</code>. The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with
a custom implementation that is backed by Spring Session and GemFire.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, we need to instruct Spring to load our <code>session-client.xml</code> configuration file.
We do this with the following configuration:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>contextConfigLocation<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>/WEB-INF/spring/session-client.xml<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;listener&gt;</span>
    <span class="tag">&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/listener-class&gt;</span>
<span class="tag">&lt;/listener&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#context-create">ContextLoaderListener</a>
reads the <code>contextConfigLocation</code> context parameter value and picks up our <em>session-client.xml</em> configuration file.</p>
</div>
<div class="paragraph">
<p>Finally, we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code>
for every request.</p>
</div>
<div class="paragraph">
<p>The following snippet performs this last step for us:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>springSessionRepositoryFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;filter-class&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span class="tag">&lt;/filter-class&gt;</span>
<span class="tag">&lt;/filter&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>springSessionRepositoryFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>/*<span class="tag">&lt;/url-pattern&gt;</span>
    <span class="tag">&lt;dispatcher&gt;</span>REQUEST<span class="tag">&lt;/dispatcher&gt;</span>
    <span class="tag">&lt;dispatcher&gt;</span>ERROR<span class="tag">&lt;/dispatcher&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="http://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/filter/DelegatingFilterProxy.html">DelegatingFilterProxy</a>
will look up a bean by the name of <code>springSessionRepositoryFilter</code> and cast it to a <code>Filter</code>. For every request that <code>DelegatingFilterProxy</code>
is invoked, the <code>springSessionRepositoryFilter</code> will be invoked.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="httpsession-gemfire-p2p"><a class="anchor" href="#httpsession-gemfire-p2p"></a>GemFire Peer-To-Peer (P2P)</h4>
<div class="paragraph">
<p>Perhaps less common would be to configure the Spring Session application as a peer member in the GemFire cluster using
the <a href="http://gemfire.docs.pivotal.io/docs-gemfire/latest/topologies_and_comm/p2p_configuration/chapter_overview.html">Peer-To-Peer (P2P)</a> topology.
In this configuration, a Spring Session application would be an actual data node (server) in the GemFire cluster,
and <strong>not</strong> a cache client as before.</p>
</div>
<div class="paragraph">
<p>One advantage to this approach is the proximity of the application to the application&#8217;s state (i.e. it&#8217;s data). However,
there are other effective means of accomplishing similar data dependent computations, such as using GemFire&#8217;s
<a href="http://gemfire.docs.pivotal.io/docs-gemfire/latest/developing/function_exec/chapter_overview.html">Function Execution</a>.
Any of GemFire&#8217;s other <a href="http://gemfire.docs.pivotal.io/docs-gemfire/latest/getting_started/product_intro.html">features</a>
can be used when GemFire is serving as a provider in Spring Session.</p>
</div>
<div class="paragraph">
<p>P2P is very useful for both testing purposes as well as smaller, more focused and self-contained applications,
such as those found in a microservices architecture, and will most certainly improve on your application&#8217;s latency,
throughput and consistency needs.</p>
</div>
<div class="paragraph">
<p>You can configure a Peer-To-Peer (P2P) topology with either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#httpsession-gemfire-p2p-java">Java-based Configuration</a></p>
</li>
<li>
<p><a href="#httpsession-gemfire-p2p-xml">XML-based Configuration</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="httpsession-gemfire-p2p-java"><a class="anchor" href="#httpsession-gemfire-p2p-java"></a>GemFire Peer-To-Peer (P2P) Java-based Configuration</h5>
<div class="paragraph">
<p>This section describes how to use GemFire&#8217;s Peer-To-Peer (P2P) topology to back an <code>HttpSession</code> using Java-based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">HttpSession with GemFire (P2P) Sample</a> provides a working sample on how to integrate
Spring Session and GemFire to replace the <code>HttpSession</code> using Java configuration. You can read the basic steps
for integration below, but you are encouraged to follow along with the detailed HttpSession with GemFire (P2P) Guide
when integrating with your own application.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="httpsession-spring-java-configuration"><a class="anchor" href="#httpsession-spring-java-configuration"></a>Spring Java Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies and repository declarations, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code>
with an implementation backed by Spring Session and GemFire.</p>
</div>
<div class="paragraph">
<p>Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EnableGemFireHttpSession</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Config</span> {

        <span class="annotation">@Bean</span>
        <span class="predefined-type">Properties</span> gemfireProperties() { <i class="conum" data-value="2"></i><b>(2)</b>
                <span class="predefined-type">Properties</span> gemfireProperties = <span class="keyword">new</span> <span class="predefined-type">Properties</span>();

                gemfireProperties.setProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">GemFireP2PHttpSessionSample</span><span class="delimiter">&quot;</span></span>);
                gemfireProperties.setProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">mcast-port</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span>);
                gemfireProperties.setProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">log-level</span><span class="delimiter">&quot;</span></span>,
                                <span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">sample.httpsession.gemfire.log-level</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">warning</span><span class="delimiter">&quot;</span></span>));
                gemfireProperties.setProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">jmx-manager</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>);
                gemfireProperties.setProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">jmx-manager-start</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>);

                <span class="keyword">return</span> gemfireProperties;
        }

        <span class="annotation">@Bean</span>
        CacheFactoryBean gemfireCache() { <i class="conum" data-value="3"></i><b>(3)</b>
                CacheFactoryBean gemfireCache = <span class="keyword">new</span> CacheFactoryBean();

                gemfireCache.setClose(<span class="predefined-constant">true</span>);
                gemfireCache.setProperties(gemfireProperties());

                <span class="keyword">return</span> gemfireCache;
        }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableGemFireHttpSession</code> annotation creates a Spring bean named <code>springSessionRepositoryFilter</code> that
implements <code>Filter</code>. The filter is what replaces the <code>HttpSession</code> with an implementation backed by Spring Session.
In this instance, Spring Session is backed by GemFire.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Then, we configure a GemFire peer cache using standard GemFire System properties.  We give the GemFire data node
a name using the <code>name</code> property and set <code>mcast-port</code> to 0.  With the absence of a <code>locators</code> property, this data node
will be a standalone server. GemFire&#8217;s <code>log-level</code> is set using an application-specific System property (<code>sample.httpsession.gemfire.log-level</code>)
that a user can specify on the command-line when running this sample application using either Maven or Gradle (default is "<em>warning</em>").</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Finally, we create an instance of the GemFire peer cache that embeds GemFire in the same JVM process as the running
Spring Session sample application.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Additionally, we have configured this data node (server) as a GemFire Manager as well using GemFire-specific
JMX System properties that enable JMX client (e.g. <em>Gfsh</em>) to connect to this running data node.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more information on configuring <em>Spring Data GemFire</em>, refer to the <a href="http://docs.spring.io/spring-data-gemfire/docs/current/reference/html/">reference guide</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>@EnableGemFireHttpSession</code> annotation enables a developer to configure certain aspects of Spring Session
and GemFire out-of-the-box using the following attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>maxInactiveIntervalInSeconds</code> - controls HttpSession idle-timeout expiration (defaults to <strong>30 minutes</strong>).</p>
</li>
<li>
<p><code>regionName</code> - specifies the name of the GemFire Region used to store <code>HttpSession</code> state (defaults is "<em>ClusteredSpringSessions</em>").</p>
</li>
<li>
<p><code>serverRegionShort</code> - specifies GemFire <a href="http://gemfire.docs.pivotal.io/docs-gemfire/latest/developing/management_all_region_types/chapter_overview.html">data management policies</a>
with a GemFire <a href="https://data-docs-samples.cfapps.io/docs-gemfire/latest/javadocs/japi/com/gemstone/gemfire/cache/RegionShortcut.html">RegionShortcut</a>
(default is <code>PARTITION</code>).</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>clientRegionShort</code> is ignored in a peer cache configuration and only applies when a client-server topology,
and more specifically, a GemFire client cache is used.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="java-servlet-container-initialization-3"><a class="anchor" href="#java-servlet-container-initialization-3"></a>Java Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="#httpsession-spring-java-configuration">Spring Java Configuration</a> created a Spring bean named <code>springSessionRepositoryFilter</code>
that implements <code>Filter</code>. The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code>
with a custom implementation backed by Spring Session and GemFire.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class. We also need to ensure our
Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request. Fortunately, Spring Session
provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> to make both of these steps extremely easy.</p>
</div>
<div class="paragraph">
<p>You can find an example below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Initializer</span> <span class="directive">extends</span> AbstractHttpSessionApplicationInitializer { <i class="conum" data-value="1"></i><b>(1)</b>

        <span class="directive">public</span> Initializer() {
                <span class="local-variable">super</span>(Config.class); <i class="conum" data-value="2"></i><b>(2)</b>
        }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (<code>Initializer</code>) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</table>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The first step is to extend <code>AbstractHttpSessionApplicationInitializer</code>.
This ensures that a Spring bean named <code>springSessionRepositoryFilter</code> is registered with our Servlet Container
and used for every request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>AbstractHttpSessionApplicationInitializer</code> also provides a mechanism to easily allow Spring to load our <code>Config</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="httpsession-gemfire-p2p-xml"><a class="anchor" href="#httpsession-gemfire-p2p-xml"></a>GemFire Peer-To-Peer (P2P) XML-based Configuration</h5>
<div class="paragraph">
<p>This section describes how to use GemFire&#8217;s Peer-To-Peer (P2P) topology to back an <code>HttpSession</code> using XML-based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">HttpSession with GemFire (P2P) using XML Sample</a> provides a working sample on how to integrate
Spring Session and GemFire to replace the <code>HttpSession</code> using XML configuration. You can read the basic steps for
integration below, but you are encouraged to follow along with the detailed HttpSession with GemFire (P2P) using XML
Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="httpsession-spring-xml-configuration"><a class="anchor" href="#httpsession-spring-xml-configuration"></a>Spring XML Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies and repository declarations, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code>
with an implementation backed by Spring Session and GemFire.</p>
</div>
<div class="paragraph">
<p>Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/spring/session.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><i class="conum" data-value="1"></i><b>(1)</b>
<span class="tag">&lt;context:annotation-config</span><span class="tag">/&gt;</span>
<span class="tag">&lt;context:property-placeholder</span><span class="tag">/&gt;</span>

<span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.session.data.gemfire.config.annotation.web.http.GemFireHttpSessionConfiguration</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

<i class="conum" data-value="2"></i><b>(2)</b>
<span class="tag">&lt;util:properties</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">gemfireProperties</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;prop</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>GemFireP2PHttpSessionXmlSample<span class="tag">&lt;/prop&gt;</span>
    <span class="tag">&lt;prop</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">mcast-port</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>0<span class="tag">&lt;/prop&gt;</span>
    <span class="tag">&lt;prop</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">log-level</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>${sample.httpsession.gemfire.log-level:warning}<span class="tag">&lt;/prop&gt;</span>
    <span class="tag">&lt;prop</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jmx-manager</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>true<span class="tag">&lt;/prop&gt;</span>
    <span class="tag">&lt;prop</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">jmx-manager-start</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>true<span class="tag">&lt;/prop&gt;</span>
<span class="tag">&lt;/util:properties&gt;</span>

<i class="conum" data-value="3"></i><b>(3)</b>
<span class="tag">&lt;gfe:cache</span> <span class="attribute-name">properties-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">gemfireProperties</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use-bean-factory-locator</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We use the combination of <code>&lt;context:annotation-config/&gt;</code> and <code>GemFireHttpSessionConfiguration</code> because Spring Session
does not yet provide XML Namespace support (see <a href="https://github.com/spring-projects/spring-session/issues/104">gh-104</a>).
This creates a Spring bean with the name of <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>. The filter is what
replaces the <code>HttpSession</code> with an implementation backed by Spring Session.
In this instance, Spring Session is backed by GemFire.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Then, we configure a GemFire peer cache using standard GemFire System properties.  We give the GemFire data node
a name using the <code>name</code> property and set <code>mcast-port</code> to 0.  With the absence of a <code>locators</code> property, this data node
will be a standalone server. GemFire&#8217;s <code>log-level</code> is set using an application-specific System property
(<code>sample.httpsession.gemfire.log-level</code>) that a user can specify on the command-line when running this application
using either Maven or Gradle (default is "<em>warning</em>").</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Finally, we create an instance of the GemFire peer cache that embeds GemFire in the same JVM process as the running
Spring Session sample application.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Additionally, we have configured this data node (server) as a GemFire Manager as well using GemFire-specific
JMX System properties that enable JMX client (e.g. <em>Gfsh</em>) to connect to this running data node.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more information on configuring <em>Spring Data GemFire</em>, refer to the <a href="http://docs.spring.io/spring-data-gemfire/docs/current/reference/html/">reference guide</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="xml-servlet-container-initialization-3"><a class="anchor" href="#xml-servlet-container-initialization-3"></a>XML Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="#httpsession-spring-xml-configuration">Spring XML Configuration</a> created a Spring bean named <code>springSessionRepositoryFilter</code>
that implements <code>Filter</code>. The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with
a custom implementation that is backed by Spring Session and GemFire.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, we need to instruct Spring to load our <code>session.xml</code> configuration file.
We do this with the following configuration:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>contextConfigLocation<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>
        /WEB-INF/spring/*.xml
    <span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;listener&gt;</span>
    <span class="tag">&lt;listener-class&gt;</span>
        org.springframework.web.context.ContextLoaderListener
    <span class="tag">&lt;/listener-class&gt;</span>
<span class="tag">&lt;/listener&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#context-create">ContextLoaderListener</a>
reads the <code>contextConfigLocation</code> context parameter value and picks up our <em>session.xml</em> configuration file.</p>
</div>
<div class="paragraph">
<p>Finally, we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code>
for every request.</p>
</div>
<div class="paragraph">
<p>The following snippet performs this last step for us:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>springSessionRepositoryFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;filter-class&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span class="tag">&lt;/filter-class&gt;</span>
<span class="tag">&lt;/filter&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>springSessionRepositoryFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>/*<span class="tag">&lt;/url-pattern&gt;</span>
    <span class="tag">&lt;dispatcher&gt;</span>REQUEST<span class="tag">&lt;/dispatcher&gt;</span>
    <span class="tag">&lt;dispatcher&gt;</span>ERROR<span class="tag">&lt;/dispatcher&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="http://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/filter/DelegatingFilterProxy.html">DelegatingFilterProxy</a>
will look up a bean by the name of <code>springSessionRepositoryFilter</code> and cast it to a <code>Filter</code>. For every request that <code>DelegatingFilterProxy</code>
is invoked, the <code>springSessionRepositoryFilter</code> will be invoked.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-jdbc"><a class="anchor" href="#httpsession-jdbc"></a>HttpSession with JDBC</h3>
<div class="paragraph">
<p>Using Spring Session with <code>HttpSession</code> is enabled by adding a Servlet Filter before anything that uses the <code>HttpSession</code>.
You can choose from enabling this using either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#httpsession-jdbc-jc">Java Based Configuration</a></p>
</li>
<li>
<p><a href="#httpsession-jdbc-xml">XML Based Configuration</a></p>
</li>
<li>
<p><a href="#httpsession-jdbc-boot">Spring Boot Based Configuration</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="httpsession-jdbc-jc"><a class="anchor" href="#httpsession-jdbc-jc"></a>JDBC Java Based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use a relational database to back <code>HttpSession</code> using Java based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">HttpSession JDBC Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using Java configuration.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed HttpSession JDBC Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-spring-configuration"><a class="anchor" href="#httpsession-jdbc-spring-configuration"></a>Spring Java Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EnableJdbcHttpSession</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Config</span> {

        <span class="annotation">@Bean</span>
        <span class="directive">public</span> EmbeddedDatabase dataSource() {
                <span class="keyword">return</span> <span class="keyword">new</span> EmbeddedDatabaseBuilder() <i class="conum" data-value="2"></i><b>(2)</b>
                                .setType(EmbeddedDatabaseType.H2)
                                .addScript(<span class="string"><span class="delimiter">&quot;</span><span class="content">org/springframework/session/jdbc/schema-h2.sql</span><span class="delimiter">&quot;</span></span>).build();
        }

        <span class="annotation">@Bean</span>
        <span class="directive">public</span> PlatformTransactionManager transactionManager(<span class="predefined-type">DataSource</span> dataSource) {
                <span class="keyword">return</span> <span class="keyword">new</span> DataSourceTransactionManager(dataSource); <i class="conum" data-value="3"></i><b>(3)</b>
        }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableJdbcHttpSession</code> annotation creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by a relational database.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>dataSource</code> that connects Spring Session to an embedded instance of H2 database.
We configure the H2 database to create database tables using the SQL script which is included in Spring Session.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We create a <code>transactionManager</code> that manages transactions for previously configured <code>dataSource</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For additional information on how to configure data access related concerns, please refer to the <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/html/spring-data-tier.html">Spring Framework Reference Documentation</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="java-servlet-container-initialization-4"><a class="anchor" href="#java-servlet-container-initialization-4"></a>Java Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="#httpsession-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class.
Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
Fortunately, Spring Session provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> both of these steps extremely easy.
You can find an example below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Initializer</span> <span class="directive">extends</span> AbstractHttpSessionApplicationInitializer { <i class="conum" data-value="1"></i><b>(1)</b>

        <span class="directive">public</span> Initializer() {
                <span class="local-variable">super</span>(Config.class); <i class="conum" data-value="2"></i><b>(2)</b>
        }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (Initializer) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</table>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The first step is to extend <code>AbstractHttpSessionApplicationInitializer</code>.
This ensures that the Spring Bean by the name <code>springSessionRepositoryFilter</code> is registered with our Servlet Container for every request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>AbstractHttpSessionApplicationInitializer</code> also provides a mechanism to easily ensure Spring loads our <code>Config</code>.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="httpsession-jdbc-xml"><a class="anchor" href="#httpsession-jdbc-xml"></a>JDBC XML Based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use a relational database to back <code>HttpSession</code> using XML based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">HttpSession JDBC XML Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using XML configuration.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed HttpSession JDBC XML Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-xml-spring-configuration"><a class="anchor" href="#httpsession-jdbc-xml-spring-configuration"></a>Spring XML Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/spring/session.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><i class="conum" data-value="1"></i><b>(1)</b>
<span class="tag">&lt;context:annotation-config</span><span class="tag">/&gt;</span>
<span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.session.jdbc.config.annotation.web.http.JdbcHttpSessionConfiguration</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

<i class="conum" data-value="2"></i><b>(2)</b>
<span class="tag">&lt;jdbc:embedded-database</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dataSource</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">database-name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">testdb</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">H2</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;jdbc:script</span> <span class="attribute-name">location</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">classpath:org/springframework/session/jdbc/schema-h2.sql</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/jdbc:embedded-database&gt;</span>

<i class="conum" data-value="3"></i><b>(3)</b>
<span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.jdbc.datasource.DataSourceTransactionManager</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;constructor-arg</span> <span class="attribute-name">ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dataSource</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We use the combination of <code>&lt;context:annotation-config/&gt;</code> and <code>JdbcHttpSessionConfiguration</code> because Spring Session does not yet provide XML Namespace support (see <a href="https://github.com/spring-projects/spring-session/issues/104">gh-104</a>).
This creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by a relational database.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>dataSource</code> that connects Spring Session to an embedded instance of H2 database.
We configure the H2 database to create database tables using the SQL script which is included in Spring Session.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We create a <code>transactionManager</code> that manages transactions for previously configured <code>dataSource</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For additional information on how to configure data access related concerns, please refer to the <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/html/spring-data-tier.html">Spring Framework Reference Documentation</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="xml-servlet-container-initialization-4"><a class="anchor" href="#xml-servlet-container-initialization-4"></a>XML Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="#httpsession-xml-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, we need to instruct Spring to load our <code>session.xml</code> configuration.
We do this with the following configuration:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>contextConfigLocation<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>
        /WEB-INF/spring/*.xml
    <span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;listener&gt;</span>
    <span class="tag">&lt;listener-class&gt;</span>
        org.springframework.web.context.ContextLoaderListener
    <span class="tag">&lt;/listener-class&gt;</span>
<span class="tag">&lt;/listener&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#context-create">ContextLoaderListener</a> reads the contextConfigLocation and picks up our session.xml configuration.</p>
</div>
<div class="paragraph">
<p>Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
The following snippet performs this last step for us:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/WEB-INF/web.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>springSessionRepositoryFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;filter-class&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span class="tag">&lt;/filter-class&gt;</span>
<span class="tag">&lt;/filter&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>springSessionRepositoryFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>/*<span class="tag">&lt;/url-pattern&gt;</span>
    <span class="tag">&lt;dispatcher&gt;</span>REQUEST<span class="tag">&lt;/dispatcher&gt;</span>
    <span class="tag">&lt;dispatcher&gt;</span>ERROR<span class="tag">&lt;/dispatcher&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="http://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/filter/DelegatingFilterProxy.html">DelegatingFilterProxy</a> will look up a Bean by the name of <code>springSessionRepositoryFilter</code> and cast it to a <code>Filter</code>.
For every request that <code>DelegatingFilterProxy</code> is invoked, the <code>springSessionRepositoryFilter</code> will be invoked.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="httpsession-jdbc-boot"><a class="anchor" href="#httpsession-jdbc-boot"></a>JDBC Spring Boot Based Configuration</h4>
<div class="paragraph">
<p>This section describes how to use a relational database to back <code>HttpSession</code> when using Spring Boot.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">HttpSession JDBC Spring Boot Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using Spring Boot.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed HttpSession JDBC Spring Boot Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-boot-spring-configuration"><a class="anchor" href="#httpsession-jdbc-boot-spring-configuration"></a>Spring Configuration</h5>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EnableJdbcHttpSession</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">HttpSessionConfig</span> {
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableJdbcHttpSession</code> annotation creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by a relational database.</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-boot-configuration"><a class="anchor" href="#httpsession-jdbc-boot-configuration"></a>Configuring the DataSource</h5>
<div class="paragraph">
<p>Spring Boot automatically creates a <code>DataSource</code> that connects Spring Session to an embedded instance of H2 database.
In a production environment you need to ensure to update your configuration to point to your relational database.
For example, you can include the following in your <strong>application.properties</strong></p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/application.properties</div>
<div class="content">
<pre>spring.datasource.url=jdbc:postgresql://localhost:5432/myapp
spring.datasource.username=myapp
spring.datasource.password=secret</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, refer to <a href="http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-configure-datasource">Configure a DataSource</a> portion of the Spring Boot documentation.</p>
</div>
</div>
<div class="sect4">
<h5 id="httpsession-jdbc-boot-servlet-configuration"><a class="anchor" href="#httpsession-jdbc-boot-servlet-configuration"></a>Servlet Container Initialization</h5>
<div class="paragraph">
<p>Our <a href="#httpsession-jdbc-boot-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class.
Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
Fortunately, Spring Boot takes care of both of these steps for us.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-mongo"><a class="anchor" href="#httpsession-mongo"></a>HttpSession with Mongo</h3>
<div class="paragraph">
<p>Using Spring Session with <code>HttpSession</code> is enabled by adding a Servlet Filter before anything that uses the <code>HttpSession</code>.</p>
</div>
<div class="paragraph">
<p>This section describes how to use Mongo to back <code>HttpSession</code> using Java based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">HttpSession Mongo Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using Java configuration.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed HttpSession Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All you have to do is to add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EnableMongoHttpSession</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">HttpSessionConfig</span> {

        <span class="annotation">@Bean</span>
        <span class="directive">public</span> JdkMongoSessionConverter jdkMongoSessionConverter() {
                <span class="keyword">return</span> <span class="keyword">new</span> JdkMongoSessionConverter(); <i class="conum" data-value="2"></i><b>(2)</b>
        }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableMongoHttpSession</code> annotation creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by Mongo.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We explicitly configure <code>JdkMongoSessionConverter</code> since Spring Security&#8217;s objects cannot be automatically persisted using Jackson (the default if Jackson is on the classpath).</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="session-serialization-mechanisms"><a class="anchor" href="#session-serialization-mechanisms"></a>Session serialization mechanisms</h4>
<div class="paragraph">
<p>To be able to persist session objects in MongoDB we need to provide the serialization/deserialization mechanism.
Depending on your classpath Spring Session will choose one of two build-in converters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>JacksonMongoSessionConverter</code> when <code>ObjectMapper</code> class is available, or</p>
</li>
<li>
<p><code>JdkMongoSessionConverter</code> otherwise.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="jacksonmongosessionconverter"><a class="anchor" href="#jacksonmongosessionconverter"></a>JacksonMongoSessionConverter</h5>
<div class="paragraph">
<p>This mechanism uses Jackson to serialize session objects to/from JSON.
<code>JacksonMongoSessionConverter</code> will be the default when Jackson is detected on the classpath and the user has not explicitly registered a <code>AbstractMongoSessionConverter</code> Bean.</p>
</div>
<div class="paragraph">
<p>If you would like to provide custom Jackson modules you can do it by explicitly registering <code>JacksonMongoSessionConverter</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="annotation">@EnableMongoHttpSession</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MongoJacksonSessionConfiguration</span> {

        <span class="annotation">@Bean</span>
        <span class="directive">public</span> AbstractMongoSessionConverter mongoSessionConverter() {
                <span class="keyword">return</span> <span class="keyword">new</span> JacksonMongoSessionConverter(getJacksonModules());
        }

        <span class="directive">public</span> <span class="predefined-type">Iterable</span>&lt;Module&gt; getJacksonModules() {
                <span class="keyword">return</span> <span class="predefined-type">Collections</span>.&lt;Module&gt;singletonList(<span class="keyword">new</span> MyJacksonModule());
        }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="jdkmongosessionconverter"><a class="anchor" href="#jdkmongosessionconverter"></a>JdkMongoSessionConverter</h4>
<div class="paragraph">
<p><code>JdkMongoSessionConverter</code> uses standard Java serialization to persist session attributes map to MongoDB in a binary form.
However, standard session elements like id, access time, etc are still written as a plain Mongo objects and can be read and queried without additional effort.
<code>JdkMongoSessionConverter</code> is used if Jackson is not on the classpath and no explicit <code>AbstractMongoSessionConverter</code> Bean has been defined.
You can explicitly register <code>JdkMongoSessionConverter</code> by defining it as a Bean.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="annotation">@EnableMongoHttpSession</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MongoJdkSessionConfiguration</span> {

        <span class="annotation">@Bean</span>
        <span class="directive">public</span> AbstractMongoSessionConverter mongoSessionConverter() {
                <span class="keyword">return</span> <span class="keyword">new</span> JdkMongoSessionConverter();
        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is also a constructor taking <code>Serializer</code> and <code>Deserializer</code> objects, allowing you to pass custom implementations, which is especially important when you want to use non-default classloader.</p>
</div>
</div>
<div class="sect3">
<h4 id="using-custom-converters"><a class="anchor" href="#using-custom-converters"></a>Using custom converters</h4>
<div class="paragraph">
<p>You can create your own session converter by extending <code>AbstractMongoSessionConverter</code> class.
The implementation will be used for serializing, deserializing your objects and for providing queries to access the session.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-hazelcast"><a class="anchor" href="#httpsession-hazelcast"></a>HttpSession with Hazelcast</h3>
<div class="paragraph">
<p>Using Spring Session with <code>HttpSession</code> is enabled by adding a Servlet Filter before anything that uses the <code>HttpSession</code>.</p>
</div>
<div class="paragraph">
<p>This section describes how to use Hazelcast to back <code>HttpSession</code> using Java based configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">Hazelcast Spring Sample</a> provides a working sample on how to integrate Spring Session and <code>HttpSession</code> using Java configuration.
You can read the basic steps for integration below, but you are encouraged to follow along with the detailed Hazelcast Spring Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="security-spring-configuration"><a class="anchor" href="#security-spring-configuration"></a>Spring Configuration</h4>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EnableHazelcastHttpSession</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@Configuration</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">HazelcastHttpSessionConfig</span> {

        <span class="annotation">@Bean</span>
        <span class="directive">public</span> HazelcastInstance hazelcastInstance() {
                MapAttributeConfig attributeConfig = <span class="keyword">new</span> MapAttributeConfig()
                                .setName(HazelcastSessionRepository.PRINCIPAL_NAME_ATTRIBUTE)
                                .setExtractor(PrincipalNameExtractor.class.getName());

                Config config = <span class="keyword">new</span> Config();

                config.getMapConfig(<span class="string"><span class="delimiter">&quot;</span><span class="content">spring:session:sessions</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="2"></i><b>(2)</b>
                                .addMapAttributeConfig(attributeConfig)
                                .addMapIndexConfig(<span class="keyword">new</span> MapIndexConfig(
                                                HazelcastSessionRepository.PRINCIPAL_NAME_ATTRIBUTE, <span class="predefined-constant">false</span>));

                <span class="keyword">return</span> Hazelcast.newHazelcastInstance(config); <i class="conum" data-value="3"></i><b>(3)</b>
        }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableHazelcastHttpSession</code> annotation creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements Filter.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by Hazelcast.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In order to support retrieval of sessions by principal name index, appropriate <code>ValueExtractor</code> needs to be registered.
Spring Session provides <code>PrincipalNameExtractor</code> for this purpose.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We create a <code>HazelcastInstance</code> that connects Spring Session to Hazelcast.
By default, an embedded instance of Hazelcast is started and connected to by the application.
For more information on configuring Hazelcast, refer to the <a href="http://docs.hazelcast.org/docs/latest/manual/html-single/index.html#hazelcast-configuration">reference documentation</a>.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="servlet-container-initialization"><a class="anchor" href="#servlet-container-initialization"></a>Servlet Container Initialization</h4>
<div class="paragraph">
<p>Our <a href="#security-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>SessionConfig</code> class.
Since our application is already loading Spring configuration using our <code>SecurityInitializer</code> class, we can simply add our <code>SessionConfig</code> class to it.</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/SecurityInitializer.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">SecurityInitializer</span> <span class="directive">extends</span> AbstractSecurityWebApplicationInitializer {

        <span class="directive">public</span> SecurityInitializer() {
                <span class="local-variable">super</span>(SecurityConfig.class, SessionConfig.class);
        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
It is extremely important that Spring Session&#8217;s <code>springSessionRepositoryFilter</code> is invoked before Spring Security&#8217;s <code>springSecurityFilterChain</code>.
This ensures that the <code>HttpSession</code> that Spring Security uses is backed by Spring Session.
Fortunately, Spring Session provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> that makes this extremely easy.
You can find an example below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Initializer</span> <span class="directive">extends</span> AbstractHttpSessionApplicationInitializer {

}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (Initializer) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By extending <code>AbstractHttpSessionApplicationInitializer</code> we ensure that the Spring Bean by the name <code>springSessionRepositoryFilter</code> is registered with our Servlet Container for every request before Spring Security&#8217;s <code>springSecurityFilterChain</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-how"><a class="anchor" href="#httpsession-how"></a>How HttpSession Integration Works</h3>
<div class="paragraph">
<p>Fortunately both <code>HttpSession</code> and <code>HttpServletRequest</code> (the API for obtaining an <code>HttpSession</code>) are both interfaces.
This means that we can provide our own implementations for each of these APIs.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section describes how Spring Session provides transparent integration with <code>HttpSession</code>. The intent is so that user&#8217;s can understand what is happening under the covers. This functionality is already integrated and you do NOT need to implement this logic yourself.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>First we create a custom <code>HttpServletRequest</code> that returns a custom implementation of <code>HttpSession</code>.
It looks something like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">SessionRepositoryRequestWrapper</span> <span class="directive">extends</span> HttpServletRequestWrapper {

        <span class="directive">public</span> SessionRepositoryRequestWrapper(HttpServletRequest original) {
                <span class="local-variable">super</span>(original);
        }

        <span class="directive">public</span> HttpSession getSession() {
                <span class="keyword">return</span> getSession(<span class="predefined-constant">true</span>);
        }

        <span class="directive">public</span> HttpSession getSession(<span class="type">boolean</span> createNew) {
                <span class="comment">// create an HttpSession implementation from Spring Session</span>
        }

        <span class="comment">// ... other methods delegate to the original HttpServletRequest ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any method that returns an <code>HttpSession</code> is overridden.
All other methods are implemented by <code>HttpServletRequestWrapper</code> and simply delegate to the original <code>HttpServletRequest</code> implementation.</p>
</div>
<div class="paragraph">
<p>We replace the <code>HttpServletRequest</code> implementation using a servlet <code>Filter</code> called <code>SessionRepositoryFilter</code>.
The pseudocode can be found below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">SessionRepositoryFilter</span> <span class="directive">implements</span> <span class="predefined-type">Filter</span> {

        <span class="directive">public</span> doFilter(ServletRequest request, ServletResponse response, FilterChain chain) {
                HttpServletRequest httpRequest = (HttpServletRequest) request;
                SessionRepositoryRequestWrapper customRequest =
                        <span class="keyword">new</span> SessionRepositoryRequestWrapper(httpRequest);

                chain.doFilter(customRequest, response, chain);
        }

        <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By passing in a custom <code>HttpServletRequest</code> implementation into the <code>FilterChain</code> we ensure that anything invoked after our <code>Filter</code> uses the custom <code>HttpSession</code> implementation.
This highlights why it is important that Spring Session&#8217;s <code>SessionRepositoryFilter</code> must be placed before anything that interacts with the <code>HttpSession</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-multi"><a class="anchor" href="#httpsession-multi"></a>Multiple HttpSessions in Single Browser</h3>
<div class="paragraph">
<p>Spring Session has the ability to support multiple sessions in a single browser instance.
This provides the ability to support authenticating with multiple users in the same browser instance (i.e. Google Accounts).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">Manage Multiple Users Guide</a> provides a complete working example of managing multiple users in the same browser instance.
You can follow the basic steps for integration below, but you are encouraged to follow along with the detailed Manage Multiple Users Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at how Spring Session keeps track of multiple sessions.</p>
</div>
<div class="sect3">
<h4 id="managing-a-single-session"><a class="anchor" href="#managing-a-single-session"></a>Managing a Single Session</h4>
<div class="paragraph">
<p>Spring Session keeps track of the <code>HttpSession</code> by adding a value to a cookie named SESSION.
For example, the SESSION cookie might have a value of:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>7e8383a4-082c-4ffe-a4bc-c40fd3363c5e</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="adding-a-session"><a class="anchor" href="#adding-a-session"></a>Adding a Session</h4>
<div class="paragraph">
<p>We can add another session by requesting a URL that contains a special parameter in it.
By default the parameter name is <strong>_s</strong>. For example, the following URL would create a new session:</p>
</div>
<div class="paragraph">
<p><a href="http://localhost:8080/?_s=1" class="bare">http://localhost:8080/?_s=1</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The parameter value does not indicate the actual session id.
This is important because we never want to allow the session id to be determined by a client to avoid <a href="https://www.owasp.org/index.php/Session_fixation">session fixation attacks</a>.
Additionally, we do not want the session id to be leaked since it is sent as a query parameter.
Remember sensitive information should only be transmitted as a header or in the body of the request.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Rather than creating the URL ourselves, we can utilize the <code>HttpSessionManager</code> to do this for us.
We can obtain the <code>HttpSessionManager</code> from the <code>HttpServletRequest</code> using the following:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/UserAccountsFilter.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">HttpSessionManager sessionManager = (HttpSessionManager) httpRequest
        .getAttribute(HttpSessionManager.class.getName());</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can now use it to create a URL to add another session.</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/UserAccountsFilter.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> addAlias = unauthenticatedAlias == <span class="predefined-constant">null</span> ? <i class="conum" data-value="1"></i><b>(1)</b>
        sessionManager.getNewSessionAlias(httpRequest)
        : <i class="conum" data-value="2"></i><b>(2)</b>
        unauthenticatedAlias; <i class="conum" data-value="3"></i><b>(3)</b>
<span class="predefined-type">String</span> addAccountUrl = sessionManager.encodeURL(contextPath, addAlias); <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We have an existing variable named <code>unauthenticatedAlias</code>.
The value is an alias that points to an existing unauthenticated session.
If no such session exists, the value is null.
This ensures if we have an existing unauthenticated session that we use it instead of creating a new session.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If all of our sessions are already associated to a user, we create a new session alias.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>If there is an existing session that is not associated to a user, we use its session alias.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Finally, we create the add account URL.
The URL contains a session alias that either points to an existing unauthenticated session or is an alias that is unused thus signaling to create a new session associated to that alias.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now our SESSION cookie looks something like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>0 7e8383a4-082c-4ffe-a4bc-c40fd3363c5e 1 1d526d4a-c462-45a4-93d9-84a39b6d44ad</pre>
</div>
</div>
<div class="paragraph">
<p>Such that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There is a session with the id <strong>7e8383a4-082c-4ffe-a4bc-c40fd3363c5e</strong></p>
<div class="ulist">
<ul>
<li>
<p>The alias for this session is  <strong>0</strong>.
For example, if the URL is <a href="http://localhost:8080/?_s=0" class="bare">http://localhost:8080/?_s=0</a> this alias would be used.</p>
</li>
<li>
<p>This is the default session.
This means that if no session alias is specified, then this session is used.
For example, if the URL is <a href="http://localhost:8080/" class="bare">http://localhost:8080/</a> this session would be used.</p>
</li>
</ul>
</div>
</li>
<li>
<p>There is a session with the id <strong>1d526d4a-c462-45a4-93d9-84a39b6d44ad</strong></p>
<div class="ulist">
<ul>
<li>
<p>The alias for this session is <strong>1</strong>.
If the session alias is <strong>1</strong>, then this session is used.
For example, if the URL is <a href="http://localhost:8080/?_s=1" class="bare">http://localhost:8080/?_s=1</a> this alias would be used.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="automatic-session-alias-inclusion-with-encodeurl"><a class="anchor" href="#automatic-session-alias-inclusion-with-encodeurl"></a>Automatic Session Alias Inclusion with encodeURL</h4>
<div class="paragraph">
<p>The nice thing about specifying the session alias in the URL is that we can have multiple tabs open with different active sessions.
The bad thing is that we need to include the session alias in every URL of our application.
Fortunately, Spring Session will automatically include the session alias in any URL that passes through <a href="http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletResponse.html#encodeURL(java.lang.String)">HttpServletResponse#encodeURL(java.lang.String)</a></p>
</div>
<div class="paragraph">
<p>This means that if you are using standard tag libraries the session alias is automatically included in the URL.
For example, if we are currently using the session with the alias of <strong>1</strong>, then the following:</p>
</div>
<div class="listingblock">
<div class="title">src/main/webapp/index.jsp</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  --<span class="error">&gt;</span>
<span class="tag">&lt;c:url</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/link.jsp</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">var</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">linkUrl</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;a</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">navLink</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${linkUrl}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Link<span class="tag">&lt;/a&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>will output a link of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;a</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">navLink</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/link.jsp?_s=1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Link<span class="tag">&lt;/a&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-rest"><a class="anchor" href="#httpsession-rest"></a>HttpSession &amp; RESTful APIs</h3>
<div class="paragraph">
<p>Spring Session can work with RESTful APIs by allowing the session to be provided in a header.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#samples">REST Sample</a> provides a working sample on how to use Spring Session in a REST application to support authenticating with a header.
You can follow the basic steps for integration below, but you are encouraged to follow along with the detailed REST Guide when integrating with your own application.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="rest-spring-configuration"><a class="anchor" href="#rest-spring-configuration"></a>Spring Configuration</h4>
<div class="paragraph">
<p>After adding the required dependencies, we can create our Spring configuration.
The Spring configuration is responsible for creating a Servlet Filter that replaces the <code>HttpSession</code> implementation with an implementation backed by Spring Session.
Add the following Spring Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="annotation">@EnableRedisHttpSession</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">HttpSessionConfig</span> {

        <span class="annotation">@Bean</span>
        <span class="directive">public</span> LettuceConnectionFactory connectionFactory() {
                <span class="keyword">return</span> <span class="keyword">new</span> LettuceConnectionFactory(); <i class="conum" data-value="2"></i><b>(2)</b>
        }

        <span class="annotation">@Bean</span>
        <span class="directive">public</span> HttpSessionStrategy httpSessionStrategy() {
                <span class="keyword">return</span> <span class="keyword">new</span> HeaderHttpSessionStrategy(); <i class="conum" data-value="3"></i><b>(3)</b>
        }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EnableRedisHttpSession</code> annotation creates a Spring Bean with the name of <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The filter is what is in charge of replacing the <code>HttpSession</code> implementation to be backed by Spring Session.
In this instance Spring Session is backed by Redis.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a <code>RedisConnectionFactory</code> that connects Spring Session to the Redis Server.
We configure the connection to connect to localhost on the default port (6379)
For more information on configuring Spring Data Redis, refer to the <a href="http://docs.spring.io/spring-data/data-redis/docs/current/reference/html/">reference documentation</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We customize Spring Session&#8217;s HttpSession integration to use HTTP headers to convey the current session information instead of cookies.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="servlet-container-initialization-2"><a class="anchor" href="#servlet-container-initialization-2"></a>Servlet Container Initialization</h4>
<div class="paragraph">
<p>Our <a href="#rest-spring-configuration">Spring Configuration</a> created a Spring Bean named <code>springSessionRepositoryFilter</code> that implements <code>Filter</code>.
The <code>springSessionRepositoryFilter</code> bean is responsible for replacing the <code>HttpSession</code> with a custom implementation that is backed by Spring Session.</p>
</div>
<div class="paragraph">
<p>In order for our <code>Filter</code> to do its magic, Spring needs to load our <code>Config</code> class. We provide the configuration in our Spring <code>MvcInitializer</code> as shown below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/mvc/MvcInitializer.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Override</span>
<span class="directive">protected</span> <span class="predefined-type">Class</span>&lt;?&gt;<span class="type">[]</span> getRootConfigClasses() {
    <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">Class</span><span class="type">[]</span> { SecurityConfig.class, HttpSessionConfig.class };
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Last we need to ensure that our Servlet Container (i.e. Tomcat) uses our <code>springSessionRepositoryFilter</code> for every request.
Fortunately, Spring Session provides a utility class named <code>AbstractHttpSessionApplicationInitializer</code> that makes this extremely easy. Simply extend the class with the default constructor as shown below:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/sample/Initializer.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Initializer</span> <span class="directive">extends</span> AbstractHttpSessionApplicationInitializer {

}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name of our class (Initializer) does not matter. What is important is that we extend <code>AbstractHttpSessionApplicationInitializer</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="httpsession-httpsessionlistener"><a class="anchor" href="#httpsession-httpsessionlistener"></a>HttpSessionListener</h3>
<div class="paragraph">
<p>Spring Session supports <code>HttpSessionListener</code> by translating <code>SessionDestroyedEvent</code> and <code>SessionCreatedEvent</code> into <code>HttpSessionEvent</code> by declaring <code>SessionEventHttpSessionListenerAdapter</code>.
To use this support, you need to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ensure your <code>SessionRepository</code> implementation supports and is configured to fire <code>SessionDestroyedEvent</code> and <code>SessionCreatedEvent</code>.</p>
</li>
<li>
<p>Configure <code>SessionEventHttpSessionListenerAdapter</code> as a Spring bean.</p>
</li>
<li>
<p>Inject every <code>HttpSessionListener</code> into the <code>SessionEventHttpSessionListenerAdapter</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you are using the configuration support documented in <a href="#httpsession-redis">HttpSession with Redis</a>, then all you need to do is register every <code>HttpSessionListener</code> as a bean.
For example, assume you want to support Spring Security&#8217;s concurrency control and need to use <code>HttpSessionEventPublisher</code> you can simply add <code>HttpSessionEventPublisher</code> as a bean.
In Java configuration, this might look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="annotation">@EnableRedisHttpSession</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">RedisHttpSessionConfig</span> {

        <span class="annotation">@Bean</span>
        <span class="directive">public</span> HttpSessionEventPublisher httpSessionEventPublisher() {
                <span class="keyword">return</span> <span class="keyword">new</span> HttpSessionEventPublisher();
        }

        <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In XML configuration, this might look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.security.web.session.HttpSessionEventPublisher</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="websocket"><a class="anchor" href="#websocket"></a>WebSocket Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides transparent integration with Spring&#8217;s WebSocket support.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Session&#8217;s WebSocket support only works with Spring&#8217;s WebSocket support.
Specifically it does not work with using <a href="https://www.jcp.org/en/jsr/detail?id=356">JSR-356</a> directly.
This is due to the fact that JSR-356 does not have a mechanism for intercepting incoming WebSocket messages.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="websocket-why"><a class="anchor" href="#websocket-why"></a>Why Spring Session &amp; WebSockets?</h3>
<div class="paragraph">
<p>So why do we need Spring Session when using WebSockets?</p>
</div>
<div class="paragraph">
<p>Consider an email application that does much of its work through HTTP requests.
However, there is also a chat application embedded within it that works over WebSocket APIs.
If a user is actively chatting with someone, we should not timeout the <code>HttpSession</code> since this would be pretty poor user experience.
However, this is exactly what <a href="https://java.net/jira/browse/WEBSOCKET_SPEC-175">JSR-356</a> does.</p>
</div>
<div class="paragraph">
<p>Another issue is that according to JSR-356 if the <code>HttpSession</code> times out any WebSocket that was created with that HttpSession and an authenticated user should be forcibly closed.
This means that if we are actively chatting in our application and are not using the HttpSession, then we will also disconnect from our conversation!</p>
</div>
</div>
<div class="sect2">
<h3 id="websocket-usage"><a class="anchor" href="#websocket-usage"></a>WebSocket Usage</h3>
<div class="paragraph">
<p>The <a href="#samples">WebSocket Sample</a> provides a working sample on how to integrate Spring Session with WebSockets.
You can follow the basic steps for integration below, but you are encouraged to follow along with the detailed WebSocket Guide when integrating with your own application:</p>
</div>
<div class="sect3">
<h4 id="websocket-httpsession"><a class="anchor" href="#websocket-httpsession"></a>HttpSession Integration</h4>
<div class="paragraph">
<p>Before using WebSocket integration, you should be sure that you have <a href="#httpsession">HttpSession Integration</a> working first.</p>
</div>
</div>
<div class="sect3">
<h4 id="websocket-spring-configuration"><a class="anchor" href="#websocket-spring-configuration"></a>Spring Configuration</h4>
<div class="paragraph">
<p>In a typical Spring WebSocket application users would extend <code>AbstractWebSocketMessageBrokerConfigurer</code>.
For example, the configuration might look something like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="annotation">@EnableScheduling</span>
<span class="annotation">@EnableWebSocketMessageBroker</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">WebSocketConfig</span> <span class="directive">extends</span> AbstractWebSocketMessageBrokerConfigurer {

        <span class="directive">public</span> <span class="type">void</span> registerStompEndpoints(StompEndpointRegistry registry) {
                registry.addEndpoint(<span class="string"><span class="delimiter">&quot;</span><span class="content">/messages</span><span class="delimiter">&quot;</span></span>).withSockJS();
        }

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">void</span> configureMessageBroker(MessageBrokerRegistry registry) {
                registry.enableSimpleBroker(<span class="string"><span class="delimiter">&quot;</span><span class="content">/queue/</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">/topic/</span><span class="delimiter">&quot;</span></span>);
                registry.setApplicationDestinationPrefixes(<span class="string"><span class="delimiter">&quot;</span><span class="content">/app</span><span class="delimiter">&quot;</span></span>);
        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can easily update our configuration to use Spring Session&#8217;s WebSocket support.
For example:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/samples/config/WebSocketConfig.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="annotation">@EnableScheduling</span>
<span class="annotation">@EnableWebSocketMessageBroker</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">WebSocketConfig</span>
                <span class="directive">extends</span> AbstractSessionWebSocketMessageBrokerConfigurer&lt;ExpiringSession&gt; { <i class="conum" data-value="1"></i><b>(1)</b>

        <span class="directive">protected</span> <span class="type">void</span> configureStompEndpoints(StompEndpointRegistry registry) { <i class="conum" data-value="2"></i><b>(2)</b>
                registry.addEndpoint(<span class="string"><span class="delimiter">&quot;</span><span class="content">/messages</span><span class="delimiter">&quot;</span></span>).withSockJS();
        }

        <span class="directive">public</span> <span class="type">void</span> configureMessageBroker(MessageBrokerRegistry registry) {
                registry.enableSimpleBroker(<span class="string"><span class="delimiter">&quot;</span><span class="content">/queue/</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">/topic/</span><span class="delimiter">&quot;</span></span>);
                registry.setApplicationDestinationPrefixes(<span class="string"><span class="delimiter">&quot;</span><span class="content">/app</span><span class="delimiter">&quot;</span></span>);
        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To hook in the Spring Session support we only need to change two things:</p>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Instead of extending <code>AbstractWebSocketMessageBrokerConfigurer</code> we extend <code>AbstractSessionWebSocketMessageBrokerConfigurer</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We rename the <code>registerStompEndpoints</code> method to <code>configureStompEndpoints</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>What does <code>AbstractSessionWebSocketMessageBrokerConfigurer</code> do behind the scenes?</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>WebSocketConnectHandlerDecoratorFactory</code> is added as a <code>WebSocketHandlerDecoratorFactory</code> to <code>WebSocketTransportRegistration</code>.
This ensures a custom <code>SessionConnectEvent</code> is fired that contains the <code>WebSocketSession</code>.
The <code>WebSocketSession</code> is necessary to terminate any WebSocket connections that are still open when a Spring Session is terminated.</p>
</li>
<li>
<p><code>SessionRepositoryMessageInterceptor</code> is added as a <code>HandshakeInterceptor</code> to every <code>StompWebSocketEndpointRegistration</code>.
This ensures that the Session is added to the WebSocket properties to enable updating the last accessed time.</p>
</li>
<li>
<p><code>SessionRepositoryMessageInterceptor</code> is added as a <code>ChannelInterceptor</code> to our inbound <code>ChannelRegistration</code>.
This ensures that every time an inbound message is received, that the last accessed time of our Spring Session is updated.</p>
</li>
<li>
<p><code>WebSocketRegistryListener</code> is created as a Spring Bean.
This ensures that we have a mapping of all of the Session id to the corresponding WebSocket connections.
By maintaining this mapping, we can close all the WebSocket connections when a Spring Session (HttpSession) is terminated.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-security"><a class="anchor" href="#spring-security"></a>Spring Security Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Session provides integration with Spring Security.</p>
</div>
<div class="sect2">
<h3 id="spring-security-rememberme"><a class="anchor" href="#spring-security-rememberme"></a>Spring Security Remember-Me Support</h3>
<div class="paragraph">
<p>Spring Session provides integration with <a href="http://docs.spring.io/spring-security/site/docs/4.2.x/reference/htmlsingle/#remember-me">Spring Security&#8217;s Remember-Me Authentication</a>.
The support will:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change the session expiration length</p>
</li>
<li>
<p>Ensure the session cookie expires at <code>Integer.MAX_VALUE</code>.
The cookie expiration is set to the largest possible value because the cookie is only set when the session is created.
If it were set to the same value as the session expiration, then the session would get renewed when the user used it but the cookie expiration would not be updated causing the expiration to be fixed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To configure Spring Session with Spring Security in Java Configuration use the following as a guide:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Override</span>
<span class="directive">protected</span> <span class="type">void</span> configure(HttpSecurity http) <span class="directive">throws</span> <span class="exception">Exception</span> {
    http
        <span class="comment">// ... additional configuration ...</span>
        .rememberMe()
            .rememberMeServices(rememberMeServices());
}

<span class="annotation">@Bean</span>
<span class="directive">public</span> SpringSessionRememberMeServices rememberMeServices() {
    SpringSessionRememberMeServices rememberMeServices =
            <span class="keyword">new</span> SpringSessionRememberMeServices();
    <span class="comment">// optionally customize</span>
    rememberMeServices.setAlwaysRemember(<span class="predefined-constant">true</span>);
    <span class="keyword">return</span> rememberMeServices;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An XML based configuration would look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;security:http&gt;</span>
    <span class="comment">&lt;!-- ... --&gt;</span>
    <span class="tag">&lt;security:form-login</span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;security:remember-me</span> <span class="attribute-name">services-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">rememberMeServices</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/security:http&gt;</span>

<span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">rememberMeServices</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.session.security.web.authentication.SpringSessionRememberMeServices</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">p:alwaysRemember</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spring-security-concurrent-sessions"><a class="anchor" href="#spring-security-concurrent-sessions"></a>Spring Security Concurrent Session Control</h3>
<div class="paragraph">
<p>Spring Session provides integration with Spring Security to support its concurrent session control.
This allows limiting the number of active sessions that a single user can have concurrently, but unlike the default
Spring Security support this will also work in a clustered environment. This is done by providing a custom
implementation of Spring Security&#8217;s <code>SessionRegistry</code> interface.</p>
</div>
<div class="paragraph">
<p>When using Spring Security&#8217;s Java config DSL, you can configure the custom <code>SessionRegistry</code> through the
<code>SessionManagementConfigurer</code> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SecurityConfiguration</span> <span class="directive">extends</span> WebSecurityConfigurerAdapter {

        <span class="annotation">@Autowired</span>
        <span class="directive">private</span> FindByIndexNameSessionRepository sessionRepository;

        <span class="annotation">@Override</span>
        <span class="directive">protected</span> <span class="type">void</span> configure(HttpSecurity http) <span class="directive">throws</span> <span class="exception">Exception</span> {
                http
                        <span class="comment">// other config goes here...</span>
                        .sessionManagement()
                                .maximumSessions(<span class="integer">2</span>)
                                .sessionRegistry(sessionRegistry());
        }

        <span class="annotation">@Bean</span>
        <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">unchecked</span><span class="delimiter">&quot;</span></span>)
        <span class="directive">public</span> SpringSessionBackedSessionRegistry sessionRegistry() {
                <span class="keyword">return</span> <span class="keyword">new</span> SpringSessionBackedSessionRegistry(<span class="local-variable">this</span>.sessionRepository);
        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This assumes that you&#8217;ve also configured Spring Session to provide a <code>FindByIndexNameSessionRepository</code> that
returns <code>ExpiringSession</code> instances.</p>
</div>
<div class="paragraph">
<p>When using XML configuration, it would look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;security:http&gt;</span>
    <span class="comment">&lt;!-- other config goes here... --&gt;</span>
    <span class="tag">&lt;security:session-management&gt;</span>
        <span class="tag">&lt;security:concurrency-control</span> <span class="attribute-name">max-sessions</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">session-registry-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sessionRegistry</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/security:session-management&gt;</span>
<span class="tag">&lt;/security:http&gt;</span>

<span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sessionRegistry</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.session.security.SpringSessionBackedSessionRegistry</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;constructor-arg</span> <span class="attribute-name">ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sessionRepository</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This assumes that your Spring Session <code>SessionRegistry</code> bean is called <code>sessionRegistry</code>, which is the name used by all
<code>SpringHttpSessionConfiguration</code> subclasses except for the one for MongoDB: there it&#8217;s called <code>mongoSessionRepository</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="spring-security-concurrent-sessions-limitations"><a class="anchor" href="#spring-security-concurrent-sessions-limitations"></a>Limitations</h3>
<div class="paragraph">
<p>Spring Session&#8217;s implementation of Spring Security&#8217;s <code>SessionRegistry</code> interface does not support the <code>getAllPrincipals</code>
method, as this information cannot be retrieved using Spring Session. This method is never called by Spring Security,
so this only affects applications that access the <code>SessionRegistry</code> themselves.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api"><a class="anchor" href="#api"></a>API Documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can browse the complete <a href="../../api/">Javadoc</a> online. The key APIs are described below:</p>
</div>
<div class="sect2">
<h3 id="api-session"><a class="anchor" href="#api-session"></a>Session</h3>
<div class="paragraph">
<p>A <code>Session</code> is a simplified <code>Map</code> of name value pairs.</p>
</div>
<div class="paragraph">
<p>Typical usage might look like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">RepositoryDemo</span>&lt;S <span class="directive">extends</span> Session&gt; {
    <span class="directive">private</span> SessionRepository&lt;S&gt; repository; <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="directive">public</span> <span class="type">void</span> demo() {
        S toSave = <span class="local-variable">this</span>.repository.createSession(); <i class="conum" data-value="2"></i><b>(2)</b>

        <i class="conum" data-value="3"></i><b>(3)</b>
        User rwinch = <span class="keyword">new</span> User(<span class="string"><span class="delimiter">&quot;</span><span class="content">rwinch</span><span class="delimiter">&quot;</span></span>);
        toSave.setAttribute(ATTR_USER, rwinch);

        <span class="local-variable">this</span>.repository.save(toSave); <i class="conum" data-value="4"></i><b>(4)</b>

        S session = <span class="local-variable">this</span>.repository.getSession(toSave.getId()); <i class="conum" data-value="5"></i><b>(5)</b>

        <i class="conum" data-value="6"></i><b>(6)</b>
        User user = session.getAttribute(ATTR_USER);
        assertThat(user).isEqualTo(rwinch);
    }

    <span class="comment">// ... setter methods ...</span>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We create a <code>SessionRepository</code> instance with a generic type, <code>S</code>, that extends <code>Session</code>. The generic type is defined in our class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a new <code>Session</code> using our <code>SessionRepository</code> and assign it to a variable of type <code>S</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We interact with the <code>Session</code>. In our example, we demonstrate saving a <code>User</code> to the <code>Session</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We now save the <code>Session</code>. This is why we needed the generic type <code>S</code>. The <code>SessionRepository</code> only allows saving <code>Session</code> instances that were created or retrieved using the same <code>SessionRepository</code>. This allows for the <code>SessionRepository</code> to make implementation specific optimizations (i.e. only writing attributes that have changed).</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We retrieve the <code>Session</code> from the <code>SessionRepository</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>We obtain the persisted <code>User</code> from our <code>Session</code> without the need for explicitly casting our attribute.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="api-expiringsession"><a class="anchor" href="#api-expiringsession"></a>ExpiringSession</h3>
<div class="paragraph">
<p>An <code>ExpiringSession</code> extends a <code>Session</code> by providing attributes related to the <code>Session</code> instance&#8217;s expiration.
If there is no need to interact with the expiration information, prefer using the more simple <code>Session</code> API.</p>
</div>
<div class="paragraph">
<p>Typical usage might look like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">ExpiringRepositoryDemo</span>&lt;S <span class="directive">extends</span> ExpiringSession&gt; {
    <span class="directive">private</span> SessionRepository&lt;S&gt; repository; <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="directive">public</span> <span class="type">void</span> demo() {
        S toSave = <span class="local-variable">this</span>.repository.createSession(); <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="comment">// ...</span>
        toSave.setMaxInactiveIntervalInSeconds(<span class="integer">30</span>); <i class="conum" data-value="3"></i><b>(3)</b>

        <span class="local-variable">this</span>.repository.save(toSave); <i class="conum" data-value="4"></i><b>(4)</b>

        S session = <span class="local-variable">this</span>.repository.getSession(toSave.getId()); <i class="conum" data-value="5"></i><b>(5)</b>
        <span class="comment">// ...</span>
    }

    <span class="comment">// ... setter methods ...</span>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We create a <code>SessionRepository</code> instance with a generic type, <code>S</code>, that extends <code>ExpiringSession</code>. The generic type is defined in our class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We create a new <code>ExpiringSession</code> using our <code>SessionRepository</code> and assign it to a variable of type <code>S</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We interact with the <code>ExpiringSession</code>.
In our example, we demonstrate updating the amount of time the <code>ExpiringSession</code> can be inactive before it expires.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We now save the <code>ExpiringSession</code>.
This is why we needed the generic type <code>S</code>.
The <code>SessionRepository</code> only allows saving <code>ExpiringSession</code> instances that were created or retrieved using the same <code>SessionRepository</code>.
This allows for the <code>SessionRepository</code> to make implementation specific optimizations (i.e. only writing attributes that have changed).
The last accessed time is automatically updated when the <code>ExpiringSession</code> is saved.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We retrieve the <code>ExpiringSession</code> from the <code>SessionRepository</code>.
If the <code>ExpiringSession</code> were expired, the result would be null.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="api-sessionrepository"><a class="anchor" href="#api-sessionrepository"></a>SessionRepository</h3>
<div class="paragraph">
<p>A <code>SessionRepository</code> is in charge of creating, retrieving, and persisting <code>Session</code> instances.</p>
</div>
<div class="paragraph">
<p>If possible, developers should not interact directly with a <code>SessionRepository</code> or a <code>Session</code>.
Instead, developers should prefer interacting with <code>SessionRepository</code> and <code>Session</code> indirectly through the <a href="#httpsession">HttpSession</a> and <a href="#websocket">WebSocket</a> integration.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-findbyindexnamesessionrepository"><a class="anchor" href="#api-findbyindexnamesessionrepository"></a>FindByIndexNameSessionRepository</h3>
<div class="paragraph">
<p>Spring Session&#8217;s most basic API for using a <code>Session</code> is the <code>SessionRepository</code>.
This API is intentionally very simple, so that it is easy to provide additional implementations with basic functionality.</p>
</div>
<div class="paragraph">
<p>Some <code>SessionRepository</code> implementations may choose to implement <code>FindByIndexNameSessionRepository</code> also.
For example, Spring&#8217;s Redis support implements <code>FindByIndexNameSessionRepository</code>.</p>
</div>
<div class="paragraph">
<p>The <code>FindByIndexNameSessionRepository</code> adds a single method to look up all the sessions for a particular user.
This is done by ensuring that the session attribute with the name <code>FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME</code> is populated with the username.
It is the responsibility of the developer to ensure the attribute is populated since Spring Session is not aware of the authentication mechanism being used.
An example of how this might be used can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> username = <span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>;
<span class="local-variable">this</span>.session.setAttribute(
        FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME, username);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Some implementations of <code>FindByIndexNameSessionRepository</code> will provide hooks to automatically index other session attributes.
For example, many implementations will automatically ensure the current Spring Security user name is indexed with the index name <code>FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once the session is indexed, it can be found using the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> username = <span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>;
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Session&gt; sessionIdToSession = <span class="local-variable">this</span>.sessionRepository
        .findByIndexNameAndIndexValue(
                FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME,
                username);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-enablespringhttpsession"><a class="anchor" href="#api-enablespringhttpsession"></a>EnableSpringHttpSession</h3>
<div class="paragraph">
<p>The <code>@EnableSpringHttpSession</code> annotation can be added to an <code>@Configuration</code> class to expose the <code>SessionRepositoryFilter</code> as a bean named "springSessionRepositoryFilter".
In order to leverage the annotation, a single <code>SessionRepository</code> bean must be provided.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EnableSpringHttpSession</span>
<span class="annotation">@Configuration</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">SpringHttpSessionConfig</span> {
        <span class="annotation">@Bean</span>
        <span class="directive">public</span> MapSessionRepository sessionRepository() {
                <span class="keyword">return</span> <span class="keyword">new</span> MapSessionRepository();
        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is important to note that no infrastructure for session expirations is configured for you out of the box.
This is because things like session expiration are highly implementation dependent.
This means if you require cleaning up expired sessions, you are responsible for cleaning up the expired sessions.</p>
</div>
</div>
<div class="sect2">
<h3 id="api-redisoperationssessionrepository"><a class="anchor" href="#api-redisoperationssessionrepository"></a>RedisOperationsSessionRepository</h3>
<div class="paragraph">
<p><code>RedisOperationsSessionRepository</code> is a <code>SessionRepository</code> that is implemented using Spring Data&#8217;s <code>RedisOperations</code>.
In a web environment, this is typically used in combination with <code>SessionRepositoryFilter</code>.
The implementation supports <code>SessionDestroyedEvent</code> and <code>SessionCreatedEvent</code> through <code>SessionMessageListener</code>.</p>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-new"><a class="anchor" href="#api-redisoperationssessionrepository-new"></a>Instantiating a RedisOperationsSessionRepository</h4>
<div class="paragraph">
<p>A typical example of how to create a new instance can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">LettuceConnectionFactory factory = <span class="keyword">new</span> LettuceConnectionFactory();
SessionRepository&lt;? <span class="directive">extends</span> ExpiringSession&gt; repository = <span class="keyword">new</span> RedisOperationsSessionRepository(
        factory);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For additional information on how to create a <code>RedisConnectionFactory</code>, refer to the Spring Data Redis Reference.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-config"><a class="anchor" href="#api-redisoperationssessionrepository-config"></a>EnableRedisHttpSession</h4>
<div class="paragraph">
<p>In a web environment, the simplest way to create a new <code>RedisOperationsSessionRepository</code> is to use <code>@EnableRedisHttpSession</code>.
Complete example usage can be found in the <a href="#samples">Samples and Guides (Start Here)</a>
You can use the following attributes to customize the configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>maxInactiveIntervalInSeconds</strong> - the amount of time before the session will expire in seconds</p>
</li>
<li>
<p><strong>redisNamespace</strong> - allows configuring an application specific namespace for the sessions. Redis keys and channel ids will start with the prefix of <code>spring:session:&lt;redisNamespace&gt;:</code>.</p>
</li>
<li>
<p><strong>redisFlushMode</strong> - allows specifying when data will be written to Redis. The default is only when <code>save</code> is invoked on <code>SessionRepository</code>.
A value of <code>RedisFlushMode.IMMEDIATE</code> will write to Redis as soon as possible.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="custom-redisserializer"><a class="anchor" href="#custom-redisserializer"></a>Custom RedisSerializer</h5>
<div class="paragraph">
<p>You can customize the serialization by creating a Bean named <code>springSessionDefaultRedisSerializer</code> that implements <code>RedisSerializer&lt;Object&gt;</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="redis-taskexecutor"><a class="anchor" href="#redis-taskexecutor"></a>Redis TaskExecutor</h4>
<div class="paragraph">
<p><code>RedisOperationsSessionRepository</code> is subscribed to receive events from redis using a <code>RedisMessageListenerContainer</code>.
You can customize the way those events are dispatched, by creating a Bean named <code>springSessionRedisTaskExecutor</code> and/or a Bean <code>springSessionRedisSubscriptionExecutor</code>.
More details on configuring redis task executors can be found <a href="http://docs.spring.io/spring-data-redis/docs/current/reference/html/#redis:pubsub:subscribe:containers">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-storage"><a class="anchor" href="#api-redisoperationssessionrepository-storage"></a>Storage Details</h4>
<div class="paragraph">
<p>The sections below outline how Redis is updated for each operation.
An example of creating a new session can be found below.
The subsequent sections describe the details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>HMSET spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe creationTime 1404360000000 \
	maxInactiveInterval 1800 \
	lastAccessedTime 1404360000000 \
	sessionAttr:attrName someAttrValue \
	sessionAttr2:attrName someAttrValue2
EXPIRE spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe 2100
APPEND spring:session:sessions:expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe ""
EXPIRE spring:session:sessions:expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe 1800
SADD spring:session:expirations:1439245080000 expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe
EXPIRE spring:session:expirations1439245080000 2100</pre>
</div>
</div>
<div class="sect4">
<h5 id="saving-a-session"><a class="anchor" href="#saving-a-session"></a>Saving a Session</h5>
<div class="paragraph">
<p>Each session is stored in Redis as a Hash.
Each session is set and updated using the HMSET command.
An example of how each session is stored can be seen below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>HMSET spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe creationTime 1404360000000 \
	maxInactiveInterval 1800 \
	lastAccessedTime 1404360000000 \
	sessionAttr:attrName someAttrValue \
	sessionAttr2:attrName someAttrValue2</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the session following statements are true about the session:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The session id is 33fdd1b6-b496-4b33-9f7d-df96679d32fe</p>
</li>
<li>
<p>The session was created at 1404360000000 in milliseconds since midnight of 1/1/1970 GMT.</p>
</li>
<li>
<p>The session expires in 1800 seconds (30 minutes).</p>
</li>
<li>
<p>The session was last accessed at 1404360000000 in milliseconds since midnight of 1/1/1970 GMT.</p>
</li>
<li>
<p>The session has two attributes.
The first is "attrName" with the value of "someAttrValue".
The second session attribute is named "attrName2" with the value of "someAttrValue2".</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="api-redisoperationssessionrepository-writes"><a class="anchor" href="#api-redisoperationssessionrepository-writes"></a>Optimized Writes</h5>
<div class="paragraph">
<p>The <code>Session</code> instances managed by <code>RedisOperationsSessionRepository</code> keeps track of the properties that have changed and only updates those.
This means if an attribute is written once and read many times we only need to write that attribute once.
For example, assume the session attribute "sessionAttr2" from earlier was updated.
The following would be executed upon saving:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>HMSET spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe sessionAttr:attrName2 newValue</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-redisoperationssessionrepository-expiration"><a class="anchor" href="#api-redisoperationssessionrepository-expiration"></a>Session Expiration</h5>
<div class="paragraph">
<p>An expiration is associated to each session using the EXPIRE command based upon the <code>ExpiringSession.getMaxInactiveInterval()</code>.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>EXPIRE spring:session:sessions:33fdd1b6-b496-4b33-9f7d-df96679d32fe 2100</pre>
</div>
</div>
<div class="paragraph">
<p>You will note that the expiration that is set is 5 minutes after the session actually expires.
This is necessary so that the value of the session can be accessed when the session expires.
An expiration is set on the session itself five minutes after it actually expires to ensure it is cleaned up, but only after we perform any necessary processing.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>SessionRepository.getSession(String)</code> method ensures that no expired sessions will be returned.
This means there is no need to check the expiration before using a session.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spring Session relies on the delete and expired <a href="http://redis.io/topics/notifications">keyspace notifications</a> from Redis to fire a <a href="#api-redisoperationssessionrepository-sessiondestroyedevent">SessionDeletedEvent</a> and <a href="#api-redisoperationssessionrepository-sessiondestroyedevent">SessionExpiredEvent</a> respectively.
It is the <code>SessionDeletedEvent</code> or <code>SessionExpiredEvent</code> that ensures resources associated with the Session are cleaned up.
For example, when using Spring Session&#8217;s WebSocket support the Redis expired or delete event is what triggers any WebSocket connections associated with the session to be closed.</p>
</div>
<div class="paragraph">
<p>Expiration is not tracked directly on the session key itself since this would mean the session data would no longer be available. Instead a special session expires key is used. In our example the expires key is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>APPEND spring:session:sessions:expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe ""
EXPIRE spring:session:sessions:expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe 1800</pre>
</div>
</div>
<div class="paragraph">
<p>When a session expires key is deleted or expires, the keyspace notification triggers a lookup of the actual session and a SessionDestroyedEvent is fired.</p>
</div>
<div class="paragraph">
<p>One problem with relying on Redis expiration exclusively is that Redis makes no guarantee of when the expired event will be fired if the key has not been accessed.
Specifically the background task that Redis uses to clean up expired keys is a low priority task and may not trigger the key expiration.
For additional details see <a href="http://redis.io/topics/notifications">Timing of expired events</a> section in the Redis documentation.</p>
</div>
<div class="paragraph">
<p>To circumvent the fact that expired events are not guaranteed to happen we can ensure that each key is accessed when it is expected to expire.
This means that if the TTL is expired on the key, Redis will remove the key and fire the expired event when we try to access the key.</p>
</div>
<div class="paragraph">
<p>For this reason, each session expiration is also tracked to the nearest minute.
This allows a background task to access the potentially expired sessions to ensure that Redis expired events are fired in a more deterministic fashion.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SADD spring:session:expirations:1439245080000 expires:33fdd1b6-b496-4b33-9f7d-df96679d32fe
EXPIRE spring:session:expirations1439245080000 2100</pre>
</div>
</div>
<div class="paragraph">
<p>The background task will then use these mappings to explicitly request each key.
By accessing the key, rather than deleting it, we ensure that Redis deletes the key for us only if the TTL is expired.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We do not explicitly delete the keys since in some instances there may be a race condition that incorrectly identifies a key as expired when it is not.
Short of using distributed locks (which would kill our performance) there is no way to ensure the consistency of the expiration mapping.
By simply accessing the key, we ensure that the key is only removed if the TTL on that key is expired.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-sessiondestroyedevent"><a class="anchor" href="#api-redisoperationssessionrepository-sessiondestroyedevent"></a>SessionDeletedEvent and SessionExpiredEvent</h4>
<div class="paragraph">
<p><code>SessionDeletedEvent</code> and <code>SessionExpiredEvent</code> are both types of <code>SessionDestroyedEvent</code>.</p>
</div>
<div class="paragraph">
<p><code>RedisOperationsSessionRepository</code> supports firing a <code>SessionDeletedEvent</code> whenever a <code>Session</code> is deleted or a <code>SessionExpiredEvent</code> when it expires.
This is necessary to ensure resources associated with the <code>Session</code> are properly cleaned up.</p>
</div>
<div class="paragraph">
<p>For example, when integrating with WebSockets the <code>SessionDestroyedEvent</code> is in charge of closing any active WebSocket connections.</p>
</div>
<div class="paragraph">
<p>Firing <code>SessionDeletedEvent</code> or <code>SessionExpiredEvent</code> is made available through the <code>SessionMessageListener</code> which listens to <a href="http://redis.io/topics/notifications">Redis Keyspace events</a>.
In order for this to work, Redis Keyspace events for Generic commands and Expired events needs to be enabled.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">redis-cli config set notify-keyspace-events Egx</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are using <code>@EnableRedisHttpSession</code> the <code>SessionMessageListener</code> and enabling the necessary Redis Keyspace events is done automatically.
However, in a secured Redis enviornment the config command is disabled.
This means that Spring Session cannot configure Redis Keyspace events for you.
To disable the automatic configuration add <code>ConfigureRedisAction.NO_OP</code> as a bean.</p>
</div>
<div class="paragraph">
<p>For example, Java Configuration can use the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Bean</span>
<span class="directive">public</span> <span class="directive">static</span> ConfigureRedisAction configureRedisAction() {
    <span class="keyword">return</span> ConfigureRedisAction.NO_OP;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>XML Configuration can use the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;util:constant</span>
    <span class="attribute-name">static-field</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.session.data.redis.config.ConfigureRedisAction.NO_OP</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-sessioncreatedevent"><a class="anchor" href="#api-redisoperationssessionrepository-sessioncreatedevent"></a>SessionCreatedEvent</h4>
<div class="paragraph">
<p>When a session is created an event is sent to Redis with the channel of <code>spring:session:channel:created:33fdd1b6-b496-4b33-9f7d-df96679d32fe</code>
such that <code>33fdd1b6-b496-4b33-9f7d-df96679d32fe</code> is the session id. The body of the event will be the session that was created.</p>
</div>
<div class="paragraph">
<p>If registered as a MessageListener (default), then <code>RedisOperationsSessionRepository</code> will then translate the Redis message into a <code>SessionCreatedEvent</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-redisoperationssessionrepository-cli"><a class="anchor" href="#api-redisoperationssessionrepository-cli"></a>Viewing the Session in Redis</h4>
<div class="paragraph">
<p>After <a href="http://redis.io/topics/quickstart">installing redis-cli</a>, you can inspect the values in Redis <a href="http://redis.io/commands#hash">using the redis-cli</a>.
For example, enter the following into a terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ redis-cli
redis 127.0.0.1:6379&gt; keys *
1) &quot;spring:session:sessions:4fc39ce3-63b3-4e17-b1c4-5e1ed96fb021&quot; <i class="conum" data-value="1"></i><b>(1)</b>
2) &quot;spring:session:expirations:1418772300000&quot; <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The suffix of this key is the session identifier of the Spring Session.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This key contains all the session ids that should be deleted at the time <code>1418772300000</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also view the attributes of each session.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">redis 127.0.0.1:6379&gt; hkeys spring:session:sessions:4fc39ce3-63b3-4e17-b1c4-5e1ed96fb021
1) &quot;lastAccessedTime&quot;
2) &quot;creationTime&quot;
3) &quot;maxInactiveInterval&quot;
4) &quot;sessionAttr:username&quot;
redis 127.0.0.1:6379&gt; hget spring:session:sessions:4fc39ce3-63b3-4e17-b1c4-5e1ed96fb021 sessionAttr:username
&quot;\xac\xed\x00\x05t\x00\x03rob&quot;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-gemfireoperationssessionrepository"><a class="anchor" href="#api-gemfireoperationssessionrepository"></a>GemFireOperationsSessionRepository</h3>
<div class="paragraph">
<p><code>GemFireOperationsSessionRepository</code> is a <code>SessionRepository</code> that is implemented using Spring Data&#8217;s <code>GemFireOperationsSessionRepository</code>.
In a web environment, this is typically used in combination with <code>SessionRepositoryFilter</code>.
The implementation supports <code>SessionDestroyedEvent</code> and <code>SessionCreatedEvent</code> through <code>SessionMessageListener</code>.</p>
</div>
<div class="sect3">
<h4 id="api-gemfireoperationssessionrepository-indexing"><a class="anchor" href="#api-gemfireoperationssessionrepository-indexing"></a>Using Indexes with GemFire</h4>
<div class="paragraph">
<p>While best practices concerning the proper definition of indexes that positively impact GemFire&#8217;s performance is beyond
the scope of this document, it is important to realize that Spring Session Data GemFire creates and uses indexes to
query and find Sessions efficiently.</p>
</div>
<div class="paragraph">
<p>Out-of-the-box, Spring Session Data GemFire creates 1 Hash-typed Index on the principal name. There are two different buit in
strategies for finding the principal name. The first strategy is that the value of the session attribute with the name
<code>FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME</code> will be indexed to the same index name. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> indexName = FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME;
session.setAttribute(indexName, username);
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, ExpiringSession&gt; idToSessions = sessionRepository
        .findByIndexNameAndIndexValue(indexName, username);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-gemfireoperationssessionrepository-indexing-security"><a class="anchor" href="#api-gemfireoperationssessionrepository-indexing-security"></a>Using Indexes with GemFire &amp; Spring Security</h4>
<div class="paragraph">
<p>Alternatively, Spring Session Data GemFire will map Spring Security&#8217;s current <code>Authentication#getName()</code> to the index
<code>FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME</code>. For example, if you are using Spring Security you can
find the current user&#8217;s sessions using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">SecurityContext context = SecurityContextHolder.getContext();
Authentication authentication = context.getAuthentication();
<span class="predefined-type">String</span> indexName = FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME;
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, ExpiringSession&gt; idToSessions = sessionRepository
        .findByIndexNameAndIndexValue(indexName, authentication.getName());</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-gemfireoperationssessionrepository-indexing-custom"><a class="anchor" href="#api-gemfireoperationssessionrepository-indexing-custom"></a>Using Custom Indexes with GemFire</h4>
<div class="paragraph">
<p>This enables developers using the <code>GemFireOperationsSessionRepository</code> programmatically to query and find all Sessions
with a given principal name efficiently.</p>
</div>
<div class="paragraph">
<p>Additionally, Spring Session Data GemFire will create a Range-based Index on the implementing Session&#8217;s Map-type
<code>attributes</code> property (i.e. on any arbitrary Session attribute) when a developer identifies 1 or more named Session
attributes that should be indexed by GemFire.</p>
</div>
<div class="paragraph">
<p>Sessions attributes to index can be specified with the <code>indexableSessionAttributes</code> attribute on the <code>@EnableGemFireHttpSession</code>
annotation.  A developer adds this annotation to their Spring application <code>@Configuration</code> class when s/he wishes to
enable Spring Session support for HttpSession backed by GemFire.</p>
</div>
<div class="paragraph">
<p>For example, the following configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EnableGemFireHttpSession</span>(indexableSessionAttributes = { <span class="string"><span class="delimiter">&quot;</span><span class="content">name1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">name2</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">name3</span><span class="delimiter">&quot;</span></span> })
<span class="directive">public</span> <span class="type">class</span> <span class="class">GemFireHttpSessionConfig</span> {
        <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>will allow searching for sessions using the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> indexName = <span class="string"><span class="delimiter">&quot;</span><span class="content">name1</span><span class="delimiter">&quot;</span></span>;
session.setAttribute(indexName, attrValue);
<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, ExpiringSession&gt; idToSessions = sessionRepository
        .findByIndexNameAndIndexValue(indexName, attrValue);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Only Session attribute names identified in the <code>@EnableGemFireHttpSession</code> annotation&#8217;s <code>indexableSessionAttributes</code>
attribute will have an Index defined.  All other Session attributes will not be indexed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>However, there is one caveat. Any values stored in indexable Session attributes must implement the <code>java.lang.Comparable&lt;T&gt;</code>
interface. If those object values do not implement <code>Comparable</code>, then GemFire will throw an error on startup when the
Index is defined for Regions with persistent Session data, or when an attempt is made at runtime to assign the indexable
Session attribute a value that is not <code>Comparable</code> and the Session is saved to GemFire.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Any Session attribute that is not indexed may store non-<code>Comparable</code> values.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To learn more about GemFire&#8217;s Range-based Indexes, see <a href="http://gemfire.docs.pivotal.io/docs-gemfire/latest/developing/query_index/creating_map_indexes.html">Creating Indexes on Map Fields</a>.</p>
</div>
<div class="paragraph">
<p>To learn more about GemFire Indexing in general, see <a href="http://gemfire.docs.pivotal.io/docs-gemfire/latest/developing/query_index/query_index.html">Working with Indexes</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-mapsessionrepository"><a class="anchor" href="#api-mapsessionrepository"></a>MapSessionRepository</h3>
<div class="paragraph">
<p>The <code>MapSessionRepository</code> allows for persisting <code>ExpiringSession</code> in a <code>Map</code> with the key being the <code>ExpiringSession</code> id and the value being the <code>ExpiringSession</code>.
The implementation can be used with a <code>ConcurrentHashMap</code> as a testing or convenience mechanism.
Alternatively, it can be used with distributed <code>Map</code> implementations. For example, it can be used with Hazelcast.</p>
</div>
<div class="sect3">
<h4 id="api-mapsessionrepository-new"><a class="anchor" href="#api-mapsessionrepository-new"></a>Instantiating MapSessionRepository</h4>
<div class="paragraph">
<p>Creating a new instance is as simple as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">SessionRepository&lt;? <span class="directive">extends</span> ExpiringSession&gt; repository = <span class="keyword">new</span> MapSessionRepository();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-mapsessionrepository-hazelcast"><a class="anchor" href="#api-mapsessionrepository-hazelcast"></a>Using Spring Session and Hazlecast</h4>
<div class="paragraph">
<p>The <a href="#samples">Hazelcast Sample</a> is a complete application demonstrating using Spring Session with Hazelcast.</p>
</div>
<div class="paragraph">
<p>To run it use the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./gradlew :samples:hazelcast:tomcatRun</pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="#samples">Hazelcast Spring Sample</a> is a complete application demonstrating using Spring Session with Hazelcast and Spring Security.</p>
</div>
<div class="paragraph">
<p>It includes example Hazelcast <code>MapListener</code> implementations that support firing <code>SessionCreatedEvent</code>, <code>SessionDeletedEvent</code> and <code>SessionExpiredEvent</code>.</p>
</div>
<div class="paragraph">
<p>To run it use the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./gradlew :samples:hazelcast-spring:tomcatRun</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-jdbcoperationssessionrepository"><a class="anchor" href="#api-jdbcoperationssessionrepository"></a>JdbcOperationsSessionRepository</h3>
<div class="paragraph">
<p><code>JdbcOperationsSessionRepository</code> is a <code>SessionRepository</code> implementation that uses Spring&#8217;s <code>JdbcOperations</code> to store sessions in a relational database.
In a web environment, this is typically used in combination with <code>SessionRepositoryFilter</code>.
Please note that this implementation does not support publishing of session events.</p>
</div>
<div class="sect3">
<h4 id="api-jdbcoperationssessionrepository-new"><a class="anchor" href="#api-jdbcoperationssessionrepository-new"></a>Instantiating a JdbcOperationsSessionRepository</h4>
<div class="paragraph">
<p>A typical example of how to create a new instance can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate();

<span class="comment">// ... configure JdbcTemplate ...</span>

PlatformTransactionManager transactionManager = <span class="keyword">new</span> DataSourceTransactionManager();

<span class="comment">// ... configure transactionManager ...</span>

SessionRepository&lt;? <span class="directive">extends</span> ExpiringSession&gt; repository =
        <span class="keyword">new</span> JdbcOperationsSessionRepository(jdbcTemplate, transactionManager);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For additional information on how to create and configure <code>JdbcTemplate</code> and <code>PlatformTransactionManager</code>, refer to the <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/html/spring-data-tier.html">Spring Framework Reference Documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-jdbcoperationssessionrepository-config"><a class="anchor" href="#api-jdbcoperationssessionrepository-config"></a>EnableJdbcHttpSession</h4>
<div class="paragraph">
<p>In a web environment, the simplest way to create a new <code>JdbcOperationsSessionRepository</code> is to use <code>@EnableJdbcHttpSession</code>.
Complete example usage can be found in the <a href="#samples">Samples and Guides (Start Here)</a>
You can use the following attributes to customize the configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>tableName</strong> - the name of database table used by Spring Session to store sessions</p>
</li>
<li>
<p><strong>maxInactiveIntervalInSeconds</strong> - the amount of time before the session will expire in seconds</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="custom-lobhandler"><a class="anchor" href="#custom-lobhandler"></a>Custom LobHandler</h5>
<div class="paragraph">
<p>You can customize the BLOB handling by creating a Bean named <code>springSessionLobHandler</code> that implements <code>LobHandler</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="custom-conversionservice"><a class="anchor" href="#custom-conversionservice"></a>Custom ConversionService</h5>
<div class="paragraph">
<p>You can customize the default serialization and deserialization of the session by providing a <code>ConversionService</code> instance.
When working in a typical Spring environment, the default <code>ConversionService</code> Bean (named <code>conversionService</code>) will be automatically picked up and used for serialization and deserialization.
However, you can override the default <code>ConversionService</code> by providing a Bean named <code>springSessionConversionService</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-jdbcoperationssessionrepository-storage"><a class="anchor" href="#api-jdbcoperationssessionrepository-storage"></a>Storage Details</h4>
<div class="paragraph">
<p>By default, this implementation uses <code>SPRING_SESSION</code> and <code>SPRING_SESSION_ATTRIBUTES</code> tables to store sessions.
Note that the table name can be easily customized as already described. In that case the table used to store attributes will be named using the provided table name, suffixed with <code>_ATTRIBUTES</code>.
If further customizations are needed, SQL queries used by the repository can be customized using <code>set*Query</code> setter methods. In this case you need to manually configure the <code>sessionRepository</code> bean.</p>
</div>
<div class="paragraph">
<p>Due to the differences between the various database vendors, especially when it comes to storing binary data, make sure to use SQL script specific to your database.
Scripts for most major database vendors are packaged as <code>org/springframework/session/jdbc/schema-*.sql</code>, where <code>*</code> is the target database type.</p>
</div>
<div class="paragraph">
<p>For example, with PostgreSQL database you would use the following schema script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">CREATE</span> <span class="type">TABLE</span> SPRING_SESSION (
        SESSION_ID <span class="predefined-type">CHAR</span>(<span class="integer">36</span>) <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
        CREATION_TIME <span class="predefined-type">BIGINT</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
        LAST_ACCESS_TIME <span class="predefined-type">BIGINT</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
        MAX_INACTIVE_INTERVAL <span class="predefined-type">INT</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
        PRINCIPAL_NAME <span class="predefined-type">VARCHAR</span>(<span class="integer">100</span>),
        <span class="type">CONSTRAINT</span> SPRING_SESSION_PK <span class="directive">PRIMARY</span> <span class="type">KEY</span> (SESSION_ID)
);

<span class="class">CREATE</span> <span class="type">INDEX</span> SPRING_SESSION_IX1 <span class="keyword">ON</span> SPRING_SESSION (LAST_ACCESS_TIME);
<span class="class">CREATE</span> <span class="type">INDEX</span> SPRING_SESSION_IX2 <span class="keyword">ON</span> SPRING_SESSION (PRINCIPAL_NAME);

<span class="class">CREATE</span> <span class="type">TABLE</span> SPRING_SESSION_ATTRIBUTES (
        SESSION_ID <span class="predefined-type">CHAR</span>(<span class="integer">36</span>) <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
        ATTRIBUTE_NAME <span class="predefined-type">VARCHAR</span>(<span class="integer">200</span>) <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
        ATTRIBUTE_BYTES BYTEA <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
        <span class="type">CONSTRAINT</span> SPRING_SESSION_ATTRIBUTES_PK <span class="directive">PRIMARY</span> <span class="type">KEY</span> (SESSION_ID, ATTRIBUTE_NAME),
        <span class="type">CONSTRAINT</span> SPRING_SESSION_ATTRIBUTES_FK <span class="directive">FOREIGN</span> <span class="type">KEY</span> (SESSION_ID) <span class="keyword">REFERENCES</span> SPRING_SESSION(SESSION_ID) <span class="keyword">ON</span> <span class="class">DELETE</span> <span class="directive">CASCADE</span>
);

<span class="class">CREATE</span> <span class="type">INDEX</span> SPRING_SESSION_ATTRIBUTES_IX1 <span class="keyword">ON</span> SPRING_SESSION_ATTRIBUTES (SESSION_ID);</code></pre>
</div>
</div>
<div class="paragraph">
<p>And with MySQL database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">CREATE</span> <span class="type">TABLE</span> SPRING_SESSION (
        SESSION_ID <span class="predefined-type">CHAR</span>(<span class="integer">36</span>) <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
        CREATION_TIME <span class="predefined-type">BIGINT</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
        LAST_ACCESS_TIME <span class="predefined-type">BIGINT</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
        MAX_INACTIVE_INTERVAL <span class="predefined-type">INT</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
        PRINCIPAL_NAME <span class="predefined-type">VARCHAR</span>(<span class="integer">100</span>),
        <span class="type">CONSTRAINT</span> SPRING_SESSION_PK <span class="directive">PRIMARY</span> <span class="type">KEY</span> (SESSION_ID)
) <span class="directive">ENGINE</span>=InnoDB;

<span class="class">CREATE</span> <span class="type">INDEX</span> SPRING_SESSION_IX1 <span class="keyword">ON</span> SPRING_SESSION (LAST_ACCESS_TIME);
<span class="class">CREATE</span> <span class="type">INDEX</span> SPRING_SESSION_IX2 <span class="keyword">ON</span> SPRING_SESSION (PRINCIPAL_NAME);

<span class="class">CREATE</span> <span class="type">TABLE</span> SPRING_SESSION_ATTRIBUTES (
        SESSION_ID <span class="predefined-type">CHAR</span>(<span class="integer">36</span>) <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
        ATTRIBUTE_NAME <span class="predefined-type">VARCHAR</span>(<span class="integer">200</span>) <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
        ATTRIBUTE_BYTES <span class="predefined-type">BLOB</span> <span class="keyword">NOT</span> <span class="predefined-constant">NULL</span>,
        <span class="type">CONSTRAINT</span> SPRING_SESSION_ATTRIBUTES_PK <span class="directive">PRIMARY</span> <span class="type">KEY</span> (SESSION_ID, ATTRIBUTE_NAME),
        <span class="type">CONSTRAINT</span> SPRING_SESSION_ATTRIBUTES_FK <span class="directive">FOREIGN</span> <span class="type">KEY</span> (SESSION_ID) <span class="keyword">REFERENCES</span> SPRING_SESSION(SESSION_ID) <span class="keyword">ON</span> <span class="class">DELETE</span> <span class="directive">CASCADE</span>
) <span class="directive">ENGINE</span>=InnoDB;

<span class="class">CREATE</span> <span class="type">INDEX</span> SPRING_SESSION_ATTRIBUTES_IX1 <span class="keyword">ON</span> SPRING_SESSION_ATTRIBUTES (SESSION_ID);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="transaction-management"><a class="anchor" href="#transaction-management"></a>Transaction management</h4>
<div class="paragraph">
<p>All JDBC operations in <code>JdbcOperationsSessionRepository</code> are executed in a transactional manner.
Transactions are executed with propagation set to <code>REQUIRES_NEW</code> in order to avoid unexpected behavior due to interference with existing transactions (for example, executing <code>save</code> operation in a thread that already participates in a read-only transaction).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-hazelcastsessionrepository"><a class="anchor" href="#api-hazelcastsessionrepository"></a>HazelcastSessionRepository</h3>
<div class="paragraph">
<p><code>HazelcastSessionRepository</code> is a <code>SessionRepository</code> implementation that stores sessions in Hazelcast&#8217;s distributed <code>IMap</code>.
In a web environment, this is typically used in combination with <code>SessionRepositoryFilter</code>.</p>
</div>
<div class="sect3">
<h4 id="api-hazelcastsessionrepository-new"><a class="anchor" href="#api-hazelcastsessionrepository-new"></a>Instantiating a HazelcastSessionRepository</h4>
<div class="paragraph">
<p>A typical example of how to create a new instance can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Config config = <span class="keyword">new</span> Config();

<span class="comment">// ... configure Hazelcast ...</span>

HazelcastInstance hazelcastInstance = Hazelcast.newHazelcastInstance(config);

IMap&lt;<span class="predefined-type">String</span>, MapSession&gt; sessions = hazelcastInstance
        .getMap(<span class="string"><span class="delimiter">&quot;</span><span class="content">spring:session:sessions</span><span class="delimiter">&quot;</span></span>);

HazelcastSessionRepository repository =
        <span class="keyword">new</span> HazelcastSessionRepository(sessions);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For additional information on how to create and configure Hazelcast instance, refer to the <a href="http://docs.hazelcast.org/docs/latest/manual/html-single/index.html#hazelcast-configuration">Hazelcast documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-enablehazelcasthttpsession"><a class="anchor" href="#api-enablehazelcasthttpsession"></a>EnableHazelcastHttpSession</h4>
<div class="paragraph">
<p>If you wish to use <a href="http://hazelcast.org/">Hazelcast</a> as your backing source for the <code>SessionRepository</code>, then the <code>@EnableHazelcastHttpSession</code> annotation
can be added to an <code>@Configuration</code> class. This extends the functionality provided by the <code>@EnableSpringHttpSession</code> annotation but makes the <code>SessionRepository</code> for you in Hazelcast.
You must provide a single <code>HazelcastInstance</code> bean for the configuration to work.
Complete configuration example can be found in the <a href="#samples">Samples and Guides (Start Here)</a></p>
</div>
</div>
<div class="sect3">
<h4 id="api-enablehazelcasthttpsession-storage"><a class="anchor" href="#api-enablehazelcasthttpsession-storage"></a>Storage Details</h4>
<div class="paragraph">
<p>Sessions will be stored in a distributed <code>IMap</code> in Hazelcast using a <a href="#api-mapsessionrepository">MapSessionRepository</a>.
The <code>IMap</code> interface methods will be used to <code>get()</code> and <code>put()</code> Sessions.
Additionally, <code>values()</code> method is used to support <code>FindByIndexNameSessionRepository#findByIndexNameAndIndexValue</code> operation, together with appropriate <code>ValueExtractor</code> that needs to be registered with Hazelcast. Refer to <a href="#samples">Hazelcast Spring Sample</a> for more details on this configuration.
The expiration of a session in the <code>IMap</code> is handled by Hazelcast&#8217;s support for setting the time to live on an entry when it is <code>put()</code> into the <code>IMap</code>. Entries (sessions) that have been idle longer than the time to live will be automatically removed from the <code>IMap</code>.</p>
</div>
<div class="paragraph">
<p>You shouldn&#8217;t need to configure any settings such as <code>max-idle-seconds</code> or <code>time-to-live-seconds</code> for the <code>IMap</code> within the Hazelcast configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-enablehazelcasthttpsession-customize"><a class="anchor" href="#api-enablehazelcasthttpsession-customize"></a>Basic Customization</h4>
<div class="paragraph">
<p>You can use the following attributes on <code>@EnableHazelcastHttpSession</code> to customize the configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>maxInactiveIntervalInSeconds</strong> - the amount of time before the session will expire in seconds. Default is 1800 seconds (30 minutes)</p>
</li>
<li>
<p><strong>sessionMapName</strong> - the name of the distributed <code>Map</code> that will be used in Hazelcast to store the session data.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="api-enablehazelcasthttpsession-events"><a class="anchor" href="#api-enablehazelcasthttpsession-events"></a>Session Events</h4>
<div class="paragraph">
<p>Using a <code>MapListener</code> to respond to entries being added, evicted, and removed from the distributed <code>Map</code>, these events will trigger
publishing SessionCreatedEvent, SessionExpiredEvent, and SessionDeletedEvent events respectively using the <code>ApplicationEventPublisher</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="community"><a class="anchor" href="#community"></a>Spring Session Community</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We are glad to consider you a part of our community.
Please find additional information below.</p>
</div>
<div class="sect2">
<h3 id="community-support"><a class="anchor" href="#community-support"></a>Support</h3>
<div class="paragraph">
<p>You can get help by asking questions on <a href="http://stackoverflow.com/questions/tagged/spring-session">StackOverflow with the tag spring-session</a>.
Similarly we encourage helping others by answering questions on StackOverflow.</p>
</div>
</div>
<div class="sect2">
<h3 id="community-source"><a class="anchor" href="#community-source"></a>Source Code</h3>
<div class="paragraph">
<p>Our source code can be found on github at <a href="https://github.com/spring-projects/spring-session/" class="bare">https://github.com/spring-projects/spring-session/</a></p>
</div>
</div>
<div class="sect2">
<h3 id="community-issues"><a class="anchor" href="#community-issues"></a>Issue Tracking</h3>
<div class="paragraph">
<p>We track issues in github issues at <a href="https://github.com/spring-projects/spring-session/issues" class="bare">https://github.com/spring-projects/spring-session/issues</a></p>
</div>
</div>
<div class="sect2">
<h3 id="community-contributing"><a class="anchor" href="#community-contributing"></a>Contributing</h3>
<div class="paragraph">
<p>We appreciate <a href="https://help.github.com/articles/using-pull-requests/">Pull Requests</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="community-license"><a class="anchor" href="#community-license"></a>License</h3>
<div class="paragraph">
<p>Spring Session is Open Source software released under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache 2.0 license</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="community-extensions"><a class="anchor" href="#community-extensions"></a>Community Extensions</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Location</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Session OrientDB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/maseev/spring-session-orientdb" class="bare">https://github.com/maseev/spring-session-orientdb</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Session Infinispan</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://infinispan.org/docs/dev/user_guide/user_guide.html#externalizing_session_using_spring_session" class="bare">http://infinispan.org/docs/dev/user_guide/user_guide.html#externalizing_session_using_spring_session</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="minimum-requirements"><a class="anchor" href="#minimum-requirements"></a>Minimum Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The minimum requirements for Spring Session are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java 5+</p>
</li>
<li>
<p>If you are running in a Servlet Container (not required), Servlet 2.5+</p>
</li>
<li>
<p>If you are using other Spring libraries (not required), the minimum required version is Spring 3.2.14.
While we re-run all unit tests against Spring 3.2.x, we recommend using the latest Spring 4.x version when possible.</p>
</li>
<li>
<p><code>@EnableRedisHttpSession</code> requires Redis 2.8+. This is necessary to support <a href="#api-redisoperationssessionrepository-expiration">Session Expiration</a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>At its core Spring Session only has a required dependency on commons-logging.
For an example of using Spring Session without any other Spring dependencies, refer to the <a href="#samples">hazelcast sample</a> application.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.3.5.RELEASE<br>
Last updated 2019-01-11 04:53:48 +00:00
</div>
</div>
</body>
</html>