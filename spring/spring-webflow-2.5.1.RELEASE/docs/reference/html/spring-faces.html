<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>13.&nbsp;JSF Integration</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Spring Web Flow Reference Guide"><link rel="up" href="index.html" title="Spring Web Flow Reference Guide"><link rel="prev" href="spring-js.html" title="12.&nbsp;Spring JavaScript Quick Reference"><link rel="next" href="testing.html" title="14.&nbsp;Testing flows"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">13.&nbsp;JSF Integration</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="spring-js.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="testing.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="spring-faces" href="#spring-faces"></a>13.&nbsp;JSF Integration</h1></div></div></div>
	

	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spring-faces-introduction" href="#spring-faces-introduction"></a>13.1.&nbsp;Introduction</h2></div></div></div>
		
		<p>
			Spring Web Flow provides a JSF integration that lets you use the JSF UI
			Component Model with Spring Web Flow controllers. Web Flow also provides
			a Spring Security tag library for use in JSF environments,
			see <a class="xref" href="spring-faces.html#spring-faces-security-taglib" title="13.9.&nbsp;Using the Spring Security Facelets Tag Library">Section&nbsp;13.9, &#8220;Using the Spring Security Facelets Tag Library&#8221;</a> for more details.
		</p>
		<p>Spring Web Flow 2.5 requires JSF 2.2 or higher.</p>
	</div>

	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spring-faces-config-web.xml" href="#spring-faces-config-web.xml"></a>13.2.&nbsp;Configuring web.xml</h2></div></div></div>
		

		<p>The first step is to route requests to the
		<code class="code">DispatcherServlet</code> in the <code class="code">web.xml</code> file. In this
		example, we map all URLs that begin with <code class="code">/spring/</code> to the
		servlet. The servlet needs to be configured. An <code class="code">init-param</code> is
		used in the servlet to pass the <code class="code">contextConfigLocation</code>. This
		is the location of the Spring configuration for your web
		application.</p>

		<pre class="programlisting">
<span class="hl-tag">&lt;servlet&gt;</span>
	<span class="hl-tag">&lt;servlet-name&gt;</span>Spring MVC Dispatcher Servlet<span class="hl-tag">&lt;/servlet-name&gt;</span>
	<span class="hl-tag">&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hl-tag">&lt;/servlet-class&gt;</span>
	<span class="hl-tag">&lt;init-param&gt;</span>
		<span class="hl-tag">&lt;param-name&gt;</span>contextConfigLocation<span class="hl-tag">&lt;/param-name&gt;</span>
		<span class="hl-tag">&lt;param-value&gt;</span>/WEB-INF/web-application-config.xml<span class="hl-tag">&lt;/param-value&gt;</span>
	<span class="hl-tag">&lt;/init-param&gt;</span>
	<span class="hl-tag">&lt;load-on-startup&gt;</span>1<span class="hl-tag">&lt;/load-on-startup&gt;</span>
<span class="hl-tag">&lt;/servlet&gt;</span>

<span class="hl-tag">&lt;servlet-mapping&gt;</span>
	<span class="hl-tag">&lt;servlet-name&gt;</span>Spring MVC Dispatcher Servlet<span class="hl-tag">&lt;/servlet-name&gt;</span>
	<span class="hl-tag">&lt;url-pattern&gt;</span>/spring/*<span class="hl-tag">&lt;/url-pattern&gt;</span>
<span class="hl-tag">&lt;/servlet-mapping&gt;</span>
		</pre>

		<p>In order for JSF to bootstrap correctly, the
		<code class="code">FacesServlet</code> must be configured in <code class="code">web.xml</code> as it
		normally would even though you generally will not need to route requests
		through it at all when using JSF with Spring Web Flow.</p>

		<pre class="programlisting">
<span class="hl-comment">&lt;!-- Just here so the JSF implementation can initialize, *not* used at runtime --&gt;</span>
<span class="hl-tag">&lt;servlet&gt;</span>
	<span class="hl-tag">&lt;servlet-name&gt;</span>Faces Servlet<span class="hl-tag">&lt;/servlet-name&gt;</span>
	<span class="hl-tag">&lt;servlet-class&gt;</span>javax.faces.webapp.FacesServlet<span class="hl-tag">&lt;/servlet-class&gt;</span>
	<span class="hl-tag">&lt;load-on-startup&gt;</span>1<span class="hl-tag">&lt;/load-on-startup&gt;</span>
<span class="hl-tag">&lt;/servlet&gt;</span>

<span class="hl-comment">&lt;!-- Just here so the JSF implementation can initialize --&gt;</span>
<span class="hl-tag">&lt;servlet-mapping&gt;</span>
	<span class="hl-tag">&lt;servlet-name&gt;</span>Faces Servlet<span class="hl-tag">&lt;/servlet-name&gt;</span>
	<span class="hl-tag">&lt;url-pattern&gt;</span>*.faces<span class="hl-tag">&lt;/url-pattern&gt;</span>
<span class="hl-tag">&lt;/servlet-mapping&gt;</span>
		</pre>

		<p>The use of Facelets instead of JSP typically requires this in
		web.xml:</p>

		<pre class="programlisting">
!-- Use JSF view templates saved as *.xhtml, for use with Facelets --&gt;
<span class="hl-tag">&lt;context-param&gt;</span>
	<span class="hl-tag">&lt;param-name&gt;</span>javax.faces.DEFAULT_SUFFIX<span class="hl-tag">&lt;/param-name&gt;</span>
	<span class="hl-tag">&lt;param-value&gt;</span>.xhtml<span class="hl-tag">&lt;/param-value&gt;</span>
<span class="hl-tag">&lt;/context-param&gt;</span>
		</pre>

	</div>

	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spring-faces-webflow-config" href="#spring-faces-webflow-config"></a>13.3.&nbsp;Configuring Web Flow for use with JSF</h2></div></div></div>
		

		<p>This section explains how to configure Web Flow with JSF.
		Both Java and XML style configuration are supported.
		The following is sample configuration for Web Flow and JSF in XML:</p>

		<pre class="programlisting">
<span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
	<span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
	<span class="hl-attribute">xmlns:webflow</span>=<span class="hl-value">"http://www.springframework.org/schema/webflow-config"</span>
	<span class="hl-attribute">xmlns:faces</span>=<span class="hl-value">"http://www.springframework.org/schema/faces"</span>
	<span class="hl-attribute">si:schemaLocation</span>=<span class="hl-value">"
		http://www.springframework.org/schema/beans
		http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/webflow-config
		http://www.springframework.org/schema/webflow-config/spring-webflow-config.xsd
		http://www.springframework.org/schema/faces
		http://www.springframework.org/schema/faces/spring-faces.xsd"</span><span class="hl-tag">&gt;</span>

	<span class="hl-comment">&lt;!-- Executes flows: the central entry point into the Spring Web Flow system --&gt;</span>
	<span class="hl-tag">&lt;webflow:flow-executor</span> <span class="hl-attribute">id</span>=<span class="hl-value">"flowExecutor"</span><span class="hl-tag">&gt;</span>
		<span class="hl-tag">&lt;webflow:flow-execution-listeners&gt;</span>
			<span class="hl-tag">&lt;webflow:listener</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"facesContextListener"</span><span class="hl-tag">/&gt;</span>
		<span class="hl-tag">&lt;/webflow:flow-execution-listeners&gt;</span>
	<span class="hl-tag">&lt;/webflow:flow-executor&gt;</span>

	<span class="hl-comment">&lt;!-- The registry of executable flow definitions --&gt;</span>
	<span class="hl-tag">&lt;webflow:flow-registry</span> <span class="hl-attribute">id</span>=<span class="hl-value">"flowRegistry"</span> <span class="hl-attribute">flow-builder-services</span>=<span class="hl-value">"flowBuilderServices"</span> <span class="hl-attribute">base-path</span>=<span class="hl-value">"/WEB-INF"</span><span class="hl-tag">&gt;</span>
		<span class="hl-tag">&lt;webflow:flow-location-pattern</span> <span class="hl-attribute">value</span>=<span class="hl-value">"**/*-flow.xml"</span><span class="hl-tag"> /&gt;</span>
	<span class="hl-tag">&lt;/webflow:flow-registry&gt;</span>

	<span class="hl-comment">&lt;!-- Configures the Spring Web Flow JSF integration --&gt;</span>
	<span class="hl-tag">&lt;faces:flow-builder-services</span> <span class="hl-attribute">id</span>=<span class="hl-value">"flowBuilderServices"</span><span class="hl-tag"> /&gt;</span>

	<span class="hl-comment">&lt;!-- A listener maintain one FacesContext instance per Web Flow request. --&gt;</span>
	<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"facesContextListener"</span>
		<span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.faces.webflow.FlowFacesContextLifecycleListener"</span><span class="hl-tag"> /&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span>
		</pre>

		<p>
			The following is an example of the same in Java configuration:
		</p>

		<pre class="programlisting">
<span class="hl-keyword">import</span> org.springframework.context.annotation.Bean;
<span class="hl-keyword">import</span> org.springframework.context.annotation.Configuration;
<span class="hl-keyword">import</span> org.springframework.faces.config.*;

<em><span class="hl-annotation" style="color: gray">@Configuration</span></em>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> WebFlowConfig <span class="hl-keyword">extends</span> AbstractFacesFlowConfiguration {

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> FlowExecutor flowExecutor() {
        <span class="hl-keyword">return</span> getFlowExecutorBuilder(flowRegistry())
                .addFlowExecutionListener(<span class="hl-keyword">new</span> FlowFacesContextLifecycleListener())
                .build();
    }

    <em><span class="hl-annotation" style="color: gray">@Bean</span></em>
    <span class="hl-keyword">public</span> FlowDefinitionRegistry flowRegistry() {
        <span class="hl-keyword">return</span> getFlowDefinitionRegistryBuilder()
                .setBasePath(<span class="hl-string">"/WEB-INF"</span>)
                .addFlowLocationPattern(<span class="hl-string">"**/*-flow.xml"</span>).build();

}
		</pre>

		<p>The main points are the installation of a
		<code class="code">FlowFacesContextLifecycleListener</code> that manages a single
		FacesContext for the duration of Web Flow request and the use of the
		<code class="code">flow-builder-services</code> element from the <code class="code">faces</code>
		custom namespace to configure rendering for a JSF environment.</p>

		<p>In a JSF environment you'll also need this Spring MVC related
		configuration:</p>

		<pre class="programlisting">
<span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
		 <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
		 <span class="hl-attribute">xmlns:faces</span>=<span class="hl-value">"http://www.springframework.org/schema/faces"</span>
		 <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"
			 http://www.springframework.org/schema/beans
			 http://www.springframework.org/schema/beans/spring-beans.xsd
			 http://www.springframework.org/schema/faces
			 http://www.springframework.org/schema/faces/spring-faces.xsd"</span><span class="hl-tag">&gt;</span>

	<span class="hl-tag">&lt;faces:resources /&gt;</span>

	<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">class</span>=<span class="hl-value">"org.springframework.faces.webflow.JsfFlowHandlerAdapter"</span><span class="hl-tag">&gt;</span>
		<span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"flowExecutor"</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"flowExecutor"</span><span class="hl-tag"> /&gt;</span>
	<span class="hl-tag">&lt;/bean&gt;</span>

<span class="hl-tag">&lt;/beans&gt;</span>
		</pre>

		<p>The <code class="code">resources</code> custom namespace element delegates JSF
		resource requests to the JSF resource API. The
		<code class="code">JsfFlowHandlerAdapter</code> is a replacement for the
		<code class="code">FlowHandlerAdapter</code> normally used with Web Flow. This adapter
		initializes itself with a <code class="code">JsfAjaxHandler</code> instead of the
		<code class="code">SpringJavaSciprtAjaxHandler</code>.</p>

		<p>When using Java config, the <code class="classname">AbstractFacesFlowConfiguration</code>
		base class automatically registers <code class="classname">JsfResourceRequestHandler</code>
		so there is nothing further to do.
		</p>

	</div>

	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spring-faces-managed-beans" href="#spring-faces-managed-beans"></a>13.4.&nbsp;Replacing the JSF Managed Bean Facility</h2></div></div></div>
		

		<p>When using JSF with Spring Web Flow you can completely replace the
		JSF managed bean facility with a combination of Web Flow managed variables
		and Spring managed beans. It gives you a good deal more control over the
		lifecycle of your managed objects with well-defined hooks for
		initialization and execution of your domain model. Additionally, since you
		are presumably already using Spring for your business layer, it reduces
		the conceptual overhead of having to maintain two different managed bean
		models.</p>

		<p>In doing pure JSF development, you will quickly find that request
		scope is not long-lived enough for storing conversational model objects
		that drive complex event-driven views. In JSF the usual option is to begin
		putting things into session scope, with the extra
		burden of needing to clean the objects up before progressing to another
		view or functional area of the application. What is really needed is a
		managed scope that is somewhere between request and session scope. JSF
		provides flash and view scopes that can be accessed programmatically via
		UIViewRoot.getViewMap(). Spring Web Flow provides access to flash, view,
		flow, and conversation scopes. These scopes are seamlessly integrated
		through JSF variable resolvers and work the same in all JSF
		applications.</p>

		<div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="spring-faces-flow-variables" href="#spring-faces-flow-variables"></a>13.4.1.&nbsp;Using Flow Variables</h3></div></div></div>
			

			<p>The easiest and most natural way to declare and manage the model
			is through the use of <a class="link" href="defining-flows.html#flow-variables" title="3.8.&nbsp;Variables">flow
			variables</a>. You can declare these variables at the beginning of
			the flow:</p>

			<pre class="programlisting">
<span class="hl-tag">&lt;var</span> <span class="hl-attribute">name</span>=<span class="hl-value">"searchCriteria"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.mycompany.myapp.hotels.search.SearchCriteria"</span><span class="hl-tag">/&gt;</span>
			</pre>

			<p>and then reference this variable in one of the flow's JSF view
			templates through EL:</p>

			<pre class="programlisting">
<span class="hl-tag">&lt;h:inputText</span> <span class="hl-attribute">id</span>=<span class="hl-value">"searchString"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"#{searchCriteria.searchString}"</span><span class="hl-tag">/&gt;</span>
			</pre>

			<p>Note that you do not need to prefix the variable with its scope
			when referencing it from the template (though you can do so if you need
			to be more specific). As with standard JSF beans, all available scopes
			will be searched for a matching variable, so you could change the scope
			of the variable in your flow definition without having to modify the EL
			expressions that reference it.</p>

			<p>You can also define view instance variables that are scoped to the
			current view and get cleaned up automatically upon transitioning to
			another view. This is quite useful with JSF as views are often
			constructed to handle multiple in-page events across many requests
			before transitioning to another view.</p>

			<p>To define a view instance variable, you can use the
			<code class="code">var</code> element inside a <code class="code">view-state</code>
			definition:</p>

			<pre class="programlisting">
<span class="hl-tag">&lt;view-state</span> <span class="hl-attribute">id</span>=<span class="hl-value">"enterSearchCriteria"</span><span class="hl-tag">&gt;</span>
	<span class="hl-tag">&lt;var</span> <span class="hl-attribute">name</span>=<span class="hl-value">"searchCriteria"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.mycompany.myapp.hotels.search.SearchCriteria"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/view-state&gt;</span>
			</pre>
		</div>

		<div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="spring-faces-spring-beans" href="#spring-faces-spring-beans"></a>13.4.2.&nbsp;Using Scoped Spring Beans</h3></div></div></div>
			

			<p>Though defining autowired flow instance variables provides nice
			modularization and readability, occasions may arise where you want to
			utilize the other capabilities of the Spring container such as AOP. In
			these cases, you can define a bean in your Spring ApplicationContext and
			give it a specific web flow scope:</p>

			<pre class="programlisting">
<span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"searchCriteria"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.mycompany.myapp.hotels.search.SearchCriteria"</span> <span class="hl-attribute">scope</span>=<span class="hl-value">"flow"</span><span class="hl-tag">/&gt;</span>
			</pre>

			<p>The major difference with this approach is that the bean will not
			be fully initialized until it is first accessed via an EL expression.
			This sort of lazy instantiation via EL is quite similar to how JSF
			managed beans are typically allocated.</p>
		</div>

		<div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="faces-manipulating-model" href="#faces-manipulating-model"></a>13.4.3.&nbsp;Manipulating The Model</h3></div></div></div>
			

			<p>The need to initialize the model before view rendering (such as by
			loading persistent entities from a database) is quite common, but JSF by
			itself does not provide any convenient hooks for such initialization.
			The flow definition language provides a natural facility for this
			through its <a class="link" href="defining-flows.html#flow-actions" title="3.6.&nbsp;Actions">Actions</a> . Spring Web
			Flow provides some extra conveniences for converting the outcome of an
			action into a JSF-specific data structure. For example:</p>

			<pre class="programlisting">
<span class="hl-tag">&lt;on-render&gt;</span>
	<span class="hl-tag">&lt;evaluate</span> <span class="hl-attribute">expression</span>=<span class="hl-value">"bookingService.findBookings(currentUser.name)"</span>
				<span class="hl-attribute">result</span>=<span class="hl-value">"viewScope.bookings"</span> <span class="hl-attribute">result-type</span>=<span class="hl-value">"dataModel"</span><span class="hl-tag"> /&gt;</span>
<span class="hl-tag">&lt;/on-render&gt;</span>
			</pre>

			<p>This will take the result of the
			<code class="code">bookingService.findBookings</code> method an wrap it in a custom
			JSF DataModel so that the list can be used in a standard JSF DataTable
			component:</p>

			<pre class="programlisting">
<span class="hl-tag">&lt;h:dataTable</span> <span class="hl-attribute">id</span>=<span class="hl-value">"bookings"</span> <span class="hl-attribute">styleClass</span>=<span class="hl-value">"summary"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"#{bookings}"</span> <span class="hl-attribute">var</span>=<span class="hl-value">"booking"</span>
			<span class="hl-attribute">rendered</span>=<span class="hl-value">"#{bookings.rowCount &gt; 0}"</span><span class="hl-tag">&gt;</span>
	<span class="hl-tag">&lt;h:column&gt;</span>
		<span class="hl-tag">&lt;f:facet</span> <span class="hl-attribute">name</span>=<span class="hl-value">"header"</span><span class="hl-tag">&gt;</span>Name<span class="hl-tag">&lt;/f:facet&gt;</span>
		#{booking.hotel.name}
	<span class="hl-tag">&lt;/h:column&gt;</span>
	<span class="hl-tag">&lt;h:column&gt;</span>
	<span class="hl-tag">&lt;f:facet</span> <span class="hl-attribute">name</span>=<span class="hl-value">"header"</span><span class="hl-tag">&gt;</span>Confirmation number<span class="hl-tag">&lt;/f:facet&gt;</span>
		#{booking.id}
		<span class="hl-tag">&lt;/h:column&gt;</span>
	<span class="hl-tag">&lt;h:column&gt;</span>
		<span class="hl-tag">&lt;f:facet</span> <span class="hl-attribute">name</span>=<span class="hl-value">"header"</span><span class="hl-tag">&gt;</span>Action<span class="hl-tag">&lt;/f:facet&gt;</span>
		<span class="hl-tag">&lt;h:commandLink</span> <span class="hl-attribute">id</span>=<span class="hl-value">"cancel"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Cancel"</span> <span class="hl-attribute">action</span>=<span class="hl-value">"cancelBooking"</span><span class="hl-tag"> /&gt;</span>
	<span class="hl-tag">&lt;/h:column&gt;</span>
<span class="hl-tag">&lt;/h:dataTable&gt;</span>
			</pre>
		</div>

		<div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="faces-data-model-implementations" href="#faces-data-model-implementations"></a>13.4.4.&nbsp;Data Model Implementations</h3></div></div></div>
			

			<p>In the example above result-type="dataModel" results in the
			wrapping of List&lt;Booking&gt; with custom
			<code class="classname">DataModel</code> type. The custom
			<code class="classname">DataModel</code> provides extra conveniences such as
			being serializable for storage beyond request scope as well as access to
			the currently selected row in EL expressions. For example, on postback
			from a view where the action event was fired by a component within a
			DataTable, you can take action on the selected row's model
			instance:</p>

			<pre class="programlisting">
<span class="hl-tag">&lt;transition</span> <span class="hl-attribute">on</span>=<span class="hl-value">"cancelBooking"</span><span class="hl-tag">&gt;</span>
	<span class="hl-tag">&lt;evaluate</span> <span class="hl-attribute">expression</span>=<span class="hl-value">"bookingService.cancelBooking(bookings.selectedRow)"</span><span class="hl-tag"> /&gt;</span>
<span class="hl-tag">&lt;/transition&gt;</span>
			</pre>

			<p>Spring Web Flow provides two custom DataModel types:
			<code class="classname">OneSelectionTrackingListDataModel</code> and
			<code class="classname">ManySelectionTrackingListDataModel</code>. As the names
			indicate they keep track of one or multiple selected rows. This is done
			with the help of a
			<code class="classname">SelectionTrackingActionListener</code> listener, which
			responds to JSF action events and invokes the appopriate methods on the
			<code class="classname">SelectinAware</code> data models to record the currently
			clicked row.</p>

			<p>To understand how this is configured, keep in mind the
			<code class="classname">FacesConversionService</code> registers a
			<code class="classname">DataModelConverter</code> against the alias "dataModel"
			on startup. When result-type="dataModel" is used in a flow definition it
			causes the <code class="classname">DataModelConverter</code> to be used. The
			converter then wraps the given List with an instance of
			<code class="classname">OneSelectionTrackingListDataModel</code>. To use the
			<code class="classname">ManySelectionTrackingListDataModel</code> you will need
			to register your own custom converter.</p>
		</div>
	</div>

	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spring-faces-event-handling" href="#spring-faces-event-handling"></a>13.5.&nbsp;Handling JSF Events With Spring Web Flow</h2></div></div></div>
		

		<p>Spring Web Flow allows you to handle JSF action events in a
		decoupled way, requiring no direct dependencies in your Java code on JSF
		API's. In fact, these events can often be handled completely in the flow
		definiton language without requiring any custom Java action code at all.
		This allows for a more agile development process since the artifacts being
		manipulated in wiring up events (JSF view templates and SWF flow
		definitions) are instantly refreshable without requiring a build and
		re-deploy of the whole application.</p>

		<div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="spring-faces-in-page-events" href="#spring-faces-in-page-events"></a>13.5.1.&nbsp;Handling JSF In-page Action Events</h3></div></div></div>
			

			<p>A simple but common case in JSF is the need to signal an event
			that causes manipulation of the model in some way and then redisplays
			the same view to reflect the changed state of the model. The flow
			definition language has special support for this in the
			<code class="code">transition</code> element.</p>

			<p>A good example of this is a table of paged list results. Suppose
			you want to be able to load and display only a portion of a large result
			list, and allow the user to page through the results. The initial
			<code class="code">view-state</code> definition to load and display the list would
			be:</p>

			<pre class="programlisting">
<span class="hl-tag">&lt;view-state</span> <span class="hl-attribute">id</span>=<span class="hl-value">"reviewHotels"</span><span class="hl-tag">&gt;</span>
	<span class="hl-tag">&lt;on-render&gt;</span>
		<span class="hl-tag">&lt;evaluate</span> <span class="hl-attribute">expression</span>=<span class="hl-value">"bookingService.findHotels(searchCriteria)"</span>
					<span class="hl-attribute">result</span>=<span class="hl-value">"viewScope.hotels"</span> <span class="hl-attribute">result-type</span>=<span class="hl-value">"dataModel"</span><span class="hl-tag"> /&gt;</span>
	<span class="hl-tag">&lt;/on-render&gt;</span>
<span class="hl-tag">&lt;/view-state&gt;</span>
			</pre>

			<p>You construct a JSF DataTable that displays the current
			<code class="code">hotels</code> list, and then place a "More Results" link below the
			table:</p>

			<pre class="programlisting">
<span class="hl-tag">&lt;h:commandLink</span> <span class="hl-attribute">id</span>=<span class="hl-value">"nextPageLink"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"More Results"</span> <span class="hl-attribute">action</span>=<span class="hl-value">"next"</span><span class="hl-tag">/&gt;</span>
			</pre>

			<p>This commandLink signals a "next" event from its action attribute.
			You can then handle the event by adding to the <code class="code">view-state</code>
			definition:</p>

			<pre class="programlisting">
<span class="hl-tag">&lt;view-state</span> <span class="hl-attribute">id</span>=<span class="hl-value">"reviewHotels"</span><span class="hl-tag">&gt;</span>
	<span class="hl-tag">&lt;on-render&gt;</span>
		<span class="hl-tag">&lt;evaluate</span> <span class="hl-attribute">expression</span>=<span class="hl-value">"bookingService.findHotels(searchCriteria)"</span>
			<span class="hl-attribute">result</span>=<span class="hl-value">"viewScope.hotels"</span> <span class="hl-attribute">result-type</span>=<span class="hl-value">"dataModel"</span><span class="hl-tag"> /&gt;</span>
	<span class="hl-tag">&lt;/on-render&gt;</span>
	<span class="hl-tag">&lt;transition</span> <span class="hl-attribute">on</span>=<span class="hl-value">"next"</span><span class="hl-tag">&gt;</span>
		<span class="hl-tag">&lt;evaluate</span> <span class="hl-attribute">expression</span>=<span class="hl-value">"searchCriteria.nextPage()"</span><span class="hl-tag"> /&gt;</span>
	<span class="hl-tag">&lt;/transition&gt;</span>
<span class="hl-tag">&lt;/view-state&gt;</span>
			</pre>

			<p>Here you handle the "next" event by incrementing the page count on
			the searchCriteria instance. The <code class="code">on-render</code> action is then
			called again with the updated criteria, which causes the next page of
			results to be loaded into the DataModel. The same view is re-rendered
			since there was no <code class="code">to</code> attribute on the
			<code class="code">transition</code> element, and the changes in the model are
			reflected in the view.</p>
		</div>

		<div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="spring-faces-action-events" href="#spring-faces-action-events"></a>13.5.2.&nbsp;Handling JSF Action Events</h3></div></div></div>
			

			<p>The next logical level beyond in-page events are events that
			require navigation to another view, with some manipulation of the model
			along the way. Achieving this with pure JSF would require adding a
			navigation rule to faces-config.xml and likely some intermediary Java
			code in a JSF managed bean (both tasks requiring a re-deploy). With the
			flow defintion language, you can handle such a case concisely in one
			place in a quite similar way to how in-page events are handled.</p>

			<p>Continuing on with our use case of manipulating a paged list of
			results, suppose we want each row in the displayed DataTable to contain
			a link to a detail page for that row instance. You can add a column to
			the table containing the following <code class="code">commandLink</code>
			component:</p>

			<pre class="programlisting">
<span class="hl-tag">&lt;h:commandLink</span> <span class="hl-attribute">id</span>=<span class="hl-value">"viewHotelLink"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"View Hotel"</span> <span class="hl-attribute">action</span>=<span class="hl-value">"select"</span><span class="hl-tag">/&gt;</span>
			</pre>

			<p>This raises the "select" event which you can then handle by adding
			another <code class="code">transition</code> element to the existing
			<code class="code">view-state</code> :</p>

			<pre class="programlisting">
<span class="hl-tag">&lt;view-state</span> <span class="hl-attribute">id</span>=<span class="hl-value">"reviewHotels"</span><span class="hl-tag">&gt;</span>
	<span class="hl-tag">&lt;on-render&gt;</span>
		<span class="hl-tag">&lt;evaluate</span> <span class="hl-attribute">expression</span>=<span class="hl-value">"bookingService.findHotels(searchCriteria)"</span>
			<span class="hl-attribute">result</span>=<span class="hl-value">"viewScope.hotels"</span> <span class="hl-attribute">result-type</span>=<span class="hl-value">"dataModel"</span><span class="hl-tag"> /&gt;</span>
	<span class="hl-tag">&lt;/on-render&gt;</span>
	<span class="hl-tag">&lt;transition</span> <span class="hl-attribute">on</span>=<span class="hl-value">"next"</span><span class="hl-tag">&gt;</span>
		<span class="hl-tag">&lt;evaluate</span> <span class="hl-attribute">expression</span>=<span class="hl-value">"searchCriteria.nextPage()"</span><span class="hl-tag"> /&gt;</span>
	<span class="hl-tag">&lt;/transition&gt;</span>
	<span class="hl-tag">&lt;transition</span> <span class="hl-attribute">on</span>=<span class="hl-value">"select"</span> <span class="hl-attribute">to</span>=<span class="hl-value">"reviewHotel"</span><span class="hl-tag">&gt;</span>
			<span class="hl-tag">&lt;set</span> <span class="hl-attribute">name</span>=<span class="hl-value">"flowScope.hotel"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"hotels.selectedRow"</span><span class="hl-tag"> /&gt;</span>
	<span class="hl-tag">&lt;/transition&gt;</span>
<span class="hl-tag">&lt;/view-state&gt;</span>
			</pre>

			<p>Here the "select" event is handled by pushing the currently
			selected hotel instance from the DataTable into flow scope, so that it
			may be referenced by the "reviewHotel" <code class="code">view-state</code> .</p>
		</div>

		<div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="spring-faces-model-validation" href="#spring-faces-model-validation"></a>13.5.3.&nbsp;Performing Model Validation</h3></div></div></div>
			

			<p>JSF provides useful facilities for validating input at field-level
			before changes are applied to the model, but when you need to then
			perform more complex validation at the model-level after the updates
			have been applied, you are generally left with having to add more custom
			code to your JSF action methods in the managed bean. Validation of this
			sort is something that is generally a responsibility of the domain model
			itself, but it is difficult to get any error messages propagated back to
			the view without introducing an undesirable dependency on the JSF API in
			your domain layer.</p>

			<p>With Web Flow, you can utilize the generic and low-level
			<code class="code">MessageContext</code> in your business code and any messages added
			there will then be available to the <code class="code">FacesContext</code> at render
			time.</p>

			<p>For example, suppose you have a view where the user enters the
			necessary details to complete a hotel booking, and you need to ensure
			the Check In and Check Out dates adhere to a given set of business
			rules. You can invoke such model-level validation from a
			<code class="code">transition</code> element:</p>

			<pre class="programlisting">
<span class="hl-tag">&lt;view-state</span> <span class="hl-attribute">id</span>=<span class="hl-value">"enterBookingDetails"</span><span class="hl-tag">&gt;</span>
	<span class="hl-tag">&lt;transition</span> <span class="hl-attribute">on</span>=<span class="hl-value">"proceed"</span> <span class="hl-attribute">to</span>=<span class="hl-value">"reviewBooking"</span><span class="hl-tag">&gt;</span>
		<span class="hl-tag">&lt;evaluate</span> <span class="hl-attribute">expression</span>=<span class="hl-value">"booking.validateEnterBookingDetails(messageContext)"</span><span class="hl-tag"> /&gt;</span>
	<span class="hl-tag">&lt;/transition&gt;</span>
<span class="hl-tag">&lt;/view-state&gt;</span>
			</pre>

			<p>Here the "proceed" event is handled by invoking a model-level
			validation method on the booking instance, passing the generic
			<code class="code">MessageContext</code> instance so that messages may be recorded.
			The messages can then be displayed along with any other JSF messages
			with the <code class="code">h:messages</code> component,</p>

			<p></p>
		</div>

		<div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="spring-faces-ajax-events-jsf2" href="#spring-faces-ajax-events-jsf2"></a>13.5.4.&nbsp;Handling Ajax Events In JSF</h3></div></div></div>
			

			<p>JSF provides built-in support for sending Ajax requests and
			performing partial processing and rendering on the server-side. You can
			specify a list of id's for partial rendering through the &lt;f:ajax&gt;
			facelets tag.</p>

			<p>In Spring Web Flow you also have the option to specify the ids to
			use for partial rendering on the server side with the render
			action:</p>

			<pre class="programlisting">
<span class="hl-tag">&lt;view-state</span> <span class="hl-attribute">id</span>=<span class="hl-value">"reviewHotels"</span><span class="hl-tag">&gt;</span>
	<span class="hl-tag">&lt;on-render&gt;</span>
		<span class="hl-tag">&lt;evaluate</span> <span class="hl-attribute">expression</span>=<span class="hl-value">"bookingService.findHotels(searchCriteria)"</span>
					<span class="hl-attribute">result</span>=<span class="hl-value">"viewScope.hotels"</span> <span class="hl-attribute">result-type</span>=<span class="hl-value">"dataModel"</span><span class="hl-tag"> /&gt;</span>
	<span class="hl-tag">&lt;/on-render&gt;</span>
	<span class="hl-tag">&lt;transition</span> <span class="hl-attribute">on</span>=<span class="hl-value">"next"</span><span class="hl-tag">&gt;</span>
		<span class="hl-tag">&lt;evaluate</span> <span class="hl-attribute">expression</span>=<span class="hl-value">"searchCriteria.nextPage()"</span><span class="hl-tag"> /&gt;</span>
		<span class="hl-tag">&lt;render</span> <span class="hl-attribute">fragments</span>=<span class="hl-value">"hotels:searchResultsFragment"</span><span class="hl-tag"> /&gt;</span>
	<span class="hl-tag">&lt;/transition&gt;</span>
<span class="hl-tag">&lt;/view-state&gt;</span>
			</pre>
		</div>
	</div>

	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spring-faces-embedded-mode" href="#spring-faces-embedded-mode"></a>13.6.&nbsp;Embedding a Flow On a Page</h2></div></div></div>
		

		<p>By default when a flow enters a view state, it executes a
		client-side redirect before rendering the view. This approach is known as
		POST-REDIRECT-GET. It has the advantage of separating the form processing
		for one view from the rendering of the next view. As a result the browser
		Back and Refresh buttons work seamlessly without causing any browser
		warnings.</p>

		<p>Normally the client-side redirect is transparent from a user's
		perspective. However, there are situations where POST-REDIRECT-GET may not
		bring the same benefits. For example sometimes it may be useful to embed
		a flow on a page and drive it via Ajax requests refreshing only the area
		of the page where the flow is rendered. Not only is it unnecessary to use
		client-side redirects in this case, it is also not the desired behavior
		with regards to keeping the surrounding content of the page intact.</p>

		<p>To indicate a flow should execute in "page embedded" mode all
		you need to do is pass an extra flow input attribute called "mode"
		with a value of "embedded". Below is an example of a top-level
		container flow invoking a sub-flow in an embedded mode:</p>

		<pre class="programlisting">
<span class="hl-tag">&lt;subflow-state</span> <span class="hl-attribute">id</span>=<span class="hl-value">"bookHotel"</span> <span class="hl-attribute">subflow</span>=<span class="hl-value">"booking"</span><span class="hl-tag">&gt;</span>
	<span class="hl-tag">&lt;input</span> <span class="hl-attribute">name</span>=<span class="hl-value">"mode"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"'embedded'"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/subflow-state&gt;</span>
		</pre>

		<p>When launched in "page embedded" mode the sub-flow will not issue
		flow execution redirects during Ajax requests.</p>

		<p>If you'd like to see examples of an embedded flow please refer to
		the webflow-primefaces-showcase project. You can check out
		the source code locally, build it as you would a Maven project, and import
		it into Eclipse:</p>

		<pre class="programlisting">cd some-directory
svn co https://src.springframework.org/svn/spring-samples/webflow-primefaces-showcase
cd webflow-primefaces-showcase
mvn package
# import into Eclipse</pre>

		<p>The specific example you need to look at is under the "Advanced Ajax"
			tab and is called "Top Flow with Embedded Sub-Flow".</p>

	</div>

	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spring-faces-redirect-in-same-state" href="#spring-faces-redirect-in-same-state"></a>13.7.&nbsp;Redirect In Same State</h2></div></div></div>
		

		<p>
			By default Web Flow does a client-side redirect even it it remains in the same view state as long as the current request is not an Ajax request.
			This is quite useful after form validation failures for example.
			If the user hits Refresh or Back they won't see any browser warnings.
			They would if the Web Flow didn't do a redirect.
		</p>
		<p>
			This can lead to a problem specific to JSF environments where a specific Sun Mojarra listener component caches the FacesContext assuming the same instance is available throughout the JSF lifecycle.
			In Web Flow however the render phase is temporarily put on hold and a client-side redirect executed.
		</p>
		<p>
			The default behavior of Web Flow is desirable and it is unlikely JSF applications will experience the issue.
			This is because Ajax is often enabled the default in JSF component libraries and Web Flow does not redirect during Ajax requests.
			However if you experience this issue you can disable client-side redirects within the same view as follows:
			</p><pre class="programlisting">
<span class="hl-tag">&lt;webflow:flow-executor</span> <span class="hl-attribute">id</span>=<span class="hl-value">"flowExecutor"</span><span class="hl-tag">&gt;</span>
	<span class="hl-tag">&lt;webflow:flow-execution-attributes&gt;</span>
		<span class="hl-tag">&lt;webflow:redirect-in-same-state</span> <span class="hl-attribute">value</span>=<span class="hl-value">"false"</span><span class="hl-tag">/&gt;</span>
	<span class="hl-tag">&lt;/webflow:flow-execution-attributes&gt;</span>
<span class="hl-tag">&lt;/webflow:flow-executor&gt;</span>
			</pre><p>
		</p>
	</div>

	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spring-faces-file-upload" href="#spring-faces-file-upload"></a>13.8.&nbsp;Handling File Uploads with JSF</h2></div></div></div>
		

		<p>Most JSF component providers include some form of 'file upload' component. Generally when working
		with these components JSF must take complete control of parsing multi-part requests and Spring MVC's
		<code class="code">MultipartResolver</code> cannot be used.</p>

		<p>Spring Web Flow has been tested with file upload components from PrimeFaces. Check the
		documentation of your JSF component library for other providers to see how to configure file upload.</p>

		<div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d5e1950" href="#d5e1950"></a>13.8.1.&nbsp;File Uploads with PrimeFaces</h3></div></div></div>
			
			<p>PrimeFaces provides a <code class="code">&lt;p:fileUpload&gt;</code> component for uploading files. In order
			to use the component you need to configure the <code class="code">org.primefaces.webapp.filter.FileUploadFilter</code>
			servlet filter. The filter needs to be configured against Spring MVC's
			<code class="code">DispatcherServlet</code> in your <code class="code">web.xml</code>:</p>
			<pre class="programlisting"><span class="hl-tag">&lt;filter&gt;</span>
	<span class="hl-tag">&lt;filter-name&gt;</span>PrimeFaces FileUpload Filter<span class="hl-tag">&lt;/filter-name&gt;</span>
	<span class="hl-tag">&lt;filter-class&gt;</span>org.primefaces.webapp.filter.FileUploadFilter<span class="hl-tag">&lt;/filter-class&gt;</span>
<span class="hl-tag">&lt;/filter&gt;</span>
<span class="hl-tag">&lt;filter-mapping&gt;</span>
	<span class="hl-tag">&lt;filter-name&gt;</span>PrimeFaces FileUpload Filter<span class="hl-tag">&lt;/filter-name&gt;</span>
	<span class="hl-tag">&lt;servlet-name&gt;</span>Spring MVC Dispatcher Servlet<span class="hl-tag">&lt;/servlet-name&gt;</span>
<span class="hl-tag">&lt;/filter-mapping&gt;</span>

<span class="hl-tag">&lt;context-param&gt;</span>
	<span class="hl-tag">&lt;param-name&gt;</span>primefaces.UPLOADER<span class="hl-tag">&lt;/param-name&gt;</span>
	<span class="hl-tag">&lt;param-value&gt;</span>commons<span class="hl-tag">&lt;/param-value&gt;</span>
<span class="hl-tag">&lt;/context-param&gt;</span>
			</pre>
			<p>For more details refer to the
			<a class="ulink" href="http://primefaces.org/documentation.html" target="_top">PrimeFaces documentation</a>.</p>
		</div>
	</div>

	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spring-faces-security-taglib" href="#spring-faces-security-taglib"></a>13.9.&nbsp;Using the Spring Security Facelets Tag Library</h2></div></div></div>
		

		<p>To use the library you'll need to create a <code class="code">.taglib.xml</code>
		file and register it in <code class="code">web.xml</code>.</p>

		<p>Create the file
		<code class="code">/WEB-INF/springsecurity.taglib.xml</code> with the following
		content:</p>

		<pre class="programlisting">
<span class="hl-directive" style="color: maroon">&lt;?xml version="1.0"?&gt;</span>
<strong class="hl-tag" style="color: blue">&lt;!DOCTYPE facelet-taglib PUBLIC
"-//Sun Microsystems, Inc.//DTD Facelet Taglib 1.0//EN"
"http://java.sun.com/dtd/facelet-taglib_1_0.dtd"&gt;</strong>
<span class="hl-tag">&lt;facelet-taglib&gt;</span>
	<span class="hl-tag">&lt;namespace&gt;</span>http://www.springframework.org/security/tags<span class="hl-tag">&lt;/namespace&gt;</span>
	<span class="hl-tag">&lt;tag&gt;</span>
		<span class="hl-tag">&lt;tag-name&gt;</span>authorize<span class="hl-tag">&lt;/tag-name&gt;</span>
		<span class="hl-tag">&lt;handler-class&gt;</span>org.springframework.faces.security.FaceletsAuthorizeTagHandler<span class="hl-tag">&lt;/handler-class&gt;</span>
	<span class="hl-tag">&lt;/tag&gt;</span>
	<span class="hl-tag">&lt;function&gt;</span>
		<span class="hl-tag">&lt;function-name&gt;</span>areAllGranted<span class="hl-tag">&lt;/function-name&gt;</span>
		<span class="hl-tag">&lt;function-class&gt;</span>org.springframework.faces.security.FaceletsAuthorizeTagUtils<span class="hl-tag">&lt;/function-class&gt;</span>
		<span class="hl-tag">&lt;function-signature&gt;</span>boolean areAllGranted(java.lang.String)<span class="hl-tag">&lt;/function-signature&gt;</span>
	<span class="hl-tag">&lt;/function&gt;</span>
	<span class="hl-tag">&lt;function&gt;</span>
		<span class="hl-tag">&lt;function-name&gt;</span>areAnyGranted<span class="hl-tag">&lt;/function-name&gt;</span>
		<span class="hl-tag">&lt;function-class&gt;</span>org.springframework.faces.security.FaceletsAuthorizeTagUtils<span class="hl-tag">&lt;/function-class&gt;</span>
		<span class="hl-tag">&lt;function-signature&gt;</span>boolean areAnyGranted(java.lang.String)<span class="hl-tag">&lt;/function-signature&gt;</span>
	<span class="hl-tag">&lt;/function&gt;</span>
	<span class="hl-tag">&lt;function&gt;</span>
		<span class="hl-tag">&lt;function-name&gt;</span>areNotGranted<span class="hl-tag">&lt;/function-name&gt;</span>
		<span class="hl-tag">&lt;function-class&gt;</span>org.springframework.faces.security.FaceletsAuthorizeTagUtils<span class="hl-tag">&lt;/function-class&gt;</span>
		<span class="hl-tag">&lt;function-signature&gt;</span>boolean areNotGranted(java.lang.String)<span class="hl-tag">&lt;/function-signature&gt;</span>
	<span class="hl-tag">&lt;/function&gt;</span>
	<span class="hl-tag">&lt;function&gt;</span>
		<span class="hl-tag">&lt;function-name&gt;</span>isAllowed<span class="hl-tag">&lt;/function-name&gt;</span>
		<span class="hl-tag">&lt;function-class&gt;</span>org.springframework.faces.security.FaceletsAuthorizeTagUtils<span class="hl-tag">&lt;/function-class&gt;</span>
		<span class="hl-tag">&lt;function-signature&gt;</span>boolean isAllowed(java.lang.String, java.lang.String)<span class="hl-tag">&lt;/function-signature&gt;</span>
	<span class="hl-tag">&lt;/function&gt;</span>
<span class="hl-tag">&lt;/facelet-taglib&gt;</span>
		</pre>

		<p>Next, register the above file taglib in web.xml:</p>

		<pre class="programlisting"><span class="hl-tag">&lt;context-param&gt;</span>
	<span class="hl-tag">&lt;param-name&gt;</span>javax.faces.FACELETS_LIBRARIES<span class="hl-tag">&lt;/param-name&gt;</span>
	<span class="hl-tag">&lt;param-value&gt;</span>/WEB-INF/springsecurity.taglib.xml<span class="hl-tag">&lt;/param-value&gt;</span>
<span class="hl-tag">&lt;/context-param&gt;</span>
		</pre>

		<p>Now you are ready to use the tag library in your views. You can use
		the authorize tag to include nested content conditionally:</p>

		<pre class="programlisting"><strong class="hl-tag" style="color: blue">&lt;!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</strong>
<span class="hl-tag">&lt;ui:composition</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.w3.org/1999/xhtml"</span>
	<span class="hl-attribute">xmlns:ui</span>=<span class="hl-value">"http://java.sun.com/jsf/facelets"</span>
	<span class="hl-attribute">xmlns:h</span>=<span class="hl-value">"http://java.sun.com/jsf/html"</span>
	<span class="hl-attribute">xmlns:sec</span>=<span class="hl-value">"http://www.springframework.org/security/tags"</span><span class="hl-tag">&gt;</span>

	<span class="hl-tag">&lt;sec:authorize</span> <span class="hl-attribute">ifAllGranted</span>=<span class="hl-value">"ROLE_FOO, ROLE_BAR"</span><span class="hl-tag">&gt;</span>
		Lorem ipsum dolor sit amet
	<span class="hl-tag">&lt;/sec:authorize&gt;</span>

	<span class="hl-tag">&lt;sec:authorize</span> <span class="hl-attribute">ifNotGranted</span>=<span class="hl-value">"ROLE_FOO, ROLE_BAR"</span><span class="hl-tag">&gt;</span>
		Lorem ipsum dolor sit amet
	<span class="hl-tag">&lt;/sec:authorize&gt;</span>

	<span class="hl-tag">&lt;sec:authorize</span> <span class="hl-attribute">ifAnyGranted</span>=<span class="hl-value">"ROLE_FOO, ROLE_BAR"</span><span class="hl-tag">&gt;</span>
		Lorem ipsum dolor sit amet
	<span class="hl-tag">&lt;/sec:authorize&gt;</span>

<span class="hl-tag">&lt;/ui:composition&gt;</span>
		</pre>

		<p>You can also use one of several EL functions in the rendered or
		other attribute of any JSF component:</p>

		<pre class="programlisting"><strong class="hl-tag" style="color: blue">&lt;!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</strong>
<span class="hl-tag">&lt;ui:composition</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.w3.org/1999/xhtml"</span>
	<span class="hl-attribute">xmlns:ui</span>=<span class="hl-value">"http://java.sun.com/jsf/facelets"</span>
	<span class="hl-attribute">xmlns:h</span>=<span class="hl-value">"http://java.sun.com/jsf/html"</span>
	<span class="hl-attribute">xmlns:sec</span>=<span class="hl-value">"http://www.springframework.org/security/tags"</span><span class="hl-tag">&gt;</span>

	<span class="hl-comment">&lt;!-- Rendered only if user has all of the listed roles --&gt;</span>
	<span class="hl-tag">&lt;h:outputText</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Lorem ipsum dolor sit amet"</span> <span class="hl-attribute">rendered</span>=<span class="hl-value">"#{sec:areAllGranted('ROLE_FOO, ROLE_BAR')}"</span><span class="hl-tag">/&gt;</span>

	<span class="hl-comment">&lt;!-- Rendered only if user does not have any of the listed roles --&gt;</span>
	<span class="hl-tag">&lt;h:outputText</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Lorem ipsum dolor sit amet"</span> <span class="hl-attribute">rendered</span>=<span class="hl-value">"#{sec:areNotGranted('ROLE_FOO, ROLE_BAR')}"</span><span class="hl-tag">/&gt;</span>

	<span class="hl-comment">&lt;!-- Rendered only if user has any of the listed roles --&gt;</span>
	<span class="hl-tag">&lt;h:outputText</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Lorem ipsum dolor sit amet"</span> <span class="hl-attribute">rendered</span>=<span class="hl-value">"#{sec:areAnyGranted('ROLE_FOO, ROLE_BAR')}"</span><span class="hl-tag">/&gt;</span>

	<span class="hl-comment">&lt;!-- Rendered only if user has access to given HTTP method/URL as defined in Spring Security configuration --&gt;</span>
	<span class="hl-tag">&lt;h:outputText</span> <span class="hl-attribute">value</span>=<span class="hl-value">"Lorem ipsum dolor sit amet"</span> <span class="hl-attribute">rendered</span>=<span class="hl-value">"#{sec:isAllowed('/secured/foo', 'POST')}"</span><span class="hl-tag">/&gt;</span>

<span class="hl-tag">&lt;/ui:composition&gt;</span>
		</pre>
	</div>

	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="spring-faces-component-libraries" href="#spring-faces-component-libraries"></a>13.10.&nbsp;Third-Party Component Library Integration</h2></div></div></div>
		

		<p>The Spring Web Flow JSF integration strives to be compatible with
		any third-party JSF component library. By honoring all of the standard
		semantics of the JSF specification within the SWF-driven JSF lifecycle,
		third-party libraries in general should "just work". The main thing to
		remember is that configuration in web.xml will change slightly since Web
		Flow requests are not routed through the standard FacesServlet. Typically,
		anything that is traditionally mapped to the FacesServlet should be mapped
		to the Spring DispatcherServlet instead. (You can also map to both if for
		example you are migrating a legacy JSF application page-by-page.).</p>
	</div>
</div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="spring-js.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="testing.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">12.&nbsp;Spring JavaScript Quick Reference&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;14.&nbsp;Testing flows</td></tr></table></div></body></html>