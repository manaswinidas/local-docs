<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>9.&nbsp;Flow Inheritance</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Spring Web Flow Reference Guide"><link rel="up" href="index.html" title="Spring Web Flow Reference Guide"><link rel="prev" href="flow-security.html" title="8.&nbsp;Securing Flows"><link rel="next" href="system-setup.html" title="10.&nbsp;System Setup"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">9.&nbsp;Flow Inheritance</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="flow-security.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="system-setup.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="flow-inheritance" href="#flow-inheritance"></a>9.&nbsp;Flow Inheritance</h1></div></div></div>
	
	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="flow-inheritance-introduction" href="#flow-inheritance-introduction"></a>9.1.&nbsp;Introduction</h2></div></div></div>
		
		<p>
			Flow inheritance allows one flow to inherit the configuration of another flow.
			Inheritance can occur at both the flow and state levels.
			A common use case is for a parent flow to define global transitions and exception handlers, then each child flow can inherit those settings.
		</p>
		<p>
			In order for a parent flow to be found, it must be added to the <code class="code">flow-registry</code> just like any other flow.
		</p>
	</div>
	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="flow-inheritance-java-comparison" href="#flow-inheritance-java-comparison"></a>9.2.&nbsp;Is flow inheritance like Java inheritance?</h2></div></div></div>
		
		<p>
			Flow inheritance is similar to Java inheritance in that elements defined in a parent are exposed via the child, however, there are key differences.
		</p>
		<p>
			A child flow cannot override an element from a parent flow.
			Similar elements between the parent and child flows will be merged.
			Unique elements in the parent flow will be added to the child.
		</p>
		<p>
			A child flow can inherit from multiple parent flows.
			Java inheritance is limited to a single class.
		</p>
	</div>
	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="flow-inheritance-levels" href="#flow-inheritance-levels"></a>9.3.&nbsp;Types of Flow Inheritance</h2></div></div></div>
		
		<div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="flow-inheritance-level-flow" href="#flow-inheritance-level-flow"></a>9.3.1.&nbsp;Flow level inheritance</h3></div></div></div>
			
			<p>
				Flow level inheritance is defined by the <code class="code">parent</code> attribute on the <code class="code">flow</code> element.
				The attribute contains a comma separated list of flow identifiers to inherit from.
				The child flow will inherit from each parent in the order it is listed adding elements and content to the resulting flow.
				The resulting flow from the first merge will be considered the child in the second merge, and so on.
			</p>
			<pre class="programlisting">
<span class="hl-tag">&lt;flow</span> <span class="hl-attribute">parent</span>=<span class="hl-value">"common-transitions, common-states"</span><span class="hl-tag">&gt;</span>
			</pre>
		</div>
		<div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="flow-inheritance-level-state" href="#flow-inheritance-level-state"></a>9.3.2.&nbsp;State level inheritance</h3></div></div></div>
			
			<p>
				State level inheritance is similar to flow level inheritance, except only one state inherits from the parent, instead of the entire flow.
			</p>
			<p>
				Unlike flow inheritance, only a single parent is allowed.
				Additionally, the identifier of the flow state to inherit from must also be defined.
				The identifiers for the flow and the state within that flow are separated by a #.
			</p>
			<p>
				The parent and child states must be of the same type.
				For instance a view-state cannot inherit from an end-state, only another view-state.
			</p>
			<pre class="programlisting">
<span class="hl-tag">&lt;view-state</span> <span class="hl-attribute">id</span>=<span class="hl-value">"child-state"</span> <span class="hl-attribute">parent</span>=<span class="hl-value">"parent-flow#parent-view-state"</span><span class="hl-tag">&gt;</span>
			</pre>
			<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
				<p>
					The intent for flow-level inheritance is to define common states to be
					added to and shared among multiple flow definitions while the intent
					for state-level inheritance is to extend from and merge with a single
					parent state. Flow-level inheritance is a good fit for composition
					and multiple inheritance but at the state level you can still only
					inherit from a single parent state.
				</p>
			</td></tr></table></div>
		</div>
	</div>
	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="flow-inheritance-abstract" href="#flow-inheritance-abstract"></a>9.4.&nbsp;Abstract flows</h2></div></div></div>
		
		<p>
			Often parent flows are not designed to be executed directly.
			In order to protect these flows from running, they can be marked as <code class="code">abstract</code>.
			If an abstract flow attempts to run, a <code class="code">FlowBuilderException</code> will be thrown.
		</p>
		<pre class="programlisting">
<span class="hl-tag">&lt;flow</span> <span class="hl-attribute">abstract</span>=<span class="hl-value">"true"</span><span class="hl-tag">&gt;</span>
		</pre>
	</div>
	<div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="flow-inheritance-algorithm" href="#flow-inheritance-algorithm"></a>9.5.&nbsp;Inheritance Algorithm</h2></div></div></div>
		
		<p>
			When a child flow inherits from it's parent, essentially what happens is that the parent and child are merged together to create a new flow.
			There are rules for every element in the Web Flow definition language that govern how that particular element is merged.
		</p>
		<p>
			There are two types of elements: <span class="emphasis"><em>mergeable</em></span> and <span class="emphasis"><em>non-mergeable</em></span>.
			Mergeable elements will always attempt to merge together if the elements are similar.
			Non-mergeable elements in a parent or child flow will always be contained in the resulting flow intact.
			They will not be modified as part of the merge process.
		</p>
		<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
			<p>
				Paths to external resources in the parent flow should be absolute.
				Relative paths will break when the two flows are merged unless the parent and child flow are in the same directory.
				Once merged, all relative paths in the parent flow will become relative to the child flow.
			</p>
		</td></tr></table></div>
		<div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="flow-inheritance-algorithm-mergeable" href="#flow-inheritance-algorithm-mergeable"></a>9.5.1.&nbsp;Mergeable Elements</h3></div></div></div>
			
			<p>
				If the elements are of the same type and their keyed attribute are identical, the content of the parent element will be merged with the child element.
				The merge algorithm will continue to merge each sub-element of the merging parent and child.
				Otherwise the parent element is added as a new element to the child.
			</p>
			<p>
				In most cases, elements from a parent flow that are added will be added after elements in the child flow.
				Exceptions to this rule include action elements (evaluate, render and set) which will be added at the beginning.
				This allows for the results of parent actions to be used by child actions.
			</p>
			<p>
				Mergeable elements are:
				</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
						<p>action-state: id</p>
					</li><li class="listitem">
						<p>attribute: name</p>
					</li><li class="listitem">
						<p>decision-state: id</p>
					</li><li class="listitem">
						<p>end-state: id</p>
					</li><li class="listitem">
						<p>flow: always merges</p>
					</li><li class="listitem">
						<p>if: test</p>
					</li><li class="listitem">
						<p>on-end: always merges</p>
					</li><li class="listitem">
						<p>on-entry: always merges</p>
					</li><li class="listitem">
						<p>on-exit: always merges</p>
					</li><li class="listitem">
						<p>on-render: always merges</p>
					</li><li class="listitem">
						<p>on-start: always merges</p>
					</li><li class="listitem">
						<p>input: name</p>
					</li><li class="listitem">
						<p>output: name</p>
					</li><li class="listitem">
						<p>secured: attributes</p>
					</li><li class="listitem">
						<p>subflow-state: id</p>
					</li><li class="listitem">
						<p>transition: on and on-exception</p>
					</li><li class="listitem">
						<p>view-state: id</p>
					</li></ul></div><p>
			</p>
		</div>
		<div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="flow-inheritance-nonmergeable" href="#flow-inheritance-nonmergeable"></a>9.5.2.&nbsp;Non-mergeable Elements</h3></div></div></div>
			
			<p>
				Non-mergeable elements are:
				</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
						<p>bean-import</p>
					</li><li class="listitem">
						<p>evaluate</p>
					</li><li class="listitem">
						<p>exception-handler</p>
					</li><li class="listitem">
						<p>persistence-context</p>
					</li><li class="listitem">
						<p>render</p>
					</li><li class="listitem">
						<p>set</p>
					</li><li class="listitem">
						<p>var</p>
					</li></ul></div><p>
			</p>
		</div>
	</div>
</div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="flow-security.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="system-setup.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">8.&nbsp;Securing Flows&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;10.&nbsp;System Setup</td></tr></table></div></body></html>