<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>3.&nbsp;Yammer API Binding</title><link rel="stylesheet" href="css/manual-multipage.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="Spring Social Yammer Reference Manual"><link rel="up" href="index.html" title="Spring Social Yammer Reference Manual"><link rel="prev" href="connecting.html" title="2.&nbsp;Configuring Yammer Connectivity"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">3.&nbsp;Yammer API Binding</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="connecting.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;</td></tr></table><hr></div><div class="chapter" title="3.&nbsp;Yammer API Binding"><div class="titlepage"><div><div><h2 class="title"><a name="apis"></a>3.&nbsp;Yammer API Binding</h2></div></div></div>
	

	<p>
		Spring Social Yammer offers integration with Yammer's REST API with the <code class="interfacename">Yammer</code> interface and its implementation, <code class="classname">YammerTemplate</code>.
	</p>

    <p>
        Spring Social Yammer's <code class="interfacename">Yammer</code> interface and its implementation, <code class="classname">YammerTemplate</code> provide the operations needed to interact with Yammer on behalf of a user.
        Creating an instance of <code class="classname">YammerTemplate</code> is as simple as constructing it by passing in an authorized access token to the constructor:
    </p>

    <pre class="programlisting">
String accessToken = <span class="hl-string">"f8FX29g..."</span>; <span class="hl-comment">// access token received from Yammer after OAuth authorization</span>
Yammer yammer = <span class="hl-keyword">new</span> YammerTemplate(accessToken);
    </pre>
	
	<p>
		If you are using Spring Social's <a class="ulink" href="http://static.springsource.org/spring-social/docs/1.0.x/reference/html/serviceprovider.html" target="_top">service provider framework</a>, you can get an instance of <code class="interfacename">Yammer</code> from a <code class="interfacename">Connection</code>. 
		For example, the following snippet calls <code class="methodname">getApi()</code> on a connection to retrieve a <code class="interfacename">Yammer</code>:
	</p>				
	
	<pre class="programlisting">
Connection&lt;Yammer&gt; connection = connectionRepository.findPrimaryConnection(Yammer.<span class="hl-keyword">class</span>);
<span class="hl-keyword">if</span> (connection != null) {
    Yammer yammer = connection.getApi();

    <span class="hl-comment">// ... use Yammer API binding</span>
}
	</pre>
	
	<p>
		Here, <code class="interfacename">ConnectionRepository</code> is being asked for the primary connection that the current user has with Yammer.
		If a connection to Yammer is found, it retrieves a <code class="interfacename">Yammer</code> instance that is configured with the connection details received when the connection was first established.
	</p>
	
	<p>
		Once you have a <code class="interfacename">Yammer</code> you can use it to interact with Yammer on behalf of the user who the access token was granted for.
	</p>

	
	
		<p>
		With a <code class="interfacename">Yammer</code> in hand, there are several ways you can use it to interact with Yammer on behalf of the user.
		Spring Social's Yammer API binding is divided into 7 sub-APIs exposed through the methods of <code class="interfacename">Yammer</code>:
	</p>

	<pre class="programlisting">
<span class="hl-keyword">public</span> <span class="hl-keyword">interface</span> Yammer {

	ThreadOperations threadOperations();

	SubscriptionOperations subscriptionOperations();

	TopicOperations topicOperations();

	SearchOperations searchOperations();

	GroupOperations groupOperations();

	MessageOperations messageOperations();

	UserOperations userOperations();

}
	</pre>

	<p>
		The sub-API interfaces returned from <code class="interfacename">Yammer</code>'s methods are described in <a class="xref" href="apis.html#table-yammer-sub-apis" title="Table&nbsp;3.1.&nbsp;Yammer's Sub-APIs">Table&nbsp;3.1, &#8220;Yammer's Sub-APIs&#8221;</a>.
	</p>

	<div class="table"><a name="table-yammer-sub-apis"></a><p class="title"><b>Table&nbsp;3.1.&nbsp;Yammer's Sub-APIs</b></p><div class="table-contents">
		
		<table summary="Yammer's Sub-APIs" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left"><col></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center">Sub-API Interface</th><th style="border-bottom: 0.5pt solid ; " align="center">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left">ThreadOperations</td><td style="border-bottom: 0.5pt solid ; ">Get information about Yammer threads</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left">SubscriptionOperations</td><td style="border-bottom: 0.5pt solid ; ">Follow, unfollow and check whether you are following topics (tags), users or threads</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left">TopicOperations</td><td style="border-bottom: 0.5pt solid ; ">Get information about a single Topic (tag)</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left">SearchOperations</td><td style="border-bottom: 0.5pt solid ; ">Search for messages, users, tags and groups in your Yammer network</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left">GroupOperations</td><td style="border-bottom: 0.5pt solid ; ">List, get, create, join and leave groups</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left">MessageOperations</td><td style="border-bottom: 0.5pt solid ; ">Get, post and delete messages</td></tr><tr><td style="border-right: 0.5pt solid ; " align="left">UserOperations</td><td style="">List users, get, and update user.</td></tr></tbody></table>
	</div></div><br class="table-break">

	<p>
		The following sections will give an overview of common tasks that can be performed via <code class="interfacename">Yammer</code> and its sub-APIs.
		For complete details on all of the operations available, refer to the JavaDoc.
	</p>
	
	
	<div class="section" title="3.1&nbsp;Retrieving a user's Yammer profile data"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="yammer-getProfile"></a>3.1&nbsp;Retrieving a user's Yammer profile data</h2></div></div></div>
		
		
		<p>
			To retrieve the authenticated user's profile data, call the <code class="methodname">getUserProfile()</code> method method provided by the <code class="interfacename">UserOperations</code>::
		</p>
		
		<pre class="programlisting">
YammerProfile profile = yammer.userOperations().getUserProfile();
		</pre>
		
		<p>
			The data returned in the <code class="classname">YammerProfile</code> includes the user's Yammer ID, first and last names, contact information, education and work experience as well as stats such as number of posts, followers and number of people the user is following
		</p>
	</div>
	
	<div class="section" title="3.2&nbsp;Listing Yammer users in a network"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="yammer-getUsers"></a>3.2&nbsp;Listing Yammer users in a network</h2></div></div></div>
		
		
		<p>
			To retrieve a list of users (members) of a Yammer network, call the <code class="methodname">getUsers()</code> method provided by the <code class="interfacename">UserOperations</code>:
		</p>
		
		<pre class="programlisting">
YammerProfile profile = yammer.userOperations().getUsers(<span class="hl-number">1</span>);
		</pre>
		
		<p>
			The single parameter is the page number. User lists are retrieved per page, with Yammer returning a maximum of 50 users per page. 
			The method returns a <code class="interfacename">List</code> of <code class="classname">YammerProfile</code>s.
		</p>

		<p>
			You may also the overloaded <code class="methodname">getUsers()</code> method that in addition to the page number lets you specify the sorting key (followers or messages), 
			wether you want results in reversed order (true or false, false is default) and the letter you want the users to start with:
		</p>
		
		<pre class="programlisting">
YammerProfile profile = yammer.userOperations().getUsers(<span class="hl-number">1</span>, UserOperations.SORT_BY_MESSAGES, false, <span class="hl-string">'A'</span>)
		</pre>
	</div>

	<div class="section" title="3.3&nbsp;Get messages posted to your network"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="yammer-getMessages"></a>3.3&nbsp;Get messages posted to your network</h2></div></div></div>
		
		
		<p>
			To get messages posted to your network call the <code class="methodname">getMessages()</code> method method provided by the <code class="interfacename">MessageOperations</code>:
		</p>
		
		<pre class="programlisting">
YammerProfile profile = yammer.messageOperations().getMessages(<span class="hl-number">0</span>, <span class="hl-number">0</span>, MessageOperations.NO_THREADING, <span class="hl-number">0</span>);
		</pre>
		
		<p>
			The parameters to the <code class="methodname">getMessages()</code> are: 
			older than id (returns only messages older than the message ID specified, 0 if you want the latest), newer than id, threading option (NO_THREADING, THREADED or THREADED_EXTENDED), 
			limit (the number of posts per poll, 0 for defaulting to yammer default of 50)
			The data returned is <code class="classname">MessageInfo</code> which contains meta data about the poll and a <code class="interfacename">List</code> of <code class="classname">YammerMessage</code>
		</p>
		
		<p>
			Additional operations to get messages exists in <code class="interfacename">MessageOperations</code>, they all take the same parameters as <code class="methodname">getMessages()</code>. 
			<code class="methodname">getMessagesFollowing()</code> to get messages from people you are following. 
			<code class="methodname">getMessagesFromUser()</code> to get messages posted by a specified user. 
			<code class="methodname">getMessagesPrivate()</code> to private messages. 
			<code class="methodname">getMessagesReceived()</code> to get messages received. 
			<code class="methodname">getMessagesLikedByUser()</code> to get messages liked by a specified user. 
			<code class="methodname">getMessagesAboutTopic()</code> to get messages on a specified topic (topic id). 
		</p>
	</div>
	<div class="section" title="3.4&nbsp;Post an update to your network"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="yammer-postUpdate"></a>3.4&nbsp;Post an update to your network</h2></div></div></div>
		
		
		<p>
			To post an update to your followers, call the <code class="methodname">postUpdate()</code> method method provided by the <code class="interfacename">MessageOperations</code>:
		</p>
		
		<pre class="programlisting">
YammerProfile profile = yammer.messageOperations().postUpdate(<span class="hl-string">"Hello all Yammerites!"</span>);
		</pre>
		
		<p>
			The data returned is <code class="classname">MessageInfo</code> which is the same type of object returned when you fetch messages. This allows you to immediately display the newly-posted message without doing a poll.
		</p>
		
		<p>
			Optionally, you may provide additional information to your update such as attachments. You may also include a group id if you are posting to a group or a replied to id if you are replying to an existing post.
			This is done by calling the overloaded <code class="methodname">postUpdate()</code> method method provided by the <code class="interfacename">MessageOperations</code>:
		</p>
		
		<pre class="programlisting">
		Resource resource = <span class="hl-keyword">new</span> FileSystemResource(<span class="hl-string">"file:///test.txt"</span>);
		YammerPostDetails details = <span class="hl-keyword">new</span> YammerPostDetails();
		details.addAttachment(resource);
YammerProfile profile = yammer.messageOperations().postUpdate(<span class="hl-string">"Hello all Yammerites!"</span>, details);
		</pre>
	</div>	
	
</div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="connecting.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;</td></tr><tr><td width="40%" align="left" valign="top">2.&nbsp;Configuring Yammer Connectivity&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;</td></tr></table></div></body></html>