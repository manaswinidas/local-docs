<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>3.&nbsp;Oracle Pooling DataSource</title><link rel="stylesheet" href="css/manual-multipage.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="Spring Data JDBC Extensions Reference Documentation"><link rel="up" href="pt02.html" title="Part&nbsp;II.&nbsp;JDBC Extensions for the Oracle Database"><link rel="prev" href="orcl.overview.html" title="Overview"><link rel="next" href="orcl.failover.html" title="4.&nbsp;Fast Connection Failover"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">3.&nbsp;Oracle Pooling DataSource</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="orcl.overview.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;II.&nbsp;JDBC Extensions for the Oracle Database</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="orcl.failover.html">Next</a></td></tr></table><hr></div><div class="chapter" title="3.&nbsp;Oracle Pooling DataSource"><div class="titlepage"><div><div><h2 class="title"><a name="orcl.datasource"></a>3.&nbsp;Oracle Pooling DataSource</h2></div></div></div><p>Oracle provides an advanced DataSource implementation that has some
  unique features. It provides connection pooling and it is required when
  using "Fast Connection Failover" for RAC.</p><div class="section" title="3.1&nbsp;Configuration using the traditional <bean&gt; element"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="orcl.datasource.1"></a>3.1&nbsp;Configuration using the traditional &lt;bean&gt; element</h2></div></div></div><p>We'll start by looking at a very basic DataSource configuration
    using the traditional &lt;bean&gt; element.</p><pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
       <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="hl-attribute">xmlns:context</span>=<span class="hl-value">"http://www.springframework.org/schema/context"</span>
	   <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"dataSource"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"oracle.jdbc.pool.OracleDataSource"</span> <span class="hl-attribute">destroy-method</span>=<span class="hl-value">"close"</span><span class="hl-tag">&gt;</span> <a name="datasource.class"></a><img src="images/callouts/1.png" alt="1" border="0">
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"URL"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"${jdbc.url}"</span><span class="hl-tag"> /&gt;</span> <a name="datasource.url"></a><img src="images/callouts/2.png" alt="2" border="0">
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"user"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"${jdbc.username}"</span><span class="hl-tag">/&gt;</span> <a name="datasource.username"></a><img src="images/callouts/3.png" alt="3" border="0">
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"${jdbc.password}"</span><span class="hl-tag">/&gt;</span> <a name="datasource.password"></a><img src="images/callouts/4.png" alt="4" border="0">
        <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"connectionCachingEnabled"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"true"</span><span class="hl-tag">/&gt;</span> <a name="datasource.cache"></a><img src="images/callouts/5.png" alt="5" border="0">
    <span class="hl-tag">&lt;/bean&gt;</span>

    <span class="hl-tag">&lt;context:property-placeholder</span> <span class="hl-attribute">location</span>=<span class="hl-value">"classpath:jdbc.properties"</span><span class="hl-tag">/&gt;</span> <a name="datasource.propertyPlaceholder"></a><img src="images/callouts/6.png" alt="6" border="0">

<span class="hl-tag">&lt;/beans&gt;</span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#datasource.class"><img src="images/callouts/1.png" alt="1" border="0"></a> </p></td><td valign="top" align="left"><p>Here we specify the <code class="classname">DataSource</code>
          implementation class as the
          <code class="classname">OracleDataSource</code>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#datasource.url"><img src="images/callouts/2.png" alt="2" border="0"></a> </p></td><td valign="top" align="left"><p>We specify the URL using the <code class="classname">URL</code>
          property. Note that it is upper case in this implementation while it
          is lower case in most other <code class="classname">DataSource</code>
          implementations.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#datasource.username"><img src="images/callouts/3.png" alt="3" border="0"></a> </p></td><td valign="top" align="left"><p>The user name is specified using the
          <code class="classname">user</code> property.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#datasource.password"><img src="images/callouts/4.png" alt="4" border="0"></a> </p></td><td valign="top" align="left"><p>The password is specified using the
          <code class="classname">password</code> property.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#datasource.cache"><img src="images/callouts/5.png" alt="5" border="0"></a> </p></td><td valign="top" align="left"><p>The connection caching must be enabled explicitly using the
          <code class="classname">connectionCachingEnabled</code> property.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#datasource.propertyPlaceholder"><img src="images/callouts/6.png" alt="6" border="0"></a> </p></td><td valign="top" align="left"><p>The property place holders will be filled in using this
          <code class="classname">&lt;context:property-placeholder&gt;</code> element
          from the context namespace.</p></td></tr></table></div></div><div class="section" title="3.2&nbsp;Using the &#34;orcl&#34; namespace to configure the OracleDataSource"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="orcl.datasource.2"></a>3.2&nbsp;Using the "orcl" namespace to configure the
    OracleDataSource</h2></div></div></div><p>The new "orcl" namespace contains a
    <code class="classname">pooling-data-source</code> element used for easy
    configuration of the <code class="classname">OracleDataSource</code>. We will show
    several ways this element can be used and we will start with a basic one
    that can replace the traditional &lt;bean&gt; element configuration used
    above.</p><p>When using the <code class="classname">pooling-data-source</code> element
    connection caching is enabled by default and must explicitly be turned off
    using the <code class="classname">connection-caching-enabled</code> attribute if
    you don't want to use this pooling support.</p><pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
       <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="hl-attribute">xmlns:context</span>=<span class="hl-value">"http://www.springframework.org/schema/context"</span>
       <span class="bold"><strong>xmlns:orcl="http://www.springframework.org/schema/data/orcl"</strong></span> <a name="datasource2.ns"></a><img src="images/callouts/1.png" alt="1" border="0">
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.0.xsd
       <span class="bold"><strong>http://www.springframework.org/schema/data/orcl <a name="datasource2.xsd"></a><img src="images/callouts/2.png" alt="2" border="0">
       http://www.springframework.org/schema/data/orcl/spring-data-orcl-1.0.xsd"&gt;</strong></span>

    <span class="bold"><strong>&lt;orcl:pooling-datasource id="dataSource"
        url="${jdbc.url}" username="${jdbc.username}" password="${jdbc.password}"/&gt;</strong></span> <a name="datasource2.properties"></a><img src="images/callouts/3.png" alt="3" border="0">

    <span class="hl-tag">&lt;context:property-placeholder</span> <span class="hl-attribute">location</span>=<span class="hl-value">"classpath:jdbc.properties"</span><span class="hl-tag">/&gt;</span> <a name="datasource2.propertyPlaceholder"></a><img src="images/callouts/4.png" alt="4" border="0">

<span class="hl-tag">&lt;/beans&gt;</span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#datasource2.ns"><img src="images/callouts/1.png" alt="1" border="0"></a> </p></td><td valign="top" align="left"><p>Here we specify the reference to the
          <code class="classname">orcl</code> schema.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#datasource2.xsd"><img src="images/callouts/2.png" alt="2" border="0"></a> </p></td><td valign="top" align="left"><p>We also specify the location for the
          <code class="classname">orcl</code> schema.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#datasource2.properties"><img src="images/callouts/3.png" alt="3" border="0"></a> </p></td><td valign="top" align="left"><p>The properties needed to connect to the database in this
          example are <code class="classname">url</code>,
          <code class="classname">username</code> and <code class="classname">password</code>.
          The <code class="classname">url</code> property could also be specifiec as
          <code class="classname">URL</code> and the <code class="classname">username</code>
          property could be specifed as <code class="classname">user</code>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#datasource2.propertyPlaceholder"><img src="images/callouts/4.png" alt="4" border="0"></a> </p></td><td valign="top" align="left"><p>Just as in the previous example, the property place holders
          will be filled in using this
          <code class="classname">&lt;context:property-placeholder&gt;</code> element
          from the context namespace.</p></td></tr></table></div></div><div class="section" title="3.3&nbsp;Using a properties file directly for connection properties"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="orcl.datasource.3"></a>3.3&nbsp;Using a properties file directly for connection properties</h2></div></div></div><p>We used a <code class="classname">property-placeholder</code> in the
    previous example to provide connection properties. We can also read the
    properties directly from a properties file without using placeholders.
    This is done by using a <code class="classname">properties-location</code>
    attribute specifying the location of the properties file.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>When you specify properties using a property file there are two
      basic properties, url and username, where you can use the Oracle
      property name or the name traditionally used by Spring developers. For
      url we also accept URL and for username we also accept user.</p></td></tr></table></div><p>We will use the following property file named
    <code class="filename">orcl.properties</code> and we will place it at the root of
    the classpath.</p><pre class="programlisting">url=jdbc:oracle:thin:@//maui:1521/xe
username=spring
password=spring</pre><p>Once we have this file in place we can reference it from our
    <code class="classname">pooling-data-source</code> entry and omit the property
    plceholder declarations for any properties provided in this file.</p><pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
       <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="hl-attribute">xmlns:context</span>=<span class="hl-value">"http://www.springframework.org/schema/context"</span>
       <span class="hl-attribute">xmlns:orcl</span>=<span class="hl-value">"http://www.springframework.org/schema/data/orcl"</span>
       <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.0.xsd
       http://www.springframework.org/schema/data/orcl
       http://www.springframework.org/schema/data/orcl/spring-data-orcl-1.0.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="bold"><strong>&lt;orcl:pooling-datasource id="dataSource" 
        properties-location="classpath:orcl.properties"/&gt;</strong></span> <a name="datasource3.properties"></a><img src="images/callouts/1.png" alt="1" border="0">

<span class="hl-tag">&lt;/beans&gt;</span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#datasource3.properties"><img src="images/callouts/1.png" alt="1" border="0"></a> </p></td><td valign="top" align="left"><p>The <code class="classname">pooling-datasource</code> with the
          <code class="classname">properties-location</code> specified. The
          <code class="classname">URL</code>, <code class="classname">user</code> and
          <code class="classname">password</code> properties will be read from the
          provided properties file.</p></td></tr></table></div><p>You can even remove the <code class="classname">properties-location</code>
    attribute as long as you use the default location and name which is a file
    named <code class="filename">orcl.properties</code> at the root of the
    classpath.</p><pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
       <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="hl-attribute">xmlns:context</span>=<span class="hl-value">"http://www.springframework.org/schema/context"</span>
       <span class="hl-attribute">xmlns:orcl</span>=<span class="hl-value">"http://www.springframework.org/schema/data/orcl"</span>
       <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.0.xsd
       http://www.springframework.org/schema/data/orcl
       http://www.springframework.org/schema/data/orcl/spring-data-orcl-1.0.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="bold"><strong>&lt;orcl:pooling-datasource id="dataSource"/&gt;</strong></span> <a name="datasource4.properties"></a><img src="images/callouts/1.png" alt="1" border="0">

<span class="hl-tag">&lt;/beans&gt;</span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#datasource4.properties"><img src="images/callouts/1.png" alt="1" border="0"></a> </p></td><td valign="top" align="left"><p>The <code class="classname">pooling-datasource</code> without
          properties or the <code class="classname">properties-location</code>
          specified. We are relying on the default properties file name and
          location.</p></td></tr></table></div></div><div class="section" title="3.4&nbsp;Additional connection and cache properties"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="orcl.datasource.4"></a>3.4&nbsp;Additional connection and cache properties</h2></div></div></div><p>It's sometimes necessary to provide additional connection properties
    to control how the database access is configured. There are several ways
    you can provide these properties and they are outlined below.</p><div class="section" title="3.4.1&nbsp;Using the property file for additional connection properties"><div class="titlepage"><div><div><h3 class="title"><a name="orcl.datasource.4.1"></a>3.4.1&nbsp;Using the property file for additional connection
      properties</h3></div></div></div><p>We can provide additional connection properties by ust adding them
      to the properties file we used in the example above.</p><pre class="programlisting">url=jdbc:oracle:thin:@//maui:1521/xe
username=spring
password=spring
processEscapes=false</pre><p>Any properties specified in addition to the standard URL/url,
      user/username and password will be used for configuring the
      <code class="classname">OracleDataSource</code>.</p><p>We can also use a prefix for the connection properties. This can
      be useful if the properties file contain other properties like
      connection cache properties. We will see how these additional properties
      are used later on.</p><pre class="programlisting">conn.url=jdbc:oracle:thin:@//maui:1521/xe
conn.username=spring
conn.password=spring
conn.processEscapes=false</pre><p>The prefix must be specified in the
      <code class="classname">pooling-data-source</code> element configuration. It is
      specified using the <code class="classname">connection-properties-prefix</code>
      attribute.</p><pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
       <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="hl-attribute">xmlns:context</span>=<span class="hl-value">"http://www.springframework.org/schema/context"</span>
       <span class="hl-attribute">xmlns:orcl</span>=<span class="hl-value">"http://www.springframework.org/schema/data/orcl"</span>
       <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.0.xsd
       http://www.springframework.org/schema/data/orcl
       http://www.springframework.org/schema/data/orcl/spring-data-orcl-1.0.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="bold"><strong>&lt;orcl:pooling-datasource id="dataSource" 
        connection-properties-prefix="conn" <a name="datasource.4.1.prefix"></a><img src="images/callouts/1.png" alt="1" border="0">
        properties-location="classpath:orcl.properties"/&gt;</strong></span>

<span class="hl-tag">&lt;/beans&gt;</span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#datasource.4.1.prefix"><img src="images/callouts/1.png" alt="1" border="0"></a> </p></td><td valign="top" align="left"><p>The <code class="classname">connection-properties-prefix</code> is
            specified here.</p></td></tr></table></div></div><div class="section" title="3.4.2&nbsp;Using the property file for additional cache properties"><div class="titlepage"><div><div><h3 class="title"><a name="orcl.datasource.4.2"></a>3.4.2&nbsp;Using the property file for additional cache properties</h3></div></div></div><p>We can also specify connection cache properties in the properties
      file. We must use a prefix for these connection cache properties to
      distinguish them from the regular connection properties. In this example
      we are using "cache" as the prefix.</p><pre class="programlisting">conn.url=jdbc:oracle:thin:@//maui:1521/xe
conn.username=spring
conn.password=spring
conn.processEscapes=false
cache.InitialLimit=10</pre><p>The connection cache prefix must be specified using the
      <code class="classname">connection-cache-properties-prefix</code>
      attribute.</p><pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
       <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="hl-attribute">xmlns:context</span>=<span class="hl-value">"http://www.springframework.org/schema/context"</span>
       <span class="hl-attribute">xmlns:orcl</span>=<span class="hl-value">"http://www.springframework.org/schema/data/orcl"</span>
       <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.0.xsd
       http://www.springframework.org/schema/data/orcl
       http://www.springframework.org/schema/data/orcl/spring-data-orcl-1.0.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="bold"><strong>&lt;orcl:pooling-datasource id="dataSource" 
        connection-properties-prefix="conn"
        connection-cache-properties-prefix="cache" <a name="datasource.4.2.prefix"></a><img src="images/callouts/1.png" alt="1" border="0">
        properties-location="classpath:orcl.properties"/&gt;</strong></span>

<span class="hl-tag">&lt;/beans&gt;</span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#datasource.4.2.prefix"><img src="images/callouts/1.png" alt="1" border="0"></a> </p></td><td valign="top" align="left"><p>The
            <code class="classname">connection-cache-properties-prefix</code> is
            specified here.</p></td></tr></table></div></div><div class="section" title="3.4.3&nbsp;Using &#34;connection-properties&#34; element for additional connection properties"><div class="titlepage"><div><div><h3 class="title"><a name="orcl.datasource.4.3"></a>3.4.3&nbsp;Using "connection-properties" element for additional connection
      properties</h3></div></div></div><p>The connection properties can be specified using the
      <code class="classname">connection-properties</code> element.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>If you specify a <code class="classname">connection-properties</code>
        element then any connection properties specified in a property file
        other than the basic url, username and password will not be
        used.</p></td></tr></table></div><pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
       <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="hl-attribute">xmlns:context</span>=<span class="hl-value">"http://www.springframework.org/schema/context"</span>
       <span class="hl-attribute">xmlns:orcl</span>=<span class="hl-value">"http://www.springframework.org/schema/data/orcl"</span>
       <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.0.xsd
       http://www.springframework.org/schema/data/orcl
       http://www.springframework.org/schema/data/orcl/spring-data-orcl-1.0.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="bold"><strong>&lt;orcl:pooling-datasource id="dataSource" 
        properties-location="classpath:orcl.properties"&gt;
        &lt;orcl:connection-properties&gt;
            processEscapes=false <a name="datasource.4.3.prop"></a><img src="images/callouts/1.png" alt="1" border="0">
        &lt;/orcl:connection-properties&gt;
    &lt;/orcl:pooling-datasource&gt;</strong></span>

<span class="hl-tag">&lt;/beans&gt;</span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#datasource.4.3.prop"><img src="images/callouts/1.png" alt="1" border="0"></a> </p></td><td valign="top" align="left"><p>The connection properties are specified here.</p></td></tr></table></div></div><div class="section" title="3.4.4&nbsp;Using &#34;connection-cache-properties&#34; element for additional cache properties"><div class="titlepage"><div><div><h3 class="title"><a name="orcl.datasource.4.4"></a>3.4.4&nbsp;Using "connection-cache-properties" element for additional cache
      properties</h3></div></div></div><p>The connection cache properties can be specified using the
      <code class="classname">connection-cache-properties</code> element.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>If you specify a
        <code class="classname">connection-cache-properties</code> element then any
        connection cache properties specified in a property file will not be
        used.</p></td></tr></table></div><pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
       <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="hl-attribute">xmlns:context</span>=<span class="hl-value">"http://www.springframework.org/schema/context"</span>
       <span class="hl-attribute">xmlns:orcl</span>=<span class="hl-value">"http://www.springframework.org/schema/data/orcl"</span>
       <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.0.xsd
       http://www.springframework.org/schema/data/orcl
       http://www.springframework.org/schema/data/orcl/spring-data-orcl-1.0.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="bold"><strong>&lt;orcl:pooling-datasource id="dataSource" 
        properties-location="classpath:orcl.properties"&gt;
        &lt;orcl:connection-properties&gt;
            processEscapes=false
        &lt;/orcl:connection-properties&gt;
        &lt;orcl:connection-cache-properties&gt;
            InitialLimit=10 <a name="datasrce.4.4.prop"></a><img src="images/callouts/1.png" alt="1" border="0">
        &lt;/orcl:connection-cache-properties&gt;
    &lt;/orcl:pooling-datasource&gt;</strong></span>

<span class="hl-tag">&lt;/beans&gt;</span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#datasrce.4.4.prop"><img src="images/callouts/1.png" alt="1" border="0"></a> </p></td><td valign="top" align="left"><p>The connection cache properties are specified here.</p></td></tr></table></div></div><div class="section" title="3.4.5&nbsp;Using &#34;username-connection-proxy&#34; element for proxy connections"><div class="titlepage"><div><div><h3 class="title"><a name="orcl.datasource.4.5"></a>3.4.5&nbsp;Using "username-connection-proxy" element for proxy
      connections</h3></div></div></div><p>The Oracle JDBC driver provides proxy authentication. This means
      that you can configure a connection pool using a proxy user account with
      limited rights. Then during the connection process you would specify the
      actual username for the end user. This username must be configured to
      allow a proxy connection through the user proxy ("grant connect through
      proxyuser"). See <a class="xref" href="">???</a> for more details on this
      usage.</p><p>Connection proxy authentication is configured using the
      <code class="classname">username-connection-proxy</code> element. You also need
      to provide a user name provider that implements the
      <code class="classname">ConnectionUsernameProvider</code> interface. This
      interface has a single method named <code class="classname">getUserName</code>
      that should return the username for the current end user to be connected
      via the proxy user.</p><pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">xmlns</span>=<span class="hl-value">"http://www.springframework.org/schema/beans"</span>
       <span class="hl-attribute">xmlns:xsi</span>=<span class="hl-value">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="hl-attribute">xmlns:context</span>=<span class="hl-value">"http://www.springframework.org/schema/context"</span>
       <span class="hl-attribute">xmlns:orcl</span>=<span class="hl-value">"http://www.springframework.org/schema/data/orcl"</span>
       <span class="hl-attribute">xsi:schemaLocation</span>=<span class="hl-value">"http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.0.xsd
       http://www.springframework.org/schema/data/orcl
       http://www.springframework.org/schema/data/orcl/spring-data-orcl-1.0.xsd"</span><span class="hl-tag">&gt;</span>

    <span class="bold"><strong>&lt;orcl:pooling-datasource id="dataSource" 
        properties-location="classpath:orcl.properties"&gt;
        &lt;orcl:username-connection-proxy connection-context-provider="usernameProvider"/&gt; <a name="datasource.4.5.prop"></a><img src="images/callouts/1.png" alt="1" border="0">
    &lt;/orcl:pooling-datasource&gt;

    &lt;bean id="usernameProvider" class="org.springframework.data.jdbc.test.CurrentUsernameProvider"/&gt;</strong></span>

<span class="hl-tag">&lt;/beans&gt;</span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#datasource.4.5.prop"><img src="images/callouts/1.png" alt="1" border="0"></a> </p></td><td valign="top" align="left"><p>The connection proxy username provider is specified
            here.</p></td></tr></table></div></div></div><div class="section" title="3.5&nbsp;Summary of configuration options for the &#34;pooling-data-source&#34;"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="orcl.datasource.options"></a>3.5&nbsp;Summary of configuration options for the
    "pooling-data-source"</h2></div></div></div><p>The <code class="classname">pooling-data-source</code> element has the
    following attributes:</p><div class="table"><a name="pooling-data-source-settings"></a><p class="title"><b>Table&nbsp;3.1.&nbsp;<code class="literal">&lt;pooling-data-source&gt;</code> attribute
        settings</b></p><div class="table-contents"><table summary="<pooling-data-source&gt; attribute&#xA;        settings" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col><col><col></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">Attribute</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">Required</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">Default</th><th style="border-bottom: 0.5pt solid ; ">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><code class="literal">url</code></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">Yes</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; ">The url to be used for connecting to the database. Can be
              provided in a property file. Alternate property name is
              <code class="literal">URL</code></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><code class="literal">username</code></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">No</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; ">The user name used to connect. Can be provided in a
              property file. Alternate property name is
              <code class="literal">user</code></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><code class="literal">password</code></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">No</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; ">The password used to connect. Can be provided in a
              property file.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><code class="literal">connection-caching-enabled</code></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">No</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><code class="literal">true</code></td><td style="border-bottom: 0.5pt solid ; ">Is connection caching enabled?</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><code class="literal">fast-connection-failover-enabled</code></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">No</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><code class="literal">false</code></td><td style="border-bottom: 0.5pt solid ; ">Is the fast connection failover feature enabled?</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><code class="literal">ONS-configuration</code></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">No</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; ">The ONS configuration string.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><code class="literal">properties-location</code></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">No</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; ">The location of a properties file containing key-value
              pairs for the connection and connection cache environment using
              a specific prefix to separate connection cache properties from
              connection properties (in standard Properties format, namely
              'key=value' pairs). If no location is specified a properties
              file located at <code class="literal">classpath:orcl.properties</code>
              will be used if found.</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><code class="literal">connection-properties-prefix</code></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">No</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">&nbsp;</td><td style="border-bottom: 0.5pt solid ; ">The prefix that is used for connection properties
              provided in the property file.</td></tr><tr><td style="border-right: 0.5pt solid ; "><code class="literal">connection-cache-properties-prefix</code></td><td style="border-right: 0.5pt solid ; ">No</td><td style="border-right: 0.5pt solid ; ">&nbsp;</td><td style="">The prefix that is used for connection cache properties
              provided in the property file.</td></tr></tbody></table></div></div><p><br class="table-break"></p><p>The <code class="classname">pooling-data-source</code> element has the
    following child elements:</p><div class="table"><a name="pooling-data-source-elements"></a><p class="title"><b>Table&nbsp;3.2.&nbsp;<code class="literal">&lt;pooling-data-source&gt;</code> child
        elements</b></p><div class="table-contents"><table summary="<pooling-data-source&gt; child&#xA;        elements" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">Element</th><th style="border-bottom: 0.5pt solid ; ">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><code class="literal">connection-properties</code></td><td style="border-bottom: 0.5pt solid ; ">The newline-separated, key-value pairs for the connection
              properties (in standard Properties format, namely 'key=value'
              pairs)</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><code class="literal">connection-cache-properties</code></td><td style="border-bottom: 0.5pt solid ; ">The newline-separated, key-value pairs for the
              connection-cache-properties (in standard Properties format,
              namely 'key=value' pairs)</td></tr><tr><td style="border-right: 0.5pt solid ; "><code class="literal">username-connection-proxy</code></td><td style="">The configuration of a proxy authentication using a
              connection context provider</td></tr></tbody></table></div></div><p><br class="table-break"></p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="orcl.overview.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="pt02.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="orcl.failover.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Overview&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;4.&nbsp;Fast Connection Failover</td></tr></table></div></body></html>