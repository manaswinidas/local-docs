<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>17.&nbsp;Creating a Stream</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Spring Cloud Data Flow Server for Apache Mesos"><link rel="up" href="streams.html" title="Part&nbsp;IV.&nbsp;Streams"><link rel="prev" href="spring-cloud-dataflow-register-apps.html" title="16.&nbsp;Register a Stream App"><link rel="next" href="spring-cloud-dataflow-destroy-stream.html" title="18.&nbsp;Destroying a Stream"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">17.&nbsp;Creating a Stream</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="spring-cloud-dataflow-register-apps.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;IV.&nbsp;Streams</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="spring-cloud-dataflow-destroy-stream.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="spring-cloud-dataflow-create-stream" href="#spring-cloud-dataflow-create-stream"></a>17.&nbsp;Creating a Stream</h2></div></div></div><p>The Spring Cloud Data Flow Server exposes a full RESTful API for managing the lifecycle of stream definitions, but the easiest way to use is it is via the Spring Cloud Data Flow shell. Start the shell as described in the <a class="link" href="Getting-Started.xml#getting-started" target="_top">Getting Started</a> section.</p><p>New streams are created by posting stream definitions. The definitions are built from a simple DSL. For example, let&#8217;s walk through what happens if we execute the following shell command:</p><pre class="screen">dataflow:&gt; stream create --definition "time | log" --name ticktock</pre><p>This defines a stream named <code class="literal">ticktock</code> based off the DSL expression <code class="literal">time | log</code>.  The DSL uses the "pipe" symbol <code class="literal">|</code>, to connect a source to a sink.</p><p>Then to deploy the stream execute the following shell command (or alternatively add the <code class="literal">--deploy</code> flag when creating the stream so that this step is not needed):</p><pre class="screen">dataflow:&gt; stream deploy --name ticktock</pre><p>The Data Flow Server resolves <code class="literal">time</code> and <code class="literal">log</code> to maven coordinates and uses those to launch the <code class="literal">time</code> and <code class="literal">log</code> applications of the stream.</p><pre class="screen">2016-06-01 09:41:21.728  INFO 79016 --- [nio-9393-exec-6] o.s.c.d.spi.local.LocalAppDeployer       : deploying app ticktock.log instance 0
   Logs will be in /var/folders/wn/8jxm_tbd1vj28c8vj37n900m0000gn/T/spring-cloud-dataflow-912434582726479179/ticktock-1464788481708/ticktock.log
2016-06-01 09:41:21.914  INFO 79016 --- [nio-9393-exec-6] o.s.c.d.spi.local.LocalAppDeployer       : deploying app ticktock.time instance 0
   Logs will be in /var/folders/wn/8jxm_tbd1vj28c8vj37n900m0000gn/T/spring-cloud-dataflow-912434582726479179/ticktock-1464788481910/ticktock.time</pre><p>In this example, the time source simply sends the current time as a message each second, and the log sink outputs it using the logging framework.
You can tail the <code class="literal">stdout</code> log (which has an "_&lt;instance&gt;" suffix). The log files are located within the directory displayed in the Data Flow Server&#8217;s log output, as shown above.</p><pre class="screen">$ tail -f /var/folders/wn/8jxm_tbd1vj28c8vj37n900m0000gn/T/spring-cloud-dataflow-912434582726479179/ticktock-1464788481708/ticktock.log/stdout_0.log
2016-06-01 09:45:11.250  INFO 79194 --- [  kafka-binder-] log.sink    : 06/01/16 09:45:11
2016-06-01 09:45:12.250  INFO 79194 --- [  kafka-binder-] log.sink    : 06/01/16 09:45:12
2016-06-01 09:45:13.251  INFO 79194 --- [  kafka-binder-] log.sink    : 06/01/16 09:45:13</pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_application_properties" href="#_application_properties"></a>17.1&nbsp;Application properties</h2></div></div></div><p>Application properties are the properties associated with each application in the stream. When the application is deployed, the application properties are applied to the application via
command line arguments or environment variables based on the underlying deployment implementation.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_passing_application_properties_when_creating_a_stream" href="#_passing_application_properties_when_creating_a_stream"></a>17.1.1&nbsp;Passing application properties when creating a stream</h3></div></div></div><p>The following stream</p><pre class="programlisting">dataflow:&gt; stream create --definition <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"time | log"</span> --name ticktock</pre><p>can have application properties defined at the time of stream creation.</p><p>The shell command <code class="literal">app info</code> displays the white-listed application properties for the application.
For more info on the property white listing refer to <a class="xref" href="spring-cloud-dataflow-register-apps.html#spring-cloud-dataflow-stream-app-whitelisting" title="16.1&nbsp;Whitelisting application properties">Section&nbsp;16.1, &#8220;Whitelisting application properties&#8221;</a></p><p>Below are the white listed properties for the app <code class="literal">time</code>:</p><pre class="programlisting">dataflow:&gt; app info source:time
&#9556;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9572;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9572;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9572;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9559;
&#9553;         Option Name          &#9474;         Description          &#9474;           Default            &#9474;             Type             &#9553;
&#9568;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9578;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9578;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9578;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9571;
&#9553;trigger.time-unit             &#9474;The TimeUnit to apply to delay&#9474;&lt;none&gt;                        &#9474;java.util.concurrent.TimeUnit &#9553;
&#9553;                              &#9474;values.                       &#9474;                              &#9474;                              &#9553;
&#9553;trigger.fixed-delay           &#9474;Fixed delay <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">for</span> periodic      &#9474;<span class="hl-number">1</span>                             &#9474;java.lang.Integer             &#9553;
&#9553;                              &#9474;triggers.                     &#9474;                              &#9474;                              &#9553;
&#9553;trigger.cron                  &#9474;Cron expression value <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">for</span> the &#9474;&lt;none&gt;                        &#9474;java.lang.String              &#9553;
&#9553;                              &#9474;Cron Trigger.                 &#9474;                              &#9474;                              &#9553;
&#9553;trigger.initial-delay         &#9474;Initial delay <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">for</span> periodic    &#9474;<span class="hl-number">0</span>                             &#9474;java.lang.Integer             &#9553;
&#9553;                              &#9474;triggers.                     &#9474;                              &#9474;                              &#9553;
&#9553;trigger.max-messages          &#9474;Maximum messages per poll, -<span class="hl-number">1</span> &#9474;<span class="hl-number">1</span>                             &#9474;java.lang.Long                &#9553;
&#9553;                              &#9474;means infinity.               &#9474;                              &#9474;                              &#9553;
&#9553;trigger.date-format           &#9474;Format <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">for</span> the date value.    &#9474;&lt;none&gt;                        &#9474;java.lang.String              &#9553;
&#9562;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9575;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9575;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9575;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9565;</pre><p>Below are the white listed properties for the app <code class="literal">log</code>:</p><pre class="programlisting">dataflow:&gt; app info sink:log
&#9556;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9572;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9572;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9572;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9559;
&#9553;         Option Name          &#9474;         Description          &#9474;           Default            &#9474;             Type             &#9553;
&#9568;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9578;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9578;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9578;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9571;
&#9553;log.name                      &#9474;The name of the logger to use.&#9474;&lt;none&gt;                        &#9474;java.lang.String              &#9553;
&#9553;log.level                     &#9474;The level at which to log     &#9474;&lt;none&gt;                        &#9474;org.springframework.integratio&#9553;
&#9553;                              &#9474;messages.                     &#9474;                              &#9474;n.handler.LoggingHandler$Level&#9553;
&#9553;log.expression                &#9474;A SpEL expression (against the&#9474;payload                       &#9474;java.lang.String              &#9553;
&#9553;                              &#9474;incoming message) to evaluate &#9474;                              &#9474;                              &#9553;
&#9553;                              &#9474;as the logged message.        &#9474;                              &#9474;                              &#9553;
&#9562;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9575;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9575;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9575;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9565;</pre><p>The application properties for the <code class="literal">time</code> and <code class="literal">log</code> apps can be specified at the time of <code class="literal">stream</code> creation as follows:</p><pre class="programlisting">dataflow:&gt; stream create --definition <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"time --fixed-delay=5 | log --level=WARN"</span> --name ticktock</pre><p>Note that the properties <code class="literal">fixed-delay</code> and <code class="literal">level</code> defined above for the apps <code class="literal">time</code> and <code class="literal">log</code> are the 'short-form' property names provided by the shell completion.
These 'short-form' property names are applicable only for the white-listed properties and in all other cases, only <span class="emphasis"><em>fully qualified</em></span> property names should be used.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_passing_application_properties_when_deploying_a_stream" href="#_passing_application_properties_when_deploying_a_stream"></a>17.1.2&nbsp;Passing application properties when deploying a stream</h3></div></div></div><p>The application properties can also be specified when deploying a stream. When specified during deployment, these application properties can either be specified as
 'short-form' property names (applicable for white-listed properties) or <span class="emphasis"><em>fully qualified</em></span> property names. The application properties should have the prefix "app.&lt;appName/label&gt;".</p><p>For example, the stream</p><pre class="programlisting">dataflow:&gt; stream create --definition <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"time | log"</span> --name ticktock</pre><p>can be deployed with application properties using the 'short-form' property names:</p><pre class="programlisting">dataflow:&gt;stream deploy ticktock --properties <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"app.time.fixed-delay=5,app.log.level=ERROR"</span></pre><p>When using the app label,</p><pre class="programlisting">stream create ticktock --definition <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"a: time | b: log"</span></pre><p>the application properties can be defined as:</p><pre class="programlisting">stream deploy ticktock --properties <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"app.a.fixed-delay=4,app.b.level=ERROR"</span></pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="passing_stream_partition_properties" href="#passing_stream_partition_properties"></a>17.1.3&nbsp;Passing stream partition properties during stream deployment</h3></div></div></div><p>A common pattern in stream processing is to partition the data as it is streamed.
This entails deploying multiple instances of a message consuming app and using
content-based routing so that messages with a given key (as determined at runtime)
are always routed to the same app instance. You can pass the partition properties during
stream deployment to declaratively configure a partitioning strategy to route each
message to a specific consumer instance.</p><p>See below for examples of deploying partitioned streams:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="strong"><strong>app.[app/label name].producer.partitionKeyExtractorClass</strong></span></span></dt><dd>The class name of a PartitionKeyExtractorStrategy (default <code class="literal">null</code>)</dd><dt><span class="term"><span class="strong"><strong>app.[app/label name].producer.partitionKeyExpression</strong></span></span></dt><dd>A SpEL expression, evaluated against the message, to determine the partition key;
only applies if <code class="literal">partitionKeyExtractorClass</code> is null. If both are null, the app
is not partitioned (default <code class="literal">null</code>)</dd><dt><span class="term"><span class="strong"><strong>app.[app/label name].producer.partitionSelectorClass</strong></span></span></dt><dd>The class name of a PartitionSelectorStrategy (default <code class="literal">null</code>)</dd><dt><span class="term"><span class="strong"><strong>app.[app/label name].producer.partitionSelectorExpression</strong></span></span></dt><dd>A SpEL expression, evaluated against the partition key, to determine the partition
index to which the message will be routed. The final partition index will be the
return value (an integer) modulo <code class="literal">[nextModule].count</code>. If both the class and
expression are null, the underlying binder&#8217;s default PartitionSelectorStrategy
will be applied to the key (default <code class="literal">null</code>)</dd></dl></div><p>In summary, an app is partitioned if its count is &gt; 1 and the previous app has a
<code class="literal">partitionKeyExtractorClass</code> or <code class="literal">partitionKeyExpression</code> (class takes precedence).
When a partition key is extracted, the partitioned app instance is determined by
invoking the <code class="literal">partitionSelectorClass</code>, if present, or the <code class="literal">partitionSelectorExpression % partitionCount</code>,
where <code class="literal">partitionCount</code> is application count in the case of RabbitMQ, and the underlying
partition count of the topic in the case of Kafka.</p><p>If neither a <code class="literal">partitionSelectorClass</code> nor a <code class="literal">partitionSelectorExpression</code> is
present the result is <code class="literal">key.hashCode() % partitionCount</code>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_overriding_application_properties_during_stream_deployment" href="#_overriding_application_properties_during_stream_deployment"></a>17.1.4&nbsp;Overriding application properties during stream deployment</h3></div></div></div><p>Application properties that are defined during deployment override the same properties defined during the stream creation.</p><p>For example, the following stream has application properties defined during stream creation:</p><pre class="programlisting">dataflow:&gt; stream create --definition <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"time --fixed-delay=5 | log --level=WARN"</span> --name ticktock</pre><p>To override these application properties, one can specify the new property values during deployment:</p><pre class="programlisting">dataflow:&gt;stream deploy ticktock --properties <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"app.time.fixed-delay=4,app.log.level=ERROR"</span></pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_deployment_properties" href="#_deployment_properties"></a>17.2&nbsp;Deployment properties</h2></div></div></div><p>When deploying the stream, properties that control the deployment of the apps into the target platform are known as <code class="literal">deployment</code> properties.
For instance, one can specify how many instances need to be deployed for the specific application defined in the stream using the deployment property called <code class="literal">count</code>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_passing_instance_count_as_deployment_property" href="#_passing_instance_count_as_deployment_property"></a>17.2.1&nbsp;Passing instance count as deployment property</h3></div></div></div><p>If you would like to have multiple instances of an application in the stream, you
can include a property with the deploy command:</p><pre class="programlisting">dataflow:&gt; stream deploy --name ticktock --properties <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"app.time.count=3"</span></pre><p>Note that <code class="literal">count</code> is the <span class="strong"><strong>reserved</strong></span> property name used by the underlying deployer. Hence, if the application also has a custom property named <code class="literal">count</code>, it is <span class="strong"><strong>not</strong></span> supported
 when specified in 'short-form' form during stream <span class="emphasis"><em>deployment</em></span> as it could conflict with the <span class="emphasis"><em>instance</em></span> count deployer property. Instead, the <code class="literal">count</code> as a custom application property can be
 specified in its <span class="emphasis"><em>fully qualified</em></span> form (example: <code class="literal">app.foo.bar.count</code>) during stream <span class="emphasis"><em>deployment</em></span> or it can be specified using 'short-form' or <span class="emphasis"><em>fully qualified</em></span> form during the stream <span class="emphasis"><em>creation</em></span>
 where it will be considered as an app property.</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>See <a class="xref" href="spring-cloud-dataflow-stream-app-labels.html" title="24.&nbsp;Using Labels in a Stream">Chapter&nbsp;24, <i>Using Labels in a Stream</i></a>.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_inline_vs_file_reference_properties" href="#_inline_vs_file_reference_properties"></a>17.2.2&nbsp;Inline vs file reference properties</h3></div></div></div><p>When using the Spring Cloud Dataflow Shell, there are two ways to provide deployment
properties: either <span class="strong"><strong>inline</strong></span> or via a <span class="strong"><strong>file reference</strong></span>. Those two ways are exclusive
and documented below:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="strong"><strong>Inline properties</strong></span></span></dt><dd>use the <code class="literal">--properties</code> shell option and list properties as a comma separated
list of key=value pairs, like so:</dd></dl></div><pre class="programlisting">stream deploy foo
    --properties <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"app.transform.count=2,app.transform.producer.partitionKeyExpression=payload"</span></pre><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="strong"><strong>Using a file reference</strong></span></span></dt><dd>use the <code class="literal">--propertiesFile</code> option and point it to a local Java <code class="literal">.properties</code> file
(i.e. that lives in the filesystem of the machine running the shell). Being read
as a <code class="literal">.properties</code> file, normal rules apply (ISO 8859-1 encoding, <code class="literal">=</code>, <code class="literal">&lt;space&gt;</code> or
<code class="literal">:</code> delimiter, etc.) although we recommend using <code class="literal">=</code> as a key-value pair delimiter
for consistency:</dd></dl></div><pre class="programlisting">stream deploy foo --propertiesFile myprops.properties</pre><p>where <code class="literal">myprops.properties</code> contains:</p><pre class="screen">app.transform.count=2
app.transform.producer.partitionKeyExpression=payload</pre><p>Both the above properties will be passed as deployment properties for the stream <code class="literal">foo</code> above.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="spring-cloud-dataflow-register-apps.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="streams.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="spring-cloud-dataflow-destroy-stream.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">16.&nbsp;Register a Stream App&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;18.&nbsp;Destroying a Stream</td></tr></table></div></body></html>