<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.3">
<title>Service Bindings</title>
<link rel="stylesheet" href="css//spring.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
</head>
<body class="book">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="service-bindings"><a class="anchor" href="#service-bindings"></a>1. Service Bindings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Service brokers can provide information to a consumer of a service instance through a {osbspec}#binding[service binding].
Service bindings are often used to expose credentials for service instance resources to an application.</p>
</div>
<div class="paragraph">
<p>If the <code>bindable</code> field is set to <code>true</code> for any plan in the service catalog, the service broker must provide an implementation of the {scosb-api-services}ServiceInstanceBindingService.html[<code>ServiceInstanceBindingService</code>] interface.
Otherwise, the binding methods of the service broker are not called by the platform, and a default implementation of this interface can be used.
Each method receives a single Java object parameter that contains all details of the request from the platform and returns a Java object value that provides details of the operation to the platform.</p>
</div>
<div class="sect2">
<h3 id="service-binding-creation"><a class="anchor" href="#service-binding-creation"></a>1.1. Service Binding Creation</h3>
<div class="paragraph">
<p>The service broker must provide an implementation of the {scosb-api-services}ServiceInstanceBindingService.html#createServiceInstanceBinding-org.springframework.cloud.servicebroker.model.binding.CreateServiceInstanceBindingRequest-[createServiceInstanceBinding()].</p>
</div>
<div class="paragraph">
<p>Two types of bindings are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>App bindings can be used to provide credentials, log drains, and volume services to applications.</p>
</li>
<li>
<p>Route bindings can be used to provide routes for the platform to use when proxying requests.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The response from this method lets one of two Java object types be returned, reflecting the two types of supported bindings.</p>
</div>
<div class="paragraph">
<p>Service brokers can generate one set of credentials for all binding requests or provide unique credentials for each binding request.</p>
</div>
<div class="sect3">
<h4 id="event-registry"><a class="anchor" href="#event-registry"></a>1.1.1. Event Registry</h4>
<div class="paragraph">
<p>Service binding creation can be further customized by utilizing events. Autowire the {scosb-api-service-events}/EventFlowRegistries.html[EventFlowRegistries] bean and retrieve the {scosb-api-service-events}/CreateServiceInstanceBindingEventFlowRegistry.html[CreateServiceInstanceBindingEventFlowRegistry] via the {scosb-api-service-events}/EventFlowRegistries.html#getCreateInstanceBindingRegistry--[getCreateInstanceBindingRegistry()] accessor. Use the {scosb-api-service-events}/EventFlowRegistry.html#addInitializationFlow-I-[addInitializationFlow()], {scosb-api-service-events}/EventFlowRegistry.html#addCompletionFlow-C-[addCompletionFlow()] or {scosb-api-service-events}/EventFlowRegistry.html#addErrorFlow-E-[addErrorFlow()] methods to register custom reactive flows for execution during the various stages of creating a service binding.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="service-binding-deletion"><a class="anchor" href="#service-binding-deletion"></a>1.2. Service Binding Deletion</h3>
<div class="paragraph">
<p>The service broker must provide an implementation of the {scosb-api-services}ServiceInstanceBindingService.html#deleteServiceInstanceBinding-org.springframework.cloud.servicebroker.model.binding.DeleteServiceInstanceBindingRequest-[deleteServiceInstanceBinding()].</p>
</div>
<div class="paragraph">
<p>Any credentials provisioned in the create operation should be deprovisioned by the delete operation.</p>
</div>
<div class="sect3">
<h4 id="event-registry-2"><a class="anchor" href="#event-registry-2"></a>1.2.1. Event Registry</h4>
<div class="paragraph">
<p>Service binding deletion can be further customized by utilizing events. Autowire the {scosb-api-service-events}/EventFlowRegistries.html[EventFlowRegistries] bean and retrieve the {scosb-api-service-events}/DeleteServiceInstanceBindingEventFlowRegistry.html[DeleteServiceInstanceBindingEventFlowRegistry] via the {scosb-api-service-events}/EventFlowRegistries.html#getDeleteInstanceBindingRegistry--[getDeleteInstanceBindingRegistry()] accessor. Use the {scosb-api-service-events}/EventFlowRegistry.html#addInitializationFlow-I-[addInitializationFlow()], {scosb-api-service-events}/EventFlowRegistry.html#addCompletionFlow-C-[addCompletionFlow()] or {scosb-api-service-events}/EventFlowRegistry.html#addErrorFlow-E-[addErrorFlow()] methods to register custom reactive flows for execution during the various stages of deleting a service binding.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="service-binding-retrieval"><a class="anchor" href="#service-binding-retrieval"></a>1.3. Service Binding Retrieval</h3>
<div class="paragraph">
<p>If the <code>bindings_retrievable</code> field is set to <code>true</code> in the services catalog, the service catalog must provide an implementation of the {scosb-api-services}ServiceInstanceBindingService.html#getServiceInstanceBinding-org.springframework.cloud.servicebroker.model.binding.GetServiceInstanceBindingRequest-[getServiceInstanceBinding()].
Otherwise, this method is never called by the platform, and the default implementation in the interface can be used.</p>
</div>
<div class="paragraph">
<p>Service brokers are responsible for maintaining any service binding state necessary to support the retrieval operation.</p>
</div>
</div>
<div class="sect2">
<h3 id="example-implementation"><a class="anchor" href="#example-implementation"></a>1.4. Example Implementation</h3>
<div class="paragraph">
<p>The following example shows an implementation of a service binding:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">Unresolved directive in service-bindings.adoc - include::{examples-dir}/ExampleServiceBindingService.java[]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="example-event-flow-configuration"><a class="anchor" href="#example-event-flow-configuration"></a>1.5. Example Event Flow Configuration</h3>
<div class="paragraph">
<p>The following example shows a configuration of a service binding event flows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">Unresolved directive in service-bindings.adoc - include::{examples-dir}/ExampleServiceBindingEventFlowsConfiguration.java[]</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<script type="text/javascript" src="js/tocbot/tocbot.min.js"></script>
<script type="text/javascript" src="js/toc.js"></script>
<link rel="stylesheet" href="js/highlight/styles/atom-one-dark-reasonable.min.css">
<script src="js/highlight/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>