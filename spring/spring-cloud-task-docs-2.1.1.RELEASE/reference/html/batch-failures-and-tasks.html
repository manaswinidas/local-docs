<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>12.&nbsp;Batch Job Exit Codes</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Spring Cloud Task Reference Guide"><link rel="up" href="batch.html" title="Part&nbsp;IV.&nbsp;Batch"><link rel="prev" href="batch-informational-messages.html" title="11.&nbsp;Batch Informational Messages"><link rel="next" href="stream-integration.html" title="Part&nbsp;V.&nbsp;Spring Cloud Stream Integration"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">12.&nbsp;Batch Job Exit Codes</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="batch-informational-messages.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;IV.&nbsp;Batch</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="stream-integration.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="batch-failures-and-tasks" href="#batch-failures-and-tasks"></a>12.&nbsp;Batch Job Exit Codes</h2></div></div></div><p>As discussed <a class="link" href="features-lifecycle.html#features-lifecycle-exit-codes" title="7.2&nbsp;Mapping Exit Codes">earlier</a>, Spring Cloud Task
applications support the ability to record the exit code of a task execution. However, in
cases where you run a Spring Batch Job within a task, regardless of how the Batch Job
Execution completes, the result of the task is always zero when using the default
Batch/Boot behavior. Keep in mind that a task is a boot application and that the exit code
returned from the task is the same as a boot application.
To override this behavior and allow the task to return an exit code other than zero when a
batch job returns an
<a class="link" href="https://docs.spring.io/spring-batch/4.0.x/reference/html/step.html#batchStatusVsExitStatus" target="_top">BatchStatus</a>
of <code class="literal">FAILED</code>, set <code class="literal">spring.cloud.task.batch.fail-on-job-failure</code> to <code class="literal">true</code>. Then the exit code
can be 1 (the default) or be based on the
<a class="link" href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-spring-application.html#boot-features-application-exit" target="_top">specified
<code class="literal">ExitCodeGenerator</code></a>)</p><p>This functionality uses a new <code class="literal">CommandLineRunner</code> that replaces the one provided by Spring
Boot. By default, it is configured with the same order. However, if you want to customize
the order in which the <code class="literal">CommandLineRunner</code> is run, you can set its order by setting the
<code class="literal">spring.cloud.task.batch.commandLineRunnerOrder</code> property. To have your task return the
exit code based on the result of the batch job execution, you need to write your own
<code class="literal">CommandLineRunner</code>.</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="batch-informational-messages.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="batch.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="stream-integration.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">11.&nbsp;Batch Informational Messages&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Part&nbsp;V.&nbsp;Spring Cloud Stream Integration</td></tr></table></div></body></html>