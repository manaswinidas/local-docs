<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>15.&nbsp;Spring Batch Events</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Spring Cloud Task Reference Guide"><link rel="up" href="stream-integration.html" title="Part&nbsp;V.&nbsp;Spring Cloud Stream Integration"><link rel="prev" href="stream-integration-events.html" title="14.&nbsp;Spring Cloud Task Events"><link rel="next" href="appendix.html" title="Part&nbsp;VI.&nbsp;Appendices"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">15.&nbsp;Spring Batch Events</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="stream-integration-events.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;V.&nbsp;Spring Cloud Stream Integration</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="appendix.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="stream-integration-batch-events" href="#stream-integration-batch-events"></a>15.&nbsp;Spring Batch Events</h2></div></div></div><p>When executing a Spring Batch job through a task, Spring Cloud Task can be configured to
emit informational messages based on the Spring Batch listeners available in Spring Batch.
Specifically, the following Spring Batch listeners are autoconfigured into each batch job
and emit messages on the associated Spring Cloud Stream channels when run through Spring
Cloud Task:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">JobExecutionListener</code> listens for <code class="literal">job-execution-events</code></li><li class="listitem"><code class="literal">StepExecutionListener</code> listens for <code class="literal">step-execution-events</code></li><li class="listitem"><code class="literal">ChunkListener</code> listens for <code class="literal">chunk-events</code></li><li class="listitem"><code class="literal">ItemReadListener</code> listens for <code class="literal">item-read-events</code></li><li class="listitem"><code class="literal">ItemProcessListener</code> listens for <code class="literal">item-process-events</code></li><li class="listitem"><code class="literal">ItemWriteListener</code> listens for <code class="literal">item-write-events</code></li><li class="listitem"><code class="literal">SkipListener</code> listens for <code class="literal">skip-events</code></li></ul></div><p>These listeners are autoconfigured into any <code class="literal">AbstractJob</code> when the appropriate
beans (a <code class="literal">Job</code> and a <code class="literal">TaskLifecycleListener</code>) exist in the context. Configuration to
listen to these events is handled the same way binding to any other Spring
Cloud Stream channel is done.  Our task (the one running the batch job) serves as a
<code class="literal">Source</code>, with the listening applications serving as either a <code class="literal">Processor</code> or a <code class="literal">Sink</code>.</p><p>An example could be to have an application listening to the <code class="literal">job-execution-events</code> channel
for the start and stop of a job. To configure the listening application, you would
configure the input to be <code class="literal">job-execution-events</code> as follows:</p><p><code class="literal">spring.cloud.stream.bindings.input.destination=job-execution-events</code></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>A binder implementation is also required to be on the classpath.</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>A sample batch event application can be found in the samples module
of the Spring Cloud Task Project,
<a class="link" href="https://github.com/spring-cloud/spring-cloud-task/tree/master/spring-cloud-task-samples/batch-events" target="_top">here</a>.</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_sending_batch_events_to_different_channels" href="#_sending_batch_events_to_different_channels"></a>15.1&nbsp;Sending Batch Events to Different Channels</h2></div></div></div><p>One of the options that Spring Cloud Task offers for batch events is the ability to alter
the channel to which a specific listener can emit its messages. To do so, use the
following configuration:
<code class="literal">spring.cloud.stream.bindings.&lt;the channel&gt;.destination=&lt;new destination&gt;</code>. For example,
if <code class="literal">StepExecutionListener</code> needs to emit its messages to another channel called
<code class="literal">my-step-execution-events</code> instead of the default <code class="literal">step-execution-events</code>, you can add the
following configuration:</p><p><code class="literal">spring.cloud.stream.bindings.step-execution-events.destination=my-step-execution-events</code></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_disabling_batch_events" href="#_disabling_batch_events"></a>15.2&nbsp;Disabling Batch Events</h2></div></div></div><p>To disable the listener functionality for all batch events, use the following
configuration:</p><p><code class="literal">spring.cloud.task.batch.events.enabled=false</code></p><p>To disable a specific batch event, use the following configuration:</p><p><code class="literal">spring.cloud.task.batch.events.&lt;batch event listener&gt;.enabled=false</code>:</p><p>The following listing shows individual listeners that you can disable:</p><pre class="programlisting">spring.cloud.task.batch.events.job-execution.enabled=false
spring.cloud.task.batch.events.step-execution.enabled=false
spring.cloud.task.batch.events.chunk.enabled=false
spring.cloud.task.batch.events.item-<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">read</span>.enabled=false
spring.cloud.task.batch.events.item-process.enabled=false
spring.cloud.task.batch.events.item-write.enabled=false
spring.cloud.task.batch.events.skip.enabled=false</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_emit_order_for_batch_events" href="#_emit_order_for_batch_events"></a>15.3&nbsp;Emit Order for Batch Events</h2></div></div></div><p>By default, batch events have <code class="literal">Ordered.LOWEST_PRECEDENCE</code>. To change this value (for
example, to 5 ), use the following configuration:</p><pre class="programlisting">spring.cloud.task.batch.events.job-execution-order=<span class="hl-number">5</span>
spring.cloud.task.batch.events.step-execution-order=<span class="hl-number">5</span>
spring.cloud.task.batch.events.chunk-order=<span class="hl-number">5</span>
spring.cloud.task.batch.events.item-<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">read</span>-order=<span class="hl-number">5</span>
spring.cloud.task.batch.events.item-process-order=<span class="hl-number">5</span>
spring.cloud.task.batch.events.item-write-order=<span class="hl-number">5</span>
spring.cloud.task.batch.events.skip-order=<span class="hl-number">5</span></pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="stream-integration-events.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="stream-integration.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="appendix.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">14.&nbsp;Spring Cloud Task Events&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Part&nbsp;VI.&nbsp;Appendices</td></tr></table></div></body></html>