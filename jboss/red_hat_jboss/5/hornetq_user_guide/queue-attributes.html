<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 23. Queue Attributes</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="queue-attributes">
      ⁠</a>Chapter 23. Queue Attributes</h1></div></div></div><div class="para">
		Queue attributes can be set in one of two ways; by configuring them using the configuration file or by using the core API. This chapter will explain how to configure each attribute and what effect the attribute has.
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="predefined.queues">
      ⁠</a>23.1. Predefined Queues</h1></div></div></div><div class="para">
			Queues can be predefined through configuration at a core level or at a JMS level. First look at a JMS level.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">JMS Level</div>
				The following shows a queue predefined in the <code class="filename"><em class="replaceable">JBOSS_DIST</em>/jboss-as/server/<em class="replaceable">&lt;PROFILE&gt;</em>/deploy/hornetq/hornetq-jms.xml</code> configuration file.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;queue</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"selectorQueue"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;entry</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"/queue/selectorQueue"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;selector</span><span xmlns="" class="perl_Others"> string=</span><span xmlns="" class="perl_String">"color='red'"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;durable&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/durable&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/queue&gt;</span></pre><div class="para">
			This <span class="property">name</span> attribute of <span class="markup">&lt;queue&gt;</span> defines the name of the queue. When doing this at a JMS level a naming convention is followed so the actual name of the core queue will be <code class="literal">jms.queue.selectorQueue</code>.
		</div><div class="para">
			The mandatory <span class="markup">&lt;entry&gt;</span> element configures the name used to bind the queue to JNDI. &lt;queue&gt; can contain multiple &lt;entry&gt; elements to bind the same queue to different names.
		</div><div class="para">
			The optional <span class="markup">&lt;selector&gt;</span> element defines what JMS message selector the predefined queue will have. Only messages that match the selector will be added to the queue. When omitted from the <span class="markup">&lt;queue&gt;</span> the default value is <code class="literal">null</code>.
		</div><div class="para">
			The optional <span class="markup">&lt;durable&gt;</span> element specifies whether the queue is persisted. When omitted from the <span class="markup">&lt;queue&gt;</span> the default value is <code class="literal">true</code>.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Core Level</div>
				A queue can be predefined at a core level in the <code class="filename"><em class="replaceable">&lt;JBOSS_HOME&gt;</em>/jboss-as/server/<em class="replaceable">&lt;PROFILE&gt;</em>/deploy/hornetq/hornetq-configuration.xml</code> file.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;queues&gt;</span>     
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;queue</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jms.queue.selectorQueue"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;address&gt;</span>jms.queue.selectorQueue<span xmlns="" class="perl_Keyword">&lt;/address&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;filter</span><span xmlns="" class="perl_Others"> string=</span><span xmlns="" class="perl_String">"color='red'"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;durable&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/durable&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/queues&gt;</span></pre><div class="para">
			This is very similar to the JMS configuration, with the following exceptions:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
					The name attribute of queue is the actual name used for the queue with no naming convention as in JMS.
				</div></li><li class="listitem"><div class="para">
					The address element defines what address is used for routing messages.
				</div></li><li class="listitem"><div class="para">
					There is no entry element.
				</div></li><li class="listitem"><div class="para">
					The filter uses the <span class="emphasis"><em>Core filter syntax</em></span> (described in <a class="xref" href="filter-expressions.html">Chapter 12, <em>Filter Expressions</em></a>), <span class="emphasis"><em>not</em></span> the JMS selector syntax.
				</div></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139905860737104">
      ⁠</a>23.2. Using the API</h1></div></div></div><div class="para">
			Queues can also be created using the core API or the management API.
		</div><div class="para">
			For the core API, queues can be created via the <code class="literal">org.hornetq.api.core.client.ClientSession</code> interface. There are multiple <code class="literal">createQueue</code> methods that support setting all of the previously mentioned attributes. There is one extra attribute that can be set via this API which is <code class="literal">temporary</code>. Setting this to <code class="literal">true</code> means the queue will be deleted once the session is disconnected.
		</div><div class="para">
			Take a look at <a class="xref" href="management.html">Chapter 28, <em>Management</em></a> for a description of the management API for creating queues.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Configuring_Queues_Through_Address_Settings">
      ⁠</a>23.3. Configuring Queues Through Address Settings</h1></div></div></div><div class="para">
			There are some attributes that are defined against an address wildcard rather than a specific queue. Here is an example of an <code class="literal">address-setting</code> entry that would be found in the <code class="filename"><em class="replaceable">&lt;JBOSS_HOME&gt;</em>/jboss-as/server/<em class="replaceable">&lt;PROFILE&gt;</em>/deploy/hornetq/hornetq-configuration.xml</code> file.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;address-settings&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;address-setting</span><span xmlns="" class="perl_Others"> match=</span><span xmlns="" class="perl_String">"jms.queue.exampleQueue"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;dead-letter-address&gt;</span>jms.queue.deadLetterQueue<span xmlns="" class="perl_Keyword">&lt;/dead-letter-address&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;max-delivery-attempts&gt;</span>3<span xmlns="" class="perl_Keyword">&lt;/max-delivery-attempts&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;redelivery-delay&gt;</span>5000<span xmlns="" class="perl_Keyword">&lt;/redelivery-delay&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;expiry-address&gt;</span>jms.queue.expiryQueue<span xmlns="" class="perl_Keyword">&lt;/expiry-address&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;last-value-queue&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/last-value-queue&gt;</span>        
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;max-size-bytes&gt;</span>100000<span xmlns="" class="perl_Keyword">&lt;/max-size-bytes&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;page-size-bytes&gt;</span>20000<span xmlns="" class="perl_Keyword">&lt;/page-size-bytes&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;redistribution-delay&gt;</span>0<span xmlns="" class="perl_Keyword">&lt;/redistribution-delay&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;send-to-dla-on-no-route&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/send-to-dla-on-no-route&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;address-full-policy&gt;</span>PAGE<span xmlns="" class="perl_Keyword">&lt;/address-full-policy&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/address-setting&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/address-settings&gt;</span></pre><div class="para">
			Address settings allow you to provide a block of settings which will be applied against any addresses that match the string in the <code class="literal">match</code> attribute. In the above example the settings would only be applied to any addresses which exactly match the address <code class="literal">jms.queue.exampleQueue</code>, but you can also use wildcards to apply sets of configuration against many addresses. The wildcard syntax used is described in <a class="xref" href="wildcard-syntax.html">Chapter 11, <em>Understanding the HornetQ Wildcard Syntax</em></a>
		</div><div class="para">
			For example, if you used the <code class="literal">match</code> string <code class="literal">jms.queue.#</code> the settings would be applied to all addresses which start with <code class="literal">jms.queue.</code> which would be all JMS queues.
		</div><div class="para">
			The meaning of the specific settings are explained fully throughout the user manual, however here is a brief description with a link to the appropriate chapter if available.
		</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"> <code class="literal">max-delivery-attempts</code> </span></dt><dd><div class="para">
						Defines how many times a canceled message can be redelivered before sending it to the <code class="literal">dead-letter-address</code>. A full explanation can be found in <a class="xref" href="undelivered-messages.html#undelivered-messages.configuring">Section 19.2.1, “Configuring Dead Letter Addresses”</a>.
					</div></dd><dt><span class="term"> <code class="literal">redelivery-delay</code> </span></dt><dd><div class="para">
						Defines how long to wait before attempting redelivery of a canceled message. Refer to <a class="xref" href="undelivered-messages.html#undelivered-messages.delay">Section 19.1.1, “Configuring Delayed Redelivery”</a>.
					</div></dd><dt><span class="term"> <code class="literal">expiry-address</code> </span></dt><dd><div class="para">
						Defines where to send a message that has expired. Refer to <a class="xref" href="message-expiry.html#message-expiry.configuring">Section 20.2, “Configuring Expiry Addresses”</a>.
					</div></dd><dt><span class="term"> <code class="literal">last-value-queue</code> </span></dt><dd><div class="para">
						Defines whether a queue only uses last values or not. Refer to <a class="xref" href="last-value-queues.html">Chapter 25, <em>Last-Value Queues</em></a>.
					</div></dd><dt><span class="term"><code class="literal">max-size-bytes</code> and <code class="literal">page-size-bytes</code></span></dt><dd><div class="para">
						Are used to set paging on an address. This is explained in <a class="xref" href="paging.html">Chapter 22, <em>Paging</em></a>.
					</div></dd><dt><span class="term"> <code class="literal">redistribution-delay</code> </span></dt><dd><div class="para">
						Defines how long to wait when the last consumer is closed on a queue before redistributing any messages. See <a class="xref" href="clusters.html#clusters.message-redistribution">Section 36.6, “Message Redistribution”</a>.
					</div></dd><dt><span class="term"> <code class="literal">send-to-dla-on-no-route</code> </span></dt><dd><div class="para">
						If a message is sent to an address, but the server does not route it to any queues, (for example, there might be no queues bound to that address, or none of the queues have filters that match) then normally that message would be discarded. However if this parameter is set to true for that address, if the message is not routed to any queues it will instead be sent to the dead letter address (DLA) for that address, if it exists.
					</div></dd><dt><span class="term"> <code class="literal">address-full-policy</code> </span></dt><dd><div class="para">
						This attribute can have one of the following values: PAGE, DROP or BLOCK and determines what happens when an address where <code class="literal">max-size-bytes</code> is specified becomes full. The default value is PAGE. If the value is PAGE then further messages will be paged to disk.
					</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
								If the value is DROP then further messages will be silently dropped.
							</div></li><li class="listitem"><div class="para">
								If the value is BLOCK then client message producers will block when they try and send further messages.
							</div></li></ul></div></dd></dl></div><div class="para">
			See the following chapters for more info <a class="xref" href="flow-control.html">Chapter 17, <em>Flow Control</em></a>, <a class="xref" href="paging.html">Chapter 22, <em>Paging</em></a>.
		</div></div></div></body></html>