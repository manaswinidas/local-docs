<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 12.  SOAP Message Logging</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idm139976659226176">
      ⁠</a>Chapter 12.  SOAP Message Logging </h1></div></div></div><div class="para">
		The <code class="filename">cxf-extension-jbossws.xml</code> file contains the JBossWS extensions to the Apache CXF stack. You need to manually add this file and link it in the <code class="filename">cxf.extensions</code> file. In <code class="filename">cxf-extension-jbossws-xml</code> you need to enable:
	</div><pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;cxf:bus&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;cxf:inInterceptors&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;ref</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"logInbound"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/cxf:inInterceptors&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;cxf:outInterceptors&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;ref</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"logOutbound"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/cxf:outInterceptors&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;cxf:inFaultInterceptors&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;ref</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"logOutbound"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/cxf:inFaultInterceptors&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/cxf:bus&gt;</span>
</pre><div class="para">
		Once you've uncommented the <code class="filename">cxf-extension-jbossws.xml</code> contents, you need to re-pack the jar or zip. Alternatively, Apache CXF offers multiple ways of configuring SOAP message logging; for programmatic configuration, the below annotations can be used on either the SEI or the SEI implementation class. If placed on the SEI, they activate logging both for client and server; if on the SEI implementation class, they are relevant just for server-side logging.
	</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>@javax.<span xmlns="" class="perl_Function">jws</span>.<span xmlns="" class="perl_Function">WebService</span>(portName = <span xmlns="" class="perl_String">"MyWebServicePort"</span>, serviceName = <span xmlns="" class="perl_String">"MyWebService"</span>, ...)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Features</span>(features = <span xmlns="" class="perl_String">"org.apache.cxf.feature.LoggingFeature"</span>)        
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> MyWebServicePortTypeImpl <span xmlns="" class="perl_Keyword">implements</span> MyWebServicePortType {
<span xmlns="" class="line">​</span>
</pre><div class="para">
		Or equivalent:
	</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.apache.cxf.interceptor.InInterceptors;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.apache.cxf.interceptor.OutInterceptors;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@javax.<span xmlns="" class="perl_Function">jws</span>.<span xmlns="" class="perl_Function">WebService</span>(portName = <span xmlns="" class="perl_String">"WebServicePort"</span>, serviceName = <span xmlns="" class="perl_String">"WebServiceService"</span>, ...)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">InInterceptors</span>(interceptors = <span xmlns="" class="perl_String">"org.apache.cxf.interceptor.LoggingInInterceptor"</span>)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">OutInterceptors</span>(interceptors = <span xmlns="" class="perl_String">"org.apache.cxf.interceptor.LoggingOutInterceptor"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> WebServicePortTypeImpl <span xmlns="" class="perl_Keyword">implements</span> WebServicePortType {
</pre><div class="para">
		For programmatic client-side logging, the following code snippet can be used as an example:
	</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.apache.cxf.endpoint.Client;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.apache.cxf.frontend.ClientProxy;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.apache.cxf.interceptor.LoggingInInterceptor;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.apache.cxf.interceptor.LoggingOutInterceptor;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> WSClient {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">static</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">main</span> (String[] args) {
<span xmlns="" class="line">​</span>        MyService ws = <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">MyService</span>();
<span xmlns="" class="line">​</span>        MyPortType port = ws.<span xmlns="" class="perl_Function">getPort</span>();
<span xmlns="" class="line">​</span>        
<span xmlns="" class="line">​</span>        Client client = ClientProxy.<span xmlns="" class="perl_Function">getClient</span>(port);
<span xmlns="" class="line">​</span>        client.<span xmlns="" class="perl_Function">getInInterceptors</span>().<span xmlns="" class="perl_Function">add</span>(<span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">LoggingInInterceptor</span>());
<span xmlns="" class="line">​</span>        client.<span xmlns="" class="perl_Function">getOutInterceptors</span>().<span xmlns="" class="perl_Function">add</span>(<span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">LoggingOutInterceptor</span>()); 
<span xmlns="" class="line">​</span>        
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">// make WS calls...</span>
</pre><div class="para">
		Finally, you can also enable message logging using the Logging feature.
	</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;beans</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://www.springframework.org/schema/beans"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xmlns:cxf=</span><span xmlns="" class="perl_String">"http://cxf.apache.org/core"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xsi:schemaLocation=</span><span xmlns="" class="perl_String">"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">http://cxf.apache.org/core http://cxf.apache.org/schemas/core.xsd</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;cxf:bus&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;cxf:features&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;cxf:logging/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/cxf:features&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/cxf:bus&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/beans&gt;</span>
</pre><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139976639658544">
      ⁠</a>12.1.  Debugging Tools </h1></div></div></div><div class="para">
			Here is a list of tools that can be used to capture exchanged messages:
		</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"> <a href="https://tcpmon.dev.java.net/">Tcpmon</a> </span></dt><dd><div class="para">
						TCPMon allows you to easily view messages as they go back and forth on the wire.
					</div></dd><dt><span class="term"> <a href="https://wsmonitor.dev.java.net/">WSMonitor</a> </span></dt><dd><div class="para">
						WSMonitor is another option to Tcpmon with slightly more functionality.
					</div></dd><dt><span class="term"> <a href="http://www.soapui.org/">SOAP UI</a> </span></dt><dd><div class="para">
						<acronym class="acronym">SOAP UI</acronym> can also be used for debugging. In addition to viewing messages, it allows you send messages and load test your services. It also has plug-ins for Eclipse, <acronym class="acronym">IDEA</acronym> and NetBeans.
					</div></dd><dt><span class="term"> <a href="http://www.wireshark.org/">Wireshark</a> </span></dt><dd><div class="para">
						<span class="package">Wireshark</span>, a network packet analyzer, is useful for following the routing of <acronym class="acronym">SOAP</acronym> messages. It can also help when you are getting an HTML error message from the server that your CXF client cannot normally process, by allowing you to see the non-SOAP error message.
					</div></dd></dl></div></div></div></body></html>