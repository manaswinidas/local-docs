<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 8.  WS-Reliable Messaging Tutorial</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="WS_RM_Messaging_Tutorial">
      ⁠</a>Chapter 8.  WS-Reliable Messaging Tutorial </h1></div></div></div><div class="para">
		In this sample we show you how to create client and endpoint communication using WS-Reliable Messaging 1.0.  Creating the WS-RM based service and client is very simple. The user needs to create regular JAX-WS service and client first. The last step is to configure WS-RM.
	</div><div class="para">
		We will start with the following endpoint implementation:
	</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>package org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">test</span>.<span xmlns="" class="perl_Function">ws</span>.<span xmlns="" class="perl_Function">jaxws</span>.<span xmlns="" class="perl_Function">samples</span>.<span xmlns="" class="perl_Function">wsrm</span>.<span xmlns="" class="perl_Function">service</span>;
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.jws.Oneway;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.jws.WebMethod;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.jws.WebService;</span>
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span>@WebService
<span xmlns="" class="line">​</span>(
<span xmlns="" class="line">​</span>   name = <span xmlns="" class="perl_String">"SimpleService"</span>,
<span xmlns="" class="line">​</span>   serviceName = <span xmlns="" class="perl_String">"SimpleService"</span>,
<span xmlns="" class="line">​</span>   targetNamespace = <span xmlns="" class="perl_String">"http://www.jboss.org/jbossws/ws-extensions/wsrm"</span>
<span xmlns="" class="line">​</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> SimpleServiceImpl
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   @Oneway
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">ping</span>()
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      System.<span xmlns="" class="perl_Function">out</span>.<span xmlns="" class="perl_Function">println</span>(<span xmlns="" class="perl_String">"ping()"</span>);
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">echo</span>(String s)
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      System.<span xmlns="" class="perl_Function">out</span>.<span xmlns="" class="perl_Function">println</span>(<span xmlns="" class="perl_String">"echo("</span> + s + <span xmlns="" class="perl_String">")"</span>);
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">return</span> s;
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}
</pre><div class="para">
		Let us say that compiled endpoint class is in directory <code class="filename">/home/username/wsrm/cxf/classes</code>. Our next step is to generate JAX-WS artifacts and WSSDL.
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139976639935184">
      ⁠</a>8.1.  Generating WSDL and JAX-WS Endpoint Artifacts </h1></div></div></div><div class="para">
			We will use the <code class="command">wsprovide</code> command line tool to generate WSDL and JAX-WS artifacts. Here's the command:
		</div><pre class="programlisting">
cd $JBOSS_HOME/bin
./wsprovide.sh --keep --wsdl \ 
   --classpath=/home/username/wsrm/cxf/classes \
   --output=/home/username/wsrm/cxf/wsprovide/generated/classes \
   --resource=/home/username/wsrm/cxf/wsprovide/generated/wsdl \
   --source=/home/username/wsrm/cxf/wsprovide/generated/src \
   org.jboss.test.ws.jaxws.samples.wsrm.service.SimpleServiceImpl
</pre><div class="para">
			The above command generates the following artifacts:
		</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"> Compiled classes</span></dt><dd><div class="para">
						Echo.class
					</div><div class="para">
						Echo response.class
					</div><div class="para">
						Ping.class
					</div></dd><dt><span class="term"> Java sources </span></dt><dd><div class="para">
						Echo.java
					</div><div class="para">
						EchoResponse.java
					</div><div class="para">
						Ping.java
					</div></dd><dt><span class="term"> Contract artifacts </span></dt><dd><div class="para">
						SimpleService.wsdl
					</div></dd></dl></div><div class="para">
			The artifacts generated above will be part of the endpoint archive, but before we create the endpoint archive we need to reference generated WSDL from the endpoint. To achieve that we will use the <code class="varname">wsdlLocation</code> annotation attribute. Here's the updated endpoint implementation before it is packaged to the <code class="filename">war</code> file:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span>package org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">test</span>.<span xmlns="" class="perl_Function">ws</span>.<span xmlns="" class="perl_Function">jaxws</span>.<span xmlns="" class="perl_Function">samples</span>.<span xmlns="" class="perl_Function">wsrm</span>.<span xmlns="" class="perl_Function">service</span>;
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.jws.Oneway;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.jws.WebMethod;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.jws.WebService;</span>
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span>@WebService
<span xmlns="" class="line">​</span>(
<span xmlns="" class="line">​</span>   name = <span xmlns="" class="perl_String">"SimpleService"</span>,
<span xmlns="" class="line">​</span>   serviceName = <span xmlns="" class="perl_String">"SimpleService"</span>,
<span xmlns="" class="line">​</span>   wsdlLocation = <span xmlns="" class="perl_String">"WEB-INF/wsdl/SimpleService.wsdl"</span>,
<span xmlns="" class="line">​</span>   targetNamespace = <span xmlns="" class="perl_String">"http://www.jboss.org/jbossws/ws-extensions/wsrm"</span>
<span xmlns="" class="line">​</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> SimpleServiceImpl
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   @Oneway
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">ping</span>()
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      System.<span xmlns="" class="perl_Function">out</span>.<span xmlns="" class="perl_Function">println</span>(<span xmlns="" class="perl_String">"ping()"</span>);
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">echo</span>(String s)
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      System.<span xmlns="" class="perl_Function">out</span>.<span xmlns="" class="perl_Function">println</span>(<span xmlns="" class="perl_String">"echo("</span> + s + <span xmlns="" class="perl_String">")"</span>);
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">return</span> s;
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}
</pre><div class="para">
			The created endpoint war archive consists of the following entries:
		</div><pre class="screen">
jar -tvf jaxws-samples-wsrm.war 
     0 Wed Apr 16 14:39:22 CEST 2008 META-INF/
   106 Wed Apr 16 14:39:20 CEST 2008 META-INF/MANIFEST.MF
     0 Wed Apr 16 14:39:22 CEST 2008 WEB-INF/
   591 Wed Apr 16 14:39:20 CEST 2008 WEB-INF/web.xml
     0 Wed Apr 16 14:39:22 CEST 2008 WEB-INF/classes/
     0 Wed Apr 16 14:39:18 CEST 2008 WEB-INF/classes/org/
     0 Wed Apr 16 14:39:18 CEST 2008 WEB-INF/classes/org/jboss/
     0 Wed Apr 16 14:39:18 CEST 2008 WEB-INF/classes/org/jboss/test/
     0 Wed Apr 16 14:39:18 CEST 2008 WEB-INF/classes/org/jboss/test/ws/
     0 Wed Apr 16 14:39:20 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/
     0 Wed Apr 16 14:39:20 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/
     0 Wed Apr 16 14:39:18 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/wsrm/
     0 Wed Apr 16 14:39:18 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/wsrm/service/
     0 Wed Apr 16 14:39:18 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/wsrm/service/jaxws/
  1235 Wed Apr 16 14:39:18 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/wsrm/service/SimpleServiceImpl.class
   997 Wed Apr 16 14:39:18 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/wsrm/service/jaxws/Echo.class
  1050 Wed Apr 16 14:39:18 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/wsrm/service/jaxws/EchoResponse.class
   679 Wed Apr 16 14:39:18 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/wsrm/service/jaxws/Ping.class
     0 Wed Apr 16 14:39:22 CEST 2008 WEB-INF/wsdl/
  2799 Wed Apr 16 14:39:20 CEST 2008 WEB-INF/wsdl/SimpleService.wsdl
</pre><div class="para">
			The content of <code class="filename">web.xml</code> file is:
		</div><pre class="screen XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;web-app</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">   version=</span><span xmlns="" class="perl_String">"2.5"</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://java.sun.com/xml/ns/javaee"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">   xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">   xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;servlet&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>SimpleService<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;servlet-class&gt;</span>org.jboss.test.ws.jaxws.samples.wsrm.service.SimpleServiceImpl<span xmlns="" class="perl_Keyword">&lt;/servlet-class&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/servlet&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;servlet-mapping&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>SimpleService<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;url-pattern&gt;</span>/*<span xmlns="" class="perl_Keyword">&lt;/url-pattern&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/servlet-mapping&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/web-app&gt;</span>
</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139976651258208">
      ⁠</a>8.2. Generating JAX-WS Client Artifacts</h1></div></div></div><div class="para">
			Before we write the regular JAX-WS client we need to generate client artifacts from WSDL. Here's the command to achieve that:
		</div><pre class="screen">
cd $JBOSS_HOME/bin
./wsconsume.sh --keep \          
   --package=org.jboss.test.ws.jaxws.samples.wsrm.generated \
   --output=/home/username/wsrm/cxf/wsconsume/generated/classes \
   --source=/home/username/wsrm/cxf/wsconsume/generated/src \
   /home/username/wsrm/cxf/wsprovide/generated/wsdl/SimpleService.wsdl
</pre><div class="para">
			The artifacts that have been generated are below.
		</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"> Compiled classes </span></dt><dd><div class="para">
						Echo.class
					</div><div class="para">
						ObjectFactory.class
					</div><div class="para">
						Ping.class
					</div><div class="para">
						SimpleService_Service.class
					</div><div class="para">
						EchoResponse.class
					</div><div class="para">
						package-info.class
					</div><div class="para">
						SimpleService.class
					</div><div class="para">
						SimpleService_SimpleServicePort_Client.class
					</div></dd><dt><span class="term"> Java sources </span></dt><dd><div class="para">
						Echo.java
					</div><div class="para">
						ObjectFactory.java
					</div><div class="para">
						Ping.java
					</div><div class="para">
						SimpleService_Service.java
					</div><div class="para">
						EchoResponse.java
					</div><div class="para">
						package-info.java
					</div><div class="para">
						SimpleService.java
					</div><div class="para">
						SimpleService_SimpleServicePort_Client.java
					</div></dd></dl></div><div class="para">
			The last step is to write the regular JAX-WS client using generated artifacts.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title"> Writing Regular JAX-WS Client </div>
				The following is the regular JAX-WS client using generated artifacts:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>package org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">test</span>.<span xmlns="" class="perl_Function">ws</span>.<span xmlns="" class="perl_Function">jaxws</span>.<span xmlns="" class="perl_Function">samples</span>.<span xmlns="" class="perl_Function">wsrm</span>.<span xmlns="" class="perl_Function">client</span>;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import java.net.URL;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.xml.namespace.QName;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.xml.ws.Service;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.test.ws.jaxws.samples.wsrm.generated.SimpleService;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">final</span> <span xmlns="" class="perl_Keyword">class</span> SimpleServiceTestCase
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">static</span> <span xmlns="" class="perl_DataType">final</span> String serviceURL = <span xmlns="" class="perl_String">"http://localhost:8080/jaxws-samples-wsrm/SimpleService"</span>;
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">static</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">main</span>(String[] args) <span xmlns="" class="perl_Keyword">throws</span> Exception
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Comment">// create service</span>
<span xmlns="" class="line">​</span>      QName serviceName = <span xmlns="" class="perl_Keyword">new</span> QName(<span xmlns="" class="perl_String">"http://www.jboss.org/jbossws/ws-extensions/wsrm"</span>, <span xmlns="" class="perl_String">"SimpleService"</span>);
<span xmlns="" class="line">​</span>      URL wsdlURL = <span xmlns="" class="perl_Keyword">new</span> URL(serviceURL + <span xmlns="" class="perl_String">"?wsdl"</span>);
<span xmlns="" class="line">​</span>      Service service = Service.<span xmlns="" class="perl_Function">create</span>(wsdlURL, serviceName);
<span xmlns="" class="line">​</span>      SimpleService proxy = (SimpleService)service.<span xmlns="" class="perl_Function">getPort</span>(SimpleService.<span xmlns="" class="perl_Function">class</span>);
<span xmlns="" class="line">​</span>      
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Comment">// invoke methods</span>
<span xmlns="" class="line">​</span>      proxy.<span xmlns="" class="perl_Function">ping</span>(); <span xmlns="" class="perl_Comment">// one way call</span>
<span xmlns="" class="line">​</span>      proxy.<span xmlns="" class="perl_Function">echo</span>(<span xmlns="" class="perl_String">"Hello World!"</span>); <span xmlns="" class="perl_Comment">// request responce call</span>
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span>}
</pre><div class="para">
			Now we have both endpoint and client implementations but without WS-Reliable Messaging in place. Our next goal is to turn on the WS-RM feature.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139976665704768">
      ⁠</a>8.3.  Turning on WS-RM 1.0 </h1></div></div></div><div class="para">
			Four steps are necessary to turn on WS-RM in JBossWS-CXF. They are outline below.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					Extend WSDL with WS-Policy containing both WSRM and WS-Addressing policy.
				</div></li><li class="listitem"><div class="para">
					Provide <code class="filename">jbossws-cxf.xml</code> endpoint configuration file.
				</div></li><li class="listitem"><div class="para">
					Provide client CXF configuration.
				</div></li><li class="listitem"><div class="para">
					Update client code to read CXF configuration file.
				</div></li></ul></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title"> Extending WSDL Using WS-Policy </div>
				To activate WSRM we need to extend WSDL with WSRM and addressing policy. Here is how it looks:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;wsdl:definitions</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"SimpleService"</span><span xmlns="" class="perl_Others"> targetNamespace=</span><span xmlns="" class="perl_String">"http://www.jboss.org/jbossws/ws-extensions/wsrm"</span><span xmlns="" class="perl_Others"> xmlns:tns=</span><span xmlns="" class="perl_String">"http://www.jboss.org/jbossws/ws-extensions/wsrm"</span><span xmlns="" class="perl_Others"> xmlns:xsd=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema"</span><span xmlns="" class="perl_Others"> xmlns:soap=</span><span xmlns="" class="perl_String">"http://schemas.xmlsoap.org/wsdl/soap/"</span><span xmlns="" class="perl_Others"> xmlns:wsdl=</span><span xmlns="" class="perl_String">"http://schemas.xmlsoap.org/wsdl/"</span><span xmlns="" class="perl_Others"> xmlns:wsp=</span><span xmlns="" class="perl_String">"http://www.w3.org/2006/07/ws-policy"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- - - - - - - - - - - - - - - - - - - - - - - - - - --&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- Created WS-Policy with WSRM addressing assertions --&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- - - - - - - - - - - - - - - - - - - - - - - - - - --&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;wsp:UsingPolicy/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;wsp:Policy</span><span xmlns="" class="perl_Others"> wsu:Id=</span><span xmlns="" class="perl_String">"wsrm10policy"</span><span xmlns="" class="perl_Others"> xmlns:wsu=</span><span xmlns="" class="perl_String">"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;wswa:UsingAddressing</span><span xmlns="" class="perl_Others"> xmlns:wswa=</span><span xmlns="" class="perl_String">"http://www.w3.org/2006/05/addressing/wsdl"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;wsp:Policy/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;wswa:UsingAddressing&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;wsrmp:RMAssertion</span><span xmlns="" class="perl_Others"> xmlns:wsrmp=</span><span xmlns="" class="perl_String">"http://schemas.xmlsoap.org/ws/2005/02/rm/policy"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/wsp:Policy&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;wsdl:types&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;xsd:schema</span><span xmlns="" class="perl_Others"> xmlns:xsd=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema"</span><span xmlns="" class="perl_Others"> xmlns:tns=</span><span xmlns="" class="perl_String">"http://www.jboss.org/jbossws/ws-extensions/wsrm"</span><span xmlns="" class="perl_Others"> attributeFormDefault=</span><span xmlns="" class="perl_String">"unqualified"</span><span xmlns="" class="perl_Others"> elementFormDefault=</span><span xmlns="" class="perl_String">"unqualified"</span><span xmlns="" class="perl_Others"> targetNamespace=</span><span xmlns="" class="perl_String">"http://www.jboss.org/jbossws/ws-extensions/wsrm"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;xsd:element</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ping"</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"tns:ping"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;xsd:complexType</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ping"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;xsd:sequence/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/xsd:complexType&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;xsd:element</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"echo"</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"tns:echo"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;xsd:complexType</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"echo"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;xsd:sequence&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;xsd:element</span><span xmlns="" class="perl_Others"> minOccurs=</span><span xmlns="" class="perl_String">"0"</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"arg0"</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"xsd:string"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/xsd:sequence&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/xsd:complexType&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;xsd:element</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"echoResponse"</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"tns:echoResponse"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;xsd:complexType</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"echoResponse"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;xsd:sequence&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;xsd:element</span><span xmlns="" class="perl_Others"> minOccurs=</span><span xmlns="" class="perl_String">"0"</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"return"</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"xsd:string"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/xsd:sequence&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/xsd:complexType&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/xsd:schema&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/wsdl:types&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;wsdl:message</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"echoResponse"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;wsdl:part</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"parameters"</span><span xmlns="" class="perl_Others"> element=</span><span xmlns="" class="perl_String">"tns:echoResponse"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/wsdl:part&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/wsdl:message&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;wsdl:message</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"echo"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;wsdl:part</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"parameters"</span><span xmlns="" class="perl_Others"> element=</span><span xmlns="" class="perl_String">"tns:echo"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/wsdl:part&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/wsdl:message&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;wsdl:message</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ping"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;wsdl:part</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"parameters"</span><span xmlns="" class="perl_Others"> element=</span><span xmlns="" class="perl_String">"tns:ping"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/wsdl:part&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/wsdl:message&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;wsdl:portType</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"SimpleService"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;wsdl:operation</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ping"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;wsdl:input</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ping"</span><span xmlns="" class="perl_Others"> message=</span><span xmlns="" class="perl_String">"tns:ping"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/wsdl:input&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/wsdl:operation&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;wsdl:operation</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"echo"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;wsdl:input</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"echo"</span><span xmlns="" class="perl_Others"> message=</span><span xmlns="" class="perl_String">"tns:echo"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/wsdl:input&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;wsdl:output</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"echoResponse"</span><span xmlns="" class="perl_Others"> message=</span><span xmlns="" class="perl_String">"tns:echoResponse"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/wsdl:output&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/wsdl:operation&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/wsdl:portType&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;wsdl:binding</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"SimpleServiceSoapBinding"</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"tns:SimpleService"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- - - - - - - - - - - - - - - - - - - - --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- Associated WS-Policy with the binding --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- - - - - - - - - - - - - - - - - - - - --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;wsp:PolicyReference</span><span xmlns="" class="perl_Others"> URI=</span><span xmlns="" class="perl_String">"#wsrm10policy"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;soap:binding</span><span xmlns="" class="perl_Others"> style=</span><span xmlns="" class="perl_String">"document"</span><span xmlns="" class="perl_Others"> transport=</span><span xmlns="" class="perl_String">"http://schemas.xmlsoap.org/soap/http"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;wsdl:operation</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ping"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;soap:operation</span><span xmlns="" class="perl_Others"> soapAction=</span><span xmlns="" class="perl_String">""</span><span xmlns="" class="perl_Others"> style=</span><span xmlns="" class="perl_String">"document"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;wsdl:input</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ping"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;soap:body</span><span xmlns="" class="perl_Others"> use=</span><span xmlns="" class="perl_String">"literal"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/wsdl:input&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/wsdl:operation&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;wsdl:operation</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"echo"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;soap:operation</span><span xmlns="" class="perl_Others"> soapAction=</span><span xmlns="" class="perl_String">""</span><span xmlns="" class="perl_Others"> style=</span><span xmlns="" class="perl_String">"document"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;wsdl:input</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"echo"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;soap:body</span><span xmlns="" class="perl_Others"> use=</span><span xmlns="" class="perl_String">"literal"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/wsdl:input&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;wsdl:output</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"echoResponse"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;soap:body</span><span xmlns="" class="perl_Others"> use=</span><span xmlns="" class="perl_String">"literal"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/wsdl:output&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/wsdl:operation&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/wsdl:binding&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;wsdl:service</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"SimpleService"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;wsdl:port</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"SimpleServicePort"</span><span xmlns="" class="perl_Others"> binding=</span><span xmlns="" class="perl_String">"tns:SimpleServiceSoapBinding"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;soap:address</span><span xmlns="" class="perl_Others"> location=</span><span xmlns="" class="perl_String">"http://localhost:9090/hello"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/wsdl:port&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/wsdl:service&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/wsdl:definitions&gt;</span>
<span xmlns="" class="line">​</span>
</pre><div class="para">
			We added <code class="classname">wsp:UsingPolicy;</code><code class="classname">wsp:Policy</code> and <code class="classname">wsp:PolicyReference</code> elements to WSDL.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title"> Providing <code class="filename">jbossws-cxf.xml</code> Endpoint Configuration File </div>
				This is the JBossWS CXF integration extension file: <a class="xref" href="CXF_Integration.html">Chapter 3, <em> Server Side Integration Customization </em></a>. In our case, the relevant content is as follows:
			</div><pre class="screen XML"><span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;beans</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns=</span><span xmlns="" class="perl_String">'http://www.springframework.org/schema/beans'</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns:xsi=</span><span xmlns="" class="perl_String">'http://www.w3.org/2001/XMLSchema-instance'</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns:beans=</span><span xmlns="" class="perl_String">'http://www.springframework.org/schema/beans'</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns:jaxws=</span><span xmlns="" class="perl_String">'http://cxf.apache.org/jaxws'</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns:wsp=</span><span xmlns="" class="perl_String">'http://www.w3.org/2006/07/ws-policy'</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns:p=</span><span xmlns="" class="perl_String">'http://cxf.apache.org/policy'</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xsi:schemaLocation=</span><span xmlns="" class="perl_String">'http://www.springframework.org/schema/beans</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://www.springframework.org/schema/beans/spring-beans-2.0.xsd</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://cxf.apache.org/policy</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://cxf.apache.org/schemas/policy.xsd </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://www.w3.org/2006/07/ws-policy</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://www.w3.org/2006/07/ws-policy.xsd</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://cxf.apache.org/jaxws</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://cxf.apache.org/schemas/jaxws.xsd'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;wsp:Policy</span><span xmlns="" class="perl_Others"> wsu:Id=</span><span xmlns="" class="perl_String">"wsrm10policy"</span><span xmlns="" class="perl_Others"> xmlns:wsu=</span><span xmlns="" class="perl_String">"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;wswa:UsingAddressing</span><span xmlns="" class="perl_Others"> xmlns:wswa=</span><span xmlns="" class="perl_String">"http://www.w3.org/2006/05/addressing/wsdl"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;wsrmp:RMAssertion</span><span xmlns="" class="perl_Others"> xmlns:wsrmp=</span><span xmlns="" class="perl_String">"http://schemas.xmlsoap.org/ws/2005/02/rm/policy"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/wsp:Policy&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;jaxws:endpoint</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">    id=</span><span xmlns="" class="perl_String">'SimpleServiceImpl'</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">    address=</span><span xmlns="" class="perl_String">'http://localhost:8080/jaxws-samples-wsrm'</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">    implementor=</span><span xmlns="" class="perl_String">'org.jboss.test.ws.jaxws.samples.wsrm.service.SimpleServiceImpl'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;jaxws:invoker&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">'org.jboss.wsf.stack.cxf.InvokerJSE'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/jaxws:invoker&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;jaxws:features&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;p:policies&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;wsp:PolicyReference</span><span xmlns="" class="perl_Others"> URI=</span><span xmlns="" class="perl_String">"#wsrm10policy"</span><span xmlns="" class="perl_Others"> xmlns:wsp=</span><span xmlns="" class="perl_String">"http://www.w3.org/2006/07/ws-policy"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/p:policies&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/jaxws:features&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/jaxws:endpoint&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/beans&gt;</span>
<span xmlns="" class="line">​</span>
</pre><div class="para">
			We need to include this <code class="filename">jbossws-cxf.xml</code> CXF configuration file in the <code class="filename">WEB-INF</code> directory of the endpoint archive because we are creating a <acronym class="acronym">POJO</acronym> deployment.
		</div><pre class="screen">
jar -tvf jaxws-samples-wsrm.war 
     0 Wed Apr 16 19:05:38 CEST 2008 META-INF/
   106 Wed Apr 16 19:05:36 CEST 2008 META-INF/MANIFEST.MF
     0 Wed Apr 16 19:05:38 CEST 2008 WEB-INF/
   591 Wed Apr 16 19:05:36 CEST 2008 WEB-INF/web.xml
     0 Wed Apr 16 19:05:38 CEST 2008 WEB-INF/classes/
     0 Wed Apr 16 19:05:32 CEST 2008 WEB-INF/classes/org/
     0 Wed Apr 16 19:05:32 CEST 2008 WEB-INF/classes/org/jboss/
     0 Wed Apr 16 19:05:32 CEST 2008 WEB-INF/classes/org/jboss/test/
     0 Wed Apr 16 19:05:32 CEST 2008 WEB-INF/classes/org/jboss/test/ws/
     0 Wed Apr 16 19:05:34 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/
     0 Wed Apr 16 19:05:34 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/
     0 Wed Apr 16 19:05:34 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/wsrm/
     0 Wed Apr 16 19:05:34 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/wsrm/service/
     0 Wed Apr 16 19:05:34 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/wsrm/service/jaxws/
  1235 Wed Apr 16 19:05:34 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/wsrm/service/SimpleServiceImpl.class
   997 Wed Apr 16 19:05:34 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/wsrm/service/jaxws/Echo.class
  1050 Wed Apr 16 19:05:34 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/wsrm/service/jaxws/EchoResponse.class
   679 Wed Apr 16 19:05:34 CEST 2008 WEB-INF/classes/org/jboss/test/ws/jaxws/samples/wsrm/service/jaxws/Ping.class
  1554 Wed Apr 16 19:05:36 CEST 2008 WEB-INF/jbossws-cxf.xml
     0 Wed Apr 16 19:05:38 CEST 2008 WEB-INF/wsdl/
  3237 Wed Apr 16 19:05:36 CEST 2008 WEB-INF/wsdl/SimpleService.wsdl
</pre><div class="para">
			The next step is to create the client CXF configuration file that will be used by the client. It activates the WS-RM protocol for the CXF client. We will name this file <code class="filename">cxf.xml</code> in our sample. The content of this file is as follows:
		</div><pre class="screen XML"><span xmlns="" class="line">​</span>     
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;beans</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns=</span><span xmlns="" class="perl_String">"http://www.springframework.org/schema/beans"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns:cxf=</span><span xmlns="" class="perl_String">"http://cxf.apache.org/core"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns:wsa=</span><span xmlns="" class="perl_String">"http://cxf.apache.org/ws/addressing"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns:http=</span><span xmlns="" class="perl_String">"http://cxf.apache.org/transports/http/configuration"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns:wsrm-policy=</span><span xmlns="" class="perl_String">"http://schemas.xmlsoap.org/ws/2005/02/rm/policy"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns:wsrm-mgr=</span><span xmlns="" class="perl_String">"http://cxf.apache.org/ws/rm/manager"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xsi:schemaLocation=</span><span xmlns="" class="perl_String">"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://cxf.apache.org/core</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://cxf.apache.org/schemas/core.xsd</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://cxf.apache.org/transports/http/configuration</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://cxf.apache.org/schemas/configuration/http-conf.xsd</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://schemas.xmlsoap.org/ws/2005/02/rm/policy</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://schemas.xmlsoap.org/ws/2005/02/rm/wsrm-policy.xsd</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://cxf.apache.org/ws/rm/manager</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://cxf.apache.org/schemas/configuration/wsrm-manager.xsd</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://www.springframework.org/schema/beans</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;cxf:bus&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;cxf:features&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;cxf:logging/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;wsa:addressing/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;wsrm-mgr:reliableMessaging&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;wsrm-policy:RMAssertion&gt;</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;wsrm-policy:BaseRetransmissionInterval</span><span xmlns="" class="perl_Others"> Milliseconds=</span><span xmlns="" class="perl_String">"4000"</span><span xmlns="" class="perl_Keyword">/&gt;</span>           
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;wsrm-policy:AcknowledgementInterval</span><span xmlns="" class="perl_Others"> Milliseconds=</span><span xmlns="" class="perl_String">"2000"</span><span xmlns="" class="perl_Keyword">/&gt;</span>          
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/wsrm-policy:RMAssertion&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;wsrm-mgr:destinationPolicy&gt;</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;wsrm-mgr:acksPolicy</span><span xmlns="" class="perl_Others"> intraMessageThreshold=</span><span xmlns="" class="perl_String">"0"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/wsrm-mgr:destinationPolicy&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/wsrm-mgr:reliableMessaging&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/cxf:features&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/cxf:bus&gt;</span>
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/beans&gt;</span>
<span xmlns="" class="line">​</span>
</pre><div class="para">
			We are almost done. The client configuration needs to be picked up by the client classloader. In order to achieve that the <code class="filename">cxf.xml</code> has to be put in the <code class="filename">META-INF</code> directory of client jar. That jar should then be provided when setting the class loader.
		</div><div class="para">
			Alternatively you can read the bus configuration programmatically.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title"> Updating Client Code to Read Bus Configuration File </div>
				Here's the last piece of the updated CXF client:
			</div><pre class="screen JAVA"><span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>package org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">test</span>.<span xmlns="" class="perl_Function">ws</span>.<span xmlns="" class="perl_Function">jaxws</span>.<span xmlns="" class="perl_Function">samples</span>.<span xmlns="" class="perl_Function">wsrm</span>.<span xmlns="" class="perl_Function">client</span>;
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import java.net.URL;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import java.io.File;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.xml.namespace.QName;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.xml.ws.Service;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.apache.cxf.Bus;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.apache.cxf.BusFactory;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.apache.cxf.bus.spring.SpringBusFactory;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.test.ws.jaxws.samples.wsrm.generated.SimpleService;</span>
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">final</span> <span xmlns="" class="perl_Keyword">class</span> SimpleServiceTestCase
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">static</span> <span xmlns="" class="perl_DataType">final</span> String serviceURL = <span xmlns="" class="perl_String">"http://localhost:8080/jaxws-samples-wsrm/SimpleService"</span>;
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">static</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">main</span>(String[] args) <span xmlns="" class="perl_Keyword">throws</span> Exception
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Comment">// create bus</span>
<span xmlns="" class="line">​</span>      SpringBusFactory busFactory = <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">SpringBusFactory</span>();
<span xmlns="" class="line">​</span>      URL cxfConfig = <span xmlns="" class="perl_Keyword">new</span> File(<span xmlns="" class="perl_String">"resources/jaxws/samples/wsrm/cxf.xml"</span>).<span xmlns="" class="perl_Function">toURL</span>();
<span xmlns="" class="line">​</span>      Bus bus = busFactory.<span xmlns="" class="perl_Function">createBus</span>(cxfConfig);
<span xmlns="" class="line">​</span>      busFactory.<span xmlns="" class="perl_Function">setDefaultBus</span>(bus);
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Comment">// create service</span>
<span xmlns="" class="line">​</span>      QName serviceName = <span xmlns="" class="perl_Keyword">new</span> QName(<span xmlns="" class="perl_String">"http://www.jboss.org/jbossws/ws-extensions/wsrm"</span>, <span xmlns="" class="perl_String">"SimpleService"</span>);
<span xmlns="" class="line">​</span>      URL wsdlURL = <span xmlns="" class="perl_Keyword">new</span> URL(serviceURL + <span xmlns="" class="perl_String">"?wsdl"</span>);
<span xmlns="" class="line">​</span>      Service service = Service.<span xmlns="" class="perl_Function">create</span>(wsdlURL, serviceName);
<span xmlns="" class="line">​</span>      SimpleService proxy = (SimpleService)service.<span xmlns="" class="perl_Function">getPort</span>(SimpleService.<span xmlns="" class="perl_Function">class</span>);
<span xmlns="" class="line">​</span>      
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Comment">// invoke methods</span>
<span xmlns="" class="line">​</span>      proxy.<span xmlns="" class="perl_Function">ping</span>(); <span xmlns="" class="perl_Comment">// one way call</span>
<span xmlns="" class="line">​</span>      proxy.<span xmlns="" class="perl_Function">echo</span>(<span xmlns="" class="perl_String">"Hello World!"</span>); <span xmlns="" class="perl_Comment">// request responce call</span>
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Comment">// shutdown bus</span>
<span xmlns="" class="line">​</span>      bus.<span xmlns="" class="perl_Function">shutdown</span>(<span xmlns="" class="perl_Keyword">true</span>);
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>
</pre></div></div></body></html>