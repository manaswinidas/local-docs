<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 8. Using JBossJTA with JBoss Enterprise Application Platform</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="chap-Transactions_JTA_Programmers_Guide-Using_JBossJTA_in_Application_Servers">
      ⁠</a>Chapter 8. Using JBossJTA with JBoss Enterprise Application Platform</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="form-Transactions_JTA_Programmers_Guide-JBoss_Application_Server-Service_Configuration">
      ⁠</a>8.1. Service Configuration</h1></div></div></div><div class="para">
			Most of the configuration for The JBoss Transaction Service is done using the XML files stored in the <code class="filename">etc</code> directory. Several extra attributes can be configured when it is run as a JBOSS service, however.
		</div><div class="variablelist"><a id="list-JTS-as-server-options">
      ⁠</a><dl class="variablelist"><dt><span class="term">TransactionTimeout</span></dt><dd><div class="para">
						The default transaction timeout to be used for new transactions. An integer value, expressed in seconds.
					</div></dd><dt><span class="term">StatisticsEnabled</span></dt><dd><div class="para">
						Determines whether or not the transaction service should gather statistical information. Viable using the <code class="interfacename">PerformanceStatistics</code> MBean. A Boolean value, whose default is <code class="literal">NO</code>.
					</div></dd><dt><span class="term">PropagateFullContext</span></dt><dd><div class="para">
						Determines whether a full transactional context is propagated by context importer/exporter. If set to <code class="literal">false</code>, only the current transaction context is propagated. If set to <code class="literal">true</code>, the full transaction context is propagated, including any parent transactions.
					</div></dd></dl></div><div class="para">
			These attributes are specified as MBean attributes in the <code class="filename">jboss-service.xml</code> file located in the <code class="filename">server/all/conf</code> directory, See <a class="xref" href="chap-Transactions_JTA_Programmers_Guide-Using_JBossJTA_in_Application_Servers.html#example-jboss-services.xml">Example 8.1, “Example <code class="filename">jboss-services.xml</code>”</a> for an example.
		</div><div class="example"><a id="example-jboss-services.xml">
      ⁠</a><p class="title"><strong>Example 8.1. Example <code class="filename">jboss-services.xml</code></strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;mbean</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"com.arjuna.ats.jbossatx.jts.TransactionManagerService"</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jboss:service=TransactionManager"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"TransactionTimeout"</span><span xmlns="" class="perl_Keyword">&gt;</span>300<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"StatisticsEnabled&gt;true</span><span xmlns="" class="perl_Error">&lt;</span><span xmlns="" class="perl_String">/attribute&gt;&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">  </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Error">&lt;</span><span xmlns="" class="perl_String">/mbean&gt;</span>
<span xmlns="" class="line">​</span>
</pre></div></div><div class="para">
			The transaction service can also be configured via the standard JBoss Transaction Service property files. These are located in the JBoss Transaction Service install location under the <code class="filename">etc</code> directory. You can edit these files manually or through JMX. Each property file is exposed using an object whose name is derived from a combination of <code class="interfacename">com.arjuna.ts.properties</code> and the name of the module containing the attribute to be configured An example is <code class="filename">com.arjuna.ts.properties:module=arjuna</code>.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="form-Transactions_JTA_Programmers_Guide-JBoss_Application_Server-Logging">
      ⁠</a>8.2. Logging</h1></div></div></div><div class="para">
			In order to make JBoss Transaction Service logging semantically consistent with JBoss Enterprise Application Platform, the <code class="systemitem">TransactionManagerService</code> service modifies the level of some log messages by overriding the value of the <span class="property">com.arjuna.common.util.logger</span> property given in the <code class="filename">jbossjta-properties.xml</code> file. Therefore, the value of this property has no effect on the logging behavior when the transaction service is embedded in JBoss Enterprise Application Platform. By forcing use of the <code class="systemitem">log4j_releveler</code> logger, the <code class="systemitem">TransactionManagerService</code> service causes all <code class="literal">INFO</code> level messages in the transaction code to be modified to be shown as <code class="literal">DEBUG</code> messages. As a side effect, these messages do not appear in log files if the filter level is <code class="literal">INFO</code>. All other log messages behave as normal.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="form-Transactions_JTA_Programmers_Guide-JBoss_Application_Server-The_services">
      ⁠</a>8.3. The Services</h1></div></div></div><div class="para">
			The only service provided by the integration with the JBoss Enterprise Application Platform is <code class="systemitem">TransactionManagerService</code>. This service ensures the recovery manager is started, and binds the JBoss Transaction Service JTA transaction manager to the JNDI provider using the name <code class="literal">java:/TransactionManager</code>. This service depends upon the existence of the <code class="literal">CORBA ORB</code> Service and it must be using <code class="literal">JacORB</code> as the underlying <code class="literal">ORB</code> implementation.
		</div><div class="para">
			There are two instances of this service:
		</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Distributed</span></dt><dd><div class="para">
						Uses the JBoss Transaction Service-enabled transaction manager implementation and supports distributed transactions and recovery. Configured with the <code class="classname">com.arjuna.ats.jbossatx.jts.TransactionManagerService</code> class. This is the default configuration.
					</div></dd><dt><span class="term">Local</span></dt><dd><div class="para">
						Uses the purely local JTA implementation. Configured using the <code class="classname">com.arjuna.ats.jbossatx.jta.TransactionManagerService</code> class.
					</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="form-Transactions_JTA_Programmers_Guide-JBoss_Application_Server-Ensuring_Transactional_Context_is_Propagated_to_the_Server">
      ⁠</a>8.4. Ensuring Transactional Context is Propagated to the Server</h1></div></div></div><div class="para">
			Transactions can be coordinated by a coordinator which is external to the server. To ensure that the transaction context is propagated via JRMP invocations to the server, the transaction propagation context factory needs to be explicitly set for the JRMP invoker proxy. Here is an example: <code class="code">JRMPInvokerProxy.setTPCFactory( new com.arjuna.ats.internal.jbossatx.jts.PropagationContextManager() );</code>
		</div></div></div></body></html>