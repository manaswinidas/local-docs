<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 19. Getting Started</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="chap-Transactions_Development_Guide-Getting_Started">
      ⁠</a>Chapter 19. Getting Started</h1></div></div></div><a id="idm140019159359888" class="indexterm"/><a id="idm140019156351392" class="indexterm"/><a id="idm140019179591392" class="indexterm"/><a id="idm140019160431376" class="indexterm"/><a id="idm140019117293216" class="indexterm"/><a id="idm140019114105296" class="indexterm"/><a id="idm140019162377168" class="indexterm"/><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm140019171524768">
      ⁠</a>19.1. Installing the XTS Service Archive into JBoss Transaction Service</h1></div></div></div><div class="para">
			XTS, which is the Web Services component of JBoss Transaction Service, provides WS-AT and WS-BA support for Web Services hosted on the Enterprise Application Platform. The module is packaged as a <em class="firstterm">Service Archive (.sar)</em> located in <code class="filename"><em class="replaceable">$JBOSS_HOME</em>/docs/examples/transactions/</code>. To install it, follow <a class="xref" href="chap-Transactions_Development_Guide-Getting_Started.html#procedure-install-xts">Procedure 19.1, “Installing the XTS Module”</a>.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="procedure-install-xts">
      ⁠</a><p class="title"><strong>Procedure 19.1. Installing the XTS Module</strong></p><ol class="1"><li class="step"><div class="para">
					Create a sub-directory in the <code class="filename"><em class="replaceable">$JBOSS_HOME</em>/server/[<em class="replaceable">name</em>]/deploy/</code> directory, called <code class="filename">jbossxts.sar/</code>.
				</div></li><li class="step"><div class="para">
					Unpack the SAR, which is a ZIP archive, into this new directory.
				</div></li><li class="step"><div class="para">
					Restart JBoss Enterprise Application Platform to activate the module.
				</div></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm140019111795984">
      ⁠</a>19.2. Creating Client Applications</h1></div></div></div><div class="para">
			There are two aspects to a client application using XTS, the transaction declaration aspects, and the business logic. The business logic includes the invocation of Web Services.
		</div><div class="para">
			Transaction declaration aspects are handled automatically with the XTS client API. This API provides simple transaction directives such as <code class="methodname">begin</code>, <code class="methodname">commit</code>, and <code class="methodname">rollback</code>, which the client application can use to initialize, manage, and terminate transactions. Internally, this API uses SOAP to invoke operations on the various WS-C, WS-AT and WS-BA services, in order to create a coordinator and drive the transaction to completion.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm140019156936016">
      ⁠</a>19.2.1. User Transactions</h2></div></div></div><div class="para">
				A client uses the <code class="classname">UserTransactionFactory</code> and <code class="classname">UserTransaction</code> classes to create and manage WS-AT transactions. These classes provide a simple API which operates in a manner similar to the JTA API. A WS-AT transaction is started and associated with the client thread by calling the <code class="methodname">begin</code> method of the <code class="methodname">UserTransaction</code> class. The transaction can be committed by calling the <code class="methodname">commit</code> method, and rolled back by calling the <code class="methodname">rollback</code> method.
			</div><div class="para">
				More complex transaction management, such as suspension and resumption of transactions, is supported by the <code class="classname">TransactionManagerFactory</code> and <code class="classname">TransactionManager</code> classes.
			</div><div class="para">
				Full details of the WS-AT APIs are provided in <a class="xref" href="sec-xts-api.html">Chapter 21, <em>The XTS API</em></a>.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm140019153629344">
      ⁠</a>19.2.2. Business Activities</h2></div></div></div><div class="para">
				A client creates and manages Business Activities using the <code class="classname">UserBusinessActivityFactory</code> and <code class="classname">UserBusinessActivity</code> classes. A WS-BA activity is started and associated with the client thread by calling the <code class="methodname">begin</code> method of the <code class="methodname">UserBusinessActivity</code> class. A client can terminate a business activity by calling the <code class="methodname">close</code> method, and cancel it by calling the <code class="methodname">cancel</code> method.
			</div><div class="para">
				If any of the Web Services invoked by the client register for the <code class="systemitem">BusinessActivityWithCoordinatorCompletion</code> protocol, the client can call the <code class="methodname">completed</code> method before calling the <code class="methodname">close</code> method, to notify the services that it has finished making service invocations in the current activity.
			</div><div class="para">
				More complex business activity management, such as suspension and resumption of business activities, is supported by the <code class="classname">BusinessActivityManagerFactory</code> and <code class="classname">BusinessActivityManager</code> classes.
			</div><div class="para">
				Full details of the WS-AT APIs are provided in <a class="xref" href="sec-xts-api.html">Chapter 21, <em>The XTS API</em></a>.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm140019119120016">
      ⁠</a>19.2.3. Client-Side Handler Configuration</h2></div></div></div><div class="para">
				XTS does not require the client application to use a specific API to perform invocations on transactional Web Services. The client is free to use any appropriate API to send SOAP messages to the server and receive SOAP responses. The only requirements imposed on the client are:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						It must forward details of the current transaction to the server when invoking a web service.
					</div></li><li class="listitem"><div class="para">
						It must process any responses from the server in the context of the correct transaction.
					</div></li></ul></div><div class="para">
				In order to achieve this, the client must insert details of the current XTS context into the headers of outgoing SOAP messages, and extract the context details from the headers of incoming messages and associate the context with the current thread. To simplify this process, the XTS module includes handlers which can perform this task automatically. These handlers are designed to work with JAX-WS clients.
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					If you choose to use a different SOAP client/server infrastructure for business service invocations, you must provide for header processing. XTS only provides interceptors for or JAX-WS. A JAX-RPC handler is provided only for the 1.0 implementation.
				</div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm140019150570848">
      ⁠</a>19.2.3.1. JAX-WS Client Context Handlers</h3></div></div></div><div class="para">
					In order to register the JAX-WS client-side context handler, the client application uses the APIs provided by the <code class="classname">javax.xml.ws.BindingProvider</code> and <code class="classname">javax.xml.ws.Binding</code> classes, to install a handler chain on the service proxy which is used to invoke the remote endpoint. Refer to the example application client implementation located in the <code class="filename">src/com/jboss/jbosstm/xts/demo/BasicClient.java</code> file for an example.
				</div><div class="para">
					You can also specify the handlers by using a configuration file deployed with the application. The file is identified by attaching a <code class="systemitem">javax.jws.HandlerChain</code> annotation to the interface class, which declares the JAX-WS client API. This interface is normally generated from the web service WSDL port definition.
				</div><div class="para">
					You need to instantiate the <code class="classname">com.arjuna.mw.wst11.client.JaxWSHeaderContextProcessor</code> class when registering a JAX-WS client context handler.
				</div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm140019165928768">
      ⁠</a>19.3. Creating Transactional Web Services</h1></div></div></div><div class="para">
			The two parts to implementing a Web service using XTS are the transaction management and the business logic.
		</div><div class="para">
			The bulk of the transaction management aspects are organized in a clear and easy-to-implement model by means of the XTS’s <em class="firstterm">Participant API</em>, provides a structured model for negotiation between the web service and the transaction coordinator. It allows the web service to manage its own local transactional data, in accordance with the needs of the business logic, while ensuring that its activities are in step with those of the client and other services involved in the transaction. Internally, this API uses SOAP to invokes operations on the various WS-C, WS-AT and WS-BA services, to drive the transaction to completion.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm140019165925888">
      ⁠</a>19.3.1. Participants</h2></div></div></div><div class="para">
				A <em class="firstterm">participant</em> is a software entity which is driven by the transaction manager on behalf of a Web service. When a web service wants to participate in a particular transaction, it must enroll a participant to act as a proxy for the service in subsequent negotiations with the coordinator. The participant implements an API appropriate to the type of transaction it is enrolled in, and the participant model selected when it is enrolled. For example, a Durable2PC participant, as part of a WS-Atomic Transaction, implements the Durable2PCParticipant interface. The use of participants allows the transactional control management aspects of the Web service to be factored into the participant implementation, while staying separate from the rest of the Web service's business logic and private transactional data management.
			</div><div class="para">
				The creation of participants is not trivial, since they ultimately reflect the state of a Web service’s back-end processing facilities, an aspect normally associated with an enterprise’s own IT infrastructure. Implementations must use one of the following interfaces, depending upon the protocol it will participate within: <code class="interfacename">com.arjuna.wst11.Durable2PCParticipant</code>, <code class="interfacename">com.arjuna.wst11.Volatile2PCParticipant</code>, <code class="interfacename">com.arjuna.wst11.BusinessAgreementWithParticipantCompletionParticipant</code>, or <code class="interfacename">com.arjuna.wst11.BusinessAgreementWithCoordinatorCompletionParticipant</code>.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm140019113791632">
      ⁠</a>19.3.2. Service-Side Handler Configuration</h2></div></div></div><div class="para">
				A transactional Web service must ensure that a service invocation is included in the appropriate transaction. This usually only affects the operation of the participants and has no impact on the operation of the rest of the Web service. XTS simplifies this task and decouples it from the business logic, in much the same way as for transactional clients
				 . XTS provides a handler which detects and extracts the context details from the headers in incoming SOAP headers, and associates the web service thread with the transaction. The handler clears this association when dispatching SOAP responses, and writes the context into the outgoing message headers. This is shown in <a class="xref" href="chap-Transactions_Development_Guide-Getting_Started.html#fig-context-handlers-registered-with-soap-server">Figure 19.1, “Context Handlers Registered with the SOAP Server”</a>.
			</div><div class="para">
				The service side handlers for JAX-WS come in two different versions. The normal handler resumes any transaction identified by an incoming context when the service is invoked, and suspends this transaction when the service call completes. The alternative handler is used to interpose a local coordinator. The first time an incoming parent context is seen, the local coordinator service creates a subordinate transaction, which is resumed before the web service is called. The handler ensures that this subordinate transaction is resumed each time the service is invoked with the same parent context. When the subordinate transaction completes, the association between the parent transaction and its subordinate is cleared.
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The subordinate service side handler is only able to interpose a subordinate coordinator for an Atomic Transaction.
				</div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					JAX-RPC is provided for the 1.0 implementation only.
				</div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sect-Transactions_Development_Guide-Getting_Started-JAX-WS_Service_Context-Handlers">
      ⁠</a>19.3.2.1. JAX-WS Service Context Handlers</h3></div></div></div><div class="para">
					To register the JAX-WS server-side context handler with the deployed Web Services, you must install a handler chain on the Server Endpoint Implementation class. The endpoint implementation class annotation, which is the one annotated with a <code class="systemitem">javax.jws.WebService</code>, must be supplemented with a <code class="systemitem">javax.jws.HandlerChain</code> annotation which identifies a handler configuration file deployed with the application.
				</div><div class="para">
					Please refer to the application configuration and the endpoint implementation classes located in <a class="xref" href="appe-Transactions_Development_Guide-Endpoint_Implementation_Classes.html">Appendix C, <em>Endpoint Implementation Classes</em></a> for examples.
				</div><div class="para">
					When registering a normal JAX-WS service context handler, you must instantiate the <code class="classname">com.arjuna.mw.wst11.service.JaxWSHeaderContextProcessor</code> class. If you need coordinator interposition, employ the <code class="classname">com.arjuna.mw.wst11.service.JaxWSSubordinateHeaderContextProcessor</code> instead.
				</div><div class="figure"><a id="fig-context-handlers-registered-with-soap-server">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><img src="images/fig-context-handlers-registered-with-soap-server.png" alt="Context Handlers Registered with the SOAP Server"/></div></div><p class="title"><strong>Figure 19.1. Context Handlers Registered with the SOAP Server</strong></p></div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm140019167229904">
      ⁠</a>19.4. Summary</h1></div></div></div><div class="para">
			This chapter gives a high-level overview of each of the major software pieces used by the Web Services transactions component of JBoss Transaction Service. The Web Services transaction manager provided by JBoss Transaction Service is the hub of the architecture and is the only piece of software that user-level software does not bind to directly. XTS provides header-processing infrastructure for use with Web Services transactions contexts for both client applications and Web Services. XTS provides a simple interface for developing transaction participants, along with the necessary document-handling code.
		</div><div class="para">
			This chapter is only an overview, and does not address the more difficult and subtle aspects of programming Web Services. For fuller explanations of the components, please continue reading.
		</div></div></div></body></html>