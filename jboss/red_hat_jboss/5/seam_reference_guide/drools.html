<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 14. Seam and JBoss Rules</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="drools">
      ⁠</a>Chapter 14. Seam and JBoss Rules</h1></div></div></div><div class="para">
		Seam makes it easy to call JBoss Rules (Drools) rulebases from Seam components or jBPM process definitions.
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690514354032">
      ⁠</a>14.1. Installing rules</h1></div></div></div><div class="para">
			The first step is to make an instance of <code class="literal">org.drools.RuleBase</code> available in a Seam context variable. For testing purposes, Seam provides a built-in component that compiles a static set of rules from the classpath. You can install this component via <code class="filename">components.xml</code>:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;drools:rule-base</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"policyPricingRules"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;drools:rule-files&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>policyPricingRules.drl<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/drools:rule-files&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/drools:rule-base&gt;</span>
</pre><div class="para">
			This component compiles rules from a set of DRL (<code class="literal">.drl</code>) or decision table (<code class="literal">.xls</code>) files and caches an instance of <code class="literal">org.drools.RuleBase</code> in the Seam <code class="literal">APPLICATION</code> context. Note that you will likely need to install multiple rule bases in a rule-driven application.
		</div><div class="para">
			If you want to use a Drools DSL, you must also specify the DSL definition:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;drools:rule-base</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"policyPricingRules"</span><span xmlns="" class="perl_Others"> dsl-file=</span><span xmlns="" class="perl_String">"policyPricing.dsl"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;drools:rule-files&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>policyPricingRules.drl<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/drools:rule-files&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/drools:rule-base&gt;</span>
</pre><div class="para">
			If you want to register a custom consequence exception handler through the RuleBaseConfiguration, you need to write the handler. This is demonstrated in the following example:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Scope</span>(ScopeType.<span xmlns="" class="perl_Function">APPLICATION</span>)
<span xmlns="" class="line">​</span>@Startup
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"myConsequenceExceptionHandler"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> MyConsequenceExceptionHandler 
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Keyword">implements</span> ConsequenceExceptionHandler, Externalizable {
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">readExternal</span>(ObjectInput in) <span xmlns="" class="perl_Keyword">throws</span> IOException, 
<span xmlns="" class="line">​</span>                                           ClassNotFoundException { }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">writeExternal</span>(ObjectOutput out) <span xmlns="" class="perl_Keyword">throws</span> IOException { }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">handleException</span>(Activation activation, 
<span xmlns="" class="line">​</span>                              WorkingMemory workingMemory,
<span xmlns="" class="line">​</span>                              Exception exception) {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">throw</span> <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">ConsequenceException</span>( exception, activation.<span xmlns="" class="perl_Function">getRule</span>() );
<span xmlns="" class="line">​</span>  }
<span xmlns="" class="line">​</span>}</pre><div class="para">
			and register it:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;drools:rule-base</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"policyPricingRules"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">                  dsl-file=</span><span xmlns="" class="perl_String">"policyPricing.dsl"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">                  consequence-exception-handler=</span>
<span xmlns="" class="line">​</span>                    <span xmlns="" class="perl_String">"#{myConsequenceExceptionHandler}"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;drools:rule-files&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>policyPricingRules.drl<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/drools:rule-files&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/drools:rule-base&gt;</span></pre><div class="para">
			In most rules-driven applications, rules must be dynamically deployable. A Drools RuleAgent is useful to manage the RuleBase. The RuleAgent can connect to a Drools rule server (BRMS), or hot-deploy rules packages from a local file repository. The RulesAgent-managed RuleBase is also configurable via <code class="filename">components.xml</code>:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;drools:rule-agent</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"insuranceRules"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">        configurationFile=</span><span xmlns="" class="perl_String">"/WEB-INF/deployedrules.properties"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
			The properties file contains properties specific to the RulesAgent. The following is an example configuration file from the Drools example distribution:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>newInstance=<span xmlns="" class="perl_Keyword">true</span> 
<span xmlns="" class="line">​</span>url=http:<span xmlns="" class="perl_Comment">//localhost:8080/drools-jbrms/org.drools.brms.JBRMS/package/</span>
<span xmlns="" class="line">​</span>           org.<span xmlns="" class="perl_Function">acme</span>.<span xmlns="" class="perl_Function">insurance</span>/fmeyer 
<span xmlns="" class="line">​</span>localCacheDir=/Users/fernandomeyer/projects/jbossrules/drools-examples/ 
<span xmlns="" class="line">​</span>               drools-examples-brms/cache 
<span xmlns="" class="line">​</span>poll=<span xmlns="" class="perl_Float">30</span> 
<span xmlns="" class="line">​</span>name=insuranceconfig
</pre><div class="para">
			It is also possible to configure the options on the component directly, bypassing the configuration file.
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;drools:rule-agent</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"insuranceRules"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">        url=</span><span xmlns="" class="perl_String">"http://localhost:8080/drools-jbrms/org.drools.brms.JBRMS/</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">                    package/org.acme.insurance/fmeyer"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">        local-cache-dir=</span><span xmlns="" class="perl_String">"/Users/fernandomeyer/projects/jbossrules/</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">                          drools-examples/drools-examples-brms/cache"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">        poll=</span><span xmlns="" class="perl_String">"30"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others"> configuration-name=</span><span xmlns="" class="perl_String">"insuranceconfig"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
			Next, make an instance of <code class="literal">org.drools.WorkingMemory</code> available to each conversation. (Each <code class="literal">WorkingMemory</code> accumulates facts relating to the current conversation.)
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;drools:managed-working-memory</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"policyPricingWorkingMemory"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">        auto-create=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> rule-base=</span><span xmlns="" class="perl_String">"#{policyPricingRules}"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
			Notice that we referred the <code class="literal">policyPricingWorkingMemory</code> back to our rule base via the <code class="literal">ruleBase</code> configuration property.
		</div><div class="para">
			We can also add means to be notified of rule engine events, including, for example, rules firing or objects being asserted by adding event listeners to WorkingMemory.
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;drools:managed-working-memory</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"policyPricingWorkingMemory"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">                               auto-create=</span><span xmlns="" class="perl_String">"true"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">                               rule-base=</span><span xmlns="" class="perl_String">"#{policyPricingRules}"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;drools:event-listeners&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>org.drools.event.DebugWorkingMemoryEventListener<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>org.drools.event.DebugAgendaEventListener<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/drools:event-listeners&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/drools:managed-working-memory&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690467253600">
      ⁠</a>14.2. Using rules from a Seam component</h1></div></div></div><div class="para">
			We can now inject our <code class="literal">WorkingMemory</code> into any Seam component, assert facts, and fire rules:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@In WorkingMemory policyPricingWorkingMemory; 
<span xmlns="" class="line">​</span>@In Policy policy; 
<span xmlns="" class="line">​</span>@In Customer customer; 
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">pricePolicy</span>() <span xmlns="" class="perl_Keyword">throws</span> FactException { 
<span xmlns="" class="line">​</span>  policyPricingWorkingMemory.<span xmlns="" class="perl_Function">insert</span>(policy);
<span xmlns="" class="line">​</span>  policyPricingWorkingMemory.<span xmlns="" class="perl_Function">insert</span>(customer);  
<span xmlns="" class="line">​</span>  policyPricingWorkingMemory.<span xmlns="" class="perl_Function">fireAllRules</span>(); 
<span xmlns="" class="line">​</span>}</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690516583312">
      ⁠</a>14.3. Using rules from a jBPM process definition</h1></div></div></div><div class="para">
			A rule base can act as a jBPM action, decision, or assignment handler in either a pageflow or a business process definition.
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;decision</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"approval"</span><span xmlns="" class="perl_Keyword">&gt;</span>         
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;handler</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.seam.drools.DroolsDecisionHandler"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;workingMemoryName&gt;</span>orderApprovalRulesWorkingMemory<span xmlns="" class="perl_Keyword">&lt;/workingMemoryName&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;assertObjects&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;element&gt;</span>#{customer}<span xmlns="" class="perl_Keyword">&lt;/element&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;element&gt;</span>#{order}<span xmlns="" class="perl_Keyword">&lt;/element&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;element&gt;</span>#{order.lineItems}<span xmlns="" class="perl_Keyword">&lt;/element&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/assertObjects&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/handler&gt;</span>
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;transition</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"approved"</span><span xmlns="" class="perl_Others"> to=</span><span xmlns="" class="perl_String">"ship"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;action</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.seam.drools.DroolsActionHandler"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;workingMemoryName&gt;</span>shippingRulesWorkingMemory<span xmlns="" class="perl_Keyword">&lt;/workingMemoryName&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;assertObjects&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;element&gt;</span>#{customer}<span xmlns="" class="perl_Keyword">&lt;/element&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;element&gt;</span>#{order}<span xmlns="" class="perl_Keyword">&lt;/element&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;element&gt;</span>#{order.lineItems}<span xmlns="" class="perl_Keyword">&lt;/element&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/assertObjects&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/action&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/transition&gt;</span>  
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;transition</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"rejected"</span><span xmlns="" class="perl_Others"> to=</span><span xmlns="" class="perl_String">"cancelled"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/decision&gt;</span>
</pre><div class="para">
			The <code class="literal">&lt;assertObjects&gt;</code> element specifies EL expressions that return an object or collection of objects to be asserted as facts into the <code class="literal">WorkingMemory</code>.
		</div><div class="para">
			Using Drools for jBPM task assignments is also supported:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;task-node</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"review"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;task</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"review"</span><span xmlns="" class="perl_Others"> description=</span><span xmlns="" class="perl_String">"Review Order"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;assignment</span><span xmlns="" class="perl_Others"> handler=</span><span xmlns="" class="perl_String">"org.jboss.seam.drools.DroolsAssignmentHandler"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;workingMemoryName&gt;</span>
<span xmlns="" class="line">​</span>        orderApprovalRulesWorkingMemory
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/workingMemoryName&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;assertObjects&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;element&gt;</span>#{actor}<span xmlns="" class="perl_Keyword">&lt;/element&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;element&gt;</span>#{customer}<span xmlns="" class="perl_Keyword">&lt;/element&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;element&gt;</span>#{order}<span xmlns="" class="perl_Keyword">&lt;/element&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;element&gt;</span>#{order.lineItems}<span xmlns="" class="perl_Keyword">&lt;/element&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/assertObjects&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/assignment&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/task&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;transition</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"rejected"</span><span xmlns="" class="perl_Others"> to=</span><span xmlns="" class="perl_String">"cancelled"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;transition</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"approved"</span><span xmlns="" class="perl_Others"> to=</span><span xmlns="" class="perl_String">"approved"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/task-node&gt;</span>
</pre><div class="para">
			Certain objects are available as Drools globals — the jBPM <code class="literal">Assignable</code> is available as <code class="literal">assignable</code>, and the Seam <code class="literal">Decision</code> object is available as <code class="literal">decision</code>. Rules that handle decisions should call <code class="literal">decision.setOutcome("result")</code> to determine the decision result. Rules that perform assignments should set the actor ID with <code class="literal">Assignable</code>.
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>package org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">seam</span>.<span xmlns="" class="perl_Function">examples</span>.<span xmlns="" class="perl_Function">shop</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.seam.drools.Decision </span>
<span xmlns="" class="line">​</span>global Decision decision 
<span xmlns="" class="line">​</span>rule <span xmlns="" class="perl_String">"Approve Order For Loyal Customer"</span> 
<span xmlns="" class="line">​</span>  when 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Function">Customer</span>( loyaltyStatus == <span xmlns="" class="perl_String">"GOLD"</span> ) 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Function">Order</span>( totalAmount &lt;= <span xmlns="" class="perl_Float">10000</span> ) 
<span xmlns="" class="line">​</span>  then 
<span xmlns="" class="line">​</span>    decision.<span xmlns="" class="perl_Function">setOutcome</span>(<span xmlns="" class="perl_String">"approved"</span>); 
<span xmlns="" class="line">​</span>end</pre><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>package org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">seam</span>.<span xmlns="" class="perl_Function">examples</span>.<span xmlns="" class="perl_Function">shop</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jbpm.taskmgmt.exe.Assignable </span>
<span xmlns="" class="line">​</span>global Assignable assignable 
<span xmlns="" class="line">​</span>rule <span xmlns="" class="perl_String">"Assign Review For Small Order"</span> 
<span xmlns="" class="line">​</span>  when 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Function">Order</span>( totalAmount &lt;= <span xmlns="" class="perl_Float">100</span> ) 
<span xmlns="" class="line">​</span>  then 
<span xmlns="" class="line">​</span>    assignable.<span xmlns="" class="perl_Function">setPooledActors</span>( <span xmlns="" class="perl_Keyword">new</span> String[] {<span xmlns="" class="perl_String">"reviewers"</span>} ); 
<span xmlns="" class="line">​</span>end</pre><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				More information about Drools is available at <a href="http://www.drools.org">http://www.drools.org</a>.
			</div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				Seam comes packaged with enough Drools dependencies to implement some simple rules. To add extra capabilities, download the full Drools distribution and add extra dependencies as required.
			</div></div></div></div></div></body></html>