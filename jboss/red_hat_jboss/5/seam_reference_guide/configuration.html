<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 28. Configuring Seam and packaging Seam applications</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="configuration">
      ⁠</a>Chapter 28. Configuring Seam and packaging Seam applications</h1></div></div></div><div class="para">
		Configuration can be complex and tedious, but for the most part you will not need to write configuration data from scratch. Only a few lines of XML are required to integrate Seam with your JavaServer Faces (JSF) implementation and Servlet container, and for the most part you can either use seam-gen to start your application, or simply copy and paste from the example applications provided with Seam.
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690452831456">
      ⁠</a>28.1. Basic Seam configuration</h1></div></div></div><div class="para">
			First, the basic configuration required whenever Seam is used with JSF.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690526845040">
      ⁠</a>28.1.1. Integrating Seam with JSF and your servlet container</h2></div></div></div><div class="para">
				First, define a Faces Servlet.
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;servlet&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>Faces Servlet<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;servlet-class&gt;</span>javax.faces.webapp.FacesServlet<span xmlns="" class="perl_Keyword">&lt;/servlet-class&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;load-on-startup&gt;</span>1<span xmlns="" class="perl_Keyword">&lt;/load-on-startup&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/servlet&gt;</span>
<span xmlns="" class="line">​</span>         
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;servlet-mapping&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>Faces Servlet<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;url-pattern&gt;</span>*.seam<span xmlns="" class="perl_Keyword">&lt;/url-pattern&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/servlet-mapping&gt;</span>
</pre><div class="para">
				(You can adjust the URL pattern as you like.)
			</div><div class="para">
				Seam also requires the following entry in your <code class="filename">web.xml</code> file:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;listener&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;listener-class&gt;</span>org.jboss.seam.servlet.SeamListener<span xmlns="" class="perl_Keyword">&lt;/listener-class&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/listener&gt;</span>
</pre><div class="para">
				This listener is responsible for bootstrapping Seam, and for destroying session and application contexts.
			</div><div class="para">
				Some JSF implementations do not implement server-side state saving correctly, which interferes with Seam's conversation propagation. If you have problems with conversation propagation during form submissions, try switching to client-side state saving. To do so, add the following to <code class="filename">web.xml</code>:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;context-param&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param-name&gt;</span>javax.faces.STATE_SAVING_METHOD<span xmlns="" class="perl_Keyword">&lt;/param-name&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param-value&gt;</span>client<span xmlns="" class="perl_Keyword">&lt;/param-value&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/context-param&gt;</span>
</pre><div class="para">
				The JSF specification is unclear about the mutability of view state values. Since Seam uses the JSF view state to back its <code class="literal">PAGE</code> scope, this can be problematic. If you use server-side state saving with the JSF-RI (JSF Reference Implementation), and you want a page-scoped bean to retain its exact value for a given page view, you must specify the context parameter as follows:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;context-param&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param-name&gt;</span>com.sun.faces.serializeServerState<span xmlns="" class="perl_Keyword">&lt;/param-name&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param-value&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/param-value&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/context-param&gt;</span>
</pre><div class="para">
				If this is not specified, a page-scoped component will contain the latest value of the page, and not the value of the "back" page, when the "back" button is used. (See <a href="https://javaserverfaces-spec-public.dev.java.net/issues/show_bug.cgi? id=295">this specification issue</a> for details.) This setting is not enabled by default because serializing the JSF view with every request lowers overall performance.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690510918784">
      ⁠</a>28.1.2. Using Facelets</h2></div></div></div><div class="para">
				To use the recommended Facelets over JavaServer Pages (JSP), add the following lines to <code class="filename">faces-config.xml</code>:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;application&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;view-handler&gt;</span>com.sun.facelets.FaceletViewHandler<span xmlns="" class="perl_Keyword">&lt;/view-handler&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/application&gt;</span>
</pre><div class="para">
				Then, add the following lines to <code class="filename">web.xml</code>:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;context-param&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param-name&gt;</span>javax.faces.DEFAULT_SUFFIX<span xmlns="" class="perl_Keyword">&lt;/param-name&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param-value&gt;</span>.xhtml<span xmlns="" class="perl_Keyword">&lt;/param-value&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/context-param&gt;</span>
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690495156352">
      ⁠</a>28.1.3. Seam Resource Servlet</h2></div></div></div><div class="para">
				The Seam Resource Servlet provides resources used by Seam Remoting, CAPTCHAs (see the Security chapter) and some JSF UI controls. Configuring the Seam Resource Servlet requires the following entry in <code class="filename">web.xml</code>:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;servlet&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>Seam Resource Servlet<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;servlet-class&gt;</span>
<span xmlns="" class="line">​</span>    org.jboss.seam.servlet.SeamResourceServlet
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/servlet-class&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/servlet&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;servlet-mapping&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>Seam Resource Servlet<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;url-pattern&gt;</span>/seam/resource/*<span xmlns="" class="perl_Keyword">&lt;/url-pattern&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/servlet-mapping&gt;</span>
<span xmlns="" class="line">​</span>
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690511648832">
      ⁠</a>28.1.4. Seam Servlet filters</h2></div></div></div><div class="para">
				Seam does not require Servlet filters for basic operation, but there are several features that depend upon filter use. Seam lets you add and configure Servlet filters as you would configure other built-in Seam components. To use this configuration method, you must first install a master filter in <code class="filename">web.xml</code>:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;filter&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;filter-name&gt;</span>Seam Filter<span xmlns="" class="perl_Keyword">&lt;/filter-name&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;filter-class&gt;</span>org.jboss.seam.servlet.SeamFilter<span xmlns="" class="perl_Keyword">&lt;/filter-class&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/filter&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;filter-mapping&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;filter-name&gt;</span>Seam Filter<span xmlns="" class="perl_Keyword">&lt;/filter-name&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;url-pattern&gt;</span>/*<span xmlns="" class="perl_Keyword">&lt;/url-pattern&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/filter-mapping&gt;</span>
</pre><div class="para">
				To ensure that it is run first, the Seam master filter <span class="emphasis"><em>must</em></span> be the first filter specified in <code class="filename">web.xml</code>.
			</div><div class="para">
				The Seam filters share a number of common attributes, which can be set in <code class="filename">components.xml</code>, along with any parameters discussed below:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="literal">url-pattern</code> — Specifies which requests are filtered. The default is all requests. <code class="literal">url-pattern</code> is a pattern which allows a wildcard suffix.
					</div></li><li class="listitem"><div class="para">
						<code class="literal">regex-url-pattern</code> — Specifies which requests are filtered. The default is all requests. <code class="literal">regex-url-pattern</code> is a true regular expression match for request path.
					</div></li><li class="listitem"><div class="para">
						<code class="literal">disabled</code> — Disables a built in filter.
					</div></li></ul></div><div class="para">
				These patterns are matched against the URI path of the request (see <code class="literal">HttpServletRequest.getURIPath()</code>), and the name of the Servlet context is removed before matching occurs.
			</div><div class="para">
				Adding the master filter enables the following built-in filters:
			</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690451602752">
      ⁠</a>28.1.4.1. Exception handling</h3></div></div></div><div class="para">
					This filter is required by most applications, and provides the exception mapping functionality in <code class="filename">pages.xml</code>. It also rolls back uncommitted transactions when uncaught exceptions occur. (The web container should do this automatically, but this does not occur reliably in some application servers.)
				</div><div class="para">
					By default, the exception handling filter will process all requests, but you can adjust this behavior by adding a <code class="literal">&lt;web:exception-filter&gt;</code> entry to <code class="filename">components.xml</code>, like so:
				</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;components</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://jboss.com/products/seam/components"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            xmlns:web=</span><span xmlns="" class="perl_String">"http://jboss.com/products/seam/web"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;web:exception-filter</span><span xmlns="" class="perl_Others"> url-pattern=</span><span xmlns="" class="perl_String">"*.seam"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/components&gt;</span>
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690448129168">
      ⁠</a>28.1.4.2. Conversation propagation with redirects</h3></div></div></div><div class="para">
					This filter allows Seam to propagate the conversation context across browser redirects. It intercepts any browser redirects and adds a request parameter that specifies the Seam conversation identifier.
				</div><div class="para">
					The redirect filter processes all requests by default, but this behavior can also be adjusted in <code class="filename">components.xml</code>:
				</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;web:redirect-filter</span><span xmlns="" class="perl_Others"> url-pattern=</span><span xmlns="" class="perl_String">"*.seam"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuration.filters.rewrite">
      ⁠</a>28.1.4.3. URL rewriting</h3></div></div></div><div class="para">
					This filter lets Seam apply URL rewriting for views, depending on its configuration in <code class="filename">pages.xml</code>. This filter is not active by default, but can be activated by adding the following configuration to <code class="filename">components.xml</code>:
				</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;web:rewrite-filter</span><span xmlns="" class="perl_Others"> view-mapping=</span><span xmlns="" class="perl_String">"*.seam"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
					The <code class="literal">view-mapping</code> parameter must match the Servlet mapping defined for the Faces Servlet in the <code class="filename">web.xml</code> file. If omitted, the rewrite filter assumes the pattern <code class="literal">*.seam</code>.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690509527472">
      ⁠</a>28.1.4.4. Multipart form submissions</h3></div></div></div><div class="para">
					This feature is required when you use the Seam <span class="emphasis"><em>file upload</em></span> JSF control. It detects multipart form requests and processes them according the multipart/form-data specification (RFC-2388). Add the following to <code class="filename">components.xml</code> to override settings:
				</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;web:multipart-filter</span><span xmlns="" class="perl_Others"> create-temp-files=</span><span xmlns="" class="perl_String">"true"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">     max-request-size=</span><span xmlns="" class="perl_String">"1000000"</span><span xmlns="" class="perl_Others"> url-pattern=</span><span xmlns="" class="perl_String">"*.seam"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="literal">create-temp-files</code> — If <code class="literal">true</code>, uploaded files are written to a temporary file, rather than being held in memory. This can be important if you expect large file uploads. By default, this is set to <code class="literal">false</code>.
						</div></li><li class="listitem"><div class="para">
							<code class="literal">max-request-size</code> — If the size of a file upload request exceeds this value, the request will be aborted. The default setting is <code class="literal">0</code> (no size limit). (The size of a file upload is determined by reading the <code class="literal">Content-Length</code> header in the request.)
						</div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690502294608">
      ⁠</a>28.1.4.5. Character encoding</h3></div></div></div><div class="para">
					This filter sets the character encoding of submitted form data. It is not installed by default, and requires an entry in <code class="filename">components.xml</code> to enable it:
				</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;web:character-encoding-filter</span><span xmlns="" class="perl_Others"> encoding=</span><span xmlns="" class="perl_String">"UTF-16"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">     override-client=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> url-pattern=</span><span xmlns="" class="perl_String">"*.seam"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="literal">encoding</code> — The type of encoding to use.
						</div></li><li class="listitem"><div class="para">
							<code class="literal">override-client</code> — If set to <code class="literal">true</code>, the request encoding will be set to that specified by <code class="literal">encoding</code>, regardless of whether the request specifies a particular encoding. If set to <code class="literal">false</code>, the request encoding will only be set if the client has not already specified the request encoding. By default, this is set to <code class="literal">false</code>.
						</div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690504649904">
      ⁠</a>28.1.4.6. RichFaces</h3></div></div></div><div class="para">
					If RichFaces is used in your project, Seam automatically installs the RichFaces AJAX filter before all other built-in filters, so there is no need to add it to <code class="filename">web.xml</code> manually.
				</div><div class="para">
					The RichFaces Ajax filter is installed only if the RichFaces <code class="filename">JAR</code>s are present in your project.
				</div><div class="para">
					To override the default settings, add the following entry to <code class="filename">components.xml</code>. The options are the same as those specified in the RichFaces Developer Guide:
				</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;web:ajax4jsf-filter</span><span xmlns="" class="perl_Others"> force-parser=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> enable-cache=</span><span xmlns="" class="perl_String">"true"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">     log4j-init-file=</span><span xmlns="" class="perl_String">"custom-log4j.xml"</span><span xmlns="" class="perl_Others"> url-pattern=</span><span xmlns="" class="perl_String">"*.seam"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="literal">force-parser</code> — forces all JSF pages to be validated by RichFaces's XML syntax checker. If <code class="literal">false</code>, only AJAX responses are validated and converted to well-formed XML. Setting <code class="literal">force-parser</code> to <code class="literal">false</code> improves performance, but can provide visual artifacts on AJAX updates.
						</div></li><li class="listitem"><div class="para">
							<code class="literal">enable-cache</code> — enables caching of framework-generated resources, such as JavaScript, CSS, images, etc. When developing custom JavaScript or CSS, setting this to <code class="literal">true</code> prevents the browser from caching the resource.
						</div></li><li class="listitem"><div class="para">
							<code class="literal">log4j-init-file</code> — is used to set up per-application logging. A path, relative to web application context, to the <code class="filename">log4j.xml</code> configuration file should be provided.
						</div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690499527312">
      ⁠</a>28.1.4.7. Identity Logging</h3></div></div></div><div class="para">
					This filter adds the authenticated username to the <code class="literal">log4j</code> mapped diagnostic context, so that it can be included in formatted log output by adding <code class="literal">%X{username}</code> to the pattern.
				</div><div class="para">
					By default, the logging filter processes all requests. You can adjust this behavior by adding a <code class="literal">&lt;web:logging-filter&gt;</code> entry to <code class="filename">components.xml</code>, like so:
				</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;components</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://jboss.com/products/seam/components"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            xmlns:web=</span><span xmlns="" class="perl_String">"http://jboss.com/products/seam/web"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;web:logging-filter</span><span xmlns="" class="perl_Others"> url-pattern=</span><span xmlns="" class="perl_String">"*.seam"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/components&gt;</span>
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690514129968">
      ⁠</a>28.1.4.8. Context management for custom servlets</h3></div></div></div><div class="para">
					Requests that are sent directly to Servlets other than the JSF Servlet are not processed in the JSF life cycle, so Seam provides a Servlet filter that can be applied to any other Servlet requiring access to Seam components.
				</div><div class="para">
					This filter lets custom Servlets interact with Seam contexts. It sets up Seam contexts at the beginning of each request, and removes them at the end of the request. This filter should <span class="emphasis"><em>never</em></span> be applied to the JSF <code class="literal">FacesServlet</code> — Seam uses the phase listener to manage context in a JSF request.
				</div><div class="para">
					This filter is not installed by default, and must be enabled in <code class="filename">components.xml</code>:
				</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;web:context-filter</span><span xmlns="" class="perl_Others"> url-pattern=</span><span xmlns="" class="perl_String">"/media/*"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
					The context filter expects the conversation ID of any conversation context to be defined in the <code class="literal">conversationId</code> request parameter. You are responsible for ensuring that this is included in the request.
				</div><div class="para">
					You are also responsible for ensuring that any new conversation ID propagates back to the client. Seam exposes the conversation ID as a property of the built in component <code class="literal">conversation</code>.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690450299952">
      ⁠</a>28.1.4.9. Adding custom filters</h3></div></div></div><div class="para">
					Seam can install your filters for you. This allows you to specify your filter's placement in the chain — the Servlet specification does not provide a well-defined order when you specify your filters in <code class="filename">web.xml</code>. Add a <code class="literal">@Filter</code> annotation to your Seam component. (Your Seam component must implement <code class="literal">javax.servlet.Filter</code>.)
				</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@Startup 
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Scope</span>(APPLICATION) 
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"org.jboss.seam.web.multipartFilter"</span>) 
<span xmlns="" class="line">​</span>@BypassInterceptors 
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Filter</span>(within=<span xmlns="" class="perl_String">"org.jboss.seam.web.ajax4jsfFilter"</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> MultipartFilter <span xmlns="" class="perl_Keyword">extends</span> AbstractFilter {...}
</pre><div class="para">
					Adding the <code class="literal">@Startup</code> annotation makes the component available during Seam start up. Bijection is not available here (<code class="literal">@BypassInterceptors</code>), and the filter should be further down the chain than the RichFaces filter (<code class="literal">@Filter(within="org.jboss.seam.web.ajax4jsfFilter")</code>).
				</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690465708640">
      ⁠</a>28.1.5. Integrating Seam with your EJB container</h2></div></div></div><div class="para">
				EJB components in a Seam application are managed by both Seam and the EJB container. Seam resolves EJB component references, manages the lifetime of stateful session bean components, and participates in each method call via interceptors. To integrate Seam with your EJB container, you must first configure the interceptor chain.
			</div><div class="para">
				Apply the <code class="literal">SeamInterceptor</code> to your Seam EJB components. This interceptor delegates to a set of built-in server-side interceptors that handle operations like bijection, conversation demarcation, and business process signals. The simplest way to do this across an entire application is to add the following interceptor configuration in <code class="filename">ejb-jar.xml</code>:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;interceptors&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;interceptor&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;interceptor-class&gt;</span>
<span xmlns="" class="line">​</span>      org.jboss.seam.ejb.SeamInterceptor
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/interceptor-class&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/interceptor&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/interceptors&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;assembly-descriptor&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;interceptor-binding&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>*<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;interceptor-class&gt;</span>
<span xmlns="" class="line">​</span>      org.jboss.seam.ejb.SeamInterceptor
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/interceptor-class&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/interceptor-binding&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/assembly-descriptor&gt;</span>
</pre><div class="para">
				You must tell seam where to find session beans in JNDI. You could do this by specifying a <code class="literal">@JndiName</code> annotation on every session bean Seam component. A better approach is to specify a pattern with which Seam can calculate the JNDI name from the EJB name. However, the EJB3 specification does not define a standard method of mapping to global JNDI — this mapping is vendor-specific, and can also depend upon your naming conventions. We specify this option in <code class="filename">components.xml</code>:
			</div><div class="para">
				For JBoss Enterprise Application Platform, the following pattern is correct:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;core:init</span><span xmlns="" class="perl_Others"> jndi-name=</span><span xmlns="" class="perl_String">"earName/#{ejbName}/local"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
				Here, <code class="literal">earName</code> is the name of the EAR in which the bean is deployed. Seam replaces <code class="literal">#{ejbName}</code> with the name of the EJB, and the final segment represents the type of interface (local or remote).
			</div><div class="para">
				When outside the <code class="filename">EAR</code> context (for example, when using the JBoss Embeddable EJB3 container), the first segment is dropped, since there is no <code class="filename">EAR</code>, which leaves us with the following pattern:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;core:init</span><span xmlns="" class="perl_Others"> jndi-name=</span><span xmlns="" class="perl_String">"#{ejbName}/local"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
				This process looks complicated, but in reality comprises few steps.
			</div><div class="para">
				First, we will talk about how the EJB component is transferred to JNDI. To avoid using XML, JBoss Enterprise Application Platform uses the aforementioned pattern (that is, <code class="filename">EAR</code> name/EJB name/interface type) to automatically assign an EJB component a global JNDI name. The EJB name will be the first non-empty value out of the following:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						the <code class="literal">&lt;ejb-name&gt;</code> element in <code class="filename">ejb-jar.xml</code>,
					</div></li><li class="listitem"><div class="para">
						the <code class="literal">name</code> attribute in the <code class="literal">@Stateless</code> or <code class="literal">@Stateful</code> annotation, or
					</div></li><li class="listitem"><div class="para">
						the simple name of the bean class.
					</div></li></ul></div><div class="para">
				For example, assume that you have the following EJB bean and interface defined:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>package com.<span xmlns="" class="perl_Function">example</span>.<span xmlns="" class="perl_Function">myapp</span>; 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.Local; </span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@Local 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> Authenticator { 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_DataType">boolean</span> <span xmlns="" class="perl_Function">authenticate</span>(); 
<span xmlns="" class="line">​</span>} 
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>package com.<span xmlns="" class="perl_Function">example</span>.<span xmlns="" class="perl_Function">myapp</span>; 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.Stateless; </span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@Stateless 
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"authenticator"</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> AuthenticatorBean <span xmlns="" class="perl_Keyword">implements</span> Authenticator { 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">boolean</span> <span xmlns="" class="perl_Function">authenticate</span>() { <span xmlns="" class="perl_Keyword">... </span>} 
<span xmlns="" class="line">​</span>}
</pre><div class="para">
				Assuming that your EJB bean class is deployed in an <code class="filename">EAR</code> named <code class="literal">myapp</code>, the global JNDI name assigned on the JBoss Enterprise Application Platform will be <code class="literal">myapp/AuthenticatorBean/local</code>. You can refer to this EJB component as a Seam component with the name <code class="literal">authenticator</code>, and Seam will use the JNDI pattern (or the <code class="literal">@JndiName</code> annotation) to locate it in JNDI.
			</div><div class="para">
				For other application servers, you must declare an EJB reference for your EJB so that it is assigned a JNDI name. This does require some XML, and means that you must establish your own JNDI naming convention so that you can use the Seam JNDI pattern. It may be useful to follow the JBoss convention.
			</div><div class="para">
				You must define the EJB references in two locations when using Seam with a non-JBoss application server. If you look up the Seam EJB component with JSF (in a JSF view, or as a JSF action listener) or a Seam JavaBean component, then you must declare the EJB reference in <code class="filename">web.xml</code>. The EJB reference that would be required for our example is:\
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ejb-local-ref&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;ejb-ref-name&gt;</span>myapp/AuthenticatorBean/local<span xmlns="" class="perl_Keyword">&lt;/ejb-ref-name&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;ejb-ref-type&gt;</span>Session<span xmlns="" class="perl_Keyword">&lt;/ejb-ref-type&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;local&gt;</span>org.example.vehicles.action.Authenticator<span xmlns="" class="perl_Keyword">&lt;/local&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/ejb-local-ref&gt;</span>
</pre><div class="para">
				This reference covers most uses of the component in a Seam application. If you want to be able to inject a Seam EJB component into another Seam EJB component with the <code class="literal">@In</code> annotation, you must define this EJB reference in a second location: <code class="filename">ejb-jar.xml</code>. This is slightly more complicated.
			</div><div class="para">
				When Seam looks for a Seam EJB component to satisfy an injection point defined with <code class="literal">@In</code>, the component will only be found if it is referenced in JNDI. JBoss automatically registers EJBs to the JNDI so that they are always available to the web and EJB containers. Other containers require you to define your EJBs explicitly.
			</div><div class="para">
				Application servers that adhere to the EJB specification require that EJB references are always explicitly defined. These cannot be declared globally — you must specify each JNDI resource for an EJB component individually.
			</div><div class="para">
				Assuming that you have an EJB with a resolved name of <code class="literal">RegisterAction</code>, the following Seam injection applies:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">In</span>(create = <span xmlns="" class="perl_Keyword">true</span>) Authenticator authenticator;
</pre><div class="para">
				For this injection to work, you must also establish the link in <code class="filename">ejb-jar.xml</code>, like so:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ejb-jar&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;enterprise-beans&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;session&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>RegisterAction<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;ejb-local-ref&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;ejb-ref-name&gt;</span>myapp/AuthenticatorAction/local<span xmlns="" class="perl_Keyword">&lt;/ejb-ref-name&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;ejb-ref-type&gt;</span>Session<span xmlns="" class="perl_Keyword">&lt;/ejb-ref-type&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;local&gt;</span>com.example.myapp.Authenticator<span xmlns="" class="perl_Keyword">&lt;/local&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/ejb-local-ref&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/session&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/enterprise-beans&gt;</span> 
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/ejb-jar&gt;</span>
</pre><div class="para">
				The component is referenced here just as it was in <code class="filename">web.xml</code>. Identifying it here brings the reference into the EJB context, where it can be used by the <code class="literal">RegisterAction</code> bean. You must add one reference for each injection (via <code class="literal">@In</code>) of one Seam EJB component into another Seam EJB component. You can see an example of this setup in the <code class="literal">jee5/booking</code> example.
			</div><div class="para">
				It is possible to inject one EJB into another with the <code class="literal">@EJB</code> annotation, but this injects the EJB reference rather than the Seam EJB component instance. Because Seam's interceptor is invoked on any <span class="emphasis"><em>method call</em></span> to an EJB component, and using <code class="literal">@EJB</code> only invokes Seam's server-side interceptor chain, some Seam features will not work with <code class="literal">@EJB</code> injection. (Seam's state management and Seam's client-side interceptor chain, which handles security and concurrency, are two affected features.) When a stateful session bean is injected using the <code class="literal">@EJB</code> annotation, it will not necessarily bind to the active session or conversation, either, so we recommend injecting with <code class="literal">@In</code>.
			</div><div class="para">
				Some application servers (such as Glassfish) require you to specify JNDI names for all EJB components explicitly, sometimes more than once. You may also need to alter the JNDI pattern used in Seam, even if you follow the JBoss Enterprise Application Platform naming convention. For example, in Glassfish the global JNDI names are automatically prefixed with <code class="literal">java:comp/env</code>, so you must define the JNDI pattern as follows:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;core:init</span><span xmlns="" class="perl_Others"> jndi-name=</span><span xmlns="" class="perl_String">"java:comp/env/earName/#{ejbName}/local"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
				For transaction management, we recommend using a special built-in component that is fully aware of container transactions, and can correctly process transaction success events registered with the <code class="literal">Events</code> component. To tell Seam when container-managed transactions end, add the following line to your <code class="filename">components.xml</code> file:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;transaction:ejb-transaction/&gt;</span>
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690502058208">
      ⁠</a>28.1.6. Remember</h2></div></div></div><div class="para">
				The final requirement for integration is that a <code class="literal">seam.properties</code>, <code class="literal">META-INF/seam.properties</code> or <code class="literal">META-INF/components.xml</code> file be placed in any archive in which your Seam components are deployed. For web archive (WAR) files, place a <code class="filename">seam.properties</code> file inside the <code class="literal">WEB-INF/classes</code> directory in which your components are deployed.
			</div><div class="para">
				Seam scans any archive with <code class="filename">seam.properties</code> files for Seam components at start up. The <code class="filename">seam.properties</code> file can be empty, but it must be included so that the component is recognized by Seam. This is a workaround for Java Virtual Machine (JVM) limitations — without the <code class="filename">seam.properties</code> file, you would need to list every component explicitly in <code class="filename">components.xml</code>.
			</div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="alt-jpa-providers">
      ⁠</a>28.2. Using Alternate JPA Providers</h1></div></div></div><div class="para">
			Seam comes packaged and configured with Hibernate as the default JPA provider. To use a different JPA provider, you must configure it with Seam.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				This is a workaround — future versions of Seam will not require configuration changes to use alternative JPA providers, unless you add a custom persistence provider implementation.
			</div></div></div><div class="para">
			There are two ways to tell Seam about your JPA provider. The first is to update your application's <code class="filename">components.xml</code> so that the generic <code class="literal">PersistenceProvider</code> takes precedence over the Hibernate version. Simply add the following to the file:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;component</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.jboss.seam.persistence.persistenceProvider"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">           class=</span><span xmlns="" class="perl_String">"org.jboss.seam.persistence.PersistenceProvider"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">           scope=</span><span xmlns="" class="perl_String">"stateless"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/component&gt;</span>
</pre><div class="para">
			To take advantage of any of your JPA provider's non-standard features, you must write your own implementation of the <code class="literal">PersistenceProvider</code>. (You can use <code class="literal">HibernatePersistenceProvider</code> as a starting point.) Tell Seam to use this <code class="literal">PersistenceProvider</code> like so:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;component</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.jboss.seam.persistence.persistenceProvider"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">           class=</span><span xmlns="" class="perl_String">"org.your.package.YourPersistenceProvider"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/component&gt;</span>
</pre><div class="para">
			Now, update <code class="filename">persistence.xml</code> with the correct provider class, and any properties required by your provider. Remember to package any required <code class="filename">JAR</code> files with your application.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690502577856">
      ⁠</a>28.3. Configuring Seam in Java EE 5</h1></div></div></div><div class="mediaobject" style="text-align: center"><img src="images/ee5.png" align="middle" alt="Configuring Seam in Java EE 5" style="text-align: middle"/></div><div class="para">
			If you're running in a Java EE 5 environment, this is all the configuration required to start using Seam!
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690474453344">
      ⁠</a>28.3.1. Packaging</h2></div></div></div><div class="para">
				Once packaged into an <code class="filename">EAR</code>, your archive will be structured similarly to the following:
			</div><pre class="screen">my-application.ear/
    jboss-seam.jar
    lib/
        jboss-el.jar
    META-INF/
        MANIFEST.MF
        application.xml
    my-application.war/
        META-INF/
            MANIFEST.MF
        WEB-INF/
            web.xml
            components.xml
            faces-config.xml
            lib/
                jsf-facelets.jar
                jboss-seam-ui.jar
        login.jsp
        register.jsp
        ...
    my-application.jar/
        META-INF/
            MANIFEST.MF
            persistence.xml
        seam.properties
        org/
            jboss/
                myapplication/
                    User.class
                    Login.class
                    LoginBean.class
                    Register.class
                    RegisterBean.class
          ...
</pre><div class="para">
				Declare <code class="filename">jboss-seam.jar</code> as an EJB module in <code class="filename">META-INF/application.xml</code>. Add <code class="filename">jboss-el.jar</code> to the <code class="filename">EAR</code> classpath by placing it in the <code class="filename">EAR</code>'s <code class="literal">lib</code> directory.
			</div><div class="para">
				To use jBPM or Drools, include the required <code class="filename">JAR</code>s in the <code class="filename">EAR</code>'s <code class="literal">lib</code> directory.
			</div><div class="para">
				Tp use Facelets, as recommended, include <code class="filename">jsf-facelets.jar</code> in the <code class="literal">WEB-INF/lib</code> directory of the <code class="filename">WAR</code>.
			</div><div class="para">
				Most applications use the Seam tag library — to do so, include <code class="filename">jboss-seam-ui.jar</code> in the <code class="literal">WEB-INF/lib</code> directory of the WAR. To use the PDF or email tag libraries, you must also place <code class="filename">jboss-seam-pdf.jar</code> or <code class="filename">jboss-seam-mail.jar</code> in <code class="literal">WEB-INF/lib</code>.
			</div><div class="para">
				To use the Seam debug page, include <code class="filename">jboss-seam-debug.jar</code> in the <code class="literal">WEB-INF/lib</code> directory of the <code class="filename">WAR</code>. Seam's debug page only works for applications using Facelets.)
			</div><div class="para">
				Seam also ships with several example applications — these are deployable in any Java EE container with EJB3 support.
			</div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690467176464">
      ⁠</a>28.4. Configuring Seam in J2EE</h1></div></div></div><div class="para">
			You can use Hibernate 3 or JPA instead of EJB3 persistence, and plain JavaBeans instead of session beans. You can still take advantage of Seam's declarative state management architecture, and it is easy to migrate to EJB3.
		</div><div class="mediaobject" style="text-align: center"><img src="images/hibernate-ee.png" align="middle" alt="Configuring Seam in J2EE" style="text-align: middle"/></div><div class="para">
			Unlike session beans, Seam JavaBean components do not provide declarative transaction demarcation. Most applications use Seam-managed transactions when using Hibernate with JavaBeans, but you can also manage your transactions manually with the JTA <code class="literal">UserTransaction</code>, or declaratively with Seam's <code class="literal">@Transactional</code> annotation.
		</div><div class="para">
			The Seam distribution includes extra versions of the booking example application — one uses Hibernate3 and JavaBeans instead of EJB3, and the other uses JPA and JavaBeans. These example applications are ready to deploy into any J2EE application server.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690447807808">
      ⁠</a>28.4.1. Boostrapping Hibernate in Seam</h2></div></div></div><div class="para">
				Install the following built-in component to have Seam bootstrap a Hibernate <code class="literal">SessionFactory</code> from your <code class="literal">hibernate.cfg.xml</code> file:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;persistence:hibernate-session-factory</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernateSessionFactory"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
				To make a Seam-managed Hibernate <code class="literal">Session</code> available via injection, configure a <code class="literal">managed session</code> as follows:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;persistence:managed-hibernate-session</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernateSession"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">             session-factory=</span><span xmlns="" class="perl_String">"#{hibernateSessionFactory}"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690532963216">
      ⁠</a>28.4.2. Boostrapping JPA in Seam</h2></div></div></div><div class="para">
				Install the following built-in component to have Seam bootstrap a JPA <code class="literal">EntityManagerFactory</code> from your <code class="filename">persistence.xml</code> file:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;persistence:entity-manager-factory</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"entityManagerFactory"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
				To make a Seam-managed JPA <code class="literal">EntityManager</code> available via injection, configure a managed persistence context as follows:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;persistence:managed-persistence-context</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"entityManager"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">             entity-manager-factory=</span><span xmlns="" class="perl_String">"#{entityManagerFactory}"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690516829872">
      ⁠</a>28.4.3. Packaging</h2></div></div></div><div class="para">
				Your application will have the following structure when packaged as a <code class="filename">WAR</code>:
			</div><pre class="screen">my-application.war/
    META-INF/
        MANIFEST.MF
    WEB-INF/
        web.xml
        components.xml
        faces-config.xml
        lib/
            jboss-seam.jar
            jboss-seam-ui.jar
            jboss-el.jar
            jsf-facelets.jar
            hibernate3.jar
            hibernate-annotations.jar
            hibernate-validator.jar
            ...
            my-application.jar/
                META-INF/
                   MANIFEST.MF
                seam.properties
                hibernate.cfg.xml
                org/
                    jboss/
                        myapplication/
                            User.class
                            Login.class
                            Register.class
                            ...
    login.jsp
    register.jsp
    ...
</pre><div class="para">
				Some additional configuration is required in order to deploy Hibernate in a non-EE environment, such as TestNG.
			</div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690529626112">
      ⁠</a>28.5. Configuring Seam in Java SE, without JBoss Embedded</h1></div></div></div><div class="para">
			To use Seam outside an EE environment, you must tell Seam how to manage transactions, since JTA will not be available. If you use JPA, you can tell Seam to use JPA resource-local transactions — that is, <code class="literal">EntityTransaction</code> — like so:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;transaction:entity-transaction</span><span xmlns="" class="perl_Others"> entity-manager=</span><span xmlns="" class="perl_String">"#{entityManager}"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
			If you use Hibernate, you can tell Seam to use the Hibernate transaction API with the following:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;transaction:hibernate-transaction</span><span xmlns="" class="perl_Others"> session=</span><span xmlns="" class="perl_String">"#{session}"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
			You must also define a datasource.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690532203664">
      ⁠</a>28.6. Configuring Seam in Java SE, with JBoss Embedded</h1></div></div></div><div class="para">
			JBoss Embedded lets you run EJB3 components outside the context of the Java EE 5 application server. This is particularly useful in testing.
		</div><div class="para">
			The Seam booking example application includes a TestNG integration test suite that runs on Embedded JBoss via <code class="literal">SeamTest</code>.
		</div><div class="mediaobject" style="text-align: center"><img src="images/testng.png" align="middle" alt="Configuring Seam in Java SE, with JBoss Embedded" style="text-align: middle"/></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690446986368">
      ⁠</a>28.6.1. Packaging</h2></div></div></div><div class="para">
				A <code class="filename">WAR</code>-based deployment on a Servlet engine will be structured as follows:
			</div><pre class="screen">my-application.war/
    META-INF/
        MANIFEST.MF
    WEB-INF/
        web.xml
        components.xml
        faces-config.xml
        lib/
            jboss-seam.jar
            jboss-seam-ui.jar
            jboss-el.jar
            jsf-facelets.jar
            jsf-api.jar
            jsf-impl.jar
            ...
            my-application.jar/
                META-INF/
                    MANIFEST.MF
                    persistence.xml
                seam.properties
                org/
                    jboss/
                        myapplication/
                            User.class
                            Login.class
                            LoginBean.class
                            Register.class
                            RegisterBean.class
                            ...
    login.jsp
    register.jsp
    ...
</pre></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690500756624">
      ⁠</a>28.7. Configuring jBPM in Seam</h1></div></div></div><div class="para">
			Seam's jBPM integration is not installed by default. To enable jBPM, you must install a built-in component. You must also explicitly list your process and pageflow definitions. In <code class="filename">components.xml</code>:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bpm:jbpm&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;bpm:pageflow-definitions&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>createDocument.jpdl.xml<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>editDocument.jpdl.xml<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>approveDocument.jpdl.xml<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/bpm:pageflow-definitions&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;bpm:process-definitions&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>documentLifecycle.jpdl.xml<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/bpm:process-definitions&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bpm:jbpm&gt;</span>
</pre><div class="para">
			If you only have pageflows, no further configuration is required. If you have business process definitions, you must provide a jBPM configuration, and a Hibernate configuration for jBPM. The Seam DVD Store demo includes example <code class="filename">jbpm.cfg.xml</code> and <code class="filename">hibernate.cfg.xml</code> files that will work with Seam:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jbpm-configuration&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;jbpm-context&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;service</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"persistence"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;factory&gt;</span> 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jbpm.persistence.db.DbPersistenceServiceFactory"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;field</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"isTransactionEnabled"</span><span xmlns="" class="perl_Keyword">&gt;&lt;false/&gt;&lt;/field&gt;</span> 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/factory&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/service&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;service</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"tx"</span><span xmlns="" class="perl_Others"> factory=</span><span xmlns="" class="perl_String">"org.jbpm.tx.TxServiceFactory"</span> <span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;service</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"message"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">     factory=</span><span xmlns="" class="perl_String">"org.jbpm.msg.db.DbMessageServiceFactory"</span> <span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;service</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"scheduler"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">             factory=</span><span xmlns="" class="perl_String">"org.jbpm.scheduler.db.DbSchedulerServiceFactory"</span> <span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;service</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"logging"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">             factory=</span><span xmlns="" class="perl_String">"org.jbpm.logging.db.DbLoggingServiceFactory"</span> <span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;service</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"authentication"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">             factory=</span><span xmlns="" class="perl_String">"org.jbpm.security.authentication</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">                          .DefaultAuthenticationServiceFactory"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/jbpm-context&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jbpm-configuration&gt;</span>
</pre><div class="para">
			Note that jBPM transaction control is disabled — JTA transactions should be controlled by either Seam or EJB3.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690501426960">
      ⁠</a>28.7.1. Packaging</h2></div></div></div><div class="para">
				There is no well-defined packaging format for jBPM configuration and process or pageflow definition files. While other standard packaging formats may be developed, the Seam examples are packaged into the root of the <code class="filename">EAR</code>, and follow this structure:
			</div><pre class="screen">my-application.ear/
    jboss-seam.jar
    lib/
       jboss-el.jar
       jbpm-jpdl.jar
    META-INF/
        MANIFEST.MF
        application.xml
    my-application.war/
        META-INF/
            MANIFEST.MF
        WEB-INF/
            web.xml
            components.xml
            faces-config.xml
            lib/
                jsf-facelets.jar
                jboss-seam-ui.jar
        login.jsp
        register.jsp
        ...
    my-application.jar/
        META-INF/
            MANIFEST.MF
            persistence.xml
        seam.properties
        org/
            jboss/
                myapplication/
                    User.class
                    Login.class
                    LoginBean.class
                    Register.class
                    RegisterBean.class
                    ...
    jbpm.cfg.xml
    hibernate.cfg.xml
    createDocument.jpdl.xml
    editDocument.jpdl.xml
    approveDocument.jpdl.xml
    documentLifecycle.jpdl.xml
</pre></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690538264480">
      ⁠</a>28.8. Configuring SFSB and Session Timeouts in EAP</h1></div></div></div><div class="para">
			The timeout for stateful session beans must be longer than the timeout for HTTP sessions, or the stateful session bean may timeout before the user's HTTP Session ends. The EAP has a default session bean timeout of 30 minutes, which is configured in <code class="filename">server/default/conf/standardjboss.xml</code> — to change this, replace <code class="literal">default</code> with your own preferred configuration.
		</div><div class="para">
			In the <code class="literal">LRUStatefulContextCachePolicy</code> cache configuration, modify the value of <code class="literal">max-bean-life</code> to change the default stateful session bean timeout:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;container-cache-conf&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;cache-policy&gt;</span>
<span xmlns="" class="line">​</span>    org.jboss.ejb.plugins.LRUStatefulContextCachePolicy
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/cache-policy&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;cache-policy-conf&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;min-capacity&gt;</span>50<span xmlns="" class="perl_Keyword">&lt;/min-capacity&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;max-capacity&gt;</span>1000000<span xmlns="" class="perl_Keyword">&lt;/max-capacity&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;remover-period&gt;</span>1800<span xmlns="" class="perl_Keyword">&lt;/remover-period&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- SFSB timeout in seconds; 1800 seconds == 30 minutes --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;max-bean-life&gt;</span>1800<span xmlns="" class="perl_Keyword">&lt;/max-bean-life&gt;</span>  
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;overager-period&gt;</span>300<span xmlns="" class="perl_Keyword">&lt;/overager-period&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;max-bean-age&gt;</span>600<span xmlns="" class="perl_Keyword">&lt;/max-bean-age&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;resizer-period&gt;</span>400<span xmlns="" class="perl_Keyword">&lt;/resizer-period&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;max-cache-miss-period&gt;</span>60<span xmlns="" class="perl_Keyword">&lt;/max-cache-miss-period&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;min-cache-miss-period&gt;</span>1<span xmlns="" class="perl_Keyword">&lt;/min-cache-miss-period&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;cache-load-factor&gt;</span>0.75<span xmlns="" class="perl_Keyword">&lt;/cache-load-factor&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/cache-policy-conf&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/container-cache-conf&gt;</span>
</pre><div class="para">
			You can modify the default HTTP Session timeout in <code class="filename">server/default/deployer/jbossweb.deployer/web.xml</code> for JBoss Enterprise Application Platform 5.1. The following entry in the <code class="filename">web.xml</code> file controls the default session timeout for all web applications:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;session-config&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- HTTP Session timeout, in minutes --&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;session-timeout&gt;</span>30<span xmlns="" class="perl_Keyword">&lt;/session-timeout&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/session-config&gt;</span>
</pre><div class="para">
			To override this value for your own application, simply include a modified version of this entry in your application's own <code class="filename">web.xml</code>.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690450037280">
      ⁠</a>28.9. Running Seam in a Portlet</h1></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="warning"><div class="admonition_header"><p><strong>JBoss Portlet Bridge integration is a Technology Preview</strong></p></div><div class="admonition"><div class="para">
				Technology Preview features are not fully supported under Red Hat subscription level agreements (SLAs), may not be functionally complete, and are not intended for production use. However, these features provide early access to upcoming product innovations, enabling customers to test functionality and provide feedback during the development process. As Red Hat considers making future iterations of Technology Preview features generally available, we will provide commercially reasonable efforts to resolve any reported issues that customers experience when using these features.
			</div></div></div><div class="para">
			You can use the JBoss Portlet Bridge to run your Seam application in a portlet. The bridge supports JSF within a portlet, and includes extensions for Seam and RichFaces. See <a href="http://labs.jboss.com/portletbridge">http://labs.jboss.com/ portletbridge</a> for more information.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690500555664">
      ⁠</a>28.10. Deploying custom resources</h1></div></div></div><div class="para">
			On start up, Seam scans all <code class="filename">JAR</code>s containing <code class="filename">/seam.properties</code>, <code class="filename">/META-INF/components.xml</code> or <code class="filename">/META-INF/seam.properties</code> for resources. For example, all classes annotated with <code class="literal">@Name</code> are registered on start as Seam components.
		</div><div class="para">
			You can also use Seam to handle custom resources — that is, Seam can handle specific annotations. First, provide a list of annotation types to handle in the <code class="literal">/META-INF/seam-deployment.properties</code> files, like so:
		</div><pre class="screen"># A colon-separated list of annotation types to handle 
org.jboss.seam.deployment.annotationTypes=com.acme.Foo:com.acme.Bar
</pre><div class="para">
			Then, collect all classes annotated with <code class="literal">@Foo</code> on application start up:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"fooStartup"</span>)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Scope</span>(APPLICATION)
<span xmlns="" class="line">​</span>@Startup
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> FooStartup {
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>   @<span xmlns="" class="perl_Function">In</span>(<span xmlns="" class="perl_String">"#{deploymentStrategy.annotatedClasses['com.acme.Foo']}"</span>)
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">private</span> Set&lt;<span xmlns="" class="perl_Keyword">Class</span>&lt;Object&gt;&gt; fooClasses;
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span>   @<span xmlns="" class="perl_Function">In</span>(<span xmlns="" class="perl_String">"#{hotDeploymentStrategy.annotatedClasses['com.acme.Foo']}"</span>)
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">private</span> Set&lt;<span xmlns="" class="perl_Keyword">Class</span>&lt;Object&gt;&gt; hotFooClasses;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>   @Create
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">create</span>() {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">for</span> (<span xmlns="" class="perl_Keyword">Class</span> clazz: fooClasses) {
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Function">handleClass</span>(clazz);
<span xmlns="" class="line">​</span>      }
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">for</span> (<span xmlns="" class="perl_Keyword">Class</span> clazz: hotFooClasses) {
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Function">handleClass</span>(clazz);
<span xmlns="" class="line">​</span>      }
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">handleClass</span>(<span xmlns="" class="perl_Keyword">Class</span> clazz) {
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Comment">// ...</span>
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>}
</pre><div class="para">
			You can also set Seam to handle any resource. For example, if you want to process files with the <code class="literal">.foo.xml</code> extension, you can write a custom deployment handler:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> FooDeploymentHandler <span xmlns="" class="perl_Keyword">implements</span> DeploymentHandler { 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">static</span> DeploymentMetadata FOO_METADATA = <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">DeploymentMetadata</span>() {
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">getFileNameSuffix</span>() {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_String">".foo.xml"</span>;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>  };
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">getName</span>() { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_String">"fooDeploymentHandler"</span>; 
<span xmlns="" class="line">​</span>  } 
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">public</span> DeploymentMetadata <span xmlns="" class="perl_Function">getMetadata</span>() {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">return</span> FOO_METADATA;
<span xmlns="" class="line">​</span>  }
<span xmlns="" class="line">​</span>}
</pre><div class="para">
			This provides us with a list of all files with the <code class="literal">.foo.xml</code> suffix.
		</div><div class="para">
			Next, register the deployment handler with Seam in <code class="filename">/META-INF/seam-deployment.properties</code>:
		</div><pre class="screen"># For standard deployment 
# org.jboss.seam.deployment.deploymentHandlers=
#    com.acme.FooDeploymentHandler
 
# For hot deployment 
# org.jboss.seam.deployment.hotDeploymentHandlers=
#    com.acme.FooDeploymentHandler
</pre><div class="para">
			You can register multiple deployment handlers with a comma-separated list.
		</div><div class="para">
			Seam uses deployment handlers internally to install components and namespaces, so the <code class="literal">handle()</code> is called too early in Seam bootstrap to be useful. You can access the deployment handler easily during the start up of an application-scoped component:
		</div><pre class="programlisting Java"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"fooStartup"</span>) 
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Scope</span>(APPLICATION) 
<span xmlns="" class="line">​</span>@Startup 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> FooStartup { 
<span xmlns="" class="line">​</span>  @<span xmlns="" class="perl_Function">In</span>(<span xmlns="" class="perl_String">"#{deploymentStrategy.deploymentHandlers['fooDeploymentHandler']}"</span>)
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">private</span> FooDeploymentHandler myDeploymentHandler;
<span xmlns="" class="line">​</span>  @<span xmlns="" class="perl_Function">In</span>(<span xmlns="" class="perl_String">"#{hotDeploymentStrategy.deploymentHandlers['fooDeploymentHandler']}"</span>)
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">private</span> FooDeploymentHandler myHotDeploymentHandler;
<span xmlns="" class="line">​</span>  @Create <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">create</span>() { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">for</span> (FileDescriptor fd: myDeploymentHandler.<span xmlns="" class="perl_Function">getResources</span>()) {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Function">handleFooXml</span>(fd);
<span xmlns="" class="line">​</span>    } 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">for</span> (FileDescriptor f: myHotDeploymentHandler.<span xmlns="" class="perl_Function">getResources</span>()) {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Function">handleFooXml</span>(fd);
<span xmlns="" class="line">​</span>    } 
<span xmlns="" class="line">​</span>  }
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">handleFooXml</span>(FileDescriptor fd) {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Comment">// ...</span>
<span xmlns="" class="line">​</span>  } 
<span xmlns="" class="line">​</span>}
</pre></div></div></body></html>