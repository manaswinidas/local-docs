<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 7. Events, interceptors and exception handling</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="events">
      ⁠</a>Chapter 7. Events, interceptors and exception handling</h1></div></div></div><div class="para">
		To complement the contextual component model, there are two further basic concepts that facilitate the extremely loose coupling distinctive of Seam applications. The first is a strong event model, where events are mapped to event listeners with method-binding expressions like those in JavaServer Faces (JSF). The second is the pervasive use of annotations and interceptors to apply cross-cutting concerns to components that implement business logic.
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690506586928">
      ⁠</a>7.1. Seam events</h1></div></div></div><div class="para">
			The Seam component model was developed for use with <span class="emphasis"><em>event-driven applications</em></span>, specifically to enable the development of fine-grained, loosely-coupled components in a fine-grained eventing model. There are several event types in Seam:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					JSF events
				</div></li><li class="listitem"><div class="para">
					jBPM transition events
				</div></li><li class="listitem"><div class="para">
					Seam page actions
				</div></li><li class="listitem"><div class="para">
					Seam component-driven events
				</div></li><li class="listitem"><div class="para">
					Seam contextual events
				</div></li></ul></div><div class="para">
			Each of these events is mapped to Seam components with JSF EL method-binding expressions. For a JSF event, this is defined in the JSF template:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;h:commandButton</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"Click me!"</span><span xmlns="" class="perl_Others"> action=</span><span xmlns="" class="perl_String">"#{helloWorld.sayHello}"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
			For a jBPM transition event, it is specified in the jBPM process definition or pageflow definition:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;start-page</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hello"</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/hello.jsp"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;transition</span><span xmlns="" class="perl_Others"> to=</span><span xmlns="" class="perl_String">"hello"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;action</span><span xmlns="" class="perl_Others"> expression=</span><span xmlns="" class="perl_String">"#{helloWorld.sayHello}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/transition&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/start-page&gt;</span>
</pre><div class="para">
			More information about JSF events and jBPM events is available elsewhere. For now, we will concentrate upon the two additional event types defined by Seam.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690518287712">
      ⁠</a>7.2. Page actions</h1></div></div></div><div class="para">
			 A Seam page action is an event occurring immediately before a JSF request is rendered. Declare page actions in <code class="filename">WEB-INF/pages.xml</code>. We can define a page action for a particular JSF view ID:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;pages&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/hello.jsp"</span><span xmlns="" class="perl_Others"> action=</span><span xmlns="" class="perl_String">"#{helloWorld.sayHello}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/pages&gt;</span>
</pre><div class="para">
			Or we can use a <code class="literal">*</code> wildcard as a suffix to the <code class="literal">view-id</code> to specify an action that applies to all view IDs that match that pattern:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;pages&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/hello/*"</span><span xmlns="" class="perl_Others"> action=</span><span xmlns="" class="perl_String">"#{helloWorld.sayHello}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/pages&gt;</span>
</pre><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				If the <code class="literal">&lt;page&gt;</code> element is defined in a fine-grained page descriptor, the <code class="literal">view-id</code> attribute can be omitted, as it is already implied.
			</div></div></div><div class="para">
			If multiple wildcarded page actions match the current view-id, Seam will call all the actions, in order of least-specific to most-specific.
		</div><div class="para">
			The page action method can return a JSF outcome. If the outcome is not null, Seam uses the defined navigation rules to navigate to a view.
		</div><div class="para">
			The view ID mentioned in the <code class="literal">&lt;page&gt;</code> element need not correspond to a real JSP or Facelets page. This way, we can reproduce the functionality of a traditional action-oriented framework like Struts or WebWork using page actions. This is useful for performing complex actions in response to non-Faces requests like HTTP GET.
		</div><div class="para">
			Multiple or conditional page actions can be specified with the <code class="literal">&lt;action&gt;</code> tag:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;pages&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/hello.jsp"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;action</span><span xmlns="" class="perl_Others"> execute=</span><span xmlns="" class="perl_String">"#{helloWorld.sayHello}"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            if=</span><span xmlns="" class="perl_String">"#{not validation.failed}"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;action</span><span xmlns="" class="perl_Others"> execute=</span><span xmlns="" class="perl_String">"#{hitCount.increment}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/page&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/pages&gt;</span></pre><div class="para">
			Page actions are executed on both an initial (non-Faces) request and a postback (Faces) request. If you use the page action to load data, it may conflict with the standard JSF actions being executed on a postback. One way to disable the page action is to set up a condition that resolves to <code class="literal">true</code> only upon an initial request.
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;pages&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/dashboard.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;action</span><span xmlns="" class="perl_Others"> execute=</span><span xmlns="" class="perl_String">"#{dashboard.loadData}"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            if=</span><span xmlns="" class="perl_String">"#{not FacesContext.renderKit.responseStateManager</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">                .isPostback(FacesContext)}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/page&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/pages&gt;</span></pre><div class="para">
			This condition consults the <code class="literal">ResponseStateManager#isPostback(FacesContext)</code> to determine if the request is a postback. The ResponseStateManager is accessed using <code class="literal">FacesContext.getCurrentInstance().getRenderKit(). getResponseStateManager()</code>.
		</div><div class="para">
			Seam offers a built-in condition that accomplishes this result less verbosely. You can disable a page action on a postback by setting the <code class="literal">on-postback</code> attribute to <code class="literal">false</code>:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;pages&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/dashboard.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;action</span><span xmlns="" class="perl_Others"> execute=</span><span xmlns="" class="perl_String">"#{dashboard.loadData}"</span><span xmlns="" class="perl_Others"> on-postback=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/page&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/pages&gt;</span>
</pre><div class="para">
			The <code class="literal">on-postback</code> attribute defaults to <code class="literal">true</code> to maintain backwards compatibility. However, you are more likely to use <code class="literal">false</code> more often.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690497769056">
      ⁠</a>7.3. Page parameters</h1></div></div></div><div class="para">
			A Faces request (a JSF form submission) encapsulates both an <span class="emphasis"><em>action</em></span> (a method binding) and <span class="emphasis"><em>parameters</em></span> (input value bindings). A page action can also require parameters.
		</div><div class="para">
			Since non-Faces (GET) requests can be bookmarked, page parameters are passed as human-readable request parameters.
		</div><div class="para">
			You can use page parameters with or without an action method.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690501486960">
      ⁠</a>7.3.1. Mapping request parameters to the model</h2></div></div></div><div class="para">
				Seam lets us provide a value binding that maps a named request parameter to an attribute of a model object.
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;pages&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/hello.jsp"</span><span xmlns="" class="perl_Others"> action=</span><span xmlns="" class="perl_String">"#{helloWorld.sayHello}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"firstName"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"#{person.firstName}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"lastName"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"#{person.lastName}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/page&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/pages&gt;</span></pre><div class="para">
				The <code class="literal">&lt;param&gt;</code> declaration is bidirectional, as with value bindings for JSF input:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						When a non-Faces (GET) request for the view ID occurs, Seam sets the value of the named request parameter to the model object, after performing appropriate type conversions.
					</div></li><li class="listitem"><div class="para">
						Any <code class="literal">&lt;s:link&gt;</code> or <code class="literal">&lt;s:button&gt;</code> includes the request parameter transparently. The parameter value is determined by evaluating the value binding during the render phase (when the <code class="literal">&lt;s:link&gt;</code> is rendered).
					</div></li><li class="listitem"><div class="para">
						Any navigation rule with a <code class="literal">&lt;redirect/&gt;</code> to the view ID includes the request parameter transparently. The parameter value is determined by evaluating the value binding at the end of the invoke application phase.
					</div></li><li class="listitem"><div class="para">
						The value is transparently propagated with any JSF form submission for the page with the given view ID. This means that view parameters behave like <code class="literal">PAGE</code>-scoped context variables for Faces requests.
					</div></li></ul></div><div class="para">
				However we arrive at <code class="filename">/hello.jsp</code>, the value of the model attribute referenced in the value binding is held in memory, without the need for a conversation (or other server-side state).
			</div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690501289664">
      ⁠</a>7.4. Propagating request parameters</h1></div></div></div><div class="para">
			If only the <code class="literal">name</code> attribute is specified, the request parameter is propagated with the <code class="literal">PAGE</code> context (that is, it is not mapped to model property).
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;pages&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/hello.jsp"</span><span xmlns="" class="perl_Others"> action=</span><span xmlns="" class="perl_String">"#{helloWorld.sayHello}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"firstName"</span> <span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"lastName"</span> <span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/page&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/pages&gt;</span></pre><div class="para">
			Page parameter propagation is especially useful when building multi-layered master-detail CRUD pages. You can use it to "remember" your view (for example, when pressing the Save button), and which entity you were editing.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					Any <code class="literal">&lt;s:link&gt;</code> or <code class="literal">&lt;s:button&gt;</code> transparently propagates the request parameter if that parameter is listed as a page parameter for the view.
				</div></li><li class="listitem"><div class="para">
					The value is transparently propagated with any JSF form submission for the page with the given view ID. (This means that view parameters behave like <code class="literal">PAGE</code>-scoped context variables for Faces requests.
				</div></li></ul></div><div class="para">
			Although this is fairly complex, it is definitely worthwhile to dedicate time to an understanding of page parameters. They are the most elegant method of propagating state across non-Faces requests. They are particularly useful in certain situations. For example, if we have search screens with bookmarkable results pages, page parameters let us write handling for both POST and GET requests in the same code. Page parameters eliminate repetitive request parameter-listing in the view definition, and simplify redirect code.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690504699904">
      ⁠</a>7.5. URL rewriting with page parameters</h1></div></div></div><div class="para">
			Rewriting occurs based on patterns found for views in <code class="filename">pages.xml</code>. Seam URL rewriting performs both incoming and outgoing URL rewriting based on the same pattern. A simple pattern for this process is:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/home.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;rewrite</span><span xmlns="" class="perl_Others"> pattern=</span><span xmlns="" class="perl_String">"/home"</span> <span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/page&gt;</span></pre><div class="para">
			In this case, any incoming request for <code class="literal">/home</code> will be sent to <code class="filename">/home.xhtml</code>. Any link generated that would normally point to <code class="literal">/home.seam</code> will instead be rewritten as <code class="literal">/home</code>. Rewrite patterns only match the portion of the URL before the query parameters, so <code class="literal">/home.seam?conversationId=13</code> and <code class="literal">/home.seam?color=red</code> will both be matched by this rewrite rule.
		</div><div class="para">
			Rewrite rules can take query parameters into consideration, as shown with the following rules.
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/home.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;rewrite</span><span xmlns="" class="perl_Others"> pattern=</span><span xmlns="" class="perl_String">"/home/{color}"</span> <span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;rewrite</span><span xmlns="" class="perl_Others"> pattern=</span><span xmlns="" class="perl_String">"/home"</span> <span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/page&gt;</span></pre><div class="para">
			In this case, an incoming request for <code class="literal">/home/red</code> will be served as if it were a request for <code class="literal">/home.seam?color=red</code>. Similarly, if color is a page parameter, an outgoing URL that would normally show as <code class="literal">/home.seam?color=blue</code> would instead be output as <code class="literal">/home/blue</code>. Rules are processed in order, so it is important to list more specific rules before more general rules.
		</div><div class="para">
			Default Seam query parameters can also be mapped with URL rewriting, further concealing Seam's fingerprints. In the following example, <code class="literal">/search.seam?conversationId=13</code> would be written as <code class="literal">/search-13</code>.
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/search.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;rewrite</span><span xmlns="" class="perl_Others"> pattern=</span><span xmlns="" class="perl_String">"/search-{conversationId}"</span> <span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;rewrite</span><span xmlns="" class="perl_Others"> pattern=</span><span xmlns="" class="perl_String">"/search"</span> <span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/page&gt;</span></pre><div class="para">
			Seam URL rewriting provides simple, bidirectional rewriting on a per-view basis. For more complex rewriting rules that cover non-Seam components, Seam applications can continue to use the <code class="literal">org.tuckey.URLRewriteFilter</code>, or apply rewriting rules at the web server.
		</div><div class="para">
			To use URL rewriting, the Seam <span class="emphasis"><em>rewrite filter</em></span> must be enabled. Rewrite filter configuration is discussed in <a class="xref" href="configuration.html#configuration.filters.rewrite">Section 28.1.4.3, “URL rewriting”</a>.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690528377728">
      ⁠</a>7.6. Conversion and Validation</h1></div></div></div><div class="para">
			You can specify a JSF converter for complex model properties, in either of the following ways:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;pages&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/calculator.jsp"</span><span xmlns="" class="perl_Others"> action=</span><span xmlns="" class="perl_String">"#{calculator.calculate}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"x"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"#{calculator.lhs}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"y"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"#{calculator.rhs}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"op"</span><span xmlns="" class="perl_Others"> converterId=</span><span xmlns="" class="perl_String">"com.my.calculator.OperatorConverter"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">           value=</span><span xmlns="" class="perl_String">"#{calculator.op}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/page&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/pages&gt;</span></pre><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;pages&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/calculator.jsp"</span><span xmlns="" class="perl_Others"> action=</span><span xmlns="" class="perl_String">"#{calculator.calculate}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"x"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"#{calculator.lhs}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"y"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"#{calculator.rhs}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"op"</span><span xmlns="" class="perl_Others"> converter=</span><span xmlns="" class="perl_String">"#{operatorConverter}"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">           value=</span><span xmlns="" class="perl_String">"#{calculator.op}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/page&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/pages&gt;</span></pre><div class="para">
			JSF validators, and <code class="literal">required="true"</code> may also be used, in either of the following ways:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;pages&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/blog.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"date"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"#{blog.date}"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">           validatorId=</span><span xmlns="" class="perl_String">"com.my.blog.PastDate"</span><span xmlns="" class="perl_Others"> required=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/page&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/pages&gt;</span></pre><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;pages&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/blog.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"date"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"#{blog.date}"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">           validator=</span><span xmlns="" class="perl_String">"#{pastDateValidator}"</span><span xmlns="" class="perl_Others"> required=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/page&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/pages&gt;</span></pre><div class="para">
			Model-based Hibernate validator annotations are automatically recognized and validated. Seam also provides a default date converter to convert a string parameter value to a date and back.
		</div><div class="para">
			When type conversion or validation fails, a global <code class="literal">FacesMessage</code> is added to the <code class="literal">FacesContext</code>.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="events.pageaction.navigation">
      ⁠</a>7.7. Navigation</h1></div></div></div><div class="para">
			You can use standard JSF navigation rules defined in <code class="filename">faces-config.xml</code> in a Seam application. However, these rules have several limitations:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					It is not possible to specify that request parameters are used when redirecting.
				</div></li><li class="listitem"><div class="para">
					It is not possible to begin or end conversations from a rule.
				</div></li><li class="listitem"><div class="para">
					Rules work by evaluating the return value of the action method; it is not possible to evaluate an arbitrary EL expression.
				</div></li></ul></div><div class="para">
			Another problem is that "orchestration" logic is scattered between <code class="filename">pages.xml</code> and <code class="filename">faces-config.xml</code>. It is better to unify this logic under <code class="filename">pages.xml</code>.
		</div><div class="para">
			This JSF navigation rule:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;navigation-rule&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;from-view-id&gt;</span>/editDocument.xhtml<span xmlns="" class="perl_Keyword">&lt;/from-view-id&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;navigation-case&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;from-action&gt;</span>#{documentEditor.update}<span xmlns="" class="perl_Keyword">&lt;/from-action&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;from-outcome&gt;</span>success<span xmlns="" class="perl_Keyword">&lt;/from-outcome&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;to-view-id&gt;</span>/viewDocument.xhtml<span xmlns="" class="perl_Keyword">&lt;/to-view-id&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;redirect/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/navigation-case&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/navigation-rule&gt;</span></pre><div class="para">
			Can be rewritten as follows:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/editDocument.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;navigation</span><span xmlns="" class="perl_Others"> from-action=</span><span xmlns="" class="perl_String">"#{documentEditor.update}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;rule</span><span xmlns="" class="perl_Others"> if-outcome=</span><span xmlns="" class="perl_String">"success"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/viewDocument.xhtml"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/rule&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/navigation&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/page&gt;</span></pre><div class="para">
			However, this method pollutes <code class="literal">DocumentEditor</code> with string-valued return values (the JSF outcomes). Instead, Seam lets us write:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/editDocument.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;navigation</span><span xmlns="" class="perl_Others"> from-action=</span><span xmlns="" class="perl_String">"#{documentEditor.update}"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">              evaluate=</span><span xmlns="" class="perl_String">"#{documentEditor.errors.size}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;rule</span><span xmlns="" class="perl_Others"> if-outcome=</span><span xmlns="" class="perl_String">"0"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/viewDocument.xhtml"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/rule&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/navigation&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/page&gt;</span></pre><div class="para">
			Or even:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/editDocument.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;navigation</span><span xmlns="" class="perl_Others"> from-action=</span><span xmlns="" class="perl_String">"#{documentEditor.update}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;rule</span><span xmlns="" class="perl_Others"> if=</span><span xmlns="" class="perl_String">"#{documentEditor.errors.empty}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/viewDocument.xhtml"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/rule&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/navigation&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/page&gt;</span></pre><div class="para">
			The first form evaluates a value binding to determine the outcome value used by the subsequent rules. The second approach ignores the outcome and evaluates a value binding for each possible rule.
		</div><div class="para">
			When an update succeeds, we probably want to end the current conversation, like so:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/editDocument.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;navigation</span><span xmlns="" class="perl_Others"> from-action=</span><span xmlns="" class="perl_String">"#{documentEditor.update}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;rule</span><span xmlns="" class="perl_Others"> if=</span><span xmlns="" class="perl_String">"#{documentEditor.errors.empty}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;end-conversation/&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/viewDocument.xhtml"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/rule&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/navigation&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/page&gt;</span></pre><div class="para">
			Since the conversation has ended, any subsequent requests will not know which document we are interested in. We can pass the document ID as a request parameter, which also makes the view bookmarkable:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/editDocument.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;navigation</span><span xmlns="" class="perl_Others"> from-action=</span><span xmlns="" class="perl_String">"#{documentEditor.update}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;rule</span><span xmlns="" class="perl_Others"> if=</span><span xmlns="" class="perl_String">"#{documentEditor.errors.empty}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;end-conversation/&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/viewDocument.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"documentId"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"#{documentEditor.documentId}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/redirect&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/rule&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/navigation&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/page&gt;</span></pre><div class="para">
			Null outcomes are a special case in JSF, and are interpreted as instructions to redisplay the page. The following navigation rule matches any non-null outcome, but <span class="emphasis"><em>not</em></span> the null outcome:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/editDocument.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;navigation</span><span xmlns="" class="perl_Others"> from-action=</span><span xmlns="" class="perl_String">"#{documentEditor.update}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;rule&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;render</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/viewDocument.xhtml"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/rule&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/navigation&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/page&gt;</span></pre><div class="para">
			To perform navigation when a null outcome occurs, use the following:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/editDocument.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;navigation</span><span xmlns="" class="perl_Others"> from-action=</span><span xmlns="" class="perl_String">"#{documentEditor.update}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;render</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/viewDocument.xhtml"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/navigation&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/page&gt;</span></pre><div class="para">
			The view ID can be given as a JSF EL expression:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/editDocument.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;navigation&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;rule</span><span xmlns="" class="perl_Others"> if-outcome=</span><span xmlns="" class="perl_String">"success"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/#{userAgent}/displayDocument.xhtml"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/rule&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/navigation&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/page&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690506683808">
      ⁠</a>7.8. Fine-grained files for defining navigation, page actions and parameters</h1></div></div></div><div class="para">
			If you have a large number of different page actions and parameters — or even just a large number of navigation rules — it is sensible to split the declarations into several smaller files. You can define actions and parameters for a page with the view ID <code class="literal">/calc/calculator.jsp</code> in a resource named <code class="literal">calc/calculator.page.xml</code>. In this case, <code class="literal">&lt;page&gt;</code> is the root element, and the view ID is implied:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;page</span><span xmlns="" class="perl_Others"> action=</span><span xmlns="" class="perl_String">"#{calculator.calculate}"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"x"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"#{calculator.lhs}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"y"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"#{calculator.rhs}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"op"</span><span xmlns="" class="perl_Others"> converter=</span><span xmlns="" class="perl_String">"#{operatorConverter}"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"#{calculator.op}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/page&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690496874912">
      ⁠</a>7.9. Component-driven events</h1></div></div></div><div class="para">
			Seam components interact by calling each other's methods. Stateful components can even implement the observer/observable pattern. However, to enable more loosely-coupled interaction, Seam provides <span class="emphasis"><em>component-driven events</em></span>.
		</div><div class="para">
			We specify event listeners (observers) in <code class="filename">components.xml</code>.
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;components&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;event</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"hello"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;action</span><span xmlns="" class="perl_Others"> execute=</span><span xmlns="" class="perl_String">"#{helloListener.sayHelloBack}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;action</span><span xmlns="" class="perl_Others"> execute=</span><span xmlns="" class="perl_String">"#{logger.logHello}"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/event&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/components&gt;</span></pre><div class="para">
			Here, the <span class="emphasis"><em>event type</em></span> is an arbitrary string.
		</div><div class="para">
			When an event occurs, the actions registered for that event will be called in the order they appear in <code class="filename">components.xml</code>. Seam provides a built-in component to raise events.
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"helloWorld"</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> HelloWorld { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">sayHello</span>() { 
<span xmlns="" class="line">​</span>        FacesMessages.<span xmlns="" class="perl_Function">instance</span>().<span xmlns="" class="perl_Function">add</span>(<span xmlns="" class="perl_String">"Hello World!"</span>); 
<span xmlns="" class="line">​</span>        Events.<span xmlns="" class="perl_Function">instance</span>().<span xmlns="" class="perl_Function">raiseEvent</span>(<span xmlns="" class="perl_String">"hello"</span>); 
<span xmlns="" class="line">​</span>    } 
<span xmlns="" class="line">​</span>}</pre><div class="para">
			You can also use an annotation, like so:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"helloWorld"</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> HelloWorld { 
<span xmlns="" class="line">​</span>    @<span xmlns="" class="perl_Function">RaiseEvent</span>(<span xmlns="" class="perl_String">"hello"</span>) 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">sayHello</span>() { 
<span xmlns="" class="line">​</span>        FacesMessages.<span xmlns="" class="perl_Function">instance</span>().<span xmlns="" class="perl_Function">add</span>(<span xmlns="" class="perl_String">"Hello World!"</span>); 
<span xmlns="" class="line">​</span>    } 
<span xmlns="" class="line">​</span>}
</pre><div class="para">
			This event producer is not dependent upon event consumers. The event listener can now be implemented with absolutely no dependency upon the producer:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"helloListener"</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> HelloListener { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">sayHelloBack</span>() { 
<span xmlns="" class="line">​</span>        FacesMessages.<span xmlns="" class="perl_Function">instance</span>().<span xmlns="" class="perl_Function">add</span>(<span xmlns="" class="perl_String">"Hello to you too!"</span>); 
<span xmlns="" class="line">​</span>    } 
<span xmlns="" class="line">​</span>}
</pre><div class="para">
			The method binding defined above in <code class="filename">components.xml</code> maps the event to the consumer. If you prefer, you can also do this with annotations:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"helloListener"</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> HelloListener { 
<span xmlns="" class="line">​</span>    @<span xmlns="" class="perl_Function">Observer</span>(<span xmlns="" class="perl_String">"hello"</span>) 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">sayHelloBack</span>() { 
<span xmlns="" class="line">​</span>        FacesMessages.<span xmlns="" class="perl_Function">instance</span>().<span xmlns="" class="perl_Function">add</span>(<span xmlns="" class="perl_String">"Hello to you too!"</span>); 
<span xmlns="" class="line">​</span>    } 
<span xmlns="" class="line">​</span>}
</pre><div class="para">
			If you are familiar with component-driven events, you may be wondering about event objects. In Seam, event objects do not need to propagate state between the event producer and listener. State is held in the Seam contexts, and shared between components. However, if you do want to pass an event object, you can do so:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"helloWorld"</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> HelloWorld { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> String name; 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">sayHello</span>() { 
<span xmlns="" class="line">​</span>        FacesMessages.<span xmlns="" class="perl_Function">instance</span>().<span xmlns="" class="perl_Function">add</span>(<span xmlns="" class="perl_String">"Hello World, my name is #0."</span>, name); 
<span xmlns="" class="line">​</span>        Events.<span xmlns="" class="perl_Function">instance</span>().<span xmlns="" class="perl_Function">raiseEvent</span>(<span xmlns="" class="perl_String">"hello"</span>, name); 
<span xmlns="" class="line">​</span>    } 
<span xmlns="" class="line">​</span>}</pre><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"helloListener"</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> HelloListener { 
<span xmlns="" class="line">​</span>    @<span xmlns="" class="perl_Function">Observer</span>(<span xmlns="" class="perl_String">"hello"</span>) 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">sayHelloBack</span>(String name) { 
<span xmlns="" class="line">​</span>        FacesMessages.<span xmlns="" class="perl_Function">instance</span>().<span xmlns="" class="perl_Function">add</span>(<span xmlns="" class="perl_String">"Hello #0!"</span>, name); 
<span xmlns="" class="line">​</span>    } 
<span xmlns="" class="line">​</span>}
</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690453651008">
      ⁠</a>7.10. Contextual events</h1></div></div></div><div class="para">
			Seam defines a number of built-in events that the application uses for certain kinds of framework integration. The events are:
		</div><div class="table"><a id="idm139690453649616">
      ⁠</a><p class="title"><strong>Table 7.1. Contextual Events</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-14-rows" summary="Contextual Events"><colgroup><col width="270px"/><col width="170px"/></colgroup><thead><tr><th> Event </th><th> Description </th></tr></thead><tbody><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.validationFailed</code>
						</div>
						 </td><td> <div class="para">
							Called when JSFvalidation fails.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.noConversation</code>
						</div>
						 </td><td> <div class="para">
							Called when there is nolong-running conversation and a long-running conversation is required.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.preSetVariable.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							called when the context variable &lt;name&gt; is set.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.postSetVariable.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							called when the context variable &lt;name&gt; is set.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.preRemoveVariable.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							Called when the context variable &lt;name&gt; is unset.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.postRemoveVariable.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							Called when the context variable &lt;name&gt; is unset.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.preDestroyContext.&lt;SCOPE&gt; </code>
						</div>
						 </td><td> <div class="para">
							Called before the &lt;SCOPE&gt; context is destroyed.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.postDestroyContext.&lt;SCOPE&gt; </code>
						</div>
						 </td><td> <div class="para">
							Called after the &lt;SCOPE&gt; context is destroyed.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.beginConversation </code>
						</div>
						 </td><td> <div class="para">
							Called whenever along-running conversation begins.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.endConversation </code>
						</div>
						 </td><td> <div class="para">
							Called whenever a long-running conversation ends.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.conversationTimeout</code>
						</div>
						 </td><td> <div class="para">
							Called when a conversation timeout occurs. The conversation ID is passed as a parameter.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.beginPageflow </code>
						</div>
						 </td><td> <div class="para">
							Called when a pageflowbegins.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.beginPageflow.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							Called when the pageflow &lt;name&gt; begins.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.endPageflow </code>
						</div>
						 </td><td> <div class="para">
							Called when a pageflowends.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.endPageflow.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							Called when the pageflow &lt;name&gt; ends.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.createProcess.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							called when the process &lt;name&gt; is created.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.endProcess.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							called when the process &lt;name&gt; ends.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.initProcess.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							called when the process &lt;name&gt; is associated with the conversation.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.initTask.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							Called when the task &lt;name&gt; is associated with the conversation.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.startTask.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							Called when the task &lt;name&gt; is started.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.endTask.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							Called when the task &lt;name&gt; is ended.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.postCreate.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							Called when the component &lt;name&gt; is created.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.preDestroy.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							Called when the component &lt;name&gt; is destroyed.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.beforePhase </code>
						</div>
						 </td><td> <div class="para">
							Called before the start of a JSF phase.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.afterPhase </code>
						</div>
						 </td><td> <div class="para">
							Called after the end of a JSF phase.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.postInitialization </code>
						</div>
						 </td><td> <div class="para">
							Called when Seam has initialized and started up all components.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.postReInitialization </code>
						</div>
						 </td><td> <div class="para">
							Called when Seam has re-initialized and started up all components after a redeploy.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.exceptionHandled.&lt;type&gt; </code>
						</div>
						 </td><td> <div class="para">
							Called when an uncaught exception is handled by Seam.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.exceptionHandled</code>
						</div>
						 </td><td> <div class="para">
							Called when an uncaught exception is handled by Seam.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.exceptionNotHandled</code>
						</div>
						 </td><td> <div class="para">
							Called when there was no handler for an uncaught exception.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.afterTransactionSuccess</code>
						</div>
						 </td><td> <div class="para">
							Called when a transaction succeeds in the Seam Application Framework.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal"> org.jboss.seam.afterTransactionSuccess.&lt;name&gt; </code>
						</div>
						 </td><td> <div class="para">
							Called when a transaction succeeds in the Seam Application Framework managing the entity <code class="literal"> &lt;name&gt; </code> .
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.security.loggedOut</code>
						</div>
						 </td><td> <div class="para">
							Called when a user logs out.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.security.loginFailed</code>
						</div>
						 </td><td> <div class="para">
							Called when a user authentication attempt fails.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.security.loginSuccessful</code>
						</div>
						 </td><td> <div class="para">
							Called when a user is successfully authenticated.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.security.notAuthorized</code>
						</div>
						 </td><td> <div class="para">
							Called when an authorization check fails.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.security.notLoggedIn</code>
						</div>
						 </td><td> <div class="para">
							Called when there is no authenticated user and authentication is required.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.security.postAuthenticate</code>
						</div>
						 </td><td> <div class="para">
							Called after a user is authenticated.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="literal">org.jboss.seam.security.preAuthenticate</code>
						</div>
						 </td><td> <div class="para">
							Called before attempting to authenticate a user.
						</div>
						 </td></tr></tbody></table></div></div><div class="para">
			Seam components observe these events just as they observe any other component-driven event.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690458351872">
      ⁠</a>7.11. Seam interceptors</h1></div></div></div><div class="para">
			EJB3 introduced a standard interceptor model for session bean components. To add an interceptor to a bean, you need to write a class with a method annotated <code class="literal">@AroundInvoke</code> and annotate the bean with an <code class="literal">@Interceptors</code> annotation that specifies the name of the interceptor class. For example, the following interceptor checks that the user is logged in before allowing invoking an action listener method:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> LoggedInInterceptor { 
<span xmlns="" class="line">​</span>    @AroundInvoke 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> Object <span xmlns="" class="perl_Function">checkLoggedIn</span>(InvocationContext invocation) 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">throws</span> Exception { 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_DataType">boolean</span> isLoggedIn = Contexts.<span xmlns="" class="perl_Function">getSessionContext</span>()
<span xmlns="" class="line">​</span>            .<span xmlns="" class="perl_Function">get</span>(<span xmlns="" class="perl_String">"loggedIn"</span>)!=<span xmlns="" class="perl_Keyword">null</span>; 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">if</span> (isLoggedIn) { 
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Comment">//the user is already logged in return invocation.proceed(); </span>
<span xmlns="" class="line">​</span>        } <span xmlns="" class="perl_Keyword">else</span> { 
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Comment">//the user is not logged in, fwd to login page return "login"; </span>
<span xmlns="" class="line">​</span>        } 
<span xmlns="" class="line">​</span>    } 
<span xmlns="" class="line">​</span>}
</pre><div class="para">
			To apply this interceptor to a session bean acting as an action listener, we must annotate the session bean <code class="literal">@Interceptors(LoggedInInterceptor.class)</code>. However, Seam builds upon the interceptor framework in EJB3 by allowing you to use <code class="literal">@Interceptors</code> as a meta-annotation for class level interceptors (those annotated <code class="literal">@Target(TYPE)</code>). In this example, we would create an <code class="literal">@LoggedIn</code> annotation, as follows:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Target</span>(TYPE) 
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Retention</span>(RUNTIME) 
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Interceptors</span>(LoggedInInterceptor.<span xmlns="" class="perl_Function">class</span>) 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">@interface</span> LoggedIn {}
</pre><div class="para">
			We can now annotate our action listener bean with <code class="literal">@LoggedIn</code> to apply the interceptor.
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@Stateless 
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"changePasswordAction"</span>) 
<span xmlns="" class="line">​</span>@LoggedIn 
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Interceptors</span>(SeamInterceptor.<span xmlns="" class="perl_Function">class</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> ChangePasswordAction <span xmlns="" class="perl_Keyword">implements</span> ChangePassword { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">... </span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">changePassword</span>() { 
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">... </span>
<span xmlns="" class="line">​</span>        } 
<span xmlns="" class="line">​</span>}
</pre><div class="para">
			Where interceptor order is important, add <code class="literal">@Interceptor</code> annotations to your interceptor classes to specify a particular order of interceptors.
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Interceptor</span>(around={BijectionInterceptor.<span xmlns="" class="perl_Function">class</span>, 
<span xmlns="" class="line">​</span>                     ValidationInterceptor.<span xmlns="" class="perl_Function">class</span>, 
<span xmlns="" class="line">​</span>                     ConversationInterceptor.<span xmlns="" class="perl_Function">class</span>}, 
<span xmlns="" class="line">​</span>    within=RemoveInterceptor.<span xmlns="" class="perl_Function">class</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> LoggedInInterceptor { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">... </span>
<span xmlns="" class="line">​</span>}</pre><div class="para">
			You can even have a client-side interceptor, for built-in EJB3 functions:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Interceptor</span>(type=CLIENT) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> LoggedInInterceptor { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">... </span>
<span xmlns="" class="line">​</span>}
</pre><div class="para">
			EJB interceptors are stateful, and their life cycles match that of the component they intercept. For interceptors that do not need to maintain state, Seam allows performance optimization where <code class="literal">@Interceptor(stateless=true)</code> is specified.
		</div><div class="para">
			Much of Seam's functionality is implemented as a set of built-in Seam interceptors, including the interceptors named in the previous example. These interceptors exist for all interceptable Seam components; you need not specify them explicitly through annotation.
		</div><div class="para">
			Seam interceptors can also be used with JavaBean components.
		</div><div class="para">
			EJB defines interception not only for business methods (using <code class="literal">@AroundInvoke</code>), but also for the life cycle methods <code class="literal">@PostConstruct</code>, <code class="literal">@PreDestroy</code>, <code class="literal">@PrePassivate</code> and <code class="literal">@PostActive</code>. Seam supports these life cycle methods on both component and interceptor, not only for EJB3 beans, but also for JavaBean components (except <code class="literal">@PreDestroy</code>, which is not meaningful for JavaBean components).
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690527543632">
      ⁠</a>7.12. Managing exceptions</h1></div></div></div><div class="para">
			JSF has a limited ability to handle exceptions. To work around this problem, Seam lets you define treatment of an exception class through annotation, or through declaration in an XML file. This combines with the EJB3-standard <code class="literal">@ApplicationException</code> annotation, which specifies whether the exception should cause a transaction rollback.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690498850848">
      ⁠</a>7.12.1. Exceptions and transactions</h2></div></div></div><div class="para">
				EJB specifies well-defined rules to control whether an exception immediately marks the current transaction for rollback, when thrown by a business method of the bean. <span class="emphasis"><em>System exceptions</em></span> always cause a transaction rollback. <span class="emphasis"><em>Application exceptions</em></span> do not cause a rollback by default, but they will cause a rollback if <code class="literal">@ApplicationException(rollback=true)</code> is specified. (An application exception is any checked exception, or any unchecked exception annotated <code class="literal">@ApplicationException</code>. A system exception is any unchecked exception without an <code class="literal">@ApplicationException</code> annotation.)
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Marking a transaction for rollback is not the same as actually rolling back the transaction. The exception rules say that the transaction should be marked rollback only, but it may still be active after the exception is thrown.
				</div></div></div><div class="para">
				Seam also applies the EJB3 exception rollback rules to Seam JavaBean components.
			</div><div class="para">
				These rules apply only in the Seam component layer. When an exception occurs outside the Seam component layer, Seam rolls back any active transaction.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690516881184">
      ⁠</a>7.12.2. Enabling Seam exception handling</h2></div></div></div><div class="para">
				To enable Seam's exception handling, the master Servlet filter must be declared in <code class="filename">web.xml</code>:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;filter&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;filter-name&gt;</span>Seam Filter<span xmlns="" class="perl_Keyword">&lt;/filter-name&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;filter-class&gt;</span>org.jboss.seam.servlet.SeamFilter<span xmlns="" class="perl_Keyword">&lt;/filter-class&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/filter&gt;</span> 
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;filter-mapping&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;filter-name&gt;</span>Seam Filter<span xmlns="" class="perl_Keyword">&lt;/filter-name&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;url-pattern&gt;</span>*.seam<span xmlns="" class="perl_Keyword">&lt;/url-pattern&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/filter-mapping&gt;</span></pre><div class="para">
				For the exception handlers to fire, you must disable Facelets development mode in <code class="filename">web.xml</code> and Seam debug mode in <code class="filename">components.xml</code>.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690515545536">
      ⁠</a>7.12.3. Using annotations for exception handling</h2></div></div></div><div class="para">
				The following exception results in a HTTP 404 error whenever it propagates outside the Seam component layer. It does not roll back the current transaction immediately when thrown, but the transaction will be rolled back if it the exception is not caught by another Seam component.
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">HttpError</span>(errorCode=<span xmlns="" class="perl_Float">404</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> ApplicationException <span xmlns="" class="perl_Keyword">extends</span> Exception { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">... </span>
<span xmlns="" class="line">​</span>}
</pre><div class="para">
				This exception results in a browser redirect whenever it propagates outside the Seam component layer. It also ends the current conversation. It causes an immediate rollback of the current transaction.
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Redirect</span>(viewId=<span xmlns="" class="perl_String">"/failure.xhtml"</span>, end=<span xmlns="" class="perl_Keyword">true</span>) 
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">ApplicationException</span>(rollback=<span xmlns="" class="perl_Keyword">true</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> UnrecoverableApplicationException <span xmlns="" class="perl_Keyword">extends</span> RuntimeException { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">... </span>
<span xmlns="" class="line">​</span>}
</pre><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Seam cannot handle exceptions that occur during JSF's <code class="literal">RENDER_RESPONSE</code> phase, as it is not possible to perform a redirect once writing to the response has begun.
				</div></div></div><div class="para">
				You can also use EL to specify the <code class="literal">viewId</code> to redirect to.
			</div><div class="para">
				When this exception propagates outside the Seam component layer, it results in a redirect and a message to the user. It also immediately rolls back the current transaction.
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Redirect</span>(viewId=<span xmlns="" class="perl_String">"/error.xhtml"</span>, message=<span xmlns="" class="perl_String">"Unexpected error"</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> SystemException <span xmlns="" class="perl_Keyword">extends</span> RuntimeException { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">... </span>
<span xmlns="" class="line">​</span>}
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690509681584">
      ⁠</a>7.12.4. Using XML for exception handling</h2></div></div></div><div class="para">
				Since annotations cannot be added to all exception classes, Seam also lets us specify this functionality in <code class="filename">pages.xml</code>.
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;pages&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;exception</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"javax.persistence.EntityNotFoundException"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;http-error</span><span xmlns="" class="perl_Others"> error-code=</span><span xmlns="" class="perl_String">"404"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/exception&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;exception</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"javax.persistence.PersistenceException"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;end-conversation/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/error.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;message&gt;</span>Database access failed<span xmlns="" class="perl_Keyword">&lt;/message&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/redirect&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/exception&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;exception&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;end-conversation/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/error.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;message&gt;</span>Unexpected failure<span xmlns="" class="perl_Keyword">&lt;/message&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/redirect&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/exception&gt;</span>   
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/pages&gt;</span></pre><div class="para">
				The final <code class="literal">&lt;exception&gt;</code> declaration does not specify a class, and acts as catch-all for any exception without specified handling via annotations or in <code class="filename">pages.xml</code>.
			</div><div class="para">
				You can also use EL to specify the <code class="literal">view-id</code> to redirect to.
			</div><div class="para">
				You can also access the handled exception instance through EL. Seam places it in the conversation context. For example, to access the exception message:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>  throw new AuthorizationException("You are not allowed to do this!");
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;pages&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;exception</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.seam.security.AuthorizationException"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;end-conversation/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/error.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;message</span><span xmlns="" class="perl_Others"> severity=</span><span xmlns="" class="perl_String">"WARN"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        #{org.jboss.seam.handledException.message}
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/message&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/redirect&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/exception&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/pages&gt;</span></pre><div class="para">
				<code class="literal">org.jboss.seam.handledException</code> holds the nested exception that was handled by an exception handler. The outermost (wrapper) exception is also available as <code class="literal">org.jboss.seam.caughtException</code>.
			</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690515317264">
      ⁠</a>7.12.4.1. Suppressing exception logging</h3></div></div></div><div class="para">
					For the exception handlers defined in <code class="filename">pages.xml</code>, it is possible to declare the level at which the exception will be logged, or to suppress exception logging altogether. The <code class="literal">log</code> and <code class="literal">log-level</code> attributes are used to control exception logging. No log message will be generated when the specified exception occurs when <code class="literal">log="false"</code> is set, as shown here:
				</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;exception</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.seam.security.NotLoggedInException"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">           log=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/register.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;message</span><span xmlns="" class="perl_Others"> severity=</span><span xmlns="" class="perl_String">"warn"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      You must be a member to use this feature
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/message&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/redirect&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/exception&gt;</span></pre><div class="para">
					If the <code class="literal">log</code> attribute is not specified, then it defaults to <code class="literal">true</code> — that is, the exception will be logged. Alternatively, you can specify the <code class="literal">log-level</code> to control the level at which the exception will be logged:
				</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;exception</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.seam.security.NotLoggedInException"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">           log-level=</span><span xmlns="" class="perl_String">"info"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/register.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;message</span><span xmlns="" class="perl_Others"> severity=</span><span xmlns="" class="perl_String">"warn"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      You must be a member to use this feature
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/message&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/redirect&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/exception&gt;</span></pre><div class="para">
					The acceptable values for <code class="literal">log-level</code> are: <code class="literal">fatal, error, warn, info, debug</code>, and <code class="literal">trace</code>. If the <code class="literal">log-level</code> is not specified, or if an invalid value is configured, <code class="literal">log-level</code> will default to <code class="literal">error</code>.
				</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690448150592">
      ⁠</a>7.12.5. Some common exceptions</h2></div></div></div><div class="para">
				If you are using JPA:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;exception</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"javax.persistence.EntityNotFoundException"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/error.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;message&gt;</span>Not found<span xmlns="" class="perl_Keyword">&lt;/message&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/redirect&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/exception&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;exception</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"javax.persistence.OptimisticLockException"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;end-conversation/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/error.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;message&gt;</span>
<span xmlns="" class="line">​</span>      Another user changed the same data, please try again
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/message&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/redirect&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/exception&gt;</span></pre><div class="para">
				If you are using the Seam Application Framework:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;exception</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.seam.framework.EntityNotFoundException"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/error.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;message&gt;</span>Not found<span xmlns="" class="perl_Keyword">&lt;/message&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/redirect&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/exception&gt;</span></pre><div class="para">
				If you are using Seam Security:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;exception</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.seam.security.AuthorizationException"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;redirect&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;message&gt;</span>You do not have permission to do this<span xmlns="" class="perl_Keyword">&lt;/message&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/redirect&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/exception&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;exception</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.seam.security.NotLoggedInException"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/login.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;message&gt;</span>Please log in first<span xmlns="" class="perl_Keyword">&lt;/message&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/redirect&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/exception&gt;</span></pre><div class="para">
				And, for JSF:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;exception</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"javax.Faces.application.ViewExpiredException"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;redirect</span><span xmlns="" class="perl_Others"> view-id=</span><span xmlns="" class="perl_String">"/error.xhtml"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;message&gt;</span>Your session has timed out, please try again<span xmlns="" class="perl_Keyword">&lt;/message&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/redirect&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/exception&gt;</span></pre><div class="para">
				A <code class="literal">ViewExpiredException</code> occurs when the user posts to a page after their session has expired. The <code class="literal">conversation-required</code> and <code class="literal">no-conversation-view-id</code> settings in the Seam page descriptor, discussed in <a class="xref" href="conversations.html#conversations.required">Section 8.4, “Requiring a long-running conversation”</a>, allow finer-grained control over session expiration while accessing a page used within a conversation.
			</div></div></div></div></body></html>