<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 24. Remoting</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="remoting">
      ⁠</a>Chapter 24. Remoting</h1></div></div></div><div class="para">
		Seam uses Asynchronous JavaScript and XML (AJAX) to remotely access components from a web page. The framework for this functionality requires very little development effort — you can make your components AJAX-accessible with simple annotations. This chapter describes the steps required to build an AJAX-enabled web page, and explains the Seam Remoting framework in further detail.
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690508038016">
      ⁠</a>24.1. Configuration</h1></div></div></div><div class="para">
			To use remoting, you must first configure your Seam Resource Servlet in your <code class="filename">web.xml</code> file:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;servlet&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>Seam Resource Servlet<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;servlet-class&gt;</span>
<span xmlns="" class="line">​</span>    org.jboss.seam.servlet.SeamResourceServlet
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/servlet-class&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/servlet&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;servlet-mapping&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>Seam Resource Servlet<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;url-pattern&gt;</span>/seam/resource/*<span xmlns="" class="perl_Keyword">&lt;/url-pattern&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/servlet-mapping&gt;</span></pre><div class="para">
			Next, import the necessary JavaScript into your web page. A minimum of two scripts must be imported. The first contains all client-side framework code, which enables remoting functionality:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;script</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"text/javascript"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">        src=</span><span xmlns="" class="perl_String">"seam/resource/remoting/resource/remote.js"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/script&gt;</span></pre><div class="para">
			The second contains the stubs and type definitions for the components you wish to call. This is generated dynamically, based on the local interface of your components, and includes type definitions for all classes that can be used to call the remotable methods of the interface. The script name reflects your component name. For example, if you annotate a stateless session bean with <code class="literal">@Name("customerAction")</code>, your script tag should look like this:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;script</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"text/javascript"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">        src=</span><span xmlns="" class="perl_String">"seam/resource/remoting/interface.js?customerAction"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/script&gt;</span></pre><div class="para">
			If you want to access more than one component from the same page, include them all as parameters of your script tag:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;script</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"text/javascript"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">        src=</span><span xmlns="" class="perl_String">"seam/resource/remoting/interface.js?customerAction</span><span xmlns="" class="perl_Error">&amp;</span><span xmlns="" class="perl_String">accountAction"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/script&gt;</span></pre><div class="para">
			You can also use the <code class="literal">s:remote</code> tag to import the required JavaScript. Separate each component or class name that you want to import with a comma:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;s:remote</span><span xmlns="" class="perl_Others"> include=</span><span xmlns="" class="perl_String">"customerAction,accountAction"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690493197056">
      ⁠</a>24.2. The <code class="interfacename">Seam</code> object</h1></div></div></div><div class="para">
			Client-side component interaction is performed with the <code class="literal">Seam</code> JavaScript object defined in <code class="literal">remote.js</code>. This is used to make asynchronous calls against your component. It is split into two areas of functionality: <code class="literal">Seam.Component</code> contains methods for working with components and <code class="literal">Seam.Remoting</code> contains methods for executing remote requests. The easiest way to become familiar with this object is to start with a simple example.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690523991360">
      ⁠</a>24.2.1. A Hello World example</h2></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139690523990560">
      ⁠</a><p class="title"><strong>Procedure 24.1. Hello World Example</strong></p><ol class="1"><li class="step"><div class="para">
						To show you how the <code class="literal">Seam</code> object works, we will first create a new Seam component called <code class="literal">helloAction</code>:
					</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@Stateless 
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"helloAction"</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> HelloAction <span xmlns="" class="perl_Keyword">implements</span> HelloLocal { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">sayHello</span>(String name) { 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_String">"Hello, "</span> + name; 
<span xmlns="" class="line">​</span>    } 
<span xmlns="" class="line">​</span>}
</pre></li><li class="step"><div class="para">
						We will also need to create a local interface for our new component. In particular, note the <code class="literal">@WebRemote</code> annotation, as this is required to make our method accessible via remoting:
					</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@Local 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">interface</span> HelloLocal { 
<span xmlns="" class="line">​</span>    @WebRemote 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">sayHello</span>(String name); 
<span xmlns="" class="line">​</span>}
</pre></li><li class="step"><div class="para">
						This is all the server-side code we require. Next, create a new web page and import the <code class="literal">helloAction</code> component:
					</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;s:remote</span><span xmlns="" class="perl_Others"> include=</span><span xmlns="" class="perl_String">"helloAction"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre></li><li class="step"><div class="para">
						Add a button to the page to make this an interactive user experience:
					</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;button</span><span xmlns="" class="perl_Others"> onclick=</span><span xmlns="" class="perl_String">"javascript:sayHello()"</span><span xmlns="" class="perl_Keyword">&gt;</span>Say Hello<span xmlns="" class="perl_Keyword">&lt;/button&gt;</span></pre></li><li class="step"><div class="para">
						You will also need script that performs an action when the button is clicked:
					</div><pre class="programlisting XML"><span xmlns="" class="line">​</span>&lt;script type=<span xmlns="" class="perl_String">"text/javascript"</span>&gt;
<span xmlns="" class="line">​</span>function <span xmlns="" class="perl_Function">sayHello</span>() {
<span xmlns="" class="line">​</span>     var name = <span xmlns="" class="perl_Function">prompt</span>(<span xmlns="" class="perl_String">"What is your name?"</span>);
<span xmlns="" class="line">​</span>     Seam.<span xmlns="" class="perl_Function">Component</span>.<span xmlns="" class="perl_Function">getInstance</span>(<span xmlns="" class="perl_String">"helloAction"</span>).<span xmlns="" class="perl_Function">sayHello</span>(name, sayHelloCallback);
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>function <span xmlns="" class="perl_Function">sayHelloCallback</span>(result) {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Function">alert</span>(result);
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>&lt;/script&gt;</pre></li><li class="step"><div class="para">
						Now deploy your application and browse to your page. Click the button, and enter a name when prompted. A message box will display the "Hello" message, confirming the call's success. (You can find the full source code for this Hello World example in Seam's <code class="literal">/examples/remoting/helloworld</code> directory.)
					</div></li></ol></div><div class="para">
				You can see from the JavaScript code listing that we have implemented two methods. The first method prompts the user for their name, and makes a remote request. Look at the following line:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Component</span>.<span xmlns="" class="perl_Function">getInstance</span>(<span xmlns="" class="perl_String">"helloAction"</span>).<span xmlns="" class="perl_Function">sayHello</span>(name, sayHelloCallback);</pre><div class="para">
				The first section of this line (<code class="literal">Seam.Component.getInstance("helloAction")</code>) returns a proxy, or <span class="emphasis"><em>stub</em></span>, for our <code class="literal">helloAction</code> component. The remainder of the line (<code class="literal">sayHello(name,sayHelloCallback);</code>) invokes our component methods against the stub.
			</div><div class="para">
				The whole line invokes the <code class="literal">sayHello</code> method of our component, passing in <code class="literal">name</code> as a parameter. The second parameter, <code class="literal">sayHelloCallback</code>, is not a parameter of our component's <code class="literal">sayHello</code> method — it tells the Seam Remoting framework that, once a response to the request is received, the response should be passed to the <code class="literal">sayHelloCallback</code> JavaScript method. (This callback parameter is optional; you can leave it out if you are calling a method with a <code class="literal">void</code> return type, or if the result of the request is not important.)
			</div><div class="para">
				When the <code class="literal">sayHelloCallback</code> method receives the response to our remote request, it displays an alert message with the result of our method call.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690516219120">
      ⁠</a>24.2.2. Seam.Component</h2></div></div></div><div class="para">
				The <code class="literal">Seam.Component</code> JavaScript object provides a number of client-side methods for working with your Seam components. The two main methods, <code class="literal">newInstance()</code> and <code class="literal">getInstance()</code> are documented more thoroughly in the sections following. The main difference between them is that <code class="literal">newInstance()</code> will always create a new instance of a component type, and <code class="literal">getInstance()</code> will return a singleton instance.
			</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690538020224">
      ⁠</a>24.2.2.1. Seam.Component.newInstance()</h3></div></div></div><div class="para">
					Use this method to create a new instance of an entity or JavaBean component. The object returned will have the same getter/setter methods as its server-side counterpart. You can also access its fields directly. For example:
				</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"customer"</span>)
<span xmlns="" class="line">​</span>@Entity
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> Customer <span xmlns="" class="perl_Keyword">implements</span> Serializable
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> Integer customerId;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> String firstName;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> String lastName;
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>    @Column <span xmlns="" class="perl_Keyword">public</span> Integer <span xmlns="" class="perl_Function">getCustomerId</span>() { 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> customerId; 
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">setCustomerId</span>(Integer customerId} { 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">customerId</span> = customerId; 
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>    @Column <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">getFirstName</span>() { 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> firstName; 
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">setFirstName</span>(String firstName) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">firstName</span> = firstName; 
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>    @Column <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">getLastName</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> lastName;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">setLastName</span>(String lastName) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">lastName</span> = lastName;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
</pre><div class="para">
					To create a client-side Customer you would write the following code:
				</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>var customer = Seam.<span xmlns="" class="perl_Function">Component</span>.<span xmlns="" class="perl_Function">newInstance</span>(<span xmlns="" class="perl_String">"customer"</span>);</pre><div class="para">
					From here, you can set the fields of the customer object.
				</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>customer.<span xmlns="" class="perl_Function">setFirstName</span>(<span xmlns="" class="perl_String">"John"</span>); <span xmlns="" class="perl_Comment">// Or you can set the fields directly </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">// customer.lastName = "Smith";</span></pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690517738048">
      ⁠</a>24.2.2.2. Seam.Component.getInstance()</h3></div></div></div><div class="para">
					The <code class="literal">getInstance()</code> method is used to refer to a Seam session bean component stub, which can then be used to remotely execute methods against your component. This method returns a singleton for the specified component, so calling it twice in a row with the same component name will return the same instance of the component.
				</div><div class="para">
					To continue the previous example, if we have created a new <code class="literal">customer</code> and we want to save it, we pass it to the <code class="literal">saveCustomer()</code> method of our <code class="literal">customerAction</code> component:
				</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Component</span>.<span xmlns="" class="perl_Function">getInstance</span>(<span xmlns="" class="perl_String">"customerAction"</span>).<span xmlns="" class="perl_Function">saveCustomer</span>( customer);</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690517122848">
      ⁠</a>24.2.2.3. Seam.Component.getComponentName()</h3></div></div></div><div class="para">
					Passing an object into this method returns the component name, if it is a component, or <code class="literal">null</code> if it is not.
				</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">if</span> (Seam.<span xmlns="" class="perl_Function">Component</span>.<span xmlns="" class="perl_Function">getComponentName</span>(instance) == <span xmlns="" class="perl_String">"customer"</span>)
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Function">alert</span>(<span xmlns="" class="perl_String">"Customer"</span>);
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">else</span> <span xmlns="" class="perl_Keyword">if</span> (Seam.<span xmlns="" class="perl_Function">Component</span>.<span xmlns="" class="perl_Function">getComponentName</span>(instance) == <span xmlns="" class="perl_String">"staff"</span>)
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Function">alert</span>(<span xmlns="" class="perl_String">"Staff member"</span>);</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690456759808">
      ⁠</a>24.2.3. Seam.Remoting</h2></div></div></div><div class="para">
				Most of the client side functionality for Seam Remoting is held within the <code class="literal">Seam.Remoting</code> object. You should not need to directly call many of its methods, but there are several that are useful:
			</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690456757984">
      ⁠</a>24.2.3.1. Seam.Remoting.createType()</h3></div></div></div><div class="para">
					If your application contains or uses JavaBean classes that are not Seam components, you may need to create these types on the client side to pass as parameters into your component method. Use the <code class="literal">createType()</code> method to create an instance of your type. Pass in the fully-qualified Java class name as a parameter:
				</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>var widget = Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">createType</span>(<span xmlns="" class="perl_String">"com.acme.widgets.MyWidget"</span>);</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690455695056">
      ⁠</a>24.2.3.2. Seam.Remoting.getTypeName()</h3></div></div></div><div class="para">
					This method is the non-component equivalent of <code class="literal">Seam.Component.getComponentName()</code>. It returns the name of the type for an object instance, or <code class="literal">null</code> if the type is not known. The name is the fully-qualified name of the type's Java class.
				</div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690450286160">
      ⁠</a>24.3. Evaluating EL Expressions</h1></div></div></div><div class="para">
			Seam Remoting also supports EL expression evaluation, which is another convenient method of retrieving data from the server. The <code class="literal">Seam.Remoting.eval()</code> function lets the EL expression be remotely evaluated on the server, and returns the resulting value to a client-side callback method. This function accepts two parameters: the EL expression to evaluate, and the callback method to invoke with the expression value. For example:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>function <span xmlns="" class="perl_Function">customersCallback</span>(customers) {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">for</span> (var i = <span xmlns="" class="perl_Float">0</span>; i &lt; customers.<span xmlns="" class="perl_Function">length</span>; i++) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Function">alert</span>(<span xmlns="" class="perl_String">"Got customer: "</span> + customers[i].<span xmlns="" class="perl_Function">getName</span>());
<span xmlns="" class="line">​</span>    }    
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">eval</span>(<span xmlns="" class="perl_String">"#{customers}"</span>, customersCallback); </pre><div class="para">
			Here, Seam evaluates the <code class="literal">#{customers}</code> expression, and the value of the expression (in this case, a list of <code class="literal">Customer</code> objects) is returned to the <code class="literal">customersCallback()</code> method. Remember, objects returned this way must have their types imported with <code class="literal">s:remote</code> for you to work with them in JavaScript. To work with a list of <code class="literal">customer</code> objects, you must be able to import the <code class="literal">customer</code> type:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;s:remote</span><span xmlns="" class="perl_Others"> include=</span><span xmlns="" class="perl_String">"customer"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690510989392">
      ⁠</a>24.4. Client Interfaces</h1></div></div></div><div class="para">
			In the previous configuration section, the stub for our component is imported into our page with either <code class="literal">seam/resource/remoting/interface.js</code>, or with the <code class="literal">s:remote</code> tag:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;script</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"text/javascript"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">        src=</span><span xmlns="" class="perl_String">"seam/resource/remoting/interface.js?customerAction"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/script&gt;</span></pre><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;s:remote</span><span xmlns="" class="perl_Others"> include=</span><span xmlns="" class="perl_String">"customerAction"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre><div class="para">
			Including this script generates the interface definitions for our component, plus any other components or types required to execute the methods of our component, and makes them available for the remoting framework's use.
		</div><div class="para">
			Two types of stub can be generated: <span class="emphasis"><em>executable</em></span> stubs, and <span class="emphasis"><em>type</em></span> stubs. Executable stubs are behavioral, and execute methods against your session bean components. Type stubs contain state, and represent the types that can be passed in as parameters or returned as results.
		</div><div class="para">
			The type of stub that is generated depends upon the type of your Seam component. If the component is a session bean, an executable stub will be generated. If it is an entity or JavaBean, a type stub will be generated. However, if your component is a JavaBean and any of its methods are annotated with <code class="literal">@WebRemote</code>, an executable stub will be generated. This lets you call your JavaBean component's methods in a non-EJB environment, where you do not have access to session beans.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690451523552">
      ⁠</a>24.5. The Context</h1></div></div></div><div class="para">
			The Seam Remoting Context contains additional information that is sent and received as part of a remoting request or response cycle. At this point, it contains only the conversation ID, but may be expanded in future.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690451522064">
      ⁠</a>24.5.1. Setting and reading the Conversation ID</h2></div></div></div><div class="para">
				If you intend to use remote calls within a conversation's scope, then you must be able to read or set the conversation ID in the Seam Remoting context. To read the conversation ID after making a remote request, call <code class="literal">Seam.Remoting.getContext().getConversationId()</code>. To set the conversation ID before making a request, call <code class="literal">Seam.Remoting.getContext().setConversationId()</code>.
			</div><div class="para">
				If the conversation ID has not been explicitly set with <code class="literal">Seam.Remoting.getContext().setConversationId()</code>, then the first valid conversation ID returned by any remoting call is assigned automatically. If you are working with multiple conversations within your page, you may need to set your conversation ID explicitly before each call. Single conversations do not require explicit ID setting.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690527682144">
      ⁠</a>24.5.2. Remote calls within the current conversation scope</h2></div></div></div><div class="para">
				Under some circumstances, you may need to make a remote call within the scope of the current view's conversation. To do so, you must explicitly set the conversation ID to that of the view before making the remote call. The following JavaScript will set the conversation ID being used for remote calls to the current view's conversation ID:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">getContext</span>().<span xmlns="" class="perl_Function">setConversationId</span>( #{conversation.<span xmlns="" class="perl_Function">id</span>} );</pre></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690516692320">
      ⁠</a>24.6. Batch Requests</h1></div></div></div><div class="para">
			Seam Remoting lets you execute multiple component calls with a single request. We recommend using this feature when you need to reduce network traffic.
		</div><div class="para">
			The <code class="literal">Seam.Remoting.startBatch()</code> method starts a new batch. Any component calls executed after starting a batch are queued, rather than being sent immediately. When all the desired component calls have been added to the batch, the <code class="literal">Seam.Remoting.executeBatch()</code> method sends a single request containing all of the queued calls to the server, where they will be executed in order. After the calls have been executed, a single response containing all return values is returned to the client, and the callback functions are triggered in their execution order.
		</div><div class="para">
			If you begin a batch, and then decide you do not want to send it, the <code class="literal">Seam.Remoting.cancelBatch()</code> method discards any queued calls and exits the batch mode.
		</div><div class="para">
			For an example of batch use, see <code class="literal">/examples/remoting/chatroom</code>.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690535037824">
      ⁠</a>24.7. Working with Data types</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690535037024">
      ⁠</a>24.7.1. Primitives / Basic Types</h2></div></div></div><div class="para">
				This section describes the support for basic data types. On the server side, these values are generally compatible with either their primitive type, or their corresponding wrapper class.
			</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690518335984">
      ⁠</a>24.7.1.1. String</h3></div></div></div><div class="para">
					Use JavaScript String objects to set String parameter values.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690518334576">
      ⁠</a>24.7.1.2. Number</h3></div></div></div><div class="para">
					Seam supports all Java-supported number types. On the client side, number values are always serialized as their String representation. They are converted to the correct destination type on the server side. Conversion into either a primitive or wrapper type is supported for <code class="literal">Byte</code>, <code class="literal">Double</code>, <code class="literal">Float</code>, <code class="literal">Integer</code>, <code class="literal">Long</code> and <code class="literal">Short</code> types.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690500691696">
      ⁠</a>24.7.1.3. Boolean</h3></div></div></div><div class="para">
					Booleans are represented client-side by JavaScript Boolean values, and server-side by a Java Boolean.
				</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690500690000">
      ⁠</a>24.7.2. JavaBeans</h2></div></div></div><div class="para">
				In general, these are either Seam entity or JavaBean components, or some other non-component class. Use the appropriate method to create a new instance of the object — <code class="literal">Seam.Component.newInstance()</code> for Seam components, or <code class="literal">Seam.Remoting.createType()</code> for anything else.
			</div><div class="para">
				Only objects created by either of these two methods should be used as parameter values, where the parameter is not one of the preexisting valid types. You may encounter component methods where the exact parameter type cannot be determined, such as:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"myAction"</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> MyAction <span xmlns="" class="perl_Keyword">implements</span> MyActionLocal { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">doSomethingWithObject</span>(Object obj) { 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">// code </span>
<span xmlns="" class="line">​</span>    } 
<span xmlns="" class="line">​</span>}
</pre><div class="para">
				In this case, the interface for <code class="literal">myAction</code> will not include <code class="literal">myWidget</code>, because it is not directly referenced by any of its methods. Therefore, you cannot pass in an instance of your <code class="literal">myWidget</code> component unless you import it explicitly:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;s:remote</span><span xmlns="" class="perl_Others"> include=</span><span xmlns="" class="perl_String">"myAction,myWidget"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre><div class="para">
				This allows a <code class="literal">myWidget</code> object to be created with <code class="literal">Seam.Component.newInstance("myWidget")</code>, which can then be passed to <code class="literal">myAction.doSomethingWithObject()</code>.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690494480096">
      ⁠</a>24.7.3. Dates and Times</h2></div></div></div><div class="para">
				Date values are serialized into a String representation that is accurate to the millisecond. On the client side, use a JavaScript Date object to work with date values. On the server side, use any <code class="literal">java.util.Date</code> class (or a descendant class, such as <code class="literal">java.sql.Date</code> or <code class="literal">java.sql.Timestamp</code>.)
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690494477056">
      ⁠</a>24.7.4. Enums</h2></div></div></div><div class="para">
				On the client side, enums are treated similarly to Strings. When setting the value for an enum parameter, use the String representation of the enum. Take the following component as an example:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"paintAction"</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> paintAction <span xmlns="" class="perl_Keyword">implements</span> paintLocal { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">enum</span> Color {red, green, blue, yellow, orange, purple}; 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> paint(Color color) { 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">// code </span>
<span xmlns="" class="line">​</span>    }    
<span xmlns="" class="line">​</span>}
</pre><div class="para">
				To call the <code class="literal">paint()</code> method with the color <code class="literal">red</code>, pass the parameter value as a String literal:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Component</span>.<span xmlns="" class="perl_Function">getInstance</span>(<span xmlns="" class="perl_String">"paintAction"</span>).<span xmlns="" class="perl_Function">paint</span>(<span xmlns="" class="perl_String">"red"</span>);</pre><div class="para">
				The inverse is also true. That is, if a component method returns an enum parameter (or contains an enum field anywhere in the returned object graph), then on the client-side it will be represented as a String.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690519282832">
      ⁠</a>24.7.5. Collections</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690519282032">
      ⁠</a>24.7.5.1. Bags</h3></div></div></div><div class="para">
					Bags cover all collection types, including arrays, collections, lists, and sets, but excluding maps — see the section following. They are implemented client-side as a JavaScript array, both when called and returned. The remoting framework on the server side can convert the bag to an appropriate type for the component method call.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690496384224">
      ⁠</a>24.7.5.2. Maps</h3></div></div></div><div class="para">
					The Seam Remoting framework provides simple map support where no native support is available in JavaScript. To create a map that can be used as a parameter to a remote call, create a new <code class="literal">Seam.Remoting.Map</code> object:
				</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>var map = <span xmlns="" class="perl_Keyword">new</span> Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">Map</span>();</pre><div class="para">
					This JavaScript implementation provides basic methods for working with Maps: <code class="literal">size()</code>, <code class="literal">isEmpty()</code>, <code class="literal">keySet()</code>, <code class="literal">values()</code>, <code class="literal">get(key)</code>, <code class="literal">put(key, value)</code>, <code class="literal">remove(key)</code> and <code class="literal">contains(key)</code>. Each of these methods is equivalent to the Java method of the same name. Where the method returns a collection, as in <code class="literal">keySet()</code> and <code class="literal">values()</code>, a JavaScript array object will be returned that contains the key or value objects (respectively).
				</div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690502003568">
      ⁠</a>24.8. Debugging</h1></div></div></div><div class="para">
			To help you track down bugs, you can enable a debug mode, which displays the contents of all packets sent between client and server in a pop-up window. To enable debug mode, either execute the <code class="literal">setDebug()</code> method in JavaScript, like so:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">setDebug</span>(<span xmlns="" class="perl_Keyword">true</span>);</pre><div class="para">
			Or configure it in <code class="filename">components.xml</code>:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;remoting:remoting</span><span xmlns="" class="perl_Others"> debug=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre><div class="para">
			To turn off debug mode, call <code class="literal">setDebug(false)</code>. If you want to write your own messages to the debug log, call <code class="literal">Seam.Remoting.log(message)</code>.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690528742448">
      ⁠</a>24.9. Handling Exceptions</h1></div></div></div><div class="para">
			When invoking a remote component method, you can specify an exception handler to process the response in the event of an exception during component invocation. To specify an exception handler function, include a reference to it after the callback parameter in your JavaScript:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>var callback = <span xmlns="" class="perl_Function">function</span>(result) { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Function">alert</span>(result); 
<span xmlns="" class="line">​</span>}; 
<span xmlns="" class="line">​</span>var exceptionHandler = <span xmlns="" class="perl_Function">function</span>(ex) { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Function">alert</span>(<span xmlns="" class="perl_String">"An exception occurred: "</span> + ex.<span xmlns="" class="perl_Function">getMessage</span>()); 
<span xmlns="" class="line">​</span>}; 
<span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Component</span>.<span xmlns="" class="perl_Function">getInstance</span>(<span xmlns="" class="perl_String">"helloAction"</span>)
<span xmlns="" class="line">​</span>    .<span xmlns="" class="perl_Function">sayHello</span>(name, callback, exceptionHandler);
</pre><div class="para">
			If you do not have a callback handler defined, you must specify <code class="literal">null</code> in its place:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>var exceptionHandler = <span xmlns="" class="perl_Function">function</span>(ex) { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Function">alert</span>(<span xmlns="" class="perl_String">"An exception occurred: "</span> + ex.<span xmlns="" class="perl_Function">getMessage</span>()); 
<span xmlns="" class="line">​</span>}; 
<span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Component</span>.<span xmlns="" class="perl_Function">getInstance</span>(<span xmlns="" class="perl_String">"helloAction"</span>)
<span xmlns="" class="line">​</span>    .<span xmlns="" class="perl_Function">sayHello</span>(name, <span xmlns="" class="perl_Keyword">null</span>, exceptionHandler);
</pre><div class="para">
			The exception object that is passed to the exception handler exposes one method, <code class="literal">getMessage()</code>, which returns the exception message belonging to the exception thrown by the <code class="literal">@WebRemote</code> method.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690519074592">
      ⁠</a>24.10. The Loading Message</h1></div></div></div><div class="para">
			You can modify, define custom rendering for, or even remove the default loading message that appears in the top right corner of the screen.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690498355072">
      ⁠</a>24.10.1. Changing the message</h2></div></div></div><div class="para">
				To change the message from the default "Please Wait...", set the value of <code class="literal">Seam.Remoting.loadingMessage</code>:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">loadingMessage</span> = <span xmlns="" class="perl_String">"Loading..."</span>;</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690498351808">
      ⁠</a>24.10.2. Hiding the loading message</h2></div></div></div><div class="para">
				To completely suppress the display of the loading message, override the implementation of <code class="literal">displayLoadingMessage()</code> and <code class="literal">hideLoadingMessage()</code> with actionless functions:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">// do not display the loading indicator </span>
<span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">displayLoadingMessage</span> = <span xmlns="" class="perl_Function">function</span>() {}; 
<span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">hideLoadingMessage</span> = <span xmlns="" class="perl_Function">function</span>() {};
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690518491056">
      ⁠</a>24.10.3. A Custom Loading Indicator</h2></div></div></div><div class="para">
				It is also possible to override the loading indicator to display an animated icon, or anything else that you want. To do so, override the <code class="literal">displayLoadingMessage()</code> and <code class="literal">hideLoadingMessage()</code> messages with your own implementations:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">displayLoadingMessage</span> = <span xmlns="" class="perl_Function">function</span>() { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">// Write code here to display the indicator </span>
<span xmlns="" class="line">​</span>}; 
<span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">hideLoadingMessage</span> = <span xmlns="" class="perl_Function">function</span>() { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">// Write code here to hide the indicator </span>
<span xmlns="" class="line">​</span>};
</pre></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690498656160">
      ⁠</a>24.11. Controlling what data is returned</h1></div></div></div><div class="para">
			When a remote method is executed, the result is serialized into an XML response, which is returned to the client. This response is then unmarshaled by the client into a JavaScript object. For complex types (such as JavaBeans) that include references to other objects, all referenced objects are also serialized as part of the response. These objects can reference other objects, which can reference other objects, and so on — so, if left unchecked, this object "graph" can be enormous.
		</div><div class="para">
			For this reason, and to prevent sensitive information being exposed to the client, Seam Remoting lets you constrain the object graph by specifying the <code class="literal">exclude</code> field of the remote method's <code class="literal">@WebRemote</code> annotation. This field accepts a String array containing one or more paths specified with dot notation. When invoking a remote method, the objects in the result's object graph that match these paths are excluded from the serialized result packet.
		</div><div class="para">
			The examples that follow are all based on this <code class="literal">Widget</code> class:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"widget"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> Widget {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> String value;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> String secret;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> Widget child;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> Map&amp;lt;String,Widget&amp;gt; widgetMap;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> List&amp;lt;Widget&amp;gt; widgetList;
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">// getters and setters for all fields</span>
</pre><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690507204096">
      ⁠</a>24.11.1. Constraining normal fields</h2></div></div></div><div class="para">
				If your remote method returns an instance of <code class="literal">Widget</code>, but you do not want to expose the <code class="literal">secret</code> field because it contains sensitive information, you would constrain it like so:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">WebRemote</span>(exclude = {<span xmlns="" class="perl_String">"secret"</span>}) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> Widget <span xmlns="" class="perl_Function">getWidget</span>();</pre><div class="para">
				The value "secret" refers to the <code class="literal">secret</code> field of the returned object.
			</div><div class="para">
				Now, note that the returned <code class="literal">Widget</code> value has a field <code class="literal">child</code> that is also a <code class="literal">Widget</code>. If we want to hide the <code class="literal">child</code>'s <code class="literal">secret</code> value, rather than the field itself, we can use dot notation to specify this field's path within the result object's graph:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">WebRemote</span>(exclude = {<span xmlns="" class="perl_String">"child.secret"</span>}) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> Widget <span xmlns="" class="perl_Function">getWidget</span>();
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690454962704">
      ⁠</a>24.11.2. Constraining Maps and Collections</h2></div></div></div><div class="para">
				Objects within an object graph can also exist in a <code class="literal">Map</code> or a Collection (that is, a <code class="literal">List</code>, a <code class="literal">Set</code>, an <code class="literal">Array</code>, etc.). Collections are treated like any other field — for example, if our <code class="literal">Widget</code> contained a list of other <code class="literal">Widget</code>s in its <code class="literal">widgetList</code> field, we would constrain the <code class="literal">secret</code> field of the <code class="literal">Widget</code>s in this list with the following notation:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">WebRemote</span>(exclude = {<span xmlns="" class="perl_String">"widgetList.secret"</span>}) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> Widget <span xmlns="" class="perl_Function">getWidget</span>();
</pre><div class="para">
				To constrain a <code class="literal">Map</code>'s key or value, the notation is slightly different. Appending <code class="literal">[key]</code> after the <code class="literal">Map</code>'s field name constrains the <code class="literal">Map</code>'s key object values, while <code class="literal">[value]</code> constrains the value object values. The following example demonstrates how the values of the <code class="literal">widgetMap</code> field have their <code class="literal">secret</code> field constrained:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">WebRemote</span>(exclude = {<span xmlns="" class="perl_String">"widgetMap[value].secret"</span>}) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> Widget <span xmlns="" class="perl_Function">getWidget</span>();
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690505198336">
      ⁠</a>24.11.3. Constraining objects of a specific type</h2></div></div></div><div class="para">
				You can use square brackets to constrain the fields of an object type regardless of its location in the object graph. If the object is a Seam component, use the name of the component; if not, use the fully-qualified class name, like so:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">WebRemote</span>(exclude = {<span xmlns="" class="perl_String">"[widget].secret"</span>}) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> Widget <span xmlns="" class="perl_Function">getWidget</span>();
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690505195296">
      ⁠</a>24.11.4. Combining Constraints</h2></div></div></div><div class="para">
				Constraints can also be combined to filter objects from multiple paths within the object graph:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">WebRemote</span>(exclude = {<span xmlns="" class="perl_String">"widgetList.secret"</span>, <span xmlns="" class="perl_String">"widgetMap[value].secret"</span>}) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> Widget <span xmlns="" class="perl_Function">getWidget</span>();</pre></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690515605632">
      ⁠</a>24.12. Transactional Requests</h1></div></div></div><div class="para">
			By default, no transaction is active during a remoting request. If you wish to update the database during a remoting request, you must annotate the <code class="literal">@WebRemote</code> method with <code class="literal">@Transactional</code>, like so:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@WebRemote
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Transactional</span>(TransactionPropagationType.<span xmlns="" class="perl_Function">REQUIRED</span>) 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">updateOrder</span>(Order order) { 
<span xmlns="" class="line">​</span>    entityManager.<span xmlns="" class="perl_Function">merge</span>(order); 
<span xmlns="" class="line">​</span>}
</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690492782320">
      ⁠</a>24.13. JMS Messaging</h1></div></div></div><div class="para">
			Seam Remoting provides experimental support for JMS Messaging. This section describes currently-implemented JMS support. Note that this may change in the future. At present, we do not recommend using this feature within a production environment.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690493047200">
      ⁠</a>24.13.1. Configuration</h2></div></div></div><div class="para">
				Before you can subscribe to a JMS topic, you must first configure a list of the topics that Seam Remoting can subscribe to. List the topics under <code class="literal">org.jboss.seam.remoting.messaging.subscriptionRegistry. allowedTopics</code> in <code class="filename">seam.properties</code>, <code class="filename">web.xml</code> or <code class="filename">components.xml</code>:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;remoting:remoting</span><span xmlns="" class="perl_Others"> poll-timeout=</span><span xmlns="" class="perl_String">"5"</span><span xmlns="" class="perl_Others"> poll-interval=</span><span xmlns="" class="perl_String">"1"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690465874528">
      ⁠</a>24.13.2. Subscribing to a JMS Topic</h2></div></div></div><div class="para">
				The following example demonstrates how to subscribe to a JMS Topic:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>function <span xmlns="" class="perl_Function">subscriptionCallback</span>(message) { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">if</span> (message <span xmlns="" class="perl_Keyword">instanceof</span> Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">TextMessage</span>) 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Function">alert</span>(<span xmlns="" class="perl_String">"Received message: "</span> + message.<span xmlns="" class="perl_Function">getText</span>()); 
<span xmlns="" class="line">​</span>}           
<span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">subscribe</span>(<span xmlns="" class="perl_String">"topicName"</span>, subscriptionCallback);
</pre><div class="para">
				The <code class="literal">Seam.Remoting.subscribe()</code> method accepts two parameters: the name of the JMS topic to subscribe to, and the callback function to invoke when a message is received.
			</div><div class="para">
				Two message types are supported: Text messages, and Object messages. To test for the message type that is passed to your callback function, use the <code class="literal">instanceof</code> operator. This tests whether the message is a <code class="literal">Seam.Remoting.TextMessage</code> or <code class="literal">Seam.Remoting.ObjectMessage</code>. A <code class="literal">TextMessage</code> contains the text value in its <code class="literal">text</code> field. (You can also fetch this value by calling the object's <code class="literal">getText()</code> method.) An <code class="literal">ObjectMessage</code> contains its object value in its <code class="literal">value</code> field. (You can also fetch this value by calling the object's <code class="literal">getValue()</code> method.)
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690450117904">
      ⁠</a>24.13.3. Unsubscribing from a Topic</h2></div></div></div><div class="para">
				To unsubscribe from a topic, call <code class="literal">Seam.Remoting.unsubscribe()</code> and pass in the topic name:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">unsubscribe</span>(<span xmlns="" class="perl_String">"topicName"</span>);</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690528547936">
      ⁠</a>24.13.4. Tuning the Polling Process</h2></div></div></div><div class="para">
				Polling can be controlled and modified with two parameters.
			</div><div class="para">
				<code class="literal">Seam.Remoting.pollInterval</code> controls how long to wait between subsequent polls for new messages. This parameter is expressed in seconds, and its default setting is <code class="literal">10</code>.
			</div><div class="para">
				<code class="literal">Seam.Remoting.pollTimeout</code> is also expressed in seconds. It controls how long a request to the server should wait for a new message before timing out and sending an empty response. Its default is <code class="literal">0</code> seconds, which means that when the server is polled, if there are no messages ready for delivery, an empty response will be immediately returned.
			</div><div class="para">
				Use caution when setting a high <code class="literal">pollTimeout</code> value. Each request that has to wait for a message uses a server thread until either the message is received, or the request times out. If many such requests are served simultaneously, a large number of server threads will be used.
			</div><div class="para">
				We recommend setting these options in <code class="filename">components.xml</code>, but they can be overridden with JavaScript if desired. The following example demonstrates a more aggressive polling method. Set these parameters to values that suit your application:
			</div><div class="para">
				In <code class="filename">components.xml</code>:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;remoting:remoting</span><span xmlns="" class="perl_Others"> poll-timeout=</span><span xmlns="" class="perl_String">"5"</span><span xmlns="" class="perl_Others"> poll-interval=</span><span xmlns="" class="perl_String">"1"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre><div class="para">
				With Java:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">// Only wait 1 second between receiving a poll response and sending </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">// the next poll request. </span>
<span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">pollInterval</span> = <span xmlns="" class="perl_Float">1</span>; 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">// Wait up to 5 seconds on the server for new messages </span>
<span xmlns="" class="line">​</span>Seam.<span xmlns="" class="perl_Function">Remoting</span>.<span xmlns="" class="perl_Function">pollTimeout</span> = <span xmlns="" class="perl_Float">5</span>;
</pre></div></div></div></body></html>