<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 17. Seam Text</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="text">
      ⁠</a>Chapter 17. Seam Text</h1></div></div></div><div class="para">
		Collaboration-oriented websites require a human-friendly markup language so that formatted text can be entered easily in forum posts, wiki pages, blogs, comments, etc. Seam provides the <code class="literal">&lt;s:formattedText/&gt;</code> control to display formatted text that conforms to the <span class="emphasis"><em>Seam Text</em></span> language. Seam Text is implemented with an ANTLR-based parser. (Experience with ANTLR is not required.)
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690503104000">
      ⁠</a>17.1. Basic formatting</h1></div></div></div><div class="para">
			Here is a simple example: <code class="command">It's easy to make *emphasized*, |monospaced|, ~deleted~, super^scripted^ or _underlined_ text.</code>
		</div><div class="para">
			If we display this using <code class="literal">&lt;s:formattedText/&gt;</code>, the following HTML will be produced:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;p&gt;</span> 
<span xmlns="" class="line">​</span>  It's easy to make <span xmlns="" class="perl_Keyword">&lt;i&gt;</span>emphasized<span xmlns="" class="perl_Keyword">&lt;/i&gt;</span>, <span xmlns="" class="perl_Keyword">&lt;tt&gt;</span>monospaced<span xmlns="" class="perl_Keyword">&lt;/tt&gt;</span>, 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;del&gt;</span>deleted<span xmlns="" class="perl_Keyword">&lt;/del&gt;</span>, super<span xmlns="" class="perl_Keyword">&lt;sup&gt;</span>scripted<span xmlns="" class="perl_Keyword">&lt;/sup&gt;</span> or 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;u&gt;</span>underlined<span xmlns="" class="perl_Keyword">&lt;/u&gt;</span> text.
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/p&gt;</span></pre><div class="para">
			We can use a blank line to indicate a new paragraph, and <code class="literal">+</code> to indicate a heading:
		</div><pre class="screen">
        +This is a big heading
        You /must/ have some text following a heading!
        
        ++This is a smaller heading
        This is the first paragraph. We can split it across multiple 
        lines, but we must end it with a blank line.

        This is the second paragraph.
</pre><div class="para">
			A simple new line is ignored — you need an additional blank line to wrap text into a new paragraph. This is the HTML that results:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;h1&gt;</span>This is a big heading<span xmlns="" class="perl_Keyword">&lt;/h1&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;p&gt;</span>
<span xmlns="" class="line">​</span>  You <span xmlns="" class="perl_Keyword">&lt;i&gt;</span>must<span xmlns="" class="perl_Keyword">&lt;/i&gt;</span> have some text following a heading!
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/p&gt;</span>
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;h2&gt;</span>This is a smaller heading<span xmlns="" class="perl_Keyword">&lt;/h2&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;p&gt;</span>
<span xmlns="" class="line">​</span>  This is the first paragraph. We can split it across multiple 
<span xmlns="" class="line">​</span>  lines, but we must end it with a blank line.
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/p&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;p&gt;</span>
<span xmlns="" class="line">​</span>  This is the second paragraph.
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/p&gt;</span></pre><div class="para">
			The <code class="literal">#</code> character creates items in an ordered list. Unordered lists use the <code class="literal">=</code> character:
		</div><pre class="screen">
        An ordered list:
        
        #first item
        #second item
        #and even the /third/ item

        An unordered list:

        =an item
        =another item
</pre><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;p&gt;</span>
<span xmlns="" class="line">​</span>  An ordered list:
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/p&gt;</span>
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ol&gt;</span>       
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;li&gt;</span>first item<span xmlns="" class="perl_Keyword">&lt;/li&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;li&gt;</span>second item<span xmlns="" class="perl_Keyword">&lt;/li&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;li&gt;</span>and even the <span xmlns="" class="perl_Keyword">&lt;i&gt;</span>third<span xmlns="" class="perl_Keyword">&lt;/i&gt;</span> item<span xmlns="" class="perl_Keyword">&lt;/li&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/ol&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;p&gt;</span>
<span xmlns="" class="line">​</span>  An unordered list:
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/p&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ul&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;li&gt;</span>an item<span xmlns="" class="perl_Keyword">&lt;/li&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;li&gt;</span>another item<span xmlns="" class="perl_Keyword">&lt;/li&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/ul&gt;</span>
</pre><div class="para">
			Quoted sections should be surrounded in double quotes: 
		</div><pre class="screen">
        He said:
        
        "Hello, how are /you/?"

        She answered, "Fine, and you?"
</pre><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;p&gt;</span>
<span xmlns="" class="line">​</span>  He said:
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/p&gt;</span>
<span xmlns="" class="line">​</span>        
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;q&gt;</span>Hi, how are
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;i&gt;</span>you<span xmlns="" class="perl_Keyword">&lt;/i&gt;</span>?<span xmlns="" class="perl_Keyword">&lt;/q&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;p&gt;</span>
<span xmlns="" class="line">​</span>  She answered, <span xmlns="" class="perl_Keyword">&lt;q&gt;</span>Fine, and you?<span xmlns="" class="perl_Keyword">&lt;/q&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/p&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690466867280">
      ⁠</a>17.2. Entering code and text with special characters</h1></div></div></div><div class="para">
			Special characters such as <code class="literal">*</code>, <code class="literal">|</code> and <code class="literal">#</code>, and HTML characters such as <code class="literal">&lt;</code>, <code class="literal">&gt;</code> and <code class="literal">&amp;</code> can be escaped with <code class="literal">\</code>:
		</div><pre class="screen">You can write down equations like 2\*3\=6 and HTML tags like \&lt;body\&gt; using the escape character: \\.</pre><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;p&gt;</span> 
<span xmlns="" class="line">​</span>  You can write down equations like 2*3=6 and HTML tags
<span xmlns="" class="line">​</span>  like <span xmlns="" class="perl_DecVal">&amp;lt;</span>body<span xmlns="" class="perl_DecVal">&amp;gt;</span> using the escape character: \. 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/p&gt;</span></pre><div class="para">
			And we can quote code blocks with backticks:
		</div><pre class="screen">My code does not work:
  `for (int i=0; i&lt;100; i--)
       {
       doSomething();
       }`
Any ideas?</pre><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;p&gt;</span>
<span xmlns="" class="line">​</span>  My code does not work:
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/p&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;pre&gt;</span>for (int i=0; i<span xmlns="" class="perl_DecVal">&amp;lt;</span>100; i--)
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>    doSomething();
<span xmlns="" class="line">​</span>}<span xmlns="" class="perl_Keyword">&lt;/pre&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;p&gt;</span>
<span xmlns="" class="line">​</span>  Any ideas?
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/p&gt;</span></pre><div class="para">
			Since most monospace-formatted text is either code, or involves special characters, inline monospace formatting always escapes. So, you can write:
		</div><pre class="screen">This is a |&lt;tag attribute="value"/&gt;| example.</pre><div class="para">
			without escaping any of the characters inside the monospace bars. This also means that inline monospace text cannot be formatted in any other way.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690524757520">
      ⁠</a>17.3. Links</h1></div></div></div><div class="para">
			You can create a link like so:
		</div><pre class="screen">Go to the Seam website at [=&gt;http://jboss.com/products/seam].</pre><div class="para">
			If you want to specify the link text:
		</div><pre class="screen">Go to [the Seam website=&gt;http://jboss.com/products/seam].</pre><div class="para">
			For advanced users, you can also customize the Seam Text parser to understand wikiword links written in this syntax.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690519912064">
      ⁠</a>17.4. Entering HTML</h1></div></div></div><div class="para">
			Text can include a certain limited subset of HTML. (The subset was selected to remain safe from cross-site scripting attacks.) This is useful for creating links:
		</div><pre class="screen"><span xmlns="" class="line">​</span>You might want to link to 
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;a</span><span xmlns="" class="perl_Others"> href=</span><span xmlns="" class="perl_String">"http://jboss.com/products/seam"</span><span xmlns="" class="perl_Keyword">&gt;</span>something cool<span xmlns="" class="perl_Keyword">&lt;/a&gt;</span>, 
<span xmlns="" class="line">​</span>      or even include an image: <span xmlns="" class="perl_Keyword">&lt;img</span><span xmlns="" class="perl_Others"> src=</span><span xmlns="" class="perl_String">"/logo.jpg"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
			And for creating tables:
		</div><pre class="screen"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;table&gt;</span> 
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;tr&gt;&lt;td&gt;</span>First name:<span xmlns="" class="perl_Keyword">&lt;/td&gt;&lt;td&gt;</span>Gavin<span xmlns="" class="perl_Keyword">&lt;/td&gt;&lt;/tr&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;tr&gt;&lt;td&gt;</span>Last name:<span xmlns="" class="perl_Keyword">&lt;/td&gt;&lt;td&gt;</span>King<span xmlns="" class="perl_Keyword">&lt;/td&gt;&lt;/tr&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/table&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690456919904">
      ⁠</a>17.5. Using the SeamTextParser</h1></div></div></div><div class="para">
			The <code class="literal">&lt;s:formattedText/&gt;</code> JSF component uses the <code class="literal">org.jboss.seam.text.SeamTextParser</code> internally. You can use this class directly to implement your own text parsing, rendering, and HTML sanitation procedures. If you have a custom front-end interface for entering rich text, such as a JavaScript-based HTML editor, this can be useful for validating user input in order to defend against Cross-Site Scripting (XSS) attacks. You could also use it as a custom Wiki text-parsing and rendering engine.
		</div><div class="para">
			The following example defines a custom text parser, which overrides the default HTML sanitizer:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> MyTextParser <span xmlns="" class="perl_Keyword">extends</span> SeamTextParser {
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Function">MyTextParser</span>(String myText) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">super</span>(<span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">SeamTextLexer</span>(<span xmlns="" class="perl_Keyword">new</span> StringReader(myText)));
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Function">setSanitizer</span>(
<span xmlns="" class="line">​</span>                     <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">DefaultSanitizer</span>() {
<span xmlns="" class="line">​</span>                         @Override
<span xmlns="" class="line">​</span>                         <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">validateHtmlElement</span>(Token element) <span xmlns="" class="perl_Keyword">throws</span> SemanticException {
<span xmlns="" class="line">​</span>                             <span xmlns="" class="perl_Comment">// TODO: I want to validate HTML elements myself!</span>
<span xmlns="" class="line">​</span>                         }
<span xmlns="" class="line">​</span>                     }
<span xmlns="" class="line">​</span>                     );
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">// Customizes rendering of Seam text links such as [Some Text=&amp;gt;http://example.com]</span>
<span xmlns="" class="line">​</span>    @Override
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">protected</span> String <span xmlns="" class="perl_Function">linkTag</span>(String descriptionText, String linkText) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_String">"&amp;lt;a href=</span><span xmlns="" class="perl_Char">\"</span><span xmlns="" class="perl_String">"</span> + linkText + <span xmlns="" class="perl_String">"</span><span xmlns="" class="perl_Char">\"</span><span xmlns="" class="perl_String">&amp;gt;My Custom Link: "</span> + 
<span xmlns="" class="line">​</span>            descriptionText + <span xmlns="" class="perl_String">"&amp;lt;/a&amp;gt;"</span>;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">// Renders a &amp;lt;p&amp;gt; or equivalent tag</span>
<span xmlns="" class="line">​</span>    @Override
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">protected</span> String <span xmlns="" class="perl_Function">paragraphOpenTag</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_String">"&amp;lt;p class=</span><span xmlns="" class="perl_Char">\"</span><span xmlns="" class="perl_String">myCustomStyle</span><span xmlns="" class="perl_Char">\"</span><span xmlns="" class="perl_String">&amp;gt;"</span>;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">parse</span>() <span xmlns="" class="perl_Keyword">throws</span> ANTLRException {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Function">startRule</span>();
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>}</pre><div class="para">
			<code class="literal">linkTag()</code> and <code class="literal">paragraphOpenTag()</code> methods are two of the methods you can override in order to customize rendered output. These methods usually return <code class="literal">String</code> output. For further details, refer to the Java Documentation. The <code class="literal">org.jboss.seam.text.SeamTextParser.DefaultSanitizer</code> Java Documentation also contains more information about the HTML elements, attributes, and attribute values that are filtered by default.
		</div></div></div></body></html>