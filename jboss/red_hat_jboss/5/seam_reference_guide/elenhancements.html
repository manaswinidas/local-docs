<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 32. JBoss EL</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="elenhancements">
      ⁠</a>Chapter 32. JBoss EL</h1></div></div></div><div class="para">
		Seam uses JBoss EL to provide an extension to the standard Unified Expression Language (EL). This provides several enhancements to the expressiveness and power of EL expressions.
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690466810320">
      ⁠</a>32.1. Parameterized Expressions</h1></div></div></div><div class="para">
			Standard EL does not allow methods to be used with user-defined parameters, but JBoss EL removes this restriction. For example:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;h:commandButton</span><span xmlns="" class="perl_Others"> action=</span><span xmlns="" class="perl_String">"#{hotelBooking.bookHotel(hotel)}"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">                 value=</span><span xmlns="" class="perl_String">"Book Hotel"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"hotelBooking"</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> HotelBooking { 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">bookHotel</span>(Hotel hotel) { 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">// Book the hotel </span>
<span xmlns="" class="line">​</span>  } 
<span xmlns="" class="line">​</span>}
</pre><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690453813600">
      ⁠</a>32.1.1. Usage</h2></div></div></div><div class="para">
				As in method calls from Java, parameters are surrounded by parentheses, and separated by commas:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;h:commandButton</span><span xmlns="" class="perl_Others"> action=</span><span xmlns="" class="perl_String">"#{hotelBooking.bookHotel(hotel, user)}"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">                 value=</span><span xmlns="" class="perl_String">"Book Hotel"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
				Here, the parameters <code class="literal">hotel</code> and <code class="literal">user</code> will be evaluated as value expressions and passed to the <code class="literal">bookHotel()</code> method of the component.
			</div><div class="para">
				Any value expression can be used as a parameter:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;h:commandButton</span><span xmlns="" class="perl_Others"> action=</span><span xmlns="" class="perl_String">"#{hotelBooking.bookHotel(hotel.id, </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">                           user.username)}"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">                 value=</span><span xmlns="" class="perl_String">"Book Hotel"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
				When the page is rendered, the parameter names —<code class="literal">hotel.id</code> and <code class="literal">user.username</code> —are stored, and evaluated as value expressions when the page is submitted. Objects cannot be passed as parameters.
			</div><div class="para">
				Parameters must be available both when the page is rendered and when it is submitted. If the arguments cannot be resolved at page submission time, the action method will be called with <code class="literal">null</code> arguments.
			</div><div class="para">
				You can also pass literal strings using single quotes:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;h:commandLink</span><span xmlns="" class="perl_Others"> action=</span><span xmlns="" class="perl_String">"#{printer.println('Hello world!')}"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">               value=</span><span xmlns="" class="perl_String">"Hello"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
				Unified EL also supports value expressions, which are used to bind a field to a backing bean. Value expressions use JavaBean naming conventions and expect a getter/setter pair. JSF often expects a value expression where only retrieval (get) is required (for example, in the <code class="literal">rendered</code> attribute), but many objects do not have appropriately named property accessors, or do not require parameters.
			</div><div class="para">
				JBoss EL removes this restriction by allowing values to be retrieved using the method syntax. For example:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;h:outputText</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"#{person.name}"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">              rendered=</span><span xmlns="" class="perl_String">"#{person.name.length() &gt; 5}"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
				You can access the size of a collection in a similar manner:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>#{searchResults.<span xmlns="" class="perl_Function">size</span>()}
</pre><div class="para">
				In general, any expression of the form <code class="literal">#{obj.property}</code> would be identical to the expression <code class="literal">#{obj.getProperty()}</code>.
			</div><div class="para">
				Parameters are also allowed. The following example calls the <code class="literal">productsByColorMethod</code> with a literal string argument:
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>#{controller.<span xmlns="" class="perl_Function">productsByColor</span>('blue')}
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690448860736">
      ⁠</a>32.1.2. Limitations and Hints</h2></div></div></div><div class="para">
				JBoss EL does have several limitations:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<span class="emphasis"><em>Incompatibility with JSP 2.1</em></span> —JBoss EL cannot currently be used with JSP 2.1, because the compiler rejects expressions that include parameters. You will need Facelets if you want to use this extension with JSF 1.2. The extension works correctly with JSP 2.0.
					</div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em>Use inside iterative components</em></span> —Components like <code class="literal">&lt;c:forEach /&gt;</code> and <code class="literal">&lt;ui:repeat /&gt;</code> iterate over a list or array, exposing each item in the list to nested components. This is effective if you are selecting a row with a <code class="literal">&lt;h:commandButton /&gt;</code> or <code class="literal">&lt;h:commandLink /&gt;</code> like so:
					</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Factory</span>(<span xmlns="" class="perl_String">"items"</span>) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> List&lt;Item&gt; <span xmlns="" class="perl_Function">getItems</span>() { 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">return</span> entityManager.<span xmlns="" class="perl_Function">createQuery</span>(<span xmlns="" class="perl_String">"select ..."</span>).<span xmlns="" class="perl_Function">getResultList</span>(); 
<span xmlns="" class="line">​</span>}
</pre><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;h:dataTable</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"#{items}"</span><span xmlns="" class="perl_Others"> var=</span><span xmlns="" class="perl_String">"item"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;h:column&gt;</span> 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;h:commandLink</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"Select #{item.name}"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">       action=</span><span xmlns="" class="perl_String">"#{itemSelector.select(item})"</span> <span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/h:column&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/h:dataTable&gt;</span>
</pre><div class="para">
						However, if you want to use <code class="literal">&lt;s:link /&gt;</code> or <code class="literal">&lt;s:button /&gt;</code> you must expose the items as a <code class="literal">DataModel</code>, and use a <code class="literal">&lt;dataTable /&gt;</code> (or equivalent from a component set like <code class="literal">&lt;rich:dataTable /&gt;</code>). Neither <code class="literal">&lt;s:link /&gt;</code> or <code class="literal">&lt;s:button /&gt;</code> submit the form, so they do not produce a bookmarkable link. An additional parameter is required to recreate the item when the action method is called. This parameter can only be added when a data table backed by a <code class="literal">DataModel</code> is used. 
					</div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em>Calling a <code class="literal">MethodExpression</code> from Java code</em></span> —Normally, when a <code class="literal">MethodExpression</code> is created, the parameter types are passed in by JSF. However, in a method binding, JSF assumes that there are no parameters to pass. With this extension, there is no way to know the parameter types prior to expression evaluation. This has two minor consequences:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								When you invoke a <code class="literal">MethodExpression</code> in Java code, parameters you pass may be ignored. Parameters defined in the expression will take precedence.
							</div></li><li class="listitem"><div class="para">
								Ordinarily, it is safe to call <code class="literal">methodExpression.getMethodInfo().getParamTypes()</code> at any time. For an expression with parameters, you must first invoke the <code class="literal">MethodExpression</code> before calling <code class="literal">getParamTypes()</code>.
							</div></li></ul></div><div class="para">
						Both of these cases are exceedingly rare and only apply when you want to invoke the <code class="literal">MethodExpression</code> by hand in Java code.
					</div></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690505806336">
      ⁠</a>32.2. Projection</h1></div></div></div><div class="para">
			JBoss EL supports a limited projection syntax. A projection expression maps a sub-expression across a multi-valued (list, set, etc...) expression. For instance, the expression:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>#{company.<span xmlns="" class="perl_Function">departments</span>}
</pre><div class="para">
			might return a list of departments. If you only need a list of department names, you must iterate over the list to retrieve the values. JBoss EL allows this with a projection expression:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>#{company.<span xmlns="" class="perl_Function">departments</span>.{d|d.<span xmlns="" class="perl_Function">name</span>}}
</pre><div class="para">
			The sub-expression is enclosed in braces. In this example, the expression <code class="literal">d.name</code> is evaluated for each department, using <code class="literal">d</code> as an alias to the department object. The result of this expression will be a list of String values.
		</div><div class="para">
			Any valid expression can be used in an expression, so —assuming you would use department names of all lengths in a company —it would also be valid to write the following:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>#{company.<span xmlns="" class="perl_Function">departments</span>.{d|d.<span xmlns="" class="perl_Function">size</span>()}}
</pre><div class="para">
			Projections can be nested. The following expression returns the last names of every employee in every department:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>#{company.<span xmlns="" class="perl_Function">departments</span>.{d|d.<span xmlns="" class="perl_Function">employees</span>.{emp|emp.<span xmlns="" class="perl_Function">lastName</span>}}}
</pre><div class="para">
			Nested projections can be slightly tricky, however. The following expression appears to return a list of all employees in all departments:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>#{company.<span xmlns="" class="perl_Function">departments</span>.{d|d.<span xmlns="" class="perl_Function">employees</span>}}
</pre><div class="para">
			However, it actually returns a list containing a list of the employees for each individual department. To combine the values, it is necessary to use a slightly longer expression:
		</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>#{company.<span xmlns="" class="perl_Function">departments</span>.{d|d.<span xmlns="" class="perl_Function">employees</span>.{e|e}}}
</pre><div class="para">
			This syntax cannot be parsed by either Facelets or JSP, so it cannot be used in XHTML or JSP files. Future versions of JBoss EL may accommodate the projection syntax more easily.
		</div></div></div></body></html>