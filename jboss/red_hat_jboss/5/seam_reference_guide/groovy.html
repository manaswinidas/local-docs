<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 12. Groovy integration</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="groovy">
      ⁠</a>Chapter 12. Groovy integration</h1></div></div></div><div class="para">
		Seam has a great capability for Rapid Application Development (RAD). Seam allows you to utilize dynamic languages with your existing platform, while retaining compatibility with standard Java APIs. Static and dynamic languages are integrated, so there is no need for context-switching, and you can use the same annotations and APIs to write a dynamic Seam component as you would for a regular Seam component.
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690518644912">
      ⁠</a>12.1. Groovy introduction</h1></div></div></div><div class="para">
			Groovy is an agile, Java-based dynamic language, with additional features inspired by Python, Ruby, and Smalltalk. Being Java-based, with Java objects and classes, Groovy is easy to learn and integrates seamlessly with existing Java libraries and frameworks.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690526621632">
      ⁠</a>12.2. Writing Seam applications in Groovy</h1></div></div></div><div class="para">
			Since Groovy objects are Java objects, any Seam component can be written and deployed with Groovy. You can also combine Groovy and Java classes in the same application.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690517996048">
      ⁠</a>12.2.1. Writing Groovy components</h2></div></div></div><div class="para">
				You will need to use Groovy 1.1 or higher to support annotations. The rest of this chapter shows how to use Groovy in a Seam application.
			</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139690453686128">
      ⁠</a>12.2.1.1. Entity</h3></div></div></div><div class="example"><a id="idm139690453843920">
      ⁠</a><p class="title"><strong>Example 12.1. Using Groovy in a Seam Application</strong></p><div class="example-contents"><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@Entity
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"hotel"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">class</span> Hotel <span xmlns="" class="perl_Keyword">implements</span> Serializable {
<span xmlns="" class="line">​</span>    @Id @GeneratedValue
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_DataType">Long</span> id
<span xmlns="" class="line">​</span>          
<span xmlns="" class="line">​</span>        @<span xmlns="" class="perl_Function">Length</span>(max=<span xmlns="" class="perl_Float">50</span>) @NotNull
<span xmlns="" class="line">​</span>        String name
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        @<span xmlns="" class="perl_Function">Length</span>(max=<span xmlns="" class="perl_Float">100</span>) @NotNull
<span xmlns="" class="line">​</span>        String address
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        @<span xmlns="" class="perl_Function">Length</span>(max=<span xmlns="" class="perl_Float">40</span>) @NotNull
<span xmlns="" class="line">​</span>        String city
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        @<span xmlns="" class="perl_Function">Length</span>(min=<span xmlns="" class="perl_Float">2</span>, max=<span xmlns="" class="perl_Float">10</span>) @NotNull
<span xmlns="" class="line">​</span>        String state
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        @<span xmlns="" class="perl_Function">Length</span>(min=<span xmlns="" class="perl_Float">4</span>, max=<span xmlns="" class="perl_Float">6</span>) @NotNull
<span xmlns="" class="line">​</span>        String zip
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        @<span xmlns="" class="perl_Function">Length</span>(min=<span xmlns="" class="perl_Float">2</span>, max=<span xmlns="" class="perl_Float">40</span>) @NotNull
<span xmlns="" class="line">​</span>        String country
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        @<span xmlns="" class="perl_Function">Column</span>(precision=<span xmlns="" class="perl_Float">6</span>, scale=<span xmlns="" class="perl_Float">2</span>)
<span xmlns="" class="line">​</span>        BigDecimal price
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        @Override
<span xmlns="" class="line">​</span>        String <span xmlns="" class="perl_Function">toString</span>(){
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_String">"Hotel(${name},${address},${city},${zip})"</span>
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
</pre></div></div><div class="para">
					Since Groovy supports properties, there is no need to explicitly write verbose getters and setters. In the previous example, the hotel class can be accessed from Java as <code class="code">hotel.getCity()</code> — the getters and setters are generated by the Groovy compiler. This makes the entity code very concise.
				</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690508329552">
      ⁠</a>12.2.2. Seam component</h2></div></div></div><div class="para">
				You can write Seam components in Groovy exactly as you would in Java: annotations mark classes as Seam components.
			</div><div class="example"><a id="idm139690518064864">
      ⁠</a><p class="title"><strong>Example 12.2. Writing Seam Components in Groovy</strong></p><div class="example-contents"><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Scope</span>(ScopeType.<span xmlns="" class="perl_Function">SESSION</span>)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Name</span>(<span xmlns="" class="perl_String">"bookingList"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">class</span> BookingListAction <span xmlns="" class="perl_Keyword">implements</span> Serializable
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>    @In EntityManager em
<span xmlns="" class="line">​</span>    @In User user
<span xmlns="" class="line">​</span>    @DataModel List&lt;Booking&gt; bookings
<span xmlns="" class="line">​</span>    @DataModelSelection Booking booking
<span xmlns="" class="line">​</span>    @Logger Log log
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    @Factory 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">getBookings</span>()
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>        bookings = em.<span xmlns="" class="perl_Function">createQuery</span>(<span xmlns="" class="perl_Char">'''</span>
<span xmlns="" class="line">​</span>        select b from Booking b
<span xmlns="" class="line">​</span>        where b.<span xmlns="" class="perl_Function">user</span>.<span xmlns="" class="perl_Function">username</span> = :username
<span xmlns="" class="line">​</span>        order by b.<span xmlns="" class="perl_Function">checkinDate</span><span xmlns="" class="perl_Char">'''</span>).
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Function">setParameter</span>(<span xmlns="" class="perl_String">"username"</span>, user.<span xmlns="" class="perl_Function">username</span>).
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Function">getResultList</span>()
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>        
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">cancel</span>()
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>        log.<span xmlns="" class="perl_Function">info</span>(<span xmlns="" class="perl_String">"Cancel booking: #{bookingList.booking.id} </span>
<span xmlns="" class="line">​</span>                 <span xmlns="" class="perl_Keyword">for</span> #{user.<span xmlns="" class="perl_Function">username</span>}<span xmlns="" class="perl_String">")</span>
<span xmlns="" class="line">​</span>        Booking cancelled = em.<span xmlns="" class="perl_Function">find</span>(Booking.<span xmlns="" class="perl_Function">class</span>, booking.<span xmlns="" class="perl_Function">id</span>)
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">if</span> (cancelled != <span xmlns="" class="perl_Keyword">null</span>) em.<span xmlns="" class="perl_Function">remove</span>( cancelled )
<span xmlns="" class="line">​</span>           <span xmlns="" class="perl_Function">getBookings</span>()
<span xmlns="" class="line">​</span>           FacesMessages.<span xmlns="" class="perl_Function">instance</span>().<span xmlns="" class="perl_Function">add</span>(<span xmlns="" class="perl_String">"Booking cancelled for confirmation </span>
<span xmlns="" class="line">​</span>                                         number #{bookingList.<span xmlns="" class="perl_Function">booking</span>.<span xmlns="" class="perl_Function">id</span>}<span xmlns="" class="perl_String">", </span>
<span xmlns="" class="line">​</span>                                         <span xmlns="" class="perl_Keyword">new</span> Object[<span xmlns="" class="perl_Float">0</span>])
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690450429216">
      ⁠</a>12.2.3. seam-gen</h2></div></div></div><div class="para">
				Seam-gen interacts transparently with Groovy. No additional infrastructure is required to include Groovy code in seam-gen-backed projects — when writing an entity, just place your <code class="filename">.groovy</code> files in <code class="filename">src/main</code>. When writing an action, place your <code class="filename">.groovy</code> files in <code class="filename">src/hot</code>.
			</div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139690503227280">
      ⁠</a>12.3. Deployment</h1></div></div></div><div class="para">
			Deploying Groovy classes works like deploying Java classes. As with JavaBeans component classes, Seam can redeploy GroovyBeans component classes without restarting the application.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690538255280">
      ⁠</a>12.3.1. Deploying Groovy code</h2></div></div></div><div class="para">
				Groovy entities, session beans, and components all require compilation to deploy — use the <code class="literal">groovyc</code> ant task. Once compiled, a Groovy class is identical to a Java class, and the application server will treat them equally. This allows a seamless mix of Groovy and Java code.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690532119616">
      ⁠</a>12.3.2. Native .groovy file deployment at development time</h2></div></div></div><div class="para">
				Seam supports <code class="filename">.groovy</code> file hot deployment (deployment without compilation) in incremental hot deployment mode. This mode is development-only, and enables a fast edit/test cycle. Follow the configuration instructions at <a class="xref" href="gettingstarted.html#gettingstarted-hotdeployment">Section 3.8, “Seam and incremental hot deployment”</a> to set up <code class="filename">.groovy</code> hot deployment. Deploy your Groovy code (<code class="filename">.groovy</code> files) into the <code class="filename">WEB-INF/dev</code> directory. The GroovyBean components will deploy incrementally, without needing to restart either application or application server.
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The native <code class="filename">.groovy</code> file deployment has the same limitations as the regular Seam hot deployment:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							components must be either JavaBeans or GroovyBeans — they cannot be EJB3 beans.
						</div></li><li class="listitem"><div class="para">
							entities cannot be hot deployed.
						</div></li><li class="listitem"><div class="para">
							hot-deployable components are not visible to any classes deployed outside <code class="literal">WEB-INF/dev</code>.
						</div></li><li class="listitem"><div class="para">
							Seam debug mode must be enabled.
						</div></li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139690531560736">
      ⁠</a>12.3.3. seam-gen</h2></div></div></div><div class="para">
				Seam-gen transparently supports Groovy file deployment and compilation. This includes the native <code class="filename">.groovy</code> file hot deployment available during development. In WAR-type projects, Java and Groovy classes in <code class="filename">src/hot</code> are automatic candidates for incremental hot deployment. In production mode, Groovy files will be compiled prior to deployment.
			</div><div class="para">
				There is a Booking demonstration, written completely in Groovy and supporting incremental hot deployment, in <code class="filename">examples/groovybooking</code>.
			</div></div></div></div></body></html>