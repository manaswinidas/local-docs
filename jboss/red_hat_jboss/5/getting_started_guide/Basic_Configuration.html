<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 5. Basic Configuration Changes</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="Basic_Configuration">
      ⁠</a>Chapter 5. Basic Configuration Changes</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Security-Configuration">
      ⁠</a>5.1. Security Configuration</h1></div></div></div><div class="para">
			When installed from the zip archive, authentication is required to access the majority of JBoss services, including administrative services. Consoles are secured by the JAAS security domain "jmx-console". At installation, this security domain has no user accounts. This is to eliminate the possibility of default username/password based attacks. Refer to <a class="xref" href="Basic_Configuration.html#proc-Create_Users">Procedure 5.1, “Create jmx-console, admin-console, and http invoker user account”</a> to create a user account to access the consoles.
		</div><div class="para">
			When installed via the graphical installer, a JAAS security domain and a user account is created as part of the install process. Even if you change the name of the JAAS security domain during installation, the users are stored in the same place. Follow the instructions in <a class="xref" href="Basic_Configuration.html#proc-Create_Users">Procedure 5.1, “Create jmx-console, admin-console, and http invoker user account”</a> to edit your user account, or create a new one.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				This section describes only basic security configuration. This configuration is not sufficient for use in production environment. Refer to the <em class="citetitle">Security Guide</em> for comprehensive information on how to configure security in JBoss Enterprise Application Platform 5.
			</div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				The authentication system applied to the JMX Console, Admin Console and Web Console does not block brute-force password attacks. It is recommended that in production environments, JBoss servers are protected by firewalls or reverse proxies that include measures to mitigate brute force attacks.
			</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm140132744092720">
      ⁠</a>5.1.1. Security Configuration: JMX Console, Admin Console, HttpInvoker</h2></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="proc-Create_Users">
      ⁠</a><p class="title"><strong>Procedure 5.1. Create jmx-console, admin-console, and http invoker user account</strong></p><div class="para">
					This procedure creates user with access permissions to the admin and jmx consoles, and the http invoker
				</div><ol class="1"><li class="step"><p class="title"><strong>Create a user in the default JAAS security domain</strong></p><ol class="substeps a"><li class="step"><div class="para">
								Edit the file <code class="filename">$JBOSS_HOME/server/$PROFILE/conf/props/jmx-console-users.properties</code>.
							</div></li><li class="step"><div class="para">
								Create a <em class="replaceable">username</em> = <em class="replaceable">password</em> pair.
							</div><div class="important"><div class="admonition_header"><p><strong>Default admin user configuration</strong></p></div><div class="admonition"><div class="para">
									The commented <code class="literal">admin=admin</code> username and password pair is an example of the username/password definition syntax. Do not use this for your user account.
								</div></div></div></li></ol></li><li class="step"><p class="title"><strong>Grant permissions to user</strong></p><ol class="substeps a"><li class="step"><div class="para">
								Edit the file <code class="filename">$JBOSS_HOME/server/$PROFILE/conf/props/jmx-console-roles.properties</code>.
							</div></li><li class="step"><div class="para">
								Create an entry for the user of the form:
							</div><pre class="programlisting"><em class="replaceable">username</em>=JBossAdmin,HttpInvoker</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term">JBossAdmin</span></dt><dd><div class="para">
											Grant the user permission to access the JMX Console and Admin Console.
										</div></dd><dt><span class="term">HttpInvoker</span></dt><dd><div class="para">
											Grant the user permission to access the httpinvoker
										</div></dd></dl></div></li></ol></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Adminstration_Console_User_Guide-Configuration-Security-HTTPInvoker">
      ⁠</a>5.1.2. Securing the HTTPInvoker</h2></div></div></div><div class="para">
				The HTTP Invoker is a service that provides HTTP and Remote Method Invocation (RMI) access for EJBs and the JNDI Naming service. Secure this service to prevent unauthorized access.
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140132691159296">
      ⁠</a><p class="title"><strong>Procedure 5.2. Secure the HTTP Invoker</strong></p><ol class="1"><li class="step"><div class="para">
						Edit the <code class="filename"><em class="replaceable">&lt;JBOSS_HOME&gt;</em>/server/<em class="replaceable">&lt;PROFILE&gt;</em>/conf/bindingservice.beans/META-INF/bindings-jboss-beans.xml</code> file.
					</div></li><li class="step"><div class="para">
						Add the <em class="parameter"><code>hostName</code></em> and <em class="parameter"><code>fixedHostName</code></em> properties to the <span class="emphasis"><em>deploy/legacy-invokers-service.xml</em></span> section:
					</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- ************ deploy/legacy-invokers-service.xml ************ --&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- RMI/JRMP invoker --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.services.binding.ServiceBindingMetadata"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"serviceName"</span><span xmlns="" class="perl_Keyword">&gt;</span>jboss:service=invoker,type=jrmp<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"port"</span><span xmlns="" class="perl_Keyword">&gt;</span>4444<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"description"</span><span xmlns="" class="perl_Keyword">&gt;</span>Socket for the legacy RMI/JRMP invoker<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hostName"</span><span xmlns="" class="perl_Keyword">&gt;</span>localhost<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"fixedHostName"</span><span xmlns="" class="perl_Keyword">&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Pooled invoker --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.services.binding.ServiceBindingMetadata"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"serviceName"</span><span xmlns="" class="perl_Keyword">&gt;</span>jboss:service=invoker,type=pooled<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"port"</span><span xmlns="" class="perl_Keyword">&gt;</span>4445<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"description"</span><span xmlns="" class="perl_Keyword">&gt;</span>Socket for the legacy Pooled invoker<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hostName"</span><span xmlns="" class="perl_Keyword">&gt;</span>localhost<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"fixedHostName"</span><span xmlns="" class="perl_Keyword">&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
</pre></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm140132742124304">
      ⁠</a>5.1.3. Security Configuration: Web Console</h2></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="proc-Create_User_Web_Console">
      ⁠</a><p class="title"><strong>Procedure 5.3. Creating Web Console User Account</strong></p><div class="para">
					This procedure creates a user with access permissions to the web console
				</div><ol class="1"><li class="step"><p class="title"><strong>Create a user in the web-console JAAS security domain.</strong></p><ol class="substeps a"><li class="step"><div class="para">
								Edit the file <code class="filename">web-console-users.properties</code> in <code class="filename">jboss-as/server/$PROFILE/deploy/management/console-mgr.sar/web-console.war/WEB-INF/classes/</code>.
							</div></li><li class="step"><div class="para">
								Create a <em class="replaceable">username</em> = <em class="replaceable">password</em> pair.
							</div><div class="important"><div class="admonition_header"><p><strong>Default admin user configuration</strong></p></div><div class="admonition"><div class="para">
									The commented <code class="literal">admin=admin</code> username and password is an example of the username/password definition syntax. Do not use this for your user account.
								</div></div></div></li></ol></li><li class="step"><p class="title"><strong>Grant permissions to the user.</strong></p><ol class="substeps a"><li class="step"><div class="para">
								Edit the file <code class="filename">web-console-roles.properties</code> in <code class="filename">jboss-as/server/$PROFILE/deploy/management/console-mgr.sar/web-console.war/WEB-INF/classes/</code>.
							</div></li><li class="step"><div class="para">
								Create an entry for the user of the form:
							</div><pre class="programlisting"><em class="replaceable">username</em>=JBossAdmin,HttpInvoker
</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term">JBossAdmin</span></dt><dd><div class="para">
											Grant the user permission to access the Web-Console
										</div></dd><dt><span class="term">HttpInvoker</span></dt><dd><div class="para">
											Grant the user permission to access the HTTP Invoker
										</div></dd></dl></div></li></ol></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm140132690399232">
      ⁠</a>5.1.4. Security Configuration of JBoss Messaging</h2></div></div></div><div class="para">
				JBoss Messaging makes internal connections between nodes in order to redistribute messages between clustered destinations. These connections are made with the user name of a special reserved user whose password is specified in the property <code class="literal">suckerPassword</code> in the messaging and server configuration files.
			</div><div class="para">
				The suckerPassword used by JBoss Messaging in a clustered environment is contained in the <code class="filename">jboss-as/server/$PROFILE/deploy/messaging/messaging-jboss-beans.xml</code> file and the <code class="filename">messaging-service.xml</code> file. These files contain directives that specify the encrypted <code class="literal">suckerPassword</code>.
			</div><div class="task"><a id="task-Set_SuckerPassword">
      ⁠</a><p class="title"><strong>Changing the Password in <code class="filename">messaging-jboss-beans.xml</code></strong></p><div class="tasksummary"> <div class="para">
				Complete this task to change the distribution placeholder password in <code class="filename">messaging-jboss-beans.xml</code>.
			</div>
			 </div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140132690392448">
      ⁠</a><p class="title"><strong>Procedure 5.4. Setting suckerPassword for JBoss Messaging</strong></p><ol class="1"><li class="step"><div class="para">
						Navigate to the <code class="filename"><em class="replaceable">&lt;JBOSS_HOME&gt;</em>/server/<em class="replaceable">&lt;PROFILE&gt;</em>/deploy/messaging/</code> directory.
					</div></li><li class="step"><div class="para">
						Open the <code class="filename">messaging-jboss-beans.xml</code> file in your preferred text editor.
					</div></li><li class="step"><div class="para">
						Change the <em class="parameter"><code>suckerPassword</code></em> placeholder value from <code class="literal">"CHANGE ME!!"</code> to a plain text password:
					</div><pre class="programlisting">&lt;property name="suckerPassword"&gt;CHANGE ME!!&lt;/property&gt;
</pre><div class="para">
						Make note of the new password; it will be used in the next task.
					</div></li><li class="step"><div class="para">
						Save the file.
					</div></li></ol></div></div><div class="task"><a id="task-Generate_suckerPassword_Encrypted">
      ⁠</a><p class="title"><strong>Creating the encrypted JBoss Messaging suckerPassword</strong></p><div class="tasksummary"> <div class="para">
				Complete this task to create an encrypted suckerPassword using the JBoss Messaging SecurityUtil tool.
			</div>
			 </div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><ol class="1"><li class="step"><div class="para">
						In a terminal, change to <code class="filename"><em class="replaceable">&lt;JBOSS_HOME&gt;</em>/server/<em class="replaceable">&lt;PROFILE&gt;</em>/deploy/messaging/</code>.
					</div></li><li class="step"><div class="para">
						Run the following command:
					</div><pre class="programlisting"><em class="replaceable">/path/to/java/executable</em> -cp <em class="replaceable">JBOSS_HOME</em>/client/jboss-messaging-client.jar org.jboss.messaging.util.SecurityUtil <em class="replaceable">PLAIN_TEXT_PASSWORD</em></pre></li><li class="step"><div class="para">
						<em class="replaceable">PLAIN_TEXT_PASSWORD</em> is the password you set in <code class="filename">messaging-jboss-beans.xml</code> in the previous task.
					</div><div class="para">
						As an example:
					</div><div class="example"><a id="idm140132739500944">
      ⁠</a><p class="title"><strong>Example 5.1. Test Encrypted Password</strong></p><div class="example-contents"><div class="para">
							Running the following command (from the <code class="filename"><em class="replaceable">JBOSS_HOME</em>/jboss-as/server/$PROFILE/deploy/messaging/</code> directory) ...
						</div><pre class="programlisting"><code class="command">/usr/bin/java -cp ../../../../client/jboss-messaging-client.jar org.jboss.messaging.util.SecurityUtil test</code></pre><div class="para">
							...produced the following encrypted password:
						</div><pre class="screen">key len: 14 length max: 2147483647
Encoded password: 5e2c1ae5a618317
</pre></div></div></li><li class="step"><div class="para">
						Make note of the encrypted password output; it will be used in the next task.
					</div></li></ol></div></div><div class="task"><a id="task-Set_suckerPassword">
      ⁠</a><p class="title"><strong>Specifying an encrypted suckerPassword for JBoss Messaging</strong></p><div class="tasksummary"> <div class="para">
				Complete this task to add an encrypted suckerPassword value to JBoss Messaging configuration files.
			</div>
			 </div><div class="taskprerequisites"><a id="idm140132739493216">
      ⁠</a><p class="title"><strong>Prerequisites</strong></p><div class="taskprerequisites-contents"> 
			 <div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a class="xref" href="Basic_Configuration.html#task-Generate_suckerPassword_Encrypted">Creating the encrypted JBoss Messaging suckerPassword</a>
					</div></li><li class="listitem"><div class="para">
						You have a terminal open at the <code class="filename"><em class="replaceable">&lt;JBOSS_HOME&gt;</em>/server/<em class="replaceable">&lt;PROFILE&gt;</em>/deploy/messaging/</code> directory.
					</div></li></ul></div>
			 </div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><ol class="1"><li class="step"><div class="para">
						In a text editor, open the <code class="filename">messaging-service.xml</code> file.
					</div></li><li class="step"><div class="para">
						Paste the encrypted password from the previous procedure into the <em class="parameter"><code>SuckerPassword</code></em> attribute:
					</div><pre class="programlisting">&lt;attribute name="SuckerPassword"&gt;<em class="replaceable">ENCRYPTED_PASSWORD</em>&lt;/attribute&gt;</pre></li><li class="step"><div class="para">
						Save the <code class="filename">messaging-service.xml</code> file.
					</div></li></ol></div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Adjust_Memory_Settings">
      ⁠</a>5.2. Memory Settings for the Enterprise Application Platform</h1></div></div></div><div class="para">
			The optimal memory settings for an application server depend on the deployed applications, the number of users, the virtual or physical host upon which the installation resides, and services running on the host.
		</div><div class="para">
			The Enterprise Application Platform ships with the following default values for initial and maximum heap allocations by the JVM:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="literal">-Xms1303m</code>: initial heap size in megabytes
				</div></li><li class="listitem"><div class="para">
					<code class="literal">-Xmx1303m</code>: maximum heap size in megabytes
				</div></li></ul></div><div class="para">
			Follow the guidelines below when defining memory settings:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					Allocate the same values for initial and maximum heap sizes.
				</div></li><li class="listitem"><div class="para">
					Use values smaller than the host's allocatable memory.
				</div></li><li class="listitem"><div class="para">
					Be aware of other services and applications running on the host, and allow for their usage of memory.
				</div></li></ul></div><div class="para">
			Fine tuning the memory settings beyond these guidelines requires production-like load testing and analysis of memory usage logs, and can vary dramatically between installations and applications used with the JBoss Enterprise Application Platform.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140132739471392">
      ⁠</a><p class="title"><strong>Procedure 5.5. Changing Memory Settings for the Enterprise Application Platform on Linux</strong></p><ol class="1"><li class="step"><div class="para">
					Navigate to <code class="filename"><em class="replaceable">$JBOSS_HOME</em>/jboss-as/bin</code>.
				</div></li><li class="step"><div class="para">
					Open <code class="filename">run.conf</code> for editing.
				</div></li><li class="step"><div class="para">
					Locate the line with the memory options:
				</div><pre class="programlisting">JAVA_OPTS="-Xms1303m -Xmx1303m -XX:MaxPermSize=256m -Dorg.jboss.resolver.warning=true -Dsun.rmi.dgc.client.gcInterval=3600000 -Dsun.rmi.dgc.server.gcInterval=3600000 -Dsun.lang.ClassLoader.allowArraySyntax=true"</pre></li><li class="step"><div class="para">
					Edit the line to include the new initial and maximum heap sizes for the JVM:
				</div><pre class="programlisting">JAVA_OPTS="-Xms<em class="replaceable">INITIAL_HEAP_SIZE</em> -Xmx<em class="replaceable">MAX_HEAP_SIZE</em> -XX:MaxPermSize=256m -Dorg.jboss.resolver.warning=true -Dsun.rmi.dgc.client.gcInterval=3600000 -Dsun.rmi.dgc.server.gcInterval=3600000 -Dsun.lang.ClassLoader.allowArraySyntax=true"</pre></li><li class="step"><div class="para">
					If the server is runnning, restart it to apply the new settings.
				</div></li></ol></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140132739462016">
      ⁠</a><p class="title"><strong>Procedure 5.6. Changing Memory Settings for the Enterprise Application Platform on Windows</strong></p><ol class="1"><li class="step"><div class="para">
					Navigate to <code class="filename"><em class="replaceable">$JBOSS_HOME</em>/jboss-as/bin</code>.
				</div></li><li class="step"><div class="para">
					Open <code class="filename">run.conf.bat</code> for editing.
				</div></li><li class="step"><div class="para">
					Locate the line with the memory options:
				</div><div class="para">
					
<pre class="programlisting">set "JAVA_OPTS=-Xms1303m -Xmx1303m -XX:MaxPermSize=256m -Dorg.jboss.resolver.warning=true
-Dsun.rmi.dgc.client.gcInterval=3600000 -Dsun.rmi.dgc.server.gcInterval=3600000
-Dsun.lang.ClassLoader.allowArraySyntax=true"</pre>

				</div></li><li class="step"><div class="para">
					Edit the line to include the new initial and maximum heap sizes for the JVM:
				</div><pre class="programlisting">set "JAVA_OPTS=-Xms<em class="replaceable">INITIAL_HEAP_SIZE</em>m -Xmx<em class="replaceable">MAX_HEAP_SIZE</em>m -XX:MaxPermSize=256m -Dorg.jboss.resolver.warning=true -Dsun.rmi.dgc.client.gcInterval=3600000 -Dsun.rmi.dgc.server.gcInterval=3600000 -Dsun.lang.ClassLoader.allowArraySyntax=true"
</pre></li><li class="step"><div class="para">
					If the server is runnning, restart it to apply the new settings.
				</div></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Setting_your_application_as_the_default_application">
      ⁠</a>5.3. Setting the Default Server Application</h1></div></div></div><div class="para">
			JBoss Enterprise Application Platform, by default, configures <code class="filename"><em class="replaceable">&lt;JBOSS_HOME&gt;</em>/jboss-as/server/<em class="replaceable">&lt;PROFILE&gt;</em>/deploy/ROOT.war</code> as the default application on the server. So accessing <code class="literal">http://localhost:8080/</code> results in displaying the index page of this application. If you want your application to be available as the default application, then you will wish to follow these steps:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					Rename <code class="filename">ROOT.war</code> in <code class="filename"><em class="replaceable">&lt;JBOSS_HOME&gt;</em>/jboss-as/server/<em class="replaceable">&lt;PROFILE&gt;</em>/deploy</code> to something else, for example, <code class="filename">jboss.war</code>.
				</div></li><li class="listitem"><div class="para">
					In your WAR file (the one which you want to be the default application), add a <code class="filename">jboss-web.xml</code>, in the <code class="filename">WEB-INF</code> folder, with a configuration for the context-root:
				</div><pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">&lt;!DOCTYPE </span>jboss-web PUBLIC "-//JBoss//DTD Web Application 5.0//EN" "http://www.jboss.org/j2ee/dtd/jboss-web_5_0.dtd"<span xmlns="" class="perl_DataType">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-web&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;context-root&gt;</span>/<span xmlns="" class="perl_Keyword">&lt;/context-root&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Other configurations as needed --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-web&gt;</span>
</pre><div class="para">
					By setting the context-root to <code class="filename">/</code> you are making your application the default application. Your application will now be available at <code class="literal">http://localhost:8080/</code>.
				</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						Renaming the <code class="filename">ROOT.war</code> to <code class="filename">jboss.war</code> will make that application be available at <code class="literal">http://localhost:8080/jboss</code>
					</div></div></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Core_Services">
      ⁠</a>5.4. Configuring Legacy Core Services</h1></div></div></div><div class="para">
			The legacy core services specified in the <code class="filename"><em class="replaceable">$JBOSS_HOME</em>/server/<em class="replaceable">PROFILE</em>/conf/jboss-service.xml</code> file are started just after server starts up the microcontainer. The file contains MBeans for various services including logging, security, JNDI, JNDIView etc. If you commenting out a service, it is not loaded on startup.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				This file will be dropped as the services are converted to microcontainer Beans or MBeans that are deployed as deploy directory services.
			</div></div></div><div class="para">
			Note that if an MBeans definition has nested comments, you need to comment out the MBean in two sections, leaving the original comment as it was.
		</div><div class="example"><a id="mbean_commented_out">
      ⁠</a><p class="title"><strong>Example 5.2. JNDIView MBean Commented out</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Section 1 commented out</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;mbean code="org.jboss.naming.JNDIView"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">name="jboss:service=JNDIView"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">xmbean-dd="resource:xmdesc/JNDIView-xmbean.xml"&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">--&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- The HANamingService service name --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Section two commented out</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;attribute name="HANamingService"&gt;jboss:service=HAJNDI&lt;/attribute&gt;&lt;/mbean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">--&gt;</span></pre></div></div><div class="para">
			If you then restart JBoss, you will see that the <code class="literal">JNDIView</code> service no longer appears in the JMX Management Console (JMX Console) listing. In practice, you should rarely, if ever, need to modify this file, though there is nothing to stop you adding extra MBean entries in here if you want to. The alternative is to use a separate file in the <code class="filename">deploy</code> directory, which allows your service to be hot deployable.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Logging_Service">
      ⁠</a>5.5. Configuring Logging Service</h1></div></div></div><div class="para">
			In JBoss <code class="literal">log4j</code> is used for logging. If you are not familiar with the <code class="literal">log4j</code> package, more information is available the <a href="http://logging.apache.org/log4j/1.2/index.html">Jakarta web site</a>.
		</div><div class="para">
			Logging is controlled from the central <code class="filename"><em class="replaceable">$JBOSS_HOME</em>/server/<em class="replaceable">PROFILE</em>/conf/jboss-log4j.xml</code> file. This file defines a set of appenders that specify the log files, the categories of messages the log file should contains, the message format and the level of filtering. By default, JBoss produces output to both the console and a log file (<code class="filename">log/server.log</code>).
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="note" id="Log_Levels"><div class="admonition_header"><p><strong>Log Levels</strong></p></div><div class="admonition"><div class="para">
				There are six basic log levels in log4j: <code class="literal">TRACE</code>, <code class="literal">DEBUG</code>, <code class="literal">INFO</code>, <code class="literal">WARN</code>, <code class="literal">ERROR</code> and <code class="literal">FATAL</code>. The logging threshold on the console is <code class="literal">INFO</code>, so that any informational messages, warning messages and error messages are returned to the console, while general debug and trace messages are only available in the log file. If no logging level is set for the <code class="filename">server.log</code> file, it defaults to <code class="literal">DEBUG</code>.
			</div></div></div><div class="para">
			Always when demanding debug information, check the <code class="filename">server.log</code> file to see if there are any debug messages which might help you to track down the problem. However, be aware that just because the logging threshold allows debug messages to be displayed, that does not mean that all of JBoss produces detailed debug information for the log file. You should also consider increasing the logging limits set for individual categories.
		</div><div class="example"><a id="Log_limits">
      ⁠</a><p class="title"><strong>Example 5.3. Example Log Limits</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Limit JBoss categories to INFO --&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;category</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.jboss"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;priority</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"INFO"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/category&gt;</span>
</pre></div></div><div class="para">
			In <a class="xref" href="Basic_Configuration.html#Log_limits">Example 5.3, “Example Log Limits”</a>, the level of logging is set to <code class="literal">INFO</code> for all JBoss classes, with the exception of classes with more specific overrides. By default the root logger in the <code class="filename">jboss-log4j.xml</code> is set to <code class="literal">INFO</code>: any <code class="literal">TRACE</code> or <code class="literal">DEBUG</code> logger from any logger categories is not logged in any files or the console appenders. This setting is controlled through the <span class="property"> jboss.server.log.threshold </span> property. By default this is <code class="literal">INFO</code>. If changed to <code class="literal">DEBUG</code>, more detailed logging output is produced. Yuo can change this as follows:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					Pass the <span class="property"> -Djboss.server.log.threshold=DEBUG </span> parameter when starting the server:
				</div><pre class="programlisting">
./run.sh -Djboss.server.log.threshold=DEBUG
</pre></li><li class="listitem"><div class="para">
					Edit the <code class="filename"><em class="replaceable">&lt;JBOSS_HOME&gt;</em>/jboss-as/server/<em class="replaceable">&lt;PROFILE&gt;</em>/conf/jboss-log4j.xml</code> file directly:
				</div><pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;root&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Let us comment this out to set our own value </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;priority value="${jboss.server.log.threshold}"/&gt;--&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;priority</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"DEBUG"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;appender-ref</span><span xmlns="" class="perl_Others"> ref=</span><span xmlns="" class="perl_String">"CONSOLE"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;appender-ref</span><span xmlns="" class="perl_Others"> ref=</span><span xmlns="" class="perl_String">"FILE"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/root&gt;</span>
</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						The <code class="filename"><em class="replaceable">&lt;JBOSS_HOME&gt;</em>/jboss-as/server/<em class="replaceable">&lt;PROFILE&gt;</em>/conf/jboss-log4j.xml</code> is scanned every 60 seconds (by default) on any changes. Therefore changing this file does not require a server restart.
					</div></div></div></li></ul></div><div class="para">
			As another example, let’s say you wanted to set the output from the container-managed persistence engine to <code class="literal">DEBUG</code> level and to redirect it to a separate file, <code class="filename">cmp.log</code>, in order to analyze the generated SQL commands. You would add the following code to the <code class="filename">conf/jboss-log4j.xml</code> file:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;appender</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"CMP"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.logging.appender.RollingFileAppender"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;errorHandler</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.logging.util.OnlyOnceErrorHandler"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"File"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"${jboss.server.home.dir}/log/cmp.log"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Append"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"MaxFileSize"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"500KB"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"MaxBackupIndex"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"1"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;layout</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.apache.log4j.PatternLayout"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ConversionPattern"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"%d %-5p [%c] %m%n"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/layout&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/appender&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;category</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.jboss.ejb.plugins.cmp"</span><span xmlns="" class="perl_Keyword">&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;priority</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"DEBUG"</span> <span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;appender-ref</span><span xmlns="" class="perl_Others"> ref=</span><span xmlns="" class="perl_String">"CMP"</span><span xmlns="" class="perl_Keyword">/&gt;</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/category&gt;</span>
</pre><div class="para">
			This creates a new file appender and specifies that it should be used by the logger (or category) for the package <code class="literal">org.jboss.ejb.plugins.cmp</code>.
		</div><div class="para">
			The file appender is set up to produce a new log file every day rather than producing a new one every time you restart the server or writing to a single file indefinitely. The current log file is <code class="filename">cmp.log</code>. Older files have the date they were written added to their file names. Please note that the <code class="filename">log</code> directory also contains HTTP request logs which are produced by the web container.
		</div><div class="para">
			By default the <code class="filename">server.log</code> appender is configured to retain log messages between server restarts. This is controlled by the <span class="property"> Append </span> property on the <code class="literal">FILE</code> appender which corresponds to the <code class="filename">server.log</code> file. By default this property is set to true; if you want the <code class="filename">server.log</code> contents to be wiped out on server restarts then you can edit the <code class="filename"><em class="replaceable">&lt;JBOSS_HOME&gt;</em>/jboss-as/server/<em class="replaceable">&lt;PROFILE&gt;</em>/conf/jboss-log4j.xml</code> file to set this property value to false. For example:
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;appender</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"FILE"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.logging.appender.DailyRollingFileAppender"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;errorHandler</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.logging.util.OnlyOnceErrorHandler"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"File"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"${jboss.server.log.dir}/server.log"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Append"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>...
</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Additional_Services">
      ⁠</a>5.6. Additional Services</h1></div></div></div><div class="para">
			The non-core, hot-deployable services are added to the <code class="filename">deploy</code> directory (refer to <a class="xref" href="Hot_Deployment_of_Services.html">Chapter 6, <em>Hot Deployment of Services</em></a>). They can be either XML descriptor files, <code class="filename">*-service.xml, *-jboss-beans.xml</code>, MC <code class="filename">.beans</code> archive, or JBoss Service Archive (SAR) files. SARs contains an <code class="filename">META-INF/jboss-service.xml</code> descriptor and additional resources the service requires (for example, classes, library JAR files or other archives), all packaged up into a single archive. Similarly, a <code class="filename">.beans</code> archive contains a <code class="filename">META-INF/jboss-beans.xml</code> and additional resources.
		</div><div class="para">
			Detailed information on all these services can be found in the <a href="https://docs.redhat.com/docs/en-US/JBoss_Enterprise_Application_Platform/5/html-single/Administration_And_Configuration_Guide/index.html">Administration and Configuration Guide</a>, which also provides comprehensive information on server internals and the implementation of services, such as JTA and the J2EE Connector Architecture (JCA).
		</div></div></div></body></html>