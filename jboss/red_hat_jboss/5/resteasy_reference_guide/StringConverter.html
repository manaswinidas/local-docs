<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 22. String marshalling for String based @*Param</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="StringConverter">
      ⁠</a>Chapter 22. String marshalling for String based @*Param</h1></div></div></div><div class="para">
		<code class="literal">@PathParam</code>, <code class="literal">@QueryParam</code>, <code class="literal">@MatrixParam</code>, <code class="literal">@FormParam</code>, and <code class="literal">@HeaderParam</code> are represented as Strings in a raw HTTP request. These injected parameter types can be converted into objects if they have a <code class="literal">valueOf(String)</code> static method, or a constructor that takes one String parameter. If you have a class with <code class="literal">valueOf()</code>, or the String constructor is inappropriate for your HTTP request, you can plug in RESTEasy's proprietary <code class="literal">@Provider</code>:
	</div><pre class="programlisting">
package org.jboss.resteasy.spi;

public interface StringConverter&lt;T&gt;
{
   T fromString(String str);
   String toString(T value);
}
</pre><div class="para">
		This interface lets you use your own customized String marshalling. It is registered in <code class="filename">web.xml</code> under the <code class="literal">resteasy.providers context-param</code>. (See the Installation and Configuration chapter for details.) You can register it manually by calling the <code class="literal">ResteasyProviderFactory.addStringConverter()</code> method. A simple example of using the <code class="literal">StringConverter</code> follows:
	</div><pre class="programlisting">
   import org.jboss.resteasy.client.ProxyFactory;
   import org.jboss.resteasy.spi.StringConverter;
   import org.jboss.resteasy.test.BaseResourceTest;
   import org.junit.Assert;
   import org.junit.Before;
   import org.junit.Test;

   import javax.ws.rs.HeaderParam;
   import javax.ws.rs.MatrixParam;
   import javax.ws.rs.PUT;
   import javax.ws.rs.Path;
   import javax.ws.rs.PathParam;
   import javax.ws.rs.QueryParam;
   import javax.ws.rs.ext.Provider;

   public class StringConverterTest extends BaseResourceTest
   {
      public static class POJO
      {
         private String name;

         public String getName()
         {
            return name;
         }

         public void setName(String name)
         {
            this.name = name;
         }
      }

      @Provider
      public static class POJOConverter implements StringConverter&lt;POJO&gt;
      {
         public POJO fromString(String str)
         {
            System.out.println("FROM STRNG: " + str);
            POJO pojo = new POJO();
            pojo.setName(str);
            return pojo;
         }

         public String toString(POJO value)
         {
            return value.getName();
         }
      }

      @Path("/")
      public static class MyResource
      {
         @Path("{pojo}")
         @PUT
         public void put(@QueryParam("pojo")POJO q, @PathParam("pojo")POJO pp,
                         @MatrixParam("pojo")POJO mp, @HeaderParam("pojo")POJO hp)
         {
            Assert.assertEquals(q.getName(), "pojo");
            Assert.assertEquals(pp.getName(), "pojo");
            Assert.assertEquals(mp.getName(), "pojo");
            Assert.assertEquals(hp.getName(), "pojo");
         }
      }

      @Before
      public void setUp() throws Exception
      {
         dispatcher.getProviderFactory().addStringConverter(POJOConverter.class);
         dispatcher.getRegistry().addPerRequestResource(MyResource.class);
      }

      @Path("/")
      public static interface MyClient
      {
         @Path("{pojo}")
         @PUT
         void put(@QueryParam("pojo")POJO q, @PathParam("pojo")POJO pp,
                  @MatrixParam("pojo")POJO mp, @HeaderParam("pojo")POJO hp);
      }

      @Test
      public void testIt() throws Exception
      {
         MyClient client = ProxyFactory.create(MyClient.class, "http://localhost:8081");
         POJO pojo = new POJO();
         pojo.setName("pojo");
         client.put(pojo, pojo, pojo, pojo);
      }
   }
</pre></div></body></html>