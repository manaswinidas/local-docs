<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 35. Spring Integration</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="RESTEasy_Spring_Integration">
      ⁠</a>Chapter 35. Spring Integration</h1></div></div></div><div class="para">
		RESTEasy integrates with Spring 2.5. (We are interested in other forms of Spring integration, and encourage you to contribute.)
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="SpringBeanProcessor">
      ⁠</a>35.1. Basic Integration</h1></div></div></div><div class="para">
			For Maven users, you must use the resteasy-spring artifact. Otherwise, the jar is available in the downloaded distribution.
		</div><pre class="programlisting">
&lt;dependency&gt;
    &lt;groupId&gt;org.jboss.resteasy&lt;/groupId&gt;
    &lt;artifactId&gt;resteasy-spring&lt;/artifactId&gt;
    &lt;version&gt;whatever version you are using&lt;/version&gt;
&lt;/dependency&gt;
</pre><div class="para">
			RESTEasy includes its own Spring <code class="literal">ContextLoaderListener</code>. This registers a RESTEasy-specific <code class="literal">BeanPostProcessor</code> that processes JAX-RS annotations when a bean is created by a <code class="literal">BeanFactory</code>. This means that RESTEasy automatically scans for <code class="literal">@Provider</code> and JAX-RS resource annotations on your bean class and registers them as JAX-RS resources.
		</div><div class="para">
			You will need to alter your <code class="filename">web.xml</code> file:
		</div><pre class="programlisting">
&lt;web-app&gt;
   &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;

   &lt;listener&gt;
      &lt;listener-class&gt;org.resteasy.plugins.server.servlet.ResteasyBootstrap&lt;/listener-class&gt;
   &lt;/listener&gt;

   &lt;listener&gt;
      &lt;listener-class&gt;org.resteasy.plugins.spring.SpringContextLoaderListener&lt;/listener-class&gt;
   &lt;/listener&gt;

   &lt;servlet&gt;
      &lt;servlet-name&gt;Resteasy&lt;/servlet-name&gt;
      &lt;servlet-class&gt;org.resteasy.plugins.server.servlet.HttpServletDispatcher&lt;/servlet-class&gt;
   &lt;/servlet&gt;

   &lt;servlet-mapping&gt;
      &lt;servlet-name&gt;Resteasy&lt;/servlet-name&gt;
      &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
   &lt;/servlet-mapping&gt;


&lt;/web-app&gt;
</pre><div class="para">
			The <code class="literal">SpringContextLoaderListener</code> must be declared after <code class="literal">ResteasyBootstrap</code> because it uses ServletContext attributes initialized by <code class="literal">ResteasyBootstrap</code>.
		</div><div class="para">
			If you do not use a Spring <code class="literal">ContextLoaderListener</code> to create your bean factories, you can manually register the RESTEasy <code class="literal">BeanFactoryPostProcessor</code> by allocating an instance of <code class="literal">org.jboss.resteasy.plugins.spring.SpringBeanProcessor</code>. You can obtain instances of a <code class="literal">ResteasyProviderFactory</code> and <code class="literal">Registry</code> from the <code class="literal">ServletContext</code> attribute, <code class="literal">org.resteasy.spi.ResteasyProviderFactory and org.resteasy.spi.Registry</code> (the fully-qualified name String of these classes). There is also <code class="literal">org.jboss.resteasy.plugins.spring.SpringBeanProcessorServletAware</code>, which automatically injects references to the <code class="literal">Registry</code> and <code class="literal">ResteasyProviderFactory</code> from the Servlet Context, assuming that you have used <code class="literal">RestasyBootstrap</code> to bootstrap RESTEasy.
		</div><div class="para">
			RESTEasy Spring integration supports both singletons and the <span class="emphasis"><em>prototype</em></span> scope. It handles injecting <code class="literal">@Context</code> references. However, constructor injection is not supported, and when the <span class="emphasis"><em>prototype</em></span> scope is used, RESTEasy injects any <code class="literal">@*Param</code>-annotated fields and setters before the request is dispatched.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				You can only use automatically proxied beans with RESTEasy Spring integration. Hand-coded proxying (that is, with <code class="literal">ProxyFactoryBean</code>) will have undesirable effects.
			</div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="SpringMVC">
      ⁠</a>35.2. Spring MVC Integration</h1></div></div></div><div class="para">
			RESTEasy can also integrate with the Spring <code class="literal">DispatcherServlet</code>. This is advantageous because the <code class="filename">web.xml</code> is simpler, you can dispatch to either Spring controllers or RESTEasy from under the same base URL, and you can use Spring <code class="literal">ModelAndView</code> objects as return arguments from <code class="literal">@GET</code> resource methods. To set this up, you must use the Spring <code class="literal">DispatcherServlet</code> in your <code class="filename">web.xml</code> file, and import the <code class="filename">springmvc-resteasy.xml</code> file into your base Spring beans xml file. Here is an example <code class="filename">web.xml</code> file:
		</div><pre class="programlisting">
&lt;web-app&gt;
   &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;

   &lt;servlet&gt;
      &lt;servlet-name&gt;Resteasy&lt;/servlet-name&gt;
      &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet;&lt;/servlet-class&gt;
   &lt;/servlet&gt;

   &lt;servlet-mapping&gt;
      &lt;servlet-name&gt;Spring&lt;/servlet-name&gt;
      &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
   &lt;/servlet-mapping&gt;


&lt;/web-app&gt;
</pre><div class="para">
			Then, within your main Spring beans xml file, import the <code class="filename">springmvc-resteasy.xml</code> file.
		</div><pre class="programlisting">
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd
    http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.5.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
"&gt;

    &lt;!-- Import basic SpringMVC Resteasy integration --&gt;
    &lt;import resource="classpath:springmvc-resteasy.xml"/&gt;
....
</pre></div></div></body></html>