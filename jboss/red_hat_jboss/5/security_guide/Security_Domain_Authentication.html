<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 7. Authentication</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="Security_Domain_Authentication">
      ⁠</a>Chapter 7. Authentication</h1></div></div></div><div class="para">
		The following examples describe ways you can use application policies in a security domain.
	</div><div class="para">
		For clarity, only the authentication policy is declared in the examples, however you can include <span class="markup">&lt;authorization&gt;</span>, and <span class="markup">&lt;mapping&gt;</span> elements in the same <span class="markup">&lt;application-policy&gt;</span>. Refer to <a class="xref" href="Security_Domain_Schema_Construction.html#Security_Domain_Schema_Authentication_Element">Section 6.1.1, “&lt;authentication&gt;”</a> for detailed information about the &lt;authentication&gt; element.
	</div><div class="example"><a id="exam-Login_Module_Intro_Example">
      ⁠</a><p class="title"><strong>Example 7.1. Single login stack authentication policy</strong></p><div class="example-contents"><div class="para">
			This example describes a simple security domain configuration named <code class="literal">jmx-console</code> that uses a single login module, <code class="classname">UsersRolesLoginModule</code> (refer to <a class="xref" href="ch12.html#sect-UsersRolesLoginModule">Section 12.1.6, “UsersRolesLoginModule”</a>).
		</div><div class="para">
			The login module is supplied user and role properties from files in the <code class="filename">jboss-as/server/<em class="replaceable">$PROFILE</em>/conf/props</code> directory.
		</div><div class="para">
			In this instance, the <span class="markup">&lt;login-module&gt;</span> must succeed or authentication fails.
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;application-policy</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:security-beans:1.0 name="</span><span xmlns="" class="perl_Error">jmx-console"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;authentication&gt;</span>
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Keyword">&lt;login-module</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.security.auth.spi.UsersRolesLoginModule"</span><span xmlns="" class="perl_Others"> flag=</span><span xmlns="" class="perl_String">"required"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"usersProperties"</span><span xmlns="" class="perl_Keyword">&gt;</span>props/jmx-console-users.properties<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"rolesProperties"</span><span xmlns="" class="perl_Keyword">&gt;</span>props/jmx-console-roles.properties<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Keyword">&lt;/login-module&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/authentication&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/application-policy&gt;</span>
</pre></div></div><div class="example"><a id="idm139921682490256">
      ⁠</a><p class="title"><strong>Example 7.2. Multiple login stack authentication policy</strong></p><div class="example-contents"><div class="para">
			This example describes a security domain configuration named <code class="literal">web-console</code> that uses two login modules in the authentication login module stack.
		</div><div class="para">
			One &lt;login-module&gt; obtains login credentials using the <code class="classname">LdapLoginModule</code> (refer to <a class="xref" href="ch12.html#sect-LdapLoginModule">Section 12.1.1, “LdapLoginModule”</a>), whereas the other <span class="markup">&lt;login-module&gt;</span> obtains authentication credentials using <code class="classname">BaseCertLoginModule</code> (refer to <a class="xref" href="ch12.html#sect-BaseCertLoginModule">Section 12.1.8, “BaseCertLoginModule”</a>).
		</div><div class="para">
			In this instance, both modules are marked as sufficient, therefore only one of them must succeed for authentication to be successful.
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;application-policy</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:security-beans:1.0 name="</span><span xmlns="" class="perl_Error">web-console"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;authentication&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- LDAP configuration --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;login-module</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.security.auth.spi.LdapLoginModule"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">         flag=</span><span xmlns="" class="perl_String">"sufficient"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- database configuration --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;login-module</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.security.auth.spi.BaseCertLoginModule"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">                      flag=</span><span xmlns="" class="perl_String">"sufficient"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>            
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/authentication&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/application-policy&gt;</span>
</pre></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Custom_Callback_Handlers">
      ⁠</a>7.1. Custom Callback Handlers</h1></div></div></div><div class="para">
		Implementing callback handlers into authentication procedures allows a login module to authenticate a user independent of the client application authentication method.
	</div><div class="para">
		You can implement callback handlers using the following methods:
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				Specify the CallbackHandlerClassName attribute in the <code class="filename">conf/jboss-service.xml</code> JaasSecurityManagerService MBean definition.
			</div></li><li class="listitem"><div class="para">
				Inject a callback handler instance into the <code class="filename">deploy/security/security-jboss-beans.xml</code> JNDISecurityManagement bean.
			</div></li></ul></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139921631666128">
      ⁠</a><p class="title"><strong>Procedure 7.1. Set callback handler using attributes</strong></p><div class="para">
			This procedure describes how to specify a callback handler in the <code class="filename">jboss-service.xml</code> configuration file.
		</div><ol class="1"><li class="step"><p class="title"><strong>Open the configuration file</strong></p><div class="para">
				Navigate to <code class="filename"><em class="replaceable">$JBOSS_HOME</em>/server/<em class="replaceable">$PROFILE</em>/conf/</code>
			</div><div class="para">
				Open the <code class="filename">jboss-service.xml</code> file.
			</div><div class="para">
				By default, the <code class="filename">jboss-service.xml</code> file contains the configuration in <a class="xref" href="Security_Domain_Authentication.html#exam-JBoss_Service_JAAS_Default_Configuration">Example 7.3, “jboss-service default configuration”</a>
			</div><div class="example"><a id="exam-JBoss_Service_JAAS_Default_Configuration">
      ⁠</a><p class="title"><strong>Example 7.3. jboss-service default configuration</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- ==================================================================== --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Security                                                             --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- ==================================================================== --&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- JAAS security manager and realm mapping --&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;mbean</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.security.plugins.JaasSecurityManagerService"</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jboss.security:service=JaasSecurityManager"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- A flag which indicates whether the SecurityAssociation server mode</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  is set on service creation. This is true by default since the</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  SecurityAssociation should be thread local for multi-threaded server</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  operation.--&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ServerMode"</span><span xmlns="" class="perl_Keyword">&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"SecurityManagerClassName"</span><span xmlns="" class="perl_Keyword">&gt;</span>org.jboss.security.plugins.JaasSecurityManager<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DefaultUnauthenticatedPrincipal"</span><span xmlns="" class="perl_Keyword">&gt;</span>anonymous<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- DefaultCacheTimeout: Specifies the default timed cache policy timeout</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  in seconds.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  If you want to disable caching of security credentials, set this to 0 to</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  force authentication to occur every time. This has no affect if the</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  AuthenticationCacheJndiName has been changed from the default value.--&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DefaultCacheTimeout"</span><span xmlns="" class="perl_Keyword">&gt;</span>1800<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- DefaultCacheResolution: Specifies the default timed cache policy</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  resolution in seconds. This controls the interval at which the cache</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  current timestamp is updated and should be less than the DefaultCacheTimeout</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  in order for the timeout to be meaningful. This has no affect if the</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  AuthenticationCacheJndiName has been changed from the default value.--&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DefaultCacheResolution"</span><span xmlns="" class="perl_Keyword">&gt;</span>60<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- DeepCopySubjectMode: This set the copy mode of subjects done by the</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  security managers to be deep copies that makes copies of the subject</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  principals and credentials if they are cloneable. It should be set to</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  true if subject include mutable content that can be corrupted when</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  multiple threads have the same identity and cache flushes/logout clearing</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  the subject in one thread results in subject references affecting other</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  threads.--&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DeepCopySubjectMode"</span><span xmlns="" class="perl_Keyword">&gt;</span>false<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/mbean&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>				
<span xmlns="" class="line">​</span>				
<span xmlns="" class="line">​</span>				
<span xmlns="" class="line">​</span>
</pre></div></div></li><li class="step"><p class="title"><strong>Append the attribute</strong></p><div class="para">
				To set the custom callback handler, append an <span class="markup">&lt;attribute&gt;</span> element as a child of the <span class="markup">&lt;mbean&gt;</span> element, and specify the fully qualified name of your callback handler. Refer to <a class="xref" href="Security_Domain_Authentication.html#exam-JBoss_Service_JAAS_Appended_CCH">Example 7.4, “jboss-service appended callback handler”</a> for an example <span class="markup">&lt;attribute&gt;</span> element, with the callback handler specified.
			</div><div class="example"><a id="exam-JBoss_Service_JAAS_Appended_CCH">
      ⁠</a><p class="title"><strong>Example 7.4. jboss-service appended callback handler</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- ==================================================================== --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Security                                                             --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- ==================================================================== --&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- JAAS security manager and realm mapping --&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;mbean</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.security.plugins.JaasSecurityManagerService"</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jboss.security:service=JaasSecurityManager"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- A flag which indicates whether the SecurityAssociation server mode</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  is set on service creation. This is true by default since the</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  SecurityAssociation should be thread local for multi-threaded server</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  operation.--&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ServerMode"</span><span xmlns="" class="perl_Keyword">&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"SecurityManagerClassName"</span><span xmlns="" class="perl_Keyword">&gt;</span>org.jboss.security.plugins.JaasSecurityManager<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DefaultUnauthenticatedPrincipal"</span><span xmlns="" class="perl_Keyword">&gt;</span>anonymous<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- DefaultCacheTimeout: Specifies the default timed cache policy timeout</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  in seconds.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  If you want to disable caching of security credentials, set this to 0 to</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  force authentication to occur every time. This has no affect if the</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  AuthenticationCacheJndiName has been changed from the default value.--&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DefaultCacheTimeout"</span><span xmlns="" class="perl_Keyword">&gt;</span>1800<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- DefaultCacheResolution: Specifies the default timed cache policy</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  resolution in seconds. This controls the interval at which the cache</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  current timestamp is updated and should be less than the DefaultCacheTimeout</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  in order for the timeout to be meaningful. This has no affect if the</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  AuthenticationCacheJndiName has been changed from the default value.--&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DefaultCacheResolution"</span><span xmlns="" class="perl_Keyword">&gt;</span>60<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- DeepCopySubjectMode: This set the copy mode of subjects done by the</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  security managers to be deep copies that makes copies of the subject</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  principals and credentials if they are cloneable. It should be set to</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  true if subject include mutable content that can be corrupted when</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  multiple threads have the same identity and cache flushes/logout clearing</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  the subject in one thread results in subject references affecting other</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  threads.--&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DeepCopySubjectMode"</span><span xmlns="" class="perl_Keyword">&gt;</span>false<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"CallbackHandlerClassName"</span><span xmlns="" class="perl_Keyword">&gt;</span>org.jboss.security.plugins.[Custom_Callback_Handler_Name]<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/mbean&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>				
<span xmlns="" class="line">​</span>				
<span xmlns="" class="line">​</span>				
<span xmlns="" class="line">​</span>
</pre></div></div></li><li class="step"><p class="title"><strong>Restart server</strong></p><div class="para">
				You have now configured the <code class="filename">jboss-service.xml</code> file to use a custom callback handler.
			</div><div class="para">
				Restart the server to ensure the new security policy takes effect.
			</div></li></ol></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139921681546256">
      ⁠</a><p class="title"><strong>Procedure 7.2. Set security callback handler using injection</strong></p><div class="para">
			This procedure describes how to inject a security callback handler instance into the JNDISecurityManagement bean.
		</div><ol class="1"><li class="step"><p class="title"><strong>Create custom callback instance</strong></p><div class="para">
				You must create an instance of the custom callback handler, and register it.
			</div></li><li class="step"><p class="title"><strong>Open the configuration file</strong></p><div class="para">
				Navigate to <code class="filename">$JBOSS_HOME/server/<em class="replaceable">$PROFILE</em>/deploy/security/</code>
			</div><div class="para">
				Open the <code class="filename">security-jboss-beans.xml</code> file.
			</div><div class="para">
				By default, the <code class="filename">security-jboss-beans.xml</code> file contains the JNDIBasedSecurityManagement bean configuration in <a class="xref" href="Security_Domain_Authentication.html#exam-security_jboss_beans_default">Example 7.5, “security-jboss-beans default configuration”</a>
			</div><div class="example"><a id="exam-security_jboss_beans_default">
      ⁠</a><p class="title"><strong>Example 7.5. security-jboss-beans default configuration</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- JNDI Based Security Management --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"JBossSecuritySubjectFactory"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.security.integration.JBossSecuritySubjectFactory"</span> <span xmlns="" class="perl_Keyword">/&gt;</span></pre></div></div></li><li class="step"><p class="title"><strong>Append the injection property</strong></p><div class="para">
				To inject the callback handler, append a <span class="markup">&lt;property&gt;</span> element as a child of the JNDIBasedSecurityManagement <span class="markup">&lt;mbean&gt;</span> element. Specify the callback handler using the <span class="markup">&lt;property&gt;</span> and <span class="markup">&lt;inject&gt;</span> elements described in <a class="xref" href="Security_Domain_Authentication.html#exam-JBoss_Service_JAAS_Appended_CCH">Example 7.4, “jboss-service appended callback handler”</a>.
			</div><div class="example"><a id="exam-security_jboss_beans_CCH">
      ⁠</a><p class="title"><strong>Example 7.6. security-jboss-beans callback handler</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"JBossSecuritySubjectFactory"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.security.integration.JBossSecuritySubjectFactory"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"securityManagement"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"JNDIBasedSecurityManagement"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span></pre></div></div></li><li class="step"><p class="title"><strong>Restart server</strong></p><div class="para">
				You have now configured the <code class="filename">security-jboss-beans.xml</code> file to inject your custom callback handler.
			</div><div class="para">
				Restart the server to ensure the new security policy takes effect.
			</div></li></ol></div></div></div></body></html>