<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 10. Auditing</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="chap-Security_Event_Auditing">
      ⁠</a>Chapter 10. Auditing</h1></div></div></div><div class="para">
		Certain government organizations mandate auditing in enterprise applications to ensure the software components of an implementation are traceable, and operating within their design parameters. Additionally, government regulations and standards require audit controls in addition to standard application auditing.
	</div><div class="para">
		System administrators can enable security event auditing to constantly monitor the operation of the security domain, and deployed Web and EJB applications.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Event Auditing, and Server Performance</strong></p></div><div class="admonition"><div class="para">
			Security event auditing may introduce a performance impact on servers that manage high event volumes. Auditing is deactivated by default, and should be configured to be available on-demand.
		</div></div></div><div class="para">
		Activating security event auditing differs between Web and EJB components. <a class="xref" href="chap-Security_Event_Auditing.html#proc-Enabling_Sec_Audit_Feature">Procedure 10.1, “Enable the security audit feature”</a> describes the minimum steps to enable the audit service for EJBs in your implementation . <a class="xref" href="chap-Security_Event_Auditing.html#proc-Enable_Sec_Audit_Web">Procedure 10.2, “Enable security auditing for Web containers”</a> describes how to enable security event auditing for Web containers.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Event data security for Web components</strong></p></div><div class="admonition"><div class="para">
			Web container event auditing can expose sensitive user information. Administrators must ensure appropriate data protection procedures such as password hashing are implemented when configuring security auditing for Web container events.
		</div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="proc-Enabling_Sec_Audit_Feature">
      ⁠</a><p class="title"><strong>Procedure 10.1. Enable the security audit feature</strong></p><ol class="1"><li class="step"><p class="title"><strong>Open the log4j configuration file</strong></p><div class="para">
				Navigate to <code class="filename">$JBOSS_HOME/server/<em class="replaceable">$PROFILE</em>/conf/</code>
			</div><div class="para">
				Open the <code class="filename">jboss-log4j.xml</code> file using a text editor.
			</div></li><li class="step"><p class="title"><strong>Uncomment the security audit category</strong></p><div class="para">
				By default, the Security Audit Provider category definition in the <code class="filename">jboss-log4j.xml</code> file is commented out. Uncomment the category definition shown in <a class="xref" href="chap-Security_Event_Auditing.html#exam-log4j_Security_Audit_Provider_Category">Example 10.1, “log4j Security Audit Provider category”</a>.
			</div><div class="example"><a id="exam-log4j_Security_Audit_Provider_Category">
      ⁠</a><p class="title"><strong>Example 10.1. log4j Security Audit Provider category</strong></p><div class="example-contents"><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Limit the verbose MC4J EMS (lib used by admin-console) categories --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;category</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.mc4j.ems"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;priority</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"WARN"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/category&gt;</span>
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Show the evolution of the DataSource pool in the logs [inUse/Available/Max]</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;category name="org.jboss.resource.connectionmanager.JBossManagedConnectionPool"&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  &lt;priority value="TRACE"/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;/category&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">   --&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Category specifically for Security Audit Provider --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;category</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.jboss.security.audit.providers.LogAuditProvider"</span><span xmlns="" class="perl_Others"> additivity=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;priority</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"TRACE"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;appender-ref</span><span xmlns="" class="perl_Others"> ref=</span><span xmlns="" class="perl_String">"AUDIT"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/category&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Limit the org.jboss.serial (jboss-serialization) to INFO as its DEBUG is verbose --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;category</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.jboss.serial"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;priority</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"INFO"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/category&gt;</span>
<span xmlns="" class="line">​</span>
</pre></div></div></li><li class="step"><p class="title"><strong>Uncomment the audit appender</strong></p><div class="para">
				By default, the AUDIT appender definition in the <code class="filename">jboss-log4j.xml</code> file is commented out. Uncomment the appender definition shown in <a class="xref" href="chap-Security_Event_Auditing.html#exam-log4j_Security_Audit_Provider_Category">Example 10.1, “log4j Security Audit Provider category”</a>.
			</div><div class="example"><a id="exam-log4j_Security_Audit_AUDIT_Appender">
      ⁠</a><p class="title"><strong>Example 10.2. log4j Security Audit Provider category</strong></p><div class="example-contents"><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!--  Emit events as JMX notifications</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;appender name="JMX" class="org.jboss.monitor.services.JMXNotificationAppender"&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  &lt;errorHandler class="org.jboss.logging.util.OnlyOnceErrorHandler"/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  &lt;param name="Threshold" value="WARN"/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  &lt;param name="ObjectName" value="jboss.system:service=Logging,type=JMXNotificationAppender"/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  &lt;layout class="org.apache.log4j.PatternLayout"&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    &lt;param name="ConversionPattern" value="%d %-5p [%c] %m"/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  &lt;/layout&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;/appender&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">--&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Security AUDIT Appender --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;appender</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"AUDIT"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.logging.appender.DailyRollingFileAppender"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;errorHandler</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.logging.util.OnlyOnceErrorHandler"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"File"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"${jboss.server.log.dir}/audit.log"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Append"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DatePattern"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"'.'yyyy-MM-dd"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;layout</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.apache.log4j.PatternLayout"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ConversionPattern"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"%d %-5p [%c] (%t:%x) %m%n"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/layout&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/appender&gt;</span>
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">&lt;!-- ================ --&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">&lt;!-- Limit categories --&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">&lt;!-- ================ --&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Limit the org.apache category to INFO as its DEBUG is verbose --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;category</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;priority</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"INFO"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/category&gt;</span>
<span xmlns="" class="line">​</span>...
</pre></div></div></li><li class="step"><p class="title"><strong>Save, and restart server</strong></p><div class="para">
				You have now activated the auditing service for your implementation, as configured in the <code class="filename">jboss-log4j.xml</code> file.
			</div><div class="para">
				Restart the server to ensure the new security policy takes effect.
			</div></li><li class="step"><p class="title"><strong>Verify security auditing is functioning correctly</strong></p><div class="para">
				Once the audit service is configured and deployed, audit log entries will verify the audit service and EJB invocation success.
			</div><div class="para">
				The <code class="filename">audit.log</code> file is located in <code class="filename">jboss-as/server/<em class="replaceable">$PROFILE</em>/log/</code> directory.
			</div><div class="para">
				A successful EJB invocation would look similar to the following <code class="filename">audit.log</code> output.
			</div><div class="example"><a id="idm139921635541616">
      ⁠</a><p class="title"><strong>Example 10.3. Successful EJB Invocation log entry</strong></p><div class="example-contents"><pre class="programlisting">2008-12-05 16:08:26,719 TRACE [org.jboss.security.audit.providers.LogAuditProvider] (http-127.0.0.1-8080-2:) [Success]policyRegistration=org.jboss.security.plugins.JBossPolicyRegistration@76ed4518; Resource:=[org.jboss.security.authorization.resources.EJBResource:contextMap={policyRegistration=org.jboss.security.plugins.JBossPolicyRegistration@76ed4518}:method=public abstract org.jboss.test.security.interfaces.RunAsServiceRemote org.jboss.test.security.interfaces.RunAsServiceRemoteHome.create() throws java.rmi.RemoteException,javax.ejb.CreateException:ejbMethodInterface=Home:ejbName=RunAs:ejbPrincipal=jduke:MethodRoles=Roles(identitySubstitutionCaller,):securityRoleReferences=null:callerSubject=Subject:
        Principal: [roles=[identitySubstitutionCaller, extraRunAsRole],principal=runAsUser]
        Principal: Roles(members:extraRunAsRole,identitySubstitutionCaller)
:callerRunAs=[roles=[identitySubstitutionCaller, extraRunAsRole],principal=runAsUser]:callerRunAs=[roles=[identitySubstitutionCaller, extraRunAsRole],principal=runAsUser]:ejbRestrictionEnforcement=false:ejbVersion=null];Source=org.jboss.security.plugins.javaee.EJBAuthorizationHelper;Exception:=;</pre></div></div><div class="para">
				An unsuccessful EJB invocation would look similar to the following <code class="filename">audit.log</code> output.
			</div><div class="example"><a id="idm139921664390640">
      ⁠</a><p class="title"><strong>Example 10.4. Unsuccessful EJB Invocation log entry</strong></p><div class="example-contents"><pre class="programlisting">[Error]policyRegistration=org.jboss.security.plugins.JBossPolicyRegistration@76ed4518;Resource:=[org.jboss.security.authorization.resources.EJBResource:contextMap={policyRegistration=org.jboss.security.plugins.JBossPolicyRegistration@76ed4518}:method=public java.security.Principal org.jboss.test.security.ejb3.SimpleStatelessSessionBean.invokeUnavailableMethod():ejbMethodInterface=Remote:ejbName=SimpleStatelessSessionBean:ejbPrincipal=UserA:MethodRoles=Roles(&lt;NOBODY&gt;,):securityRoleReferences=null:callerSubject=Subject:
        Principal: UserA
        Principal: Roles(members:RegularUser,Administrator)
:callerRunAs=null:callerRunAs=null:ejbRestrictionEnforcement=false:ejbVersion=null];Source=org.jboss.security.plugins.javaee.EJBAuthorizationHelper;Exception:=Authorization Failed: ;</pre></div></div></li></ol></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="proc-Enable_Sec_Audit_Web">
      ⁠</a><p class="title"><strong>Procedure 10.2. Enable security auditing for Web containers</strong></p><ol class="1"><li class="step"><p class="title"><strong>Enable EJB security auditing</strong></p><div class="para">
				You must enable security as described in <a class="xref" href="chap-Security_Event_Auditing.html#proc-Enabling_Sec_Audit_Feature">Procedure 10.1, “Enable the security audit feature”</a>.
			</div></li><li class="step"><p class="title"><strong>Activate auditing in the server realm</strong></p><div class="para">
				Web container auditing must first be activated in the server realm of the <code class="filename">server.xml</code> file.
			</div><div class="para">
				The <code class="filename">server.xml</code> file is located in the <code class="filename"><em class="replaceable">jboss-as</em>/server/<em class="replaceable">$PROFILE</em>/deploy/jbossweb.sar/</code> directory.
			</div><div class="para">
				The <code class="sgmltag-element"> &lt;Realm&gt; </code> element must have the <em class="parameter"><code>enableAudit="<code class="literal">true</code>"</code></em> attribute set, as per <a class="xref" href="chap-Security_Event_Auditing.html#exam-server_xml_audit_activation">Example 10.5, “server.xml audit activation”</a>.
			</div><div class="example"><a id="idm139921635820720">
      ⁠</a><p class="title"><strong>Example 10.5. server.xml audit activation</strong></p><div class="example-contents"><pre class="programlisting">&lt;Realm className="org.jboss.web.tomcat.security.JBossWebRealm" certificatePrincipal="org.jboss.security.auth.certs.SubjectDNMapping" allRolesMode="authOnly" 
enableAudit="<code class="literal">true</code>"/&gt;</pre></div></div></li><li class="step"><p class="title"><strong>Specify auditing levels system property</strong></p><div class="para">
				The auditing levels for Web applications must be specified using the <span class="property">org.jboss.security.web.audit</span> system property in the <code class="filename">run.conf</code> (Linux) or <code class="filename">run.conf.bat</code> (Microsoft Windows) script.
			</div><div class="para">
				Alternatively, you can specify the system property in the <code class="filename">jboss-as/server/<em class="replaceable">$PROFILE</em>/deploy/properties-service.xml</code> file.
			</div><ul class="stepalternatives">
				<li class="step"><p class="title"><strong>Linux</strong></p><div class="para">
						Add the system property into the <code class="filename">jboss-as/bin/run.sh</code> file.
					</div><div class="para">
						
<pre class="programlisting">## Specify the Security Audit options
#System Property setting to configure the web audit:
#* off = turn it off
#* headers = audit the headers
#* cookies = audit the cookie
#* parameters = audit the parameters
#* attributes = audit the attributes
#* headers,cookies,parameters = audit the headers,cookie and 
#                               parameters
#* headers,cookies = audit the headers and cookies
JAVA_OPTS="$JAVA_OPTS -Dorg.jboss.security.web.audit=headers,cookies,parameter"</pre>

					</div></li>
				 <li class="step"><p class="title"><strong>Microsoft Windows</strong></p><div class="para">
						Add the system property into the <code class="filename">jboss-as/bin/run.bat</code> file.
					</div><div class="para">
						
<pre class="programlisting">rem Specify the Security Audit options
rem System Property setting to configure the web audit
rem * off = turn it off
rem * headers = audit the headers
rem * cookies = audit the cookie
rem * parameters = audit the parameters
rem * attributes = audit the attributes
rem * headers,cookies,parameters = audit the headers,cookie and
rem   parameters
rem * headers,cookies = audit the headers and cookies
set JAVA_OPTS=%JAVA_OPTS% " -Dorg.jboss.security.web.audit=headers,cookies,parameter"</pre>

					</div></li>
				 <li class="step"><p class="title"><strong>properties-service.xml</strong></p><div class="para">
						Update the <code class="classname">SystemPropertiesService</code> class MBean in the <code class="filename">jboss-as/server/<em class="replaceable">$PROFILE</em>/deploy/properties-service.xml</code> file, and declare the java property as an <span class="markup">&lt;attribute&gt;</span>. You can uncomment the relevant operating system block in the code sample below.
					</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;mbean</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.varia.property.SystemPropertiesService"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">name=</span><span xmlns="" class="perl_String">"jboss:type=Service,name=SystemProperties"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Properties"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>org.jboss.security.web.audit=headers,cookies,parameter
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/mbean&gt;</span>
</pre></li>

			</ul></li><li class="step"><p class="title"><strong>Verify security auditing is functioning correctly</strong></p><div class="para">
				Once the system property is specified in the files, audit log entries will verify Web invocation success.
			</div><div class="para">
				The <code class="filename">audit.log</code> file is located in <code class="filename">jboss-as/server/<em class="replaceable">$PROFILE</em>/log/</code> directory.
			</div><div class="para">
				A successful Web invocation would look similar to the following <code class="filename">audit.log</code> output.
			</div><div class="example"><a id="idm139921625391936">
      ⁠</a><p class="title"><strong>Example 10.6. Successful Web Invocation log entry</strong></p><div class="example-contents"><pre class="programlisting">2008-12-05 16:08:38,997 TRACE [org.jboss.security.audit.providers.LogAuditProvider] (http-127.0.0.1-8080-17:) [Success]policyRegistration=org.jboss.security.plugins.JBossPolicyRegistration@76ed4518;Resource:=[org.jboss.security.authorization.resources.WebResource:contextMap={policyRegistration=org.jboss.security.plugins.JBossPolicyRegistration@76ed4518,securityConstraints=[Lorg.apache.catalina.deploy.SecurityConstraint;@6feeae6, resourcePermissionCheck=true},canonicalRequestURI=/restricted/get-only/x,request=[/web-constraints:cookies=null:headers=user-agent=Jakarta Commons-HttpClient/3.0,authorization=host=localhost:8080,][parameters=],CodeSource=null];securityConstraints=SecurityConstraint[RestrictedAccess - Get Only];Source=org.jboss.security.plugins.javaee.WebAuthorizationHelper;resourcePermissionCheck=true;Exception:=;</pre></div></div><div class="para">
				An unsuccessful EJB invocation would look similar to the following <code class="filename">audit.log</code> output.
			</div><div class="example"><a id="idm139921687884528">
      ⁠</a><p class="title"><strong>Example 10.7. Unsuccessful Web Invocation log entry</strong></p><div class="example-contents"><pre class="programlisting">2008-12-05 16:08:41,561 TRACE [org.jboss.security.audit.providers.LogAuditProvider] (http-127.0.0.1-8080-4:) [Failure]principal=anil;Source=org.jboss.web.tomcat.security.JBossWebRealm;request=[/jaspi-web-basic:cookies=null:headers=user-agent=Jakarta Commons-HttpClient/3.0,authorization=host=localhost:8080,][parameters=][attributes=];2008-12-05 16:07:30,129 TRACE [org.jboss.security.audit.providers.LogAuditProvider] (WorkerThread#1[127.0.0.1:55055]:)</pre></div></div></li></ol></div></div></body></html>