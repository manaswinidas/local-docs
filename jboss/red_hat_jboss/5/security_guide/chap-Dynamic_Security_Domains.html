<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 11. Deploying Security Domains</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="chap-Dynamic_Security_Domains">
      ⁠</a>Chapter 11. Deploying Security Domains</h1></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Modular Security Domain</span></dt><dd><div class="para">
					A security domain deployment method, where the security domain declaration is included in a <em class="firstterm"> deployment descriptor </em> . A modular security domain takes the form <code class="filename">*-jboss-beans.xml</code>. It is included in the <code class="filename">META-INF</code> directory of EJB Jars, or the <code class="filename">WEB-INF</code> directory of web application (WAR).
				</div></dd><dt><span class="term">Deployment Descriptor</span></dt><dd><div class="para">
					A declarative XML configuration file that describes the deployment settings of an application. The way an application is deployed can be changed within this file, eliminating the need to make changes to the underlying code of the application.
				</div></dd></dl></div><div class="para">
		There are two ways of deploying a security domain in JBoss Enterprise Application Platform:
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
				Declare the security domain in the <code class="filename">jboss-as/server/<em class="replaceable">$PROFILE</em>/conf/login-config.xml</code> file.
			</div></li><li class="listitem"><div class="para">
				Create and deploy a modular security domain.
			</div></li></ol></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139921635358656">
      ⁠</a><p class="title"><strong>Procedure 11.1. Modular Security Domain configuration</strong></p><div class="para">
			Follow this procedure to configure a basic modular security domain deployment descriptor with two domains for EJB and web applications.
		</div><div class="para">
			Each domain uses the <code class="classname">UsersRolesLoginModule</code> for the authorization policy, however you are not limited to this login module when creating a modular security domain. Refer to <a class="xref" href="ch12.html#chap-JBoss_Login_Modules">Section 12.1, “Using Modules”</a> for additional login modules shipped with JBoss Enterprise Application Platform.
		</div><ol class="1"><li class="step"><p class="title"><strong>Create deployment descriptor</strong></p><div class="para">
				You must create a deployment descriptor file to contain the security domain configuration.
			</div><div class="para">
				If you have already created a deployment descriptor for your application, you can skip this step and proceed to step 2.
			</div><div class="para">
				The file name takes the format <code class="filename"><em class="replaceable">[domain_name]</em>-jboss-beans.xml</code>. While the <em class="replaceable">domain_name</em> is arbitrary, you should choose a name that is meaningful to the application ensure the name of the deployment descriptor is unique across the server profile.
			</div><div class="para">
				The file must contain the standard XML declaration, and a correctly configured <code class="sgmltag-element"> &lt;deployment&gt; </code> element.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;deployment</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:bean-deployer:2.0"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/deployment&gt;</span></pre></li><li class="step"><p class="title"><strong>Define application policies</strong></p><div class="para">
				Individual security domains are defined within the <span class="markup">&lt;deployment&gt;</span> element.
			</div><div class="para">
				In the example below, two security domains are specified. Each authentication policy uses the same login module, and module parameters.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Other login modules are available for use with the Enterprise Application Platform. For more information about the available login modules, refer to <a class="xref" href="ch12.html#chap-JBoss_Login_Modules">Section 12.1, “Using Modules”</a>
				</div></div></div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;deployment</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:bean-deployer:2.0"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;application-policy</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:security-beans:1.0"</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"web-test"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;authentication&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;login-module</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.security.auth.spi.UsersRolesLoginModule"</span><span xmlns="" class="perl_Others"> flag=</span><span xmlns="" class="perl_String">"required"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"unauthenticatedIdentity"</span><span xmlns="" class="perl_Keyword">&gt;</span>anonymous<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"usersProperties"</span><span xmlns="" class="perl_Keyword">&gt;</span>u.properties<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"rolesProperties"</span><span xmlns="" class="perl_Keyword">&gt;</span>r.properties<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/login-module&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/authentication&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/application-policy&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;application-policy</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:security-beans:1.0"</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ejb-test"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;authentication&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;login-module</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.security.auth.spi.UsersRolesLoginModule"</span><span xmlns="" class="perl_Others"> flag=</span><span xmlns="" class="perl_String">"required"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"unauthenticatedIdentity"</span><span xmlns="" class="perl_Keyword">&gt;</span>anonymous<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"usersProperties"</span><span xmlns="" class="perl_Keyword">&gt;</span>u.properties<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"rolesProperties"</span><span xmlns="" class="perl_Keyword">&gt;</span>r.properties<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/login-module&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/authentication&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/application-policy&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/deployment&gt;</span>
</pre></li><li class="step"><p class="title"><strong>Deploy or package the deployment descriptor</strong></p><div class="para">
				Move the deployment descriptor file to the <code class="filename">jboss-as/server/<em class="replaceable">$PROFILE</em>/deploy</code> directory of the required server profile in your installation.
			</div><div class="para">
				If you are distributing your application to a wider audience, package the deployment descriptor in the <code class="filename">META-INF</code> directory of the EJB Jar, or the <code class="filename">WEB-INF</code> directory of your web application (WAR).
			</div></li></ol></div></div></body></html>