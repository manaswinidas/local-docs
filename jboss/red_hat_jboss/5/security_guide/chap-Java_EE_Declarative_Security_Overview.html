<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 1. Java EE Declarative Security Overview</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="chap-Java_EE_Declarative_Security_Overview">
      ⁠</a>Chapter 1. Java EE Declarative Security Overview</h1></div></div></div><div class="para">
		Rather than embedding security into your business component, the Java EE security model is declarative: you describe the security roles and permissions in a standard XML descriptor. This isolates security from business-level code because security tends to be more a function of where the component is deployed than an inherent aspect of the component's business logic.
	</div><div class="para">
		For example, consider an Automatic Teller Machine (ATM) component used to access a bank account. The security requirements, roles, and permissions of the component will vary independently of how you access the bank account. How you access your account information may also vary based on which bank is managing the account, or where the ATM is located.
	</div><div class="para">
		Securing a Java EE application is based on the specification of the application security requirements via the standard Java EE deployment descriptors. You secure access to EJBs and web components in an enterprise application by using the <code class="literal">ejb-jar.xml</code> and <code class="literal">web.xml</code> deployment descriptors. The following sections look at the purpose and usage of the various security elements.
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="J2EE_Declarative_Security_Overview-Security_References">
      ⁠</a>1.1. Security References</h1></div></div></div><div class="para">
		Both Enterprise Java Beans (EJBs) and servlets can declare one or more <span class="markup">&lt;security-role-ref&gt;</span> elements. <a class="xref" href="chap-Java_EE_Declarative_Security_Overview.html#Security_References-The_security_role_ref_element">Figure 1.1, “The &lt;security-role-ref&gt; element”</a> describes the <span class="markup">&lt;security-role-ref&gt;</span> element, its child elements, and attributes.
	</div><div class="figure"><a id="Security_References-The_security_role_ref_element">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><img src="images/j2ee_security_role_ref.png" alt="The &lt;security-role-ref&gt; element"/></div></div><p class="title"><strong>Figure 1.1. The &lt;security-role-ref&gt; element</strong></p></div><div class="para">
		This element declares that a component is using the <span class="markup">&lt;role-name&gt;</span> element's <code class="literal">role-nameType</code> attribute value as an argument to the <code class="methodname"> isCallerInRole(String) </code> method. By using the <code class="methodname"> isCallerInRole </code> method, a component can verify whether the caller is in a role that has been declared with a <span class="markup">&lt;security-role-ref&gt;</span> or <span class="markup">&lt;role-name&gt;</span> element. The <span class="markup">&lt;role-name&gt;</span> element value must link to a <span class="markup">&lt;security-role&gt;</span> element through the <span class="markup">&lt;role-link&gt;</span> element. The typical use of <code class="methodname"> isCallerInRole </code> is to perform a security check that cannot be defined by using the role-based <span class="markup">&lt;method-permissions&gt;</span> elements.
	</div><div class="para">
		<a class="xref" href="chap-Java_EE_Declarative_Security_Overview.html#Security_References-An_ejb_jar.xml_descriptor_fragment_that_illustrates_the_security_role_ref_element_usage.">Example 1.1, “ejb-jar.xml descriptor fragment”</a> describes the use of <span class="markup">&lt;security-role-ref&gt;</span> in an <code class="literal">ejb-jar.xml</code> file.
	</div><div class="example"><a id="Security_References-An_ejb_jar.xml_descriptor_fragment_that_illustrates_the_security_role_ref_element_usage.">
      ⁠</a><p class="title"><strong>Example 1.1. ejb-jar.xml descriptor fragment</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- A sample ejb-jar.xml fragment --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ejb-jar&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;enterprise-beans&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;session&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>ASessionBean<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>      ...
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;security-role-ref&gt;</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;role-name&gt;</span>TheRoleICheck<span xmlns="" class="perl_Keyword">&lt;/role-name&gt;</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;role-link&gt;</span>TheApplicationRole<span xmlns="" class="perl_Keyword">&lt;/role-link&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/security-role-ref&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/session&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/enterprise-beans&gt;</span>
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/ejb-jar&gt;</span>
</pre></div></div><div class="para">
		<a class="xref" href="chap-Java_EE_Declarative_Security_Overview.html#Security_References-An_example_web.xml_descriptor_fragment_that_illustrates_the_security_role_ref_element_usage.">Example 1.2, “web.xml descriptor fragment”</a> shows the use of <span class="markup">&lt;security-role-ref&gt;</span> in a <code class="literal">web.xml</code> file.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			This fragment is an example only. In deployments, the elements in this section must contain role names and links relevant to the EJB deployment.
		</div></div></div><div class="example"><a id="Security_References-An_example_web.xml_descriptor_fragment_that_illustrates_the_security_role_ref_element_usage.">
      ⁠</a><p class="title"><strong>Example 1.2. web.xml descriptor fragment</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;web-app&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;servlet&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>AServlet<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span>        ...
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;security-role-ref&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;role-name&gt;</span>TheServletRole<span xmlns="" class="perl_Keyword">&lt;/role-name&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;role-link&gt;</span>TheApplicationRole<span xmlns="" class="perl_Keyword">&lt;/role-link&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/security-role-ref&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/servlet&gt;</span>
<span xmlns="" class="line">​</span>    ...
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/web-app&gt;</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="J2EE_Declarative_Security_Overview-Security_Identity">
      ⁠</a>1.2. Security Identity</h1></div></div></div><div class="para">
		An Enterprise Java Bean (EJB) can specify the identity another EJB must use when it invokes methods on components using the <span class="markup">&lt;security-identity&gt;</span> element. <a class="xref" href="chap-Java_EE_Declarative_Security_Overview.html#Security_Identity-The_security_identity_element">Figure 1.2, “The security-identity element”</a> describes the <span class="markup">&lt;security-identity&gt;</span> element, its child elements, and attributes.
	</div><div class="figure"><a id="Security_Identity-The_security_identity_element">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><img src="images/j2ee_security_identity.png" alt="The security-identity element"/></div></div><p class="title"><strong>Figure 1.2. The security-identity element</strong></p></div><div class="para">
		The invocation identity can be that of the current caller, or it can be a specific role. The application assembler uses the <span class="markup">&lt;security-identity&gt;</span> element with a <span class="markup">&lt;use-caller-identity&gt;</span> child element. This indicate that the current caller's identity should be propagated as the security identity for method invocations made by the EJB. Propagation of the caller's identity is the default used in the absence of an explicit <span class="markup">&lt;security-identity&gt;</span> element declaration.
	</div><div class="para">
		Alternatively, the application assembler can use the <span class="markup">&lt;run-as&gt;</span> or <span class="markup">&lt;role-name&gt;</span> child element to specify that a specific security role supplied by the &lt;<span class="markup">role-name&gt;</span> element value must be used as the security identity for method invocations made by the EJB.
	</div><div class="para">
		Note that this does not change the caller's identity as seen by the <code class="methodname"> EJBContext.getCallerPrincipal() </code> method. Rather, the caller's security roles are set to the single role specified by the <span class="markup">&lt;run-as&gt;</span> or <span class="markup">&lt;role-name&gt;</span> element value.
	</div><div class="para">
		One use case for the <span class="markup">&lt;run-as&gt;</span> element is to prevent external clients from accessing internal EJBs. You configure this behavior by assigning the internal EJB <span class="markup">&lt;method-permission&gt;</span> elements, which restrict access to a role never assigned to an external client. EJBs that must in turn use internal EJBs are then configured with a <span class="markup">&lt;run-as&gt;</span> or <span class="markup">&lt;role-name&gt;</span> equal to the restricted role. The following descriptor fragment describes an example<span class="markup">&lt;security-identity&gt;</span> element usage.
	</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- A sample ejb-jar.xml fragment --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ejb-jar&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;enterprise-beans&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;session&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>ASessionBean<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;security-identity&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;use-caller-identity/&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;/security-identity&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/session&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;session&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>RunAsBean<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;security-identity&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;run-as&gt;</span>
<span xmlns="" class="line">​</span>                    <span xmlns="" class="perl_Keyword">&lt;description&gt;</span>A private internal role<span xmlns="" class="perl_Keyword">&lt;/description&gt;</span>
<span xmlns="" class="line">​</span>                    <span xmlns="" class="perl_Keyword">&lt;role-name&gt;</span>InternalRole<span xmlns="" class="perl_Keyword">&lt;/role-name&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;/run-as&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;/security-identity&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/session&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/enterprise-beans&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/ejb-jar&gt;</span>
</pre><div class="para">
		When you use <span class="markup">&lt;run-as&gt;</span> to assign a specific role to outgoing calls, a principal named <code class="literal">anonymous</code> is assigned to all outgoing calls. If you want another principal to be associated with the call, you must associate a <span class="markup">&lt;run-as-principal&gt;</span> with the bean in the <code class="filename">jboss.xml</code> file. The following fragment associates a principal named <code class="literal">internal</code> with <code class="literal">RunAsBean</code> from the prior example.
	</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;session&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>RunAsBean<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;security-identity&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;run-as-principal&gt;</span>internal<span xmlns="" class="perl_Keyword">&lt;/run-as-principal&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/security-identity&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/session&gt;</span>
</pre><div class="para">
		The <span class="markup">&lt;run-as&gt;</span> element is also available in servlet definitions in a <code class="filename">web.xml</code> file. The following example shows how to assign the role <code class="literal">InternalRole</code> to a servlet:
	</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;servlet&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>AServlet<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;run-as&gt;</span> 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;role-name&gt;</span>InternalRole<span xmlns="" class="perl_Keyword">&lt;/role-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/run-as&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/servlet&gt;</span>
</pre><div class="para">
		Calls from this servlet are associated with the anonymous <code class="literal">principal</code>. The <span class="markup">&lt;run-as-principal&gt;</span> element is available in the <code class="filename">jboss-web.xml</code> file to assign a specific principal to go along with the <code class="literal">run-as</code> role. The following fragment shows how to associate a principal named <code class="literal">internal</code> to the servlet above.
	</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;servlet&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>AServlet<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;run-as-principal&gt;</span>internal<span xmlns="" class="perl_Keyword">&lt;/run-as-principal&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/servlet&gt;</span>
</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="J2EE_Declarative_Security_Overview-Security_roles">
      ⁠</a>1.3. Security Roles</h1></div></div></div><div class="para">
		The security role name referenced by either the <span class="markup">&lt;security-role-ref&gt;</span> or <span class="markup">&lt;security-identity&gt;</span> element must map to one of the application's declared roles. An application assembler defines logical security roles by declaring <span class="markup">&lt;security-role&gt;</span> elements. The <span class="property">role-name</span> attribute value is a logical application role name, such as <span class="property">Administrator</span>, <span class="property">Architect</span>, or <span class="property">Sales_Manager</span>.
	</div><div class="para">
		The Java EE specifications note that it is important to keep in mind that the security roles in the deployment descriptor are used to define the logical security view of an application. Roles defined in the Java EE deployment descriptors should not be confused with the user groups, users, principals, and other concepts that exist in the target enterprise's operational environment. The deployment descriptor roles are application constructs with application domain-specific names. For example, a banking application might use role names such as <span class="property">Bank_Manager</span>, <span class="property">Teller</span>, or <span class="property">Customer</span>.
	</div><div class="figure"><a id="Security_roles-The_security_role_element">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><img src="images/j2ee_security_role.png" alt="&lt;security-role&gt; element"/></div></div><p class="title"><strong>Figure 1.3. &lt;security-role&gt; element</strong></p></div><div class="para">
		In JBoss, a <span class="markup">&lt;security-role&gt;</span> element is only used to map <span class="markup">&lt;security-role-ref&gt;</span> or <span class="markup">&lt;role-name&gt;</span> values to the logical role that the component role references. The user's assigned roles are a dynamic function of the application's security manager, as you will see when we discuss the JBossSX implementation details.
	</div><div class="para">
		JBoss does not require the definition of <span class="markup">&lt;security-role&gt;</span> elements in order to declare method permissions. However, the specification of <span class="markup">&lt;security-role&gt;</span> elements is still a recommended practice to ensure portability across application servers and for deployment descriptor maintenance. <a class="xref" href="chap-Java_EE_Declarative_Security_Overview.html#Security_roles-An_ejb_jar.xml_descriptor_fragment_that_illustrates_the_security_role_element_usage.">Example 1.3, “ejb-jar.xml descriptor fragment”</a> describes the usage of the <span class="markup">&lt;security-role&gt;</span> in an <code class="filename">ejb-jar.xml</code> file.
	</div><div class="example"><a id="Security_roles-An_ejb_jar.xml_descriptor_fragment_that_illustrates_the_security_role_element_usage.">
      ⁠</a><p class="title"><strong>Example 1.3. ejb-jar.xml descriptor fragment</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- A sample ejb-jar.xml fragment --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ejb-jar&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;assembly-descriptor&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;security-role&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;description&gt;</span>The single application role<span xmlns="" class="perl_Keyword">&lt;/description&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;role-name&gt;</span>TheApplicationRole<span xmlns="" class="perl_Keyword">&lt;/role-name&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/security-role&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/assembly-descriptor&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/ejb-jar&gt;</span>
</pre></div></div><div class="para">
		<a class="xref" href="chap-Java_EE_Declarative_Security_Overview.html#Security_roles-An_example_web.xml_descriptor_fragment_that_illustrates_the_security_role_element_usage.">Example 1.4, “example web.xml descriptor fragment”</a> shows the usage of the <span class="markup">&lt;security-role&gt;</span> in an <code class="literal">web.xml</code> file.
	</div><div class="example"><a id="Security_roles-An_example_web.xml_descriptor_fragment_that_illustrates_the_security_role_element_usage.">
      ⁠</a><p class="title"><strong>Example 1.4. example web.xml descriptor fragment</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- A sample web.xml fragment --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;web-app&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;security-role&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;description&gt;</span>The single application role<span xmlns="" class="perl_Keyword">&lt;/description&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;role-name&gt;</span>TheApplicationRole<span xmlns="" class="perl_Keyword">&lt;/role-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/security-role&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/web-app&gt;</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="J2EE_Declarative_Security_Overview-EJB_method_permissions">
      ⁠</a>1.4. EJB method permissions</h1></div></div></div><div class="para">
		An application assembler can use <span class="markup">&lt;method-permission&gt;</span> element declaration to set the roles that are allowed to invoke an EJB's home and remote interface methods.
	</div><div class="figure"><a id="EJB_method_permissions-The_method_permissions_element">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><img src="images/j2ee_method_permission.png" alt="The &lt;method-permission&gt; element"/></div></div><p class="title"><strong>Figure 1.4. The &lt;method-permission&gt; element</strong></p></div><div class="para">
		Each <span class="markup">&lt;method-permission&gt;</span> element contains one or more <span class="markup">&lt;role-name&gt;</span> child elements. <span class="markup">&lt;role-name&gt;</span> defines the logical roles that are allowed to access the EJB methods as identified by <span class="markup">&lt;method&gt;</span> child elements. You can also specify an <span class="markup">&lt;unchecked&gt;</span> element instead of the <span class="markup">&lt;role-name&gt;</span> element to declare that any authenticated user can access the methods identified by method child elements. In addition, you can declare that no one should have access to a method that has the <span class="markup">exclude-list</span> element. If an EJB has methods that have not been declared as accessible by a role using a <span class="markup">&lt;method-permission&gt;</span> element, the EJB methods default to being excluded from use. This is equivalent to defaulting the methods into the <code class="literal">exclude-list</code>.
	</div><div class="figure"><a id="EJB_method_permissions-The_method_element">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><img src="images/j2ee_method.png" alt="&lt;method&gt; element"/></div></div><p class="title"><strong>Figure 1.5. &lt;method&gt; element</strong></p></div><div class="para">
		There are three supported styles of method element declarations.
	</div><div class="para">
		The first is used for referring to all the home and component interface methods of the named enterprise bean:
	</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;method&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>EJBNAME<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;method-name&gt;</span>*<span xmlns="" class="perl_Keyword">&lt;/method-name&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/method&gt;</span>
</pre><div class="para">
		The second style is used for referring to a specified method of the home or component interface of the named enterprise bean:
	</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;method&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>EJBNAME<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;method-name&gt;</span>METHOD<span xmlns="" class="perl_Keyword">&lt;/method-name&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;/method&gt;</span>
</pre><div class="para">
		If there are multiple methods with the same overloaded name, this style refers to all of the overloaded methods.
	</div><div class="para">
		The third style is used to refer to a specified method within a set of methods with an overloaded name:
	</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;method&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>EJBNAME<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;method-name&gt;</span>METHOD<span xmlns="" class="perl_Keyword">&lt;/method-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;method-params&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;method-param&gt;</span>PARAMETER_1<span xmlns="" class="perl_Keyword">&lt;/method-param&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;method-param&gt;</span>PARAMETER_N<span xmlns="" class="perl_Keyword">&lt;/method-param&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/method-params&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/method&gt;</span>
</pre><div class="para">
		The method must be defined in the specified enterprise bean's home or remote interface. The <span class="markup">&lt;method-param&gt;</span> element values are the fully qualified name of the corresponding method parameter type. If there are multiple methods with the same overloaded signature, the permission applies to all of the matching overloaded methods.
	</div><div class="para">
		The optional <span class="markup">&lt;method-intf&gt;</span> element can be used to differentiate methods with the same name and signature that are defined in both the home and remote interfaces of an enterprise bean.
	</div><div class="para">
		<a class="xref" href="chap-Java_EE_Declarative_Security_Overview.html#EJB_method_permissions-An_ejb_jar.xml_descriptor_fragment_that_illustrates_the_method_permission_element_usage.">Example 1.5, “&lt;method-permission&gt; element usage”</a> provides complete examples of the <span class="markup">&lt;method-permission&gt;</span> element usage.
	</div><div class="example"><a id="EJB_method_permissions-An_ejb_jar.xml_descriptor_fragment_that_illustrates_the_method_permission_element_usage.">
      ⁠</a><p class="title"><strong>Example 1.5. &lt;method-permission&gt; element usage</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ejb-jar&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;assembly-descriptor&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;method-permission&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;description&gt;</span>The employee and temp-employee roles may access any
<span xmlns="" class="line">​</span>                method of the EmployeeService bean <span xmlns="" class="perl_Keyword">&lt;/description&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;role-name&gt;</span>employee<span xmlns="" class="perl_Keyword">&lt;/role-name&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;role-name&gt;</span>temp-employee<span xmlns="" class="perl_Keyword">&lt;/role-name&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;method&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>EmployeeService<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;method-name&gt;</span>*<span xmlns="" class="perl_Keyword">&lt;/method-name&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;/method&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/method-permission&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;method-permission&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;description&gt;</span>The employee role may access the findByPrimaryKey,
<span xmlns="" class="line">​</span>                getEmployeeInfo, and the updateEmployeeInfo(String) method of
<span xmlns="" class="line">​</span>                the AardvarkPayroll bean <span xmlns="" class="perl_Keyword">&lt;/description&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;role-name&gt;</span>employee<span xmlns="" class="perl_Keyword">&lt;/role-name&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;method&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>AardvarkPayroll<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;method-name&gt;</span>findByPrimaryKey<span xmlns="" class="perl_Keyword">&lt;/method-name&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;/method&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;method&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>AardvarkPayroll<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;method-name&gt;</span>getEmployeeInfo<span xmlns="" class="perl_Keyword">&lt;/method-name&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;/method&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;method&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>AardvarkPayroll<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;method-name&gt;</span>updateEmployeeInfo<span xmlns="" class="perl_Keyword">&lt;/method-name&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;method-params&gt;</span>
<span xmlns="" class="line">​</span>                    <span xmlns="" class="perl_Keyword">&lt;method-param&gt;</span>java.lang.String<span xmlns="" class="perl_Keyword">&lt;/method-param&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;/method-params&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;/method&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/method-permission&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;method-permission&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;description&gt;</span>The admin role may access any method of the
<span xmlns="" class="line">​</span>                EmployeeServiceAdmin bean <span xmlns="" class="perl_Keyword">&lt;/description&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;role-name&gt;</span>admin<span xmlns="" class="perl_Keyword">&lt;/role-name&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;method&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>EmployeeServiceAdmin<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;method-name&gt;</span>*<span xmlns="" class="perl_Keyword">&lt;/method-name&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;/method&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/method-permission&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;method-permission&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;description&gt;</span>Any authenticated user may access any method of the
<span xmlns="" class="line">​</span>                EmployeeServiceHelp bean<span xmlns="" class="perl_Keyword">&lt;/description&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;unchecked/&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;method&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>EmployeeServiceHelp<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;method-name&gt;</span>*<span xmlns="" class="perl_Keyword">&lt;/method-name&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;/method&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/method-permission&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;exclude-list&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;description&gt;</span>No fireTheCTO methods of the EmployeeFiring bean may be
<span xmlns="" class="line">​</span>                used in this deployment<span xmlns="" class="perl_Keyword">&lt;/description&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;method&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>EmployeeFiring<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;method-name&gt;</span>fireTheCTO<span xmlns="" class="perl_Keyword">&lt;/method-name&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;/method&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/exclude-list&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/assembly-descriptor&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/ejb-jar&gt;</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139921632478560">
      ⁠</a>1.5. Enterprise Bean Security Annotations</h1></div></div></div><div class="para">
		Enterprise beans use Annotations to pass information to the deployer about security and other aspects of the application. The deployer can set up the appropriate enterprise bean security policy for the application if specified in annotations, or the deployment descriptor.
	</div><div class="para">
		Any method values explicitly specified in the deployment descriptor override annotation values. If a method value is not specified in the deployment descriptor, those values set using annotations are used. The overriding granularity is on a per-method basis
	</div><div class="para">
		Those annotations that address security and can be used in an enterprise beans include the following:
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="parameter"><code>@DeclareRoles</code></em></span></dt><dd><div class="para">
					Declares each security role declared in the code. For information about configuring roles, refer to the <em class="citetitle">Java EE 5 Tutorial</em> <a href="http://docs.sun.com/app/docs/doc/819-3669/bnbyp?l=en&amp;a=view">Declaring Security Roles Using Annotations</a>.
				</div></dd><dt><span class="term"><em class="parameter"><code>@RolesAllowed</code></em>, <em class="parameter"><code>@PermitAll</code></em>, and <em class="parameter"><code>@DenyAll</code></em></span></dt><dd><div class="para">
					Specifies method permissions for annotations. For information about configuring annotation method permissions, refer to the <em class="citetitle">Java EE 5 Tutorial</em> <a href="http://docs.sun.com/app/docs/doc/819-3669/bnbyw?l=en&amp;a=view">Specifying Method Permissions Using Annotations</a>.
				</div></dd><dt><span class="term"><em class="parameter"><code>@RunAs</code></em></span></dt><dd><div class="para">
					Configures the propagated security identity of a component. For information about configuring propagated security identities using annotations, refer to the <em class="citetitle">Java EE 5 Tutorial</em> <a href="http://docs.sun.com/app/docs/doc/819-3669/bnbzb?l=en&amp;a=view">Configuring a Component’s Propagated Security Identity</a>.
				</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="J2EE_Declarative_Security_Overview-Web_Content_Security_Constraints">
      ⁠</a>1.6. Web Content Security Constraints</h1></div></div></div><div class="para">
		In a web application, security is defined by the roles that are allowed access to content by a URL pattern that identifies the protected content. This set of information is declared by using the <code class="filename">web.xml</code><span class="markup"> security-constraint</span> element.
	</div><div class="figure"><a id="Web_Content_Security_Constraints-The_security_constraint_element">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><img src="images/webapp_security_constraint.png" alt="&lt;security-constraint&gt; element"/></div></div><p class="title"><strong>Figure 1.6. &lt;security-constraint&gt; element</strong></p></div><div class="para">
		The content to be secured is declared using one or more <span class="markup">&lt;web-resource-collection&gt;</span> elements. Each <span class="markup">&lt;web-resource-collection&gt;</span> element contains an optional series of <span class="markup">&lt;url-pattern&gt;</span> elements followed by an optional series of <span class="markup">&lt;http-method&gt;</span> elements. The <span class="markup">&lt;url-pattern&gt;</span> element value specifies a URL pattern against which a request URL must match for the request to correspond to an attempt to access secured content. The <span class="markup">&lt;http-method&gt;</span> element value specifies a type of HTTP request to allow.
	</div><div class="para">
		The optional <span class="markup">&lt;user-data-constraint&gt;</span> element specifies the requirements for the transport layer of the client to server connection. The requirement may be for content integrity (preventing data tampering in the communication process) or for confidentiality (preventing reading while in transit). The <span class="markup">&lt;transport-guarantee&gt;</span> element value specifies the degree to which communication between the client and server should be protected. Its values are <code class="literal">NONE</code>, <code class="literal">INTEGRAL</code>, and <code class="literal">CONFIDENTIAL</code>. A value of <code class="literal">NONE</code> means that the application does not require any transport guarantees. A value of <code class="literal">INTEGRAL</code> means that the application requires the data sent between the client and server to be sent in such a way that it can not be changed in transit. A value of <code class="literal">CONFIDENTIAL</code> means that the application requires the data to be transmitted in a fashion that prevents other entities from observing the contents of the transmission. In most cases, the presence of the <code class="literal">INTEGRAL</code> or <code class="literal">CONFIDENTIAL</code> flag indicates that the use of SSL is required.
	</div><div class="para">
		The optional <span class="markup">&lt;login-config&gt;</span> element is used to configure the authentication method that should be used, the realm name that should be used for the application, and the attributes that are needed by the form log in mechanism.
	</div><div class="figure"><a id="Web_Content_Security_Constraints-The_login_config_element">
      ⁠</a><div class="figure-contents"><div class="mediaobject"><img src="images/webapp_login_config.png" alt="&lt;login-config&gt; element"/></div></div><p class="title"><strong>Figure 1.7. &lt;login-config&gt; element</strong></p></div><div class="para">
		The <span class="markup">&lt;auth-method&gt;</span> child element specifies the authentication mechanism for the web application. As a prerequisite to gaining access to any web resources that are protected by an authorization constraint, a user must have authenticated using the configured mechanism. Legal <span class="markup">&lt;auth-method&gt;</span> values are <code class="literal">BASIC</code>, <code class="literal">DIGEST</code>, <code class="literal">FORM</code>, and <code class="literal">CLIENT-CERT</code>. The <span class="markup">&lt;realm-name&gt;</span> child element specifies the realm name to use in HTTP basic and digest authorization. The <span class="markup">&lt;form-login-config&gt;</span> child element specifies the log in as well as error pages that should be used in form-based log in. If the <span class="markup">&lt;auth-method&gt;</span> value is not <code class="literal">FORM</code>, then <code class="literal">form-login-config</code> and its child elements are ignored.
	</div><div class="para">
		<a class="xref" href="chap-Java_EE_Declarative_Security_Overview.html#Web_Content_Security_Constraints-_A_web.xml_descriptor_fragment_which_illustrates_the_use_of_the_security_constraint_and_related_elements.">Example 1.6, “web.xml descriptor fragment”</a> indicates that any URL lying under the web application's <code class="filename">/restricted</code> path requires an <code class="literal">AuthorizedUser</code> role. There is no required transport guarantee and the authentication method used for obtaining the user identity is BASIC HTTP authentication.
	</div><div class="example"><a id="Web_Content_Security_Constraints-_A_web.xml_descriptor_fragment_which_illustrates_the_use_of_the_security_constraint_and_related_elements.">
      ⁠</a><p class="title"><strong>Example 1.6. web.xml descriptor fragment</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;web-app&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;security-constraint&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;web-resource-collection&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;web-resource-name&gt;</span>Secure Content<span xmlns="" class="perl_Keyword">&lt;/web-resource-name&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;url-pattern&gt;</span>/restricted/*<span xmlns="" class="perl_Keyword">&lt;/url-pattern&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/web-resource-collection&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;auth-constraint&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;role-name&gt;</span>AuthorizedUser<span xmlns="" class="perl_Keyword">&lt;/role-name&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/auth-constraint&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;user-data-constraint&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;transport-guarantee&gt;</span>NONE<span xmlns="" class="perl_Keyword">&lt;/transport-guarantee&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/user-data-constraint&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/security-constraint&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;login-config&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;auth-method&gt;</span>BASIC<span xmlns="" class="perl_Keyword">&lt;/auth-method&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;realm-name&gt;</span>The Restricted Zone<span xmlns="" class="perl_Keyword">&lt;/realm-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/login-config&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;security-role&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;description&gt;</span>The role required to access restricted content <span xmlns="" class="perl_Keyword">&lt;/description&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;role-name&gt;</span>AuthorizedUser<span xmlns="" class="perl_Keyword">&lt;/role-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/security-role&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/web-app&gt;</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Enabling_FORM_Authentication">
      ⁠</a>1.7. Enabling Form-based Authentication</h1></div></div></div><div class="para">
		Form-based authentication provides flexibility in defining a custom JSP/HTML page for log in, and a separate page to which users are directed if an error occurs during log in.
	</div><div class="para">
		Form-based authentication is defined by including <code class="code"> &lt;auth-method&gt;FORM&lt;/auth-method&gt; </code> in the <span class="markup">&lt;login-config&gt;</span> element of the deployment descriptor, <code class="filename">web.xml</code>. The login and error pages are also defined in <span class="markup">&lt;login-config&gt;</span>, as follows:
	</div><pre class="programlisting">&lt;login-config&gt;
  &lt;auth-method&gt;FORM&lt;/auth-method&gt;
  &lt;form-login-config&gt;
    &lt;form-login-page&gt;/login.html&lt;/form-login-page&gt;
    &lt;form-error-page&gt;/error.html&lt;/form-error-page&gt;
  &lt;/form-login-config&gt;
&lt;/login-config&gt;</pre><div class="para">
		When a web application with form-based authentication is deployed, the web container uses <code class="classname">FormAuthenticator</code> to direct users to the appropriate page. JBoss Enterprise Application Platform maintains a session pool so that authentication information does not need to be present for each request. When <code class="classname">FormAuthenticator</code> receives a request, it queries <code class="classname">org.apache.catalina.session.Manager</code> for an existing session. If no session exists, a new session is created. <code class="classname">FormAuthenticator</code> then verifies the credentials of the session.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Authentication Requests</strong></p></div><div class="admonition"><div class="para">
			Each session is identified by a session ID, a 16 byte string generated from random values. These values are retrieved from <code class="filename">/dev/urandom</code> (Linux) by default, and hashed with MD5. Checks are performed at session ID creation to ensure that the ID created is unique.
		</div></div></div><div class="para">
		Once verified, the session ID is assigned as part of a cookie, and then returned to the client. This cookie is expected in subsequent client requests and is used to identify the user session.
	</div><div class="para">
		The cookie passed to the client is a name value pair with several optional attributes. The identifier attribute is called <code class="varname"> JSESSIONID </code> . Its value is a hex-string of the session ID. This cookie is configured to be non-persistent. This means that on the client side it will be deleted when the browser exits. On the server side, sessions expire after 60 seconds of inactivity, at which time session objects and their credential information are deleted.
	</div><div class="para">
		Say a user attempts to access a web application that is protected with form-based authentication. <code class="classname">FormAuthenticator</code> caches the request, creates a new session if necessary, and redirects the user to the login page defined in <code class="literal">login-config</code>. (In the previous example code, the login page is <code class="filename">login.html</code>.) The user then enters their user name and password in the HTML form provided. User name and password are passed to <code class="classname">FormAuthenticator</code> via the <code class="methodname"> j_security_check </code> form action.
	</div><div class="para">
		The <code class="classname">FormAuthenticator</code> then authenticates the user name and password against the realm attached to the web application context. In JBoss Enterprise Application Platform, the realm is <code class="literal">JBossWebRealm</code>. When authentication is successful, <code class="classname">FormAuthenticator</code> retrieves the saved request from the cache and redirects the user to their original request.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			The server recognizes form authentication requests only when the URI ends with <code class="literal">/j_security_check</code> and at least the <code class="varname"> j_username </code> and <code class="varname"> j_password </code> parameters exist.
		</div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="J2EE_Declarative_Security_Overview-Enabling_Declarative_Security_in_JBoss">
      ⁠</a>1.8. Enabling Declarative Security</h1></div></div></div><div class="para">
		The Java EE security elements that have been covered so far describe the security requirements only from the application's perspective. Because Java EE security elements declare logical roles, the application deployer maps the roles from the application domain onto the deployment environment. The Java EE specifications omit these application server-specific details.
	</div><div class="para">
		To map application roles onto the deployment environment, you must specify a security manager that implements the Java EE security model using JBoss Enterprise Application Platform specific deployment descriptors. The details behind the security configuration are discussed in <a class="xref" href="ch12.html#A_Custom_LoginModule_Example-_A_JndiUserAndPass_custom_login_module">Example 12.17, “JndiUserAndPass Custom Login Module”</a>.
	</div></div></div></body></html>