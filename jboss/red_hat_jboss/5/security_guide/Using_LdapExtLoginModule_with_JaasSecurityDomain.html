<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 19. Using LdapExtLoginModule with JaasSecurityDomain</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="Using_LdapExtLoginModule_with_JaasSecurityDomain">
      ⁠</a>Chapter 19. Using LdapExtLoginModule with JaasSecurityDomain</h1></div></div></div><div class="para">
		This chapter provides guidance on how the LdapExtLoginModule can be used with an encrypted password to be decrypted by a JaasSecurityDomain. This chapter assumes that the LdapExtLoginModule is already running correctly with a non-encrypted password. For more information about LdapExtLoginModule, refer to <a class="xref" href="ch12.html#sect-LdapExtLoginModule">Section 12.1.2, “LdapExtLoginModule”</a>
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139921633787328">
      ⁠</a><p class="title"><strong>Procedure 19.1. </strong></p><ol class="1"><li class="step"><p class="title"><strong>Define JaasSecurityDomain MBean</strong></p><div class="para">
				Define the JaasSecurityDomain MBean used to decrypt the encrypted version of the password. You can add the MBean to <code class="filename">JBOSS_HOME/server/<em class="replaceable">PROFILE</em>/conf/jboss-service.xml</code>, or to a *<code class="filename">-service.xml</code> deployment descriptor in the <code class="filename">JBOSS_HOME/server/<code class="filename"> <em class="replaceable">PROFILE</em> </code>/deploy</code> folder.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;mbean</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.security.plugins.JaasSecurityDomain"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      name=</span><span xmlns="" class="perl_String">"jboss.security:service=JaasSecurityDomain,domain=jmx-console"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;constructor&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;arg</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"java.lang.String"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"jmx-console"</span><span xmlns="" class="perl_Keyword">&gt;&lt;/arg&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/constructor&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"KeyStorePass"</span><span xmlns="" class="perl_Keyword">&gt;</span>some_password<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Salt"</span><span xmlns="" class="perl_Keyword">&gt;</span>abcdefgh<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"IterationCount"</span><span xmlns="" class="perl_Keyword">&gt;</span>66<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/mbean&gt;</span>
</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The default cipher algorithm used by the JaasSecurityDomain implementation is <code class="literal">PBEwithMD5andDES</code>. Other cipher algorithms include <code class="literal">DES</code>, <code class="literal">TripleDES</code>, <code class="literal">Blowfish</code>, and <code class="literal">PBEWithMD5AndTripleDES</code>. All algorithms are symmetric algorithms. You specify a cipher algorithm by appending an <span class="markup">&lt;attribute&gt;</span> element with the <em class="parameter"><code>CypherElement</code></em> attribute set to one of these values.
				</div></div></div></li><li class="step"><p class="title"><strong>Adjust password, salt, and iteration count</strong></p><div class="para">
				Step One contains a simple configuration where the required password, Salt, and Iteration Count used for the encryption or decryption are contained within the MBean definition. 
			</div><div class="para">
				Ensure you change the KeyStorePass, Salt, and IterationCount values suitable for your own deployment.
			</div></li><li class="step"><p class="title"><strong>Start the platform</strong></p><div class="para">
				Start the server after configuring the MBean, password, salt, and iteration counts. Ensure you start the platform by specifying the server profile containing the configuration.
			</div><pre class="screen">[bin]$ ./run.sh -c <em class="replaceable">PROFILE</em></pre></li><li class="step"><p class="title"><strong>Open the JMX Console</strong></p><div class="para">
				Navigate to the JMX Console (<a href="http://localhost:8080/jmx-console/">http://localhost:8080/jmx-console/</a> by default) and select the <code class="literal">org.jboss.security.plugins.JaasSecurityDomain</code> MBean.
			</div></li><li class="step"><p class="title"><strong>Invoke the LdapExtLoginModule</strong></p><ol class="substeps a"><li class="step"><div class="para">
						On the <code class="literal">org.jboss.security.plugins.JaasSecurityDomain</code> page, find the <code class="methodname"> encode64(String password) </code> method.
					</div></li><li class="step"><div class="para">
						Pass the plain text version of the <code class="varname"> password </code> the LdapExtLoginModule will use to this method.
					</div></li><li class="step"><div class="para">
						Invoke the <code class="methodname"> encode64(String password) </code> method.
					</div></li><li class="step"><div class="para">
						The return value is the encrypted version of the password encoded as Base64.
					</div></li></ol></li><li class="step"><p class="title"><strong>Configure Login Module</strong></p><div class="para">
				Within the login module configuration, the following module-options should be set:
			</div><div class="para">

			</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jaasSecurityDomain"</span><span xmlns="" class="perl_Keyword">&gt;</span>jboss.security:service=JaasSecurityDomain,domain=jmx-console<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"bindCredential"</span><span xmlns="" class="perl_Keyword">&gt;</span>2gx7gcAxcDuaHaJMgO5AVo<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span></pre><div class="para">
				The first option specifies the JaasSecurityDomain configured in Step 1 is used to decrypt the password.
			</div><div class="para">
				The <em class="parameter"><code>bindCredential</code></em> is replaced with the encrypted Base64 password obtained in Step 5.
			</div></li></ol></div></div></body></html>