<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 11. Migrating to Enterprise Application Platform 5</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="Migration">
      ⁠</a>Chapter 11. Migrating to Enterprise Application Platform 5</h1></div></div></div><div class="para">
		This chapter provides information for administrators who plan to move their enterprise servers from JBoss Enterprise Application Platform 4.2 or 4.3 to the new Enterprise Application Platform 5.
	</div><div class="para">
		The first section covers new features available in Enterprise Application Platform 5. The second section covers the changes to configuration, administration, and application deployment between Enterprise Application Platform 4.x and Enterprise Application Platform 5.
	</div><div class="para">
		If you require further information, refer to the relevant guides provided in this release.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			JBoss Enterprise Application 5 is a major release, and includes major changes from JBoss Enterprise Application Platform 4.3. With the release of JBoss Enterprise Application Platform 5.1.1 onwards, an RPM upgrade path from JBoss Enterprise Application Platform 4.3 is no longer available.
		</div><div class="para">
			JBoss Enterprise Application Platform 4.3 customers that want to upgrade to JBoss Enterprise Application Platform 5 should back-up their production systems and proceed with installing the platform using an installation option described in <a class="xref" href="part_Installation.html">Part I, “Installing JBoss Enterprise Application Platform 5”</a>.
		</div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migration.changes">
      ⁠</a>11.1. What's New in Enterprise Application Platform 5</h1></div></div></div><div class="para">
			This section provides an overview of the components of Enterprise Application Platform 5, and the changes to each component between version 4.x and 5.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration.change.as510">
      ⁠</a>11.1.1. JBoss Application Server 5 GA</h2></div></div></div><div class="para">
				JBoss Application Server 5 is the next generation of the JBoss Application Server built on top of a new kernel architecture, the <span class="application"><strong>JBoss Microcontainer</strong></span>. The JBoss Microcontainer is a lightweight container for managing the deployment, configuration and life cycle of Plain Old Java Objects (POJOs). While remaining compatible with the 4.x-based JMX kernel, the Microcontainer integrates with the JBoss framework for Aspect Oriented Programming, JBoss AOP. JMX support remains strong in EAP 5, and MBean services written against the old Microkernel work as expected. Further, it lays the groundwork for Java EE 6 profile-oriented configurations and embedded EAP, which will allow for fine grained selection of services for both unit testing and embedded scenarios.
			</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="migration.change.profile">
      ⁠</a>11.1.1.1. ProfileService-based Deployment Configuration</h3></div></div></div><div class="para">
					Definitions for both non-kernel deployers and their deployment are now contained in a Profile obtained from the ProfileService. The <span class="application"><strong>ProfileService</strong></span> replaces EAP 4.x <span class="emphasis"><em>server configuration</em></span>. In EAP 4.x, a server configuration was a collection of services and applications loaded from the <code class="filename">deploy</code> directory by the deployment scanner service. Enterprise Application Platform 5 uses more active profiles, which may depend on other <span class="emphasis"><em>sub-profiles</em></span>.
				</div><div class="para">
					The main profile is the <span class="emphasis"><em>server profile</em></span>, which is based on the <code class="literal">${jboss.server.name}</code>. This profile has three sub-profiles:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							<span class="emphasis"><em>bootstrap</em></span> — representing <code class="filename">conf/jboss-service.xml</code>
						</div></li><li class="listitem"><div class="para">
							<span class="emphasis"><em>deployers</em></span> — the <code class="filename">deployers/</code> directory
						</div></li><li class="listitem"><div class="para">
							<span class="emphasis"><em>applications</em></span> — a hot-deployment profile for the <code class="filename">deploy/</code> and additional user directories
						</div></li></ul></div><div class="para">
					A profile generally represents a named collection of deployments on a server. A profile can also apply certain behaviors to the deployments that it manages. Some profiles, such as the <code class="literal">application</code> profile, provide hot-deployment checks and allow remote distribution of deployed applications via the <code class="literal">DeploymentManager</code>. Other profiles can provide a farming service to distribute deployments over a cluster. The ProfileService also provides the ManagementView for ManagedDeployments/ManagedObjects used by the Enterprise Application Admin Console (admin-console).
				</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration.change.ejb3">
      ⁠</a>11.1.2. Enterprise Java Beans (EJB) 3.0</h2></div></div></div><div class="para">
				JBoss EJB 3.0, an implementation of the latest revision of the EJB specification, is a deep overhaul and simplification of earlier versions of the EJB specification. It simplifies development, facilitates a test driven approach, and focuses more on writing POJOs rather than coding against complex EJB APIs.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration.change.jee5">
      ⁠</a>11.1.3. Java Enterprise Edition 5 Compliance</h2></div></div></div><div class="para">
				JBoss Enterprise Application Platform 5 is a fully-certified Java EE 5 implementation. It uses the microcontainer to integrate enterprise services with a Servlet/JSP container, EJB container, deployers and management utilities, providing a standard Java EE environment with the flexibility to deploy additional services on top of Java EE to give you the functionality you need. For further compatibility details, read <a href="http://java.sun.com/javaee/overview/compatibility.jsp">http://java.sun.com/javaee/overview/compatibility.jsp</a> page.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration.change.seam2">
      ⁠</a>11.1.4. Seam 2.2.0.GA</h2></div></div></div><div class="para">
				Seam is an application framework for Java Enterprise Edition. It integrates technologies such as Asynchronous JavaScript and XML (AJAX), JavaServer Faces (JSF), Java Persistence (JPA), Enterprise JavaBeans 3.0 (EJB) and Business Process Management (BPM). Seam enables developers to assemble complex web applications using simple annotated Java classes, a rich set of UI components, and very little XML.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration.change.resteasy">
      ⁠</a>11.1.5. RESTEasy 1.1.GA</h2></div></div></div><div class="para">
				RESTEasy provides several frameworks to help you build RESTful Web Services and RESTful Java applications. It is a fully-certified, portable implementation of the <a href="http://jsr311.dev.java.net/">JAX-RS</a> specification, which defines a Java API for RESTful Web Services over the Hypertext Transfer Protocol (HTTP).
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration.change.gui">
      ⁠</a>11.1.6. Enhanced Enterprise GUI Installer</h2></div></div></div><div class="para">
				The Enterprise Installer retains the familiar Enterprise Application Platform 4.3 interface but includes enhancements to provide you with a complete Enterprise Application Platform 5 installation. The installer is localized and provides you with secure JMX, Web and Admin Consoles.
			</div><div class="para">
				The new Enterprise Installer also presents users with the opportunity to install the optional Native package, which includes <span class="application"><strong>JBoss Native</strong></span> and <span class="application"><strong>mod_jk</strong></span>. The Native package helps users who wish to use Tomcat or JBoss Web with the HTTP daemon.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration.change.admin">
      ⁠</a>11.1.7. Enterprise Application Platform Admin Console</h2></div></div></div><div class="para">
				A new Admin Console is being introduced in this Enterprise Application Platform release. The admin-console enables configuration and management of a single Enterprise Application Platform server instance. See <a class="xref" href="Migration.html#migration.admin">Section 11.3, “Admin Console”</a> for more information about this new management console.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration.change.jts">
      ⁠</a>11.1.8. JBoss Transactions includes Java Transaction Service</h2></div></div></div><div class="para">
				JBoss Transactions now includes the Java Transaction Service and the XML Transaction Service. The Java Transaction Service handles distributed, interoperable transactions between Enterprise JavaBean containers. The XML Transaction Service handles transactions for Web Services.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration.change.jars">
      ⁠</a>11.1.9. Distribution with Red Hat Signed JARs</h2></div></div></div><div class="para">
				JAR files included with JBoss Enterprise Application Platform are digitally signed by Red Hat. This gives you an additional level of security about the source and identity of the code executing on your systems.
			</div><div class="para">
				For the complete technology matrix and information on the revision level of included components please refer to the Release Notes.
			</div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migration.config">
      ⁠</a>11.2. What's Different in Enterprise Application Platform 5</h1></div></div></div><div class="para">
			The distribution layout and configuration information in the Enterprise Application Platform 5 distribution are similar to the Enterprise Application Platform 4.x series with some notable differences. This section highlights the differences at a glance.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration.config.lib">
      ⁠</a>11.2.1. Differences in the Distribution Layout</h2></div></div></div><div class="para">
				The directory structure of <code class="filename">jboss-as</code> directory is summarized below.
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="filename">/bin</code> — contains start scripts and <code class="filename">run.jar</code>
					</div></li><li class="listitem"><div class="para">
						<code class="filename">/client</code> — contains client JARs.
					</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							Previously, JBoss client libraries were bundled in <code class="filename">jbossall-client.jar</code>. Rather than including them, <code class="filename">jbossall-client.jar</code> now references them through a Classpath manifest entry. This enables granular updating of libraries without requiring replacement of all libraries. It requires that you have the <code class="filename">jbossall-client.jar</code>, which now acts as a map or index, as well as the actual <code class="filename">client/*.jar</code> libraries.
						</div></div></div></li><li class="listitem"><div class="para">
						<code class="filename">/common/lib</code> — contains shared libraries common to various configurations have been moved to this new shared location. This eliminates the need for multiple copies of the same library in the distribution.
					</div><div class="para">
						The location of the common library directory is controlled with the following properties:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<code class="literal">jboss.common.base.url</code> — the default value is <code class="literal">${jboss.home.url}/common</code>
							</div></li><li class="listitem"><div class="para">
								<code class="literal">jboss.common.lib.url</code> — the default value is <code class="literal">${jboss.common.base.url}/lib</code>
							</div></li></ul></div><div class="para">
						You can set these properties in <code class="filename">run.conf</code> under <code class="literal">JAVA_OPTS</code> with the <code class="code">-D</code> flag:
					</div><pre class="programlisting">JAVA_OPTS="[...] -Djboss.common.base.url=$URL1 -Djboss.common.lib.url=$URL2"
</pre><div class="para">
						The common library directory is shared by all configuration types except for the <code class="literal">minimal</code> configuration. The common library is referenced at the beginning of every configuration's <code class="filename">conf/jboss-service.xml</code>
					</div><pre class="programlisting XML">&lt;classpath codebase="${jboss.server.lib.url}" archives="*"/&gt;</pre><div class="para">
						The <code class="filename">library</code> directory of the individual directory remains in place, although in some cases (as in <code class="filename">$JBOSS_HOME/server/default/lib/</code>) it is an empty directory.
					</div></li><li class="listitem"><div class="para">
						<code class="filename">/docs</code> — contains schemas, document type declarations, examples and licenses. Most deployment descriptors now use XML Schema Definitions (XSDs). One exception is <code class="literal">jboss-app</code>, which uses <code class="filename">jboss-app_5_0.dtd</code>. JBoss Web uses <code class="filename">jboss-web_5_1.xsd</code>. For Enterprise JavaBeans 3.0 deployments, <code class="filename">jboss_5_1.xsd</code> is the recommended schema. Enterprise JavaBeans 2.0 deployments must use <code class="filename">jboss_x_x.dtd</code>.
					</div></li><li class="listitem"><div class="para">
						<code class="filename">/lib</code> — contains the core bootstrap JARs. These have been changed slightly to accommodate the Microcontainer and the division of <code class="filename">jboss-common</code>.
					</div></li><li class="listitem"><div class="para">
						<code class="filename">/server</code> — contains directories for configuring the server:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<code class="filename"> <em class="replaceable">$PROFILE</em> </code> — contains the configuration details of a particular server profile
							</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
										<code class="filename">/conf</code>
									</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
												<code class="filename">bootstrap.xml</code> — a new kernel bootstrap configuration that refers to other configuration files containing the beans to set up each individual subsystem.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">bindingservice.beans</code>
											</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
														<code class="filename">/META-INF</code>
													</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
																<code class="filename">bindings-jboss-beans.xml</code> — contains required port bindings.
															</div></li></ul></div></li><li class="listitem"><div class="para">
														<code class="filename">jboss-bindingservice.jar</code>
													</div></li></ul></div></li><li class="listitem"><div class="para">
												<code class="filename">/bootstrap</code>
											</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
														<code class="filename">vfs.xml</code> — initializes the virtual file system
													</div></li><li class="listitem"><div class="para">
														<code class="filename">classloader.xml</code>
													</div></li><li class="listitem"><div class="para">
														<code class="filename">aop.xml</code>
													</div></li><li class="listitem"><div class="para">
														<code class="filename">jmx.xml</code> — legacy JMX support.
													</div></li><li class="listitem"><div class="para">
														<code class="filename">deployers.xml</code>
													</div></li><li class="listitem"><div class="para">
														<code class="filename">profile-repository.xml</code> — the ProfileService enabled deployment repository.
													</div></li></ul></div></li><li class="listitem"><div class="para">
												<code class="filename">jax-ws-catalog.xml</code> — an Oasis Catalog-driven Schema/DTD namespace configuration file.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">jbossts-properties.xml</code> — contains new JBossTS properties.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">jboss-service.xml</code> — contains legacy static managed beans to retain compatibility.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">jndi.properties</code> — contains JNDI configuration properties.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">log4j.xml</code> — contains log4j configuration information.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">login-config.xml</code> — contains JAAS login configuration information.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">/props</code> — contains default JAAS login properties files.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">standardjbosscmp-jdbc.xml</code> — contains CMP2 configuration information.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">standardjboss.xml</code> — contains Enterprise JavaBean 2.0 configuration information.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">/xmdesc</code> — contains legacy XML managed bean descriptors.
											</div></li></ul></div></li><li class="listitem"><div class="para">
										<code class="filename">/deploy</code>
									</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
												<code class="filename">jca-jboss-beans.xml</code>
											</div></li><li class="listitem"><div class="para">
												<code class="filename">hdscanner-jboss-beans.xml</code> — contains the hot-deployment scanner.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">legacy-invokers-service.xml</code>
											</div></li><li class="listitem"><div class="para">
												<code class="filename">profileservice-jboss-beans.xml</code>
											</div></li><li class="listitem"><div class="para">
												<code class="filename">remoting-jboss-beans.xml</code>
											</div></li><li class="listitem"><div class="para">
												<code class="filename">transaction-jboss-beans.xml</code>
											</div></li><li class="listitem"><div class="para">
												<code class="filename">vfs-jboss-beans.xml</code>
											</div></li></ul></div></li><li class="listitem"><div class="para">
										<code class="filename">/deployers</code> — contains new VDF deployers.
									</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
												<code class="filename">/bsh-deployer</code> — contains the beanshell deployer.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">ejb3.deployer</code> — contains Enterprise JavaBean 3.0 deployers.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">jboss-aop-jboss5.deployer</code> — contains the aspect deployer.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">jboss-jca.deployer</code> — contains the JCA deployers.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">jbossweb.deployer</code> — contains the WAR deployers.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">jbossws.deployer</code> — contains the web service deployers.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">seam.deployer</code> — contains the Seam deployer.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">clustering-deployers-jboss-beans.xml</code>
											</div></li><li class="listitem"><div class="para">
												<code class="filename">dependency-deployers-jboss-beans.xml</code>
											</div></li><li class="listitem"><div class="para">
												<code class="filename">directory-deployer-jboss-beans.xml</code>
											</div></li><li class="listitem"><div class="para">
												<code class="filename">ear-deployer-jboss-beans.xml</code>
											</div></li><li class="listitem"><div class="para">
												<code class="filename">ejb-deployer-jboss-beans.xml</code>
											</div></li><li class="listitem"><div class="para">
												<code class="filename">hibernate-deployer-jboss-beans.xml</code>
											</div></li><li class="listitem"><div class="para">
												<code class="filename">logbridge-boss-beans.xml</code>
											</div></li><li class="listitem"><div class="para">
												<code class="filename">jsr77-deployers-jboss-beans.xml</code> — contains JSR-77 (J2EE Management) support.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">metadata-deployer-jboss-beans.xml</code> — contains the metadata handlers.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">messaging-definitions-jboss-beans.xml</code> — contains data required to map JMS destinations to managed objects.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">security-deployer-jboss-beans.xml</code> — contains the security deployers.
											</div></li><li class="listitem"><div class="para">
												<code class="filename">xnio.deployer</code>
											</div></li><li class="listitem"><div class="para">
												<code class="filename">jboss-threads.deployer</code>
											</div></li></ul></div></li><li class="listitem"><div class="para">
										<code class="filename">/lib</code> — contains static library JARs. Some JARs that were previously located in this directory have been moved into the top-level <code class="filename">common/lib</code> directory.
									</div></li></ul></div></li></ul></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration.config.new">
      ⁠</a>11.2.2. Standard and Web Configuration</h2></div></div></div><div class="para">
				Two additional server configurations are distributed with Enterprise Application Platform 5: <code class="literal">standard</code> and <code class="literal">web</code>.
			</div><div class="para">
				The <code class="literal">standard</code> configuration is certified for Java EE 5 compliance. This configuration enables both call-by-value and deployment isolation by default. Support for RMI-IIOP (Remote Method Invocation over the Internet Inter-Orb Protocol) and Java UDDI (Universal Description, Discovery and Integration), as in the <code class="literal">all</code> configuration type, is also enabled.
			</div><div class="para">
				The <code class="literal">web</code> configuration is lightweight. It was created around JBoss Web and provides the services required for web application deployment and only a subset of Java EE technologies. This profile does not include JBoss Transaction JTS or XTS, Enterprise Java Bean 1.x or 2.x capabilities, JBoss Messaging, JCA, or JBoss IIOP.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration.config.as">
      ⁠</a>11.2.3. Differences in Application Server Configuration Files</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="migration.config.as-gen">
      ⁠</a>11.2.3.1. General</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							A reminder that the RPM and ZIP distributions of the Enterprise Application Platform are shipped with authentication enabled for the JMX Console, Web Console, JMX Invoker, Admin Console, HTTP Invoker and Profile Service. No user accounts are active by default to assist in preventing default user and password-based attacks.
						</div></li><li class="listitem"><div class="para">
							<code class="filename">shutdown.sh</code> now accepts a JNDI URL, as follows:
						</div><pre class="programlisting">shutdown.sh -s http://localhost:8080/invoker/JNDIFactory -S</pre><div class="para">
							Where <code class="code">-s</code> defines the server name to perform an operation on; <code class="code">-S</code> specifies the shutdown operation.
						</div></li><li class="listitem"><div class="para">
							If a user omits the <code class="code">-c</code> option when starting an instance of JBoss Application Server in Enterprise Application Platform 4.x, the <code class="literal">production</code> configuration was started by default. In JBoss Enterprise Application Platform 5, <code class="literal">default</code> configuration is used when a user omits the <code class="code">-c</code> option.
						</div></li><li class="listitem"><div class="para">
							<code class="filename">bin/run.conf</code> now uses a Java heap size of 1303 MB. This is consistent across all configurations.
						</div></li><li class="listitem"><div class="para">
							Document Type and Schema Declarations have been updated.
						</div></li><li class="listitem"><div class="para">
							The <code class="literal">production</code> server profile provided with Enterprise Application Platform 5 restricts the classes served on port 8083. If Remote Method Invocation (RMI) is being used, you may need to make this port available to clients. This option can be set in <code class="filename">production/conf/jboss-service.xml</code>:
						</div><pre class="programlisting XML">&lt;!-- Should non-EJB .class files be downloadable --&gt;
   &lt;attribute name="DownloadServerClasses"&gt;false&lt;/attribute&gt;</pre></li><li class="listitem"><div class="para">
							The cluster-safe UUID generator can now be used from <code class="filename">server/production/deploy/uuid-key-generator.sar/META-INF/jboss-service.xml</code>.
						</div></li><li class="listitem"><div class="para">
							The delay period for <code class="filename">server/production/deploy/hdscanner-jboss-beans.xml</code> to rescan for deployment changes has been increased to 60 seconds from the previous 5 second delay period.
						</div><pre class="programlisting XML">&lt;!-- Frequency in milliseconds to rescan the URLs for changes--&gt;
   &lt;property name="scanPeriod"&gt;60000&lt;/property&gt;</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="migration.config.as-jca">
      ⁠</a>11.2.3.2. J2EE Connector Architecture</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="filename">jboss-ra.xml</code> can now be used to override the properties specified in <code class="filename">*-ra.xml</code>.  
						</div><div class="para">
							The <code class="filename">jboss-ra.xml</code> file should be in the <code class="filename">META-INF</code> directory of the resource adapter whose properties you wish to override, alongside the <code class="filename">*-ra.xml</code> file.
						</div><div class="para">
							Specify a corresponding <code class="literal">&lt;ra-config-property&gt;</code> in the <code class="filename">jboss-ra.xml</code> file for each property you wish to override. An example follows:
						</div><div class="example"><a id="idm140281228577440">
      ⁠</a><p class="title"><strong>Example 11.1. Representative excerpt from resource adapter *-ra.xml file</strong></p><div class="example-contents"><pre class="programlisting XML">&lt;config-property&gt;
  &lt;config-property-name&gt;StringRAR&lt;/config-property-name&gt;
  &lt;config-property-type&gt;java.lang.String&lt;/config-property-type&gt;
  &lt;config-property-value&gt;StringFromRARProperties&lt;/config-property-value&gt;
&lt;/config-property&gt;
</pre></div></div><div class="example"><a id="idm140281228575552">
      ⁠</a><p class="title"><strong>Example 11.2. Representative excerpt from a corresponding jboss-ra.xml file</strong></p><div class="example-contents"><pre class="programlisting XML">&lt;ra-config-property&gt;
  &lt;ra-config-property-name&gt;StringRAR&lt;/ra-config-property-name&gt;
  &lt;ra-config-property-type&gt;java.lang.String&lt;/ra-config-property-type&gt;
  &lt;ra-config-property-value&gt;XMLOVERRIDE&lt;/ra-config-property-value&gt;
&lt;/ra-config-property&gt;
</pre></div></div><div class="para">
							The complete source for a working example can be viewed in the test case for this feature at <a href="https://anonsvn.jboss.org/repos/jbossas/trunk/testsuite/src/resources/jcaprops/xmloverride/META-INF/">https://anonsvn.jboss.org/repos/jbossas/trunk/testsuite/src/resources/jcaprops/xmloverride/META-INF/</a>.
						</div></li><li class="listitem"><div class="para">
							Support has been added for defining dependencies in J2EE Connector Architecture (JCA) adapters.
						</div></li><li class="listitem"><div class="para">
							<code class="filename">server/production/deploy/jca-jboss-beans.xml</code> disables debug monitoring of JCA and database connections:
						</div><pre class="programlisting XML">&lt;!-- Whether to track unclosed connections and close them --&gt;
&lt;property name="debug"&gt;false&lt;/property&gt;</pre><div class="para">
							This disables the application server's debug support. Disabling this means that the origin of obtained database connections and connection leaks cannot be tracked. Unclosed managed database connections are still returned to the connection pool, regardless of this attribute's value.
						</div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="migration.config.as-web">
      ⁠</a>11.2.3.3. Web</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							For JavaServer Pages-based pages, the default setting for <code class="varname">DeleteWorkDirOnContextDestroy</code> is <code class="literal">false</code>. Set this to <code class="literal">true</code> to enable a faster, simpler page recompilation check, or if you are using JSP settings that require recompilation. 
						</div></li><li class="listitem"><div class="para">
							<code class="literal">emptySessionPath="true"</code> no longer sets the cookie path <code class="filename">/</code> by default. Instead, the cookie path is set via the <code class="literal">&lt;SessionCookie path="/" /&gt;</code> in the <code class="varname">Context</code> element. Session cookies are now scoped to the context by default.
						</div></li><li class="listitem"><div class="para">
							<code class="literal">emptySessionPath</code> no longer affects whether Session IDs are recycled. This is now handled by the <code class="varname">org.apache.catalina.connector.Request.SESSION_ID_CHECK</code> system property. If set to <code class="literal">true</code>, the Servlet container verifies that a Session ID does not yet exist in a particular context before creating a session with that ID. You can set this property in the <code class="filename">jboss-as/bin/run.conf</code> file using the <code class="literal">-D</code> switch.
						</div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="migration.config.as-clust">
      ⁠</a>11.2.3.4. Clustering</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							Clustering configurations have been moved to a new <code class="filename">/deploy/cluster</code> directory.
						</div><pre class="programlisting">cluster
   |-- deploy-hasingleton-jboss-beans.xml
   |-- farm-deployment-jboss-beans.xml
   |-- ha-legacy-jboss-beans.xml
   |-- hajndi-jboss-beans.xml
   |-- hapartition-jboss-beans.xml
   |-- jboss-cache-manager.sar
   | `-- META-INF
   | |-- jboss-cache-configs.xml
   | `-- jboss-cache-manager-jboss-beans.xml
   |-- jbossweb-cluster.aop
   |-- jgroups-channelfactory.sar
   | `-- META-INF
   | |-- jgroups-channelfactory-jboss-beans.xml
   | `-- jgroups-channelfactory-stacks.xml
   `-- timestamps-jboss-beans.xml</pre></li><li class="listitem"><div class="para">
							A separate cache is now used for Clustered Single Sign-On (SSO).
						</div></li><li class="listitem"><div class="para">
							UseJK, snapshot mode and snapshot interval can now be configured on a per-application basis. The default value for UseJK depends upon whether the <code class="varname">jvmRoute</code> is set.
						</div></li><li class="listitem"><div class="para">
							The default setting for session replication is now <code class="literal">total</code> replication instead of <code class="literal">buddy</code> replication.
						</div></li><li class="listitem"><div class="para">
							<code class="varname">loopback</code> is now set to <code class="literal">true</code> for all JGroups User Datagram Protocol stacks.
						</div></li><li class="listitem"><div class="para">
							The <code class="varname">jboss.jgroups.udp.mcast_port</code> property is now used to configure the multicast port. The <code class="code">-m</code> option to the <code class="filename">run.sh</code> or <code class="filename">run.bat</code> script now sets <code class="varname">jboss.jgroups.udp.mcast_port</code> instead of <code class="varname">jgroups.udp.mcast_port</code>.
						</div><div class="para">
							<code class="varname">jgroups.udp.mcast_port</code> is checked internally by JGroups, and is used to override any XML-based configuration. If this parameter is set, two channels with non-shared transports cannot use different ports. The <code class="varname">jboss.jgroups.udp.mcast_port</code> property substitutes system properties in the default UDP channel configurations.
						</div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="migration.config.as-trans">
      ⁠</a>11.2.3.5. Transactions</h3></div></div></div><div class="para">
					The transaction manager configuration information has moved from <code class="filename">conf/jboss-service.xml</code> to <code class="filename">deploy/transaction-service.xml</code>.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="migration.config.as-log">
      ⁠</a>11.2.3.6. Logging</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							The default <code class="filename">conf/jboss-log4j.xml</code> configuration now includes the thread name for <code class="filename">log/server.log</code> entries.
						</div></li><li class="listitem"><div class="para">
							The new <code class="varname">jboss.server.log.threshold</code> system property can be used to control the <code class="filename">log/server.log</code> threshold. The default value is <code class="literal">INFO</code>.
						</div></li><li class="listitem"><div class="para">
							<code class="filename">server.log</code> is appended, rather than truncated, after a server is restarted.
						</div></li><li class="listitem"><div class="para">
							The following changes apply only to <code class="filename">server/production/conf/jboss-log4j.xml</code>:
						</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
									the console logger has been commented out by default.
								</div></li><li class="listitem"><div class="para">
									the async logger is enabled by default.
								</div></li><li class="listitem"><div class="para">
									a <code class="filename">cluster.log</code> file has been added to store cluster output.
								</div></li></ul></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="migration.config.as-sec">
      ⁠</a>11.2.3.7. Security</h3></div></div></div><div class="para">
					Security-related configuration files are now found in the <code class="filename">deploy/security</code> directory:
				</div><pre class="screen">security/
   |-- security-jboss-beans.xml
   `-- security-policies-jboss-beans.xml</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="migration.config.as-ejb">
      ⁠</a>11.2.3.8. Enterprise JavaBeans</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							Enterprise JavaBean configuration information is now located in <code class="filename">deployers/ejb3.deployer/META-INF/ejb3-deployers-jboss-beans.xml</code>.
						</div></li><li class="listitem"><div class="para">
							Java Persistence API configuration information is now located in <code class="filename">deployers/ejb3.deployer/META-INF/jpa-deployers-jboss-beans.xml</code>.
						</div></li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migration.admin">
      ⁠</a>11.3. Admin Console</h1></div></div></div><div class="para">
			The first release of the JBoss Enterprise Application Platform Admin Console (<code class="literal">admin-console</code>) provides the following administrative features:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					configuration information about the system on which the Enterprise Application Platform is running.
				</div></li><li class="listitem"><div class="para">
					configuration information about the Service Binding Manager.
				</div></li><li class="listitem"><div class="para">
					deploy, undeploy and update Enterprise Applications, including:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							Java EE Enterprise Applications (EARs)
						</div></li><li class="listitem"><div class="para">
							Web Applications (WARs)
						</div></li><li class="listitem"><div class="para">
							Resource Adapters (RARs)
						</div></li><li class="listitem"><div class="para">
							Enterprise JavaBean 2 and 3 (JARs)
						</div></li></ul></div></li><li class="listitem"><div class="para">
					persistent configuration changes for the following resources:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							data sources
						</div></li><li class="listitem"><div class="para">
							connection factories
						</div></li><li class="listitem"><div class="para">
							JMS queues and topics (based on JBoss Messaging)
						</div></li></ul></div></li><li class="listitem"><div class="para">
					Control Operations:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							execute scripts to perform tasks against a running instance of the application server
						</div></li><li class="listitem"><div class="para">
							stop, start, and restart applications
						</div></li><li class="listitem"><div class="para">
							view resource statistics
						</div></li><li class="listitem"><div class="para">
							view resource metric information
						</div></li></ul></div></li></ul></div><div class="para">
			The new <code class="literal">admin-console</code> provided with JBoss Enterprise Application Platform retains the JMX and web consoles. <code class="literal">admin-console</code> supports the <code class="literal">production</code>, <code class="literal">all</code>, <code class="literal">web</code> and <code class="literal">default</code> configurations out of the box. It has also been tested with <code class="literal">standard</code> server profile, but is not included in standard by default. To use <code class="literal">admin-console</code> in a <code class="literal">standard</code> profile, copy the <code class="filename">admin-console.war</code> from one of the supported server profiles.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				The Admin Console is not intended for use with the <code class="literal">minimal</code> configuration provided with the distribution. Custom configurations based on this configuration should not be used with the Admin Console, either.
			</div></div></div><div class="para">
			When the server has been started, you can use the <code class="literal">admin-console</code> to perform administrative tasks for your application server. To use the <code class="literal">admin-console</code>, navigate to <code class="literal">http://${hostname}:8080/admin-console</code>.
		</div><div class="para">
			Refer to the <em class="citetitle">Administration Console User Guide</em> for more information on the Admin Console.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migration.apps">
      ⁠</a>11.4. Applications</h1></div></div></div><div class="para">
			JBoss Enterprise Application Platform 5 is a fully-compliant implementation of the Java Enterprise Edition 5 (Java EE 5) Platform Specification. Java EE 5 defines the metadata associations of the Java language which can be used to annotate application code and eliminate the need for deployment descriptors wherever possible. Default behavior is also defined with the ability to override as needed. This is known as <span class="emphasis"><em>configuration by exception</em></span>.
		</div><div class="para">
			Portable Java EE applications running on Enterprise Application Platform 4.x can be deployed to Enterprise Application Platform 5 without any changes. However, runtime-specific deployment information may be required when migrating from another vendor's application server to JBoss Enterprise Application Platform 5.
		</div><div class="para">
			Enterprise Application Platform 5 users can take advantage of the simplified packaging and deployment rules defined in the Java EE 5 Platform Specification, such as no longer requiring an <code class="filename">application.xml</code> file in Enterprise Archives (EARs). Additionally, a default library directory (<code class="filename">lib</code>) in the root directory of an EAR makes the JARs available to all components packaged within the EAR. If an <code class="filename">application.xml</code> file is included, the <code class="literal">library-directory</code> element can be used to specify the location of the <code class="filename">lib</code> directory.
		</div><div class="para">
			Enterprise Application Platform 5 also introduces a new deployable unit: the <span class="emphasis"><em>MCBeans archive</em></span>, after JBoss Microcontainer, which typically takes the <code class="filename">.beans</code> or <code class="filename">.deployer</code> suffix. MCBeans archives package a POJO deployment in a JAR file with a <code class="filename">META-INF/jboss-beans.xml</code> descriptor. This format is common in Enterprise Application Platform deployers.
		</div><div class="para">
			Application verification for all file types is enabled by default, and can be configured in the <code class="filename">deployers/ear-deployer-jboss-beans.xml</code> file, specifically:
		</div><pre class="programlisting XML">&lt;!-- uncomment to disable xml validation
   &lt;property name="useValidation"&gt;false&lt;/property --&gt;
&lt;!-- in case xml validation is disabled, it's also better to turn off schema validation
   &lt;property name="useSchemaValidation"&gt;false&lt;/property --&gt;</pre><div class="para">
			Enterprise JavaBean 2.0 archive verification remains the same between Enterprise Application Platform 4.x and Enterprise Application Platform 5. However, the properties that control verification have been moved from <code class="filename">deploy/ejb-deployer.xml</code> to <code class="filename">deployers/ejb-deployer-jboss-beans.xml</code>.
		</div><div class="para">
			If an enterprise archive contains only an application client and refers to EJBs, you must also add the <code class="literal">&lt;/ignore-dependency&gt;</code> element to the <code class="literal">ejb-ref</code> or <code class="literal">ejb-local-ref</code> definitions in the <code class="filename">jboss-client.xml</code> deployment descriptor. This informs the deployer to deploy the archive without resolving the referenced dependencies.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration.app.loader">
      ⁠</a>11.4.1. Classloading</h2></div></div></div><div class="para">
				The new <code class="literal">ClassLoader</code> is fully backwards compatible, with one exception that does not affect common use ( <a href="http://www.jboss.org/community/docs/DOC-12840">http://www.jboss.org/community/docs/DOC-12840</a> ). All classloading configurations from EAP 4.x will still work with the new implementation, and most default settings retain the behavior of the previous version.
			</div><div class="para">
				The new <code class="literal">ClassLoader</code> shares many design and implementation details with the original <code class="literal">UnifiedClassLoader</code>, but makes the following improvements:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						the classloader no longer depends upon JMX, so it can be used in any environment as a standalone.
					</div></li><li class="listitem"><div class="para">
						it is much easier to implement your own classloader policy.
					</div></li><li class="listitem"><div class="para">
						increased control over which classloaders your classloader delegates to.
					</div></li><li class="listitem"><div class="para">
						increased control over which classes are visible to other classloaders.
					</div></li><li class="listitem"><div class="para">
						hierarchical repositories have been replaced by domains, and can now extend beyond a single level.
					</div></li></ul></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					<code class="literal">useJBossWebClassLoader="true"</code> is not used in JBoss Enterprise Application Platform 5. All WAR classloaders in Enterprise Application Platform 5 are JBoss <code class="literal">ClassLoader</code> s, so the <code class="literal">WarDeployer</code> no longer handles the configuration details for web applications.
				</div></div></div><div class="para">
				There are several methods available to change the classloading configuration of a WAR:
			</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Remove the <code class="classname">WarClassLoaderDeployer</code></span></dt><dd><div class="para">
							The <code class="literal">WarClassLoaderDeployer</code> automatically implements the defined classloading rules for WARs. Each WAR is assigned a scoped classloading domain. Its classes are not visible to other applications or to any parent EAR, and where possible the WAR's classes are called first. To remove this behavior and make WAR classloading behave like other deployers, comment out the <code class="literal">WarClassLoaderDeployer</code> in <code class="filename">deployers/jbossweb.deploy/META-INF/war-deployers-jboss-beans.xml</code>.
						</div></dd><dt><span class="term">Define classloading rules explicitly for the WAR</span></dt><dd><div class="para">
							Add a <code class="filename">WEB-INF/jboss-classloading.xml</code> with the following content to your WAR.
						</div><pre class="programlisting XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;classloading xmlns="urn:jboss:classloading:1.0"
   name="mywar.war"
   domain="DefaultDomain"
   export-all="NON_EMPTY"
   import-all="true"&gt;
&lt;/classloading&gt;</pre><div class="para">
							This lets you define how the WAR's classloader is constructed. In this case, the WAR's classloader has been placed in the <code class="literal">DefaultDomain</code>, which is shared with all other applications that do not define their own domain. <code class="varname">import-all</code> is enabled, which means the classloader will look at all other classes exported by other applications. <code class="varname">export-all</code> is set to expose all classes in our application to other classes.
						</div></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration.app.scoping">
      ⁠</a>11.4.2. EAR Scoping</h2></div></div></div><div class="para">
				You can control how class isolation between deployments behave with the <code class="varname">isolated</code> property in <code class="filename">deployers/ear-deployer-jboss-beans.xml</code>, as follows:
			</div><pre class="programlisting XML">&lt;!-- A flag indicating if ear deployments should have their own scoped
   class loader to isolate theirclasses from other deployments. --&gt;
   &lt;property name="isolated"&gt;false&lt;/property&gt;</pre></div></div></div></body></html>