<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 4. Persistent Classes</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="persistent-classes">
      ⁠</a>Chapter 4. Persistent Classes</h1></div></div></div><div class="para">
		Persistent classes are classes in an application that implement the entities of the business problem (e.g. Customer and Order in an E-commerce application). Not all instances of a persistent class are considered to be in the persistent state. For example, an instance can instead be transient or detached.
	</div><div class="para">
		Hibernate works best if these classes follow some simple rules, also known as the Plain Old Java Object (POJO) programming model. However, none of these rules are hard requirements. Indeed, Hibernate3 assumes very little about the nature of your persistent objects. You can express a domain model in other ways (using trees of <code class="literal">Map</code> instances, for example).
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="persistent-classes-pojo">
      ⁠</a>4.1. A simple POJO example</h1></div></div></div><div class="para">
			Most Java applications require a persistent class representing felines. For example:
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>package eg;
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import java.util.Set;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import java.util.Date;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> Cat {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">Long</span> id; <span xmlns="" class="perl_Comment">// identifier</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> Date birthdate;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> Color color;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">char</span> sex;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">float</span> weight;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">int</span> litterId;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> Cat mother;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> Set kittens = <span xmlns="" class="perl_Keyword">new</span> HashSet();
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">setId</span>(<span xmlns="" class="perl_DataType">Long</span> id) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">id</span>=id;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">Long</span> <span xmlns="" class="perl_Function">getId</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> id;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">setBirthdate</span>(Date date) {
<span xmlns="" class="line">​</span>        birthdate = date;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> Date <span xmlns="" class="perl_Function">getBirthdate</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> birthdate;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">setWeight</span>(<span xmlns="" class="perl_DataType">float</span> weight) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">weight</span> = weight;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">float</span> <span xmlns="" class="perl_Function">getWeight</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> weight;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> Color <span xmlns="" class="perl_Function">getColor</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> color;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">setColor</span>(Color color) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">color</span> = color;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">setSex</span>(<span xmlns="" class="perl_DataType">char</span> sex) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">sex</span>=sex;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">char</span> <span xmlns="" class="perl_Function">getSex</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> sex;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">setLitterId</span>(<span xmlns="" class="perl_DataType">int</span> id) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">litterId</span> = id;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">int</span> <span xmlns="" class="perl_Function">getLitterId</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> litterId;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">setMother</span>(Cat mother) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">mother</span> = mother;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> Cat <span xmlns="" class="perl_Function">getMother</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> mother;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">setKittens</span>(Set kittens) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">kittens</span> = kittens;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> Set <span xmlns="" class="perl_Function">getKittens</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> kittens;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">// addKitten not needed by Hibernate</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">addKitten</span>(Cat kitten) {
<span xmlns="" class="line">​</span>        kitten.<span xmlns="" class="perl_Function">setMother</span>(<span xmlns="" class="perl_Keyword">this</span>);
<span xmlns="" class="line">​</span>    kitten.<span xmlns="" class="perl_Function">setLitterId</span>( kittens.<span xmlns="" class="perl_Function">size</span>() ); 
<span xmlns="" class="line">​</span>        kittens.<span xmlns="" class="perl_Function">add</span>(kitten);
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}</pre><div class="para">
			The four main rules of persistent classes are explored in more detail in the following sections.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="persistent-classes-pojo-constructor">
      ⁠</a>4.1.1. Implement a no-argument constructor</h2></div></div></div><div class="para">
				<code class="literal">Cat</code> has a no-argument constructor. All persistent classes must have a default constructor (which can be non-public) so that Hibernate can instantiate them using <code class="literal">Constructor.newInstance()</code>. It is recommended that you have a default constructor with at least <span class="emphasis"><em>package</em></span> visibility for runtime proxy generation in Hibernate.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="persistent-classes-pojo-identifier">
      ⁠</a>4.1.2. Provide an identifier property (optional)</h2></div></div></div><div class="para">
				<code class="literal">Cat</code> has a property called <code class="literal">id</code>. This property maps to the primary key column of a database table. The property might have been called anything, and its type might have been any primitive type, any primitive "wrapper" type, <code class="literal">java.lang.String</code> or <code class="literal">java.util.Date</code>. If your legacy database table has composite keys, you can use a user-defined class with properties of these types (see the section on composite identifiers later in the chapter.)
			</div><div class="para">
				The identifier property is strictly optional. You can leave them off and let Hibernate keep track of object identifiers internally. We do not recommend this, however.
			</div><div class="para">
				In fact, some functionality is available only to classes that declare an identifier property:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						Transitive reattachment for detached objects (cascade update or cascade merge) - see <a class="xref" href="objectstate.html#objectstate-transitive">Section 10.11, “Transitive persistence”</a>
					</div></li><li class="listitem"><div class="para">
						<code class="literal">Session.saveOrUpdate()</code>
					</div></li><li class="listitem"><div class="para">
						<code class="literal">Session.merge()</code>
					</div></li></ul></div><div class="para">
				We recommend that you declare consistently-named identifier properties on persistent classes and that you use a nullable (i.e., non-primitive) type.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="persistent-classes-pojo-final">
      ⁠</a>4.1.3. Prefer non-final classes (optional)</h2></div></div></div><div class="para">
				A central feature of Hibernate, <span class="emphasis"><em>proxies</em></span>, depends upon the persistent class being either non-final, or the implementation of an interface that declares all public methods.
			</div><div class="para">
				You can persist <code class="literal">final</code> classes that do not implement an interface with Hibernate. You will not, however, be able to use proxies for lazy association fetching which will ultimately limit your options for performance tuning.
			</div><div class="para">
				You should also avoid declaring <code class="literal">public final</code> methods on the non-final classes. If you want to use a class with a <code class="literal">public final</code> method, you must explicitly disable proxying by setting <code class="literal">lazy="false"</code>.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="persistent-classes-pojo-accessors">
      ⁠</a>4.1.4. Declare accessors and mutators for persistent fields (optional)</h2></div></div></div><div class="para">
				<code class="literal">Cat</code> declares accessor methods for all its persistent fields. Many other ORM tools directly persist instance variables. It is better to provide an indirection between the relational schema and internal data structures of the class. By default, Hibernate persists JavaBeans style properties and recognizes method names of the form <code class="literal">getFoo</code>, <code class="literal">isFoo</code> and <code class="literal">setFoo</code>. If required, you can switch to direct field access for particular properties.
			</div><div class="para">
				Properties need <span class="emphasis"><em>not</em></span> be declared public - Hibernate can persist a property with a default, <code class="literal">protected</code> or <code class="literal">private</code> get / set pair.
			</div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="persistent-classes-inheritance">
      ⁠</a>4.2. Implementing inheritance</h1></div></div></div><div class="para">
			A subclass must also observe the first and second rules. It inherits its identifier property from the superclass, <code class="literal">Cat</code>. For example:
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>package eg;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> DomesticCat <span xmlns="" class="perl_Keyword">extends</span> Cat {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">private</span> String name;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">getName</span>() {
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">return</span> name;
<span xmlns="" class="line">​</span>        }
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">protected</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">setName</span>(String name) {
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">name</span>=name;
<span xmlns="" class="line">​</span>        }
<span xmlns="" class="line">​</span>}</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="persistent-classes-equalshashcode">
      ⁠</a>4.3. Implementing <code class="literal">equals()</code> and <code class="literal">hashCode()</code></h1></div></div></div><div class="para">
			You have to override the <code class="literal">equals()</code> and <code class="literal">hashCode()</code> methods if you:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					intend to put instances of persistent classes in a <code class="literal">Set</code> (the recommended way to represent many-valued associations); <span class="emphasis"><em>and</em></span>
				</div></li><li class="listitem"><div class="para">
					intend to use reattachment of detached instances
				</div></li></ul></div><div class="para">
			Hibernate guarantees equivalence of persistent identity (database row) and Java identity only inside a particular session scope. When you mix instances retrieved in different sessions, you must implement <code class="literal">equals()</code> and <code class="literal">hashCode()</code> if you wish to have meaningful semantics for <code class="literal">Set</code>s.
		</div><div class="para">
			The most obvious way is to implement <code class="literal">equals()</code>/<code class="literal">hashCode()</code> by comparing the identifier value of both objects. If the value is the same, both must be the same database row, because they are equal. If both are added to a <code class="literal">Set</code>, you will only have one element in the <code class="literal">Set</code>). Unfortunately, you cannot use that approach with generated identifiers. Hibernate will only assign identifier values to objects that are persistent; a newly created instance will not have any identifier value. Furthermore, if an instance is unsaved and currently in a <code class="literal">Set</code>, saving it will assign an identifier value to the object. If <code class="literal">equals()</code> and <code class="literal">hashCode()</code> are based on the identifier value, the hash code would change, breaking the contract of the <code class="literal">Set</code>. See the Hibernate website for a full discussion of this problem. This is not a Hibernate issue, but normal Java semantics of object identity and equality.
		</div><div class="para">
			It is recommended that you implement <code class="literal">equals()</code> and <code class="literal">hashCode()</code> using <span class="emphasis"><em>Business key equality</em></span>. Business key equality means that the <code class="literal">equals()</code> method compares only the properties that form the business key. It is a key that would identify our instance in the real world (a <span class="emphasis"><em>natural</em></span> candidate key):
		</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> Cat {
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    ...
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">boolean</span> <span xmlns="" class="perl_Function">equals</span>(Object other) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">if</span> (<span xmlns="" class="perl_Keyword">this</span> == other) <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_Keyword">true</span>;
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">if</span> ( !(other <span xmlns="" class="perl_Keyword">instanceof</span> Cat) ) <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_Keyword">false</span>;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_DataType">final</span> Cat cat = (Cat) other;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">if</span> ( !cat.<span xmlns="" class="perl_Function">getLitterId</span>().<span xmlns="" class="perl_Function">equals</span>( <span xmlns="" class="perl_Function">getLitterId</span>() ) ) <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_Keyword">false</span>;
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">if</span> ( !cat.<span xmlns="" class="perl_Function">getMother</span>().<span xmlns="" class="perl_Function">equals</span>( <span xmlns="" class="perl_Function">getMother</span>() ) ) <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_Keyword">false</span>;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_Keyword">true</span>;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">int</span> <span xmlns="" class="perl_Function">hashCode</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_DataType">int</span> result;
<span xmlns="" class="line">​</span>        result = <span xmlns="" class="perl_Function">getMother</span>().<span xmlns="" class="perl_Function">hashCode</span>();
<span xmlns="" class="line">​</span>        result = <span xmlns="" class="perl_Float">29</span> * result + <span xmlns="" class="perl_Function">getLitterId</span>();
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> result;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>}</pre><div class="para">
			A business key does not have to be as solid as a database primary key candidate (see <a class="xref" href="transactions.html#transactions-basics-identity">Section 11.1.3, “Considering object identity”</a>). Immutable or unique properties are usually good candidates for a business key.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="persistent-classes-dynamicmodels">
      ⁠</a>4.4. Dynamic models</h1></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				<span class="emphasis"><em>The following features are currently considered experimental and may change in the near future.</em></span>
			</div></div></div><div class="para">
			Persistent entities do not necessarily have to be represented as POJO classes or as JavaBean objects at runtime. Hibernate also supports dynamic models (using <code class="literal">Map</code>s of <code class="literal">Map</code>s at runtime) and the representation of entities as DOM4J trees. With this approach, you do not write persistent classes, only mapping files.
		</div><div class="para">
			By default, Hibernate works in normal POJO mode. You can set a default entity representation mode for a particular <code class="literal">SessionFactory</code> using the <code class="literal">default_entity_mode</code> configuration option (see <a class="xref" href="session-configuration.html#configuration-optional-properties">Table 3.3, “Hibernate Configuration Properties”</a>).
		</div><div class="para">
			The following examples demonstrate the representation using <code class="literal">Map</code>s. First, in the mapping file an <code class="literal">entity-name</code> has to be declared instead of, or in addition to, a class name:
		</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;hibernate-mapping&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;class</span><span xmlns="" class="perl_Others"> entity-name=</span><span xmlns="" class="perl_String">"Customer"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;id</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"id"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            type=</span><span xmlns="" class="perl_String">"long"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            column=</span><span xmlns="" class="perl_String">"ID"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;generator</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"sequence"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/id&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"name"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            column=</span><span xmlns="" class="perl_String">"NAME"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            type=</span><span xmlns="" class="perl_String">"string"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"address"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            column=</span><span xmlns="" class="perl_String">"ADDRESS"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            type=</span><span xmlns="" class="perl_String">"string"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;many-to-one</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"organization"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            column=</span><span xmlns="" class="perl_String">"ORGANIZATION_ID"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            class=</span><span xmlns="" class="perl_String">"Organization"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;bag</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"orders"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            inverse=</span><span xmlns="" class="perl_String">"true"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            lazy=</span><span xmlns="" class="perl_String">"false"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">            cascade=</span><span xmlns="" class="perl_String">"all"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;key</span><span xmlns="" class="perl_Others"> column=</span><span xmlns="" class="perl_String">"CUSTOMER_ID"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;one-to-many</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"Order"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/bag&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/class&gt;</span>
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/hibernate-mapping&gt;</span></pre><div class="para">
			Even though associations are declared using target class names, the target type of associations can also be a dynamic entity instead of a POJO.
		</div><div class="para">
			After setting the default entity mode to <code class="literal">dynamic-map</code> for the <code class="literal">SessionFactory</code>, you can, at runtime, work with <code class="literal">Map</code>s of <code class="literal">Map</code>s:
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>Session s = <span xmlns="" class="perl_Function">openSession</span>();
<span xmlns="" class="line">​</span>Transaction tx = s.<span xmlns="" class="perl_Function">beginTransaction</span>();
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">// Create a customer</span>
<span xmlns="" class="line">​</span>Map david = <span xmlns="" class="perl_Keyword">new</span> HashMap();
<span xmlns="" class="line">​</span>david.<span xmlns="" class="perl_Function">put</span>(<span xmlns="" class="perl_String">"name"</span>, <span xmlns="" class="perl_String">"David"</span>);
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">// Create an organization</span>
<span xmlns="" class="line">​</span>Map foobar = <span xmlns="" class="perl_Keyword">new</span> HashMap();
<span xmlns="" class="line">​</span>foobar.<span xmlns="" class="perl_Function">put</span>(<span xmlns="" class="perl_String">"name"</span>, <span xmlns="" class="perl_String">"Foobar Inc."</span>);
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">// Link both</span>
<span xmlns="" class="line">​</span>david.<span xmlns="" class="perl_Function">put</span>(<span xmlns="" class="perl_String">"organization"</span>, foobar);
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">// Save both</span>
<span xmlns="" class="line">​</span>s.<span xmlns="" class="perl_Function">save</span>(<span xmlns="" class="perl_String">"Customer"</span>, david);
<span xmlns="" class="line">​</span>s.<span xmlns="" class="perl_Function">save</span>(<span xmlns="" class="perl_String">"Organization"</span>, foobar);
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>tx.<span xmlns="" class="perl_Function">commit</span>();
<span xmlns="" class="line">​</span>s.<span xmlns="" class="perl_Function">close</span>();</pre><div class="para">
			One of the main advantages of dynamic mapping is quick turnaround time for prototyping, without the need for entity class implementation. However, you lose compile-time type checking and will likely deal with many exceptions at runtime. As a result of the Hibernate mapping, the database schema can easily be normalized and sound, allowing to add a proper domain model implementation on top later on.
		</div><div class="para">
			Entity representation modes can also be set on a per <code class="literal">Session</code> basis:
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>Session dynamicSession = pojoSession.<span xmlns="" class="perl_Function">getSession</span>(EntityMode.<span xmlns="" class="perl_Function">MAP</span>);
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">// Create a customer</span>
<span xmlns="" class="line">​</span>Map david = <span xmlns="" class="perl_Keyword">new</span> HashMap();
<span xmlns="" class="line">​</span>david.<span xmlns="" class="perl_Function">put</span>(<span xmlns="" class="perl_String">"name"</span>, <span xmlns="" class="perl_String">"David"</span>);
<span xmlns="" class="line">​</span>dynamicSession.<span xmlns="" class="perl_Function">save</span>(<span xmlns="" class="perl_String">"Customer"</span>, david);
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>dynamicSession.<span xmlns="" class="perl_Function">flush</span>();
<span xmlns="" class="line">​</span>dynamicSession.<span xmlns="" class="perl_Function">close</span>();
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">// Continue on pojoSession</span>
</pre><div class="para">
			Please note that the call to <code class="literal">getSession()</code> using an <code class="literal">EntityMode</code> is on the <code class="literal">Session</code> API, not the <code class="literal">SessionFactory</code>. That way, the new <code class="literal">Session</code> shares the underlying JDBC connection, transaction, and other context information. This means you do not have to call <code class="literal">flush()</code> and <code class="literal">close()</code> on the secondary <code class="literal">Session</code>, and also leave the transaction and connection handling to the primary unit of work.
		</div><div class="para">
			More information about the XML representation capabilities can be found in <a class="xref" href="xml.html">Chapter 18, <em>XML Mapping</em></a>.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="persistent-classes-tuplizers">
      ⁠</a>4.5. Tuplizers</h1></div></div></div><div class="para">
			<code class="literal">org.hibernate.tuple.Tuplizer</code>, and its sub-interfaces, are responsible for managing a particular representation of a piece of data given that representation's <code class="literal">org.hibernate.EntityMode</code>. If a given piece of data is thought of as a data structure, then a tuplizer is the thing that knows how to create such a data structure and how to extract values from and inject values into such a data structure. For example, for the POJO entity mode, the corresponding tuplizer knows how create the POJO through its constructor. It also knows how to access the POJO properties using the defined property accessors.
		</div><div class="para">
			There are two high-level types of Tuplizers, represented by the <code class="literal">org.hibernate.tuple.entity.EntityTuplizer</code> and <code class="literal">org.hibernate.tuple.component.ComponentTuplizer</code> interfaces. <code class="literal">EntityTuplizer</code>s are responsible for managing the above mentioned contracts in regards to entities, while <code class="literal">ComponentTuplizer</code>s do the same for components.
		</div><div class="para">
			Users can also plug in their own tuplizers. Perhaps you require that a <code class="literal">java.util.Map</code> implementation other than <code class="literal">java.util.HashMap</code> be used while in the dynamic-map entity-mode. Or perhaps you need to define a different proxy generation strategy than the one used by default. Both would be achieved by defining a custom tuplizer implementation. Tuplizer definitions are attached to the entity or component mapping they are meant to manage. Going back to the example of our customer entity:
		</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;hibernate-mapping&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;class</span><span xmlns="" class="perl_Others"> entity-name=</span><span xmlns="" class="perl_String">"Customer"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">&lt;!--</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">            Override the dynamic-map entity-mode</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">            tuplizer for the customer entity</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">        --&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;tuplizer</span><span xmlns="" class="perl_Others"> entity-mode=</span><span xmlns="" class="perl_String">"dynamic-map"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">                class=</span><span xmlns="" class="perl_String">"CustomMapTuplizerImpl"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;id</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"id"</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"long"</span><span xmlns="" class="perl_Others"> column=</span><span xmlns="" class="perl_String">"ID"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;generator</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"sequence"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/id&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">&lt;!-- other properties --&gt;</span>
<span xmlns="" class="line">​</span>        ...
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/class&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/hibernate-mapping&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>public class CustomMapTuplizerImpl
<span xmlns="" class="line">​</span>        extends org.hibernate.tuple.entity.DynamicMapEntityTuplizer {
<span xmlns="" class="line">​</span>    // override the buildInstantiator() method to plug in our custom map...
<span xmlns="" class="line">​</span>    protected final Instantiator buildInstantiator(
<span xmlns="" class="line">​</span>            org.hibernate.mapping.PersistentClass mappingInfo) {
<span xmlns="" class="line">​</span>        return new CustomMapInstantiator( mappingInfo );
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    private static final class CustomMapInstantiator
<span xmlns="" class="line">​</span>            extends org.hibernate.tuple.DynamicMapInstantitor {
<span xmlns="" class="line">​</span>        // override the generateMap() method to return our custom map...
<span xmlns="" class="line">​</span>        protected final Map generateMap() {
<span xmlns="" class="line">​</span>            return new CustomMap();
<span xmlns="" class="line">​</span>        }
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="persistent-classes-entity-name-resolver">
      ⁠</a>4.6. EntityNameResolvers</h1></div></div></div><div class="para">
			The <code class="interfacename">org.hibernate.EntityNameResolver</code> interface is a contract for resolving the entity name of a given entity instance. The interface defines a single method <code class="methodname">resolveEntityName</code> which is passed the entity instance and is expected to return the appropriate entity name (null is allowed and would indicate that the resolver does not know how to resolve the entity name of the given entity instance). Generally speaking, an <code class="interfacename">org.hibernate.EntityNameResolver</code> is going to be most useful in the case of dynamic models. One example might be using proxied interfaces as your domain model. The hibernate test suite has an example of this exact style of usage under the <span class="package">org.hibernate.test.dynamicentity.tuplizer2</span>. Here is some of the code from that package for illustration.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * A very trivial JDK Proxy InvocationHandler implementation where we proxy an interface as</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * the domain model and simply store persistent state in an internal Map.  This is an extremely</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * trivial example meant only for illustration.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">final</span> <span xmlns="" class="perl_Keyword">class</span> DataProxyHandler <span xmlns="" class="perl_Keyword">implements</span> InvocationHandler {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> String entityName;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> HashMap data = <span xmlns="" class="perl_Keyword">new</span> HashMap();
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Function">DataProxyHandler</span>(String entityName, Serializable id) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">entityName</span> = entityName;
<span xmlns="" class="line">​</span>        data.<span xmlns="" class="perl_Function">put</span>( <span xmlns="" class="perl_String">"Id"</span>, id );
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> Object <span xmlns="" class="perl_Function">invoke</span>(Object proxy, Method method, Object[] args) <span xmlns="" class="perl_Keyword">throws</span> Throwable {
<span xmlns="" class="line">​</span>        String methodName = method.<span xmlns="" class="perl_Function">getName</span>();
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">if</span> ( methodName.<span xmlns="" class="perl_Function">startsWith</span>( <span xmlns="" class="perl_String">"set"</span> ) ) {
<span xmlns="" class="line">​</span>            String propertyName = methodName.<span xmlns="" class="perl_Function">substring</span>( <span xmlns="" class="perl_Float">3</span> );
<span xmlns="" class="line">​</span>            data.<span xmlns="" class="perl_Function">put</span>( propertyName, args[<span xmlns="" class="perl_Float">0</span>] );
<span xmlns="" class="line">​</span>        }
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">else</span> <span xmlns="" class="perl_Keyword">if</span> ( methodName.<span xmlns="" class="perl_Function">startsWith</span>( <span xmlns="" class="perl_String">"get"</span> ) ) {
<span xmlns="" class="line">​</span>            String propertyName = methodName.<span xmlns="" class="perl_Function">substring</span>( <span xmlns="" class="perl_Float">3</span> );
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">return</span> data.<span xmlns="" class="perl_Function">get</span>( propertyName );
<span xmlns="" class="line">​</span>        }
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">else</span> <span xmlns="" class="perl_Keyword">if</span> ( <span xmlns="" class="perl_String">"toString"</span>.<span xmlns="" class="perl_Function">equals</span>( methodName ) ) {
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">return</span> entityName + <span xmlns="" class="perl_String">"#"</span> + data.<span xmlns="" class="perl_Function">get</span>( <span xmlns="" class="perl_String">"Id"</span> );
<span xmlns="" class="line">​</span>        }
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">else</span> <span xmlns="" class="perl_Keyword">if</span> ( <span xmlns="" class="perl_String">"hashCode"</span>.<span xmlns="" class="perl_Function">equals</span>( methodName ) ) {
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_Keyword">new</span> Integer( <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">hashCode</span>() );
<span xmlns="" class="line">​</span>        }
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_Keyword">null</span>;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">getEntityName</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> entityName;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> HashMap <span xmlns="" class="perl_Function">getData</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> data;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> *</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> ProxyHelper {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">static</span> String <span xmlns="" class="perl_Function">extractEntityName</span>(Object object) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">// Our custom java.lang.reflect.Proxy instances actually bundle</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">// their appropriate entity name, so we simply extract it from there</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">// if this represents one of our proxies; otherwise, we return null</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">if</span> ( Proxy.<span xmlns="" class="perl_Function">isProxyClass</span>( object.<span xmlns="" class="perl_Function">getClass</span>() ) ) {
<span xmlns="" class="line">​</span>            InvocationHandler handler = Proxy.<span xmlns="" class="perl_Function">getInvocationHandler</span>( object );
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">if</span> ( DataProxyHandler.<span xmlns="" class="perl_Function">class</span>.<span xmlns="" class="perl_Function">isAssignableFrom</span>( handler.<span xmlns="" class="perl_Function">getClass</span>() ) ) {
<span xmlns="" class="line">​</span>                DataProxyHandler myHandler = ( DataProxyHandler ) handler;
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">return</span> myHandler.<span xmlns="" class="perl_Function">getEntityName</span>();
<span xmlns="" class="line">​</span>            }
<span xmlns="" class="line">​</span>        }
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_Keyword">null</span>;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">// various other utility methods ....</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * The EntityNameResolver implementation.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * IMPL NOTE : An EntityNameResolver really defines a strategy for how entity names should be</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * resolved.  Since this particular impl can handle resolution for all of our entities we want to</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * take advantage of the fact that SessionFactoryImpl keeps these in a Set so that we only ever</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * have one instance registered.  Why?  Well, when it comes time to resolve an entity name,</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * Hibernate must iterate over all the registered resolvers.  So keeping that number down</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * helps that process be as speedy as possible.  Hence the equals and hashCode impls</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> MyEntityNameResolver <span xmlns="" class="perl_Keyword">implements</span> EntityNameResolver {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">static</span> <span xmlns="" class="perl_DataType">final</span> MyEntityNameResolver INSTANCE = <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">MyEntityNameResolver</span>();
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">resolveEntityName</span>(Object entity) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> ProxyHelper.<span xmlns="" class="perl_Function">extractEntityName</span>( entity );
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">boolean</span> <span xmlns="" class="perl_Function">equals</span>(Object obj) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_Function">getClass</span>().<span xmlns="" class="perl_Function">equals</span>( obj.<span xmlns="" class="perl_Function">getClass</span>() );
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">int</span> <span xmlns="" class="perl_Function">hashCode</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_Function">getClass</span>().<span xmlns="" class="perl_Function">hashCode</span>();
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> MyEntityTuplizer <span xmlns="" class="perl_Keyword">extends</span> PojoEntityTuplizer {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Function">MyEntityTuplizer</span>(EntityMetamodel entityMetamodel, PersistentClass mappedEntity) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">super</span>( entityMetamodel, mappedEntity );
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> EntityNameResolver[] <span xmlns="" class="perl_Function">getEntityNameResolvers</span>() {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_Keyword">new</span> EntityNameResolver[] { MyEntityNameResolver.<span xmlns="" class="perl_Function">INSTANCE</span> };
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">determineConcreteSubclassEntityName</span>(Object entityInstance, SessionFactoryImplementor factory) {
<span xmlns="" class="line">​</span>        String entityName = ProxyHelper.<span xmlns="" class="perl_Function">extractEntityName</span>( entityInstance );
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">if</span> ( entityName == <span xmlns="" class="perl_Keyword">null</span> ) {
<span xmlns="" class="line">​</span>            entityName = <span xmlns="" class="perl_Keyword">super</span>.<span xmlns="" class="perl_Function">determineConcreteSubclassEntityName</span>( entityInstance, factory );
<span xmlns="" class="line">​</span>        }
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> entityName;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    ...
<span xmlns="" class="line">​</span>}
</pre><div class="para">
			In order to register an <code class="interfacename">org.hibernate.EntityNameResolver</code> users must either: 
			<div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
						Implement a custom <a class="xref" href="persistent-classes.html#persistent-classes-tuplizers">Section 4.5, “Tuplizers”</a>, implementing the <code class="methodname">getEntityNameResolvers</code> method.
					</div></li><li class="listitem"><div class="para">
						Register it with the <code class="classname">org.hibernate.impl.SessionFactoryImpl</code> (which is the implementation class for <code class="interfacename">org.hibernate.SessionFactory</code>) using the <code class="methodname">registerEntityNameResolver</code> method.
					</div></li></ol></div>

		</div></div></div></body></html>