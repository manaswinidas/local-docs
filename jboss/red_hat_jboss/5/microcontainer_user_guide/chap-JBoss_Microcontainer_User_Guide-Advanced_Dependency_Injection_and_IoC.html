<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 7. Advanced Dependency Injection and IoC</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC">
      ⁠</a>Chapter 7. Advanced Dependency Injection and IoC</h1></div></div></div><div class="para">
		Today, <em class="firstterm">Dependency injection (DI)</em>, also called <em class="firstterm">Inversion of Control (IoC)</em>, lies at the core of many frameworks that embrace the notion of a container or a component model. Component models were discussed in a previous chapter. JBoss JMX kernel, the precursor to the Microcontainer, provided only lightweight DI/IoC support, primarily due to the limitations of accessing MBeans through the MBeans server. However with the new POJO-based component model, several new and interesting features are available.
	</div><div class="para">
		This chapter shows how you can apply different DI concepts with the help of the JBoss Microcontainer. These concepts will be expressed via XML code, but you can also apply most of these features using annotations.
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-Value_Factory">
      ⁠</a>7.1. Value Factory</h1></div></div></div><div class="para">
			A value factory is a bean which has one or more methods devoted to generating values for you. See <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-value-factory">Example 7.1, “Value Factory”</a>.
		</div><div class="example"><a id="example-value-factory">
      ⁠</a><p class="title"><strong>Example 7.1. Value Factory</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Binding"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.vf.PortBindingManager"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;constructor&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;parameter&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;map</span><span xmlns="" class="perl_Others"> keyClass=</span><span xmlns="" class="perl_String">"java.lang.String"</span><span xmlns="" class="perl_Others"> valueClass=</span><span xmlns="" class="perl_String">"java.lang.Integer"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">&lt;entry&gt;</span>
<span xmlns="" class="line">​</span>	  <span xmlns="" class="perl_Keyword">&lt;key&gt;</span>http<span xmlns="" class="perl_Keyword">&lt;/key&gt;</span>
<span xmlns="" class="line">​</span>	  <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>80<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span>
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">&lt;/entry&gt;</span>
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">&lt;entry&gt;</span>
<span xmlns="" class="line">​</span>	  <span xmlns="" class="perl_Keyword">&lt;key&gt;</span>ssh<span xmlns="" class="perl_Keyword">&lt;/key&gt;</span>
<span xmlns="" class="line">​</span>	  <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>22<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span>
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">&lt;/entry&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/map&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/constructor&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"PortsConfig"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.vf.PortsConfig"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"http"</span><span xmlns="" class="perl_Keyword">&gt;&lt;value-factory</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"Binding"</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"getPort"</span><span xmlns="" class="perl_Others"> parameter=</span><span xmlns="" class="perl_String">"http"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/property&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ssh"</span><span xmlns="" class="perl_Keyword">&gt;&lt;value-factory</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"Binding"</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"getPort"</span><span xmlns="" class="perl_Others"> parameter=</span><span xmlns="" class="perl_String">"ssh"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/property&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ftp"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;value-factory</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"Binding"</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"getPort"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;parameter&gt;</span>ftp<span xmlns="" class="perl_Keyword">&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;parameter&gt;</span>21<span xmlns="" class="perl_Keyword">&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/value-factory&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"mail"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;value-factory</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"Binding"</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"getPort"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;parameter&gt;</span>mail<span xmlns="" class="perl_Keyword">&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;parameter&gt;</span>25<span xmlns="" class="perl_Keyword">&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/value-factory&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div><div class="para">
			<a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-PortsConfig">Example 7.2, “PortsConfig”</a> shows how the PortsConfig bean uses Binding bean to get its values via the <code class="methodname">getPort</code> method invocation.
		</div><div class="example"><a id="example-PortsConfig">
      ⁠</a><p class="title"><strong>Example 7.2. PortsConfig</strong></p><div class="example-contents"><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> PortBindingManager {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> Map&lt;String, Integer&gt; bindings;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Function">PortBindingManager</span>(Map&lt;String, Integer&gt; bindings)
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">bindings</span> = bindings;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> Integer <span xmlns="" class="perl_Function">getPort</span>(String key)
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_Function">getPort</span>(key, <span xmlns="" class="perl_Keyword">null</span>);
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> Integer <span xmlns="" class="perl_Function">getPort</span>(String key, Integer defaultValue)
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">if</span> (bindings == <span xmlns="" class="perl_Keyword">null</span>)
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">return</span> defaultValue;
<span xmlns="" class="line">​</span>	Integer value = bindings.<span xmlns="" class="perl_Function">get</span>(key);
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">if</span> (value != <span xmlns="" class="perl_Keyword">null</span>)
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">return</span> value;
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">if</span> (defaultValue != <span xmlns="" class="perl_Keyword">null</span>)
<span xmlns="" class="line">​</span>	    bindings.<span xmlns="" class="perl_Function">put</span>(key, defaultValue);
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">return</span> defaultValue;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-Callbacks">
      ⁠</a>7.2. Callbacks</h1></div></div></div><div class="para">
			The descriptor shown in <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-callbacks">Example 7.3, “Callbacks to Collect and Filter Beans”</a> allows you to collect all beans of a certain type, and even limit the number of matching beans.
		</div><div class="para">
			In conjunction with the descriptor in <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-callbacks">Example 7.3, “Callbacks to Collect and Filter Beans”</a>, the Java code shown in <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-editor_parser">Example 7.4, “A Parser to Collect all Editors”</a> shows a <code class="interfacename">Parser</code> which collects all <code class="interfacename">Editor</code>s.
		</div><div class="example"><a id="example-callbacks">
      ⁠</a><p class="title"><strong>Example 7.3. Callbacks to Collect and Filter Beans</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"checker"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.callback.Checker"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;constructor&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;parameter&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;value-factory</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"parser"</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"parse"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">&lt;parameter&gt;</span>
<span xmlns="" class="line">​</span>	  <span xmlns="" class="perl_Keyword">&lt;array</span><span xmlns="" class="perl_Others"> elementClass=</span><span xmlns="" class="perl_String">"java.lang.Object"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>http://www.jboss.org<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span>
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>SI<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span>
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>3.14<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span>
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>42<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span>
<span xmlns="" class="line">​</span>	  <span xmlns="" class="perl_Keyword">&lt;/array&gt;</span>
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/value-factory&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/constructor&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"editorA"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.callback.DoubleEditor"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"editorB"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.callback.LocaleEditor"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"parser"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.callback.Parser"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;incallback</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"addEditor"</span><span xmlns="" class="perl_Others"> cardinality=</span><span xmlns="" class="perl_String">"4..n"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;uncallback</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"removeEditor"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"editorC"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.callback.LongEditor"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"editorD"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.callback.URLEditor"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div><div class="example"><a id="example-editor_parser">
      ⁠</a><p class="title"><strong>Example 7.4. A Parser to Collect all Editors</strong></p><div class="example-contents"><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> Parser {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> Set&lt;Editor&gt; editors = <span xmlns="" class="perl_Keyword">new</span> HashSet&lt;Editor&gt;();
<span xmlns="" class="line">​</span>    ...
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">addEditor</span>(Editor editor)
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>	editors.<span xmlns="" class="perl_Function">add</span>(editor);
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">removeEditor</span>(Editor editor)
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>	editors.<span xmlns="" class="perl_Function">remove</span>(editor);
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div><div class="para">
			Notice that <code class="classname">incallback</code> and <code class="classname">uncallback</code> use the method name for matching.
		</div><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;incallback</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"addEditor"</span><span xmlns="" class="perl_Others"> cardinality=</span><span xmlns="" class="perl_String">"4..n"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;uncallback</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"removeEditor"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>		
<span xmlns="" class="line">​</span>		
<span xmlns="" class="line">​</span>		
<span xmlns="" class="line">​</span>
</pre><div class="para">
			A bottom limit controls how many editors actually cause the bean to progress from a Configured state: <code class="code">cardinality=4..n/&gt;</code>
		</div><div class="para">
			Eventually, <code class="interfacename">Checker</code> gets created and checks the parser. This is illustrated in <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-parser-checker">Example 7.5, “The Checker for the Parser”</a>.
		</div><div class="example"><a id="example-parser-checker">
      ⁠</a><p class="title"><strong>Example 7.5. The Checker for the Parser</strong></p><div class="example-contents"><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">create</span>() <span xmlns="" class="perl_Keyword">throws</span> Throwable {
<span xmlns="" class="line">​</span>    Set&lt;String&gt; strings = <span xmlns="" class="perl_Keyword">new</span> TreeSet&lt;String&gt;(String.<span xmlns="" class="perl_Function">CASE_INSENSITIVE_ORDER</span>);
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">for</span> (Object element : elements)
<span xmlns="" class="line">​</span>	strings.<span xmlns="" class="perl_Function">add</span>(element.<span xmlns="" class="perl_Function">toString</span>());
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">if</span> (expected.<span xmlns="" class="perl_Function">equals</span>(strings) == <span xmlns="" class="perl_Keyword">false</span>)
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">throw</span> <span xmlns="" class="perl_Keyword">new</span> IllegalArgumentException(<span xmlns="" class="perl_String">"Illegal expected set: "</span> + expected + <span xmlns="" class="perl_String">"!="</span> + strings);
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-Bean_Access_Mode">
      ⁠</a>7.3. Bean Access Mode</h1></div></div></div><div class="para">
			With the default BeanAccessMode, a bean's fields are not inspected. However, if you specify a different BeanAccessMode, the fields are accessible as part of the bean's properties. See <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-BeanAccessModes">Example 7.6, “Possible BeanAccessMode Definitions”</a>, <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-Setting-BeanAccessMode">Example 7.7, “Setting the BeanAccessMode”</a>, and <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-FieldsBean_Class">Example 7.8, “The <code class="classname">FieldsBean</code> Class”</a> for an implementation.
		</div><div class="example"><a id="example-BeanAccessModes">
      ⁠</a><p class="title"><strong>Example 7.6. Possible BeanAccessMode Definitions</strong></p><div class="example-contents"><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">enum</span> BeanAccessMode {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Function">STANDARD</span>(BeanInfoCreator.<span xmlns="" class="perl_Function">STANDARD</span>), <span xmlns="" class="perl_Comment">// Getters and Setters</span>
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Function">FIELDS</span>(BeanInfoCreator.<span xmlns="" class="perl_Function">FIELDS</span>), <span xmlns="" class="perl_Comment">// Getters/Setters and fields without getters and setters</span>
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Function">ALL</span>(BeanInfoCreator.<span xmlns="" class="perl_Function">ALL</span>); <span xmlns="" class="perl_Comment">// As above but with non public fields included</span>
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div><div class="para">
			Here, a String value is set to a private String field:
		</div><div class="example"><a id="example-Setting-BeanAccessMode">
      ⁠</a><p class="title"><strong>Example 7.7. Setting the BeanAccessMode</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"FieldsBean"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.access.FieldsBean"</span><span xmlns="" class="perl_Others"> access-mode=</span><span xmlns="" class="perl_String">"ALL"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"string"</span><span xmlns="" class="perl_Keyword">&gt;</span>InternalString<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div><div class="example"><a id="example-FieldsBean_Class">
      ⁠</a><p class="title"><strong>Example 7.8. The <code class="classname">FieldsBean</code> Class</strong></p><div class="example-contents"><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> FieldsBean {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> String string;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">start</span>()
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">if</span> (string == <span xmlns="" class="perl_Keyword">null</span>)
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">throw</span> <span xmlns="" class="perl_Keyword">new</span> IllegalArgumentException(<span xmlns="" class="perl_String">"Strings should be set!"</span>);
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-Bean_Alias">
      ⁠</a>7.4. Bean Alias</h1></div></div></div><div class="para">
			Each bean can have any number of aliases. Since Microcontainer component names are treated as Objects, the alias type is not limited. By default a system property replacement is not done; you need to set the replace flag explicitly, as shown in <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-simple-bean-alias">Example 7.9, “A Simple Bean Alias”</a>.
		</div><div class="example"><a id="example-simple-bean-alias">
      ⁠</a><p class="title"><strong>Example 7.9. A Simple Bean Alias</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"SimpleName"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"java.lang.Object"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;alias&gt;</span>SimpleAlias<span xmlns="" class="perl_Keyword">&lt;/alias&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;alias</span><span xmlns="" class="perl_Others"> replace=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">&gt;</span>${some.system.property}<span xmlns="" class="perl_Keyword">&lt;/alias&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;alias</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"java.lang.Integer"</span><span xmlns="" class="perl_Keyword">&gt;</span>12345<span xmlns="" class="perl_Keyword">&lt;/alias&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;alias&gt;&lt;javabean</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:javabean:2.0"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.bootstrap.Main"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/alias&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-XML_or_MetaData_annotations_support">
      ⁠</a>7.5. XML (or MetaData) Annotations Support</h1></div></div></div><div class="para">
			AOP support is a prime feature in JBoss Microcontainer. You can use AOP aspects and plain beans in any combination. <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-Intercepting-Method-based-on-Annotation">Example 7.10, “Intercepting a Method based on Annotation”</a> attempts to intercept a method invocation based on an annotation. The annotation can come from anywhere. It might be a true class annotation or an annotation added through the xml configuration.
		</div><div class="example"><a id="example-Intercepting-Method-based-on-Annotation">
      ⁠</a><p class="title"><strong>Example 7.10. Intercepting a Method based on Annotation</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;interceptor</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:aop-beans:1.0"</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"StopWatchInterceptor"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.annotations.StopWatchInterceptor"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bind</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:aop-beans:1.0"</span><span xmlns="" class="perl_Others"> pointcut=</span><span xmlns="" class="perl_String">"execution(* @org.jboss.demos.ioc.annotations.StopWatchLog-&gt;*(..)) OR execution(* *-&gt;@org.jboss.demos.ioc.annotations.StopWatchLog(..))"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;interceptor-ref</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"StopWatchInterceptor"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bind&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Error">&lt;</span>/interceptor&gt;
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> StopWatchInterceptor <span xmlns="" class="perl_Keyword">implements</span> Interceptor {
<span xmlns="" class="line">​</span>    ...
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">public</span> Object <span xmlns="" class="perl_Function">invoke</span>(Invocation invocation) <span xmlns="" class="perl_Keyword">throws</span> Throwable
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>	Object target = invocation.<span xmlns="" class="perl_Function">getTargetObject</span>();
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_DataType">long</span> time = System.<span xmlns="" class="perl_Function">currentTimeMillis</span>();
<span xmlns="" class="line">​</span>	log.<span xmlns="" class="perl_Function">info</span>(<span xmlns="" class="perl_String">"Invocation ["</span> + target + <span xmlns="" class="perl_String">"] start: "</span> + time);
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">try</span>
<span xmlns="" class="line">​</span>	    {
<span xmlns="" class="line">​</span>		<span xmlns="" class="perl_Keyword">return</span> invocation.<span xmlns="" class="perl_Function">invokeNext</span>();
<span xmlns="" class="line">​</span>	    }
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">finally</span>
<span xmlns="" class="line">​</span>	    {
<span xmlns="" class="line">​</span>		log.<span xmlns="" class="perl_Function">info</span>(<span xmlns="" class="perl_String">"Invocation ["</span> + target + <span xmlns="" class="perl_String">"] time: "</span> + (System.<span xmlns="" class="perl_Function">currentTimeMillis</span>() - time));
<span xmlns="" class="line">​</span>	    }
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}    
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div><div class="para">
			<a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#exam-JBoss_Microcontainer_User_Guide-XML_or_MetaData_annotations_support-A_true_class_annotated_executor">Example 7.11, “A true class annotated executor”</a> and <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#exam-JBoss_Microcontainer_User_Guide-XML_or_MetaData_annotations_support-Simple_executor_with_XML_annotation">Example 7.12, “Simple executor with XML annotation”</a> show some different ways to implement executors.
		</div><div class="example"><a id="exam-JBoss_Microcontainer_User_Guide-XML_or_MetaData_annotations_support-A_true_class_annotated_executor">
      ⁠</a><p class="title"><strong>Example 7.11. A true class annotated executor</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"AnnotatedExecutor"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.annotations.AnnotatedExecutor"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> AnnotatedExecutor <span xmlns="" class="perl_Keyword">implements</span> Executor {
<span xmlns="" class="line">​</span>    ...
<span xmlns="" class="line">​</span>	@StopWatchLog <span xmlns="" class="perl_Comment">// &lt;-- Pointcut match!</span>
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">execute</span>() <span xmlns="" class="perl_Keyword">throws</span> Exception {
<span xmlns="" class="line">​</span>	delegate.<span xmlns="" class="perl_Function">execute</span>();
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div><div class="example"><a id="exam-JBoss_Microcontainer_User_Guide-XML_or_MetaData_annotations_support-Simple_executor_with_XML_annotation">
      ⁠</a><p class="title"><strong>Example 7.12. Simple executor with XML annotation</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"SimpleExecutor"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.annotations.SimpleExecutor"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;annotation&gt;</span>@org.jboss.demos.ioc.annotations.StopWatchLog<span xmlns="" class="perl_Keyword">&lt;/annotation&gt;</span> // <span xmlns="" class="perl_Error">&lt;</span>-- Pointcut match!
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> SimpleExecutor <span xmlns="" class="perl_Keyword">implements</span> Executor {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">static</span> Random random = <span xmlns="" class="perl_Keyword">new</span> Random();
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">execute</span>() <span xmlns="" class="perl_Keyword">throws</span> Exception
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>	Thread.<span xmlns="" class="perl_Function">sleep</span>(Math.<span xmlns="" class="perl_Function">abs</span>(random.<span xmlns="" class="perl_Function">nextLong</span>() % <span xmlns="" class="perl_Float">101</span>));
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div><div class="para">
			After adding executor invoker beans, you can see the executors in action during employment, by looking for log output such as <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-executor-output">Example 7.13, “Executor Logging Output”</a>.
		</div><div class="example"><a id="example-executor-output">
      ⁠</a><p class="title"><strong>Example 7.13. Executor Logging Output</strong></p><div class="example-contents"><pre class="screen">
		  JBoss-MC-Demo  INFO [15-12-2008 13:57:39] StopWatch - Invocation [org.jboss.demos.ioc.annotations.AnnotatedExecutor@4d28c7] start: 1229345859234
		  JBoss-MC-Demo  INFO [15-12-2008 13:57:39] StopWatch - Invocation [org.jboss.demos.ioc.annotations.AnnotatedExecutor@4d28c7] time: 31
		  JBoss-MC-Demo  INFO [15-12-2008 13:57:39] StopWatch - Invocation [org.jboss.demos.ioc.annotations.SimpleExecutor@1b044df] start: 1229345859265
		  JBoss-MC-Demo  INFO [15-12-2008 13:57:39] StopWatch - Invocation [org.jboss.demos.ioc.annotations.SimpleExecutor@1b044df] time: 47
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-Autowire">
      ⁠</a>7.6. Autowire</h1></div></div></div><div class="para">
			Autowiring, or contextual injection, is a common feature with IoC frameworks. <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-include-exclude-autowire">Example 7.14, “Include and Exclude with Autowiring”</a> shows you how to use or exclude beans with autowiring.
		</div><div class="example"><a id="example-include-exclude-autowire">
      ⁠</a><p class="title"><strong>Example 7.14. Include and Exclude with Autowiring</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Square"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.autowire.Square"</span><span xmlns="" class="perl_Others"> autowire-candidate=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Circle"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.autowire.Circle"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ShapeUser"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.autowire.ShapeUser"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;constructor&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;inject/&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/constructor&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ShapeHolder"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.autowire.ShapeHolder"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;incallback</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"addShape"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;uncallback</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"removeShape"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ShapeChecker"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.autowire.ShapesChecker"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre></div></div><div class="para">
			In both cases - <span class="package">ShapeUser</span> and <span class="package">ShapeChecker</span> - only <span class="package">Circle</span> should be used, since <span class="package">Square</span> is excluded in the contextual binding.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-Bean_Factory">
      ⁠</a>7.7. Bean Factory</h1></div></div></div><div class="para">
			When you want more than one instance of a particular bean, you need to use the bean factory pattern. The job of the Microcontainer is to configure and install the bean factory as if it were a plain bean. Then you need to invoke the bean factory's <code class="methodname">createBean</code> method.
		</div><div class="para">
			By default, the Microcontainer creates a <code class="classname">GenericBeanFactory</code> instance, but you can configure your own factory. The only limitation is that its signature and configuration hooks are similar to the one of <code class="classname">AbstractBeanFactory</code>.
		</div><div class="example"><a id="idm139732987015840">
      ⁠</a><p class="title"><strong>Example 7.15. Generic Bean Factory</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Object"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"java.lang.Object"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;beanfactory</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DefaultPrototype"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.factory.Prototype"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"value"</span><span xmlns="" class="perl_Keyword">&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"Object"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/beanfactory&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;beanfactory</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"EnhancedPrototype"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.factory.Prototype"</span><span xmlns="" class="perl_Others"> factoryClass=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.factory.EnhancedBeanFactory"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"value"</span><span xmlns="" class="perl_Keyword">&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"Object"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/beanfactory&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;beanfactory</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ProxiedPrototype"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.factory.UnmodifiablePrototype"</span><span xmlns="" class="perl_Others"> factoryClass=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.factory.EnhancedBeanFactory"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"value"</span><span xmlns="" class="perl_Keyword">&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"Object"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/beanfactory&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"PrototypeCreator"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.factory.PrototypeCreator"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"default"</span><span xmlns="" class="perl_Keyword">&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"DefaultPrototype"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/property&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"enhanced"</span><span xmlns="" class="perl_Keyword">&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"EnhancedPrototype"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/property&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"proxied"</span><span xmlns="" class="perl_Keyword">&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"ProxiedPrototype"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div><div class="para">
			See <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-extended-BeanFactory">Example 7.16, “Extended BeanFactory”</a> for usage of an extended BeanFactory.
		</div><div class="example"><a id="example-extended-BeanFactory">
      ⁠</a><p class="title"><strong>Example 7.16. Extended BeanFactory</strong></p><div class="example-contents"><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> EnhancedBeanFactory <span xmlns="" class="perl_Keyword">extends</span> GenericBeanFactory {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Function">EnhancedBeanFactory</span>(KernelConfigurator configurator)
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">super</span>(configurator);
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> Object <span xmlns="" class="perl_Function">createBean</span>() <span xmlns="" class="perl_Keyword">throws</span> Throwable
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>	Object bean = <span xmlns="" class="perl_Keyword">super</span>.<span xmlns="" class="perl_Function">createBean</span>();
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">Class</span> clazz = bean.<span xmlns="" class="perl_Function">getClass</span>();
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">if</span> (clazz.<span xmlns="" class="perl_Function">isAnnotationPresent</span>(SetterProxy.<span xmlns="" class="perl_Function">class</span>))
<span xmlns="" class="line">​</span>	    {
<span xmlns="" class="line">​</span>		Set&lt;<span xmlns="" class="perl_Keyword">Class</span>&gt; interfaces = <span xmlns="" class="perl_Keyword">new</span> HashSet&lt;<span xmlns="" class="perl_Keyword">Class</span>&gt;();
<span xmlns="" class="line">​</span>		<span xmlns="" class="perl_Function">addInterfaces</span>(clazz, interfaces);
<span xmlns="" class="line">​</span>		<span xmlns="" class="perl_Keyword">return</span> Proxy.<span xmlns="" class="perl_Function">newProxyInstance</span>(
<span xmlns="" class="line">​</span>					      clazz.<span xmlns="" class="perl_Function">getClassLoader</span>(),
<span xmlns="" class="line">​</span>					      interfaces.<span xmlns="" class="perl_Function">toArray</span>(<span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Keyword">Class</span>[interfaces.<span xmlns="" class="perl_Function">size</span>()]),
<span xmlns="" class="line">​</span>					      <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">SetterInterceptor</span>(bean)
<span xmlns="" class="line">​</span>					      );
<span xmlns="" class="line">​</span>	    }
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">else</span>
<span xmlns="" class="line">​</span>	    {
<span xmlns="" class="line">​</span>		<span xmlns="" class="perl_Keyword">return</span> bean;
<span xmlns="" class="line">​</span>	    }
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">protected</span> <span xmlns="" class="perl_DataType">static</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">addInterfaces</span>(<span xmlns="" class="perl_Keyword">Class</span> clazz, Set&lt;<span xmlns="" class="perl_Keyword">Class</span>&gt; interfaces)
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">if</span> (clazz == <span xmlns="" class="perl_Keyword">null</span>)
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">return</span>;
<span xmlns="" class="line">​</span>	interfaces.<span xmlns="" class="perl_Function">addAll</span>(Arrays.<span xmlns="" class="perl_Function">asList</span>(clazz.<span xmlns="" class="perl_Function">getInterfaces</span>()));
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Function">addInterfaces</span>(clazz.<span xmlns="" class="perl_Function">getSuperclass</span>(), interfaces);
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_Keyword">class</span> SetterInterceptor <span xmlns="" class="perl_Keyword">implements</span> InvocationHandler
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">private</span> Object target;
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_Function">SetterInterceptor</span>(Object target)
<span xmlns="" class="line">​</span>	{
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">target</span> = target;
<span xmlns="" class="line">​</span>	}
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">public</span> Object <span xmlns="" class="perl_Function">invoke</span>(Object proxy, Method method, Object[] args) <span xmlns="" class="perl_Keyword">throws</span> Throwable
<span xmlns="" class="line">​</span>	{
<span xmlns="" class="line">​</span>	    String methodName = method.<span xmlns="" class="perl_Function">getName</span>();
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">if</span> (methodName.<span xmlns="" class="perl_Function">startsWith</span>(<span xmlns="" class="perl_String">"set"</span>))
<span xmlns="" class="line">​</span>		<span xmlns="" class="perl_Keyword">throw</span> <span xmlns="" class="perl_Keyword">new</span> IllegalArgumentException(<span xmlns="" class="perl_String">"Cannot invoke setters."</span>);
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">return</span> method.<span xmlns="" class="perl_Function">invoke</span>(target, args);
<span xmlns="" class="line">​</span>	}
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}</pre><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> PrototypeCreator {
<span xmlns="" class="line">​</span>    ...
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">create</span>() <span xmlns="" class="perl_Keyword">throws</span> Throwable
<span xmlns="" class="line">​</span>    {
<span xmlns="" class="line">​</span>	ValueInvoker vi1 = (ValueInvoker)bfDefault.<span xmlns="" class="perl_Function">createBean</span>();
<span xmlns="" class="line">​</span>	vi1.<span xmlns="" class="perl_Function">setValue</span>(<span xmlns="" class="perl_String">"default"</span>);
<span xmlns="" class="line">​</span>	ValueInvoker vi2 = (ValueInvoker)enhanced.<span xmlns="" class="perl_Function">createBean</span>();
<span xmlns="" class="line">​</span>	vi2.<span xmlns="" class="perl_Function">setValue</span>(<span xmlns="" class="perl_String">"enhanced"</span>);
<span xmlns="" class="line">​</span>	ValueInvoker vi3 = (ValueInvoker)proxied.<span xmlns="" class="perl_Function">createBean</span>();
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">try</span>
<span xmlns="" class="line">​</span>	    {
<span xmlns="" class="line">​</span>		vi3.<span xmlns="" class="perl_Function">setValue</span>(<span xmlns="" class="perl_String">"default"</span>);
<span xmlns="" class="line">​</span>		<span xmlns="" class="perl_Keyword">throw</span> <span xmlns="" class="perl_Keyword">new</span> Error(<span xmlns="" class="perl_String">"Should not be here."</span>);
<span xmlns="" class="line">​</span>	    }
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">catch</span> (Exception ignored)
<span xmlns="" class="line">​</span>	    {
<span xmlns="" class="line">​</span>	    }
<span xmlns="" class="line">​</span>    }</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-Bean_Metadata_Builder">
      ⁠</a>7.8. Bean Metadata Builder</h1></div></div></div><div class="para">
			When using the Microcontainer in your code, use <code class="classname">BeanMetaDataBuilder</code> to create and configure your bean metadata.
		</div><div class="example"><a id="idm139732991988176">
      ⁠</a><p class="title"><strong>Example 7.17. <code class="classname">BeanMetaDataBuilder</code></strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"BuilderUtil"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.builder.BuilderUtil"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"BuilderExampleHolder"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.builder.BuilderExampleHolder"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;constructor&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"BUExample"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/constructor&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span></pre><div class="para">
				Using this concept, you do not expose your code to any Microcontainer implementation details.
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> BuilderUtil {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> KernelController controller;
<span xmlns="" class="line">​</span>    @Constructor
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Function">BuilderUtil</span>(@<span xmlns="" class="perl_Function">Inject</span>(bean = KernelConstants.<span xmlns="" class="perl_Function">KERNEL_CONTROLLER_NAME</span>) KernelController controller) {
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">controller</span> = controller;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">create</span>() <span xmlns="" class="perl_Keyword">throws</span> Throwable {
<span xmlns="" class="line">​</span>	BeanMetaDataBuilder builder = BeanMetaDataBuilder.<span xmlns="" class="perl_Function">createBuilder</span>(<span xmlns="" class="perl_String">"BUExample"</span>, BuilderExample.<span xmlns="" class="perl_Function">class</span>.<span xmlns="" class="perl_Function">getName</span>());
<span xmlns="" class="line">​</span>	builder.<span xmlns="" class="perl_Function">addStartParameter</span>(Kernel.<span xmlns="" class="perl_Function">class</span>.<span xmlns="" class="perl_Function">getName</span>(), builder.<span xmlns="" class="perl_Function">createInject</span>(KernelConstants.<span xmlns="" class="perl_Function">KERNEL_NAME</span>));
<span xmlns="" class="line">​</span>	controller.<span xmlns="" class="perl_Function">install</span>(builder.<span xmlns="" class="perl_Function">getBeanMetaData</span>());
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">destroy</span>() {
<span xmlns="" class="line">​</span>	controller.<span xmlns="" class="perl_Function">uninstall</span>(<span xmlns="" class="perl_String">"BUExample"</span>);
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-Custom_ClassLoader">
      ⁠</a>7.9. Custom ClassLoader</h1></div></div></div><div class="para">
			In the Microcontainer you can define a custom ClassLoader per bean. When defining a classloader for the whole deployment, make sure you do not create a cyclic dependency -- for instance, a newly defined classloader that depends on itself.
		</div><div class="example"><a id="idm139732986474624">
      ⁠</a><p class="title"><strong>Example 7.18. Defining a ClassLoader Per Bean</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;classloader&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"custom-classloader:0.0.0"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/classloader&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- this will be explained in future article --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;classloader</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"custom-classloader"</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:classloader:1.0"</span><span xmlns="" class="perl_Others"> export-all=</span><span xmlns="" class="perl_String">"NON_EMPTY"</span><span xmlns="" class="perl_Others"> import-all=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"CustomCL"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.classloader.CustomClassLoader"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;constructor&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"custom-classloader:0.0.0"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/constructor&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"pattern"</span><span xmlns="" class="perl_Keyword">&gt;</span>org\.jboss\.demos\.ioc\..+<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"CB1"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.classloader.CustomBean"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"CB2"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.classloader.CustomBean"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;classloader&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"CustomCL"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/classloader&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div><div class="para">
			<a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-ClassLoader_CB2_Bean_Test">Example 7.19, “Custom ClassLoader Test”</a> shows a test to verify that the CB2 bean uses a custom ClassLoader, which limits the loadable package scope.
		</div><div class="example"><a id="example-ClassLoader_CB2_Bean_Test">
      ⁠</a><p class="title"><strong>Example 7.19. Custom ClassLoader Test</strong></p><div class="example-contents"><pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> CustomClassLoader <span xmlns="" class="perl_Keyword">extends</span> ClassLoader {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> Pattern pattern;
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Function">CustomClassLoader</span>(ClassLoader parent) {
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">super</span>(parent);
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">Class</span>&lt;?&gt; <span xmlns="" class="perl_Function">loadClass</span>(String name) <span xmlns="" class="perl_Keyword">throws</span> ClassNotFoundException {
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">if</span> (pattern == <span xmlns="" class="perl_Keyword">null</span> || pattern.<span xmlns="" class="perl_Function">matcher</span>(name).<span xmlns="" class="perl_Function">matches</span>())
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_Keyword">super</span>.<span xmlns="" class="perl_Function">loadClass</span>(name);
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">else</span>
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">throw</span> <span xmlns="" class="perl_Keyword">new</span> ClassNotFoundException(<span xmlns="" class="perl_String">"Name '"</span> + name + <span xmlns="" class="perl_String">"' does not match pattern: "</span> + pattern);
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">setPattern</span>(String regexp) {
<span xmlns="" class="line">​</span>	pattern = Pattern.<span xmlns="" class="perl_Function">compile</span>(regexp);
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-Controller_Mode">
      ⁠</a>7.10. Controller Mode</h1></div></div></div><div class="para">
			By default, the Microcontainer uses the <span class="property">AUTO</span> controller mode. It pushes beans as far as they go with respect to dependencies. But there are two other modes: <span class="property">MANUAL</span> and <span class="property">ON_DEMAND</span>.
		</div><div class="para">
			If the bean is marked as <span class="property">ON_DEMAND</span>, it will not be used or installed installed until some other bean explicitly depends on it. In <span class="property">MANUAL</span> mode, the Microcontainer user must push the bean forward and backward along the state ladder.
		</div><div class="example"><a id="idm139732933909232">
      ⁠</a><p class="title"><strong>Example 7.20. Bean Controller Mode</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"OptionalService"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.mode.OptionalService"</span><span xmlns="" class="perl_Others"> mode=</span><span xmlns="" class="perl_String">"On Demand"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"OptionalServiceUser"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.mode.OptionalServiceUser"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ManualService"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.mode.ManualService"</span><span xmlns="" class="perl_Others"> mode=</span><span xmlns="" class="perl_String">"Manual"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ManualServiceUser"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.mode.ManualServiceUser"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;start&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"ManualService"</span><span xmlns="" class="perl_Others"> fromContext=</span><span xmlns="" class="perl_String">"context"</span><span xmlns="" class="perl_Others"> state=</span><span xmlns="" class="perl_String">"Not Installed"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/start&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				Using the <span class="property">fromContext</span> attribute of the <code class="classname">inject</code> class, you can inject beans, as well as their unmodifiable Microcontainer component representation.
			</div></div></div><div class="para">
			Review the code of <code class="classname">OptionalServiceUser</code> and <code class="classname">ManualServiceUser</code> for how to use the Microcontainer API for <span class="property">ON_DEMAND</span> and <span class="property">MANUAL</span> bean handling.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-Cycle">
      ⁠</a>7.11. Cycle</h1></div></div></div><div class="para">
			Beans may depend on each other in a cycle. For instance, <span class="package">A</span> depends on <span class="package">B</span> at construction, but <span class="package">B</span> depends on <span class="package">A</span> at setter. Because of the Microcontainer’s fine-grained state life cycle separation, this problem can be solved easily.
		</div><div class="example"><a id="idm139732975900464">
      ⁠</a><p class="title"><strong>Example 7.21. Bean life cycle separation</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"cycleA"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.cycle.CyclePojo"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"dependency"</span><span xmlns="" class="perl_Keyword">&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"cycleB"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"cycleB"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.cycle.CyclePojo"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;constructor&gt;&lt;parameter&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"cycleA"</span><span xmlns="" class="perl_Others"> state=</span><span xmlns="" class="perl_String">"Instantiated"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/parameter&gt;&lt;/constructor&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"cycleC"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.cycle.CyclePojo"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"dependency"</span><span xmlns="" class="perl_Keyword">&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"cycleD"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"cycleD"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.cycle.CyclePojo"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"dependency"</span><span xmlns="" class="perl_Keyword">&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"cycleC"</span><span xmlns="" class="perl_Others"> state=</span><span xmlns="" class="perl_String">"Instantiated"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-Demand_and_Supply">
      ⁠</a>7.12. Demand and Supply</h1></div></div></div><div class="para">
			Sometimes, such as with an injection, a dependency between two beans may not be readily apparent. Such dependencies should be expressed in a clear way, such as shown in <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-static-code-usage">Example 7.22, “Static Code Usage”</a>.
		</div><div class="example"><a id="example-static-code-usage">
      ⁠</a><p class="title"><strong>Example 7.22. Static Code Usage</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"TMDemand"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.demandsupply.TMDemander"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;demand&gt;</span>TM<span xmlns="" class="perl_Keyword">&lt;/demand&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"SimpleTMSupply"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.demandsupply.SimpleTMSupplyer"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;supply&gt;</span>TM<span xmlns="" class="perl_Keyword">&lt;/supply&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-Installs">
      ⁠</a>7.13. Installs</h1></div></div></div><div class="para">
			As a bean moves through different states, you might want to invoke some methods on other beans or the same bean. <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-invoking-methods-in-different-states">Example 7.23, “Invoking Methods in Different-States”</a> shows how <code class="classname">Entry</code> invokes <code class="classname">RepositoryManager</code>'s <code class="methodname">add</code> and <code class="methodname">removeEntry</code> methods to register and unregister itself.
		</div><div class="example"><a id="example-invoking-methods-in-different-states">
      ⁠</a><p class="title"><strong>Example 7.23. Invoking Methods in Different-States</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"RepositoryManager"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.install.RepositoryManager"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;install</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"addEntry"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;inject</span><span xmlns="" class="perl_Others"> fromContext=</span><span xmlns="" class="perl_String">"name"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;this/&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/install&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;uninstall</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"removeEntry"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;inject</span><span xmlns="" class="perl_Others"> fromContext=</span><span xmlns="" class="perl_String">"name"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/uninstall&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Entry"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.install.SimpleEntry"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;install</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"RepositoryManager"</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"addEntry"</span><span xmlns="" class="perl_Others"> state=</span><span xmlns="" class="perl_String">"Instantiated"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;inject</span><span xmlns="" class="perl_Others"> fromContext=</span><span xmlns="" class="perl_String">"name"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;this/&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/install&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;uninstall</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"RepositoryManager"</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"removeEntry"</span><span xmlns="" class="perl_Others"> state=</span><span xmlns="" class="perl_String">"Configured"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;inject</span><span xmlns="" class="perl_Others"> fromContext=</span><span xmlns="" class="perl_String">"name"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/uninstall&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-Lazy_Mock">
      ⁠</a>7.14. Lazy Mock</h1></div></div></div><div class="para">
			You might have a dependency on a bean that is rarely used, but takes a long time to configure. You can use a lazy mock of the bean, demonstrated in <a class="xref" href="chap-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC.html#example-lazy-mock">Example 7.24, “Lazy Mock”</a>, to resolve the dependency. When you actually need the bean, invoke and use the target bean, hoping it has been installed by then.
		</div><div class="example"><a id="example-lazy-mock">
      ⁠</a><p class="title"><strong>Example 7.24. Lazy Mock</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"lazyA"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.lazy.LazyImpl"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;constructor&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;parameter&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;lazy</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"lazyB"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">&lt;interface&gt;</span>org.jboss.demos.ioc.lazy.ILazyPojo<span xmlns="" class="perl_Keyword">&lt;/interface&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/lazy&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/constructor&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"lazyB"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.lazy.LazyImpl"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;constructor&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;parameter&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;lazy</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"lazyA"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">&lt;interface&gt;</span>org.jboss.demos.ioc.lazy.ILazyPojo<span xmlns="" class="perl_Keyword">&lt;/interface&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/lazy&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/constructor&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;lazy</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"anotherLazy"</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"Pojo"</span><span xmlns="" class="perl_Others"> exposeClass=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Pojo"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.lazy.Pojo"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-JBoss_Microcontainer_User_Guide-Advanced_Dependency_Injection_and_IoC-Life_cycle">
      ⁠</a>7.15. Life cycle</h1></div></div></div><div class="para">
			By default the Microcontainer uses <code class="methodname">create</code>, <code class="methodname">start</code>, and <code class="methodname">destroy</code> methods when it moves through the various states. However, you may not want the Microcontainer to invoke them. For this reason, an <span class="property">ignore</span> flag is available.
		</div><div class="example"><a id="idm139732971501520">
      ⁠</a><p class="title"><strong>Example 7.25. Bean Life cycles</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"FullLifecycleBean-3"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.lifecycle.FullLifecycleBean"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"FullLifecycleBean-2"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.lifecycle.FullLifecycleBean"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;create</span><span xmlns="" class="perl_Others"> ignored=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"FullLifecycleBean-1"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.demos.ioc.lifecycle.FullLifecycleBean"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;start</span><span xmlns="" class="perl_Others"> ignored=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div></div></div></body></html>