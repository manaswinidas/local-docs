<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Appendix C. Logging Information and Recipes</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="logging-appendix">
      ⁠</a>Appendix C. Logging Information and Recipes</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776749951744">
      ⁠</a>C.1. Log Level Descriptions</h1></div></div></div><div class="para">
			<a class="xref" href="logging-appendix.html#log-levels-table">Table C.1, “<span class="application">log4j</span> Log Level Definitions”</a> lists the typical meanings for different log levels in <span class="application"><strong>log4j</strong></span>. Your application may interpret these levels differently, depending on your choices.
		</div><div class="table"><a id="log-levels-table">
      ⁠</a><p class="title"><strong>Table C.1. <span class="application">log4j</span> Log Level Definitions</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-7-rows" summary="log4j Log Level Definitions"><colgroup><col/><col/><col/></colgroup><thead><tr><th> <span class="application"><strong>log4j</strong></span> Level </th><th> JDK Level </th><th> Description </th></tr></thead><tbody><tr><td> FATAL </td><td> </td><td> <div class="para">
							The Application Service is likely to crash.
						</div>
						 </td></tr><tr><td> ERROR </td><td> SEVERE </td><td> <div class="para">
							A definite problem exists.
						</div>
						 </td></tr><tr><td> WARN </td><td> WARNING </td><td> <div class="para">
							Likely to be a problem, but may be recoverable.
						</div>
						 </td></tr><tr><td> INFO </td><td> INFO </td><td> <div class="para">
							Low-volume detailed logging. Something of interest, but not a problem.
						</div>
						 </td></tr><tr><td> DEBUG </td><td> FINE </td><td> <div class="para">
							Low-volume detailed logging. Information that is probably not of interest.
						</div>
						 </td></tr><tr><td> </td><td> FINER </td><td> <div class="para">
							Medium-volume detailed logging.
						</div>
						 </td></tr><tr><td> TRACE </td><td> FINEST </td><td> <div class="para">
							High-volume detailed logging.
						</div>
						 </td></tr></tbody></table></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				The more verbose logging levels are not appropriate for production systems, because of the high level of output they generate.
			</div></div></div><div class="example"><a id="idm139776724045168">
      ⁠</a><p class="title"><strong>Example C.1. Restricting Logged Information to a Specific Log Level</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">&lt;!-- Show the evolution of the DataSource pool in the logs [inUse/Available/Max]--&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;category</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.jboss.resource.connectionmanager.JBossManagedConnectionPool"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;priority</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"TRACE"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.logging.XLevel"</span><span xmlns="" class="perl_Keyword">&gt;&lt;/priority&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/category&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776693524432">
      ⁠</a>C.2. Separate Log Files Per Application</h1></div></div></div><div class="para">
			To segregate logging output per application, assign <span class="application"><strong>log4j</strong></span> categories to specific appenders. This is typically done in the <code class="filename">conf/log4j.xml</code> deployment descriptor.
		</div><div class="example"><a id="idm139776682477936">
      ⁠</a><p class="title"><strong>Example C.2. Filtering App1 Log Output to a Separate File</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;appender</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"App1Log"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.apache.log4j.FileAppender"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;errorHandler</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.logging.util.OnlyOnceErrorHandler"</span><span xmlns="" class="perl_Keyword">&gt;&lt;/errorHandler&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Append"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"File"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"${jboss.server.home.dir}/log/app1.log"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;layout</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.apache.log4j.PatternLayout"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ConversionPattern"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"%d{ABSOLUTE} %-5p [%c{1}] %m%n"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/layout&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/appender&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;category</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"com.app1"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;appender-ref</span><span xmlns="" class="perl_Others"> ref=</span><span xmlns="" class="perl_String">"App1Log"</span><span xmlns="" class="perl_Keyword">&gt;&lt;/appender-ref&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/category&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;category</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"com.util"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;appender-ref</span><span xmlns="" class="perl_Others"> ref=</span><span xmlns="" class="perl_String">"App1Log"</span><span xmlns="" class="perl_Keyword">&gt;&lt;/appender-ref&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/category&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div><div class="example"><a id="idm139776733360656">
      ⁠</a><p class="title"><strong>Example C.3. Using TCLMCFilter</strong></p><div class="example-contents"><div class="para">
				Enterprise Platform 5.1 includes the new class <code class="classname">jboss.logging.filter.TCLMCFilter</code>, which allows you to filter based on the deployment URL.
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;appender</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"App1Log"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.apache.log4j.FileAppender"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;errorHandler</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.logging.util.OnlyOnceErrorHandler"</span><span xmlns="" class="perl_Keyword">&gt;&lt;/errorHandler&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Append"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"File"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"${jboss.server.home.dir}/log/app1.log"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;layout</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.apache.log4j.PatternLayout"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>	 <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ConversionPattern"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"%d{ABSOLUTE} %-5p [%c{1}] %m%n"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/layout&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;filter</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.logging.filter.TCLMCFilter"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>	 <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"AcceptOnMatch"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>	 <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DeployURL"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"app1.ear"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/filter&gt;</span>    
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- end the filter chain here --&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;filter</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.apache.log4j.varia.DenyAllFilter"</span><span xmlns="" class="perl_Keyword">&gt;&lt;/filter&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/appender&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776747605744">
      ⁠</a>C.3. Redirecting Category Output</h1></div></div></div><div class="para">
			When you increase the level of logging for one or more categories, it is often useful to redirect the output to a separate file for easier investigation. To do this you add an <code class="option">appender-ref</code> to the category.
		</div><div class="example"><a id="idm139776747603856">
      ⁠</a><p class="title"><strong>Example C.4. Adding an appender-ref</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;appender</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"JSR77"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.apache.log4j.FileAppender"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"File"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"${jboss.server.home.dir}/log/jsr77.log"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/appender&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Limit the JSR77 categories --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;category</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.jboss.management"</span><span xmlns="" class="perl_Others"> additivity=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;priority</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"DEBUG"</span><span xmlns="" class="perl_Keyword">&gt;&lt;/priority&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;appender-ref</span><span xmlns="" class="perl_Others"> ref=</span><span xmlns="" class="perl_String">"JSR77"</span><span xmlns="" class="perl_Keyword">&gt;&lt;/appender-ref&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/category&gt;</span>
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>			
<span xmlns="" class="line">​</span>
</pre></div></div><div class="para">
			All <code class="classname">org.jboss.management</code> output goes to the <code class="filename">jsr77.log</code> file. The <code class="option">additivity</code> attribute controls whether output continues to go to the root category appender. If <code class="literal">false</code>, output only goes to the appenders referred to by the category.
		</div></div></div></body></html>