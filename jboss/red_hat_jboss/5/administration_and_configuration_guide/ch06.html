<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 6. Logging</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776725182032">
      ⁠</a>Chapter 6. Logging</h1></div></div></div><div class="para">
		Logging is the most important tool to troubleshoot errors and monitor the status of the components of the Platform. <span class="application"><strong>log4j</strong></span> provides a familiar, flexible framework, familiar to Java developers.
	</div><div class="para">
		<a class="xref" href="ch06.html#logging-defaults">Section 6.1, “Logging Defaults”</a> contains information about customizing the default logging behavior for the Platform. See <a class="xref" href="ch06.html#logging-component-specific">Section 6.2, “Component-Specific Logging”</a> for additional customization. <a class="xref" href="logging-appendix.html">Appendix C, <em>Logging Information and Recipes</em></a> provides some logging <em class="wordasword">recipes</em>, which you can customize to your needs.
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="logging-defaults">
      ⁠</a>6.1. Logging Defaults</h1></div></div></div><div class="para">
			The <span class="application"><strong>log4j</strong></span> configuration is loaded from the <code class="filename"><em class="replaceable">&lt;JBOSS_HOME&gt;</em>/server/<em class="replaceable">&lt;PROFILE&gt;</em>/conf/jboss-log4j.xml</code> deployment descriptor. <span class="application"><strong>log4j</strong></span> uses <em class="firstterm">appenders</em> to control its logging behavior. An appender is a directive for where to log information, and how to do it. The <code class="filename">jboss-log4j.xml</code> file contains many sample appenders, including FILE, CONSOLE, and SMTP.
		</div><div class="table"><a id="idm139776764054080">
      ⁠</a><p class="title"><strong>Table 6.1. Common <span class="application">log4j</span> Configuration Directives</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols lt-7-rows" summary="Common log4j Configuration Directives"><colgroup><col/><col/></colgroup><thead><tr><th> Configuration Option </th><th> Description </th></tr></thead><tbody><tr><td> <div class="para">
							<code class="option">appender</code>
						</div>
						 </td><td> <div class="para">
							The main appender. Gives the name and the implementing class.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="option">errorHandler</code>
						</div>
						 </td><td> <div class="para">
							Delegates an external class to handle exceptions passed to the logger, especially if the appender cannot write the log for some reason.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="option">param</code>
						</div>
						 </td><td> <div class="para">
							Options specific to the type of appender. In this instance, the &lt;param&gt; is the name of the file that stores the logs for the FILE appender.
						</div>
						 </td></tr><tr><td> <div class="para">
							<code class="option">layout</code><code class="option"/>
						</div>
						 </td><td> <div class="para">
							Controls the logging format. Tweak this to work with your log-parsing software of choice.
						</div>
						 </td></tr></tbody></table></div></div><div class="example"><a id="idm139776756468768">
      ⁠</a><p class="title"><strong>Example 6.1. Sample Appender</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;appender</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"FILE"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.logging.appender.DailyRollingFileAppender"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;errorHandler</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.logging.util.OnlyOnceErrorHandler"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"File"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"${jboss.server.log.dir}/server.log"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Append"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- In AS 5.0.x the server log threshold was set by a system property.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">		 In 5.1 and later, the system property sets the priority on the root</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">		 logger (see &lt;root/&gt; below)</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">		 &lt;param name="Threshold" value="${jboss.server.log.threshold}"/&gt; --&gt;</span>
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- Rollover at midnight each day --&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DatePattern"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"'.'yyyy-MM-dd"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;layout</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.apache.log4j.PatternLayout"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>	 <span xmlns="" class="perl_Comment">&lt;!-- The default pattern: Date Priority [Category] (Thread) Message\n --&gt;</span>
<span xmlns="" class="line">​</span>	 <span xmlns="" class="perl_Keyword">&lt;param</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ConversionPattern"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"%d %-5p [%c] (%t) %m%n"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/layout&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/appender&gt;</span></pre></div></div><div class="para">
			For more information on configuring <span class="application"><strong>log4j</strong></span>, see <a href="http://logging.apache.org/log4j/1.2/">http://logging.apache.org/log4j/1.2/</a>.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="logging-component-specific">
      ⁠</a>6.2. Component-Specific Logging</h1></div></div></div><div class="para">
			Some Platform components have extra logging options available, or extra mechanisms for customizing logging.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776729139168">
      ⁠</a>6.2.1. SQL Logging with Hibernate</h2></div></div></div><div class="para">
				Hibernate has two ways to enable logging of SQL statements. These statements are most useful during the testing and debugging phases of application development.
			</div><div class="para">
				The first way is to explicitly enable it in your code.
			</div><pre class="programlisting JAVA"><span xmlns="" class="line">​</span>SessionFactory sf = <span xmlns="" class="perl_Keyword">new</span> Configuration()
<span xmlns="" class="line">​</span>	 .<span xmlns="" class="perl_Function">setProperty</span>(<span xmlns="" class="perl_String">"hibernate.show_sql"</span>, <span xmlns="" class="perl_String">"true"</span>)
<span xmlns="" class="line">​</span>	 <span xmlns="" class="perl_Comment">// ...</span>
<span xmlns="" class="line">​</span>	 .<span xmlns="" class="perl_Function">buildSessionFactory</span>();</pre><div class="para">
				Alternately, you can configure Hibernate to send all SQL messages to <span class="application"><strong>log4j</strong></span>, using a specific facility:
			</div><pre class="screen">
log4j.logger.org.hibernate.SQL=DEBUG, SQL_APPENDER
log4j.additivity.org.hibernate.SQL=false
</pre><div class="para">
				The <code class="option">additivity</code> option controls whether these log messages are propagated upward to parent handlers, and is a matter of preference.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776756669792">
      ⁠</a>6.2.2. Transaction Service Logging</h2></div></div></div><div class="para">
				The TransactionManagerService included with the Enterprise Platform handles logging differently than the stand-alone Transaction Service. Specifically, it overrides the value of the <span class="property">com.arjuna.common.util.logger property</span> given in the <code class="filename">jbossjta-properties.xml</code> file, forcing use of the <span class="application"><strong>log4j_releveler</strong></span> logger. All <code class="literal">INFO</code> level messages in the transaction code behave as <code class="literal">DEBUG</code> messages. Therefore, these messages are only present in log files if the filter level is <code class="literal">DEBUG</code>. All other log messages behave as normal.
			</div></div></div></div></body></html>