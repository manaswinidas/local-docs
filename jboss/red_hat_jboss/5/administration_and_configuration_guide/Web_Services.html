<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 10. Web Services</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="Web_Services">
      ⁠</a>Chapter 10. Web Services</h1></div></div></div><div class="para">
		<a id="idm139776680919680" class="indexterm"/><a id="idm139776755861888" class="indexterm"/><a id="idm139776757003568" class="indexterm"/> Web services are a key contributing factor in the way Web commerce is conducted today. Web services enable applications to communicate by sending small and large chunks of data to each other.
	</div><div class="para">
		A web service is essentially a software application that supports interaction of applications over a computer network or the world wide web. Web services usually interact through XML documents that map to an object, computer program, business process or database. To communicate, an application sends a message in XML document format to a web service which sends this message to the respective programs. Responses may be received based on requirements, the web service receives and then sends them in XML document format to the required program or applications. Web services can be used in many ways, examples include supply chain information management and business integration.
	</div><div class="para">
		JBossWS is a web service framework included as part of the JBoss Enterprise Application Platform. It implements the JAX-WS specification that defines a programming model and run-time architecture for implementing web services in Java, targeted at the Java Platform, Enterprise Edition 5 (Java EE 5). Even though JAX-RPC is still supported (the web service specification for J2EE 1.4), JBossWS does put a clear focus on JAX-WS.
	</div><div class="para">
		<div xmlns:d="http://docbook.org/ns/docbook" class="warning"><div class="admonition_header"><p><strong> Warning </strong></p></div><div class="admonition"><div class="para">
				JAX-RPC is not supported for JBoss Web Services CXF Stack.
			</div></div></div>

	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776688484288">
      ⁠</a>10.1. The need for web services</h1></div></div></div><div class="para">
			Enterprise systems communication may benefit from a wise adoption of web service technologies. Focusing attention on well designed contracts allows developers to establish an abstract view of their service capabilities. Considering the standardized way contracts are written, this definitely helps communication with third-party systems and eventually supports business-to-business integration; everything is clear and standardized in the contract the provider and consumer agree on. This also reduces the dependencies between implementations allowing other consumers to easily use the provided service without major changes.
		</div><div class="para">
			Other benefits exist for enterprise systems that incorporate web service technologies for internal heterogenous subsystems communication as web service interoperability boosts service reuse and composition. Web services eliminates the need to rewrite whole functionalities because they were developed by another enterprise department using a different software language.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776750349888">
      ⁠</a>10.2. What web services are not</h1></div></div></div><div class="para">
			Web services are not the solution for every software system communication.
		</div><div class="para">
			Nowadays they are meant to be used for loosely-coupled coarse-grained communication, message (document) exchange. Recent times has seen many specifications (WS-*) discussed and finally approved to establish standardized ws-related advanced aspects, including reliable messaging, message-level security and cross-service transactions. Web service specifications also include the notion of registries to collect service contract references, to easily discover service implementations.
		</div><div class="para">
			This all means that the web services technology platform suits complex enterprise communication and is not simply the latest way of doing remote procedure calls.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776685358528">
      ⁠</a>10.3. Document/Literal</h1></div></div></div><div class="para">
			With document style web services two business partners agree on the exchange of complex business documents that are well defined in XML schema. For example, one party sends a document describing a purchase order, the other responds (immediately or later) with a document that describes the status of the purchase order. The payload of the SOAP message is an XML document that can be validated against XML schema. The document is defined by the style attribute on the SOAP binding.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;binding</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'EndpointInterfaceBinding'</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">'tns:EndpointInterface'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;soap:binding</span><span xmlns="" class="perl_Others"> style=</span><span xmlns="" class="perl_String">'document'</span><span xmlns="" class="perl_Others"> transport=</span><span xmlns="" class="perl_String">'http://schemas.xmlsoap.org/soap/http'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;operation</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'concat'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;soap:operation</span><span xmlns="" class="perl_Others"> soapAction=</span><span xmlns="" class="perl_String">''</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;input&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;soap:body</span><span xmlns="" class="perl_Others"> use=</span><span xmlns="" class="perl_String">'literal'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/input&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;output&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;soap:body</span><span xmlns="" class="perl_Others"> use=</span><span xmlns="" class="perl_String">'literal'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/output&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/operation&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/binding&gt;</span>
</pre><div class="para">
			With document style web services the payload of every message is defined by a complex type in XML schema.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;complexType</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'concatType'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;sequence&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;element</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'String_1'</span><span xmlns="" class="perl_Others"> nillable=</span><span xmlns="" class="perl_String">'true'</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">'string'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;element</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'long_1'</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">'long'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/sequence&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/complexType&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;element</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'concat'</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">'tns:concatType'</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre><div class="para">
			Therefore, message parts must refer to an element from the schema.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;message</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'EndpointInterface_concat'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;part</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'parameters'</span><span xmlns="" class="perl_Others"> element=</span><span xmlns="" class="perl_String">'tns:concat'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/message&gt;</span></pre><div class="para">
			The following message definition is invalid.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;message</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'EndpointInterface_concat'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;part</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'parameters'</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">'tns:concatType'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/message&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776748764112">
      ⁠</a>10.4. Document/Literal (Bare)</h1></div></div></div><div class="para">
			Bare is an implementation detail from the Java domain. Neither in the abstract contract (for instance, wsdl+schema) nor at the SOAP message level is a bare endpoint recognizable. A bare endpoint or client uses a Java bean that represents the entire document payload.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>@WebService
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">SOAPBinding</span>(parameterStyle = SOAPBinding.<span xmlns="" class="perl_Function">ParameterStyle</span>.<span xmlns="" class="perl_Function">BARE</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> DocBareServiceImpl
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> SubmitBareResponse <span xmlns="" class="perl_Function">submitPO</span>(SubmitBareRequest poRequest)
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      ...
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}</pre><div class="para">
			The trick is that the Java beans representing the payload contain JAXB annotations that define how the payload is represented on the wire.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">XmlAccessorType</span>(XmlAccessType.<span xmlns="" class="perl_Function">FIELD</span>)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">XmlType</span>(name = <span xmlns="" class="perl_String">"SubmitBareRequest"</span>, namespace=<span xmlns="" class="perl_String">"http://soapbinding.samples.jaxws.ws.test.jboss.org/"</span>, propOrder = { <span xmlns="" class="perl_String">"product"</span> })
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">XmlRootElement</span>(namespace=<span xmlns="" class="perl_String">"http://soapbinding.samples.jaxws.ws.test.jboss.org/"</span>, name = <span xmlns="" class="perl_String">"SubmitPO"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> SubmitBareRequest
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   @<span xmlns="" class="perl_Function">XmlElement</span>(namespace=<span xmlns="" class="perl_String">"http://soapbinding.samples.jaxws.ws.test.jboss.org/"</span>,  required = <span xmlns="" class="perl_Keyword">true</span>)
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">private</span> String product;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>   ...
<span xmlns="" class="line">​</span>}</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776683483440">
      ⁠</a>10.5. Document/Literal (Wrapped)</h1></div></div></div><div class="para">
			Wrapped is an implementation detail from the Java domain. Neither in the abstract contract (for instance, wsdl+schema) nor at the SOAP message level is a wrapped endpoint recognizable. A wrapped endpoint or client uses the individual document payload properties. Wrapped is the default and does not have to be declared explicitly.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>@WebService
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> DocWrappedServiceImpl
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   @<span xmlns="" class="perl_Function">RequestWrapper</span> (className=<span xmlns="" class="perl_String">"org.somepackage.SubmitPO"</span>)
<span xmlns="" class="line">​</span>   @<span xmlns="" class="perl_Function">ResponseWrapper</span> (className=<span xmlns="" class="perl_String">"org.somepackage.SubmitPOResponse"</span>)
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">submitPO</span>(String product, <span xmlns="" class="perl_DataType">int</span> quantity)
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>   ...
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}</pre><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				With JBossWS the request and response wrapper annotations are not required, they will be generated on demand using sensible defaults.
			</div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776693704304">
      ⁠</a>10.6. RPC/Literal</h1></div></div></div><div class="para">
			With RPC there is a wrapper element that names the endpoint operation. Child elements of the RPC parent are the individual parameters. The SOAP body is constructed based on some simple rules: 
			<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						The port type operation name defines the endpoint method name
					</div></li><li class="listitem"><div class="para">
						Message parts are endpoint method parameters
					</div></li></ul></div>
			 RPC is defined by the style attribute on the SOAP binding.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;binding</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'EndpointInterfaceBinding'</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">'tns:EndpointInterface'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;soap:binding</span><span xmlns="" class="perl_Others"> style=</span><span xmlns="" class="perl_String">'rpc'</span><span xmlns="" class="perl_Others"> transport=</span><span xmlns="" class="perl_String">'http://schemas.xmlsoap.org/soap/http'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;operation</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'echo'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;soap:operation</span><span xmlns="" class="perl_Others"> soapAction=</span><span xmlns="" class="perl_String">''</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;input&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;soap:body</span><span xmlns="" class="perl_Others"> namespace=</span><span xmlns="" class="perl_String">'http://org.jboss.ws/samples/jsr181pojo'</span><span xmlns="" class="perl_Others"> use=</span><span xmlns="" class="perl_String">'literal'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/input&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;output&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;soap:body</span><span xmlns="" class="perl_Others"> namespace=</span><span xmlns="" class="perl_String">'http://org.jboss.ws/samples/jsr181pojo'</span><span xmlns="" class="perl_Others"> use=</span><span xmlns="" class="perl_String">'literal'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/output&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/operation&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/binding&gt;</span></pre><div class="para">
			With RPC style web services the portType names the operation (i.e. the java method on the endpoint)
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;portType</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'EndpointInterface'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;operation</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'echo'</span><span xmlns="" class="perl_Others"> parameterOrder=</span><span xmlns="" class="perl_String">'String_1'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;input</span><span xmlns="" class="perl_Others"> message=</span><span xmlns="" class="perl_String">'tns:EndpointInterface_echo'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;output</span><span xmlns="" class="perl_Others"> message=</span><span xmlns="" class="perl_String">'tns:EndpointInterface_echoResponse'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/operation&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/portType&gt;</span></pre><div class="para">
			Operation parameters are defined by individual message parts.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;message</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'EndpointInterface_echo'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;part</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'String_1'</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">'xsd:string'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/message&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;message</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'EndpointInterface_echoResponse'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;part</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'result'</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">'xsd:string'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/message&gt;</span></pre><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				There is no complex type in XML schema that could validate the entire SOAP message payload.
			</div></div></div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@WebService
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">SOAPBinding</span>(style = SOAPBinding.<span xmlns="" class="perl_Function">Style</span>.<span xmlns="" class="perl_Function">RPC</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> JSEBean01
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   @<span xmlns="" class="perl_Function">WebResult</span>(name=<span xmlns="" class="perl_String">"result"</span>)
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">echo</span>(@<span xmlns="" class="perl_Function">WebParam</span>(name=<span xmlns="" class="perl_String">"String_1"</span>) String input)
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>   ...
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}</pre><div class="para">
			The element names of RPC parameters/return values may be defined using the JAX-WS Annotations#javax.jws.WebParam and JAX-WS Annotations#javax.jws.WebResult respectively.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776678586736">
      ⁠</a>10.7. RPC/Encoded</h1></div></div></div><div class="para">
			SOAP encoding style is defined by <a href="http://www.w3.org/TR/2000/NOTE-SOAP-20000508/#_Toc478383512">chapter 5</a> of the <a href="http://www.w3.org/TR/2000/NOTE-SOAP-20000508/">SOAP-1.1</a> specification. It has inherent interoperability issues that cannot be fixed. The <a href="http://www.ws-i.org/Profiles/BasicProfile-1.0-2004-04-16.html">Basic Profile-1.0</a> prohibits this encoding style in <a href="http://www.ws-i.org/Profiles/BasicProfile-1.0-2004-04-16.html#refinement16448072">4.1.7 SOAP encodingStyle Attribute</a>. JBossWS has basic support for RPC/Encoded that is provided as is for simple interop scenarios with SOAP stacks that do not support literal encoding. Specifically, JBossWS does not support: 
			<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						element references
					</div></li><li class="listitem"><div class="para">
						soap arrays as bean properties
					</div></li></ul></div>

		</div><div class="para">
			<div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong> Note </strong></p></div><div class="admonition"><div class="para">
					This section should not be used in conjunction with JBoss Web Services CXF Stack.
				</div></div></div>

		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Web_Service-Web_Servie_Endpoints">
      ⁠</a>10.8. Web Service Endpoints </h1></div></div></div><div class="para">
			JAX-WS simplifies the development model for a web service endpoint a great deal. In short, an endpoint implementation bean is annotated with JAX-WS annotations and deployed to the server. The server automatically generates and publishes the abstract contract (for instance, wsdl+schema) for client consumption. All marshaling/unmarshaling is delegated to JAXB.
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776763497952">
      ⁠</a>10.9. Plain old Java Object (POJO)</h1></div></div></div><div class="para">
			Let us take a look at simple POJO endpoint implementation. All endpoint associated metadata are provided via JSR-181 annotations
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>@WebService
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">SOAPBinding</span>(style = SOAPBinding.<span xmlns="" class="perl_Function">Style</span>.<span xmlns="" class="perl_Function">RPC</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> JSEBean01
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">echo</span>(String input)
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>    ...
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776754249920">
      ⁠</a>10.10. The endpoint as a web application</h1></div></div></div><div class="para">
			A JAX-WS java service endpoint (JSE) is deployed as a web application.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;web-app</span> <span xmlns="" class="perl_Error">...</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;servlet&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>TestService<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;servlet-class&gt;</span>org.jboss.test.ws.jaxws.samples.jsr181pojo.JSEBean01<span xmlns="" class="perl_Keyword">&lt;/servlet-class&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/servlet&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;servlet-mapping&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>TestService<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;url-pattern&gt;</span>/*<span xmlns="" class="perl_Keyword">&lt;/url-pattern&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/servlet-mapping&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/web-app&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776758844384">
      ⁠</a>10.11. Packaging the endpoint</h1></div></div></div><div class="para">
			A JSR-181 java service endpoint (JSE) is packaged as a web application in a <code class="filename">*.war</code> file.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;war</span><span xmlns="" class="perl_Others"> warfile=</span><span xmlns="" class="perl_String">"${build.dir}/libs/jbossws-samples-jsr181pojo.war"</span><span xmlns="" class="perl_Others"> webxml=</span><span xmlns="" class="perl_String">"${build.resources.dir}/samples/jsr181pojo/WEB-INF/web.xml"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;classes</span><span xmlns="" class="perl_Others"> dir=</span><span xmlns="" class="perl_String">"${build.dir}/classes"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;include</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org/jboss/test/ws/samples/jsr181pojo/JSEBean01.class"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/classes&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/war&gt;</span></pre><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				Only the endpoint implementation bean and <code class="filename">web.xml</code> file are required.
			</div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776725866928">
      ⁠</a>10.12. Accessing the generated WSDL</h1></div></div></div><div class="para">
			A successfully deployed service endpoint will show up in the service endpoint manager. This is also where you find the links to the generated WSDL.
		</div><pre class="screen">http://yourhost:8080/jbossws/services</pre><div class="para">
			It is also possible to generate the abstract contract off line using jboss tools. For details of that see <a href="http://www.jboss.org/community/wiki/JBossWS-JAX-WSTools#TopDown_Using_wsconsume">Top Down (Using wsconsume)</a>
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776685698416">
      ⁠</a>10.13. EJB3 Stateless Session Bean (SLSB)</h1></div></div></div><div class="para">
			The JAX-WS programming model support the same set of annotations on EJB3 stateless session beans as on <a href="http://www.jboss.org/community/wiki/JBossWS-UserGuide#Plain_old_Java_Object_POJO">Plain old Java Object (POJO)</a> endpoints. EJB-2.1 endpoints are supported using the JAX-RPC programming model.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@Stateless
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Remote</span>(EJB3RemoteInterface.<span xmlns="" class="perl_Function">class</span>)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">RemoteBinding</span>(jndiBinding = <span xmlns="" class="perl_String">"/ejb3/EJB3EndpointInterface"</span>)
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span>@WebService
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">SOAPBinding</span>(style = SOAPBinding.<span xmlns="" class="perl_Function">Style</span>.<span xmlns="" class="perl_Function">RPC</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> EJB3Bean01 <span xmlns="" class="perl_Keyword">implements</span> EJB3RemoteInterface
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">echo</span>(String input)
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>   ...
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}</pre><div class="para">
			Above you see an EJB-3.0 stateless session bean that exposes one method both on the remote interface and as an endpoint operation.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Packaging the endpoint</div>
				A JSR-181 EJB service endpoint is packaged as an ordinary ejb deployment.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jar</span><span xmlns="" class="perl_Others"> jarfile=</span><span xmlns="" class="perl_String">"${build.dir}/libs/jbossws-samples-jsr181ejb.jar"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;fileset</span><span xmlns="" class="perl_Others"> dir=</span><span xmlns="" class="perl_String">"${build.dir}/classes"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;include</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org/jboss/test/ws/samples/jsr181ejb/EJB3Bean01.class"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;include</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org/jboss/test/ws/samples/jsr181ejb/EJB3RemoteInterface.class"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/fileset&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jar&gt;</span></pre><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Accessing the generated WSDL</div>
				A successfully deployed service endpoint will show up in the service endpoint manager. This is also where you will find the links to the generated WSDL.
			</div><pre class="programlisting">
  http://yourhost:8080/jbossws/services</pre><div class="para">
			It is also possible to generate the abstract contract offline using JbossWS tools. For details of that please see <a href="http://www.jboss.org/community/wiki/JBossWS-JAX-WSTools#TopDown_Using_wsconsume">Top Down (Using wsconsume)</a>
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776757684672">
      ⁠</a>10.14. Endpoint Provider</h1></div></div></div><div class="para">
			JAX-WS services typically implement a native Java service endpoint interface (SEI), perhaps mapped from a WSDL port type, either directly or via the use of annotations.
		</div><div class="para">
			Java SEIs provide a high level Java-centric abstraction that hides the details of converting between Java objects and their XML representations for use in XML-based messages. However, in some cases it is desirable for services to be able to operate at the XML message level. The Provider interface offers an alternative to SEIs and may be implemented by services wishing to work at the XML message level.
		</div><div class="para">
			A Provider based service instance’s invoke method is called for each message received for the service.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@WebServiceProvider
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">ServiceMode</span>(value = Service.<span xmlns="" class="perl_Function">Mode</span>.<span xmlns="" class="perl_Function">PAYLOAD</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> ProviderBeanPayload <span xmlns="" class="perl_Keyword">implements</span> Provider&lt;Source&gt;
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> Source <span xmlns="" class="perl_Function">invoke</span>(Source req)
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Comment">// Access the entire request PAYLOAD and return the response PAYLOAD</span>
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}</pre><div class="para">
			<span class="property">Service.Mode.PAYLOAD</span> is the default and does not have to be declared explicitly. You can also use <span class="property">Service.Mode.MESSAGE</span> to access the entire SOAP message (for example, with <span class="property">MESSAGE</span> the Provider can also see SOAP Headers)
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776765878976">
      ⁠</a>10.15. WebServiceContext</h1></div></div></div><div class="para">
			The <code class="classname">WebServiceContext</code> is treated as an injectable resource that can be set at the time an endpoint is initialized. The <code class="classname">WebServiceContext</code> object will then use thread-local information to return the correct information regardless of how many threads are concurrently being used to serve requests addressed to the same endpoint object.
		</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@WebService
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> EndpointJSE
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   @Resource
<span xmlns="" class="line">​</span>   WebServiceContext wsCtx;
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">testGetMessageContext</span>()
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      SOAPMessageContext jaxwsContext = (SOAPMessageContext)wsCtx.<span xmlns="" class="perl_Function">getMessageContext</span>();
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">return</span> jaxwsContext != <span xmlns="" class="perl_Keyword">null</span> ? <span xmlns="" class="perl_String">"pass"</span> : <span xmlns="" class="perl_String">"fail"</span>;
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>   ...
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">testGetUserPrincipal</span>()
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      Principal principal = wsCtx.<span xmlns="" class="perl_Function">getUserPrincipal</span>();
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">return</span> principal.<span xmlns="" class="perl_Function">getName</span>();
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">boolean</span> <span xmlns="" class="perl_Function">testIsUserInRole</span>(String role)
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">return</span> wsCtx.<span xmlns="" class="perl_Function">isUserInRole</span>(role);
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Web_Service-Web_Servie_Clients">
      ⁠</a>10.16. Web Service Clients</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776753119264">
      ⁠</a>10.16.1. Service</h2></div></div></div><div class="para">
				<code class="literal">Service</code> is an abstraction that represents a WSDL service. A WSDL service is a collection of related ports, each of which consists of a port type bound to a particular protocol and available at a particular endpoint address.
			</div><div class="para">
				For most clients, you will start with a set of stubs generated from the WSDL. One of these will be the service, and you will create objects of that class in order to work with the service (see "static case" below).
			</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776731259536">
      ⁠</a>10.16.1.1. Service Usage</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Static case</div>
						Most clients will start with a WSDL file, and generate some stubs using jbossws tools like <span class="emphasis"><em>wsconsume</em></span>. This usually gives a mass of files, one of which is the top of the tree. This is the service implementation class.
					</div><div class="para">
					The generated implementation class can be recognized as it will have two public constructors, one with no arguments and one with two arguments, representing the wsdl location (a java.net.URL) and the service name (a javax.xml.namespace.QName) respectively.
				</div><div class="para">
					Usually you will use the no-argument constructor. In this case the WSDL location and service name are those found in the WSDL. These are set implicitly from the WebServiceClient annotation that decorates the generated class.
				</div><div class="para">
					The following code snippet shows the generated constructors from the generated class:
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">// Generated Service Class</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">WebServiceClient</span>(name=<span xmlns="" class="perl_String">"StockQuoteService"</span>, targetNamespace=<span xmlns="" class="perl_String">"http://example.com/stocks"</span>, wsdlLocation=<span xmlns="" class="perl_String">"http://example.com/stocks.wsdl"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> StockQuoteService <span xmlns="" class="perl_Keyword">extends</span> javax.<span xmlns="" class="perl_Function">xml</span>.<span xmlns="" class="perl_Function">ws</span>.<span xmlns="" class="perl_Function">Service</span> 
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Function">StockQuoteService</span>() 
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">super</span>(<span xmlns="" class="perl_Keyword">new</span> URL(<span xmlns="" class="perl_String">"http://example.com/stocks.wsdl"</span>), <span xmlns="" class="perl_Keyword">new</span> QName(<span xmlns="" class="perl_String">"http://example.com/stocks"</span>, <span xmlns="" class="perl_String">"StockQuoteService"</span>));
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Function">StockQuoteService</span>(String wsdlLocation, QName serviceName) 
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">super</span>(wsdlLocation, serviceName);
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   ...
<span xmlns="" class="line">​</span>}</pre><div class="para">
					<a class="xref" href="Web_Services.html#Web_Services-Dynamic_Proxy">Section 10.16.2, “Dynamic Proxy”</a> explains how to obtain a port from the service and how to invoke an operation on the port. If you need to work with the XML payload directly or with the XML representation of the entire SOAP message, refer to <a class="xref" href="Web_Services.html#Web_Services-Dispatch">Section 10.16.4, “Dispatch”</a>.
				</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Dynamic case</div>
						In the dynamic case, when nothing is generated, a web service client uses <code class="literal">Service.create</code> to create Service instances, the following code illustrates this process.
					</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>URL wsdlLocation = <span xmlns="" class="perl_Keyword">new</span> URL(<span xmlns="" class="perl_String">"http://example.org/my.wsdl"</span>);
<span xmlns="" class="line">​</span>QName serviceName = <span xmlns="" class="perl_Keyword">new</span> QName(<span xmlns="" class="perl_String">"http://example.org/sample"</span>, <span xmlns="" class="perl_String">"MyService"</span>);
<span xmlns="" class="line">​</span>Service service = Service.<span xmlns="" class="perl_Function">create</span>(wsdlLocation, serviceName);</pre><div class="para">
					This is not the recommended way to use JBossWS.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776753480976">
      ⁠</a>10.16.1.2. Handler Resolver</h3></div></div></div><div class="para">
					JAX-WS provides a flexible plug-in framework for message processing modules, known as handlers, that may be used to extend the capabilities of a JAX-WS runtime system. <a class="xref" href="Web_Services.html#Web_Service-Handler_Framework">Section 10.17.1, “Handler Framework”</a> describes the handler framework in detail. A <code class="classname">Service</code> instance provides access to a <code class="classname">HandlerResolver</code> via a pair of <code class="methodname">getHandlerResolver</code> and <code class="methodname">setHandlerResolver</code> methods that may be used to configure a set of handlers on a per-service, per-port or per-protocol binding basis.
				</div><div class="para">
					When a <code class="classname">Service</code> instance is used to create a proxy or a <code class="classname">Dispatch</code> instance then the handler resolver currently registered with the service is used to create the required handler chain. Subsequent changes to the handler resolver configured for a <code class="classname">Service</code> instance do not affect the handlers on previously created proxies, or <code class="classname">Dispatch</code> instances.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776678750000">
      ⁠</a>10.16.1.3. Executor</h3></div></div></div><div class="para">
					<code class="classname">Service</code> instances can be configured with a <code class="classname">java.util.concurrent.Executor</code>. The executor will then be used to invoke any asynchronous callbacks requested by the application. The <code class="methodname">setExecutor</code> and <code class="methodname">getExecutor</code> methods of <code class="classname">Service</code> can be used to modify and retrieve the executor configured for a service.
				</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Web_Services-Dynamic_Proxy">
      ⁠</a>10.16.2. Dynamic Proxy</h2></div></div></div><div class="para">
				You can create an instance of a client proxy using one of <code class="methodname">getPort</code> methods on the <a href="http://java.sun.com/javaee/5/docs/api/javax/xml/ws/Service.html"><code class="classname">Service</code></a>.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/** </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * The getPort method returns a proxy. A service client</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * uses this proxy to invoke operations on the target</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * service endpoint. The </span><span xmlns="" class="perl_Keyword">&lt;code&gt;</span><span xmlns="" class="perl_Comment">serviceEndpointInterface</span><span xmlns="" class="perl_Keyword">&lt;/code&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * specifies the service endpoint interface that is supported by</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * the created dynamic proxy instance.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> &lt;T&gt; T <span xmlns="" class="perl_Function">getPort</span>(QName portName, <span xmlns="" class="perl_Keyword">Class</span>&lt;T&gt; serviceEndpointInterface)
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>}
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/** </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * The getPort method returns a proxy. The parameter</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * </span><span xmlns="" class="perl_Keyword">&lt;code&gt;</span><span xmlns="" class="perl_Comment">serviceEndpointInterface</span><span xmlns="" class="perl_Keyword">&lt;/code&gt;</span><span xmlns="" class="perl_Comment"> specifies the service</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * endpoint interface that is supported by the returned proxy.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * In the implementation of this method, the JAX-WS</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * runtime system takes the responsibility of selecting a protocol</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * binding (and a port) and configuring the proxy accordingly.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * The returned proxy should not be reconfigured by the client.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> *</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> &lt;T&gt; T <span xmlns="" class="perl_Function">getPort</span>(<span xmlns="" class="perl_Keyword">Class</span>&lt;T&gt; serviceEndpointInterface)
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>}</pre><div class="para">
				The <span class="emphasis"><em>Service Endpoint Interface</em></span> (SEI) is usually generated using tools. For details see <a href="http://www.jboss.org/community/wiki/JBossWS-JAX-WSTools#TopDown_Using_wsconsume">Top Down (Using wsconsume)</a>.
			</div><div class="para">
				A generated static <a href="http://www.jboss.org/community/wiki/JBossWS-UserGuide#Service"><code class="classname">Service</code></a> usually also offers typed methods to get ports. These methods also return dynamic proxies that implement the SEI.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">WebServiceClient</span>(name = <span xmlns="" class="perl_String">"TestEndpointService"</span>, targetNamespace = <span xmlns="" class="perl_String">"http://org.jboss.ws/wsref"</span>, 
<span xmlns="" class="line">​</span>  wsdlLocation = <span xmlns="" class="perl_String">"http://localhost.localdomain:8080/jaxws-samples-webserviceref?wsdl"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> TestEndpointService <span xmlns="" class="perl_Keyword">extends</span> Service
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   ...
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Function">TestEndpointService</span>(URL wsdlLocation, QName serviceName) {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">super</span>(wsdlLocation, serviceName);
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span>   @<span xmlns="" class="perl_Function">WebEndpoint</span>(name = <span xmlns="" class="perl_String">"TestEndpointPort"</span>)
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> TestEndpoint <span xmlns="" class="perl_Function">getTestEndpointPort</span>() 
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">return</span> (TestEndpoint)<span xmlns="" class="perl_Keyword">super</span>.<span xmlns="" class="perl_Function">getPort</span>(TESTENDPOINTPORT, TestEndpoint.<span xmlns="" class="perl_Function">class</span>);
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776679192336">
      ⁠</a>10.16.3. WebServiceRef</h2></div></div></div><div class="para">
				The <code class="classname">WebServiceRef</code> annotation is used to declare a reference to a Web service. It follows the resource pattern exemplified by the <code class="classname">javax.annotation.Resource</code> annotation in <a href="http://jcp.org/en/jsr/detail?id=250">JSR-250</a>
			</div><div class="para">
				There are two uses to the <code class="classname">WebServiceRef</code> annotation:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
						To define a reference whose type is a generated service class. In this case, the type and value element will both refer to the generated service class type. Moreover, if the reference type can be inferred by the field or method declaration then the annotation is applied to the type, and value elements <span class="emphasis"><em>may</em></span> have the default value (<code class="classname">Object.class</code>, that is). If the type cannot be inferred, then at least the type element <span class="emphasis"><em>must</em></span> be present with a non-default value.
					</div></li><li class="listitem"><div class="para">
						To define a reference whose type is a SEI. In this case, the type element <span class="emphasis"><em>may</em></span> be present with its default value if the type of the reference can be inferred from the annotated field and method declaration, but the value element <span class="emphasis"><em>must</em></span> always be present and refer to a generated service class type (a subtype of <code class="classname">javax.xml.ws.Service</code>). The <span class="property">wsdlLocation</span> element, if present, overrides <span class="property">theWSDL</span> location information specified in the <code class="classname">WebService</code> annotation of the referenced generated service class.
					</div></li></ol></div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> EJB3Client <span xmlns="" class="perl_Keyword">implements</span> EJB3Remote
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   @WebServiceRef
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> TestEndpointService service4;
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span>   @WebServiceRef
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> TestEndpoint port3;
<span xmlns="" class="line">​</span>}</pre><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">WebServiceRef Customization</div>
					In JBoss Enterprise Application Platform 5.0 we offer a number of overrides and extensions to the <code class="classname">WebServiceRef</code> annotation. These include:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						define the port that should be used to resolve a container-managed port
					</div></li><li class="listitem"><div class="para">
						define default <span class="property">Stub</span> property settings for Stub objects
					</div></li><li class="listitem"><div class="para">
						define the URL of a final WSDL document to be used
					</div></li></ul></div><div class="para">
				Example:
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;service-ref&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;service-ref-name&gt;</span>OrganizationService<span xmlns="" class="perl_Keyword">&lt;/service-ref-name&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;wsdl-override&gt;</span>file:/wsdlRepository/organization-service.wsdl<span xmlns="" class="perl_Keyword">&lt;/wsdl-override&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/service-ref&gt;</span>
<span xmlns="" class="line">​</span>.. 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;service-ref&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;service-ref-name&gt;</span>OrganizationService<span xmlns="" class="perl_Keyword">&lt;/service-ref-name&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;config-name&gt;</span>Secure Client Config<span xmlns="" class="perl_Keyword">&lt;/config-name&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;config-file&gt;</span>META-INF/jbossws-client-config.xml<span xmlns="" class="perl_Keyword">&lt;/config-file&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;handler-chain&gt;</span>META-INF/jbossws-client-handlers.xml<span xmlns="" class="perl_Keyword">&lt;/handler-chain&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/service-ref&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;service-ref&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;service-ref-name&gt;</span>SecureService<span xmlns="" class="perl_Keyword">&lt;/service-ref-name&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;service-class-name&gt;</span>org.jboss.tests.ws.jaxws.webserviceref.SecureEndpointService<span xmlns="" class="perl_Keyword">&lt;/service-class-name&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;service-qname&gt;</span>{http://org.jboss.ws/wsref}SecureEndpointService<span xmlns="" class="perl_Keyword">&lt;/service-qname&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;port-info&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;service-endpoint-interface&gt;</span>org.jboss.tests.ws.jaxws.webserviceref.SecureEndpoint<span xmlns="" class="perl_Keyword">&lt;/service-endpoint-interface&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;port-qname&gt;</span>{http://org.jboss.ws/wsref}SecureEndpointPort<span xmlns="" class="perl_Keyword">&lt;/port-qname&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;stub-property&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;name&gt;</span>javax.xml.ws.security.auth.username<span xmlns="" class="perl_Keyword">&lt;/name&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>kermit<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/stub-property&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;stub-property&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;name&gt;</span>javax.xml.ws.security.auth.password<span xmlns="" class="perl_Keyword">&lt;/name&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>thefrog<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/stub-property&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/port-info&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/service-ref&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Web_Services-Dispatch">
      ⁠</a>10.16.4. Dispatch</h2></div></div></div><div class="para">
				XML Web Services use XML messages for communication between services and service clients. The higher level JAX-WS APIs are designed to hide the details of converting between Java method invocations and the corresponding XML messages, but in some cases operating at the XML message level is desirable. The Dispatch interface provides support for this mode of interaction.
			</div><div class="para">
				Dispatch supports two usage modes, identified by the constants <span class="property">javax.xml.ws.Service.Mode.MESSAGE</span> and <span class="property">javax.xml.ws.Service.Mode.PAYLOAD</span> respectively:
			</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Message</div>
					In this mode, client applications work directly with protocol-specific message structures. For example, when used with a SOAP protocol binding, a client application would work directly with a SOAP message.
				</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Message Payload</div>
					In this mode, client applications work with the payload of messages rather than the messages themselves. For example, when used with a SOAP protocol binding, a client application would work with the contents of the SOAP Body rather than the SOAP message as a whole.
				</div><div class="para">
				Dispatch is a low level API that requires clients to construct messages or message payloads as XML and requires an intimate knowledge of the desired message or payload structure. Dispatch is a generic class that supports input and output of messages or message payloads of any type.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>Service service = Service.<span xmlns="" class="perl_Function">create</span>(wsdlURL, serviceName);
<span xmlns="" class="line">​</span>Dispatch dispatch = service.<span xmlns="" class="perl_Function">createDispatch</span>(portName, StreamSource.<span xmlns="" class="perl_Function">class</span>, Mode.<span xmlns="" class="perl_Function">PAYLOAD</span>);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>String payload = <span xmlns="" class="perl_String">"&lt;ns1:ping xmlns:ns1='http://oneway.samples.jaxws.ws.test.jboss.org/'/&gt;"</span>;
<span xmlns="" class="line">​</span>dispatch.<span xmlns="" class="perl_Function">invokeOneWay</span>(<span xmlns="" class="perl_Keyword">new</span> StreamSource(<span xmlns="" class="perl_Keyword">new</span> StringReader(payload)));
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>payload = <span xmlns="" class="perl_String">"&lt;ns1:feedback xmlns:ns1='http://oneway.samples.jaxws.ws.test.jboss.org/'/&gt;"</span>;
<span xmlns="" class="line">​</span>Source retObj = (Source)dispatch.<span xmlns="" class="perl_Function">invoke</span>(<span xmlns="" class="perl_Keyword">new</span> StreamSource(<span xmlns="" class="perl_Keyword">new</span> StringReader(payload)));
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776746140544">
      ⁠</a>10.16.5. Asynchronous Invocations</h2></div></div></div><div class="para">
				The <code class="classname">BindingProvider</code> interface represents a component that provides a protocol binding for use by clients, it is implemented by proxies and is extended by the <code class="classname">Dispatch</code> interface.
			</div><div class="para">
				<code class="classname">BindingProvider</code> instances may provide asynchronous operation capabilities. When used, asynchronous operation invocations are decoupled from the <code class="classname">BindingProvider</code> instance at invocation time such that the response context is not updated when the operation completes. Instead a separate response context is made available using the <code class="classname">Response</code> interface.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">testInvokeAsync</span>() <span xmlns="" class="perl_Keyword">throws</span> Exception
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   URL wsdlURL = <span xmlns="" class="perl_Keyword">new</span> URL(<span xmlns="" class="perl_String">"http://"</span> + <span xmlns="" class="perl_Function">getServerHost</span>() + <span xmlns="" class="perl_String">":8080/jaxws-samples-asynchronous?wsdl"</span>);
<span xmlns="" class="line">​</span>   QName serviceName = <span xmlns="" class="perl_Keyword">new</span> QName(targetNS, <span xmlns="" class="perl_String">"TestEndpointService"</span>);
<span xmlns="" class="line">​</span>   Service service = Service.<span xmlns="" class="perl_Function">create</span>(wsdlURL, serviceName);
<span xmlns="" class="line">​</span>   TestEndpoint port = service.<span xmlns="" class="perl_Function">getPort</span>(TestEndpoint.<span xmlns="" class="perl_Function">class</span>);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   Response response = port.<span xmlns="" class="perl_Function">echoAsync</span>(<span xmlns="" class="perl_String">"Async"</span>);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">// access future</span>
<span xmlns="" class="line">​</span>   String retStr = (String) response.<span xmlns="" class="perl_Function">get</span>();
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Function">assertEquals</span>(<span xmlns="" class="perl_String">"Async"</span>, retStr);
<span xmlns="" class="line">​</span>}
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776683320112">
      ⁠</a>10.16.6. Oneway Invocations</h2></div></div></div><div class="para">
				<span class="property">@Oneway</span> indicates that the given web method has only an input message and no output. Typically, a one-way method returns the thread of control to the calling application prior to executing the actual business method.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">WebService</span> (name=<span xmlns="" class="perl_String">"PingEndpoint"</span>)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">SOAPBinding</span>(style = SOAPBinding.<span xmlns="" class="perl_Function">Style</span>.<span xmlns="" class="perl_Function">RPC</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> PingEndpointImpl
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">static</span> String feedback;
<span xmlns="" class="line">​</span>   ...
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   @Oneway
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">ping</span>()
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      log.<span xmlns="" class="perl_Function">info</span>(<span xmlns="" class="perl_String">"ping"</span>);
<span xmlns="" class="line">​</span>      feedback = <span xmlns="" class="perl_String">"ok"</span>;
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>   ...
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">feedback</span>()
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>   log.<span xmlns="" class="perl_Function">info</span>(<span xmlns="" class="perl_String">"feedback"</span>);
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">return</span> feedback;
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}</pre></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776756114880">
      ⁠</a>10.17. Common API</h1></div></div></div><div class="para">
			This sections describes concepts that apply equally to <a class="xref" href="Web_Services.html#Web_Service-Web_Servie_Endpoints">Section 10.8, “Web Service Endpoints ”</a> and <a class="xref" href="Web_Services.html#Web_Service-Web_Servie_Clients">Section 10.16, “Web Service Clients”</a>.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Web_Service-Handler_Framework">
      ⁠</a>10.17.1. Handler Framework</h2></div></div></div><div class="para">
				The handler framework is implemented by a JAX-WS protocol binding in both client and server side runtimes. Proxies, and Dispatch instances, known collectively as binding providers, each use protocol bindings to bind their abstract functionality to specific protocols.
			</div><div class="para">
				Client and server-side handlers are organized into an ordered list known as a handler chain. The handlers within a handler chain are invoked each time a message is sent or received. Inbound messages are processed by handlers prior to binding provider processing. Outbound messages are processed by handlers after any binding provider processing.
			</div><div class="para">
				Handlers are invoked with a message context that provides methods to access and modify inbound and outbound messages and to manage a set of properties. Message context properties may be used to facilitate communication between individual handlers and between handlers and client and service implementations. Different types of handlers are invoked with different types of message context.
			</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776759354816">
      ⁠</a>10.17.1.1. Logical Handler</h3></div></div></div><div class="para">
					Handlers that only operate on message context properties and message payloads. Logical handlers are protocol agnostic and are unable to affect protocol specific parts of a message. Logical handlers are handlers that implement <code class="classname">javax.xml.ws.handler.LogicalHandler</code>.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776759542224">
      ⁠</a>10.17.1.2. Protocol Handler</h3></div></div></div><div class="para">
					Handlers that operate on message context properties and protocol specific messages. Protocol handlers are specific to a particular protocol and may access and change protocol specific aspects of a message. Protocol handlers are handlers that implement any interface derived from <code class="classname">javax.xml.ws.handler.Handler</code> except <code class="classname">javax.xml.ws.handler.LogicalHandler</code>.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776759539616">
      ⁠</a>10.17.1.3. Service endpoint handlers</h3></div></div></div><div class="para">
					On the service endpoint, handlers are defined using the <span class="property">@HandlerChain</span> annotation.
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@WebService
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">HandlerChain</span>(file = <span xmlns="" class="perl_String">"jaxws-server-source-handlers.xml"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> SOAPEndpointSourceImpl
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>}</pre><div class="para">
					The location of the handler chain file supports 2 formats
				</div><div class="para">
					1. An absolute java.net.URL in externalForm. (ex: <a href="http://myhandlers.foo.com/handlerfile1.xml">http://myhandlers.foo.com/handlerfile1.xml</a>)
				</div><div class="para">
					2. A relative path from the source file or class file. (ex: bar/handlerfile1.xml)
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776745830496">
      ⁠</a>10.17.1.4. Service client handlers</h3></div></div></div><div class="para">
					On the client side, handler can be configured using the <span class="property">@HandlerChain</span> annotation on the SEI or dynamically using the API.
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>Service service = Service.<span xmlns="" class="perl_Function">create</span>(wsdlURL, serviceName);
<span xmlns="" class="line">​</span>Endpoint port = (Endpoint)service.<span xmlns="" class="perl_Function">getPort</span>(Endpoint.<span xmlns="" class="perl_Function">class</span>);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>BindingProvider bindingProvider = (BindingProvider)port;
<span xmlns="" class="line">​</span>List&lt;Handler&gt; handlerChain = <span xmlns="" class="perl_Keyword">new</span> ArrayList&lt;Handler&gt;();
<span xmlns="" class="line">​</span>handlerChain.<span xmlns="" class="perl_Function">add</span>(<span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">LogHandler</span>());
<span xmlns="" class="line">​</span>handlerChain.<span xmlns="" class="perl_Function">add</span>(<span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">AuthorizationHandler</span>());
<span xmlns="" class="line">​</span>handlerChain.<span xmlns="" class="perl_Function">add</span>(<span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">RoutingHandler</span>());
<span xmlns="" class="line">​</span>bindingProvider.<span xmlns="" class="perl_Function">getBinding</span>().<span xmlns="" class="perl_Function">setHandlerChain</span>(handlerChain); <span xmlns="" class="perl_Comment">// important!</span>
</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776680641296">
      ⁠</a>10.17.2. Message Context</h2></div></div></div><div class="para">
				MessageContext is the super interface for all JAX-WS message contexts. It extends Map&lt;String,Object&gt; with additional methods and constants to manage a set of properties that enable handlers in a handler chain to share processing related state. For example, a handler may use the put method to insert a property in the message context that one or more other handlers in the handler chain may subsequently obtain via the get method.
			</div><div class="para">
				Properties are scoped as either APPLICATION or HANDLER. All properties are available to all handlers associated with particular endpoint. E.g., if a logical handler puts a property in the message context, that property will also be available to any protocol handlers in the chain during the execution. APPLICATION scoped properties are also made available to client applications and service endpoint implementations. The default scope for a property is HANDLER.
			</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776765668272">
      ⁠</a>10.17.2.1. Accessing the message context</h3></div></div></div><div class="para">
					Users can access the message context in handlers or in endpoints via <code class="literal">@WebServiceContext</code> annotation.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776765666416">
      ⁠</a>10.17.2.2. Logical Message Context</h3></div></div></div><div class="para">
					LogicalMessageContext is passed to <code class="literal">Logical Handlers</code> at invocation time. LogicalMessageContext extends MessageContext with methods to obtain and modify the message payload, it does not provide access to the protocol specific aspects of a message. A protocol binding defines what component of a message are available via a logical message context. The SOAP binding defines that a logical handler deployed in a SOAP binding can access the contents of the SOAP body but not the SOAP headers whereas the XML/HTTP binding defines that a logical handler can access the entire XML payload of a message.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776750965728">
      ⁠</a>10.17.2.3. SOAP Message Context</h3></div></div></div><div class="para">
					SOAPMessageContext is passed to <code class="literal">SOAP handlers</code> at invocation time. SOAPMessageContext extends MessageContext with methods to obtain and modify the SOAP message payload.
				</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776698239056">
      ⁠</a>10.17.3. Fault Handling</h2></div></div></div><div class="para">
				An implementation may throw a SOAPFaultException
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">throwSoapFaultException</span>()
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   SOAPFactory factory = SOAPFactory.<span xmlns="" class="perl_Function">newInstance</span>();
<span xmlns="" class="line">​</span>   SOAPFault fault = factory.<span xmlns="" class="perl_Function">createFault</span>(<span xmlns="" class="perl_String">"this is a fault string!"</span>, <span xmlns="" class="perl_Keyword">new</span> QName(<span xmlns="" class="perl_String">"http://foo"</span>, <span xmlns="" class="perl_String">"FooCode"</span>));
<span xmlns="" class="line">​</span>   fault.<span xmlns="" class="perl_Function">setFaultActor</span>(<span xmlns="" class="perl_String">"mr.actor"</span>);
<span xmlns="" class="line">​</span>   fault.<span xmlns="" class="perl_Function">addDetail</span>().<span xmlns="" class="perl_Function">addChildElement</span>(<span xmlns="" class="perl_String">"test"</span>);
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">throw</span> <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">SOAPFaultException</span>(fault);
<span xmlns="" class="line">​</span>}
</pre><div class="para">
				or an application specific user exception
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">throwApplicationException</span>() <span xmlns="" class="perl_Keyword">throws</span> UserException
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">throw</span> <span xmlns="" class="perl_Keyword">new</span> UserException(<span xmlns="" class="perl_String">"validation"</span>, <span xmlns="" class="perl_Float">123</span>, <span xmlns="" class="perl_String">"Some validation error"</span>);
<span xmlns="" class="line">​</span>}
</pre><div class="para">
				<div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						In case of the latter JBossWS generates the required fault wrapper beans at runtime if they are not part of the deployment
					</div></div></div>

			</div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776684936672">
      ⁠</a>10.18. DataBinding</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776735015248">
      ⁠</a>10.18.1. Using JAXB with non annotated classes</h2></div></div></div><div class="para">
				JAXB is heavily driven by Java Annotations on the Java Bindings. It currently does not support an external binding configuration.
			</div><div class="para">
				In order to support this, we built on a JAXB RI feature whereby it allows you to specify a RuntimeInlineAnnotationReader implementation during JAXBContext creation (see JAXBRIContext).
			</div><div class="para">
				We call this feature "JAXB Annotation Introduction" and we've made it available for general consumption i.e. it can be checked out, built and used from SVN:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a href="http://anonsvn.jboss.org/repos/jbossws/projects/jaxbintros/">http://anonsvn.jboss.org/repos/jbossws/projects/jaxbintros/</a>
					</div></li></ul></div><div class="para">
				Complete documentation can be found here:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a href="http://wiki.jboss.org/wiki/Wiki.jsp?page=JAXBIntroductions">JAXB Introductions</a>
					</div></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776682434304">
      ⁠</a>10.19. Attachments</h1></div></div></div><div class="para">
			JBoss-WS4EE relied on a deprecated attachments technology called SwA (SOAP with Attachments). SwA required soap/encoding which is disallowed by the WS-I Basic Profile. JBossWS provides support for WS-I AP 1.0, and MTOM instead.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776682432800">
      ⁠</a>10.19.1. MTOM/XOP</h2></div></div></div><div class="para">
				This section describes Message Transmission Optimization Mechanism (MTOM) and XML-binary Optimized Packaging (XOP), a means of more efficiently serializing XML Infosets that have certain types of content. The related specifications are
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a href="http://www.w3.org/TR/soap12-mtom/">SOAP Message Transmission Optimization Mechanism (MTOM)</a>
					</div></li><li class="listitem"><div class="para">
						<a href="http://www.w3.org/TR/xop10/">XML-binary Optimized Packaging (XOP)</a>
					</div></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776748658112">
      ⁠</a>10.19.1.1. Supported MTOM parameter types</h3></div></div></div><div class="informaltable"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="c1"/><col width="50%" class="c2"/></colgroup><tbody><tr><td> <div class="para">
									image/jpeg
								</div>
								 </td><td> <div class="para">
									java.awt.Image
								</div>
								 </td></tr><tr><td> <div class="para">
									text/xml
								</div>
								 </td><td> <div class="para">
									javax.xml.transform.Source
								</div>
								 </td></tr><tr><td> <div class="para">
									application/xml
								</div>
								 </td><td> <div class="para">
									javax.xml.transform.Source
								</div>
								 </td></tr><tr><td> <div class="para">
									application/octet-stream
								</div>
								 </td><td> <div class="para">
									javax.activation.DataHandler
								</div>
								 </td></tr></tbody></table></div><div class="para">
					The above table shows a list of supported endpoint parameter types. The recommended approach is to use the <a href="http://java.sun.com/j2ee/1.4/docs/api/javax/activation/DataHandler.html">javax.activation.DataHandler</a> classes to represent binary data as service endpoint parameters.
				</div><div class="para">
					<div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							Microsoft endpoints tend to send any data as application/octet-stream. The only Java type that can easily cope with this ambiguity is javax.activation.DataHandler
						</div></div></div>

				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776698956464">
      ⁠</a>10.19.1.2. Enabling MTOM per endpoint</h3></div></div></div><div class="para">
					On the server side MTOM processing is enabled through the <code class="literal">@BindingType</code> annotation. JBossWS does handle SOAP1.1 and SOAP1.2. Both come with or without MTOM flavors:
				</div><div class="para">
					<span class="bold bold"><strong>MTOM enabled service implementations</strong></span>
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>package org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">test</span>.<span xmlns="" class="perl_Function">ws</span>.<span xmlns="" class="perl_Function">jaxws</span>.<span xmlns="" class="perl_Function">samples</span>.<span xmlns="" class="perl_Function">xop</span>.<span xmlns="" class="perl_Function">doclit</span>;
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.Remote;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.jws.WebService;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.jws.soap.SOAPBinding;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.xml.ws.BindingType;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>@Remote
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">WebService</span>(targetNamespace = <span xmlns="" class="perl_String">"http://org.jboss.ws/xop/doclit"</span>)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">SOAPBinding</span>(style = SOAPBinding.<span xmlns="" class="perl_Function">Style</span>.<span xmlns="" class="perl_Function">DOCUMENT</span>, parameterStyle = SOAPBinding.<span xmlns="" class="perl_Function">ParameterStyle</span>.<span xmlns="" class="perl_Function">BARE</span>)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">BindingType</span>(value=<span xmlns="" class="perl_String">"http://schemas.xmlsoap.org/wsdl/soap/http?mtom=true"</span>)                         (<span xmlns="" class="perl_Float">1</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">interface</span> MTOMEndpoint
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>}</pre><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
							The MTOM enabled SOAP 1.1 binding ID
						</div></li></ol></div><div class="para">
					<span class="bold bold"><strong>MTOM enabled clients</strong></span>
				</div><div class="para">
					Web service clients can use the same approach described above or rely on the <code class="literal">Binding</code> API to enable MTOM (Excerpt taken from the <code class="literal">org.jboss.test.ws.jaxws.samples.xop.doclit.XOPTestCase</code>):
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>Service service = Service.<span xmlns="" class="perl_Function">create</span>(wsdlURL, serviceName);
<span xmlns="" class="line">​</span>port = service.<span xmlns="" class="perl_Function">getPort</span>(MTOMEndpoint.<span xmlns="" class="perl_Function">class</span>);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">// enable MTOM</span>
<span xmlns="" class="line">​</span>binding = (SOAPBinding)((BindingProvider)port).<span xmlns="" class="perl_Function">getBinding</span>();
<span xmlns="" class="line">​</span>binding.<span xmlns="" class="perl_Function">setMTOMEnabled</span>(<span xmlns="" class="perl_Keyword">true</span>);
</pre><div class="para">
					<div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							Use the JBossWS configuration templates to setup deployment defaults.
						</div></div></div>

				</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776727886768">
      ⁠</a>10.19.2. SwaRef</h2></div></div></div><div class="para">
				<a href="http://www.ws-i.org/Profiles/AttachmentsProfile-1.0-2004-08-24.html">WS-I Attachment Profile 1.0</a> defines mechanism to reference MIME attachment parts using <a href="http://www.ws-i.org/Profiles/AttachmentsProfile-1.0-2004-08-24.html#Referencing_Attachments_from_the_SOAP_Envelope">swaRef</a>. In this mechanism the content of XML element of type wsi:swaRef is sent as MIME attachment and the element inside SOAP Body holds the reference to this attachment in the CID URI scheme as defined by <a href="http://www.ietf.org/rfc/rfc2111.txt">RFC 2111</a>.
			</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776731662288">
      ⁠</a>10.19.2.1. Using SwaRef with JAX-WS endpoints</h3></div></div></div><div class="para">
					JAX-WS endpoints delegate all marshaling/unmarshaling to the JAXB API. The most simple way to enable SwaRef encoding for <code class="literal">DataHandler</code> types is to annotate a payload bean with the <code class="literal">@XmlAttachmentRef</code> annotation as shown below:
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * Payload bean that will use SwaRef encoding</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span>@XmlRootElement
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> DocumentPayload
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">private</span> DataHandler data;
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Function">DocumentPayload</span>()
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Function">DocumentPayload</span>(DataHandler data)
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">data</span> = data;
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   @XmlElement
<span xmlns="" class="line">​</span>   @XmlAttachmentRef
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> DataHandler <span xmlns="" class="perl_Function">getData</span>()
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">return</span> data;
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">setData</span>(DataHandler data)
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">data</span> = data;
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}</pre><div class="para">
					With document wrapped endpoints you may even specify the <code class="literal">@XmlAttachmentRef</code> annotation on the service endpoint interface:
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@WebService
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">interface</span> DocWrappedEndpoint
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   DocumentPayload <span xmlns="" class="perl_Function">beanAnnotation</span>(DocumentPayload dhw, String test);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   @XmlAttachmentRef
<span xmlns="" class="line">​</span>   DataHandler <span xmlns="" class="perl_Function">parameterAnnotation</span>(@XmlAttachmentRef DataHandler data, String test);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>}</pre><div class="para">
					The message would then refer to the attachment part by CID:
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Envelope</span><span xmlns="" class="perl_Others"> xmlns:env=</span><span xmlns="" class="perl_String">'http://schemas.xmlsoap.org/soap/envelope/'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;env:Header/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;env:Body&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;ns2:parameterAnnotation</span><span xmlns="" class="perl_Others"> xmlns:ns2=</span><span xmlns="" class="perl_String">'http://swaref.samples.jaxws.ws.test.jboss.org/'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;arg0&gt;</span>cid:0-1180017772935-32455963@ws.jboss.org<span xmlns="" class="perl_Keyword">&lt;/arg0&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;arg1&gt;</span>Wrapped test<span xmlns="" class="perl_Keyword">&lt;/arg1&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/ns2:parameterAnnotation&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/env:Body&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Envelope&gt;</span>
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776689918736">
      ⁠</a>10.19.2.2. Starting from WSDL</h3></div></div></div><div class="para">
					If you chose the contract first approach then you need to ensure that any element declaration that should use SwaRef encoding simply refers to wsi:swaRef schema type:
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;element</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"data"</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"wsi:swaRef"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">xmlns:wsi=</span><span xmlns="" class="perl_String">"http://ws-i.org/profiles/basic/1.1/xsd"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
					Any wsi:swaRef schema type would then be mapped to DataHandler.
				</div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776756517968">
      ⁠</a>10.20. Tools</h1></div></div></div><div class="para">
			The JAX-WS tools provided by JBossWS can be used in a variety of ways. First we will look at server-side development strategies, and then proceed to the client. When developing a Web Service Endpoint (the server-side) you have the option of starting from Java (bottom-up development), or from the abstract contract (WSDL) that defines your service (top-down development). If this is a new service (no existing contract), the bottom-up approach is the fastest route; you only need to add a few annotations to your classes to get a service up and running. However, if you are developing a service with an already defined contract, it is far simpler to use the top-down approach, since the provided tool will generate the annotated code for you.
		</div><div class="para">
			Bottom-up use cases:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					Exposing an already existing EJB3 bean as a Web Service
				</div></li><li class="listitem"><div class="para">
					Providing a new service, and you want the contract to be generated for you
				</div></li></ul></div><div class="para">
			Top-down use cases:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					Replacing the implementation of an existing Web Service without breaking compatibility with older clients
				</div></li><li class="listitem"><div class="para">
					Exposing a service that conforms to a contract specified by a third party (e.g. a vendor that calls you back using an already defined protocol).
				</div></li><li class="listitem"><div class="para">
					Creating a service that adheres to the XML Schema and WSDL you developed by hand up front
				</div></li></ul></div><div class="para">
			The following JAX-WS command line tools are included in JBossWS:
		</div><div class="informaltable"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols lt-7-rows"><colgroup><col width="50%" class="c1"/><col width="50%" class="c2"/></colgroup><thead><tr><th> <div class="para">
							<span class="bold bold"><strong>Command</strong></span>
						</div>
						 </th><th> <div class="para">
							<span class="bold bold"><strong>Description</strong></span>
						</div>
						 </th></tr></thead><tbody><tr><td> <div class="para">
							<a href="http://www.jboss.org/community/wiki/JBossWS-wsprovide">wsprovide</a>
						</div>
						 </td><td> <div class="para">
							Generates JAX-WS portable artifacts, and provides the abstract contract. Used for bottom-up development.
						</div>
						 </td></tr><tr><td> <div class="para">
							<a href="http://www.jboss.org/community/wiki/JBossWS-wsconsume">wsconsume</a>
						</div>
						 </td><td> <div class="para">
							Consumes the abstract contract (WSDL and Schema files), and produces artifacts for both a server and client. Used for top-down and client development
						</div>
						 </td></tr><tr><td> <div class="para">
							<a href="http://www.jboss.org/community/wiki/JBossWS-wsrunclient">wsrunclient</a>
						</div>
						 </td><td> <div class="para">
							Executes a Java client (that has a main method) using the JBossWS classpath.
						</div>
						 </td></tr></tbody></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776735576800">
      ⁠</a>10.20.1. Bottom-Up (Using wsprovide)</h2></div></div></div><div class="para">
				The bottom-up strategy involves developing the Java code for your service, and then annotating it using JAX-WS annotations. These annotations can be used to customize the contract that is generated for your service. For example, you can change the operation name to map to anything you like. However, all of the annotations have sensible defaults, so only the @WebService annotation is required.
			</div><div class="para">
				This can be as simple as creating a single class:
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>package echo;
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>@javax.<span xmlns="" class="perl_Function">jws</span>.<span xmlns="" class="perl_Function">WebService</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> Echo
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">echo</span>(String input)
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">return</span> input;
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}
</pre><div class="para">
				A JSE or EJB3 deployment can be built using this class, and it is the only Java code needed to deploy on JBossWS. The WSDL, and all other Java artifacts called "wrapper classes" will be generated for you at deploy time. This actually goes beyond the JAX-WS specification, which requires that wrapper classes be generated using an offline tool. The reason for this requirement is purely a vendor implementation problem, and since we do not believe in burdening a developer with a bunch of additional steps, we generate these as well. However, if you want your deployment to be portable to other application servers, you will need to use a tool and add the generated classes to your deployment.
			</div><div class="para">
				This is the primary purpose of the <a href="http://www.jboss.org/community/wiki/JBossWS-wsprovide">wsprovide</a> tool, to generate portable JAX-WS artifacts. Additionally, it can be used to "provide" the abstract contract (WSDL file) for your service. This can be obtained by invoking <a href="http://www.jboss.org/community/wiki/JBossWS-wsprovide">wsprovide</a> using the "-w" option:
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>$ javac -d . -classpath jboss-jaxws.<span xmlns="" class="perl_Function">jar</span> Echo.<span xmlns="" class="perl_Function">java</span>
<span xmlns="" class="line">​</span>$ wsprovide -w echo.<span xmlns="" class="perl_Function">Echo</span>
<span xmlns="" class="line">​</span>Generating WSDL:
<span xmlns="" class="line">​</span>EchoService.<span xmlns="" class="perl_Function">wsdl</span>
<span xmlns="" class="line">​</span>Writing Classes:
<span xmlns="" class="line">​</span>echo/jaxws/Echo.<span xmlns="" class="perl_Function">class</span>
<span xmlns="" class="line">​</span>echo/jaxws/EchoResponse.<span xmlns="" class="perl_Function">class</span>
</pre><div class="para">
				Inspecting the WSDL reveals a service called EchoService:
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;service</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'EchoService'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;port</span><span xmlns="" class="perl_Others"> binding=</span><span xmlns="" class="perl_String">'tns:EchoBinding'</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'EchoPort'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;soap:address</span><span xmlns="" class="perl_Others"> location=</span><span xmlns="" class="perl_String">'REPLACE_WITH_ACTUAL_URL'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/port&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/service&gt;</span></pre><div class="para">
				As expected, this service defines one operation, "echo":
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;portType</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'Echo'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;operation</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'echo'</span><span xmlns="" class="perl_Others"> parameterOrder=</span><span xmlns="" class="perl_String">'echo'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;input</span><span xmlns="" class="perl_Others"> message=</span><span xmlns="" class="perl_String">'tns:Echo_echo'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;output</span><span xmlns="" class="perl_Others"> message=</span><span xmlns="" class="perl_String">'tns:Echo_echoResponse'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/operation&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/portType&gt;</span></pre><div class="para">
				<div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						Remember that <span class="bold bold"><strong>when deploying on JBossWS you do not need to run this tool.</strong></span> You only need it for generating portable artifacts and/or the abstract contract for your service.
					</div></div></div>

			</div><div class="para">
				Let us create a POJO endpoint for deployment on JBoss Enterprise Application Platform. A simple <code class="filename">web.xml</code> needs to be created:
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;web-app</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://java.sun.com/xml/ns/j2ee"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">version=</span><span xmlns="" class="perl_String">"2.4"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;servlet&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>Echo<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;servlet-class&gt;</span>echo.Echo<span xmlns="" class="perl_Keyword">&lt;/servlet-class&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/servlet&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;servlet-mapping&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>Echo<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;url-pattern&gt;</span>/Echo<span xmlns="" class="perl_Keyword">&lt;/url-pattern&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/servlet-mapping&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/web-app&gt;</span>
</pre><div class="para">
				The <code class="filename">web.xml</code> and the single class can now be used to create a WAR:
			</div><pre class="screen">
$ mkdir -p WEB-INF/classes
$ cp -rp echo WEB-INF/classes/
$ cp web.xml WEB-INF
$ jar cvf echo.war WEB-INF
added manifest
adding: WEB-INF/(in = 0) (out= 0)(stored 0%)
adding: WEB-INF/classes/(in = 0) (out= 0)(stored 0%)
adding: WEB-INF/classes/echo/(in = 0) (out= 0)(stored 0%)
adding: WEB-INF/classes/echo/Echo.class(in = 340) (out= 247)(deflated 27%)
adding: WEB-INF/web.xml(in = 576) (out= 271)(deflated 52%)
</pre><div class="para">
				The war can then be deployed:
			</div><pre class="programlisting">
 cp echo.war &lt;JBOSS_HOME&gt;/server/default/deploy
</pre><div class="para">
				At deploy time JBossWS will internally invoke <a href="http://www.jboss.org/community/wiki/JBossWS-wsprovide">wsprovide</a>, which will generate the WSDL. If deployment was successful, and you are using the default settings, it should be available here: <a href="http://localhost:8080/echo/Echo?wsdl">http://localhost:8080/echo/Echo?wsdl</a>
			</div><div class="para">
				For a portable JAX-WS deployment, the wrapper classes generated earlier could be added to the deployment.
			</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776757991920">
      ⁠</a>10.20.2. Top-Down (Using wsconsume)</h2></div></div></div><div class="para">
				The top-down development strategy begins with the abstract contract for the service, which includes the WSDL file and zero or more schema files. The <a href="http://www.jboss.org/community/wiki/JBossWS-wsconsume">wsconsume</a> tool is then used to consume this contract, and produce annotated Java classes (and optionally sources) that define it.
			</div><div class="para">
				<div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						wsconsume seems to have a problem with symlinks on unix systems
					</div></div></div>

			</div><div class="para">
				Using the WSDL file from the bottom-up example, a new Java implementation that adheres to this service can be generated. The "-k" option is passed to <a href="http://www.jboss.org/community/wiki/JBossWS-wsconsume">wsconsume</a> to preserve the Java source files that are generated, instead of providing just classes:
			</div><pre class="programlisting">
  
$ wsconsume -k EchoService.wsdl
echo/Echo.java
echo/EchoResponse.java
echo/EchoService.java
echo/Echo_Type.java
echo/ObjectFactory.java
echo/package-info.java
echo/Echo.java
echo/EchoResponse.java
echo/EchoService.java
echo/Echo_Type.java
echo/ObjectFactory.java
echo/package-info.java
</pre><div class="para">
				The following table shows the purpose of each generated file:
			</div><div class="informaltable"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-7-rows"><colgroup><col width="50%" class="c1"/><col width="50%" class="c2"/></colgroup><tbody><tr><td> <div class="para">
								<span class="bold bold"><strong>File</strong></span>
							</div>
							 </td><td> <div class="para">
								<span class="bold bold"><strong>Purpose</strong></span>
							</div>
							 </td></tr><tr><td> <div class="para">
								Echo.java
							</div>
							 </td><td> <div class="para">
								Service Endpoint Interface
							</div>
							 </td></tr><tr><td> <div class="para">
								Echo_Type.java
							</div>
							 </td><td> <div class="para">
								Wrapper bean for request message
							</div>
							 </td></tr><tr><td> <div class="para">
								EchoResponse.java
							</div>
							 </td><td> <div class="para">
								Wrapper bean for response message
							</div>
							 </td></tr><tr><td> <div class="para">
								ObjectFactory.java
							</div>
							 </td><td> <div class="para">
								JAXB XML Registry
							</div>
							 </td></tr><tr><td> <div class="para">
								package-info.java
							</div>
							 </td><td> <div class="para">
								Holder for JAXB package annotations
							</div>
							 </td></tr><tr><td> <div class="para">
								EchoService.java
							</div>
							 </td><td> <div class="para">
								Used only by JAX-WS clients
							</div>
							 </td></tr></tbody></table></div><div class="para">
				Examining the Service Endpoint Interface reveals annotations that are more explicit than in the class written by hand in the bottom-up example, however, these evaluate to the same contract:
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">WebService</span>(name = <span xmlns="" class="perl_String">"Echo"</span>, targetNamespace = <span xmlns="" class="perl_String">"http://echo/"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">interface</span> Echo
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   @<span xmlns="" class="perl_Function">WebResult</span>(targetNamespace = <span xmlns="" class="perl_String">""</span>)
<span xmlns="" class="line">​</span>   @<span xmlns="" class="perl_Function">RequestWrapper</span>(localName = <span xmlns="" class="perl_String">"echo"</span>, targetNamespace = <span xmlns="" class="perl_String">"http://echo/"</span>, className = <span xmlns="" class="perl_String">"echo.Echo_Type"</span>)
<span xmlns="" class="line">​</span>   @<span xmlns="" class="perl_Function">ResponseWrapper</span>(localName = <span xmlns="" class="perl_String">"echoResponse"</span>, targetNamespace = <span xmlns="" class="perl_String">"http://echo/"</span>, className = <span xmlns="" class="perl_String">"echo.EchoResponse"</span>)
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">echo</span>(@<span xmlns="" class="perl_Function">WebParam</span>(name = <span xmlns="" class="perl_String">"arg0"</span>, targetNamespace = <span xmlns="" class="perl_String">""</span>) String arg0);
<span xmlns="" class="line">​</span>}</pre><div class="para">
				The only missing piece (besides the packaging) is the implementation class, which can now be written using the above interface.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>package echo;
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>@javax.<span xmlns="" class="perl_Function">jws</span>.<span xmlns="" class="perl_Function">WebService</span>(endpointInterface=<span xmlns="" class="perl_String">"echo.Echo"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> EchoImpl <span xmlns="" class="perl_Keyword">implements</span> Echo
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">echo</span>(String arg0)
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">return</span> arg0;
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}
</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776697271728">
      ⁠</a>10.20.3. Client Side</h2></div></div></div><div class="para">
				Before going into detail on the client-side it is important to understand the decoupling concept that is central to Web Services. Web Services are not the best fit for internal RPC, even though they can be used in this way; there are much better technologies for achieving this (CORBA, and RMI for example). Web Services were designed specifically for interoperable coarse-grained correspondence. There is no expectation or guarantee that any party participating in a Web Service interaction will be at any particular location, running on any particular operating system, or written in any particular programming language. So because of this, it is important to clearly separate client and server implementations. The only thing they should have in common is the abstract contract definition. If, for whatever reason, your software does not adhere to this principal, then you should not be using Web Services. For the above reasons, the <span class="bold bold"><strong><span class="emphasis"><em>recommended methodology for developing a client is</em></span></strong></span> to follow <span class="bold bold"><strong><span class="emphasis"><em>the top-down approach</em></span></strong></span>, even if the client is running on the same server.
			</div><div class="para">
				Let us repeat the process of the top-down section, although using the deployed WSDL, instead of the one generated offline by <a href="http://www.jboss.org/community/wiki/JBossWS-wsprovide">wsprovide</a>. The reason why we do this is just to get the right value for soap:address. This value must be computed at deploy time, since it is based on container configuration specifics. You could of course edit the WSDL file yourself, although you need to ensure that the path is correct.
			</div><div class="para">
				Offline version:
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;service</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'EchoService'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;port</span><span xmlns="" class="perl_Others"> binding=</span><span xmlns="" class="perl_String">'tns:EchoBinding'</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">'EchoPort'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;soap:address</span><span xmlns="" class="perl_Others"> location=</span><span xmlns="" class="perl_String">'REPLACE_WITH_ACTUAL_URL'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/port&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/service&gt;</span></pre><div class="para">
				Online version:
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;service</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"EchoService"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;port</span><span xmlns="" class="perl_Others"> binding=</span><span xmlns="" class="perl_String">"tns:EchoBinding"</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"EchoPort"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;soap:address</span><span xmlns="" class="perl_Others"> location=</span><span xmlns="" class="perl_String">"http://localhost.localdomain:8080/echo/Echo"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/port&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/service&gt;</span></pre><div class="para">
				Using the online deployed version with <a href="http://www.jboss.org/community/wiki/JBossWS-wsconsume">wsconsume</a>:
			</div><pre class="programlisting">
$ wsconsume -k http://localhost:8080/echo/Echo?wsdl
echo/Echo.java
echo/EchoResponse.java
echo/EchoService.java
echo/Echo_Type.java
echo/ObjectFactory.java
echo/package-info.java
echo/Echo.java
echo/EchoResponse.java
echo/EchoService.java
echo/Echo_Type.java
echo/ObjectFactory.java
echo/package-info.java</pre><div class="para">
				The one class that was not examined in the top-down section, was <code class="filename">EchoService.java</code>. Notice how it stores the location the WSDL was obtained from.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">WebServiceClient</span>(name = <span xmlns="" class="perl_String">"EchoService"</span>, targetNamespace = <span xmlns="" class="perl_String">"http://echo/"</span>, wsdlLocation = <span xmlns="" class="perl_String">"http://localhost:8080/echo/Echo?wsdl"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> EchoService <span xmlns="" class="perl_Keyword">extends</span> Service
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">final</span> <span xmlns="" class="perl_DataType">static</span> URL ECHOSERVICE_WSDL_LOCATION;
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_DataType">static</span>
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      URL url = <span xmlns="" class="perl_Keyword">null</span>;
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">try</span>
<span xmlns="" class="line">​</span>      {
<span xmlns="" class="line">​</span>         url = <span xmlns="" class="perl_Keyword">new</span> URL(<span xmlns="" class="perl_String">"http://localhost:8080/echo/Echo?wsdl"</span>);
<span xmlns="" class="line">​</span>      }
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">catch</span> (MalformedURLException e)
<span xmlns="" class="line">​</span>      {
<span xmlns="" class="line">​</span>         e.<span xmlns="" class="perl_Function">printStackTrace</span>();
<span xmlns="" class="line">​</span>      }
<span xmlns="" class="line">​</span>      ECHOSERVICE_WSDL_LOCATION = url;
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Function">EchoService</span>(URL wsdlLocation, QName serviceName)
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">super</span>(wsdlLocation, serviceName);
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Function">EchoService</span>()
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">super</span>(ECHOSERVICE_WSDL_LOCATION, <span xmlns="" class="perl_Keyword">new</span> QName(<span xmlns="" class="perl_String">"http://echo/"</span>, <span xmlns="" class="perl_String">"EchoService"</span>));
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   @<span xmlns="" class="perl_Function">WebEndpoint</span>(name = <span xmlns="" class="perl_String">"EchoPort"</span>)
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> Echo <span xmlns="" class="perl_Function">getEchoPort</span>()
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">return</span> (Echo)<span xmlns="" class="perl_Keyword">super</span>.<span xmlns="" class="perl_Function">getPort</span>(<span xmlns="" class="perl_Keyword">new</span> QName(<span xmlns="" class="perl_String">"http://echo/"</span>, <span xmlns="" class="perl_String">"EchoPort"</span>), Echo.<span xmlns="" class="perl_Function">class</span>);
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}</pre><div class="para">
				As you can see, this generated class extends the main client entry point in JAX-WS, <code class="classname">javax.xml.ws.Service</code>. While you can use <code class="classname">Service</code> directly, this is far simpler since it provides the configuration info for you. The only method we really care about is the <code class="methodname">getEchoPort()</code> method, which returns an instance of our <code class="classname">Service Endpoint Interface</code>. Any Web Services operation can then be called by just invoking a method on the returned interface.
			</div><div class="para">
				<div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						It is not recommended to refer to a remote WSDL URL in a production application. This causes network I/O every time you instantiate the Service Object. Instead, use the tool on a saved local copy, or use the URL version of the constructor to provide a new WSDL location.
					</div></div></div>
				 <div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						The wsdlLocation is used when creating the Service to be used by clients and will be added to the @WebServiceClient annotation, for an endpoint implementation based on the generated service endpoint interface you will need to manually add the wsdlLocation to the @WebService annotation on your web service implementation and not the service endpoint interface.
					</div></div></div>

			</div><div class="para">
				All that is left to do, is write and compile the client:
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import echo.*;</span>
<span xmlns="" class="line">​</span>..
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> EchoClient
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">static</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">main</span>(String args[])
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">if</span> (args.<span xmlns="" class="perl_Function">length</span> != <span xmlns="" class="perl_Float">1</span>)
<span xmlns="" class="line">​</span>      {
<span xmlns="" class="line">​</span>         System.<span xmlns="" class="perl_Function">err</span>.<span xmlns="" class="perl_Function">println</span>(<span xmlns="" class="perl_String">"usage: EchoClient &lt;message&gt;"</span>);
<span xmlns="" class="line">​</span>         System.<span xmlns="" class="perl_Function">exit</span>(<span xmlns="" class="perl_Float">1</span>);
<span xmlns="" class="line">​</span>      }
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>      EchoService service = <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">EchoService</span>();
<span xmlns="" class="line">​</span>      Echo echo = service.<span xmlns="" class="perl_Function">getEchoPort</span>();
<span xmlns="" class="line">​</span>      System.<span xmlns="" class="perl_Function">out</span>.<span xmlns="" class="perl_Function">println</span>(<span xmlns="" class="perl_String">"Server said: "</span> + echo.<span xmlns="" class="perl_Function">echo</span>(args[<span xmlns="" class="perl_Float">0</span>]));
<span xmlns="" class="line">​</span>   } 
<span xmlns="" class="line">​</span>}</pre><div class="para">
				It can then be easily executed using the <a href="http://www.jboss.org/community/wiki/JBossWS-wsrunclient">wsrunclient</a> tool. This is just a convenience tool that invokes java with the needed classpath:
			</div><pre class="programlisting">
$ wsrunclient EchoClient 'Hello World!'
Server said: Hello World!
</pre><div class="para">
				It is easy to change the endpoint address of your operation at runtime, setting <span class="property">ENDPOINT_ADDRESS_PROPERTY</span> as shown below:
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>EchoService service = <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">EchoService</span>();
<span xmlns="" class="line">​</span>Echo echo = service.<span xmlns="" class="perl_Function">getEchoPort</span>();
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/* Set NEW Endpoint Location */</span>
<span xmlns="" class="line">​</span>String endpointURL = <span xmlns="" class="perl_String">"http://NEW_ENDPOINT_URL"</span>;
<span xmlns="" class="line">​</span>BindingProvider bp = (BindingProvider)echo;
<span xmlns="" class="line">​</span>bp.<span xmlns="" class="perl_Function">getRequestContext</span>().<span xmlns="" class="perl_Function">put</span>(BindingProvider.<span xmlns="" class="perl_Function">ENDPOINT_ADDRESS_PROPERTY</span>, endpointURL);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>System.<span xmlns="" class="perl_Function">out</span>.<span xmlns="" class="perl_Function">println</span>(<span xmlns="" class="perl_String">"Server said: "</span> + echo.<span xmlns="" class="perl_Function">echo</span>(args[<span xmlns="" class="perl_Float">0</span>]));
<span xmlns="" class="line">​</span>...</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776755920432">
      ⁠</a>10.20.4. Command-line &amp; Ant Task Reference</h2></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a href="http://www.jboss.org/community/wiki/JBossWS-wsconsume">wsconsume reference page</a>
					</div></li><li class="listitem"><div class="para">
						<a href="http://www.jboss.org/community/wiki/JBossWS-wsprovide">wsprovide reference page</a>
					</div></li><li class="listitem"><div class="para">
						<a href="http://www.jboss.org/community/wiki/JBossWS-wsrunclient">wsrunclient reference page</a>
					</div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776755641344">
      ⁠</a>10.20.5. JAX-WS binding customization</h2></div></div></div><div class="para">
				An introduction to binding customizations:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a href="http://java.sun.com/webservices/docs/2.0/jaxws/customizations.html">http://java.sun.com/webservices/docs/2.0/jaxws/customizations.html</a>
					</div></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776764401824">
      ⁠</a>10.21. Web Service Extensions</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776756528048">
      ⁠</a>10.21.1. WS-Addressing</h2></div></div></div><div class="para">
				This section describes how <a href="http://www.w3.org/TR/ws-addr-core">WS-Addressing</a> can be used to provide a stateful service endpoint.
			</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776756526000">
      ⁠</a>10.21.1.1. Specifications</h3></div></div></div><div class="para">
					WS-Addressing is defined by a combination of the following specifications from the W3C Recommendation. The WS-Addressing API is standardized by <a href="http://www.jcp.org/en/jsr/detail?id=224">JSR-224 - Java API for XML-Based Web Services (JAX-WS)</a>
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							<a href="http://www.w3.org/TR/ws-addr-core">Web Services Addressing 1.0 - Core</a>
						</div></li><li class="listitem"><div class="para">
							<a href="http://www.w3.org/TR/ws-addr-soap">Web Services Addressing 1.0 - SOAP Binding</a>
						</div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776697936000">
      ⁠</a>10.21.1.2. Addressing Endpoint</h3></div></div></div><div class="para">
					<div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong> Note </strong></p></div><div class="admonition"><div class="para">
							The following information should not be used in conjunction with JBoss Web Services CXF Stack.
						</div></div></div>

				</div><div class="para">
					The following endpoint implementation has a set of operation for a typical stateful shopping chart application.
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">WebService</span>(name = <span xmlns="" class="perl_String">"StatefulEndpoint"</span>, targetNamespace = <span xmlns="" class="perl_String">"http://org.jboss.ws/samples/wsaddressing"</span>, serviceName = <span xmlns="" class="perl_String">"TestService"</span>)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Addressing</span>(enabled=<span xmlns="" class="perl_Keyword">true</span>, required=<span xmlns="" class="perl_Keyword">true</span>)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">SOAPBinding</span>(style = SOAPBinding.<span xmlns="" class="perl_Function">Style</span>.<span xmlns="" class="perl_Function">RPC</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> StatefulEndpointImpl <span xmlns="" class="perl_Keyword">implements</span> StatefulEndpoint, ServiceLifecycle
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">addItem</span>(String item)
<span xmlns="" class="line">​</span>   { <span xmlns="" class="perl_Keyword">... </span>}
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">checkout</span>()
<span xmlns="" class="line">​</span>   { <span xmlns="" class="perl_Keyword">... </span>}
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   @WebMethod
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">getItems</span>()
<span xmlns="" class="line">​</span>   { <span xmlns="" class="perl_Keyword">... </span>}
<span xmlns="" class="line">​</span>}</pre><div class="para">
					It uses the JAX-WS 2.1 defined <code class="literal">javax.xml.ws.soap.Addressing</code> annotation to enable the server side addressing handler.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776756126848">
      ⁠</a>10.21.1.3. Addressing Client</h3></div></div></div><div class="para">
					The client code uses <code class="literal">javax.xml.ws.soap.AddressingFeature</code> feature from JAX-WS 2.1 API to enable the WS-Addressing.
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>Service service = Service.<span xmlns="" class="perl_Function">create</span>(wsdlURL, serviceName);
<span xmlns="" class="line">​</span>port1 = (StatefulEndpoint)service.<span xmlns="" class="perl_Function">getPort</span>(StatefulEndpoint.<span xmlns="" class="perl_Function">class</span>,  <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">AddressingFeature</span>());
</pre><div class="para">
					<span class="bold bold"><strong>A client connecting to the stateful endpoint</strong></span>
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> AddressingStatefulTestCase <span xmlns="" class="perl_Keyword">extends</span> JBossWSTest
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   ...
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">testAddItem</span>() <span xmlns="" class="perl_Keyword">throws</span> Exception
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      port1.<span xmlns="" class="perl_Function">addItem</span>(<span xmlns="" class="perl_String">"Ice Cream"</span>);
<span xmlns="" class="line">​</span>      port1.<span xmlns="" class="perl_Function">addItem</span>(<span xmlns="" class="perl_String">"Ferrari"</span>);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>      port2.<span xmlns="" class="perl_Function">addItem</span>(<span xmlns="" class="perl_String">"Mars Bar"</span>);
<span xmlns="" class="line">​</span>      port2.<span xmlns="" class="perl_Function">addItem</span>(<span xmlns="" class="perl_String">"Porsche"</span>);
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">testGetItems</span>() <span xmlns="" class="perl_Keyword">throws</span> Exception
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      String items1 = port1.<span xmlns="" class="perl_Function">getItems</span>();
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Function">assertEquals</span>(<span xmlns="" class="perl_String">"[Ice Cream, Ferrari]"</span>, items1);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>      String items2 = port2.<span xmlns="" class="perl_Function">getItems</span>();
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Function">assertEquals</span>(<span xmlns="" class="perl_String">"[Mars Bar, Porsche]"</span>, items2);
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}</pre><div class="para">
					<span class="bold bold"><strong>SOAP message exchange</strong></span>
				</div><div class="para">
					Below you see the SOAP messages that are being exchanged.
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Envelope</span><span xmlns="" class="perl_Others"> xmlns:env=</span><span xmlns="" class="perl_String">'http://schemas.xmlsoap.org/soap/envelope/'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Header</span><span xmlns="" class="perl_Others"> xmlns:wsa=</span><span xmlns="" class="perl_String">'http://schemas.xmlsoap.org/ws/2004/08/addressing'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;wsa:To&gt;</span>uri:jbossws-samples-wsaddr/TestService<span xmlns="" class="perl_Keyword">&lt;/wsa:To&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;wsa:Action&gt;</span>http://org.jboss.ws/addressing/stateful/action<span xmlns="" class="perl_Keyword">&lt;/wsa:Action&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;wsa:ReferenceParameters&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ns1:clientid</span><span xmlns="" class="perl_Others"> xmlns:ns1=</span><span xmlns="" class="perl_String">'http://somens'</span><span xmlns="" class="perl_Keyword">&gt;</span>clientid-1<span xmlns="" class="perl_Keyword">&lt;/ns1:clientid&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/wsa:ReferenceParameters&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Header&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Body&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ns1:addItem</span><span xmlns="" class="perl_Others"> xmlns:ns1=</span><span xmlns="" class="perl_String">'http://org.jboss.ws/samples/wsaddr'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;String_1&gt;</span>Ice Cream<span xmlns="" class="perl_Keyword">&lt;/String_1&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/ns1:addItem&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Body&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Envelope&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Envelope</span><span xmlns="" class="perl_Others"> xmlns:env=</span><span xmlns="" class="perl_String">'http://schemas.xmlsoap.org/soap/envelope/'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Header</span><span xmlns="" class="perl_Others"> xmlns:wsa=</span><span xmlns="" class="perl_String">'http://schemas.xmlsoap.org/ws/2004/08/addressing'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;wsa:To&gt;</span>http://www.w3.org/2005/08/addressing/anonymous<span xmlns="" class="perl_Keyword">&lt;/wsa:To&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;wsa:Action&gt;</span>http://org.jboss.ws/addressing/stateful/actionReply<span xmlns="" class="perl_Keyword">&lt;/wsa:Action&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ns1:clientid</span><span xmlns="" class="perl_Others"> xmlns:ns1=</span><span xmlns="" class="perl_String">'http://somens'</span><span xmlns="" class="perl_Keyword">&gt;</span>clientid-1<span xmlns="" class="perl_Keyword">&lt;/ns1:clientid&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Header&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Body&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ns1:addItemResponse</span><span xmlns="" class="perl_Others"> xmlns:ns1=</span><span xmlns="" class="perl_String">'http://org.jboss.ws/samples/wsaddr'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Body&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Envelope&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Envelope</span><span xmlns="" class="perl_Others"> xmlns:env=</span><span xmlns="" class="perl_String">'http://schemas.xmlsoap.org/soap/envelope/'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Header</span><span xmlns="" class="perl_Others"> xmlns:wsa=</span><span xmlns="" class="perl_String">'http://schemas.xmlsoap.org/ws/2004/08/addressing'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;wsa:To&gt;</span>uri:jbossws-samples-wsaddr/TestService<span xmlns="" class="perl_Keyword">&lt;/wsa:To&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;wsa:Action&gt;</span>http://org.jboss.ws/addressing/stateful/action<span xmlns="" class="perl_Keyword">&lt;/wsa:Action&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;wsa:ReferenceParameters&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ns1:clientid</span><span xmlns="" class="perl_Others"> xmlns:ns1=</span><span xmlns="" class="perl_String">'http://somens'</span><span xmlns="" class="perl_Keyword">&gt;</span>clientid-1<span xmlns="" class="perl_Keyword">&lt;/ns1:clientid&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/wsa:ReferenceParameters&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Header&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Body&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ns1:getItems</span><span xmlns="" class="perl_Others"> xmlns:ns1=</span><span xmlns="" class="perl_String">'http://org.jboss.ws/samples/wsaddr'</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Body&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Envelope&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Envelope</span><span xmlns="" class="perl_Others"> xmlns:env=</span><span xmlns="" class="perl_String">'http://schemas.xmlsoap.org/soap/envelope/'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Header</span><span xmlns="" class="perl_Others"> xmlns:wsa=</span><span xmlns="" class="perl_String">'http://schemas.xmlsoap.org/ws/2004/08/addressing'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;wsa:To&gt;</span>http://www.w3.org/2005/08/addressing/anonymous<span xmlns="" class="perl_Keyword">&lt;/wsa:To&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;wsa:Action&gt;</span>http://org.jboss.ws/addressing/stateful/actionReply<span xmlns="" class="perl_Keyword">&lt;/wsa:Action&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ns1:clientid</span><span xmlns="" class="perl_Others"> xmlns:ns1=</span><span xmlns="" class="perl_String">'http://somens'</span><span xmlns="" class="perl_Keyword">&gt;</span>clientid-1<span xmlns="" class="perl_Keyword">&lt;/ns1:clientid&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Header&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Body&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ns1:getItemsResponse</span><span xmlns="" class="perl_Others"> xmlns:ns1=</span><span xmlns="" class="perl_String">'http://org.jboss.ws/samples/wsaddr'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;result&gt;</span>[Ice Cream, Ferrari]<span xmlns="" class="perl_Keyword">&lt;/result&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/ns1:getItemsResponse&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Body&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Envelope&gt;</span>
</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776748587648">
      ⁠</a>10.21.2. WS-Security</h2></div></div></div><div class="para">
				WS-Security addresses message level security. It standardizes authorization, encryption, and digital signature processing of web services. Unlike transport security models, such as SSL, WS-Security applies security directly to the elements of the web service message. This increases the flexibility of your web services, by allowing any message model to be used (for example, point to point, or multi-hop relay).
			</div><div class="para">
				This chapter describes how to use WS-Security to sign and encrypt a simple SOAP message.
			</div><div class="para">
				<span class="bold bold"><strong>Specifications</strong></span>
			</div><div class="para">
				WS-Security is defined by the combination of the following specifications:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf">SOAP Message Security 1.0</a>
					</div></li><li class="listitem"><div class="para">
						<a href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0.pdf">Username Token Profile 1.0</a>
					</div></li><li class="listitem"><div class="para">
						<a href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0.pdf">X.509 Token Profile 1.0</a>
					</div></li><li class="listitem"><div class="para">
						<a href="http://www.w3.org/TR/xmlenc-core">W3C XML Encryption</a>
					</div></li><li class="listitem"><div class="para">
						<a href="http://www.w3.org/TR/xmldsig-core">W3C XML Signature</a>
					</div></li><li class="listitem"><div class="para">
						<a href="http://www.ws-i.org/Profiles/BasicSecurityProfile-1.0.html">Basic Security Profile 1.0</a>
					</div></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776740103872">
      ⁠</a>10.21.2.1. Endpoint configuration</h3></div></div></div><div class="para">
					JBossWS uses handlers to identify ws-security encoded requests and invoke the security components to sign and encrypt messages. In order to enable security processing, the client and server side must include a corresponding handler configuration. The preferred way is to reference a predefined <a href="http://www.jboss.org/community/wiki/JBossWS-JAX-WSEndpointConfiguration">JAX-WS Endpoint Configuration</a> or <a href="http://www.jboss.org/community/wiki/JBossWS-JAX-WSClientConfiguration">JAX-WS Client Configuration</a> respectively.
				</div><div class="para">
					<div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							You must setup both the endpoint configuration and the WSSE declarations. These are two separate steps.
						</div></div></div>

				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776752414896">
      ⁠</a>10.21.2.2. Server side WSSE declaration (jboss-wsse-server.xml)</h3></div></div></div><div class="para">
					In this example we configure both the client and the server to sign the message body. Both also require this from each other. So, if you remove either the client or the server security deployment descriptor, you will notice that the other party will throw a fault explaining that the message did not conform to the proper security requirements.
				</div><div class="programlistingco"><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-ws-security</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">http://www.jboss.com/ws-security/schema/jboss-ws-security_1_0.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;key-store-file&gt;</span>WEB-INF/wsse.keystore<span xmlns="" class="perl_Keyword">&lt;/key-store-file&gt;</span>               <img class="callout" alt="1" src="Common_Content/images/1.png"/>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;key-store-password&gt;</span>jbossws<span xmlns="" class="perl_Keyword">&lt;/key-store-password&gt;</span>                     <img class="callout" alt="2" src="Common_Content/images/2.png"/>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;trust-store-file&gt;</span>WEB-INF/wsse.truststore<span xmlns="" class="perl_Keyword">&lt;/trust-store-file&gt;</span>         <img class="callout" alt="3" src="Common_Content/images/3.png"/>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;trust-store-password&gt;</span>jbossws<span xmlns="" class="perl_Keyword">&lt;/trust-store-password&gt;</span>                 <img class="callout" alt="4" src="Common_Content/images/4.png"/>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;config&gt;</span>                                                             <img class="callout" alt="5" src="Common_Content/images/5.png"/>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;sign</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"x509v3"</span><span xmlns="" class="perl_Others"> alias=</span><span xmlns="" class="perl_String">"wsse"</span><span xmlns="" class="perl_Keyword">/&gt;</span>                                <img class="callout" alt="6" src="Common_Content/images/6.png"/>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;requires&gt;</span>                                                        <img class="callout" alt="7" src="Common_Content/images/7.png"/>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;signature/&gt;</span>                                                   <img class="callout" alt="8" src="Common_Content/images/8.png"/>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;/requires&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/config&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-ws-security&gt;</span>
</pre>
<div class="calloutlist"><table border="0" summary="Callout list"><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/1.png" alt="1"/></p></td><td valign="top" align="left"><div class="para">
								This specifies that the key store we wish to use is <code class="filename">WEB-INF/wsse.keystore</code>, which is located in our war file.
							</div></td></tr><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/2.png" alt="2"/></p></td><td valign="top" align="left"><div class="para">
								This specifies that the store password is "jbossws". Password can be encypted using the {EXT} and {CLASS} commands. Please see samples for their usage.
							</div></td></tr><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/3.png" alt="3"/></p></td><td valign="top" align="left"><div class="para">
								This specifies that the trust store we wish to use is <code class="filename">WEB-INF/wsse.truststore</code>, which is located in our war file.
							</div></td></tr><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/4.png" alt="4"/></p></td><td valign="top" align="left"><div class="para">
								This specifies that the trust store password is also "jbossws". Password can be encrypted using the {EXT} and {CLASS} commands. Please see samples for their usage.
							</div></td></tr><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/5.png" alt="5"/></p></td><td valign="top" align="left"><div class="para">
								Here we start our root config block. The root config block is the default configuration for all services in this war file.
							</div></td></tr><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/6.png" alt="6"/></p></td><td valign="top" align="left"><div class="para">
								This means that the server must sign the message body of all responses. Type means that we are using X.509v3 certificate (a standard certificate). The alias option says that the certificate and key pair to use for signing is in the key store under the "wsse" alias
							</div></td></tr><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/7.png" alt="7"/></p></td><td valign="top" align="left"><div class="para">
								Here we start our optional requires block. This block specifies all security requirements that must be met when the server receives a message.
							</div></td></tr><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/8.png" alt="8"/></p></td><td valign="top" align="left"><div class="para">
								This means that all web services in this war file require the message body to be signed.
							</div></td></tr></table></div></div><div class="para">
					By default an endpoint does not use the WS-Security configuration. Users can use proprietary <code class="literal">@EndpointConfig</code> annotation to set the config name. See <a href="http://www.jboss.org/community/wiki/JBossWS-JAX-WSEndpointConfiguration">JAX-WS_Endpoint_Configuration</a> for the list of available config names.
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@WebService
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">EndpointConfig</span>(configName = <span xmlns="" class="perl_String">"Standard WSSecurity Endpoint"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> HelloJavaBean
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>}
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776768864624">
      ⁠</a>10.21.2.3. Client side WSSE declaration (jboss-wsse-client.xml)</h3></div></div></div><div class="programlistingco"><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-ws-security</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">http://www.jboss.com/ws-security/schema/jboss-ws-security_1_0.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;config&gt;</span>                                                          <img class="callout" alt="1" src="Common_Content/images/1.png"/>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;sign</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"x509v3"</span><span xmlns="" class="perl_Others"> alias=</span><span xmlns="" class="perl_String">"wsse"</span><span xmlns="" class="perl_Keyword">/&gt;</span>                             <img class="callout" alt="2" src="Common_Content/images/2.png"/>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;requires&gt;</span>                                                     <img class="callout" alt="3" src="Common_Content/images/3.png"/>
<span xmlns="" class="line">​</span>           <span xmlns="" class="perl_Keyword">&lt;signature/&gt;</span>                                                <img class="callout" alt="4" src="Common_Content/images/4.png"/>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/requires&gt;</span>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;/config&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-ws-security&gt;</span>
</pre>
<div class="calloutlist"><table border="0" summary="Callout list"><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/1.png" alt="1"/></p></td><td valign="top" align="left"><div class="para">
								Here we start our root config block. The root config block is the default configuration for all web service clients (Call, Proxy objects).
							</div></td></tr><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/2.png" alt="2"/></p></td><td valign="top" align="left"><div class="para">
								This means that the client must sign the message body of all requests it sends. Type means that we are to use a X.509v3 certificate (a standard certificate). The alias option says that the certificate/key pair to use for signing is in the key store under the "wsse" alias
							</div></td></tr><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/3.png" alt="3"/></p></td><td valign="top" align="left"><div class="para">
								Here we start our optional requires block. This block specifies all security requirements that must be met when the client receives a response.
							</div></td></tr><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/4.png" alt="4"/></p></td><td valign="top" align="left"><div class="para">
								This means that all web service clients must receive signed response messages.
							</div></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm139776764015600">
      ⁠</a>10.21.2.3.1. Client side key store configuration</h4></div></div></div><div class="para">
						We did not specify a key store or trust store, because client apps instead use the wsse System properties instead. If this was a web or ejb client (meaning a web service client in a war or ejb jar file), then we would have specified them in the client descriptor.
					</div><div class="para">
						Here is an excerpt from the JBossWS samples:
					</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;sysproperty</span><span xmlns="" class="perl_Others"> key=</span><span xmlns="" class="perl_String">"org.jboss.ws.wsse.keyStore"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">value=</span><span xmlns="" class="perl_String">"${tests.output.dir}/resources/jaxrpc/samples/wssecurity/wsse.keystore"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;sysproperty</span><span xmlns="" class="perl_Others"> key=</span><span xmlns="" class="perl_String">"org.jboss.ws.wsse.trustStore"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">value=</span><span xmlns="" class="perl_String">"${tests.output.dir}/resources/jaxrpc/samples/wssecurity/wsse.truststore"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;sysproperty</span><span xmlns="" class="perl_Others"> key=</span><span xmlns="" class="perl_String">"org.jboss.ws.wsse.keyStorePassword"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"jbossws"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;sysproperty</span><span xmlns="" class="perl_Others"> key=</span><span xmlns="" class="perl_String">"org.jboss.ws.wsse.trustStorePassword"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"jbossws"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;sysproperty</span><span xmlns="" class="perl_Others"> key=</span><span xmlns="" class="perl_String">"org.jboss.ws.wsse.keyStoreType"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"jks"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;sysproperty</span><span xmlns="" class="perl_Others"> key=</span><span xmlns="" class="perl_String">"org.jboss.ws.wsse.trustStoreType"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"jks"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre><div class="para">
						<span class="bold bold"><strong>SOAP message exchange</strong></span>
					</div><div class="para">
						Below you see the incoming SOAP message with the details of the security headers omitted. The idea is, that the SOAP body is still plain text, but it is signed in the security header and therefore can not be manipulated in transit.
					</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Envelope</span><span xmlns="" class="perl_Others"> xmlns:env=</span><span xmlns="" class="perl_String">"http://schemas.xmlsoap.org/soap/envelope/"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Header&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;wsse:Security</span><span xmlns="" class="perl_Others"> env:mustUnderstand=</span><span xmlns="" class="perl_String">"1"</span> <span xmlns="" class="perl_Error">...</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;wsu:Timestamp</span><span xmlns="" class="perl_Others"> wsu:Id=</span><span xmlns="" class="perl_String">"timestamp"</span><span xmlns="" class="perl_Keyword">&gt;</span>...<span xmlns="" class="perl_Keyword">&lt;/wsu:Timestamp&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;wsse:BinarySecurityToken</span> <span xmlns="" class="perl_Error">...</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/wsse:BinarySecurityToken&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ds:Signature</span><span xmlns="" class="perl_Others"> xmlns:ds=</span><span xmlns="" class="perl_String">"http://www.w3.org/2000/09/xmldsig#"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/ds:Signature&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/wsse:Security&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Header&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;env:Body</span><span xmlns="" class="perl_Others"> wsu:Id=</span><span xmlns="" class="perl_String">"element-1-1140197309843-12388840"</span> <span xmlns="" class="perl_Error">...</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ns1:echoUserType</span><span xmlns="" class="perl_Others"> xmlns:ns1=</span><span xmlns="" class="perl_String">"http://org.jboss.ws/samples/wssecurity"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;UserType_1</span><span xmlns="" class="perl_Others"> xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;msg&gt;</span>Kermit<span xmlns="" class="perl_Keyword">&lt;/msg&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/UserType_1&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/ns1:echoUserType&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Body&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/env:Envelope&gt;</span>
</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776681264368">
      ⁠</a>10.21.2.4. Installing the BouncyCastle JCE provider</h3></div></div></div><div class="para">
					The information below has originally been provided by <a href="http://www.bouncycastle.org/specifications.html#install">The Legion of the Bouncy Castle</a>.
				</div><div class="para">
					The provider can be configured as part of your environment via static registration by adding an entry to the <code class="filename">java.security</code> properties file (found in <code class="filename">$JAVA_HOME/jre/lib/security/java.security</code>, where <code class="filename">$JAVA_HOME</code> is the location of your JDK and JRE distribution). You will find detailed instructions in the file but basically it comes down to adding a line:
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>security.provider.<span xmlns="" class="perl_Keyword">&lt;n&gt;</span>=org.bouncycastle.jce.provider.BouncyCastleProvider
</pre><div class="para">
					Where <code class="code">&lt;n&gt;</code> is the preference you want the provider at.
				</div><div class="para">
					<div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							Issues may arise if the Sun provided providers are not first.
						</div></div></div>

				</div><div class="para">
					The location of the provider jar is mostly arbitrary, although some common conventions exist. Under Windows there will normally be a JRE and a JDK install of Java. If you think it's installed it correctly but it still does not work then with high probability the provider installation is not used.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776682527984">
      ⁠</a>10.21.2.5. Username Token Authentication</h3></div></div></div><div class="para">
					If you need to authenticate clients through a Username Token, the JAAS integration will verify the received token against the configured JBoss JAAS Security Domain.
				</div><div class="example"><a id="idm139776686247376">
      ⁠</a><p class="title"><strong>Example 10.1. Basic Username Token Configuration</strong></p><div class="example-contents"><div class="para">
						To implement this feature, you must append a <span class="markup">&lt;jboss-ws-security&gt;</span> element to <code class="filename">jboss-wsse-client.xml</code> that contains the following information.
					</div><div class="programlistingco"><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-ws-security</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">    xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">    xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://www.jboss.com/ws-security/schema/jboss-ws-security_1_0.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;config&gt;</span>
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Keyword">&lt;username/&gt;</span>
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Keyword">&lt;timestamp</span><span xmlns="" class="perl_Others"> ttl=</span><span xmlns="" class="perl_String">"300"</span><span xmlns="" class="perl_Keyword">/&gt;</span>                                              <img class="callout" alt="1" src="Common_Content/images/1.png"/>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;/config&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-ws-security&gt;</span></pre>
<div class="calloutlist"><table border="0" summary="Callout list"><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/1.png" alt="1"/></p></td><td valign="top" align="left"><div class="para">
									This line specifies that a <span class="markup">&lt;timestamp&gt;</span> element must be present in the message and that the message can not be older than 300 seconds. The seconds limitation is used to prevent replay attacks.
								</div></td></tr></table></div></div><div class="para">
						You must then specify the same <span class="markup">&lt;timestamp&gt;</span> element and <em class="parameter"><code>seconds</code></em> attribute in the <code class="filename">jboss-wsse-server.xml</code> file so both headers match. You must also specify the <span class="markup">&lt;requires/&gt; </span>element to enforce this condition.
					</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-ws-security</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">          xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">          xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">          http://www.jboss.com/ws-security/schema/jboss-ws-security_1_0.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;config&gt;</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;timestamp</span><span xmlns="" class="perl_Others"> ttl=</span><span xmlns="" class="perl_String">"300"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;requires/&gt;</span>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;/config&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-ws-security&gt;</span></pre></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
						This example configuration results in simple text user information being sent in SOAP headers. You should strongly consider implementing JBossWS Secure Transport
					</div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Password Digest, Nonces, and Timestamp</div>
						<a class="xref" href="Web_Services.html#exam-Basic_Username_Token_Configuration">Example 10.1, “Basic Username Token Configuration”</a> results in the client password being sent as plain text. You can use a combination of <em class="firstterm">digested passwords</em>, <em class="firstterm">nonces</em>, and <em class="firstterm">timestamps</em> to provide further protection from replay attacks.
					</div><div class="para">
					To enable password digesting, you must implement the following items as described in <a class="xref" href="Web_Services.html#exam-Enable_Password_Digesting">Example 10.2, “Enable Password Digesting”</a>:
				</div><div class="example"><a id="exam-Enable_Password_Digesting">
      ⁠</a><p class="title"><strong>Example 10.2. Enable Password Digesting</strong></p><div class="example-contents"><div class="programlistingco"><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-ws-security</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">    xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">    xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">    http://www.jboss.com/ws-security/schema/jboss-ws-security_1_0.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;config&gt;</span>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;username</span><span xmlns="" class="perl_Others"> digestPassword=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> useNonce=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> useCreated=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>    <img class="callout" alt="1" src="Common_Content/images/1.png"/>
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Keyword">&lt;timestamp</span><span xmlns="" class="perl_Others"> ttl=</span><span xmlns="" class="perl_String">"300"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/config&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-ws-security&gt;</span></pre>
<div class="calloutlist"><table border="0" summary="Callout list"><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/1.png" alt="1"/></p></td><td valign="top" align="left"><div class="para">
									The <span class="markup">&lt;username&gt;</span> element of the <code class="filename">jboss-wsse-client.xml</code> file enables the <em class="parameter"><code>digestPassword</code></em>, <em class="parameter"><code>nonces</code></em> and <em class="parameter"><code>timestamps</code></em> attributes.
								</div></td></tr></table></div></div></div></div><div class="para">
					In the <code class="filename">login-config.xml</code> file, you must also implement the <code class="literal">UsernameTokenCallback</code> module option.
				</div><div class="example"><a id="exam-UsernameTokenCallback_Module">
      ⁠</a><p class="title"><strong>Example 10.3. UsernameTokenCallback Module</strong></p><div class="example-contents"><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;application-policy</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"JBossWSDigest"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;authentication&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;login-module</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.security.auth.spi.UsersRolesLoginModule"</span><span xmlns="" class="perl_Others"> flag=</span><span xmlns="" class="perl_String">"required"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"usersProperties"</span><span xmlns="" class="perl_Keyword">&gt;</span>META-INF/jbossws-users.properties<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"rolesProperties"</span><span xmlns="" class="perl_Keyword">&gt;</span>META-INF/jbossws-roles.properties<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hashAlgorithm"</span><span xmlns="" class="perl_Keyword">&gt;</span>SHA<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hashEncoding"</span><span xmlns="" class="perl_Keyword">&gt;</span>BASE64<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hashUserPassword"</span><span xmlns="" class="perl_Keyword">&gt;</span>false<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hashStorePassword"</span><span xmlns="" class="perl_Keyword">&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"storeDigestCallback"</span><span xmlns="" class="perl_Keyword">&gt;</span>org.jboss.ws.extensions.security.auth.callback.UsernameTokenCallback<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"unauthenticatedIdentity"</span><span xmlns="" class="perl_Keyword">&gt;</span>anonymous<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/login-module&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/authentication&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/application-policy&gt;</span></pre></div></div><div class="para">
					You may wish to use a more sophisticated custom login module to provide more security against replay attacks. You can use your own custom login module provided you implement the following:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							plug the <code class="classname">UsernameTokenCallback</code> callback into your login module
						</div></li><li class="listitem"><div class="para">
							extend the <code class="classname">org.jboss.security.auth.spi.UsernamePasswordLoginModule</code>
						</div></li><li class="listitem"><div class="para">
							set the hash attributes (<em class="parameter"><code>hashAlgorithm</code></em>, <em class="parameter"><code>hashEncoding</code></em>, <em class="parameter"><code>hashUserPassword</code></em>, <em class="parameter"><code>hashStorePassword</code></em>) as shown in <a class="xref" href="Web_Services.html#exam-UsernameTokenCallback_Module">Example 10.3, “UsernameTokenCallback Module”</a>.
						</div></li></ul></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Advanced Tuning - Nonce Factory</div>
						The way nonces are created, and subsequently checked and stored on the server side, influences overall security against replay attacks. Currently JBossWS ships with a basic implementation of a nonce store that does not cache the received tokens on the server side.
					</div><div class="para">
					More complex implementation can be plugged into your modules by implementing the <code class="interfacename">NonceFactory</code> and <code class="interfacename">NonceStore</code> interfaces. You can find these interfaces in the <span class="package">org.jboss.ws.extensions.security.nonce</span> package.
				</div><div class="para">
					Once included, you specify your factory class through the <span class="markup">&lt;nonce-factory-class&gt;</span> element in the <code class="filename">jboss-wsse-server.xml</code> file.
				</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Advanced Tuning - Timestamp Verification</div>
						If a Timestamp is present in the <code class="literal">wsse:Security</code> header, header verification does not allow for any tolerance whatsoever in the time comparisons. If the message appears to have been created even slightly in the future or if the message has just expired it will be rejected. A new element called <span class="markup">&lt;timestamp-verification&gt;</span> is available for the wsse configuration. <a class="xref" href="Web_Services.html#exam-Timestamp-Verification_Configuration">Example 10.4, “&lt;timestamp-verification&gt; Configuration”</a> describes the required attributes for the <span class="markup">&lt;timestamp-verification&gt;</span> element.
					</div><div class="example"><a id="exam-Timestamp-Verification_Configuration">
      ⁠</a><p class="title"><strong>Example 10.4. &lt;timestamp-verification&gt; Configuration</strong></p><div class="example-contents"><div class="para">
						The <span class="markup">&lt;timestamp-verification&gt;</span> element attributes allow you to specify the tolerance in seconds that is used when verifying the 'Created' or 'Expires' element of the 'Timestamp' header.
					</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-ws-security</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">'http://www.jboss.com/ws-security/config'</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">                   xmlns:xsi=</span><span xmlns="" class="perl_String">'http://www.w3.org/2001/XMLSchema-instance'</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">                   xsi:schemaLocation=</span><span xmlns="" class="perl_String">'http://www.jboss.com/ws-security/config     </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">                   http://www.jboss.com/ws-security/schema/jboss-ws-security_1_0.xsd'</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;timestamp-verification</span><span xmlns="" class="perl_Others"> createdTolerance=</span><span xmlns="" class="perl_String">"5"</span><span xmlns="" class="perl_Others"> warnCreated=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Others"> expiresTolerance=</span><span xmlns="" class="perl_String">"10"</span><span xmlns="" class="perl_Others"> warnExpires=</span><span xmlns="" class="perl_String">"false"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-ws-security&gt;</span></pre><div class="variablelist"><dl class="variablelist"><dt><span class="term"> <em class="parameter"><code>createdTolerance</code></em> </span></dt><dd><div class="para">
									Number of seconds in the future a message will be accepted. The default value is <code class="literal">0</code>
								</div></dd><dt><span class="term"> <em class="parameter"><code>expiresTolerance</code></em> </span></dt><dd><div class="para">
									Number of seconds a message is rejected after being classed as expired. The default value is <code class="literal">0</code>.
								</div></dd><dt><span class="term"> <em class="parameter"><code>warnCreated</code></em> </span></dt><dd><div class="para">
									Specifies whether to log a warning message if a message is accepted with a 'Created' value in the future. The default value is <code class="literal">true</code>.
								</div></dd><dt><span class="term"> <em class="parameter"><code>warnExpires</code></em> </span></dt><dd><div class="para">
									Specifies whether to log a warning message if a message is accepted with an 'Expired' value in the past. The default value is <code class="literal">true</code>.
								</div></dd></dl></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						The <em class="parameter"><code>warnCreated</code></em> and <em class="parameter"><code>warnExpires</code></em> attributes can be used to identify accepted messages that would normally be rejected. You can use this data to identify clients that are out of sync with the server time, without rejecting the client messages.
					</div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm139776698845568">
      ⁠</a>10.21.2.5.1. Secure Transport</h4></div></div></div><div class="para">

					</div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776732715200">
      ⁠</a>10.21.2.6. X509 Certificate Token</h3></div></div></div><div class="para">
					By using X509v3 certificates, you can both sign and encrypt messages.
				</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Encryption</div>
						To configure encryption, you must specify the items in <a class="xref" href="Web_Services.html#exam-X509_Encryption_Configuration">Example 10.5, “X509 Encryption Configuration”</a>. The configuration is the same for clients and servers.
					</div><div class="example"><a id="exam-X509_Encryption_Configuration">
      ⁠</a><p class="title"><strong>Example 10.5. X509 Encryption Configuration</strong></p><div class="example-contents"><div class="para">
						The server configuration includes the following encryption information:
					</div><div class="programlistingco"><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-ws-security</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">       xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">       xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">       http://www.jboss.com/ws-security/schema/jboss-ws-security_1_0.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;key-store-file&gt;</span>WEB-INF/bob-sign_enc.jks<span xmlns="" class="perl_Keyword">&lt;/key-store-file&gt;</span>                 <img class="callout" alt="1" src="Common_Content/images/1.png"/>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;key-store-password&gt;</span>password<span xmlns="" class="perl_Keyword">&lt;/key-store-password&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;key-store-type&gt;</span>jks<span xmlns="" class="perl_Keyword">&lt;/key-store-type&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;trust-store-file&gt;</span>WEB-INF/wsse10.truststore<span xmlns="" class="perl_Keyword">&lt;/trust-store-file&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;trust-store-password&gt;</span>password<span xmlns="" class="perl_Keyword">&lt;/trust-store-password&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;config&gt;</span>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;timestamp</span><span xmlns="" class="perl_Others"> ttl=</span><span xmlns="" class="perl_String">"300"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;sign</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"x509v3"</span><span xmlns="" class="perl_Others"> alias=</span><span xmlns="" class="perl_String">"1"</span><span xmlns="" class="perl_Others"> includeTimestamp=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>                 <img class="callout" alt="2" src="Common_Content/images/2.png"/>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;encrypt</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"x509v3"</span>                                                  <img class="callout" alt="3" src="Common_Content/images/3.png"/>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">              alias=</span><span xmlns="" class="perl_String">"alice"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">              algorithm=</span><span xmlns="" class="perl_String">"aes-256"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">              keyWrapAlgorithm=</span><span xmlns="" class="perl_String">"rsa_oaep"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">              tokenReference=</span><span xmlns="" class="perl_String">"keyIdentifier"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;requires&gt;</span>                                                        <img class="callout" alt="4" src="Common_Content/images/4.png"/>
<span xmlns="" class="line">​</span>              <span xmlns="" class="perl_Keyword">&lt;signature/&gt;</span>
<span xmlns="" class="line">​</span>              <span xmlns="" class="perl_Keyword">&lt;encryption/&gt;</span>      
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;/requires&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/config&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-ws-security&gt;</span></pre>
<div class="calloutlist"><table border="0" summary="Callout list"><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/1.png" alt="1"/></p></td><td valign="top" align="left"><div class="para">
									Keystore and Truststore information: location of each store, the password, and type of store.
								</div></td></tr><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/2.png" alt="2"/></p></td><td valign="top" align="left"><div class="para">
									Signature configuration: you must provide the certificate and key pair aliases to use. <em class="parameter"><code>includeTimestamp</code></em> specifies whether the timestamp is signed to prevent tampering.
								</div></td></tr><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/3.png" alt="3"/></p></td><td valign="top" align="left"><div class="para">
									Encryption configuration: you must provide the certificate and key pair aliases to use. Refer to <a class="xref" href="Web_Services.html#form-Algorithms">Algorithms</a> for more information.
								</div></td></tr><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/4.png" alt="4"/></p></td><td valign="top" align="left"><div class="para">
									Optional security requirements: incoming messages must be both signed, and encrypted.
								</div></td></tr></table></div></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Dynamic Encryption</div>
						When replying to multiple clients, a service provider must encrypt a message according to its destination using the correct public key. The JBossWS native implementation of WS-Security obtains the correct key to use from the signature received (and verified) in the incoming message.
					</div><div class="example"><a id="exam-Dynamic_Encryption_Configuration">
      ⁠</a><p class="title"><strong>Example 10.6. Dynamic Encryption Configuration</strong></p><div class="example-contents"><div class="para">
						To configure dynamic encryption:
					</div><div class="programlistingco"><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-ws-security</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">       xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">       xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">       http://www.jboss.com/ws-security/schema/jboss-ws-security_1_0.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;key-store-file&gt;</span>WEB-INF/bob-sign_enc.jks<span xmlns="" class="perl_Keyword">&lt;/key-store-file&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;key-store-password&gt;</span>password<span xmlns="" class="perl_Keyword">&lt;/key-store-password&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;key-store-type&gt;</span>jks<span xmlns="" class="perl_Keyword">&lt;/key-store-type&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;trust-store-file&gt;</span>WEB-INF/wsse10.truststore<span xmlns="" class="perl_Keyword">&lt;/trust-store-file&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;trust-store-password&gt;</span>password<span xmlns="" class="perl_Keyword">&lt;/trust-store-password&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;config&gt;</span>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;timestamp</span><span xmlns="" class="perl_Others"> ttl=</span><span xmlns="" class="perl_String">"300"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;sign</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"x509v3"</span><span xmlns="" class="perl_Others"> alias=</span><span xmlns="" class="perl_String">"1"</span><span xmlns="" class="perl_Others"> includeTimestamp=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;encrypt</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"x509v3"</span>                                                  <img class="callout" alt="1" src="Common_Content/images/1.png"/>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">              algorithm=</span><span xmlns="" class="perl_String">"aes-256"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">              keyWrapAlgorithm=</span><span xmlns="" class="perl_String">"rsa_oaep"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">               tokenReference=</span><span xmlns="" class="perl_String">"keyIdentifier"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;requires&gt;</span>
<span xmlns="" class="line">​</span>              <span xmlns="" class="perl_Keyword">&lt;signature/&gt;</span>                                                    <img class="callout" alt="2" src="Common_Content/images/2.png"/>
<span xmlns="" class="line">​</span>              <span xmlns="" class="perl_Keyword">&lt;encryption/&gt;</span>      
<span xmlns="" class="line">​</span>           <span xmlns="" class="perl_Keyword">&lt;/requires&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/config&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-ws-security&gt;</span></pre>
<div class="calloutlist"><table border="0" summary="Callout list"><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/1.png" alt="1"/></p></td><td valign="top" align="left"><div class="para">
									Do not specify any encryption alias on the server side.
								</div></td></tr><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/2.png" alt="2"/></p></td><td valign="top" align="left"><div class="para">
									Declare that a signature is required.
								</div></td></tr></table></div></div></div></div><div class="para"><a id="form-Algorithms">
      ⁠</a><div xmlns:d="http://docbook.org/ns/docbook" class="title">Algorithms</div>
						Asymmetric and symmetric encryption is performed whenever the <span class="markup">&lt;encrypt&gt;</span> element is declared. Message data are encrypted using a generated symmetric secured key. This key is written in the SOAP header after being encrypted (wrapped) with the receiver public key. You can set both the encryption and key wrap algorithms.
					</div><div class="para">
					The supported encryption algorithms include:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							AES 128 (aes-128) (default)
						</div></li><li class="listitem"><div class="para">
							AES 192 (aes-192)
						</div></li><li class="listitem"><div class="para">
							AES 256 (aes-256)
						</div></li><li class="listitem"><div class="para">
							Triple DES (triple-des)
						</div></li></ul></div><div class="para">
					The supported key-wrap algorithms include:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							RSA v1.5 (rsa_15) (default)
						</div></li><li class="listitem"><div class="para">
							RSA OAEP (rsa_oaep)
						</div></li></ul></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						The <a href="http://java.sun.com/javase/downloads/index.jsp">Unlimited Strength Java(TM) Cryptography Extension</a> installation might be required to run some strong algorithms (for example, aes-256). Your country may impose limitations on the allowed cryptographic strength in applications. It is your responsibility to select the encryption level suitable for your jurisdiction.
					</div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Encryption Token Reference</div>
						For interoperability reasons, you may need to configure the type of reference to encryption token to be used. For example, Microsoft Indigo does not support direct reference to local binary security tokens which are the default reference type used by JBossWS.
					</div><div class="para">
					To configure this reference, you specify the <em class="parameter"><code>tokenReference</code></em> attribute in the <span class="markup">&lt;encrypt&gt;</span> element. The values for the <em class="parameter"><code>tokenReference</code></em> attribute are:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="literal">directReference</code> (default)
						</div></li><li class="listitem"><div class="para">
							<code class="literal">keyIdentifier</code> - specifies the token data by means of an X509 SubjectKeyIdentifier reference.
						</div></li><li class="listitem"><div class="para">
							<code class="literal">x509IssuerSerial</code> - uniquely identifies an end entity certificate by its X509 Issuer and Serial Number
						</div></li></ul></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						Complete information about X509 Token Profiles are available in the <em class="citetitle">WSS X501 Certificate Token Profile 1.0</em> document, which can be obtained from the <a href="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0.pdf">Oasis.org docs portal</a>.
					</div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Targets Configuration</div>
						JBossWS gives you precise control over elements that must be signed or encrypted. This allows you to encrypt important data only (such as credit card numbers) instead of other, security-trivial, information exchanged by the same service (email addresses, for example). To configure this, you must specify the Qualified Name (qname) of the SOAP elements to encrypt. The default behavior is to encrypt the whole SOAP body.
					</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;encrypt</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"x509v3"</span><span xmlns="" class="perl_Others"> alias=</span><span xmlns="" class="perl_String">"alice"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;targets&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;target</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"qname"</span><span xmlns="" class="perl_Keyword">&gt;</span>{http://www.my-company.com/cc}CardNumber<span xmlns="" class="perl_Keyword">&lt;/target&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;target</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"qname"</span><span xmlns="" class="perl_Keyword">&gt;</span>{http://www.my-company.com/cc}CardExpiration<span xmlns="" class="perl_Keyword">&lt;/target&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;target</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"qname"</span><span xmlns="" class="perl_Others"> contentOnly=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">&gt;</span>{http://www.my-company.com/cc}CustomerData<span xmlns="" class="perl_Keyword">&lt;/target&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/targets&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/encrypt&gt;</span></pre><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Payload Carriage Returns</div>
						Signature verification errors can occur in signed message payloads that contain carriage returns (<code class="literal">\r</code>) due to the way the special character is parsed by XML parsers. To prevent this issue, you can choose to implement custom encoding before sending the payload. Users can either encrypt the message, or force JBossWS to perform canonical normalization of messages.
					</div><div class="para">
					The <span class="property">org.jboss.ws.DOMContentCanonicalNormalization</span> property can normalize the payload if set to <code class="literal">true</code> in the MessageContext. The property must be set just before the invocation on the client side and in the endpoint implementation.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776728564048">
      ⁠</a>10.21.2.7. JAAS Integration</h3></div></div></div><div class="para">
					The WS-Security implementation allows users to achieve J2EE declarative security through JAAS integration. The calling user's identity and credentials are derived from the wsse headers of the incoming message, according to the parameters provided in the server wsse configuration file. Authentication and authorization is subsequently achieved delegating to the JAAS login modules configured for the specified security domain.
				</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Username Token</div>
						Username Token Profile provides a mean of specifying the caller's username and password. The wsse server configuration file can be used to have those information used when performing authentication and authorization through configured login module.
					</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-ws-security</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">                      http://www.jboss.com/ws-security/schema/jboss-ws-security_1_0.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;config&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;username/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;authenticate&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;usernameAuth/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/authenticate&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/config&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-ws-security&gt;</span></pre><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">X.509 Certificate Token</div>
						In previous versions of JBossWS, the username token was always used to set the principal and credential of the caller whenever specified. This behavior is retained for backward compatibility reasons where no <span class="markup">&lt;authenticate&gt;</span> element is specified and the username token is used.
					</div><div class="programlistingco"><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-ws-security</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://www.jboss.com/ws-security/config</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">                      http://www.jboss.com/ws-security/schema/jboss-ws-security_1_0.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;key-store-file&gt;</span>META-INF/bob-sign.jks<span xmlns="" class="perl_Keyword">&lt;/key-store-file&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;key-store-password&gt;</span>password<span xmlns="" class="perl_Keyword">&lt;/key-store-password&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;key-store-type&gt;</span>jks<span xmlns="" class="perl_Keyword">&lt;/key-store-type&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;trust-store-file&gt;</span>META-INF/wsse10.truststore<span xmlns="" class="perl_Keyword">&lt;/trust-store-file&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;trust-store-password&gt;</span>password<span xmlns="" class="perl_Keyword">&lt;/trust-store-password&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;config&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;sign</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"x509v3"</span><span xmlns="" class="perl_Others"> alias=</span><span xmlns="" class="perl_String">"1"</span><span xmlns="" class="perl_Others"> includeTimestamp=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;requires&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;signature/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/requires&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;authenticate&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;signatureCertAuth</span><span xmlns="" class="perl_Others"> certificatePrincipal=</span><span xmlns="" class="perl_String">"org.jboss.security.auth.certs.SubjectCNMapping"</span><span xmlns="" class="perl_Keyword">/&gt;</span>    <img class="callout" alt="1" src="Common_Content/images/1.png"/>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/authenticate&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/config&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-ws-security&gt;</span></pre>
<div class="calloutlist"><table border="0" summary="Callout list"><tr><td valign="top" align="left"><p><img class="callout" src="Common_Content/images/1.png" alt="1"/></p></td><td valign="top" align="left"><div class="para">
								The optional <em class="parameter"><code>certificatePrincipal</code></em> attribute specifies the class used to retrieve the principal from the X.509 certificate's attributes. The selected class must extend <code class="classname">CertificatePrincipal</code>. The default class used when no attribute is specified is <code class="classname">org.jboss.security.auth.certs.SubjectDNMapping</code>. 
							</div></td></tr></table></div></div><div class="para">
					The configured security domain must have a correctly configured BaseCertLoginModule, as described in <a class="xref" href="Web_Services.html#exam-BaseCertLoginModule_Security_Domain">Example 10.7, “BaseCertLoginModule Security Domain”</a>.
				</div><div class="example"><a id="exam-BaseCertLoginModule_Security_Domain">
      ⁠</a><p class="title"><strong>Example 10.7. BaseCertLoginModule Security Domain</strong></p><div class="example-contents"><div class="para">
						The following code sample shows a security domain with a <code class="classname">CertRolesLoginModule</code> that also enables authorization (using the specified <code class="filename">jbossws-roles.properties</code> file).
					</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;application-policy</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"JBossWSCert"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;authentication&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;login-module</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.security.auth.spi.CertRolesLoginModule"</span><span xmlns="" class="perl_Others"> flag=</span><span xmlns="" class="perl_String">"required"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"rolesProperties"</span><span xmlns="" class="perl_Keyword">&gt;</span>jbossws-roles.properties<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"unauthenticatedIdentity"</span><span xmlns="" class="perl_Keyword">&gt;</span>anonymous<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"securityDomain"</span><span xmlns="" class="perl_Keyword">&gt;</span>java:/jaas/JBossWSCert<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/login-module&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/authentication&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/application-policy&gt;</span></pre></div></div><div class="para">
					The BaseCertLoginModule uses a central keystore to authenticate users. This store is configured through the <code class="classname">org.jboss.security.plugins.JaasSecurityDomain</code> MBean as shown in <a class="xref" href="Web_Services.html#exam-BaseCertLoginModule_Keystore">Example 10.8, “BaseCertLoginModule Keystore”</a>.
				</div><div class="example"><a id="exam-BaseCertLoginModule_Keystore">
      ⁠</a><p class="title"><strong>Example 10.8. BaseCertLoginModule Keystore</strong></p><div class="example-contents"><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;mbean</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.security.plugins.JaasSecurityDomain"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">       name=</span><span xmlns="" class="perl_String">"jboss.security:service=SecurityDomain"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;constructor&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;arg</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"java.lang.String"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"JBossWSCert"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/constructor&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"KeyStoreURL"</span><span xmlns="" class="perl_Keyword">&gt;</span>resource:META-INF/keystore.jks<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"KeyStorePass"</span><span xmlns="" class="perl_Keyword">&gt;</span>password<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;depends&gt;</span>jboss.security:service=JaasSecurityManager<span xmlns="" class="perl_Keyword">&lt;/depends&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/mbean&gt;</span></pre></div></div><div class="para">
					At authentication time, the specified <code class="classname">CertificatePrincipal</code> mapping class accesses the keystore using the principal obtained from the associated wsse header. If a certificate is found and is the same as the one specified in the wsse header, the user is successfully authenticated.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776687645280">
      ⁠</a>10.21.2.8. POJO Endpoint Authentication and Authorization</h3></div></div></div><div class="para">
					The credentials obtained by WS-Security are generally used for EJB endpoints, or for POJO endpoints when they make a call to another secured resource. It is now possible to enable authentication and authorization checking for POJO endpoints.
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
						Authentication and Authorization should not be enabled for EJB based endpoints because the EJB container handles the security requirements of the deployed bean.
					</div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139776732052544">
      ⁠</a><p class="title"><strong>Procedure 10.1. Enabling POJO Authentication and Authorization</strong></p><div class="para">
						This procedure describes the additional configuration required to enable authentication and authorization for POJO endpoints.
					</div><ol class="1"><li class="step"><p class="title"><strong>Define Security Domain in Web Archive</strong></p><div class="para">
							You must define a security domain in the WAR containing the POJO.
						</div><div class="para">
							Specify a <span class="markup">&lt;security-domain&gt;</span> in the jboss-web deployment descriptor within the <code class="filename">/WEB-INF</code> folder.
						</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-web&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;security-domain&gt;</span>java:/jaas/JBossWS<span xmlns="" class="perl_Keyword">&lt;/security-domain&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-web&gt;</span></pre></li><li class="step"><p class="title"><strong>Configure the jboss-wsse-server.xml &lt;authorize&gt; element</strong></p><div class="para">
							Specify an &lt;authorize&gt; element within the &lt;config&gt; element.
						</div><div class="para">
							The <span class="markup">&lt;config&gt;</span> element can be defined globally, be port-specific, or operation-specific.
						</div><div class="para">
							The <span class="markup">&lt;authorize&gt;</span> element must contain either the <span class="markup">&lt;unchecked/&gt;</span> element or one or more <span class="markup">&lt;role&gt;</span> elements. Each <span class="markup">&lt;role&gt;</span> element must contain the name of a valid RoleName.
						</div><div class="para">
							You can choose to implement two types of authentication: unchecked, and role-based authentication.
						</div><div class="para"><div class="title">Unchecked Authentication</div>
								The authentication step is performed to validate the user's username and password, but no further role checking takes place. If the user's username and password are invalid, the request is rejected.
							</div><div class="example"><a id="idm139776769049344">
      ⁠</a><p class="title"><strong>Example 10.9. Unchecked Authentication</strong></p><div class="example-contents"><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-ws-security&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;config&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;authorize&gt;</span>      
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;unchecked/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/authorize&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/config&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-ws-security&gt;</span></pre></div></div><div class="para"><div class="title">Role-based Authentication</div>
								The user is authenticated using their username and password as per Unchecked Authentication. Once the user's username and password is verified, user credentials are checked again to ensure at least of the roles specified in the <span class="markup">&lt;role&gt;</span> element is assigned to the user.
							</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
								Authentication and authorization proceeds even if no username and password, or certificate was provided in the request message. In this scenario, authentication may proceed if the security domain's login module has been configured with an anonymous identity.
							</div></div></div><div class="example"><a id="idm139776754799760">
      ⁠</a><p class="title"><strong>Example 10.10. Role-based Authentication</strong></p><div class="example-contents"><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-ws-security&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;config&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;authorize&gt;</span>      
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;role&gt;</span>friend<span xmlns="" class="perl_Keyword">&lt;/role&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;role&gt;</span>family<span xmlns="" class="perl_Keyword">&lt;/role&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/authorize&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/config&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-ws-security&gt;</span></pre></div></div></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-XML_Registries">
      ⁠</a>10.21.3. XML Registries</h2></div></div></div><div class="para">
				J2EE 5.0 mandates support for Java API for XML Registries (JAXR). Inclusion of a XML Registry with the J2EE 5.0 certified Application Server is optional. JBoss EAP ships a UDDI v2.0 compliant registry, the Apache jUDDI registry. JAXR Capability Level 0 (UDDI Registries) is also supported through Apache Scout integration.
			</div><div class="para">
				<a class="xref" href="Web_Services.html#sect-XML_Registries">Section 10.21.3, “XML Registries”</a> describes how to configure the jUDDI registry in JBoss and some sample code outlines for using JAXR API to publish and query the jUDDI registry.
			</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776731425456">
      ⁠</a>10.21.3.1. Apache jUDDI Configuration</h3></div></div></div><div class="para">
					jUDDI registry configuration happens via a MBean Service that is deployed in the <code class="filename">juddi-service.sar</code> archive in the <code class="literal">all</code> server profile. The configuration of this service can be done in the <code class="filename">jboss-service.xml</code> of the <code class="filename">META-INF</code> directory in the <code class="filename">juddi-service.sar</code>
				</div><div class="para">
					Let us look at the individual configuration items that can be changed.
				</div><div class="para">
					DataSources configuration
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Datasource to Database --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DataSourceUrl"</span><span xmlns="" class="perl_Keyword">&gt;</span>java:/DefaultDS<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
</pre><div class="para">
					Database Tables (Should they be created on start, Should they be dropped on stop, Should they be dropped on start etc)
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Should all tables be created on Start--&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"CreateOnStart"</span><span xmlns="" class="perl_Keyword">&gt;</span>false<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Should all tables be dropped on Stop--&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DropOnStop"</span><span xmlns="" class="perl_Keyword">&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Should all tables be dropped on Start--&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DropOnStart"</span><span xmlns="" class="perl_Keyword">&gt;</span>false<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
</pre><div class="para">
					JAXR Connection Factory to be bound in JNDI. (Should it be bound? and under what name?)
				</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Should I bind a Context to which JaxrConnectionFactory bound--&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ShouldBindJaxr"</span><span xmlns="" class="perl_Keyword">&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- Context to which JaxrConnectionFactory to bind to. If you have remote clients, please bind it to the global namespace(default behavior). </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">To just cater to clients running on the same VM as JBoss, change to java:/JAXR --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"BindJaxr"</span><span xmlns="" class="perl_Keyword">&gt;</span>JAXR<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
</pre><div class="para">
					Other common configuration:
				</div><div class="para">
					Add authorized users to access the jUDDI registry. (Add a sql insert statement in a single line)
				</div><pre class="programlisting">
Look at the script META-INF/ddl/juddi_data.ddl for more details. Example for a user 'jboss'
  
INSERT INTO PUBLISHER (PUBLISHER_ID,PUBLISHER_NAME,
EMAIL_ADDRESS,IS_ENABLED,IS_ADMIN) 
VALUES ('jboss','JBoss User','jboss@xxx','true','true');
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776743147168">
      ⁠</a>10.21.3.2. JBoss JAXR Configuration</h3></div></div></div><div class="para">
					In this section, we will discuss the configuration needed to run the JAXR API. The JAXR configuration relies on System properties passed to the JVM. The System properties that are needed are:
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>javax.xml.registry.ConnectionFactoryClass=org.apache.ws.scout.registry.
<span xmlns="" class="line">​</span>ConnectionFactoryImpl 
<span xmlns="" class="line">​</span>jaxr.query.url=http://localhost:8080/juddi/inquiry 
<span xmlns="" class="line">​</span>jaxr.publish.url=http://localhost:8080/juddi/publish
<span xmlns="" class="line">​</span>scout.proxy.transportClass=org.jboss.jaxr.scout.transport.SaajTransport
</pre><div class="para">
					Please remember to change the hostname from "localhost" to the hostname of the UDDI service/Server.
				</div><div class="para">
					You can pass the System Properties to the JVM in the following ways:
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							When the client code is running inside JBoss (maybe a servlet or an EJB). Then you will need to pass the System properties in the <code class="filename">run.sh</code> or <code class="filename">run.bat</code> scripts to the java process via the <code class="code">"-D"</code> option.
						</div></li><li class="listitem"><div class="para">
							When the client code is running in an external JVM. Then you can pass the properties either as "-D" options to the java process or explicitly set them in the client code(not recommended).
						</div></li></ul></div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>System.<span xmlns="" class="perl_Function">setProperty</span>(propertyname, propertyvalue);
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776743307936">
      ⁠</a>10.21.3.3. JAXR Sample Code</h3></div></div></div><div class="para">
					There are two categories of API: JAXR Publish API and JAXR Inquiry API. The important JAXR interfaces that any JAXR client code will use are the following.
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							<a href="http://java.sun.com/javaee/5/docs/api/javax/xml/registry/RegistryService.html">javax.xml.registry.RegistryService</a> From J2EE 5.0 JavaDoc: "This is the principal interface implemented by a JAXR provider. A registry client can get this interface from a Connection to a registry. It provides the methods that are used by the client to discover various capability specific interfaces implemented by the JAXR provider."
						</div></li><li class="listitem"><div class="para">
							<a href="http://java.sun.com/javaee/5/docs/api/javax/xml/registry/BusinessLifeCycleManager.html">javax.xml.registry.BusinessLifeCycleManager</a> From J2EE 5.0 JavaDoc: "The <code class="classname">BusinessLifeCycleManager</code> interface, which is exposed by the Registry Service, implements the life cycle management functionality of the Registry as part of a business level API. There is no authentication information provided, because the Connection interface keeps that state and context on behalf of the client."
						</div></li><li class="listitem"><div class="para">
							<a href="http://java.sun.com/javaee/5/docs/api/javax/xml/registry/BusinessQueryManager.html">javax.xml.registry.BusinessQueryManager</a> From J2EE 5.0 JavaDoc: "The <code class="classname">BusinessQueryManager</code> interface, which is exposed by the Registry Service, implements the business style query interface. It is also referred to as the focused query interface."
						</div></li></ul></div><div class="para">
					Let us now look at some of the common programming tasks performed while using the JAXR API:
				</div><div class="para">
					Getting a JAXR Connection to the registry.
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>String queryurl = System.<span xmlns="" class="perl_Function">getProperty</span>(<span xmlns="" class="perl_String">"jaxr.query.url"</span>, <span xmlns="" class="perl_String">"http://localhost:8080/juddi/inquiry"</span>);
<span xmlns="" class="line">​</span>String puburl = System.<span xmlns="" class="perl_Function">getProperty</span>(<span xmlns="" class="perl_String">"jaxr.publish.url"</span>, <span xmlns="" class="perl_String">"http://localhost:8080/juddi/publish"</span>);
<span xmlns="" class="line">​</span>.. 
<span xmlns="" class="line">​</span>Properties props = <span xmlns="" class="perl_Keyword">new</span> Properties();
<span xmlns="" class="line">​</span>props.<span xmlns="" class="perl_Function">setProperty</span>(<span xmlns="" class="perl_String">"javax.xml.registry.queryManagerURL"</span>, queryurl);
<span xmlns="" class="line">​</span>props.<span xmlns="" class="perl_Function">setProperty</span>(<span xmlns="" class="perl_String">"javax.xml.registry.lifeCycleManagerURL"</span>, puburl);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>String transportClass = System.<span xmlns="" class="perl_Function">getProperty</span>(<span xmlns="" class="perl_String">"scout.proxy.transportClass"</span>, <span xmlns="" class="perl_String">"org.jboss.jaxr.scout.transport.SaajTransport"</span>);
<span xmlns="" class="line">​</span>System.<span xmlns="" class="perl_Function">setProperty</span>(<span xmlns="" class="perl_String">"scout.proxy.transportClass"</span>, transportClass);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">// Create the connection, passing it the configuration properties</span>
<span xmlns="" class="line">​</span>factory = ConnectionFactory.<span xmlns="" class="perl_Function">newInstance</span>();
<span xmlns="" class="line">​</span>factory.<span xmlns="" class="perl_Function">setProperties</span>(props);
<span xmlns="" class="line">​</span>connection = factory.<span xmlns="" class="perl_Function">createConnection</span>();
</pre><div class="para">
					Authentication with the registry.
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * Does authentication with the uddi registry</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">protected</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">login</span>() <span xmlns="" class="perl_Keyword">throws</span> JAXRException
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   PasswordAuthentication passwdAuth = <span xmlns="" class="perl_Keyword">new</span> PasswordAuthentication(userid, passwd.<span xmlns="" class="perl_Function">toCharArray</span>());
<span xmlns="" class="line">​</span>   Set creds = <span xmlns="" class="perl_Keyword">new</span> HashSet();
<span xmlns="" class="line">​</span>   creds.<span xmlns="" class="perl_Function">add</span>(passwdAuth);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   connection.<span xmlns="" class="perl_Function">setCredentials</span>(creds);
<span xmlns="" class="line">​</span>}
</pre><div class="para">
					Save a Business
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * Creates a Jaxr Organization with 1 or more services</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">protected</span> Organization <span xmlns="" class="perl_Function">createOrganization</span>(String orgname) <span xmlns="" class="perl_Keyword">throws</span> JAXRException
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   Organization org = blm.<span xmlns="" class="perl_Function">createOrganization</span>(<span xmlns="" class="perl_Function">getIString</span>(orgname));
<span xmlns="" class="line">​</span>   org.<span xmlns="" class="perl_Function">setDescription</span>(<span xmlns="" class="perl_Function">getIString</span>(<span xmlns="" class="perl_String">"JBoss Inc"</span>));
<span xmlns="" class="line">​</span>   Service service = blm.<span xmlns="" class="perl_Function">createService</span>(<span xmlns="" class="perl_Function">getIString</span>(<span xmlns="" class="perl_String">"JBOSS JAXR Service"</span>));
<span xmlns="" class="line">​</span>   service.<span xmlns="" class="perl_Function">setDescription</span>(<span xmlns="" class="perl_Function">getIString</span>(<span xmlns="" class="perl_String">"Services of XML Registry"</span>));
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">//Create serviceBinding</span>
<span xmlns="" class="line">​</span>   ServiceBinding serviceBinding = blm.<span xmlns="" class="perl_Function">createServiceBinding</span>();
<span xmlns="" class="line">​</span>   serviceBinding.<span xmlns="" class="perl_Function">setDescription</span>(blm.<span xmlns="" class="perl_Function">createInternationalString</span>(<span xmlns="" class="perl_String">"Test Service Binding"</span>));
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">//Turn validation of URI off</span>
<span xmlns="" class="line">​</span>   serviceBinding.<span xmlns="" class="perl_Function">setValidateURI</span>(<span xmlns="" class="perl_Keyword">false</span>);
<span xmlns="" class="line">​</span>   serviceBinding.<span xmlns="" class="perl_Function">setAccessURI</span>(<span xmlns="" class="perl_String">"http://testjboss.org"</span>);
<span xmlns="" class="line">​</span>   ...
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">// Add the serviceBinding to the service</span>
<span xmlns="" class="line">​</span>   service.<span xmlns="" class="perl_Function">addServiceBinding</span>(serviceBinding);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   User user = blm.<span xmlns="" class="perl_Function">createUser</span>();
<span xmlns="" class="line">​</span>   org.<span xmlns="" class="perl_Function">setPrimaryContact</span>(user);
<span xmlns="" class="line">​</span>   PersonName personName = blm.<span xmlns="" class="perl_Function">createPersonName</span>(<span xmlns="" class="perl_String">"Anil S"</span>);
<span xmlns="" class="line">​</span>   TelephoneNumber telephoneNumber = blm.<span xmlns="" class="perl_Function">createTelephoneNumber</span>();
<span xmlns="" class="line">​</span>   telephoneNumber.<span xmlns="" class="perl_Function">setNumber</span>(<span xmlns="" class="perl_String">"111-111-7777"</span>);
<span xmlns="" class="line">​</span>   telephoneNumber.<span xmlns="" class="perl_Function">setType</span>(<span xmlns="" class="perl_Keyword">null</span>);
<span xmlns="" class="line">​</span>   PostalAddress address = blm.<span xmlns="" class="perl_Function">createPostalAddress</span>(<span xmlns="" class="perl_String">"111"</span>, <span xmlns="" class="perl_String">"My Drive"</span>, <span xmlns="" class="perl_String">"BuckHead"</span>, <span xmlns="" class="perl_String">"GA"</span>, <span xmlns="" class="perl_String">"USA"</span>, <span xmlns="" class="perl_String">"1111-111"</span>, <span xmlns="" class="perl_String">""</span>);
<span xmlns="" class="line">​</span>   Collection postalAddresses = <span xmlns="" class="perl_Keyword">new</span> ArrayList();
<span xmlns="" class="line">​</span>   postalAddresses.<span xmlns="" class="perl_Function">add</span>(address);
<span xmlns="" class="line">​</span>   Collection emailAddresses = <span xmlns="" class="perl_Keyword">new</span> ArrayList();
<span xmlns="" class="line">​</span>   EmailAddress emailAddress = blm.<span xmlns="" class="perl_Function">createEmailAddress</span>(<span xmlns="" class="perl_String">"anil@apache.org"</span>);
<span xmlns="" class="line">​</span>   emailAddresses.<span xmlns="" class="perl_Function">add</span>(emailAddress);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   Collection numbers = <span xmlns="" class="perl_Keyword">new</span> ArrayList();
<span xmlns="" class="line">​</span>   numbers.<span xmlns="" class="perl_Function">add</span>(telephoneNumber);
<span xmlns="" class="line">​</span>   user.<span xmlns="" class="perl_Function">setPersonName</span>(personName);
<span xmlns="" class="line">​</span>   user.<span xmlns="" class="perl_Function">setPostalAddresses</span>(postalAddresses);
<span xmlns="" class="line">​</span>   user.<span xmlns="" class="perl_Function">setEmailAddresses</span>(emailAddresses);
<span xmlns="" class="line">​</span>   user.<span xmlns="" class="perl_Function">setTelephoneNumbers</span>(numbers);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>   ClassificationScheme cScheme = <span xmlns="" class="perl_Function">getClassificationScheme</span>(<span xmlns="" class="perl_String">"ntis-gov:naics"</span>, <span xmlns="" class="perl_String">""</span>);
<span xmlns="" class="line">​</span>   Key cKey = blm.<span xmlns="" class="perl_Function">createKey</span>(<span xmlns="" class="perl_String">"uuid:C0B9FE13-324F-413D-5A5B-2004DB8E5CC2"</span>);
<span xmlns="" class="line">​</span>   cScheme.<span xmlns="" class="perl_Function">setKey</span>(cKey);
<span xmlns="" class="line">​</span>   Classification classification = blm.<span xmlns="" class="perl_Function">createClassification</span>(cScheme, <span xmlns="" class="perl_String">"Computer Systems Design and Related Services"</span>, <span xmlns="" class="perl_String">"5415"</span>);
<span xmlns="" class="line">​</span>   org.<span xmlns="" class="perl_Function">addClassification</span>(classification);
<span xmlns="" class="line">​</span>   ClassificationScheme cScheme1 = <span xmlns="" class="perl_Function">getClassificationScheme</span>(<span xmlns="" class="perl_String">"D-U-N-S"</span>, <span xmlns="" class="perl_String">""</span>);
<span xmlns="" class="line">​</span>   Key cKey1 = blm.<span xmlns="" class="perl_Function">createKey</span>(<span xmlns="" class="perl_String">"uuid:3367C81E-FF1F-4D5A-B202-3EB13AD02423"</span>);
<span xmlns="" class="line">​</span>   cScheme1.<span xmlns="" class="perl_Function">setKey</span>(cKey1);
<span xmlns="" class="line">​</span>   ExternalIdentifier ei = blm.<span xmlns="" class="perl_Function">createExternalIdentifier</span>(cScheme1, <span xmlns="" class="perl_String">"D-U-N-S number"</span>, <span xmlns="" class="perl_String">"08-146-6849"</span>);
<span xmlns="" class="line">​</span>   org.<span xmlns="" class="perl_Function">addExternalIdentifier</span>(ei);
<span xmlns="" class="line">​</span>   org.<span xmlns="" class="perl_Function">addService</span>(service);
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">return</span> org;
<span xmlns="" class="line">​</span>}
</pre><div class="para">
					Query a Business
				</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * Locale aware Search a business in the registry</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">searchBusiness</span>(String bizname) <span xmlns="" class="perl_Keyword">throws</span> JAXRException
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">try</span>
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Comment">// Get registry service and business query manager</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">getJAXREssentials</span>();
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Comment">// Define find qualifiers and name patterns</span>
<span xmlns="" class="line">​</span>      Collection findQualifiers = <span xmlns="" class="perl_Keyword">new</span> ArrayList();
<span xmlns="" class="line">​</span>      findQualifiers.<span xmlns="" class="perl_Function">add</span>(FindQualifier.<span xmlns="" class="perl_Function">SORT_BY_NAME_ASC</span>);
<span xmlns="" class="line">​</span>      Collection namePatterns = <span xmlns="" class="perl_Keyword">new</span> ArrayList();
<span xmlns="" class="line">​</span>      String pattern = <span xmlns="" class="perl_String">"%"</span> + bizname + <span xmlns="" class="perl_String">"%"</span>;
<span xmlns="" class="line">​</span>      LocalizedString ls = blm.<span xmlns="" class="perl_Function">createLocalizedString</span>(Locale.<span xmlns="" class="perl_Function">getDefault</span>(), pattern);
<span xmlns="" class="line">​</span>      namePatterns.<span xmlns="" class="perl_Function">add</span>(ls);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Comment">// Find based upon qualifier type and values</span>
<span xmlns="" class="line">​</span>      BulkResponse response = bqm.<span xmlns="" class="perl_Function">findOrganizations</span>(findQualifiers, namePatterns, <span xmlns="" class="perl_Keyword">null</span>, <span xmlns="" class="perl_Keyword">null</span>, <span xmlns="" class="perl_Keyword">null</span>, <span xmlns="" class="perl_Keyword">null</span>);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Comment">// check how many organization we have matched</span>
<span xmlns="" class="line">​</span>      Collection orgs = response.<span xmlns="" class="perl_Function">getCollection</span>();
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">if</span> (orgs == <span xmlns="" class="perl_Keyword">null</span>)
<span xmlns="" class="line">​</span>      {
<span xmlns="" class="line">​</span>         log.<span xmlns="" class="perl_Function">debug</span>(<span xmlns="" class="perl_String">" -- Matched 0 orgs"</span>);
<span xmlns="" class="line">​</span>      }
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">else</span>
<span xmlns="" class="line">​</span>      {
<span xmlns="" class="line">​</span>         log.<span xmlns="" class="perl_Function">debug</span>(<span xmlns="" class="perl_String">" -- Matched "</span> + orgs.<span xmlns="" class="perl_Function">size</span>() + <span xmlns="" class="perl_String">" organizations -- "</span>);
<span xmlns="" class="line">​</span>  
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Comment">// then step through them</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">for</span> (Iterator orgIter = orgs.<span xmlns="" class="perl_Function">iterator</span>(); orgIter.<span xmlns="" class="perl_Function">hasNext</span>();)
<span xmlns="" class="line">​</span>         {
<span xmlns="" class="line">​</span>            Organization org = (Organization)orgIter.<span xmlns="" class="perl_Function">next</span>();
<span xmlns="" class="line">​</span>            log.<span xmlns="" class="perl_Function">debug</span>(<span xmlns="" class="perl_String">"Org name: "</span> + <span xmlns="" class="perl_Function">getName</span>(org));
<span xmlns="" class="line">​</span>            log.<span xmlns="" class="perl_Function">debug</span>(<span xmlns="" class="perl_String">"Org description: "</span> + <span xmlns="" class="perl_Function">getDescription</span>(org));
<span xmlns="" class="line">​</span>            log.<span xmlns="" class="perl_Function">debug</span>(<span xmlns="" class="perl_String">"Org key id: "</span> + <span xmlns="" class="perl_Function">getKey</span>(org));
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Function">checkUser</span>(org);
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Function">checkServices</span>(org);
<span xmlns="" class="line">​</span>         }
<span xmlns="" class="line">​</span>      }
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">finally</span>
<span xmlns="" class="line">​</span>   {
<span xmlns="" class="line">​</span>      connection.<span xmlns="" class="perl_Function">close</span>();
<span xmlns="" class="line">​</span>   }
<span xmlns="" class="line">​</span>}
</pre><div class="para">
					For more examples of code using the JAXR API, please refer to the resources in the Resources Section.
				</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776752742528">
      ⁠</a>10.21.3.4. Troubleshooting</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							<span class="bold bold"><strong>I cannot connect to the registry from JAXR.</strong></span> Please check the inquiry and publish url passed to the JAXR ConnectionFactory.
						</div></li><li class="listitem"><div class="para">
							<span class="bold bold"><strong>I cannot connect to the jUDDI registry.</strong></span> Please check the jUDDI configuration and see if there are any errors in the server.log. And also remember that the jUDDI registry is available only in the "all" configuration.
						</div></li><li class="listitem"><div class="para">
							<span class="bold bold"><strong>I cannot authenticate to the jUDDI registry.</strong></span> Have you added an authorized user to the jUDDI database, as described earlier in the chapter?
						</div></li><li class="listitem"><div class="para">
							<span class="bold bold"><strong>I would like to view the SOAP messages in transit between the client and the UDDI Registry.</strong></span> Please use the tcpmon tool to view the messages in transit. <a href="http://tcpmon.dev.java.net/">TCPMon</a>
						</div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776748593056">
      ⁠</a>10.21.3.5. Resources</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
							<a href="http://java.sun.com/webservices/jaxr/learning/tutorial/index.html">JAXR Tutorial and Code Camps</a>
						</div></li><li class="listitem"><div class="para">
							<a href="http://java.sun.com/j2ee/1.4/docs/tutorial/doc/">J2EE 1.4 Tutorial</a>
						</div></li><li class="listitem"><div class="para">
							<a href="http://www.amazon.com/exec/obidos/ASIN/0321146182">J2EE Web Services by Richard Monson-Haefel</a>
						</div></li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776749830448">
      ⁠</a>10.22. JBossWS Extensions</h1></div></div></div><div class="para">
			This section describes proprietary JBoss extensions to JAX-WS.
		</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="idm139776756367792">
      ⁠</a>10.22.1. Proprietary Annotations</h2></div></div></div><div class="para">
				For the set of standard annotations, please have a look at <a href="http://www.jboss.org/community/wiki/JBossWS-JAX-WSAnnotations">JAX-WS Annotations</a>
			</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776756365632">
      ⁠</a>10.22.1.1. EndpointConfig</h3></div></div></div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * Defines an endpoint or client configuration. </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * This annotation is valid on an endpoint implementaion bean or a SEI.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Retention</span>(value = RetentionPolicy.<span xmlns="" class="perl_Function">RUNTIME</span>)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Target</span>(value = { ElementType.<span xmlns="" class="perl_Function">TYPE</span> })
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">@interface</span> EndpointConfig
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">... </span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * The optional config-name element gives the configuration name that must be present in</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * the configuration given by element config-file.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * Server side default: Standard Endpoint</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * Client side default: Standard Client</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    */</span>
<span xmlns="" class="line">​</span>   String <span xmlns="" class="perl_Function">configName</span>() <span xmlns="" class="perl_Keyword">default</span> <span xmlns="" class="perl_String">""</span>;
<span xmlns="" class="line">​</span>   ...
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * The optional config-file element is a URL or resource name for the configuration.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    *</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * Server side default: standard-jaxws-endpoint-config.xml</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * Client side default: standard-jaxws-client-config.xml</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    */</span>
<span xmlns="" class="line">​</span>   String <span xmlns="" class="perl_Function">configFile</span>() <span xmlns="" class="perl_Keyword">default</span> <span xmlns="" class="perl_String">""</span>;
<span xmlns="" class="line">​</span>}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776755007120">
      ⁠</a>10.22.1.2. WebContext</h3></div></div></div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * Provides web context specific meta data to EJB based web service endpoints.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> *</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * </span><span xmlns="" class="perl_Keyword">@author </span><span xmlns="" class="perl_Comment">thomas.diesler@jboss.org</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * </span><span xmlns="" class="perl_Keyword">@since </span><span xmlns="" class="perl_Comment">26-Apr-2005</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Retention</span>(value = RetentionPolicy.<span xmlns="" class="perl_Function">RUNTIME</span>)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Target</span>(value = { ElementType.<span xmlns="" class="perl_Function">TYPE</span> })
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">@interface</span> WebContext
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">... </span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">/** </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * The contextRoot element specifies the context root that the web service endpoint is deployed to.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * If it is not specified it will be derived from the deployment short name.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * Applies to server side port components only. </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    */</span>
<span xmlns="" class="line">​</span>   String <span xmlns="" class="perl_Function">contextRoot</span>() <span xmlns="" class="perl_Keyword">default</span> <span xmlns="" class="perl_String">""</span>;
<span xmlns="" class="line">​</span>   ...
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">/** </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * The virtual hosts that the web service endpoint is deployed to.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * Applies to server side port components only.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    */</span>
<span xmlns="" class="line">​</span>   String[] <span xmlns="" class="perl_Function">virtualHosts</span>() <span xmlns="" class="perl_Keyword">default</span> {};
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">/** </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * Relative path that is appended to the contextRoot to form fully qualified</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * endpoint address for the web service endpoint.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * Applies to server side port components only. </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    */</span>
<span xmlns="" class="line">​</span>   String <span xmlns="" class="perl_Function">urlPattern</span>() <span xmlns="" class="perl_Keyword">default</span> <span xmlns="" class="perl_String">""</span>;
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * The authMethod is used to configure the authentication mechanism for the web service. </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * As a prerequisite to gaining access to any web service which are protected by an authorization</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * constraint, a user must have authenticated using the configured mechanism.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    *</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * Legal values for this element are "BASIC", or "CLIENT-CERT".</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    */</span>
<span xmlns="" class="line">​</span>   String <span xmlns="" class="perl_Function">authMethod</span>() <span xmlns="" class="perl_Keyword">default</span> <span xmlns="" class="perl_String">""</span>;
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * The transportGuarantee specifies that the communication</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * between client and server should be NONE, INTEGRAL, or</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * CONFIDENTIAL. NONE means that the application does not require any</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * transport guarantees. A value of INTEGRAL means that the application</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * requires that the data sent between the client and server be sent in</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * such a way that it can not be changed in transit. CONFIDENTIAL means</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * that the application requires that the data be transmitted in a</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * fashion that prevents other entities from observing the contents of</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * the transmission. In most cases, the presence of the INTEGRAL or</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * CONFIDENTIAL flag will indicate that the use of SSL is required.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    */</span>
<span xmlns="" class="line">​</span>   String <span xmlns="" class="perl_Function">transportGuarantee</span>() <span xmlns="" class="perl_Keyword">default</span> <span xmlns="" class="perl_String">""</span>;
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * A secure endpoint does not by default publish it's wsdl on an unsecure transport.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * You can override this behavior by explicitly setting the secureWSDLAccess flag to false.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * Protect access to WSDL. See http://jira.jboss.org/jira/browse/JBWS-723   </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    */</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_DataType">boolean</span> <span xmlns="" class="perl_Function">secureWSDLAccess</span>() <span xmlns="" class="perl_Keyword">default</span> <span xmlns="" class="perl_Keyword">true</span>;
<span xmlns="" class="line">​</span>}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm139776754765488">
      ⁠</a>10.22.1.3. SecurityDomain</h3></div></div></div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * Annotation for specifying the JBoss security domain for an EJB</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Target</span>(ElementType.<span xmlns="" class="perl_Function">TYPE</span>) @<span xmlns="" class="perl_Function">Retention</span>(RetentionPolicy.<span xmlns="" class="perl_Function">RUNTIME</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">@interface</span> SecurityDomain
<span xmlns="" class="line">​</span>{
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * The required name for the security domain.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * Do not use the JNDI name</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    *    Good: "MyDomain"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    *    Bad:  "java:/jaas/MyDomain"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    */</span>
<span xmlns="" class="line">​</span>   String <span xmlns="" class="perl_Function">value</span>();
<span xmlns="" class="line">​</span>   
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    * The name for the unauthenticated pricipal</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    */</span>
<span xmlns="" class="line">​</span>   String <span xmlns="" class="perl_Function">unauthenticatedPrincipal</span>() <span xmlns="" class="perl_Keyword">default</span> <span xmlns="" class="perl_String">""</span>;
<span xmlns="" class="line">​</span>}</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776725888320">
      ⁠</a>10.23. Web Services Appendix</h1></div></div></div><div class="para">
			<div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					This information can be used with JBoss Web Services CXF Stack.
				</div></div></div>

		</div><div class="para">
			<a href="http://www.jboss.org/community/wiki/JBossWS-JAX-WSEndpointConfiguration">JAX-WS Endpoint Configuration</a>
		</div><div class="para">
			<a href="http://www.jboss.org/community/wiki/JBossWS-JAX-WSClientConfiguration">JAX-WS Client Configuration</a>
		</div><div class="para">
			<a href="http://www.jboss.org/community/wiki/JBossWS-JAX-WSAnnotations">JAX-WS Annotations</a>
		</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139776764889120">
      ⁠</a>10.24. References</h1></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
					<a href="http://www.jcp.org/en/jsr/detail?id=224">JSR-224 - Java API for XML-Based Web Services (JAX-WS) 2.0</a>
				</div></li><li class="listitem"><div class="para">
					<a href="http://jaxb.dev.java.net/">JSR 222 - Java Architecture for XML Binding (JAXB) 2.0</a>
				</div></li><li class="listitem"><div class="para">
					<a href="http://jcp.org/en/jsr/detail?id=250">JSR-250 - Common Annotations for the Java Platform</a>
				</div></li><li class="listitem"><div class="para">
					<a href="http://jcp.org/en/jsr/detail?id=181">JSR 181 - Web Services Metadata for the Java Platform</a>
				</div></li></ol></div></div></div></body></html>