<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 16. Configuring the NSAPI connector on Solaris</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idm139711976050800">
      ⁠</a>Chapter 16. Configuring the NSAPI connector on Solaris</h1></div></div></div><div class="para">
			The following tasks describe how to configure the NSAPI connector to use a JBoss Enterprise Application Platform instance as a worker node for a Sun Java System Web Server (SJWS) master node. Sun Java System Web Server has been renamed to the Oracle iPlanet Web Server. The old name is used throughout this guide for clarity.
		</div><div class="para">
			In this section, all of the server instances are on the same machine. To use different machines for each instance, use the <code class="code">-b</code> switch to bind your instance of JBoss Enterprise Application Platform to a public IP address. Remember to edit the <code class="filename">workers.properties</code> file on the SJWS machine to reflect these changes in IP address.
		</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="NSAPI_Prerequisites_Configuration_Assumptions">
      ⁠</a>16.1. Prerequisites and configuration assumptions</h1></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						Worker nodes are already installed with JBoss Enterprise Application Platform 5.2 or later. The Native components are not a requirement of the NSAPI connector. Refer to the <em class="citetitle"> Installation Guide </em> for assistance with this prerequisite.
					</div></li><li class="listitem"><div class="para">
						The master node is already installed with one of the following technology combinations, and the appropriate Native binary for its operating system and architecture. Refer to the <em class="citetitle"> Installation Guide </em> for assistance with this installation prerequisite.
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								Solaris 10 x86 with Sun Java System Web Server 7.0 U8
							</div></li><li class="listitem"><div class="para">
								Solaris 10 SPARC 64 with Sun Java System Web Server 7.0 U8
							</div></li></ul></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139711974155872">
      ⁠</a>16.2. Configure server instance as a worker node</h1></div></div></div><div class="task"><a id="task-Configure_JBoss_EAP_Worker_Node_SJWS">
      ⁠</a><p class="title"><strong>Task: Configure a JBoss Enterprise Application Platform Worker Node</strong></p><div class="tasksummary"> <div class="para">
				Follow this task to correctly configure a JBoss Enterprise Application Platform instance as a SJWS worker node.
			</div>
			 </div><div class="taskprerequisites"><a id="idm139711974152912">
      ⁠</a><p class="title"><strong>Prerequisites</strong></p><div class="taskprerequisites-contents"> 
			 <div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a class="xref" href="ch16.html#NSAPI_Prerequisites_Configuration_Assumptions">Section 16.1, “Prerequisites and configuration assumptions”</a>
					</div></li></ul></div>
			 </div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Create a server profile for each worker node</strong></p><div class="para">
						Make a copy of the server profile that you wish to configure as a worker node. (This procedure uses the <code class="literal">default</code> server profile.)
					</div><pre class="screen">[user@workstation jboss-ep-5.2]$ cd jboss-as/server
[user@workstation server]$ cp -r default/ default-01
[user@workstation server]$ cp -r default/ default-02</pre></li><li class="step"><p class="title"><strong>Give each instance a unique name</strong></p><div class="para">
						Edit the following line in the <code class="filename">deploy/jbossweb.sar/server.xml</code> file of each new worker instance:
					</div><pre class="screen"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;Engine</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jboss.web"</span><span xmlns="" class="perl_Others"> defaultHost=</span><span xmlns="" class="perl_String">"localhost"</span><span xmlns="" class="perl_Keyword">&gt;</span></pre><div class="para">
						Add a unique <code class="varname"> jvmRoute </code> value, as shown. This value is the identifier for this node in the cluster.
					</div><div class="para">
						For the <code class="literal">default-01</code> server profile:
					</div><pre class="screen XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;Engine</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jboss.web"</span><span xmlns="" class="perl_Others"> defaultHost=</span><span xmlns="" class="perl_String">"localhost"</span><span xmlns="" class="perl_Others"> jvmRoute=</span><span xmlns="" class="perl_String">"worker01"</span><span xmlns="" class="perl_Keyword">&gt;</span></pre><div class="para">
						For the <code class="literal">default-02</code> server profile:
					</div><pre class="screen"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;Engine</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jboss.web"</span><span xmlns="" class="perl_Others"> defaultHost=</span><span xmlns="" class="perl_String">"localhost"</span><span xmlns="" class="perl_Others"> jvmRoute=</span><span xmlns="" class="perl_String">"worker02"</span><span xmlns="" class="perl_Keyword">&gt;</span></pre></li><li class="step"><p class="title"><strong>Enable session handling</strong></p><div class="para">
						Uncomment the following line in the <code class="filename">deployers/jbossweb.deployer/META-INF/war-deployers-jboss-beans.xml</code> file of each worker node:
					</div><pre class="screen"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"useJK"</span><span xmlns="" class="perl_Keyword">&gt;</span>false<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span></pre><div class="para">
						This property controls whether special session handling is used to coordinate with mod_jk and other connector variants. Set this property to <code class="literal">true</code> in both worker nodes:
					</div><pre class="screen"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"useJK"</span><span xmlns="" class="perl_Keyword">&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span></pre></li><li class="step"><p class="title"><strong>Start your worker nodes</strong></p><div class="para">
						Start each worker node in a separate command line interface. Ensure that each node is bound to a different IP address with the <code class="code">-b</code> switch.
					</div><pre class="screen">[user@workstation jboss-eap-5.2]$ ./jboss-as/bin/run.sh -b 127.0.0.1 -c default-01</pre><pre class="screen">[user@workstation jboss-eap-5.2]$ ./jboss-as/bin/run.sh -b 127.0.0.100 -c default-02</pre></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139711933624464">
      ⁠</a>16.3. Initial clustering configuration</h1></div></div></div><div class="task"><a id="task-Configure_Initial_Clustering_Behavior_NSAPI">
      ⁠</a><p class="title"><strong>Task: Configure Required Elements</strong></p><div class="tasksummary"> <div class="para">
				Complete this task to configure the basic elements required for clustering using Sun Java Web Server (SJWS) and NSAPI.
			</div>
			 </div><div class="taskprerequisites"><a id="idm139711990826864">
      ⁠</a><p class="title"><strong>Prerequisites</strong></p><div class="taskprerequisites-contents"> 
			 <div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a class="xref" href="ch16.html#task-Configure_JBoss_EAP_Worker_Node_SJWS">Task: Configure a JBoss Enterprise Application Platform Worker Node</a>
					</div></li><li class="listitem"><div class="para">
						Native zip archive extracted to the directory <code class="filename">/tmp/connectors/</code>. The directory <code class="filename">/tmp/connectors/jboss-ep-5.2/native/</code> is referred to as <em class="replaceable">NATIVE</em> in this procedure.
					</div></li><li class="listitem"><div class="para">
						The directory <code class="filename">/tmp/connectors</code> is used as the storage location for logs, properties files, and NSAPI locks.
					</div></li><li class="listitem"><div class="para">
						SJWS is installed in one of the locations specified in the <em class="replaceable">SJWS</em> file path abbreviation in <a class="xref" href="Preface.html#File_Name_Conventions">Section 1, “File Name Conventions”</a>.
					</div></li></ul></div>
			 </div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Disable servlet mappings</strong></p><div class="para">
						Under <span class="emphasis"><em>Built In Servlet Mappings</em></span> in the <code class="filename"><em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/config/default-web.xml</code> file, disable the mappings for the following servlets, by commenting them out as shown:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								default
							</div></li><li class="listitem"><div class="para">
								invoker
							</div></li><li class="listitem"><div class="para">
								jsp
							</div></li></ul></div><pre class="screen XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- ==================== Built In Servlet Mappings ===================== --&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- The servlet mappings for the built in servlets defined above. --&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- The mapping for the default servlet --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!--servlet-mapping&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> &lt;servlet-name&gt;default&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> &lt;url-pattern&gt;/&lt;/url-pattern&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;/servlet-mapping--&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- The mapping for the invoker servlet --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!--servlet-mapping&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> &lt;servlet-name&gt;invoker&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> &lt;url-pattern&gt;/servlet/*&lt;/url-pattern&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;/servlet-mapping--&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- The mapping for the JSP servlet --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!--servlet-mapping&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> &lt;servlet-name&gt;jsp&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> &lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;/servlet-mapping--&gt;</span></pre></li><li class="step"><a id="init-load-mod">
      ⁠</a><p class="title"><strong>Load the required modules and properties</strong></p><div class="para">
						Append the following lines to the <code class="filename"><em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/config/magnus.conf</code> file:
					</div><pre class="screen">Init fn="load-modules" funcs="jk_init,jk_service" shlib="<em class="replaceable">NATIVE</em>/lib/nsapi_redirector.so" shlib_flags="(global|now)"
Init fn="jk_init" worker_file="/tmp/connectors/workers.properties" log_level="debug" log_file="/tmp/connectors/nsapi.log" shm_file="/tmp/connectors/jk_shm"</pre><div class="para">
						These lines define the location of the <code class="filename">nsapi_redirector.so</code> module used by the <code class="literal">jk_init</code> and <code class="literal">jk_service</code> functions, and the location of the <code class="filename">workers.properties</code> file, which defines the worker nodes and their attributes.
					</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							The <code class="filename">lib</code> directory in the <code class="filename"><em class="replaceable">NATIVE</em>/lib/nsapi_redirector.so</code> path applies only to 32-bit machines. On 64-bit machines, this directory is called <code class="filename">lib64</code>.
						</div></div></div></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139711986885952">
      ⁠</a>16.4. Configure a basic cluster with NSAPI</h1></div></div></div><div class="task"><a id="task-Configure_Basic_Cluster_NSAPI">
      ⁠</a><p class="title"><strong>Task: Configure a Basic Cluster with NSAPI</strong></p><div class="tasksummary"> <div class="para">
				Complete this task to configure a basic cluster, where requests for particular paths are forwarded to particular worker nodes. The procedure specifies that worker02 serves the <code class="literal">/nc</code> path, while worker01 serves <code class="literal">/status</code> and all other paths defined in the first part of the <code class="filename">obj.conf</code> file.
			</div>
			 </div><div class="taskprerequisites"><a id="idm139711986881568">
      ⁠</a><p class="title"><strong>Prerequisites</strong></p><div class="taskprerequisites-contents"> 
			 <div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a class="xref" href="ch16.html#task-Configure_Initial_Clustering_Behavior_NSAPI">Task: Configure Required Elements</a>
					</div></li><li class="listitem"><div class="para">
						SJWS is installed in one of the locations specified in the <em class="replaceable">SJWS</em> file path abbreviation in <a class="xref" href="Preface.html#File_Name_Conventions">Section 1, “File Name Conventions”</a>.
					</div></li></ul></div>
			 </div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="proc-basic-cluster">
      ⁠</a><ol class="1"><li class="step"><p class="title"><strong>Define the paths to serve via NSAPI</strong></p><div class="para">
						Edit the <code class="filename"><em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/config/obj.conf</code> file. Define paths that should be served via NSAPI at the end of the <code class="literal">default</code> Object definition, as shown:
					</div><pre class="screen XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;Object</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"default"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      [...]
<span xmlns="" class="line">​</span>   NameTrans fn="assign-name" from="/status" name="jknsapi"
<span xmlns="" class="line">​</span>   NameTrans fn="assign-name" from="/images(|/*)" name="jknsapi"
<span xmlns="" class="line">​</span>   NameTrans fn="assign-name" from="/css(|/*)" name="jknsapi"
<span xmlns="" class="line">​</span>   NameTrans fn="assign-name" from="/nc(|/*)" name="jknsapi"
<span xmlns="" class="line">​</span>   NameTrans fn="assign-name" from="/jmx-console(|/*)" name="jknsapi"
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/Object&gt;</span></pre><div class="para">
						You can map the path of any application deployed on your JBoss Enterprise Platform instance in this <code class="filename">obj.conf</code> file. In the example code, the <code class="literal">/nc</code> path is mapped to an application deployed under the name <code class="literal">nc</code>.
					</div></li><li class="step"><p class="title"><strong>Define the worker that serves each path</strong></p><div class="para">
						Edit the <code class="filename"><em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/config/obj.conf</code> file and add the following <code class="literal">jknsapi</code> Object definition after the <code class="literal">default</code> Object definition.
					</div><pre class="screen XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;Object</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jknsapi"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   ObjectType fn=force-type type=text/plain
<span xmlns="" class="line">​</span>   Service fn="jk_service" worker="worker01" path="/status"
<span xmlns="" class="line">​</span>   Service fn="jk_service" worker="worker02" path="/nc(/*)"
<span xmlns="" class="line">​</span>   Service fn="jk_service" worker="worker01"
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/Object&gt;</span></pre><div class="para">
						This <code class="literal">jknsapi</code> Object defines the worker nodes used to serve each path that was assigned to <code class="code">name="jknsapi"</code> in the <code class="literal">default</code> Object.
					</div><div class="para">
						In the example code, the third Service definition does not specify a <code class="varname"> path </code> value, so the worker node defined (<code class="literal">worker01</code>) serves all of the paths assigned to <code class="literal">jknsapi</code> by default. In this case, the first Service definition in the example code, which assigns the <code class="literal">/status</code> path to <code class="literal">worker01</code>, is superfluous.
					</div></li><li class="step"><p class="title"><strong>Define the workers and their attributes</strong></p><div class="para">
						Create a <code class="filename">workers.properties</code> file in the location you defined in <a class="xref" href="ch16.html#init-load-mod">Step 2</a>.
					</div><div class="para">
						Define the list of worker nodes and each worker node's properties in this file:
					</div><pre class="screen"># An entry that lists all the workers defined
worker.list=worker01, worker02

# Entries that define the host and port associated with these workers
worker.worker01.host=127.0.0.1
worker.worker01.port=8009
worker.worker01.type=ajp13

worker.worker02.host=127.0.0.100
worker.worker02.port=8009
worker.worker02.type=ajp13</pre></li><li class="step"><p class="title"><strong>Restart the server</strong></p><div class="para">
						Once your Sun Java System Web Server instance is configured, restart it so that your changes take effect.
					</div><div class="para">
						For Sun Java System Web Server 6.1:
					</div><pre class="screen"><em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/stop
<em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/start</pre><div class="para">
						For Sun Java System Web Server 7.0:
					</div><pre class="screen"><em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/bin/stopserv
<em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/bin/startserv</pre></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="idm139711962035904">
      ⁠</a>16.5. Configure a load-balanced cluster with NSAPI</h1></div></div></div><div class="task"><p class="title"><strong>Task: Configure a Load-balanced Cluster with NSAPI</strong></p><div class="tasksummary"> <div class="para">
				Complete this task to configure a load-balanced cluster consisting of two worker nodes.
			</div>
			 </div><div class="taskprerequisites"><a id="idm139711985462512">
      ⁠</a><p class="title"><strong>Prerequisites</strong></p><div class="taskprerequisites-contents"> 
			 <div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a class="xref" href="ch16.html#task-Configure_Initial_Clustering_Behavior_NSAPI">Task: Configure Required Elements</a>
					</div></li><li class="listitem"><div class="para">
						SJWS is installed in one of the locations specified in the <em class="replaceable">SJWS</em> file path abbreviation in <a class="xref" href="Preface.html#File_Name_Conventions">Section 1, “File Name Conventions”</a>.
					</div></li></ul></div>
			 </div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="proc-lb-cluster">
      ⁠</a><ol class="1"><li class="step"><p class="title"><strong>Define the paths to serve via NSAPI</strong></p><div class="para">
						Open <code class="filename"><em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/config/obj.conf</code> and define paths that should be served through NSAPI at the end of the <code class="literal">default</code> Object definition, as shown:
					</div><pre class="screen XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;Object</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"default"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      [...]
<span xmlns="" class="line">​</span>   NameTrans fn="assign-name" from="/status" name="jknsapi"
<span xmlns="" class="line">​</span>   NameTrans fn="assign-name" from="/images(|/*)" name="jknsapi"
<span xmlns="" class="line">​</span>   NameTrans fn="assign-name" from="/css(|/*)" name="jknsapi"
<span xmlns="" class="line">​</span>   NameTrans fn="assign-name" from="/nc(|/*)" name="jknsapi"
<span xmlns="" class="line">​</span>   NameTrans fn="assign-name" from="/jmx-console(|/*)" name="jknsapi"
<span xmlns="" class="line">​</span>   NameTrans fn="assign-name" from="/jkmanager/*" name="jknsapi"
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/Object&gt;</span></pre><div class="para">
						You can map the path of any application deployed on your JBoss Enterprise Platform instance in this <code class="filename">obj.conf</code> file. In the example code, the <code class="literal">/nc</code> path is mapped to an application deployed under the name <code class="literal">nc</code>.
					</div></li><li class="step"><p class="title"><strong>Define the worker that serves each path</strong></p><div class="para">
						Open <code class="filename"><em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/config/obj.conf</code> and add the following <code class="literal">jknsapi</code> Object definition after the <code class="literal">default</code> Object definition.
					</div><pre class="screen XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;Object</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jknsapi"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   ObjectType fn=force-type type=text/plain
<span xmlns="" class="line">​</span>   Service fn="jk_service" worker="status" path="/jkmanager(/*)"
<span xmlns="" class="line">​</span>   Service fn="jk_service" worker="router"
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/Object&gt;</span></pre><div class="para">
						This <code class="literal">jknsapi</code> Object defines the worker nodes used to serve each path that was assigned to <code class="code">name="jknsapi"</code> in the <code class="literal">default</code> Object.
					</div></li><li class="step"><p class="title"><strong>Define the workers and their attributes</strong></p><div class="para">
						Create <code class="filename"><em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/config/workers.properties</code>.
					</div><div class="para">
						Define the list of worker nodes and each worker node's properties in this file:
					</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							For an explanation of <code class="filename">workers.properties</code> directives, refer to <a class="xref" href="workers.properties_Reference.html">Appendix A, <em>Reference: workers.properties</em></a>
						</div></div></div><pre class="screen"># The advanced router LB worker
worker.list=router,status

#First EAP server definition, port 8009 is standard port for AJP in EAP
#
#lbfactor defines how much the worker will be used. 
#The higher the number, the more requests are served
#lbfactor is useful when one machine is more powerful 
#ping_mode=A – all possible probes will be used to determine that
#connections are still working
worker.worker01.port=8009
worker.worker01.host=127.0.0.1
worker.worker01.type=ajp13
worker.worker01.ping_mode=A
worker.worker01.socket_timeout=10
worker.worker01.lbfactor=3

#Second EAP server definition
worker.worker02.port=8009
worker.worker02.host=127.0.0.100
worker.worker02.type=ajp13
worker.worker02.ping_mode=A
worker.worker02.socket_timeout=10
worker.worker02.lbfactor=1

# Define the LB worker
worker.router.type=lb
worker.router.balance_workers=worker01,worker02

# Define the status worker
worker.status.type=status</pre></li><li class="step"><p class="title"><strong>Restart the server</strong></p><div class="para">
						Once your Sun Java System Web Server instance is configured, restart it so that your changes take effect.
					</div><div class="para">
						For Sun Java System Web Server 6.1:
					</div><pre class="screen"><em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/stop
<em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/start</pre><div class="para">
						For Sun Java System Web Server 7.0:
					</div><pre class="screen"><em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/bin/stopserv
<em class="replaceable">SJWS</em>/<em class="replaceable">PROFILE</em>/bin/startserv</pre></li></ol></div></div></div></div></body></html>