<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 9. Advanced configuration</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="chap-HTTP_Connector_Guide-JBoss_HTTP_Advanced_Configure">
      ⁠</a>Chapter 9. Advanced configuration</h1></div></div></div><div class="para">
		Read this chapter to configure advanced features of the JBoss HTTP Connector.
	</div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="static-proxy-configuration">
      ⁠</a>9.1. Static proxy configuration</h1></div></div></div><div class="para">
			Server advertisement allows worker nodes to dynamically discover and register themselves with proxy servers. If UDP broadcast is not available or server advertisement is disabled then worker nodes must be configured with a static list of proxy server addresses and ports.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Character Limitations on Proxy Node</strong></p></div><div class="admonition"><div class="para">
				Make sure your configuration definition meets the following character limits:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						Maximum Alias length: 100 character (for example, if myapp.war is deployed in <code class="filename">/myapp</code>, then<code class="literal">/myapp</code> is the context)
					</div></li><li class="listitem"><div class="para">
						Maximum balancer name length: 40 (the<span class="property">balancer</span> property in MBean)
					</div></li><li class="listitem"><div class="para">
						Maximum domain name length: 20 (the<span class="property">domain</span> property in MBean)
					</div></li></ul></div></div></div><div class="task"><p class="title"><strong>Task: Configure Application Platform Worker Node with Static Proxy List</strong></p><div class="tasksummary"> <div class="para">
			Follow this task to configure a JBoss Enterprise Application Platform worker node to operate with a static list of proxy servers.
		</div>
		 </div><div class="taskprerequisites"><a id="idm139711972924080">
      ⁠</a><p class="title"><strong>Prerequisites</strong></p><div class="taskprerequisites-contents"> 
		 <div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					JBoss Enterprise Application Platform worker node configured. Refer to <a class="xref" href="chap-HTTP_Connector_Guide-JBoss_HTTP_Install.html">Chapter 8, <em>Install node with basic configuration</em></a> for directions.
				</div></li></ul></div>
		 </div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Disable dynamic proxy discovery</strong></p><div class="para">
					Edit the file <code class="filename"><em class="replaceable">JBOSS_EAP_DIST</em>/jboss-as/server/<em class="replaceable">PROFILE</em>/mod-cluster.sar/META-INF/mod-cluster-jboss-beans.xml</code> and set the <code class="literal">advertise</code> property to false:
				</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"advertise"</span><span xmlns="" class="perl_Keyword">&gt;</span>false<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span></pre></li><li class="step"><div class="para">
					Choose, and implement, one of the following static proxy options:
				</div><ul class="stepalternatives">
					<li class="step"><p class="title"><strong>Option 1: Create a static proxy server list</strong></p><div class="para">
							Edit <code class="filename"><em class="replaceable">JBOSS_EAP_DIST</em>/jboss-as/server/<em class="replaceable">PROFILE</em>/mod-cluster.sar/META-INF/mod-cluster-jboss-beans.xml</code> and add a comma separated list of proxies in the form of <em class="replaceable">IP_ADDRESS:PORT</em> in the <code class="literal">proxyList</code> property.
						</div><div class="example"><a id="idm139711975691504">
      ⁠</a><p class="title"><strong>Example 9.1. Example Static Proxy List</strong></p><div class="example-contents"><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"proxyList"</span><span xmlns="" class="perl_Keyword">&gt;</span>10.33.144.3:6666,10.33.144.1:6666<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span></pre></div></div></li>
					 <li class="step"><p class="title"><strong>Option 2: Start the worker node with a static proxy list as a parameter</strong></p><ol class="substeps a"><li class="step"><div class="para">
									Edit <code class="filename"><em class="replaceable">JBOSS_EAP_DIST</em>/server/<em class="replaceable">PROFILE</em>/mod-cluster.sar/META-INF/mod-cluster-jboss-beans.xml</code>
								</div></li><li class="step"><div class="para">
									Add the following line:
								</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"domain"</span><span xmlns="" class="perl_Keyword">&gt;</span>${jboss.modcluster.domain:}<span xmlns="" class="perl_Keyword">&lt;/property&gt;</span></pre></li><li class="step"><div class="para">
									Add a comma-separated list of proxies in the form of <em class="replaceable">IP_ADDRESS:PORT</em> as the <code class="literal">jboss.modcluster.proxyList</code> parameter when starting the node. 
									<div class="example"><a id="idm139711964493008">
      ⁠</a><p class="title"><strong>Example 9.2. Example Static Proxy List Parameter</strong></p><div class="example-contents"><pre class="screen">-Djboss.modcluster.domain=10.33.144.3:6666,10.33.144.1:6666</pre></div></div>

								</div></li></ol></li>

				</ul></li></ol></div></div><div class="task"><p class="title"><strong>Task: Configure Web Server Worker Node with Static Proxy List</strong></p><div class="tasksummary"> <div class="para">
			Follow this procedure to configure a JBoss Enterprise Web Server worker node to operate with a static list of proxy servers.
		</div>
		 </div><div class="taskprerequisites"><a id="idm139711961185536">
      ⁠</a><p class="title"><strong>Prerequisites</strong></p><div class="taskprerequisites-contents"> 
		 <div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					JBoss Enterprise Web Server worker node configured. Refer to <a class="xref" href="chap-HTTP_Connector_Guide-JBoss_HTTP_Install.html">Chapter 8, <em>Install node with basic configuration</em></a> for directions.
				</div></li><li class="listitem"><div class="para">
					Understand the Proxy Configuration parameters discussed in <a class="xref" href="Java_Properties_Reference.html">Appendix B, <em>Reference: Java properties</em></a>
				</div></li></ul></div>
		 </div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Disable dynamic proxy discovery</strong></p><div class="para">
					Edit <code class="filename"><em class="replaceable">JBOSS_EWS_DIST</em>/<em class="replaceable">tomcat6</em>/conf/server.xml</code>. and set the <code class="literal">advertise</code> property of the ModClusterListener to false:
				</div></li><li class="step"><p class="title"><strong>Define a mod_cluster listener</strong></p><div class="para">
					Add a &lt;Listener&gt; element to <code class="filename">server.xml</code>.
				</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;Listener</span><span xmlns="" class="perl_Others"> className=</span><span xmlns="" class="perl_String">"org.jboss.modcluster.ModClusterListener"</span><span xmlns="" class="perl_Others"> advertise=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Others"> stickySession=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> stickySessionForce=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Others"> stickySessionRemove=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre></li><li class="step"><p class="title"><strong>Create a static proxy server list</strong></p><div class="para">
					Add a comma separated list of proxies in the form of <em class="replaceable">IP_ADDRESS:PORT</em> as the <code class="literal">proxyList</code> property of the ModClusterListener &lt;Listener&gt; element.
				</div><div class="example"><a id="idm139711985106320">
      ⁠</a><p class="title"><strong>Example 9.3. Example Static Proxy List</strong></p><div class="example-contents"><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;Listener</span><span xmlns="" class="perl_Others"> className=</span><span xmlns="" class="perl_String">"org.jboss.modcluster.ModClusterListener"</span><span xmlns="" class="perl_Others"> advertise=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Others"> stickySession=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> stickySessionForce=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Others"> stickySessionRemove=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> proxyList=</span><span xmlns="" class="perl_String">"10.33.144.3:6666,10.33.144.1:6666"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre></div></div></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="clustered-node-operation">
      ⁠</a>9.2. Clustered node operation</h1></div></div></div><div class="para">
			The JBoss HTTP Connector can operate in either clustered or non-clustered mode.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				Only JBoss Enterprise Application Platform nodes support clustered operation with the JBoss HTTP Connector. JBoss Enterprise Web Server nodes support non-clustered operation only.
			</div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">JBoss HTTP Connector non-clustered operation</span></dt><dd><div class="para">
						In non-clustered mode each worker node communicates directly with the proxy.
					</div></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">JBoss HTTP Connector clustered operation</span></dt><dd><div class="para">
						In clustered mode multiple worker nodes form a JBoss HA (High Availability) cluster domain. A single worker node communicates with the proxy on behalf of the other nodes in the cluster domain.
					</div></dd></dl></div></div></div></body></html>