<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Appendix A. Reference: workers.properties</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="workers.properties_Reference">
      ⁠</a>Appendix A. Reference: workers.properties</h1></div></div></div><div class="para">
		Apache HTTP Server worker nodes are Servlet containers that are mapped to the <span class="application"><strong>mod_jk</strong></span> load balancer. The worker nodes are defined in <code class="literal"><em class="replaceable">HTTPD_DIST</em>/conf/workers.properties</code>. This file specifies where the different Servlet containers are located, and how calls should be load-balanced across them.
	</div><div class="para">
		The <code class="filename">workers.properties</code> file contains two sections:
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Global Properties</span></dt><dd><div class="para">
					This section contains directives that apply to all workers.
				</div></dd><dt><span class="term">Worker Properties</span></dt><dd><div class="para">
					This section contains directives that apply to each individual worker.
				</div></dd></dl></div><div class="para">
		Each node is defined using the Worker Properties naming convention. The worker name can only contain alphanumeric characters, limited to [a-z][A-Z][0-9][_\-].
	</div><div class="para">
		The structure of a Worker Property is <code class="filename">worker.<em class="replaceable">worker_name</em>.<em class="replaceable">directive</em></code>.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">worker</span></dt><dd><div class="para">
					The constant prefix for all worker properties.
				</div></dd><dt><span class="term"><em class="replaceable">worker_name</em></span></dt><dd><div class="para">
					The arbitrary name given to the worker. For example: node1, node_01, Node_1.
				</div></dd><dt><span class="term"><em class="replaceable">directive</em></span></dt><dd><div class="para">
					The specific directive required.
				</div></dd></dl></div><div class="para">
		The main directives required to configure worker nodes are described below.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			For the full list of <code class="filename">worker.properties</code> configuration directives, refer directly to the <a href="http://tomcat.apache.org/connectors-doc/reference/workers.html">Apache Tomcat Connector - Reference Guide</a>
		</div></div></div><div class="variablelist"><p class="title"><strong>worker.properties Global Directives</strong></p><dl class="variablelist"><dt><span class="term">worker.list</span></dt><dd><div class="para">
					Specifies the list of worker names used by mod_jk. The workers in this list are available to map requests to.
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						A single node configuration, which is not managed by a load balancer, must be set to <code class="literal">worker.list=<em class="replaceable">[worker name]</em></code>.
					</div></div></div></dd></dl></div><div class="variablelist"><p class="title"><strong>workers.properties Mandatory Directives</strong></p><dl class="variablelist"><dt><span class="term">type</span></dt><dd><div class="para">
					Specifies the type of worker, which determines the directives applicable to the worker. The default value is <em class="parameter"><code>ajp13</code></em>, which is the preferred worker type to select for communication between the web server and Apache HTTP Server.
				</div><div class="para">
					Other values include <em class="parameter"><code>ajp14</code></em>, <em class="parameter"><code>lb</code></em>, <em class="parameter"><code>status</code></em>.
				</div><div class="para">
					For detailed information about ajp13, refer to <a href="http://tomcat.apache.org/connectors-doc/ajp/ajpv13a.html">The Apache Tomcat Connector - AJP Protocol Reference</a>
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>workers.properties Connection Directives</strong></p><dl class="variablelist"><dt><span class="term">host</span></dt><dd><div class="para">
					The hostname or IP address of the worker. The worker node must support the ajp13 protocol stack. The default value is <code class="literal">localhost</code>.
				</div><div class="para">
					You can specify the <em class="parameter"><code>port</code></em> directive as part of the host directive by appending the port number after the hostname or IP address. For example: <code class="literal">worker.node1.host=192.168.2.1:8009</code> or <code class="literal">worker.node1.host=node1.example.com:8009</code>
				</div></dd><dt><span class="term">port</span></dt><dd><div class="para">
					The port number of the remote server instance listening for defined protocol requests. The default value is <code class="literal">8009</code>, which is the default listen port for AJP13 workers. If you are using AJP14 workers, this value must be set to <code class="literal">8011</code>.
				</div></dd><dt><span class="term">ping_mode</span></dt><dd><div class="para">
					Specifies the conditions under which connections are probed for their current network health.
				</div><div class="para">
					The probe uses an empty AJP13 packet for the CPing, and expects a CPong in return, within a specified timeout.
				</div><div class="para">
					You specify the conditions by using a combination of the directive flags. The flags are not comma-separated. For example, a correct directive flag set is <code class="literal">worker.node1.ping_mode=CI</code>, which specifies that the connection will be pinged on connecting to the server and at regular intervals afterward.
				</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">C (connect)</span></dt><dd><div class="para">
								Specifies the connection is probed once after connecting to the server. You specify the timeout using the <em class="parameter"><code>connect_timeout</code></em> directive, otherwise the value for <em class="parameter"><code>ping_timeout</code></em> is used.
							</div></dd><dt><span class="term">P (prepost)</span></dt><dd><div class="para">
								Specifies the connection is probed before sending each request to the server. You specify the timeout using the <em class="parameter"><code>prepost_timeout</code></em> directive, otherwise the value for <em class="parameter"><code>ping_timeout</code></em> is used.
							</div></dd><dt><span class="term">I (interval)</span></dt><dd><div class="para">
								Specifies the connection is probed during regular internal maintenance cycles. You specify the idle time between each interval using the <em class="parameter"><code>connection_ping_interval</code></em> directive, otherwise the value for <em class="parameter"><code>ping_timeout</code></em> is used.
							</div></dd><dt><span class="term">A (all)</span></dt><dd><div class="para">
								The most common setting, which specifies all directive flags are applied. For information about the <em class="parameter"><code>*_timeout</code></em> advanced directives, refer directly to <a href="http://tomcat.apache.org/connectors-doc/reference/workers.html">Apache Tomcat Connector - Reference Guide</a>.
							</div></dd></dl></div></dd><dt><span class="term">ping_timeout</span></dt><dd><div class="para">
					Specifies the time to wait for CPong answers to a CPing connection probe (refer to <em class="parameter"><code>ping_mode</code></em>). The default value is 10000 (milliseconds).
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>worker.properties Load Balancing Directives</strong></p><dl class="variablelist"><dt><span class="term">lbfactor</span></dt><dd><div class="para">
					Specifies the load-balancing factor for an individual worker, and is only specified for a member worker of a load balancer.
				</div><div class="para">
					This directive defines the relative amount of HTTP request load distributed to the worker compared to other workers in the cluster.
				</div><div class="para">
					A common example where this directive applies is where you want to differentiate servers with greater processing power than others in the cluster. For example, if you require a worker to take three times the load of other workers, specify <code class="literal">worker.<em class="replaceable">worker name</em>.lbfactor=3</code>
				</div></dd><dt><span class="term">balance_workers</span></dt><dd><div class="para">
					Specifies the worker nodes that the load balancer must manage. The directive can be used multiple times for the same load balancer, and consists of a comma-separated list of worker names as specified in the workers.properties file.
				</div></dd><dt><span class="term">sticky_session</span></dt><dd><div class="para">
					Specifies whether requests for workers with SESSION IDs are routed back to the same worker. The default is <em class="parameter"><code>0</code></em> (false). When set to <em class="parameter"><code>1</code></em> (true), load balancer persistence is enabled.
				</div><div class="para">
					For example, if you specify <code class="literal">worker.loadbalancer.sticky_session=0</code>, each request is load balanced between each node in the cluster. In other words, different requests for the same session will go to different servers based on server load.
				</div><div class="para">
					If <code class="literal">worker.loadbalancer.sticky_session=1</code>, each session is persisted (locked) to one server until the session is terminated, providing that server is available.
				</div></dd></dl></div></div></body></html>