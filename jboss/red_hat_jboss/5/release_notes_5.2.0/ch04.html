<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 4. Resolved Issues</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idm140392323382544">
      ⁠</a>Chapter 4. Resolved Issues</h1></div></div></div><div class="para">
		Resolved issues in JBoss Enterprise Application Platform 5.2.0 are listed by component.
	</div><div class="variablelist"><p class="title"><strong>AOP</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9198">https://issues.jboss.org/browse/JBPAPP-9198</a></span></dt><dd><div class="para">
					Previously, JBoss Pojo Cache's <code class="filename">pojocache-aop.xml</code> was missing a namespace on the <code class="literal">&lt;aop&gt;</code> tag. Consequently, if <code class="filename">jbosscache-pojo.jar</code> was packaged in a location scanned by deployment scanners, the <code class="systemitem">JBossXBRuntimeException</code> was thrown. The namespace has been added to the <code class="literal">&lt;aop&gt;</code> tag and the <code class="systemitem">JBossXBRuntimeException</code> is no longer thrown in this scenario.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Build</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-6752">https://issues.jboss.org/browse/JBPAPP-6752</a></span></dt><dd><div class="para">
					All licence files have been moved into one distribution RPM to avoid conflicts on operating systems that are not case-sensitive.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-5302">https://issues.jboss.org/browse/JBPAPP-5302</a></span></dt><dd><div class="para">
					The file <code class="filename">properties-service.xml</code> was removed to minimise the number of unwanted services. Instead of using this file, the same result can be achieved by passing the properties in the server's startup.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Clustering</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9588">https://issues.jboss.org/browse/JBPAPP-9588</a></span></dt><dd><div class="para">
					JGroups <code class="systemitem">FD_SOCK</code> protocol did not set the <code class="systemitem">TCP_KEEPALIVE</code> option on the server side of the socket. After a network interruption during which the client side had broken the connection, the server side sockets remained open until the JGroups channel was shut down. The <code class="systemitem">FD_SOCK</code> protocol now sets the <code class="systemitem">TCP_KEEPALIVE</code> option on the server side of the socket. Now even if the client side of the socket is closed during a network interruption, the server side socket is closed by the <code class="systemitem">TCP_KEEPALIVE</code> timeout.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-6447">https://issues.jboss.org/browse/JBPAPP-6447</a></span></dt><dd><div class="para">
					In previous versions of JBoss Enterprise Application Platform, an <code class="systemitem">UnmarshalException</code> (when a connection was reset) or an <code class="systemitem">EOFException</code> (when making a JNDI call as a server is shutting down) could occur. As a result of this the <code class="systemitem">UnmarshalException</code> was thrown to the caller with no attempt at failover. In this release of JBoss Enterprise Application Platform the <code class="systemitem">UnmarshalException</code> is caught and a new connection attempt is made to the supplied provider list. When possible the <code class="systemitem">UnmarshalException</code> now fails over transparently.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8152">https://issues.jboss.org/browse/JBPAPP-8152</a></span></dt><dd><div class="para">
					An issue that resulted in clients receiving errors has been resolved in this release. It was determined that HAJNDI was processing results before it was fully initialized, and the errors were coming from components that were not in the correct state. The issue has been corrected and HAJNDI now throws <code class="systemitem">javax.naming.ServiceUnavailableException</code>, which can be handled to retry the request automatically if a request comes in during start up.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8301">https://issues.jboss.org/browse/JBPAPP-8301</a></span></dt><dd><div class="para">
					In previous JBoss Enterprise Application Platform 5 releases a <code class="systemitem">NullPointerException</code> sometimes occurred when calling HAJNDI during startup. This was caused by <code class="systemitem">HARMIServerImpl</code> processes requests for HAJNDI before it is fully initialized. This would produce errors from components that were not in the correct state. As a resolution to this issue, <code class="systemitem">HARMIServerImpl</code> now throws <code class="systemitem">java.rmi.NoSuchObjectException</code> if a request comes in during startup, which causes an automatic retry in the client HAJNDI code.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8305">https://issues.jboss.org/browse/JBPAPP-8305</a></span></dt><dd><div class="para">
					It was found that, because HAJNDI continued to process requests while shutting down, clients could receive <code class="systemitem">CacheNotReadyException</code> errors from components that are not in the correct state. As a resolution to this issue, HAJNDI now throws <code class="systemitem">javax.naming.ServiceUnavailableException</code> if a request comes in during shutdown, and the shutdown process waits for existing requests to complete.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8302">https://issues.jboss.org/browse/JBPAPP-8302</a></span></dt><dd><div class="para">
					It was found that, because HARMIServerImpl continued to process requests for HAJNDI while shutting down, clients could receive <code class="systemitem">JBossLazyUnmarshallingException</code> errors from components that are not in the correct state. As a resolution to this issue, HARMIServerImpl now throws <code class="systemitem">java.rmi.NoSuchObjectException</code> if a request comes in during shutdown, and the shutdown process waits for existing requests to complete.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7904">https://issues.jboss.org/browse/JBPAPP-7904</a></span></dt><dd><div class="para">
					An issue that prevented a custom <code class="systemitem">HASingleton</code> election policy from being called if there was only one node in a cluster has been resolved in this release. The issue caused that a custom <code class="systemitem">HASingleton</code> election policy (such as a quorum policy) could not prevent a singleton from running in the cluster. In this release, the custom <code class="systemitem">HASingleton</code> election policy is always called and can therefore prevent a singleton from running in the cluster.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7418">https://issues.jboss.org/browse/JBPAPP-7418</a></span></dt><dd><div class="para">
					The JGroups <code class="systemitem">MPING</code> configurations ignored the <em class="parameter"><code>jboss.partition.udpGroup</code></em> system property (set with the <code class="literal">-u</code> option). Therefore, when setting the multicast address for clustering using <code class="literal">-u</code>, any channels using <code class="systemitem">MPING</code>, such as the JBoss Messaging data channel, used the default address instead of the configured address. The <em class="parameter"><code>jboss.partition.udpGroup</code></em> property has been added to the <code class="systemitem">MPING</code> configuration in the binding manager and setting the multicast address for clustering using <code class="literal">-u</code> now affects all clustering channels as expected.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9573">https://issues.jboss.org/browse/JBPAPP-9573</a></span></dt><dd><div class="para">
					The same name attributes were used on different tags in the POJO Cache's <code class="filename">pojocache-aop.xml</code> file. It resulted in an <code class="systemitem">IllegalStateException</code> error if <code class="filename">jbosscache-pojo.jar</code> was packaged in a location scanned by deployment scanners. To resolve this issue, the duplicate <code class="literal">name</code> attribute was removed.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9624">https://issues.jboss.org/browse/JBPAPP-9624</a></span></dt><dd><div class="para">
					When two threads attempted to create the same parent node at the same time, a race condition on locking occurred in JBoss Cache. As a result, one of the threads did not acquire a lock on the node, which could later lead to a deadlock. With this update, the threads now confirm that they created and have a write lock on the node and the deadlock no longer occurs.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7355">https://issues.jboss.org/browse/JBPAPP-7355</a></span></dt><dd><div class="para">
					Concurrent calls that started the same JBoss Cache instance caused errors. The calls are now synchronized so that concurrent access no longer occurs.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7850">https://issues.jboss.org/browse/JBPAPP-7850</a></span></dt><dd><div class="para">
					A database password was logged in plain text if a database connection was configured in a JBoss Cache loader and a connection error occurred. The log statement has been now altered so as not to log the password, which fixes this problem.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9220">https://issues.jboss.org/browse/JBPAPP-9220</a></span></dt><dd><div class="para">
					When using a JTS transaction manager, transaction commit could incorrectly share data between threads when under heavy load due to a race condition in JBoss Cache. This could result in lock time-out exceptions as locks were not freed correctly. With this update, the race condition no longer occurs, the transaction commit uses the correct data when using a JTS transaction manager under load, and transactions are committed correctly.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7500">https://issues.jboss.org/browse/JBPAPP-7500</a></span></dt><dd><div class="para">
					Inactivating a JBoss Cache region locked the entire subtree of the region's parent and never unlocked it. Consequently, the cache became unusable because of the locks. Inactivating a region now only locks the parent, not the entire subtree of the parent. As a result, the cache is no longer locked after inactivation of a region.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9560">https://issues.jboss.org/browse/JBPAPP-9560</a></span></dt><dd><div class="para">
					When an exception occurred during marshalling in CommandAwareRpcDispatcher, the exception was logged without its context, making diagnostics difficult. The message has now been modified so that it clearly states that it occurred during marshalling.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9574">https://issues.jboss.org/browse/JBPAPP-9574</a></span></dt><dd><div class="para">
					JBoss Cache unmarshalled return values that were going to be discarded during replication. When the cache contained objects in an isolated classloader, it was unable to unmarshall the objects and an exception was thrown, preventing the replication from succeeding. The return values are now no longer unmarshalled since they will be discarded. The exception is therefore not thrown and the replication finishes successfully.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7709">https://issues.jboss.org/browse/JBPAPP-7709</a></span></dt><dd><div class="para">
					Due to issues in the Oracle driver, the <code class="systemitem">JDBCCacheLoader</code> did not work with an Oracle database if the serialized form of the data exceeded a certain size (a couple of kB). The <em class="parameter"><code>cache.jdbc.node.useSetBlob</code></em> cache loader flag has been added to solve this problem: when the flag is set, JDBC uses a different JDBC call of the Oracle driver implementation and the <code class="systemitem">JDBCCacheLoader</code> works as expected with Oracle databases under these circumstances.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9604">https://issues.jboss.org/browse/JBPAPP-9604</a></span></dt><dd><div class="para">
					JBoss Cache used the <code class="systemitem">useOutOfBandMessage</code> message hard-coded to <code class="literal">false</code> when making remote procedure calls. Consequently, RPC messages that were meant to be processed immediately, such as a transaction commit, had to wait for other messages to be processed first, which could cause deadlocks. With this update, the <code class="systemitem">useOutOfBandMessage</code> is no longer set to <code class="literal">false</code>. Out-of-band RPC messages are now processed immedately and can no longer cause deadlocks.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9639">https://issues.jboss.org/browse/JBPAPP-9639</a></span></dt><dd><div class="para">
					JBoss Cache transaction <code class="literal">ROLLBACK</code> messages that were processed before the corresponding <code class="literal">PREPARE</code> were ignored. This caused the <code class="literal">PREPARE</code> to acquire locks and release them only after the transaction timed out. JBoss Cache now keeps track of <code class="literal">ROLLBACK</code> messages processed before the corresponding <code class="literal">PREPARE</code> message, and aborts <code class="literal">PREPARE</code> if the corresponding <code class="literal">ROLLBACK</code> was already processed.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9344">https://issues.jboss.org/browse/JBPAPP-9344</a></span></dt><dd><div class="para">
					When requesting missing messages to be retransmitted, a node sometimes requested the latest received message instead of the missing one. If if had not previously received any messages from the member in these cases, it requested message <code class="literal">0</code> (which is invalid). This behaviour caused unnecessary retransmission requests and the following warning messages were logged: 
<pre class="screen">
WARN [org.jgroups.protocols.pbcast.NAKACK] (OOB-19,10.1.1.1:55200) (requester=10.1.1.2:55200, local_addr=10.1.1.1:55200) message 10.1.1.1:55200::0 not found in retransmission table of 10.1.1.1:55200:
[0 : 7 (7) (size=7, missing=0, highest stability=0)]
</pre>
					 With this update, JGroups do not request retransmission of message <code class="literal">0</code> or a message it already has received. As a result, no redundant retransmission requests are sent and the above mentioned warning messages are not logged.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7472">https://issues.jboss.org/browse/JBPAPP-7472</a></span></dt><dd><div class="para">
					A race condition in JGroups could lead to a <code class="systemitem">ConcurrentModificationException</code> in the <code class="systemitem">BasicConnectionTable.retainAll()</code> call. The race condition occurred on the members variable when using the TCP protocol. The appropriate synchronization has been implemented to prevent concurrent access to the variable so that the <code class="systemitem">ConcurrentModificationException</code> can now no longer occur.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7456">https://issues.jboss.org/browse/JBPAPP-7456</a></span></dt><dd><div class="para">
					If a protocol considers a cluster node dead, the protocol sends a <code class="literal">SUSPECT</code> message. The <code class="literal">VERIFY_PROTOCOL</code> then pings the node to verify that the node is unresponsive. If the node does not respond before the <code class="literal">VERIFY_SUSPECT</code> time-out period elapses, the node is kicked from the cluster. Previously, after a cluster member was kicked and then rejoined the cluster, the member could be kicked again if it joined the cluster before the time-out period had elapsed. This happened because the member was not removed from the list of the suspected members after it has left the cluster. Now, a node that leaves the cluster is removed from the list of suspected members so that the member is not kicked after rejoining the cluster again, even if it rejoins the cluster before the timer expires.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Consoles</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-5925">https://issues.jboss.org/browse/JBPAPP-5925</a></span></dt><dd><div class="para">
					When using the IBM JDK and logging onto the web console for the first time, a <code class="computeroutput">java.lang.UnsupportedOperationException</code> error occurred. The root cause of this issue was IBM's Java implementation. The problem has been resolved by working around the issue with IBM's JDK so that the error no longer occurs when logging in to the web console.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Documentation</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9433">https://issues.jboss.org/browse/JBPAPP-9433</a></span></dt><dd><div class="para">
					The <em class="citetitle">Installation Guide</em> stated that the GUI installer configures JBoss Enterprise Application Platform to run as a service on Red Hat Enterprise Linux. However, this is only the case when the product is installed from an RPM package. With this update, the text has been corrected to reflect this fact.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-5491">https://issues.jboss.org/browse/JBPAPP-5491</a></span></dt><dd><div class="para">
					A documentation oversight lead to SNMP-related content not being included in the JBoss Enterprise Application Platform 5 documentation suite (it was present in the 4.3 suite). The information has now been included in the latest release of the <em class="citetitle">Administration and Configuration Guide</em>.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9635">https://issues.jboss.org/browse/JBPAPP-9635</a></span></dt><dd><div class="para">
					The <em class="citetitle">HTTP Connectors Load Balancing Guide</em> did not discuss load providers and how to control the metrics that are reported to the http-side module. The information has been added to the guide and is available in the Load Metrics chapter.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9804">https://issues.jboss.org/browse/JBPAPP-9804</a></span></dt><dd><div class="para">
					The <em class="citetitle">Administration and Configuration Guide</em> did not document that datasource properties &lt;background-validation&gt; and &lt;background-validation-minutes&gt; have been deprecated. Notes on deprecation have been added and the property descriptions have been modified respectively.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-10294">https://issues.jboss.org/browse/JBPAPP-10294</a></span></dt><dd><div class="para">
					A procedure for switching to a production database using the new Database Configuration Tool has been added to the <em class="citetitle">Administration and Configuration Guide</em>.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-4550">https://issues.jboss.org/browse/JBPAPP-4550</a></span></dt><dd><div class="para">
					Previously, the <em class="citetitle">Installation Guide</em> provided incorrect information on how to define the <code class="systemitem">SuckerPassword</code>, which is used by nodes during messaging for authentication in clustered environment. With this update, the correct information has been added to the <em class="citetitle">Messaging Guide</em> and the original information has been removed from the <em class="citetitle">Installation Guide</em>.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-5499">https://issues.jboss.org/browse/JBPAPP-5499</a></span></dt><dd><div class="para">
					In response to a request, details about how to install <span class="application"><strong>mod_cluster</strong></span>, <span class="application"><strong>mod_cluster support</strong></span> and <span class="application"><strong>mod_jk</strong></span> in JBoss Enterprise Application Platform 5 have been added to the <em class="citetitle">Installation Guide</em>.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-3207">https://issues.jboss.org/browse/JBPAPP-3207</a></span></dt><dd><div class="para">
					Customers were experiencing difficulties running the non-clustered Messaging examples using the <code class="literal">All</code> and <code class="literal">Production</code> server profiles because the <em class="citetitle">Messaging User Guide</em> did not contain clear instructions. Most Messaging examples are designed to run on non-clustered server profiles (all profiles, except All and Production). The chapter has been improved by separating the examples into clustered and unclustered sets, and also instructs the user to review the <code class="filename">readme</code> file shipped with each example for configuration instructions.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7146">https://issues.jboss.org/browse/JBPAPP-7146</a></span></dt><dd><div class="para">
					The <em class="citetitle">Security Guide</em> did not include the information that user names and roles are case sensitive. A note reflecting this fact has been added.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9595">https://issues.jboss.org/browse/JBPAPP-9595</a></span></dt><dd><div class="para">
					The <em class="citetitle">Performance Tuning</em> chapter was removed from the <em class="citetitle">Administration and Configuration Guide</em> and is now substituted by the <em class="citetitle">Performance Tuning Guide</em>.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9878">https://issues.jboss.org/browse/JBPAPP-9878</a></span></dt><dd><div class="para">
					Previously, the <em class="citetitle">HornetQ User Guide</em> did not contain information on HornetQ HA supported shared stores. The appropriate information has been added.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>EJB</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-6624">https://issues.jboss.org/browse/JBPAPP-6624</a></span></dt><dd><div class="para">
					A memory leak was discovered in the InfinitePool's implementation of the <code class="systemitem">ThreadLocalPool</code> which could eventually lead to <code class="systemitem">OutOfMemory</code> exceptions. The InfinitePool maintained a list of active <code class="systemitem">beanContexts</code> but did not override the discard method so a small memory leak occurred every time this method was called. A discard method was implemented, preventing memory leaks occurring.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8123">https://issues.jboss.org/browse/JBPAPP-8123</a></span></dt><dd><div class="para">
					If a class did not implement EJBObject but was annotated as <code class="systemitem">@Stateful</code>, JBoss incorrectly considered the respective object not to be an EJB. This happened because the code failed to handle the returned EJB-annotation results. With this update, the EJB annotation is handled correctly and the object is identified as an EJB Bean as expected.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7685">https://issues.jboss.org/browse/JBPAPP-7685</a></span></dt><dd><div class="para">
					Previously, the <code class="systemitem">timeout()</code> methods on an EJB3 timer bean ignored the <code class="systemitem">@RunAs</code> annotation due to a missing interceptor reference in the XML defining EJB3 interceptors. With this update, the <code class="systemitem">RunAs</code> interceptor reference has been added and the <code class="systemitem">timeout()</code> method is run with the matching role as expected.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7724">https://issues.jboss.org/browse/JBPAPP-7724</a></span></dt><dd><div class="para">
					If a Stateful Session Bean reached its <code class="systemitem">removalTimeout</code>, the system removed the bean without executing the <code class="systemitem">@PreDestroy</code> lifecycle. JBoss will now execute the <code class="systemitem">@PreDestroy</code> annotated method of the Stateful Session Bean before removing the bean.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8035">https://issues.jboss.org/browse/JBPAPP-8035</a></span></dt><dd><div class="para">
					Extensive use of the <code class="systemitem">ejbTimeout()</code> callbacks in an EJB resulted in "<span class="emphasis"><em>failure to create native thread</em></span>" OOM (out of memory) errors rendering the server unusable. Now, each server has a <code class="systemitem">ScheduledExecutorService</code>, which registers any deployed EJB. The service has a restricted pool size of threads which process the timeout callbacks. The pool size is set to <code class="literal">50</code> threads by default.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7292">https://issues.jboss.org/browse/JBPAPP-7292</a></span></dt><dd><div class="para">
					In previous versions of JBoss Enterprise Application Platform 5, it was found that the EJB3 deployer could slow a large deployment down significantly. This was because, during a deployment, the deployer scanned the entire archive to locate client deployment descriptors. It would ignore the deployment of any it found. This issue has been resolved by ensuring that all deployment descriptors are located directly in the <code class="filename">META-INF</code> directory, giving the deployer a single location to scan and leading to faster deployments.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-4428">https://issues.jboss.org/browse/JBPAPP-4428</a></span></dt><dd><div class="para">
					When the WebServiceContext was injected into an EJB3 interceptor the following error was reported: 
<pre class="screen">Caused by: java.lang.ArrayStoreException: org.jboss.injection.WebServiceContextPropertyInjector
at java.util.AbstractCollection.toArray(AbstractCollection.java:171)
at org.jboss.ejb3.interceptor.InterceptorInjector.&lt;init&gt;(InterceptorInjector.java:42)
at org.jboss.ejb3.EJBContainer.processMetadata(EJBContainer.java:620)
at org.jboss.ejb3.Ejb3Deployment.processEJBContainerMetadata(Ejb3Deployment.java:434)
at org.jboss.ejb3.Ejb3Deployment.start(Ejb3Deployment.java:543)
...</pre>
					 The cause of this issue was that the <code class="systemitem">WebServiceContextPropertyInjector</code> did not extend the <code class="systemitem">PojoInjector</code>. This has been corrected and this error no longer occurs.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-923">https://issues.jboss.org/browse/JBPAPP-923</a></span></dt><dd><div class="para">
					Propagation of an Extended Persistence Context (<abbr class="abbrev">XPC</abbr>) was not taking into account the existence of a transaction, with the XPC always being propagated. The handling of XPC has been modified so that if there is no transaction active the XPC's propagation is ignored so that the bean being invoked has its own Persistence Context instead of the XPC. This behavior can be overridden by adding the following to <code class="filename">run.conf</code>: 
<pre class="screen">{{JAVA_OPTS="$JAVA_OPTS -DJBPAPP-923.alwaysPropagate=true"}}</pre>

				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7488">https://issues.jboss.org/browse/JBPAPP-7488</a></span></dt><dd><div class="para">
					Persistence units that had exploded packages in a <em class="parameter"><code>&lt;jar-file&gt;</code></em> tag did not have their entities scanned. It returned the <code class="systemitem">vfsfile</code> protocol for exploded packages declared in <code class="literal">&lt;jar-file&gt;</code> which were not scanned by Hibernate <code class="systemitem">EntityManager</code>. The class <code class="systemitem">JarVisitorFactory</code> returned an incorrect implementation of <code class="systemitem">AbstractJarVisitor</code> for <code class="systemitem">vfsfile</code> (returning <code class="systemitem">InputStreamZippedJarVisitor</code>). This issue has been resolved by modifying <code class="systemitem">JarVisitorFactory</code> so that it returns the correct implementation and as a result, <code class="systemitem">ExplodedJarVisitor</code> is able to scan entities in exploded packages appropriately.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9341">https://issues.jboss.org/browse/JBPAPP-9341</a></span></dt><dd><div class="para">
					Because unlinked collections were used by the EJB-QL compiler to store join paths of processed queries, the order of individual parts of produced SQL queries was different with different versions of the Java Development Kit. While the queries produced identical results, the differences affected execution plan performance on some database systems. With this update, the unlinked collections have been replaced with linked ones. As a result, the produced SQL queries are now identical with different Java Development Kit versions and execution plan performance is no longer affected.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Embedded Jopr</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8084">https://issues.jboss.org/browse/JBPAPP-8084</a></span></dt><dd><div class="para">
					When using the administration console to update an application (EAR or WAR) deployed to the <code class="filename">farm</code> directory, the target application was removed from the <code class="filename">farm</code> directory and deployed to the <code class="filename">deploy</code> directory. This resulted result in the <code class="systemitem">farmed</code> attribute value being <code class="literal">null</code> when the administration console UI expected it to be set to <code class="literal">true</code>. This issue has been resolved by ensuring that existing applications that are marked as farmed continue to be deployed in the <code class="filename">farm</code> directory, which ensures <code class="literal">farmed=true</code> on the updated deployment.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8222">https://issues.jboss.org/browse/JBPAPP-8222</a></span></dt><dd><div class="para">
					When an XML parser in strict mode parsed a deployment descriptor found in <code class="filename">admin-console.war</code>, a failure occurred due to a missing version attribute in the <code class="filename">persistence.xml</code> descriptor. This issue has been resolved by adding the missing version attribute to the <code class="filename">persistence.xml</code> file for <code class="filename">rhq-core-domain.jar</code>.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7551">https://issues.jboss.org/browse/JBPAPP-7551</a></span></dt><dd><div class="para">
					When using Microsoft Internet Explorer (IE) 7 or IE 8 in IE 7 compatibility mode, the administration console's main panel was sometimes blank. This was due to a Microsoft CSS extension used by the administration console that had been deprecated in IE 6 and removed in IE 7. This issue has been resolved by updating the administration console's CSS to use a standard style rendering that is compatible with IE 6 and later.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9459">https://issues.jboss.org/browse/JBPAPP-9459</a></span></dt><dd><div class="para">
					When creating a data source in the Admin Console, the data source mapping type did not provide the <code class="literal">MySQL</code> option. The data source type mapping property has been changed to a text field and the <code class="literal">MySQL</code> mapping type can now be entered as the data source mapping type.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9461">https://issues.jboss.org/browse/JBPAPP-9461</a></span></dt><dd><div class="para">
					On access, the Admin Console turned off global caching of resources contained within JAR files. This resulted in serious performance issues. With this update, the console explicitly re-enables default caching on <code class="systemitem">URLConnection</code> after it is accessed and the performance problems no longer occur in this scenario.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Hibernate</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-6395">https://issues.jboss.org/browse/JBPAPP-6395</a></span></dt><dd><div class="para">
					When the Criteria API was used with LEFT OUTER JOIN to add criteria to children, the child collections contained only children matching the criteria. This behavior also applied when no Filters were used. For example: 
<pre class="programlisting">criteria.createCriteria("children", JoinFragment.LEFT_OUTER_JOIN)</pre>
					 The root cause of this issue was that the criteria were not being properly propagated. This has now been resolved and these criteria are now properly applied.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-6013">https://issues.jboss.org/browse/JBPAPP-6013</a></span></dt><dd><div class="para">
					In the server's logs, Hibernate Annotations' version number was being reported as <code class="literal">3.4.0.GA_CP01</code> and Hibernate EntityManager's was reported as <code class="literal">WORKING</code> when both were in fact the same version: <code class="literal">3.4.0.GA_CP01</code>. This has now been fixed and the correct version numbers of both components are recorded in the server's logs.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-6906">https://issues.jboss.org/browse/JBPAPP-6906</a></span></dt><dd><div class="para">
					When the <code class="literal">EXISTS</code> statement was negated in Hibernate HQL, it was incorrectly translated to SQL without the negation. This issue has been resolved and the statement is now correctly translated.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8370">https://issues.jboss.org/browse/JBPAPP-8370</a></span></dt><dd><div class="para">
					With JBossCache configured as a second-level cache for Hibernate, and <code class="systemitem">TimeStampsRegionImpl</code> enabled, a Null Pointer Exception (<abbr class="abbrev">NPE</abbr>) could occur on initialization of the cache. To prevent this occurring, an additional check has been added for these circumstances, preventing the NPE and ensuring the cache is initialized correctly.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7998">https://issues.jboss.org/browse/JBPAPP-7998</a></span></dt><dd><div class="para">
					It was found that when a non-English language is used in an Orcale database, constraint violation could not be correctly extracted and reported. This was because in the Oracle SQL dialect, constraint violation name extraction was English-specific. A patch has been applied to make constraint violation name extraction language-neutral. Now, when Oracle is using a non-English language, the constraint can be seen.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8682">https://issues.jboss.org/browse/JBPAPP-8682</a></span></dt><dd><div class="para">
					A bug was identified in the <code class="systemitem">SchemaUpdate</code> function where, although it read the foreign keys metadata from the database, it ignored <em class="parameter"><code>_default_schema_</code></em> and <em class="parameter"><code>_default_catalog_</code></em> settings, resulting in incorrect SQL statements. This issue has now been fixed and these default settings are honored.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9227">https://issues.jboss.org/browse/JBPAPP-9227</a></span></dt><dd><div class="para">
					Hibernate returned an exception stating that the primary key of a child entity was ambiguous when updating the primary key of the child element while both entities, the entity of the parent element and the entity of the child element, were mapped with joined subclass method. This happened because Hibernate generated an incorrect SQL leaving out the table alias from the <code class="literal">id</code> column. An upstream fix that fixes this issue has been backported to Hibernate and Hibernate now generates the correct SQL under these circumstances.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7072">https://issues.jboss.org/browse/JBPAPP-7072</a></span></dt><dd><div class="para">
					If Hibernate's EntityManager was used in a CMT Bean and a <code class="systemitem">GenericJDBCException</code> occurred, Hibernate would initiate a rollback even if there was no active transaction, resulting in the exception: 
<pre class="screen">
&lt;org.hibernate.ejb.AbstractEntityManagerImpl&gt; Unable to mark for rollback on PersistenceException:
java.lang.IllegalStateException: [com.arjuna.ats.internal.jta.transaction.arjunacore.nosuchtx] [com.arjuna.ats.internal.jta.transaction.arjunacore.nosuchtx] No such transaction!
</pre>
					 This issue has been resolved so a rollback is no longer initiated in these circumstances.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7291">https://issues.jboss.org/browse/JBPAPP-7291</a></span></dt><dd><div class="para">
					When executing a SQL query that returns values of the <code class="literal">char</code> SQL data type, a value of the <code class="systemitem">java.lang.Character</code> data type was returned, regardless of the <code class="literal">char</code> data type length. This caused that only the first character of the value was returned. A value of the <code class="systemitem">java.lang.String</code> data type is now returned when the length of the <code class="literal">char</code> type is larger than <code class="literal">1</code>.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>HornetQ</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-6659">https://issues.jboss.org/browse/JBPAPP-6659</a></span></dt><dd><div class="para">
					The HornetQ examples were dependent on a build script - <code class="filename">build.sh</code>, which was not included with the examples. The dependency has now been removed so the only dependency for installing the scripts is the <span class="application"><strong>ant</strong></span> utility. To build the examples, perform these steps: 
					<div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
								Open a terminal;
							</div></li><li class="listitem"><div class="para">
								Navigate to the example directory root containing the <code class="filename">build.xml</code> file;
							</div></li><li class="listitem"><div class="para">
								Execute <code class="command">ant</code> to build and deploy the examples.
							</div></li></ol></div>

				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8561">https://issues.jboss.org/browse/JBPAPP-8561</a></span></dt><dd><div class="para">
					An issue was discovered in which when <code class="systemitem">destroy()</code> was called on a managed connection, <code class="systemitem">stop()</code> was called on the managed connection factory which stopped the <code class="systemitem">ServerLocator</code> and subsequently all sessions all the managed connections associated with that factory. The root cause of this issue has now been resolved.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8786">https://issues.jboss.org/browse/JBPAPP-8786</a></span></dt><dd><div class="para">
					A bug was discovered which caused a node in HornetQ clusters using collocated back up servers to become unresponsive the shutdown signal was sent. This was caused by the JBoss Shutdown Hook thread being blocked from joining a <code class="systemitem">JMSServerManagerImpl</code> thread, because it, in turn, was waiting for a lock that was already held by the JBoss Shutdown Hook thread. This issue was corrected by changing the synchronization semantics of the related methods and by changing the order of operations. HornetQ cluster nodes now shut down gracefully when collocated.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8168">https://issues.jboss.org/browse/JBPAPP-8168</a></span></dt><dd><div class="para">
					If a message consumer crashed, any messages which it had consumed but not acknowledged did not have their delivery count updated. This issue has now been fixed so that delivery counts are accurate.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8151">https://issues.jboss.org/browse/JBPAPP-8151</a></span></dt><dd><div class="para">
					If a message was paged and the session which sent the message was rolled back, the paged message was not removed until the server was restarted. The cause of this issue has now been fixed and paged messages are correctly removed.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8434">https://issues.jboss.org/browse/JBPAPP-8434</a></span></dt><dd><div class="para">
					In certain circumstances messages were lost when using a message selector. The root cause was identified and fixed so that message references are maintained.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8578">https://issues.jboss.org/browse/JBPAPP-8578</a></span></dt><dd><div class="para">
					It was found that a <code class="literal">discovery-group</code> would effectively ignore the <code class="literal">group-address</code> and simply bind to <code class="uri">0.0.0.0</code>. This could potentially lead to cluster "cross-talk" where applications listening on a MulticastSocket receive packets associated with a different multicast address. The problem was caused by EAP using the wrong constructor for <code class="code">java.net.MulticastSocket</code>. A patch has ensured EAP uses the correct constructor and adds a log message to warn the user if the expected configuration failed.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7652">https://issues.jboss.org/browse/JBPAPP-7652</a></span></dt><dd><div class="para">
					An issue was found where JNDI bindings added using JConsole were valid only until the instance was restarted, when all changes would be lost. This has been resolved and all such changes are persistent.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8731">https://issues.jboss.org/browse/JBPAPP-8731</a></span></dt><dd><div class="para">
					In circumstances where a JMS server backup is started and then the backup server is shutdown before the backup goes live, an <code class="systemitem">IllegalStateException</code> can be thrown (on the backup server). This is because any calls to create new connection factories and destinations for the backup server are cached and, if the server is shut down, EAP will attempt to undeploy them only to find they do not exist. This issue has been corrected with a patch that caches the relevant shutdown commands (just as is done with the start commands) so that they do not get executed until the server is active.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8769">https://issues.jboss.org/browse/JBPAPP-8769</a></span></dt><dd><div class="para">
					A bug was found wherein sending extremely large messages had the potential to lock the queue while they we being transmitted. This could, in some extreme cases, lead to timeouts. This bug was fixed in a cumulative patch.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8997">https://issues.jboss.org/browse/JBPAPP-8997</a></span></dt><dd><div class="para">
					When refreshing the metrics page of a HornetQ message queue, a message indicating that there were no numeric metrics available appeared occasionally. This was caused by a race condition identified in <a href="https://issues.jboss.org/browse/JBPAPP-9406">JBPAPP-9406</a>. The race condition has been corrected to prevent the management view from becoming out-of-sync and the problem no longer occurs.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9002">https://issues.jboss.org/browse/JBPAPP-9002</a></span></dt><dd><div class="para">
					In previous releases of EAP, if <code class="systemitem">BroadcastGroupImpl</code> was unable to broadcast, it logged an error every 5 seconds. This release changes that behavior so that the error is only logged once. A message is also logged when the condition changes.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9027">https://issues.jboss.org/browse/JBPAPP-9027</a></span></dt><dd><div class="para">
					If a <code class="systemitem">javax.jms.ObjectMessage</code> with a <code class="systemitem">java.lang.reflect.Proxy</code> payload was sent to a message queue, the <code class="systemitem">getObject()</code> call on the message failed with a JMSException. This happened because the underlying <code class="systemitem">org.hornetq.utils.ObjectInputStreamWithClassLoader</code> class did not implement the <code class="systemitem">java.io.ObjectInputStream.resolveProxyClass()</code> method. This update provides a suitable implementation of the method.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9258">https://issues.jboss.org/browse/JBPAPP-9258</a></span></dt><dd><div class="para">
					An issue was found wherein JMX Topic attributes were not available in a cluster. The issue was caused by a <code class="systemitem">NullPointerException</code> in the code which looped through the subscriptions to gather metrics and caused all clustered nodes to incorrectly report topic attributes as <code class="literal">0</code>. This issue was fixed by checking for null on the relevant variable.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9393">https://issues.jboss.org/browse/JBPAPP-9393</a></span></dt><dd><div class="para">
					In previous versions of JBoss Enterprise Application Platform 5, when a HornetQ "connector" was bound to <code class="literal">0.0.0.0</code> HornetQ would tell a remote client to connect to the same address. However, <code class="literal">0.0.0.0</code> is meaningless to a remote client. This issue was resolved by detecting the <code class="literal">0.0.0.0</code> binding and replacing that value with the result of <code class="code">InetAddress.getLocalHost().getHostName()</code> so that the remote client can connect properly.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9617">https://issues.jboss.org/browse/JBPAPP-9617</a></span></dt><dd><div class="para">
					In HornetQ, when a message was imported from an XML file, the message body was null due to a <code class="systemitem">NullPointerException</code> that occurred when acquiring message attributes. The process of acquiring message attributes has been fixed and the problem no longer occurs.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9616">https://issues.jboss.org/browse/JBPAPP-9616</a></span></dt><dd><div class="para">
					It was reported that the HornetQ journal importer would throw a <code class="systemitem">NullPointerException</code> when passed an argument of <code class="literal">false</code> for the transactional command line parameter. This was found to be occurring because the XML importer uses two different HornetQ sessions; one for normal send operations and one for management operations. In certain circumstances the management session was not instantiated properly and, when it was used, the exception was thrown. The XML importer has been updated and the issue no longer presents.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9960">https://issues.jboss.org/browse/JBPAPP-9960</a></span></dt><dd><div class="para">
					An issue was discovered which affected HornetQ high-availability clusters and failover. If, in the <code class="filename">ra.xml</code> file, the hostname was specified as a string, any active session would not failover to a backup node. The root cause of this issue has been resolved and hostnames in string format are no longer a problem for failover.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8067">https://issues.jboss.org/browse/JBPAPP-8067</a></span></dt><dd><div class="para">
					An issue was identified with HornetQ where paged messages would not be expired if there was no active consumer. The expiry scan was enhanced so that it now includes paged messages in its analysis.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9669">https://issues.jboss.org/browse/JBPAPP-9669</a></span></dt><dd><div class="para">
					When the HornetQ installer was used to install a backup server using the <em class="parameter"><code>-Dbackup</code></em>=<code class="literal">true</code> parameter, the following message would result: 
<pre class="screen">
15:18:09,615 ERROR [ProfileServiceBootstrap] Failed to load profile: Summary of incomplete deployments (SEE PREVIOUS ERRORS FOR DETAILS):

DEPLOYMENTS MISSING DEPENDENCIES:
  Deployment "AS5RecoveryRegistry" is missing the following dependencies:
    Dependency "TransactionManager" (should be in state "Installed", but is actually in state "** NOT FOUND Depends on 'TransactionManager' **")

DEPLOYMENTS IN ERROR:
  Deployment "TransactionManager" is in error due to the following reason(s): ** NOT FOUND Depends on 'TransactionManager' **
</pre>
					 The cause of this issue was that in deploying the backup server, the deployment of the AS5RecoveryRegistry mbean was also attempted but failed because of missing dependencies. To resolve this issue the AS5RecoveryRegistry mbean has been excluded from deployment.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8377">https://issues.jboss.org/browse/JBPAPP-8377</a></span></dt><dd><div class="para">
					An issue was identified in which it was possible to have duplicate resource recovery entries for one recovery manager, resulting in recovery scans conflicting with each other. This problem has been resolved by implementing auto-discovery of resources instead of manual configuration.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9603">https://issues.jboss.org/browse/JBPAPP-9603</a></span></dt><dd><div class="para">
					A memory leak was identified in the paging module. When a durable subscription was removed, the paging system was not notified, and it would keep paging for that nonexistent subscription. As a result, the resources used to maintain paging would increase and only a restart of JBoss Enterprise Application Platform would release them. The handling of durable subscriptions has been changed so that the paging system is notified, resolving the memory leak.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Installer</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7674">https://issues.jboss.org/browse/JBPAPP-7674</a></span></dt><dd><div class="para">
					Previous versions of the JBoss Enterprise Application Platform 5 graphical installer required <span class="emphasis"><em>root</em></span> privileges to run. Consequently, all files created or modified by EAP (including the launcher icons) inherited these permissions and could not be used by other accounts. To correct this behavior, the requirement for the graphical installer to be run as <span class="emphasis"><em>root</em></span> has been removed (the documentation has also been updated) and unprivileged users can now install and run an EAP 5 instance using the graphical installer.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9665">https://issues.jboss.org/browse/JBPAPP-9665</a></span></dt><dd><div class="para">
					The JTA RPM was missing a symbolic link and the RPM installation process returned the following warning: <code class="computeroutput">primary link for jta_api must be /usr/share/java/jta_1_0_1B_api.jar</code> The symbolic link has been added to the RPM package and the warning is no longer displayed on RPM installation.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7638">https://issues.jboss.org/browse/JBPAPP-7638</a></span></dt><dd><div class="para">
					The "Hotel" demonstration application would not run on Microsoft Windows Server because of restrictions implemented via User Access Control (UAC). The batch file used to start the application has been modified so that it complies with UAC's restrictions and so it now starts correctly.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8115">https://issues.jboss.org/browse/JBPAPP-8115</a></span></dt><dd><div class="para">
					When the installer was launched from the command line and WSNative was chosen as the web services stack, the following error message would occur when all prompts were completed. The root cause of this issue was a missing file. This file has been added and the installer now works correctly. 
<pre class="screen">
[ ERROR: The following error occurred while executing this line:
.../jboss-as/scripts/install-cxf.xml:8: Basedir .../jboss-as/jbossws-cxf-installer does not exist ]
com.izforge.izpack.installer.InstallerException: The following error occurred while executing this line:
.../jboss-as/scripts/install-cxf.xml:8: Basedir .../jboss-as/jbossws-cxf-installer does not exist
</pre>

				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>JCA</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7786">https://issues.jboss.org/browse/JBPAPP-7786</a></span></dt><dd><div class="para">
					The JBossTS transaction recovery manager was previously improved to prevent a stale JDBC connection for XA recovery by checking the validity of the connection before making any calls to the driver. In the case of the DB2 JDBC driver however, the validity check caused a connection to the database to be opened and remain open, preventing a planned shutdown of the DB2 RDBMS instance even though no activity was in progress. To prevent this occurring, a new system property - recover-connection-validation - has been created, allowing validation to be turned off, for example: <em class="parameter"><code>-Drecover-connection-validation=</code></em><code class="literal">false</code>.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7863">https://issues.jboss.org/browse/JBPAPP-7863</a></span></dt><dd><div class="para">
					When a thread's interrupted status was <code class="literal">true</code> and it called <code class="code">java.sql.DataSource.getConnection()</code> for a JCA datasource, it resulted in error message: 
<pre class="screen">javax.resource.ResourceException: Interrupted while requesting permit! Waited 0 ms</pre>
					 To assist debugging the following text has been added to this error message: 
<pre class="screen">The 0 ms wait time suggests the thread was already interrupted before attempting to acquire the connection. Ensure the calling thread's interrupted status is cleared before calling getConnection().</pre>

				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9236">https://issues.jboss.org/browse/JBPAPP-9236</a></span></dt><dd><div class="para">
					When a security domain was set in the data source configuration, a race condition between the <code class="systemitem">IdleRemover</code> thread and the JCA <code class="systemitem">PoolFiller</code> thread caused a connection leak, when a connection was created outside of the connection pool. Consequently, the pool failed to contain the required minimum number of connections. The race condition has been fixed and the pool connections are created correctly.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9237">https://issues.jboss.org/browse/JBPAPP-9237</a></span></dt><dd><div class="para">
					If an application called the <code class="code">setQueryTimeout()</code> method on a statement object, the database query time-out did not become effective. This happened when query-timeout was set in the data-source configuration. With this update, the time-out query is overwritten by the application that called the <code class="code">setQueryTimeout()</code> method as expected.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7464">https://issues.jboss.org/browse/JBPAPP-7464</a></span></dt><dd><div class="para">
					When the <code class="systemitem">org.jboss.resource.adapter.jdbc.xa.XAManagedConnectionFactory.equals()</code> method was executed simultaneously from multiple threads, a JCA-layer deadlock occurred. This update synchronizes three methods used within the <code class="systemitem">equals()</code> method, and changes the object type of the objects that were accessed on the deadlock from <code class="systemitem">xaProps</code> to <code class="systemitem">HashMap</code>. As a result, the <code class="systemitem">equals()</code> method can now be executed simultaneously by multiple threads and no deadlock occurs.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9384">https://issues.jboss.org/browse/JBPAPP-9384</a></span></dt><dd><div class="para">
					The <em class="parameter"><code>&lt;url-selector-strategy-class-name&gt;</code></em> property in a local-tx-datasource definition was ignored and the default implementation was used. This happened because the datasource deployer was setting the <code class="systemitem">UrlSelectorStrategyClassName</code> instead of <code class="systemitem">URLSelectorStrategyClassName</code> on the class <code class="code">BaseWrapperManagedConnectionFactory.java</code>. This mistake has been fixed and the property is picked up and applied as expected.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9463">https://issues.jboss.org/browse/JBPAPP-9463</a></span></dt><dd><div class="para">
					Previously, when using JDBC to connect to XA datasources, it was not possible to use a custom URL selector. To allow to do so, the XAData class was made public.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9470">https://issues.jboss.org/browse/JBPAPP-9470</a></span></dt><dd><div class="para">
					The <code class="systemitem">org.jboss.resource.adapter.jdbc.remote.WrapperDataSourceService.doStatementMethod</code> method did not return a proxied connection. Consequently, when the <code class="systemitem">statement.getConnection()</code> JDBC API method was called from an application, the following exception was thrown: 
<pre class="screen">
Caused by: java.lang.IllegalAccessException: Method=public abstract java.sql.Connection java.sql.Statement.getConnection() throws java.sql.SQLException does not return Serializable
at org.jboss.resource.adapter.jdbc.remote.WrapperDataSourceService.doStatementMethod(WrapperDataSourceService.java:422)
at org.jboss.resource.adapter.jdbc.remote.WrapperDataSourceService.invoke(WrapperDataSourceService.java:227)
at sun.reflect.GeneratedMethodAccessor165.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
</pre>
					 With this update, a proxied connection is returned, which eliminates the above mentioned exception and enables successful calls of the <code class="systemitem">statement.getConnection()</code> method.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7543">https://issues.jboss.org/browse/JBPAPP-7543</a></span></dt><dd><div class="para">
					In the event the Oracle database driver reported an SQLException error, this was not treated in the same way as other error events. The handling of such an error has been changed so that it is treated as a fatal database connection error. Oracle database connections are now handled using <code class="systemitem">oracle.jdbc.OracleConnection</code> instead of the deprecated <code class="systemitem">oracle.jdbc.driver.OracleConnection</code> method. The method of checking the status of an Oracle database connection has been changed, using <code class="systemitem">pingDatabase()</code> instead of the deprecated <code class="systemitem">pingDatabase(int)</code>.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>JMX</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7295">https://issues.jboss.org/browse/JBPAPP-7295</a></span></dt><dd><div class="para">
					The <code class="systemitem">traceInstructions</code>, <code class="systemitem">traceMethodCalls</code>, <code class="systemitem">runGarbageCollector</code> and <code class="systemitem">runFinalization</code> methods in <code class="systemitem">org.jboss.system.server.jmx.JMXKernel</code> were empty. Calling these methods was therefore successful, but no operation was actually performed by them. The code of the methods has been extended to call the alike named methods in <code class="systemitem">java.lang.Runtime</code>. The methods are now no longer empty and the expected operations are performed when the methods are called.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Microcontainer and Deployers</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9468">https://issues.jboss.org/browse/JBPAPP-9468</a></span></dt><dd><div class="para">
					When the <code class="systemitem">jboss.vfs.forceCanonical</code> property was set to <code class="literal">true</code>, VFS did not correctly cache <code class="systemitem">VFSXXXContext</code> objects for paths that included symbolic links. With this update, all symlinks are resolved to a path within the permanent root directory specified in the <code class="systemitem">VFSCache</code> bean defined in the <code class="filename">$JBOSS_HOME/server/$CONFIG/conf/bootstrap/vfs.xml</code> file, ensuring that the <code class="systemitem">VFSXXXContext</code> objects are now cached correctly.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>mod_cluster</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8956">https://issues.jboss.org/browse/JBPAPP-8956</a></span></dt><dd><div class="para">
					Due to a change in the proxy_balancer structure between 2.2.15 and 2.2.17 (which is the version used to compile EAP), a Segmentation Fault was thrown from <code class="filename">mod_proxy_cluster.so</code> when running more than one EAP server cluster behind a single Apache server. This was because all the clusters used the same domain name (usually the cluster name). This issue was resolved by reading the size of the <code class="systemitem">proxy_balancer</code> structure for the <code class="systemitem">httpd mod_proxy</code> tables and using that size in <code class="systemitem">mod_cluster</code> logic. The Segmentation Faults no longer present.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9396">https://issues.jboss.org/browse/JBPAPP-9396</a></span></dt><dd><div class="para">
					When using JBoss HTTP Connector (mod_cluster), an RPC (remote procedure call) failure could cause deployment of a web application to fail because RPC call exceptions were propagated to the web container. Such exceptions are no longer propagated and the problem no longer occurs.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Naming</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8838">https://issues.jboss.org/browse/JBPAPP-8838</a></span></dt><dd><div class="para">
					Naming lookups have been improved so that if a ServiceUnavailableException occurs when a <code class="systemitem">context.lookup</code> call is made, the call is retried.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>PicketLink</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7853">https://issues.jboss.org/browse/JBPAPP-7853</a></span></dt><dd><div class="para">
					The <code class="systemitem">SAMLSubjectParser</code> did not support the &lt;saml2:NameID&gt; subelement within the &lt;saml2:SubjectConfirmation&gt; subelement of the &lt;saml2:Subject&gt; element. If it found the &lt;saml2:NameID&gt; subelement, it parsed it incorrectly and threw the following exception: 
<pre class="screen">
java.lang.ClassCastException: com.ctc.wstx.evt.CompactStartElement cannot be cast to javax.xml.stream.events.EndElement
        at org.picketlink.identity.federation.core.parsers.saml.SAMLSubjectParser.parse(SAMLSubjectParser.java:123)
        at org.picketlink.identity.federation.core.parsers.saml.SAMLAssertionParser.parse(SAMLAssertionParser.java:148)
        at org.picketlink.identity.federation.core.parsers.saml.SAMLParser.parse(SAMLParser.java:76)
</pre>
					 This update modifies the <code class="systemitem">SAMLSubjectParser</code> to support the &lt;saml2:NameID&gt; subelement within the previously mentioned elements. The <em class="parameter"><code>&lt;saml2:NameID&gt;</code></em> subelement is now parsed correctly and the exception cited above is no longer thrown.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Profile Service</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9213">https://issues.jboss.org/browse/JBPAPP-9213</a></span></dt><dd><div class="para">
					When the user attempted to create a JMS queue or topic in the admin-console, the process failed due to missing default values of the <code class="systemitem">expiryQueue</code>, <abbr class="abbrev">DLQ</abbr>, and <code class="systemitem">serverPeer</code> properties. Now, the properties are populated with acceptable default values within the UI in the admin-console when a new message queue or topic is being created.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9406">https://issues.jboss.org/browse/JBPAPP-9406</a></span></dt><dd><div class="para">
					Due to a race condition when clearing and reloading the ProfileService ManagementView, the Admin Console and JBoss ON randomly report that managed components were missing or not available. The respective reloading process has been fixed and the race condition no longer occurs.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Remoting</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8912">https://issues.jboss.org/browse/JBPAPP-8912</a></span></dt><dd><div class="para">
					If you had configured JBossWS clients to use the socket factory returned by <code class="code">HttpsURLConnection.getDefaultSSLSocketFactory()</code>, then you would receive an ERROR log message even though the configuration would work properly. The code causing this issue has been cleaned up, and a new property is available to tell JBossWS to use the default SSL socket factory: <code class="systemitem">StubExt.PROPERTY_DEFAULT_SSL_SOCKET_FACTORY</code>.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Scripts and Commands</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7436">https://issues.jboss.org/browse/JBPAPP-7436</a></span></dt><dd><div class="para">
					Due to missing quotation of certain echo statements in the <code class="filename">run.bat</code> script, JBoss Enterprise Application Platform failed to start if the JBOSS_HOME path contained one or more parentheses (e.g. <code class="filename">C:\JB-EAP(test)\jboss-eap-5.1\jboss-as</code>), and returned the following error message: 
<pre class="screen">
\Jboss-5.1.0\bin\run.conf.bat was unexpected at this time.
</pre>
					 Double quotes have been added around the echo statements in the <code class="filename">run.bat</code> file, ensuring that JBoss Enterprise Application Platform starts successfully even if the JBOSS_HOME path contains parentheses.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9581">https://issues.jboss.org/browse/JBPAPP-9581</a></span></dt><dd><div class="para">
					JBoss Enterprise Application Platform attempted to load a per-profile <code class="filename">run.conf</code> file from the default location in <code class="filename">$JBOSS_HOME/server/$PROFILE</code>. Consequently, per-profile <code class="filename">run.conf</code> files stored in a different location were not loaded. The <code class="literal">--run-conf=...</code> option (on Windows: <code class="literal">-r</code>) has been added to the <code class="filename">run.sh</code> script, allowing to specify the location of the <code class="filename">run.conf</code> file that should be used. Using this option, per-profile <code class="filename">run.conf</code> files stored in another than the default location can now be loaded correctly.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7514">https://issues.jboss.org/browse/JBPAPP-7514</a></span></dt><dd><div class="para">
					In JBoss Enterprise Application Platform version 5.1.1, the <code class="filename">run.sh</code> startup script was enhanced to include a test for a 64-bit JVM. However, this test was not working on Solaris because the standard <code class="command">grep</code> command does not support the <em class="parameter"><code>-e</code></em>, which specifies the regular expression to be used in the search. This issue was resolved by explicitly using <code class="filename">/usr/xpg4/bin/grep</code> since this does support the regular expression parameter <em class="parameter"><code>-e</code></em>.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8148">https://issues.jboss.org/browse/JBPAPP-8148</a></span></dt><dd><div class="para">
					An issue was found with the the JBoss Native service batch file on Windows Server. When JBoss Enterprise Application Platform was started, the service batch file (<code class="filename">service.bat</code>) searched for its associated configuration batch file in the wrong directory, resulting in the error message <code class="computeroutput">Config file not found $JBOSS_DIST/native/sbin/run.conf.bat</code>. The cause of the issue was that it was looking for the configuration batch file in <code class="filename">$JBOSS_HOME/bin</code> when instead it was in <code class="filename">$JBOSS_DIST/native/sbin</code>. The service batch file has now been corrected with the correct path specified.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Seam/Seam2</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-6376">https://issues.jboss.org/browse/JBPAPP-6376</a></span></dt><dd><div class="para">
					The DVD Store demonstration Seam application provided with JBoss Enterprise Application Platform failed to deploy. The application is now updated and will successfully deploy.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7269">https://issues.jboss.org/browse/JBPAPP-7269</a></span></dt><dd><div class="para">
					When using the <em class="parameter"><code>&lt;s:token /&gt;</code></em> tag in JSF, the <code class="systemitem">javax.faces.ClientToken</code> cookie that is created sometimes contained illegal characters, for example: semicolon ";", resulting in the following error message: 
<pre class="screen">
org.jboss.seam.ui.UnauthorizedCommandException: viewId: /restricted/desktop.xhtml - Form signature invalid
</pre>
					 The cause of this issue was that the code which created the cookie's value did no validation. The code has been amended so that the cookie can contain only letters and digits, avoiding the circumstances leading to the error message above.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8041">https://issues.jboss.org/browse/JBPAPP-8041</a></span></dt><dd><div class="para">
					The execution of the "ant eclipseclasspath" task failed as the OpenId dependency <code class="filename">pom</code> file was incorrectly included in the generation of Eclipse project files. The ant task now ignores the <code class="filename">pom</code> files and the problem no longer occurs.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8322">https://issues.jboss.org/browse/JBPAPP-8322</a></span></dt><dd><div class="para">
					As JNDI transaction lookup was changed in JBoss Enterprise Application Platform (EAP) 6, the <code class="systemitem">org.jboss.seam.transaction.transaction</code> Seam 2.2.x component failed to look up transaction contexts. The respective transaction lookup was added to Seam in JBoss Enterprise Application Platform 5 so that transaction lookup from user applications and the Seam examples now work as expected on <span class="emphasis"><em>both</em></span> JBoss Enterprise Application Platform 5 and 6.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-6924">https://issues.jboss.org/browse/JBPAPP-6924</a></span></dt><dd><div class="para">
					Multiple Seam classes have been changed to make JpaIdentityStore clusterable. The changes include serialization of the involved classes.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8159">https://issues.jboss.org/browse/JBPAPP-8159</a></span></dt><dd><div class="para">
					Seam component precedence defined in the <code class="filename">components.xml</code> file was not taken into account when initializing component properties. If a property of the same component was defined more than once in the file, the last occurrence in the file was used, not the one defined in the <code class="systemitem">&lt;component&gt;</code> element with the highest value of the <code class="systemitem">precedence</code> attribute. This behaviour is now fixed and the property value defined in the <code class="systemitem">&lt;component&gt;</code> element with the highest precedence is used during component initialization.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7957">https://issues.jboss.org/browse/JBPAPP-7957</a></span></dt><dd><div class="para">
					When the <em class="parameter"><code>&lt;p:piechart&gt;</code></em> element was used inside the <em class="parameter"><code>&lt;ui:repeat&gt;</code></em> element, data in the piechart dataset generated in every <em class="parameter"><code>&lt;ui:repeat&gt;</code></em> iteration were accumulated with the ones form the previous iterations. The behaviour has been fixed to reset and create the dataset in every iteration, which ensures that correct datasets are now generated.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7201">https://issues.jboss.org/browse/JBPAPP-7201</a></span></dt><dd><div class="para">
					Business interfaces in a Seam Component were stored in the <code class="systemitem">java.util.HashSet</code> data structure. This data structure does not guarantee the order of elements, thus the order of business interfaces was nondeterministic. This was fixed by using the <code class="systemitem">java.util.LinkedHashSet</code> data structure instead.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7183">https://issues.jboss.org/browse/JBPAPP-7183</a></span></dt><dd><div class="para">
					When using the <em class="parameter"><code>&lt;s:token /&gt;</code></em> tag in JSF, the <code class="systemitem">javax.faces.ClientToken</code> cookie that is created sometimes had an empty ("") path. The cookie was then not accepted in certain versions of <span class="application"><strong>Windows Internet Explorer</strong></span> and the following error message was returned: 
<pre class="screen">
viewId: /myPage.xhtml - No client identifier provided.
</pre>
					 This update ensures that when an empty path is detected, the cookie path is set to "/". As a result, the cookie is accepted by all browsers and the above mentioned error message is no longer returned.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8376">https://issues.jboss.org/browse/JBPAPP-8376</a></span></dt><dd><div class="para">
					The Seambay example failed the functional tests on EAP 6, throwing a <code class="systemitem">NotLoggedInException</code>. This was caused by the underlying issue JBPAPP-10075, which was fixed in this release.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-10075">https://issues.jboss.org/browse/JBPAPP-10075</a></span></dt><dd><div class="para">
					The Seam web service integration uses the SOAP header for storing the conversation's ID. However the SOAP header is not mandatory and in JBoss Enterprise PLatform 6 it is no longer present by default. Therefore any attempts by a Seam web service to process a message without a header failed. To resolve this issue the <code class="systemitem">SOAPRequestHandler</code> now adds a header to any message where a header is missing.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8465">https://issues.jboss.org/browse/JBPAPP-8465</a></span></dt><dd><div class="para">
					The Spring example application failed to run on JBoss Enterprise Application Platform 6 because the <code class="filename">cglib.jar</code> file was signed. This has now been resolved by un-signing the file and the example now runs on JBoss Enterprise Application Platform 5 and 6.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8915">https://issues.jboss.org/browse/JBPAPP-8915</a></span></dt><dd><div class="para">
					The version of Drools distributed as part of JBoss Enterprise Application Platform 5.1.2 was incompatible with Java 7. To resolve this issue the Drools component has been upgraded.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7520">https://issues.jboss.org/browse/JBPAPP-7520</a></span></dt><dd><div class="para">
					The seam-gen tool by default obtained the database driver for the Hypersonic database from <code class="filename">${seam.dir}/lib/hsqldb.jar</code>. However, that file was moved in an earlier version, resulting in a failed database connection. This issue has been resolved by obtaining the driver from the directory <code class="filename">${jboss.home}/common/lib/hsqldb.jar</code>.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Security</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8089">https://issues.jboss.org/browse/JBPAPP-8089</a></span></dt><dd><div class="para">
					The <code class="systemitem">j_password</code> form field parameter was not filtered out of auditing logs, which caused unintended password exposure in the <code class="filename">audit.log</code> file. The underlying source code for audit logging has been enhanced to filter out the <code class="systemitem">j_password</code> parameter so that it no longer occurs in the <code class="filename">audit.log</code> file.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7794">https://issues.jboss.org/browse/JBPAPP-7794</a></span></dt><dd><div class="para">
					Login modules have been enhanced so that if invalid configuration options are used, these are logged as warnings. This reduces the time required to diagnose the problem.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>System</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9973">https://issues.jboss.org/browse/JBPAPP-9973</a></span></dt><dd><div class="para">
					When two subsequent calls to suspend the hot deployment scanner were made without resuming the scanner in between the calls, any following calls of the <code class="systemitem">resume()</code> method were not functional. As a result, it became impossible to resume the scanner. This behavior has been fixed and it is now possible to resume the hot deployment scanner after a series of subsequent suspend calls.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Transaction Manager</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8073">https://issues.jboss.org/browse/JBPAPP-8073</a></span></dt><dd><div class="para">
					If an unexpected failure occurred during execution of the <code class="systemitem">Synchronization.afterCompletion</code> method, the original exception thrown after the failure was not logged and the following warning was logged instead: 
<pre class="programlisting">
2012-02-08 12:47:31,402 WARN  [com.arjuna.ats.arjuna.logging.arjLoggerI18N] (WorkerThread#0[127.0.0.1:46304]) [com.arjuna.ats.arjuna.coordinator.TwoPhaseCoordinator_4] TwoPhaseCoordinator.afterCompletion - returned failure for com.arjuna.ats.internal.jta.resources.arjunacore.SynchronizationImple@3c255a5a
</pre>
					 This behavior prevented exact identification of the failure. With this update, logging has been extended to include such exceptions. The exceptions are now logged, enabling easier identification of failures that occur.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Web</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-10001">https://issues.jboss.org/browse/JBPAPP-10001</a></span></dt><dd><div class="para">
					JBoss Web would only start processing requests once it had received notification from the bootstrap process that everything had been successfully booted. If the bootstrap failed, the result was that the application server was running and consuming resources, but not accepting connections. This behaviour has been changed so that JBoss Enterprise Application Platform exits if the bootstrap fails. On exiting it outputs the message <code class="computeroutput">Failed to boot JBoss</code> and a stack trace. This change brings JBoss Enterprise Application Platform 5 in line with the behaviour of JBoss Enterprise Application Platform 6.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9561">https://issues.jboss.org/browse/JBPAPP-9561</a></span></dt><dd><div class="para">
					Error during startup in <code class="systemitem">ClusteredSingleSignOn</code> valve was incorrectly logged as the <span class="emphasis"><em>Caught exception stopping</em></span>. With this update, the problem has been fixed and the error is now logged as <span class="emphasis"><em>Caught exception starting</em></span>.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8112">https://issues.jboss.org/browse/JBPAPP-8112</a></span></dt><dd><div class="para">
					Due to a regression, the compilation of some JSPs with JSF tags (for example <em class="parameter"><code>&lt;h:outputText value="\\"&gt;</code></em>) failed with an exception similar to the following: 
<pre class="screen">
Caused by: org.apache.jasper.JasperException: /pages/preferences.jsp
According to TLD or attribute directive in tag file, attribute value does not accept any expressions
</pre>
					 This happened because of incorrect expression parsing. Now, the regression has been fixed and the problem no longer occurs.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7210">https://issues.jboss.org/browse/JBPAPP-7210</a></span></dt><dd><div class="para">
					It was found that when an AJP message with a request body was received, an unsolicited AJP message containing the first part or the entire request body was sent to the web server under certain circumstances. This injected message could be processed as a new request which would permit an attacker to gain full control over the AJP message and bypass authentication, and lead to information disclosure. With this update, such message injections no longer take place.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7401">https://issues.jboss.org/browse/JBPAPP-7401</a></span></dt><dd><div class="para">
					There was a concurrency issue in Tomcat. When the <code class="systemitem">javax.servlet.ServletOutputStream.write</code> method got accessed by multiple threads, it sometimes got called while the previous thread had not yet finished writing of the byte buffer, or when its own buffer had not yet been flushed. This resulted in corrupted output and the following exception was thrown: 
<pre class="screen">
SEVERE: Servlet.service() for servlet default threw exception
java.io.IOException: Bad file number
	at java.io.FileInputStream.readBytes(Native Method)
	at java.io.FileInputStream.read(FileInputStream.java:199)
	at java.io.BufferedInputStream.read1(BufferedInputStream.java:256)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:317)
	at java.io.FilterInputStream.read(FilterInputStream.java:90)
	at org.apache.catalina.servlets.DefaultServlet.copyRange(DefaultServlet.java:1968)
	at org.apache.catalina.servlets.DefaultServlet.copy(DefaultServlet.java:1714)
	at org.apache.catalina.servlets.DefaultServlet.serveResource(DefaultServlet.java:809)
	at org.apache.catalina.servlets.DefaultServlet.doGet(DefaultServlet.java:325)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:690)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)
</pre>
					 This update modifies the underlying source code and ensures that such concurrency is avoided. The <code class="systemitem">javax.servlet.ServletOutputStream.write</code> method can now be accessed by multiple threads without causing the previously mentioned issue.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7098">https://issues.jboss.org/browse/JBPAPP-7098</a></span></dt><dd><div class="para">
					A number of security vulnerabilities were identified in JBoss Web. These have now been resolved in this release and in patches to the previous release. Refer to <span class="bold bold"><strong>CVE-2011-2204</strong></span>, <span class="bold bold"><strong>CVE-2011-2729</strong></span>, <span class="bold bold"><strong>CVE-2011-1184</strong></span>, <span class="bold bold"><strong>CVE-2011-2526</strong></span> and <span class="bold bold"><strong>CVE-2011-4858</strong></span> for details of the vulnerabilities.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-6382">https://issues.jboss.org/browse/JBPAPP-6382</a></span></dt><dd><div class="para">
					When a <code class="literal">null</code> reference and a <code class="systemitem">Number</code> type was passed to the <code class="systemitem">coerceToType</code> method of the <code class="systemitem">org.apache.el.lang.ELSupport</code> class, the following error message was thrown: 
<pre class="screen">java.lang.IllegalArgumentException: Cannot convert 0 of type class java.lang.Long to class java.lang.Number</pre>
					 The cause of this issue was that the <code class="systemitem">coerceToNumber</code> method did not check if the value was of the <code class="systemitem">Number</code> type. This test has now been added, resolving this bug.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Web Services</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8011">https://issues.jboss.org/browse/JBPAPP-8011</a></span></dt><dd><div class="para">
					Previously, when <code class="literal">jbossws.undefined.host</code> was used as the value of the <code class="systemitem">webServiceHost</code> property in the <code class="filename">jboss-beans.xml</code> file, the <code class="literal">REPLACE_WITH_ACTUAL_URL</code> string was not replaced by the actual address when used in a WSDL definition as the value of the <code class="systemitem">location</code> attribute of the <code class="systemitem">soap12.address</code> element. This update fixes this issue and the <code class="literal">REPLACE_WITH_ACTUAL_URL</code> string is now replaced with the appropriate SOAP 1.2 address.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7108">https://issues.jboss.org/browse/JBPAPP-7108</a></span></dt><dd><div class="para">
					Changes made to resolve a security issue (<a href="https://issues.jboss.org/browse/JBPAPP-6879">JBPAPP-6879</a>) created a performance regression. The cause of the issue was that in the related change, the DOCTYPE declaration in DOMUtils was disabled. This has been corrected and the performance regression no longer occurs.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-6860">https://issues.jboss.org/browse/JBPAPP-6860</a></span></dt><dd><div class="para">
					When a JBoss Web Services (WS) client sent a response containing an invalid character, it returned <code class="computeroutput">null</code> rather than raising an exception. The expected behaviour was that the client stub throw the following exception: <code class="computeroutput">javax.xml.ws.WebServiceException</code>. The only error reported, logged to <code class="systemitem">stderr</code>, was as follows: 
<pre class="screen">
ERROR [STDERR] [Fatal Error] :2:1462: An invalid XML character (Unicode: 0xffff) was found in the element content of the document.
</pre>
					 A system property <em class="parameter"><code>org.jboss.ws.IgnoreParseError</code></em> can now be set on the client side using JBossWS to allow exceptions to be propagated to the client instead of returning <code class="computeroutput">null</code>. If this property is not set, <code class="computeroutput">null</code> is returned as previously.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7498">https://issues.jboss.org/browse/JBPAPP-7498</a></span></dt><dd><div class="para">
					When using the SOAP Envelope and accessing the default namespace, a <code class="computeroutput">NullPointerException</code> would be raised. The root cause of this issue has been resolved, so that this issue will no longer occur.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-6249">https://issues.jboss.org/browse/JBPAPP-6249</a></span></dt><dd><div class="para">
					The JBossWS-CXF JAXWS client relies on the CXF ProviderImpl which requires a Bus instance. Unless a Bus was associated with the current thread, the Bus retrieval process returned the Bus instance that was created for the server. Now a customized Provider implementation creates a new Bus instance for the client and the Bus request returns this Bus instance.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7900">https://issues.jboss.org/browse/JBPAPP-7900</a></span></dt><dd><div class="para">
					An upstream patch applied to the Java Architecture for XML Binding (JAXB) component was found not to be thread safe. The issue was patched and the patched version of JAXB has been included in this release of JBoss Enterprise Application Platform 5.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7982">https://issues.jboss.org/browse/JBPAPP-7982</a></span></dt><dd><div class="para">
					JBossWS previously did a character-for-character comparison of the issuer field of certificates when comparing the client's certificate against the truststore's certificate. It now follows the X509 specification more closely, allowing issuer fields to be considered a match when not an exact character-for-character match.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8810">https://issues.jboss.org/browse/JBPAPP-8810</a></span></dt><dd><div class="para">
					JBossWS-CFX failed to create a dispatch object when using <code class="systemitem">javax.xml.ws.Service.createDispatch()</code> methods involving EPRs (Endpoint Reference) with the following exception: 
<pre class="screen">javax.xml.ws.WebServiceException: Cannot find port: null</pre>
					 Consequently, the web service invocation failed. This happened due to missing and incorrect code for handling EPR deserialization. With this update, the deserialization code has been provided and corrected, and the problem no longer occurs.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7112">https://issues.jboss.org/browse/JBPAPP-7112</a></span></dt><dd><div class="para">
					When requesting a WSDL or external XML schema from a JBossWS endpoint (e.g. with <span class="emphasis"><em>?wsdl</em></span>), the XML declaration was omitted. This issue has been resolved and the declaration is now included with UTF-8 encoding.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7461">https://issues.jboss.org/browse/JBPAPP-7461</a></span></dt><dd><div class="para">
					The <code class="literal">2.5.4.SP1</code> version of JBoss Remoting was specified as a dependency in the <code class="filename">pom.xml</code> file for JBossWS Native stack. This version was outdated compared to the Enterprise Application Platform component matrix, which contained version <code class="literal">2.5.4.SP3</code>. With this update, the <code class="filename">pom.xml</code> file has been updated and now contains the correct dependency on version <code class="literal">2.5.4.SP3</code>.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9457">https://issues.jboss.org/browse/JBPAPP-9457</a></span></dt><dd><div class="para">
					Due to an issue in a DOM utility class, the procedure for finding children of a soap element by their tag name was failing and returned a NullPointerException when the soap element had the null namespace. With the update, the parsing process has been fixed and the search process completes successfully.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9517">https://issues.jboss.org/browse/JBPAPP-9517</a></span></dt><dd><div class="para">
					The invocation message could not previously be validated if a WSDL contained multiple nested schemas. This issue how now been resolved and nested schemas are now validated correctly.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9520">https://issues.jboss.org/browse/JBPAPP-9520</a></span></dt><dd><div class="para">
					Previously, a random number was added to each temporary file's name, causing inconsistent naming across instance restarts or reboots, and also in load-balanced environments. This resulted in inconsistencies in load-balanced environments and OutOfMemory errors in cases where millions of temporary files were created. With this update, MD5 hashes are used instead of the random numbers, ensuring unique file identification and avoiding the previous issues.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9545">https://issues.jboss.org/browse/JBPAPP-9545</a></span></dt><dd><div class="para">
					The exception when a class name from <code class="systemitem">@WebService.endpointInterface</code> is incorrect was difficult to understand. The exception now explains why the error was thrown, making it easier to pinpoint the root cause.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8118">https://issues.jboss.org/browse/JBPAPP-8118</a></span></dt><dd><div class="para">
					A keystore can contain a private key that has a different password to the password of the keystore. To use the key in a web service client, the key-password pair must be defined in the <em class="parameter"><code>&lt;key-password&gt;</code></em> element in the <code class="filename">jboss-wsse-client.xml</code> configuration file. Previously, the WS client or WS endpoint that used the configuration file did not process the <em class="parameter"><code>&lt;key-password&gt;</code></em> element as the jbossws service failed to pick up the element. The service now detects and picks up the <em class="parameter"><code>&lt;key-password&gt;</code></em> element as expected and the problem no longer occurs.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8018">https://issues.jboss.org/browse/JBPAPP-8018</a></span></dt><dd><div class="para">
					Web Services Description Language (WSDL) files in the directory <code class="filename">&lt;SERVER&gt;/data/wsdl</code> were re-generated after each EAP server restart, but existing temporary files were not deleted, resulting in an ever-increasing storage usage. Handling of these files has now been improved, with consistent file naming across restarts avoiding the need to recreate them. The new method uses an MD5 hash to uniquely identify each file.
				</div></dd></dl></div><div class="variablelist"><p class="title"><strong>Other</strong></p><dl class="variablelist"><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9412">https://issues.jboss.org/browse/JBPAPP-9412</a></span></dt><dd><div class="para">
					It was found that when a <code class="filename">.sar</code> archive that declared a classpath element in its <code class="filename">*-service.xml</code> file was deployed, the <code class="systemitem">MANIFEST.MF Class-Path</code> of the <code class="filename">.jar</code> files specified in the <code class="filename">.sar</code>'s classpath were not added to the <code class="filename">.sar</code>'s classpath. This release has patched the <code class="systemitem">SARDeployer</code> such that the classpath is transitive, so if the <code class="filename">sar</code>'s classpath includes <code class="filename">x.jar</code> and <code class="filename">x.jar</code>'s classpath includes <code class="filename">z.jar</code>, then the <code class="filename">.sar</code>'s classpath also includes <code class="filename">z.jar</code> as it should.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-6920">https://issues.jboss.org/browse/JBPAPP-6920</a></span></dt><dd><div class="para">
					A syntax error was discovered in the <code class="filename">run.bat</code> batch file distributed with JBoss Enterprise Application Platform 5.1.1. When run on Windows Server, if <code class="filename">bin</code> directory was not the current directory, <code class="filename">run.bat</code> failed to call the associated <code class="filename">run.conf.bat</code>. The batch file has now been corrected and <code class="filename">run.conf.bat</code> is called as intended.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-10165">https://issues.jboss.org/browse/JBPAPP-10165</a></span></dt><dd><div class="para">
					An infinite number of reconnection attempts can be specified by setting the value of the <code class="systemitem">reconnectAttempts</code> property of a message driven bean to <code class="literal">-1</code>: 
<pre class="programlisting"> 
@ActivationConfigProperty(propertyName="reconnectAttempts", propertyValue="-1")
</pre>
					 However, this was previously functional only with HornetQ. With JBoss Messaging, no reconnection attempts were performed when the <code class="literal">-1</code> value was used. With this update, the underlying JBoss Messaging source code has been modified to support this value. As a result, an infinite number of reconnection attempts is now performed when the value is set to <code class="literal">-1</code>.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7800">https://issues.jboss.org/browse/JBPAPP-7800</a></span></dt><dd><div class="para">
					The Apache xml-commons resolver did not correctly convert paths to URLs. Instead, it prefixed the path with <code class="literal">file:</code> and passed it to the URL constructor. This method was incompatible with Microsoft Windows Server because <code class="literal">file:C:\...</code> is not a valid file URL. This function has been corrected and the method of converting paths to URLs is now compatible with all supported platforms.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9156">https://issues.jboss.org/browse/JBPAPP-9156</a></span></dt><dd><div class="para">
					An issue was found in an underlying library, in which a <code class="computeroutput">StackOverFlow</code> error could occur while validating a long XML file against a schema. The root cause of this issue has been resolved and the error no longer occurs.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-6327">https://issues.jboss.org/browse/JBPAPP-6327</a></span></dt><dd><div class="para">
					Messages for any given queue could not be removed when the messages were paged. The HornetQ core API removed only the in-memory messages but not the paged ones when <code class="systemitem">jmsQueueControl.removeMessages(null)</code> was used. This problem has now been solved and both paged and non-paged messages are successfully removed from the message queue.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9685">https://issues.jboss.org/browse/JBPAPP-9685</a></span></dt><dd><div class="para">
					Previous versions of JBoss Enterprise Application Platform 5 were released with a bug in the <code class="filename">log4j.xml</code> file. This file contained two <code class="literal">jgroups</code> categories. This prevented correct logging and resulted in empty <code class="filename">cluster.log</code> files. The extra <code class="literal">jgroups</code> category has been removed in this release and logging now functions correctly.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9316">https://issues.jboss.org/browse/JBPAPP-9316</a></span></dt><dd><div class="para">
					Oracle's JDK7 changed the way in which the <code class="systemitem">ProperyEditors</code> registry was stored. What was previously a global registry became a per <code class="systemitem">ThreadGroup</code> registry. EAP 5.2.0 has removed the use of <code class="systemitem">PropertyEditorManager</code> and implements a new facility provided by <code class="systemitem">jboss-common-beans</code> to accommodate this. Clients whose applications use custom <code class="systemitem">ProperyEditors</code> should be aware of this change.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-9642">https://issues.jboss.org/browse/JBPAPP-9642</a></span></dt><dd><div class="para">
					The root directory of JBoss Enterprise Application Platform now contains the <code class="filename">version.txt</code> file with the full name and exact version of the installed product.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-8065">https://issues.jboss.org/browse/JBPAPP-8065</a></span></dt><dd><div class="para">
					When a third party JAR or application tried to open a connection and provide a URL that was not a valid URI, the following exception was thrown and the connection was not established: 
<pre class="screen">
java.lang.IllegalArgumentException: URI is not hierarchical
at java.io.File.&lt;init&gt;(File.java:363)
at org.jboss.net.protocol.file.FileURLConnection.&lt;init&gt;(FileURLConnection.java:62)
at org.jboss.net.protocol.file.Handler.openConnection(Handler.java:40)
at java.net.URL.openConnection(URL.java:945)
at java.net.URL.openStream(URL.java:1010)
</pre>
					 This update ensures that when the <code class="systemitem">org.jboss.net.protocol.file.useURI</code> system property is set to <code class="literal">false</code>, the provided URLs is not required to be a valid URI. As a result, the exception is no longer thrown when the property is set to <code class="literal">false</code>, and the connection can be successfully established.
				</div></dd><dt><span class="term"><a href="https://issues.jboss.org/browse/JBPAPP-7609">https://issues.jboss.org/browse/JBPAPP-7609</a></span></dt><dd><div class="para">
					Classloading classes did not cache the results of <code class="systemitem">getResourcesLocally()</code> as they do for <code class="systemitem">getResourceLocally()</code>, resulting in <code class="systemitem">Classloader.getResources()</code> running slowly. This could cause performance issues if it was called often, as Java's <code class="systemitem">ServerFinder</code> would do if its results were not cached. To resolve this issue, caching has now been implemented in classloading classes, resulting in better overall performance.
				</div></dd></dl></div></div></body></html>