<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 4. Launching non-clustered managed domain</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="launching_non_clustered_managed_domain"/>Chapter 4. Launching non-clustered managed domain</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="launch_instance_to_serve_domain_controller"/>Launch an Instance to Serve as a Domain Controller</h1></div></div></div><p>
				This topic lists the steps to launch a non-clustered JBoss EAP managed domain on a Red Hat Amazon Machine Image (AMI).
			</p><h3><a id="prerequisite"/>Prerequisite</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						A suitable Red Hat AMI. See <a class="link" href="about_amazon_ec2.html#supported_red_hat_AMIs" title="Supported Red Hat AMIs">Supported Red Hat AMIs</a> for more information.
					</li></ul></div><h3><a id="launch_a_non_clustered_jboss_eap_instance_2"/>Launch a Non-Clustered JBoss EAP Instance</h3><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					You can connect to an EC2 instance through <code class="literal">ssh</code> as the <code class="literal">ec2-user</code> user. If you need administrative privileges, you can change to <code class="literal">root</code> user later. For example,
				</p><pre class="screen">$ ssh -l ec2-user ${INSTANCE_PUBLIC_IP}
...
$ sudo su -</pre></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
						Launch the Red Hat AMI instance.
					</p><p class="simpara">
						A non-clustered instance of JBoss EAP has been configured and launched on a Red Hat AMI.
					</p></li><li class="listitem"><p class="simpara">
						To configure JBoss EAP, you can pass arguments to the service directly. Some arguments may not be handled in this way. The location of the service configuration files is:
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								RHEL 6: <code class="literal">/etc/sysconfig/eap7-domain</code>
							</li><li class="listitem">
								RHEL 7: <code class="literal">/etc/opt/rh/eap7/wildfly/eap7-domain.conf</code>
							</li></ul></div></li></ul></div><p>
				See <a class="link" href="reference_material.html#system_paths" title="System Paths">System Paths</a> for more details about system paths.
			</p><p>
				See <a class="link" href="reference_material.html#configuring_subsystems_for_cloud_platforms" title="Configuring JBoss EAP Subsystems to Work on Cloud Platforms">Configuring JBoss EAP Subsystems to Work on Cloud Platforms</a> for information about configuring JBoss EAP subsystems for Amazon EC2.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							For complex configuration, you can either use the <code class="literal">domain.conf</code> file in the JBoss EAP <code class="literal">bin</code> directory: <code class="literal">/opt/rh/eap7/root/usr/share/wildfly/bin/</code>, or you can start the JBoss EAP service and configure the server using the management CLI. The script can be found in the <code class="literal">bin</code> directory. Then, reload the configuration.
						</li><li class="listitem">
							You must regularly run the <code class="literal">yum -y update</code> to apply security fixes and enhancements.
						</li></ul></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
						To start JBoss EAP on RHEL 6, run the following command:
					</p><pre class="screen">$ service eap7-domain start</pre><p class="simpara">
						To start JBoss EAP on RHEL 7, run the following command:
					</p><pre class="screen">$ systemctl start eap7-domain</pre></li><li class="listitem"><p class="simpara">
						To stop JBoss EAP on RHEL 6, run the following command:
					</p><pre class="screen">$ service eap7-domain stop</pre><p class="simpara">
						To stop JBoss EAP on RHEL 7, run the following command:
					</p><pre class="screen">$ systemctl stop eap7-domain</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
							The <code class="literal">systemctl</code> command is relevant to only RHEL 7.
						</p></div></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					If you want to bind JBoss EAP to a different IP address, add the following line in the <code class="literal">/etc/opt/rh/eap7/wildfly/eap7-domain.conf</code> file on RHEL 7. The internal IP address is translated into a public IP address by EC2.
				</p><pre class="screen">WILDFLY_BIND=$YOUR_PRIVATE_IP_ADDRESS</pre></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="launch_one_or_more_instances_serve_as_host_controllers"/>Launch One or More Instances to Serve as Host Controllers</h1></div></div></div><p>
				This topic lists the steps to launch one or more instances of JBoss EAP to serve as non-clustered host controllers on a Red Hat AMI.
			</p><p>
				Configure and launch the non-clustered domain controller. Refer to <a class="link" href="launching_non_clustered_managed_domain.html#launch_instance_to_serve_domain_controller" title="Launch an Instance to Serve as a Domain Controller">Launch an Instance to Serve as a Domain Controller</a>.
			</p><p>
				See <a class="link" href="reference_material.html#system_paths" title="System Paths">System Paths</a> for more details about system paths.
			</p><p>
				See <a class="link" href="reference_material.html#configuring_subsystems_for_cloud_platforms" title="Configuring JBoss EAP Subsystems to Work on Cloud Platforms">Configuring JBoss EAP Subsystems to Work on Cloud Platforms</a> for information about configuring JBoss EAP subsystems for Amazon EC2.
			</p><h3><a id="for_domain_controller_instance"/>For Domain Controller Instance</h3><p>
				For a managed domain running on Amazon EC2, in addition to static domain controller discovery, host controllers can dynamically discover a domain controller using the Amazon Simple Storage (Amazon S3) system. In particular, host controllers and the domain controller can be configured with information needed to access an Amazon S3 bucket.
			</p><p>
				Using this configuration, when a domain controller is started, it writes its contact information to an S3 file in the bucket. Whenever a host controller attempts to contact the domain controller, it gets the domain controller’s contact information from the <code class="literal">S3</code> file.
			</p><p>
				For example, it is common for an Amazon EC2 instance’s IP address to change when it is stopped and started. In this scenario, if the domain controller’s contact information changes, the host controllers need not be reconfigured. The host controllers are able to get the domain controller’s new contact information from the <code class="literal">S3</code> file.
			</p><p>
				See <a class="link" href="reference_material.html#example_user_data_clustered_eap_instances" title="Example User Data for Clustered JBoss EAP Instances">Example User Data for Clustered JBoss EAP Instances</a> for more information about sample script for user data.
			</p><p>
				The manual domain controller discovery configuration is specified using the following properties:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<code class="literal">access-key</code>: The Amazon AWS user account access key.
					</li><li class="listitem">
						<code class="literal">secret-access-key</code>: The Amazon AWS user account secret access key.
					</li><li class="listitem"><p class="simpara">
						<code class="literal">location</code>: The Amazon S3 bucket to be used.
					</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
								Copy the <code class="literal">domain-ec2.xml</code> file from <code class="literal">/opt/rh/eap7/root/usr/share/wildfly/docs/examples/configs</code> to the JBoss EAP configuration directory.
							</li><li class="listitem"><p class="simpara">
								Set the following variables in the appropriate service configuration file:
							</p><pre class="screen">WILDFLY_SERVER_CONFIG=domain-ec2.xml
WILDFLY_HOST_CONFIG=host-master.xml</pre></li><li class="listitem"><p class="simpara">
								Add the S3 domain controller discovery configuration to the <code class="literal">domain-ec2.xml</code> file:
							</p><pre class="programlisting">&lt;local&gt;
    &lt;discovery-options&gt;
        &lt;discovery-option name="s3-discovery" module="org.jboss.as.host-controller" code="org.jboss.as.host.controller.discovery.S3Discovery"&gt;
            &lt;property name="access-key" value="S3_ACCESS_KEY"/&gt;
            &lt;property name="secret-access-key" value="S3_SECRET_ACCESS_KEY"/&gt;
            &lt;property name="location" value="S3_BUCKET_NAME"/&gt;
        &lt;/discovery-option&gt;
    &lt;/discovery-options&gt;
&lt;/local&gt;</pre></li></ol></div></li></ul></div></div></div></body></html>