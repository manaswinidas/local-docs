<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. Configuring JVM Settings</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="configuring_jvm_settings"/>Chapter 9. Configuring JVM Settings</h1></div></div></div><p>
			Configuration of Java Virtual Machine (JVM) settings is different for a standalone JBoss EAP server, or a JBoss EAP server in a managed domain.
		</p><p>
			For a standalone JBoss EAP server instance, the server startup processes pass JVM settings to the JBoss EAP server at startup. These can be declared from the command line before launching JBoss EAP, or using the <span class="strong"><strong>System Properties</strong></span> page under <span class="strong"><strong>Configuration</strong></span> in the management console.
		</p><p>
			In a managed domain, JVM settings are declared in the <code class="literal">host.xml</code> and <code class="literal">domain.xml</code> configuration files, and can be configured at host, server group, or server levels.
		</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
				System properties must be configured in <code class="literal">JAVA_OPTS</code> to be used by JBoss EAP modules (such as the logging manager) during startup.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="jvm_settings_standalone_server"/>Configuring JVM Settings for a Standalone Server</h1></div></div></div><p>
				JVM settings for standalone JBoss EAP server instances can be declared at runtime by setting the <code class="literal">JAVA_OPTS</code> environment variable before starting the server.
			</p><p>
				An example of setting the <code class="literal">JAVA_OPTS</code> environment variable on Linux is shown below.
			</p><pre class="screen">$ export JAVA_OPTS="-Xmx1024M"</pre><p>
				The same setting can be used in a Microsoft Windows environment:
			</p><pre class="screen">set JAVA_OPTS="Xmx1024M"</pre><p>
				Alternatively, JVM settings can be added to the <code class="literal">standalone.conf</code> file, or <code class="literal">standalone.conf.bat</code> for Windows Server, in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin</code> folder, which contains examples of options to pass to the JVM.
			</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
					Setting the <code class="literal">JAVA_OPTS</code> environment variable will override the default values from <code class="literal">standalone.conf</code>, which may cause JBoss EAP startup issues.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="jvm_settings_managed_domain"/>Configuring JVM Settings for a Managed Domain</h1></div></div></div><p>
				In a JBoss EAP managed domain, you can define JVM settings at multiple levels. You can define custom JVM settings on a particular host, and then apply those settings to server groups, or to individual server instances.
			</p><p>
				By default, server groups and individual servers will inherit the JVM settings from their parent, but you can choose to override JVM settings at each level.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					The JVM settings in <code class="literal">domain.conf</code>, or <code class="literal">domain.conf.bat</code> for Windows Server, are applied to the Java process of the JBoss EAP host controller, and not the individual JBoss EAP server instances controlled by that host controller.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="jvm_host_controller"/>Defining JVM Settings on a Host Controller</h2></div></div></div><p>
					You can define JVM settings on a host controller, and apply those settings to server groups or individual servers. JBoss EAP comes with a <code class="literal">default</code> JVM setting, but the following management CLI command demonstrates creating a new JVM setting named <code class="literal">production_jvm</code> with some custom JVM settings and options.
				</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>/jvm=production_jvm:add(heap-size=2048m, max-heap-size=2048m, max-permgen-size=512m, stack-size=1024k, jvm-options=["-XX:-UseParallelGC"])</pre><p>
					See <a class="link" href="reference_material.html#jvm_config_attributes" title="Managed Domain JVM Configuration Attributes">Managed Domain JVM Configuration Attributes</a> for descriptions of all available options.
				</p><p>
					You can also create and edit JVM settings in the JBoss EAP management console by navigating to <span class="strong"><strong>Runtime</strong></span> → <span class="strong"><strong>Hosts</strong></span>, choosing a host and clicking <span class="strong"><strong>View</strong></span>, and selecting the <span class="strong"><strong>JVMs</strong></span> tab.
				</p><p>
					These settings are stored in the within the <code class="literal">&lt;jvm&gt;</code> tag in <code class="literal">host.xml</code>.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="jvm_server_group"/>Applying JVM Settings to a Server Group</h2></div></div></div><p>
					When creating a server group, you can specify a JVM configuration that all servers in the group will use. The following management CLI commands demonstrate creating a server group name <code class="literal">groupA</code> that uses the <code class="literal">production_jvm</code> JVM settings that were shown in <a class="link" href="configuring_jvm_settings.html#jvm_host_controller" title="Defining JVM Settings on a Host Controller">the previous example</a>.
				</p><pre class="screen">/server-group=groupA:add(profile=default, socket-binding-group=standard-sockets)
/server-group=groupA/jvm=production_jvm:add</pre><p>
					All servers in the server group will inherit JVM settings from <code class="literal">production_jvm</code>.
				</p><p>
					You can also override specific JVM settings at the server group level. For example, to set a different heap size, you can use the following command:
				</p><pre class="screen">/server-group=groupA/jvm=production_jvm:write-attribute(name=heap-size,value="1024m")</pre><p>
					After applying the above command, the server group <code class="literal">groupA</code> will inherit the JVM settings from <code class="literal">production_jvm</code>, except for the heap size which has an overridden value of <code class="literal">1024m</code>.
				</p><p>
					See <a class="link" href="reference_material.html#jvm_config_attributes" title="Managed Domain JVM Configuration Attributes">Managed Domain JVM Configuration Attributes</a> for descriptions of all available options.
				</p><p>
					You can also edit server group JVM settings in the JBoss EAP management console by navigating to <span class="strong"><strong>Runtime</strong></span> → <span class="strong"><strong>Server Groups</strong></span>, choosing a server group and clicking <span class="strong"><strong>View</strong></span>, and selecting the <span class="strong"><strong>JVMs</strong></span> tab.
				</p><p>
					These settings for a server group are stored in <code class="literal">domain.xml</code>.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="applying_jvm_settings_to_an_individual_server"/>Applying JVM Settings to an Individual Server</h2></div></div></div><p>
					By default, an individual JBoss EAP server instance will inherit the JVM settings of the server group it belongs to. However, you can choose to override the inherited settings with another complete JVM setting definition from the host controller, or choose to override specific JVM settings.
				</p><p>
					For example, the following command overrides the JVM definition of the <a class="link" href="configuring_jvm_settings.html#jvm_server_group" title="Applying JVM Settings to a Server Group">server group in the previous example</a>, and sets the JVM settings for <code class="literal">server-one</code> to the <code class="literal">default</code> JVM definition:
				</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>/server-config=server-one/jvm=default:add</pre><p>
					Also, similar to server groups, you can override specific JVM settings at the server level. For example, to set a different heap size, you can use the following command:
				</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>/server-config=server-one/jvm=default:write-attribute(name=heap-size,value="1024m")</pre><p>
					See <a class="link" href="reference_material.html#jvm_config_attributes" title="Managed Domain JVM Configuration Attributes">Managed Domain JVM Configuration Attributes</a> for descriptions of all available options.
				</p><p>
					You can also edit server JVM settings in the JBoss EAP management console by navigating to <span class="strong"><strong>Runtime</strong></span> → <span class="strong"><strong>Hosts</strong></span>, choosing the host, clicking <span class="strong"><strong>View</strong></span> on the server, and selecting the <span class="strong"><strong>JVMs</strong></span> tab.
				</p><p>
					These settings for an individual server are stored in <code class="literal">host.xml</code>.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="displaying_the_jvm_status"/>Displaying the JVM Status</h1></div></div></div><p>
				You can view the status of JVM resources, such as heap and thread usage, for standalone or managed domain servers from the management console. While statistics are not displayed in real time, you can click <span class="strong"><strong>Refresh</strong></span> to provide an up-to-date overview of JVM resources.
			</p><p>
				To display the JVM status for a standalone JBoss EAP server:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						Navigate to the <span class="strong"><strong>Runtime</strong></span> tab, select the server, and select <span class="strong"><strong>Status</strong></span>.
					</li></ul></div><p>
				To display the JVM status for a JBoss EAP server in a managed domain:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						Navigate to <span class="strong"><strong>Runtime</strong></span> → <span class="strong"><strong>Hosts</strong></span>, select the host and server, and select <span class="strong"><strong>Status</strong></span>.
					</li></ul></div><p>
				This shows the following heap usage information:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Max</span></dt><dd>
							The maximum amount of memory that can be used for memory management.
						</dd><dt><span class="term">Used</span></dt><dd>
							The amount of used memory.
						</dd><dt><span class="term">Committed</span></dt><dd>
							The amount of memory that is committed for the Java Virtual Machine to use.
						</dd></dl></div><p>
				Other information, such as JVM uptime and thread usage, is also available.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="tuning_jvm"/>Tuning the JVM</h1></div></div></div><p>
				For tips on optimizing JVM performance, see the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/performance_tuning_guide/#jvm_tuning">JVM Tuning</a> section of the <span class="emphasis"><em>Performance Tuning Guide</em></span>.
			</p></div></div></body></html>