<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 3. JBoss EAP Management</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="jboss_eap_management"/>Chapter 3. JBoss EAP Management</h1></div></div></div><p>
			JBoss EAP uses a simplified configuration, with one configuration file per standalone server or managed domain. Default configuration for a standalone server is stored in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/configuration/standalone.xml</code> file and default configuration for a managed domain is stored in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/domain/configuration/domain.xml</code> file. Additionally, the default configuration for a host controller is stored in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/domain/configuration/host.xml</code> file.
		</p><p>
			JBoss EAP can be configured using the command-line management CLI, web-based management console, Java API, or HTTP API. Changes made using these management interfaces persist automatically, and the XML configuration files are overwritten by the Management API. The management CLI and management console are the preferred methods, and it is not recommended to edit the XML configuration files manually.
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="about_subsystems"/>About Subsystems, Extensions, and Profiles</h1></div></div></div><p>
				Different aspects of JBoss EAP functionality are configured in different subsystems. For example, application and server logging are configured in the <code class="literal">logging</code> subsystem.
			</p><p>
				An <span class="emphasis"><em>extension</em></span> is a module that extends the core functionality of the server. Extensions are loaded as they are needed by deployments, and are unloaded when they are no longer needed. See the JBoss EAP <span class="emphasis"><em>Management CLI Guide</em></span> for how to <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/management_cli_guide/#how_to_add_extension">add</a> and <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/management_cli_guide/#how_to_remove_extension">remove</a> extensions.
			</p><p>
				A <span class="emphasis"><em>subsystem</em></span> provides configuration options for a particular extension. For more information on the available subsystems, see <a class="link" href="reference_material.html#jboss_eap_subsystems" title="Overview of JBoss EAP Subsystems">Overview of JBoss EAP Subsystems</a>.
			</p><p>
				A collection of subsystem configurations makes up a <span class="emphasis"><em>profile</em></span>, which is configured to satisfy the needs for the server. A standalone server has a single, unnamed profile. A managed domain can define many <a class="link" href="domain_management.html#about_profiles" title="About Profiles">profiles</a> for use by server groups in the domain.
			</p><h2><a id="using_the_management_console_or_the_management_cli"/>Using the Management Console or the Management CLI</h2><p>
				Both the management console and the management CLI are valid, supported ways of updating the configuration of a JBoss EAP instance. Deciding between the two is a matter of preference. Those who prefer to use a graphical, web-based interface should use the management console. Those who prefer a command-line interface should use the management CLI.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="management_users"/>Management Users</h1></div></div></div><p>
				The default JBoss EAP configuration provides local authentication so that a user can access the management CLI on the local host without requiring authentication.
			</p><p>
				However, you must add a management user if you want to access the management CLI remotely or use the management console, which is considered remote access even if the traffic originates on the local host. If you attempt to access the management console before adding a management user, you will receive an error message.
			</p><p>
				If JBoss EAP is installed using the graphical installer, then a management user is created during the installation process.
			</p><p>
				This guide covers simple user management for JBoss EAP using the <code class="literal">add-user</code> script, which is a utility for adding new users to the properties files for out-of-the-box authentication.
			</p><p>
				For more advanced authentication and authorization options, such as LDAP or Role-Based Access Control (RBAC), see the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/security_architecture/#core_management_auth">Core Management Authentication</a> section of the JBoss EAP <span class="emphasis"><em>Security Architecture</em></span>.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="adding_a_management_user"/>Adding a Management User</h2></div></div></div><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
							Run the <code class="literal">add-user</code> utility script and follow the prompts.
						</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/add-user.sh</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
								For Windows Server, use the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>\bin\add-user.bat</code> script.
							</p></div></li><li class="listitem"><p class="simpara">
							Press <code class="literal">ENTER</code> to select the default option <code class="literal">a</code> to add a management user.
						</p><p class="simpara">
							This user will be added to the <span class="emphasis"><em>ManagementRealm</em></span> and will be authorized to perform management operations using the management console or management CLI. The other choice, <code class="literal">b</code>, adds a user to the <span class="emphasis"><em>ApplicationRealm</em></span>, which is used for applications and provides no particular permissions.
						</p></li><li class="listitem"><p class="simpara">
							Enter the desired username and password. You will be prompted to confirm the password.
						</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
								User names can only contain the following characters, in any number and in any order:
							</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
										Alphanumeric characters (a-z, A-Z, 0-9)
									</li><li class="listitem">
										Dashes (-), periods (.), commas (,), at sign (@)
									</li><li class="listitem">
										Backslash (\)
									</li><li class="listitem">
										Equals (=)
									</li></ul></div></div><p class="simpara">
							By default, JBoss EAP allows weak passwords but will issue a warning.
						</p><p class="simpara">
							See <a class="link" href="jboss_eap_management.html#setting_add_user_password_restrictions" title="Setting Add-User Utility Password Restrictions">Setting Add-User Utility Password Restrictions</a> for details on changing this default behavior.
						</p></li><li class="listitem">
							Enter a comma-separated list of groups to which the user belongs. If you do not want the user to belong to any groups, press <code class="literal">ENTER</code> to leave it blank.
						</li><li class="listitem">
							Review the information and enter <code class="literal">yes</code> to confirm.
						</li><li class="listitem"><p class="simpara">
							Determine whether this user represents a remote JBoss EAP server instance. For a basic management user, enter <code class="literal">no</code>.
						</p><p class="simpara">
							One type of user that may need to be added to the <span class="emphasis"><em>ManagementRealm</em></span> is a user representing another instance of JBoss EAP, which must be able to authenticate to join as a member of a cluster. If this is the case, then answer <code class="literal">yes</code> to this prompt and you will be given a hashed secret value representing the user’s password, which will need to be added to a different configuration file.
						</p></li></ol></div><p>
					Users can also be created non-interactively by passing parameters to the <code class="literal">add-user</code> script. This approach is not recommended on shared systems, because the passwords will be visible in log and history files. For more information, see <a class="link" href="jboss_eap_management.html#running_the_add_user_utility_non_interactively" title="Running the Add-User Utility Non-Interactively">Running the Add-User Utility Non-Interactively</a>.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="running_the_add_user_utility_non_interactively"/>Running the Add-User Utility Non-Interactively</h2></div></div></div><p>
					You can run the <code class="literal">add-user</code> script non-interactively by passing in arguments on the command line. At a minimum, the username and password must be provided.
				</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
						This approach is not recommended on shared systems, because the passwords will be visible in log and history files.
					</p></div><h4><a id="create_a_user_belonging_to_multiple_groups"/>Create a User Belonging to Multiple Groups</h4><p>
					The following command adds a management user, <code class="literal">mgmtuser1</code>, with the <code class="literal">guest</code> and <code class="literal">mgmtgroup</code> groups.
				</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/add-user.sh -u 'mgmtuser1' -p 'password1!' -g 'guest,mgmtgroup'</pre><h4><a id="specify_an_alternative_properties_file"/>Specify an Alternative Properties File</h4><p>
					By default, user and group information created using the <code class="literal">add-user</code> script are stored in properties files located in the server configuration directory.
				</p><p>
					User information is stored in the following properties files:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/configuration/mgmt-users.properties</code>
						</li><li class="listitem">
							<code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/domain/configuration/mgmt-users.properties</code>
						</li></ul></div><p>
					Group information is stored in the following properties files:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/configuration/mgmt-groups.properties</code>
						</li><li class="listitem">
							<code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/domain/configuration/mgmt-groups.properties</code>
						</li></ul></div><p>
					These default directories and properties file names can be overridden. The following command adds a new user, specifying a different name and location for the user properties files.
				</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/add-user.sh -u 'mgmtuser2' -p 'password1!' -sc '<span class="emphasis"><em>/path/to</em></span>/standaloneconfig/' -dc '<span class="emphasis"><em>/path/to</em></span>/domainconfig/' -up 'newname.properties'</pre><p>
					The new user was added to the user properties files located at <code class="literal"><span class="emphasis"><em>/path/to</em></span>/standaloneconfig/newname.properties</code> and <code class="literal"><span class="emphasis"><em>/path/to</em></span>/domainconfig/newname.properties</code>. Note that these files must already exist or you will see an error.
				</p><p>
					For a complete listing of all available <code class="literal">add-user</code> arguments and their purposes, use the <code class="literal">--help</code> argument or see the <a class="link" href="reference_material.html#reference_of_add_user_utility_arguments" title="Add-User Utility Arguments">Add-User Utility Arguments</a> section.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="setting_add_user_password_restrictions"/>Setting Add-User Utility Password Restrictions</h2></div></div></div><p>
					The password restrictions for the <code class="literal">add-user</code> utility script can be configured using the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin/add-user.properties</code> file.
				</p><p>
					By default, JBoss EAP allows weak passwords but will issue a warning. To reject passwords that do not meet the minimum requirements specified, set the <code class="literal">password.restriction</code> property to <code class="literal">REJECT</code>.
				</p><p>
					Additional password requirements that can be configured in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin/add-user.properties</code> file:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							Minimum length
						</li><li class="listitem">
							Minimum alphabetic characters
						</li><li class="listitem">
							Minimum digits
						</li><li class="listitem">
							Minimum symbols
						</li><li class="listitem">
							List of forbidden passwords, such as <code class="literal">admin</code>
						</li><li class="listitem">
							Whether to allow a password that matches the username
						</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="updating_mgmt_user"/>Updating a Management User</h2></div></div></div><p>
					You can update the settings for an existing management user using the <code class="literal">add-user</code> utility script by entering the username when prompted.
				</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/add-user.sh

What type of user do you wish to add?
 a) Management User (mgmt-users.properties)
 b) Application User (application-users.properties)
(a): a

Enter the details of the new user to add.
Using realm 'ManagementRealm' as discovered from the existing property files.
Username : test-user
User 'test-user' already exists and is enabled, would you like to...
 a) Update the existing user password and roles
 b) Disable the existing user
 c) Type a new username
(a):</pre><p>
					When you enter a username that already exists, you are presented with several options:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							Type <code class="literal">a</code> to update the password for the existing user.
						</li><li class="listitem">
							Type <code class="literal">b</code> to disable the existing user.
						</li><li class="listitem">
							Type <code class="literal">c</code> to enter a new username.
						</li></ul></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
						When updating a user using the <code class="literal">add-user</code> script non-interactively, the user is updated automatically with no confirmation prompt.
					</p></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="optimizing_the_jboss_eap_server_configuration"/>Optimizing the JBoss EAP Server Configuration</h1></div></div></div><p>
				Once you have <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/installation_guide/#installing_jboss_eap">installed the JBoss EAP server</a>, and you have <a class="link" href="jboss_eap_management.html#adding_a_management_user" title="Adding a Management User">created a management user</a>, Red Hat recommends that you optimize your server configuration.
			</p><p>
				Make sure you review information in the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/performance_tuning_guide/"><span class="emphasis"><em>Performance Tuning Guide</em></span></a> for information about how to optimize the server configuration to avoid common problems when deploying applications in a production environment. Common optimizations include <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/performance_tuning_guide/#setting_ulimits">setting ulimits</a>, <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/performance_tuning_guide/#enabling_garbage_collection">enabling garbage collection</a>, <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/performance_tuning_guide/#heap_dumps">creating Java heap dumps</a>, and <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/performance_tuning_guide/#bean_thread_pools">adjusting the thread pool size</a>.
			</p><p>
				It is also a good idea to apply any existing patches for your release of the product. Each patch for EAP contains numerous bug fixes. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/patching_and_upgrading_guide/#patching-jboss-eap">Patching JBoss EAP</a> in the <span class="emphasis"><em>Patching and Upgrading Guide</em></span> for JBoss EAP.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="management_interfaces"/>Management Interfaces</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="management_cli_overview"/>Management CLI</h2></div></div></div><p>
					The management command-line interface (CLI) is a command-line administration tool for JBoss EAP.
				</p><p>
					Use the management CLI to start and stop servers, deploy and undeploy applications, configure system settings, and perform other administrative tasks. Operations can be performed in batch mode, allowing multiple tasks to be run as a group.
				</p><p>
					Many common terminal commands are available, such as <code class="literal">ls</code>, <code class="literal">cd</code>, and <code class="literal">pwd</code>. The management CLI also supports tab completion.
				</p><p>
					For detailed information on using the management CLI, including commands and operations, syntax, and running in batch mode, see the JBoss EAP <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/management_cli_guide/"><span class="emphasis"><em>Management CLI Guide</em></span></a>.
				</p><h4><a id="launch_the_management_cli"/>Launch the Management CLI</h4><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/jboss-cli.sh</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						For Windows Server, use the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>\bin\jboss-cli.bat</code> script.
					</p></div><h4><a id="connect_to_a_running_server"/>Connect to a Running Server</h4><pre class="screen">connect</pre><p>
					Or you can launch the management CLI and connect in one step by using the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin/jboss-cli.sh --connect</code> command.
				</p><h4><a id="display_help"/>Display Help</h4><p>
					Use the following command for general help.
				</p><pre class="screen">help</pre><p>
					Use the <code class="literal">--help</code> flag on a command to receive instructions on using that specific command. For instance, to receive information on using <code class="literal">deploy</code>, the following command is executed.
				</p><pre class="screen">deploy --help</pre><h4><a id="quit_the_management_cli"/>Quit the Management CLI</h4><pre class="screen">quit</pre><h4><a id="view_system_settings"/>View System Settings</h4><p>
					The following command uses the <code class="literal">read-attribute</code> operation to display whether the example datasource is enabled.
				</p><pre class="screen">/subsystem=datasources/data-source=ExampleDS:read-attribute(name=enabled)
{
    "outcome" =&gt; "success",
    "result" =&gt; true
}</pre><p>
					When running in a managed domain, you must specify which profile to update by preceding the command with <code class="literal">/profile=<span class="emphasis"><em>PROFILE_NAME</em></span></code>.
				</p><pre class="screen">/profile=default/subsystem=datasources/data-source=ExampleDS:read-attribute(name=enabled)</pre><h4><a id="update_system_settings"/>Update System Settings</h4><p>
					The following command uses the <code class="literal">write-attribute</code> operation to disable the example datasource.
				</p><pre class="screen">/subsystem=datasources/data-source=ExampleDS:write-attribute(name=enabled,value=false)</pre><h4><a id="start_servers"/>Start Servers</h4><p>
					The management CLI can also be used to start and stop servers when running in a managed domain.
				</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>/server-config=server-one:start</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="management_console_overview"/>Management Console</h2></div></div></div><p>
					The management console is a web-based administration tool for JBoss EAP.
				</p><p>
					Use the management console to start and stop servers, deploy and undeploy applications, tune system settings, and make persistent modifications to the server configuration. The management console also has the ability to perform administrative tasks, with live notifications when any changes performed by the current user require the server instance to be restarted or reloaded.
				</p><p>
					In a managed domain, server instances and server groups in the same domain can be centrally managed from the management console of the domain controller.
				</p><p>
					For a JBoss EAP instance running on the local host using the default management port, the management console can be accessed through a web browser at <a class="link" href="http://localhost:9990/console/index.html">http://localhost:9990/console/index.html</a>. You will need to authenticate with a user that has permissions to access the management console.
				</p><p>
					The management console provides the following tabs for navigating and managing your JBoss EAP standalone server or managed domain.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Home</span></dt><dd>
								Learn how to accomplish several common configuration and management tasks. Take a tour to become familiar with the JBoss EAP management console.
							</dd><dt><span class="term">Deployments</span></dt><dd>
								Add, remove, and enable deployments. In a managed domain, assign deployments to server groups.
							</dd><dt><span class="term">Configuration</span></dt><dd>
								Configure available subsystems, which provide capabilities such as web services, messaging, or high availability. In a managed domain, manage the profiles that contain different subsystem configurations.
							</dd><dt><span class="term">Runtime</span></dt><dd>
								View runtime information, such as server status, JVM usage, and server logs. In a managed domain, manage your hosts, server groups, and servers.
							</dd><dt><span class="term">Patching</span></dt><dd>
								Apply patches to your JBoss EAP instances.
							</dd><dt><span class="term">Access Control</span></dt><dd>
								Assign roles to users and groups when using Role-Based Access Control.
							</dd></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="updating_attributes_console"/>Updating Attributes in the Management Console</h3></div></div></div><p>
						Once you have navigated to the appropriate section of the management console for the resource that you want to modify, you can edit its attributes as long as you have the proper permissions.
					</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
								Click the <span class="strong"><strong>Edit</strong></span> link.
							</li><li class="listitem"><p class="simpara">
								Make the desired changes.
							</p><p class="simpara">
								Required fields are marked with an asterisk (<span class="strong"><strong><span class="x-">*</span></strong></span>). You can view attribute descriptions by clicking the <span class="strong"><strong>Help</strong></span> link.
							</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
									Depending on the attribute type, the input field can be a text field, ON/OFF field, or drop down. In some text fields, as you type, values from elsewhere in the configuration may appear as suggestions.
								</p></div></li><li class="listitem">
								Click <span class="strong"><strong>Save</strong></span> to save the changes.
							</li><li class="listitem"><p class="simpara">
								If necessary, reload the server for the changes to take effect.
							</p><p class="simpara">
								A popup appears when saving changes that require a reload in order to take effect. To reload a standalone server, click the <span class="strong"><strong>Reload</strong></span> link in the popup. To reload a server in a managed domain, click the <span class="strong"><strong>Topology</strong></span> link, select the appropriate server, and click the <span class="strong"><strong>Reload</strong></span> drop down option.
							</p></li></ol></div><p>
						To view the history of recent configuration actions you have performed, click the notification icon in the top-right of the management console.
					</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="enable_disable_management_console"/>Enable/Disable Management Console</h3></div></div></div><p>
						You can enable or disable the management console by setting the <code class="literal">console-enabled</code> boolean attribute of the <code class="literal">/core-service=management/management-interface=http-interface</code> resource. For the master host in domain mode, use <code class="literal">/host=master/core-service=management/management-interface=http-interface</code>.
					</p><p>
						For example, to enable:
					</p><pre class="screen">/core-service=management/management-interface=http-interface:write-attribute(name=console-enabled,value=true)</pre><p>
						For example, to disable:
					</p><pre class="screen">/core-service=management/management-interface=http-interface:write-attribute(name=console-enabled,value=false)</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="change_language_of_management_console"/>Change the Language of the Management Console</h3></div></div></div><p>
						By default, the language settings of the management console is English. You can choose to use one of the following languages instead:
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								German (de)
							</li><li class="listitem">
								Simplified Chinese (zh-Hans)
							</li><li class="listitem">
								Brazilian Portuguese (pt-BR)
							</li><li class="listitem">
								French (fr)
							</li><li class="listitem">
								Spanish (es)
							</li><li class="listitem">
								Japanese (ja)
							</li></ul></div><h5><a id="to_change_the_language_of_the_management_console"/>To Change the Language of the Management Console</h5><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
								Log in to the management console.
							</li><li class="listitem">
								Click the <span class="strong"><strong>Settings</strong></span> link in the lower-right corner of the management console.
							</li><li class="listitem">
								Select the required language from the <span class="strong"><strong>Locale</strong></span> selection box.
							</li><li class="listitem">
								Select <span class="strong"><strong>Save</strong></span>. A confirmation box informs you that you need to reload the application.
							</li><li class="listitem">
								Click <span class="strong"><strong>Yes</strong></span>. The system refreshes your web browser automatically to use the selected locale.
							</li></ol></div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="management_apis"/>Management APIs</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="http_api"/>HTTP API</h2></div></div></div><p>
					The HTTP API endpoint is the entry point for management clients that rely on the HTTP protocol to integrate with the JBoss EAP management layer.
				</p><p>
					The HTTP API is used by the JBoss EAP management console but offers integration capabilities for other clients as well. By default, the HTTP API is accessible at <code class="literal">http://<span class="emphasis"><em>HOST_NAME</em></span>:9990/management</code>. This URL will display the raw attributes and values exposed to the API.
				</p><h4><a id="read_resources"/>Read Resources</h4><p>
					While you can read, write, or perform other operations using the HTTP <code class="literal">POST</code> method, you can perform some read operations using a <code class="literal">GET</code> request. The HTTP <code class="literal">GET</code> method uses the following URL format.
				</p><pre class="screen">http://<span class="emphasis"><em>HOST_NAME</em></span>:9990/management/<span class="emphasis"><em>PATH_TO_RESOURCE</em></span>?operation=<span class="emphasis"><em>OPERATION</em></span>&amp;<span class="emphasis"><em>PARAMETER</em></span>=<span class="emphasis"><em>VALUE</em></span></pre><p>
					Be sure to replace all of the replaceable values with those that are appropriate for your request. The following values are the available options for the <code class="literal"><span class="emphasis"><em>OPERATION</em></span></code> replaceable value:
				</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Value</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									attribute
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Performs the <code class="literal">read-attribute</code> operation.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									operation-description
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Performs the <code class="literal">read-operation-description</code> operation.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									operation-names
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Performs the <code class="literal">read-operation-names</code> operation.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									resource
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Performs the <code class="literal">read-resource</code> operation.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									resource-description
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Performs the <code class="literal">read-resource-description</code> operation.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									snapshots
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Performs the <code class="literal">list-snapshots</code> operation.
								</p>
								 </td></tr></tbody></table></div><p>
					The following example URLs show how to perform read operations using the HTTP API.
				</p><div class="title"><strong>Example: Read All Attributes and Values for a Resource</strong></div><p>
						
</p><pre class="screen">http://<span class="emphasis"><em>HOST_NAME</em></span>:9990/management/subsystem/undertow/server/default-server/http-listener/default</pre><p>

					</p><p>
					This displays all attributes and their values for the <code class="literal">default</code> HTTP listener.
				</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						The default operation is <code class="literal">read-resource</code>.
					</p></div><div class="title"><strong>Example: Read the Value of an Attribute for a Resource</strong></div><p>
						
</p><pre class="screen">http://<span class="emphasis"><em>HOST_NAME</em></span>:9990/management/subsystem/datasources/data-source/ExampleDS?operation=attribute&amp;name=enabled</pre><p>

					</p><p>
					This reads the value of the <code class="literal">enabled</code> attribute for the <code class="literal">ExampleDS</code> datasource.
				</p><h4><a id="update_resources"/>Update Resources</h4><p>
					You can use the HTTP <code class="literal">POST</code> method to update configuration values or perform other operations using the HTTP API. You must provide authentication for these operations.
				</p><p>
					The following examples show how to update resources using the HTTP API.
				</p><div class="title"><strong>Example: Update the Value of an Attribute for a Resource</strong></div><p>
						
</p><pre class="screen">$ curl --digest http://<span class="emphasis"><em>HOST_NAME</em></span>:9990/management --header "Content-Type: application/json" -u <span class="emphasis"><em>USERNAME</em></span>:<span class="emphasis"><em>PASSWORD</em></span> -d '{"operation":"write-attribute", "address":["subsystem","datasources","data-source","ExampleDS"], "name":"enabled", "value":"false", "json.pretty":"1"}'</pre><p>

					</p><p>
					This updates the value of the <code class="literal">enabled</code> attribute for the <code class="literal">ExampleDS</code> datasource to <code class="literal">false</code>.
				</p><div class="title"><strong>Example: Issue an Operation to the Server</strong></div><p>
						
</p><pre class="screen">$ curl --digest http://localhost:9990/management --header "Content-Type: application/json" -u <span class="emphasis"><em>USERNAME</em></span>:<span class="emphasis"><em>PASSWORD</em></span> -d '{"operation":"reload"}'</pre><p>

					</p><p>
					This reloads the server.
				</p><p>
					See <a class="link" href="deploying_applications.html#deploying_apps_using_http_api" title="Deploying Applications Using the HTTP API">Deploying Applications Using the HTTP API</a> for information on how to deploy applications to JBoss EAP using the HTTP API.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="native_api"/>Native API</h2></div></div></div><p>
					The native API endpoint is the entry point for management clients that rely on the native protocol to integrate with the JBoss EAP management layer. The native API is used by the JBoss EAP management CLI but offers integration capabilities for other clients as well.
				</p><p>
					The following Java code shows an example of how to execute management operations from Java code using the native API.
				</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						You must add the required JBoss EAP libraries, found in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin/client/jboss-cli-client.jar</code> file, to your class path.
					</p></div><div class="title"><strong>Example: Using the Native API to Read Resources</strong></div><p>
						
</p><pre class="programlisting">// Create the management client
ModelControllerClient client = ModelControllerClient.Factory.create("localhost", 9990);

// Create the operation request
ModelNode op = new ModelNode();

// Set the operation
op.get("operation").set("read-resource");

// Set the address
ModelNode address = op.get("address");
address.add("subsystem", "undertow");
address.add("server", "default-server");
address.add("http-listener", "default");

// Execute the operation and manipulate the result
ModelNode returnVal = client.execute(op);
System.out.println("Outcome: " + returnVal.get("outcome").toString());
System.out.println("Result: " + returnVal.get("result").toString());

// Close the client
client.close();</pre><p>

					</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="configuration_data"/>Configuration Data</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="standalone_server_configuration_files"/>Standalone Server Configuration Files</h2></div></div></div><p>
					The standalone configuration files are located in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/configuration/</code> directory. A separate file exists for each of the five predefined profiles (<span class="emphasis"><em>default</em></span>, <span class="emphasis"><em>ha</em></span>, <span class="emphasis"><em>full</em></span>, <span class="emphasis"><em>full-ha</em></span>, <span class="emphasis"><em>load-balancer</em></span>).
				</p><div class="table"><a id="idm140150825180960"/><p class="title"><strong>Table 3.1. Standalone Configuration Files</strong></p><div class="table-contents"><table summary="Standalone Configuration Files" border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Configuration File</th><th style="text-align: left" valign="top">Purpose</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">standalone.xml</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									This standalone configuration file is the default configuration that is used when you start your standalone server. It contains all information about the server, including subsystems, networking, deployments, socket bindings, and other configurable details. It does not provide the subsystems necessary for messaging or high availability.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">standalone-ha.xml</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									This standalone configuration file includes all of the default subsystems and adds the <code class="literal">modcluster</code> and <code class="literal">jgroups</code> subsystems for high availability. It does not provide the subsystems necessary for messaging.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">standalone-full.xml</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									This standalone configuration file includes all of the default subsystems and adds the <code class="literal">messaging-activemq</code> and <code class="literal">iiop-openjdk</code> subsystems. It does not provide the subsystems necessary for high availability.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">standalone-full-ha.xml</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									This standalone configuration file includes support for every possible subsystem, including those for messaging and high availability.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">standalone-load-balancer.xml</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									This standalone configuration file includes the minimum subsystems necessary to use the built-in mod_cluster front-end load balancer to load balance other JBoss EAP instances.
								</p>
								 </td></tr></tbody></table></div></div><p>
					By default, starting JBoss EAP as a standalone server uses the <code class="literal">standalone.xml</code> file. To start JBoss EAP with a different configuration, use the <code class="literal">--server-config</code> argument. For example,
				</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/standalone.sh --server-config=standalone-full.xml</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="managed_domain_configuration_files"/>Managed Domain Configuration Files</h2></div></div></div><p>
					The managed domain configuration files are located in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/domain/configuration/</code> directory.
				</p><div class="table"><a id="idm140150825144032"/><p class="title"><strong>Table 3.2. Managed Domain Configuration Files</strong></p><div class="table-contents"><table summary="Managed Domain Configuration Files" border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Configuration File</th><th style="text-align: left" valign="top">Purpose</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">domain.xml</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									This is the main configuration file for a managed domain. Only the domain master reads this file. This file contains the configurations for all of the profiles (<span class="emphasis"><em>default</em></span>, <span class="emphasis"><em>ha</em></span>, <span class="emphasis"><em>full</em></span>, <span class="emphasis"><em>full-ha</em></span>, <span class="emphasis"><em>load-balancer</em></span>).
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">host.xml</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									This file includes configuration details specific to a physical host in a managed domain, such as network interfaces, socket bindings, the name of the host, and other host-specific details. The <code class="literal">host.xml</code> file includes all of the features of both <code class="literal">host-master.xml</code> and <code class="literal">host-slave.xml</code>, which are described below.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">host-master.xml</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									This file includes only the configuration details necessary to run a server as the master domain controller.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<code class="literal">host-slave.xml</code>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									This file includes only the configuration details necessary to run a server as a managed domain host controller.
								</p>
								 </td></tr></tbody></table></div></div><p>
					By default, starting JBoss EAP in a managed domain uses the <code class="literal">host.xml</code> file. To start JBoss EAP with a different configuration, use the <code class="literal">--host-config</code> argument. For example,
				</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/domain.sh --host-config=host-master.xml</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="backing_up_configuration_data"/>Backing Up Configuration Data</h2></div></div></div><p>
					In order to later restore the JBoss EAP server configuration, items in the following locations should be backed up:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
							<code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/configuration/</code>
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									Back up the entire directory to save user data, server configuration, and logging settings for standalone servers.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							<code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/domain/configuration/</code>
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									Back up the entire directory to save user and profile data, domain and host configuration, and logging settings for managed domains.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							<code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/modules/</code>
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									Back up any custom modules.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							<code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/welcome-content/</code>
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									Back up any custom welcome content.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							<code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin/</code>
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									Back up any custom scripts or startup configuration files.
								</li></ul></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="configuration_file_snapshots"/>Configuration File Snapshots</h2></div></div></div><p>
					To assist in the maintenance and management of the server, JBoss EAP creates a timestamped version of the original configuration file at the time of startup. Any additional configuration changes made by management operations will result in the original file being automatically backed up, and a working copy of the instance being preserved for reference and rollback. Additionally, configuration snapshots can be taken, which are point-in-time copies of the current server configuration. These snapshots can be saved and loaded by an administrator.
				</p><p>
					The following examples use the <code class="literal">standalone.xml</code> file, but the same process applies to the <code class="literal">domain.xml</code> and <code class="literal">host.xml</code> files.
				</p><h4><a id="take_a_snapshot"/>Take a Snapshot</h4><p>
					Use the management CLI to take a snapshot of the current configurations.
				</p><pre class="screen">:take-snapshot
{
    "outcome" =&gt; "success",
    "result" =&gt; "<span class="emphasis"><em>EAP_HOME</em></span>/standalone/configuration/standalone_xml_history/snapshot/20151022-133109702standalone.xml"
}</pre><h4><a id="list_snapshots"/>List Snapshots</h4><p>
					Use the management CLI to list all snapshots that have been taken.
				</p><pre class="screen">:list-snapshots
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "directory" =&gt; "<span class="emphasis"><em>EAP_HOME</em></span>/standalone/configuration/standalone_xml_history/snapshot",
        "names" =&gt; [
            "20151022-133109702standalone.xml",
            "20151022-132715958standalone.xml"
        ]
    }
}</pre><h4><a id="delete_a_snapshot"/>Delete a Snapshot</h4><p>
					Use the management CLI to delete a snapshot.
				</p><pre class="screen">:delete-snapshot(name=20151022-133109702standalone.xml)</pre><h4><a id="start_the_server_with_a_snapshot"/>Start the Server with a Snapshot</h4><p>
					The server can be started using a snapshot or an automatically-saved version of the configuration.
				</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
							Navigate to the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/configuration/standalone_xml_history</code> directory and identify the snapshot or saved configuration file to be loaded.
						</li><li class="listitem"><p class="simpara">
							Start the server and point to the selected configuration file. Pass in the file path relative to the configuration directory, <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/configuration/</code>.
						</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/standalone.sh --server-config=standalone_xml_history/snapshot/20151022-133109702standalone.xml</pre></li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						When running in a managed domain, use the <code class="literal">--host-config</code> argument instead to specify the configuration file.
					</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="view_config_changes"/>View Configuration Changes</h2></div></div></div><p>
					JBoss EAP 7 provides the ability to track configuration changes made to the running system. This allows administrators to view a history of configuration changes made by other authorized users.
				</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
						Changes are stored in memory and are not persisted between server restarts. This feature is not a replacement for <a class="link" href="jboss_eap_management.html#management_audit_logging" title="Management Audit Logging">management audit logging</a>.
					</p></div><p>
					You can enable tracking and view configuration changes from either the <a class="link" href="jboss_eap_management.html#config_changes_cli" title="Track and View Configuration Changes from the Management CLI">management CLI</a> or the <a class="link" href="jboss_eap_management.html#config_changes_console" title="Track and View Configuration Changes from the Management Console">management console</a>.
				</p><h4><a id="config_changes_cli"/>Track and View Configuration Changes from the Management CLI</h4><p>
					To enable tracking of configuration changes, use the following management CLI command. You can specify how many entries to store using the <code class="literal">max-history</code> attribute.
				</p><pre class="screen">/subsystem=core-management/service=configuration-changes:add(max-history=20)</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						In a managed domain, configuration changes are tracked at the host level for host and server-related modifications. Enabling configuration changes for a host controller enables it for all of its managed servers. You can track configuration changes per host using the following command.
					</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>/subsystem=core-management/service=configuration-changes:add(max-history=20)</pre></div><p>
					To view the list of most recent configuration changes, use the following management CLI command.
				</p><pre class="screen">/subsystem=core-management/service=configuration-changes:list-changes</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						In a managed domain, you can list the configuration changes for a host using the following command.
					</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>/subsystem=core-management/service=configuration-changes:list-changes</pre><p>
						You can list the configuration changes that affect a particular server using the following command.
					</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>/server=<span class="emphasis"><em>SERVER_NAME</em></span>/subsystem=core-management/service=configuration-changes:list-changes</pre></div><p>
					This lists each configuration change made, with the date, origin, outcome, and operation details. For example, the below output from the <code class="literal">list-changes</code> command shows configuration changes, with the most recent displayed first.
				</p><pre class="screen">{
    "outcome" =&gt; "success",
    "result" =&gt; [
        {
            "operation-date" =&gt; "2016-02-12T18:37:00.354Z",
            "access-mechanism" =&gt; "NATIVE",
            "remote-address" =&gt; "127.0.0.1/127.0.0.1",
            "outcome" =&gt; "success",
            "operations" =&gt; [{
                "address" =&gt; [],
                "operation" =&gt; "reload",
                "operation-headers" =&gt; {
                    "caller-type" =&gt; "user",
                    "access-mechanism" =&gt; "NATIVE"
                }
            }]
        },
        {
            "operation-date" =&gt; "2016-02-12T18:34:16.859Z",
            "access-mechanism" =&gt; "NATIVE",
            "remote-address" =&gt; "127.0.0.1/127.0.0.1",
            "outcome" =&gt; "success",
            "operations" =&gt; [{
                "address" =&gt; [
                    ("subsystem" =&gt; "datasources"),
                    ("data-source" =&gt; "ExampleDS")
                ],
                "operation" =&gt; "write-attribute",
                "name" =&gt; "enabled",
                "value" =&gt; false,
                "operation-headers" =&gt; {
                    "caller-type" =&gt; "user",
                    "access-mechanism" =&gt; "NATIVE"
                }
            }]
        },
        {
            "operation-date" =&gt; "2016-02-12T18:24:11.670Z",
            "access-mechanism" =&gt; "HTTP",
            "remote-address" =&gt; "127.0.0.1/127.0.0.1",
            "outcome" =&gt; "success",
            "operations" =&gt; [{
                "operation" =&gt; "remove",
                "address" =&gt; [
                    ("subsystem" =&gt; "messaging-activemq"),
                    ("server" =&gt; "default"),
                    ("jms-queue" =&gt; "ExpiryQueue")
                ],
                "operation-headers" =&gt; {"access-mechanism" =&gt; "HTTP"}
            }]
        }
    ]
}</pre><p>
					This example lists the details of three operations performed that impacted the configuration:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							Reloading the server from the management CLI.
						</li><li class="listitem">
							Disabling the <code class="literal">ExampleDS</code> datasource from the management CLI.
						</li><li class="listitem">
							Removing the <code class="literal">ExpiryQueue</code> queue from the management console.
						</li></ul></div><h4><a id="config_changes_console"/>Track and View Configuration Changes from the Management Console</h4><p>
					To enable tracking of configuration changes from the management console, select to the <span class="strong"><strong>Runtime</strong></span> tab, navigate to the server or host to track changes for and select <span class="strong"><strong>Configuration Changes</strong></span> from the drop down. Click <span class="strong"><strong>Enable Configuration Changes</strong></span> and provide a maximum history value.
				</p><p>
					The table on this page then lists each configuration change made, with the date, origin, outcome, and operation details.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="property_replacement"/>Property Replacement</h2></div></div></div><p>
					JBoss EAP allows you to use expressions to define replaceable properties in place of literal values in the configuration. Expressions use the format <code class="literal">${<span class="emphasis"><em>PARAMETER</em></span>:<span class="emphasis"><em>DEFAULT_VALUE</em></span>}</code>. If the specified parameter is set, then the parameter’s value will be used. Otherwise, the default value provided will be used.
				</p><p>
					The supported sources for resolving expressions are system properties, environment variables, and the vault. For deployments only, the source can be properties listed in a <code class="literal">META-INF/jboss.properties</code> file in the deployment archive. For deployment types that support subdeployments, the resolution is scoped to all subdeployments if the properties file is in the outer deployment, for example the EAR. If the properties file is in the subdeployment, then the resolution is scoped just to that subdeployment.
				</p><p>
					The example below from the <code class="literal">standalone.xml</code> configuration file sets the <code class="literal">inet-address</code> for the <code class="literal">public</code> interface to <code class="literal">127.0.0.1</code> unless the <code class="literal">jboss.bind.address</code> parameter is set.
				</p><pre class="programlisting">&lt;interface name="public"&gt;
    &lt;inet-address value="${jboss.bind.address:127.0.0.1}"/&gt;
&lt;/interface&gt;</pre><p>
					The <code class="literal">jboss.bind.address</code> parameter can be set when starting EAP as a standalone server with the following command:
				</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/standalone.sh -Djboss.bind.address=<span class="emphasis"><em>IP_ADDRESS</em></span></pre><h4><a id="nested_expressions"/>Nested Expressions</h4><p>
					Expressions can be nested, which allows for more advanced use of expressions in place of fixed values. The format of a nested expression is like that of a normal expression, but one expression is embedded in the other, for example:
				</p><pre class="screen">${<span class="emphasis"><em>SYSTEM_VALUE_1</em></span>${<span class="emphasis"><em>SYSTEM_VALUE_2</em></span>}}</pre><p>
					Nested expressions are evaluated recursively, so the <span class="emphasis"><em>inner</em></span> expression is first evaluated, then the <span class="emphasis"><em>outer</em></span> expression is evaluated. Expressions may also be recursive, where an expression resolves to another expression, which is then resolved. Nested expressions are permitted anywhere that expressions are permitted, with the exception of management CLI commands.
				</p><p>
					An example of where a nested expression might be used is if the password used in a datasource definition is masked. The configuration for the datasource might have the following line:
				</p><pre class="programlisting">&lt;password&gt;${VAULT::ds_ExampleDS::password::1}&lt;/password&gt;</pre><p>
					The value of <code class="literal">ds_ExampleDS</code> could be replaced with a system property (<code class="literal">datasource_name</code>) using a nested expression. The configuration for the datasource could instead have the following line:
				</p><pre class="programlisting">&lt;password&gt;${VAULT::${datasource_name}::password::1}&lt;/password&gt;</pre><p>
					JBoss EAP would first evaluate the expression <code class="literal">${datasource_name}</code>, then input this to the larger expression and evaluate the resulting expression. The advantage of this configuration is that the name of the datasource is abstracted from the fixed configuration.
				</p><h4><a id="descriptor_property_replacement"/>Descriptor-Based Property Replacement</h4><p>
					Application configuration, such as datasource connection parameters, typically varies between development, testing, and production environments. This variance is sometimes accommodated by build system scripts, as the Java EE specification does not contain a method to externalize these configurations. With JBoss EAP, you can use descriptor-based property replacement to manage configuration externally.
				</p><p>
					Descriptor-based property replacement substitutes properties based on descriptors, allowing you to remove assumptions about the environment from the application and the build chain. Environment-specific configurations can be specified in deployment descriptors rather than annotations or build system scripts. You can provide configuration in files or as parameters at the command line.
				</p><p>
					There are several flags in the <code class="literal">ee</code> subsystem that control whether property replacement is applied.
				</p><p>
					JBoss-specific descriptor replacement is controlled by the <code class="literal">jboss-descriptor-property-replacement</code> flag and is <span class="emphasis"><em>enabled</em></span> by default. When enabled, properties can be replaced in the following deployment descriptors:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<code class="literal">jboss-ejb3.xml</code>
						</li><li class="listitem">
							<code class="literal">jboss-app.xml</code>
						</li><li class="listitem">
							<code class="literal">jboss-web.xml</code>
						</li><li class="listitem">
							<code class="literal">*-jms.xml</code>
						</li><li class="listitem">
							<code class="literal">*-ds.xml</code>
						</li></ul></div><p>
					The following management CLI command can be used to enable or disable property replacement in JBoss-specific descriptors:
				</p><pre class="screen">/subsystem=ee:write-attribute(name="jboss-descriptor-property-replacement",value=<span class="emphasis"><em>VALUE</em></span>)</pre><p>
					Java EE descriptor replacement controlled by the <code class="literal">spec-descriptor-property-replacement</code> flag and is <span class="emphasis"><em>disabled</em></span> by default. When enabled, properties can be replaced in the following deployment descriptors:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<code class="literal">ejb-jar.xml</code>
						</li><li class="listitem">
							<code class="literal">persistence.xml</code>
						</li><li class="listitem">
							<code class="literal">application.xml</code>
						</li><li class="listitem">
							<code class="literal">web.xml</code>
						</li></ul></div><p>
					The following management CLI command can be used to enable or disable property replacement in Java EE descriptors:
				</p><pre class="screen">/subsystem=ee:write-attribute(name="spec-descriptor-property-replacement",value=<span class="emphasis"><em>VALUE</em></span>)</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="using_git_to_manage_configuration_data"/>Using Git to Manage Configuration Data</h2></div></div></div><p>
					As of JBoss EAP 7.2, you can use Git to manage and persist your server configuration data, properties files, and deployments. This not only allows you to manage the version history for these files, but it also allows you to share server and application configurations across multiple servers and nodes using one or more Git repositories. This feature only works for standalone servers that use the default configuration directory layout.
				</p><p>
					You can choose to use configuration data in a <a class="link" href="jboss_eap_management.html#using_a_local_git_repository" title="Using a Local Git Repository">local Git repository</a> or you can pull the data from a <a class="link" href="jboss_eap_management.html#using_a_remote_git_repository" title="Using a Remote Git Repository">remote Git repository</a>. The Git repository is configured in the <code class="literal">jboss.server.base.dir</code> directory, which is the base directory for standalone server content. Once the <code class="literal">jboss.server.base.dir</code> directory is configured to use Git, JBoss EAP automatically commits every update you make to the configuration using the management CLI or management console. Any changes made outside of the server by manually editing the configuration files are not committed or persisted; however, you can use the Git CLI to add and commit manual changes. You can also use the Git CLI to view the commit history, manage branching, and manage the content.
				</p><p>
					To use this feature, pass one or more of the following arguments on the command line when you start the server.
				</p><div class="table"><a id="idm140150869891536"/><p class="title"><strong>Table 3.3. Server Startup Arguments for Git Configuration Management</strong></p><div class="table-contents"><table summary="Server Startup Arguments for Git Configuration Management" border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Argument</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									--git-repo
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									The location of the Git repository that is used to manage and persist server configuration data. This can be <code class="literal">local</code> if you want to store it locally, or the URL to a remote repository.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									--git-branch
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									The branch or tag name in the Git repository to use. This argument should name an existing branch or tag name as it will <span class="emphasis"><em>not</em></span> be created if it does not exist. If you use a tag name, you put the repository in a detached HEAD state, meaning future commits are not attached to any branches. Tag names are read-only and are normally used when you need to replicate a configuration across several nodes.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									--git-auth
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									The URL to an Elytron configuration file that contains the credentials to be used when connecting to a remote Git repository. This argument is required if your remote Git repository requires authentication. Although Git supports SSH authentication, Elytron does not; therefore, only default SSH authentication is supported using private keys without a password. This argument is not used with a <code class="literal">local</code> repository.
								</p>
								 </td></tr></tbody></table></div></div><h4><a id="using_a_local_git_repository"/>Using a Local Git Repository</h4><p>
					To use a local Git repository, start the server with the <code class="literal">--git-repo=local</code> argument. You can also specify an optional branch or tag name in the remote repository by adding the <code class="literal">--git-branch=<span class="emphasis"><em>GIT_BRANCH_NAME</em></span></code> argument when you start the server. This argument should name an existing branch or tag name as it will <span class="emphasis"><em>not</em></span> be created if it does not exist. If you use a tag name, you put the repository in a detached HEAD state, meaning future commits are not attached to any branches.
				</p><p>
					The following is an example of a command to start the server using the <code class="literal">1.0.x</code> branch of the <code class="literal">local</code> repository.
				</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/standalone.sh --git-repo=local --git-branch=1.0.x</pre><p>
					If you start the server with the argument to use a <code class="literal">local</code> Git repository, JBoss EAP checks whether the <code class="literal">jboss.server.base.dir</code> directory is already configured for Git. If not, JBoss EAP creates and initializes the Git repository in the <code class="literal">jboss.server.base.dir</code> directory using the existing configuration content. JBoss EAP checks out a branch name passed by the <code class="literal">--git-branch</code> argument. If that argument is not passed, it checks out the <code class="literal">master</code> branch. After initialization, you should see a <code class="literal">.git/</code> directory and a <code class="literal">.gitignore</code> file in the base directory for standalone server content.
				</p><h4><a id="using_a_remote_git_repository"/>Using a Remote Git Repository</h4><p>
					To use a remote Git repository, start the server with the <code class="literal">--git-repo=<span class="emphasis"><em>REMOTE_REPO</em></span></code> argument. The value of the argument can be a URL or a remote alias that you have manually added to the local Git configuration.
				</p><p>
					You can also specify an optional branch or tag name in the remote repository by adding the <code class="literal">--git-branch=<span class="emphasis"><em>GIT_BRANCH_NAME</em></span></code> argument when you start the server. This argument should name an existing branch or tag name as it will <span class="emphasis"><em>not</em></span> be created if it does not exist. If you use a tag name, you put the repository in a detached HEAD state, meaning future commits are not attached to any branches.
				</p><p>
					If your Git repository requires authentication, you must also add the <code class="literal">--git-auth=<span class="emphasis"><em>AUTH_FILE_URL</em></span></code> argument when you start the server. This argument should be the URL to an Elytron configuration file containing the credentials required to connect to the Git repository. The following is an example of an Elytron configuration file that can be used for authentication.
				</p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
  &lt;authentication-client xmlns="urn:elytron:client:1.2"&gt;
    &lt;authentication-rules&gt;
      &lt;rule use-configuration="test-login"&gt;
      &lt;/rule&gt;
    &lt;/authentication-rules&gt;
    &lt;authentication-configurations&gt;
      &lt;configuration name="test-login"&gt;
        &lt;sasl-mechanism-selector selector="BASIC" /&gt;
        &lt;set-user-name name="eap-user" /&gt;
        &lt;credentials&gt;
          &lt;clear-password password="my_api_key" /&gt;
        &lt;/credentials&gt;
        &lt;set-mechanism-realm name="testRealm" /&gt;
      &lt;/configuration&gt;
    &lt;/authentication-configurations&gt;
  &lt;/authentication-client&gt;
&lt;/configuration&gt;</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						Although Git supports SSH authentication, Elytron does not; therefore, only default SSH authentication is supported using private keys without a password.
					</p></div><p>
					The following is an example of a command to start the server with the full profile, using the <code class="literal">1.0.x</code> branch of the remote <code class="literal">eap-configuration</code> repository, and passing the URL to an Elytron configuration file containing authentication credentials.
				</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/standalone.sh --git-repo=https://github.com/<span class="emphasis"><em>MY_GIT_ID</em></span>/eap-configuration.git --git-branch=1.0.x --git-auth=file:///home/<span class="emphasis"><em>USER_NAME</em></span>/github-wildfly-config.xml --server-config=standalone-full.xml</pre><p>
					If you start the server with the argument to use a remote Git repository, JBoss EAP checks whether the <code class="literal">jboss.server.base.dir</code> directory is already configured for Git. If not, JBoss EAP deletes the existing configuration files in the <code class="literal">jboss.server.base.dir</code> directory and replaces them with the remote Git configuration data. JBoss EAP checks out a branch name passed by the <code class="literal">--git-branch</code> argument. If that argument is not passed, it checks out the <code class="literal">master</code> branch. Once this process is complete, you should see a <code class="literal">.git/</code> directory and a <code class="literal">.gitignore</code> file in the base directory for standalone server content.
				</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
						If you later start the server passing a different <code class="literal">--git-repo</code> URL or <code class="literal">--git-branch</code> name than was originally used, you will see the error message <code class="literal">java.lang.RuntimeException: WFLYSRV0268: Failed to pull the repository <span class="emphasis"><em>GIT_REPO_NAME</em></span></code> when you attempt to start the server. This is because JBoss EAP attempts to pull configuration data from a different repository and branch than the one that is currently configured in the <code class="literal">jboss.server.base.dir</code> directory and the Git pull results in conflicts.
					</p></div><h5><a id="publishing_configuration_data_with_git"/>Publishing Remote Configuration Data When Using Git</h5><p>
					You can push your Git repository changes to the remote repository using the management CLI <code class="literal">publish-configuration</code> operation. Because JBoss EAP pulls the configuration from the remote Git repository during the boot process when you start the server, this allows you to share the configuration data across multiple servers. You can only use this operation with a remote repository. It does not work for a local repository.
				</p><p>
					The following management CLI operation publishes the configuration data to the remote <code class="literal">eap-configuration</code> repository.
				</p><pre class="screen">:publish-configuration(location="=https://github.com/<span class="emphasis"><em>MY_GIT_ID</em></span>/eap-configuration.git")
{"outcome" =&gt; "success"}</pre><h4><a id="using_snapshots_with_git"/>Using Snapshots with Git</h4><p>
					In addition to using the Git commit history to track configuration changes, you can also take snapshots to preserve a configuration at a specific point in time. You can list the snapshots and delete them.
				</p><h5><a id="taking_snapshots_with_git"/>Taking Snapshots When Using Git</h5><p>
					Snapshots are stored as tags in Git. You specify the snapshot tag name and commit message as arguments on the <code class="literal">take-snapshot</code> operation.
				</p><p>
					The following management CLI operation takes a snapshot and names the tag "snapshot-01".
				</p><pre class="screen">:take-snapshot(name="snapshot-01", comment="1st snapshot")
{
    "outcome" =&gt; "success",
    "result" =&gt; "1st snapshot"
}</pre><h5><a id="listing_snapshots_with_git"/>Listing Snapshots When Using Git</h5><p>
					You can list all of the snapshot tags using the <code class="literal">list-snapshots</code> operation.
				</p><p>
					The following management CLI operation lists the snapshot tags.
				</p><pre class="screen">:list-snapshots
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "directory" =&gt; "",
        "names" =&gt; [
            "snapshot : 1st snapshot",
            "refs/tags/snapshot-01",
            "snapshot2 : 2nd snapshot",
            "refs/tags/snapshot-02"
        ]
    }
}</pre><h5><a id="deleting_snapshots_with_git"/>Deleting Snapshots When Using Git</h5><p>
					You can delete a specific snapshot by passing the tag name on the <code class="literal">delete-snapshot</code> operation.
				</p><p>
					The following management CLI operation deletes the snapshot with the tag name "snapshot-01".
				</p><pre class="screen">:delete-snapshot(name="snapshot-01")
{"outcome" =&gt; "success"}</pre></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="file_system_paths"/>File System Paths</h1></div></div></div><p>
				JBoss EAP uses logical names for file system paths. Other areas of the configuration can then reference the paths using their logical name, avoiding the need to use absolute paths for each instance and allowing specific host configurations to resolve to universal logical names.
			</p><p>
				For example, the default <code class="literal">logging</code> subsystem configuration declares <code class="literal">jboss.server.log.dir</code> as the logical name for the server log directory.
			</p><div class="title"><strong>Example: Relative Path Example for the Server Log Directory</strong></div><p>
					
</p><pre class="programlisting">&lt;file relative-to="jboss.server.log.dir" path="server.log"/&gt;</pre><p>

				</p><p>
				JBoss EAP automatically provides a number of standard paths without any need for the user to configure them in a configuration file.
			</p><div class="table"><a id="idm140150824898592"/><p class="title"><strong>Table 3.4. Standard Paths</strong></p><div class="table-contents"><table summary="Standard Paths" border="1" width="100%"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Property</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								java.home
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The Java installation directory
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.controller.temp.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A common alias for standalone servers and managed domains. The directory to be used for temporary file storage. Equivalent to <code class="literal">jboss.domain.temp.dir</code> in a managed domain, and <code class="literal">jboss.server.temp.dir</code> on a standalone server.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.domain.base.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The base directory for domain content.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.domain.config.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The directory that contains the domain configuration.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.domain.data.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The directory that the domain will use for persistent data file storage.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.domain.log.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The directory that the domain will use for persistent log file storage.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.domain.temp.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The directory that the domain will use for temporary file storage.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.domain.deployment.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The directory that the domain will use for storing deployed content.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.domain.servers.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The directory that the domain will use for storing outputs of the managed domain instances.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.home.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The root directory of the JBoss EAP distribution.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.server.base.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The base directory for standalone server content.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.server.config.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The directory that contains the standalone server configuration.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.server.data.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The directory the standalone server will use for persistent data file storage.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.server.log.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The directory the standalone server will use for log file storage.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.server.temp.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The directory the standalone server will use for temporary file storage.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jboss.server.deploy.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The directory that the standalone server will use for storing deployed content.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								user.dir
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The user’s current working directory.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								user.home
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The user home directory.
							</p>
							 </td></tr></tbody></table></div></div><p>
				You can <a class="link" href="jboss_eap_management.html#override_standard_path" title="Override a Standard Path">override a standard path</a> or <a class="link" href="jboss_eap_management.html#add_custom_path" title="Add a Custom Path">add a custom path</a>.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="view_file_system_paths"/>View File System Paths</h2></div></div></div><p>
					Use the following management CLI command to list the file system paths:
				</p><pre class="screen">ls /path</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						In a managed domain, you can list the file system paths for a specific server using the following management CLI command:
					</p><pre class="screen">ls /host=<span class="emphasis"><em>HOST_NAME</em></span>/server=<span class="emphasis"><em>SERVER_NAME</em></span>/path</pre></div><p>
					Use the following management CLI command to read the value of a file system path:
				</p><pre class="screen">/path=<span class="emphasis"><em>PATH_NAME</em></span>:read-resource</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						In a managed domain, you can read the value of a file system path for a specific server using the following management CLI command:
					</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>/server=<span class="emphasis"><em>SERVER_NAME</em></span>/path=<span class="emphasis"><em>PATH_NAME</em></span>:read-resource</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="override_standard_path"/>Override a Standard Path</h2></div></div></div><p>
					You can override the default locations of the standard paths that begin with <code class="literal">jboss.server.*</code> or <code class="literal">jboss.domain.*</code>. This can be done in one of two ways:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
							Pass in the command-line argument when you start the server. For example:
						</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/standalone.sh -Djboss.server.log.dir=/var/log</pre></li><li class="listitem"><p class="simpara">
							Modify the <code class="literal">JAVA_OPTS</code> variable in the server configuration file, either <code class="literal">standalone.conf</code> or <code class="literal">domain.conf</code>, to contain the new location. For example:
						</p><pre class="screen">JAVA_OPTS="$JAVA_OPTS -Djboss.server.log.dir=/var/log"</pre></li></ul></div><h4><a id="overriding_a_managed_domain_s_standard_paths"/>Overriding a Managed Domain’s Standard Paths</h4><p>
					In this example, the objective is to store domain files in the <code class="literal">/opt/jboss_eap/domain_data</code> directory, and give each top-level directory a custom name. The default directory grouping, <code class="literal">by-server</code>, is used.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							Log files are to be stored in the <code class="literal">all_logs</code> subdirectory
						</li><li class="listitem">
							Data files are to be stored in the <code class="literal">all_data</code> subdirectory
						</li><li class="listitem">
							Temporary files are to be stored in the <code class="literal">all_temp</code> subdirectory
						</li><li class="listitem">
							Servers' files are to be stored in the <code class="literal">all_servers</code> subdirectory
						</li></ul></div><p>
					To achieve this configuration, you would override several system properties when starting JBoss EAP.
				</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/domain.sh -Djboss.domain.temp.dir=/opt/jboss_eap/domain_data/all_temp -Djboss.domain.log.dir=/opt/jboss_eap/domain_data/all_logs -Djboss.domain.data.dir=/opt/jboss_eap/domain_data/all_data -Djboss.domain.servers.dir=/opt/jboss_eap/domain_data/all_servers</pre><p>
					The resulting path structure will be as follows:
				</p><pre class="screen">/opt/jboss_eap/domain_data/
               ├── all_data
               ├── all_logs
               ├── all_servers
               │   ├── server-one
               │   │   ├── data
               │   │   ├── log
               │   │   └── tmp
               │   └── server-two
               │       ├── data
               │       ├── log
               │       └── tmp
               └── all_temp</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="add_custom_path"/>Add a Custom Path</h2></div></div></div><p>
					You can add a custom file system path using the management CLI or the management console.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
							From the management CLI, you can add a new path using the following management CLI command.
						</p><pre class="screen">/path=my.custom.path:add(path=/my/custom/path)</pre></li><li class="listitem">
							From the management console, you can configure file system paths by navigating to the <span class="strong"><strong>Configuration</strong></span> tab, selecting <span class="strong"><strong>Paths</strong></span>, and clicking <span class="strong"><strong>View</strong></span>. From there, you can add, modify, and remove paths.
						</li></ul></div><p>
					You can then use this custom path in your configuration. For example, the below log handler uses a custom path for its relative path.
				</p><pre class="programlisting">&lt;subsystem xmlns="urn:jboss:domain:logging:6.0"&gt;
  ...
  &lt;periodic-rotating-file-handler name="FILE" autoflush="true"&gt;
    &lt;formatter&gt;
      &lt;named-formatter name="PATTERN"/&gt;
    &lt;/formatter&gt;
    &lt;file relative-to="my.custom.path" path="server.log"/&gt;
    &lt;suffix value=".yyyy-MM-dd"/&gt;
    &lt;append value="true"/&gt;
  &lt;/periodic-rotating-file-handler&gt;
  ...
&lt;/subsystem&gt;</pre></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="directory_grouping"/>Directory Grouping</h1></div></div></div><p>
				In a managed domain, each server’s files are stored in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/domain</code> directory. You can specify how to organize the subdirectories for servers using the host controller’s <code class="literal">directory-grouping</code> attribute. Directories can be grouped either by <span class="emphasis"><em>server</em></span> or by <span class="emphasis"><em>type</em></span>. By default, directories are grouped by <span class="emphasis"><em>server</em></span>.
			</p><h3><a id="directory_grouping_by_server"/>Directory Grouping by Server</h3><p>
				By default, directories are grouped by server. If your administration is <span class="emphasis"><em>server-centric</em></span>, this configuration is recommended. For example, it allows backups and log file handling to be configured per server instance.
			</p><p>
				If JBoss EAP is installed using the ZIP installation method, the default directory structure (grouped by server) will be as follows.
			</p><pre class="screen"><span class="emphasis"><em>EAP_HOME</em></span>/domain
         └─ servers
            ├── server-one
            │   ├── data
            │   ├── tmp
            │   └── log
            └── server-two
                ├── data
                ├── tmp
                └── log</pre><p>
				To group domain directories by server, enter the following management CLI command:
			</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>:write-attribute(name=directory-grouping,value=by-server)</pre><p>
				This will update the host controller’s <code class="literal">host.xml</code> configuration file:
			</p><pre class="programlisting">&lt;servers directory-grouping="by-server"&gt;
  &lt;server name="server-one" group="main-server-group"/&gt;
  &lt;server name="server-two" group="main-server-group" auto-start="true"&gt;
    &lt;socket-bindings port-offset="150"/&gt;
  &lt;/server&gt;
&lt;/servers&gt;</pre><h3><a id="directory_grouping_by_type"/>Directory Grouping by Type</h3><p>
				Instead of grouping directories by server, you can instead group by file type. If your administration is <span class="emphasis"><em>file type-centric</em></span>, this configuration is recommended. For example, this would allow you to easily back up only <code class="literal">data</code> files.
			</p><p>
				If JBoss EAP is installed using the ZIP installation method and the domain’s files are grouped by type, the directory structure will be as follows.
			</p><pre class="screen"><span class="emphasis"><em>EAP_HOME</em></span>/domain
         ├── data
         │   └── servers
         │       ├── server-one
         │       └── server-two
         ├── log
         │   └── servers
         │       ├── server-one
         │       └── server-two
         └── tmp
             └── servers
                 ├── server-one
                 └── server-two</pre><p>
				To group domain directories by type, enter the following management CLI command:
			</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>:write-attribute(name=directory-grouping,value=by-type)</pre><p>
				This will update the host controller’s <code class="literal">host.xml</code> configuration file:
			</p><pre class="programlisting">&lt;servers directory-grouping="by-type"&gt;
  &lt;server name="server-one" group="main-server-group"/&gt;
  &lt;server name="server-two" group="main-server-group" auto-start="true"&gt;
    &lt;socket-bindings port-offset="150"/&gt;
  &lt;/server&gt;
&lt;/servers&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="system_properties"/>System Properties</h1></div></div></div><p>
				You can use Java system properties to configure many JBoss EAP options, as well as set any name-value pair for use within the application server.
			</p><p>
				System properties can be used to override default values in the JBoss EAP configuration. For example, the following XML configuration for the public interface bind address shows that it can be set by the <code class="literal">jboss.bind.address</code> system property, but if the system property is not provided, it will default to <code class="literal">127.0.0.1</code>.
			</p><pre class="programlisting">&lt;inet-address value="${jboss.bind.address:127.0.0.1}"/&gt;</pre><p>
				There are a few ways you can set system properties in JBoss EAP, including:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<a class="link" href="jboss_eap_management.html#sys_prop_startup_script" title="Passing a System Property to the Startup Script">passing the system property to the JBoss EAP startup script</a>
					</li><li class="listitem">
						<a class="link" href="jboss_eap_management.html#sys_prop_management_cli" title="Setting a System Property Using the Management CLI">using the management CLI</a>
					</li><li class="listitem">
						<a class="link" href="jboss_eap_management.html#sys_prop_management_console" title="Setting a System Property Using the Management Console">using the management console</a>
					</li><li class="listitem">
						<a class="link" href="jboss_eap_management.html#sys_prop_java_opts" title="Setting a System Property Using JAVA_OPTS">using the <code class="literal">JAVA_OPTS</code> environment variable</a>
					</li></ul></div><p>
				If you use a JBoss EAP managed domain, system properties can be applied to either the whole domain, a specific server group, a specific host and all its server instances, or just to one specific server instance. As with most other JBoss EAP domain settings, a system property set at a more specific level will override a more abstract one. See the <a class="link" href="domain_management.html" title="Chapter 8. Domain Management">Domain Management</a> chapter for more information.
			</p><h3><a id="sys_prop_startup_script"/>Passing a System Property to the Startup Script</h3><p>
				You can pass a system property to the JBoss EAP startup script by using the <code class="literal">-D</code> argument. For example:
			</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/standalone.sh -Djboss.bind.address=192.168.1.2</pre><p>
				This method of setting the system property is especially useful for JBoss EAP options that need to be set before JBoss EAP starts.
			</p><h3><a id="sys_prop_management_cli"/>Setting a System Property Using the Management CLI</h3><p>
				Using the management CLI, you can set a system property using the following syntax:
			</p><pre class="screen">/system-property=<span class="emphasis"><em>PROPERTY_NAME</em></span>:add(value=<span class="emphasis"><em>PROPERTY_VALUE</em></span>)</pre><p>
				For example:
			</p><pre class="screen">/system-property=jboss.bind.address:add(value=192.168.1.2)</pre><p>
				When setting system properties using the management CLI, some JBoss EAP options, including the above example of <code class="literal">jboss.bind.address</code>, will only take effect after the next server restart.
			</p><p>
				For a managed domain, the above example configures a system property for the entire domain, but you can also set or override system properties at more specific levels of the domain configuration.
			</p><h3><a id="sys_prop_management_console"/>Setting a System Property Using the Management Console</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						For a standalone JBoss EAP server, you can configure system properties in the management console under the <span class="strong"><strong>Configuration</strong></span> tab. Select <span class="strong"><strong>System Properties</strong></span>, and click the <span class="strong"><strong>View</strong></span> button.
					</li><li class="listitem"><p class="simpara">
						For a managed domain:
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								Domain-level system properties can be set in the <span class="strong"><strong>Configuration</strong></span> tab. Select <span class="strong"><strong>System Properties</strong></span>, and click the <span class="strong"><strong>View</strong></span> button.
							</li><li class="listitem">
								Server group and server-level system properties can be set in the <span class="strong"><strong>Runtime</strong></span> tab. Select the server group or server you want to configure, click the <span class="strong"><strong>View</strong></span> button next to the server group or server name, and select the <span class="strong"><strong>System Properties</strong></span> tab.
							</li><li class="listitem">
								Host-level system properties can be set in the <span class="strong"><strong>Runtime</strong></span> tab. Select the host you want to configure, then using the drop-down menu next to the host name, select <span class="strong"><strong>Properties</strong></span>.
							</li></ul></div></li></ul></div><h3><a id="sys_prop_java_opts"/>Setting a System Property Using JAVA_OPTS</h3><p>
				System properties can also be configured using the <code class="literal">JAVA_OPTS</code> environment variable. There are many ways to modify <code class="literal">JAVA_OPTS</code>, but JBoss EAP provides a configuration file for setting <code class="literal">JAVA_OPTS</code> that is used by the JBoss EAP process.
			</p><p>
				For a standalone server, this file is <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin/standalone.conf</code>, or, for a managed domain, it is <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin/domain.conf</code>. For Microsoft Windows systems these files have a <code class="literal">.bat</code> extension.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					For an RPM installation, the <a class="link" href="reference_material.html#rpm_installation_configuration_files" title="RPM Service Configuration Files">RPM service configuration file</a> is the preferred location to modify <code class="literal">JAVA_OPTS</code> to configure system properties. For more information, see <a class="link" href="starting_and_stopping_jboss_eap.html#configure_rpm_service_properties" title="Configure RPM Service Properties">Configure RPM Service Properties</a>.
				</p></div><p>
				Add your system property definition to <code class="literal">JAVA_OPTS</code> in the relevant configuration file. The examples below demonstrate setting the bind address on a Red Hat Enterprise Linux system.
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
						For <code class="literal">standalone.conf</code>, add your <code class="literal">JAVA_OPTS</code> system property definition at the end of the file. For example:
					</p><pre class="screen">...
# Set the bind address
JAVA_OPTS="$JAVA_OPTS -Djboss.bind.address=192.168.1.2"</pre></li><li class="listitem"><p class="simpara">
						For <code class="literal">domain.conf</code>, <code class="literal">JAVA_OPTS</code> must be set before the process controller <code class="literal">JAVA_OPTS</code> setting. For example:
					</p><pre class="screen">...
# Set the bind address
JAVA_OPTS="$JAVA_OPTS -Djboss.bind.address=192.168.1.2"

# The ProcessController process uses its own set of java options
if [ "x$PROCESS_CONTROLLER_JAVA_OPTS" = "x" ]; then
...</pre></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="management_audit_logging"/>Management Audit Logging</h1></div></div></div><p>
				You can enable audit logging for the management interfaces, which will log all operations performed using the management console, management CLI, or custom application that uses the Management API. Audit log entries are stored in JSON format. By default, audit logging is disabled.
			</p><p>
				You can configure audit logging to output to a <a class="link" href="jboss_eap_management.html#enable_audit_logging" title="Enable Management Audit Logging">file</a> or to a <a class="link" href="jboss_eap_management.html#send_audit_logging_syslog" title="Send Management Audit Logging to a Syslog Server">syslog server</a>.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					Login and logout events cannot be audited as there is no authenticated session in JBoss EAP. Instead, audit messages are logged when an operation is received from the user.
				</p></div><h3><a id="standalone_server_audit_logging"/>Standalone Server Audit Logging</h3><p>
				Though disabled by default, the default audit logging configuration writes to a file.
			</p><pre class="programlisting">&lt;audit-log&gt;
    &lt;formatters&gt;
        &lt;json-formatter name="json-formatter"/&gt;
    &lt;/formatters&gt;
    &lt;handlers&gt;
        &lt;file-handler name="file" formatter="json-formatter" path="audit-log.log" relative-to="jboss.server.data.dir"/&gt;
    &lt;/handlers&gt;
    &lt;logger log-boot="true" log-read-only="false" enabled="false"&gt;
        &lt;handlers&gt;
            &lt;handler name="file"/&gt;
        &lt;/handlers&gt;
    &lt;/logger&gt;
&lt;/audit-log&gt;</pre><p>
				This configuration can be read using the following management CLI command.
			</p><pre class="screen">/core-service=management/access=audit:read-resource(recursive=true)</pre><p>
				See <a class="link" href="jboss_eap_management.html#enable_audit_logging" title="Enable Management Audit Logging">Enable Audit Logging</a> to enable audit logging for a standalone server.
			</p><h3><a id="managed_domain_audit_logging"/>Managed Domain Audit Logging</h3><p>
				Though disabled by default, the default audit logging configuration writes a file for each host and for each server.
			</p><pre class="programlisting">&lt;audit-log&gt;
    &lt;formatters&gt;
        &lt;json-formatter name="json-formatter"/&gt;
    &lt;/formatters&gt;
    &lt;handlers&gt;
        &lt;file-handler name="host-file" formatter="json-formatter" relative-to="jboss.domain.data.dir" path="audit-log.log"/&gt;
        &lt;file-handler name="server-file" formatter="json-formatter" relative-to="jboss.server.data.dir" path="audit-log.log"/&gt;
    &lt;/handlers&gt;
    &lt;logger log-boot="true" log-read-only="false" enabled="false"&gt;
        &lt;handlers&gt;
            &lt;handler name="host-file"/&gt;
        &lt;/handlers&gt;
    &lt;/logger&gt;
    &lt;server-logger log-boot="true" log-read-only="false" enabled="false"&gt;
        &lt;handlers&gt;
            &lt;handler name="server-file"/&gt;
        &lt;/handlers&gt;
    &lt;/server-logger&gt;
&lt;/audit-log&gt;</pre><p>
				This configuration can be read using the following management CLI command.
			</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>/core-service=management/access=audit:read-resource(recursive=true)</pre><p>
				See <a class="link" href="jboss_eap_management.html#enable_audit_logging" title="Enable Management Audit Logging">Enable Audit Logging</a> to enable audit logging for a managed domain.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="enable_audit_logging"/>Enable Management Audit Logging</h2></div></div></div><p>
					JBoss EAP is preconfigured with file handlers for audit logging, though audit logging is disabled by default. The management CLI command to enable audit logging depends on whether you are running as a standalone server or in a managed domain. See <a class="link" href="reference_material.html#management_audit_logging_attributes" title="Management Audit Logging Attributes">Management Audit Logging Attributes</a> for file handler attributes.
				</p><p>
					The following instructions enable <code class="literal">NATIVE</code> and <code class="literal">HTTP</code> audit logging. To configure JMX audit logging, see <a class="link" href="jboss_eap_management.html#enable_jmx_audit_logging" title="Enable JMX Management Audit Logging">Enable JMX Management Audit Logging</a>.
				</p><p>
					To set up syslog audit logging, see <a class="link" href="jboss_eap_management.html#send_audit_logging_syslog" title="Send Management Audit Logging to a Syslog Server">Send Management Audit Logging to a Syslog Server</a>.
				</p><h4><a id="enable_standalone_server_audit_logging"/>Enable Standalone Server Audit Logging</h4><p>
					Audit logging can be enabled using the following command.
				</p><pre class="screen">/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)</pre><p>
					By default, this will write the audit log to <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/data/audit-log.log</code>.
				</p><h4><a id="enable_managed_domain_audit_logging"/>Enable Managed Domain Audit Logging</h4><p>
					The default audit logging configuration for a managed domain is preconfigured to write an audit log for each host and each server.
				</p><p>
					Audit logging for each host can be enabled using the following command.
				</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)</pre><p>
					By default, this will write the audit logs to <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/domain/data/audit-log.log</code>.
				</p><p>
					Audit logging for each server can be enabled using the following command.
				</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>/core-service=management/access=audit/server-logger=audit-log:write-attribute(name=enabled,value=true)</pre><p>
					By default, this will write the audit logs to <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/domain/servers/<span class="emphasis"><em>SERVER_NAME</em></span>/data/audit-log.log</code>.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="enable_jmx_audit_logging"/>Enable JMX Management Audit Logging</h2></div></div></div><p>
					JBoss EAP is preconfigured with file handlers for JMX audit logging, though these logs are disabled by default. The management CLI command to enable audit logging depends on whether you are running as a standalone server or a managed domain.
				</p><p>
					To configure <code class="literal">NATIVE</code> or <code class="literal">HTTP</code> audit logging, see <a class="link" href="jboss_eap_management.html#enable_audit_logging" title="Enable Management Audit Logging">Enable Management Audit Logging</a>.
				</p><h4><a id="enable_standalone_jmx_audit_logging"/>Enable Standalone Server JMX Audit Logging</h4><p>
					JMX audit logging can be enabled for a standalone server using the following commands.
				</p><pre class="screen">/subsystem=jmx/configuration=audit-log:add()
/subsystem=jmx/configuration=audit-log/handler=file:add()</pre><p>
					This enables JMX audit logging, and then uses the defined <code class="literal">file</code> handler to write these logs to <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/data/audit-log.log</code>.
				</p><h4><a id="enable_domain_jmx_audit_logging"/>Enable Managed Domain JMX Audit Logging</h4><p>
					JMX audit logging can be enabled for each host and profile in a managed domain.
				</p><div class="orderedlist"><p class="title"><strong>Enable JMX Audit Logging for a Host</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">
							Enable audit logging in the host’s <code class="literal">jmx</code> subsystem.
						</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>/subsystem=jmx/configuration=audit-log:add()</pre></li><li class="listitem"><p class="simpara">
							Once audit logging for the <code class="literal">jmx</code> subsystem has been enabled, a handler can be defined for the host with the following command.
						</p><pre class="screen">/host=<span class="emphasis"><em>HOST_NAME</em></span>/subsystem=jmx/configuration=audit-log/handler=host-file:add()</pre><p class="simpara">
							By default, this will write the JMX audit logs to <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/domain/data/audit-log.log</code>.
						</p></li></ol></div><div class="orderedlist"><p class="title"><strong>Enable JMX Audit Logging for a Profile</strong></p><ol class="orderedlist"><li class="listitem"><p class="simpara">
							Enable audit logging in the profile’s <code class="literal">jmx</code> subsystem.
						</p><pre class="screen">/profile=<span class="emphasis"><em>PROFILE_NAME</em></span>/subsystem=jmx/configuration=audit-log:add()</pre></li><li class="listitem"><p class="simpara">
							Once audit logging for the <code class="literal">jmx</code> subsystem has been enabled, a handler can be defined for the profile with the following command.
						</p><pre class="screen">/profile=<span class="emphasis"><em>PROFILE_NAME</em></span>/subsystem=jmx/configuration=audit-log/handler=server-file:add()</pre><p class="simpara">
							By default, this will write the JMX audit logs to <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/domain/servers/<span class="emphasis"><em>SERVER_NAME</em></span>/data/audit-log.log</code>.
						</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="send_audit_logging_syslog"/>Send Management Audit Logging to a Syslog Server</h2></div></div></div><p>
					A syslog handler specifies the parameters by which audit log entries are sent to a syslog server, specifically the syslog server’s host name and the port on which the syslog server is listening. Sending audit logging to a syslog server provides more security options than logging to a local file or local syslog server. Multiple syslog handlers can be defined and be active at the same time.
				</p><p>
					By default, audit logging is preconfigured to output to a file when enabled. Use the following steps to set up and enable audit logging to a syslog server. See <a class="link" href="reference_material.html#management_audit_logging_attributes" title="Management Audit Logging Attributes">Management Audit Logging Attributes</a> for syslog handler attributes.
				</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
							Add a syslog handler.
						</p><p class="simpara">
							Create the syslog handler, specifying the host and port of the syslog server. In a managed domain, you must precede the <code class="literal">/core-service</code> commands with <code class="literal">/host=<span class="emphasis"><em>HOST_NAME</em></span></code>.
						</p><pre class="screen">batch
/core-service=management/access=audit/syslog-handler=<span class="emphasis"><em>SYSLOG_HANDLER_NAME</em></span>:add(formatter=json-formatter)
/core-service=management/access=audit/syslog-handler=<span class="emphasis"><em>SYSLOG_HANDLER_NAME</em></span>/protocol=udp:add(host=<span class="emphasis"><em>HOST_NAME</em></span>,port=<span class="emphasis"><em>PORT</em></span>)
run-batch</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
								The parameters to pass in differ depending on the protocol specified.
							</p><p>
								To configure the handler to use TLS to communicate securely with the syslog server, you must also configure the authentication, for example:
							</p><pre class="screen">/core-service=management/access=audit/syslog-handler=<span class="emphasis"><em>SYSLOG_HANDLER_NAME</em></span>/protocol=tls/authentication=truststore:add(keystore-path=<span class="emphasis"><em>PATH_TO_TRUSTSTORE</em></span>,keystore-password=<span class="emphasis"><em>TRUSTSTORE_PASSWORD</em></span>)</pre></div></li><li class="listitem"><p class="simpara">
							Add a reference to the syslog handler.
						</p><p class="simpara">
							In a managed domain, you must precede this command with <code class="literal">/host=<span class="emphasis"><em>HOST_NAME</em></span></code>.
						</p><pre class="screen">/core-service=management/access=audit/logger=audit-log/handler=<span class="emphasis"><em>SYSLOG_HANDLER_NAME</em></span>:add</pre></li><li class="listitem"><p class="simpara">
							Enable audit logging.
						</p><p class="simpara">
							See <a class="link" href="jboss_eap_management.html#enable_audit_logging" title="Enable Management Audit Logging">Enable Management Audit Logging</a> to enable audit logging.
						</p></li></ol></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
						Enabling audit logging to a syslog server in JBoss EAP will not work unless logging is enabled in the operating system as well.
					</p><p>
						For more information on <code class="literal">rsyslog</code> configurations on Red Hat Enterprise Linux, see the <span class="emphasis"><em>Basic Configuration of Rsyslog</em></span> section of the <span class="emphasis"><em>System Administrator’s Guide</em></span> for Red Hat Enterprise Linux at <a class="link" href="https://access.redhat.com/documentation/en/red-hat-enterprise-linux/">https://access.redhat.com/documentation/en/red-hat-enterprise-linux/</a>.
					</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="read_audit_log"/>Read Audit Log Entries</h2></div></div></div><p>
					Audit log entries output to files are best viewed with a text <span class="emphasis"><em>viewer</em></span>, while those output to a syslog server are best viewed using a syslog viewer application.
				</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						Using a text <span class="emphasis"><em>editor</em></span> for viewing log files is not recommended as some may prevent further log entries being written to the log file.
					</p></div><p>
					The audit log entries are stored in JSON format. Each log entry begins with an optional timestamp, followed by the fields in the below table.
				</p><div class="table"><a id="idm140150824605680"/><p class="title"><strong>Table 3.5. Management Audit Log Fields</strong></p><div class="table-contents"><table summary="Management Audit Log Fields" border="1" width="100%"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Field Name</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									access
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									This can have one of the following values:
								</p>
								 <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
											<code class="literal">NATIVE</code> - The operation came in through the native management interface.
										</li><li class="listitem">
											<code class="literal">HTTP</code> - The operation came in through the domain HTTP interface.
										</li><li class="listitem">
											<code class="literal">JMX</code> - The operation came in through the <code class="literal">jmx</code> subsystem.
										</li></ul></div>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									booting
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Has the value <code class="literal">true</code> if the operation was executed during the bootup process, or <code class="literal">false</code> if it was executed once the server is up and running.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									domainUUID
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									An ID to link together all operations as they are propagated from the domain controller to its servers, slave host controllers, and slave host controller servers.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									ops
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									The operations being executed. This is a list of the operations serialized to JSON. At boot, this is the operations resulting from parsing the XML. Once booted, the list typically contains a single entry.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									r/o
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Has the value <code class="literal">true</code> if the operation does not change the management model, or <code class="literal">false</code> if it does.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									remote-address
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									The address of the client executing this operation.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									success
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Has the value <code class="literal">true</code> if the operation was successful, or <code class="literal">false</code> if it was rolled back.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									type
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									This can have the value <code class="literal">core</code>, meaning it is a management operation, or <code class="literal">jmx</code>, meaning it comes from the <code class="literal">jmx</code> subsystem.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									user
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									The username of the authenticated user. If the operation occurred using the management CLI on the same machine as the running server, the special user <code class="literal">$local</code> is used.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									version
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									The version number of the JBoss EAP instance.
								</p>
								 </td></tr></tbody></table></div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="server_lifecycle_event_notifications"/>Server Lifecycle Event Notifications</h1></div></div></div><p>
				You can set up notifications for server lifecycle events using the JBoss EAP <a class="link" href="jboss_eap_management.html#monitor_server_lifecycle_events_management" title="Monitor Server Lifecycle Events Using the Core Management Subsystem"><code class="literal">core-management</code> subsystem</a> or <a class="link" href="jboss_eap_management.html#monitor_server_lifecycle_events_jmx" title="Monitor Server Lifecycle Events Using JMX Notifications">JMX</a>. A change in server runtime configuration state or server running state will trigger a notification.
			</p><p>
				The server runtime configuration states for JBoss EAP are <code class="literal">STARTING</code>, <code class="literal">RUNNING</code>, <code class="literal">RELOAD_REQUIRED</code>, <code class="literal">RESTART_REQUIRED</code>, <code class="literal">STOPPING</code>, and <code class="literal">STOPPED</code>.
			</p><p>
				The server running states for JBoss EAP are <code class="literal">STARTING</code>, <code class="literal">NORMAL</code>, <code class="literal">ADMIN_ONLY</code>, <code class="literal">PRE_SUSPEND</code>, <code class="literal">SUSPENDING</code>, <code class="literal">SUSPENDED</code>, <code class="literal">STOPPING</code>, and <code class="literal">STOPPED</code>.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="monitor_server_lifecycle_events_management"/>Monitor Server Lifecycle Events Using the Core Management Subsystem</h2></div></div></div><p>
					You can register a listener to the JBoss EAP <code class="literal">core-management</code> subsystem to monitor for server lifecycle events. The following steps show how to create and register an example listener that logs the events to a file.
				</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
							Create the listener.
						</p><p class="simpara">
							Create an implementation of <code class="literal">org.wildfly.extension.core.management.client.ProcessStateListener</code>, like the example below.
						</p><div class="title"><strong>Example: Listener Class</strong></div><p>
								
</p><pre class="programlisting">package org.simple.lifecycle.events.listener;

import java.io.File;
import java.io.FileWriter;
import java.io.IOException;

import org.wildfly.extension.core.management.client.ProcessStateListener;
import org.wildfly.extension.core.management.client.ProcessStateListenerInitParameters;
import org.wildfly.extension.core.management.client.RunningStateChangeEvent;
import org.wildfly.extension.core.management.client.RuntimeConfigurationStateChangeEvent;

public class SimpleListener implements ProcessStateListener {

    private File file;
    private FileWriter fileWriter;
    private ProcessStateListenerInitParameters parameters;

    public void init(ProcessStateListenerInitParameters parameters) {
        this.parameters = parameters;
        this.file = new File(parameters.getInitProperties().get("file"));
        try {
            fileWriter = new FileWriter(file, true);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public void cleanup() {
        try {
            fileWriter.close();
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            fileWriter = null;
        }
    }

    public void runtimeConfigurationStateChanged(RuntimeConfigurationStateChangeEvent evt) {
        try {
            fileWriter.write(String.format("Runtime configuration state change for %s: %s to %s\n", parameters.getProcessType(), evt.getOldState(), evt.getNewState()));
            fileWriter.flush();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public void runningStateChanged(RunningStateChangeEvent evt) {
        try {
            fileWriter.write(String.format("Running state change for %s: %s to %s\n", parameters.getProcessType(), evt.getOldState(), evt.getNewState()));
            fileWriter.flush();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}</pre><p>

							</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
								Keep the following in mind when implementing the listener.
							</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
										In the event of a server reload, listeners stop listening while the server attempts to stop, and the listeners are reloaded when the server starts. Because of this, implementations must ensure that they can be loaded, initialized, and removed properly several times inside the same JVM.
									</li><li class="listitem">
										Notifications to the listeners are blocking to allow reactions to server state changes. Implementations must ensure that they do not block or deadlock.
									</li><li class="listitem">
										Each listener instance is executed in its own thread and the order is not guaranteed.
									</li></ul></div></div></li><li class="listitem"><p class="simpara">
							Compile the class and package it into a JAR.
						</p><p class="simpara">
							Note that to compile, you need to depend on the <code class="literal">org.wildfly.core:wildfly-core-management-client</code> Maven module.
						</p></li><li class="listitem"><p class="simpara">
							Add the JAR as a JBoss EAP module.
						</p><p class="simpara">
							Use the following management CLI command and provide the module name and path to the JAR.
						</p><pre class="screen">module add --name=org.simple.lifecycle.events.listener --dependencies=org.wildfly.extension.core-management-client --resources=/path/to/simple-listener-0.0.1-SNAPSHOT.jar</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
								Using the <code class="literal">module</code> management CLI command to add and remove modules is provided as Technology Preview only. This command is not appropriate for use in a managed domain or when connecting to the management CLI remotely. Modules should be <a class="link" href="overview_of_class_loading_and_modules.html#create_module_manually" title="Create a Custom Module Manually">added</a> and <a class="link" href="overview_of_class_loading_and_modules.html#remove_module_manually" title="Remove a Custom Module Manually">removed</a> manually in a production environment.
							</p><p>
								Technology Preview features are not supported with Red Hat production service level agreements (SLAs), might not be functionally complete, and Red Hat does not recommend to use them for production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
							</p><p>
								See <a class="link" href="https://access.redhat.com/support/offerings/techpreview">Technology Preview Features Support Scope</a> on the Red Hat Customer Portal for information about the support scope for Technology Preview features.
							</p></div></li><li class="listitem"><p class="simpara">
							Register the listener.
						</p><p class="simpara">
							Add the listener to the <code class="literal">core-management</code> subsystem using the following management CLI command. Specify the class, module, and file location to log the server lifecycle events.
						</p><pre class="screen">/subsystem=core-management/process-state-listener=my-simple-listener:add(class=org.simple.lifecycle.events.listener.SimpleListener, module=org.simple.lifecycle.events.listener,properties={file=/path/to/my-listener-output.txt})</pre></li></ol></div><p>
					Now, server lifecycle events will be logged to the <code class="literal">my-listener-output.txt</code> file based on the <code class="literal">SimpleListener</code> class above. For example, issuing a <code class="literal">:suspend</code> command in the management CLI will output the following to the <code class="literal">my-listener-output.txt</code> file.
				</p><pre class="screen">Running state change for STANDALONE_SERVER: normal to suspending
Running state change for STANDALONE_SERVER: suspending to suspended</pre><p>
					This shows that the running state changed from <code class="literal">normal</code> to <code class="literal">suspending</code>, and then from <code class="literal">suspending</code> to <code class="literal">suspended</code>.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="monitor_server_lifecycle_events_jmx"/>Monitor Server Lifecycle Events Using JMX Notifications</h2></div></div></div><p>
					You can register a JMX notification listener to monitor for server lifecycle events. The following steps show how to create and add an example listener that logs events to a file.
				</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
							Create the listener.
						</p><p class="simpara">
							Create an implementation of <code class="literal">javax.management.NotificationListener</code>, like the example below.
						</p><div class="title"><strong>Example: Listener Class</strong></div><p>
								
</p><pre class="programlisting">import java.io.BufferedWriter;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.nio.file.StandardOpenOption;

import javax.management.AttributeChangeNotification;
import javax.management.Notification;
import javax.management.NotificationListener;

import org.jboss.logging.Logger;

public class StateNotificationListener implements NotificationListener {

  public static final String RUNTIME_CONFIGURATION_FILENAME = "runtime-configuration-notifications.txt";
  public static final String RUNNING_FILENAME = "running-notifications.txt";
  private final Path targetFile;

  public StateNotificationListener() {
    this.targetFile = Paths.get("notifications/data").toAbsolutePath();
    init(targetFile);
  }

  protected Path getRuntimeConfigurationTargetFile() {
    return this.targetFile.resolve(RUNTIME_CONFIGURATION_FILENAME);
  }

  protected Path getRunningConfigurationTargetFile() {
    return this.targetFile.resolve(RUNNING_FILENAME);
  }

  protected final void init(Path targetFile) {
    try {
      Files.createDirectories(targetFile);

      if (!Files.exists(targetFile.resolve(RUNTIME_CONFIGURATION_FILENAME))) {
        Files.createFile(targetFile.resolve(RUNTIME_CONFIGURATION_FILENAME));
      }

      if (!Files.exists(targetFile.resolve(RUNNING_FILENAME))) {
        Files.createFile(targetFile.resolve(RUNNING_FILENAME));
      }
    } catch (IOException ex) {
        Logger.getLogger(StateNotificationListener.class).error("Problem handling JMX Notification", ex);
    }
  }

  @Override
  public void handleNotification(Notification notification, Object handback) {
    AttributeChangeNotification attributeChangeNotification = (AttributeChangeNotification) notification;
    if ("RuntimeConfigurationState".equals(attributeChangeNotification.getAttributeName())) {
      writeNotification(attributeChangeNotification, getRuntimeConfigurationTargetFile());
    } else {
      writeNotification(attributeChangeNotification, getRunningConfigurationTargetFile());
    }
  }

  private void writeNotification(AttributeChangeNotification notification, Path path) {
    try (BufferedWriter in = Files.newBufferedWriter(path, StandardCharsets.UTF_8, StandardOpenOption.APPEND)) {
      in.write(String.format("%s %s %s %s", notification.getType(), notification.getSequenceNumber(), notification.getSource().toString(), notification.getMessage()));
      in.newLine();
      in.flush();
    } catch (IOException ex) {
      Logger.getLogger(StateNotificationListener.class).error("Problem handling JMX Notification", ex);
    }
  }
}</pre><p>

							</p></li><li class="listitem"><p class="simpara">
							Register the notification listener.
						</p><p class="simpara">
							Add the notification listener to the <code class="literal">MBeanServer</code>.
						</p><div class="title"><strong>Example: Add a Notification Listener</strong></div><p>
								
</p><pre class="programlisting">MBeanServer server = ManagementFactory.getPlatformMBeanServer();
server.addNotificationListener(ObjectName.getInstance("jboss.root:type=state"), new StateNotificationListener(), null, null);</pre><p>

							</p></li><li class="listitem">
							Package and deploy to JBoss EAP.
						</li></ol></div><p>
					Server lifecycle events are now logged to a file based on the <code class="literal">StateNotificationListener</code> class above. For example, issuing a <code class="literal">:suspend</code> command in the management CLI outputs the following to the <code class="literal">running-notifications.txt</code> file.
				</p><pre class="screen">jmx.attribute.change 5 jboss.root:type=state The attribute 'RunningState' has changed from 'normal' to 'suspending'
jmx.attribute.change 6 jboss.root:type=state The attribute 'RunningState' has changed from 'suspending' to 'suspended'</pre><p>
					This shows that the running state changed from <code class="literal">normal</code> to <code class="literal">suspending</code>, and then from <code class="literal">suspending</code> to <code class="literal">suspended</code>.
				</p></div></div></div></body></html>