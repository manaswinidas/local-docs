<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 7. Deploying Applications</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="deploying_applications"/>Chapter 7. Deploying Applications</h1></div></div></div><p>
			JBoss EAP features a range of application deployment and configuration options to cater to both administrators and developers. For administrators, the <a class="link" href="deploying_applications.html#deploying_apps_using_console" title="Deploying Applications Using the Management Console">management console</a> and the <a class="link" href="deploying_applications.html#deploying_apps_using_cli" title="Deploying Applications Using the Management CLI">management CLI</a> offer ideal graphical and command-line interfaces to manage application deployment in a production environment. For developers, the range of application deployment testing options include a configurable file system <a class="link" href="deploying_applications.html#deploying_apps_using_scanner" title="Deploying Applications Using the Deployment Scanner">deployment scanner</a>, the <a class="link" href="deploying_applications.html#deploying_apps_using_http_api" title="Deploying Applications Using the HTTP API">HTTP API</a>, an IDE such as Red Hat Developer Studio, and <a class="link" href="deploying_applications.html#deploying_apps_using_maven" title="Deploying Applications Using Maven">Maven</a>.
		</p><p>
			When deploying applications, you may want to enable validation for deployment descriptors by setting the <code class="literal">org.jboss.metadata.parser.validate</code> system property to <code class="literal">true</code>. This can be done one of the following ways:
		</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
					While starting the server.
				</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/standalone.sh -Dorg.jboss.metadata.parser.validate=true</pre></li><li class="listitem"><p class="simpara">
					By adding it to the server configuration with the following management CLI command.
				</p><pre class="screen">/system-property=org.jboss.metadata.parser.validate:add(value=true)</pre></li></ul></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="deploying_apps_using_cli"/>Deploying Applications Using the Management CLI</h1></div></div></div><p>
				Deploying applications using the management CLI gives you the benefit of a single command-line interface with the ability to create and run deployment scripts. You can use this scripting ability to configure specific application deployment and management scenarios. You can manage the deployments for a single server when running as a standalone server, or an entire network of servers when running in a managed domain.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deploy_app_standalone_cli"/>Deploy an Application to a Standalone Server Using the Management CLI</h2></div></div></div><h4><a id="deploy_an_application"/>Deploy an Application</h4><p>
					From the management CLI, use the <code class="literal">deployment deploy-file</code> command and specify the path to the application deployment.
				</p><pre class="screen">deployment deploy-file <span class="emphasis"><em>/path/to</em></span>/test-application.war</pre><p>
					A successful deployment does not produce any output to the management CLI, but the server log displays deployment messages.
				</p><pre class="screen">WFLYSRV0027: Starting deployment of "test-application.war" (runtime-name: "test-application.war")
WFLYUT0021: Registered web context: /test-application
WFLYSRV0010: Deployed "test-application.war" (runtime-name : "test-application.war")</pre><p>
					Similarly, you can use the following <code class="literal">deployment</code> commands:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							Use the <code class="literal">deployment deploy-cli-archive</code> to deploy the content from a <code class="literal">.cli</code> archive file. A CLI deployment archive is a <code class="literal">JAR</code> file with the <code class="literal">.cli</code> extension. It contains application archives that should be deployed and the CLI script files, <code class="literal">deploy.scr</code> and <code class="literal">undeploy.scr</code>, containing commands and operations. One script file, <code class="literal">deploy.scr</code>, contains the commands and operations that deploy the application archives and set up the environment; the other script file, <code class="literal">undeploy.scr</code>, contains the commands to undeploy the application archives and clean up the environment.
						</li><li class="listitem">
							Use the <code class="literal">deployment deploy-url</code> to deploy the content referenced by a URL.
						</li></ul></div><p>
					You can also enable the <a class="link" href="deploying_applications.html#disable_app_domain_cli" title="Disable an Application">disabled</a> applications using the <a class="link" href="deploying_applications.html#enable_app_standalone_cli" title="Enable an Application"><code class="literal">deployment enable</code> command</a>.
				</p><h4><a id="undeploy_an_application"/>Undeploy an Application</h4><p>
					From the management CLI, use the <code class="literal">deployment undeploy</code> command and specify the deployment name. This will delete the deployment content from the repository. See <a class="link" href="deploying_applications.html#disable_app_standalone_cli" title="Disable an Application">Disable an Application</a> for keeping the deployment content when undeploying.
				</p><pre class="screen">deployment undeploy test-application.war</pre><p>
					A successful undeployment does not produce any output to the management CLI, but the server log displays undeployment messages.
				</p><pre class="screen">WFLYUT0022: Unregistered web context: /test-application
WFLYSRV0028: Stopped deployment test-application.war (runtime-name: test-application.war) in 62ms
WFLYSRV0009: Undeployed "test-application.war" (runtime-name: "test-application.war")</pre><p>
					Similarly, you can use the <code class="literal">deployment undeploy-cli-archive</code> to undeploy the content from a <code class="literal">.cli</code> archive file. You can also undeploy all deployments using a wildcard (<code class="literal">*</code>).
				</p><pre class="screen">deployment undeploy *</pre><h4><a id="disable_app_standalone_cli"/>Disable an Application</h4><p>
					Disable a deployed application without removing the deployment content from the repository.
				</p><pre class="screen">deployment disable test-application.war</pre><p>
					You can use the <code class="literal">deployment disable-all</code> command to disable all the deployments.
				</p><pre class="screen">deployment disable-all</pre><h4><a id="enable_app_standalone_cli"/>Enable an Application</h4><p>
					Enable a disabled deployed application.
				</p><pre class="screen">deployment enable test-application.war</pre><p>
					You can use the <code class="literal">deployment enable-all</code> command to enable all the deployments.
				</p><pre class="screen">deployment enable-all</pre><h4><a id="list_deployments"/>List Deployments</h4><p>
					From the management CLI, use the <code class="literal">deployment info</code> command to list deployment information.
				</p><pre class="screen">deployment info</pre><p>
					The output will show details about each deployment, such as the runtime name, status, and whether it is enabled.
				</p><pre class="screen">NAME                 RUNTIME-NAME         PERSISTENT ENABLED STATUS
helloworld.war       helloworld.war       true       true    OK
test-application.war test-application.war true       true    OK</pre><p>
					To display deployment information by name:
				</p><pre class="screen">deployment info helloworld.war</pre><p>
					You can also list all the deployments using the <code class="literal">deployment list</code> command.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deploy_app_managed_domain_cli"/>Deploy an Application in a Managed Domain Using the Management CLI</h2></div></div></div><h4><a id="deploy_an_application_2"/>Deploy an Application</h4><p>
					From the management CLI, use the <code class="literal">deployment deploy-file</code> command and specify the path to the application deployment. You must also specify the server groups to which the application should be deployed.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
							To deploy the application to all server groups.
						</p><pre class="screen">deployment deploy-file <span class="emphasis"><em>/path/to</em></span>/test-application.war --all-server-groups</pre></li><li class="listitem"><p class="simpara">
							To deploy the application to specific server groups.
						</p><pre class="screen">deployment deploy-file <span class="emphasis"><em>/path/to</em></span>/test-application.war --server-groups=main-server-group,other-server-group</pre></li></ul></div><p>
					A successful deployment does not produce any output to the management CLI, but the server log displays deployment messages for each affected server.
				</p><pre class="screen">[Server:server-one] WFLYSRV0027: Starting deployment of "test-application.war" (runtime-name: "test-application.war")
[Server:server-one] WFLYUT0021: Registered web context: /test-application
[Server:server-one] WFLYSRV0010: Deployed "test-application.war" (runtime-name : "test-application.war")</pre><p>
					Similarly, you can use the following <code class="literal">deployment</code> commands:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							Use the <code class="literal">deployment deploy-cli-archive</code> command to deploy the content from a <code class="literal">.cli</code> archive file. A CLI deployment archive is a <code class="literal">JAR</code> file with the <code class="literal">.cli</code> extension. It contains application archives that should be deployed and the CLI script files, <code class="literal">deploy.scr</code> and <code class="literal">undeploy.scr</code>, containing commands and operations. One script file, <code class="literal">deploy.scr</code>, contains the commands and operations that deploy the application archives and set up the environment; the other script file, <code class="literal">undeploy.scr</code>, contains the commands to undeploy the application archives and clean up the environment.
						</li><li class="listitem">
							Use the <code class="literal">deployment deploy-url</code> command to deploy the content referenced by a URL.
						</li></ul></div><p>
					You can also enable the <a class="link" href="deploying_applications.html#disable_app_domain_cli" title="Disable an Application">disabled</a> applications using the <a class="link" href="deploying_applications.html#enable_app_domain_cli" title="Enable an Application"><code class="literal">deployment enable</code> command</a>.
				</p><h4><a id="undeploy_an_application_2"/>Undeploy an Application</h4><p>
					From the management CLI, use the <code class="literal">deployment undeploy</code> command and specify the deployment name. You must also specify the server groups from which the application should be undeployed. See <a class="link" href="deploying_applications.html#disable_app_domain_cli" title="Disable an Application">Disable an Application</a> for undeploying from specific server groups.
				</p><p>
					Undeploy the application from all server groups with that deployment.
				</p><pre class="screen">deployment undeploy test-application.war --all-relevant-server-groups</pre><p>
					A successful undeployment does not produce any output to the management CLI, but the server log displays undeployment messages for each affected server.
				</p><pre class="screen">[Server:server-one] WFLYUT0022: Unregistered web context: /test-application
[Server:server-one] WFLYSRV0028: Stopped deployment test-application.war (runtime-name: test-application.war) in 74ms
[Server:server-one] WFLYSRV0009: Undeployed "test-application.war" (runtime-name: "test-application.war")</pre><p>
					Similarly, you can use the <code class="literal">deployment undeploy-cli-archive</code> command to undeploy the content from a <code class="literal">.cli</code> archive file. You can also undeploy all deployments using a wildcard (<code class="literal">*</code>).
				</p><pre class="screen">deployment undeploy * --all-relevant-server-groups</pre><h4><a id="disable_app_domain_cli"/>Disable an Application</h4><p>
					Disable a deployed application from specific server groups and retain its content in the repository for other server groups with that deployment.
				</p><pre class="screen">deployment disable test-application.war --server-groups=other-server-group</pre><p>
					You can use the <code class="literal">deployment disable-all</code> command to disable all the deployments.
				</p><pre class="screen">deployment disable-all --server-groups=other-server-group</pre><h4><a id="enable_app_domain_cli"/>Enable an Application</h4><p>
					Enable a disabled deployed application.
				</p><pre class="screen">deployment enable test-application.war</pre><p>
					You can use the <code class="literal">deployment enable-all</code> command to enable all the deployments.
				</p><pre class="screen">deployment enable-all --server-groups=other-server-group</pre><h4><a id="list_deployments_2"/>List Deployments</h4><p>
					From the management CLI, use the <code class="literal">deployment info</code> command to list deployment information. You can list deployment information by deployment name or by server group.
				</p><p>
					To display deployment information by name:
				</p><pre class="screen">deployment info helloworld.war</pre><p>
					The output will list the deployment and its state in each server group.
				</p><pre class="screen">NAME               RUNTIME-NAME
helloworld.war     helloworld.war

SERVER-GROUP       STATE
main-server-group  enabled
other-server-group added</pre><p>
					To display deployment information by server group:
				</p><pre class="screen">deployment info --server-group=other-server-group</pre><p>
					The output will list the deployments and their state for the specified server group.
				</p><pre class="screen">NAME                 RUNTIME-NAME         STATE
helloworld.war       helloworld.war       added
test-application.war test-application.war enabled</pre><p>
					You can also list all deployments in the domain using the <code class="literal">deployment list</code> command.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="deploying_apps_using_console"/>Deploying Applications Using the Management Console</h1></div></div></div><p>
				Deploying applications using the management console gives you the benefit of a graphical interface that is easy to use. You can see at a glance which applications are deployed to your server or server groups, and you can enable, disable or remove applications from the content repository as required.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deploy_app_standalone_console"/>Deploy an Application to a Standalone Server Using the Management Console</h2></div></div></div><p>
					Deployments can be viewed and managed from the <span class="strong"><strong>Deployments</strong></span> tab of the JBoss EAP management console.
				</p><h4><a id="deploy_an_application_3"/>Deploy an Application</h4><p>
					Click the Add (<span class="strong"><strong>+</strong></span>) button. You can choose to deploy an application by <span class="emphasis"><em>uploading a deployment</em></span>, <span class="emphasis"><em>adding an unmanaged deployment</em></span>, or <span class="emphasis"><em>creating an empty deployment</em></span>. Deployments are enabled by default.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
							Upload a deployment
						</p><p class="simpara">
							Upload an application that will be copied to the server’s content repository and managed by JBoss EAP.
						</p></li><li class="listitem"><p class="simpara">
							Adding an unmanaged deployment
						</p><p class="simpara">
							Specify the location of a deployment. This deployment will not be copied to the server’s content repository and will not be managed by JBoss EAP.
						</p></li><li class="listitem"><p class="simpara">
							Creating an empty deployment
						</p><p class="simpara">
							Create an empty, exploded deployment. You can add files to the deployment after it has been created.
						</p></li></ul></div><h4><a id="undeploy_an_application_3"/>Undeploy an Application</h4><p>
					Select the deployment and choose the <span class="strong"><strong>Remove</strong></span> option to undeploy the application. This undeploys the deployment and removes it from the content repository.
				</p><h4><a id="disable_an_application"/>Disable an Application</h4><p>
					Select the deployment and choose the <span class="strong"><strong>Disable</strong></span> option to disable the application. This undeploys the deployment, but does not remove it from the content repository.
				</p><h4><a id="replace_an_application"/>Replace an Application</h4><p>
					Select the deployment and choose the <span class="strong"><strong>Replace</strong></span> option. Select the new version of the deployment, which must have the same name as the original, and click <span class="strong"><strong>Finish</strong></span>. This undeploys and removes the original version of the deployment, and then deploys the new version.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deploy_app_domain_console"/>Deploy an Application in a Managed Domain Using the Management Console</h2></div></div></div><p>
					From the <span class="strong"><strong>Deployments</strong></span> tab of the JBoss EAP management console, deployments can be viewed and managed by:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
							Content Repository
						</p><p class="simpara">
							All managed and unmanaged deployments are listed in the <span class="strong"><strong>Content Repository</strong></span> section. Deployments can be added and deployed to server groups here.
						</p></li><li class="listitem"><p class="simpara">
							Server Groups
						</p><p class="simpara">
							Deployments that have been deployed to one or more server groups are listed in the <span class="strong"><strong>Server Groups</strong></span> section. Deployments can be enabled and added directly to a server group here.
						</p></li></ul></div><h4><a id="add_an_application"/>Add an Application</h4><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
							From <span class="strong"><strong>Content Repository</strong></span>, click the <span class="strong"><strong>Add</strong></span> button.
						</li><li class="listitem">
							Choose to add an application by <span class="emphasis"><em>uploading a deployment</em></span> or <span class="emphasis"><em>adding an unmanaged deployment</em></span>.
						</li><li class="listitem"><p class="simpara">
							Follow the prompts to deploy the application.
						</p><p class="simpara">
							Note that a deployment must be deployed to a server group before it can be enabled.
						</p></li></ol></div><h4><a id="deploy_an_application_to_a_server_group"/>Deploy an Application to a Server Group</h4><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
							From <span class="strong"><strong>Content Repository</strong></span>, select a deployment and click the <span class="strong"><strong>Deploy</strong></span> button.
						</li><li class="listitem">
							Select one or more server groups to which this deployment should be deployed.
						</li><li class="listitem">
							Optionally, select the option to enable the deployment on the selected server groups.
						</li></ol></div><h4><a id="undeploy_an_application_from_a_server_group"/>Undeploy an Application from a Server Group</h4><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
							From <span class="strong"><strong>Server Groups</strong></span>, select the appropriate server group.
						</li><li class="listitem">
							Select the desired deployment and click the <span class="strong"><strong>Remove</strong></span> button.
						</li></ol></div><p>
					Deployments can also be undeployed from multiple server groups at once by selecting the <span class="strong"><strong>Undeploy</strong></span> button for the deployment in <span class="strong"><strong>Content Repository</strong></span>.
				</p><h4><a id="remove_an_application"/>Remove an Application</h4><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
							If the deployment is still deployed to any server groups, be sure to undeploy the deployment.
						</li><li class="listitem">
							From <span class="strong"><strong>Content Repository</strong></span>, select the deployment and click the <span class="strong"><strong>Remove</strong></span> button.
						</li></ol></div><p>
					This removes the deployment from the content repository.
				</p><h4><a id="disable_an_application_2"/>Disable an Application</h4><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
							From <span class="strong"><strong>Server Groups</strong></span>, select the appropriate server group.
						</li><li class="listitem">
							Select the desired deployment and click the <span class="strong"><strong>Disable</strong></span> button.
						</li></ol></div><p>
					This undeploys the deployment, but does not remove it from the content repository.
				</p><h4><a id="replace_an_application_2"/>Replace an Application</h4><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
							From <span class="strong"><strong>Content Repository</strong></span>, select the deployment and click the <span class="strong"><strong>Replace</strong></span> button.
						</li><li class="listitem">
							Select the new version of the deployment, which must have the same name as the original, and click <span class="strong"><strong>Replace</strong></span>.
						</li></ol></div><p>
					This undeploys and removes the original version of the deployment, and then deploys the new version.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="deploying_apps_using_scanner"/>Deploying Applications Using the Deployment Scanner</h1></div></div></div><p>
				The deployment scanner monitors the deployment directory for applications to deploy. By default, the deployment scanner scans the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/deployments/</code> directory every five seconds for changes. Marker files are used to indicate the status of a deployment and to trigger actions against deployments, such as undeploying or redeploying.
			</p><p>
				While it is recommended to use the management console or management CLI for application deployment in a production environment, deploying using the deployment scanner is provided for the convenience of developers. This allows users to build and test applications in a manner suited for rapid development cycles. Additionally, the deployment scanner should not be used in conjunction with other deployment methods.
			</p><p>
				The deployment scanner is only available when running JBoss EAP as a standalone server.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deploy_app_standalone_scanner"/>Deploy an Application to a Standalone Server Using the Deployment Scanner</h2></div></div></div><p>
					The deployment scanner can be configured to allow or disallow automatic deployment of XML, zipped, and exploded content. If automatic deployment is disabled, you must manually create marker files to trigger deployment actions. For more information about the available marker file types and their purposes, see the <a class="link" href="reference_material.html#reference_deploy_scanner_marker_files" title="Deployment Scanner Marker Files">Deployment Scanner Marker Files</a> section.
				</p><p>
					By default, automatic deployment for XML and zipped content is enabled. For details on configuring automatic deployment for each content type, see <a class="link" href="deploying_applications.html#configure_deploy_scanner" title="Configure the Deployment Scanner">Configure the Deployment Scanner</a>.
				</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
						Deploying using the deployment scanner is provided for the convenience of developers and is not recommended for use in a production environment. It should also not be used in conjunction with other deployment methods.
					</p></div><h4><a id="deploy_an_application_4"/>Deploy an Application</h4><p>
					Copy the content to the deployment folder.
				</p><pre class="screen">$ cp <span class="emphasis"><em>/path/to</em></span>/test-application.war <span class="emphasis"><em>EAP_HOME</em></span>/standalone/deployments/</pre><p>
					If auto-deployment is enabled, this file will be picked up automatically, deployed, and a <code class="literal">.deployed</code> marker file will be created. If auto-deployment is not enabled, then you will need to manually add a <code class="literal">.dodeploy</code> marker file to trigger deployment.
				</p><pre class="screen">$ touch <span class="emphasis"><em>EAP_HOME</em></span>/standalone/deployments/test-application.war.dodeploy</pre><h4><a id="undeploy_an_application_4"/>Undeploy an Application</h4><p>
					Trigger an undeployment by removing the <code class="literal">.deployed</code> marker file.
				</p><pre class="screen">$ rm <span class="emphasis"><em>EAP_HOME</em></span>/standalone/deployments/test-application.war.deployed</pre><p>
					If auto-deployment is enabled, you can also remove the <code class="literal">test-application.war</code> file, which will trigger the undeployment. Note that this does not apply for exploded deployments.
				</p><h4><a id="redeploy_an_application"/>Redeploy an Application</h4><p>
					Create a <code class="literal">.dodeploy</code> marker file to initiate redeployment.
				</p><pre class="screen">$ touch <span class="emphasis"><em>EAP_HOME</em></span>/standalone/deployments/test-application.war.dodeploy</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="configure_deploy_scanner"/>Configure the Deployment Scanner</h2></div></div></div><p>
					The deployment scanner can be configured using the management console or the management CLI. You can configure the deployment scanner’s behavior, such as the scan interval, deployment folder location, and autodeployment of certain application file types. You can also disable the deployment scanner entirely.
				</p><p>
					For details on all available deployment scanner attributes, see the <a class="link" href="reference_material.html#reference_deploy_scanner_attr" title="Deployment Scanner Attributes">Deployment Scanner Attributes</a> section.
				</p><p>
					Use the below management CLI commands to configure the default deployment scanner.
				</p><h4><a id="disable_the_deployment_scanner"/>Disable the Deployment Scanner</h4><pre class="screen">/subsystem=deployment-scanner/scanner=default:write-attribute(name=scan-enabled,value=false)</pre><p>
					This disables the <code class="literal">default</code> deployment scanner.
				</p><h4><a id="change_the_scan_interval"/>Change the Scan Interval</h4><pre class="screen">/subsystem=deployment-scanner/scanner=default:write-attribute(name=scan-interval,value=10000)</pre><p>
					This updates the scan interval time from <code class="literal">5000</code> milliseconds (five seconds) to <code class="literal">10000</code> milliseconds (ten seconds).
				</p><h4><a id="change_the_deployment_folder"/>Change the Deployment Folder</h4><pre class="screen">/subsystem=deployment-scanner/scanner=default:write-attribute(name=path,value=<span class="emphasis"><em>/path/to</em></span>/deployments)</pre><p>
					This changes the location of the deployment folder from the default location of <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/deployments</code> to <code class="literal"><span class="emphasis"><em>/path/to</em></span>/deployments</code>.
				</p><p>
					The <code class="literal">path</code> value will be treated as an absolute path unless the <code class="literal">relative-to</code> attribute is specified, in which case it will be relative to that path.
				</p><h4><a id="enable_the_automatic_deployment_of_exploded_content"/>Enable the Automatic Deployment of Exploded Content</h4><pre class="screen">/subsystem=deployment-scanner/scanner=default:write-attribute(name=auto-deploy-exploded,value=true)</pre><p>
					This enables the automatic deployment of exploded content, which is disabled by default.
				</p><h4><a id="disable_the_automatic_deployment_of_zipped_content"/>Disable the Automatic Deployment of Zipped Content</h4><pre class="screen">/subsystem=deployment-scanner/scanner=default:write-attribute(name=auto-deploy-zipped,value=false)</pre><p>
					This disables the automatic deployment of zipped content, which is enabled by default.
				</p><h4><a id="disable_the_automatic_deployment_of_xml_content"/>Disable the Automatic Deployment of XML Content</h4><pre class="screen">/subsystem=deployment-scanner/scanner=default:write-attribute(name=auto-deploy-xml,value=false)</pre><p>
					This disables the automatic deployment of XML content, which is enabled by default.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="define_custom_deployment_scanner"/>Define a Custom Deployment Scanner</h2></div></div></div><p>
					A new deployment scanner can be added using the management CLI or by navigating to the <span class="strong"><strong>Deployment Scanners</strong></span> subsystem from the <span class="strong"><strong>Configuration</strong></span> tab in the management console. This will define a new directory to scan for deployments. The default deployment scanner monitors <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/deployments</code>. See <a class="link" href="deploying_applications.html#configure_deploy_scanner" title="Configure the Deployment Scanner">Configure the Deployment Scanner</a> for details on configuring an existing deployment scanner.
				</p><p>
					The following management CLI command adds a new deployment scanner that will check <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/new_deployment_dir</code> every five seconds for deployments.
				</p><pre class="screen">/subsystem=deployment-scanner/scanner=new-scanner:add(path=new_deployment_dir,relative-to=jboss.server.base.dir,scan-interval=5000)</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						The specified directory must already exist or this command will fail with an error.
					</p></div><p>
					A new deployment scanner has been defined and the specified directory will be monitored for deployments.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="deploying_apps_using_maven"/>Deploying Applications Using Maven</h1></div></div></div><p>
				Deploying applications using Apache Maven allows you to easily incorporate deployment to JBoss EAP into your existing development workflow.
			</p><p>
				You can use Maven to deploy applications to JBoss EAP using the <a class="link" href="https://docs.jboss.org/wildfly/plugins/maven/latest/">WildFly Maven Plugin</a>, which provides simple operations to deploy and undeploy applications to the application server.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deploy_app_standalone_maven"/>Deploy an Application to a Standalone Server Using Maven</h2></div></div></div><p>
					The following instructions show how to deploy and undeploy the JBoss EAP <code class="literal">helloworld</code> quickstart to a standalone server using Maven.
				</p><p>
					See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/getting_started_guide/#using_the_quickstart_examples">Using the Quickstart Examples</a> in the JBoss EAP <span class="emphasis"><em>Getting Started Guide</em></span> for more information on the JBoss EAP quickstarts.
				</p><h4><a id="deploy_an_application_5"/>Deploy an Application</h4><p>
					Initialize the WildFly Maven Plugin in your Maven <code class="literal">pom.xml</code> file. This should already be configured in the JBoss EAP quickstart <code class="literal">pom.xml</code> files.
				</p><pre class="programlisting">&lt;plugin&gt;
  &lt;groupId&gt;org.wildfly.plugins&lt;/groupId&gt;
  &lt;artifactId&gt;wildfly-maven-plugin&lt;/artifactId&gt;
  &lt;version&gt;${version.wildfly.maven.plugin}&lt;/version&gt;
&lt;/plugin&gt;</pre><p>
					From the <code class="literal">helloworld</code> quickstart directory, execute the following Maven command.
				</p><pre class="screen">$ mvn clean install wildfly:deploy</pre><p>
					After issuing the Maven command to deploy, the terminal window shows the following output indicating a successful deployment.
				</p><pre class="screen">[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 2.981 s
[INFO] Finished at: 2015-12-23T15:06:13-05:00
[INFO] Final Memory: 21M/231M
[INFO] ------------------------------------------------------------------------</pre><p>
					The deployment can also be confirmed by viewing the server log of the active server instance.
				</p><pre class="screen">WFLYSRV0027: Starting deployment of "helloworld.war" (runtime-name: "helloworld.war")
WFLYUT0021: Registered web context: /helloworld
WFLYSRV0010: Deployed "helloworld.war" (runtime-name : "helloworld.war")</pre><h4><a id="undeploy_an_application_5"/>Undeploy an Application</h4><p>
					From the <code class="literal">helloworld</code> quickstart directory, execute the following Maven command.
				</p><pre class="screen">$ mvn wildfly:undeploy</pre><p>
					After issuing the Maven command to undeploy, the terminal window shows the following output indicating a successful undeployment.
				</p><pre class="screen">[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1.237 s
[INFO] Finished at: 2015-12-23T15:09:10-05:00
[INFO] Final Memory: 10M/183M
[INFO] ------------------------------------------------------------------------</pre><p>
					The undeployment can also be confirmed by viewing the server log of the active server instance.
				</p><pre class="screen">WFLYUT0022: Unregistered web context: /helloworld
WFLYSRV0028: Stopped deployment helloworld.war (runtime-name: helloworld.war) in 27ms
WFLYSRV0009: Undeployed "helloworld.war" (runtime-name: "helloworld.war")</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deploy_app_domain_maven"/>Deploy an Application in a Managed Domain Using Maven</h2></div></div></div><p>
					The following instructions show how to deploy and undeploy the JBoss EAP <code class="literal">helloworld</code> quickstart in a managed domain using Maven.
				</p><p>
					See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/getting_started_guide/#using_the_quickstart_examples">Using the Quickstart Examples</a> in the JBoss EAP <span class="emphasis"><em>Getting Started Guide</em></span> for more information on the JBoss EAP quickstarts.
				</p><h4><a id="deploy_an_application_6"/>Deploy an Application</h4><p>
					When deploying an application in a managed domain, you must specify the server groups to which the application should be deployed. This is configured in the Maven <code class="literal">pom.xml</code> file.
				</p><p>
					The following configuration in the <code class="literal">pom.xml</code> initializes the WildFly Maven Plugin and specifies <code class="literal">main-server-group</code> as the server group to which the application should be deployed.
				</p><pre class="programlisting">&lt;plugin&gt;
  &lt;groupId&gt;org.wildfly.plugins&lt;/groupId&gt;
  &lt;artifactId&gt;wildfly-maven-plugin&lt;/artifactId&gt;
  &lt;version&gt;${version.wildfly.maven.plugin}&lt;/version&gt;
  &lt;configuration&gt;
    &lt;domain&gt;
      &lt;server-groups&gt;
        &lt;server-group&gt;main-server-group&lt;/server-group&gt;
      &lt;/server-groups&gt;
    &lt;/domain&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;</pre><p>
					From the <code class="literal">helloworld</code> quickstart directory, execute the following Maven command.
				</p><pre class="screen">$ mvn clean install wildfly:deploy</pre><p>
					After issuing the Maven command to deploy, the terminal window shows the following output indicating a successful deployment.
				</p><pre class="screen">[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 4.005 s
[INFO] Finished at: 2016-09-02T14:36:17-04:00
[INFO] Final Memory: 21M/226M
[INFO] ------------------------------------------------------------------------</pre><p>
					The deployment can also be confirmed by viewing the server log of the active server instance.
				</p><pre class="screen">WFLYSRV0027: Starting deployment of "helloworld.war" (runtime-name: "helloworld.war")
WFLYUT0021: Registered web context: /helloworld
WFLYSRV0010: Deployed "helloworld.war" (runtime-name : "helloworld.war")</pre><h4><a id="undeploy_an_application_6"/>Undeploy an Application</h4><p>
					From the <code class="literal">helloworld</code> quickstart directory, execute the following Maven command.
				</p><pre class="screen">$ mvn wildfly:undeploy</pre><p>
					After issuing the Maven command to undeploy, the terminal window shows the following output indicating a successful undeployment.
				</p><pre class="screen">[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1.750 s
[INFO] Finished at: 2016-09-02T14:45:10-04:00
[INFO] Final Memory: 10M/184M
[INFO] ------------------------------------------------------------------------</pre><p>
					The undeployment can also be confirmed by viewing the server log of the active server instance.
				</p><pre class="screen">WFLYUT0022: Unregistered web context: /helloworld
WFLYSRV0028: Stopped deployment helloworld.war (runtime-name: helloworld.war) in 106ms
WFLYSRV0009: Undeployed "helloworld.war" (runtime-name: "helloworld.war")</pre></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="deploying_apps_using_http_api"/>Deploying Applications Using the HTTP API</h1></div></div></div><p>
				Applications can be deployed to JBoss EAP using the HTTP API with the <code class="literal">curl</code> command. For more information on using the HTTP API, see the <a class="link" href="jboss_eap_management.html#http_api" title="HTTP API">HTTP API</a> section.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deploy_app_standalone_http_api"/>Deploy an Application to a Standalone Server Using the HTTP API</h2></div></div></div><p>
					By default, the HTTP API is accessible at <code class="literal">http://<span class="emphasis"><em>HOST</em></span>:<span class="emphasis"><em>PORT</em></span>/management</code>, for example, <code class="literal">http://localhost:9990/management</code>.
				</p><h4><a id="deploy_an_application_7"/>Deploy an Application</h4><pre class="screen">$ curl --digest -L -D - http://<span class="emphasis"><em>HOST</em></span>:<span class="emphasis"><em>PORT</em></span>/management --header "Content-Type: application/json" -u <span class="emphasis"><em>USER</em></span>:<span class="emphasis"><em>PASSWORD</em></span> -d '{"operation" : "composite", "address" : [], "steps" : [{"operation" : "add", "address" : {"deployment" : "test-application.war"}, "content" : [{"url" : "file:/path/to/test-application.war"}]},{"operation" : "deploy", "address" : {"deployment" : "test-application.war"}}],"json.pretty":1}'</pre><h4><a id="undeploy_an_application_7"/>Undeploy an Application</h4><pre class="screen">$ curl --digest -L -D - http://<span class="emphasis"><em>HOST</em></span>:<span class="emphasis"><em>PORT</em></span>/management --header "Content-Type: application/json" -u <span class="emphasis"><em>USER</em></span>:<span class="emphasis"><em>PASSWORD</em></span> -d '{"operation" : "composite", "address" : [], "steps" : [{"operation" : "undeploy", "address" : {"deployment" : "test-application.war"}},{"operation" : "remove", "address" : {"deployment" : "test-application.war"}}],"json.pretty":1}'</pre><p>
					See this <a class="link" href="https://access.redhat.com/solutions/82463">Red Hat Knowledgebase article</a> to learn more about programmatically generating the JSON requests.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deploy_app_domain_http_api"/>Deploy an Application in a Managed Domain Using the HTTP API</h2></div></div></div><p>
					By default, the HTTP API is accessible at <code class="literal">http://<span class="emphasis"><em>HOST</em></span>:<span class="emphasis"><em>PORT</em></span>/management</code>, for example, <code class="literal">http://localhost:9990/management</code>.
				</p><h4><a id="deploy_an_application_8"/>Deploy an Application</h4><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
							Add the deployment to the content repository.
						</p><pre class="screen">$ curl --digest -L -D - http://<span class="emphasis"><em>HOST</em></span>:<span class="emphasis"><em>PORT</em></span>/management --header "Content-Type: application/json" -u <span class="emphasis"><em>USER</em></span>:<span class="emphasis"><em>PASSWORD</em></span> -d '{"operation" : "add", "address" : {"deployment" : "test-application.war"}, "content" : [{"url" : "file:<span class="emphasis"><em>/path/to</em></span>/test-application.war"}],"json.pretty":1}'</pre></li><li class="listitem"><p class="simpara">
							Add the deployment to the desired server group.
						</p><pre class="screen">$ curl --digest -L -D - http://<span class="emphasis"><em>HOST</em></span>:<span class="emphasis"><em>PORT</em></span>/management --header "Content-Type: application/json" -u <span class="emphasis"><em>USER</em></span>:<span class="emphasis"><em>PASSWORD</em></span> -d '{"operation" : "add", "address" : {"server-group" : "main-server-group","deployment":"test-application.war"},"json.pretty":1}'</pre></li><li class="listitem"><p class="simpara">
							Deploy the application to the server group.
						</p><pre class="screen">$ curl --digest -L -D - http://<span class="emphasis"><em>HOST</em></span>:<span class="emphasis"><em>PORT</em></span>/management --header "Content-Type: application/json" -u <span class="emphasis"><em>USER</em></span>:<span class="emphasis"><em>PASSWORD</em></span> -d '{"operation" : "deploy", "address" : {"server-group" : "main-server-group","deployment":"test-application.war"},"json.pretty":1}'</pre></li></ol></div><h4><a id="undeploy_an_application_8"/>Undeploy an Application</h4><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
							Remove the deployment from all server groups to which it is assigned.
						</p><pre class="screen">$ curl --digest -L -D - http://<span class="emphasis"><em>HOST</em></span>:<span class="emphasis"><em>PORT</em></span>/management --header "Content-Type: application/json" -u <span class="emphasis"><em>USER</em></span>:<span class="emphasis"><em>PASSWORD</em></span> -d '{"operation" : "remove", "address" : {"server-group" : "main-server-group","deployment":"test-application.war"},"json.pretty":1}'</pre></li><li class="listitem"><p class="simpara">
							Remove the deployment from the content repository.
						</p><pre class="screen">$ curl --digest -L -D - http://<span class="emphasis"><em>HOST</em></span>:<span class="emphasis"><em>PORT</em></span>/management --header "Content-Type: application/json" -u <span class="emphasis"><em>USER</em></span>:<span class="emphasis"><em>PASSWORD</em></span> -d '{"operation" : "remove", "address" : {"deployment" : "test-application.war"}, "json.pretty":1}'</pre></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="customizing_deploy_behavior"/>Customizing Deployment Behavior</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="define_custom_dir_deploy_content"/>Define a Custom Directory for Deployment Content</h2></div></div></div><p>
					You can define a custom location for JBoss EAP to store deployed content.
				</p><h4><a id="define_a_custom_directory_for_a_standalone_server"/>Define a Custom Directory for a Standalone Server</h4><p>
					By default, deployed content for a standalone server is stored in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/data/content</code> directory. This location can be changed by passing in the <code class="literal">-Djboss.server.deploy.dir</code> argument when starting the server.
				</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/standalone.sh -Djboss.server.deploy.dir=<span class="emphasis"><em>/path/to</em></span>/new_deployed_content</pre><p>
					The chosen location should be unique among JBoss EAP instances.
				</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						The <code class="literal">jboss.server.deploy.dir</code> property specifies the directory to be used for storing content that has been deployed using the management console or management CLI. To define a custom deployment directory to be monitored by the deployment scanner, see <a class="link" href="deploying_applications.html#configure_deploy_scanner" title="Configure the Deployment Scanner">Configure the Deployment Scanner</a>.
					</p></div><h4><a id="define_a_custom_directory_for_a_managed_domain"/>Define a Custom Directory for a Managed Domain</h4><p>
					By default, deployed content for a managed domain is stored in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/domain/data/content</code> directory. This location can be changed by passing in the <code class="literal">-Djboss.domain.deployment.dir</code> argument when starting the domain.
				</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/domain.sh -Djboss.domain.deployment.dir=<span class="emphasis"><em>/path/to</em></span>/new_deployed_content</pre><p>
					The chosen location should be unique among JBoss EAP instances.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="control_order_deployments"/>Control the Order of Deployments</h2></div></div></div><p>
					JBoss EAP offers fine-grained control over the order of deployments when the server is started. Strict order of the deployment of applications present in multiple EAR files can be specified along with persistence of the order after a restart.
				</p><p>
					You can use the <code class="literal">jboss-all.xml</code> deployment descriptor to declare dependencies between top-level deployments.
				</p><p>
					For example, if you have an <code class="literal">app.ear</code> that depends on <code class="literal">framework.ear</code> being deployed first, then you can create an <code class="literal">app.ear/META-INF/jboss-all.xml</code> file as shown below.
				</p><pre class="programlisting">&lt;jboss xmlns="urn:jboss:1.0"&gt;
  &lt;jboss-deployment-dependencies xmlns="urn:jboss:deployment-dependencies:1.0"&gt;
    &lt;dependency name="framework.ear" /&gt;
  &lt;/jboss-deployment-dependencies&gt;
&lt;/jboss&gt;</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						You can use the deployment’s runtime name as the dependency name in the <code class="literal">jboss-all.xml</code> file.
					</p></div><p>
					This ensures that <code class="literal">framework.ear</code> is deployed before <code class="literal">app.ear</code>.
				</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
						Although the <code class="literal">jboss-all.xml</code> file and other deployment descriptors allow you to declare dependencies that the server does not otherwise detect, it is not a strict ordering feature. JBoss EAP assumes that all dependencies specified in the deployment descriptor have already been deployed or are available. If there are missing dependencies, JBoss EAP does not automatically deploy them, and the deployment fails.
					</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="override_deployment_content"/>Override Deployment Content</h2></div></div></div><p>
					A <span class="emphasis"><em>deployment overlay</em></span> can be used to overlay content into an existing deployment without physically modifying the contents of the deployment archive. It allows you to override deployment descriptors, library JAR files, classes, JSP pages, and other files at runtime without rebuilding the archive.
				</p><p>
					This can be useful if you need to adapt a deployment for different environments that need different configurations or settings. For example, when moving a deployment through the application lifecycle from development, to testing, to stage, and finally into production, you might want to swap deployment descriptors, modify static web resources to change the branding of the application, or even replace JAR libraries with different versions depending on the target environment. It is also a useful feature for installations that need to change a configuration but can not modify or crack an archive due to policy or security restrictions.
				</p><p>
					When defining a deployment overlay, you specify the file on a file system that will replace the file in the deployment archive. You must also specify which deployments should be affected by the deployment overlay. Any affected deployments must be redeployed in order for the changes to take effect.
				</p><p>
					Use the <code class="literal">deployment-overlay add</code> management CLI command to add a deployment overlay.
				</p><pre class="screen">deployment-overlay add --name=new-deployment-overlay --content=WEB-INF/web.xml=<span class="emphasis"><em>/path/to</em></span>/other/web.xml --deployments=test-application.war --redeploy-affected</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						In a managed domain, specify the applicable server groups by using <code class="literal">--server-groups</code> or specify all server groups with <code class="literal">--all-server-groups</code>.
					</p></div><p>
					Once created, you can add content to an existing overlay, link the overlay to a deployment, or remove the overlay. For full usage details, execute <code class="literal">deployment-overlay --help</code>.
				</p><div class="variablelist"><p class="title"><strong>Parameters</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">name</code></span></dt><dd>
								The name of the deployment overlay.
							</dd><dt><span class="term"><code class="literal">content</code></span></dt><dd>
								Comma-separated list that maps the file on the file system to the file in the archive that it will replace. The format for each entry is <code class="literal"><span class="emphasis"><em>ARCHIVE_PATH</em></span>=<span class="emphasis"><em>FILESYSTEM_PATH</em></span></code>.
							</dd><dt><span class="term"><code class="literal">deployments</code></span></dt><dd>
								Comma-separated list of deployments to which this overlay will be linked.
							</dd><dt><span class="term"><code class="literal">redeploy-affected</code></span></dt><dd>
								Redeploys all affected deployments.
							</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="rollout_plans"/>Using Rollout Plans</h2></div></div></div><h4><a id="about_rollout_plans"/>About Rollout Plans</h4><p>
					In a managed domain, operations targeted at domain or host level resources can potentially impact multiple servers. Such operations can include a roll out plan detailing the sequence in which the operation would be applied to the servers, as well as the policies for detailing whether the operation could be reverted if it fails to execute successfully on some servers. If no rollout plan is specified, the <a class="link" href="deploying_applications.html#default_rollout_plan" title="Default Rollout Plan">default rollout plan</a> is used.
				</p><p>
					Below is an example rollout plan involving five server groups. Operations can be applied to server groups serially, <code class="literal">in-series</code>, or concurrently, <code class="literal">concurrent-groups</code>. The syntax is described in more detail in <a class="link" href="deploying_applications.html#rollout_plan_syntax" title="Rollout Plan Syntax">Rollout Plan Syntax</a>.
				</p><pre class="screen">{"my-rollout-plan" =&gt; {"rollout-plan" =&gt; {
    "in-series" =&gt; [
        {"concurrent-groups" =&gt; {
            "group-A" =&gt; {
                "max-failure-percentage" =&gt; "20",
                "rolling-to-servers" =&gt; "true"
            },
            "group-B" =&gt; undefined
        }},
        {"server-group" =&gt; {"group-C" =&gt; {
            "rolling-to-servers" =&gt; "false",
            "max-failed-servers" =&gt; "1"
        }}},
        {"concurrent-groups" =&gt; {
            "group-D" =&gt; {
                "max-failure-percentage" =&gt; "20",
                "rolling-to-servers" =&gt; "true"
            },
            "group-E" =&gt; undefined
        }}
    ],
    "rollback-across-groups" =&gt; "true"
}}}</pre><p>
					Looking at the example above, applying the operation to the servers in the domain is done in three phases. If the policy for any server group triggers a rollback of the operation across the server group, all other server groups will be rolled back as well.
				</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
							Server groups <span class="emphasis"><em>group-A</em></span> and <span class="emphasis"><em>group-B</em></span> will have the operation applied concurrently. The operation will be applied to the servers in <span class="emphasis"><em>group-A</em></span> in series, while all servers in <span class="emphasis"><em>group-B</em></span> will handle the operation concurrently. If more than 20% of the servers in <span class="emphasis"><em>group-A</em></span> fail to apply the operation, it will be rolled back across that group. If any servers in <span class="emphasis"><em>group-B</em></span> fail to apply the operation it will be rolled back across that group.
						</li><li class="listitem">
							Once all servers in <span class="emphasis"><em>group-A</em></span> and <span class="emphasis"><em>group-B</em></span> are complete, the operation will be applied to the servers in <span class="emphasis"><em>group-C</em></span>. Those servers will handle the operation concurrently. If more than one server in <span class="emphasis"><em>group-C</em></span> fails to apply the operation it will be rolled back across that group.
						</li><li class="listitem">
							Once all servers in <span class="emphasis"><em>group-C</em></span> are complete, server groups <span class="emphasis"><em>group-D</em></span> and <span class="emphasis"><em>group-E</em></span> will have the operation applied concurrently. The operation will be applied to the servers in <span class="emphasis"><em>group-D</em></span> in series, while all servers in <span class="emphasis"><em>group-E</em></span> will handle the operation concurrently. If more than 20% of the servers in <span class="emphasis"><em>group-D</em></span> fail to apply the operation, it will be rolled back across that group. If any servers in <span class="emphasis"><em>group-E</em></span> fail to apply the operation it will be rolled back across that group.
						</li></ol></div><h4><a id="rollout_plan_syntax"/>Rollout Plan Syntax</h4><p>
					You can specify a rollout plan in either of the following ways.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							By defining the rollout plan in the <code class="literal">deploy</code> command operation headers. See <a class="link" href="deploying_applications.html#deploy_rollout_plan" title="Deploy Using a Rollout Plan">Deploy Using a Rollout Plan</a> for details.
						</li><li class="listitem">
							By storing the rollout plan using the <code class="literal">rollout-plan</code> command and then referencing the plan name in the <code class="literal">deploy</code> command operation headers. See <a class="link" href="deploying_applications.html#deploy_stored_rollout_plan" title="Deploy Using a Stored Rollout Plan">Deploy Using a Stored Rollout Plan</a> for details.
						</li></ul></div><p>
					Although each method has a different initial command, both methods use the <code class="literal">rollout</code> operation header to define the rollout plan. This uses the following syntax.
				</p><pre class="screen">rollout (id=<span class="emphasis"><em>PLAN_NAME</em></span> | <span class="emphasis"><em>SERVER_GROUP_LIST</em></span>) [rollback-across-groups]</pre><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<code class="literal"><span class="emphasis"><em>PLAN_NAME</em></span></code> is the name for the rollout plan that was stored using the <code class="literal">rollout-plan</code> command.
						</li><li class="listitem"><p class="simpara">
							<code class="literal"><span class="emphasis"><em>SERVER_GROUP_LIST</em></span></code> is the list of server groups. Use a comma (<code class="literal">,</code>) to separate multiple server groups to indicate that that operations should be performed on each server group sequentially. Use a caret (<code class="literal">^</code>) separator to indicate that operations should be performed on each server group concurrently.
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
									For each server group, set any of the following policies in parentheses. Use a comma to separate multiple policies.
								</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
											<code class="literal">rolling-to-servers</code>: A boolean that, if set to <code class="literal">true</code>, applies the operation to each server in the group in series. If the value is <code class="literal">false</code> or not specified, the operation will be applied to the servers in the group concurrently.
										</li><li class="listitem">
											<code class="literal">max-failed-servers</code>: An integer which takes the maximum number of servers in the group that can fail to apply the operation before it should be reverted on all servers in the group. The default value if not specified is <code class="literal">0</code>, meaning that a failure on any server will trigger rollback across the group.
										</li><li class="listitem"><p class="simpara">
											<code class="literal">max-failure-percentage</code>: An integer between <code class="literal">0</code> and <code class="literal">100</code> that represents the maximum percentage of the total number of servers in the group that can fail to apply the operation before it should be reverted on all servers in the group. The default value if not specified is <code class="literal">0</code>, meaning that a failure on any server will trigger rollback across the group.
										</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
												If both <code class="literal">max-failed-servers</code> and <code class="literal">max-failure-percentage</code> are set to non-zero values, <code class="literal">max-failure-percentage</code> takes precedence.
											</p></div></li></ul></div></li></ul></div></li><li class="listitem">
							<code class="literal">rollback-across-groups</code>: A boolean that indicates whether the need to rollback the operation on all the servers in one server group triggers a rollback across all the server groups. This defaults to <code class="literal">false</code>.
						</li></ul></div><h4><a id="deploy_rollout_plan"/>Deploy Using a Rollout Plan</h4><p>
					You can provide the full details of a rollout plan directly to the <code class="literal">deploy</code> command by passing the <code class="literal">rollout</code> settings into the <code class="literal">headers</code> argument. See the <a class="link" href="deploying_applications.html#rollout_plan_syntax" title="Rollout Plan Syntax">Rollout Plan Syntax</a> for more information on the format.
				</p><p>
					The following management CLI command deploys an application to the <code class="literal">main-server-group</code> server group using a deployment plan that specifies <code class="literal">rolling-to-servers=true</code> for serial deployment.
				</p><pre class="screen">deploy <span class="emphasis"><em>/path/to</em></span>/test-application.war --server-groups=main-server-group --headers={rollout main-server-group(rolling-to-servers=true)}</pre><h4><a id="deploy_stored_rollout_plan"/>Deploy Using a Stored Rollout Plan</h4><p>
					Since rollout plans can be complex, you have the option to store the details of a rollout plan. This allows you to reference the rollout plan name when you want to use it instead of requiring the full details of the rollout plan each time.
				</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
							Use the <code class="literal">rollout-plan</code> management CLI command to store a rollout plan. See the <a class="link" href="deploying_applications.html#rollout_plan_syntax" title="Rollout Plan Syntax">Rollout Plan Syntax</a> for more information on the format.
						</p><pre class="screen">rollout-plan add --name=my-rollout-plan --content={rollout main-server-group(rolling-to-servers=false,max-failed-servers=1),other-server-group(rolling-to-servers=true,max-failure-percentage=20) rollback-across-groups=true}</pre><p class="simpara">
							This creates the following deployment plan.
						</p><pre class="screen">"rollout-plan" =&gt; {
    "in-series" =&gt; [
        {"server-group" =&gt; {"main-server-group" =&gt; {
            "rolling-to-servers" =&gt; false,
            "max-failed-servers" =&gt; 1
        }}},
        {"server-group" =&gt; {"other-server-group" =&gt; {
            "rolling-to-servers" =&gt; true,
            "max-failure-percentage" =&gt; 20
        }}}
    ],
    "rollback-across-groups" =&gt; true
}</pre></li><li class="listitem"><p class="simpara">
							Specify the stored rollout plan name when deploying the application.
						</p><p class="simpara">
							The following management CLI command deploys an application to all server groups using the <code class="literal">my-rollout-plan</code> stored rollout plan.
						</p><pre class="screen">deploy <span class="emphasis"><em>/path/to</em></span>/test-application.war --all-server-groups --headers={rollout id=my-rollout-plan}</pre></li></ol></div><h4><a id="remove_stored_rollout_plan"/>Remove a Stored Rollout Plan</h4><p>
					You can remove a stored rollout plan using the <code class="literal">rollout-plan</code> management CLI command by specifying the name of the rollout plan to remove.
				</p><pre class="screen">rollout-plan remove --name=my-rollout-plan</pre><h4><a id="default_rollout_plan"/>Default Rollout Plan</h4><p>
					All operations that impact multiple servers will be executed with a rollout plan. If no rollout plan is specified in the operation request, a default rollout plan will be generated. The plan will have the following characteristics.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							There will only be a single high-level phase. All server groups affected by the operation will have the operation applied concurrently.
						</li><li class="listitem">
							Within each server group, the operation will be applied to all servers concurrently.
						</li><li class="listitem">
							Failure on any server in a server group will cause rollback across the group.
						</li><li class="listitem">
							Failure of any server group will result in rollback of all other server groups.
						</li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="managing_exploded_deployments"/>Managing Exploded Deployments</h1></div></div></div><p>
				Prior to JBoss EAP 7.1, you could only manage exploded deployments by manipulating files on the file system. Starting with JBoss EAP 7.1, you can manage exploded deployments using the management interfaces. This allows you to change the contents of an exploded application without deploying a new version of the application.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					Updates to static files in a deployment, such as JavaScript and CSS files, take effect immediately. Changes to other files, such as Java classes, might require an application redeployment for the changes to take effect.
				</p></div><p>
				You can either start with an <a class="link" href="deploying_applications.html#create_empty_deployment" title="Create an Empty Exploded Deployment">empty deployment</a> or <a class="link" href="deploying_applications.html#explode_archive_deployment" title="Explode an Existing Archive Deployment">explode an existing archive deployment</a> and then <a class="link" href="deploying_applications.html#add_remove_content_deployment" title="Add Content to an Exploded Deployment">add or remove content</a>.
			</p><p>
				See <a class="link" href="deploying_applications.html#viewing_deployment_content" title="Viewing Deployment Content">Viewing Deployment Content</a> to browse the files in a deployment or read the contents of the files.
			</p><h3><a id="create_empty_deployment"/>Create an Empty Exploded Deployment</h3><p>
				You can create an empty exploded deployment to which you can later add content as necessary. Use the following management CLI command to create an empty exploded deployment.
			</p><pre class="screen">/deployment=<span class="emphasis"><em>DEPLOYMENT_NAME</em></span>.war:add(content=[{empty=true}])</pre><p>
				The <code class="literal">empty=true</code> option is required to confirm that you intended to create an empty deployment.
			</p><h3><a id="explode_archive_deployment"/>Explode an Existing Archive Deployment</h3><p>
				You can explode an existing archive deployment to be able to update its contents. Note that a <a class="link" href="deploying_applications.html#disable_app_standalone_cli" title="Disable an Application">deployment must be disabled</a> before it can be exploded. Use the following management CLI command to explode a deployment.
			</p><pre class="screen">/deployment=<span class="emphasis"><em>ARCHIVE_DEPLOYMENT_NAME</em></span>.ear:explode</pre><p>
				You can now <a class="link" href="deploying_applications.html#add_remove_content_deployment" title="Add Content to an Exploded Deployment">add or remove content</a> from this deployment.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					You can also explode an existing archive deployment from the management console. From the <span class="strong"><strong>Deployments</strong></span> tab, select the deployment and select the <span class="strong"><strong>Explode</strong></span> drop down option.
				</p></div><h3><a id="add_remove_content_deployment"/>Add Content to an Exploded Deployment</h3><p>
				To add content to a deployment, use the <code class="literal">add-content</code> management CLI operation. Provide the path to the location in the deployment where the content should be added, and provide the content to be uploaded. The content to upload can be provided as a local file stream, URL, hash of content that already exists in the JBoss EAP content repository, or a byte array of the content. The following management CLI command uses the <code class="literal">input-stream-index</code> option to upload the contents of a local file to the deployment.
			</p><pre class="screen">/deployment=<span class="emphasis"><em>DEPLOYMENT_NAME</em></span>.war:add-content(content=[{target-path=<span class="emphasis"><em>/path/to/FILE_IN_DEPLOYMENT</em></span>, input-stream-index=<span class="emphasis"><em>/path/to/LOCAL_FILE_TO_UPLOAD</em></span>}]</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					When adding content to a deployment using the <code class="literal">add-content</code> operation, content in the deployment is overwritten by default. You can change this behavior by setting the <code class="literal">overwrite</code> option to <code class="literal">false</code>.
				</p></div><h3><a id="remove_content_from_an_exploded_deployment"/>Remove Content from an Exploded Deployment</h3><p>
				To remove content from a deployment, use the <code class="literal">remove-content</code> management CLI operation and provide the path of the content in the deployment to remove.
			</p><pre class="screen">/deployment=<span class="emphasis"><em>DEPLOYMENT_NAME</em></span>.war:remove-content(paths=[<span class="emphasis"><em>/path/to/FILE_1</em></span>, <span class="emphasis"><em>/path/to/FILE_2</em></span>])</pre></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="viewing_deployment_content"/>Viewing Deployment Content</h1></div></div></div><p>
				You can <a class="link" href="deploying_applications.html#browse_deployment_content" title="Browse Files in a Deployment">browse information</a> about files in a managed deployment and <a class="link" href="deploying_applications.html#read_deployment_content" title="Read Deployment Content">read the contents</a> of the files using the JBoss EAP management interfaces.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="browse_deployment_content"/>Browse Files in a Deployment</h2></div></div></div><p>
					Use the <code class="literal">browse-content</code> operation to view the files and directories in a managed deployment. Provide no arguments to return the entire deployment structure or use the <code class="literal">path</code> argument to provide the path to a specific directory.
				</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						You can also browse contents of a deployment from the management console by navigating to the <span class="strong"><strong>Deployments</strong></span> tab, selecting the deployment, and selecting <span class="strong"><strong>View</strong></span> from the drop down.
					</p></div><pre class="screen">/deployment=helloworld.war:browse-content(path=META-INF/)</pre><p>
					This displays the files and directories in the <code class="literal">META-INF/</code> directory of the <code class="literal">helloworld.war</code> deployment.
				</p><pre class="screen">{
    "outcome" =&gt; "success",
    "result" =&gt; [
        {
            "path" =&gt; "MANIFEST.MF",
            "directory" =&gt; false,
            "file-size" =&gt; 827L
        },
        {
            "path" =&gt; "maven/org.jboss.eap.quickstarts/helloworld/pom.properties",
            "directory" =&gt; false,
            "file-size" =&gt; 106L
        },
        {
            "path" =&gt; "maven/org.jboss.eap.quickstarts/helloworld/pom.xml",
            "directory" =&gt; false,
            "file-size" =&gt; 2713L
        },
        {
            "path" =&gt; "maven/org.jboss.eap.quickstarts/helloworld/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "maven/org.jboss.eap.quickstarts/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "maven/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "INDEX.LIST",
            "directory" =&gt; false,
            "file-size" =&gt; 251L
        }
    ]
}</pre><p>
					You can also specify the following arguments to the <code class="literal">browse-content</code> operation.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">archive</span></dt><dd>
								Whether to only return archive files.
							</dd><dt><span class="term">depth</span></dt><dd>
								Specify the depth of files to return.
							</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="read_deployment_content"/>Read Deployment Content</h2></div></div></div><p>
					You can read the contents of a file in a managed deployment using the <code class="literal">read-content</code> operation. Provide no arguments to return the entire deployment or use the <code class="literal">path</code> argument to provide the path to a specific file. For example:
				</p><pre class="screen">/deployment=helloworld.war:read-content(path=META-INF/MANIFEST.MF)</pre><p>
					This returns a file stream, which can be <a class="link" href="deploying_applications.html#display_contents_file_stream" title="Display the Contents of a File">displayed in the management CLI</a> or <a class="link" href="deploying_applications.html#save_contents_file_stream" title="Save the Contents of a File">saved to the file system</a>.
				</p><pre class="screen">{
    "outcome" =&gt; "success",
    "result" =&gt; {"uuid" =&gt; "24ba8e06-21bd-4505-b4d4-bdfb16451b95"},
    "response-headers" =&gt; {"attached-streams" =&gt; [{
        "uuid" =&gt; "24ba8e06-21bd-4505-b4d4-bdfb16451b95",
        "mime-type" =&gt; "text/plain"
    }]}
}</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="display_contents_file_stream"/>Display the Contents of a File</h3></div></div></div><p>
						Use the <code class="literal">attachment display</code> command to read the contents of the <code class="literal">MANIFEST.MF</code> file.
					</p><pre class="screen">attachment display --operation=/deployment=helloworld.war:read-content(path=META-INF/MANIFEST.MF)</pre><p>
						This displays the contents of the <code class="literal">MANIFEST.MF</code> file from the <code class="literal">helloworld.war</code> deployment to the management CLI.
					</p><pre class="screen">ATTACHMENT 8af87836-2abd-423a-8e44-e731cc57bd80:
Manifest-Version: 1.0
Implementation-Title: Quickstart: helloworld
Implementation-Version: 7.2.0.GA
Java-Version: 1.8.0_131
Built-By: username
Scm-Connection: scm:git:git@github.com:jboss/jboss-parent-pom.git/quic
 kstart-parent/helloworld
Specification-Vendor: JBoss by Red Hat
...</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="save_contents_file_stream"/>Save the Contents of a File</h3></div></div></div><p>
						Use the <code class="literal">attachment save</code> command to save the contents of the <code class="literal">MANIFEST.MF</code> file to the file system.
					</p><pre class="screen">attachment save --operation=/deployment=helloworld.war:read-content(path=META-INF/MANIFEST.MF) --file=<span class="emphasis"><em>/path/to</em></span>/MANIFEST.MF</pre><p>
						This saves the <code class="literal">MANIFEST.MF</code> file from the <code class="literal">helloworld.war</code> deployment to the file system at <code class="literal"><span class="emphasis"><em>path/to</em></span>/MANIFEST.MF</code>. If you do not specify a file path using the <code class="literal">--file</code> argument, the file will be named using its unique attachment ID and saved in the working directory of the management CLI, which by default is <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin/</code>.
					</p></div></div></div></div></body></html>