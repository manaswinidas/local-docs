<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 10. Security Mapping Modules</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="security_mapping_modules"/>Chapter 10. Security Mapping Modules</h1></div></div></div><p>
			The following security mapping modules are provided in JBoss EAP.
		</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Class</th><th style="text-align: left" valign="top">Code</th><th style="text-align: left" valign="top">Type</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.role.PropertiesRolesMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							PropertiesRoles
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							role
						</p>
						 </td></tr><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.role.SimpleRolesMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							SimpleRoles
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							role
						</p>
						 </td></tr><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.DeploymentRolesMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							DeploymentRoles
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							role
						</p>
						 </td></tr><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.role.DatabaseRolesMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							DatabaseRoles
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							role
						</p>
						 </td></tr><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.role.LdapRolesMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							LdapRoles
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							role
						</p>
						 </td></tr><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.attribute.LdapAttributeMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							LdapAttributes
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							attribute
						</p>
						 </td></tr><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.DeploymentRoleToRolesMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
							role
						</p>
						 </td></tr><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.attribute.DefaultAttributeMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
							attribute
						</p>
						 </td></tr></tbody></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
				The mapping module functionality is only invoked for role type mapping modules. To invoke other mapping module types, the mapping functionality needs to be invoked in the application or in a custom login module.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="propertiesrolesmappingprovider"/>PropertiesRolesMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Code</strong></span>: PropertiesRoles
			</p><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.role.PropertiesRolesMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: role
			</p><p>
				A MappingProvider that reads roles from a properties file in the following format: <code class="literal">username=role1,role2,…​</code>
			</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/><col class="col_4"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Default</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								rolesProperties
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								roles.properties
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Properties formatted file name. Expansion of JBoss EAP variables can be used in form of <code class="literal">${jboss.variable}</code>.
							</p>
							 </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="simplerolesmappingprovider"/>SimpleRolesMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Code</strong></span>: SimpleRoles
			</p><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.role.SimpleRolesMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: role
			</p><p>
				A simple <code class="literal">MappingProvider</code> that reads roles from the options map. The option attribute name is the name of principal to assign roles to and the attribute value is the comma-separated role names to assign to the principal. ⁠
			</p><div class="title"><strong>Example</strong></div><p>
					
</p><pre class="programlisting">&lt;module-option name="JavaDuke" value="JBossAdmin,Admin"/&gt;
&lt;module-option name="joe" value="Users"/&gt;</pre><p>

				</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="deploymentrolesmappingprovider"/>DeploymentRolesMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Code</strong></span>: DeploymentRoles
			</p><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.DeploymentRolesMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: role
			</p><p>
				A Role Mapping Module that takes into consideration a principal to roles mapping that can be done in <code class="literal">jboss-web.xml</code> and <code class="literal">jboss-app.xml</code> deployment descriptors.
			</p><div class="title"><strong>Example</strong></div><p>
					
</p><pre class="programlisting">&lt;jboss-web&gt;
...
​  &lt;security-role&gt;
​      &lt;role-name&gt;Support&lt;/role-name&gt;
​      &lt;principal-name&gt;Mark&lt;/principal-name&gt;
​      &lt;principal-name&gt;Tom&lt;/principal-name&gt;
​  &lt;/security-role&gt;
...
&lt;/jboss-web&gt;</pre><p>

				</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="databaserolesmappingprovider"/>DatabaseRolesMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Code</strong></span>: DatabaseRoles
			</p><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.role.DatabaseRolesMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: role
			</p><p>
				A <code class="literal">MappingProvider</code> that reads roles from a database.
			</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/><col class="col_4"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Default</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								dsJndiName
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
								JNDI name of data source used to map roles to the user.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								rolesQuery
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
								This option should be a prepared statement equivalent to <code class="literal">select RoleName from Roles where User=?</code>. <code class="literal">?</code> is substituted with current principal name.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								suspendResume
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								boolean
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								true
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								If <code class="literal">true</code>, will suspend and later resume transaction associated with current thread while performing search for roles.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								transactionManagerJndiName
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								java:/TransactionManager
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								JNDI name of transaction manager.
							</p>
							 </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ldaprolesmappingprovider"/>LdapRolesMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Code</strong></span>: LdapRoles
			</p><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.role.LdapRolesMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: role
			</p><p>
				A mapping provider that assigns roles to a user using an LDAP server to search for the roles.
			</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/><col class="col_4"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Default</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								bindDN
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
								The DN used to bind against the LDAP server for the user and roles queries. This DN needs read and search permissions on the <code class="literal">baseCtxDN</code> and <code class="literal">rolesCtxDN</code> values.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								bindCredential
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
								The password for the <code class="literal">bindDN</code>. This can be encrypted via the vault mechanism.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								rolesCtxDN
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
								The fixed DN of the context to search for user roles. This is not the DN where the actual roles are, but the DN where the objects containing the user roles are. For example, in a Microsoft Active Directory server, this is the DN where the user account is.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								roleAttributeID
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								role
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The LDAP attribute which contains the names of authorization roles.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								roleAttributeIsDN
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								boolean
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								false
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Whether or not the <code class="literal">roleAttributeID</code> contains the fully qualified DN of a role object. If <code class="literal">false</code>, the role name is taken from the value of the <code class="literal">roleNameAttributeId</code> attribute of the context name. Certain directory schemas, such as Microsoft Active Directory, require this attribute to be set to <code class="literal">true</code>.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								roleNameAttributeID
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								name
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Name of the attribute within the <code class="literal">roleCtxDN</code> context which contains the role name. If the <code class="literal">roleAttributeIsDN</code> property is set to <code class="literal">true</code>, this property is used to find the role object’s name attribute.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								parseRoleNameFromDN
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								boolean
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								false
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A flag indicating if the DN returned by a query contains the <code class="literal">roleNameAttributeID</code>. If set to <code class="literal">true</code>, the DN is checked for the <code class="literal">roleNameATtributeID</code>. If set to <code class="literal">false</code>, the DN is not checked for the <code class="literal">roleNameAttributeID</code>. This flag can improve the performance of LDAP queries.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								roleFilter
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
								A search filter used to locate the roles associated with the authenticated user. The input <code class="literal">username</code> or <code class="literal">userDN</code> obtained from the login module callback is substituted into the filter anywhere a <code class="literal">{0}</code> expression is used. An example search filter that matches on the input <code class="literal">username</code> is <code class="literal">(member={0})</code>.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								roleRecursion
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								number
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								0
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The numbers of levels of recursion the role search will go below a matching context. Disable recursion by setting this to 0.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								searchTimeLimit
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								number
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								10000
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The timeout in milliseconds for the user/role searches.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								searchScope
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								SUBTREE_SCOPE
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The search scope to use.
							</p>
							 </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ldapattributemappingprovider"/>LdapAttributeMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Code</strong></span>: LdapAttributes
			</p><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.attribute.LdapAttributeMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: attribute
			</p><p>
				Maps attributes from LDAP to the subject. The options include whatever options your LDAP JNDI provider supports. ⁠
			</p><div class="title"><strong>Examples of Standard Property Names</strong></div><p>
					
</p><pre class="programlisting">Context.INITIAL_CONTEXT_FACTORY = "java.naming.factory.initial"
Context.SECURITY_PROTOCOL = "java.naming.security.protocol"
Context.PROVIDER_URL = "java.naming.provider.url"
Context.SECURITY_AUTHENTICATION = "java.naming.security.authentication"</pre><p>

				</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/><col class="col_4"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Default</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								bindDN
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
								The DN used to bind against the LDAP server for the user and roles queries. This DN needs read and search permissions on the <code class="literal">baseCtxDN</code> and <code class="literal">rolesCtxDN</code> values.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								bindCredential
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
								The password for the bindDN. This can be encrypted if the <code class="literal">jaasSecurityDomain</code> is specified.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								baseCtxDN
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
								The fixed DN of the context to start the user search from.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								baseFilter
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
								A search filter used to locate the context of the user to authenticate. The input <code class="literal">username</code> or <code class="literal">userDN</code> as obtained from the login module callback is substituted into the filter anywhere a <code class="literal">{0}</code> expression is used. This substitution behavior comes from the standard <code class="literal"><span class="emphasis"><em>DirContext.search(Name, String, Object[], SearchControls cons)</em></span></code> method. A common example search filter is <code class="literal">(uid={0})</code>.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								searchTimeLimit
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								number
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								10000
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The timeout in milliseconds for the user/role searches.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								attributeList
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
								A comma-separated list of attributes for the user. For example, <code class="literal">mail,cn,sn,employeeType,employeeNumber</code>.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jaasSecurityDomain
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
								The <code class="literal">JaasSecurityDomain</code> to use to decrypt the <code class="literal">java.naming.security.credentials</code>. The encrypted form of the password is that returned by the <code class="literal">JaasSecurityDomain#decode64(String)</code> method. The <code class="literal">org.jboss.security.plugins.PBEUtils</code> can also be used to generate the encrypted form.
							</p>
							 </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="deploymentroletorolesmappingprovider"/>DeploymentRoleToRolesMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.DeploymentRoleToRolesMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: role
			</p><p>
				A Role to Roles Mapping Module that takes into consideration a role to roles mapping. This can be defined in the deployment descriptors <code class="literal">jboss-web.xml</code> and <code class="literal">jboss-app.xml</code>. In this case, all the <code class="literal">principal-name</code> elements denote the roles that will replace the given role in <code class="literal">role-name</code>. ⁠
			</p><div class="title"><strong>Example</strong></div><p>
					
</p><pre class="programlisting">&lt;jboss-web&gt;
...
​    &lt;security-role&gt;
​      &lt;role-name&gt;Employee&lt;/role-name&gt;
​      &lt;principal-name&gt;Support&lt;/principal-name&gt;
​      &lt;principal-name&gt;Sales&lt;/principal-name&gt;
    &lt;/security-role&gt;
...
&lt;/jboss-web&gt;</pre><p>

				</p><p>
				In the above example, each principal having the role <code class="literal">Employee</code> will have this role replaced with <code class="literal">Support</code> and <code class="literal">Sales</code>. If it is desired for the principal to retain the <code class="literal">Employee</code> role as well as gain the <code class="literal">Support</code> and <code class="literal">Sales</code> roles, <code class="literal">&lt;principal-name&gt;Employee&lt;/principal-name&gt;</code> should be added.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					This mapping provider does not have a code associated with it so the full class name must be in the <code class="literal">code</code> field when configuring.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="defaultattributemappingprovider"/>DefaultAttributeMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.attribute.DefaultAttributeMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: attribute
			</p><p>
				Checks module and locates principal name from mapping context to create attribute email address from module option named <code class="literal">principalName</code> + <code class="literal">.email</code> and maps it to the given principal.
			</p><div class="title"><strong>Example</strong></div><p>
					
</p><pre class="programlisting">&lt;module-option name="admin.email" value="jduke@redhat.com"/&gt;</pre><p>

				</p><p>
				In the above example, the attribute <code class="literal">email</code> with a value <code class="literal">jduke@redhat.com</code> is added for the principal <code class="literal">admin</code>.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					This mapping provider does not have a code associated with it so the full class name must be in the <code class="literal">code</code> field when configuring.
				</p></div><p>
				<br/><br/><br/><br/>
			</p><p>
				<span class="emphasis"><em><span class="right">Revised on 2019-05-02 08:54:48 UTC</span></em></span>
			</p></div></div></body></html>