<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 5. Certificate-Based Login Modules</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="certificate_based_login_modules"/>Chapter 5. Certificate-Based Login Modules</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="certificate_login_module"/>Certificate Login Module</h1></div></div></div><p>
				<span class="strong"><strong>Short name</strong></span>: Certificate
			</p><p>
				<span class="strong"><strong>Full name</strong></span>: org.jboss.security.auth.spi.BaseCertLoginModule
			</p><p>
				<span class="strong"><strong>Parent</strong></span>: <a class="link" href="abstract_login_modules.html#abstractserver_login_module" title="AbstractServer Login Module">AbstractServer Login Module</a>
			</p><p>
				Certificate login module authenticates users based on X509 certificates. A typical use case for this login module is <code class="literal">CLIENT-CERT</code> authentication in the web tier. This login module only performs authentication and must be combined with another login module capable of acquiring authorization roles to completely define access to a secured web or EJB components. Two subclasses of this login module, <code class="literal">CertRoles Login Module</code> and <code class="literal">DatabaseCert Login Module</code> extend the behavior to obtain the authorization roles from either a properties file or database.
			</p><div class="table"><a id="idm140089908173712"/><p class="title"><strong>Table 5.1. Certificate Login Module Options</strong></p><div class="table-contents"><table summary="Certificate Login Module Options" border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/><col class="col_4"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Default</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								securityDomain
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								other
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Name of the security domain that has the JSSE configuration for the truststore holding the trusted certificates.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								verifier
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								class
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								none
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The class name of the <code class="literal">org.jboss.security.auth.certs.X509CertificateVerifier</code> to use for verification of the login certificate.
							</p>
							 </td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="certificateroles_login_module"/>CertificateRoles Login Module</h1></div></div></div><p>
				<span class="strong"><strong>Short name</strong></span>: CertificateRoles
			</p><p>
				<span class="strong"><strong>Full name</strong></span>: org.jboss.security.auth.spi.CertRolesLoginModule
			</p><p>
				<span class="strong"><strong>Parent</strong></span>: <a class="link" href="certificate_based_login_modules.html#certificate_login_module" title="Certificate Login Module">Certificate Login Module</a>
			</p><p>
				The <code class="literal">CertificateRoles</code> login module adds role mapping capabilities from a properties file using the following options:
			</p><div class="table"><a id="idm140089948443728"/><p class="title"><strong>Table 5.2. CertificateRoles Login Module Options</strong></p><div class="table-contents"><table summary="CertificateRoles Login Module Options" border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/><col class="col_4"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Default</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								rolesProperties
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								roles.properties
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The name of the resource or file containing the roles to assign to each user. The role properties file must be in the format <code class="literal">username=role1,role2</code> where the user name is the DN of the certificate, escaping any equals and space characters. The following example is in the correct format: <code class="literal">CN\=unit-tests-client,\ OU\=Red\ Hat\ Inc.,\ O\=Red\ Hat\ Inc.,\ ST\=North\ Carolina,\ C\=US</code>
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								defaultRolesProperties
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								defaultRoles.properties
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Name of the resource or file to fall back to if the <code class="literal">rolesProperties</code> file cannot be found.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								roleGroupSeparator
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A single character.
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								. (a single period)
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Which character to use as the role group separator in the <code class="literal">rolesProperties</code> file.
							</p>
							 </td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="databasecertificate_login_module"/>DatabaseCertificate Login Module</h1></div></div></div><p>
				<span class="strong"><strong>Short name</strong></span>: DatabaseCertificate
			</p><p>
				<span class="strong"><strong>Full name</strong></span>: org.jboss.security.auth.spi.DatabaseCertLoginModule
			</p><p>
				<span class="strong"><strong>Parent</strong></span>: <a class="link" href="certificate_based_login_modules.html#certificate_login_module" title="Certificate Login Module">Certificate Login Module</a>
			</p><p>
				The <code class="literal">DatabaseCertificate</code> login module adds mapping capabilities from a database table through these additional options:
			</p><div class="table"><a id="idm140089935587488"/><p class="title"><strong>Table 5.3. DatabaseCertificate Login Module Options</strong></p><div class="table-contents"><table summary="DatabaseCertificate Login Module Options" border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/><col class="col_4"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Default</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								dsJndiName
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A JNDI resource
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								java:/DefaultDS
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The name of the JNDI resource storing the authentication information.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								rolesQuery
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								prepared SQL statement
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								select <code class="literal">Role</code>,<code class="literal">RoleGroup</code> from <code class="literal">Roles</code> where <code class="literal">PrincipalID=?</code>
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								SQL prepared statement to be executed in order to map roles. It should be an equivalent to the query 'select <code class="literal">Role</code>, <code class="literal">RoleGroup</code> from <code class="literal">Roles</code> where <code class="literal">PrincipalID</code>=?', where <code class="literal">Role</code> is the role name and the <code class="literal">RoleGroup</code> column value should always be either <code class="literal">Roles</code> with a capital <code class="literal">R</code> or <code class="literal">CallerPrincipal</code>.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								suspendResume
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								true or false
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								true
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Whether any existing JTA transaction should be suspended during database operations.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								transactionManagerJndiName
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								JNDI Resource
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								java:/TransactionManager
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The JNDI name of the transaction manager used by the login module.
							</p>
							 </td></tr></tbody></table></div></div></div></div></body></html>