<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 3. Upgrading JBoss EAP</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="upgrading-jboss-eap"/>Chapter 3. Upgrading JBoss EAP</h1></div></div></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
				This chapter describes how to upgrade from one JBoss EAP 7 minor release to another. For example, upgrading from JBoss EAP 7.0 to JBoss EAP 7.1.
			</p><p>
				If you are migrating from an earlier major release of JBoss EAP, for example from JBoss EAP 6 to JBoss EAP 7, see the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/migration_guide/"><span class="emphasis"><em>Migration Guide</em></span></a> instead.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="preparing_for_the_upgrade"/>Preparing for the Upgrade</h1></div></div></div><p>
				Before you upgrade JBoss EAP, you need to be aware of the following potential issues.
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						If you back up and restore your configuration files when upgrading to newer point releases, you could overwrite new configurations that are in the new release and prevent new features from being enabled automatically. The recommended approach is to compare the old configuration to the new configuration, and only reapply specific configurations you need to keep. This can be done manually, or by creating a script that can apply the changes consistently to multiple server configuration files.
					</li><li class="listitem">
						If you back up and restore an existing configuration for the upgrade, when the server restarts and updates the configuration files the updated configuration may no longer be compatible with the previous version.
					</li><li class="listitem">
						The upgrade may remove temporary folders. Any deployments stored in the <code class="literal">data/content/</code> directory must be backed up prior to the upgrade, and restored after it completes. Otherwise, the server will fail to start due to the missing content.
					</li><li class="listitem">
						Prior to applying the upgrade, handle any open transactions and delete the <code class="literal">data/tx-object-store/</code> transaction directory.
					</li><li class="listitem">
						The persistent timer data in <code class="literal">data/timer-service-data</code> must be checked to determine whether it will still be applicable after the upgrade. Before the upgrade, review the <code class="literal">deployment-*</code> files in that directory to determine which timers are still in use.
					</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="upgrading_a_zip_installer_installation"/>Upgrading a ZIP/Installer Installation</h1></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist"><li class="listitem">
						Ensure that the base operating system is up to date.
					</li><li class="listitem">
						Back up all configuration files, deployments, and user data.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/installation_guide/#downloading_zip_installation">Download the ZIP file</a> of the JBoss EAP version you want to upgrade to.
					</li></ul></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
					For a managed domain, the JBoss EAP domain controller should be upgraded first.
				</p><p>
					An upgraded JBoss EAP 7 domain controller can still manage other JBoss EAP 7 hosts in a managed domain, as long as the domain controller is running the same or more recent version than the rest of the domain.
				</p></div><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
						Move the downloaded ZIP file to the desired location. It is recommended that this is a different location than the existing JBoss EAP installation.
					</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
							If you want to install the upgraded version of JBoss EAP to the same directory as the existing installation, you will need to move the existing installation to a different location before proceeding. This is to prevent modified configuration files, deployments, and upgrades from being lost.
						</p></div></li><li class="listitem">
						Extract the ZIP archive. This installs a clean instance of the new JBoss EAP release.
					</li><li class="listitem"><p class="simpara">
						Copy the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/domain/</code> and <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/</code> directories from the previous installation over the new installation directories.
					</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
							New features in the new release, such as new subsystems, may not be activated if the configuration files are copied from an older JBoss EAP installation. To use these new features, you must compare and update the old configuration files with the configuration files from the new version.
						</p></div></li><li class="listitem"><p class="simpara">
						Review the changes made to the <code class="literal">bin</code> directory of the previous installation, and make the equivalent modifications to the new directory.
					</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
							Files in the <code class="literal">bin</code> directory should not be overwritten by the files from previous versions. Changes should be made manually.
						</p></div></li><li class="listitem"><p class="simpara">
						Review the remaining modified files from the previous installation, and move these changes into the new installation. These files may include:
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								The <code class="literal">welcome-content</code> directory.
							</li><li class="listitem">
								Custom modules in the <code class="literal">modules</code> directory.
							</li></ul></div></li><li class="listitem">
						<span class="strong"><strong>Optional:</strong></span> If JBoss EAP was previously configured to run as a service, remove the existing service and configure a new service for the upgraded installation.
					</li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="upgrading_an_rpm_installation"/>Upgrading an RPM Installation</h1></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist"><li class="listitem">
						Ensure that the base operating system is up to date, and is subscribed and enabled to get updates from the standard Red Hat Enterprise Linux repositories.
					</li><li class="listitem"><p class="simpara">
						Ensure that you are subscribed to the relevant JBoss EAP repository for the upgrade.
					</p><p class="simpara">
						If you are subscribed to a previous minor JBoss EAP repository, you will need to change to the latest minor repository to get the upgrade.
					</p><p class="simpara">
						For more information on JBoss EAP repositories, see the information on <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/installation_guide/#choosing_a_repository">choosing a JBoss EAP repository</a> and <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/installation_guide/#changing_repositories">changing JBoss EAP repositories</a> in the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/installation_guide/"><span class="emphasis"><em>Installation Guide</em></span></a>.
					</p></li><li class="listitem">
						Back up all configuration files, deployments, and user data.
					</li></ul></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
					For a managed domain, the JBoss EAP domain controller should be upgraded first.
				</p><p>
					An upgraded JBoss EAP 7 domain controller can still manage other JBoss EAP 7 hosts in a managed domain, as long as the domain controller is running the same or more recent version than the rest of the domain.
				</p></div><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
						After you have subscribed to the relevant JBoss EAP repository and the upgrade is available, run the following command to upgrade your JBoss EAP installation:
					</p><pre class="screen"># yum update</pre></li><li class="listitem"><p class="simpara">
						The RPM upgrade process will not replace any of your modified configuration files, and will instead create <code class="literal">.rpmnew</code> files for the default configuration of the new JBoss EAP version.
					</p><p class="simpara">
						To activate any new features in the new release, such as new subsystems, you must manually merge each <code class="literal">.rpmnew</code> file into your existing configuration files.
					</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="patching_and_upgrading_a_cluster"/>Upgrading a Cluster</h1></div></div></div><p>
				JBoss EAP does not support the creation of clusters where the nodes are made up of different versions of JBoss EAP servers. All nodes within a cluster must be the same JBoss EAP version.
			</p><p>
				The upgrade process for a cluster involves creating a new JBoss EAP cluster comprised of nodes running the newer JBoss EAP version, and then migrating all clustered traffic from the previous cluster to the new cluster. After this is completed, the previous JBoss EAP cluster can be shut down and removed.
			</p><p>
				See the chapter on <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/configuration_guide/#configuring_high_availability">configuring high availability</a> in the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/configuration_guide/"><span class="emphasis"><em>Configuration Guide</em></span></a> for creating a new cluster, and the section on <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/configuration_guide/#migrate_traffic_between_clusters">migrating traffic between clusters</a> to migrate traffic from the old cluster to the new one.
			</p><p>
				<br/><br/><br/><br/>
			</p><p>
				<span class="emphasis"><em><span class="right">Revised on 2019-05-02 08:54:35 UTC</span></em></span>
			</p></div></div></body></html>