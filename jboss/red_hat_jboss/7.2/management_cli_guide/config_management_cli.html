<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 6. Configuring the Management CLI</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="config_management_cli"/>Chapter 6. Configuring the Management CLI</h1></div></div></div><p>
			Certain aspects of the management CLI can be customized in its configuration file, <code class="literal">jboss-cli.xml</code>. This file must be located either in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin</code> directory or in a custom directory specified with the <code class="literal">jboss.cli.config</code> system property.
		</p><p>
			The following elements can be configured in the <code class="literal">jboss-cli.xml</code> file.
		</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">default-protocol</code></span></dt><dd>
						The default protocol to use when controller addresses are supplied without one. The default is <code class="literal">remote+http</code>. If port <code class="literal">9999</code> is used and no protocol is specified, the protocol will automatically default to <code class="literal">remoting</code> unless you set the <code class="literal">use-legacy-override</code> attribute to <code class="literal">false</code>.
					</dd><dt><span class="term"><code class="literal">default-controller</code></span></dt><dd><p class="simpara">
						Configuration of the controller to which to connect if the <code class="literal">connect</code> command is executed without any parameters. If the management CLI is started with the argument <code class="literal">--controller=</code> or <code class="literal">controller=</code>, then the value specified in the argument overrides the <code class="literal">default-controller</code> definition from the configuration.
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								<code class="literal">protocol</code> - Protocol name of the controller. If one is not provided, the value of <code class="literal">default-protocol</code> will be used.
							</li><li class="listitem">
								<code class="literal">host</code> - Host name of the controller. The default is <code class="literal">localhost</code>.
							</li><li class="listitem">
								<code class="literal">port</code> - Port number on which to connect to the controller. The default value is <code class="literal">9990</code>.
							</li></ul></div></dd><dt><span class="term"><code class="literal">controllers</code></span></dt><dd><p class="simpara">
						You can define connection controller aliases in the <code class="literal">jboss-cli.xml</code> file. For example:
					</p><pre class="programlisting">&lt;!-- The default controller to connect to when 'connect' command is executed w/o arguments --&gt;
&lt;default-controller&gt;
    &lt;host&gt;localhost&lt;/host&gt;
    &lt;port&gt;9990&lt;/port&gt;
&lt;/default-controller&gt;
&lt;!-- CLI connection controller aliases --&gt;
&lt;controllers&gt;
    &lt;controller name="ServerOne"&gt;
        &lt;protocol&gt;remoting&lt;/protocol&gt;
        &lt;host&gt;192.168.3.45&lt;/host&gt;
        &lt;port&gt;9999&lt;/port&gt;
    &lt;/controller&gt;
    &lt;controller name="ServerTwo"&gt;
        &lt;protocol&gt;http-remoting&lt;/protocol&gt;
        &lt;host&gt;192.168.3.46&lt;/host&gt;
    &lt;/controller&gt;
&lt;/controllers&gt;</pre><p class="simpara">
						The <code class="literal">name</code> attribute of controller element should be used as a value to <code class="literal">--controller=</code> argument. For example, <code class="literal">--controller=ServerTwo</code>.
					</p></dd><dt><span class="term"><code class="literal">validate-operation-requests</code></span></dt><dd>
						Whether to validate the parameter list of operation requests before sending the requests to the controller for execution. The default is <code class="literal">true</code>.
					</dd><dt><span class="term"><code class="literal">history</code></span></dt><dd><p class="simpara">
						The configuration for the CLI command history log.
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								<code class="literal">enabled</code> - Whether or not the <code class="literal">history</code> is enabled. The default is <code class="literal">true</code>.
							</li><li class="listitem">
								<code class="literal">file-name</code> - The file name in which the history will be stored. The default is <code class="literal">.jboss-cli-history</code>.
							</li><li class="listitem">
								<code class="literal">file-dir</code> - The directory in which the history is to be stored. The default is the user’s home directory.
							</li><li class="listitem">
								<code class="literal">max-size</code> - The maximum number of commands stored in the history file. The default is <code class="literal">500</code>.
							</li></ul></div></dd><dt><span class="term"><code class="literal">resolve-parameter-values</code></span></dt><dd>
						Whether to resolve system properties specified as command argument (or operation parameter) values before sending the operation request to the controller. The default is <code class="literal">false</code>.
					</dd><dt><span class="term"><code class="literal">connection-timeout</code></span></dt><dd>
						The time in milliseconds allowed to establish a connection with the controller. The default is <code class="literal">5000</code>.
					</dd><dt><span class="term"><code class="literal">ssl</code></span></dt><dd><p class="simpara">
						The configuration for the keystores and truststores used for SSL.
					</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
							Red Hat recommends that SSLv2, SSLv3, and TLSv1.0 be explicitly disabled in favor of TLSv1.1 or TLSv1.2 in all affected packages.
						</p></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								<code class="literal">vault</code> - The vault configuration. If neither <code class="literal">code</code> nor <code class="literal">module</code> is specified, the default implementation will be used. If <code class="literal">code</code> is specified but not <code class="literal">module</code>, it will look for the specified class in the Picketbox module. If <code class="literal">module</code> and <code class="literal">code</code> are specified, it will look for the class specified by code in the module specified by 'module'.
							</li><li class="listitem">
								<code class="literal">key-store</code> - The keystore.
							</li><li class="listitem">
								<code class="literal">key-store-password</code> - The keystore password.
							</li><li class="listitem">
								<code class="literal">alias</code> - The alias.
							</li><li class="listitem">
								<code class="literal">key-password</code> - The key password.
							</li><li class="listitem">
								<code class="literal">trust-store</code> - The truststore.
							</li><li class="listitem">
								<code class="literal">trust-store-password</code> - The truststore password.
							</li><li class="listitem">
								<code class="literal">modify-trust-store</code> - If set to <code class="literal">true</code>, the CLI will prompt the user when unrecognized certificates are received and allow them to be stored in the truststore. The default is <code class="literal">true</code>.
							</li></ul></div></dd><dt><span class="term"><code class="literal">silent</code></span></dt><dd>
						Whether to write informational and error messages to the terminal. The default is <code class="literal">false</code>.
					</dd><dt><span class="term"><code class="literal">access-control</code></span></dt><dd>
						Whether the management-related commands and attributes should be filtered for the current user based on the permissions the user has been granted. For example, if <code class="literal">true</code>, tab completion will hide commands and attributes that the user is not allowed to access. The default is <code class="literal">true</code>.
					</dd><dt><span class="term"><code class="literal">echo-command</code></span></dt><dd>
						Whether to include the prompt and command in the output for commands executed in non-interactive mode. The default is <code class="literal">false</code>.
					</dd><dt><span class="term"><code class="literal">command-timeout</code></span></dt><dd>
						The maximum time, in seconds, to wait for a command to complete. A value of <code class="literal">0</code> means no timeout. By default, there is no timeout.
					</dd><dt><span class="term"><code class="literal">output-json</code></span></dt><dd>
						Whether to display operation responses in pure JSON format. By default, operation responses are displayed in DMR format.
					</dd><dt><span class="term"><code class="literal">color-output</code></span></dt><dd><p class="simpara">
						Whether to print the CLI log output in color based on the log message output type. The available colors are <code class="literal">black</code>, <code class="literal">blue</code>, <code class="literal">cyan</code>, <code class="literal">green</code>, <code class="literal">magenta</code>, <code class="literal">red</code>, <code class="literal">white</code>, and <code class="literal">yellow</code>.
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								<code class="literal">enabled</code> - Whether or not the color output is enabled. The default is <code class="literal">true</code>.
							</li><li class="listitem">
								<code class="literal">error-color</code> - Defaults to <code class="literal">red</code>.
							</li><li class="listitem">
								<code class="literal">warn-color</code> - Defaults to <code class="literal">yellow</code>.
							</li><li class="listitem">
								<code class="literal">success-color</code> - Defaults to <code class="literal">default</code>, which is the terminal’s default foreground color.
							</li><li class="listitem">
								<code class="literal">required-color</code> - Defaults to <code class="literal">magenta</code>.
							</li><li class="listitem">
								<code class="literal">workflow-color</code> - Defaults to <code class="literal">green</code>.
							</li><li class="listitem">
								<code class="literal">prompt-color</code> - Defaults to <code class="literal">blue</code>.
							</li></ul></div></dd></dl></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="property_substitution"/>Property Substitution</h1></div></div></div><p>
				JBoss EAP supports the use of preset element and property expressions in the management CLI. These expressions will be resolved to their defined values during the execution of the command.
			</p><p>
				You can substitute expressions for the following properties:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						the operation address part of the operation request (for example, node types or names)
					</li><li class="listitem">
						operation name
					</li><li class="listitem">
						operation parameter names
					</li><li class="listitem">
						header names and values
					</li><li class="listitem">
						command names
					</li><li class="listitem">
						command argument names
					</li></ul></div><p>
				By default, the management CLI performs property substitution for every line except for argument or parameter values. Argument and parameter values are resolved in the server at runtime. If you require property substitution for argument or parameter values to occur in the management CLI and have it send the resolved values to the server, complete the following steps.
			</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
						Edit the management CLI configuration file: <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin/jboss-cli.xml</code>.
					</li><li class="listitem"><p class="simpara">
						Set the <code class="literal">resolve-parameter-values</code> parameter to <code class="literal">true</code> (the default is <code class="literal">false</code>).
					</p><pre class="programlisting">&lt;resolve-parameter-values&gt;true&lt;/resolve-parameter-values&gt;</pre></li></ol></div><p>
				This element only affects operation request parameter values and command argument values. It does not impact the rest of the command line. This means system properties present on the command line will be resolved during the parsing of the line regardless of what the value of <code class="literal">resolve-parameter-values</code> element is, unless it is a parameter/argument value.
			</p><p>
				System property values used in management CLI commands must have already been defined in order to be resolved. You must either pass in a properties file (<code class="literal">--properties=<span class="emphasis"><em>/path/to/file.properties</em></span></code>) or property value pairs (<code class="literal">-D<span class="emphasis"><em>key</em></span>=<span class="emphasis"><em>value</em></span></code>) when starting your management CLI instance. The properties file uses a standard <code class="literal"><span class="emphasis"><em>KEY</em></span>=<span class="emphasis"><em>VALUE</em></span></code> syntax.
			</p><p>
				Property keys are denoted in your management CLI commands using the <code class="literal">${<span class="emphasis"><em>MY_VAR</em></span>}</code> syntax, for example:
			</p><pre class="screen">/host=${hostname}/server-config=${servername}:add(group=main-server-group)</pre><p>
				See <a class="link" href="config_management_cli.html" title="Chapter 6. Configuring the Management CLI">Configuring the Management CLI</a> for other <code class="literal">jboss-cli.xml</code> configuration options.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="using_aliases_for_the_CLI_commands"/>Creating Aliases</h1></div></div></div><p>
				You can define aliases for the CLI commands and operations during a CLI session using the <code class="literal">alias</code> command.
			</p><p>
				The following example creates a new CLI command alias named <code class="literal">read_undertow</code> to read the resources in the <code class="literal">undertow</code> subsystem using the <code class="literal">alias</code> command:
			</p><pre class="screen">alias read_undertow='/subsystem=undertow:read-resource'</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					Alias names can only contain alphanumeric characters and underscores.
				</p></div><p>
				To test the creation of <code class="literal">read_undertow</code> alias, type the alias name in the management CLI:
			</p><pre class="screen">read_undertow</pre><p>
				The result will be:
			</p><pre class="screen">{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "default-security-domain" =&gt; "other",
        "default-server" =&gt; "default-server",
        "default-servlet-container" =&gt; "default",
        "default-virtual-host" =&gt; "default-host",
        "instance-id" =&gt; expression "${jboss.node.name}",
        "statistics-enabled" =&gt; false,
        "buffer-cache" =&gt; {"default" =&gt; undefined},
        "configuration" =&gt; {
            "filter" =&gt; undefined,
            "handler" =&gt; undefined
        },
        "server" =&gt; {"default-server" =&gt; undefined},
        "servlet-container" =&gt; {"default" =&gt; undefined}
    }
}</pre><p>
				To view a list of all available aliases, use the <code class="literal">alias</code> command:
			</p><pre class="screen">alias</pre><p>
				The result will be:
			</p><pre class="screen">alias read_undertow='/subsystem=undertow:read-resource'</pre><p>
				To remove an alias, use the <code class="literal">unalias</code> command:
			</p><pre class="screen">unalias read_undertow</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					The aliases are stored in the <code class="literal">.aesh_aliases</code> file within the user’s home folder.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="jbossclirc_configuration_file"/>.jbossclirc Configuration File</h1></div></div></div><p>
				JBoss EAP contains the runtime configuration <code class="literal">.jbossclirc</code> file, which helps you to initialize the environment when a new session is launched. This file is located in <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin/</code> directory. The example provided in the file can be used as a template for user-specific environment setup. The <code class="literal">.jbossclirc</code> file is ideal for storing global CLI variables.
			</p><p>
				The content of the <code class="literal">.jbossclirc</code> file is a list of CLI supported commands and operations. This file is executed when a new management CLI session is launched but before the control is given to the user. If there are system properties specified with <code class="literal">--properties</code> argument, then the <code class="literal">.jbossclirc</code> file is executed after the properties have been set.
			</p><h3><a id="example_jbossclirc_file"/>Example .jbossclirc File</h3><pre class="screen">set console=/subsystem=logging/console-handler=CONSOLE</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					When using the <code class="literal">--connect</code> or <code class="literal">-c</code> argument, <code class="literal">.jbossclirc</code> is executed before the client is actually connected to the server.
				</p></div><p>
				The following locations will be checked for the presence of the <code class="literal">.jbossclirc</code> file in the following order:
			</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
						If the system property <code class="literal">jboss.cli.rc</code> is defined, its value will be considered a path to the file.
					</li><li class="listitem">
						User’s working directory as defined by the <code class="literal">user.dir</code> system property.
					</li><li class="listitem">
						The <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin</code> directory.
					</li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="using_variables_for_the_CLI_commands"/>Using Variables</h1></div></div></div><h3><a id="using_the_set_command"/>Using the Set Command</h3><p>
				You can define a certain path of the server model to a variable using the <code class="literal">set</code> command. For example:
			</p><pre class="screen">set s1=/host=master/server=server-one</pre><p>
				This is useful in a managed domain as you can include references to host and profiles using variables to easily replicate scripts on different servers. For example:
			</p><pre class="screen">$s1/subsystem=datasources/data-source=ExampleDS:test-connection-in-pool</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					The variables are referenced using <code class="literal">$</code>.
				</p></div><h3><a id="using_the_unset_command"/>Using the Unset Command</h3><p>
				You can remove the variable by using the <code class="literal">unset</code> command:
			</p><pre class="screen">unset prod_db</pre><h3><a id="using_the_jbossclirc_file"/>Using the jbossclirc File</h3><p>
				To use the variable across CLI session, you can include these variables in the <code class="literal">.jbossclirc</code> file. This file is located in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin/</code> directory.
			</p><p>
				For example:
			</p><pre class="screen">set s1=/host=master/server=server-one
set s2=/host=master/server=server-two</pre><p>
				Now, restart the management CLI and issue a <code class="literal">set</code> command to check the available variables:
			</p><pre class="screen">set</pre><p>
				The output will be:
			</p><pre class="screen">s1=/host=master/server=server-one
s2=/host=master/server=server-two</pre><p>
				The variables may appear in any part of a command line and resolved during the command line parsing phase. In this example, the <code class="literal">prod_db</code> variable will be resolved to a datasource:
			</p><pre class="screen">$prod_db/statistics=jdbc:read-resource</pre><h3><a id="using_the_echo_command"/>Using the Echo Command</h3><p>
				Use the <code class="literal">echo</code> command to check the value of a variable:
			</p><pre class="screen">echo $prod_db</pre><p>
				The output will be:
			</p><pre class="screen">/subsystem=datasources/data-source=ExampleDS</pre><h3><a id="example"/>Example</h3><p>
				The following general examples show where the variables may appear and that the entire command line may consist of variables:
			</p><pre class="screen">$prod_db:$op($param=$param_value)
$cmd --$param=$param_value</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					The variables help you in CLI scripting.
				</p></div></div></div></body></html>