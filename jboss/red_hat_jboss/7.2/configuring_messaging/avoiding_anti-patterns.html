<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 37. Avoiding Anti-Patterns</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="avoiding_anti-patterns"/>Chapter 37. Avoiding Anti-Patterns</h1></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
						Reuse connections, sessions, consumers, and producers where possible.
					</p><p class="simpara">
						The most common messaging anti-pattern is the creation of a new connection, session, and producer for every message sent or consumed. These objects take time to create and may involve several network round trips, so it is a poor use of resources. Always reuse them.
					</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
							Some popular libraries such as the Spring JMS Template use these anti-patterns. If you are using the Spring JMS Template, you may see poor performance. The Spring JMS Template can only safely be used in an application server which caches JMS sessions, for example, using JCA, and only then for sending messages. It cannot safely be used for synchronously consuming messages, even in an application server.
						</p></div></li><li class="listitem"><p class="simpara">
						Avoid fat messages.
					</p><p class="simpara">
						Verbose formats such as XML take up a lot of space on the wire and performance suffers as result. Avoid XML in message bodies if you can.
					</p></li><li class="listitem"><p class="simpara">
						Do not create temporary queues for each request.
					</p><p class="simpara">
						This common anti-pattern involves the temporary queue request-response pattern. With the temporary queue request-response pattern, a message is sent to a target, and a reply-to header is set with the address of a local temporary queue. When the recipient receives the message, they process it, and then send back a response to the address specified in the reply-to header. A common mistake made with this pattern is to create a new temporary queue on each message sent, which drastically reduces performance. Instead, the temporary queue should be reused for many requests.
					</p></li><li class="listitem"><p class="simpara">
						Do not use message driven beans unless it is necessary.
					</p><p class="simpara">
						Using MDBs to consume messages is slower than consuming messages using a simple JMS message consumer.
					</p></li></ul></div></div></body></html>