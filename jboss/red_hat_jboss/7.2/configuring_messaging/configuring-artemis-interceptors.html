<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 21. Interceptors</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="configuring-artemis-interceptors"/>Chapter 21. Interceptors</h1></div></div></div><p>
				JBoss EAP messaging supports interceptors to intercept packets entering and exiting the server. Incoming and outgoing interceptors are called for every packet entering or exiting the server respectively. This allows custom code to be executed, such as for auditing or filtering packets. Interceptors can modify the packets they intercept. This makes interceptors powerful, but also potentially dangerous.
			</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="implementing_interceptors"/>Implementing Interceptors</h1></div></div></div><p>
					An interceptor must implement the Interceptor interface:
				</p><pre class="programlisting">package org.apache.artemis.activemq.api.core.interceptor;

public interface Interceptor
{
   boolean intercept(Packet packet, RemotingConnection connection) throws ActiveMQException;
}</pre><p>
					The returned boolean value is important:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							if true is returned, the process continues normally
						</li><li class="listitem">
							if false is returned, the process is aborted, no other interceptors will be called and the packet will not be processed further by the server.
						</li></ul></div><p>
					Interceptor classes should be added to JBoss EAP as a module. See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/configuration_guide/#create_a_custom_module">Create a Custom Module</a> in the JBoss EAP <span class="emphasis"><em>Configuration Guide</em></span> for more information.
				</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="configuring_interceptors"/>Configuring Interceptors</h1></div></div></div><p>
					After adding their module to JBoss EAP as a custom module, both incoming and outgoing interceptors are added to the messaging subsystem configuration by using the management CLI.
				</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						You must start JBoss EAP in <span class="emphasis"><em>administrator only</em></span> mode before the new interceptor configuration will be accepted. See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/configuration_guide/#running_eap_in_admin_only_mode">Running JBoss EAP in Admin-only Mode</a> in the JBoss EAP <span class="emphasis"><em>Configuration Guide</em></span> for details. Restart the server in normal mode after the new configuration is processed.
					</p></div><p>
					Each interceptor should be added according to the example management CLI command below. The examples assume each interceptor has already been added to JBoss EAP as a custom module.
				</p><pre class="screen">/subsystem=messaging-activemq/server=default:list-add(name=incoming-interceptors, value={name =&gt; "foo.bar.MyIncomingInterceptor", module=&gt;"foo.bar.interceptors"})</pre><p>
					Adding an outgoing interceptor follows a similar syntax, as the example below illustrates.
				</p><pre class="screen">/subsystem=messaging-activemq/server=default:list-add(name=outgoing-interceptors, value={name =&gt; "foo.bar.MyOutgoingInterceptor", module=&gt;"foo.bar.interceptors"})</pre></div></div></body></html>