<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. Configuring Connection Factories</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="configuring_messaging_connection_factories"/>Chapter 9. Configuring Connection Factories</h1></div></div></div><p>
				By default, the JBoss EAP <code class="literal">messaging-activemq</code> subsystem provides the <code class="literal">InVmConnectionFactory</code> and <code class="literal">RemoteConnectionFactory</code> <a class="link" href="configuring_messaging_connection_factories.html#basic_connection_factories" title="Basic Connection Factories">connection factories</a>, as well as the <code class="literal">activemq-ra</code> <a class="link" href="configuring_messaging_connection_factories.html#pooled_connection_factories" title="Pooled Connection Factories">pooled connection factory</a>.
			</p><h2><a id="basic_connection_factories"/>Basic Connection Factories</h2><p>
				<code class="literal">InVmConnectionFactory</code> references an <code class="literal">in-vm-connector</code> and can be used to send and receive messages when both the client and server are running in the same JVM. <code class="literal">RemoteConnectionFactory</code> references an <code class="literal">http-connector</code> and can be used to send and receive messages over HTTP when the client and server are running in different JVMs.
			</p><pre class="programlisting">&lt;subsystem xmlns="urn:jboss:domain:messaging-activemq:4.0"&gt;
  &lt;server name="default"&gt;
    ...
    &lt;connection-factory name="InVmConnectionFactory" connectors="in-vm" entries="java:/ConnectionFactory"/&gt;
    &lt;connection-factory name="RemoteConnectionFactory" connectors="http-connector" entries="java:jboss/exported/jms/RemoteConnectionFactory"/&gt;
    ...
  &lt;/server&gt;
&lt;/subsystem&gt;</pre><p>
				For more information on the different types of connectors, see the <a class="link" href="acceptors_and_connectors.html" title="Chapter 8. Configuring the Messaging Transports">Acceptors and Connectors</a> section.
			</p><h3><a id="add_a_connection_factory"/>Add a Connection Factory</h3><p>
				You can add a new connection factory using the following management CLI command. When adding a connection factory, you must provide the <code class="literal">connectors</code> and the JNDI <code class="literal">entries</code>.
			</p><pre class="screen">/subsystem=messaging-activemq/server=default/connection-factory=MyConnectionFactory:add(entries=[java:/MyConnectionFactory],connectors=[in-vm])</pre><h3><a id="configure_a_connection_factory"/>Configure a Connection Factory</h3><p>
				You can update a connection factory’s settings using the management CLI.
			</p><pre class="screen">/subsystem=messaging-activemq/server=default/connection-factory=MyConnectionFactory:write-attribute(name=thread-pool-max-size,value=40)</pre><p>
				For information on the available attributes for a connection factory, see <a class="link" href="reference_material.html#connection_factory_attributes" title="Connection Factory Attributes">Connection Factory Attributes</a>.
			</p><h3><a id="remove_a_connection_factory"/>Remove a Connection Factory</h3><p>
				You can remove a connection factory using the management CLI.
			</p><pre class="screen">/subsystem=messaging-activemq/server=default/connection-factory=MyConnectionFactory:remove</pre><h2><a id="pooled_connection_factories"/>Pooled Connection Factories</h2><p>
				The JBoss EAP <code class="literal">messaging-activemq</code> subsystem provides a pooled connection factory that allows you to configure the inbound and outbound connectors of the integrated ActiveMQ Artemis resource adapter. For more information on configuring a <code class="literal">pooled-connection-factory</code> to connect to a remote ActiveMQ Artemis server, see <a class="link" href="resource_adapters.html#use_provided_amq_adapter" title="Using the Integrated Artemis Resource Adapter for Remote Connections">Using the Integrated Resource Adapter for Remote Connections</a>.
			</p><pre class="programlisting">&lt;subsystem xmlns="urn:jboss:domain:messaging-activemq:4.0"&gt;
  &lt;server name="default"&gt;
    ...
    &lt;pooled-connection-factory name="activemq-ra" transaction="xa" entries="java:/JmsXA java:jboss/DefaultJMSConnectionFactory" connectors="in-vm"/&gt;
  &lt;/server&gt;
&lt;/subsystem&gt;</pre><p>
				There are several unique characteristics of a pooled connection factory:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						It is only available to local clients, though it can be configured to point to a remote server. For more information on connecting to a remote ActiveMQ Artemis server, see <a class="link" href="resource_adapters.html#use_provided_amq_adapter" title="Using the Integrated Artemis Resource Adapter for Remote Connections">Using the Integrated Artemis Resource Adapter for Remote Connections</a>.
					</li><li class="listitem">
						It should only be used to send messages when looked up in JNDI or injected.
					</li><li class="listitem">
						It can be configured to use security credentials, which is useful if it is pointing to a secured remote server.
					</li><li class="listitem">
						Resources acquired from it will be automatically enlisted in any ongoing JTA transactions.
					</li></ul></div><h3><a id="add_a_pooled_connection_factory"/>Add a Pooled Connection Factory</h3><p>
				You can add a new pooled connection factory using the following management CLI command. When adding a connection factory, you must provide the <code class="literal">connectors</code> and the JNDI <code class="literal">entries</code>.
			</p><pre class="screen">/subsystem=messaging-activemq/server=default/pooled-connection-factory=MyPooledConnectionFactory:add(entries=[java:/MyPooledConnectionFactory],connectors=[in-vm])</pre><h3><a id="configure_a_pooled_connection_factory"/>Configure a Pooled Connection Factory</h3><p>
				You can update a pooled connection factory’s settings using the management CLI.
			</p><pre class="screen">/subsystem=messaging-activemq/server=default/pooled-connection-factory=MyPooledConnectionFactory:write-attribute(name=max-retry-interval,value=3000)</pre><p>
				For information on the available attributes for a pooled connection factory, see <a class="link" href="reference_material.html#pooled_connection_factory_attributes" title="Pooled Connection Factory Attributes">Pooled Connection Factory Attributes</a>.
			</p><p>
				You can disable the recording of enlistment traces for this pooled connection factory using the management CLI by setting the <code class="literal">enlistment-trace</code> attribute to <code class="literal">false</code>.
			</p><pre class="screen">/subsystem=messaging-activemq/server=default/pooled-connection-factory=MyPooledConnectionFactory:write-attribute(name=enlistment-trace,value=false)</pre><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
					Disabling the enlistment trace will make tracking down errors during transaction enlistment more difficult.
				</p></div><p>
				You can also configure the managed connection pool implementation used by the pooled connection factory. For more information, see the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/configuration_guide/#configure_managed_connection_pools">Configure Managed Connection Pools</a> section of the JBoss EAP <span class="emphasis"><em>Configuration Guide</em></span>.
			</p><h3><a id="remove_a_pooled_connection_factory"/>Remove a Pooled Connection Factory</h3><p>
				You can remove a pooled connection factory using the management CLI.
			</p><pre class="screen">/subsystem=messaging-activemq/server=default/pooled-connection-factory=MyPooledConnectionFactory:remove</pre></div></body></html>