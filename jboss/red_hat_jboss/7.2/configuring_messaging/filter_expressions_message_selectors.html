<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 15. Filter Expressions and Message Selectors</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="filter_expressions_message_selectors"/>Chapter 15. Filter Expressions and Message Selectors</h1></div></div></div><p>
				The <code class="literal">messaging-activemq</code> subsystem in JBoss EAP provides a powerful filter language based on a subset of the SQL 92 expression syntax.
			</p><p>
				It is the same as the syntax used for JMS selectors, but the predefined identifiers are different. For documentation on JMS selector syntax, refer to the <a class="link" href="https://javaee.github.io/javaee-spec/javadocs/javax/jms/Message.html">javax.jms.Message</a> interface Javadoc.
			</p><p>
				The <code class="literal">filter</code> attribute can be found in several places within the configuration.
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
						Predefined Queues. When pre-defining a queue, a filter expression can be defined for it. Only messages that match the filter expression will enter the queue. The configuration snippet below shows a queue definition that includes a filter:
					</p><pre class="programlisting">&lt;subsystem xmlns="urn:jboss:domain:messaging-activemq:4.0"&gt;
  ...
  &lt;queue
    name="myQueue"
    filter="<span class="emphasis"><em>FILTER_EXPRESSION</em></span>"
    ...
  /&gt;
  ...
&lt;/subsystem&gt;</pre><p class="simpara">
						To create queue with a selector in the management CLI you would use something like following command:
					</p><pre class="screen">jms-queue add --queue-address=<span class="emphasis"><em>QUEUE_ADDRESS</em></span> --selector=<span class="emphasis"><em>FILTER_EXPRESSION</em></span></pre></li><li class="listitem"><p class="simpara">
						Core bridges can be defined with an optional filter expression, only matching messages will be bridged. Below is a snippet from a sample configuration file where the <code class="literal">messaging-activemq</code> subsystem includes a bridge with a filter.
					</p><pre class="programlisting">&lt;subsystem xmlns="urn:jboss:domain:messaging-activemq:4.0"&gt;
  ...
  &lt;bridge
    name="myBridge"
    filter="<span class="emphasis"><em>FILTER_EXPRESSION</em></span>"
    ...
  /&gt;
  ...
&lt;/subsystem&gt;</pre></li><li class="listitem"><p class="simpara">
						Diverts can be defined with an optional filter expression, only matching messages will be diverted. See <a class="link" href="diverts.html" title="Chapter 23. Diverts">Diverts</a> for more information. The example snippet below shows a Divert using a filter:
					</p><pre class="programlisting">&lt;subsystem xmlns="urn:jboss:domain:messaging-activemq:4.0"&gt;
  ...
  &lt;divert
    name="myDivert"
    filter="<span class="emphasis"><em>FILTER_EXPRESSION</em></span>"
    ...
  /&gt;
  ...
&lt;/subsystem&gt;</pre></li></ul></div><p>
				There are some differences between JMS selector expressions and JBoss EAP messaging core filter expressions. Whereas JMS selector expressions operate on a JMS message, JBoss EAP messaging core filter expressions operate on a core message.
			</p><p>
				The following identifiers can be used in core filter expressions to refer to the attributes of a core message:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<code class="literal">AMQPriority</code>. To refer to the priority of a message. Message priorities are integers with valid values from <code class="literal">0 - 9</code>. <code class="literal">0</code> is the lowest priority and <code class="literal">9</code> is the highest. For example, <code class="literal">AMQPriority</code> = 3 AND animal = 'aardvark'.
					</li><li class="listitem">
						<code class="literal">AMQExpiration</code>. To refer to the expiration time of a message. The value is a long integer.
					</li><li class="listitem">
						<code class="literal">AMQDurable</code>. To refer to whether a message is durable or not. The value is a string with valid values: <code class="literal">DURABLE</code> or <code class="literal">NON_DURABLE</code>.
					</li><li class="listitem">
						<code class="literal">AMQTimestamp</code>. The timestamp of when the message was created. The value is a long integer.
					</li><li class="listitem">
						<code class="literal">AMQSize</code>. The size of a message in bytes. The value is an integer.
					</li></ul></div><p>
				Any other identifiers used in core filter expressions will be assumed to be properties of the message.
			</p></div></body></html>