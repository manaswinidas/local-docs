<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 3. Getting Started</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="getting_started"/>Chapter 3. Getting Started</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="using_the_quickstart"/>Using the helloworld-mdb Quickstart</h1></div></div></div><p>
					The <code class="literal">helloworld-mdb</code> quickstart uses a simple message-driven bean to demonstrate basic Java EE messaging features. Having the quickstart up and running as you <a class="link" href="getting_started.html#intro_messaging_config" title="Overview of the Messaging Subsystem Configuration">review the basic configuration</a> is an excellent way to introduce yourself to the features included with the JBoss EAP messaging server.
				</p><h3><a id="build_and_deploy_the_helloworld_mdb_quickstart"/>Build and Deploy the helloworld-mdb Quickstart</h3><p>
					See the instructions in the <code class="literal">README.md</code> file provided with the quickstart for instructions on building and deploying the <code class="literal">helloworld-mdb</code> quickstart. You will need to start the JBoss EAP server specifying the <code class="literal">full</code> configuration, which contains the <code class="literal">messaging-activemq</code> subsystem. See the <code class="literal">README.md</code> file or the JBoss EAP <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/configuration_guide/"><span class="emphasis"><em>Configuration Guide</em></span></a> for details on starting JBoss EAP with a different configuration file.
				</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="intro_messaging_config"/>Overview of the Messaging Subsystem Configuration</h1></div></div></div><p>
					Default configuration for the <code class="literal">messaging-activemq</code> subsystem is included when starting the JBoss EAP server with the <code class="literal">full</code> or <code class="literal">full-ha</code> configuration. The <code class="literal">full-ha</code> option includes advanced configuration for features like <a class="link" href="clusters_overview.html" title="Chapter 29. Clusters Overview">clustering</a> and <a class="link" href="messaging-ha.html" title="Chapter 30. High Availability">high availability</a>.
				</p><p>
					Although not necessary, it is recommended that you <a class="link" href="getting_started.html#using_the_quickstart" title="Using the helloworld-mdb Quickstart">use the <code class="literal">helloworld-mdb</code> quickstart</a> as a working example to have running alongside this overview of the configuration.
				</p><p>
					For information on all settings available in the <code class="literal">messaging-activemq</code> subsystem, see the schema definitions located in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/docs/schema/</code> directory, or run the <code class="literal">read-resource-description</code> operation on the subsystem from the management CLI, as shown below.
				</p><pre class="screen">/subsystem=messaging-activemq:read-resource-description(recursive=true)</pre><p>
					The following extension in the server configuration file tells JBoss EAP to include the <code class="literal">messaging-activemq</code> subsystem as part of its runtime.
				</p><pre class="programlisting">&lt;extensions&gt;
  ...
  &lt;extension module="org.wildfly.extension.messaging-activemq"/&gt;
  ...
&lt;/extensions&gt;</pre><p>
					The configuration for the <code class="literal">messaging-activemq</code> subsystem is contained within the <code class="literal">&lt;subsystem xmlns="urn:jboss:domain:messaging-activemq:4.0"&gt;</code> element.
				</p><pre class="programlisting">&lt;subsystem xmlns="urn:jboss:domain:messaging-activemq:4.0"&gt;
    &lt;server name="default"&gt;
        &lt;cluster password="${jboss.messaging.cluster.password:CHANGE ME!!}"/&gt;
        &lt;security-setting name="#"&gt;
            &lt;role name="guest" send="true" consume="true" create-non-durable-queue="true" delete-non-durable-queue="true"/&gt;
        &lt;/security-setting&gt;
        &lt;address-setting name="#" dead-letter-address="jms.queue.DLQ" expiry-address="jms.queue.ExpiryQueue" max-size-bytes="10485760" page-size-bytes="2097152" message-counter-history-day-limit="10" redistribution-delay="1000"/&gt;
        &lt;http-connector name="http-connector" socket-binding="http" endpoint="http-acceptor"/&gt;
        &lt;http-connector name="http-connector-throughput" socket-binding="http" endpoint="http-acceptor-throughput"&gt;
            &lt;param name="batch-delay" value="50"/&gt;
        &lt;/http-connector&gt;
        &lt;in-vm-connector name="in-vm" server-id="0"/&gt;
        &lt;http-acceptor name="http-acceptor" http-listener="default"/&gt;
        &lt;http-acceptor name="http-acceptor-throughput" http-listener="default"&gt;
            &lt;param name="batch-delay" value="50"/&gt;
            &lt;param name="direct-deliver" value="false"/&gt;
        &lt;/http-acceptor&gt;
        &lt;in-vm-acceptor name="in-vm" server-id="0"/&gt;
        &lt;broadcast-group name="bg-group1" connectors="http-connector" jgroups-cluster="activemq-cluster"/&gt;
        &lt;discovery-group name="dg-group1" jgroups-cluster="activemq-cluster"/&gt;
        &lt;cluster-connection name="my-cluster" address="jms" connector-name="http-connector" discovery-group="dg-group1"/&gt;
        &lt;jms-queue name="ExpiryQueue" entries="java:/jms/queue/ExpiryQueue"/&gt;
        &lt;jms-queue name="DLQ" entries="java:/jms/queue/DLQ"/&gt;
        &lt;connection-factory name="InVmConnectionFactory" connectors="in-vm" entries="java:/ConnectionFactory"/&gt;
        &lt;connection-factory name="RemoteConnectionFactory" ha="true" block-on-acknowledge="true" reconnect-attempts="-1" connectors="http-connector" entries="java:jboss/exported/jms/RemoteConnectionFactory"/&gt;
        &lt;pooled-connection-factory name="activemq-ra" transaction="xa" connectors="in-vm" entries="java:/JmsXA java:jboss/DefaultJMSConnectionFactory"/&gt;
    &lt;/server&gt;
&lt;/subsystem&gt;</pre><h4><a id="connection_factories"/>Connection Factories</h4><p>
					Messaging clients use a JMS <code class="literal">ConnectionFactory</code> object to make connections to the server. The default JBoss EAP configuration defines several connection factories. Note that there is a <code class="literal">&lt;connection-factory&gt;</code> for in-vm, http, and pooled connections.
				</p><pre class="programlisting">  &lt;connection-factory name="InVmConnectionFactory" connectors="in-vm" entries="java:/ConnectionFactory"/&gt;
  &lt;connection-factory name="RemoteConnectionFactory" ha="true" block-on-acknowledge="true" reconnect-attempts="-1" connectors="http-connector" entries="java:jboss/exported/jms/RemoteConnectionFactory"/&gt;
  &lt;pooled-connection-factory name="activemq-ra" transaction="xa" connectors="in-vm" entries="java:/JmsXA java:jboss/DefaultJMSConnectionFactory"/&gt;</pre><p>
					See the <a class="link" href="configuring_messaging_connection_factories.html" title="Chapter 9. Configuring Connection Factories">Configuring Connection Factories</a> section for more details.
				</p><h4><a id="connectors_and_acceptors"/>Connectors and Acceptors</h4><p>
					Each JMS connection factory uses connectors to enable JMS-enabled communication from a client producer or consumer to a messaging server. The connector object defines the transport and parameters used to connect to the messaging server. Its counterpart is the acceptor object, which identifies the type of connections accepted by the messaging server.
				</p><p>
					The default JBoss EAP configuration defines several connectors and acceptors.
				</p><div class="title"><strong>Example: Default Connectors</strong></div><p>
						
</p><pre class="programlisting">&lt;http-connector name="http-connector" socket-binding="http" endpoint="http-acceptor"/&gt;
&lt;http-connector name="http-connector-throughput" socket-binding="http" endpoint="http-acceptor-throughput"&gt;
  &lt;param name="batch-delay" value="50"/&gt;
&lt;/http-connector&gt;
&lt;in-vm-connector name="in-vm" server-id="0"/&gt;</pre><p>

					</p><div class="title"><strong>Example: Default Acceptors</strong></div><p>
						
</p><pre class="programlisting">&lt;http-acceptor name="http-acceptor" http-listener="default"/&gt;
&lt;http-acceptor name="http-acceptor-throughput" http-listener="default"&gt;
  &lt;param name="batch-delay" value="50"/&gt;
  &lt;param name="direct-deliver" value="false"/&gt;
&lt;/http-acceptor&gt;</pre><p>

					</p><p>
					See the <a class="link" href="acceptors_and_connectors.html" title="Chapter 8. Configuring the Messaging Transports">Acceptors and Connectors</a> section for more details.
				</p><h4><a id="socket_binding_groups"/>Socket Binding Groups</h4><p>
					The <code class="literal">socket-binding</code> attribute for the default connectors reference a socket binding named <code class="literal">http</code>. The http connector is used because JBoss EAP can multiplex inbound requests over standard web ports.
				</p><p>
					You can find this <code class="literal">socket-binding</code> as part of the <code class="literal">&lt;socket-binding-group&gt;</code> section elsewhere in the configuration file. Note how the configuration for the http and https socket bindings appear within the <code class="literal">&lt;socket-binding-groups&gt;</code> element:
				</p><pre class="programlisting">&lt;socket-binding-group name="standard-sockets" default-interface="public" port-offset="${jboss.socket.binding.port-offset:0}"&gt;
   ...
  &lt;socket-binding name="http" port="${jboss.http.port:8080}"/&gt;
  &lt;socket-binding name="https" port="${jboss.https.port:8443}"/&gt;
   ...
&lt;/socket-binding-group&gt;</pre><p>
					For information on socket bindings, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/configuration_guide/#configuring_socket_bindings">Configuring Socket Bindings</a> in the JBoss EAP <span class="emphasis"><em>Configuration Guide</em></span>.
				</p><h4><a id="messaging_security"/>Messaging Security</h4><p>
					The <code class="literal">messaging-activemq</code> subsystem includes a single <code class="literal">security-setting</code> element when JBoss EAP is first installed:
				</p><pre class="programlisting">&lt;security-setting name="#"&gt;
  &lt;role name="guest" delete-non-durable-queue="true" create-non-durable-queue="true" consume="true" send="true"/&gt;
&lt;/security-setting&gt;</pre><p>
					This declares that any user with the role <code class="literal">guest</code> can access any address on the server, as noted by the wildcard <code class="literal">#</code>. See <a class="link" href="configure_address_settings.html" title="Chapter 6. Address Settings">Configuring Address Settings</a> for more information on the wildcard syntax .
				</p><p>
					For more information on securing destinations and remote connections see <a class="link" href="configuring_messaging_security.html" title="Chapter 7. Configuring Security">Configuring Messaging Security</a>.
				</p><h4><a id="messaging_destinations"/>Messaging Destinations</h4><p>
					The <code class="literal">full</code> and <code class="literal">full-ha</code> configurations include two helpful queues that JBoss EAP can use to hold messages that have expired or that cannot be routed to their proper destination.
				</p><pre class="programlisting">&lt;jms-queue name="ExpiryQueue" entries="java:/jms/queue/ExpiryQueue"/&gt;
&lt;jms-queue name="DLQ" entries="java:/jms/queue/DLQ"/&gt;</pre><p>
					You can add your own messaging destinations in JBoss EAP using one of the following methods.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
							Using the management CLI
						</p><p class="simpara">
							Use the following management CLI command to add a queue.
						</p><pre class="screen">jms-queue add --queue-address=testQueue  --entries=queue/test,java:jboss/exported/jms/queue/test</pre><p class="simpara">
							Use the following management CLI command to add a topic.
						</p><pre class="screen">jms-topic add --topic-address=testTopic  --entries=topic/test,java:jboss/exported/jms/topic/test</pre></li><li class="listitem"><p class="simpara">
							Using the management console
						</p><p class="simpara">
							Messaging destinations can be configured from the management console by navigating to <span class="strong"><strong>Configuration</strong></span> → <span class="strong"><strong>Subsystems</strong></span> → <span class="strong"><strong>Messaging (ActiveMQ)</strong></span> → <span class="strong"><strong>Server</strong></span>, selecting the server, selecting <span class="strong"><strong>Destinations</strong></span>, and clicking <span class="strong"><strong>View</strong></span>. Select the <span class="strong"><strong>JMS Queue</strong></span> tab to configure queues and select the <span class="strong"><strong>JMS Topic</strong></span> to configure topics.
						</p></li><li class="listitem"><p class="simpara">
							Defining your destinations using a Java EE deployment descriptor or annotation.
						</p><p class="simpara">
							Starting with Java EE 7, deployment descriptors can include configuration for queues and topics. Below is a snippet from a Java EE descriptor file that defines a JMS queue.
						</p><pre class="programlisting">...
&lt;jms-destination&gt;
   &lt;name&gt;java:global/jms/MyQueue&lt;/name&gt;
   &lt;interfaceName&gt;javax.jms.Queue&lt;/interfaceName&gt;
   &lt;destinationName&gt;myQueue&lt;/destinationName&gt;
&lt;/jms-destination&gt;
...</pre><p class="simpara">
							For example, the message-driven beans in the <code class="literal">helloworld-mdb</code> quickstart contain annotations that define the queue and topic needed to run the application. Destinations created in this way will appear in the list of runtime queues. Use the management CLI to display the list of runtime queues. After deploying the quickstart the runtime queues it created will appear as below:
						</p><pre class="screen">/subsystem=messaging-activemq/server=default/runtime-queue=*:read-resource
{
    "outcome" =&gt; "success",
    "result" =&gt; [
        ...
        {
            "address" =&gt; [
                ("subsystem" =&gt; "messaging-activemq"),
                ("server" =&gt; "default"),
                ("runtime-queue" =&gt; "jms.queue.HelloWorldMDBQueue")
            ],
            "outcome" =&gt; "success",
            "result" =&gt; {"durable" =&gt; undefined}
        },
        ...
        {
            "address" =&gt; [
                ("subsystem" =&gt; "messaging-activemq"),
                ("server" =&gt; "default"),
                ("runtime-queue" =&gt; "jms.topic.HelloWorldMDBTopic")
            ],
            "outcome" =&gt; "success",
            "result" =&gt; {"durable" =&gt; undefined}
        },
        ...
    ]
}</pre></li></ul></div><p>
					See <a class="link" href="configure_destinations_artemis.html" title="Chapter 4. Configuring Messaging Destinations">Configuring Messaging Destinations</a> for more detailed information.
				</p></div></div></body></html>