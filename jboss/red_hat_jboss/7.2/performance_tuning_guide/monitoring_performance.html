<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 2. Monitoring Performance</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="monitoring_performance"/>Chapter 2. Monitoring Performance</h1></div></div></div><p>
			You can monitor JBoss EAP performance using any tool that can examine JVMs running on your machine. Red Hat recommends that you use either JConsole, for which JBoss EAP includes a preconfigured wrapper script, or Java VisualVM. Both these tools provide basic monitoring of JVM processes, including memory usage, thread utilization, loaded classes, and other JVM metrics.
		</p><p>
			If you will be running one of these tools locally on the same machine that JBoss EAP is running on, then no configuration is necessary. However, if you will be running one of these tools to monitor JBoss EAP running on a remote machine, then some <a class="link" href="monitoring_performance.html#configuring_remote_monitoring" title="Configuring JBoss EAP for Remote Monitoring Connections">configuration is required for JBoss EAP to accept remote JMX connections</a>.
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="configuring_remote_monitoring"/>Configuring JBoss EAP for Remote Monitoring Connections</h1></div></div></div><div class="orderedlist"><a id="remote_monitoring_standalone"/><p class="title"><strong>For a Standalone Server</strong></p><ol class="orderedlist"><li class="listitem">
						Ensure that you have created a management user. You might want to create a separate management user to monitor your JBoss EAP server. See the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/configuration_guide/#management_users">JBoss EAP <span class="emphasis"><em>Configuration Guide</em></span></a> for details.
					</li><li class="listitem"><p class="simpara">
						When starting JBoss EAP, bind the management interface to the IP address that you will use to remotely monitor the server:
					</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/standalone.sh -bmanagement=<span class="emphasis"><em>IP_ADDRESS</em></span></pre><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
							This exposes all the JBoss EAP management interfaces, including the management console and management CLI, to the specified network. Ensure that you only bind the management interface to a private network.
						</p></div></li><li class="listitem"><p class="simpara">
						Use the following URI with your management user name and password in your JVM monitoring tool to connect to the JBoss EAP server. The URI below uses the default management port (<code class="literal">9990</code>).
					</p><pre class="screen">service:jmx:remote+http://<span class="emphasis"><em>IP_ADDRESS</em></span>:9990</pre></li></ol></div><div class="title"><strong>For a Managed Domain Host</strong></div><p>
					Using the <a class="link" href="monitoring_performance.html#remote_monitoring_standalone" title="For a Standalone Server">above procedure</a> of binding the management interface on a managed domain host will only expose the host controller JVM for remote monitoring, and not the individual JBoss EAP servers running on that host.
				</p><p>
				To configure JBoss EAP to remotely monitor individual servers on a managed domain host, follow the procedure below.
			</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
						Create a new user in the <code class="literal">ApplicationRealm</code> that you will use to connect to the JBoss EAP servers for remote monitoring. See the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/configuration_guide/#management_users">JBoss EAP <span class="emphasis"><em>Configuration Guide</em></span></a> for details.
					</li><li class="listitem"><p class="simpara">
						In the management CLI, run the following commands to add a remoting port to the socket binding group, and add remoting to the <code class="literal">ApplicationRealm</code>. If necessary, replace the profile name and socket binding group in the following commands with the ones that you are using.
					</p><pre class="screen">/profile=full/subsystem=jmx/remoting-connector=jmx:add(use-management-endpoint=false)
/socket-binding-group=full-sockets/socket-binding=remoting:add(port=4447)
/profile=full/subsystem=remoting/connector=remoting-connector:add(socket-binding=remoting,security-realm=ApplicationRealm)</pre></li><li class="listitem"><p class="simpara">
						When starting your JBoss EAP managed domain host, bind one or both of the following interfaces to an IP address that you will use for monitoring.
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
								If you want to connect to individual JBoss EAP server JVMs running on your managed domain host, bind the public interface:
							</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/domain.sh -b=<span class="emphasis"><em>IP_ADDRESS</em></span></pre></li><li class="listitem"><p class="simpara">
								If you want to connect to the JBoss EAP host controller JVM, also bind the management interface:
							</p><pre class="screen">$ <span class="emphasis"><em>EAP_HOME</em></span>/bin/domain.sh -bmanagement=<span class="emphasis"><em>IP_ADDRESS</em></span></pre><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
									This exposes all the JBoss EAP management interfaces, including the management console and management CLI, to the specified network. Ensure that you only bind the management interface to a private network.
								</p></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Use the following details in your JVM monitoring tool:
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
								To connect to individual JBoss EAP server JVMs running on your managed domain host, use the following URI with your <code class="literal">ApplicationRealm</code> user name and password that was created earlier.
							</p><pre class="screen">service:jmx:remote://<span class="emphasis"><em>IP_ADDRESS</em></span>:4447</pre><p class="simpara">
								To connect to different JBoss EAP servers on a single host, add the respective server’s port offset value to the above port number.
							</p></li><li class="listitem"><p class="simpara">
								To connect to the JBoss EAP host controller JVM, use the following URI with a management user name and password.
							</p><pre class="screen">service:jmx:remote://<span class="emphasis"><em>IP_ADDRESS</em></span>:9999</pre></li></ul></div></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="jconsole"/>JConsole</h1></div></div></div><p>
				A preconfigured JConsole wrapper script is bundled with JBoss EAP. Using this wrapper script ensures that all the required libraries are added to the class path, and also provides access to the JBoss EAP management CLI from within JConsole.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="connecting_to_a_local_jboss_eap_jvm_using_jconsole"/>Connecting to a Local JBoss EAP JVM Using JConsole</h2></div></div></div><p>
					To connect to a JBoss EAP JVM running on the same machine as JConsole:
				</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
							Run the <code class="literal">jconsole</code> script in <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin</code>.
						</li><li class="listitem"><p class="simpara">
							Under <span class="strong"><strong>Local Process</strong></span>, select the JBoss EAP JVM process that to want to monitor.
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
									For a standalone JBoss EAP server, there is one JBoss EAP JVM process.
								</p><div class="figure"><a id="idm139835973254000"/><p class="title"><strong>Figure 2.1. JConsole Local Standalone JBoss EAP Server JVM</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/topics/images/jconsole-local-standalone.png" alt="jconsole local standalone"/></div></div></div></li><li class="listitem"><p class="simpara">
									A JBoss EAP managed domain host has multiple JVM processes you can connect to: a host controller JVM process, a process controller JVM process, and a JVM process for each JBoss EAP server on the host. You can determine which JVM you have connected to by looking at the JVM arguments.
								</p><div class="figure"><a id="idm139835973245920"/><p class="title"><strong>Figure 2.2. JConsole Local Managed Domain JBoss EAP JVMs</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/topics/images/jconsole-local-domain.png" alt="jconsole local domain"/></div></div></div></li></ul></div></li><li class="listitem">
							Click <span class="strong"><strong>Connect</strong></span>.
						</li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="connecting_to_a_remote_jboss_eap_jvm_using_jconsole"/>Connecting to a Remote JBoss EAP JVM Using JConsole</h2></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist"><li class="listitem">
							<a class="link" href="monitoring_performance.html#configuring_remote_monitoring" title="Configuring JBoss EAP for Remote Monitoring Connections">Configure JBoss EAP for remote monitoring connections</a>.
						</li><li class="listitem">
							Download and extract a ZIP installation of JBoss EAP to your local machine. See the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/installation_guide/#downloading_zip_installation">JBoss EAP <span class="emphasis"><em>Installation Guide</em></span></a> for details.
						</li></ul></div><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
							Run the <code class="literal">jconsole</code> script in <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/bin</code>.
						</li><li class="listitem"><p class="simpara">
							Under <span class="strong"><strong>Remote Process</strong></span>, insert the URI for the remote JBoss EAP JVM process that to want to monitor.
						</p><p class="simpara">
							See the instructions on <a class="link" href="monitoring_performance.html#configuring_remote_monitoring" title="Configuring JBoss EAP for Remote Monitoring Connections">configuring JBoss EAP for remote monitoring connections</a> for the URI to use.
						</p><div class="figure"><a id="idm139835974012576"/><p class="title"><strong>Figure 2.3. JConsole Remote JBoss EAP JVM</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/topics/images/jconsole-remote.png" alt="jconsole remote"/></div></div></div></li><li class="listitem">
							Ensure that you provide the user name and password for the monitoring connection.
						</li><li class="listitem">
							Click <span class="strong"><strong>Connect</strong></span>.
						</li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="java_visualvm"/>Java VisualVM</h1></div></div></div><p>
				Java VisualVM is included with the Oracle JDK, and is located at <code class="literal"><span class="emphasis"><em>JAVA_HOME</em></span>/bin/jvisualvm</code>. If you are not using the Oracle JDK, VisualVM is also available for download from the <a class="link" href="https://visualvm.github.io/">VisualVM website</a>. Note that VisualVM does not work with the IBM JDK.
			</p><p>
				The following sections provide instructions for using VisualVM to connect to a local or remote JBoss EAP JVM. See the <a class="link" href="https://docs.oracle.com/javase/8/docs/technotes/guides/visualvm/">VisualVM documentation</a> for other information on using VisualVM.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="connecting_to_a_local_jboss_eap_jvm_using_visualvm"/>Connecting to a Local JBoss EAP JVM Using VisualVM</h2></div></div></div><p>
					To connect to a JBoss EAP JVM running on the same machine as VisualVM:
				</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
							Open VisualVM, and find the <span class="strong"><strong>Applications</strong></span> pane on the left side of the VisualVM window.
						</li><li class="listitem"><p class="simpara">
							Under <span class="strong"><strong>Local</strong></span>, double-click the JBoss EAP JVM process that you want to monitor.
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
									For a standalone JBoss EAP server, there is one JBoss EAP JVM process.
								</p><div class="figure"><a id="idm139835978346512"/><p class="title"><strong>Figure 2.4. VisualVM Local Standalone JBoss EAP Server JVM</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/topics/images/visualvm-local-standalone.png" alt="visualvm local standalone"/></div></div></div></li><li class="listitem"><p class="simpara">
									A JBoss EAP managed domain host has multiple JVM processes you can connect to: a host controller JVM process, a process controller JVM process, and a JVM process for each JBoss EAP server on the host. You can determine which JVM you have connected to by looking at the JVM arguments.
								</p><div class="figure"><a id="idm139835985664144"/><p class="title"><strong>Figure 2.5. VisualVM Local Managed Domain JBoss EAP JVMs</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/topics/images/visualvm-local-domain.png" alt="visualvm local domain"/></div></div></div></li></ul></div></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="connecting_to_a_remote_jboss_eap_jvm_using_visualvm"/>Connecting to a Remote JBoss EAP JVM Using VisualVM</h2></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist"><li class="listitem">
							<a class="link" href="monitoring_performance.html#configuring_remote_monitoring" title="Configuring JBoss EAP for Remote Monitoring Connections">Configure JBoss EAP for remote monitoring connections</a>.
						</li><li class="listitem">
							Download and extract a ZIP installation of JBoss EAP to your local machine. See the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/installation_guide/#downloading_zip_installation">JBoss EAP <span class="emphasis"><em>Installation Guide</em></span></a> for details.
						</li></ul></div><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
							You must add the required JBoss EAP libraries to your class path to remotely monitor a JBoss EAP JVM. Start VisualVM with the arguments for required libraries on your local machine. For example:
						</p><pre class="screen">$ visualvm -cp:a <span class="emphasis"><em>EAP_HOME</em></span>/bin/client/jboss-cli-client.jar  -J-Dmodule.path=<span class="emphasis"><em>EAP_HOME</em></span>/modules</pre></li><li class="listitem">
							In the <span class="strong"><strong>File</strong></span> menu, select <span class="strong"><strong>Add JMX Connection</strong></span>.
						</li><li class="listitem"><p class="simpara">
							Complete the details for your remote JBoss EAP JVM:
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									In the <span class="strong"><strong>Connection</strong></span> field, insert the URI for the remote JBoss EAP JVM process that to want to monitor. See the instructions on <a class="link" href="monitoring_performance.html#configuring_remote_monitoring" title="Configuring JBoss EAP for Remote Monitoring Connections">configuring JBoss EAP for remote monitoring connections</a> for the URI to use.
								</li><li class="listitem">
									Select the <span class="strong"><strong>Use security credentials</strong></span> check box, and enter the user name and password for the monitoring connection.
								</li><li class="listitem">
									If you are not using an SSL connection, select the <span class="strong"><strong>Do not require SSL connection</strong></span> check box.
								</li></ul></div><div class="figure"><a id="idm139835995345232"/><p class="title"><strong>Figure 2.6. VisualVM Remote JBoss EAP JVM</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/topics/images/visualvm-remote.png" alt="visualvm remote"/></div></div></div></li><li class="listitem">
							Click <span class="strong"><strong>OK</strong></span>.
						</li><li class="listitem">
							In the <span class="strong"><strong>Applications</strong></span> pane on the left side of the VisualVM window, double-click on the JMX item under the remote host to open the monitoring connection.
						</li></ol></div></div></div></div></body></html>