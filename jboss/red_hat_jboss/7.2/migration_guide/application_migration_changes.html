<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 5. Application Migration Changes</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="application_migration_changes"/>Chapter 5. Application Migration Changes</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_web_service_application_changes"/>Web Services Application Changes</h1></div></div></div><p>
				JBossWS 5 brings new features and performance improvements to JBoss EAP 7 web services, mainly through upgrades of the <a class="link" href="http://cxf.apache.org/docs/30-migration-guide.html">Apache CXF</a>, <a class="link" href="http://ws.apache.org/wss4j/">Apache WSS4J</a>, and <a class="link" href="http://santuario.apache.org/">Apache Santuario</a> components.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_jax_rpc_support_changes"/>JAX-RPC Support Changes</h2></div></div></div><p>
					The Java API for XML-based RPC (JAX-RPC) was deprecated in Java EE 6 and was optional in Java EE 7. It is no longer available or supported in JBoss EAP 7. Applications that use JAX-RPC must be migrated to use <a class="link" href="https://github.com/javaee/metro-jax-ws">JAX-WS</a>, which is the current Java EE standard web services framework.
				</p><p>
					Use of JAX-RPC web services can be identified in any of the following ways:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							The presence of a JAX-RPC mapping file, which is an XML file with the root element <code class="literal">&lt;java-wsdl-mapping&gt;</code>.
						</li><li class="listitem"><p class="simpara">
							The presence of a <code class="literal">webservices.xml</code> XML descriptor file that contains a <code class="literal">&lt;webservice-description&gt;</code> element, which includes a <code class="literal">&lt;jaxrpc-mapping-file&gt;</code> child element. The following is an example of <code class="literal">webservices.xml</code> descriptor file that defines a JAX-RPC web service.
						</p><pre class="programlisting">&lt;webservices xmlns="http://java.sun.com/xml/ns/j2ee"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://www.ibm.com/webservices/xsd/j2ee_web_services_1_1.xsd" version="1.1"&gt;
  &lt;webservice-description&gt;
    &lt;webservice-description-name&gt;HelloService&lt;/webservice-description-name&gt;
    &lt;wsdl-file&gt;WEB-INF/wsdl/HelloService.wsdl&lt;/wsdl-file&gt;
    &lt;jaxrpc-mapping-file&gt;WEB-INF/mapping.xml&lt;/jaxrpc-mapping-file&gt;
    &lt;port-component&gt;
      &lt;port-component-name&gt;Hello&lt;/port-component-name&gt;
      &lt;wsdl-port&gt;HelloPort&lt;/wsdl-port&gt;
      &lt;service-endpoint-interface&gt;org.jboss.chap12.hello.Hello&lt;/service-endpoint-interface&gt;
      &lt;service-impl-bean&gt;
        &lt;servlet-link&gt;HelloWorldServlet&lt;/servlet-link&gt;
      &lt;/service-impl-bean&gt;
    &lt;/port-component&gt;
  &lt;/webservice-description&gt;
&lt;/webservices&gt;</pre></li><li class="listitem">
							The presence of an <code class="literal">ejb-jar.xml</code> file, which contains a <code class="literal">&lt;service-ref&gt;</code> that references a JAX-RPC mapping file.
						</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_apache_cxf_spring_web_services_changes"/>Apache CXF Spring Web Services Changes</h2></div></div></div><p>
					In previous releases of JBoss EAP, you could customize the JBossWS and Apache CXF integration by including a <code class="literal">jbossws-cxf.xml</code> configuration file with the endpoint deployment archive. One use case for this was to configure interceptor chains for web service client and server endpoints on the Apache CXF bus. This integration required Spring to be deployed in the JBoss EAP server.
				</p><p>
					Spring integration is no longer supported in JBoss EAP 7. Any application that contains a <code class="literal">jbossws-cxf.xml</code> descriptor configuration file must be modified to replace the custom configuration defined in that file. While it is still possible to directly access the Apache CXF API, be aware that the application will not be portable.
				</p><p>
					The suggested approach is to replace Spring custom configurations with the new JBossWS descriptor configuration options where possible. The JBossWS descriptor-based approach provides similar functionality without requiring modification of the client endpoint code. In some cases, you can replace Spring with Context Dependency Injection (CDI).
				</p><h4><a id="apache_cxf_interceptors"/>Apache CXF Interceptors</h4><p>
					The JBossWS descriptor provides new configuration options that allow you to declare the interceptors without modifying the client endpoint code. Instead you declare interceptors within predefined client and endpoint configurations by specifying a list of interceptor class names for the <code class="literal">cxf.interceptors.in</code> and <code class="literal">cxf.interceptors.out</code> properties.
				</p><p>
					The following is an example of a <code class="literal">jaxws-endpoint-config.xml</code> file that declares interceptors using these properties.
				</p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;jaxws-config xmlns="urn:jboss:jbossws-jaxws-config:4.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:javaee="http://java.sun.com/xml/ns/javaee"
  xsi:schemaLocation="urn:jboss:jbossws-jaxws-config:4.0 schema/jbossws-jaxws-config_4_0.xsd"&gt;
  &lt;endpoint-config&gt;
    &lt;config-name&gt;org.jboss.test.ws.jaxws.cxf.interceptors.EndpointImpl&lt;/config-name&gt;
    &lt;property&gt;
      &lt;property-name&gt;cxf.interceptors.in&lt;/property-name&gt;
      &lt;property-value&gt;org.jboss.test.ws.jaxws.cxf.interceptors.EndpointInterceptor,org.jboss.test.ws.jaxws.cxf.interceptors.FooInterceptor&lt;/property-value&gt;
    &lt;/property&gt;
    &lt;property&gt;
      &lt;property-name&gt;cxf.interceptors.out&lt;/property-name&gt;
      &lt;property-value&gt;org.jboss.test.ws.jaxws.cxf.interceptors.EndpointCounterInterceptor&lt;/property-value&gt;
    &lt;/property&gt;
  &lt;/endpoint-config&gt;
&lt;/jaxws-config&gt;</pre><h4><a id="apache_cxf_features"/>Apache CXF Features</h4><p>
					The JBossWS descriptor allows you to declare features within predefined client and endpoint configurations by specifying a list of feature class names for the <code class="literal">cxf.features</code> property.
				</p><p>
					The following is an example of a <code class="literal">jaxws-endpoint-config.xml</code> file that declares a feature using this property.
				</p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;jaxws-config xmlns="urn:jboss:jbossws-jaxws-config:4.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:javaee="http://java.sun.com/xml/ns/javaee"
  xsi:schemaLocation="urn:jboss:jbossws-jaxws-config:4.0 schema/jbossws-jaxws-config_4_0.xsd"&gt;
  &lt;endpoint-config&gt;
    &lt;config-name&gt;Custom FI Config&lt;/config-name&gt;
    &lt;property&gt;
      &lt;property-name&gt;cxf.features&lt;/property-name&gt;
      &lt;property-value&gt;org.apache.cxf.feature.FastInfosetFeature&lt;/property-value&gt;
    &lt;/property&gt;
  &lt;/endpoint-config&gt;
&lt;/jaxws-config&gt;</pre><h4><a id="apache_cxf_http_transport"/>Apache CXF HTTP Transport</h4><p>
					In Apache CXF, HTTP transport configuration is achieved by specifying <code class="literal">org.apache.cxf.transport.http.HTTPConduit</code> options. JBossWS integration allows conduits to be modified programmatically using the Apache CXF API as follows.
				</p><pre class="programlisting">import org.apache.cxf.frontend.ClientProxy;
import org.apache.cxf.transport.http.HTTPConduit;
import org.apache.cxf.transports.http.configuration.HTTPClientPolicy;

// Set chunking threshold before using a JAX-WS port client
...
HTTPConduit conduit = (HTTPConduit)ClientProxy.getClient(port).getConduit();
HTTPClientPolicy client = conduit.getClient();

client.setChunkingThreshold(8192);
...</pre><p>
					You can also control and override the Apache CXF <code class="literal">HTTPConduit</code> default values by setting system properties.
				</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Property</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									cxf.client.allowChunking
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Boolean
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Specifies whether to send requests using chunking.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									cxf.client.chunkingThreshold
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Integer
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Sets the threshold at which switching from non-chunking to chunking mode.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									cxf.client.connectionTimeout
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Long
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Sets the number of milliseconds for the connection timeout.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									cxf.client.receiveTimeout
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Long
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Sets the number of milliseconds for the receive timeout.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									cxf.client.connection
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									String
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Specifies whether to use the <code class="literal">Keep-Alive</code> or <code class="literal">close</code> connection type.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									cxf.tls-client.disableCNCheck
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Boolean
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Specifies whether to disable the CN host name check.
								</p>
								 </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_ws_security_changes"/>WS-Security Changes</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							If your application contains a custom callback handler that accesses the <code class="literal">org.apache.ws.security.WSPasswordCallback</code> class, be aware that this class has moved to package <code class="literal">org.apache.wss4j.common.ext</code>.
						</li><li class="listitem">
							Most of the SAML bean objects from the <code class="literal">org.apache.ws.security.saml.ext</code> package have been moved to the <code class="literal">org.apache.wss4j.common.saml package</code>.
						</li><li class="listitem">
							Use the RSA v1.5 key transport and all related algorithms are disallowed by default.
						</li><li class="listitem">
							The Security Token Service (STS) previously only validated <code class="literal">onBehalfOf</code> tokens. It now also validates <code class="literal">ActAs</code> tokens. As a consequence, a valid username and password must be specified in the <code class="literal">UsernameToken</code> that is provided for the <code class="literal">ActAs</code> token.
						</li><li class="listitem">
							SAML Bearer tokens are now required to have an internal signature. The <code class="literal">org.apache.wss4j.dom.validate.SamlAssertionValidator</code> class now has a <code class="literal">setRequireBearerSignature()</code> method to enable or disable the signature verification.
						</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_jboss_modules_structure_change"/>JBoss Modules Structure Change</h2></div></div></div><p>
					The <code class="literal">cxf-api</code> and <code class="literal">cxf-rt-core</code> JARs have been merged into one <code class="literal">cxf-core</code> JAR. As a consequence, the <code class="literal">org.apache.cxf</code> module in JBoss EAP now contains the <code class="literal">cxf-core</code> JAR and exposes more classes than in the previous release.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_bouncy_castle_requirements_and_changes"/>Bouncy Castle Requirements and Changes</h2></div></div></div><p>
					If you want to use AES encryption with Galois/Counter Mode (GCM) for symmetric encryption in XML/WS-Security, you need the BouncyCastle Security Provider.
				</p><p>
					JBoss EAP 7 ships with the <code class="literal">org.bouncycastle</code> module and JBossWS is now able to rely on its class loader to get and use the BouncyCastle Security Provider. Therefore it is no longer necessary to statically install BouncyCastle in the current JVM. For applications running outside of the container, the security provider can be made available to JBossWS by adding a BouncyCastle library to the class path.
				</p><p>
					You can disable this behavior by setting the <code class="literal">org.jboss.ws.cxf.noLocalBC</code> property value to <code class="literal">true</code> in the <code class="literal">jaxws-endpoint-config.xml</code> deployment descriptor file for the server or the <code class="literal">jaxws-client-config.xml</code> descriptor file for clients.
				</p><p>
					If you want to use a different version than the one that ships with JBoss EAP, you can still statically install BouncyCastle to the JVM. In that case, the statically installed BouncyCastle Security Provider is chosen over the provider present in the class path. To avoid any issues, you must use BouncyCastle 1.49, 1.51, or greater.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_apache_cxf_bus_selection_strategy"/>Apache CXF Bus Selection Strategy</h2></div></div></div><p>
					The default bus selection strategy for clients running in-container has changed from <code class="literal">THREAD_BUS</code> to <code class="literal">TCCL_BUS</code>. For clients running out-of container, the default strategy is still <code class="literal">THREAD_BUS</code>. You can restore the behavior to that of the previous release by using either of the following methods.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							Boot the JBoss EAP server with the system property <code class="literal">org.jboss.ws.cxf.jaxws-client.bus.strategy</code> value set to <code class="literal">THREAD_BUS</code>.
						</li><li class="listitem">
							Explicitly set the selection strategy in the client code.
						</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_jax_ws_2_2_requirements_for_webserviceref"/>JAX-WS 2.2 Requirements for WebServiceRef</h2></div></div></div><p>
					Containers must use JAX-WS 2.2 style constructors, which include the <a class="link" href="https://docs.oracle.com/javase/8/docs/api/javax/xml/ws/WebServiceFeature.html">WebServiceFeature</a> class as an argument in the constructor, to build clients that are injected into web service references. JBoss EAP 6.4, which ships with JBossWS 4, hides that requirement. JBoss EAP 7 ships with JBossWS 5, which no longer hides this requirement. This means that user provided service classes injected by the container must implement JAX-WS 2.2 or later by updating the existing code to use the <a class="link" href="https://docs.oracle.com/javase/8/docs/api/javax/xml/ws/Service.html#Service(java.net.URL,%20javax.xml.namespace.QName,%20javax.xml.ws.WebServiceFeature%2E%2E%2E)"><code class="literal">javax.xml.ws.Service</code></a> constructor that includes one or more <code class="literal">WebServiceFeature</code> arguments.
				</p><pre class="programlisting">protected Service(URL wsdlDocumentLocation,
       QName serviceName,
       WebServiceFeature... features)</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_ignorehttphost_cn_check_change"/>IgnoreHttpsHost CN Check Change</h2></div></div></div><p>
					In previous releases, you could disable the HTTPS URL hostname check against a service’s Common Name (CN) given in its certificate by setting the system property <code class="literal">org.jboss.security.ignoreHttpsHost</code> to <code class="literal">true</code>. This system property name has been replaced with <code class="literal">cxf.tls-client.disableCNCheck</code>.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_server_side_configuration_and_class_loading"/>Server Side Configuration and Class Loading</h2></div></div></div><p>
					As a consequence of enabling injections into service endpoint and service client handlers, it is no longer possible to automatically load handler classes from the <code class="literal">org.jboss.as.webservices.server.integration</code> JBoss module. If your application depends on a given predefined configuration, you might need to explicitly define new module dependencies for your deployment. For more information, see <a class="link" href="application_migration_changes.html#migrate_explicit_module_dependencies" title="Migrate Explicit Module Dependencies">Migrate Explicit Module Dependencies</a>
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migate_deprecation_of_java_endorsed_standards_override_mechanism"/>Deprecation of Java Endorsed Standards Override Mechanism</h2></div></div></div><p>
					The <a class="link" href="https://docs.oracle.com/javase/8/docs/technotes/guides/standards/">Java Endorsed Standards Override Mechanism</a> was deprecated in JDK 1.8_40 with intent to remove it in JDK 9. This mechanism allowed developers to make libraries available to all deployed applications by placing JARs into an endorsed directory within the JRE.
				</p><p>
					If your application uses the JBossWS implementation of Apache CXF, JBoss EAP 7 ensures the required dependencies are added in the correct order and you should not be impacted by this change. If your application accesses Apache CXF directly, you must now provide the Apache CXF dependencies after the JBossWS dependencies as part of your application deployment.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_specification_of_descriptor_in_ear_archive"/>Specification of Descriptor in EAR Archive</h2></div></div></div><p>
					In previous releases of JBoss EAP, you could configure the <code class="literal">jboss-webservices.xml</code> deployment descriptor file for EJB web service deployments in the <code class="literal">META-INF/</code> directory of JAR archives or in the <code class="literal">WEB-INF/</code> directory for POJO web service deployments and EJB web service endpoints bundled in WAR archives.
				</p><p>
					In JBoss EAP 7, you can now configure the <code class="literal">jboss-webservices.xml</code> deployment descriptor file in the <code class="literal">META-INF/</code> directory of an EAR archive. If a <code class="literal">jboss-webservices.xml</code> file is found both in the EAR archive and the JAR or WAR archive, the configuration data in the <code class="literal">jboss-webservices.xml</code> file for the JAR or WAR overrides the corresponding data in the EAR descriptor file.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_default_remote_url_connector_and_port_changes"/>Update the Remote URL Connector and Port</h1></div></div></div><p>
				In JBoss EAP 7, the default connector has changed from <code class="literal">remote</code> to <code class="literal">http-remoting</code> and the default remote connection port has changed from <code class="literal">4447</code> to <code class="literal">8080</code>. The JNDI provider URL for the default configuration has changed from <code class="literal">remote://localhost:4447</code> to <code class="literal">http-remoting://localhost:8080</code>.
			</p><p>
				If you use the JBoss EAP 7 <code class="literal">migrate</code> operation to update your configuration, you do not need to modify the remote connector, remote port, or JNDI provider URLs because the migration operation preserves the JBoss EAP 6 remoting connector and <code class="literal">4447</code> port configuration settings in the subsystem configuration. For more information about the <code class="literal">migrate</code> operation, see <a class="link" href="server_configuration_changes.html#management_cli_migration_operation" title="Management CLI Migration Operation">Management CLI Migration Operation</a>.
			</p><p>
				If you do not use the <code class="literal">migrate</code> operation and instead run with the new JBoss EAP 7 default configuration, you must change the remote connector, remote port, and JNDI provider URL to use the new settings as described above.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_messaging_application_changes"/>Messaging Application Changes</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_messaging_application_jms_deployment_descriptors"/>Replace or Update JMS Deployment Descriptors</h2></div></div></div><p>
					The proprietary HornetQ JMS resource deployment descriptor files identified by the naming pattern <code class="literal">-jms.xml</code> no longer work in JBoss EAP 7. The following is an example of a JMS resource deployment descriptor file in JBoss EAP 6.
				</p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;messaging-deployment xmlns="urn:jboss:messaging-deployment:1.0"&gt;
  &lt;hornetq-server&gt;
    &lt;jms-destinations&gt;
      &lt;jms-queue name="testQueue"&gt;
        &lt;entry name="queue/test"/&gt;
        &lt;entry name="java:jboss/exported/jms/queue/test"/&gt;
      &lt;/jms-queue&gt;
      &lt;jms-topic name="testTopic"&gt;
        &lt;entry name="topic/test"/&gt;
        &lt;entry name="java:jboss/exported/jms/topic/test"/&gt;
      &lt;/jms-topic&gt;
    &lt;/jms-destinations&gt;
  &lt;/hornetq-server&gt;
&lt;/messaging-deployment&gt;</pre><p>
					If you used <code class="literal">-jms.xml</code> JMS deployment descriptors in your application in the previous release, you can either convert your application to use the standard Java EE deployment descriptor as specified in section EE.5.18 of the <a class="link" href="http://download.oracle.com/otn-pub/jcp/java_ee-7-fr-spec/JavaEE_Platform_Spec.pdf">Java EE 7 specification</a> or you can update the deployment descriptor to use the <code class="literal">messaging-activemq-deployment</code> schema instead.
				</p><p>
					If you choose to update the descriptor, you need to make the following modifications.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							Change the namespace from "urn:jboss:messaging-deployment:1.0" to "urn:jboss:messaging-activemq-deployment:1.0".
						</li><li class="listitem">
							Change the <code class="literal">&lt;hornetq-server&gt;</code> element name to <code class="literal">&lt;server&gt;</code>.
						</li></ul></div><p>
					The modified file should look like the following example.
				</p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;messaging-deployment xmlns="urn:jboss:messaging-activemq-deployment:1.0"&gt;
  &lt;server&gt;
    &lt;jms-destinations&gt;
      &lt;jms-queue name="testQueue"&gt;
        &lt;entry name="queue/test"/&gt;
        &lt;entry name="java:jboss/exported/jms/queue/test"/&gt;
      &lt;/jms-queue&gt;
      &lt;jms-topic name="testTopic"&gt;
        &lt;entry name="topic/test"/&gt;
        &lt;entry name="java:jboss/exported/jms/topic/test"/&gt;
      &lt;/jms-topic&gt;
    &lt;/jms-destinations&gt;
  &lt;/server&gt;
&lt;/messaging-deployment&gt;</pre><p>
					For information about server configuration changes related to messaging, see <a class="link" href="server_configuration_changes.html#migrate_messaging_server_configuration_changes" title="Messaging Server Configuration Changes">Messaging Server Configuration Changes</a>.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_messaging_application_external_jms_clients"/>Update External JMS Clients</h2></div></div></div><p>
					JBoss EAP 7 still supports the JMS 1.1 API, so you do not need to modify your code.
				</p><p>
					The default remote connector and port has changed in JBoss EAP 7. For details about this change, see <a class="link" href="application_migration_changes.html#migrate_default_remote_url_connector_and_port_changes" title="Update the Remote URL Connector and Port">Update the Remote URL Connector and Port</a>.
				</p><p>
					If you migrate your server configuration using the <code class="literal">migrate</code> operation, the old settings are preserved and you do not need to update your <code class="literal">PROVIDER_URL</code>. However, if you run with the new JBoss EAP 7 default configuration, you must change the <code class="literal">PROVIDER_URL</code> in the client code to use the new <code class="literal">http-remoting://localhost:8080</code> setting. For more information, see <a class="link" href="application_migration_changes.html#migrate_remote_naming_client_code" title="Migrate Remote Naming Client Code">Migrate Remote Naming Client Code</a>.
				</p><p>
					If you plan to migrate your code to use the JMS 2.0 API, see the <code class="literal">helloworld-jms</code> quickstart for a working example.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_messaging_application_hornetq_api"/>Replace the HornetQ API</h2></div></div></div><p>
					JBoss EAP 6 included the <code class="literal">org.hornetq</code> module, which allowed you to use the <a class="link" href="https://access.redhat.com/documentation/en-US/JBoss_Enterprise_Application_Platform/6.4/html/API_Documentation/files/javadoc/index.html?org/hornetq/api/core/package-summary.html">HornetQ API</a> in your application source code.
				</p><p>
					Apache ActiveMQ Artemis replaces HornetQ in JBoss EAP 7, so you must migrate any code that used the HornetQ API to use the <a class="link" href="https://activemq.apache.org/artemis/docs/javadocs/javadoc-1.2.0/index.html">Apache ActiveMQ Artemis API</a>. The libraries for this API are included in the <code class="literal">org.apache.activemq.artemis</code> module.
				</p><p>
					ActiveMQ Artemis is an evolution of HornetQ, so many of the concepts still apply.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="replace_deprecated_address_setting_attributes"/>Replace Deprecated Address Setting Attributes</h2></div></div></div><p>
					The ability to auto-create and auto-delete topics and queues using the <code class="literal">auto-create-jms-queues</code>, <code class="literal">auto-delete-jms-queues</code>, <code class="literal">auto-create-jms-topics</code>, and <code class="literal">auto-delete-jms-topics</code> attributes was only partially implemented and not fully configurable in JBoss EAP 7. These attributes, which are deprecated, were provided as a <a class="link" href="https://access.redhat.com/support/offerings/techpreview">technology preview feature</a> only and were not supported.
				</p><p>
					You must replace any usage of these deprecated attributes with the following replacement attributes.
				</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						The deprecated attributes no longer configure this functionality in JBoss EAP 7.2 and do not take effect. The replacement attributes are not supported either. They are provided only as a way to migrate on the best effort basis.
					</p></div><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Deprecated Attribute</th><th style="text-align: left" valign="top">Replacement Attribute</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									auto-create-jms-queues
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									auto-create-queues
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									auto-delete-jms-queues
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									auto-delete-queues
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									auto-create-jms-topics
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									auto-create-addresses
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									auto-delete-jms-topics
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									auto-delete-addresses
								</p>
								 </td></tr></tbody></table></div><p>
					For more information about these replacement attributes, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/configuring_messaging/#address_setting_attributes">Address Setting Attributes</a> in the <span class="emphasis"><em>Configuring Messaging</em></span>.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_messaging_application_changes_7_2"/>Messaging Application Changes Required for JBoss EAP 7.2</h2></div></div></div><p>
					Starting with JBoss EAP 7.2, if a client application directly depends on Artemis client JARs, for example, <code class="literal">artemis-jms-client</code>, <code class="literal">artemis-commons</code>, <code class="literal">artemis-core-client</code>, or <code class="literal">artemis-selector</code>, then you must add the following dependency in your <code class="literal">pom.xml</code> file for <code class="literal">wildfly-client-properties</code>.
				</p><pre class="programlisting">&lt;dependency&gt;
  &lt;groupId&gt;org.jboss.eap&lt;/groupId&gt;
  &lt;artifactId&gt;wildfly-client-properties&lt;/artifactId&gt;
&lt;/dependency&gt;</pre><p>
					This is to avoid a <code class="literal">JMSRuntimeException</code> when calling <code class="literal">message.getJMSReplyTo()</code> from an older JBoss EAP 7 client as described in <a class="link" href="https://issues.jboss.org/browse/JBEAP-15889">JBEAP-15889</a>.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_jax_rs_and_resteasy_application_changes"/>JAX-RS and RESTEasy Application Changes</h1></div></div></div><p>
				JBoss EAP 6 bundled RESTEasy 2, which was an implementation of JAX-RS 1.x.
			</p><p>
				JBoss EAP 7.0 and JBoss EAP 7.1 included RESTEasy 3.0.x, which is an implementation of JAX-RS 2.0 as defined by the <a class="link" href="https://jcp.org/en/jsr/detail?id=339">JSR 339: JAX-RS 2.0: The Java API for RESTful Web Services</a> specification. For more information about the Java API for RESTful Web Services, see the <a class="link" href="https://jax-rs.github.io/apidocs/2.0/">JAX-RS 2.0 API Specification</a>.
			</p><p>
				JBoss EAP 7.2 includes RESTEasy 3.6.1, which is an implementation of JAX-RS 2.1 as defined by the <a class="link" href="https://jcp.org/en/jsr/detail?id=370">JSR 370: Java(TM )API for RESTful Web Services (JAX-RS 2.1) Specification</a>. This release also adds support for JDK 11. While providing some of the RESTEasy 4 key features, this release is based on RESTEasy 3.0, ensuring full backward compatibility. As a result, you should encounter few issues when migrating from RESTEasy 3.0.x to 3.6.1. For more information about the Java API for RESTEasy 3.6.1, see <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/">RESTEasy JAX-RS 3.6.1.Final API</a>.
			</p><p>
				If you are migrating from JBoss EAP 6.4, be aware that the version of Jackson included in JBoss EAP has changed. JBoss EAP 6.4 included Jackson 1.9.9. JBoss EAP 7 and later now include Jackson 2.6.3 or greater.
			</p><p>
				This section describes how these changes might impact applications that use RESTEasy or JAX-RS.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_resteasy_deprecated_classes"/>RESTEasy Deprecated Classes</h2></div></div></div><h4><a id="interceptor_and_messagebody_classes"/>Interceptor and MessageBody Classes</h4><p>
					<a class="link" href="https://jcp.org/en/jsr/detail?id=311">JSR 311: JAX-RS: The Java™ API for RESTful Web Services</a> did not include an interceptor framework, so RESTEasy 2 provided one. <a class="link" href="https://jcp.org/en/jsr/detail?id=339">JSR 339: JAX-RS 2.0: The Java API for RESTful Web Services</a> introduced an official interceptor and filter framework, so the interceptor framework included in RESTEasy 2 is now deprecated, and was replaced by the JAX-RS compliant interceptor facility in RESTEasy 3.x. The relevant interfaces are defined in the <code class="literal">javax.ws.rs.ext</code> package of the <code class="literal">jaxrs-api</code> module.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
							The following interceptor interfaces are deprecated in RESTEasy 3.x.
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/spi/interception/PreProcessInterceptor.html"><code class="literal">org.jboss.resteasy.spi.interception.PreProcessInterceptor</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/spi/interception/PostProcessInterceptor.html"><code class="literal">org.jboss.resteasy.spi.interception.PostProcessInterceptor</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/spi/interception/ClientExecutionInterceptor.html"><code class="literal">org.jboss.resteasy.spi.interception.ClientExecutionInterceptor</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/spi/interception/ClientExecutionContext.html"><code class="literal">org.jboss.resteasy.spi.interception.ClientExecutionContext</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/spi/interception/AcceptedByMethod.html"><code class="literal">org.jboss.resteasy.spi.interception.AcceptedByMethod</code></a>
								</li></ul></div></li><li class="listitem">
							The <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/spi/interception/PreProcessInterceptor.html"><code class="literal">org.jboss.resteasy.spi.interception.PreProcessInterceptor</code></a> interface was replaced by the <a class="link" href="https://jax-rs.github.io/apidocs/2.1/index.html?javax/ws/rs/container/ContainerRequestFilter.html"><code class="literal">javax.ws.rs.container.ContainerRequestFilter</code></a> interface in RESTEasy 3.x.
						</li><li class="listitem"><p class="simpara">
							The following interfaces and classes are also deprecated in RESTEasy 3.x.
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/spi/interception/MessageBodyReaderInterceptor.html"><code class="literal">org.jboss.resteasy.spi.interception.MessageBodyReaderInterceptor</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/spi/interception/MessageBodyWriterInterceptor.html"><code class="literal">org.jboss.resteasy.spi.interception.MessageBodyWriterInterceptor</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/spi/interception/MessageBodyWriterContext.html"><code class="literal">org.jboss.resteasy.spi.interception.MessageBodyWriterContext</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/spi/interception/MessageBodyReaderContext.html"><code class="literal">org.jboss.resteasy.spi.interception.MessageBodyReaderContext</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/core/interception/InterceptorRegistry.html"><code class="literal">org.jboss.resteasy.core.interception.InterceptorRegistry</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/core/interception/InterceptorRegistryListener.html"><code class="literal">org.jboss.resteasy.core.interception.InterceptorRegistryListener</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/core/interception/ClientExecutionContextImpl.html"><code class="literal">org.jboss.resteasy.core.interception.ClientExecutionContextImpl</code></a>
								</li></ul></div></li><li class="listitem">
							The <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/spi/interception/MessageBodyWriterInterceptor.html"><code class="literal">org.jboss.resteasy.spi.interception.MessageBodyWriterInterceptor</code></a> interface was replaced by the <a class="link" href="https://jax-rs.github.io/apidocs/2.1/index.html?javax/ws/rs/ext/WriterInterceptor.html"><code class="literal">javax.ws.rs.ext.WriterInterceptor</code></a> interface.
						</li><li class="listitem"><p class="simpara">
							In addition, some changes to the <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/spi/interception/MessageBodyWriterInterceptor.html"><code class="literal">javax.ws.rs.ext.MessageBodyWriter</code></a> interface might not be backward compatible with respect to JAX-RS 1.x. If your application used JAX-RS 1.x, review your application code to make sure you define <code class="literal">@Produces</code> or <code class="literal">@Consumes</code> for your endpoints. Failure to do so might result in an error similar to the following.
						</p><pre class="screen">org.jboss.resteasy.core.NoMessageBodyWriterFoundFailure: Could not find MessageBodyWriter for response object of type: &lt;OBJECT&gt; of media type:</pre><p class="simpara">
							The following is an example of a REST endpoint that can cause this error.
						</p><pre class="programlisting">@Path("dates")
public class DateService {

    @GET
    @Path("daysuntil/{targetdate}")
    public long showDaysUntil(@PathParam("targetdate") String targetDate) {
        DateLogger.LOGGER.logDaysUntilRequest(targetDate);
        final long days;

        try {
            final LocalDate date = LocalDate.parse(targetDate, DateTimeFormatter.ISO_DATE);
            days = ChronoUnit.DAYS.between(LocalDate.now(), date);
        } catch (DateTimeParseException ex) {
          // ** DISCLAIMER **. This example is contrived.
          throw new WebApplicationException(Response.status(400).entity(ex.getLocalizedMessage()).type(MediaType.TEXT_PLAIN)
              .build());
        }
        return days;
    }
}</pre><p class="simpara">
							To fix the issue, add the import for <code class="literal">javax.ws.rs.Produces</code> and the <code class="literal">@Produces</code> annotation as follows.
						</p><pre class="programlisting">...
import javax.ws.rs.Produces;
...

@Path("dates")
public class DateService {

    @GET
    @Path("daysuntil/{targetdate}")
    @Produces(MediaType.TEXT_PLAIN)
    public long showDaysUntil(@PathParam("targetdate") String targetDate) {
        DateLogger.LOGGER.logDaysUntilRequest(targetDate);
        final long days;

        try {
            final LocalDate date = LocalDate.parse(targetDate, DateTimeFormatter.ISO_DATE);
            days = ChronoUnit.DAYS.between(LocalDate.now(), date);
        } catch (DateTimeParseException ex) {
          // ** DISCLAIMER **. This example is contrived.
          throw new WebApplicationException(Response.status(400).entity(ex.getLocalizedMessage()).type(MediaType.TEXT_PLAIN)
              .build());
        }
        return days;
    }
}</pre></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						All interceptors from the previous release of RESTEasy can run in parallel with the new JAX-RS filter and interceptor interfaces.
					</p></div><p>
					For more information about interceptors, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/developing_web_services_applications/#resteasy_interceptors">RESTEasy Interceptors</a> in <span class="emphasis"><em>Developing Web Services Applications</em></span> for JBoss EAP.
				</p><p>
					For more information about the new replacement API, see the <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/index.html">RESTEasy JAX-RS 3.6.1.Final API</a>.
				</p><h4><a id="client_api"/>Client API</h4><p>
					The RESTEasy client framework in <code class="literal">resteasy-jaxrs</code> was replaced by the JAX-RS 2.0 compliant <code class="literal">resteasy-client</code> module in JBoss EAP 7.0. As a result, some RESTEasy client API classes and methods are deprecated.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
							The following classes are deprecated.
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/client/ClientRequest.html"><code class="literal">org.jboss.resteasy.client.ClientRequest</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/client/ClientRequestFactory.html"><code class="literal">org.jboss.resteasy.client.ClientRequestFactory</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/client/ClientResponse.html"><code class="literal">org.jboss.resteasy.client.ClientResponse</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/client/ProxyBuilder.html"><code class="literal">org.jboss.resteasy.client.ProxyBuilder</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/client/ProxyConfig.html"><code class="literal">org.jboss.resteasy.client.ProxyConfig</code></a>
								</li><li class="listitem">
									<a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/client/ProxyFactory.html"><code class="literal">org.jboss.resteasy.client.ProxyFactory</code></a>
								</li></ul></div></li><li class="listitem">
							The <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/client/ClientResponseFailure.html"><code class="literal">org.jboss.resteasy.client.ClientResponseFailure</code></a> exception and the <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/client/ClientExecutor.html"><code class="literal">org.jboss.resteasy.client.ClientExecutor</code></a> and <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/client/EntityTypeFactory.html"><code class="literal">org.jboss.resteasy.client.EntityTypeFactory</code></a> interfaces are also deprecated.
						</li><li class="listitem"><p class="simpara">
							You must replace the <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/client/ClientRequest.html"><code class="literal">org.jboss.resteasy.client.ClientRequest</code></a> and <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/client/ClientResponse.html"><code class="literal">org.jboss.resteasy.client.ClientResponse</code></a> classes with <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/client/jaxrs/ResteasyClient.html"><code class="literal">org.jboss.resteasy.client.jaxrs.ResteasyClient</code></a> and <a class="link" href="https://jax-rs.github.io/apidocs/2.1//javax/ws/rs/core/Response.html"><code class="literal">javax.ws.rs.core.Response</code></a> respectively.
						</p><p class="simpara">
							The following is an example of how to send a link header with the RESTEasy client in RESTEasy 2.3.x.
						</p><pre class="programlisting">ClientRequest request = new ClientRequest(generateURL("/linkheader/str"));
request.addLink("previous chapter", "previous", "http://example.com/TheBook/chapter2", null);
ClientResponse response = request.post();
LinkHeader header = response.getLinkHeader();</pre><p class="simpara">
							The following is an example of how to accomplish the same task with the RESTEasy client in RESTEasy 3.
						</p><pre class="programlisting">ResteasyClient client = new ResteasyClientBuilder().build();
Response response = client.target(generateURL("/linkheader/str")).request()
    .header("Link", "&lt;http://example.com/TheBook/chapter2&gt;; rel=\"previous\";
title=\"previous chapter\"").post(Entity.text(new String()));
javax.ws.rs.core.Link link = response.getLink("previous");</pre><p class="simpara">
							See the <code class="literal">resteasy-jaxrs-client</code> quickstart for an example of an external JAX-RS RESTEasy client that interacts with a JAX-RS Web service.
						</p></li><li class="listitem">
							The classes and interfaces in the <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/client/cache/package-frame.html"><code class="literal">org.jboss.resteasy.client.cache</code></a> package are also deprecated. They are replaced by equivalent classes and interfaces in the <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/client/jaxrs/cache/package-frame.html"><code class="literal">org.jboss.resteasy.client.jaxrs.cache</code></a> package.
						</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						For more information about the <code class="literal">org.jboss.resteasy.client.jaxrs</code> API classes, see the <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/">RESTEasy JAX-RS JavaDoc</a>.
					</p></div><h4><a id="stringconverter"/>StringConverter</h4><p>
					The <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/spi/StringConverter.html"><code class="literal">org.jboss.resteasy.spi.StringConverter</code></a> class is deprecated in RESTEasy 3.x. This functionality can be replaced using the JAX-RS <a class="link" href="https://jax-rs.github.io/apidocs/2.1/index.html?javax/ws/rs/ext/ParamConverterProvider.html">jax.ws.rs.ext.ParamConverterProvider</a> class.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_removed_or_protected_resteasy_classes"/>Removed or Protected RESTEasy Classes</h2></div></div></div><h4><a id="resteasyproviderfactory_add_methods"/>ResteasyProviderFactory Add methods</h4><p>
					Most of the <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/javadocs/org/jboss/resteasy/spi/ResteasyProviderFactory.html"><code class="literal">org.jboss.resteasy.spi.ResteasyProviderFactory</code></a> <code class="literal">add()</code> methods have been removed or made protected in RESTEasy 3.0. For example, the <code class="literal">addBuiltInMessageBodyReader()</code> and <code class="literal">addBuiltInMessageBodyWriter()</code> methods have been removed and the <code class="literal">addMessageBodyReader()</code> and <code class="literal">addMessageBodyWriter()</code> methods have been made protected.
				</p><p>
					You should now use the <code class="literal">registerProvider()</code> and <code class="literal">registerProviderInstance()</code> methods.
				</p><h4><a id="additional_classes_removed_from_resteasy_3"/>Additional Classes Removed From RESTEasy 3</h4><p>
					The <code class="literal">@org.jboss.resteasy.annotations.cache.ServerCached</code> annotation, which specified the response to the JAX-RS method should be cached on the server, was removed from RESTEasy 3 and must be removed from the application code.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_additonal_resteasy_changes"/>Additional RESTEasy Changes</h2></div></div></div><h4><a id="signedinput_and_signedouput"/>SignedInput and SignedOuput</h4><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<code class="literal">SignedInput</code> and <code class="literal">SignedOutput</code> for <code class="literal">resteasy-crypto</code> must have the <code class="literal">Content-Type</code> set to <code class="literal">multipart/signed</code> in either the <code class="literal">Request</code> or <code class="literal">Response</code> object, or by using the <code class="literal">@Consumes</code> or <code class="literal">@Produces</code> annotation.
						</li><li class="listitem">
							<code class="literal">SignedOutput</code> and <code class="literal">SignedInput</code> can be used to return the <code class="literal">application/pkcs7-signature</code> MIME type format in binary form by setting that type in the <code class="literal">@Produces</code> or <code class="literal">@Consumes</code> annotations.
						</li><li class="listitem">
							If the <code class="literal">@Produces</code> or <code class="literal">@Consumes</code> is <code class="literal">text/plain</code> MIME type, <code class="literal">SignedOutput</code> will be base64 encoded and sent as a String.
						</li></ul></div><h4><a id="security_filters"/>Security Filters</h4><p>
					The security filters for <code class="literal">@RolesAllowed</code>, <code class="literal">@PermitAll</code>, and <code class="literal">@DenyAll</code> now return "403 Forbidden" instead of "401 Unauthorized".
				</p><h4><a id="client_side_filters"/>Client-side Filters</h4><p>
					The client-side filters that were introduced in JAX-RS 2.0 will not be bound and run when you are using the RESTEasy client API from a release prior to RESTEasy 3.0.
				</p><h4><a id="asynchronous_http_support"/>Asynchronous HTTP Support</h4><p>
					Because the JAX-RS 2.0 specification added asynchronous HTTP support using the <code class="literal">@Suspended</code> annotation and the <code class="literal">AsynResponse</code> interface, the RESTEasy proprietary API for asynchronous HTTP was deprecated and might be removed in a future RESTEasy release. The asynchronous Tomcat and asynchronous JBoss Web modules have also been removed from the server installation. If you are not using the Servlet 3.0 container or higher, asynchronous HTTP server-side processing will be simulated and run synchronously in same request thread.
				</p><h4><a id="server_side_cache"/>Server-side Cache</h4><p>
					Server-side cache setup has changed. Please see the <a class="link" href="https://docs.jboss.org/resteasy/docs/3.6.1.Final/userguide/html_single/">RESTEasy Documentation</a> for more information.
				</p><h4><a id="migrate_resteasy_yaml_provider_setting_changes"/>YAML Provider Setting Changes</h4><p>
					In previous releases of JBoss EAP, the RESTEasy YAML provider setting was enabled by default. This has changed in JBoss EAP 7. The YAML provider is now disabled by default. Its use is not supported due to a security issue in the <code class="literal">SnakeYAML</code> library used by RESTEasy for unmarshalling and it must be explicitly enabled in the application. For information about how to enable the YAML provider in your application and add the Maven dependencies, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/developing_web_services_applications/#jaxrs_yaml_provider">YAML Provider</a> in <span class="emphasis"><em>Developing Web Services Applications</em></span> for JBoss EAP.
				</p><h4><a id="migrate_resteasy_default_charset_utf8_in_content_type_header"/>Default Charset UTF-8 in Content-Type Header</h4><p>
					As of JBoss EAP 7.1, the <code class="literal">resteasy.add.charset</code> parameter is set to <code class="literal">true</code> by default. You can set the <code class="literal">resteasy.add.charset</code> parameter to <code class="literal">false</code> if you do not want RESTEasy to add <code class="literal">charset=UTF-8</code> to the returned content-type header when the resource method returns a <code class="literal">text/*</code> or <code class="literal">application/xml*</code> media type without an explicit charset.
				</p><p>
					For more information about text media types and character sets, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/developing_web_services_applications/#text_media_types_charsets">Text Media Types and Character Sets</a> in <span class="emphasis"><em>Developing Web Services Applications</em></span> for JBoss EAP.
				</p><h4><a id="migrate_resteasy_serializableprovider"/>SerializableProvider</h4><p>
					Deserializing Java objects from untrusted sources is not safe. For this reason, in JBoss EAP 7, the <code class="literal">org.jboss.resteasy.plugins.providers.SerializableProvider</code> class is disabled by default, and it is not recommended to use this provider.
				</p><h4><a id="migrate_resteasy_matching_requests_to_resource_methods"/>Matching Requests to Resource Methods</h4><p>
					In RESTEasy 3, improvements and corrections were made to the implementation of matching rules, as defined in the JAX-RS specification. In particular, a change was made to how an ambiguous URI on a sub-resource method and a sub-resource locator is handled.
				</p><p>
					In RESTEasy 2, it was possible for a sub-resource locator to execute successfully even when there was another sub-resource with the same URI. This behavior was incorrect according to the specification.
				</p><p>
					In RESTEasy 3, when there is an ambiguous URI for a sub-resource and a sub-resource locator, calling the sub-resource will be successful; however, calling the sub-resource locator will result in an HTTP status <code class="literal">405 Method Not Allowed</code> error.
				</p><p>
					The following example contains an ambiguous <code class="literal">@Path</code> annotation on a sub-resource method and a sub-resource locator. Notice that the URI to both endpoints, <code class="literal">anotherResource</code> and <code class="literal">anotherResourceLocator</code>, is the same. The difference between the two endpoints is that the <code class="literal">anotherResource</code> method is associated with the REST verb, <code class="literal">POST</code>. The <code class="literal">anotherResourceLocator</code> method is not associated with any REST verb. According to the specification, the endpoint with the REST verb, in this case the <code class="literal">anotherResource</code> method, will always be selected.
				</p><pre class="programlisting">@Path("myResource")
public class ExampleSubResources {
    @POST
    @Path("items")
    @Produces("text/plain")
    public Response anotherResource(String text) {
        return Response.ok("ok").build();
    }

    @Path("items")
    @Produces("text/plain")
    public SubResource anotherResourceLocator() {
        return new SubResource();
    }
}</pre><h4><a id="migrate_resteasy_resource_method_algoritm_switch"/>Resource Method Algorithm Switch</h4><p>
					A bug discovered in the resource method matching algorithm used in RESTEasy 3.0.x versions prior to 3.0.25.Final caused RESTEasy to return too many resource methods when responding to requests.
				</p><p>
					There are three stages in the matching algorithm:
				</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
							Use the request path to choose possible resource classes.
						</li><li class="listitem">
							Use the request path to choose possible resource methods.
						</li><li class="listitem">
							Use the HTTP verb and media types, coming and going, to choose a final resource method.
						</li></ol></div><p>
					According to the JAX-RS 2.0 specification, after the set of potential resource methods is sorted, only the maximal elements should be passed on to step 3. However, RESTEasy 3.0.x implementations prior to RESTEasy 3.0.25 passed <span class="emphasis"><em>all</em></span> methods to step 3. RESTEasy 3.0.24, which was included in JBoss EAP 7.1.0, exhibits this incorrect behavior.
				</p><p>
					RESTEasy 3.0.25, which is included in JBoss EAP 7.1.1, provides the fix to limit the methods passed to step 3 to be compliant with the JAX-RS 2.0 specification. Because the looser behavior might be preferable, RESTEasy 3.0.25 also introduces a <code class="literal">context-param</code> configuration option, <code class="literal">resteasy.loose.step2.request.matching</code>, which defaults to <code class="literal">false</code>, that can be configured to enable the old behavior.
				</p><p>
					If you update your JBoss EAP server from 7.1.0 to 7.1.1 and you want to keep the old behavior and pass all potential resource methods to step 3, set the <code class="literal">resteasy.loose.step2.request.matching</code> option to <code class="literal">true</code>.
				</p><p>
					The matching algorithm was changed in the JAX-RS 2.1 specification to pass all matching resource methods to step 3. RESTEasy 3.6.1, which is included in JBoss EAP 7.2, provides a <code class="literal">jaxrs.2.0.request.matching</code> option to to retain the stricter behavior as defined in the JAX-RS 2.0 specification.
				</p><p>
					If you migrate your application from JBoss EAP from 7.1.0 to 7.2.x, you should not see a change in the behavior of the resource method matching algorithm. If you migrate your application from JBoss EAP from 7.1.1 to 7.2.x and want to retain the stricter behavior as defined in the JAX-RS 2.0 specification, set the <code class="literal">jaxrs.2.0.request.matching</code> option to <code class="literal">true</code>.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_resteasy_spi_changes"/>RESTEasy SPI Changes</h2></div></div></div><h4><a id="spi_exceptions"/>SPI Exceptions</h4><p>
					All SPI failure exceptions were deprecated and are no longer used internally. They have been replaced with the corresponding JAX-RS exception.
				</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Deprecated Exception</th><th style="text-align: left" valign="top">Replacement Exception in <code class="literal">jaxrs-api</code> module</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									org.jboss.resteasy.spi.ForbiddenException
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									javax.ws.rs.ForbiddenException
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									org.jboss.resteasy.spi.MethodNotAllowedException
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									javax.ws.rs.NotAllowedException
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									org.jboss.resteasy.spi.NotAcceptableException
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									javax.ws.rs.NotAcceptableException
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									org.jboss.resteasy.spi.NotFoundException
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									javax.ws.rs.NotFoundException
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									org.jboss.resteasy.spi.UnauthorizedException
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									javax.ws.rs.NotAuthorizedException
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									org.jboss.resteasy.spi.UnsupportedMediaTypeException
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									javax.ws.rs.NotSupportedException
								</p>
								 </td></tr></tbody></table></div><h4><a id="injectorfactory_and_registry"/>InjectorFactory and Registry</h4><p>
					The <code class="literal">InjectorFactory</code> and <code class="literal">Registry</code> SPIs have changed. This should not be an issue if you use RESTEasy as documented and supported.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_jackson_provider_changes"/>Jackson Provider Changes</h2></div></div></div><p>
					The version of Jackson included in JBoss EAP has changed. The previous version of JBoss EAP included Jackson 1.9.9. JBoss EAP 7 now includes Jackson 2.6.3 or greater. As a result, the Jackson provider has changed from <code class="literal">resteasy-jackson-provider</code> to <code class="literal">resteasy-jackson2-provider</code>.
				</p><p>
					The upgrade to the <code class="literal">resteasy-jackson2-provider</code> requires some package changes. For example, the Jackson annotation package has changed from <code class="literal">org.codehaus.jackson.annotate</code> to <code class="literal">com.fasterxml.jackson.annotation</code>.
				</p><p>
					To switch your application to use the default provider that was included in the previous release of JBoss EAP, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/developing_web_services_applications/#switching_the_default_jackson_provider">Switching the Default Jackson Provider</a> in <span class="emphasis"><em>Developing Web Services Applications</em></span> for JBoss EAP.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_spring_resteasy_integration_changes"/>Spring RESTEasy Integration Changes</h2></div></div></div><p>
					The Spring 4.0 framework introduced support for Java 8. If you plan to use the RESTEasy 3.x integration with Spring, be sure to specify 4.2.x as the minimum Spring version in your deployment as this is the earliest stable version supported by JBoss EAP 7.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_resteasy_jettison_json_provider"/>RESTEasy Jettison JSON Provider Changes</h2></div></div></div><p>
					The RESTEasy Jettison JSON provider is deprecated in JBoss EAP 7 and is no longer added to deployments by default. You are encouraged to switch to the recommended RESTEasy Jackson provider. If you prefer to continue to use the Jettison provider, you must define an explicit dependency for it in the <code class="literal">jboss-deployment-descriptor.xml</code> file as demonstrated in the following example.
				</p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;jboss-deployment-structure&gt;
  &lt;deployment&gt;
    &lt;exclusions&gt;
      &lt;module name="org.jboss.resteasy.resteasy-jackson2-provider"/&gt;
      &lt;module name="org.jboss.resteasy.resteasy-jackson-provider"/&gt;
    &lt;/exclusions&gt;
    &lt;dependencies&gt;
      &lt;module name="org.jboss.resteasy.resteasy-jettison-provider" services="import"/&gt;
    &lt;/dependencies&gt;
  &lt;/deployment&gt;
&lt;/jboss-deployment-structure&gt;</pre><p>
					For more information about how to define explicit dependencies, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/development_guide/#add_an_explicit_module_dependency_to_a_deployment">Add an Explicit Module Dependency to a Deployment</a> in the JBoss EAP <span class="emphasis"><em>Development Guide</em></span>.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_cdi_application_changes"/>CDI Application Changes</h1></div></div></div><p>
				JBoss EAP 7.2 includes support for CDI 2.0. As a result, applications written using CDI 1.0 or CDI 1.2 might see some changes in behavior when migrating to JBoss EAP 7.2. This section summarizes only few of the changes made in CDI 1.2 and CDI 2.0.
			</p><p>
				You can find more information about Weld and CDI 2.0 in the following references:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<a class="link" href="http://docs.jboss.org/cdi/spec/2.0/cdi-spec.html">JSR 365: Contexts and Dependency Injection for Java 2.0</a>
					</li><li class="listitem">
						<a class="link" href="http://docs.jboss.org/cdi/api/2.0/">CDI 2.0 Javadoc</a>
					</li><li class="listitem">
						<a class="link" href="http://docs.jboss.org/weld/reference/3.0.5.Final/en-US/html_single/">Weld 3.0.5.Final - CDI Reference Implementation</a>
					</li></ul></div><h3><a id="cdi_bean_archives"/>Bean Archives</h3><p>
				Bean classes of enabled beans must be deployed in bean archives to ensure they are scanned by CDI to find and process the bean classes.
			</p><p>
				In CDI 1.0, an archive was defined as an <span class="emphasis"><em>explicit</em></span> bean archive if it contained a <code class="literal">beans.xml</code> file in the <code class="literal">META-INF/</code> directory for an application client, EJB, or library JAR, or if it contained a <code class="literal">beans.xml</code> file in the <code class="literal">WEB-INF/</code> directory for a WAR.
			</p><p>
				CDI 1.1 introduced <span class="emphasis"><em>implicit</em></span> bean archives, which are archives that contain one or more bean classes with a bean defining annotation, or one or more session beans. Implicit bean archives are scanned by CDI and, during type discovery, only classes with bean defining annotations are discovered. For more information, see <a class="link" href="http://docs.jboss.org/cdi/spec/2.0/cdi-spec.html#type_bean_discovery">Type and Bean Discovery</a> in <span class="emphasis"><em>JSR 365: Contexts and Dependency Injection for Java 2.0</em></span>.
			</p><p>
				A bean archive has a bean discovery mode of <code class="literal">all</code>, <code class="literal">annotated</code> or <code class="literal">none</code>. A bean archive that contains a <code class="literal">beans.xml</code> file with no version has a default bean discovery mode of <code class="literal">all</code>. A bean archive that contains a <code class="literal">beans.xml</code> file with version <code class="literal">1.1</code> or later must specify the <code class="literal">bean-discovery-mode</code> attribute. The default value for the attribute is <code class="literal">annotated</code>.
			</p><p>
				An archive is not a bean archive in the following cases:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						It contains a <code class="literal">beans.xml</code> file with a <code class="literal">bean-discovery-mode</code> of <code class="literal">none</code>.
					</li><li class="listitem">
						It contains a CDI extension with no <code class="literal">beans.xml</code> file.
					</li></ul></div><p>
				An archive is an <span class="emphasis"><em>explicit</em></span> bean archive in the following cases:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						The archive contains a <code class="literal">beans.xml</code> file with a version number of 1.1 or later and a <code class="literal">bean-discovery-mode</code> of <code class="literal">all</code>.
					</li><li class="listitem">
						The archive contains a <code class="literal">beans.xml</code> file with no version number.
					</li><li class="listitem">
						The archive contains an empty <code class="literal">beans.xml</code> file.
					</li></ul></div><p>
				An archive is an <span class="emphasis"><em>implicit</em></span> bean archive in the following cases:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						The archive contains one or more bean classes with a bean defining annotation, or one or more session beans, even if it does not contain a <code class="literal">beans.xml</code> file.
					</li><li class="listitem">
						The archive contains a <code class="literal">beans.xml</code> file with a <code class="literal">bean-discovery-mode</code> of <code class="literal">annotated</code>.
					</li></ul></div><p>
				CDI 1.2 limited <a class="link" href="http://docs.jboss.org/cdi/spec/2.0/cdi-spec-with-assertions.html#bean_defining_annotations">bean defining annotations</a> to the following:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<code class="literal">@ApplicationScoped</code>, <code class="literal">@SessionScoped</code>, <code class="literal">@ConversationScoped</code>, and <code class="literal">@RequestScoped</code> annotations
					</li><li class="listitem">
						All other normal scope types
					</li><li class="listitem">
						<code class="literal">@Interceptor</code> and <code class="literal">@Decorator</code> annotations
					</li><li class="listitem">
						All stereotype annotations, which are annotations annotated with <code class="literal">@Stereotype</code>
					</li><li class="listitem">
						<code class="literal">@Dependent</code> scope annotation
					</li></ul></div><p>
				For more information about bean archives, see <a class="link" href="http://docs.jboss.org/cdi/spec/2.0/cdi-spec.html#bean_archive">Bean Archives</a> in <span class="emphasis"><em>JSR 365: Contexts and Dependency Injection for Java 2.0</em></span>.
			</p><h3><a id="cdi_clarfication_of_conversation_resolution"/>Clarification of Conversation Resolution</h3><p>
				The conversation context lifecycle was changed in CDI 1.2 to prevent conflicts with the Servlet specification as described in <a class="link" href="https://issues.jboss.org/browse/CDI-411">CDI Specification Issue CDI-411</a>. The conversation scope is active during all servlet requests and should not prevent other servlets or servlet filters from setting the request body or character encoding. For more information, see <a class="link" href="http://docs.jboss.org/cdi/spec/2.0/cdi-spec.html#conversation_context_ee">Conversation context lifecycle in Java EE</a> in <span class="emphasis"><em>JSR 365: Contexts and Dependency Injection for Java 2.0</em></span>.
			</p><h3><a id="cdi_observer_resolution"/>Observer Resolution</h3><p>
				Event resolution was partly rewritten in CDI 1.2. In CDI 1.0, an event is delivered to an observer method if the observer method has all the event qualifiers. In CDI 1.2, an event is delivered to an observer method if the observer method has no event qualifiers or has a subset of the event qualifiers. For more information, see <a class="link" href="http://docs.jboss.org/cdi/spec/2.0/cdi-spec.html#observer_resolution">Observer resolution</a> in <span class="emphasis"><em>JSR 365: Contexts and Dependency Injection for Java 2.0</em></span>.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="http_session_id_change"/>HTTP Session ID Change</h1></div></div></div><p>
				The string returned by the <code class="literal">request.getSession().getId()</code> call to get the unique identifier assigned to an HTTP session has changed between JBoss EAP 6.4 and JBoss EAP 7.
			</p><p>
				JBoss EAP 6.4 returned both the session ID and the instance ID in the <code class="literal">session-id.instance-id</code> format.
			</p><p>
				JBoss EAP 7 returns only the session ID.
			</p><p>
				This change can create issues with routeless cookies for some upgrades from JBoss EAP 6 to JBoss EAP 7. If your application recreates JSESSIONID cookies based upon the return value from this method call, you might need to update the application code to provide the desired behavior.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_explicit_module_dependencies"/>Migrate Explicit Module Dependencies</h1></div></div></div><p>
				The introduction of the modular class loading system and JBoss Modules in the previous release of JBoss EAP allowed for fine-grained control of the classes available to applications. This feature allowed you to configure explicit module dependencies using the application’s <code class="literal">MANIFEST.MF</code> file or the <code class="literal">jboss-deployment-structure.xml</code> deployment descriptor file.
			</p><p>
				If you defined explicit module dependencies in your application, you should be aware of the following changes in JBoss EAP 7.
			</p><h3><a id="review_dependencies_for_availability"/>Review Dependencies for Availability</h3><p>
				The modules that are included in JBoss EAP have changed. When you migrate your application to JBoss EAP 7, review your <code class="literal">MANIFEST.MF</code> and <code class="literal">jboss-deployment-structure.xml</code> file entries to make sure they do not refer to any modules that were removed from this release of the product.
			</p><h3><a id="dependencies_that_require_annotation_scanning"/>Dependencies That Require Annotation Scanning</h3><p>
				In the previous release of JBoss EAP, if your dependency contained annotations that needed to be processed during annotation scanning, such as when declaring EJB Interceptors, you were required to generate and include a Jandex index in a new JAR file and then set a flag in the <code class="literal">MANIFEST.MF</code> or <code class="literal">jboss-deployment-structure.xml</code> deployment descriptor file.
			</p><p>
				JBoss EAP 7 now provides automatic runtime generation of annotation indexes for static modules, so you no longer need to generate them manually. However, you still need to add the <code class="literal">annotations</code> flag to the application’s <code class="literal">MANIFEST.MF</code> file or the <code class="literal">jboss-deployment-structure.xml</code> deployment descriptor file as demonstrated below.
			</p><div class="title"><strong>Example: Annotation Flag in the <code class="literal">MANIFEST.MF</code> File</strong></div><p>
					
</p><pre class="screen">Dependencies: com.company.my-ejb annotations, com.company.other</pre><p>

				</p><div class="title"><strong>Example: Annotation Flag in the <code class="literal">jboss-deployment-structure.xml</code> File</strong></div><p>
					
</p><pre class="programlisting">&lt;jboss-deployment-structure&gt;
  &lt;deployment&gt;
    &lt;dependencies&gt;
      &lt;module name="com.company.my-ejb" annotations="true"/&gt;
      &lt;module name="com.company.other"/&gt;
    &lt;/dependencies&gt;
  &lt;/deployment&gt;
&lt;/jboss-deployment-structure&gt;</pre><p>

				</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="hibernate_and_jpa_migration_changes"/>Hibernate and JPA Migration Changes</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration_hibernate_orm_3_0"/>Hibernate ORM 3.0</h2></div></div></div><p>
					The integration classes that made it easier to use Hibernate ORM 3 in JBoss EAP 6.4 were removed from JBoss EAP 7. If your application still uses Hibernate ORM 3 libraries, it is strongly recommended that you migrate your application to use Hibernate ORM 5 as Hibernate ORM 3 will no longer work in JBoss EAP without a lot of effort. If you can not migrate to Hibernate ORM 5, you must define a custom JBoss Module for the Hibernate ORM 3 JARs and exclude the Hibernate ORM 5 classes from your application.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration_hibernate_orm_4_0_4_3"/>Hibernate ORM 4.0 - 4.3</h2></div></div></div><p>
					If your application needs second-level cache enabled, be aware that Infinispan 8.x was integrated with Hibernate ORM 5.0. Support for using Infinispan as a Hibernate 2nd-level cache provider was then moved to the Infinispan project in Hibernate ORM 5.3, and as a result, the <code class="literal">hibernate-infinispan</code> module was dropped from that release.
				</p><p>
					Applications written with Hibernate ORM 4.x can still use Hibernate ORM 4.x. You must define a custom JBoss module for the Hibernate ORM 4.x JARs and exclude the Hibernate ORM 5 classes from your application. However, it is strongly recommended that you rewrite your application code to use Hibernate ORM 5. For information about migrating to Hibernate ORM 5, see <a class="link" href="application_migration_changes.html#migration_hibernate_orm_changes" title="Migrating to Hibernate ORM 5">Migrating to Hibernate ORM 5</a>.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migration_hibernate_orm_changes"/>Migrating to Hibernate ORM 5</h2></div></div></div><p>
					JBoss EAP 7.0 included Hibernate ORM 5.0. This section highlights the changes you need to make when migrating from Hibernate ORM version 4.3 to version 5. For more information about the changes implemented between Hibernate ORM 4 and Hibernate ORM 5, see the <a class="link" href="https://github.com/hibernate/hibernate-orm/blob/5.0/migration-guide.adoc">Hibernate ORM 5.0 Migration Guide</a>.
				</p><h4><a id="migration_hibernate_orm_changes_deprecations"/>Removed and Deprecated Classes</h4><p>
					The following deprecated classes were removed from Hibernate ORM 5:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<a class="link" href="https://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/cfg/AnnotationConfiguration.html"><code class="literal">org.hibernate.cfg.AnnotationConfiguration</code></a>
						</li><li class="listitem">
							<a class="link" href="https://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/id/TableGenerator.html"><code class="literal">org.hibernate.id.TableGenerator</code></a>
						</li><li class="listitem">
							<a class="link" href="https://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/id/TableHiLoGenerator.html"><code class="literal">org.hibernate.id.TableHiLoGenerator</code></a>
						</li><li class="listitem">
							<a class="link" href="https://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/id/SequenceGenerator.html"><code class="literal">org.hibernate.id.SequenceGenerator</code></a>
						</li></ul></div><h4><a id="migration_hibernate_orm_changes_other_classes"/>Other Changes to Classes and Packages</h4><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							The <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/integrator/spi/Integrator.html"><code class="literal">org.hibernate.integrator.spi.Integrator</code></a> interface changed to account for bootstrap redesign.
						</li><li class="listitem">
							A new package <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/engine/jdbc/spi/package-frame.html"><code class="literal">org.hibernate.engine.jdbc.env.spi</code></a> was created. It contains the <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/engine/jdbc/env/spi/JdbcEnvironment.html"><code class="literal">org.hibernate.engine.jdbc.env.spi.JdbcEnvironment</code></a> interface, which was extracted from the <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/engine/jdbc/spi/JdbcServices.html"><code class="literal">org.hibernate.engine.jdbc.spi.JdbcServices</code></a> interface.
						</li><li class="listitem">
							A new <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/boot/model/relational/ExportableProducer.html"><code class="literal">org.hibernate.boot.model.relational.ExportableProducer</code></a> interface was introduced that will affect <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/id/PersistentIdentifierGenerator.html"><code class="literal">org.hibernate.id.PersistentIdentifierGenerator</code></a> implementations.
						</li><li class="listitem">
							The signature of <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/id/Configurable.html"><code class="literal">org.hibernate.id.Configurable</code></a> was changed to accept <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/service/ServiceRegistry.html"><code class="literal">org.hibernate.service.ServiceRegistry</code></a> rather than just <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/dialect/Dialect.html"><code class="literal">org.hibernate.dialect.Dialect</code></a>.
						</li><li class="listitem">
							The <a class="link" href="https://docs.jboss.org/hibernate/orm/4.3/javadocs/org/hibernate/metamodel/spi/TypeContributor.html"><code class="literal">org.hibernate.metamodel.spi.TypeContributor</code></a> interface has migrated to <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/boot/model/TypeContributor.html"><code class="literal">org.hibernate.boot.model.TypeContributor</code></a>.
						</li><li class="listitem">
							The <a class="link" href="https://docs.jboss.org/hibernate/orm/4.3/javadocs/org/hibernate/metamodel/spi/TypeContributions.html"><code class="literal">org.hibernate.metamodel.spi.TypeContributions</code></a> interface has migrated to <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/boot/model/TypeContributions.html"><code class="literal">org.hibernate.boot.model.TypeContributions</code></a>.
						</li></ul></div><h4><a id="migration_hibernate_orm_changes_type_handling"/>Type Handling</h4><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							Built-in <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/type/descriptor/sql/SqlTypeDescriptor.html"><code class="literal">org.hibernate.type.descriptor.sql.SqlTypeDescriptor</code></a> implementations no longer auto-register themselves with <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/type/descriptor/sql/SqlTypeDescriptorRegistry.html"><code class="literal">org.hibernate.type.descriptor.sql.SqlTypeDescriptorRegistry</code></a>. Applications using custom <code class="literal">SqlTypeDescriptor</code> implementations that extend the built-in implementations and rely on that behavior must be updated to call <code class="literal">SqlTypeDescriptorRegistry.addDescriptor()</code> themselves.
						</li><li class="listitem">
							For IDs defined as generated UUIDs, some databases require you to explicitly set the <code class="literal">@Column(length=16)</code> in order to generate <code class="literal">BINARY(16)</code> so that comparisons work properly.
						</li><li class="listitem">
							For <code class="literal">EnumType</code> mappings defined in the <code class="literal">hbm.xml</code>, where you want <a class="link" href="https://javaee.github.io/javaee-spec/javadocs/javax/persistence/EnumType.html#STRING"><code class="literal">javax.persistence.EnumType.STRING</code></a> <code class="literal">name-mapping</code>, this configuration must be explicitly stated by using either the <code class="literal">useNamed(true)</code> setting or by specifying a <a class="link" href="https://docs.oracle.com/javase/8/docs/api/java/sql/Types.html#VARCHAR">VARCHAR</a> value of <code class="literal">12</code>.
						</li></ul></div><h4><a id="migration_hibernate_orm_changes_transactions"/>Transaction Management</h4><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							The transaction SPI underwent a major redesign in Hibernate ORM 5. In Hibernate ORM 4.3, you used the <a class="link" href="https://docs.jboss.org/hibernate/orm/4.3/javadocs/org/hibernate/Transaction.html"><code class="literal">org.hibernate.Transaction</code></a> API to directly access different back-end transaction strategies. Hibernate ORM 5 introduced a level of indirection. On the back end, the <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/Transaction.html"><code class="literal">org.hibernate.Transaction</code></a> implementation now talks to a <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/resource/transaction/TransactionCoordinator.html"><code class="literal">org.hibernate.resource.transaction.TransactionCoordinator</code></a>, which represents the transactional context for a given session according to the back-end strategy. While this does not have a direct impact on developers, it could affect the bootstrap configuration. Previously applications would specify <code class="literal">hibernate.transaction.factory_class</code> property, which is now deprecated, and refer to a <a class="link" href="https://docs.jboss.org/hibernate/orm/4.3/javadocs/org/hibernate/engine/transaction/spi/TransactionFactory.html"><code class="literal">org.hibernate.engine.transaction.spi.TransactionFactory</code></a> FQN (fully qualified name). With Hibernate ORM 5, you specify the <code class="literal">hibernate.transaction.coordinator_class</code> setting and refer to a <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/resource/transaction/TransactionCoordinatorBuilder.html"><code class="literal">org.hibernate.resource.transaction.TransactionCoordinatorBuilder</code></a>. See <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/cfg/AvailableSettings.html#TRANSACTION_COORDINATOR_STRATEGY"><code class="literal">org.hibernate.cfg.AvailableSettings.TRANSACTION_COORDINATOR_STRATEGY</code></a> for additional details.
						</li><li class="listitem"><p class="simpara">
							The following short names are now recognized:
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									<span class="strong"><strong>jdbc</strong></span>: Manage transactions using the JDBC <a class="link" href="https://docs.oracle.com/javase/8/docs/api/java/sql/Connection.html"><code class="literal">java.sql.Connection</code></a>. This is the default for non-JPA transactions.
								</li><li class="listitem"><p class="simpara">
									<span class="strong"><strong>jta</strong></span>: Manage transactions using JTA.
								</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
										If a JPA application does not provide a setting for the <code class="literal">hibernate.transaction.coordinator_class</code> property, Hibernate will automatically build the proper transaction coordinator based on the transaction type for the persistence unit.
									</p><p>
										If a non-JPA application does not provide a setting for the <code class="literal">hibernate.transaction.coordinator_class</code> property, Hibernate will default to <code class="literal">jdbc</code> to manage the transactions. This default will cause problems if the application actually uses JTA-based transactions. A non-JPA application that uses JTA-based transactions should explicitly set the <code class="literal">hibernate.transaction.coordinator_class</code> property value to <code class="literal">jta</code> or provide a custom <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/resource/transaction/TransactionCoordinatorBuilder.html"><code class="literal">org.hibernate.resource.transaction.TransactionCoordinatorBuilder</code></a> that builds a <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/resource/transaction/TransactionCoordinator.html"><code class="literal">org.hibernate.resource.transaction.TransactionCoordinator</code></a> that properly coordinates with JTA-based transactions.
									</p></div></li></ul></div></li></ul></div><h4><a id="migration_hibernate_orm_changes_miscellaneous"/>Other Hibernate ORM 5 Changes</h4><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							The <code class="literal">cfg.xml</code> files are again fully parsed and integrated with events, security, and other functions.
						</li><li class="listitem">
							The properties loaded from the <code class="literal">cfg.xml</code> using the <code class="literal">EntityManagerFactory</code> did not previously prefix names with <code class="literal">hibernate</code>. This has now been made consistent.
						</li><li class="listitem">
							The configuration is no longer serializable.
						</li><li class="listitem">
							The <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/dialect/Dialect.html"><code class="literal">org.hibernate.dialect.Dialect.getQuerySequencesString()</code></a> method now retrieves catalog, schema, and increment values.
						</li><li class="listitem">
							The <code class="literal">AuditConfiguration</code> modifier was removed from <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/envers/boot/internal/EnversService.html"><code class="literal">org.hibernate.envers.boot.internal.EnversService</code></a>.
						</li><li class="listitem">
							The <code class="literal">AuditStrategy</code> method parameters were changed to remove the obsolete <code class="literal">AuditConfiguration</code> and use the new <code class="literal">EnversService</code>.
						</li><li class="listitem">
							Various classes and interfaces in the <a class="link" href="https://docs.jboss.org/hibernate/orm/4.3/javadocs/org/hibernate/hql/spi/package-frame.html"><code class="literal">org.hibernate.hql.spi</code></a> package and subpackages have been moved to the new <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/hql/spi/id/package-frame.html"><code class="literal">org.hibernate.hql.spi.id</code></a> package. This includes the <code class="literal">MultiTableBulkIdStrategy</code> class and the <code class="literal">AbstractTableBasedBulkIdHandler</code>, <code class="literal">TableBasedDeleteHandlerImpl</code>, and <code class="literal">TableBasedUpdateHandlerImpl</code> interfaces and their subclasses.
						</li><li class="listitem">
							There was a complete redesign of property access contracts.
						</li><li class="listitem">
							Valid <code class="literal">hibernate.cache.default_cache_concurrency_strategy</code> setting values are now defined using the <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/cache/spi/access/AccessType.html"><code class="literal">org.hibernate.cache.spi.access.AccessType.getExternalName()</code></a> method rather than the <a class="link" href="https://docs.jboss.org/hibernate/orm/5.0/javadocs/org/hibernate/cache/spi/access/AccessType.html"><code class="literal">org.hibernate.cache.spi.access.AccessType</code></a> enum constants. This is more consistent with other Hibernate settings.
						</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrating_from_hibernate_5_0_to_5_1"/>Migrating from Hibernate ORM 5.0 to Hibernate ORM 5.1</h2></div></div></div><p>
					JBoss EAP 7.1 included Hibernate ORM 5.1. This section highlights the differences and the changes needed when migrating from Hibernate ORM version 5.0 to version 5.1.
				</p><h4><a id="hibernate_orm_5_1_features"/>Hibernate ORM 5.1 Features</h4><p>
					This release of Hibernate includes many performance improvements and bug fixes, which are detailed in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.1/html-single/7.1.0_release_notes/#hibernate_5_1_features">Hibernate ORM 5.1 Features</a> in the JBoss EAP <span class="emphasis"><em>7.1.0 Release Notes</em></span>. For additional information about the changes implemented between Hibernate ORM 5.0 and Hibernate ORM 5.1, see the <a class="link" href="https://github.com/hibernate/hibernate-orm/blob/5.1/migration-guide.adoc">Hibernate ORM 5.1 Migration Guide</a>.
				</p><h4><a id="schema_management_tooling_changes"/>Schema Management Tooling Changes</h4><h5><a id="schema_management_tooling_changes_7"/>Schema Management Tooling Changes in JBoss EAP 7</h5><p>
					Schema management tooling changes in Hibernate ORM 5.1 are mainly focused in the following areas:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							Unifying the handling of <code class="literal">hbm2ddl.auto</code> and Hibernate’s JPA <code class="literal">schema-generation</code> support.
						</li><li class="listitem">
							Removing JDBC concerns from the SPI to facilitate true replacement for Hibernate OGM, a persistence engine that provides Java Persistence (JPA) support for NoSQL data stores.
						</li></ul></div><p>
					The schema management tooling changes should only be a migration concern for applications that directly use any of the following classes:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							<code class="literal">org.hibernate.tool.hbm2ddl.SchemaExport</code>
						</li><li class="listitem">
							<code class="literal">org.hibernate.tool.hbm2ddl.SchemaUpdate</code>
						</li><li class="listitem">
							<code class="literal">org.hibernate.tool.hbm2ddl.SchemaValidator</code>
						</li><li class="listitem">
							<code class="literal">org.hibernate.tool.schema.spi.SchemaManagementTool</code>, or any of its delegates
						</li></ul></div><h5><a id="schema_management_tooling_changes_71"/>Schema Management Tooling Changes in JBoss EAP 7.1</h5><p>
					Hibernate ORM 5.1.10 which is included in JBoss EAP 7.1, introduced a new strategy for retrieving database tables that improves <code class="literal">SchemaMigrator</code> and <code class="literal">SchemaValidator</code> performance. This strategy executes a single <code class="literal">java.sql.DatabaseMetaData#getTables(String, String, String, String[])</code> call to determine if each <code class="literal">javax.persistence.Entity</code> has a mapped database table. This is the default strategy, and it uses the <code class="literal">hibernate.hbm2ddl.jdbc_metadata_extraction_strategy=grouped</code> property setting. This strategy might require <code class="literal">hibernate.default_schema</code> and/or <code class="literal">hibernate.default_catalog</code> to be provided.
				</p><p>
					To use the old strategy, which executes a <code class="literal">java.sql.DatabaseMetaData#getTables(String, String, String, String[])</code> call for <code class="literal">each javax.persistence.Entity</code>, use the <code class="literal">hibernate.hbm2ddl.jdbc_metadata_extraction_strategy=individually</code> property setting.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrating_from_hibernate_5_1_to_5_3"/>Migrating from Hibernate ORM 5.1 to Hibernate ORM 5.3</h2></div></div></div><p>
					JBoss EAP 7.2 includes Hibernate ORM 5.3. This section highlights some the changes needed when migrating from Hibernate ORM 5.1 to Hibernate ORM 5.3.
				</p><h4><a id="hibernate_orm_5_2_features"/>Hibernate ORM 5.2 Features</h4><p>
					Hibernate ORM 5.2 is built using the Java 8 JDK and requires the Java 8 JRE at runtime. The following is a list of some of the changes made in this release.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							The <code class="literal">hibernate-java8</code> module was merged into <code class="literal">hibernate-core</code>, and the Java 8 date/time datatypes are now natively supported.
						</li><li class="listitem">
							The <code class="literal">hibernate-entitymanager</code> module was merged into <code class="literal">hibernate-core</code>. <code class="literal">HibernateEntityManager</code> and <code class="literal">HibernateEntityManagerFactory</code> are deprecated.
						</li><li class="listitem">
							The <code class="literal">Session</code>, <code class="literal">StatelessSession</code>, and <code class="literal">SessionFactory</code> class hierarchies were refactored to remove deprecated classes and to better align with the JPA Metamodel API.
						</li><li class="listitem">
							The SPIs in the <code class="literal">org.hibernate.persister</code> and <code class="literal">org.hibernate.tuple</code> packages have changed. Any custom classes using those SPIs will need to be reviewed and updated.
						</li><li class="listitem">
							<code class="literal">LimitHandler</code> changes introduced a new <code class="literal">hibernate.legacy_limit_handler</code> setting, which is set to <code class="literal">false</code> by default, that is designed to allow you to enable the legacy Hibernate 4.3 limit handler behavior. This impacts a limited list of dialects.
						</li><li class="listitem">
							A new strategy for retrieving database tables was introduced that improves <code class="literal">SchemaMigrator</code> and <code class="literal">SchemaValidator</code> performance.
						</li><li class="listitem">
							This release changes how <code class="literal">CLOB</code> values for <code class="literal">String</code>, <code class="literal">character[]</code>, and <code class="literal">Character[]</code> attributes that are annotated with <code class="literal">@Lob</code> are processed when using PostgreSQL81Dialect and its subclasses.
						</li><li class="listitem">
							The scope of <code class="literal">@TableGenerator</code> and <code class="literal">@SequenceGenerator</code> names has changed from global to local.
						</li></ul></div><p>
					For the complete list of changes implemented in Hibernate 5.2, see the <a class="link" href="https://github.com/hibernate/hibernate-orm/blob/5.2/migration-guide.adoc">Hibernate ORM 5.2 Migration Guide</a>.
				</p><h4><a id="hibernate_orm_5_3_features"/>Hibernate ORM 5.3 Features</h4><p>
					Hibernate ORM 5.3 adds support for the JPA 2.2 specification. This release contains changes to comply with this specification along with other improvements. The following is a list of some of these changes.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
							Changes to positional query parameter handling has resulted in the following changes:
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									Removal of support for JDBC-style parameter declarations in HQL/JPQL queries.
								</li><li class="listitem">
									JPA positional parameters behave more like named parameters.
								</li><li class="listitem">
									JDBC-style parameter declarations in native queries use one-based instead of zero-based parameter binding to be consistent with JPA. You can revert back to zero-based binding by setting the <code class="literal">hibernate.query.sql.jdbc_style_params_base</code> property to <code class="literal">true</code>.
								</li></ul></div></li><li class="listitem">
							To comply with the JPA specification, the sequence value stored by the <code class="literal">@TableGenerator</code> stored value is that last generated value. Previously, Hibernate stored the next sequence value. You can use the <code class="literal">hibernate.id.generator.stored_last_used</code> property to enable the legacy Hibernate behavior. Existing applications that use <code class="literal">@TableGenerator</code> and migrate to Hibernate 5.3 must set the <code class="literal">hibernate.id.generator.stored_last_used configuration</code> property to <code class="literal">false</code>.
						</li><li class="listitem">
							The <code class="literal">getType()</code> method in the <code class="literal">org.hibernate.query.QueryParameter</code> class was renamed to <code class="literal">getHibernateType()</code>.
						</li><li class="listitem">
							Hibernate’s second-level cache SPI was redesigned to better meet the requirements of the various caching providers. Details can be found in <a class="link" href="https://hibernate.atlassian.net/browse/HHH-11356">HHH-11356</a>.
						</li><li class="listitem">
							Changes for <a class="link" href="https://hibernate.atlassian.net/browse/HHH-11356">HHH-11356</a> also required changes in consumers, which impacts the Hibernate Statistics system.
						</li><li class="listitem">
							Some methods were temporarily added to the <code class="literal">org.hibernate.Query</code> class to make it easier to migrate native applications from Hibernate ORM 5.1 to 5.3 and maintain the Hibernate 5.1 pagination behavior. These methods are deprecated, and to be portable with future versions of Hibernate, applications should be updated to use the JPA methods.
						</li><li class="listitem">
							Support for using Infinispan as a Hibernate 2nd-level cache provider has been moved to the Infinispan project. As a result, the <code class="literal">hibernate-infinispan</code> module has been dropped.
						</li><li class="listitem">
							The API of the <code class="literal">org.hibernate.tool.enhance.EnhancementTask</code> Ant task was changed. The <code class="literal">addFileset()</code> method was dropped in favor of the <code class="literal">setBase()</code> and the <code class="literal">setDir()</code> methods. Details can be found in <a class="link" href="https://hibernate.atlassian.net/browse/HHH-11795">HHH-11795</a>.
						</li><li class="listitem">
							A bug introduced in Hibernate 4.3 caused many-to-one associations in embeddable collection elements and composite IDs to be eagerly fetched, even when explicitly mapped as lazy. In Hibernate 5.3.2, this bug was fixed. As a result, these associations are fetched as specified by their mappings. Details can be found in <a class="link" href="https://hibernate.atlassian.net/browse/HHH-12687">HHH-12687</a>.
						</li><li class="listitem">
							JPA and native implementations of Hibernate event listeners were unified in this release. As a result, the <code class="literal">JpaIntegrator</code> class is obsolete. Classes that extend <code class="literal">org.hibernate.jpa.event.spi.JpaIntegrator</code> must be modified to have to change these classes to implement the <code class="literal">org.hibernate.integrator.spi.Integrator</code> interface. Details can be found in <a class="link" href="https://hibernate.atlassian.net/browse/HHH-11264">HHH-11264</a>.
						</li><li class="listitem">
							The SPIs in the <code class="literal">org.hibernate.persister</code> package have changed. Any custom classes using those SPIs will need to be reviewed and updated.
						</li></ul></div><p>
					For the complete list of these and other changes implemented in Hibernate 5.3, see the <a class="link" href="https://github.com/hibernate/hibernate-orm/blob/5.3/migration-guide.adoc">Hibernate ORM 5.3 Migration Guide</a>.
				</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="exception_handling_changes_between_51_53"/>Exception Handling Changes Between Hibernate 5.1 and Hibernate 5.3</h3></div></div></div><p>
						In Hibernate 5.2 and 5.3, exception handling for a <code class="literal">SessionFactory</code> that is built using Hibernate’s native bootstrapping, wraps or converts <code class="literal">HibernateException</code> according to the JPA specification. The only exception to this behavior is when the operation is Hibernate-specific, for example <code class="literal">Session.save()</code> or <code class="literal">Session.saveOrUpdate()</code>.
					</p><p>
						In Hibernate 5.3.3, the <code class="literal">hibernate.native_exception_handling_51_compliance</code> property was added. This property indicates whether exception handling for a <code class="literal">SessionFactory</code> built using Hibernate’s native bootstrapping should behave the same as native exception handling in Hibernate ORM 5.1. When set to <code class="literal">true</code>, <code class="literal">HibernateException</code> is not wrapped or converted according to the JPA specification. This setting is ignored for a <code class="literal">SessionFactory</code> built using JPA bootstrapping.
					</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="hibernate_51_compatiblity_transformer"/>Compatibility Transformer</h3></div></div></div><p>
						JBoss EAP 7.2 incudes a compatibility transformer that addresses Hibernate ORM 5.3 API methods that are no longer compatible with Hibernate ORM 5.1. The transformer is a temporary measure to allow applications built using Hibernate ORM 5.1 to exhibit the same behavior with Hibernate 5.3 in JBoss EAP 7.2. This is a temporary solution and you should replace these method calls with the recommended JPA method calls.
					</p><p>
						You can enable the transformer in one of the following ways.
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								You can enable the transformer globally for all applications by setting the <code class="literal">Hibernate51CompatibilityTransformer</code> system property to <code class="literal">true</code>.
							</li><li class="listitem"><p class="simpara">
								You can use the <code class="literal">jboss-deployment-structure.xml</code> file to enable the transformer at the application level.
							</p><pre class="programlisting">&lt;jboss-deployment-structure&gt;
  &lt;deployment&gt;
    &lt;transformers&gt;
      &lt;transformer class="org.jboss.as.hibernate.Hibernate51CompatibilityTransformer"/&gt;
    &lt;/transformers&gt;
  &lt;/deployment&gt;
  &lt;sub-deployment name="main.war"&gt;
    &lt;transformers&gt;
      &lt;transformer class="org.jboss.as.hibernate.Hibernate51CompatibilityTransformer"/&gt;
    &lt;/transformers&gt;
  &lt;/sub-deployment&gt;
&lt;/jboss-deployment-structure&gt;</pre></li></ul></div><p>
						The following table lists the Hibernate 5.1 methods that are transformed and the Hibernate 5.3 method it is converted to.
					</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Hibernate 5.1 Reference or Method</th><th style="text-align: left" valign="top">Transformed to Hibernate 5.3 Reference or Method</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
										<a class="link" href="http://docs.jboss.org/hibernate/orm/5.1/javadocs/org/hibernate/BasicQueryContract.html#getFlushMode--">org.hibernate.BasicQueryContract.getFlushMode()</a>
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										<a class="link" href="http://docs.jboss.org/hibernate/orm/5.3/javadocs/org/hibernate/BasicQueryContract.html#getHibernateFlushMode--">org.hibernate.BasicQueryContract.getHibernateFlushMode()</a>
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<a class="link" href="http://docs.jboss.org/hibernate/orm/5.1/javadocs/org/hibernate/Session.html#getFlushMode--">org.hibernate.Session.getFlushMode()</a>
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										<a class="link" href="http://docs.jboss.org/hibernate/orm/5.3/javadocs/org/hibernate/Session.html#getFlushMode--">org.Session.getHibernateFlushMode()</a>
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<a class="link" href="http://docs.jboss.org/hibernate/orm/5.1/javadocs/org/hibernate/FlushMode.html#NEVER">Enum org.hibernate.FlushMode.NEVER (0)</a>
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										<a class="link" href="http://docs.jboss.org/hibernate/orm/5.3/javadocs/org/hibernate/FlushMode.html#MANUAL">Enum org.hibernate.FlushMode.MANUAL (0)</a>
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<a class="link" href="http://docs.jboss.org/hibernate/orm/5.1/javadocs/org/hibernate/Query.html#getMaxResults--">org.hibernate.Query.getMaxResults()</a>
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										<a class="link" href="http://docs.jboss.org/hibernate/orm/5.3/javadocs/org/hibernate/Query.html#getHibernateMaxResults--">org.hibernate.Query.getHibernateMaxResults()</a>
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<a class="link" href="http://docs.jboss.org/hibernate/orm/5.1/javadocs/org/hibernate/Query.html#setMaxResults-int-">org.hibernate.Query.setMaxResults(int)</a>
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										<a class="link" href="http://docs.jboss.org/hibernate/orm/5.3/javadocs/org/hibernate/Query.html#setHibernateMaxResults-int-">org.hibernate.Query.setHibernateMaxResults(int)</a>
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<a class="link" href="http://docs.jboss.org/hibernate/orm/5.1/javadocs/org/hibernate/Query.html#getFirstResult--">org.hibernate.Query.getFirstResult(int)</a>
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										<a class="link" href="http://docs.jboss.org/hibernate/orm/5.3/javadocs/org/hibernate/Query.html#getHibernateFirstResult--">org.hibernate.Query.getHibernateFirstResult()</a>
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<a class="link" href="http://docs.jboss.org/hibernate/orm/5.1/javadocs/org/hibernate/Query.html#setFirstResult-int-">org.hibernate.Query.setFirstResult(int)</a>
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										<a class="link" href="http://docs.jboss.org/hibernate/orm/5.3/javadocs/org/hibernate/Query.html#setHibernateFirstResult-int-">org.hibernate.Query.setHibernateFirstResult(int)</a>
									</p>
									 </td></tr></tbody></table></div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_hibernate_search_changes"/>Hibernate Search Changes</h1></div></div></div><p>
				The version of Hibernate Search that ships with JBoss EAP 7 has changed. The previous release of JBoss EAP shipped with Hibernate Search 4.6.x. JBoss EAP 7 ships with Hibernate Search 5.5.x.
			</p><p>
				Hibernate Search 5.5 is built upon Apache Lucene 5.3.1. If you use any native Lucene APIs, be sure to align with this version. The <a class="link" href="https://docs.jboss.org/hibernate/search/5.5/api/index.html">Hibernate Search 5.5 API</a> wraps and hides the complexity of many of the Lucene API changes made between version 3 and version 5; however, some classes are now deprecated, renamed, or repackaged. This section describes how these changes might impact your application code.
			</p><h3><a id="migrate_hibernate_search_mapping_changes"/>Hibernate Search Mapping Changes</h3><h4><a id="migrate_hibernate_search_indexing_of_id_fields"/>Indexing of id Fields of Embedded Relations</h4><p>
				When using an <code class="literal">@IndexedEmbedded</code> annotation to include fields from a related entity, the <code class="literal">id</code> of the related entity is no longer included. You can enable the inclusion of the <code class="literal">id</code> by using the <code class="literal">includeEmbeddedObjectId</code> attribute of the <code class="literal">@IndexedEmbedded</code> annotation.
			</p><div class="title"><strong>Example: <code class="literal">@IndexedEmbedded</code> Annotation</strong></div><p>
					
</p><pre class="programlisting">@IndexedEmbedded(includeEmbeddedObjectId=true)</pre><p>

				</p><h4><a id="migrate_hibernate_search_number_and_date_index_formatting_changes"/>Number and Date Index Formatting Changes</h4><p>
				Numbers and dates are now indexed as numeric fields by default. Properties of type <code class="literal">int</code>, <code class="literal">long</code>, <code class="literal">float</code>, <code class="literal">double</code>, and their corresponding wrapper classes are no longer indexed as strings. Instead, they are now indexed using Lucene’s appropriate numeric encoding. The <code class="literal">id</code> fields are an exception to this rule. Even when they are represented by a numeric type, they are still indexed as a string keyword by default. The use of <code class="literal">@NumericField</code> is now obsolete unless you want to specify a custom precision for the numeric encoding. You can keep the old string-based index format by explicitly specifying a string encoding field bridge. In the case of integers, this is the <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/bridge/builtin/IntegerBridge.html">org.hibernate.search.bridge.builtin.IntegerBridge</a>. Check the <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/bridge/builtin/package-summary.html">org.hibernate.search.bridge.builtin</a> package for other publicly available field bridges.
			</p><p>
				<code class="literal">Date</code> and <code class="literal">Calendar</code> are no longer indexed as strings. Instead, instances are encoded as long values representing the number of milliseconds since January 1, 1970, 00:00:00 GMT. You can switch the indexing format by using the new <a class="link" href="http://docs.jboss.org/hibernate/search/5.0/api/org/hibernate/search/annotations/EncodingType.html">EncodingType</a> enum. For example:
			</p><div class="title"><strong>Example: <code class="literal">@DateBridge</code> and <code class="literal">@CalendarBridge</code> Annotation</strong></div><p>
					
</p><pre class="programlisting">@DateBridge(encoding=EncodingType.STRING)
@CalendarBridge(encoding=EncodingType.STRING)</pre><p>

				</p><p>
				The encoding change for numbers and dates is important and can have a big impact on application behavior. If you have a query that targets a field that was previously string-encoded, but is now encoded numerically, you must update the query. Numeric fields must be searched with a <code class="literal">NumericRangeQuery</code>. You must also make sure that all fields targeted by faceting are string encoded. If you use the Search query DSL, the correct query should be created automatically for you.
			</p><h3><a id="migrate_miscellaneous_hibernate_search_changes"/>Miscellaneous Hibernate Search Changes</h3><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						Sorting options have improved and field encoding specified incorrectly for sorting options now results in runtime exceptions. Lucene also offers more performant sorting if the fields used in the sort are known up front. Hibernate Search 5.5 provides the new <code class="literal">@SortableField</code> annotation and its multi-valued companion <code class="literal">@SortableFields</code>. See the <a class="link" href="http://hibernate.org/search/documentation/migrate/5.5/">Migration Guide from Hibernate Search 5.4 to 5.5</a> for more information.
					</li><li class="listitem"><p class="simpara">
						The Lucene <a class="link" href="https://lucene.apache.org/core/5_3_1/core/org/apache/lucene/search/SortField.html"><code class="literal">SortField</code></a> API requires the following application code change.
					</p><p class="simpara">
						In the previous release of JBoss EAP, you set the type of the sort field in the query as follows.
					</p><pre class="programlisting">fulltextQuery.setSort(new Sort(new SortField("title", SortField.STRING)));</pre><p class="simpara">
						The following is an example of how you set it in JBoss EAP 7.
					</p><pre class="programlisting">fulltextQuery.setSort(new Sort(new SortField("title", SortField.Type.STRING)));</pre></li><li class="listitem">
						Since <code class="literal">SearchFactory</code> should only be used by ORM integration, it was moved from the <code class="literal">hibernate-search-engine</code> module to the <code class="literal">hibernate-search-orm</code> module. Other integrators should depend exclusively on <code class="literal">SearchIntegrator</code>, which replaces the deprecated <code class="literal">SearchFactoryIntegrator</code>.
					</li><li class="listitem">
						The enum value <code class="literal">SpatialMode.GRID</code> was renamed to <code class="literal">SpatialMode.HASH</code>.
					</li><li class="listitem">
						<code class="literal">FullTextIndexEventListener</code> is now a final class. If you currently extend this class, you must find an alternate solution to achieve the same functionality.
					</li><li class="listitem">
						The <code class="literal">hibernate-search-analyzers</code> module was removed. The recommended approach is to directly use the appropriate Lucene artifact, for example <code class="literal">org.apache.lucene:lucene-analyzers-common</code>.
					</li><li class="listitem">
						The JMS controller API has changed. The JMS back-end dependency on Hibernate ORM was removed so that it could be used in other non-ORM environments. A consequence is that implementors of <code class="literal">org.hibernate.search.backend.impl.jms.AbstractJMSHibernateSearchController</code> must adjust to the new signature. This class is an internal class and it is recommended to use it as an example instead of extending it.
					</li><li class="listitem">
						The <code class="literal">org.hibernate.search.spi.ServiceProvider</code> SPI was refactored. If you were integrating with the old service contract, refer to the <a class="link" href="https://docs.jboss.org/hibernate/search/5.5/api/index.html">Hibernate Search 5.5 Javadoc</a> of <code class="literal">ServiceManager</code>, <code class="literal">Service</code>, <code class="literal">Startable</code> and <code class="literal">Stoppable</code> for details about the new contract.
					</li><li class="listitem">
						If you have kept indexes generated by Lucene 3.x and have not rebuilt them with Hibernate Search 5.0 or later, you will get an <code class="literal">IndexFormatTooOldException</code>. It is recommended that you rebuild the indexes with the mass indexer. If you are not able to do that, try to use Lucene’s <code class="literal">IndexUpgrader</code>. You must carefully update the Hibernate Search mappings in case the default behavior has changed. For more information, see the <a class="link" href="http://lucene.apache.org/core/5_3_0/MIGRATE.html">Apache Lucene Migration Guide</a>.
					</li><li class="listitem">
						Apache Lucene was upgraded from 3.6 to 5.3 in JBoss EAP 7. If your code imports Lucene code directly, see the <a class="link" href="http://lucene.apache.org/core/5_3_0/MIGRATE.html">Apache Lucene Migration Guide</a> for details of the changes. Additional information can also be found in the <a class="link" href="http://lucene.apache.org/core/5_3_0/changes/Changes.html">Lucene Change Log</a>.
					</li><li class="listitem">
						When using <code class="literal">@Field(indexNullAs=)</code> to encode a null marker value in the index, the type of the marker must be compatible with all other values that are indexed in that same field. For example, it was previously possible to encode a null value for numeric fields using a string "null". This is no longer allowed. Instead, you must choose a number to represent the <code class="literal">null</code> value, such as <code class="literal">-1</code>.
					</li><li class="listitem">
						Significant improvements were made to the faceting engine. Most of the changes do not affect the API. The one notable exception is that you must now annotate any fields you intend to use for faceting with the <code class="literal">@Facet</code> or <code class="literal">@Facets</code> annotation.
					</li></ul></div><h3><a id="migrate_hibernate_search_renamed_and_repackaged_classes"/>Hibernate Search Renamed and Repackaged Classes</h3><p>
				The following is a list of Hibernate Search classes that were repackaged or renamed.
			</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Previous Package and Class</th><th style="text-align: left" valign="top">New Package and Class</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.Environment
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.cfg.Environment
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.FullTextFilter
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.filter.FullTextFilter
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.ProjectionConstants
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.engine.ProjectionConstants
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.SearchException
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.exception.SearchException
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.Version
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.engine.Version
							</p>
							 </td></tr></tbody></table></div><h3><a id="migrate_lucene_renamed_and_repackaged_classes"/>Lucene - Renamed and Repackaged Classes</h3><p>
				Query parsers were moved to a new module, resulting in a packaging change from <code class="literal">org.apache.lucene.queryParser.QueryParser</code> to <code class="literal">org.apache.lucene.queryparser.classic.QueryParser</code>.
			</p><p>
				Many of the Lucene analyzers were refactored, resulting in packaging changes. See the <a class="link" href="http://lucene.apache.org/core/4_10_2/">Apache Lucene Documentation</a> to find the replacement packages.
			</p><p>
				Some Apache Solr utility classes, for example <code class="literal">TokenizerFactory</code> or <code class="literal">TokenFilterFactory</code>, were moved into Apache Lucene. If your application uses those utilities or custom analyzers, you must find the new package name in Apache Lucene.
			</p><p>
				See the <a class="link" href="http://lucene.apache.org/core/4_10_2/MIGRATE.html">Apache Lucene Migration Guide</a> for more information.
			</p><h3><a id="migrate_hibernate_search_deprecated_apis"/>Hibernate Search Deprecated APIs</h3><p>
				For the complete list of Hibernate Search deprecated interfaces, classes, enums, annotation types, methods, constructors, and enum constants, see the <a class="link" href="https://docs.jboss.org/hibernate/search/5.5/api/deprecated-list.html">Hibernate Search Deprecated API</a> document.
			</p><h4><a id="migrate_hibernate_search_deprecated_interfaces"/>Hibernate Search Deprecated Interfaces</h4><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Interface</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.store.IndexShardingStrategy
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Deprecated as of Hibernate Search 4.4. Might be removed in Search 5. Use <a class="link" href="https://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/store/ShardIdentifierProvider.html"><code class="literal">ShardIdentifierProvider</code></a> instead.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.store.Workspace
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								This interface will be moved and should be considered non-public API. For more information, see <a class="link" href="https://hibernate.atlassian.net/browse/HSEARCH-1915">HSEARCH-1915</a>.
							</p>
							 </td></tr></tbody></table></div><h4><a id="migrate_hibernate_search_deprecated_classes"/>Hibernate Search Deprecated Classes</h4><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Class</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.filter.FilterKey
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Custom filter keys are deprecated and are scheduled for removal in Hibernate Search 6. As of Hibernate Search 5.1, keys for caching Lucene filters are calculated automatically based on the given filter parameters.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.filter.StandardFilterKey
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Custom filter keys are deprecated and are scheduled for removal in Hibernate Search 6. As of Hibernate Search 5.1, keys for caching Lucene filters are calculated automatically based on the given filter parameters.
							</p>
							 </td></tr></tbody></table></div><h4><a id="migrate_hibernate_search_deprecated_enums"/>Hibernate Search Deprecated Enums</h4><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Enum</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.annotations.FieldCacheType
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Remove the <code class="literal">CacheFromIndex</code> annotation as it is deprecated. See <a class="link" href="application_migration_changes.html#migrate_hibernate_search_deprecated_annotations" title="Hibernate Search Deprecated Annotations">Hibernate Search Deprecated Annotations</a>.
							</p>
							 </td></tr></tbody></table></div><h4><a id="migrate_hibernate_search_deprecated_annotations"/>Hibernate Search Deprecated Annotations</h4><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Annotation</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.annotations.CacheFromIndex
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Remove the annotation. No alternative replacement is necessary.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.annotations.Key
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Custom filter cache keys are a deprecated feature and are scheduled to be removed in Hibernate Search 6. As of Hibernate Search 5.1, the filter cache keys are determined automatically based on the filter parameters so it is no longer required to provide a key object.
							</p>
							 </td></tr></tbody></table></div><h4><a id="migrate_hibernate_search_deprecated_methods"/>Hibernate Search Deprecated Methods</h4><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Method</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.FullTextSharedSessionBuilder.autoClose()
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								No replacement
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.FullTextSharedSessionBuilder.autoClose(boolean)
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								No replacement
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.cfg.IndexedMapping.cacheFromIndex(FieldCacheType…​)
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								This will be removed with no replacement.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.cfg.EntityDescriptor.getCacheInMemory()
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								This will be removed with no replacement.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.cfg.ContainedInMapping.numericField()
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Invoke <code class="literal">field().numericField()</code> instead.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.cfg.EntityDescriptor.setCacheInMemory(Map&lt;String, Object&gt;)
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								This will be removed with no replacement.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.MassIndexer.threadsForSubsequentFetching(int)
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								This method will be removed.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.query.dsl.FuzzyContext.withThreshold(float)
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Use <code class="literal">FuzzyContext.withEditDistanceUpTo(int)</code>.
							</p>
							 </td></tr></tbody></table></div><h4><a id="migrate_hibernate_search_deprecated_constructors"/>Hibernate Search Deprecated Constructors</h4><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Constructor</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								org.hibernate.search.cfg.NumericFieldMapping(PropertyDescriptor, EntityDescriptor, SearchMapping)
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Use <code class="literal">NumericFieldMapping.NumericFieldMapping(String, PropertyDescriptor, EntityDescriptor, SearchMapping)</code> instead.
							</p>
							 </td></tr></tbody></table></div><h3><a id="migrate_hibernate_search_advanced_integrator_changes"/>Changes Impacting Advanced Integrators</h3><p>
				This section describes changes that are not part of the public API. They should not impact the average developer as these artifacts should only be accessed by integrators who extend the Hibernate Search framework.
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						The <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/backend/configuration/impl/IndexWriterSetting.html#MAX_THREAD_STATES"><code class="literal">IndexWriterSetting.MAX_THREAD_STATES</code></a> and <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/backend/configuration/impl/IndexWriterSetting.html#TERM_INDEX_INTERVAL"><code class="literal">IndexWriterSetting.TERM_INDEX_INTERVAL</code></a> enum constants are deprecated. They affect which properties are read from the configuration, so the fact they they are missing means that configuration properties such as <code class="literal">hibernate.search.Animals.2.indexwriter.term_index_interval = default</code> are now ignored. The only side effect is that the property is not applied.
					</li><li class="listitem">
						The <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/spi/SearchFactoryIntegrator.html"><code class="literal">SearchFactoryIntegrator</code></a> interface is now deprecated. You should immediately migrate all code to use <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/spi/SearchIntegrator.html"><code class="literal">SearchIntegrator</code></a>.
					</li><li class="listitem">
						The <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/spi/SearchFactoryBuilder.html"><code class="literal">SearchFactoryBuilder</code></a> class is now deprecated. Use <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/spi/SearchIntegratorBuilder.html"><code class="literal">SearchIntegrationBuilder</code></a> instead.
					</li><li class="listitem">
						The <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/query/engine/spi/HSQuery.html#getExtendedSearchIntegrator--"><code class="literal">HSQuery.getExtendedSearchIntegrator()</code></a> method has been deprecated. It might be possible to use <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/spi/SearchIntegrator.html"><code class="literal">SearchIntegrator</code></a>, but it is preferable to remove it altogether.
					</li><li class="listitem">
						The <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/engine/spi/DocumentBuilderIndexedEntity.html#getFieldCacheOption--"><code class="literal">DocumentBuilderIndexedEntity.getFieldCacheOption()</code></a> method has been deprecated. There is no replacement.
					</li><li class="listitem">
						The <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/spi/BuildContext.html#getIndexingStrategy--"><code class="literal">BuildContext.getIndexingStrategy()</code></a> method is deprecated. Use <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/spi/BuildContext.html#getIndexingMode--"><code class="literal">BuildContext.getIndexingMode()</code></a> instead.
					</li><li class="listitem">
						The <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/store/spi/DirectoryHelper.html#getVerifiedIndexDir-java.lang.String-java.util.Properties-boolean-"><code class="literal">DirectoryHelper.getVerifiedIndexDir(String, Properties, boolean)</code></a> method is deprecated. Use <a class="link" href="http://docs.jboss.org/hibernate/search/5.5/api/org/hibernate/search/store/spi/DirectoryHelper.html#getVerifiedIndexPath-java.lang.String-java.util.Properties-boolean-"><code class="literal">DirectoryHelper.getVerifiedIndexPath(java.lang.String, java.util.Properties, boolean)</code></a> instead.
					</li><li class="listitem"><p class="simpara">
						The following is a list of Hibernate Search classes that were repackaged or renamed.
					</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Previous Package and Class</th><th style="text-align: left" valign="top">New Package and Class</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
										org.hibernate.search.engine.impl.SearchMappingBuilder
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										org.hibernate.search.engine.spi.SearchMappingHelper
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										org.hibernate.search.indexes.impl.DirectoryBasedIndexManager
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										org.hibernate.search.indexes.spi.DirectoryBasedIndexManager
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										org.hibernate.search.spi.MassIndexerFactory
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										org.hibernate.search.batchindexing.spi.MassIndexerFactory
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										org.hibernate.search.spi.SearchFactoryBuilder
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										org.hibernate.search.spi.SearchIntegratorBuilder
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										org.hibernate.search.spi.SearchFactoryIntegrator
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										org.hibernate.search.spi.SearchIntegrator
									</p>
									 </td></tr></tbody></table></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_entity_beans_to_jpa"/>Migrate Entity Beans to JPA</h1></div></div></div><p>
				Support for EJB Entity Beans is optional in Java EE 7 and they are not supported in JBoss EAP 7. This means container-managed persistence (CMP) and bean-managed persistence (BMP) entity beans must be rewritten to use Java Persistence API (JPA) entities when you migrate to JBoss EAP 7.
			</p><p>
				In previous releases of JBoss EAP, entity beans were created in application source code by extending the <code class="literal">javax.ejb.EntityBean</code> class and implementing the required methods. They were then configured in the <code class="literal">ejb-jar.xml</code> file. A CMP entity bean was specified using an <code class="literal">&lt;entity&gt;</code> element that contained a <code class="literal">&lt;persistence-type&gt;</code> child element with a value of <span class="strong"><strong>Container</strong></span>. A BMP entity bean was specified using an <code class="literal">&lt;entity&gt;</code> element that contained a <code class="literal">&lt;persistence-type&gt;</code> child element with a value of <span class="strong"><strong>Bean</strong></span>.
			</p><p>
				In JBoss EAP 7, you must replace any CMP and BMP entity beans in your code with Java Persistence API (JPA) entities. JPA entities are created using the <a class="link" href="https://docs.oracle.com/javaee/7/api/index.html?javax/persistence/package-summary.html">javax.persistence.*</a> classes and are defined in the <code class="literal">persistence.xml</code> file.
			</p><p>
				The following is an example of a JPA entity class.
			</p><pre class="programlisting">import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.Table;

@Entity
// User is a keyword in some SQL dialects!
@Table(name = "MyUsers")
public class MyUser {
    @Id
    @GeneratedValue
    private Long id;

    @Column(unique = true)
    private String username;
    private String firstName;
    private String lastName;

    public Long getId() {
        return id;
    }
    public String getUsername() {
        return username;
    }
    public void setUsername(String username) {
        this.username = username;
    }
    public String getFirstName() {
        return firstName;
    }
    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }
    public String getLastName() {
        return lastName;
    }
    public void setLastName(String lastName) {
        this.lastName = lastName;
    }</pre><p>
				The following is an example of a <code class="literal">persistence.xml</code> file.
			</p><pre class="programlisting">&lt;persistence version="2.1"
      xmlns="http://xmlns.jcp.org/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="
        http://xmlns.jcp.org/xml/ns/persistence
        http://xmlns.jcp.org/xml/ns/persistence/persistence_2_1.xsd"&gt;
  &lt;persistence-unit name="my-unique-persistence-unit-name"&gt;
    &lt;properties&gt;
      // properties...
    &lt;/properties&gt;
  &lt;/persistence-unit&gt;
&lt;/persistence&gt;</pre><p>
				For working examples of JPA entities, see the <code class="literal">bmt</code>, <code class="literal">cmt</code>, and <code class="literal">hibernate5</code> quickstarts that ship with JBoss EAP 7.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_jpa_persistence_changes"/>JPA Persistence Property Changes</h1></div></div></div><h3><a id="migrate_jpa_persistence_changes_7"/>JPA Persistence Property Changes Introduced in JBoss EAP 7.0</h3><p>
				A new persistence property, <code class="literal">jboss.as.jpa.deferdetach</code>, was added to provide compatibility with the persistence behavior in previous releases of JBoss EAP.
			</p><p>
				The <code class="literal">jboss.as.jpa.deferdetach</code> property controls whether the transaction-scoped persistence context used in a non-JTA transaction thread detaches loaded entities after each <code class="literal">EntityManager</code> invocation or whether it waits until the persistence context is closed, for example, when the session bean invocation ends. The property value defaults to <code class="literal">false</code>, meaning entities are detached or cleared after each <code class="literal">EntityManager</code> invocation. This is the correct default behavior as defined in the <a class="link" href="https://jcp.org/en/jsr/detail?id=338">JPA specification</a>. If the property value is set to <code class="literal">true</code>, the entities are not detached until the persistence context is closed.
			</p><p>
				In JBoss EAP 5, persistence behaved as if the <code class="literal">jboss.as.jpa.deferdetach</code> property was set to <code class="literal">true</code>. To get this same behavior when migrating your application from JBoss EAP 5 to JBoss EAP 7, you must set the <code class="literal">jboss.as.jpa.deferdetach</code> property value to <code class="literal">true</code> in your <code class="literal">persistence.xml</code> as shown in the following example.
			</p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence xmlns="http://java.sun.com/xml/ns/persistence" version="1.0"&gt;
    &lt;persistence-unit name="EAP5_COMPAT_PU"&gt;
    &lt;jta-data-source&gt;java:jboss/datasources/ExampleDS&lt;/jta-data-source&gt;
    &lt;properties&gt;
         &lt;property name="jboss.as.jpa.deferdetach" value="true" /&gt;
    &lt;/properties&gt;
  &lt;/persistence-unit&gt;
&lt;/persistence&gt;</pre><p>
				In JBoss EAP 6, persistence behaved as if the <code class="literal">jboss.as.jpa.deferdetach</code> property was set to <code class="literal">false</code>. This is the same behavior as seen in JBoss EAP 7, so no changes are necessary when you migrate your application.
			</p><h3><a id="migrate_jpa_persistence_changes_7_1"/>JPA Persistence Property Changes Introduced in JBoss EAP 7.1</h3><p>
				In JBoss EAP 7.0, unsynchronized persistence context error checking was not as strict as it should have been in the following areas.
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						A synchronized container-managed persistence context was allowed to use an unsynchronized extended persistence context that was associated with a JTA transaction. Instead, it should have thrown an <code class="literal">IllegalStateException</code> to prevent the unsynchronized persistence context from being used.
					</li><li class="listitem">
						An unsynchronized persistence context specified in a deployment descriptor was treated as synchronized.
					</li></ul></div><p>
				In addition, <code class="literal">PersistenceProperty</code> hints in the <code class="literal">@PersistenceContext</code> were mistakenly ignored in JBoss EAP 7.0.
			</p><p>
				These issues were addressed and fixed in JBoss EAP 7.1 and later. Because these updates can result in an unwanted change in application behavior, two new persistence unit properties were introduced in JBoss EAP 7.1 to provide backward compatibility and preserve the previous behavior.
			</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Property</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								<code class="literal">wildfly.jpa.skipmixedsynctypechecking</code>
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								This property disables the error checking. It should only be used as a temporary measure for backward compatibility in situations where applications worked in JBoss EAP 7.0 and fail in JBoss EAP 7.1 and later. Because this property might be deprecated in a future release, it is recommended that you correct your application code as soon as you are able to do so.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								<code class="literal">wildfly.jpa.allowjoinedunsync</code>
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								This property is an alternative to <code class="literal">wildfly.jpa.skipmixedsynctypechecking</code>. It allows the application to treat unsynchronized persistence contexts that are associated with a JTA transaction as if they are synchronized persistence contexts.
							</p>
							 </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_ejb_client_code"/>Migrate EJB Client Code</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_ejb_client_code_to_eap_7"/>EJB Client Changes in JBoss EAP 7</h2></div></div></div><p>
					The default remote connector and port has changed in JBoss EAP 7. For details about this change, see <a class="link" href="application_migration_changes.html#migrate_default_remote_url_connector_and_port_changes" title="Update the Remote URL Connector and Port">Update the Remote URL Connector and Port</a>.
				</p><p>
					If you used the <code class="literal">migrate</code> operation to migrate your server configuration, the old settings are preserved and you do not need to make the changes detailed below. However, if you run with the new JBoss EAP 7 default configuration, you must make the following changes.
				</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="migrate_ejb_client_code_update_default_remote_connection_port"/>Update the Default Remote Connection Port</h3></div></div></div><p>
						Change the remote connection port value from <code class="literal">4447</code> to <code class="literal">8080</code> in the <code class="literal">jboss-ejb-client.properties</code> file.
					</p><p>
						The following are examples of a <code class="literal">jboss-ejb-client.properties</code> file in the previous and the current release.
					</p><div class="title"><strong>Example: JBoss EAP 6 <code class="literal">jboss-ejb-client.properties</code> File</strong></div><p>
							
</p><pre class="screen">remote.connectionprovider.create.options.org.xnio.Options.SSL_ENABLED=false
remote.connections=default
remote.connection.default.host=localhost
remote.connection.default.port=4447
remote.connection.default.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false</pre><p>

						</p><div class="title"><strong>Example: JBoss EAP 7 <code class="literal">jboss-ejb-client.properties</code> File</strong></div><p>
							
</p><pre class="screen">remote.connectionprovider.create.options.org.xnio.Options.SSL_ENABLED=false
remote.connections=default
remote.connection.default.host=localhost
remote.connection.default.port=8080
remote.connection.default.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false</pre><p>

						</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="migrate_ejb_client_code_update_default_connector"/>Update the Default Connector</h3></div></div></div><p>
						If you are running with the new JBoss EAP 7 configuration, the default connector has changed from <code class="literal">remote</code> to <code class="literal">http-remoting</code>. This change impacts clients that use libraries from one release of JBoss EAP and to connect to server in a different release.
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								If a client application uses the EJB client library from JBoss EAP 6 and wants to connect to JBoss EAP 7 server, the server must be configured to expose a <code class="literal">remote</code> connector on a port other than <code class="literal">8080</code>. The client must then connect using that newly configured connector.
							</li><li class="listitem"><p class="simpara">
								A client application that uses the EJB client library from JBoss EAP 7 and wants to connect to JBoss EAP 6 server must be aware that the server instance does not use the <code class="literal">http-remoting</code> connector and instead uses a <code class="literal">remote</code> connector. This is achieved by defining a new client-side connection property.
							</p><div class="title"><strong>Example: <code class="literal">remote</code> Connection Property</strong></div><p>
									
</p><pre class="screen">remote.connection.default.protocol=remote</pre><p>

								</p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_remote_naming_client_code"/>Migrate Remote Naming Client Code</h2></div></div></div><p>
					If you are running with the new default JBoss EAP 7 configuration, you must modify your client code to use the new default remote port and connector.
				</p><p>
					The following is an example of how remote naming properties were specified in the client code in JBoss EAP 6.
				</p><pre class="screen">java.naming.factory.initial=org.jboss.naming.remote.client.InitialContextFactory
java.naming.provider.url=remote://localhost:4447</pre><p>
					The following is an example of how to specify the remote naming properties in the client code in JBoss EAP 7.
				</p><pre class="screen">java.naming.factory.initial=org.wildfly.naming.client.WildFlyInitialContextFactory
java.naming.provider.url=http-remoting://localhost:8080</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_ejb_client_code_to_eap_71"/>Additional EJB Client Changes Introduced in JBoss EAP 7.1</h2></div></div></div><p>
					While JBoss EAP 7.0 shipped with JBoss EJB Client 2.1.4, JBoss EAP 7.1 and later ship with JBoss EJB Client 4.0.x, which includes a number of changes to the API.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
							The <code class="literal">org.ejb.client.EJBClientInvocationContext</code> class has added the following new methods.
						</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Method</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
											<code class="literal">isBlockingCaller()</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											boolean
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											Determine whether this invocation is currently blocking the calling thread.
										</p>
										 </td></tr><tr><td style="text-align: left" valign="top"> <p>
											<code class="literal">isClientAsync()</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											boolean
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											Determine whether the method is marked client-asynchronous, meaning that invocation should be asynchronous regardless of whether the server-side method is asynchronous.
										</p>
										 </td></tr><tr><td style="text-align: left" valign="top"> <p>
											<code class="literal">isIdempotent()</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											boolean
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											Determine whether the method is marked idempotent, meaning that the method may be invoked more than one time with no additional effect.
										</p>
										 </td></tr><tr><td style="text-align: left" valign="top"> <p>
											<code class="literal">setBlockingCaller(boolean)</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											void
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											Establish whether this invocation is currently blocking the calling thread.
										</p>
										 </td></tr><tr><td style="text-align: left" valign="top"> <p>
											<code class="literal">setLocator(EJBLocator&lt;T&gt;)</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											<code class="literal">&lt;T&gt; void</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											Set the locator for the invocation target.
										</p>
										 </td></tr></tbody></table></div></li><li class="listitem"><p class="simpara">
							The <code class="literal">org.ejb.client.EJBLocator</code> class has added the following new methods.
						</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Method</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
											<code class="literal">asStateful()</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											<code class="literal">StatefulEJBLocator&lt;T&gt;</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											Return this locator as a stateful locator, if it is one.
										</p>
										 </td></tr><tr><td style="text-align: left" valign="top"> <p>
											<code class="literal">asStateless()</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											<code class="literal">StatelessEJBLocator&lt;T&gt;</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											Return this locator as a stateless locator, if it is one.
										</p>
										 </td></tr><tr><td style="text-align: left" valign="top"> <p>
											<code class="literal">isEntity()</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											boolean
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											Determine if this is an entity locator.
										</p>
										 </td></tr><tr><td style="text-align: left" valign="top"> <p>
											<code class="literal">isHome()</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											boolean
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											Determine if this is a home locator.
										</p>
										 </td></tr><tr><td style="text-align: left" valign="top"> <p>
											<code class="literal">isStateful()</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											boolean
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											Determine if this is a stateful locator.
										</p>
										 </td></tr><tr><td style="text-align: left" valign="top"> <p>
											<code class="literal">isStateless()</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											boolean
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											Determine if this is a stateless locator.
										</p>
										 </td></tr><tr><td style="text-align: left" valign="top"> <p>
											<code class="literal">withNewAffinity(Affinity)</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											<code class="literal">abstract EJBLocator&lt;T&gt;</code>
										</p>
										 </td><td style="text-align: left" valign="top"> <p>
											Create a copy of this locator, but with the new given affinity.
										</p>
										 </td></tr></tbody></table></div></li><li class="listitem"><p class="simpara">
							A new <code class="literal">org.ejb.client.EJBClientPermission</code> class, which is a subclass of <a class="link" href="https://docs.oracle.com/javase/8/docs/api/java/security/Permission.html?is-external=true"><code class="literal">java.security.Permission</code></a>, has been introduced for controlling access to privileged EJB operations.
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
									It provides the following constructors.
								</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
											<code class="literal">EJBClientPermission(String name)</code>
										</li><li class="listitem">
											<code class="literal">EJBClientPermission(String name, String actions)</code>
										</li></ul></div></li><li class="listitem"><p class="simpara">
									It provides the following methods.
								</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Method</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">equals(EJBClientPermission obj)</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													boolean
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Checks two <code class="literal">EJBClientPermission</code> objects for equality.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">equals(Object obj)</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													boolean
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Checks two <code class="literal">Permission</code> objects for equality.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">equals(Permission obj)</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													boolean
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Checks two <code class="literal">Permission</code> objects for equality.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">getActions()</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													String
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Returns the actions as a string.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">hashcode()</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													int
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Returns the hash code value for this <code class="literal">Permission</code> object.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">implies(EJBClientPermission permission)</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													boolean
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Checks if the specified permission’s actions are <span class="emphasis"><em>implied by</em></span> this <code class="literal">EJBClientPermission</code> object’s actions.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">implies(Permission permission)</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													boolean
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Checks if the specified permission’s actions are <span class="emphasis"><em>implied by</em></span> this <code class="literal">Permission</code> object’s actions.
												</p>
												 </td></tr></tbody></table></div></li></ul></div></li><li class="listitem"><p class="simpara">
							A new <code class="literal">org.ejb.client.EJBMethodLocator</code> class has been introduced for locating a specific EJB method.
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
									It provides the following constructor.
								</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
											<code class="literal">EJBMethodLocator(String methodName, String…​ parameterTypeNames)</code>
										</li></ul></div></li><li class="listitem"><p class="simpara">
									It provides the following methods.
								</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Method</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">equals(EJBMethodLocator other)</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													boolean
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Determine whether this object is equal to another.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">equals(Object other)</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													boolean
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Determine whether this object is equal to another.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">forMethod(Method method)</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													<code class="literal">static EJBMethodLocator</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Get a method locator for the given reflection method.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">getMethodName()</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													String
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Get the method name.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">getParameterCount()</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													int
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Get the parameter count.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">getParameterTypeName(int index)</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													String
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Get the name of the parameter at the given index.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">hashCode()</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													int
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Get the hash code.
												</p>
												 </td></tr></tbody></table></div></li></ul></div></li><li class="listitem"><p class="simpara">
							A new <code class="literal">org.jboss.ejb.client.EJBReceiverInvocationContext.ResultProducer.Failed</code> class has been introduced for failure cases.
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
									It provides the following constructor.
								</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
											<code class="literal">Failed(Exception cause)</code>
										</li></ul></div></li><li class="listitem"><p class="simpara">
									It provides the following methods.
								</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Method</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">discardResult()</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													void
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Discard the result, indicating that it will not be used.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">getResult()</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													<code class="literal">Object</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Get the result.
												</p>
												 </td></tr></tbody></table></div></li></ul></div></li><li class="listitem"><p class="simpara">
							A new <code class="literal">org.jboss.ejb.client.EJBReceiverInvocationContext.ResultProducer.Immediate</code> class has been introduced for immediate results.
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
									It provides the following constructor.
								</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
											<code class="literal">Failed(Exception cause)</code>
										</li></ul></div></li><li class="listitem"><p class="simpara">
									It provides the following methods.
								</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Method</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">discardResult()</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													void
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Discard the result, indicating that it will not be used.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">getResult()</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													<code class="literal">Object</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Get the result.
												</p>
												 </td></tr></tbody></table></div></li></ul></div></li><li class="listitem"><p class="simpara">
							A new <code class="literal">org.jboss.ejb.client.URIAffinity</code> class, which is a subclass of <code class="literal">org.jboss.ejb.client.Affinity</code> has been introduced for URI affinity specification.
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									It is created using <code class="literal">Affinity.forUri(URI)</code>.
								</li><li class="listitem"><p class="simpara">
									It provides the following methods.
								</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Method</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">equals(Affinity other)</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													boolean
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Indicates whether another object is equal to this one.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">equals(Object other)</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													boolean
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Indicates whether another object is equal to this one.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">equals(URIAffinity other)</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													boolean
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Indicates whether another object is equal to this one.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">getURI()</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													URI
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Get the associated URI.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">hashCode()</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													int
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Get the hash code.
												</p>
												 </td></tr><tr><td style="text-align: left" valign="top"> <p>
													<code class="literal">toString()</code>
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													String
												</p>
												 </td><td style="text-align: left" valign="top"> <p>
													Returns a string representation of the object.
												</p>
												 </td></tr></tbody></table></div></li></ul></div></li><li class="listitem"><p class="simpara">
							The <code class="literal">org.jboss.ejb.client.EJBMetaDataImpl</code> class has deprecated the following methods.
						</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
									<code class="literal">toAbstractEJBMetaData()</code>
								</li><li class="listitem">
									<code class="literal">EJBMetaDataImpl(AbstractEJBMetaData&lt;?,?&gt;)</code>
								</li></ul></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_ejb_client_code_to_eap_72"/>EJB Client Changes Needed for JBoss EAP 7.2</h2></div></div></div><p>
					The upgrade of the <code class="literal">org.apache.santuario.xmlsec</code> module from 2.0.8 to 2.1.1 in JBoss EAP 7.2 has caused a regression with remoting in <code class="literal">PicketLinkSTS</code>. The issue manifests itself as the following runtime exception.
				</p><pre class="screen">java.lang.IllegalArgumentException: ELY05131: Invalid ASCII control "0xA"</pre><p>
					This is caused by a change in the formatting in the generated <code class="literal">SignatureValue</code> in the assertion. In the previous release, the generated value looked similar to the following example.
				</p><pre class="programlisting">&lt;dsig:SignatureValue xmlns:dsig="http://www.w3.org/2000/09/xmldsig#"&gt;cUNpFJIZlLYrBDZtQSTDrq2K6PbnAHyg2qbx/D5FuB4XMjdQ5oxQjkMejLyelnA7s4GFusoLhahlqlTOT8UrOyxrR4yYAmJ/e5s+f4gys926+tbiraT/3/wG8wM/Lvcjvk5Ap69zODuRYpypsWfA4jrI7TTBXVPGy8g4KUdnFviUiTuFTc2Ghgxp53AmUuLis/THyP28jE7+28//q8bi/bQrFwHC6tWX67+NK1duFCOcQ6IPIKeVrePZz55Ivgl+WWdkF6uYCz5IdMzurhzmeQ3K8DAMIxz/MG67VWJIOnuGNWF7nmdye5zd9AFcRsr1XadvZJCbGNfuc89AL5inCg==&lt;/dsig:SignatureValue&gt;</pre><p>
					In JBoss EAP 7.2, the generated string value now contains instances of invalid hidden ASCII <code class="literal">0xD</code> carriage return and <code class="literal">0xA</code> line feed control characters.
				</p><pre class="programlisting">&lt;dsig:SignatureValue xmlns:dsig="http://www.w3.org/2000/09/xmldsig#"&gt;cUNpFJIZlLYrBDZtQSTDrq2K6PbnAHyg2qbx/D5FuB4XMjdQ5oxQjkMejLyelnA7s4GFusoLhahl&amp;#13;
qlTOT8UrOyxrR4yYAmJ/e5s+f4gys926+tbiraT/3/wG8wM/Lvcjvk5Ap69zODuRYpypsWfA4jrI&amp;#13;
7TTBXVPGy8g4KUdnFviUiTuFTc2Ghgxp53AmUuLis/THyP28jE7+28//q8bi/bQrFwHC6tWX67+N&amp;#13;
K1duFCOcQ6IPIKeVrePZz55Ivgl+WWdkF6uYCz5IdMzurhzmeQ3K8DAMIxz/MG67VWJIOnuGNWF7&amp;#13;
nmdye5zd9AFcRsr1XadvZJCbGNfuc89AL5inCg==&lt;/dsig:SignatureValue&gt;</pre><p>
					If you experience the above runtime exception, you must update your client code to remove occurrences of the hidden ASCII characters from the the returned assertion string.
				</p><p>
					For example, assume your current code looks similar to the following example.
				</p><pre class="programlisting">WSTrustClient client = new WSTrustClient("PicketLinkSTS", "PicketLinkSTSPort",
                "http://localhost:8080/picketlink-sts/PicketLinkSTS", new WSTrustClient.SecurityInfo(username, password));
Element assertion = client.issueToken(SAMLUtil.SAML2_TOKEN_TYPE);

// Return the assertion as a string
String assertionString = DocumentUtil.getNodeAsString(assertion);
...
properties.put("remote.connection.main.password", assertionString);</pre><p>
					You must add a line of code to remove the occurrences of the invalid hidden ASCII <code class="literal">0xD</code> carriage return and <code class="literal">0xA</code> line feed characters as shown below.
				</p><pre class="programlisting">WSTrustClient client = new WSTrustClient("PicketLinkSTS", "PicketLinkSTSPort",
                "http://localhost:8080/picketlink-sts/PicketLinkSTS", new WSTrustClient.SecurityInfo(username, password));
Element assertion = client.issueToken(SAMLUtil.SAML2_TOKEN_TYPE);

// Return the assertion as a string, stripping the invalid hidden ASCII characters
String assertionString = DocumentUtil.getNodeAsString(assertion).replace(String.valueOf((char) 0xA), "").replace(String.valueOf((char) 0xD), "");
...
properties.put("remote.connection.main.password", assertionString);</pre></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_clients_to_use_wildfly_configuration"/>Migrate Clients to Use the WildFly Configuration File</h1></div></div></div><p>
				Prior to release 7.1, JBoss EAP client libraries, such as EJB and naming, used different configuration strategies. JBoss EAP 7.1 introduced the <code class="literal">wildfly-config.xml</code> file with the purpose of unifying all client configurations into one single configuration file, in a similar manner to the way the server configuration is handled.
			</p><p>
				For example, prior to JBoss EAP 7.1, you might create a new <code class="literal">InitialContext</code> for a Java EJB client using a <code class="literal">jboss-ejb-client.properties</code> file, or by programmatically setting the properties using a <code class="literal">Properties</code> class.
			</p><div class="title"><strong>Example: <code class="literal">jboss-ejb-client.properties</code> Properties File</strong></div><p>
					
</p><pre class="screen">remote.connectionprovider.create.options.org.xnio.Options.SSL_ENABLED=false
remote.connections=one
remote.connection.one.port=8080
remote.connection.one.host=127.0.0.1
remote.connection.one.username=quickuser
remote.connection.one.password=quick-123</pre><p>

				</p><p>
				In JBoss EAP 7.1 and later, you create a <code class="literal">wildfly-config.xml</code> file in the <code class="literal">META-INF/</code> directory of the client archive. This is the equivalent configuration using a <code class="literal">wildfly-config.xml</code> file.
			</p><div class="title"><strong>Example: Equivalent Configuration Using the <code class="literal">wildfly-config.xml</code> File</strong></div><p>
					
</p><pre class="programlisting">&lt;configuration&gt;
    &lt;authentication-client xmlns="urn:elytron:client:1.2"&gt;
        &lt;authentication-rules&gt;
            &lt;rule use-configuration="ejb"/&gt;
        &lt;/authentication-rules&gt;
        &lt;authentication-configurations&gt;
            &lt;configuration name="ejb"&gt;
                &lt;set-user-name name="quickuser"/&gt;
                &lt;credentials&gt;
                    &lt;clear-password password="quick-123"/&gt;
                &lt;/credentials&gt;
            &lt;/configuration&gt;
        &lt;/authentication-configurations&gt;
    &lt;/authentication-client&gt;
    &lt;jboss-ejb-client xmlns="urn:jboss:wildfly-client-ejb:3.0"&gt;
        &lt;connections&gt;
            &lt;connection uri="remote+http://127.0.0.1:8080" /&gt;
        &lt;/connections&gt;
    &lt;/jboss-ejb-client&gt;
&lt;/configuration&gt;</pre><p>

				</p><p>
				For information about how to configure client authentication for the Elytron Client using the <code class="literal">wildfly-config.xml</code> file, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/how_to_configure_identity_management/#elytron_client_authentication">Configure Client Authentication with Elytron Client</a> in <span class="emphasis"><em>How to Configure Identity Management</em></span> for JBoss EAP.
			</p><p>
				For more information about the types of client configurations that can be done using the <code class="literal">wildfly-config.xml</code> file, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/development_guide/#client_configuration_using_the_wildfly_config_file">Client Configuration Using the <code class="literal">wildfly-config.xml</code> File</a> in the JBoss EAP <span class="emphasis"><em>Development Guide</em></span>.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_deployment_plan_configurations"/>Migrate Deployment Plan Configurations</h1></div></div></div><p>
				The <a class="link" href="https://jcp.org/en/jsr/detail?id=88">Java EE Application Deployment specification (JSR-88)</a> was intended to define a standard contract to enable tools from multiple providers to configure and deploy applications on any Java EE platform product. The contract required Java EE Product Providers to implement the <code class="literal">DeploymentManager</code> and other <code class="literal">javax.enterprise.deploy.spi</code> interfaces to be accessed by the Tool Providers. In case of JBoss EAP 6, a deployment plan is identified by an XML descriptor named <code class="literal">deployment-plan.xml</code> that is bundled in a ZIP or JAR archive.
			</p><p>
				This specification saw very little adoption because most application server products provide their own more "feature rich" deployment solutions. For this reason, JSR-88 support was dropped from Java EE 7 and, in turn, from JBoss EAP 7.
			</p><p>
				If you used JSR-88 to deploy your application, you must now use another method to deploy the application. The JBoss EAP management CLI <code class="literal">deploy</code> command provides a standard way to deploy archives to standalone servers or to server groups in a managed domain. For more information about the management CLI, see the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/management_cli_guide/">Management CLI Guide</a>.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_custom_application_valves"/>Migrate Custom Application Valves</h1></div></div></div><p>
				You must manually migrate custom valves or any valves that are defined in the <code class="literal">jboss-web.xml</code> XML file. This includes valves created by extending the <code class="literal">org.apache.catalina.valves.ValveBase</code> class and configured in the <code class="literal">&lt;valve&gt;</code> element of the <code class="literal">jboss-web.xml</code> descriptor file.
			</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
					Custom valves and valves that are defined in the <code class="literal">jboss-web.xml</code> file must be rewritten or replaced by the corresponding Undertow built-in handler. For information about mapping valves to Undertow handlers, see <a class="link" href="server_configuration_changes.html#migrate_jboss_web_valves" title="Migrate JBoss Web Valves">Migrate JBoss Web Valves</a>.
				</p><p>
					Authentication valves must be replaced manually using Undertow built-in authentication mechanisms.
				</p></div><h3><a id="migrate_valves_configured_in_deployments"/>Migrate Valves Configured in Deployments</h3><p>
				In JBoss EAP 6, you could define custom valves at the application level by configuring them in the <code class="literal">jboss-web.xml</code> web application descriptor file. In JBoss EAP 7, it is possible to do this with Undertow handlers as well.
			</p><p>
				The following is an example of a valve configured in the <code class="literal">jboss-web.xml</code> file in JBoss EAP 6.
			</p><pre class="programlisting">&lt;jboss-web&gt;
    &lt;valve&gt;
        &lt;class-name&gt;org.jboss.examples.MyValve&lt;/class-name&gt;
​        &lt;param&gt;
    ​        &lt;param-name&gt;myParam&lt;/param-name&gt;
​            &lt;param-value&gt;foobar&lt;/param-value&gt;
    ​    &lt;/param&gt;
    &lt;/valve&gt;
&lt;/jboss-web&gt;</pre><p>
				For more information about how to create and configure custom handlers in JBoss EAP, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/development_guide/#creating_custom_handler">Creating Custom Handlers</a> in the JBoss EAP <span class="emphasis"><em>Development Guide</em></span>.
			</p><h3><a id="migrate_custom_authenticator_valves"/>Migrate Custom Authenticator Valves</h3><p>
				For information about how to migrate authenticator valves, see <a class="link" href="application_migration_changes.html#migrate_authenticator_valves" title="Migrate Authenticator Valves">Migrate Authenticator Valves</a> in this guide.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_security_application_changes"/>Security Application Changes</h1></div></div></div><p>
				The replacement of JBoss Web with Undertow requires changes to security configuration in JBoss EAP 7.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_authenticator_valves"/>Migrate Authenticator Valves</h2></div></div></div><p>
					If you created a custom authenticator valve that extended <code class="literal">AuthenticatorBase</code> in JBoss EAP 6.4, you must manually replace it with a custom HTTP authentication implementation in JBoss EAP 7. The HTTP authentication mechanism is created in the <code class="literal">elytron</code> subsystem and then registered with the <code class="literal">undertow</code> subsystem. For information about how to implement a custom HTTP authentication mechanism, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/development_guide/#custom_http_mechanism">Developing a Custom HTTP Mechanism</a> in the <span class="emphasis"><em>Development Guide</em></span> for JBoss EAP.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_picketlink_changes"/>PicketLink Changes</h2></div></div></div><p>
					For information about the changes required for SSO with SAML v2 configuration, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/how_to_set_up_sso_with_saml_v2/#picketlink-changes-from-prev-version">Changes from Previous Versions of JBoss EAP</a> in <span class="emphasis"><em>How To Set Up SSO with SAML v2</em></span> for JBoss EAP.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_other_security_application_changes"/>Other Security Application Changes</h2></div></div></div><p>
					For information about the differences in SSO configuration with Kerberos, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/how_to_set_up_sso_with_kerberos/#differences_from_configuring_previous_versions_jboss_eap">Differences from Configuring Previous Versions JBoss EAP</a> in <span class="emphasis"><em>How to Set Up SSO with Kerberos</em></span> for JBoss EAP.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_jboss_logging_changes"/>JBoss Logging Changes</h1></div></div></div><p>
				If your application uses JBoss Logging, be aware that the annotations in the <code class="literal">org.jboss.logging</code> package are now deprecated in JBoss EAP 7. They have been moved to the <code class="literal">org.jboss.logging.annotations</code> package, so you must update your source code to import the new package.
			</p><p>
				The annotations have also moved to a separate Maven <code class="literal">groupId:artifactId:version</code> (GAV) ID so you need to add a new project dependency for <code class="literal">org.jboss.logging:jboss-logging-annotations</code> in your project <code class="literal">pom.xml</code> file.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					Only the logging annotations have moved. The <code class="literal">org.jboss.logging.BasicLogger</code> and <code class="literal">org.jboss.logging.Logger</code> still exist in the <code class="literal">org.jboss.logging</code> package.
				</p></div><p>
				The following table lists the deprecated annotation classes and corresponding replacements.
			</p><div class="table"><a id="idm139952492068496"/><p class="title"><strong>Table 5.1. Deprecated Logging Annotation Replacements</strong></p><div class="table-contents"><table summary="Deprecated Logging Annotation Replacements" border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Deprecated Class</th><th style="text-align: left" valign="top">Replacement Class</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.Cause
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.annotations.Cause
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.Field
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.annotations.Field
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.FormatWith
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.annotations.FormatWith
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.LoggingClass
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.annotations.LoggingClass
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.LogMessage
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.annotations.LogMessage
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.Message
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.annotations.Message
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.MessageBundle
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.annotations.MessageBundle
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.MessageLogger
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.annotations.MessageLogger
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.Param
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.annotations.Param
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.Property
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.jboss.logging.annotations.Property
							</p>
							 </td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_jsf_code_changes"/>JavaServer Faces (JSF) Code Changes</h1></div></div></div><h3><a id="dropped_support_for_jsf_1_2"/>Dropped Support for JSF 1.2</h3><p>
				JBoss EAP 6.4 allowed you to continue to use JSF 1.2 with your application deployment by creating a <code class="literal">jboss-deployment-structure.xml</code> file.
			</p><p>
				JBoss EAP 7.2 includes JSF 2.3 and no longer supports the JSF 1.2 API. If your application uses JSF 1.2, you must rewrite it to use JSF 2.3.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="migrate_module_class_loading_changes"/>Module Class Loading Changes</h1></div></div></div><p>
				In JBoss EAP 7, the class loading behavior has changed in cases where multiple modules contain the same classes or packages.
			</p><p>
				Assume there are two modules, <code class="literal">MODULE_A</code> and <code class="literal">MODULE_B</code>, that depend upon each other and contain some of the same packages. In JBoss EAP 6, the classes or packages that were loaded from the dependencies took precedence over those specified in the <code class="literal">resource-root</code> of the <code class="literal">module.xml</code> file. This meant <code class="literal">MODULE_A</code> saw the packages for <code class="literal">MODULE_B</code> and <code class="literal">MODULE_B</code> saw the packages for <code class="literal">MODULE_A</code>. This behavior was confusing and could cause conflicts. This behavior has changed in JBoss EAP 7. Now the classes or packages specified by the <code class="literal">resource-root</code> in the <code class="literal">module.xml</code> file take precedence over those specified by the dependency. This means <code class="literal">MODULE_A</code> sees the packages for <code class="literal">MODULE_A</code> and <code class="literal">MODULE_B</code> sees the packages for <code class="literal">MODULE_B</code>. This prevents conflicts and provides a more appropriate behavior.
			</p><p>
				If you have defined custom modules that include <code class="literal">resource-root</code> libraries or packages that contain classes that are duplicated in their module dependencies, you might see <code class="literal">ClassCastException</code>, <code class="literal">LinkageError</code>, class loading errors, or other changes in behavior when you migrate to JBoss EAP 7. To resolve these issues, you must configure your <code class="literal">module.xml</code> file to ensure only one version of a class is used. This can be accomplished by using either of the following approaches.
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						You can avoid specifying a <code class="literal">resource-root</code> that duplicates classes in the module dependency.
					</li><li class="listitem"><p class="simpara">
						You can use the <code class="literal">include</code> and <code class="literal">exclude</code> sub-elements of the <code class="literal">imports</code> and <code class="literal">exports</code> elements to control class loading in the <code class="literal">module.xml</code> file. The following is an export element that excludes classes is in the specified package.
					</p><pre class="programlisting">&lt;exports&gt;
  &lt;exclude path="com/mycompany/duplicateclassespath/"/&gt;
&lt;/exports&gt;</pre></li></ul></div><p>
				If you prefer to preserve your existing behavior, you must filter the dependency packages from the dependent <code class="literal">resource-root</code> in the <code class="literal">module.xml</code> file using the <code class="literal">filter</code> element. This allows you to retain the existing behavior without the odd looping that you would see under JBoss EAP 6. The following is an example of a <code class="literal">root-resource</code> that filters classes in a specified package.
			</p><pre class="programlisting">&lt;resource-root path="mycompany.jar"&gt;
  &lt;filter&gt;
    &lt;exclude path="com/mycompany/duplicateclassespath"/&gt;
  &lt;/filter&gt;
&lt;/resource-root&gt;</pre><p>
				For more information about modules and class loading, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/development_guide/#class_loading_and_modules">Class Loading and Modules</a> in the JBoss EAP <span class="emphasis"><em>Development Guide</em></span>.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="application_clustering_changes"/>Application Clustering Changes</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_overview_new_clustering_features"/>Overview of New Clustering Features</h2></div></div></div><p>
					The following list describes some of the new clustering features to be aware of when migrating your application from JBoss EAP 6 to JBoss EAP 7.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							JBoss EAP 7 introduces a new public API for building singleton services that significantly simplifies the process. For information on singleton services, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/development_guide/#clustered_ha_singleton_service">HA Singleton Service</a> in the JBoss EAP <span class="emphasis"><em>Development Guide</em></span>
						</li><li class="listitem">
							A singleton deployment can be configured to deploy and start on only a single node in the cluster at a time. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/development_guide/#ha_singleton_deployments">HA Singleton Deployments</a> in the JBoss EAP <span class="emphasis"><em>Development Guide</em></span>.
						</li><li class="listitem">
							You can now define clustered singleton MDBs. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/developing_ejb_applications/#clustered_singleton_mdbs">Clustered Singleton MDBs</a> in <span class="emphasis"><em>Developing EJB Applications</em></span> for JBoss EAP.
						</li><li class="listitem">
							JBoss EAP 7 includes the Undertow mod_cluster implementation. This offers a pure Java load balancing solution that does not require an httpd web server. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/configuration_guide/#configuring_jboss_eap_load_balancer">Configuring JBoss EAP as a Front-end Load Balancer</a> in the JBoss EAP <span class="emphasis"><em>Configuration Guide</em></span>.
						</li></ul></div><p>
					The remainder of this section describes how clustering changes might impact the migration of your applications to JBoss EAP 7.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_web_session_clustering_changes"/>Web Session Clustering Changes</h2></div></div></div><p>
					JBoss EAP 7 introduces a new web session clustering implementation. It replaces the previous implementation, which was tightly coupled to the legacy JBoss Web subsystem source code.
				</p><p>
					The new web session clustering implementation impacts how the application is configured in the <code class="literal">jboss-web.xml</code> JBoss EAP proprietary web application XML descriptor file. The following are the only clustering configuration elements that remain in this file.
				</p><pre class="programlisting">&lt;jboss-web&gt;
  ...
  &lt;max-active-sessions&gt;...&lt;/max-active-sessions&gt;
  ...
  &lt;replication-config&gt;
    &lt;replication-granularity&gt;...&lt;/replication-granularity&gt;
    &lt;cache-name&gt;...&lt;/cache-name&gt;
  &lt;/replication-config&gt;
  ...
&lt;/jboss-web&gt;</pre><p>
					The following table describes how to achieve similar behavior for elements in the <code class="literal">jboss-web.xml</code> file that are now obsolete.
				</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Configuration Element</th><th style="text-align: left" valign="top">Description of Change</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									&lt;max-active-sessions/&gt;
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Previously, the session creation would fail if it caused the number of active sessions to exceed the value specified by <code class="literal">&lt;max-active-sessions/&gt;</code>.
								</p>
								 <p>
									In the new implementation, <code class="literal">&lt;max-active-sessions/&gt;</code> is used to enable session passivation. If session creation will cause the number of active sessions to exceed the <code class="literal">&lt;max-active-sessions/&gt;</code>, then the oldest session known to the session manager will passivate to make room for the new session.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									&lt;passivation-config/&gt;
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									This configuration element and its sub-elements are no longer used in JBoss EAP 7.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									&lt;use-session-passivation/&gt;
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Previously, passivation was enabled using this attribute.
								</p>
								 <p>
									In the new implementation, passivation is enabled by specifying a non-negative value for <code class="literal">&lt;max-active-sessions/&gt;</code>.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									&lt;passivation-min-idle-time/&gt;
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Previously, sessions needed to be active for a minimum amount of time before becoming a candidate for passivation. This could cause session creation to fail, even when passivation was enabled.
								</p>
								 <p>
									The new implementation does not support this logic and thus avoids this Denial of Service (DoS) vulnerability.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									&lt;passivation-max-idle-time/&gt;
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Previously, a session would be passivated after it was idle for a specific amount of time.
								</p>
								 <p>
									The new implementation only supports lazy passivation. It does not support eager passivation. Sessions are only passivated when necessary to comply with <code class="literal">&lt;max-active-sessions/&gt;</code>.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									&lt;replication-config/&gt;
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									The new implementation deprecates a number of sub-elements.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									&lt;replication-trigger/&gt;
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Previously, this element was used to determine when session replication was triggered. The new implementation replaces this configuration option with a single, robust strategy. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/development_guide/#immutable_session_attributes">Immutable Session Attributes</a> in the JBoss EAP <span class="emphasis"><em>Development Guide</em></span>.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									&lt;use-jk/&gt;
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Previously, the <code class="literal">instance-id</code> of the node handling a given request was appended to the <code class="literal">jsessionid</code>, for use by load balancers such as mod_jk, mod_proxy_balancer, mod_cluster, depending on the value specified for <code class="literal">&lt;use-jk/&gt;</code>.
								</p>
								 <p>
									In the new implementation, the <code class="literal">instance-id</code>, if defined, is always appended to the <code class="literal">jsessionid</code>.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									&lt;max-unreplicated-interval/&gt;
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Previously, this configuration option was intended as an optimization to prevent the replication of a session’s timestamp if no session attribute was changed. While this sounds nice, in practice it does not prevent any RPCs, since session access requires cache transaction RPCs regardless of whether any session attributes changed.
								</p>
								 <p>
									In the new implementation, the timestamp of a session is replicated on every request. This prevents stale session metadata following a failover.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									&lt;snapshot-mode/&gt;
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Previously, one could configure <code class="literal">&lt;snapshot-mode/&gt;</code> as <code class="literal">INSTANT</code> or <code class="literal">INTERVAL</code>. Infinispan’s asynchronous replication makes this configuration option obsolete.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									&lt;snapshot-interval/&gt;
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									This was only relevant for <code class="literal">&lt;snapshot-mode&gt;INTERVAL&lt;/snapshot-mode&gt;</code>. Since <code class="literal">&lt;snapshot-mode/&gt;</code> is obsolete, this option is now obsolete as well.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									&lt;session-notification-policy/&gt;
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Previously, the value specified by this attribute defined a policy for triggering session events.
								</p>
								 <p>
									In the new implementation, this behavior is specification-driven and not configurable.
								</p>
								 </td></tr></tbody></table></div><p>
					This new implementation also supports write-through cache stores as well as passivation-only cache stores. Typically, a write-through cache store is used in conjunction with an invalidation cache. The web session clustering implementation in JBoss EAP 6 did not operate correctly when used with an invalidation cache.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_stateful_session_ejb_clustering_changes"/>Stateful Session EJB Clustering Changes</h2></div></div></div><p>
					In JBoss EAP 6, you were required to enabled the clustering behavior for stateful session beans (SFSBs) in one of the following ways.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
							You could add the <code class="literal">org.jboss.ejb3.annotation.Clustered</code> annotation in the session bean.
						</p><pre class="programlisting">@Stateful
@Clustered
public class MyBean implements MySessionInt {

   public void myMethod() {
      //
   }
}</pre></li><li class="listitem"><p class="simpara">
							You could add the <code class="literal">&lt;clustered&gt;</code> element to the <code class="literal">jboss-ejb3.xml</code> file.
						</p><pre class="programlisting">&lt;c:clustering&gt;
  &lt;ejb-name&gt;DDBasedClusteredSFSB&lt;/ejb-name&gt;
  &lt;c:clustered&gt;true&lt;/c:clustered&gt;
&lt;/c:clustering&gt;</pre></li></ul></div><p>
					JBoss EAP 7 no longer requires you to enable the clustering behavior. By default, if the server is started using an HA profile, the state of SFSBs will be replicated automatically.
				</p><p>
					You can disable this default behavior in one of the following ways.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							You can disable the default behavior for a single stateful session bean by using <code class="literal">@Stateful(passivationCapable=false)</code>, which is new to the EJB 3.2 specification.
						</li><li class="listitem">
							You can disable this behavior globally in the configuration of the <code class="literal">ejb3</code> subsystem in the server configuration.
						</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						If the <code class="literal">@Clustered</code> annotation is not removed from the application, it is simply ignored and does not affect the deployment of the application.
					</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_clustering_services_changes"/>Clustering Services Changes</h2></div></div></div><p>
					In JBoss EAP 6, the APIs for clustering services were in private modules and were not supported.
				</p><p>
					JBoss EAP 7 introduces a public clustering services API for use by applications. The new services are designed to be lightweight, easily injectable, and require no external dependencies.
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							The new <code class="literal">org.wildfly.clustering.group.Group</code> interface provides access to the current cluster status and allows listening for cluster membership changes.
						</li><li class="listitem">
							The new <code class="literal">org.wildfly.clustering.dispatcher.CommandDispatcher</code> interface allows running code in the cluster, on all or a selected subset of nodes.
						</li></ul></div><p>
					These services replace similar APIs that were available in previous releases, namely <code class="literal">HAPartition</code> from JBoss EAP 5 and <code class="literal">GroupCommunicationService</code>, <code class="literal">GroupMembershipNotifier</code>, and <code class="literal">GroupRpcDispatcher</code> in JBoss EAP 6.
				</p><p>
					For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/development_guide/#public_API_for_clustering-services">Public API for Clustering Services</a> in the JBoss EAP <span class="emphasis"><em>Development Guide</em></span>.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="migrate_clustering_ha_singleton"/>Migrate Clustering HA Singleton</h2></div></div></div><p>
					In JBoss EAP 6, there was no public API available for the cluster-wide HA singleton service. If you used the private <code class="literal">org.jboss.as.clustering.singleton.*</code> classes, you must change your code to use the new public <code class="literal">org.wildfly.clustering.singleton.*</code> packages when you migrate your application to JBoss EAP 7.
				</p><p>
					For more information about HA singleton services, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/development_guide/#clustered_ha_singleton_service">HA Singleton Service</a> in the <span class="emphasis"><em>Development Guide</em></span> for JBoss EAP. For information about HA singleton deployments, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/development_guide/#ha_singleton_deployments">HA Singleton Deployments</a> in the <span class="emphasis"><em>Development Guide</em></span> for JBoss EAP.
				</p></div></div></div></body></html>