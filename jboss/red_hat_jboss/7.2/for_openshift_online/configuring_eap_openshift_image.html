<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 3. Configuring the JBoss EAP for OpenShift Image for Your Java Application</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="configuring_eap_openshift_image"/>Chapter 3. Configuring the JBoss EAP for OpenShift Image for Your Java Application</h1></div></div></div><p>
			The JBoss EAP for OpenShift image is preconfigured for basic use with your Java applications. However, you can configure the JBoss EAP instance inside the image. The recommended method is to use the OpenShift S2I process, together with application template parameters and environment variables.
		</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
				Any configuration changes made on a running container will be lost when the container is restarted or terminated.
			</p><p>
				This includes any configuration changes made using scripts that are included with a traditional JBoss EAP installation, for example <code class="literal">add-user.sh</code> or the management CLI.
			</p><p>
				It is strongly recommended that you use the OpenShift S2I process, together with application template parameters and environment variables, to make any configuration changes to the JBoss EAP instance inside the JBoss EAP for OpenShift image.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="eap_s2i_process"/>How the JBoss EAP for OpenShift S2I Process Works</h1></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					The variable <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span></code> is used to denote the path to the JBoss EAP installation inside the JBoss EAP for OpenShift image.
				</p></div><p>
				The S2I process for JBoss EAP for OpenShift works as follows:
			</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p class="simpara">
						If a <code class="literal">pom.xml</code> file is present in the source code repository, a Maven build process is triggered that uses the contents of the <code class="literal">$MAVEN_ARGS</code> environment variable.
					</p><p class="simpara">
						Although you can specify custom Maven arguments or options with the <code class="literal">$MAVEN_ARGS</code> environment variable, Red Hat recommends that you use the <code class="literal">$MAVEN_ARGS_APPEND</code> environment variable to do this. The <code class="literal">$MAVEN_ARGS_APPEND</code> variable takes the default arguments from <code class="literal">$MAVEN_ARGS</code> and appends the options from <code class="literal">$MAVEN_ARGS_APPEND</code> to it.
					</p><p class="simpara">
						By default, the OpenShift profile uses the Maven <code class="literal">package</code> goal, which includes system properties for skipping tests (<code class="literal">-DskipTests</code>) and enabling the Red Hat GA repository (<code class="literal">-Dcom.redhat.xpaas.repo</code>).
					</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
							To use Maven behind a proxy on JBoss EAP for OpenShift image, set the <code class="literal">$HTTP_PROXY_HOST</code> and <code class="literal">$HTTP_PROXY_PORT</code> environment variables. Optionally, you can also set the <code class="literal">$HTTP_PROXY_USERNAME</code>, <code class="literal">HTTP_PROXY_PASSWORD</code>, and <code class="literal">HTTP_PROXY_NONPROXYHOSTS</code> variables.
						</p></div></li><li class="listitem">
						The results of a successful Maven build are copied to the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/deployments/</code> directory inside the JBoss EAP for OpenShift image. This includes all JAR, WAR, and EAR files from the source repository specified by the <code class="literal">$ARTIFACT_DIR</code> environment variable. The default value of <code class="literal">$ARTIFACT_DIR</code> is the Maven target directory.
					</li><li class="listitem">
						All files in the <code class="literal">configuration</code> source repository directory are copied to the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/standalone/configuration/</code> directory inside the JBoss EAP for OpenShift image. If you want to use a custom JBoss EAP configuration file, it should be named <code class="literal">standalone-openshift.xml</code>.
					</li><li class="listitem">
						All files in the <code class="literal">modules</code> source repository directory are copied to the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/modules/</code> directory inside the JBoss EAP for OpenShift image.
					</li></ol></div><p>
				See <a class="link" href="reference_information.html#eap-artifact-repository-mirrors-section" title="Artifact Repository Mirrors">Artifact Repository Mirrors</a> for additional guidance on how to instruct the S2I process to utilize the custom Maven artifacts repository mirror.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="configuring_eap_env_vars"/>Configuring JBoss EAP for OpenShift Using Environment Variables</h1></div></div></div><p>
				Using environment variables is the recommended method of configuring the JBoss EAP for OpenShift image. See the OpenShift documentation for instructions on <a class="link" href="https://docs.openshift.com/container-platform/latest/dev_guide/application_lifecycle/new_app.html#specifying-environment-variables">specifying environment variables</a> for application containers and build containers.
			</p><p>
				For example, you can set the JBoss EAP instance’s management username and password using environment variables when creating your OpenShift application:
			</p><pre class="screen">oc new-app --template=eap72-basic-s2i \
 -p IMAGE_STREAM_NAMESPACE=eap-demo \
 -p SOURCE_REPOSITORY_URL=https://github.com/jboss-developer/jboss-eap-quickstarts \
 -p SOURCE_REPOSITORY_REF=openshift \
 -p CONTEXT_DIR=kitchensink \
 -e ADMIN_USERNAME=myspecialuser \
 -e ADMIN_PASSWORD=myspecialp@ssw0rd</pre><p>
				Available environment variables for the JBoss EAP for OpenShift image are listed in <a class="link" href="reference_information.html" title="Chapter 5. Reference Information">Reference Information</a>.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Build-Extensions-Project-Artifacts"/>Build Extensions and Project Artifacts</h1></div></div></div><p>
				The JBoss EAP for OpenShift image extends database support in OpenShift using various artifacts. These artifacts are included in the built image through different mechanisms:
			</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
						<a class="link" href="configuring_eap_openshift_image.html#S2I-Artifacts" title="S2I Artifacts">S2I artifacts</a> that are injected into the image during the S2I process.
					</li><li class="listitem">
						<a class="link" href="configuring_eap_openshift_image.html#Runtime-Artifacts" title="Runtime Artifacts">Runtime artifacts</a> from environment files provided through the OpenShift Secret mechanism.
					</li></ul></div><div class="informalfigure"><div class="mediaobject"><img src="images/topics/images/JBoss_EAP-for-OpenShift_443016_0617_ECE-02.png" alt="Build Extensions Process"/></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="S2I-Artifacts"/>S2I Artifacts</h2></div></div></div><p>
					The S2I artifacts include modules, drivers, and additional generic deployments that provide the necessary configuration infrastructure required for the deployment. This configuration is built into the image during the S2I process so that only the datasources and associated resource adapters need to be configured at runtime.
				</p><p>
					See <a class="link" href="reference_information.html#eap-artifact-repository-mirrors-section" title="Artifact Repository Mirrors">Artifact Repository Mirrors</a> for additional guidance on how to instruct the S2I process to utilize the custom Maven artifacts repository mirror.
				</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="s2i_modules_drivers_deployments"/>Modules, Drivers, and Generic Deployments</h3></div></div></div><p>
						There are a few options for including these S2I artifacts in the JBoss EAP for OpenShift image:
					</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
								Include the artifact in the application source deployment directory. The artifact is downloaded during the build and injected into the image. This is similar to deploying an application on the JBoss EAP for OpenShift image.
							</li><li class="listitem"><p class="simpara">
								Include the <code class="literal">CUSTOM_INSTALL_DIRECTORIES</code> environment variable, a list of comma-separated list of directories used for installation and configuration of artifacts for the image during the S2I process. There are two methods for including this information in the S2I:
							</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p class="simpara">
										An <code class="literal">install.sh</code> script in the nominated installation directory. The install script executes during the S2I process and operates with impunity.
									</p><div class="title"><strong><code class="literal">install.sh</code> Script Example</strong></div><p>
											
</p><pre class="screen">#!/bin/bash

injected_dir=$1
source /usr/local/s2i/install-common.sh
install_deployments ${injected_dir}/injected-deployments.war
install_modules ${injected_dir}/modules
configure_drivers ${injected_dir}/drivers.env</pre><p>

										</p><p class="simpara">
										The <code class="literal">install.sh</code> script is responsible for customizing the base image using APIs provided by <code class="literal">install-common.sh</code>. <code class="literal">install-common.sh</code> contains functions that are used by the <code class="literal">install.sh</code> script to install and configure the modules, drivers, and generic deployments.
									</p><p class="simpara">
										Functions contained within <code class="literal">install-common.sh</code>:
									</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
												<code class="literal">install_modules</code>
											</li><li class="listitem">
												<code class="literal">configure_drivers</code>
											</li><li class="listitem"><p class="simpara">
												<code class="literal">install_deployments</code>
											</p><div class="title"><strong>Modules</strong></div><p>
													A module is a logical grouping of classes used for class loading and dependency management. Modules are defined in the <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/modules/</code> directory of the application server. Each module exists as a subdirectory, for example <code class="literal"><span class="emphasis"><em>EAP_HOME</em></span>/modules/org/apache/</code>. Each module directory then contains a slot subdirectory, which defaults to main and contains the <code class="literal">module.xml</code> configuration file and any required JAR files.
												</p><div class="title"><strong>Example <code class="literal">module.xml</code> File</strong></div><p>
													
</p><pre class="screen">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;module xmlns="urn:jboss:module:1.0" name="org.apache.derby"&gt;
    &lt;resources&gt;
        &lt;resource-root path="derby-10.12.1.1.jar"/&gt;
        &lt;resource-root path="derbyclient-10.12.1.1.jar"/&gt;
    &lt;/resources&gt;
    &lt;dependencies&gt;
        &lt;module name="javax.api"/&gt;
        &lt;module name="javax.transaction.api"/&gt;
    &lt;/dependencies&gt;
&lt;/module&gt;</pre><p>

												</p><p class="simpara">
												The <code class="literal">install_modules</code> function in <code class="literal">install.sh</code> copies the respective JAR files to the modules directory in JBoss EAP, along with the <code class="literal">module.xml</code>.
											</p><div class="title"><strong>Drivers</strong></div><p>
													Drivers are installed as modules. The driver is then configured in <code class="literal">install.sh</code> by the <code class="literal">configure_drivers</code> function, the configuration properties for which are defined in a <a class="link" href="configuring_eap_openshift_image.html#Runtime-Artifacts" title="Runtime Artifacts">runtime artifact</a> environment file.
												</p><div class="title"><strong>Example <code class="literal">drivers.env</code> File</strong></div><p>
													
</p><pre class="screen">#DRIVER
DRIVERS=DERBY
DERBY_DRIVER_NAME=derby
DERBY_DRIVER_MODULE=org.apache.derby
DERBY_DRIVER_CLASS=org.apache.derby.jdbc.EmbeddedDriver
DERBY_XA_DATASOURCE_CLASS=org.apache.derby.jdbc.EmbeddedXADataSource</pre><p>

												</p><div class="title"><strong>Generic Deployments</strong></div><p>
													Deployable archive files, such as JARs, WARs, RARs, or EARs, can be deployed from an injected image using the <code class="literal">install_deployments</code> function supplied by the API in <code class="literal">install-common.sh</code>.
												</p></li></ul></div></li><li class="listitem"><p class="simpara">
										If the <code class="literal">CUSTOM_INSTALL_DIRECTORIES</code> environment variable has been declared but no <code class="literal">install.sh</code> scripts are found in the custom installation directories, the following artifact directories will be copied to their respective destinations in the built image:
									</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
												<code class="literal">modules/*</code> copied to <code class="literal">$JBOSS_HOME/modules/system/layers/openshift</code>
											</li><li class="listitem">
												<code class="literal">configuration/*</code> copied to <code class="literal">$JBOSS_HOME/standalone/configuration</code>
											</li><li class="listitem">
												<code class="literal">deployments/*</code> copied to <code class="literal">$JBOSS_HOME/standalone/deployments</code>
											</li></ul></div><p class="simpara">
										This is a basic configuration approach compared to the <code class="literal">install.sh</code> alternative, and requires the artifacts to be structured appropriately.
									</p></li></ul></div></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Runtime-Artifacts"/>Runtime Artifacts</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="datasources"/>Datasources</h3></div></div></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
							Support for using the Red Hat-provided internal datasource drivers with the JBoss EAP for OpenShift image is now deprecated. It is recommended that you use JDBC drivers obtained from your database vendor for your JBoss EAP applications.
						</p><p>
							For more information on configuring JDBC drivers with JBoss EAP, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.2/html-single/configuration_guide/#jdbc_drivers">JDBC drivers</a> in the JBoss EAP <span class="emphasis"><em>Configuration Guide</em></span>.
						</p></div><p>
						There are three types of datasources:
					</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
								Default internal datasources. These are PostgreSQL, MySQL, and MongoDB. These datasources are available on OpenShift by default through the Red Hat Registry and do not require additional environment files to be configured. Set the <a class="link" href="reference_information.html#reference_datasources" title="Datasources">DB_SERVICE_PREFIX_MAPPING</a> environment variable to the name of the OpenShift service for the database to be discovered and used as a datasource.
							</li><li class="listitem">
								Other internal datasources. These are datasources not available by default through the Red Hat Registry but run on OpenShift. Configuration of these datasources is provided by environment files added to OpenShift Secrets.
							</li><li class="listitem">
								External datasources that are not run on OpenShift. Configuration of external datasources is provided by environment files added to OpenShift Secrets.
							</li></ol></div><div class="title"><strong>Example: Datasource Environment File</strong></div><p>
							
</p><pre class="screen"># derby datasource
ACCOUNTS_DERBY_DATABASE=accounts
ACCOUNTS_DERBY_JNDI=java:/accounts-ds
ACCOUNTS_DERBY_DRIVER=derby
ACCOUNTS_DERBY_USERNAME=derby
ACCOUNTS_DERBY_PASSWORD=derby
ACCOUNTS_DERBY_TX_ISOLATION=TRANSACTION_READ_UNCOMMITTED
ACCOUNTS_DERBY_JTA=true

# Connection info for xa datasource
ACCOUNTS_DERBY_XA_CONNECTION_PROPERTY_DatabaseName=/home/jboss/source/data/databases/derby/accounts

# _HOST and _PORT are required, but not used
ACCOUNTS_DERBY_SERVICE_HOST=dummy
ACCOUNTS_DERBY_SERVICE_PORT=1527</pre><p>

						</p><p>
						The <code class="literal">DATASOURCES</code> property is a comma-separated list of datasource property prefixes. These prefixes are then appended to all properties for that datasource. Multiple datasources can then be included in a single environment file. Alternatively, each datasource can be provided in separate environment files.
					</p><p>
						Datasources contain two types of properties: connection pool-specific properties and database driver-specific properties. Database driver-specific properties use the generic <code class="literal">XA_CONNECTION_PROPERTY</code>, because the driver itself is configured as a driver S2I artifact. The suffix of the driver property is specific to the particular driver for the datasource.
					</p><p>
						In the above example, <code class="literal">ACCOUNTS</code> is the datasource prefix, <code class="literal">XA_CONNECTION_PROPERTY</code> is the generic driver property, and <code class="literal">DatabaseName</code> is the property specific to the driver.
					</p><p>
						The datasources environment files are added to the OpenShift Secret for the project. These environment files are then called within the template using the <code class="literal">ENV_FILES</code> environment property, the value of which is a comma-separated list of fully qualified environment files as shown below.
					</p><pre class="screen">{
    “Name”: “ENV_FILES”,
    “Value”: “/etc/extensions/datasources1.env,/etc/extensions/datasources2.env”
}</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="resource_adapters"/>Resource Adapters</h3></div></div></div><p>
						Configuration of resource adapters is provided by environment files added to OpenShift Secrets.
					</p><div class="table"><a id="idm140035067009760"/><p class="title"><strong>Table 3.1. Resource Adapter Properties</strong></p><div class="table-contents"><table summary="Resource Adapter Properties" border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Attribute</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>PREFIX</em></span>_ID
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										The identifier of the resource adapter as specified in the server configuration file.
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>PREFIX</em></span>_ARCHIVE
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										The resource adapter archive.
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>PREFIX</em></span>_MODULE_SLOT
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										The slot subdirectory, which contains the <code class="literal">module.xml</code> configuration file and any required JAR files.
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>PREFIX</em></span>_MODULE_ID
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										The JBoss Module ID where the object factory Java class can be loaded from.
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>PREFIX</em></span>_CONNECTION_CLASS
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										The fully qualified class name of a managed connection factory or admin object.
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>PREFIX</em></span>_CONNECTION_JNDI
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										The JNDI name for the connection factory.
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>PREFIX</em></span>_PROPERTY_ParentDirectory
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										Directory where the data files are stored.
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>PREFIX</em></span>_PROPERTY_AllowParentPaths
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										Set <code class="literal">AllowParentPaths</code> to <code class="literal">false</code> to disallow <code class="literal">..</code> in paths. This prevents requesting files that are not contained in the parent directory.
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>PREFIX</em></span>_POOL_MAX_SIZE
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										The maximum number of connections for a pool. No more connections will be created in each sub-pool.
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>PREFIX</em></span>_POOL_MIN_SIZE
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										The minimum number of connections for a pool.
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>PREFIX</em></span>_POOL_PREFILL
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										Specifies if the pool should be prefilled. Changing this value requires a server restart.
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>PREFIX</em></span>_POOL_FLUSH_STRATEGY
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										How the pool should be flushed in case of an error. Valid values are: <code class="literal">FailingConnectionOnly</code> (default), <code class="literal">IdleConnections</code>, and <code class="literal">EntirePool</code>.
									</p>
									 </td></tr></tbody></table></div></div><p>
						The <code class="literal">RESOURCE_ADAPTERS</code> property is a comma-separated list of resource adapter property prefixes. These prefixes are then appended to all properties for that resource adapter. Multiple resource adapter can then be included in a single environment file. In the example below, <code class="literal">MYRA</code> is used as the prefix for a resource adapter. Alternatively, each resource adapter can be provided in separate environment files.
					</p><div class="title"><strong>Example: Resource Adapter Environment File</strong></div><p>
							
</p><pre class="screen">#RESOURCE_ADAPTER
RESOURCE_ADAPTERS=MYRA
MYRA_ID=myra
MYRA_ARCHIVE=myra.rar
MYRA_CONNECTION_CLASS=org.javaee7.jca.connector.simple.connector.outbound.MyManagedConnectionFactory
MYRA_CONNECTION_JNDI=java:/eis/MySimpleMFC</pre><p>

						</p><p>
						The resource adapter environment files are added to the OpenShift Secret for the project namespace. These environment files are then called within the template using the <code class="literal">ENV_FILES</code> environment property, the value of which is a comma-separated list of fully qualified environment files as shown below.
					</p><pre class="screen">{
    "Name": "ENV_FILES",
    "Value": "/etc/extensions/resourceadapter1.env,/etc/extensions/resourceadapter2.env"
}</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="deployment_considerations_for_eap_openshift_image"/>Deployment Considerations for the JBoss EAP for OpenShift Image</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deployment_considerations_eap_for_openshift_image_scaling_up"/>Scaling Up and Persistent Storage Partitioning</h2></div></div></div><p>
					There are two methods for deploying JBoss EAP with persistent storage: single-node partitioning, and multi-node partitioning.
				</p><p>
					Single-node partitioning stores the JBoss EAP data store directory, including transaction data, in the storage volume.
				</p><p>
					<a id="multi_node"/>Multi-node partitioning creates additional, independent <code class="literal">split-<span class="emphasis"><em>n</em></span></code> directories to store the transaction data for each JBoss EAP pod, where <code class="literal"><span class="emphasis"><em>n</em></span></code> is an incremental integer. This communication is not altered if a JBoss EAP pod is updated, goes down unexpectedly, or is redeployed. When the JBoss EAP pod is operational again, it reconnects to the associated split directory and continues as before. If a new JBoss EAP pod is added, a corresponding <code class="literal">split-<span class="emphasis"><em>n</em></span></code> directory is created for that pod.
				</p><p>
					To enable the multi-node configuration you must set the <code class="literal">SPLIT_DATA</code> parameter to <code class="literal">true</code>. This results in the server creating independent <code class="literal">split-<span class="emphasis"><em>n</em></span></code> directories for each instance within the persistent volume which are used as their data store.
				</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
						Due to the different storage methods of single-node and multi-node partitioning, changing a deployment from single-node to multi-node results in the application losing all data previously stored in the data directory, including messages, transaction logs, and so on. This is also true if changing a deployment from multi-node to single-node, as the storage paths will not match.
					</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deployment_considerations_eap_for_openshift_image_scaling_down"/>Scaling Down and Transaction Recovery</h2></div></div></div><p>
					When the JBoss EAP for OpenShift image is deployed using a <a class="link" href="configuring_eap_openshift_image.html#multi_node">multi-node</a> configuration, it is possible for unexpectedly terminated transactions to be left in the data directory of a terminating pod if the cluster is scaled down.
				</p><p>
					See <a class="link" href="reference_information.html#manual_transaction_recovery" title="Manual Transaction Recovery Process">manual transaction recovery</a> to complete these branches.
				</p></div></div></div></body></html>