<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 9. Security Mapping Modules</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="security_mapping_modules"/>Chapter 9. Security Mapping Modules</h1></div></div></div><p>
			The following security mapping modules are provided in JBoss EAP 6.
		</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Class</th><th style="text-align: left" valign="top">Code</th><th style="text-align: left" valign="top">Type</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.role.PropertiesRolesMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							PropertiesRoles
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							role
						</p>
						 </td></tr><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.role.SimpleRolesMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							SimpleRoles
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							role
						</p>
						 </td></tr><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.DeploymentRolesMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							DeploymentRoles
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							role
						</p>
						 </td></tr><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.role.DatabaseRolesMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							DatabaseRoles
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							role
						</p>
						 </td></tr><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.role.LdapRolesMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							LdapRoles
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							role
						</p>
						 </td></tr><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.attribute.LdapAttributeMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							LdapAttributes
						</p>
						 </td><td style="text-align: left" valign="top"> <p>
							attribute
						</p>
						 </td></tr><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.DeploymentRoleToRolesMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
							role
						</p>
						 </td></tr><tr><td style="text-align: left" valign="top"> <p>
							org.jboss.security.mapping.providers.attribute.DefaultAttributeMappingProvider
						</p>
						 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
							attribute
						</p>
						 </td></tr></tbody></table></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="propertiesrolesmappingprovider"/>PropertiesRolesMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Code</strong></span>: PropertiesRoles
			</p><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.role.PropertiesRolesMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: role
			</p><p>
				A MappingProvider that reads roles from a properties file in the following format: <span class="emphasis"><em>username=role1,role2,…​</em></span>
			</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								rolesProperties
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Properties formatted file name. Expansion of JBoss EAP 6 variables can be used in form of <span class="emphasis"><em>${jboss.variable}</em></span>.
							</p>
							 </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="simplerolesmappingprovider"/>SimpleRolesMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Code</strong></span>: SimpleRoles
			</p><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.role.SimpleRolesMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: role
			</p><p>
				A simple MappingProvider that reads roles from the options map. The option attribute name is the name of principal to assign roles to and the attribute value is the comma separated role names to assign to the principal. ⁠
			</p><div class="title"><strong>Example</strong></div><p>
					
</p><pre class="programlisting">&lt;module-option name="JavaDuke" value="JBossAdmin,Admin"/&gt;
&lt;module-option name="joe" value="Users"/&gt;</pre><p>

				</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="deploymentrolesmappingprovider"/>DeploymentRolesMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Code</strong></span>: DeploymentRoles
			</p><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.DeploymentRolesMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: role
			</p><p>
				A Role Mapping Module that takes into consideration a principal to roles mapping that can be done in <code class="literal">jboss-web.xml</code> and <code class="literal">jboss-app.xml</code> deployment descriptors.
			</p><div class="title"><strong>Example</strong></div><p>
					
</p><pre class="programlisting">&lt;jboss-web&gt;
...
​  &lt;security-role&gt;
​      &lt;role-name&gt;Support&lt;/role-name&gt;
​      &lt;principal-name&gt;Mark&lt;/principal-name&gt;
​      &lt;principal-name&gt;Tom&lt;/principal-name&gt;
​  &lt;/security-role&gt;
...
&lt;/jboss-web&gt;</pre><p>

				</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="databaserolesmappingprovider"/>DatabaseRolesMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Code</strong></span>: DatabaseRoles
			</p><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.role.DatabaseRolesMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: role
			</p><p>
				A MappingProvider that reads roles from a database.
			</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								dsJndiName
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								JNDI name of data source used to map roles to the user.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								rolesQuery
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								This option should be a prepared statement equivalent to <code class="literal">select RoleName from Roles where User=?</code>. <span class="emphasis"><em>?</em></span> is substituted with current principal name.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								suspendResume
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								boolean
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								If <span class="emphasis"><em>true</em></span>, will suspend and later resume transaction associated with current thread while performing search for roles.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								transactionManagerJndiName
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								JNDI name of Transaction mamager (default is <span class="emphasis"><em>java:/TransactionManager</em></span>)
							</p>
							 </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ldaprolesmappingprovider"/>LdapRolesMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Code</strong></span>: LdapRoles
			</p><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.role.LdapRolesMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: role
			</p><p>
				A mapping provider that assigns roles to an user using a LDAP server to search for the roles.
			</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								bindDN
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The DN used to bind against the LDAP server for the user and roles queries. This DN needs read and search permissions on the <span class="emphasis"><em>baseCtxDN</em></span> and <span class="emphasis"><em>rolesCtxDN</em></span> values.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								bindCredential
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The password for the <span class="emphasis"><em>bindDN</em></span>. This can be encrypted via the vault mechanism.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								rolesCtxDN
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The fixed DN of the context to search for user roles. This is not the DN where the actual roles are, but the DN where the objects containing the user roles are. For example, in a Microsoft Active Directory server, this is the DN where the user account is.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								roleAttributeID
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The LDAP attribute which contains the names of authorization roles.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								roleAttributeIsDN
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								boolean
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Whether or not the <span class="emphasis"><em>roleAttributeID</em></span> contains the fully-qualified DN of a role object. If <span class="emphasis"><em>false</em></span>, the role name is taken from the value of the <span class="emphasis"><em>roleNameAttributeId</em></span> attribute of the context name. Certain directory schemas, such as Microsoft Active Directory, require this attribute to be set to <span class="emphasis"><em>true</em></span>.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								roleNameAttributeID
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Name of the attribute within the <span class="emphasis"><em>roleCtxDN</em></span> context which contains the role name. If the <span class="emphasis"><em>roleAttributeIsDN</em></span> property is set to <span class="emphasis"><em>true</em></span>, this property is used to find the role object’s name attribute.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								parseRoleNameFromDN
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								boolean
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A flag indicating if the DN returned by a query contains the <span class="emphasis"><em>roleNameAttributeID</em></span>. If set to <span class="emphasis"><em>true</em></span>, the DN is checked for the <span class="emphasis"><em>roleNameATtributeID</em></span>. If set to <span class="emphasis"><em>false</em></span>, the DN is not checked for the <span class="emphasis"><em>roleNameAttributeID</em></span>. This flag can improve the performance of LDAP queries.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								roleFilter
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A search filter used to locate the roles associated with the authenticated user. The input <span class="emphasis"><em>username</em></span> or <span class="emphasis"><em>userDN</em></span> obtained from the login module callback is substituted into the filter anywhere a <span class="emphasis"><em>{0}</em></span> expression is used. The authenticated <span class="emphasis"><em>userDN</em></span> is substituted into the filter anywhere a <span class="emphasis"><em>{1}</em></span> is used. An example search filter that matches on the input <span class="emphasis"><em>username</em></span> is <span class="emphasis"><em>(member={0})</em></span>. An alternative that matches on the authenticated <span class="emphasis"><em>userDN</em></span> is <span class="emphasis"><em>(member={1})</em></span>.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								roleRecursion
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								number
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The numbers of levels of recursion the role search will go below a matching context. Disable recursion by setting this to 0.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								searchTimeLimit
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								number
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The timeout in milliseconds for the user/role searches. The default value is 10000.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								searchScope
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The search scope to use.
							</p>
							 </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ldapattributemappingprovider"/>LdapAttributeMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Code</strong></span>: LdapAttributes
			</p><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.attribute.LdapAttributeMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: attribute
			</p><p>
				Maps attributes from LDAP to the subject. The options include whatever options your LDAP JNDI provider supports. ⁠
			</p><div class="title"><strong>Examples of Standard Property Names</strong></div><p>
					
</p><pre class="programlisting">Context.INITIAL_CONTEXT_FACTORY = "java.naming.factory.initial"
Context.SECURITY_PROTOCOL = "java.naming.security.protocol"
Context.PROVIDER_URL = "java.naming.provider.url"
Context.SECURITY_AUTHENTICATION = "java.naming.security.authentication"</pre><p>

				</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								bindDN
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The DN used to bind against the LDAP server for the user and roles queries. This DN needs read and search permissions on the <span class="emphasis"><em>baseCtxDN</em></span> and <span class="emphasis"><em>rolesCtxDN</em></span> values.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								bindCredential
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The password for the bindDN. This can be encrypted if the <span class="emphasis"><em>jaasSecurityDomain</em></span> is specified.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								baseCtxDN
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The fixed DN of the context to start the user search from.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								baseFilter
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A search filter used to locate the context of the user to authenticate. The input <span class="emphasis"><em>username</em></span> or <span class="emphasis"><em>userDN</em></span> as obtained from the login module callback is substituted into the filter anywhere a <span class="emphasis"><em>{0}</em></span> expression is used. This substitution behavior comes from the standard <code class="literal"><span class="emphasis"><em>DirContext.search(Name, String, Object[], SearchControls cons)</em></span></code> method. An common example search filter is <span class="emphasis"><em>(uid={0})</em></span>.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								searchTimeLimit
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								number
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The timeout in milliseconds for the user/role searches. The default value is 10000.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								attributeList
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A comma-separated list of attributes for the user. For example, <span class="emphasis"><em>mail,cn,sn,employeeType,employeeNumber</em></span>.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								jaasSecurityDomain
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The <span class="emphasis"><em>JaasSecurityDomain</em></span> to use to decrypt the <span class="emphasis"><em>java.naming.security.credentials</em></span>. The encrypted form of the password is that returned by the <span class="emphasis"><em>JaasSecurityDomain#encrypt64(byte[])</em></span> method. The <span class="emphasis"><em>org.jboss.security.plugins.PBEUtils</em></span> can also be used to generate the encrypted form.
							</p>
							 </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="deploymentroletorolesmappingprovider"/>DeploymentRoleToRolesMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.DeploymentRoleToRolesMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: role
			</p><p>
				A Role to Roles Mapping Module that takes into consideration a principal to roles mapping that can be done in the deployment descriptors <code class="literal">jboss-web.xml</code> and <code class="literal">jboss-app.xml</code>. In this case <span class="emphasis"><em>principal-name</em></span> denotes role to map other roles. ⁠
			</p><div class="title"><strong>Example</strong></div><p>
					
</p><pre class="programlisting">&lt;jboss-web&gt;
...
​    &lt;security-role&gt;
​      &lt;role-name&gt;Employee&lt;/role-name&gt;
​      &lt;principal-name&gt;Support&lt;/principal-name&gt;
​      &lt;principal-name&gt;Sales&lt;/principal-name&gt;
    &lt;/security-role&gt;
...
&lt;/jboss-web&gt;</pre><p>

				</p><p>
				In the above example, each principal having the role <span class="emphasis"><em>Support</em></span> or <span class="emphasis"><em>Sales</em></span> will also have role <span class="emphasis"><em>Employee</em></span> assigned.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					This mapping provider does not have a code associated with it so the full class name must be in the <span class="emphasis"><em>code</em></span> field when configuring.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="defaultattributemappingprovider"/>DefaultAttributeMappingProvider</h1></div></div></div><p>
				<span class="strong"><strong>Class</strong></span>: org.jboss.security.mapping.providers.attribute.DefaultAttributeMappingProvider
			</p><p>
				<span class="strong"><strong>Type</strong></span>: attribute
			</p><p>
				Checks module and locates principal name from mapping context to create attribute e-mail address from module option named <span class="emphasis"><em>principalName</em></span> + <span class="emphasis"><em>.email</em></span> and maps it to the given principal.
			</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								principalName
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Principal name used to create the attribute e-mail address.
							</p>
							 </td></tr></tbody></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					This mapping provider does not have a code associated with it so the full class name must be in the <span class="emphasis"><em>code</em></span> field when configuring.
				</p></div></div></div></body></html>