<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 2. Abstract Login Modules</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="abstract_login_modules"/>Chapter 2. Abstract Login Modules</h1></div></div></div><p>
			The abstract login modules are abstract Java classes that are extended by the other login modules in order to provide common functionality and configuration options. The abstract login modules may never be used directly, but the configuration options are available to any login modules that extend them.
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="abstractserverloginmodule"/>AbstractServerLoginModule</h1></div></div></div><p>
				<span class="strong"><strong>Short name</strong></span>: AbstractServerLoginModule
			</p><p>
				<span class="strong"><strong>Full name</strong></span>: org.jboss.security.auth.spi.AbstractServerLoginModule
			</p><p>
				The AbstractServerLoginModule serves as a base class for many login modules as well as several abstract login modules. It implements the common functionality required for a JAAS server side LoginModule and implements the PicketBox standard Subject usage pattern of storing identities and roles.
			</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/><col class="col_4"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Default</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								principalClass
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A fully-qualified classname
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								org.jboss.security.SimplePrincipal
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A Principal implementation class which contains a constructor that takes String argument for the principal name.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								module
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								none
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A reference to a jboss-module that can be used to load a custom callback/validator.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								unauthenticatedIdentity
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								none
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								This defines the principal name that should be assigned to requests that contain no authentication information. This can allow unprotected servlets to invoke methods on EJBs that do not require a specific role. Such a principal has no associated roles and can only access unsecured EJBs or EJB methods that are associated with the unchecked permission constraint. See the <a class="link" href="abstract_login_modules.html#unauthenticated_identity" title="Unauthenticated Identity">Unauthenticated Identity</a> section for more details.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								password-stacking
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								useFirstPass or false
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								false
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								See the <a class="link" href="abstract_login_modules.html#password_stacking" title="Password Stacking">Password Stacking</a> section for more details.
							</p>
							 </td></tr></tbody></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="unauthenticated_identity"/>Unauthenticated Identity</h2></div></div></div><p>
					Not all requests are received in an authenticated format. <span class="emphasis"><em>unauthenticatedIdentity</em></span> is a login module configuration option that assigns a specific identity (<span class="emphasis"><em>guest</em></span>, for example) to requests that are made with no associated authentication information. This can be used to allow unprotected servlets to invoke methods on EJBs that do not require a specific role. Such a principal has no associated roles and so can only access either unsecured EJBs or EJB methods that are associated with the unchecked permission constraint. For example, this configuration option can be used in the <a class="link" href="login_modules_without_external_identity_store.html#usersroles_login_module" title="UsersRoles Login Module">UsersRoles</a> and <a class="link" href="login_modules_for_ejbs_and_remoting.html#remoting_login_module" title="Remoting Login Module">Remoting</a> Login Modules
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="password_stacking"/>Password Stacking</h2></div></div></div><p>
					Multiple login modules can be chained together in a stack, with each login module providing both the credentials verification and role assignment during authentication. This works for many use cases, but sometimes credentials verification and role assignment are split across multiple user management stores.
				</p><p>
					Consider the case where users are managed in a central LDAP server but application-specific roles are stored in the application’s relational database. The password-stacking module option captures this relationship.
				</p><p>
					To use password stacking, each login module should set the <span class="emphasis"><em>password-stacking</em></span> attribute to <span class="emphasis"><em>useFirstPass</em></span>, which is located in the <span class="emphasis"><em>&lt;module-option&gt;</em></span> section. If a previous module configured for password stacking has authenticated the user, all the other stacking modules will consider the user authenticated and only attempt to provide a set of roles for the authorization step.
				</p><p>
					When password-stacking option is set to <span class="emphasis"><em>useFirstPass</em></span>, this module first looks for a shared user name and password under the property names <span class="emphasis"><em>javax.security.auth.login.name</em></span> and <span class="emphasis"><em>javax.security.auth.login.password</em></span> respectively in the login module shared state map.
				</p><p>
					If found, these properties are used as the principal name and password. If not found, the principal name and password are set by this login module and stored under the property names <span class="emphasis"><em>javax.security.auth.login.name</em></span> and <span class="emphasis"><em>javax.security.auth.login.password</em></span> respectively.
				</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						When using password stacking, set all modules to be required. This ensures that all modules are considered, and have the chance to contribute roles to the authorization process.
					</p></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="usernamepasswordloginmodule"/>UsernamePasswordLoginModule</h1></div></div></div><p>
				<span class="strong"><strong>Short name</strong></span>: UsernamePasswordLoginModule
			</p><p>
				<span class="strong"><strong>Full name</strong></span>: org.jboss.security.auth.spi.UsernamePasswordLoginModule
			</p><p>
				<span class="strong"><strong>Parent</strong></span>: <a class="link" href="abstract_login_modules.html#abstractserverloginmodule" title="AbstractServerLoginModule">AbstractServerLoginModule</a>
			</p><p>
				The UsernamePasswordLoginModule is an abstract login module that imposes an <span class="strong"><strong>identity == String username</strong></span>, <span class="strong"><strong>credentials == String password</strong></span> view on the login process. It inherits all the fields from AbstractServerLoginModule in addition to the below fields.
			</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/><col class="col_4"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Default</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								ignorePasswordCase
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								boolean
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								false
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A flag indicating if the password comparison should ignore case.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								digestCallback
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A fully-qualified classname
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								none
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The class name of the org.jboss.crypto.digest.DigestCallback implementation that includes pre/post digest content like salts for hashing the input password. Only used if hashAlgorithm has been specified and hashUserPassword is set to true.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								storeDigestCallback
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A fully-qualified classname
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								none
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The class name of the org.jboss.crypto.digest.DigestCallback implementation that includes pre/post digest content like salts for hashing the store/expected password. Only used if hashStorePassword is true and hashAlgorithm has been specified.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								throwValidateError
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								boolean
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								false
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A flag that indicates whether validation errors should be exposed to clients or not.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								inputValidator
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A fully-qualified classname
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								none
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The instance of the <span class="emphasis"><em>org.jboss.security.auth.spi.InputValidator</em></span> implementation used to validate the username and password supplied by the client.
							</p>
							 </td></tr></tbody></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					The UsernamePassword Login Module options, regarding password hashing, are described in the next section.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="password_hashing"/>Password Hashing</h2></div></div></div><p>
					Most login modules must compare a client-supplied password to a password stored in a user management system. These modules generally work with plain text passwords, but can be configured to support hashed passwords to prevent plain text passwords from being stored on the server side. JBoss EAP 6 supports the ability to configure the hashing algorithm, encoding, and character set as well as when the user password and store password are hashed.
				</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
						Red Hat JBoss Enterprise Application Platform Common Criteria certified release only supports SHA-256 for password hashing.
					</p></div><p>
					The following are password hashing options that can be configured as part of a login module that has UsernamePasswordLoginModule as a parent:
				</p><div class="informaltable"><table border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/><col class="col_4"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Default</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									hashAlgorithm
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									String representing a password hashing algorithm.
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									none
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Name of the java.security.MessageDigest algorithm to use to hash the password. There is no default so this option must be specified to enable hashing. Typical values are SHA-256, SHA-1 and MD5. When hashAlgorithm is specified and <span class="emphasis"><em>hashUserPassword</em></span> is set to <span class="emphasis"><em>true</em></span>, the clear text password obtained from the CallbackHandler is hashed before it is passed to UsernamePasswordLoginModule.validatePassword as the inputPassword argument.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									hashEncoding
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									String
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									base64
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									The String format for the hashed password, if hashAlgorithm is also set. May specify one of three encoding types: base64, hex or rfc2617.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									hashCharset
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									String
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									The default encoding set in the container’s runtime environment
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									The name of the charset/encoding to use when converting the password String to a byte array.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									hashUserPassword
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									boolean
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									true
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									A flag indicating if the user entered password should be hashed. The hashed user password is compared against the value in the login module, which is expected to be a hash of the password.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									hashStorePassword
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									boolean
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									false
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									A flag indicating if the store password returned should be hashed. This is used for digest authentication, where the user submits a hash of the user password along with a request-specific tokens from the server to be compare. The hash algorithm (for digest, this would be rfc2617) is utilized to compute a server-side hash, which should match the hashed value sent from the client.
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									passwordIsA1Hash
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									boolean
								</p>
								 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
									A flag used by the <span class="emphasis"><em>org.jboss.security.auth.callback.RFC2617Digest</em></span> when it is configured as the digestCallback or storeDigestCallback. If true, incoming password will not be hashed since it is already hashed.
								</p>
								 </td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="abstractpasswordcredentialloginmodule"/>AbstractPasswordCredentialLoginModule</h1></div></div></div><p>
				<span class="strong"><strong>Short name</strong></span>: AbstractPasswordCredentialLoginModule
			</p><p>
				<span class="strong"><strong>Full name</strong></span>: org.picketbox.datasource.security.AbstractPasswordCredentialLoginModule
			</p><p>
				<span class="strong"><strong>Parent</strong></span>: <a class="link" href="abstract_login_modules.html#abstractserverloginmodule" title="AbstractServerLoginModule">AbstractServerLoginModule</a>
			</p><p>
				AbstractPasswordCredentialLoginModule is a base login module that handles PasswordCredentials.
			</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="commonloginmodule"/>CommonLoginModule</h1></div></div></div><p>
				<span class="strong"><strong>Short name</strong></span>: CommonLoginModule
			</p><p>
				<span class="strong"><strong>Full name</strong></span>: org.jboss.security.negotiation.common.CommonLoginModule
			</p><p>
				<span class="strong"><strong>Parent</strong></span>: <a class="link" href="abstract_login_modules.html#abstractserverloginmodule" title="AbstractServerLoginModule">AbstractServerLoginModule</a>
			</p><p>
				CommonLoginModule is an abstract login module that serves as a base login module for some login modules within JBoss Negotiation.
			</p></div></div></body></html>