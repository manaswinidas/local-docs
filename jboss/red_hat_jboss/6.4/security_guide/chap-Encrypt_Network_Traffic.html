<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 4. Encrypt Network Traffic</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="chap-Encrypt_Network_Traffic">
      ⁠</a>Chapter 4. Encrypt Network Traffic</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Specify_Which_Network_Interface_the_Enterprise_Application_Platform_Uses">
      ⁠</a>4.1. Specify Which Network Interface JBoss EAP 6 Uses</h1></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Overview</div>
			Isolating services so that they are accessible only to the clients who need them increases the security of your network. JBoss EAP 6 includes two interfaces in its default configuration, both of which bind to the IP address <code class="literal">127.0.0.1</code>, or <code class="literal">localhost</code>, by default. One of the interfaces is called <code class="literal">management</code>, and is used by the Management Console, CLI, and API. The other is called <code class="literal">public</code>, and is used to deploy applications. These interfaces are not special or significant, but are provided as a starting point.
		</div><div class="para">
		The <code class="literal">management</code> interface uses ports <code class="literal">9990</code> and <code class="literal">9999</code> by default, and the <code class="literal">public</code> interface uses port <code class="literal">8080</code>, or port <code class="literal">8443</code> if you use HTTPS.
	</div><div class="para">
		You can change the IP address of the management interface, public interface, or both.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="warning"><div class="admonition_header"><p><strong>Be cautious when exposing the management interfaces.</strong></p></div><div class="admonition"><div class="para">
			If you expose the management interfaces to other network interfaces which are accessible from remote hosts, be aware of the security implications. Most of the time, it is not advisable to provide remote access to the management interfaces.
		</div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Stop JBoss EAP 6.</strong></p><div class="para">
				Stop JBoss EAP 6 by sending an interrupt in the appropriate way for your operating system. If you are running JBoss EAP 6 as a foreground application, the typical way to do this is to press <span class="keycap"><strong>Ctrl+C</strong></span>.
			</div></li><li class="step"><p class="title"><strong>Restart JBoss EAP 6, specifying the bind address.</strong></p><div class="para">
				Use the <code class="command">-b</code> command-line switch to start JBoss EAP 6 on a specific interface.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					In the following examples, the IP address used 10.1.1.1 must be available to you. To know the IP address, use the <code class="command">ifconfig</code> command.
				</div></div></div><div class="example"><a id="idm139772497394896">
      ⁠</a><p class="title"><strong>Example 4.1. Specify the public interface.</strong></p><div class="example-contents"><pre class="screen">
<em class="replaceable">EAP_HOME</em>/bin/domain.sh -b 10.1.1.1</pre></div></div><div class="example"><a id="idm139772562885136">
      ⁠</a><p class="title"><strong>Example 4.2. Specify the management interface.</strong></p><div class="example-contents"><pre class="screen">
<em class="replaceable">EAP_HOME</em>/bin/domain.sh -bmanagement=10.1.1.1</pre></div></div><div class="example"><a id="idm139772564056064">
      ⁠</a><p class="title"><strong>Example 4.3. Specify different addresses for each interface.</strong></p><div class="example-contents"><pre class="screen">
<em class="replaceable">EAP_HOME</em>/bin/domain.sh -bmanagement=127.0.0.1 -b 10.1.1.1</pre></div></div><div class="example"><a id="idm139772536947824">
      ⁠</a><p class="title"><strong>Example 4.4. Bind the public interface to all network interfaces.</strong></p><div class="example-contents"><pre class="screen">
<em class="replaceable">EAP_HOME</em>/bin/domain.sh -b 0.0.0.0</pre></div></div></li></ol></div><div class="para">
		It is possible to edit your XML configuration file directly, to change the default bind addresses. However, if you do this, you will no longer be able to use the <code class="command">-b</code> command-line switch to specify an IP address at runtime, so this is not recommended. If you do decide to do this, be sure to stop JBoss EAP 6 completely before editing the XML file.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22930%2C+Security+Guide-6.4-1%0ABuild+Date%3A+15-04-2015+13%3A57%3A35%0ATopic+ID%3A+4704-741438+%5BLatest%5D&amp;comment=Title%3A+Specify+Which+Network+Interface+JBoss+EAP+6+Uses%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4704-741438+05+Feb+2015+03%3A25+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Configure_Network_Firewalls_to_Work_with_JBoss_Enterprise_Application_Platform_6">
      ⁠</a>4.2. Configure Network Firewalls to Work with JBoss EAP 6</h1></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			Most production environments use firewalls as part of an overall network security strategy. If you need multiple server instances to communicate with each other or with external services such as web servers or databases, your firewall must take this into account. A well-managed firewall only opens the ports which are necessary for operation, and limits access to the ports to specific IP addresses, subnets, and network protocols.
		</div><div class="para">
		A full discussion of firewalls is out of the scope of this documentation.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				Determine the ports you need to open.
			</div></li><li class="listitem"><div class="para">
				An understanding of your firewall software is required. This procedure uses the <code class="command">system-config-firewall</code> command in Red Hat Enterprise Linux 6. Microsoft Windows Server includes a built-in firewall, and several third-party firewall solutions are available for each platform. On Microsoft Windows Server, you can use PowerShell to configure the firewall.
			</div></li></ul></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Assumptions</div>
			This procedure configures a firewall in an environment with the following assumptions:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				The operating system is Red Hat Enterprise Linux 6.
			</div></li><li class="listitem"><div class="para">
				JBoss EAP 6 runs on host <code class="literal">10.1.1.2</code>. Optionally, the server has its own firewall.
			</div></li><li class="listitem"><div class="para">
				The network firewall server runs on host <code class="literal">10.1.1.1</code> on interface <code class="literal">eth0</code>, and has an external interface <code class="literal">eth1</code>.
			</div></li><li class="listitem"><div class="para">
				You want traffic on port <code class="literal">5445</code> (a port used by JMS) forwarded to JBoss EAP 6. No other traffic should be allowed through the network firewall.
			</div></li></ul></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139772486958832">
      ⁠</a><p class="title"><strong>Procedure 4.1. Manage Network Firewalls and JBoss EAP 6 to work together</strong></p><ol class="1"><li class="step"><p class="title"><strong>Log into the Management Console.</strong></p><div class="para">
				Log into the Management Console. By default, it runs on <a href="http://localhost:9990/console/">http://localhost:9990/console/</a>.
			</div></li><li class="step"><p class="title"><strong>Determine the socket bindings used by the socket binding group.</strong></p><ol class="substeps a"><li class="step"><div class="para">
						Click the <span class="guilabel"><strong>Configuration</strong></span> label at the top of the Management Console.
					</div></li><li class="step"><div class="para">
						Expand the <span class="guilabel"><strong>General Configuration</strong></span> menu. Select the <span class="guilabel"><strong>Socket Binding</strong></span>.
					</div></li><li class="step"><div class="para">
						The <span class="guilabel"><strong>Socket Binding Declarations</strong></span> screen appears. Initially, the <code class="literal">standard-sockets</code> group is shown. Choose a different group by selecting it from the combo box on the right-hand side.
					</div></li></ol><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					If you use a standalone server, it has only one socket binding group.
				</div></div></div><div class="para">
				The list of socket names and ports is shown, eight values per page. You can go through the pages by using the arrow navigation below the table.
			</div></li><li class="step"><p class="title"><strong>Determine the ports you need to open.</strong></p><div class="para">
				Depending on the function of the particular port and the requirements of your environment, some ports may need to be opened on your firewall.
			</div></li><li class="step"><p class="title"><strong>Configure your firewall to forward traffic to JBoss EAP 6.</strong></p><div class="para">
				Perform these steps to configure your network firewall to allow traffic on the desired port.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Log into your firewall machine and access a command prompt, as the root user.
					</div></li><li class="step"><div class="para">
						Issue the command <code class="command">system-config-firewall</code> to launch the firewall configuration utility. A GUI or command-line utility launches, depending on the way you are logged into the firewall system. This task makes the assumption that you are logged in via SSH and using the command-line interface.
					</div></li><li class="step"><div class="para">
						Use the <span class="keycap"><strong>TAB</strong></span> key on your keyboard to navigate to the <span class="guibutton"><strong>Customize</strong></span> button, and press the <span class="keycap"><strong>ENTER</strong></span> key. The <span class="guilabel"><strong>Trusted Services</strong></span> screen appears.
					</div></li><li class="step"><div class="para">
						Do not change any values, but use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guibutton"><strong>Forward</strong></span> button, and press <span class="keycap"><strong>ENTER</strong></span> to advanced to the next screen. The <span class="guilabel"><strong>Other Ports</strong></span> screen appears.
					</div></li><li class="step"><div class="para">
						Use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guilabel"><strong>&lt;Add&gt;</strong></span> button, and press <span class="keycap"><strong>ENTER</strong></span>. The <span class="guilabel"><strong>Port and Protocol</strong></span> screen appears.
					</div></li><li class="step"><div class="para">
						Enter <code class="literal">5445</code> in the <span class="guilabel"><strong>Port / Port Range</strong></span> field, then use the <span class="keycap"><strong>TAB</strong></span> key to move to the <span class="guilabel"><strong>Protocol</strong></span> field, and enter <code class="literal">tcp</code>. Use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guibutton"><strong>OK</strong></span> button, and press <span class="keycap"><strong>ENTER</strong></span>.
					</div></li><li class="step"><div class="para">
						Use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guibutton"><strong>Forward</strong></span> button until you reach the <span class="guilabel"><strong>Port Forwarding</strong></span> screen.
					</div></li><li class="step"><div class="para">
						Use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guilabel"><strong>&lt;Add&gt;</strong></span> button, and press the <span class="keycap"><strong>ENTER</strong></span> key.
					</div></li><li class="step"><div class="para">
						Fill in the following values to set up port forwarding for port <code class="literal">5445</code>.
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								Source interface: <code class="literal">eth1</code>
							</div></li><li class="listitem"><div class="para">
								Protocol: <code class="literal">tcp</code>
							</div></li><li class="listitem"><div class="para">
								Port / Port Range: <code class="literal">5445</code>
							</div></li><li class="listitem"><div class="para">
								Destination IP address: <code class="literal">10.1.1.2</code>
							</div></li><li class="listitem"><div class="para">
								Port / Port Range: <code class="literal">5445</code>
							</div></li></ul></div><div class="para">
						Use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guibutton"><strong>OK</strong></span> button, and press <span class="keycap"><strong>ENTER</strong></span>.
					</div></li><li class="step"><div class="para">
						Use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guibutton"><strong>Close</strong></span> button, and press <span class="keycap"><strong>ENTER</strong></span>.
					</div></li><li class="step"><div class="para">
						Use the <span class="keycap"><strong>TAB</strong></span> key to navigate to the <span class="guibutton"><strong>OK</strong></span> button, and press <span class="keycap"><strong>ENTER</strong></span>. To apply the changes, read the warning and click <span class="guibutton"><strong>Yes</strong></span>.
					</div></li></ol></li><li class="step"><p class="title"><strong>Configure a firewall on your JBoss EAP 6 host.</strong></p><div class="para">
				Some organizations choose to configure a firewall on the JBoss EAP 6 server itself, and close all ports that are not necessary for its operation. See <a class="xref" href="chap-Encrypt_Network_Traffic.html#Network_Ports_Used_By_JBoss_Enterprise_Application_Platform_62">Section 4.3, “Network Ports Used By JBoss EAP 6”</a> and determine which ports to open, then close the rest. The default configuration of Red Hat Enterprise Linux 6 closes all ports except <code class="literal">22</code> (used for Secure Shell (SSH) and <code class="literal">5353</code> (used for multicast DNS). While you are configuring ports, ensure you have physical access to your server so that you do not inadvertently lock yourself out.
			</div></li></ol></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Result</div>
			Your firewall is configured to forward traffic to your internal JBoss EAP 6 server in the way you specified in your firewall configuration. If you chose to enable a firewall on your server, all ports are closed except the ones needed to run your applications.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139772531197040">
      ⁠</a><p class="title"><strong>Procedure 4.2. Configuring Firewall on Microsoft Windows using PowerShell</strong></p><ol class="1"><li class="step"><div class="para">
				Switch off firewall for debug purpose to determine whether the current network behavior is related to the firewall configuration. 
<pre class="screen">Start-Process "$psHome\powershell.exe" -Verb Runas -ArgumentList '-command "NetSh Advfirewall set allprofiles state off"'</pre>

			</div></li><li class="step"><div class="para">
				Allow UDP connections on port 23364. For example: 
<pre class="screen">Start-Process "$psHome\powershell.exe" -Verb Runas -ArgumentList '-command "NetSh Advfirewall firewall add rule name="UDP Port 23364" dir=in  action=allow protocol=UDP localport=23364"'
Start-Process "$psHome\powershell.exe" -Verb Runas -ArgumentList '-command "NetSh Advfirewall firewall add rule name="UDP Port 23364" dir=out action=allow protocol=UDP localport=23364"'</pre>

			</div></li></ol></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139772484479680">
      ⁠</a><p class="title"><strong>Procedure 4.3. Configure the Firewall on Red Hat Enterprise Linux 7 to Allow mod_cluster Advertising</strong></p><ul><li class="step"><div class="para">
				To allow mod_cluster advertising on Red Hat Enterprise Linux 7, you must enable the UDP port in the firewall as follows: 
<pre class="screen">firewall-cmd --permanent --zone=public --add-port=23364/udp</pre>
				 <div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						224.0.1.105:23364 is the default address and port for mod_cluster balancer advertising UDP multicast.
					</div></div></div>

			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22930%2C+Security+Guide-6.4-1%0ABuild+Date%3A+15-04-2015+13%3A57%3A35%0ATopic+ID%3A+4705-707573+%5BLatest%5D&amp;comment=Title%3A+Configure+Network+Firewalls+to+Work+with+JBoss+EAP+6%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4705-707573+09+Sep+2014+02%3A31+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Network_Ports_Used_By_JBoss_Enterprise_Application_Platform_62">
      ⁠</a>4.3. Network Ports Used By JBoss EAP 6</h1></div></div></div><div class="para">
		The ports used by the JBoss EAP 6 default configuration depend on several factors:
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				Whether your server groups use one of the default socket binding groups, or a custom group.
			</div></li><li class="listitem"><div class="para">
				The requirements of your individual deployments.
			</div></li></ul></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Numerical port offsets</strong></p></div><div class="admonition"><div class="para">
			A numerical port offset can be configured, to alleviate port conflicts when you run multiple servers on the same physical server. If your server uses a numerical port offset, add the offset to the default port number for its server group's socket binding group. For instance, if the HTTP port of the socket binding group is <code class="literal">8080</code>, and your server uses a port offset of <code class="literal">100</code>, its HTTP port is <code class="literal">8180</code>.
		</div></div></div><div class="para">
		Unless otherwise stated, the ports use the TCP protocol.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><p class="title"><strong>The default socket binding groups</strong></p><ul><li class="listitem"><div class="para">
				<code class="literal">full-ha-sockets</code>
			</div></li><li class="listitem"><div class="para">
				<code class="literal">full-sockets</code>
			</div></li><li class="listitem"><div class="para">
				<code class="literal">ha-sockets</code>
			</div></li><li class="listitem"><div class="para">
				<code class="literal">standard-sockets</code>
			</div></li></ul></div><div class="para">
		These socket binding groups are available only in <code class="filename">domain.xml</code>. The standalone server profiles contain only standard socket binding group. This group corresponds to standard-sockets in <code class="filename">standalone.xml</code>, <code class="literal">ha-sockets</code> for <code class="filename">standalone-ha.xml</code>, <code class="literal">full-sockets</code> for <code class="filename">standalone-full.xml</code>, and <code class="literal">full-ha-sockets</code> for <code class="filename">standalone-full-ha.xml</code>. Standalone profiles contain some more socket bindings, for example, management-{native,http,https}.
	</div><div class="table"><a id="socket-bindings">
      ⁠</a><p class="title"><strong>Table 4.1. Reference of the default socket bindings</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="gt-4-cols gt-14-rows" summary="Reference of the default socket bindings"><colgroup><col width="11%" style="text-align: left" class="c1"/><col width="11%" style="text-align: left" class="c2"/><col width="11%" style="text-align: left" class="c3"/><col width="22%" style="text-align: left" class="c4"/><col width="11%" style="text-align: left" class="c5"/><col width="11%" style="text-align: left" class="c6"/><col width="11%" style="text-align: left" class="c7"/><col width="11%" style="text-align: left" class="c8"/></colgroup><thead><tr><th style="text-align: left"> Name </th><th style="text-align: left"> Port </th><th style="text-align: left"> Multicast Port </th><th style="text-align: left"> Description </th><th style="text-align: left"> full-ha-sockets </th><th style="text-align: left"> full-sockets </th><th style="text-align: left"> ha-socket </th><th style="text-align: left"> standard-socket </th></tr></thead><tbody><tr><td style="text-align: left"> <code class="literal">ajp</code> </td><td style="text-align: left"> 8009 </td><td style="text-align: left"> </td><td style="text-align: left"> Apache JServ Protocol. Used for HTTP clustering and load balancing. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td></tr><tr><td style="text-align: left"> <code class="literal">http</code> </td><td style="text-align: left"> 8080 </td><td style="text-align: left"> </td><td style="text-align: left"> The default port for deployed web applications. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td></tr><tr><td style="text-align: left"> <code class="literal">https</code> </td><td style="text-align: left"> 8443 </td><td style="text-align: left"> </td><td style="text-align: left"> SSL-encrypted connection between deployed web applications and clients. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td></tr><tr><td style="text-align: left"> <code class="literal">jacorb</code> </td><td style="text-align: left"> 3528 </td><td style="text-align: left"> </td><td style="text-align: left"> CORBA services for JTS transactions and other ORB-dependent services. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td><td style="text-align: left"> No </td></tr><tr><td style="text-align: left"> <code class="literal">jacorb-ssl</code> </td><td style="text-align: left"> 3529 </td><td style="text-align: left"> </td><td style="text-align: left"> SSL-encrypted CORBA services. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td><td style="text-align: left"> No </td></tr><tr><td style="text-align: left"> <code class="literal">jgroups-diagnostics</code> </td><td style="text-align: left"> </td><td style="text-align: left"> 7500 </td><td style="text-align: left"> Multicast. Used for peer discovery in HA clusters. Not configurable using the Management Interfaces. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td></tr><tr><td style="text-align: left"> <code class="literal">jgroups-mping</code> </td><td style="text-align: left"> </td><td style="text-align: left"> 45700 </td><td style="text-align: left"> Multicast. Used to discover initial membership in a HA cluster. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td></tr><tr><td style="text-align: left"> <code class="literal">jgroups-tcp</code> </td><td style="text-align: left"> 7600 </td><td style="text-align: left"> </td><td style="text-align: left"> Unicast peer discovery in HA clusters using TCP. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td></tr><tr><td style="text-align: left"> <code class="literal">jgroups-tcp-fd</code> </td><td style="text-align: left"> 57600 </td><td style="text-align: left"> </td><td style="text-align: left"> Used for HA failure detection over TCP. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td></tr><tr><td style="text-align: left"> <code class="literal">jgroups-udp</code> </td><td style="text-align: left"> 55200 </td><td style="text-align: left"> 45688 </td><td style="text-align: left"> Multicast peer discovery in HA clusters using UDP. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td></tr><tr><td style="text-align: left"> <code class="literal">jgroups-udp-fd</code> </td><td style="text-align: left"> 54200 </td><td style="text-align: left"> </td><td style="text-align: left"> Used for HA failure detection over UDP. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td></tr><tr><td style="text-align: left"> <code class="literal">messaging</code> </td><td style="text-align: left"> 5445 </td><td style="text-align: left"> </td><td style="text-align: left"> JMS service. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td><td style="text-align: left"> No </td></tr><tr><td style="text-align: left"> <code class="literal">messaging-group</code> </td><td style="text-align: left"> </td><td style="text-align: left"> </td><td style="text-align: left"> Referenced by HornetQ JMS broadcast and discovery groups. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td><td style="text-align: left"> No </td></tr><tr><td style="text-align: left"> <code class="literal">messaging-throughput</code> </td><td style="text-align: left"> 5455 </td><td style="text-align: left"> </td><td style="text-align: left"> Used by JMS Remoting. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td><td style="text-align: left"> No </td></tr><tr><td style="text-align: left"> <code class="literal">mod_cluster</code> </td><td style="text-align: left"> </td><td style="text-align: left"> 23364 </td><td style="text-align: left"> Multicast port for communication between JBoss EAP 6 and the HTTP load balancer. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td><td style="text-align: left"> Yes </td><td style="text-align: left"> No </td></tr><tr><td style="text-align: left"> <code class="literal">remoting</code> </td><td style="text-align: left"> 4447 </td><td style="text-align: left"> </td><td style="text-align: left"> Used for remote EJB invocation. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td></tr><tr><td style="text-align: left"> <code class="literal">txn-recovery-environment</code> </td><td style="text-align: left"> 4712 </td><td style="text-align: left"> </td><td style="text-align: left"> The JTA transaction recovery manager. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td></tr><tr><td style="text-align: left"> <code class="literal">txn-status-manager</code> </td><td style="text-align: left"> 4713 </td><td style="text-align: left"> </td><td style="text-align: left"> The JTA / JTS transaction manager. </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td><td style="text-align: left"> Yes </td></tr></tbody></table></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Management Ports</div>
			In addition to the socket binding groups, each host controller opens two more ports for management purposes:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				<code class="literal">9990</code> - The Web Management Console port
			</div></li><li class="listitem"><div class="para">
				<code class="literal">9999</code> - The port used by the Management Console and Management API
			</div></li></ul></div><div class="para">
		Additionally, if HTTPS is enabled for the Management Console, 9443 is also opened as the default port.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22930%2C+Security+Guide-6.4-1%0ABuild+Date%3A+15-04-2015+13%3A57%3A35%0ATopic+ID%3A+5377-741835+%5BLatest%5D&amp;comment=Title%3A+Network+Ports+Used+By+JBoss+EAP+6%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5377-741835+06+Feb+2015+02%3A50+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="About_Encryption">
      ⁠</a>4.4. About Encryption</h1></div></div></div><div class="para">
		<em class="firstterm">Encryption</em> refers to obfuscating sensitive information by applying mathematical algorithms to it. Encryption is one of the foundations of securing your infrastructure from data breaches, system outages, and other risks.
	</div><div class="para">
		Encryption can be applied to simple string data, such as passwords. It can also be applied to data communication streams. The HTTPS protocol, for instance, encrypts all data before transferring it from one party to another. If you connect from one server to another using the Secure Shell (SSH) protocol, all of your communication is sent in an encrypted <em class="wordasword"> tunnel </em>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22930%2C+Security+Guide-6.4-1%0ABuild+Date%3A+15-04-2015+13%3A57%3A35%0ATopic+ID%3A+4774-591672+%5BLatest%5D&amp;comment=Title%3A+About+Encryption%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4774-591672+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="About_SSL_Encryption">
      ⁠</a>4.5. About SSL Encryption</h1></div></div></div><div class="para">
		Secure Sockets Layer (SSL) encrypts network traffic between two systems. Traffic between the two systems is encrypted using a two-way key, generated during the <em class="glossterm"> handshake</em>
		 phase of the connection and known only by those two systems.
	</div><div class="para">
		For secure exchange of the two-way encryption key, SSL makes use of Public Key Infrastructure (PKI), a method of encryption that utilizes a <em class="firstterm">key pair</em>. A <em class="firstterm">key pair</em> consists of two separate but matching cryptographic keys - a public key and a private key. The public key is shared with others and is used to encrypt data, and the private key is kept secret and is used to decrypt data that has been encrypted using the public key.
	</div><div class="para">
		When a client requests a secure connection, a handshake phase takes place before secure communication can begin. During the SSL handshake the server passes its public key to the client in the form of a certificate. The certificate contains the identity of the server (its URL), the public key of the server, and a digital signature that validates the certificate. The client then validates the certificate and makes a decision about whether the certificate is trusted or not. If the certificate is trusted, the client generates the two-way encryption key for the SSL connection, encrypts it using the public key of the server, and sends it back to the server. The server decrypts the two-way encryption key, using its private key, and further communication between the two machines over this connection is encrypted using the two-way encryption key.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			Red Hat recommends that you explicitly disable SSL in favor of TLSv1.1 or TLSv1.2 in all affected packages.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22930%2C+Security+Guide-6.4-1%0ABuild+Date%3A+15-04-2015+13%3A57%3A35%0ATopic+ID%3A+4775-724692+%5BLatest%5D&amp;comment=Title%3A+About+SSL+Encryption%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4775-724692+09+Nov+2014+23%3A42+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Implement_SSL_Encryption_for_the_JBoss_Enterprise_Application_Platform_Web_Server1">
      ⁠</a>4.6. Implement SSL Encryption for the JBoss EAP 6 Web Server</h1></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Introduction</div>
			Many web applications require an SSL-encrypted connection between clients and server, also known as a <code class="code">HTTPS</code> connection. You can use this procedure to enable <code class="code">HTTPS</code> on your server or server group.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			Red Hat recommends that you explicitly disable SSL in favor of TLSv1.1 or TLSv1.2 in all affected packages.
		</div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				A set of SSL encryption keys and an SSL encryption certificate. You may purchase these from a certificate-signing authority, or you can generate them yourself using command-line utilities. To generate encryption keys using utilities available on Red Hat Enterprise Linux, see <a class="xref" href="chap-Encrypt_Network_Traffic.html#Generate_a_SSL_Encryption_Key_and_Certificate">Section 4.7, “Generate a SSL Encryption Key and Certificate”</a>.
			</div></li><li class="listitem"><div class="para">
				The following details about your specific environment and setup:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						The full directory name where the certificate files are stored.
					</div></li><li class="listitem"><div class="para">
						The encryption password for your encryption keys.
					</div></li></ul></div></li><li class="listitem"><div class="para">
				Management CLI running and connected to your domain controller or standalone server.
			</div></li><li class="listitem"><div class="para">
				Select appropriate cipher suites.
			</div></li></ul></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Cipher Suites</div>
			There are a number of available cryptographic primitives used as building blocks to form cipher suites. The first table lists recommended cryptographic primitives. The second lists cryptographic primitives which, while they <span class="emphasis"><em>may</em></span> be used for compatibility with existing software, are not considered as secure as those recommended.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			Red Hat recommends selectively whitelisting a set of strong ciphers to use for <code class="varname">cipher-suite</code>. Enabling weak ciphers is a significant security risk. Consult your JDK vendor's documentation before deciding on particular cipher suites as there may be compatibility issues.
		</div></div></div><div class="table"><a id="idm139772547518448">
      ⁠</a><p class="title"><strong>Table 4.2. Recommended Cryptographic Primitives</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols lt-7-rows" summary="Recommended Cryptographic Primitives"><colgroup><col style="text-align: left" class="c1"/></colgroup><tbody><tr><td style="text-align: left"> RSA with 2048 bit keys and OAEP </td></tr><tr><td style="text-align: left"> AES-128 in CBC mode </td></tr><tr><td style="text-align: left"> SHA-256 </td></tr><tr><td style="text-align: left"> HMAC-SHA-256 </td></tr><tr><td style="text-align: left"> HMAC-SHA-1 </td></tr></tbody></table></div></div><div class="table"><a id="idm139772565068080">
      ⁠</a><p class="title"><strong>Table 4.3. Other Cryptographic Primitives</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-7-rows" summary="Other Cryptographic Primitives"><colgroup><col style="text-align: left" class="c1"/></colgroup><tbody><tr><td style="text-align: left"> RSA with key sizes larger than 1024 and legacy padding </td></tr><tr><td style="text-align: left"> AES-192 </td></tr><tr><td style="text-align: left"> AES-256 </td></tr><tr><td style="text-align: left"> 3DES (triple DES, with two or three 56 bit keys) </td></tr><tr><td style="text-align: left"> RC4 (strongly discouraged) </td></tr><tr><td style="text-align: left"> SHA-1 </td></tr><tr><td style="text-align: left"> HMAC-MD5 </td></tr></tbody></table></div></div><div class="para">
		For a full listing of parameters you can set for the SSL properties of the connector, see <a class="xref" href="chap-Encrypt_Network_Traffic.html#SSL_Connector_Reference1">Section 4.8, “SSL Connector Reference”</a>.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			This procedure uses commands appropriate for a JBoss EAP 6 configuration that uses a managed domain. If you use a standalone server, modify Management CLI commands by removing the <code class="literal">/profile=default</code> from the beginning of any management CLI commands and replace instances of the <code class="literal">jboss.domain.config.dir</code> property with <code class="literal">jboss.server.config.dir</code> (as <code class="literal">jboss.domain.config.dir</code> is not available in standalone mode).
		</div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			Red Hat recommends that you explicitly disable SSL in favor of TLSv1.1 or TLSv1.2 in all affected packages.
		</div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139772496029728">
      ⁠</a><p class="title"><strong>Procedure 4.4. Configure the JBoss Web Server to use HTTPS</strong></p><ol class="1"><li class="step"><p class="title"><strong>Add a new HTTPS connector.</strong></p><div class="para">
				Create a secure connector, named <em class="replaceable">HTTPS</em>, which uses the <code class="literal">https</code> scheme, the <code class="literal">https</code> socket binding (which defaults to <code class="literal">8443</code>), and is set to be secure.
			</div><pre class="screen">
/profile=<em class="replaceable">default</em>/subsystem=web/connector=HTTPS/:add(socket-binding=https,scheme=https,protocol=HTTP/1.1,secure=true)
</pre></li><li class="step"><p class="title"><strong>Configure the SSL encryption certificate and keys.</strong></p><div class="para">
				Configure your SSL certificate, substituting your own values for the example ones. This example assumes that the keystore is copied to the server configuration directory, which is <code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/</code> for a managed domain.
			</div><pre class="screen">
/profile=default/subsystem=web/connector=HTTPS/ssl=configuration:add(name=https,certificate-key-file="${jboss.domain.config.dir}/keystore.jks",password=<em class="replaceable">SECRET</em>, key-alias=<em class="replaceable">KEY_ALIAS</em>, cipher-suite=<em class="replaceable">CIPHERS</em>)
</pre></li><li class="step"><p class="title"><strong> Set the protocol to <code class="literal">TLSv1</code>. </strong></p><pre class="screen">
/profile=<em class="replaceable">default</em>/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=protocol,value=TLSv1)
</pre></li><li class="step"><p class="title"><strong>Deploy an application.</strong></p><div class="para">
				Deploy an application to a server group which uses the profile you have configured. If you use a standalone server, deploy an application to your server. HTTPS requests to it use the new SSL-encrypted connection.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22930%2C+Security+Guide-6.4-1%0ABuild+Date%3A+15-04-2015+13%3A57%3A35%0ATopic+ID%3A+9036-747580+%5BLatest%5D&amp;comment=Title%3A+Implement+SSL+Encryption+for+the+JBoss+EAP+6+Web+Server%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9036-747580+17+Mar+2015+16%3A46+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Generate_a_SSL_Encryption_Key_and_Certificate">
      ⁠</a>4.7. Generate a SSL Encryption Key and Certificate</h1></div></div></div><div class="para">
		To use a SSL-encrypted HTTP connection (HTTPS), as well as other types of SSL-encrypted communication, you need a signed encryption certificate. You can purchase a certificate from a Certificate Authority (CA), or you can use a self-signed certificate. Self-signed certificates are not considered trustworthy by many third parties, but are appropriate for internal testing purposes.
	</div><div class="para">
		This procedure enables you to create a self-signed certificate using utilities which are available on Red Hat Enterprise Linux.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				You need the <code class="command">keytool</code> utility, which is provided by any Java Development Kit implementation. OpenJDK on Red Hat Enterprise Linux installs this command to <code class="filename">/usr/bin/keytool</code>.
			</div></li><li class="listitem"><div class="para">
				Understand the syntax and parameters of the <code class="command">keytool</code> command. This procedure uses extremely generic instructions, because further discussion of the specifics of SSL certificates or the <code class="filename">keytool</code> command are out of scope for this documentation.
			</div></li></ul></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139772543232896">
      ⁠</a><p class="title"><strong>Procedure 4.5. Generate a SSL Encryption Key and Certificate</strong></p><ol class="1"><li class="step"><p class="title"><strong>Generate a keystore with public and private keys.</strong></p><div class="para">
				Run the following command to generate a keystore named <code class="literal">server.keystore</code> with the alias <code class="literal">jboss</code> in your current directory. 
<pre class="screen">keytool -genkeypair -alias jboss -keyalg RSA -keystore server.keystore -storepass mykeystorepass --dname "CN=jsmith,OU=Engineering,O=mycompany.com,L=Raleigh,S=NC,C=US"</pre>
				 The following table describes the parameters used in the keytool command:
			</div><div class="informaltable"><table class="lt-4-cols gt-7-rows"><colgroup><col/><col/></colgroup><thead><tr><th> Parameter </th><th> Description </th></tr></thead><tbody><tr><td> <em class="parameter"><code>-genkeypair</code></em> </td><td> The <code class="command">keytool</code> command to generate a key pair containing a public and private key. </td></tr><tr><td> <em class="parameter"><code>-alias</code></em> </td><td> The alias for the keystore. This value is arbitrary, but the alias <code class="literal">jboss</code> is the default used by the JBoss Web server. </td></tr><tr><td> <em class="parameter"><code>-keyalg</code></em> </td><td> The key pair generation algorithm. In this case it is <code class="literal">RSA</code>. </td></tr><tr><td> <em class="parameter"><code>-keystore</code></em> </td><td> The name and location of the keystore file. The default location is the current directory. The name you choose is arbitrary. In this case, the file will be named <code class="literal">server.keystore</code>. </td></tr><tr><td> <em class="parameter"><code>-storepass</code></em> </td><td> This password is used to authenticate to the keystore so that the key can be read. The password must be at least 6 characters long and must be provided when the keystore is accessed. In this case, we used <code class="literal">mykeystorepass</code>. If you omit this parameter, you will be prompted to enter it when you execute the command. </td></tr><tr><td> <em class="parameter"><code>-keypass</code></em> </td><td> <div class="para">
								This is the password for the actual key.
							</div>
							 <div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
									Due to an implementation limitation this must be the same as the store password.
								</div></div></div>
							 </td></tr><tr><td> <em class="parameter"><code>--dname</code></em> </td><td> A quoted string describing the distinguished name for the key, for example: "CN=jsmith,OU=Engineering,O=mycompany.com,L=Raleigh,C=US". This string is a concatenation of the following components: 
							<div class="itemizedlist"><ul><li class="listitem"><div class="para">
										<code class="literal">CN</code> - The common name or host name. If the hostname is "jsmith.mycompany.com", the <code class="literal">CN</code> is "jsmith".
									</div></li><li class="listitem"><div class="para">
										<code class="literal">OU</code> - The organizational unit, for example "Engineering"
									</div></li><li class="listitem"><div class="para">
										<code class="literal">O</code> - The organization name, for example "mycompany.com".
									</div></li><li class="listitem"><div class="para">
										<code class="literal">L</code> - The locality, for example "Raleigh" or "London"
									</div></li><li class="listitem"><div class="para">
										<code class="literal">S</code> - The state or province, for example "NC". This parameter is optional.
									</div></li><li class="listitem"><div class="para">
										<code class="literal">C</code> - The 2 letter country code, for example "US" or "UK",
									</div></li></ul></div>
							 </td></tr></tbody></table></div><div class="para">
				When you execute the above command, you are prompted for the following information: 
				<div class="itemizedlist"><ul><li class="listitem"><div class="para">
							If you did not use the <em class="parameter"><code>-storepass</code></em> parameter on the command line, you are asked to enter the keystore password. Re-enter the new password at the next prompt.
						</div></li><li class="listitem"><div class="para">
							If you did not use the <code class="code">-keypass</code> parameter on the command line, you are asked to enter the key password. Press <span class="keycap"><strong>Enter</strong></span> to set this to the same value as the keystore password.
						</div></li></ul></div>

			</div><div class="para">
				When the command completes, the file <code class="literal">server.keystore</code> now contains the single key with the alias <code class="literal">jboss</code>.
			</div></li><li class="step"><p class="title"><strong>Verify the key.</strong></p><div class="para">
				Verify that the key works properly by using the following command.
			</div><pre class="screen">keytool -list -keystore server.keystore</pre><div class="para">
				You are prompted for the keystore password. The contents of the keystore are displayed (in this case, a single key called <code class="literal">jboss</code>). Notice the type of the <code class="literal">jboss</code> key, which is <code class="literal">PrivateKeyEntry</code>. This indicates that the keystore contains both a public and private entry for this key.
			</div></li><li class="step"><p class="title"><strong>Generate a certificate signing request.</strong></p><div class="para">
				Run the following command to generate a certificate signing request using the public key from the keystore you created in step 1.
			</div><pre class="screen">keytool -certreq -keyalg RSA -alias jboss -keystore server.keystore -file certreq.csr</pre><div class="para">
				You are prompted for the password in order to authenticate to the keystore. The <code class="code">keytool</code> command then creates a new certificate signing request called <code class="filename">certreq.csr</code> in the current working directory.
			</div></li><li class="step"><p class="title"><strong>Test the newly generated certificate signing request.</strong></p><div class="para">
				Test the contents of the certificate by using the following command.
			</div><pre class="screen">openssl req -in certreq.csr -noout -text</pre><div class="para">
				The certificate details are shown.
			</div></li><li class="step"><p class="title"><strong>Optional: Submit your certificate signing request to a Certificate Authority (CA).</strong></p><div class="para">
				A Certificate Authority (CA) can authenticate your certificate so that it is considered trustworthy by third-party clients. The CA supplies you with a signed certificate, and optionally with one or more intermediate certificates.
			</div></li><li class="step"><p class="title"><strong>Optional: Export a self-signed certificate from the keystore.</strong></p><div class="para">
				If you only need it for testing or internal purposes, you can use a self-signed certificate. You can export one from the keystore you created in step 1 as follows:
			</div><pre class="screen">keytool -export -alias jboss -keystore server.keystore -file server.crt</pre><div class="para">
				You are prompted for the password in order to authenticate to the keystore. A self-signed certificate, named <code class="code">server.crt</code>, is created in the current working directory.
			</div></li><li class="step"><p class="title"><strong>Import the signed certificate, along with any intermediate certificates.</strong></p><div class="para">
				Import each certificate, in the order that you are instructed by the CA. For each certificate to import, replace <code class="code">intermediate.ca</code> or <code class="code">server.crt</code> with the actual file name. If your certificates are not provided as separate files, create a separate file for each certificate, and paste its contents into the file.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Your signed certificate and certificate keys are valuable assets. Be cautious with how you transport them between servers.
				</div></div></div><pre class="screen">keytool -import -keystore server.keystore -alias intermediateCA -file intermediate.ca</pre><pre class="screen">keytool -importcert -alias jboss -keystore server.keystore -file server.crt</pre></li><li class="step"><p class="title"><strong>Test that your certificates imported successfully.</strong></p><div class="para">
				Run the following command, and enter the keystore password when prompted. The contents of your keystore are displayed, and the certificates are part of the list.
			</div><pre class="screen">keytool -list -keystore server.keystore</pre></li></ol></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Result</div>
			Your signed certificate is now included in your keystore and is ready to be used to encrypt SSL connections, including HTTPS web server communications.
		</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22930%2C+Security+Guide-6.4-1%0ABuild+Date%3A+15-04-2015+13%3A57%3A35%0ATopic+ID%3A+9037-687728+%5BLatest%5D&amp;comment=Title%3A+Generate+a+SSL+Encryption+Key+and+Certificate%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9037-687728+24+Jul+2014+00%3A10+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="SSL_Connector_Reference1">
      ⁠</a>4.8. SSL Connector Reference</h1></div></div></div><div class="para">
		JBoss Web connectors may include the following SSL configuration attributes. The CLI commands provided are designed for a managed domain using profile <code class="literal">default</code>. Change the profile name to the one you wish to configure, for a managed domain, or omit the <code class="code">/profile=default</code> portion of the command, for a standalone server.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			Before using the <code class="code">write-attribute</code> CLI command listed in the table, you need to add <code class="code">ssl=configuration</code>.
		</div></div></div><div class="table"><a id="idm139772484841456">
      ⁠</a><p class="title"><strong>Table 4.4. SSL Connector Attributes</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-14-rows" summary="SSL Connector Attributes"><colgroup><col/><col/><col/></colgroup><thead><tr><th> Attribute </th><th> Description </th><th> CLI Command </th></tr></thead><tbody><tr><td> name </td><td> <div class="para">
						The display name of the SSL connector.
					</div>
					 </td><td> <div class="para">
						Attribute <code class="literal">name</code> is read-only.
					</div>
					 </td></tr><tr><td> verify-client </td><td> <div class="para">
						The possible values of <code class="literal">verify-client</code> differ, based upon whether the HTTP/HTTPS connector is used, or the native APR connector is used.
					</div>
					 <div class="para"><div class="title">HTTP/HTTPS Connector</div>
							Possible values are <code class="literal">true</code>, <code class="literal">false</code>, or <code class="literal">want</code>. Set to <code class="literal">true</code> to require a valid certificate chain from the client before accepting a connection. Set to <code class="literal">want</code> if you want the SSL stack to request a client Certificate, but not fail if one is not presented. Set to <code class="literal">false</code> (the default) to not require a certificate chain unless the client requests a resource protected by a security constraint that uses <code class="code">CLIENT-CERT</code> authentication.
						</div>
					 <div class="para">
						Before using the <code class="code">write-attribute</code> CLI command, you need to add the APR connector.
					</div>
					 <div class="para"><div class="title">Native APR Connector</div>
							Possible values are <code class="literal">optional</code>, <code class="literal">require</code>, <code class="literal">optionalNoCA</code>, and <code class="literal">none</code> (or any other string, which will have the same effect as <code class="literal">none</code>). These values determine whether a certification is optional, required, optional without a Certificate Authority, or not required at all. The default is <code class="literal">none</code>, meaning the client will not have the opportunity to submit a certificate.
						</div>
					 </td><td> <div class="para">
						The first example command uses the HTTPS connector.
					</div>
					 
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=verify-client,value=want)</pre>
					 <div class="para">
						The second example command uses the APR connector.
					</div>
					 
<pre class="screen">/profile=default/subsystem=web/connector=APR/ssl=configuration/:write-attribute(name=verify-client,value=require)</pre>
					 </td></tr><tr><td> verify-depth </td><td> <div class="para">
						The maximum number of intermediate certificate issuers checked before deciding that the clients do not have a valid certificate. The default value is <code class="literal">10</code>.
					</div>
					 </td><td>
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=verify-depth,value=10)</pre>
					 </td></tr><tr><td> certificate-key-file </td><td> <div class="para">
						The full file path and file name of the keystore file where the signed server certificate is stored. With JSSE encryption, this certificate file will be the only one, while OpenSSL uses several files. The default value is the <code class="filename">.keystore</code> file in the home directory of the user running JBoss EAP 6. If your <code class="code">keystoreType</code> does not use a file, set the parameter to an empty string.
					</div>
					 </td><td>
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=certificate-key-file,value=../domain/configuration/server.keystore)</pre>
					 </td></tr><tr><td> certificate-file </td><td> <div class="para">
						If you use OpenSSL encryption, set the value of this parameter to the path to the file containing the server certificate.
					</div>
					 </td><td>
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=certificate-file,value=server.crt)</pre>
					 </td></tr><tr><td> password </td><td> <div class="para">
						The password for both the truststore and keystore. In the following example, replace <em class="replaceable">PASSWORD</em> with your own password.
					</div>
					 </td><td>
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=password,value=<em class="replaceable">PASSWORD</em>)</pre>
					 </td></tr><tr><td> protocol </td><td> <div class="para">
						The version of the SSL protocol to use. Supported values depend on the underlying SSL implementation (whether JSSE or OpenSSL). Refer to the <a href="http://docs.oracle.com/javase/7/docs/technotes/guides/security/SunProviders.html#SunJSSEProvider">Java SSE Documentation</a>.
					</div>
					 <div class="para">
						You can also specify a combination of protocols, which is comma separated. For example, TLSv1, TLSv1.1,TLSv1.2.
					</div>
					 <div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
							Red Hat recommends that you explicitly disable SSL in favor of TLSv1.1 or TLSv1.2 in all affected packages.
						</div></div></div>
					  </td><td>
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=protocol,value=ALL)</pre>
					 
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=protocol,value="TLSv1, TLSv1.1,TLSv1.2")</pre>
					 </td></tr><tr><td> cipher-suite </td><td> <div class="para">
						A list of the encryption ciphers which are allowed. For JSSE syntax, it must be a comma-separated list. For OpenSSL syntax, it must be a colon-separated list. Ensure that you only use one syntax.
					</div>
					 <div class="para">
						 The default is <code class="literal">HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5</code>.
					</div>
					 <div class="para">
						The example only lists two possible ciphers, but real-world examples will likely use more.
					</div>
					 <div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
							Using weak ciphers is a significant security risk. See <a href="http://www.nist.gov/manuscript-publication-search.cfm?pub_id=915295">http://www.nist.gov/manuscript-publication-search.cfm?pub_id=915295</a> for NIST recommendations on cipher suites.
						</div></div></div>
					 <div class="para">
						For a list of available OpenSSL ciphers, see <a href="https://www.openssl.org/docs/apps/ciphers.html#CIPHER_STRINGS">https://www.openssl.org/docs/apps/ciphers.html#CIPHER_STRINGS</a>. Note that the following are not supported: <code class="literal">@SECLEVEL</code>, <code class="literal">SUITEB128</code>, <code class="literal">SUITEB128ONLY</code>, <code class="literal">SUITEB192</code>.
					</div>
					 </td><td>
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=cipher-suite, value="TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA")</pre>
					 </td></tr><tr><td> key-alias </td><td> <div class="para">
						The alias used to for the server certificate in the keystore. In the following example, replace <em class="replaceable">KEY_ALIAS</em> with your certificate's alias.
					</div>
					 </td><td>
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=key-alias,value=<em class="replaceable">KEY_ALIAS</em>)</pre>
					 </td></tr><tr><td> truststore-type </td><td> <div class="para">
						The type of the truststore. Various types of truststores are available, including <code class="literal">PKCS12</code> and Java's standard <code class="literal">JKS</code>.
					</div>
					 </td><td>
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=truststore-type,value=jks)</pre>
					 </td></tr><tr><td> keystore-type </td><td> <div class="para">
						The type of the keystore, Various types of keystores are available, including <code class="literal">PKCS12</code> and Java's standard <code class="literal">JKS</code>.
					</div>
					 </td><td>
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=keystore-type,value=jks)</pre>
					 </td></tr><tr><td> ca-certificate-file </td><td> <div class="para">
						The file containing the CA certificates. This is the <code class="code">truststoreFile</code>, in the case of JSSE, and uses the same password as the keystore. The <code class="code">ca-certificate-file</code> file is used to validate client certificates.
					</div>
					 </td><td>
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=certificate-file,value=ca.crt)</pre>
					 </td></tr><tr><td> ca-certificate-password </td><td> <div class="para">
						The Certificate password for the <code class="code">ca-certificate-file</code>. In the following example, replace the <em class="replaceable">MASKED_PASSWORD</em> with your own masked password.
					</div>
					 </td><td>
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=ca-certificate-password,value=<em class="replaceable">MASKED_PASSWORD</em>)</pre>
					 </td></tr><tr><td> ca-revocation-url </td><td> <div class="para">
						A file or URL which contains the revocation list. It refers to the <code class="code">crlFile</code> for JSSE or the <code class="code">SSLCARevocationFile</code> for SSL.
					</div>
					 </td><td>
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=ca-revocation-url,value=ca.crl)</pre>
					 </td></tr><tr><td> session-cache-size </td><td> <div class="para">
						The size of the SSLSession cache. This attribute applies only to JSSE connectors. The default is <code class="literal">0</code>, which specifies an unlimited cache size.
					</div>
					 </td><td>
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=session-cache-size,value=100)</pre>
					 </td></tr><tr><td> session-timeout </td><td> <div class="para">
						The number of seconds before a cached SSLSession expires. This attribute applies only to JSSE connectors. The default is <code class="literal">86400</code> seconds, which is 24 hours.
					</div>
					 </td><td>
<pre class="screen">/profile=default/subsystem=web/connector=HTTPS/ssl=configuration/:write-attribute(name=session-timeout,value=43200)</pre>
					 </td></tr></tbody></table></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			For performance testing, you must set one explicit cipher and protocol.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22930%2C+Security+Guide-6.4-1%0ABuild+Date%3A+15-04-2015+13%3A57%3A35%0ATopic+ID%3A+9038-742565+%5BLatest%5D&amp;comment=Title%3A+SSL+Connector+Reference%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9038-742565+11+Feb+2015+04%3A15+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-FIPS_140-2_Compliant_Encryption">
      ⁠</a>4.9. FIPS 140-2 Compliant Encryption</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_FIPS_140-2_Compliance">
      ⁠</a>4.9.1. About FIPS 140-2 Compliance</h2></div></div></div><div class="para">
		The Federal Information Processing Standard 140-2 (FIPS 140-2) is a US government computer security standard for the accreditation of cryptographic software modules. FIPS 140-2 compliance is often a requirement of software systems used by government agencies and private sector business.
	</div><div class="para">
		JBoss EAP 6 uses external modules encryption and can be configured to use a FIPS 140-2 compliant cryptography module.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22930%2C+Security+Guide-6.4-1%0ABuild+Date%3A+15-04-2015+13%3A57%3A35%0ATopic+ID%3A+13767-592086+%5BLatest%5D&amp;comment=Title%3A+About+FIPS+140-2+Compliance%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=13767-592086+23+Feb+2014+16%3A57+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="FIPS_140-2_Compliant_Cryptography_on_IBM_JDK">
      ⁠</a>4.9.2. FIPS 140-2 Compliant Cryptography on IBM JDK</h2></div></div></div><div class="para">
		On the IBM JDK, the IBM® JCE (Java™ Cryptographic Extension) IBMJCEFIPS provider and the IBM JSSE (Java Secure Sockets Extension) FIPS 140-2 Cryptographic Module (IBMJSSEFIPS) for Multi-platforms provide FIPS 140-2 compliant cryptography.
	</div><div class="para">
		For more information on the IBMJCEFIPS provider, refer to <a href="http://publib.boulder.ibm.com/infocenter/realtime/v1r0/index.jsp?topic=%2Fcom.ibm.rt.doc.10%2Fsecurity%2Fjcefips%2Fibmjcefips.html">the IBM Documentation for IBM JCEFIPS</a>, and the <a href="http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140sp/140sp497.pdf">NIST IBMJCEFIPS – Security Policy</a>.
	</div><h4><a id="idm139772546528112">
      ⁠</a> Key storage </h4><div class="para">
		Note that the IBM JCE does not provide a keystore. The keys are stored on the computer and do not leave its physical boundary. If the keys are moved between computers they must be encrypted.
	</div><div class="para">
		To run <code class="command">keytool</code> in FIPS-compliant mode use the <code class="command">-providerClass</code> option on each command like this:
	</div><pre class="screen">keytool -list -storetype JCEKS -keystore mystore.jck -storepass mystorepass -providerClass com.ibm.crypto.fips.provider.IBMJCEFIPS</pre><h4><a id="idm139772524920176">
      ⁠</a> Examine FIPS provider information </h4><div class="para">
		To examine information about the IBMJCEFIPS used by the server, enable debug-level logging by adding <code class="literal">-Djavax.net.debug=true</code> to <code class="filename">standalone.conf</code> or <code class="filename">domain.conf</code>. Information about the FIPS provider is logged to <code class="filename">server.log</code>, for example:
	</div><pre class="screen">04:22:45,685 INFO  [stdout] (http-/127.0.0.1:8443-1) JsseJCE:  Using MessageDigest SHA from provider IBMJCEFIPS version 1.7
04:22:45,689 INFO  [stdout] (http-/127.0.0.1:8443-1) DHCrypt:  DH KeyPairGenerator  from provider from init IBMJCEFIPS version 1.7
04:22:45,754 INFO  [stdout] (http-/127.0.0.1:8443-1) JsseJCE:  Using KeyFactory DiffieHellman from provider IBMJCEFIPS version 1.7
04:22:45,754 INFO  [stdout] (http-/127.0.0.1:8443-1) JsseJCE:  Using KeyAgreement DiffieHellman from provider IBMJCEFIPS version 1.7
04:22:45,754 INFO  [stdout] (http-/127.0.0.1:8443-1) DHCrypt:  DH KeyAgreement  from provider IBMJCEFIPS version 1.7
04:22:45,754 INFO  [stdout] (http-/127.0.0.1:8443-1) DHCrypt:  DH KeyAgreement  from provider from initIBMJCEFIPS version 1.7
</pre><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22930%2C+Security+Guide-6.4-1%0ABuild+Date%3A+15-04-2015+13%3A57%3A35%0ATopic+ID%3A+41098-686150+%5BLatest%5D&amp;comment=Title%3A+FIPS+140-2+Compliant+Cryptography+on+IBM+JDK%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=41098-686150+20+Jul+2014+19%3A00+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="FIPS_140-2_Compliant_Passwords">
      ⁠</a>4.9.3. FIPS 140-2 Compliant Passwords</h2></div></div></div><div class="para">
		A FIPS compliant password must have the following characteristics:
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
				Must be at least seven (7) characters in length.
			</div></li><li class="listitem"><div class="para">
				Must include characters from at least three (3) of the following character classes:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						ASCII digits,
					</div></li><li class="listitem"><div class="para">
						lowercase ASCII,
					</div></li><li class="listitem"><div class="para">
						uppercase ASCII,
					</div></li><li class="listitem"><div class="para">
						non-alphanumeric ASCII, and
					</div></li><li class="listitem"><div class="para">
						non-ASCII.
					</div></li></ul></div></li></ol></div><div class="para">
		If the first character of the password is an uppercase ASCII letter, then it is not counted as an uppercase ASCII letter for restriction 2.
	</div><div class="para">
		If the last character of the password is an ASCII digit, then it does not count as an ASCII digit for restriction 2.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22930%2C+Security+Guide-6.4-1%0ABuild+Date%3A+15-04-2015+13%3A57%3A35%0ATopic+ID%3A+13893-592092+%5BLatest%5D&amp;comment=Title%3A+FIPS+140-2+Compliant+Passwords%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=13893-592092+23+Feb+2014+16%3A57+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Enable_FIPS_140-2_Cryptography_for_SSL_on_Red_Hat_Enterprise_Linux_6">
      ⁠</a>4.9.4. Enable FIPS 140-2 Cryptography for SSL on Red Hat Enterprise Linux 6</h2></div></div></div><div class="para">
		This task describes how to configure the web container (JBoss Web) of JBoss EAP 6 to FIPS 140-2 compliant cryptography for SSL. This task only covers the steps to do this on Red Hat Enterprise Linux 6.
	</div><div class="para">
		This task uses the Mozilla NSS library in FIPS mode for this feature.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				Red Hat Enterprise Linux 6 must already be configured to be FIPS 140-2 compliant. Refer to <a href="https://access.redhat.com/knowledge/solutions/137833">https://access.redhat.com/knowledge/solutions/137833</a>.
			</div></li></ul></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139772524883024">
      ⁠</a><p class="title"><strong>Procedure 4.6. Enable FIPS 140-2 Compliant Cryptography for SSL</strong></p><ol class="1"><li class="step"><p class="title"><strong>Create the database</strong></p><div class="para">
				Create the NSS database in a directory own by the <code class="literal">jboss</code> user.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The <code class="literal">jboss</code> user is only an example. You need to replace it with a user on your operating system.
				</div></div></div><pre class="screen">$ mkdir -p  /usr/share/jboss-as/nssdb
$ chown jboss /usr/share/jboss-as/nssdb 
$ modutil -create -dbdir /usr/share/jboss-as/nssdb
</pre></li><li class="step"><p class="title"><strong>Create NSS configuration file</strong></p><div class="para">
				Create a new text file with the name <code class="filename">nss_pkcsll_fips.cfg</code> in the <code class="filename">/usr/share/jboss-as</code> directory with the following contents:
			</div><pre class="programlisting">name = nss-fips
nssLibraryDirectory=/usr/lib64
nssSecmodDirectory=/usr/share/jboss-as/nssdb
nssModule = fips
</pre><div class="para">
				The NSS configuration file must specify:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						a name,
					</div></li><li class="listitem"><div class="para">
						the directory where the NSS library is located, and
					</div></li><li class="listitem"><div class="para">
						the directory where the NSS database was created as per step 1.
					</div></li></ul></div><div class="para">
				If you are not running a 64bit version of Red Hat Enterprise Linux 6 then set <code class="code">nssLibraryDirectory</code> to <code class="filename">/usr/lib</code> instead of <code class="filename">/usr/lib64</code>.
			</div></li><li class="step"><p class="title"><strong>Enable SunPKCS11 provider</strong></p><div class="para">
				Edit the <code class="filename">java.security</code> configuration file for your JRE (<code class="filename">$JAVA_HOME/jre/lib/security/java.security</code>) and add the following line:
			</div><pre class="programlisting">security.provider.1=sun.security.pkcs11.SunPKCS11  /usr/share/jboss-as/nss_pkcsll_fips.cfg
</pre><div class="para">
				Note that the configuration file specified in this line is the file created in step 2.
			</div><div class="para">
				Any other <code class="code">security.provider.<em class="replaceable">X</em></code> lines in this file must have the value of their <em class="replaceable">X</em> increased by one to ensure that this provider is given priority.
			</div></li><li class="step"><p class="title"><strong>Enable FIPS mode for the NSS library</strong></p><div class="para">
				Run the <code class="command">modutil</code> command as shown to enable FIPS mode:
			</div><pre class="screen">modutil -fips true -dbdir /usr/share/jboss-as/nssdb</pre><div class="para">
				Note that the directory specified here is the one created in step 1.
			</div><div class="para">
				You may get a security library error at this point requiring you to regenerate the library signatures for some of the NSS shared objects.
			</div></li><li class="step"><p class="title"><strong>Change the password on the FIPS token</strong></p><div class="para">
				Set the password on the FIPS token using the following command. Note that the name of the token must be <code class="literal">NSS FIPS 140-2 Certificate DB</code>.
			</div><pre class="screen">modutil -changepw "<code class="literal">NSS FIPS 140-2 Certificate DB</code>" -dbdir /usr/share/jboss-as/nssdb</pre><div class="para">
				The password used for the FIPS token must be a FIPS compliant password.
			</div></li><li class="step"><p class="title"><strong>Create certificate using NSS tools</strong></p><div class="para">
				Enter the following command to create a certificate using the NSS tools.
			</div><pre class="screen">certutil -S -k rsa -n jbossweb  -t "u,u,u" -x -s "CN=localhost, OU=MYOU, O=MYORG, L=MYCITY, ST=MYSTATE, C=MY" -d /usr/share/jboss-as/nssdb</pre></li><li class="step"><p class="title"><strong>Configure the HTTPS connector to use the PKCS11 keystore</strong></p><div class="para">
				Add a HTTPS connector using the following command in the JBoss CLI Tool:
			</div><pre class="screen">/subsystem=web/connector=https/:add(socket-binding=https,scheme=https,protocol=HTTP/1.1,secure=true)
</pre><div class="para">
				Then add the SSL configuration with the following command, replacing PASSWORD with the FIPS compliant password from step 5.
			</div><pre class="screen">/subsystem=web/connector=https/ssl=configuration:add(name=https,password=PASSWORD,keystore-type=PKCS11,
cipher-suite="SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA,
TLS_RSA_WITH_AES_128_CBC_SHA,TLS_DHE_DSS_WITH_AES_128_CBC_SHA,
TLS_DHE_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,
TLS_DHE_DSS_WITH_AES_256_CBC_SHA,TLS_DHE_RSA_WITH_AES_256_CBC_SHA,
TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,
TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA,
TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,
TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,
TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,
TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA,TLS_ECDH_anon_WITH_AES_128_CBC_SHA,
TLS_ECDH_anon_WITH_AES_256_CBC_SHA")
</pre></li><li class="step"><p class="title"><strong>Verify</strong></p><div class="para">
				Verify that the JVM can read the private key from the PKCS11 keystore by running the following command:
			</div><pre class="screen">keytool -list -storetype pkcs11
</pre></li></ol></div><div class="example"><a id="idm139772498622368">
      ⁠</a><p class="title"><strong>Example 4.5. XML configuration for HTTPS connector using FIPS 140-2 compliance</strong></p><div class="example-contents"><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;connector</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"https"</span><span xmlns="" class="perl_Others"> protocol=</span><span xmlns="" class="perl_String">"HTTP/1.1"</span><span xmlns="" class="perl_Others"> scheme=</span><span xmlns="" class="perl_String">"https"</span><span xmlns="" class="perl_Others"> socket-binding=</span><span xmlns="" class="perl_String">"https"</span><span xmlns="" class="perl_Others"> secure=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;ssl</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"https"</span><span xmlns="" class="perl_Others"> password=</span><span xmlns="" class="perl_String">"****"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      cipher-suite=</span><span xmlns="" class="perl_String">"SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA,</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">         TLS_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_DSS_WITH_AES_128_CBC_SHA,</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">         TLS_DHE_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">         TLS_DHE_DSS_WITH_AES_256_CBC_SHA,TLS_DHE_RSA_WITH_AES_256_CBC_SHA,</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">         TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">         TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA,</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">         TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">         TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">         TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">         TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">         TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA,TLS_ECDH_anon_WITH_AES_128_CBC_SHA,</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">         TLS_ECDH_anon_WITH_AES_256_CBC_SHA"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      keystore-type=</span><span xmlns="" class="perl_String">"PKCS11"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/connector&gt;</span>
</pre><div class="para">
			Note that the <code class="code">cipher-suite</code> attribute has linebreaks inserted to make it easier to read.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+22930%2C+Security+Guide-6.4-1%0ABuild+Date%3A+15-04-2015+13%3A57%3A35%0ATopic+ID%3A+13768-741444+%5BLatest%5D&amp;comment=Title%3A+Enable+FIPS+140-2+Cryptography+for+SSL+on+Red+Hat+Enterprise+Linux+6%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=13768-741444+05+Feb+2015+04%3A50+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div></div></body></html>