<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 2. How Red Hat JBoss Enterprise Application Platform 6 Handles Security Out of the Box</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="how_red_hat_jboss_enterprise_application_platform_6_handles_security_out_of_the_box"/>Chapter 2. How Red Hat JBoss Enterprise Application Platform 6 Handles Security Out of the Box</h1></div></div></div><p>
			There are two components that ship with JBoss EAP 6 and above that relate to security: Core Management Authentication and the Security Subsystem. These two components are based on the general security concepts discussed in the <a class="link" href="overview-of-general-security-concepts.html" title="Chapter 1. Overview of General Security Concepts">overview section</a>, but they also incorporate some JBoss EAP-specific concepts in their implementation discussed in the in the <a class="xref" href="how_red_hat_jboss_enterprise_application_platform_6_handles_security_out_of_the_box.html#red_hat_jboss_enterprise_application_platform_specific_concepts" title="Red Hat JBoss Enterprise Application Platform-Specific Concepts">the section called “Red Hat JBoss Enterprise Application Platform-Specific Concepts”</a> section.
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="red_hat_jboss_enterprise_application_platform_specific_concepts"/>Red Hat JBoss Enterprise Application Platform-Specific Concepts</h1></div></div></div><p>
				In addition to the general security concept covered in the <a class="xref" href="overview-of-general-security-concepts.html" title="Chapter 1. Overview of General Security Concepts">Chapter 1, <em>Overview of General Security Concepts</em></a> section, it’s important to understand some of the concepts specific to JBoss EAP and JBoss EAP security.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="core_services_subsystems_and_profiles"/>Core Services, Subsystems, and Profiles</h2></div></div></div><p>
					JBoss EAP 6 is built on the concept of modular classloading. Each API or service provided by JBoss EAP is implemented as a module, which is loaded and unloaded on demand. The core services are services which are always loaded on server startup and are required to be running prior to starting any additional subsystems.
				</p><p>
					A subsystem is an additional set of capabilities added to the core server by an extension. Some example subsystems include: a subsystem that provides servlet handling capabilities, a subsystem provides an EJB container, and a subsystem provides JTA.
				</p><p>
					A profile is a named list of subsystems, along with the details of each subsystem’s configuration. A profile with a large number of subsystems results in a server with a large set of capabilities. A profile with a small, focused set of subsystems will have fewer capabilities but a smaller footprint. By default, JBoss EAP 6 comes with several pre-defined profiles (e.g. default, full, ha, full-ha). In these profiles, the Management Interfaces and the associated security realms are loaded as core services.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="management_interfaces"/>Management Interfaces</h2></div></div></div><p>
					JBoss EAP 6 offers two different management interfaces (APIs) for interacting with and editing its configuration: The Management Console (HTTP API) and the Management CLI (Native API). Both of these interfaces expose the functionality of the core management of JBoss EAP. In essence, these interfaces offer two ways to access the same core management system.
				</p><p>
					The Management Console is a web-based administration tool for JBoss EAP 6 . It may be used to start and stop servers, deploy and undeploy applications, tune system settings, and make persistent modifications to the server configuration. The Management Console also has the ability to perform administrative tasks, with live notifications when any changes require the server instance to be restarted or reloaded. In a Managed Domain, server instances and server groups in the same domain can be centrally managed from the Management Console of the domain controller.
				</p><p>
					The Management Command Line Interface (CLI) is a command line administration tool for JBoss EAP 6. The Management CLI may be used to start and stop servers, deploy and undeploy applications, configure system settings, and perform other administrative tasks. Operations can be performed in batch mode, allowing multiple tasks to be run as a group. The Management CLI may also connect to the Domain Controller in a managed domain to execute management operations on the domain. The Management CLI can perform all tasks that the web-based administration tool can perform as well as many other lower level operations that are unavailable to the web-based administration tool.
				</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						In addition to the clients that ship with JBoss EAP 6, other clients can be written to invoke the management interfaces over either the HTTP or native interfaces using the APIs included with JBoss EAP 6.
					</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="security_realms"/>Security Realms</h2></div></div></div><p>
					A security realm is effectively an identity store of usernames, passwords, and group membership information that can be used when authenticating users in EJBs, Web applications, and the Management Interface. Initially, JBoss EAP 6 comes pre-configured with two security realms by default: <span class="emphasis"><em>ManagementRealm</em></span> and <span class="emphasis"><em>ApplicationRealm</em></span>. Both of these security realms use the filesystem to store mappings between users and passwords, and users and group membership information and use a digest mechanism by default when authenticating.
				</p><p>
					A digest mechanism is simply an authentication mechanism that authenticates the user by making use of one-time, one-way hashes comprised of various pieces of information including information stored in the users/passwords mapping property file. This allows JBoss EAP to authenticate users without sending any passwords in plain text over the network.
				</p><p>
					A script is included with the JBoss EAP 6 install which enables administrators to add users to both realms. When users are added in this way, the username and hashed password are stored in the corresponding users/passwords properties file. When a user attempts to authenticate, JBoss EAP sends back a one-time use number (nonce) to the client. The client then generates a one-way hash using their username, password, nonce and a few other fields, and then sends back to JBoss EAP the username, nonce and one-way hash. JBoss EAP then looks up the user’s pre-hashed password and uses it along with the provided username and nonce and few other fields to generate another one-way hash in the same manner. If all the same information is used (e.g. correct password) on both sides then hashes will match and the user is authenticated.
				</p><p>
					Though security realms use the digest mechanism by default, they may be reconfigured to use other authentication mechanisms as well. On startup, the management interfaces determine which authentication mechanisms will be enabled based on what authentication mechanisms are configured in <span class="emphasis"><em>ManagementRelam</em></span>.
				</p><p>
					Security realms are not involved in any authorization decisions, however they can be configured to load a user’s group membership information which can subsequently be used to make authorization decisions. After a user has been authenticated, a second step will occur to load the group membership information based on the username.
				</p><p>
					By default, the <span class="emphasis"><em>ManagementRealm</em></span> is used during authentication and authorization for the management interfaces. The <span class="emphasis"><em>ApplicationRealm</em></span> is a default realm made available for web applications and EJBs to use when authenticating and authorizing users.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="security_domains"/>Security Domains</h2></div></div></div><p>
					A security domain is a set of Java Authentication and Authorization Service (JAAS) declarative security configurations which one or more applications use to control authentication, authorization, auditing, and mapping. Three security domains are included by default: <span class="emphasis"><em>jboss-ejb-policy</em></span>, <span class="emphasis"><em>jboss-web-policy</em></span>, and <span class="emphasis"><em>other</em></span>. <span class="emphasis"><em>jboss-ejb-policy</em></span> and <span class="emphasis"><em>jboss-web-policy</em></span> are the default authorization mechanisms that are used if an application’s configured security domain has none. Those security domains along with <span class="emphasis"><em>other</em></span> are also used internally within JBoss EAP for authorization and are therefore required for correct operation.
				</p><p>
					A security domain consists of configurations for authentication, authorization, security mapping, and auditing. Security domains are part of the JBoss EAP 6 security subsystem and are managed centrally by the domain controller or standalone server. Users can create as many security domains as needed to accommodate application requirements.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="using_security_realms_and_security_domains"/>Using Security Realms and Security Domains</h2></div></div></div><p>
					Both security realms and security domains can be used as a part of securing web applications deployed to JBoss EAP. When deciding if either should be used, it’s important to understand the difference between the two.
				</p><p>
					Web applications and EJB deployments can only use Security Domains directly. They perform the actual authentication and authorization via login modules using the identity information passed from an identity store. Security domains can be configured to use Security Realms for identity information (e.g. <span class="emphasis"><em>other</em></span> allows applications to specify a security realm to use for authentication and getting authorization information), but they may also be configured to use external identity stores. Web applications and EJB deployments cannot be configured to directly use Security Realms for authentication. The security domains are also part of the security subsystem and are therefore loaded after core services.
				</p><p>
					Only the core management (e.g. the management interfaces) and the EJB remoting end points can use the Security Realms directly. They are identity stores that provide authentication as well as authorization information. They are also a core service and are loaded before any subsystems are started. The out of the box Security Realms (<span class="emphasis"><em>ManagementRealm</em></span> and <span class="emphasis"><em>ApplicationRealm</em></span>) use a simple file-based authentication mechanism, but they can be configured to use other mechanisms.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="security_auditing"/>Security Auditing</h2></div></div></div><p>
					Security auditing refers to triggering events, such as writing to a log, in response to an event that happens within the security subsystem. Auditing mechanisms are configured as part of a security domain, along with authentication, authorization, and security mapping details. Auditing uses provider modules to control the way that security events are reported. JBoss EAP ships with several secuirty auditing providers, but custom ones may be used as well. In addition, the core management of JBoss EAP also has its own security auditing and logging functionality which is configure separately and is not part of the security subsystem.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="security_mapping"/>Security Mapping</h2></div></div></div><p>
					Security mapping adds the ability to combine authentication and authorization information after the authentication or authorization happens, but before the information is passed to your application. Roles (authorization), principals (authentication), or credentials (attributes which are not principals or roles) may all be mapped. Role Mapping is used to add, replace, or remove roles to the subject after authentication. Principal mapping is used to modify a principal after authentication. Credential (attribute) mapping is used to convert attributes from an external system to be used by your application, and vice versa.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="jmx"/>JMX</h2></div></div></div><p>
					Java Management Extensions (JMX) provides a way to remotely trigger JDK and application management operations. The Management API of JBoss EAP 6 is exposed as JMX Managed Beans. These Managed Beans are referred to as <span class="emphasis"><em>core mbeans</em></span> and access to them is controlled and filtered exactly the same as the underlying Management API itself.
				</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						Prior to JBoss EAP 6, the management functionality was primarily JMX based, meaning the management functionality relied on these JMX exposed beans to perform operations. With JBoss EAP 6, the core management does not rely on them to perform operations. JMX exposed beans are now just alternative mechanism (in addition to the native and http interfaces) to access and perform management operations.
					</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="role_based_access_control"/>Role-Based Access Control</h2></div></div></div><p>
					Role-Based Access Control (RBAC) is a mechanism for specifying a set of permissions for management users. It allows multiple users to share responsibility for managing JBoss EAP 6 servers without each of them requiring unrestricted access. By providing a <span class="emphasis"><em>separation of duties</em></span> for management users, JBoss EAP 6 makes it easy for an organization to spread responsibility between individuals or groups without granting unnecessary privileges. This ensures the maximum possible security of your servers and data while still providing flexibility for configuration, deployment, and management.
				</p><p>
					Role-Based Access Control in JBoss EAP 6 works through a combination of role permissions and constraints. Seven predefined roles are provided that each have different fixed permissions. Each management user is assigned one or more roles, which specify what the user is permitted to do when managing the server.
				</p><p>
					Role-Based Access Control is supported by JBoss EAP 6.2 and above, but is disabled by default.
				</p><div class="title"><strong>Standard Roles</strong></div><p>
						JBoss EAP 6 provides seven predefined user roles: <span class="emphasis"><em>Monitor</em></span>, <span class="emphasis"><em>Operator</em></span>, <span class="emphasis"><em>Maintainer</em></span>, <span class="emphasis"><em>Deployer</em></span>, <span class="emphasis"><em>Auditor</em></span>, <span class="emphasis"><em>Administrator</em></span>, and <span class="emphasis"><em>SuperUser</em></span>. Each of these roles has a different set of permissions and is designed for specific use cases. The <span class="emphasis"><em>Monitor</em></span>, <span class="emphasis"><em>Operator</em></span>, <span class="emphasis"><em>Maintainer</em></span>, <span class="emphasis"><em>Administrator</em></span>, and <span class="emphasis"><em>SuperUser</em></span> role each build successively upon each other, with each having more permissions than the previous. The <span class="emphasis"><em>Auditor</em></span> and <span class="emphasis"><em>Deployer</em></span> roles are similar to the <span class="emphasis"><em>Monitor</em></span> and <span class="emphasis"><em>Maintainer</em></span> roles respectively but have some additional special permissions and restrictions.
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Monitor</span></dt><dd>
								Users of the Monitor role have the fewest permissions and can only read the current configuration and state of the server. This role is intended for users who need to track and report on the performance of the server. Monitors cannot modify server configuration nor can they access sensitive data or operations.
							</dd><dt><span class="term">Operator</span></dt><dd>
								The Operator role extends the Monitor role by adding the ability to modify the runtime state of the server. This means that Operators can reload and shutdown the server as well as pause and resume JMS destinations. The Operator role is ideal for users who are responsible for the physical or virtual hosts of the application server so they can ensure that servers can be shutdown and restarted corrected when needed. Operators cannot modify server configuration or access sensitive data or operations.
							</dd><dt><span class="term">Maintainer</span></dt><dd>
								The Maintainer role has access to view and modify runtime state and all configuration except sensitive data and operations. The Maintainer role is the general purpose role that doesn’t have access to sensitive data and operation. The Maintainer role allows users to be granted almost complete access to administer the server without giving those users access to passwords and other sensitive information. Maintainers cannot access sensitive data or operations.
							</dd><dt><span class="term">Administrator</span></dt><dd>
								The Administrator role has unrestricted access to all resources and operations on the server except the audit logging system. The Administrator role has access to sensitive data and operations. This role can also configure the access control system. The Administrator role is only required when handling sensitive data or configuring users and roles. Administrators cannot access the audit logging system and cannot change themselves to the Auditor or SuperUser role.
							</dd><dt><span class="term">SuperUser</span></dt><dd>
								The SuperUser role has no restrictions and has complete access to all resources and operations of the server including the audit logging system. This role is equivalent to the administrator users of earlier versions of JBoss EAP 6 (6.0 and 6.1). If RBAC is disabled, all management users have permissions equivalent to the SuperUser role.
							</dd><dt><span class="term">Deployer</span></dt><dd>
								The Deployer role has the same permissions as the Monitor, but can modify configuration and state for deployments and any other resource type enabled as an application resource.
							</dd><dt><span class="term">Auditor</span></dt><dd>
								The Auditor role has all the permissions of the Monitor role and can also view (but not modify) sensitive data, and has full access to the audit logging system. The Auditor role is the only role other than SuperUser that can access the audit logging system. Auditors cannot modify sensitive data or resources. Only read access is permitted.
							</dd></dl></div><div class="title"><strong>Permissions</strong></div><p>
						What each role is allowed to do is defined by what permissions it has. Not every role has every permission. Notably SuperUser has every permission and Monitor has the least. Each permission can grant read and/or write access for a single category of resources. The categories are: runtime state, server configuration, sensitive data, the audit log, and the access control system.
					</p><div class="table"><a id="idm140170671978336"/><p class="title"><strong>Table 2.1. Permissions of Each Role</strong></p><div class="table-contents"><table summary="Permissions of Each Role" border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/><col class="col_4"/><col class="col_5"/><col class="col_6"/><col class="col_7"/><col class="col_8"/></colgroup><thead><tr><th style="text-align: left" valign="top"> </th><th style="text-align: left" valign="top">Monitor</th><th style="text-align: left" valign="top">Operator</th><th style="text-align: left" valign="top">Maintainer</th><th style="text-align: left" valign="top">Deployer</th><th style="text-align: left" valign="top">Auditor</th><th style="text-align: left" valign="top">Administrator</th><th style="text-align: left" valign="top">SuperUser</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									Read Config and State
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Read Sensitive Data <sup>2</sup>
								</p>
								 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Modify Sensitive Data <sup>2</sup>
								</p>
								 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Read/Modify Audit Log
								</p>
								 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Modify Runtime State
								</p>
								 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X<sup>1</sup>
								</p>
								 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Modify Persistent Config
								</p>
								 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X<sup>1</sup>
								</p>
								 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Read/Modify Access Control
								</p>
								 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									X
								</p>
								 </td></tr></tbody></table></div></div><p>
					<sup>1</sup> permissions are restricted to application resources.
				</p><p>
					<sup>2</sup> What resources are considered to be "sensitive data" are configured using Sensitivity
				</p><div class="title"><strong>Constraints</strong></div><p>
						Constraints are named sets of access-control configuration for a specified list of resources. The RBAC system uses the combination of constraints and role permissions to determine if any specific user can perform a management action.
					</p><p>
					Constraints are divided into three classifications:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Application Constraints</span></dt><dd>
								Application Constraints define sets of resources and attributes that can be accessed by users of the Deployer role. By default the only enabled Application Constraint is core which includes deployments, deployment overlays. Application Constraints are also included (but not enabled by default) for datasources, logging, mail, messaging, naming, resource-adapters and security. These constraints allow Deployer users to not only deploy applications but also configure and maintain the resources that are required by those applications.
							</dd><dt><span class="term">Sensitivity Constraints</span></dt><dd>
								Sensitivity Constraints define sets of resources that are considered <span class="emphasis"><em>sensitive</em></span>. A sensitive resource is generally one that is either secret, like a password, or one that will have serious impact on the operation of the server, like networking, JVM configuration, or system properties. The access control system itself is also considered sensitive. The only roles permitted to write to sensitive resources are Administrator and SuperUser. The Auditor role is only able to read sensitive resources. No other roles have access.
							</dd><dt><span class="term">Vault Expression Constraint</span></dt><dd>
								The Vault Expression constraint defines if reading or writing vault expressions is consider a sensitive operation. By default both reading and writing vault expressions is a sensitive operation.
							</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="declarative_security_and_jaas"/>Declarative Security and JAAS</h2></div></div></div><p>
					Declarative security is a method to separate security concerns from application code by using the container to manage security. The container provides an authorization system based on either file permissions or users, groups, and roles. This approach is usually superior to programmatic security, which gives the application itself all of the responsibility for security. JBoss EAP 6 provides declarative security via security domains in the Security Subsystem.
				</p><p>
					<span class="emphasis"><em>Java Authentication and Authorization Service</em></span> (JAAS) is a declarative security API which consists of a set of Java packages designed for user authentication and authorization. The API is a Java implementation of the standard Pluggable Authentication Modules (PAM) framework. It extends the Java EE access control architecture to support user-based authorization. The JBoss EAP 6 security subsystem is actually based on the JAAS API.
				</p><p>
					Since JAAS is the foundation for the security subsystem, authentication is performed in a pluggable fashion. This permits Java applications to remain independent from underlying authentication technologies, such as Kerberos or LDAP, and allows the security manager to work in different security infrastructures. Integration with a security infrastructure is achievable without changing the security manager implementation. Only the configuration of the authentication stack JAAS uses needs to be changed.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="core_management_authentication"/>Core Management Authentication</h1></div></div></div><p>
				Core Management Authentication is responsible for securing the Management Interfaces (HTTP and Native) for the core management functionality using the <span class="emphasis"><em>ManagementRealm</em></span>. It is built into the core management and is enabled and configured as a core service by default. It is only responsible for securing the Management Interfaces.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="default_security"/>Default Security</h2></div></div></div><p>
					By default, the Core Management Authentication secures each of the Management Interfaces (HTTP and Native) in two different forms: local clients and remote clients, both of which are configured using the <span class="emphasis"><em>ManagementRealm</em></span> security realm by default. These defaults may be configured differently or replaced entirely. In addition to securing the Management Interfaces, the HTTP and Native interfaces may each be disabled.
				</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
						Out of the box, the Management Interfaces are configured to use simple access controls, which does not use roles. As a result, all users by default (when using simple access controls) have the same privileges as the SuperUser Role, which essentially has access to everything.
					</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="local_and_remote_client_authentication_with_the_native_interface"/>Local and Remote Client Authentication with the Native Interface</h3></div></div></div><p>
						The Native Interface (CLI) can be invoked on the same host as the running JBoss EAP instance (local) or from another machine with the <code class="literal">jboss-cli</code> script (remote). When attempting to connect via the Native Interface, JBoss EAP presents the client with a list of available SASL authentication mechanisms (e.g. local jboss user, BASIC, etc). The client chooses its desired authentication mechanism and attempts to authenticate with the JBoss EAP instance. If it fails, it retries with any remaining mechanisms or stops attempting to connect. Local clients have the option to use the <span class="emphasis"><em>local jboss user</em></span> authentication mechanism. This security mechanism is based on the client’s ability to access the local filesystem. It simply validates that the user attempting to log in actually has access to the local filesystem on the same host as the JBoss EAP instance.
					</p><div class="orderedlist"><p class="title"><strong>This authentication mechanism happens in four steps:</strong></p><ol class="orderedlist"><li class="listitem">
								The client sends a message to the server which includes a request to authenticate using <span class="emphasis"><em>local jboss user</em></span>.
							</li><li class="listitem">
								The server generates a one-time token, writes it to a unique file, and sends a message to the client with the full path of the file.
							</li><li class="listitem">
								The client reads the token from the file and sends it to the server, verifying that it has local access to the filesystem.
							</li><li class="listitem">
								The server verifies the token and then deletes the file.
							</li></ol></div><p>
						This form of authentication is based on the principle that if physical access to the filesystem is achieved, other security mechanisms are superfluous. The reasoning being that if a user has local filesystem access, that user has enough access to create a new user or otherwise thwart other security mechanism put in place. This is sometimes referred to as <span class="emphasis"><em>Silent Authentication</em></span> since it allows the local user the ability to access the Management CLI without username or password authentication.
					</p><p>
						This functionality is enabled as a convenience, and to assist local users running Management CLI scripts without requiring additional authentication. It is considered a useful feature given that access to the local configuration typically also gives the user the ability to add their own user details or otherwise disable security checks.
					</p><p>
						The Native Interface can also be accessed from other servers (or even the same server) as a remote client. When accessing the Native Interface as a remote client, clients will not be able to authenticate using <span class="emphasis"><em>local jboss user</em></span> and will be forced another authentication mechanism (e.g. DIGEST). If a local client fails to authenticate via <span class="emphasis"><em>local jboss user</em></span> it will automatically fall back and attempt to use the other mechanisms as a remote client.
					</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
							The Management CLI may also be invoked from other servers (or even the same server) using the HTTP interface as apposed to the native interface. All HTTP connections (CLI or otherwise) are considered to be remote and <span class="strong"><strong>NOT</strong></span> covered by local interface authentication.
						</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="local_and_remote_client_authentication_with_the_http_interface"/>Local and Remote Client Authentication with the HTTP Interface</h3></div></div></div><p>
						The HTTP Interface can be invoked by clients on the same host as the same host as the running JBoss EAP instance (local) or by clients from another machine (remote). Despite allowing both local and remote clients to access the HTTP interface, all clients accessing the HTTP interface, are treated as remote connections.
					</p><p>
						When a client attempts to connect to the HTTP management interfaces, JBoss EAP sends back an HTTP response with a status code of 401 (requires authentication) and a set of headers that list the supported authentication mechanisms (e.g. Digest, GSSAPI, etc). The header for Digest also includes the nonce generated by JBoss EAP. The client then looks at the headers and chooses which authentication method to use and sends an appropriate response. In the case where the client chooses Digest, it prompts the user for their username and password. The client then uses the supplied fields (e.g. username and password), the nonce, and a few other pieces of information to generate a one-way hash. The client then sends the one-way hash, username, and nonce back to JBoss EAP as a response. JBoss EAP then takes that information, generates another one-way hash, compares to the two, and authenticates the user based on the result.
					</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="advanced_security"/>Advanced Security</h2></div></div></div><p>
					There are a number of ways to change the default configuration of Management Interfaces as well as the Authentication/Authorization mechanisms to affect how it is secured.
				</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="updating_the_management_interfaces"/>Updating the Management Interfaces</h3></div></div></div><p>
						In addition to modifying the Authentication and Authorization mechanisms, JBoss EAP 6 allows administrators to update the configuration of the Management Interface itself. There are a number of options:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Configuring the Management Interfaces to use HTTPS</span></dt><dd>
									Configuring the JBoss EAP management console for communication only via HTTPS provides increased security. All network traffic between the client and management console is encrypted, which reduces the risk of security attacks such as a man-in-the-middle attack. Anyone administering a JBoss EAP instance has greater permissions on that instance than non-privileged users, and using HTTPS helps protect the integrity and availability of that instance. When configuring HTTPS with JBoss EAP 6, authority-signed certificates are preferred over self-signed certificates since they provide a chain of trust. Self-signed certificates are still permitted but not recommended.
								</dd><dt><span class="term">Using 2-way SSL/TLS</span></dt><dd>
									2-way SSL/TLS authentication, also known as client authentication, authenticates both the client and the server using SSL/TLS certificates. This provides assurance that not only is the server who it says it is, but the client is also who it says it is.
								</dd><dt><span class="term">Using Distinct Network Interfaces for HTTP and HTTPS Traffic</span></dt><dd>
									The Management Interface can listen on distinct network interfaces for HTTP and HTTPS connections. For instance, an administrator may want to configure an external interface to listen for HTTPS traffic only while the internal-facing interface can accept HTTP traffic. If a server listens for HTTP and HTTPS traffic on the same interface, HTTPS requests received by the HTTP listener are automatically redirected to the HTTPS port. When distinct interfaces are used for HTTP and HTTPS traffic, no redirection is performed when an HTTPS request is received by the HTTP listener.
								</dd><dt><span class="term">Disabling Management Interfaces</span></dt><dd>
									In certain instances, such as with managed domains or when using other management clients such as JBoss Operations Network, administrators may wish disable the HTTP interface, the Native interface, or the Web Console. Each of these interfaces may be disabled or removed entirely.
								</dd></dl></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
							The native interface is used by JBoss EAP 6 when running in domain mode for several purposes, including communication with slave domain controllers. As a result, the native interface should not be disabled when running in domain mode.
						</p></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Updating or Creating a New Security Realm</span></dt><dd>
									The default security realm can be updated or replaced with a new security realm.
								</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="adding_outbound_connections"/>Adding Outbound Connections</h3></div></div></div><p>
						Some security realms connect to external interfaces, such as an LDAP server. An outbound connection defines how to make this connection. A pre-defined connection type, <span class="emphasis"><em>ldap-connection</em></span>, sets all of the required and optional attributes to connect to the LDAP server and verify the credential.
					</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="adding_rbac_to_the_management_interfaces"/>Adding RBAC to the Management Interfaces</h3></div></div></div><p>
						By default the <span class="emphasis"><em>Role-Based Access Control</em></span> (RBAC) system is disabled. It is enabled by changing the provider attribute from <span class="emphasis"><em>simple</em></span> to <span class="emphasis"><em>rbac</em></span>. This can be done using the jboss-cli script. When RBAC is disabled or enabled on a running server, the server configuration must be reloaded before it takes effect.
					</p><p>
						When RBAC is enabled for the management interfaces, the role assigned to a user determines the resources to which they have access and what operations they can conduct with a resource’s attributes. Only users of the <span class="emphasis"><em>Administration</em></span> or <span class="emphasis"><em>SuperUser</em></span> role can view and make changes to the access control system.
					</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
							Enabling RBAC without having users and roles properly configured could result in administrators being unable to login to the management interfaces.
						</p></div><div class="title"><strong>RBAC’s Effect on the Management Console (Web Console)</strong></div><p>
							In the management console some controls and views are disabled (greyed out) or not visible at all depending on the permissions of the role to which the user has been assigned.
						</p><p>
						If the user does not have read permissions to a resource attribute, that attribute will appear blank in the console. For example, most roles cannot read the username and password fields for datasources.
					</p><p>
						If the user has read permissions but does not have write permissions to a resource attribute, that attribute will be disabled (greyed-out) in the edit form for the resource. If the user does not have write permissions to the resource, then the edit button for the resource will not appear.
					</p><p>
						If a user does not have permissions to access a resource or attribute (it is <span class="emphasis"><em>unaddressable</em></span> for that role), it will not appear in the console for that user. An example of that is the access control system itself which is only visible to a few roles by default.
					</p><p>
						The management console also provides an interface for the following common RBAC tasks:
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								View and configure what roles are assigned to (or excluded from) each user
							</li><li class="listitem">
								View and configure what roles are assigned to (or excluded from) each group
							</li><li class="listitem">
								View group and user membership per role.
							</li><li class="listitem">
								Configure default membership per role.
							</li><li class="listitem">
								Create a scoped role
							</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
							Constraints <span class="strong"><strong>cannot</strong></span> be configured in the Management Console at this time.
						</p></div><div class="title"><strong>RBAC’s Effect on the Management CLI or API (HTTP and Native)</strong></div><p>
							Users of the jboss-cli script or management API will encounter slightly different behavior in the API when RBAC is enabled.
						</p><p>
						Resources and attributes that cannot be read are filtered from results. If the filtered items are addressable by the role, their names are listed as filtered-attributes in the response-headers section of the result. If a resource or attribute is not addressable by the role, it is not listed.
					</p><p>
						Attempting to access a resource that is not addressable will result in a resource not found error.
					</p><p>
						If a user attempts to write or read a resource that they can address but lack the appropriate write or read permissions, a <span class="emphasis"><em>Permission Denied</em></span> error is returned.
					</p><p>
						The management CLI can perform all of same RBAC tasks as the management console as well as a few additional tasks:
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								Enable and disable RBAC
							</li><li class="listitem">
								Change permission combination policy
							</li><li class="listitem">
								Configuring Application Resource and Resource Sensitivity Constraints
							</li></ul></div><div class="title"><strong>RBAC’s Effect on JMX Managed Beans</strong></div><p>
							Role-Based Access Control applies to JMX in three ways:
						</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
								The Management API of JBoss EAP 6 is exposed as JMX Managed Beans. These Managed Beans are referred to as <span class="emphasis"><em>core mbeans</em></span> and access to them is controlled and filtered exactly the same as the underlying Management API itself.
							</li><li class="listitem">
								The JMX subsystem is configured with write permissions being <span class="emphasis"><em>sensitive</em></span>. This means only users of the <span class="emphasis"><em>Administrator</em></span> and <span class="emphasis"><em>SuperUser</em></span> roles can make changes to that subsystem. Users of the <span class="emphasis"><em>Auditor</em></span> role can also read this subsystem configuration.
							</li><li class="listitem">
								By default Managed Beans registered by deployed applications and services (non-core mbeans) can be accessed by all management users, but only users of the <span class="emphasis"><em>Maintainer</em></span>, <span class="emphasis"><em>Operator</em></span>, <span class="emphasis"><em>Administrator</em></span>, and <span class="emphasis"><em>SuperUser</em></span> roles can write to them.
							</li></ol></div><div class="title"><strong>RBAC Authentication</strong></div><p>
							Role-Based Access Control works with the standard authentication providers that are included with JBoss EAP 6 :
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Username/Password</span></dt><dd>
									Users are authenticated using a username and password combination which is verified according to the settings of the <span class="emphasis"><em>ManagementRealm</em></span>, which has the ability to use a local properties file or LDAP.
								</dd><dt><span class="term">Client Certificate</span></dt><dd>
									Using the Trust Store.
								</dd><dt><span class="term">Local User</span></dt><dd>
									jboss-cli script authenticates automatically as <span class="emphasis"><em>Local User</em></span> if the server that is running on the same machine. By default <span class="emphasis"><em>Local User</em></span> is a member of the <span class="emphasis"><em>SuperUser</em></span> group.
								</dd></dl></div><p>
						Regardless of which provider is used, JBoss EAP is responsible for the assignment of roles to users. However when authenticating with the <span class="emphasis"><em>ManagementRealm</em></span> or an LDAP server, those systems can supply user group information. This information can also be used by JBoss EAP to assign roles to users.
					</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="using_ldap_with_the_management_interfaces"/>Using LDAP with the Management Interfaces</h3></div></div></div><p>
						JBoss EAP 6 includes several authentication and authorization modules which allow an LDAP server to be used as the authentication and authorization authority for web and EJB applications.
					</p><p>
						To use an LDAP directory server as the authentication source for the Management Console, Management CLI, or Management API, the following must be done:
					</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem">
								Create an outbound connection to the LDAP server.
							</li><li class="listitem">
								Create an LDAP-enabled security realm or update an existing security realm to use LDAP.
							</li><li class="listitem">
								Reference the new security realm in the Management Interface.
							</li></ol></div><p>
						The LDAP authenticator operates by first establishing a connection to the remote directory server. It then performs a search using the username, which the user passed to the authentication system, to find the fully-qualified distinguished name (DN) of the LDAP record. A new connection to the LDAP server is established, using the DN of the user as the credential and password supplied by the user. If this authentication to the LDAP server is successful, the DN is verified to be valid.
					</p><p>
						Once an LDAP-enabled security realm is created, it can be referenced by the management interface. The management interface will then use the security realm for authentication. JBoss EAP 6 can also be configured to use an outbound connection to a LDAP server using 2-way SSL/TLS for authentication in the Management Interface and CLI.
					</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="jaas_and_the_management_interfaces"/>JAAS and the Management Interfaces</h3></div></div></div><p>
						JAAS can be used to secure the management interfaces. When using JAAS for the management interfaces, the security realm must be configured to use a security domain. This introduces a dependency between core services and the subsystems. In addition, while SSL/TLS is not required to use JAAS to secure the management interfaces, it is heavily recommend that administrators enable SSL/TLS to avoid accidentally transmitting sensitive information in an unsecured manner.
					</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
							When JBoss EAP 6 instances are configured to run in <span class="strong"><strong>ADMIN_ONLY</strong></span> mode, using JAAS to secure the management interfaces is not supported. For more information on <span class="strong"><strong>ADMIN_ONLY</strong></span> mode, please see section <span class="emphasis"><em>Reference of Switches and Arguments to pass at Server Runtime</em></span> of the <a class="link" href="https://access.redhat.com/documentation/en-US/JBoss_Enterprise_Application_Platform/6.4/html-single/Administration_and_Configuration_Guide/index.html#Reference_of_Switches_and_Arguments_to_pass_at_Server_Runtime1">Administration and Configuration Guide</a>.
						</p></div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="security_subsystem"/>Security Subsystem</h1></div></div></div><p>
				The security subsystem provides security infrastructure for applications and is based on the JAAS API. The subsystem uses a security context associated with the current request to expose the capabilities of the authentication manager, authorization manager, audit manager, and mapping manager to the relevant container.
			</p><p>
				The authentication and authorization managers handle authentication and authorization. The mapping manager handles adding, modifying, or deleting information from a principal, role, or attribute before passing the information to your application. The auditing manager allows users to configure provider modules to control the way that security events are reported.
			</p><p>
				In most cases, administrators should only need to focus on setting up and configuring security domains in regards to updating the configuration of the security subsystem. Outside of security domains, the only security element that may need to be changed is whether to use <span class="emphasis"><em>deep-copy-subject-mode</em></span>. In the rare case where security elements do require changes, those configuration changes (as well as <span class="emphasis"><em>deep-copy-subject-mode</em></span>) may be found in the <a class="link" href="how_red_hat_jboss_enterprise_application_platform_6_handles_security_out_of_the_box.html#security-management" title="Security Management">security management</a> portion of the security subsystem.
			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="password_vault_system"/>Password Vault System</h2></div></div></div><p>
					JBoss EAP 6 has a Password Vault to encrypt sensitive strings, store them in an encrypted keystore, and decrypt them for applications and verification systems. In plain-text configuration files, such as XML deployment descriptors, it is sometimes necessary to specify passwords and other sensitive information. The JBoss EAP Password Vault can be used to securely store sensitive strings for use in plain-text files.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="security_domains_2"/>Security Domains</h2></div></div></div><p>
					Security domains are configured centrally either at the domain controller or on the standalone server. When security domains are used, an application may be configured to use a security domain lieu of individually configuring security. This allows users and administrators to leverage <a class="link" href="how_red_hat_jboss_enterprise_application_platform_6_handles_security_out_of_the_box.html#declarative_security_and_jaas" title="Declarative Security and JAAS">declarative security</a>.
				</p><div class="title"><strong>Example</strong></div><p>
						One common scenario that benefits from this type of configuration structure is the process of moving applications between testing and production environments. If an application has it’s security individually configured, it may need to be updated every time its promoted to a new environment (e.g. from a testing environment to a production environment). If that application instead used a security domain, the JBoss EAP instances in the individual environments would have their security domains properly configured for the current environment, allowing the application to rely on the container to provide the proper security configuration (via the security domain).
					</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="login_modules"/>Login Modules</h3></div></div></div><p>
						JBoss EAP 6 includes several bundled login modules suitable for most user management which are configured within a security domain. The security subsystem offers some core login modules that can read user information from a relational database, an LDAP server, or flat files. In addition to these core login modules, JBoss EAP 6 provides other login modules that provide user information and functionality for very customized needs.
					</p><div class="variablelist"><p class="title"><strong>Summary of the login modules commonly used</strong></p><dl class="variablelist"><dt><span class="term">Ldap Login Module</span></dt><dd>
									Ldap login module is a LoginModule implementation that authenticates against an LDAP server. The security subsystem connects to the LDAP server using connection information (i.e. a bindDN that has permissions to search both the baseCtxDN and rolesCtxDN trees for the user and roles) provided using a JNDI initial context. When a user attempts to authenticate, the LDAP login module connects to the LDAP server, and passes the user’s credentials to the LDAP server. Upon successful authentication, an InitialLDAPContext is created for that user within JBoss EAP, populated with the user’s roles.
								</dd><dt><span class="term">LdapExtended Login Module</span></dt><dd>
									The LdapExtended (org.jboss.security.auth.spi.LdapExtLoginModule) login module searches for the user to bind, as well as the associated roles, for authentication. The roles query recursively follows DNs to navigate a hierarchical role structure. The LoginModule options include whatever options are supported by the chosen LDAP JNDI provider supports.
								</dd><dt><span class="term">UsersRoles Login Module</span></dt><dd>
									UsersRoles login module is a simple login module that supports multiple users and user roles loaded from Java properties files. The primary purpose of this login module is to easily test the security settings of multiple users and roles using properties files deployed with the application.
								</dd><dt><span class="term">Database Login Module</span></dt><dd>
									The Database login module is a Java Database Connectivity-based (JDBC) login module that supports authentication and role mapping. This login module is used if user name, password and role information are stored in a relational database. This works by providing a reference to logical tables containing Principals and Roles in the expected format.
								</dd><dt><span class="term">Certificate Login Module</span></dt><dd>
									Certificate login module authenticates users based on X509 certificates. A typical use case for this login module is CLIENT-CERT authentication in the web tier. This login module only performs authentication and must be combined with another login module capable of acquiring authorization roles to completely define access to a secured web or EJB components. Two subclasses of this login module, CertRolesLoginModule and DatabaseCertLoginModule extend the behavior to obtain the authorization roles from either a properties file or database.
								</dd><dt><span class="term">Identity Login Module</span></dt><dd>
									Identity login module is a simple login module that associates a hard-coded user name to any subject authenticated against the module. It creates a SimplePrincipal instance using the name specified by the principal option. This login module is useful when a fixed identity is required to be provided to a service. This can also be used in development environments for testing the security associated with a given principal and associated roles.
								</dd><dt><span class="term">RunAs Login Module</span></dt><dd>
									RunAs login module is a helper module that pushes a run as role onto the stack for the duration of the login phase of authentication, then pops the run as role from the stack in either the commit or abort phase. The purpose of this login module is to provide a role for other login modules that must access secured resources in order to perform their authentication (for example, a login module that accesses a secured EJB). RunAs login module must be configured ahead of the login modules that require a run as role established.
								</dd><dt><span class="term">Client Login Module</span></dt><dd>
									Client login module (org.jboss.security.ClientLoginModule) is an implementation of LoginModule for use by JBoss clients when establishing caller identity and credentials. This creates a new SecurityContext, assigns it a principal and a credential and sets the SecurityContext to the ThreadLocal security context. Client login module is the only supported mechanism for a client to establish the current thread’s caller. Both stand-alone client applications, and server environments (acting as JBoss EJB clients where the security environment has not been configured to use the JBoss EAP security subsystem transparently) must use Client login module.
								</dd></dl></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
							This login module does not perform any authentication. It merely copies the login information provided to it into the server EJB invocation layer for subsequent authentication on the server. Within JBoss EAP 6, this is only supported for the purpose of switching a user’s identity for in-JVM calls. This is <span class="strong"><strong>NOT</strong></span> supported for remote clients to establish an identity.
						</p></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">SPNEGO Login Module</span></dt><dd>
									The SPNEGO login module (org.jboss.security.negotiation.spnego.SPNEGOLoginModule) is an implementation of LoginModule that establishes caller identity and credentials with a KDC. The module implements SPNEGO (Simple and Protected GSSAPI Negotiation mechanism) and is a part of the JBoss Negotiation project. This authentication can be used in the chained configuration with the AdvancedLdap login module to allow cooperation with an LDAP server. Web applications must also enable the NegotiationAuthenticator within the application in order to use this login module.
								</dd><dt><span class="term">RoleMapping Login Module</span></dt><dd>
									The RoleMapping login module supports mapping roles, that are the end result of the authentication process, to one or more declarative roles. For example, if the authentication process has determined that the user <span class="emphasis"><em>John</em></span> has the roles <span class="emphasis"><em>ldapAdmin</em></span> and <span class="emphasis"><em>testAdmin</em></span>, and the declarative role defined in the <span class="strong"><strong>web.xml</strong></span> or <span class="strong"><strong>ejb-jar.xml</strong></span> file for access is <span class="emphasis"><em>admin</em></span>, then this login module maps the admin roles to <span class="emphasis"><em>John</em></span>. The RoleMapping login module must be defined as an optional module to a login module configuration as it alters mapping of the previously mapped roles.
								</dd><dt><span class="term">Remoting Login Module</span></dt><dd>
									The Remoting login module checks if the request that is currently being authenticated was received over the Remoting connection. In cases where the request was received via the remoting interface, that request is associated with the identity created during the authentication process.
								</dd><dt><span class="term">Realm Direct Login Module</span></dt><dd>
									The Realm Direct login module allows for the use of an existing security realm to be used in making authentication and authorization decisions. When configured, this module will look up identity information using the referenced realm for making authentication decisions and mapping user roles. For example, the pre-configured <span class="emphasis"><em>other</em></span> security domain that ships with JBoss EAP 6 has a Realm Direct login module. If no realm is referenced in this module, the <span class="emphasis"><em>ApplicationRealm</em></span> security realm is used by default.
								</dd><dt><span class="term">Custom Modules</span></dt><dd>
									In cases where the login modules bundled with the JBoss EAP security framework do not meet the needs of the security environment, a custom login module implementation may be written. The AuthenticationManager requires a particular usage pattern of the Subject principals set. A full understanding of the JAAS Subject class’s information storage features and the expected usage of these features are required to write a login module that works with the AuthenticationManager.
								</dd></dl></div><p>
						In addition, the <span class="emphasis"><em>Unauthenticated Identity</em></span> login module option is also commonly used. There are certain cases where requests are not received in an authenticated format. <span class="emphasis"><em>unauthenticatedIdentity</em></span> is a login module configuration option that assigns a specific identity (<span class="emphasis"><em>guest</em></span>, for example) to requests that are made with no associated authentication information. This can be used to allow unprotected servlets to invoke methods on EJBs that do not require a specific role. Such a principal has no associated roles and so can only access either unsecured EJBs or EJB methods that are associated with the unchecked permission constraint.
					</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="password_stacking"/>Password Stacking</h3></div></div></div><p>
						Multiple login modules can be chained together in a stack, with each login module providing both the credentials verification and role assignment during authentication. This works for many use cases, but sometimes credentials verification and role assignment are split across multiple user management stores.
					</p><p>
						Consider the case where users are managed in a central LDAP server but application-specific roles are stored in the application’s relational database. The password-stacking module option captures this relationship.
					</p><p>
						To use password stacking, each login module should set the <span class="emphasis"><em>password-stacking</em></span> attribute to <span class="emphasis"><em>useFirstPass</em></span>, which is located in the <span class="emphasis"><em>&lt;module-option&gt;</em></span> section. If a previous module configured for password stacking has authenticated the user, all the other stacking modules will consider the user authenticated and only attempt to provide a set of roles for the authorization step.
					</p><p>
						When password-stacking option is set to <span class="emphasis"><em>useFirstPass</em></span>, this module first looks for a shared user name and password under the property names <span class="emphasis"><em>javax.security.auth.login.name</em></span> and <span class="emphasis"><em>javax.security.auth.login.password</em></span> respectively in the login module shared state map.
					</p><p>
						If found, these properties are used as the principal name and password. If not found, the principal name and password are set by this login module and stored under the property names <span class="emphasis"><em>javax.security.auth.login.name</em></span> and <span class="emphasis"><em>javax.security.auth.login.password</em></span> respectively.
					</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="password_hashing"/>Password Hashing</h3></div></div></div><p>
						Most login modules must compare a client-supplied password to a password stored in a user management system. These modules generally work with plain text passwords, but can be configured to support hashed passwords to prevent plain text passwords from being stored on the server side. JBoss EAP 6 supports the ability to configure the hashing algorithm, encoding, and character set as well as when the user password and store password are hashed.
					</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
							Red Hat JBoss Enterprise Application Platform Common Criteria certified configuration does not support hash algorithms weaker than SHA-256.
						</p></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="security-management"/>Security Management</h2></div></div></div><p>
					The security management portion of the security subsystem is used to override the high-level behaviors of the security subsystem. Each setting is optional. It is unusual to change any of these settings except for deep copy subject mode.
				</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="deep_copy_mode"/>Deep Copy Mode</h3></div></div></div><p>
						If deep copy subject mode is disabled (the default), copying a security data structure makes a reference to the original, rather than copying the entire data structure. This behavior is more efficient, but is prone to data corruption if multiple threads with the same identity clear the subject by means of a flush or logout operation.
					</p><p>
						If deep copy subject mode is enabled, a complete copy of the data structure along with and all its associated data is made (as long as they are marked cloneable). This is more thread-safe, but less efficient.
					</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="additional_components"/>Additional Components</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="jaspi"/>JASPI</h3></div></div></div><p>
						Java Authentication SPI for Containers (JASPI or JASPIC) is a pluggable interface for Java applications and is defined in <a class="link" href="http://www.jcp.org/en/jsr/detail?id=196">JSR-196</a>. In addition to JAAS authentication, JBoss EAP 6 also allows for JASPI authentication to be used. JASPI authentication is configured using login modules in a security domain and those modules may be stacked. The web-based management console does not expose the configuration of JASPI authentication modules. In addition, applications deployed to JBoss EAP 6 require a special authenticator to be configured in their deployment descriptor to use JASPI security domains.
					</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="jacc"/>JACC</h3></div></div></div><p>
						Java Authorization Contract for Containers (JACC) is a standard which defines a contract between containers and authorization service providers, which results in the implementation of providers for use by containers. It was defined in <a class="link" href="http://jcp.org/en/jsr/detail?id=115">JSR-115</a> and has been part of the core Java EE specification since version 1.3.
					</p><p>
						JBoss EAP 6 implements support for JACC within the security functionality of the security subsystem.
					</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="about_fine_grained_authorization_and_xacml"/>About Fine Grained Authorization and XACML</h3></div></div></div><p>
						Fine Grained Authorization caters to the changing requirements and multiple variables involved in the decision making process, which becomes the basis of providing authorization for accessing a module. Hence, the process of Fine Grained Authorization is complex in itself.
					</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
							The XACML bindings (web, ejb) are not supported in JBoss EAP 6.
						</p></div><p>
						JBoss EAP uses XACML as a medium to achieve Fine Grained Authorization. XACML provides standards based solution to the complex nature of achieving Fine Grained Authorization. XACML defines a policy language and an architecture for decision making. The XACML architecture includes a Policy Enforcement Point (PEP), which intercepts any requests in a normal program flow, then asks a Policy Decision Point (PDP) to make an access decision based on the policies associated with the PDP. The PDP evaluates the XACML request created by the PEP and runs through the policies to make one of the following access decisions:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">PERMIT</span></dt><dd>
									The access is approved.
								</dd><dt><span class="term">DENY</span></dt><dd>
									The access is denied.
								</dd><dt><span class="term">INDETERMINATE</span></dt><dd>
									There is an error at the PDP.
								</dd><dt><span class="term">NOTAPPLICABLE</span></dt><dd>
									There is some attribute missing in the request or there is no policy match.
								</dd></dl></div><div class="itemizedlist"><p class="title"><strong>XAMCL also has the following features:</strong></p><ul class="itemizedlist"><li class="listitem">
								Oasis XACML v2.0 library
							</li><li class="listitem">
								JAXB v2.0 based object model
							</li><li class="listitem">
								ExistDB Integration for storing/retrieving XACML Policies and Attributes
							</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sso"/>SSO</h3></div></div></div><p>
						JBoss EAP 6 provides out of the box support for both clustered and non-clustered SSO via the web and Infinispan subsystems. This requires the following:
					</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
								A configured security domain which handles authentication and authorization.
							</li><li class="listitem">
								The <span class="emphasis"><em>SSO</em></span> infinispan replication cache. It is present in the <span class="emphasis"><em>ha</em></span> and <span class="emphasis"><em>full-ha</em></span> profiles for a managed domain, or by using the <span class="emphasis"><em>standalone-ha</em></span> or <span class="emphasis"><em>standalone-full-ha</em></span> profile for a standalone server.
							</li><li class="listitem">
								The <span class="emphasis"><em>web</em></span> cache-container and <span class="emphasis"><em>SSO</em></span> replication cache within it must each be present.
							</li><li class="listitem">
								The <span class="emphasis"><em>web</em></span> subsystem needs to be configured to use SSO.
							</li><li class="listitem">
								Each application which will share the SSO information must be configured to use the same security domain.
							</li></ul></div></div></div></div></div></body></html>