<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 4. Example Scenarios</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="example_scenarios"/>Chapter 4. Example Scenarios</h1></div></div></div><p>
			One way of understanding how JBoss EAP security and its components work together is to view in context of real scenarios. The following sections cover several generalized but realistic situations that involve the various JBoss EAP security components and configuration options. They will focus on how an application or set of applications is secured as well as how the management interfaces are secured.
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="red_hat_jboss_enterprise_application_platform_out_of_the_box"/>Red Hat JBoss Enterprise Application Platform Out of the Box</h1></div></div></div><p>
				This scenario shows how JBoss EAP and a sample application are secured when no configuration changes are made after the initial install. An application (<span class="emphasis"><em>sampleApp1.war</em></span>) is deployed and configured to use container-based security.
			</p><p>
				<span class="inlinemediaobject"><img src="images/scenario1.png" width="600" alt="scenario1"/></span>

			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="core_management_authentication_out_of_the_box"/>Core Management Authentication Out of the Box</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="security"/>Security</h3></div></div></div><p>
						The core management authentication offers two pre-configured security realms by default: <span class="emphasis"><em>ManagementRealm</em></span> and <span class="emphasis"><em>ApplicationRealm</em></span>. These realms use property files to store the usernames, passwords, and roles. The <span class="emphasis"><em>ManagementRealm</em></span>, which is used to store the authentication information the management APIs, also defines and enables local authentication for users using the CLI interface on the same host as the JBoss EAP instance. The <span class="emphasis"><em>ApplicationRealm</em></span> is also pre-configured to store authentication and authorization information, but for use with other applications besides the management APIs. In addition, <span class="emphasis"><em>ApplicationRealm</em></span> does come pre-configured with local authentication enabled but is not commonly used.
					</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="how_it_works"/>How it works</h3></div></div></div><p>
						For this scenario, the following users have been added to a default installation of JBoss EAP:
					</p><div class="table"><a id="idm140170683400128"/><p class="title"><strong>Table 4.1. Users</strong></p><div class="table-contents"><table summary="Users" border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/><col class="col_4"/></colgroup><thead><tr><th style="text-align: left" valign="top">Username</th><th style="text-align: left" valign="top">Password</th><th style="text-align: left" valign="top">Roles</th><th style="text-align: left" valign="top">Security Realm</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
										Susan
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>Testing123!</em></span>
									</p>
									 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
										ManagementRealm
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										Sarah
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>Testing123!</em></span>
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										sample
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										ApplicationRealm
									</p>
									 </td></tr><tr><td style="text-align: left" valign="top"> <p>
										Frank
									</p>
									 </td><td style="text-align: left" valign="top"> <p>
										<span class="emphasis"><em>Testing123!</em></span>
									</p>
									 </td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top"> <p>
										ApplicationRealm
									</p>
									 </td></tr></tbody></table></div></div><p>
						On startup, the JBoss EAP instance loads both the <span class="emphasis"><em>ManagementRealm</em></span> and <span class="emphasis"><em>ApplicationRealm</em></span> security realms.
					</p><p>
						If <span class="emphasis"><em>Susan</em></span> attempts to access either of the management APIs (HTTP or CLI), she is required to authenticate. Her username, password, and roles must match an entry in the <span class="emphasis"><em>ManagementRealm</em></span> security realm. By default, no roles are required to access the management APIs. <span class="emphasis"><em>Sarah</em></span> and <span class="emphasis"><em>Frank</em></span> would not be able to access the management APIs since they are not in the <span class="emphasis"><em>ManagementRealm</em></span> security realm.
					</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="security_subsystem_out_of_the_box"/>Security Subsystem Out of the Box</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="security_2"/>Security</h3></div></div></div><p>
						The security subsystem also comes pre-configured with three security domains: <span class="emphasis"><em>other</em></span>, <span class="emphasis"><em>jboss-web-policy</em></span>, and <span class="emphasis"><em>jboss-ejb-policy</em></span>. The <span class="emphasis"><em>other</em></span> security domain performs authentication and authorization by delegating to the realm specified in the login module (uses <span class="emphasis"><em>ApplicationRealm</em></span> by default).
					</p><p>
						Additional information about both the default security realms as well as the default security domains can be found in the <a class="link" href="how_red_hat_jboss_enterprise_application_platform_6_handles_security_out_of_the_box.html#security_realms" title="Security Realms">Security Realms</a> and <a class="link" href="how_red_hat_jboss_enterprise_application_platform_6_handles_security_out_of_the_box.html#security_domains" title="Security Domains">Security Domains</a> sections.
					</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="how_it_works_2"/>How it Works</h3></div></div></div><p>
						The application <span class="emphasis"><em>sampleApp1.war</em></span> has two html files (<code class="literal">/hello.html</code> and <code class="literal">/secure/hello.html</code>) and uses basic HTTP authentication to secure the path <code class="literal">/secure/*</code>. It uses the <span class="emphasis"><em>other</em></span> security domain and requires the role of <span class="emphasis"><em>sample</em></span>. Since the <span class="emphasis"><em>other</em></span> security domain defers to <span class="emphasis"><em>ApplicationRealm</em></span> for its authentication and authorization information, refer to the users in the <span class="emphasis"><em>Users</em></span> table from the <a class="link" href="example_scenarios.html#core_management_authentication_out_of_the_box" title="Core Management Authentication Out of the Box">previous section</a>.
					</p><p>
						When <span class="emphasis"><em>Sarah</em></span> requests <code class="literal">/hello.html</code>, she is able to view the page without authenticating. When <span class="emphasis"><em>Sarah</em></span> tries to request <code class="literal">/secure/hello.html</code>, she is prompted to enter her username and password. She is then able to view <code class="literal">/secure/hello.html</code> after successfully logging in. <span class="emphasis"><em>Frank</em></span> and <span class="emphasis"><em>Susan</em></span> (or any user) can access <code class="literal">/hello.html</code>, but neither can access <code class="literal">/secure/hello.html</code> (<span class="emphasis"><em>Frank</em></span> does not have the <span class="emphasis"><em>sample</em></span> role and <span class="emphasis"><em>Susan</em></span> is not in the <span class="emphasis"><em>ApplicationRealm</em></span> security realm).
					</p></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="red_hat_jboss_enterprise_application_platform_with_https_and_rbac_added_to_the_management_interfaces"/>Red Hat JBoss Enterprise Application Platform with HTTPS and RBAC Added to the Management Interfaces</h1></div></div></div><p>
				This scenario shows how JBoss EAP is secured when HTTPS is enabled for the management interfaces, and RBAC is added to the <span class="emphasis"><em>ManagementRealm</em></span> security realm.
			</p><p>
				<span class="inlinemediaobject"><img src="images/scenario2.png" width="600" alt="scenario2"/></span>

			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="security_3"/>Security</h2></div></div></div><p>
					JBoss EAP provides support for using HTTPS with the management interfaces, which includes the Management Console. HTTPS can be enabled by configuring the <span class="emphasis"><em>secure-interface</em></span> element, adding a <span class="emphasis"><em>secure-port</em></span> to the <span class="emphasis"><em>http-interface</em></span> section of the management interface, and configuring an existing or new security realm with the desired settings (e.g. server-identities, protocol, keystore, alias, etc). This enables the management interfaces to use SSL/TLS for all HTTP traffic. For more background information on HTTPS and securing the management interfaces in general, see the <a class="xref" href="how_red_hat_jboss_enterprise_application_platform_6_handles_security_out_of_the_box.html#advanced_security" title="Advanced Security">the section called “Advanced Security”</a> section.
				</p><p>
					JBoss EAP also offers the ability to enable <a class="link" href="how_red_hat_jboss_enterprise_application_platform_6_handles_security_out_of_the_box.html#role_based_access_control" title="Role-Based Access Control">RBAC</a> on the managent interfaces using a couple of different authentication schemes. This example uses username/password authentication with the existing property files used in the <span class="emphasis"><em>ManagementRealm</em></span>. RBAC is enabled by setting the <span class="emphasis"><em>provider</em></span> attribute to <span class="emphasis"><em>rbac</em></span> for the management interface and updating the <span class="emphasis"><em>ManagementRealm</em></span> with the desired users and roles.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="how_it_works_3"/>How it works</h2></div></div></div><p>
					For this scenario, the following users have been added to the existing security realms:
				</p><div class="table"><a id="idm140170671531872"/><p class="title"><strong>Table 4.2. Management Users</strong></p><div class="table-contents"><table summary="Management Users" border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Username</th><th style="text-align: left" valign="top">Password</th><th style="text-align: left" valign="top">Security Realm</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									Suzy
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>Testing123!</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>ManagementRealm</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Tim
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>Testing123!</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>ManagementRealm</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Emily
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>Testing123!</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>ManagementRealm</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Zach
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>Testing123!</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>ManagementRealm</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Natalie
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>Testing123!</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>ManagementRealm</em></span>
								</p>
								 </td></tr></tbody></table></div></div><p>
					Based on group membership, the users have also been mapped to the following RBAC roles:
				</p><div class="table"><a id="idm140170581427200"/><p class="title"><strong>Table 4.3. RBAC Roles</strong></p><div class="table-contents"><table summary="RBAC Roles" border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Username</th><th style="text-align: left" valign="top">RBAC Role</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									Suzy
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									SuperUser
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Tim
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Administrator
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Emily
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Maintainer
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Zach
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Deployer
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Natalie
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									Monitor
								</p>
								 </td></tr></tbody></table></div></div><p>
					On startup, JBoss EAP loads the <span class="emphasis"><em>ManagementRealm</em></span> (with the RBAC configuration) and management interfaces as part of the core services, which also starts the <span class="emphasis"><em>http-interface</em></span> (configured for HTTPS) for the management interfaces. Users now access the management interfaces via HTTPS, and RBAC has also been enabled and configured. If RBAC is not enabled, any user in the <span class="emphasis"><em>ManagementRealm</em></span> security realm is considered a <span class="emphasis"><em>SuperUser</em></span> and has unlimited access. Since RBAC has been enabled, each user is now restricted based on the roles they have. <span class="emphasis"><em>Suzy</em></span>, <span class="emphasis"><em>Tim</em></span>, <span class="emphasis"><em>Emily</em></span>, <span class="emphasis"><em>Zach</em></span>, and <span class="emphasis"><em>Natalie</em></span> all have different roles which are showing in the table above. For example, only <span class="emphasis"><em>Suzy</em></span> and <span class="emphasis"><em>Tim</em></span> can read and modify access control information. <span class="emphasis"><em>Suzy</em></span>, <span class="emphasis"><em>Tim</em></span>, and <span class="emphasis"><em>Emily</em></span> can modify runtime state and other persistent configuration information. <span class="emphasis"><em>Zach</em></span> can also modify runtime state and other persistent configuration information, but only related to application resources. <span class="emphasis"><em>Suzy</em></span>, <span class="emphasis"><em>Tim</em></span>, <span class="emphasis"><em>Emily</em></span>, <span class="emphasis"><em>Zach</em></span>, and <span class="emphasis"><em>Natalie</em></span> can all read configuration and state information, but <span class="emphasis"><em>Natalie</em></span> cannot update anything. For more details on each of the roles and how JBoss EAP handles RBAC, see the <a class="xref" href="how_red_hat_jboss_enterprise_application_platform_6_handles_security_out_of_the_box.html#role_based_access_control" title="Role-Based Access Control">the section called “Role-Based Access Control”</a> and <a class="xref" href="how_red_hat_jboss_enterprise_application_platform_6_handles_security_out_of_the_box.html#adding_rbac_to_the_management_interfaces" title="Adding RBAC to the Management Interfaces">the section called “Adding RBAC to the Management Interfaces”</a> sections.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="red_hat_jboss_enterprise_application_platform_with_an_updated_security_subsystem_including_https"/>Red Hat JBoss Enterprise Application Platform with an Updated Security Subsystem including HTTPS</h1></div></div></div><p>
				This scenario shows how a sample application running on JBoss EAP is secured when a new security domain is added, and HTTPS is enabled. An application (sampleApp2.war) is deployed that is configured to use container-based security (sample-domain) and HTTPS.
			</p><p>
				<span class="inlinemediaobject"><img src="images/scenario3.png" width="600" alt="scenario3"/></span>

			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="security_4"/>Security</h2></div></div></div><p>
					JBoss EAP provides support for using HTTPS for use with applications, which is handled using the <span class="emphasis"><em>web subsystem</em></span>. A new connector for HTTPS is added to the <span class="emphasis"><em>web subystem</em></span> and is configured with the desired settings (e.g. protocol, port, keystore, etc). Once the configuration is saved, web applications can start accepting HTTPS traffic on the configured port. A new security domain has also been added called <span class="emphasis"><em>sample-domain</em></span> that uses the <span class="emphasis"><em>IdentityLoginModule</em></span> for authentication. <span class="emphasis"><em>sampleApp2.war</em></span> is configured to use <span class="emphasis"><em>sample-domain</em></span> to authenticate users.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="how_it_works_4"/>How it works</h2></div></div></div><p>
					A security domain (<span class="emphasis"><em>sample-domain</em></span>) has been created and configured to use the <span class="emphasis"><em>IdentityLoginModule</em></span>. The following credentials have been configured in the login module:
				</p><div class="table"><a id="idm140170682532784"/><p class="title"><strong>Table 4.4. sample-domain Users</strong></p><div class="table-contents"><table summary="sample-domain Users" border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Username</th><th style="text-align: left" valign="top">Password</th><th style="text-align: left" valign="top">Roles</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									Vincent
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>samplePass</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>sample</em></span>
								</p>
								 </td></tr></tbody></table></div></div><p>
					On startup, JBoss EAP loads the core services, and then starts up the <span class="emphasis"><em>web</em></span> and <span class="emphasis"><em>security</em></span> subsystems which manages the HTTPS connections for all web applications and the <span class="emphasis"><em>sample-domain</em></span> respectively. <span class="emphasis"><em>sampleApp2.war</em></span> is then loaded which looks for <span class="emphasis"><em>sample-domain</em></span> for providing authentication and authorization for its secured URLs. <span class="emphasis"><em>sampleApp2.war</em></span> has two html files (<code class="literal">/hello.html</code> and <code class="literal">/secure/hello.html</code>) and uses basic HTTP authentication to secure the path <code class="literal">/secure/*</code>. It uses the <span class="emphasis"><em>sample-domain</em></span> security domain and requires the role of <span class="emphasis"><em>sample</em></span>.
				</p><p>
					When <span class="emphasis"><em>Vincent</em></span> requests <code class="literal">/hello.html</code>, he is able to view the page without authenticating. When <span class="emphasis"><em>Vincent</em></span> tries to request <code class="literal">/secure/hello.html</code>, he is prompted to enter her username and password. He is then able to view <code class="literal">/secure/hello.html</code> after successfully logging in. All other users can access <code class="literal">/hello.html</code> without loggin in, but none can access <code class="literal">/secure/hello.html</code> since <span class="emphasis"><em>Vincent</em></span> is the only user in <span class="emphasis"><em>sample-domain</em></span>. This also applies to all traffic handled over HTTPS.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sso_for_web_applications_on_red_hat_jboss_enterprise_application_platform"/>SSO for Web Applications on Red Hat JBoss Enterprise Application Platform</h1></div></div></div><p>
				This scenario shows how web applications make use of both clustered and non-clustered SSO on JBoss EAP. Four JBoss EAP instances have are created (<span class="emphasis"><em>EAP1</em></span>, <span class="emphasis"><em>EAP2</em></span>, <span class="emphasis"><em>EAP3</em></span>, and <span class="emphasis"><em>EAP4</em></span>) with <span class="emphasis"><em>EAP1</em></span> and <span class="emphasis"><em>EAP2</em></span> operating in standalone mode, and <span class="emphasis"><em>EAP3</em></span> and <span class="emphasis"><em>EAP4</em></span> operating as a two node cluster. Two web applications (<span class="emphasis"><em>sampleAppA</em></span> and <span class="emphasis"><em>sampleAppB</em></span>) have been deployed to each of the four JBoss EAP instances.
			</p><p>
				<span class="inlinemediaobject"><img src="images/scenario4.png" width="800" alt="scenario4"/></span>

			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="security_5"/>Security</h2></div></div></div><p>
					JBoss EAP provides support for both clustered and non-clustered SSO with web applications by using a combination of the <span class="emphasis"><em>security</em></span>, <span class="emphasis"><em>web</em></span>, and <span class="emphasis"><em>infinispan</em></span> subsystems. The <span class="emphasis"><em>security</em></span> subsystem provides a security domain for performing authentication and authorization while the <span class="emphasis"><em>infinispan</em></span> and <span class="emphasis"><em>web</em></span> subsystems help with caching and distributing the SSO information between all the web applications on an JBoss EAP instance or across a JBoss EAP cluster. All four eap instances have a security domain (<span class="emphasis"><em>sso-domain</em></span>) configured to use the <span class="emphasis"><em>IdentityLoginModule</em></span>. <span class="emphasis"><em>sampleAppA</em></span> and <span class="emphasis"><em>sampleAppB</em></span> have been configured to use the <span class="emphasis"><em>sso-domain</em></span> security domain to secure the path <code class="literal">/secure/*</code> and require the role of <span class="emphasis"><em>sample</em></span> to access it. The following credentials have been configured in the <span class="emphasis"><em>sso-domain</em></span> login module:
				</p><div class="table"><a id="idm140170572837904"/><p class="title"><strong>Table 4.5. sso-domain Users</strong></p><div class="table-contents"><table summary="sso-domain Users" border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Username</th><th style="text-align: left" valign="top">Password</th><th style="text-align: left" valign="top">Roles</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									Jane
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>samplePass</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>sample</em></span>
								</p>
								 </td></tr></tbody></table></div></div><p>
					All four JBoss EAP instances have also been configured to start up with either <span class="emphasis"><em>standalone-full-ha</em></span> or <span class="emphasis"><em>full-ha</em></span> profile, which adds the <span class="emphasis"><em>infinispan</em></span> subsystem and other functionality needed for enabling SSO in this scenario. The web cache-container and SSO replicated-cache have also been added, and the <span class="emphasis"><em>web</em></span> subsystem has been configured to use both them. <span class="emphasis"><em>EAP1</em></span> and <span class="emphasis"><em>EAP2</em></span> have configured their <span class="emphasis"><em>web</em></span> subsystems for non-clustered SSO while the cluster containing <span class="emphasis"><em>EAP3</em></span> and <span class="emphasis"><em>EAP4</em></span> has been configured to use clustered SSO.
				</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Application Clustering vs. Clustered SSO</h3><p>
						There is a distinct difference between a clustered web application and clustered SSO. A clustered web application is one which is distributed across the nodes of a cluster to spread the load of hosting that application. In clustered applications (marked as distributable), all new sessions, and changes to existing sessions are replicated to other members of the cluster. Clustered SSO allows for replication of security context and identity information, regardless of whether or not the applications are themselves clustered. Although these technologies may be used together they are mutually exclusive and may be used independent of one other.
					</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="how_it_works_5"/>How it works</h2></div></div></div><p>
					On startup, JBoss EAP loads the core services and then starts up the <span class="emphasis"><em>security</em></span>, <span class="emphasis"><em>web</em></span>, and <span class="emphasis"><em>infinispan</em></span> subsystems which manage <span class="emphasis"><em>sso-domain</em></span> and the associated caching for SSO informaiton. <span class="emphasis"><em>sampleAppA.war</em></span> and <span class="emphasis"><em>sampleAppB.war</em></span> are loaded on all four JBoss EAP instances, each of which look for <span class="emphasis"><em>sso-domain</em></span> for providing authentication and authorization.
				</p><p>
					If <span class="emphasis"><em>Jane</em></span> attempts to access <code class="literal">EAP1/sampleAppA/secure/hello.html</code>, she will be asked to authenticate. After providing the correct information, she will be allowed to see <code class="literal">EAP1/sampleAppA/secure/hello.html</code>. <span class="emphasis"><em>Jane’s</em></span> session will then be be added into the SSO caches used by the <span class="emphasis"><em>web</em></span> and <span class="emphasis"><em>infinispan</em></span> subsystems. If she then attempts to access <code class="literal">EAP1/sampleAppB/secure/hello.html</code>, she will not be asked to re-authenticate. <span class="emphasis"><em>sampleAppB</em></span> running on <span class="emphasis"><em>EAP1</em></span> will find her session using the <span class="emphasis"><em>web</em></span> subsystem caches along with the <span class="emphasis"><em>infinispan</em></span> subsystem and grant her access since she is already authenticated. If <span class="emphasis"><em>Jane</em></span> then attempts to access either <code class="literal">EAP2/sampleAppA/secure/hello.html</code> or <code class="literal">EAP2/sampleAppB/secure/hello.html</code>, she will be asked to authenticate again since <span class="emphasis"><em>EAP1</em></span> and <span class="emphasis"><em>EAP2</em></span> do not share a cache.
				</p><p>
					If <span class="emphasis"><em>Jane</em></span> attempts to access <code class="literal">EAP3/sampleAppA/secure/hello.html</code>, she will be asked to authenticate and her session will be stored in the SSO caches. These caches are stored across the entire cluster, so if <span class="emphasis"><em>Jane</em></span> attempts to log into <code class="literal">EAP3/sampleAppB/secure/hello.html</code>, <code class="literal">EAP4/sampleAppA/secure/hello.html</code>, or <code class="literal">EAP4/sampleAppB/secure/hello.html</code>, she will not have to re-authenticate. Additionally, if either <span class="emphasis"><em>EAP3</em></span> or <span class="emphasis"><em>EAP4</em></span> are restarted, <span class="emphasis"><em>Jane’s</em></span> SSO information will remain in the cache since the other JBoss EAP instance and the cluster remain running, hence preserving the cache. Similarly, if <span class="emphasis"><em>Jane’s</em></span> session is invalidated, it ripples across the cache and she will be asked to re-authenticate regardless of which application or server she tries to access in the cluster.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="multiple_red_hat_jboss_enterprise_application_platform_instances_and_multiple_applications_using_browser_based_sso_with_saml"/>Multiple Red Hat JBoss Enterprise Application Platform Instances and Multiple Applications Using Browser-Based SSO with SAML</h1></div></div></div><p>
				This scenario shows how multiple JBoss EAP are secured and browser-based SSO is added. Three separate (non-clustered) JBoss EAP instances are configured(<span class="emphasis"><em>EAP1</em></span>, <span class="emphasis"><em>EAP2</em></span>, and <span class="emphasis"><em>EAP3</em></span>) and three sample applications (<span class="emphasis"><em>sampleAppA.war</em></span>, <span class="emphasis"><em>sampleAppB.war</em></span>, and <span class="emphasis"><em>sampleAppC.war</em></span>) are configured to use browser-based SSO for authentication.
			</p><p>
				<span class="inlinemediaobject"><img src="images/scenario5.png" width="800" alt="scenario5"/></span>

			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="security_6"/>Security</h2></div></div></div><p>
					JBoss EAP provides support for doing browser-based SSO via SAML with web applications as well as hosting an identity provider. To host an identity provider, a security domain (<span class="emphasis"><em>idp-domain</em></span>) must be configured with an authentication mechanism defined. In this case, <span class="emphasis"><em>idp-domain</em></span> is configured to use the <span class="strong"><strong>DatabaseLoginModule</strong></span> as the authentication mechanism. The identity provider application (<span class="emphasis"><em>IDP.war</em></span>) is deployed to that JBoss EAP instance (<span class="emphasis"><em>EAP-IDP</em></span>), and configured to use <span class="emphasis"><em>idp-domain</em></span> as its identity store. <span class="emphasis"><em>IDP.war</em></span> uses the identity store in combination with functionality in the application to authentication users as well as issue SAML tokens containing the users identity and role information. Three additional JBoss EAP instances (<span class="emphasis"><em>EAP1</em></span>, <span class="emphasis"><em>EAP2</em></span>, and <span class="emphasis"><em>EAP3</em></span>) each host one distinct application that will serve as an individual service provider (<span class="emphasis"><em>sampleAppA.war</em></span>, <span class="emphasis"><em>sampleAppB.war</em></span>, and <span class="emphasis"><em>sampleAppC</em></span> respectively). Each JBoss EAP instance has a security domain (<span class="emphasis"><em>sso-domain</em></span>) configured to use the <span class="strong"><strong>SAML2LoginModule</strong></span> as the authentication mechanism. Each application contains functionality to support SSO, use <span class="emphasis"><em>IDP.war</em></span> as an identity provider, and use HTTP/POST binding for authentication. Each application is also configured to use <span class="emphasis"><em>sso-domain</em></span> to secure the path <code class="literal">/secure/*</code> and supplies its own list of roles for handling authorization.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="how_it_works_6"/>How it works</h2></div></div></div><p>
					For this scenario, the following users have been added to the database used by the <span class="strong"><strong>DatabaseLoginModule</strong></span> in the <span class="emphasis"><em>idp-domain</em></span> security domain:
				</p><div class="table"><a id="idm140170676735184"/><p class="title"><strong>Table 4.6. idp-domain Users</strong></p><div class="table-contents"><table summary="idp-domain Users" border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Username</th><th style="text-align: left" valign="top">Password</th><th style="text-align: left" valign="top">Roles</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									Eric
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>samplePass</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>all</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Amar
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>samplePass</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>AB</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Brian
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>samplePass</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>C</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Alan
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>samplePass</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> </td></tr></tbody></table></div></div><p>
					On startup of <span class="emphasis"><em>EAP-IDP</em></span>, the management interfaces start up, followed by the subsystems and deployed applications including the security subsystem (which includes <span class="emphasis"><em>idp-domain</em></span>) and <span class="emphasis"><em>IDP.war</em></span>. <span class="emphasis"><em>idp-domain</em></span> connects to the database and loads the usernames, passwords, and roles as configured in the <span class="strong"><strong>DatabaseLoginModule</strong></span> login module. To prevent sensitive information from being stored in plaintext in the configuration of the <span class="strong"><strong>DatabaseLoginModule</strong></span> login module password hashing is configured to obscure certain fields (e.g. password for the database). <span class="emphasis"><em>IDP.war</em></span> uses <span class="emphasis"><em>idp-domain</em></span> for authentication and authorization. <span class="emphasis"><em>IDP.war</em></span> is also configured (via <span class="emphasis"><em>jboss-web.xml</em></span>, <span class="emphasis"><em>web.xml</em></span>, <span class="emphasis"><em>picketlink.xml</em></span>, and <span class="emphasis"><em>jboss-deployment-structure.xml</em></span>) to issue SAML tokens to authenticated users and supplies a simple login form for users to authenticate against. This allows it to serve as an identity provider.
				</p><p>
					On startup of <span class="emphasis"><em>EAP1</em></span>, <span class="emphasis"><em>EAP2</em></span> and <span class="emphasis"><em>EAP3</em></span>, the management interfaces start up, followed by the subsystems and deployed applications including the security subsystem (which includes <span class="emphasis"><em>sso-domain</em></span> on each instance) and <span class="emphasis"><em>sampleAppA.war</em></span>, <span class="emphasis"><em>sampleAppB.war</em></span>, and <span class="emphasis"><em>sampleAppC.war</em></span> respectively. <span class="emphasis"><em>sso-domain</em></span> is configured to use the <span class="strong"><strong>SAML2LoginModule</strong></span> login module, but relies on the application to supply the proper SAML token. This means any application using <span class="emphasis"><em>sso-domain</em></span> must handle properly connecting to an identity provider to obtain a SAML token. In this case, <span class="emphasis"><em>sampleAppA</em></span>, <span class="emphasis"><em>sampleAppB</em></span>, and <span class="emphasis"><em>sampleAppC</em></span> are each configured (via <span class="emphasis"><em>jboss-web.xml</em></span>, <span class="emphasis"><em>web.xml</em></span>, <span class="emphasis"><em>picketlink.xml</em></span>, and <span class="emphasis"><em>jboss-deployment-structure.xml</em></span>) to obtain SAML tokens from an identity provider (<span class="emphasis"><em>IDP.war</em></span>) using that identity providers login form.
				</p><p>
					Each application is also configured with its own set of allowed roles:
				</p><div class="table"><a id="idm140170690227408"/><p class="title"><strong>Table 4.7. Application/SP roles</strong></p><div class="table-contents"><table summary="Application/SP roles" border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Application/SP</th><th style="text-align: left" valign="top">Allowed Roles</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>sampleAppA</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>all</em></span>, <span class="emphasis"><em>AB</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>sampleAppB</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>all</em></span>, <span class="emphasis"><em>AB</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>sampleAppC</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>all</em></span>, <span class="emphasis"><em>C</em></span>
								</p>
								 </td></tr></tbody></table></div></div><p>
					When an un-authenticated user attempts to access the URLs secured by <span class="emphasis"><em>sso-domain</em></span> (i.e. <code class="literal">/secure/*</code>) of any application, that user is redirected to the login page at <span class="emphasis"><em>IDP.war</em></span>. The user then authenticates using the form, is issued a SAML token containing their identity and role information. The user is then redirected back to the original URL, and their SAML token is presented to the application (service provider). The application ensures the SAML token is valid and then authorizes the user based on the roles provided by the SAML token and the ones configured in the application. Once a user is issued a SAML token, they will then use that token to be authenticated and authorized on the other applications secured by SSO using the same identity provider. Once the SAML token expires or becomes invalidated, the user will required to obtain a new SAML token from the identity provider.
				</p><p>
					In this example, if Eric accesses <code class="literal">EAP1/sampleAppA/secure/hello.html</code>, he is redirected to <code class="literal">EAP-IDP/IDP/login.html</code> to login. After successful login, he is issued a SAML token containing his user information and the role <span class="emphasis"><em>all</em></span>, and redirected back to <code class="literal">EAP1/sampleAppA/secure/hello.html</code>. His SAML token is then presented to <span class="emphasis"><em>sampleAppA</em></span> to be checked and to authorize him based on his roles. Since <span class="emphasis"><em>sampleAppA</em></span> allows the roles <span class="emphasis"><em>all</em></span> and <span class="emphasis"><em>AB</em></span> to access <code class="literal">/secure/*</code> and Eric has the role <span class="emphasis"><em>all</em></span>, he is allowed to access <code class="literal">EAP1/sampleAppA/secure/hello.html</code>.
				</p><p>
					If Eric then tries to access <code class="literal">EAP2/sampleAppB/secure/hello.html</code>, since he is not already authenticated against that service provider, he is redirected again to <span class="emphasis"><em>IDP.war</em></span> with an authentication request. Since Eric has already authenticated against the identity provider (<span class="emphasis"><em>IDP.war</em></span>), he is then redirected back to <code class="literal">EAP2/sampleAppB/secure/hello.html</code> by <span class="emphasis"><em>IDP.war</em></span> with a new SAML token for that service provider without having to re-authenticate. <span class="emphasis"><em>sampleAppB</em></span> then simply checks his new SAML token and authorizes him based on his role. Since <span class="emphasis"><em>sampleAppB</em></span> allows the roles <span class="emphasis"><em>all</em></span> and <span class="emphasis"><em>AB</em></span> to access <code class="literal">/secure/*</code> and Eric has the role <span class="emphasis"><em>all</em></span>, he also is allowed to access <code class="literal">EAP2/sampleAppB/secure/hello.html</code>. The same thing would apply if Eric were to try and access <code class="literal">EAP3/sampleAppC/secure/hello.html</code>.
				</p><p>
					If Eric were to return to <code class="literal">EAP1/sampleAppA/secure/hello.html</code> (or any URL under <code class="literal">EAP2/sampleAppB/secure/ *</code> or <code class="literal">EAP3/sampleAppC/secure/*</code>) after his SAML token became invalidated via global logout, he would be redirected back to <code class="literal">EAP-IDP/IDP/login.html</code> to authenticate again and be issued a new SAML token.
				</p><p>
					If Amar attempted to access <code class="literal">EAP1/sampleAppA/secure/hello.html</code> or <code class="literal">EAP2/sampleAppB/secure/hello.html</code>, he would be directed through the same flow as Eric. If Amar attempted to access <code class="literal">EAP3/sampleAppC/secure/hello.html</code>, he would still be required to have or obtain a SAML token, but would restricted from viewing <code class="literal">EAP3/sampleAppC/secure/hello.html</code> since his role <span class="emphasis"><em>AB</em></span> only allows him to access <code class="literal">EAP1/sampleAppA/secure/*</code> and <code class="literal">EAP2/sampleAppB/secure/*</code>. Brian is in a similar situation, but he is only allowed to access <code class="literal">EAP3/sampleAppC/secure/*</code>. If Alan tries to access any service provider’s secured area, he would still be required to have or obtain a SAML token, but would be restricted from seeing anything since he has no role. Each service provider also has unsecured area which any user (authorized or not) can view without obtaining a SAML token.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="using_ldap_with_the_emphasis_managementrealm_emphasis"/>Using LDAP with the <span class="emphasis"><em>ManagementRealm</em></span></h1></div></div></div><p>
				This scenario shows the <span class="emphasis"><em>ManagementRealm</em></span> using LDAP for securing the management interfaces. A JBoss EAP instance has been created (<span class="emphasis"><em>EAP1</em></span>) and is running in standalone mode. The <span class="emphasis"><em>ManagementRealm</em></span> on <span class="emphasis"><em>EAP1</em></span> has also been updated to use LDAP as the authentication and authorization mechanism.
			</p><p>
				<span class="inlinemediaobject"><img src="images/scenario6.png" width="800" alt="scenario6"/></span>

			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="security_7"/>Security</h2></div></div></div><p>
					JBoss EAP supports using LDAP (as well as Kerberos) for authentication in security realms. This is accomplished by updating the existing <span class="emphasis"><em>ManagementRealm</em></span> to use <span class="strong"><strong>ldap</strong></span> as the authentication type and creating an outbound connection to the LDAP server. This, in turn, changes the authentication mechanism from digest to BASIC / Plain, and will transmit usernames and passwords in the clear over the network by default.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="how_it_works_7"/>How it works</h2></div></div></div><p>
					The following users have been added to the LDAP directory:
				</p><div class="table"><a id="idm140170676815840"/><p class="title"><strong>Table 4.8. Management Users</strong></p><div class="table-contents"><table summary="Management Users" border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/></colgroup><thead><tr><th style="text-align: left" valign="top">Username</th><th style="text-align: left" valign="top">Password</th><th style="text-align: left" valign="top">Roles</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									Adam
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>samplePass</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>SuperUser</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Sam
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>samplePass</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> </td></tr></tbody></table></div></div><p>
					On startup, <span class="emphasis"><em>EAP1</em></span> loads the core-services, including <span class="emphasis"><em>ManagementRealm</em></span> and the management interfaces. <span class="emphasis"><em>ManagementRealm</em></span> connects to the LDAP directory server and provides the authentication for the management interfaces as needed.
				</p><p>
					If <span class="emphasis"><em>Adam</em></span> attempts to access a management interface, he will be forced to authenticate. His credentials will be passed to the <span class="emphasis"><em>ManagementRealm</em></span> security realm, which will use the LDAP directory server for authentication. After he is authenticated, his roles will be passed back to the management interface and for authorization. Since <span class="emphasis"><em>Adam</em></span> has the <span class="emphasis"><em>SuperUser</em></span> role, he will be granted access to the management interface. If <span class="emphasis"><em>Sam</em></span> attempts to access a management interface, he would be authenticated via LDAP, but would be denied access since he does not have the proper role of <span class="emphasis"><em>SuperUser</em></span>.
				</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="using_desktop_sso_via_kerberos_to_provide_sso_for_web_applications"/>Using Desktop SSO (via Kerberos) to Provide SSO for Web Applications</h1></div></div></div><p>
				This scenario shows how Kerberos can be used with JBoss EAP to provide SSO for web applications. A JBoss EAP instance has been created (<span class="emphasis"><em>EAP1</em></span>) and is running in standalone mode. Two web applications (<span class="emphasis"><em>sampleAppA</em></span> and <span class="emphasis"><em>sampleAppB</em></span>) have been deployed to <span class="emphasis"><em>EAP1</em></span>. Both the web applications and <span class="emphasis"><em>EAP1</em></span> have been configured to authenticate using desktop-based SSO via Kerberos.
			</p><p>
				<span class="inlinemediaobject"><img src="images/scenario7.png" width="800" alt="scenario7"/></span>

			</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="security_8"/>Security</h2></div></div></div><p>
					JBoss EAP offers support for using Kerberos for SSO in web applications via SPNEGO and JBoss Negotiation. For more information on the specifics of Kerberos and SPNEGO please see the <a class="xref" href="overview-of-general-security-concepts.html#third_party_sso_implementations" title="Third-Party SSO Implementations">the section called “Third-Party SSO Implementations”</a> section. To enable JBoss EAP and deployed web applications to use Keberos for authentication, two security domains must be created. The first security domain (<span class="emphasis"><em>host-domain</em></span>) is configured with the <span class="emphasis"><em>kerberos</em></span> login module to connect to the kerberos server. This allows JBoss EAP to authenticate at the container level. A second security domain (<span class="emphasis"><em>spnego-domain</em></span>) is created with two login modules. One uses the <span class="emphasis"><em>spnego</em></span> login module to connect to <span class="emphasis"><em>host-domain</em></span> to authenticate users. The second can use any other login module to load role information for use in authorization decisions (e.g. <span class="emphasis"><em>UsersRoles</em></span> using properties files to map users to roles).
				</p><p>
					These two login modules also make use of <span class="emphasis"><em>password-stacking</em></span> to map the users and roles in the authorization module with the users in the authentication login module. <span class="emphasis"><em>EAP1</em></span> is configured with both <span class="emphasis"><em>host-domain</em></span> and <span class="emphasis"><em>spnego-domain</em></span>. Applications are then configured (via <span class="emphasis"><em>web.xml</em></span> and <span class="emphasis"><em>jboss-web.xml</em></span>) to use <span class="emphasis"><em>spnego-domain</em></span> to perform authentication and get a user’s roles for authorization. Applications can also be configured with FORM authentication as a fallback authentication mechanism in case the security tokens cannot be passed from the OS to the browser. If FORM authentication is configured as a fallback, an additional security domain must be configured to support it. This security domain is independent of Kerberos and SPNEGO, and just has to support FORM authentication (i.e. username/password validation and roles). Each application is configured to use <span class="emphasis"><em>spengo-domain</em></span> and to provide FORM authentication as a fallback. Each application is also configured to secure the path <code class="literal">/secure/*</code> and supplies its own list of roles for handling authorization.
				</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="how_it_works_8"/>How it works</h2></div></div></div><p>
					The following users have been created in the Kerberos server:
				</p><div class="table"><a id="idm140170672535376"/><p class="title"><strong>Table 4.9. Kerberos Users</strong></p><div class="table-contents"><table summary="Kerberos Users" border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Username</th><th style="text-align: left" valign="top">Password</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									Brent
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>samplePass</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Andy
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>samplePass</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Bill
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>samplePass</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Ron
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>samplePass</em></span>
								</p>
								 </td></tr></tbody></table></div></div><p>
					The following roles have mapped to the users via an additional module that is chained by setting the password-stacking option to <span class="emphasis"><em>useFirstPass</em></span>:
				</p><div class="table"><a id="idm140170639297216"/><p class="title"><strong>Table 4.10. User Roles</strong></p><div class="table-contents"><table summary="User Roles" border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Username</th><th style="text-align: left" valign="top">Roles</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									Brent
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>all</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Andy
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>A</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Bill
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>B</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									Ron
								</p>
								 </td><td style="text-align: left" valign="top"> </td></tr></tbody></table></div></div><p>
					The following roles have also been configured in each application:
				</p><div class="table"><a id="idm140170675432384"/><p class="title"><strong>Table 4.11. Application Roles</strong></p><div class="table-contents"><table summary="Application Roles" border="1"><colgroup><col class="col_1"/><col class="col_2"/></colgroup><thead><tr><th style="text-align: left" valign="top">Application/SP</th><th style="text-align: left" valign="top">Allowed Roles</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>sampleAppA</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>all</em></span>, <span class="emphasis"><em>A</em></span>
								</p>
								 </td></tr><tr><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>sampleAppB</em></span>
								</p>
								 </td><td style="text-align: left" valign="top"> <p>
									<span class="emphasis"><em>all</em></span>, <span class="emphasis"><em>B</em></span>
								</p>
								 </td></tr></tbody></table></div></div><p>
					On startup, <span class="emphasis"><em>EAP1</em></span> loads the core-services, followed by the <span class="emphasis"><em>security</em></span> and other subsystems. <span class="emphasis"><em>host-domain</em></span> establishes a connection to the Kerberos server and <span class="emphasis"><em>spnego-domain</em></span> connects to <span class="emphasis"><em>host-domain</em></span>. <span class="emphasis"><em>sampleAppA</em></span> and <span class="emphasis"><em>sampleAppB</em></span> are then deployed and connect to <span class="emphasis"><em>spnego-domain</em></span> for authentication.
				</p><p>
					<span class="emphasis"><em>Brent</em></span> has logged onto his computer that is secured with Kerberos. He then opens his browser and attempts to access <code class="literal">sampleAppA/secure/hello.html</code>. Since that is secured, authentication is required. <span class="emphasis"><em>EAP1</em></span> directs the browser to send a request for a key to the Kerberos server (specifically the Kerberos Key Distribution Center which is configured on his computer). After a key is obtained by the browser, it is sent to <span class="emphasis"><em>simpleAppA</em></span>. <span class="emphasis"><em>simpleAppA</em></span> sends the ticket to <span class="emphasis"><em>spnego-domain</em></span> where it is unpacked and authentication is performed by <span class="emphasis"><em>host-domain</em></span> (in conjunction with the configured Kerberos server). Once the ticket is authenticated, <span class="emphasis"><em>Brent’s</em></span> role is passed back to <span class="emphasis"><em>simpleAppA</em></span> to perform authorization. Since <span class="emphasis"><em>Brent</em></span> has the <span class="emphasis"><em>all</em></span> role, he will be able to access <code class="literal">sampleAppA/secure/hello.html</code>. If <span class="emphasis"><em>Brent</em></span> tries to access <code class="literal">sampleAppB/secure/hello.html</code>, the same process will occur and he will be granted access (due to him having the <span class="emphasis"><em>all</em></span> role). <span class="emphasis"><em>Andy</em></span> and <span class="emphasis"><em>Bill</em></span> would follow the same process as well, but with <span class="emphasis"><em>Andy</em></span> only having access to <code class="literal">sampleAppA/secure/hello.html</code> and not <code class="literal">sampleAppB/secure/hello.html</code>. <span class="emphasis"><em>Bill</em></span> would be the opposite, having access to <code class="literal">sampleAppB/secure/hello.html</code> and not <code class="literal">sampleAppA/secure/hello.html</code>. <span class="emphasis"><em>Ron</em></span> would pass authentication to either <code class="literal">sampleAppA/secure/hello.html</code> or <code class="literal">sampleAppB/secure/hello.html</code>, but would not be granted access to either since he has no role.
				</p><p>
					If <span class="emphasis"><em>Andy</em></span> were to attempt to access <code class="literal">sampleAppA/secure/hello.html</code> from a computer not secured by Kerberos (e.g. a personal laptop connected to the office network), he would be directed to the FORM login page as a fallback login mechanism. His credentials would then be authenticated via the fallback security domain and then the process would continue with authorization.
				</p></div></div></div></body></html>