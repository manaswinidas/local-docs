<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 6. Configuring a Security Domain to use a Filesystem</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta name="generator" content="DocBook XSL-NS Stylesheets V1.78.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="configuring_a_security_domain_to_use_a_filesystem"/>Chapter 6. Configuring a Security Domain to use a Filesystem</h1></div></div></div><p>
			Security domains can also be configured to use a filesystem as an identity store for authentication and authorization by using a login module.
		</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="usersroles_login_module"/>UsersRoles Login Module</h1></div></div></div><p>
				UsersRoles login module is a simple login module that supports multiple users and user roles loaded from Java properties files. The primary purpose of this login module is to easily test the security settings of multiple users and roles using properties files deployed with the application. The default username-to-password mapping filename is <code class="literal">users.properties</code> and the default username-to-roles mapping filename is <code class="literal">roles.properties</code>.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
					This login module supports password stacking, password hashing, and unauthenticated identity.
				</p></div><p>
				The properties files are loaded during initialization using the initialize method thread context class loader. This means that these files can be placed on the classpath of the Java EE deployment (for example, into the <code class="literal">WEB-INF/classes</code> folder in the WAR archive), or into any directory on the server classpath.
			</p><div class="table"><a id="idm140421021035824"/><p class="title"><strong>Table 6.1. Complete UsersRoles Login Module Options</strong></p><div class="table-contents"><table summary="Complete UsersRoles Login Module Options" border="1"><colgroup><col class="col_1"/><col class="col_2"/><col class="col_3"/><col class="col_4"/></colgroup><thead><tr><th style="text-align: left" valign="top">Option</th><th style="text-align: left" valign="top">Type</th><th style="text-align: left" valign="top">Default</th><th style="text-align: left" valign="top">Description</th></tr></thead><tbody><tr><td style="text-align: left" valign="top"> <p>
								usersProperties
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Path to a file or resource.
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								users.properties
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The file or resource which contains the user-to-password mappings. The format of the file is username=password
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								rolesProperties
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Path to a file or resource.
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								roles.properties
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The file or resource which contains the user-to-role mappings. The format of the file is username=role1,role2,role3
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								password-stacking
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								useFirstPass or false
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								false
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								A value of useFirstPass indicates that this login module should first look to the information stored in the LoginContext for the identity. This option can be used when stacking other login modules with this one.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								hashAlgorithm
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								String representing a password hashing algorithm.
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								none
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The name of the java.security.MessageDigest algorithm to use to hash the password. There is no default so this option must be explicitly set to enable hashing. When hashAlgorithm is specified, the clear text password obtained from the CallbackHandler is hashed before it is passed to UsernamePasswordLoginModule.validatePassword as the inputPassword argument. The password stored in the users.properties file must be comparably hashed.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								hashEncoding
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								base64 or hex
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								base64
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The string format for the hashed password, if hashAlgorithm is also set.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								hashCharset
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								string
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The default encoding set in the container’s runtime environment
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								The encoding used to convert the clear-text password to a byte array.
							</p>
							 </td></tr><tr><td style="text-align: left" valign="top"> <p>
								unauthenticatedIdentity
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								principal name
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								none
							</p>
							 </td><td style="text-align: left" valign="top"> <p>
								Defines the principal name assigned to requests which contain no authentication information. This can allow unprotected servlets to invoke methods on EJBs that do not require a specific role. Such a principal has no associated roles and can only access unsecured EJBs or EJB methods that are associated with the unchecked permission constraint.
							</p>
							 </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="configuring_a_security_domain_to_use_the_usersroles_login_module"/>Configuring a Security Domain to use the UsersRoles Login Module</h2></div></div></div><p>
					The below example assumes the following files have been created and are available on the application’s classpath:
				</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
							sampleapp-users.properties
						</li><li class="listitem">
							sampleapp-roles.properties
						</li></ul></div><div class="title"><strong>CLI Commands for Adding the UserRoles Login Module</strong></div><p>
						
</p><pre class="programlisting">/subsystem=security/security-domain=sampleapp:add</pre><p>

					</p><pre class="programlisting">/subsystem=security/security-domain=sampleapp/authentication=classic:add</pre><pre class="programlisting">/subsystem=security/security-domain=sampleapp/authentication=classic/login-module=UsersRoles:add( \
  code=UsersRoles, \
  flag=required, \
  module-options=[ \
    ("usersProperties"=&gt;"sampleapp-users.properties"), \
    ("rolesProperties"=&gt;"sampleapp-roles.properties") \
  ])</pre><pre class="programlisting">reload</pre><div class="title"><strong>Resulting XML</strong></div><p>
						
</p><pre class="programlisting">&lt;security-domain name="sampleapp"&gt;
  &lt;authentication&gt;
    &lt;login-module code="UsersRoles" flag="required"&gt;
      &lt;module-option name="usersProperties" value="sampleapp-users.properties"/&gt;
      &lt;module-option name="rolesProperties" value="sampleapp-roles.properties"/&gt;
    &lt;/login-module&gt;
  &lt;/authentication&gt;
&lt;/security-domain&gt;</pre><p>

					</p></div></div></div></body></html>