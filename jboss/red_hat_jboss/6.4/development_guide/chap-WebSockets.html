<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 17. WebSockets</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="chap-WebSockets">
      ⁠</a>Chapter 17. WebSockets</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="About_WebSockets">
      ⁠</a>17.1. About WebSockets</h1></div></div></div><div class="para">
		The WebSocket protocol provides two way communication between web clients and servers. Communications between clients and the server are event-based, allowing for faster processing and smaller bandwidth compared with polling-based methods. WebSocket is available for use in web applications via a JavaScript API.
	</div><div class="para">
		A connection is first established between client and server as an HTTP connection. The client then requests a WebSocket connection using the <code class="literal">Upgrade</code> header. All communications are then full-duplex over the same TCP/IP connection, with minimal data overhead. Because each message does not include unnecessary HTTP header content, Websocket communications require smaller bandwidth. The result is a low latency communications path, suited to applications which require real-time responsiveness.
	</div><div class="para">
		The JBoss EAP 6 WebSocket implementation provides full dependency injection support for server endpoints, however, it does not provide CDI services for client endpoints. CDI support is limited to that required by the Java EE 6 platform, and as a result, Java EE 7 features such as interceptors on endpoints are not supported.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+30495-737038+%5BLatest%5D&amp;comment=Title%3A+About+WebSockets%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=30495-737038+19+Jan+2015+10%3A07+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="Create_a_Websocket_Application">
      ⁠</a>17.2. Create a WebSocket Application</h1></div></div></div><div class="para">
		A WebSocket application requires the following components and configuration changes: 
		<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					A Java client or a WebSocket enabled HTML client. You can verify HTML client browser support at this location: <a href="http://caniuse.com/websockets">http://caniuse.com/websockets</a>
				</div></li><li class="listitem"><div class="para">
					A WebSocket server endpoint class.
				</div></li><li class="listitem"><div class="para">
					A <code class="filename">jboss-web.xml</code> file configured to enable WebSockets.
				</div></li><li class="listitem"><div class="para">
					Project dependencies configured to declare a dependency on the WebSocket API.
				</div></li><li class="listitem"><div class="para">
					Enable the <code class="literal">NIO2</code> connector in the <code class="literal">web</code> subsystem of the Red Hat JBoss Enterprise Application Platform server configuration file.
				</div></li></ul></div>
		 <div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				WebSocket applications require Java Runtime Environment version 7 or greater. Otherwise the WebSocket will not be enabled.
			</div></div></div>

	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140550791790400">
      ⁠</a><p class="title"><strong>Procedure 17.1. Create the WebSocket Application</strong></p><div class="para">
			The following is a simple example of a WebSocket application. It provides buttons to open a connection, send a message, and close a connection. It does not implement any other functions or include any error handling, which would be required for a real world application.
		</div><ol class="1"><li class="step"><p class="title"><strong>Create the JavaScript HTML client.</strong></p><div class="para">
				The following is an example of a WebSocket client. It contains these JavaScript functions: 
				<div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="code">connect()</code>: This function creates the WebSocket connection passing the WebSocket URI. The resource location matches the resource defined in the server endpoint class. This function also intercepts and handles the WebSocket <code class="code">onopen</code>, <code class="code">onmessage</code>, <code class="code">onerror</code>, and <code class="code">onclose</code>.
						</div></li><li class="listitem"><div class="para">
							<code class="code">sendMessage()</code>: This function gets the name entered in the form, creates a message, and sends it using a WebSocket.send() command.
						</div></li><li class="listitem"><div class="para">
							<code class="code">disconnect()</code>: This function issues the WebSocket.close() command.
						</div></li><li class="listitem"><div class="para">
							<code class="code">displayMessage()</code>: This function sets the display message on the page to the value returned by the WebSocket endpoint method.
						</div></li><li class="listitem"><div class="para">
							<code class="code">displayStatus()</code>: This function displays the WebSocket connection status.
						</div></li></ul></div>
				 l
			</div><div class="para">
				
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;html</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://www.w3.org/1999/xhtml"</span><span xmlns="" class="perl_Others"> xml:lang=</span><span xmlns="" class="perl_String">"en"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;head&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;title&gt;</span>WebSocket: Say Hello<span xmlns="" class="perl_Keyword">&lt;/title&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;link</span><span xmlns="" class="perl_Others"> rel=</span><span xmlns="" class="perl_String">"stylesheet"</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"text/css"</span><span xmlns="" class="perl_Others"> href=</span><span xmlns="" class="perl_String">"resources/css/hello.css"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;script</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"text/javascript"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>            var websocket = null;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>            function connect() {
<span xmlns="" class="line">​</span>                var wsURI = 'ws://' + window.location.host + '/jboss-websocket-hello/websocket/helloName';
<span xmlns="" class="line">​</span>                websocket = new WebSocket(wsURI);
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>                websocket.onopen = function() {
<span xmlns="" class="line">​</span>                    displayStatus('Open');
<span xmlns="" class="line">​</span>                    document.getElementById('sayHello').disabled = false;
<span xmlns="" class="line">​</span>                    displayMessage('Connection is now open. Type a name and click Say Hello to send a message.');
<span xmlns="" class="line">​</span>                };
<span xmlns="" class="line">​</span>                websocket.onmessage = function(event) {
<span xmlns="" class="line">​</span>                    // log the event                
<span xmlns="" class="line">​</span>                    displayMessage('The response was received! ' + event.data, 'success');
<span xmlns="" class="line">​</span>                };
<span xmlns="" class="line">​</span>                websocket.onerror = function(event) {
<span xmlns="" class="line">​</span>                    // log the event
<span xmlns="" class="line">​</span>                    displayMessage('Error! ' + event.data, 'error');
<span xmlns="" class="line">​</span>                };
<span xmlns="" class="line">​</span>                websocket.onclose = function() {
<span xmlns="" class="line">​</span>                    displayStatus('Closed');
<span xmlns="" class="line">​</span>                    displayMessage('The connection was closed or timed out. Please click the Open Connection button to reconnect.');
<span xmlns="" class="line">​</span>                    document.getElementById('sayHello').disabled = true;
<span xmlns="" class="line">​</span>                };
<span xmlns="" class="line">​</span>            }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>            function disconnect() {
<span xmlns="" class="line">​</span>                if (websocket !== null) {
<span xmlns="" class="line">​</span>                    websocket.close();
<span xmlns="" class="line">​</span>                    websocket = null;
<span xmlns="" class="line">​</span>                }
<span xmlns="" class="line">​</span>                message.setAttribute("class", "message");
<span xmlns="" class="line">​</span>                message.value = 'WebSocket closed.';
<span xmlns="" class="line">​</span>                // log the event
<span xmlns="" class="line">​</span>            }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>            function sendMessage() {
<span xmlns="" class="line">​</span>                if (websocket !== null) {
<span xmlns="" class="line">​</span>                    var content = document.getElementById('name').value;
<span xmlns="" class="line">​</span>                    websocket.send(content);
<span xmlns="" class="line">​</span>                } else {
<span xmlns="" class="line">​</span>                    displayMessage('WebSocket connection is not established. Please click the Open Connection button.', 'error');
<span xmlns="" class="line">​</span>                }
<span xmlns="" class="line">​</span>            }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>            function displayMessage(data, style) {
<span xmlns="" class="line">​</span>                var message = document.getElementById('hellomessage');
<span xmlns="" class="line">​</span>                message.setAttribute("class", style);
<span xmlns="" class="line">​</span>                message.value = data;
<span xmlns="" class="line">​</span>            }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>            function displayStatus(status) {
<span xmlns="" class="line">​</span>                var currentStatus = document.getElementById('currentstatus');
<span xmlns="" class="line">​</span>                currentStatus.value = status;
<span xmlns="" class="line">​</span>            }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/script&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/head&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;body&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;div&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;h1&gt;</span>Welcome to JBoss!<span xmlns="" class="perl_Keyword">&lt;/h1&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;div&gt;</span>This is a simple example of a WebSocket implementation.<span xmlns="" class="perl_Keyword">&lt;/div&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;div</span><span xmlns="" class="perl_Others"> id=</span><span xmlns="" class="perl_String">"connect-container"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;div&gt;</span>
<span xmlns="" class="line">​</span>                    <span xmlns="" class="perl_Keyword">&lt;fieldset&gt;</span>
<span xmlns="" class="line">​</span>                        <span xmlns="" class="perl_Keyword">&lt;legend&gt;</span>Connect or disconnect using WebSocket :<span xmlns="" class="perl_Keyword">&lt;/legend&gt;</span>
<span xmlns="" class="line">​</span>                        <span xmlns="" class="perl_Keyword">&lt;input</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"button"</span><span xmlns="" class="perl_Others"> id=</span><span xmlns="" class="perl_String">"connect"</span><span xmlns="" class="perl_Others"> onclick=</span><span xmlns="" class="perl_String">"connect();"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"Open Connection"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>                        <span xmlns="" class="perl_Keyword">&lt;input</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"button"</span><span xmlns="" class="perl_Others"> id=</span><span xmlns="" class="perl_String">"disconnect"</span><span xmlns="" class="perl_Others"> onclick=</span><span xmlns="" class="perl_String">"disconnect();"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"Close Connection"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>                    <span xmlns="" class="perl_Keyword">&lt;/fieldset&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;/div&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;div&gt;</span>
<span xmlns="" class="line">​</span>                    <span xmlns="" class="perl_Keyword">&lt;fieldset&gt;</span>
<span xmlns="" class="line">​</span>                        <span xmlns="" class="perl_Keyword">&lt;legend&gt;</span>Type your name below. then click the `Say Hello` button :<span xmlns="" class="perl_Keyword">&lt;/legend&gt;</span>
<span xmlns="" class="line">​</span>                        <span xmlns="" class="perl_Keyword">&lt;input</span><span xmlns="" class="perl_Others"> id=</span><span xmlns="" class="perl_String">"name"</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"text"</span><span xmlns="" class="perl_Others"> size=</span><span xmlns="" class="perl_String">"40"</span><span xmlns="" class="perl_Others"> style=</span><span xmlns="" class="perl_String">"width: 40%"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>                        <span xmlns="" class="perl_Keyword">&lt;input</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"button"</span><span xmlns="" class="perl_Others"> id=</span><span xmlns="" class="perl_String">"sayHello"</span><span xmlns="" class="perl_Others"> onclick=</span><span xmlns="" class="perl_String">"sendMessage();"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"Say Hello"</span><span xmlns="" class="perl_Others"> disabled=</span><span xmlns="" class="perl_String">"disabled"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>                    <span xmlns="" class="perl_Keyword">&lt;/fieldset&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;/div&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;div&gt;</span>Current WebSocket Connection Status: <span xmlns="" class="perl_Keyword">&lt;output</span><span xmlns="" class="perl_Others"> id=</span><span xmlns="" class="perl_String">"currentstatus"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"message"</span><span xmlns="" class="perl_Keyword">&gt;</span>Closed<span xmlns="" class="perl_Keyword">&lt;/output&gt;&lt;/div&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;div&gt;</span>
<span xmlns="" class="line">​</span>                    <span xmlns="" class="perl_Keyword">&lt;output</span><span xmlns="" class="perl_Others"> id=</span><span xmlns="" class="perl_String">"hellomessage"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>                <span xmlns="" class="perl_Keyword">&lt;/div&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;/div&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/div&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/body&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/html&gt;</span></pre>

			</div></li><li class="step"><p class="title"><strong>Create the WebSocket server endpoint.</strong></p><div class="para">
				You can create a WebSocket server endpoint using either of the following methods. 
				<div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="literal">Programmatic Endpoint</code>: The endpoint extends the Endpoint class.
						</div></li><li class="listitem"><div class="para">
							<code class="literal">Annotated Endpoint</code>: The endpoint class uses annotations to interact with the WebSocket events. It is simpler to code than the programmatic endpoint
						</div></li></ul></div>
				 The code example below uses the annotated endpoint approach and handles the following events. 
				<div class="itemizedlist"><ul><li class="listitem"><div class="para">
							The <code class="code">@ServerEndpoint</code> annotation identifies this class as a WebSocket server endpoint and specifies the path.
						</div></li><li class="listitem"><div class="para">
							The <code class="code">@OnOpen</code> annotation is triggered when the WebSocket connection is opened.
						</div></li><li class="listitem"><div class="para">
							The <code class="code">@OnMessage</code> annotation is triggered when a message is sent to the WebSocket connection.
						</div></li><li class="listitem"><div class="para">
							The <code class="code">@OnClose</code> annotation is triggered when the WebSocket connection is closed.
						</div></li></ul></div>

			</div><div class="para">
				
<pre class="programlisting JAVA"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>package org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">as</span>.<span xmlns="" class="perl_Function">quickstarts</span>.<span xmlns="" class="perl_Function">websocket_hello</span>;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.websocket.CloseReason;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.websocket.OnClose;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.websocket.OnMessage;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.websocket.OnOpen;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.websocket.Session;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.websocket.server.ServerEndpoint;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">ServerEndpoint</span>(<span xmlns="" class="perl_String">"/websocket/helloName"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> HelloName {
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    @OnMessage
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">sayHello</span>(String name) {
<span xmlns="" class="line">​</span>        System.<span xmlns="" class="perl_Function">out</span>.<span xmlns="" class="perl_Function">println</span>(<span xmlns="" class="perl_String">"Say hello to '"</span> + name + <span xmlns="" class="perl_String">"'"</span>);
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> (<span xmlns="" class="perl_String">"Hello"</span> + name);    
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    @OnOpen
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">helloOnOpen</span>(Session session) {
<span xmlns="" class="line">​</span>        System.<span xmlns="" class="perl_Function">out</span>.<span xmlns="" class="perl_Function">println</span>(<span xmlns="" class="perl_String">"WebSocket opened: "</span> + session.<span xmlns="" class="perl_Function">getId</span>());
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>    
<span xmlns="" class="line">​</span>    @OnClose
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">helloOnClose</span>(CloseReason reason) {
<span xmlns="" class="line">​</span>        System.<span xmlns="" class="perl_Function">out</span>.<span xmlns="" class="perl_Function">println</span>(<span xmlns="" class="perl_String">"Closing a WebSocket due to "</span> + reason.<span xmlns="" class="perl_Function">getReasonPhrase</span>());
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
</pre>

			</div></li><li class="step"><p class="title"><strong>Configure the jboss-web.xml file.</strong></p><div class="para">
				You must create the <code class="code">&lt;enable-websockets&gt;</code> element in the application <code class="filename">WEB-INF/jboss-web.xml</code> and set it to <code class="literal">true</code>. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!--Enable WebSockets --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-web&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;enable-websockets&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/enable-websockets&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-web&gt;</span></pre>

			</div></li><li class="step"><p class="title"><strong>Declare the WebSocket API dependency in your project POM file.</strong></p><div class="para">
				If you use Maven, you add the following dependency to the project <code class="filename">pom.xml</code> file. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;dependency&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;groupId&gt;</span>org.jboss.spec.javax.websocket<span xmlns="" class="perl_Keyword">&lt;/groupId&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;artifactId&gt;</span>jboss-websocket-api_1.0_spec<span xmlns="" class="perl_Keyword">&lt;/artifactId&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;version&gt;</span>1.0.0.Final<span xmlns="" class="perl_Keyword">&lt;/version&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;scope&gt;</span>provided<span xmlns="" class="perl_Keyword">&lt;/scope&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/dependency&gt;</span>
</pre>

			</div></li><li class="step"><p class="title"><strong>Configure the JBoss EAP server.</strong></p><div class="para">
				Configure the <code class="literal">http</code> <code class="code">&lt;connector&gt;</code> in the <code class="literal">web</code> subsystem of the server configuration file to use the <code class="literal">NIO2</code> protocol.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Start the JBoss EAP server.
					</div></li><li class="step"><div class="para">
						Launch the Management CLI using the command for your operating system.
					</div><div class="para">
						For Linux: 
<pre class="screen"><code class="command"><em class="replaceable">EAP_HOME</em>/bin/jboss-cli.sh --connect</code></pre>
						 For Windows: 
<pre class="screen"><code class="command"><em class="replaceable">EAP_HOME</em>\bin\jboss-cli.bat --connect</code></pre>

					</div></li><li class="step"><div class="para">
						To enable the non blocking Java <code class="literal">NIO2</code> connector protocol in the <code class="literal">web</code> subsystem of the JBoss EAP server configuration file, type the following command . 
<pre class="screen"><code class="command">/subsystem=web/connector=http/:write-attribute(name=protocol,value=org.apache.coyote.http11.Http11NioProtocol)</code></pre>

					</div><div class="para">

					</div><div class="para">
						For either command, you should see the following result: 
<pre class="screen">{
    "outcome" =&gt; "success",
    "response-headers" =&gt; {
        "operation-requires-reload" =&gt; true,
        "process-state" =&gt; "reload-required"
    }
}</pre>

					</div></li><li class="step"><div class="para">
						Notify the server to reload the configuration. 
<pre class="screen"><code class="command">reload</code></pre>

					</div><div class="para">
						You should see the following result: 
<pre class="screen">{
    "outcome" =&gt; "success",
    "result" =&gt; undefined
}
</pre>

					</div></li><li class="step"><div class="para">
						Review the changes to the JBoss EAP server configuration file. The <code class="literal">web</code> subsystem should now contain the following XML for the <code class="literal">http</code> <code class="code">&lt;connector&gt;</code>.
					</div><div class="para">
						
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:web:2.1"</span><span xmlns="" class="perl_Others"> default-virtual-server=</span><span xmlns="" class="perl_String">"default-host"</span><span xmlns="" class="perl_Others"> native=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;connector</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"http"</span><span xmlns="" class="perl_Others"> protocol=</span><span xmlns="" class="perl_String">"org.apache.coyote.http11.Http11NioProtocol"</span><span xmlns="" class="perl_Others"> scheme=</span><span xmlns="" class="perl_String">"http"</span><span xmlns="" class="perl_Others"> socket-binding=</span><span xmlns="" class="perl_String">"http"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;virtual-server</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"default-host"</span><span xmlns="" class="perl_Others"> enable-welcome-root=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;alias</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"localhost"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;alias</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"example.com"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/virtual-server&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/subsystem&gt;</span></pre>

					</div></li></ol></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+30607-764499+%5BLatest%5D&amp;comment=Title%3A+Create+a+WebSocket+Application%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=30607-764499+10+Jul+2015+04%3A59+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div></body></html>