<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 13. Hibernate</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="chap-Hibernate">
      ⁠</a>Chapter 13. Hibernate</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="About_Hibernate_Core1">
      ⁠</a>13.1. About Hibernate Core</h1></div></div></div><div class="para">
		Hibernate Core is an object/relational mapping library. It provides the framework for mapping Java classes to database tables, allowing applications to avoid direct interaction with the database.
	</div><div class="para">
		For more information, refer to <a class="xref" href="chap-Hibernate.html#Hibernate_EntityManager1">Section 13.2.2, “Hibernate EntityManager”</a> and the <a class="xref" href="chap-Hibernate.html#About_JPA1">Section 13.2.1, “About JPA”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+2252-591649+%5BLatest%5D&amp;comment=Title%3A+About+Hibernate+Core%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=2252-591649+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-Java_Persistence_API_JPA">
      ⁠</a>13.2. Java Persistence API (JPA)</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_JPA1">
      ⁠</a>13.2.1. About JPA</h2></div></div></div><div class="para">
		The Java Persistence API (JPA) is the standard for using persistence in Java projects. Java EE 6 applications use the Java Persistence 2.0 specification, documented here: <a href="http://www.jcp.org/en/jsr/detail?id=317">http://www.jcp.org/en/jsr/detail?id=317</a>.
	</div><div class="para">
		Hibernate EntityManager implements the programming interfaces and life-cycle rules defined by the specification. It provides JBoss EAP 6 with a complete Java Persistence solution.
	</div><div class="para">
		JBoss EAP 6 is 100% compliant with the Java Persistence 2.0 specification. Hibernate also provides additional features to the specification.
	</div><div class="para">
		To get started with JPA and JBoss EAP 6, refer to the <code class="literal">bean-validation</code>, <code class="literal">greeter</code>, and <code class="literal">kitchensink</code> quickstarts: <a class="xref" href="chap-Get_Started_Developing_Applications.html#Access_the_Java_EE_Quickstart_Examples">Section 1.4.1.1, “Access the Quickstarts”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+1089-591647+%5BLatest%5D&amp;comment=Title%3A+About+JPA%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=1089-591647+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Hibernate_EntityManager1">
      ⁠</a>13.2.2. Hibernate EntityManager</h2></div></div></div><div class="para">
		Hibernate EntityManager implements the programming interfaces and life-cycle rules defined by the <a href="http://jcp.org/en/jsr/detail?id=317">JPA 2.0 specification</a>. It provides JBoss EAP 6 with a complete Java Persistence solution.
	</div><div class="para">
		For more information about Java Persistence or Hibernate, refer to the <a class="xref" href="chap-Hibernate.html#About_JPA1">Section 13.2.1, “About JPA”</a> and <a class="xref" href="chap-Hibernate.html#About_Hibernate_Core1">Section 13.1, “About Hibernate Core”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+2246-591649+%5BLatest%5D&amp;comment=Title%3A+Hibernate+EntityManager%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=2246-591649+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Getting_Started">
      ⁠</a>13.2.3. Getting Started</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Create_a_JPA_project_in_JBoss_Developer_Studio1">
      ⁠</a>13.2.3.1. Create a JPA project in Red Hat JBoss Developer Studio</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			This example covers the steps required to create a JPA project in Red Hat JBoss Developer Studio.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140550789166672">
      ⁠</a><p class="title"><strong>Procedure 13.1. Create a JPA project in Red Hat JBoss Developer Studio</strong></p><ol class="1"><li class="step"><div class="para">
				In the Red Hat JBoss Developer Studio window, click <span class="guimenu"><strong>File</strong></span> → <span class="guimenuitem"><strong>New</strong></span> → <span class="guimenuitem"><strong>Project</strong></span>. Find <span class="guilabel"><strong>JPA</strong></span> in the list, expand it, and select <span class="guilabel"><strong>JPA Project</strong></span>. You are presented with the following dialog. 
				<div class="mediaobject"><img src="images/6586.png" alt="Create a JPA project in Red Hat JBoss Developer Studio"/></div>

			</div></li><li class="step"><div class="para">
				Enter a <span class="guilabel"><strong>Project name</strong></span>.
			</div></li><li class="step"><div class="para">
				Select a <span class="guilabel"><strong>Target runtime</strong></span>. If no target runtime is available, follow these instructions to define a new server and runtime: <a class="xref" href="chap-Get_Started_Developing_Applications.html#Add_the_JBoss_EAP_Server_Using_Define_New_Server">Section 1.3.1.5, “Add the JBoss EAP Server Using Define New Server”</a>.
			</div></li><li class="step"><div class="para">
				Under <span class="guilabel"><strong>JPA version</strong></span>, ensure <span class="guilabel"><strong>2.1</strong></span> is selected.
			</div></li><li class="step"><div class="para">
				Under <span class="guilabel"><strong>Configuration</strong></span>, choose <span class="guilabel"><strong>Basic JPA Configuration</strong></span>.
			</div></li><li class="step"><div class="para">
				Click <span class="guibutton"><strong>Finish</strong></span>.
			</div></li><li class="step"><div class="para">
				If prompted, choose whether you wish to associate this type of project with the JPA perspective window.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+5462-747162+%5BLatest%5D&amp;comment=Title%3A+Create+a+JPA+project+in+Red+Hat+JBoss+Developer+Studio%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5462-747162+13+Mar+2015+10%3A48+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Create_the_Persistence_Settings_File_in_JBoss_Developer_Studio1">
      ⁠</a>13.2.3.2. Create the Persistence Settings File in Red Hat JBoss Developer Studio</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			This topic covers the process for creating the <code class="filename">persistence.xml</code> file in a Java project using Red Hat JBoss Developer Studio.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				<a class="xref" href="chap-Get_Started_Developing_Applications.html#Start_JBoss_Developer_Studio">Section 1.3.1.4, “Start Red Hat JBoss Developer Studio”</a>
			</div></li></ul></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140550800166448">
      ⁠</a><p class="title"><strong>Procedure 13.2. Create and Configure a new Persistence Settings File</strong></p><ol class="1"><li class="step"><div class="para">
				Open an EJB 3.x project in Red Hat JBoss Developer Studio.
			</div></li><li class="step"><div class="para">
				Right click the project root directory in the <span class="guilabel"><strong>Project Explorer</strong></span> panel.
			</div></li><li class="step"><div class="para">
				Select <span class="guimenu"><strong>New</strong></span> → <span class="guimenuitem"><strong>Other...</strong></span>.
			</div></li><li class="step"><div class="para">
				Select <span class="guilabel"><strong>XML File</strong></span> from the <span class="guilabel"><strong>XML</strong></span> folder and click <span class="guibutton"><strong>Next</strong></span>.
			</div></li><li class="step"><div class="para">
				Select the <code class="filename">ejbModule/META-INF</code> folder as the parent directory.
			</div></li><li class="step"><div class="para">
				Name the file <code class="filename">persistence.xml</code> and click <span class="guibutton"><strong>Next</strong></span>.
			</div></li><li class="step"><div class="para">
				Select <span class="guilabel"><strong>Create XML file from an XML schema file</strong></span> and click <span class="guibutton"><strong>Next</strong></span>.
			</div></li><li class="step"><div class="para">
				Select <span class="guilabel"><strong>http://java.sun.com/xml/ns/persistence/persistence_2.0.xsd</strong></span> from the <span class="guilabel"><strong>Select XML Catalog entry</strong></span> list and click <span class="guibutton"><strong>Next</strong></span>.
			</div><div class="mediaobject"><img src="images/32.png" alt="Create and Configure a new Persistence Settings File"/></div></li><li class="step"><div class="para">
				Click <span class="guibutton"><strong>Finish</strong></span> to create the file.
			</div></li></ol></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Result:</span></dt><dd><div class="para">
					The <code class="filename">persistence.xml</code> has been created in the <code class="filename">META-INF/</code> folder and is ready to be configured. An example file is available here: <a class="xref" href="chap-Hibernate.html#Example_Persistence_Settings_File">Section 13.2.3.3, “Example Persistence Settings File”</a>
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+4430-681248+%5BLatest%5D&amp;comment=Title%3A+Create+the+Persistence+Settings+File+in+Red+Hat+JBoss+Developer+Studio%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4430-681248+03+Jul+2014+11%3A08+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Example_Persistence_Settings_File">
      ⁠</a>13.2.3.3. Example Persistence Settings File</h3></div></div></div><div class="example"><a id="idm140550768371472">
      ⁠</a><p class="title"><strong>Example 13.1. persistence.xml</strong></p><div class="example-contents"><pre class="programlisting">&lt;persistence xmlns="http://java.sun.com/xml/ns/persistence"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
   version="2.0"&gt;
   &lt;persistence-unit name="example" transaction-type="JTA"&gt;
      &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;
      &lt;jta-data-source&gt;java:jboss/datasources/ExampleDS&lt;/jta-data-source&gt;
      &lt;mapping-file&gt;ormap.xml&lt;/mapping-file&gt;
      &lt;jar-file&gt;TestApp.jar&lt;/jar-file&gt;
      &lt;class&gt;org.test.Test&lt;/class&gt;
      &lt;shared-cache-mode&gt;NONE&lt;/shared-cache-mode&gt;
      &lt;validation-mode&gt;CALLBACK&lt;/validation-mode&gt;
      &lt;properties&gt;
         &lt;property name="hibernate.dialect" value="org.hibernate.dialect.H2Dialect"/&gt;
         &lt;property name="hibernate.hbm2ddl.auto" value="create-drop"/&gt;
      &lt;/properties&gt;
   &lt;/persistence-unit&gt;
&lt;/persistence&gt;</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+4431-591662+%5BLatest%5D&amp;comment=Title%3A+Example+Persistence+Settings+File%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4431-591662+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Create_the_Hibernate_Configuration_File_in_JBoss_Developer_Studio1">
      ⁠</a>13.2.3.4. Create the Hibernate Configuration File in Red Hat JBoss Developer Studio</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				<a class="xref" href="chap-Get_Started_Developing_Applications.html#Start_JBoss_Developer_Studio">Section 1.3.1.4, “Start Red Hat JBoss Developer Studio”</a>
			</div></li></ul></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			This topic covers the process for creating the <code class="filename">hibernate.cfg.xml</code> file in a Java project using Red Hat JBoss Developer Studio.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140550774709040">
      ⁠</a><p class="title"><strong>Procedure 13.3. Create a New Hibernate Configuration File</strong></p><ol class="1"><li class="step"><div class="para">
				Open a Java project in Red Hat JBoss Developer Studio.
			</div></li><li class="step"><div class="para">
				Right click the project root directory in the <span class="guilabel"><strong>Project Explorer</strong></span> panel.
			</div></li><li class="step"><div class="para">
				Select <span class="guimenu"><strong>New</strong></span> → <span class="guimenuitem"><strong>Other...</strong></span>.
			</div></li><li class="step"><div class="para">
				Select <span class="guilabel"><strong>Hibernate Configuration File</strong></span> from the <span class="guilabel"><strong>Hibernate</strong></span> folder and click <span class="guibutton"><strong>Next</strong></span>.
			</div></li><li class="step"><div class="para">
				Select the <code class="filename">src/</code> directory and click <span class="guibutton"><strong>Next</strong></span>.
			</div></li><li class="step"><div class="para">
				Configure the following:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						Session factory name
					</div></li><li class="listitem"><div class="para">
						Database dialect
					</div></li><li class="listitem"><div class="para">
						Driver class
					</div></li><li class="listitem"><div class="para">
						Connection URL
					</div></li><li class="listitem"><div class="para">
						Username
					</div></li><li class="listitem"><div class="para">
						Password
					</div></li></ul></div></li><li class="step"><div class="para">
				Click <span class="guibutton"><strong>Finish</strong></span> to create the file.
			</div></li></ol></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Result:</span></dt><dd><div class="para">
					The <code class="filename">hibernate.cfg.xml</code> has been created in the <code class="filename">src/</code> folder. An example file is available here: <a class="xref" href="chap-Hibernate.html#Example_Hibernate_Configuration_File1">Section 13.2.3.5, “Example Hibernate Configuration File”</a>.
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+5177-681249+%5BLatest%5D&amp;comment=Title%3A+Create+the+Hibernate+Configuration+File+in+Red+Hat+JBoss+Developer+Studio%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5177-681249+03+Jul+2014+11%3A09+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Example_Hibernate_Configuration_File1">
      ⁠</a>13.2.3.5. Example Hibernate Configuration File</h3></div></div></div><div class="example"><a id="idm140550785543392">
      ⁠</a><p class="title"><strong>Example 13.2. hibernate.cfg.xml</strong></p><div class="example-contents"><pre class="programlisting">&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;!DOCTYPE hibernate-configuration PUBLIC
        "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"&gt;

&lt;hibernate-configuration&gt;

    &lt;session-factory&gt;

        &lt;!-- Datasource Name --&gt;
        &lt;property name="connection.datasource"&gt;ExampleDS&lt;/property&gt;

        &lt;!-- SQL dialect --&gt;
        &lt;property name="dialect"&gt;org.hibernate.dialect.H2Dialect&lt;/property&gt;

        &lt;!-- Enable Hibernate's automatic session context management --&gt;
        &lt;property name="current_session_context_class"&gt;thread&lt;/property&gt;

        &lt;!-- Disable the second-level cache  --&gt;
        &lt;property name="cache.region.factory_class"&gt;org.hibernate.cache.NoCacheProvider&lt;/property&gt;

        &lt;!-- Echo all executed SQL to stdout --&gt;
        &lt;property name="show_sql"&gt;true&lt;/property&gt;

        &lt;!-- Update the database schema on startup --&gt;
        &lt;property name="hbm2ddl.auto"&gt;update&lt;/property&gt;

        &lt;mapping resource="org/hibernate/tutorial/domain/Event.hbm.xml"/&gt;

    &lt;/session-factory&gt;

&lt;/hibernate-configuration&gt;</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+4413-638622+%5BLatest%5D&amp;comment=Title%3A+Example+Hibernate+Configuration+File%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4413-638622+06+May+2014+12%3A31+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Configuration1">
      ⁠</a>13.2.4. Configuration</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Hibernate_Configuration_Properties1">
      ⁠</a>13.2.4.1. Hibernate Configuration Properties</h3></div></div></div><div class="table"><a id="idm140550736304016">
      ⁠</a><p class="title"><strong>Table 13.1. Hibernate Java Properties</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-14-rows" summary="Hibernate Java Properties"><colgroup><col width="40%" class="c1"/><col width="60%" class="c2"/></colgroup><thead><tr><th> Property Name </th><th> Description </th></tr></thead><tbody><tr><td> <span class="property">hibernate.dialect</span> </td><td> <div class="para">
						The classname of a Hibernate <code class="classname">org.hibernate.dialect.Dialect</code>. Allows Hibernate to generate SQL optimized for a particular relational database.
					</div>
					 <div class="para">
						In most cases Hibernate will be able to choose the correct <code class="classname">org.hibernate.dialect.Dialect</code> implementation, based on the <code class="literal">JDBC metadata</code> returned by the JDBC driver.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.show_sql</span> </td><td> <div class="para">
						Boolean. Writes all SQL statements to console. This is an alternative to setting the log category <code class="literal">org.hibernate.SQL</code> to <code class="literal">debug</code>.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.format_sql</span> </td><td> <div class="para">
						Boolean. Pretty print the SQL in the log and console.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.default_schema</span> </td><td> <div class="para">
						Qualify unqualified table names with the given schema/tablespace in generated SQL.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.default_catalog</span> </td><td> <div class="para">
						Qualifies unqualified table names with the given catalog in generated SQL.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.session_factory_name</span> </td><td> <div class="para">
						The <code class="interfacename">org.hibernate.SessionFactory</code> will be automatically bound to this name in JNDI after it has been created. For example, <code class="literal">jndi/composite/name</code>.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.max_fetch_depth</span> </td><td> <div class="para">
						Sets a maximum "depth" for the outer join fetch tree for single-ended associations (one-to-one, many-to-one). A <code class="literal">0</code> disables default outer join fetching. The recommended value is between <code class="literal">0</code> and <code class="literal">3</code>.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.default_batch_fetch_size</span> </td><td> <div class="para">
						Sets a default size for Hibernate batch fetching of associations. The recommended values are <code class="literal">4</code>, <code class="literal">8</code>, and <code class="literal">16</code>.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.default_entity_mode</span> </td><td> <div class="para">
						Sets a default mode for entity representation for all sessions opened from this <code class="literal">SessionFactory</code>. Values include: <code class="literal">dynamic-map</code>, <code class="literal">dom4j</code>, <code class="literal">pojo</code>.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.order_updates</span> </td><td> <div class="para">
						Boolean. Forces Hibernate to order SQL updates by the primary key value of the items being updated. This will result in fewer transaction deadlocks in highly concurrent systems.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.generate_statistics</span> </td><td> <div class="para">
						Boolean. If enabled, Hibernate will collect statistics useful for performance tuning.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.use_identifier_rollback</span> </td><td> <div class="para">
						Boolean. If enabled, generated identifier properties will be reset to default values when objects are deleted.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.use_sql_comments</span> </td><td> <div class="para">
						Boolean. If turned on, Hibernate will generate comments inside the SQL, for easier debugging. Default value is <code class="literal">false</code>.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.id.new_generator_mappings</span> </td><td> <div class="para">
						Boolean. This property is relevant when using <code class="classname">@GeneratedValue</code>. It indicates whether or not the new <code class="classname">IdentifierGenerator</code> implementations are used for <code class="classname">javax.persistence.GenerationType.AUTO</code>, <code class="classname">javax.persistence.GenerationType.TABLE</code> and <code class="classname">javax.persistence.GenerationType.SEQUENCE</code>. Default value is <code class="literal">true</code>.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.ejb.naming_strategy</span> </td><td> <div class="para">
						Chooses the <code class="code">org.hibernate.cfg.NamingStrategy</code> implementation when using Hibernate EntityManager. This class is deprecated and this property is only provided for backward compatibility. This property must not be used with <code class="code">hibernate.ejb.naming_strategy_delegator</code>.
					</div>
					 <div class="para">
						If the application does not use EntityManager, follow the instructions here to configure the NamingStrategy: <a href="http://docs.jboss.org/hibernate/orm/4.2/manual/en-US/html_single/#configuration-namingstrategy">Hibernate Reference Documentation - Implementing a Naming Strategy</a>.
					</div>
					 </td></tr><tr><td> <span class="property">hibernate.ejb.naming_strategy_delegator</span> </td><td> <div class="para">
						Specifies an <code class="code">org.hibernate.cfg.naming.NamingStrategyDelegator</code> implementation for database objects and schema elements when using Hibernate EntityManager. This property has the following possible values. 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									<code class="code">org.hibernate.cfg.naming.LegacyNamingStrategyDelegator</code>: This is the default value. This class is deprecated and is only provided for backward compatibility.
								</div></li><li class="listitem"><div class="para">
									<code class="code">org.hibernate.cfg.naming.ImprovedNamingStrategyDelegator</code>: This is the preferred value. It generates default table and column names that comply with the JPA specification. It allows for specification of both the entity and foreign key class names. This class only affects entities that are mapped using Java annotations or JPA XML descriptors. Entities mapped using <code class="filename">hbm.xml</code> are not affected,
								</div></li><li class="listitem"><div class="para">
									If you prefer, you can configure a custom class that implements <code class="code">org.hibernate.cfg.naming.ImprovedNamingStrategyDelegator</code>
								</div></li></ul></div>
						 <div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
								This property must not be used with <code class="code">hibernate.ejb.naming_strategy</code>. It is a temporary replacement for <code class="code">org.hibernate.cfg.NamingStrategy</code> to address its limitations. A more comprehensive solution is planned for Hibernate 5.0 that replaces both <code class="code">org.hibernate.cfg.NamingStrategy</code> and <code class="code">org.hibernate.cfg.naming.NamingStrategyDelegator</code>.
							</div></div></div>

					</div>
					 <div class="para">
						If the application does not use EntityManager, follow the instructions here to configure the NamingStrategy: <a href="http://docs.jboss.org/hibernate/orm/4.2/manual/en-US/html_single/#configuration-namingstrategy">Hibernate Reference Documentation - Implementing a Naming Strategy</a>.
					</div>
					 </td></tr></tbody></table></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			For <code class="code">hibernate.id.new_generator_mappings</code>, new applications should keep the default value of <code class="literal">true</code>. Existing applications that used Hibernate 3.3.x may need to change it to <code class="literal">false</code> to continue using a sequence object or table based generator, and maintain backward compatibility.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+7447-754202+%5BLatest%5D&amp;comment=Title%3A+Hibernate+Configuration+Properties%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7447-754202+24+Apr+2015+00%3A36+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Hibernate_JDBC_and_Connection_Properties">
      ⁠</a>13.2.4.2. Hibernate JDBC and Connection Properties</h3></div></div></div><div class="table"><a id="idm140550810324512">
      ⁠</a><p class="title"><strong>Table 13.2. Properties</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-7-rows" summary="Properties"><colgroup><col width="50%" class="c1"/><col width="50%" class="c2"/></colgroup><thead><tr><th> Property Name </th><th> Description </th></tr></thead><tbody><tr><td> <span class="property"> hibernate.jdbc.fetch_size</span> </td><td> <div class="para">
						A non-zero value that determines the JDBC fetch size (calls <code class="literal">Statement.setFetchSize()</code>).
					</div>
					 </td></tr><tr><td> <span class="property"> hibernate.jdbc.batch_size</span> </td><td> <div class="para">
						A non-zero value enables use of JDBC2 batch updates by Hibernate. The recommended values are between <code class="literal">5</code> and <code class="literal">30</code>.
					</div>
					 </td></tr><tr><td> <span class="property"> hibernate.jdbc.batch_versioned_data</span> </td><td> <div class="para">
						Boolean. Set this property to <code class="literal">true</code> if the JDBC driver returns correct row counts from <code class="literal">executeBatch()</code>. Hibernate will then use batched DML for automatically versioned data. Default value is to <code class="literal">false</code>.
					</div>
					 </td></tr><tr><td> <span class="property"> hibernate.jdbc.factory_class</span> </td><td> <div class="para">
						Select a custom <code class="interfacename"> org.hibernate.jdbc.Batcher</code>. Most applications will not need this configuration property.
					</div>
					 </td></tr><tr><td> <span class="property"> hibernate.jdbc.use_scrollable_resultset</span> </td><td> <div class="para">
						Boolean. Enables use of JDBC2 scrollable resultsets by Hibernate. This property is only necessary when using user-supplied JDBC connections. Hibernate uses connection metadata otherwise.
					</div>
					 </td></tr><tr><td> <span class="property"> hibernate.jdbc.use_streams_for_binary</span> </td><td> <div class="para">
						Boolean. This is a system-level property. Use streams when writing/reading <code class="literal">binary</code> or <code class="literal">serializable</code> types to/from JDBC.
					</div>
					 </td></tr><tr><td> <span class="property"> hibernate.jdbc.use_get_generated_keys</span> </td><td> <div class="para">
						Boolean. Enables use of JDBC3 <code class="literal">PreparedStatement.getGeneratedKeys()</code> to retrieve natively generated keys after insert. Requires JDBC3+ driver and JRE1.4+. Set to false if JDBC driver has problems with the Hibernate identifier generators. By default, it tries to determine the driver capabilities using connection metadata.
					</div>
					 </td></tr><tr><td> <span class="property"> hibernate.connection.provider_class</span> </td><td> <div class="para">
						The classname of a custom <code class="interfacename"> org.hibernate.connection.ConnectionProvider</code> which provides JDBC connections to Hibernate.
					</div>
					 </td></tr><tr><td> <span class="property"> hibernate.connection.isolation</span> </td><td> <div class="para">
						Sets the JDBC transaction isolation level. Check <code class="interfacename"> java.sql.Connection</code> for meaningful values, but note that most databases do not support all isolation levels and some define additional, non-standard isolations. Standard values are <code class="literal">1, 2, 4, 8</code>.
					</div>
					 </td></tr><tr><td> <span class="property"> hibernate.connection.autocommit</span> </td><td> <div class="para">
						Boolean. This property is not recommended for use. Enables autocommit for JDBC pooled connections.
					</div>
					 </td></tr><tr><td> <span class="property"> hibernate.connection.release_mode</span> </td><td> <div class="para">
						Specifies when Hibernate should release JDBC connections. By default, a JDBC connection is held until the session is explicitly closed or disconnected. The default value <code class="literal">auto</code> will choose <code class="literal">after_statement</code> for the JTA and CMT transaction strategies, and <code class="literal">after_transaction</code> for the JDBC transaction strategy.
					</div>
					 <div class="para">
						Available values are <code class="literal">auto</code> (default), <code class="literal">on_close</code>, <code class="literal">after_transaction</code>, <code class="literal">after_statement</code>.
					</div>
					  <div class="para">
						This setting only affects <code class="literal">Session</code> returned from <code class="literal">SessionFactory.openSession</code>. For <code class="literal">Session</code> obtained through <code class="literal">SessionFactory.getCurrentSession</code>, the <code class="literal">CurrentSessionContext</code> implementation configured for use controls the connection release mode for that <code class="literal">Session</code>.
					</div>
					 </td></tr><tr><td> <span class="property"> hibernate.connection.</span><span class="emphasis"><em>&lt;propertyName&gt;</em></span> </td><td> <div class="para">
						Pass the JDBC property <span class="emphasis"><em>&lt;propertyName&gt;</em></span> to <code class="literal">DriverManager.getConnection()</code>.
					</div>
					 </td></tr><tr><td> <span class="property"> hibernate.jndi.</span><span class="emphasis"><em>&lt;propertyName&gt;</em></span> </td><td> <div class="para">
						Pass the property <span class="emphasis"><em>&lt;propertyName&gt;</em></span> to the JNDI <code class="literal">InitialContextFactory</code>.
					</div>
					 </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+7448-754032+%5BLatest%5D&amp;comment=Title%3A+Hibernate+JDBC+and+Connection+Properties%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7448-754032+23+Apr+2015+23%3A16+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Hibernate_Cache_Properties">
      ⁠</a>13.2.4.3. Hibernate Cache Properties</h3></div></div></div><div class="table"><a id="idm140550803372176">
      ⁠</a><p class="title"><strong>Table 13.3. Properties</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-7-rows" summary="Properties"><colgroup><col width="50%" class="c1"/><col width="50%" class="c2"/></colgroup><thead><tr><th> Property Name </th><th> Description </th></tr></thead><tbody><tr><td> <code class="literal">hibernate.cache.region.factory_class</code> </td><td> <div class="para">
						The classname of a custom <code class="literal">CacheProvider</code>.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.cache.use_minimal_puts</code> </td><td> <div class="para">
						Boolean. Optimizes second-level cache operation to minimize writes, at the cost of more frequent reads. This setting is most useful for clustered caches and, in Hibernate3, is enabled by default for clustered cache implementations.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.cache.use_query_cache</code> </td><td> <div class="para">
						Boolean. Enables the query cache. Individual queries still have to be set cacheable.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.cache.use_second_level_cache</code> </td><td> <div class="para">
						Boolean. Used to completely disable the second level cache, which is enabled by default for classes that specify a <code class="literal">&lt;cache&gt;</code> mapping.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.cache.query_cache_factory</code> </td><td> <div class="para">
						The classname of a custom <code class="literal">QueryCache</code> interface. The default value is the built-in <code class="literal">StandardQueryCache</code>.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.cache.region_prefix</code> </td><td> <div class="para">
						A prefix to use for second-level cache region names.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.cache.use_structured_entries</code> </td><td> <div class="para">
						Boolean. Forces Hibernate to store data in the second-level cache in a more human-friendly format.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.cache.default_cache_concurrency_strategy</code> </td><td> <div class="para">
						Setting used to give the name of the default <code class="classname">org.hibernate.annotations.CacheConcurrencyStrategy</code> to use when either <code class="classname">@Cacheable</code> or <code class="classname">@Cache</code> is used. <code class="code">@Cache(strategy="..")</code> is used to override this default.
					</div>
					 </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+7449-606745+%5BLatest%5D&amp;comment=Title%3A+Hibernate+Cache+Properties%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7449-606745+27+Feb+2014+12%3A41+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Hibernate_Transaction_Properties">
      ⁠</a>13.2.4.4. Hibernate Transaction Properties</h3></div></div></div><div class="table"><a id="idm140550786741648">
      ⁠</a><p class="title"><strong>Table 13.4. Properties</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols lt-7-rows" summary="Properties"><colgroup><col width="50%" class="c1"/><col width="50%" class="c2"/></colgroup><thead><tr><th> Property Name </th><th> Description </th></tr></thead><tbody><tr><td> <code class="literal">hibernate.transaction.factory_class</code> </td><td> <div class="para">
						The classname of a <code class="literal">TransactionFactory</code> to use with Hibernate <code class="literal">Transaction</code> API. Defaults to <code class="literal">JDBCTransactionFactory</code>).
					</div>
					 </td></tr><tr><td> <code class="literal">jta.UserTransaction</code> </td><td> <div class="para">
						A JNDI name used by <code class="literal">JTATransactionFactory</code> to obtain the JTA <code class="literal">UserTransaction</code> from the application server.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.transaction.manager_lookup_class</code> </td><td> <div class="para">
						The classname of a <code class="literal">TransactionManagerLookup</code>. It is required when JVM-level caching is enabled or when using hilo generator in a JTA environment.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.transaction.flush_before_completion</code> </td><td> <div class="para">
						Boolean. If enabled, the session will be automatically flushed during the before completion phase of the transaction. Built-in and automatic session context management is preferred.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.transaction.auto_close_session</code> </td><td> <div class="para">
						Boolean. If enabled, the session will be automatically closed during the after completion phase of the transaction. Built-in and automatic session context management is preferred.
					</div>
					 </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+7450-591790+%5BLatest%5D&amp;comment=Title%3A+Hibernate+Transaction+Properties%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7450-591790+23+Feb+2014+16%3A55+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Miscellaneous_Hibernate_Properties1">
      ⁠</a>13.2.4.5. Miscellaneous Hibernate Properties</h3></div></div></div><div class="table"><a id="idm140550731520144">
      ⁠</a><p class="title"><strong>Table 13.5. Properties</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-7-rows" summary="Properties"><colgroup><col width="50%" class="c1"/><col width="50%" class="c2"/></colgroup><thead><tr><th> Property Name </th><th> Description </th></tr></thead><tbody><tr><td> <code class="literal">hibernate.current_session_context_class</code> </td><td> <div class="para">
						Supply a custom strategy for the scoping of the "current" <code class="literal">Session</code>. Values include <code class="literal">jta</code>, <code class="literal">thread</code>, <code class="literal">managed</code>, <code class="literal">custom.Class</code>.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.query.factory_class</code> </td><td> <div class="para">
						Chooses the HQL parser implementation: <code class="literal">org.hibernate.hql.internal.ast.ASTQueryTranslatorFactory</code> or <code class="literal">org.hibernate.hql.internal.classic.ClassicQueryTranslatorFactory</code>.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.query.substitutions</code> </td><td> <div class="para">
						Used to map from tokens in Hibernate queries to SQL tokens (tokens might be function or literal names). For example, <code class="literal">hqlLiteral=SQL_LITERAL, hqlFunction=SQLFUNC</code>.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.hbm2ddl.auto</code> </td><td> <div class="para">
						Automatically validates or exports schema DDL to the database when the <code class="literal">SessionFactory</code> is created. With <code class="literal">create-drop</code>, the database schema will be dropped when the <code class="literal">SessionFactory</code> is closed explicitly. Property value options are <code class="literal">validate</code>, <code class="literal">update</code>, <code class="literal">create</code>, <code class="literal">create-drop</code>
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.hbm2ddl.import_files</code> </td><td> <div class="para">
						Comma-separated names of the optional files containing SQL DML statements executed during the <code class="classname">SessionFactory</code> creation. This is useful for testing or demonstrating. For example, by adding INSERT statements, the database can be populated with a minimal set of data when it is deployed. An example value is <code class="literal">/humans.sql,/dogs.sql</code>.
					</div>
					 <div class="para">
						File order matters, as the statements of a given file are executed before the statements of the following files. These statements are only executed if the schema is created (i.e. if <code class="literal">hibernate.hbm2ddl.auto</code> is set to <code class="literal">create</code> or <code class="literal">create-drop</code>).
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.hbm2ddl.import_files_sql_extractor</code> </td><td> <div class="para">
						The classname of a custom <code class="interfacename"> ImportSqlCommandExtractor</code>. Defaults to the built-in <code class="classname">SingleLineSqlCommandExtractor</code>. This is useful for implementing a dedicated parser that extracts a single SQL statement from each import file. Hibernate also provides <code class="classname">MultipleLinesSqlCommandExtractor</code>, which supports instructions/comments and quoted strings spread over multiple lines (mandatory semicolon at the end of each statement).
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.bytecode.use_reflection_optimizer</code> </td><td> <div class="para">
						Boolean. This is a system-level property, which cannot be set in the <code class="filename">hibernate.cfg.xml</code> file. Enables the use of bytecode manipulation instead of runtime reflection. Reflection can sometimes be useful when troubleshooting. Hibernate always requires either cglib or javassist even if the optimizer is turned off.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.bytecode.provider</code> </td><td> <div class="para">
						Both javassist or cglib can be used as byte manipulation engines. The default is <code class="literal">javassist</code>. Property value is either <code class="literal">javassist</code> or <code class="literal">cglib</code>
					</div>
					 </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+7451-754048+%5BLatest%5D&amp;comment=Title%3A+Miscellaneous+Hibernate+Properties%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7451-754048+23+Apr+2015+23%3A20+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Hibernate_SQL_Dialects1">
      ⁠</a>13.2.4.6. Hibernate SQL Dialects</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			The <code class="literal">hibernate.dialect</code> property should be set to the correct <code class="literal">org.hibernate.dialect.Dialect</code> subclass for the application database. If a dialect is specified, Hibernate will use sensible defaults for some of the other properties. This means that they do not have to be specified manually.
		</div></div></div><div class="table"><a id="idm140550812784240">
      ⁠</a><p class="title"><strong>Table 13.6. SQL Dialects (<code class="literal">hibernate.dialect</code>)</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-14-rows" summary="SQL Dialects (hibernate.dialect)"><colgroup><col/><col/></colgroup><thead><tr><th> RDBMS </th><th> Dialect </th></tr></thead><tbody><tr><td> DB2 </td><td> <code class="literal">org.hibernate.dialect.DB2Dialect</code> </td></tr><tr><td> DB2 AS/400 </td><td> <code class="literal">org.hibernate.dialect.DB2400Dialect</code> </td></tr><tr><td> DB2 OS390 </td><td> <code class="literal">org.hibernate.dialect.DB2390Dialect</code> </td></tr><tr><td> Firebird </td><td> <code class="literal">org.hibernate.dialect.FirebirdDialect</code> </td></tr><tr><td> FrontBase </td><td> <code class="literal">org.hibernate.dialect.FrontbaseDialect</code> </td></tr><tr><td> H2 Database </td><td> <code class="literal">org.hibernate.dialect.H2Dialect</code> </td></tr><tr><td> HypersonicSQL </td><td> <code class="literal">org.hibernate.dialect.HSQLDialect</code> </td></tr><tr><td> Informix </td><td> <code class="literal">org.hibernate.dialect.InformixDialect</code> </td></tr><tr><td> Ingres </td><td> <code class="literal">org.hibernate.dialect.IngresDialect</code> </td></tr><tr><td> Interbase </td><td> <code class="literal">org.hibernate.dialect.InterbaseDialect</code> </td></tr><tr><td> Mckoi SQL </td><td> <code class="literal">org.hibernate.dialect.MckoiDialect</code> </td></tr><tr><td> Microsoft SQL Server 2000 </td><td> <code class="literal">org.hibernate.dialect.SQLServerDialect</code> </td></tr><tr><td> Microsoft SQL Server 2005 </td><td> <code class="literal">org.hibernate.dialect.SQLServer2005Dialect</code> </td></tr><tr><td> Microsoft SQL Server 2008 </td><td> <code class="literal">org.hibernate.dialect.SQLServer2008Dialect</code> </td></tr><tr><td> Microsoft SQL Server 2012 </td><td> <code class="literal">org.hibernate.dialect.SQLServer2008Dialect</code> </td></tr><tr><td> MySQL5 </td><td> <code class="literal">org.hibernate.dialect.MySQL5Dialect</code> </td></tr><tr><td> MySQL5 with InnoDB </td><td> <code class="literal">org.hibernate.dialect.MySQL5InnoDBDialect</code> </td></tr><tr><td> MySQL with MyISAM </td><td> <code class="literal">org.hibernate.dialect.MySQLMyISAMDialect</code> </td></tr><tr><td> Oracle (any version) </td><td> <code class="literal">org.hibernate.dialect.OracleDialect</code> </td></tr><tr><td> Oracle 9i </td><td> <code class="literal">org.hibernate.dialect.Oracle9iDialect</code> </td></tr><tr><td> Oracle 10g </td><td> <code class="literal">org.hibernate.dialect.Oracle10gDialect</code> </td></tr><tr><td> Oracle 11g </td><td> <code class="literal">org.hibernate.dialect.Oracle10gDialect</code> </td></tr><tr><td> Pointbase </td><td> <code class="literal">org.hibernate.dialect.PointbaseDialect</code> </td></tr><tr><td> PostgreSQL </td><td> <code class="literal">org.hibernate.dialect.PostgreSQLDialect</code> </td></tr><tr><td> PostgreSQL 9.2 </td><td> <code class="literal">org.hibernate.dialect.PostgreSQL82Dialect</code> </td></tr><tr><td> Postgres Plus Advanced Server </td><td> <code class="literal">org.hibernate.dialect.PostgresPlusDialect</code> </td></tr><tr><td> Progress </td><td> <code class="literal">org.hibernate.dialect.ProgressDialect</code> </td></tr><tr><td> SAP DB </td><td> <code class="literal">org.hibernate.dialect.SAPDBDialect</code> </td></tr><tr><td> Sybase </td><td> <code class="literal">org.hibernate.dialect.SybaseASE15Dialect</code> </td></tr><tr><td> Sybase 15.7 </td><td> <code class="literal">org.hibernate.dialect.SybaseASE157Dialect</code> </td></tr><tr><td> Sybase Anywhere </td><td> <code class="literal">org.hibernate.dialect.SybaseAnywhereDialect</code> </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+7452-591790+%5BLatest%5D&amp;comment=Title%3A+Hibernate+SQL+Dialects%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7452-591790+23+Feb+2014+16%3A55+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Second-Level_Caches">
      ⁠</a>13.2.5. Second-Level Caches</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="About_Second-Level_Caches">
      ⁠</a>13.2.5.1. About Second-Level Caches</h3></div></div></div><div class="para">
		A second-level cache is a local data store that holds information persisted outside the application session. The cache is managed by the persistence provider, improving run-time by keeping the data separate from the application.
	</div><div class="para">
		JBoss EAP 6 supports caching for the following purposes:
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				Web Session Clustering
			</div></li><li class="listitem"><div class="para">
				Stateful Session Bean Clustering
			</div></li><li class="listitem"><div class="para">
				SSO Clustering
			</div></li><li class="listitem"><div class="para">
				Hibernate Second Level Cache
			</div></li></ul></div><div class="para">
		Each cache container defines a "repl" and a "dist" cache. These caches should not be used directly by user applications.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+1411-591647+%5BLatest%5D&amp;comment=Title%3A+About+Second-Level+Caches%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=1411-591647+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_a_Second_Level_Cache_for_Hibernate">
      ⁠</a>13.2.5.2. Configure a Second Level Cache for Hibernate</h3></div></div></div><div class="para">
		This topic covers the configuration requirements for enabling Infinispan to act as the second level cache for Hibernate.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140550811218016">
      ⁠</a><p class="title"><strong>Procedure 13.4. Create and Edit the <code class="filename">hibernate.cfg.xml</code> file</strong></p><ol class="1"><li class="step"><p class="title"><strong>Create the hibernate.cfg.xml file</strong></p><div class="para">
				Create the <code class="filename">hibernate.cfg.xml</code> in the deployment's classpath. For specifics, refer to <a class="xref" href="chap-Hibernate.html#Create_the_Hibernate_Configuration_File_in_JBoss_Developer_Studio1">Section 13.2.3.4, “Create the Hibernate Configuration File in Red Hat JBoss Developer Studio”</a> .
			</div></li><li class="step"><div class="para">
				Add these lines of XML to the <code class="filename">hibernate.cfg.xml</code> file in your application. The XML needs to be inside the &lt;session-factory&gt; tags:
			</div><pre class="programlisting">&lt;property name="hibernate.cache.use_second_level_cache"&gt;true&lt;/property&gt;
&lt;property name="hibernate.cache.use_query_cache"&gt;true&lt;/property&gt;</pre></li><li class="step"><div class="para">
				Add one of the following to the &lt;session-factory&gt; section of the <code class="filename">hibernate.cfg.xml</code> file:
			</div><ul class="stepalternatives">
				<li class="step"><p class="title"><strong>If the Infinispan CacheManager is bound to JNDI:</strong></p><pre class="programlisting">&lt;property name="hibernate.cache.region.factory_class"&gt;
    org.hibernate.cache.infinispan.JndiInfinispanRegionFactory
&lt;/property&gt;
&lt;property name="hibernate.cache.infinispan.cachemanager"&gt;
    java:CacheManager
&lt;/property&gt;</pre></li>
				 <li class="step"><p class="title"><strong>If the Infinispan CacheManager is standalone:</strong></p><pre class="programlisting">&lt;property name="hibernate.cache.region.factory_class"&gt;
    org.hibernate.cache.infinispan.InfinispanRegionFactory
&lt;/property&gt;</pre></li>

			</ul></li></ol></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Result</div>
			Infinispan is configured as the Second Level Cache for Hibernate.
		</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+4362-591660+%5BLatest%5D&amp;comment=Title%3A+Configure+a+Second+Level+Cache+for+Hibernate%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4362-591660+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-Hibernate_Annotations">
      ⁠</a>13.3. Hibernate Annotations</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Hibernate_Annotations">
      ⁠</a>13.3.1. Hibernate Annotations</h2></div></div></div><div class="table"><a id="idm140550794716512">
      ⁠</a><p class="title"><strong>Table 13.7. Hibernate Defined Annotations</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-14-rows" summary="Hibernate Defined Annotations"><colgroup><col width="50%" style="text-align: left" class="c1"/><col width="50%" style="text-align: left" class="c2"/></colgroup><thead><tr><th style="text-align: left"> Annotation </th><th style="text-align: left"> Description </th></tr></thead><tbody><tr><td style="text-align: left"> AccessType </td><td style="text-align: left"> Property Access type. </td></tr><tr><td style="text-align: left"> Any </td><td style="text-align: left"> Defines a ToOne association pointing to several entity types. Matching the according entity type is done through a metadata discriminator column. This kind of mapping should be only marginal. </td></tr><tr><td style="text-align: left"> AnyMetaDef </td><td style="text-align: left"> Defines @Any and @ManyToAny metadata. </td></tr><tr><td style="text-align: left"> AnyMedaDefs </td><td style="text-align: left"> Defines @Any and @ManyToAny set of metadata. Can be defined at the entity level or the package level. </td></tr><tr><td style="text-align: left"> BatchSize </td><td style="text-align: left"> Batch size for SQL loading. </td></tr><tr><td style="text-align: left"> Cache </td><td style="text-align: left"> Add caching strategy to a root entity or a collection. </td></tr><tr><td style="text-align: left"> Cascade </td><td style="text-align: left"> Apply a cascade strategy on an association. </td></tr><tr><td style="text-align: left"> Check </td><td style="text-align: left"> Arbitrary SQL check constraints which can be defined at the class, property or collection level. </td></tr><tr><td style="text-align: left"> Columns </td><td style="text-align: left"> Support an array of columns. Useful for component user type mappings. </td></tr><tr><td style="text-align: left"> ColumnTransformer </td><td style="text-align: left"> Custom SQL expression used to read the value from and write a value to a column. Use for direct object loading/saving as well as queries. The write expression must contain exactly one '?' placeholder for the value. </td></tr><tr><td style="text-align: left"> ColumnTransformers </td><td style="text-align: left"> Plural annotation for @ColumnTransformer. Useful when more than one column is using this behavior. </td></tr><tr><td style="text-align: left"> DiscriminatorFormula </td><td style="text-align: left"> Discriminator formula to be placed at the root entity. </td></tr><tr><td style="text-align: left"> DiscriminatorOptions </td><td style="text-align: left"> Optional annotation to express Hibernate specific discriminator properties. </td></tr><tr><td style="text-align: left"> Entity </td><td style="text-align: left"> Extends Entity with Hibernate features. </td></tr><tr><td style="text-align: left"> Fetch </td><td style="text-align: left"> Defines the fetching strategy used for the given association. </td></tr><tr><td style="text-align: left"> FetchProfile </td><td style="text-align: left"> Defines the fetching strategy profile. </td></tr><tr><td style="text-align: left"> FetchProfiles </td><td style="text-align: left"> Plural annotation for @FetchProfile. </td></tr><tr><td style="text-align: left"> Filter </td><td style="text-align: left"> Adds filters to an entity or a target entity of a collection. </td></tr><tr><td style="text-align: left"> FilterDef </td><td style="text-align: left"> Filter definition. </td></tr><tr><td style="text-align: left"> FilterDefs </td><td style="text-align: left"> Array of filter definitions. </td></tr><tr><td style="text-align: left"> FilterJoinTable </td><td style="text-align: left"> Adds filters to a join table collection. </td></tr><tr><td style="text-align: left"> FilterJoinTables </td><td style="text-align: left"> Adds multiple @FilterJoinTable to a collection. </td></tr><tr><td style="text-align: left"> Filters </td><td style="text-align: left"> Adds multiple @Filters. </td></tr><tr><td style="text-align: left"> Formula </td><td style="text-align: left"> To be used as a replacement for @Column in most places. The formula has to be a valid SQL fragment. </td></tr><tr><td style="text-align: left"> Generated </td><td style="text-align: left"> This annotated property is generated by the database. </td></tr><tr><td style="text-align: left"> GenericGenerator </td><td style="text-align: left"> Generator annotation describing any kind of Hibernate generator in a detyped manner. </td></tr><tr><td style="text-align: left"> GenericGenerators </td><td style="text-align: left"> Array of generic generator definitions. </td></tr><tr><td style="text-align: left"> Immutable </td><td style="text-align: left"> <div class="para">
						Mark an Entity or a Collection as immutable. No annotation means the element is mutable.
					</div>
					 <div class="para">
						An immutable entity may not be updated by the application. Updates to an immutable entity will be ignored, but no exception is thrown.
					</div>
					 <div class="para">
						@Immutable placed on a collection makes the collection immutable, meaning additions and deletions to and from the collection are not allowed. A HibernateException is thrown in this case.
					</div>
					 </td></tr><tr><td style="text-align: left"> Index </td><td style="text-align: left"> Defines a database index. </td></tr><tr><td style="text-align: left"> JoinFormula </td><td style="text-align: left"> To be used as a replacement for @JoinColumn in most places. The formula has to be a valid SQL fragment. </td></tr><tr><td style="text-align: left"> LazyCollection </td><td style="text-align: left"> Defines the lazy status of a collection. </td></tr><tr><td style="text-align: left"> LazyToOne </td><td style="text-align: left"> Defines the lazy status of a ToOne association (i.e. OneToOne or ManyToOne). </td></tr><tr><td style="text-align: left"> Loader </td><td style="text-align: left"> Overwrites Hibernate default FIND method. </td></tr><tr><td style="text-align: left"> ManyToAny </td><td style="text-align: left"> Defines a ToMany association pointing to different entity types. Matching the according entity type is done through a metadata discriminator column. This kind of mapping should be only marginal. </td></tr><tr><td style="text-align: left"> MapKeyType </td><td style="text-align: left"> Defines the type of key of a persistent map. </td></tr><tr><td style="text-align: left"> MetaValue </td><td style="text-align: left"> Represents a discriminator value associated to a given entity type. </td></tr><tr><td style="text-align: left"> NamedNativeQueries </td><td style="text-align: left"> Extends NamedNativeQueries to hold Hibernate NamedNativeQuery objects. </td></tr><tr><td style="text-align: left"> NamedNativeQuery </td><td style="text-align: left"> Extends NamedNativeQuery with Hibernate features. </td></tr><tr><td style="text-align: left"> NamedQueries </td><td style="text-align: left"> Extends NamedQueries to hold Hibernate NamedQuery objects. </td></tr><tr><td style="text-align: left"> NamedQuery </td><td style="text-align: left"> Extends NamedQuery with Hibernate features. </td></tr><tr><td style="text-align: left"> NaturalId </td><td style="text-align: left"> Specifies that a property is part of the natural id of the entity. </td></tr><tr><td style="text-align: left"> NotFound </td><td style="text-align: left"> Action to do when an element is not found on an association. </td></tr><tr><td style="text-align: left"> OnDelete </td><td style="text-align: left"> Strategy to use on collections, arrays and on joined subclasses delete. OnDelete of secondary tables is currently not supported. </td></tr><tr><td style="text-align: left"> OptimisticLock </td><td style="text-align: left"> Whether or not a change of the annotated property will trigger an entity version increment. If the annotation is not present, the property is involved in the optimistic lock strategy (default). </td></tr><tr><td style="text-align: left"> OptimisticLocking </td><td style="text-align: left"> Used to define the style of optimistic locking to be applied to an entity. In a hierarchy, only valid on the root entity. </td></tr><tr><td style="text-align: left"> OrderBy </td><td style="text-align: left"> Order a collection using SQL ordering (not HQL ordering). </td></tr><tr><td style="text-align: left"> ParamDef </td><td style="text-align: left"> A parameter definition. </td></tr><tr><td style="text-align: left"> Parameter </td><td style="text-align: left"> Key/value pattern. </td></tr><tr><td style="text-align: left"> Parent </td><td style="text-align: left"> Reference the property as a pointer back to the owner (generally the owning entity). </td></tr><tr><td style="text-align: left"> Persister </td><td style="text-align: left"> Specify a custom persister. </td></tr><tr><td style="text-align: left"> Polymorphism </td><td style="text-align: left"> Used to define the type of polymorphism Hibernate will apply to entity hierarchies. </td></tr><tr><td style="text-align: left"> Proxy </td><td style="text-align: left"> Lazy and proxy configuration of a particular class. </td></tr><tr><td style="text-align: left"> RowId </td><td style="text-align: left"> Support for ROWID mapping feature of Hibernate. </td></tr><tr><td style="text-align: left"> Sort </td><td style="text-align: left"> Collection sort (Java level sorting). </td></tr><tr><td style="text-align: left"> Source </td><td style="text-align: left"> Optional annotation in conjunction with Version and timestamp version properties. The annotation value decides where the timestamp is generated. </td></tr><tr><td style="text-align: left"> SQLDelete </td><td style="text-align: left"> Overwrites the Hibernate default DELETE method. </td></tr><tr><td style="text-align: left"> SQLDeleteAll </td><td style="text-align: left"> Overwrites the Hibernate default DELETE ALL method. </td></tr><tr><td style="text-align: left"> SQLInsert </td><td style="text-align: left"> Overwrites the Hibernate default INSERT INTO method. </td></tr><tr><td style="text-align: left"> SQLUpdate </td><td style="text-align: left"> Overwrites the Hibernate default UPDATE method. </td></tr><tr><td style="text-align: left"> Subselect </td><td style="text-align: left"> Maps an immutable and read-only entity to a given SQL subselect expression. </td></tr><tr><td style="text-align: left"> Synchronize </td><td style="text-align: left"> Ensures that auto-flush happens correctly and that queries against the derived entity do not return stale data. Mostly used with Subselect. </td></tr><tr><td style="text-align: left"> Table </td><td style="text-align: left"> Complementary information to a table either primary or secondary. </td></tr><tr><td style="text-align: left"> Tables </td><td style="text-align: left"> Plural annotation of Table. </td></tr><tr><td style="text-align: left"> Target </td><td style="text-align: left"> Defines an explicit target, avoiding reflection and generics resolving. </td></tr><tr><td style="text-align: left"> Tuplizer </td><td style="text-align: left"> Defines a tuplizer for an entity or a component. </td></tr><tr><td style="text-align: left"> Tuplizers </td><td style="text-align: left"> Defines a set of tuplizers for an entity or a component. </td></tr><tr><td style="text-align: left"> Type </td><td style="text-align: left"> Hibernate Type. </td></tr><tr><td style="text-align: left"> TypeDef </td><td style="text-align: left"> Hibernate Type definition. </td></tr><tr><td style="text-align: left"> TypeDefs </td><td style="text-align: left"> Hibernate Type definition array. </td></tr><tr><td style="text-align: left"> Where </td><td style="text-align: left"> Where clause to add to the element Entity or target entity of a collection. The clause is written in SQL. </td></tr><tr><td style="text-align: left"> WhereJoinTable </td><td style="text-align: left"> Where clause to add to the collection join table. The clause is written in SQL. </td></tr></tbody></table></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			The annotation "Entity" is deprecated and scheduled for removal in future releases.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+7345-745126+%5BLatest%5D&amp;comment=Title%3A+Hibernate+Annotations%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7345-745126+27+Feb+2015+07%3A53+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-Hibernate_Query_Language">
      ⁠</a>13.4. Hibernate Query Language</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="HQL_and_JPQL">
      ⁠</a>13.4.1. About Hibernate Query Language</h2></div></div></div><div class="para">
		The Hibernate Query Language (HQL) and Java Persistence Query Language (JPQL) are both object model focused query languages similar in nature to SQL. HQL is a superset of JPQL. A HQL query is not always a valid JPQL query, but a JPQL query is always a valid HQL query.
	</div><div class="para">
		Both HQL and JPQL are non-type-safe ways to perform query operations. Criteria queries offer a type-safe approach to querying.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11474-591978+%5BLatest%5D&amp;comment=Title%3A+About+Hibernate+Query+Language%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11474-591978+23+Feb+2014+16%3A56+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="HQL_Statements">
      ⁠</a>13.4.2. HQL Statements</h2></div></div></div><div class="para">
		HQL allows <code class="literal">SELECT</code>, <code class="literal">UPDATE</code>, <code class="literal">DELETE</code>, and <code class="literal">INSERT</code> statements. The HQL <code class="literal">INSERT</code> statement has no equivalent in JPQL.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			Care should be taken as to when an <code class="literal">UPDATE</code> or <code class="literal">DELETE</code> statement is executed.
		</div></div></div><div class="table"><a id="idm140550810157216">
      ⁠</a><p class="title"><strong>Table 13.8. HQL Statements</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols lt-7-rows" summary="HQL Statements"><colgroup><col width="50%" style="text-align: left" class="c1"/><col width="50%" style="text-align: left" class="c2"/></colgroup><thead><tr><th style="text-align: left"> Statement </th><th style="text-align: left"> Description </th></tr></thead><tbody><tr><td style="text-align: left"> <code class="code">SELECT</code> </td><td style="text-align: left"> <div class="para">
						The BNF for <code class="literal">SELECT</code> statements in HQL is:
					</div>
					 
<pre class="programlisting">
select_statement :: =
        [select_clause]
        from_clause
        [where_clause]
        [groupby_clause]
        [having_clause]
        [orderby_clause]
</pre>
					 <div class="para">
						The simplest possible HQL <code class="literal">SELECT</code> statement is of the form:
					</div>
					 
<pre class="programlisting">from com.acme.Cat</pre>
					 </td></tr><tr><td style="text-align: left"> <code class="code">UDPATE</code> </td><td style="text-align: left"> The BNF for UPDATE statement in HQL is the same as it is in JPQL </td></tr><tr><td style="text-align: left"> <code class="code">DELETE</code> </td><td style="text-align: left"> The BNF for DELETE statements in HQL is the same as it is in JPQL </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11476-591978+%5BLatest%5D&amp;comment=Title%3A+HQL+Statements%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11476-591978+23+Feb+2014+16%3A56+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_the_INSERT_Statement">
      ⁠</a>13.4.3. About the INSERT Statement</h2></div></div></div><div class="para">
		HQL adds the ability to define <code class="literal">INSERT</code> statements. There is no JPQL equivalent to this. The BNF for an HQL <code class="literal">INSERT</code> statement is:
	</div><pre class="programlisting">insert_statement ::= insert_clause select_statement

insert_clause ::= INSERT INTO entity_name (attribute_list)

attribute_list ::= state_field[, state_field ]*</pre><div class="para">
		The <code class="literal">attribute_list</code> is analogous to the <code class="literal">column specification</code> in the SQL <code class="literal">INSERT</code> statement. For entities involved in mapped inheritance, only attributes directly defined on the named entity can be used in the <code class="literal">attribute_list</code>. Superclass properties are not allowed and subclass properties do not make sense. In other words, <code class="literal">INSERT</code> statements are inherently non-polymorphic.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			<code class="literal">select_statement</code> can be any valid HQL select query, with the caveat that the return types must match the types expected by the insert. Currently, this is checked during query compilation rather than allowing the check to relegate to the database. This may cause problems between Hibernate Types which are <span class="emphasis"><em>equivalent</em></span> as opposed to <span class="emphasis"><em>equal</em></span>. For example, this might cause lead to issues with mismatches between an attribute mapped as a <code class="classname">org.hibernate.type.DateType</code> and an attribute defined as a <code class="classname">org.hibernate.type.TimestampType</code>, even though the database might not make a distinction or might be able to handle the conversion.
		</div></div></div><div class="para">
		For the <code class="literal">id</code> attribute, the insert statement gives you two options. You can either explicitly specify the <code class="literal">id</code> property in the <code class="literal">attribute_list</code>, in which case its value is taken from the corresponding select expression, or omit it from the <code class="literal">attribute_list</code> in which case a generated value is used. This latter option is only available when using <code class="literal">id</code> generators that operate "in the database"; attempting to use this option with any "in memory" type generators will cause an exception during parsing.
	</div><div class="para">
		For optimistic locking attributes, the insert statement again gives you two options. You can either specify the attribute in the <code class="literal">attribute_list</code> in which case its value is taken from the corresponding select expressions, or omit it from the <code class="literal">attribute_list</code> in which case the <code class="literal">seed value</code> defined by the corresponding <code class="interfacename">org.hibernate.type.VersionType</code> is used.
	</div><div class="example"><a id="idm140550800596032">
      ⁠</a><p class="title"><strong>Example 13.3. <code class="literal">INSERT</code> Query Statements</strong></p><div class="example-contents"><pre class="programlisting">String hqlInsert = "insert into DelinquentAccount (id, name) select c.id, c.name from Customer c where ...";
int createdEntities = s.createQuery( hqlInsert ).executeUpdate();</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11618-766229+%5BLatest%5D&amp;comment=Title%3A+About+the+INSERT+Statement%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11618-766229+28+Jul+2015+20%3A13+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="The_FROM_Clause_in_HQL">
      ⁠</a>13.4.4. About the FROM Clause</h2></div></div></div><div class="para">
		The <code class="literal">FROM</code> clause is responsible defining the scope of object model types available to the rest of the query. It also is responsible for defining all the "identification variables" available to the rest of the query.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11478-591978+%5BLatest%5D&amp;comment=Title%3A+About+the+FROM+Clause%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11478-591978+23+Feb+2014+16%3A56+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_the_WITH_Clause">
      ⁠</a>13.4.5. About the WITH Clause</h2></div></div></div><div class="para">
		HQL defines a <code class="literal">WITH</code> clause to qualify the join conditions. This is specific to HQL; JPQL does not define this feature.
	</div><div class="example"><a id="idm140550783480720">
      ⁠</a><p class="title"><strong>Example 13.4. <code class="literal">With</code> Clause</strong></p><div class="example-contents"><pre class="programlisting">select distinct c
from Customer c
    left join c.orders o
        with o.value &gt; 5000.00</pre></div></div><div class="para">
		The important distinction is that in the generated SQL the conditions of the <code class="literal">with clause</code> are made part of the <code class="literal">on clause</code> in the generated SQL as opposed to the other queries in this section where the HQL/JPQL conditions are made part of the <code class="literal">where clause</code> in the generated SQL. The distinction in this specific example is probably not that significant. The <code class="literal">with clause</code> is sometimes necessary in more complicated queries.
	</div><div class="para">
		Explicit joins may reference association or component/embedded attributes. In the case of component/embedded attributes, the join is logical and does not correlate to a physical (SQL) join.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11736-766228+%5BLatest%5D&amp;comment=Title%3A+About+the+WITH+Clause%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11736-766228+28+Jul+2015+20%3A11+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_Bulk_Update_Insert_and_Delete">
      ⁠</a>13.4.6. About Bulk Update, Insert and Delete</h2></div></div></div><div class="para">
		Hibernate allows the use of Data Manipulation Language (DML) to bulk insert, update and delete data directly in the mapped database through the Hibernate Query Language.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			Using DML may violate the object/relational mapping and may affect object state. Object state stays in memory and by using DML, the state of an in-memory object is not affected depending on the operation that is performed on the underlying database. In-memory data must be used with care if DML is used.
		</div></div></div><div class="para">
		The pseudo-syntax for UPDATE and DELETE statements is: <code class="command">( UPDATE | DELETE ) FROM? EntityName (WHERE where_conditions)?</code>.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			The <code class="literal">FROM</code> keyword and the <code class="literal">WHERE Clause</code> are optional.
		</div></div></div><div class="para">
		The result of execution of a UPDATE or DELETE statement is the number of rows that are actually affected (updated or deleted).
	</div><div class="example"><a id="idm140550724239936">
      ⁠</a><p class="title"><strong>Example 13.5. Bulk Update Statement</strong></p><div class="example-contents"><pre class="programlisting">
Session session = sessionFactory.openSession();
Transaction tx = session.beginTransaction();

String hqlUpdate = "update Company set name = :newName where name = :oldName";
int updatedEntities = s.createQuery( hqlUpdate )
        .setString( "newName", newName )
        .setString( "oldName", oldName )
        .executeUpdate();
tx.commit();
session.close();
</pre></div></div><div class="example"><a id="idm140550768813888">
      ⁠</a><p class="title"><strong>Example 13.6. Bulk Delete statement</strong></p><div class="example-contents"><pre class="programlisting">
Session session = sessionFactory.openSession();
Transaction tx = session.beginTransaction();

String hqlDelete = "delete Company where name = :oldName";
int deletedEntities = s.createQuery( hqlDelete )
        .setString( "oldName", oldName )
        .executeUpdate();
tx.commit();
session.close();
</pre></div></div><div class="para">
		The <code class="literal">int</code> value returned by the <code class="command">Query.executeUpdate()</code> method indicates the number of entities within the database that were affected by the operation.
	</div><div class="para">
		Internally, the database might use multiple SQL statements to execute the operation in response to a DML Update or Delete request. This might be because of relationships that exist between tables and the join tables that may need to be updated or deleted.
	</div><div class="para">
		For example, issuing a delete statement (as in the example above) may actually result in deletes being executed against not just the <code class="literal">Company</code> table for companies that are named with <code class="literal">oldName</code>, but also against joined tables. Thus, a Company table in a BiDirectional ManyToMany relationship with an Employee table, would lose rows from the corresponding join table <code class="literal">Company_Employee</code> as a result of the successful execution of the previous example.
	</div><div class="para">
		The <code class="literal">int deletedEntries</code> value above will contain a count of all the rows affected due to this operation, including the rows in the join tables.
	</div><div class="para">
		The pseudo-syntax for INSERT statements is: <code class="command">INSERT INTO EntityName properties_list select_statement</code>.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			Only the INSERT INTO ... SELECT ... form is supported; not the INSERT INTO ... VALUES ... form.
		</div></div></div><div class="example"><a id="idm140550780719280">
      ⁠</a><p class="title"><strong>Example 13.7. Bulk Insert statement</strong></p><div class="example-contents"><pre class="programlisting">
Session session = sessionFactory.openSession();
Transaction tx = session.beginTransaction();

String hqlInsert = "insert into Account (id, name) select c.id, c.name from Customer c where ...";
int createdEntities = s.createQuery( hqlInsert )
        .executeUpdate();
tx.commit();
session.close();
</pre></div></div><div class="para">
		If you do not supply the value for the <code class="literal">id</code> attribute via the SELECT statement, an identifier is generated for you, as long as the underlying database supports auto-generated keys. The return value of this bulk insert operation is the number of entries actually created in the database.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+14122-766226+%5BLatest%5D&amp;comment=Title%3A+About+Bulk+Update%2C+Insert+and+Delete%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=14122-766226+28+Jul+2015+20%3A05+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_Collection_Member_References">
      ⁠</a>13.4.7. About Collection Member References</h2></div></div></div><div class="para">
		References to collection-valued associations actually refer to the <span class="emphasis"><em>values</em></span> of that collection.
	</div><div class="example"><a id="idm140550730925584">
      ⁠</a><p class="title"><strong>Example 13.8. Collection References</strong></p><div class="example-contents"><pre class="programlisting">select c
from Customer c
    join c.orders o
    join o.lineItems l
    join l.product p
where o.status = 'pending'
  and p.status = 'backorder'

// alternate syntax
select c
from Customer c,
    in(c.orders) o,
    in(o.lineItems) l
    join l.product p
where o.status = 'pending'
  and p.status = 'backorder'</pre></div></div><div class="para">
		In the example, the identification variable <code class="literal">o</code> actually refers to the object model type <code class="classname">Order</code> which is the type of the elements of the <code class="methodname">Customer#orders</code> association.
	</div><div class="para">
		The example also shows the alternate syntax for specifying collection association joins using the <code class="literal">IN</code> syntax. Both forms are equivalent. Which form an application chooses to use is simply a matter of taste.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11737-766225+%5BLatest%5D&amp;comment=Title%3A+About+Collection+Member+References%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11737-766225+28+Jul+2015+20%3A04+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_Qualified_Path_Expressions">
      ⁠</a>13.4.8. About Qualified Path Expressions</h2></div></div></div><div class="para">
		It was previously stated that collection-valued associations actually refer to the <span class="emphasis"><em>values</em></span> of that collection. Based on the type of collection, there are also available a set of explicit qualification expressions.
	</div><div class="table"><a id="idm140550793922176">
      ⁠</a><p class="title"><strong>Table 13.9. Qualified Path Expressions</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols lt-7-rows" summary="Qualified Path Expressions"><colgroup><col width="50%" style="text-align: left" class="c1"/><col width="50%" style="text-align: left" class="c2"/></colgroup><thead><tr><th style="text-align: left"> Expression </th><th style="text-align: left"> Description </th></tr></thead><tbody><tr><td style="text-align: left"> <code class="code">VALUE</code> </td><td style="text-align: left"> <div class="para">
						Refers to the collection value. Same as not specifying a qualifier. Useful to explicitly show intent. Valid for any type of collection-valued reference.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">INDEX</code> </td><td style="text-align: left"> <div class="para">
						According to HQL rules, this is valid for both Maps and Lists which specify a <code class="interfacename">javax.persistence.OrderColumn</code> annotation to refer to the Map key or the List position (aka the OrderColumn value). JPQL however, reserves this for use in the List case and adds <code class="literal">KEY</code> for the MAP case. Applications interested in JPA provider portability should be aware of this distinction.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">KEY</code> </td><td style="text-align: left"> <div class="para">
						Valid only for Maps. Refers to the map's key. If the key is itself an entity, can be further navigated.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">ENTRY</code> </td><td style="text-align: left"> <div class="para">
						Only valid only for Maps. Refers to the Map's logical <code class="interfacename">java.util.Map.Entry</code> tuple (the combination of its key and value). <code class="literal">ENTRY</code> is only valid as a terminal path and only valid in the select clause.
					</div>
					 </td></tr></tbody></table></div></div><div class="example"><a id="idm140550794513264">
      ⁠</a><p class="title"><strong>Example 13.9. Qualified Collection References</strong></p><div class="example-contents"><pre class="programlisting">
// Product.images is a Map&lt;String,String&gt; : key = a name, value = file path

// select all the image file paths (the map value) for Product#123
select i
from Product p
    join p.images i
where p.id = 123

// same as above
select value(i)
from Product p
    join p.images i
where p.id = 123

// select all the image names (the map key) for Product#123
select key(i)
from Product p
    join p.images i
where p.id = 123

// select all the image names and file paths (the 'Map.Entry') for Product#123
select entry(i)
from Product p
    join p.images i
where p.id = 123

// total the value of the initial line items for all orders for a customer
select sum( li.amount )
from Customer c
        join c.orders o
        join o.lineItems li
where c.id = 123
  and index(li) = 1
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11738-766224+%5BLatest%5D&amp;comment=Title%3A+About+Qualified+Path+Expressions%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11738-766224+28+Jul+2015+20%3A02+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_Scalar_Functions">
      ⁠</a>13.4.9. About Scalar Functions</h2></div></div></div><div class="para">
		HQL defines some standard functions that are available regardless of the underlying database in use. HQL can also understand additional functions defined by the dialect and the application.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11780-766223+%5BLatest%5D&amp;comment=Title%3A+About+Scalar+Functions%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11780-766223+28+Jul+2015+20%3A01+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="HQL_Expressions">
      ⁠</a>13.4.10. HQL Standardized Functions</h2></div></div></div><div class="para">
		The following functions are available in HQL regardless of the underlying database in use.
	</div><div class="table"><a id="idm140550726784640">
      ⁠</a><p class="title"><strong>Table 13.10. HQL Standardized Functions</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-7-rows" summary="HQL Standardized Functions"><colgroup><col width="50%" style="text-align: left" class="c1"/><col width="50%" style="text-align: left" class="c2"/></colgroup><thead><tr><th style="text-align: left"> Function </th><th style="text-align: left"> Description </th></tr></thead><tbody><tr><td style="text-align: left"> <code class="code">BIT_LENGTH</code> </td><td style="text-align: left"> <div class="para">
						Returns the length of binary data.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">CAST</code> </td><td style="text-align: left"> <div class="para">
						Performs a SQL cast. The cast target should name the Hibernate mapping type to use. 
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">EXTRACT</code> </td><td style="text-align: left"> <div class="para">
						Performs a SQL extraction on datetime values. An extraction extracts parts of the datetime (the year, for example). See the abbreviated forms below.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">SECOND</code> </td><td style="text-align: left"> <div class="para">
						Abbreviated extract form for extracting the second.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">MINUTE</code> </td><td style="text-align: left"> <div class="para">
						Abbreviated extract form for extracting the minute.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">HOUR</code> </td><td style="text-align: left"> <div class="para">
						Abbreviated extract form for extracting the hour.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">DAY</code> </td><td style="text-align: left"> <div class="para">
						Abbreviated extract form for extracting the day.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">MONTH</code> </td><td style="text-align: left"> <div class="para">
						Abbreviated extract form for extracting the month.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">YEAR</code> </td><td style="text-align: left"> <div class="para">
						Abbreviated extract form for extracting the year.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">STR</code> </td><td style="text-align: left"> <div class="para">
						Abbreviated form for casting a value as character data.
					</div>
					 </td></tr></tbody></table></div></div><div class="para">
		Application developers can also supply their own set of functions. This would usually represent either custom SQL functions or aliases for snippets of SQL. Such function declarations are made by using the <code class="methodname">addSqlFunction</code> method of <code class="classname">org.hibernate.cfg.Configuration</code>
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11479-767312+%5BLatest%5D&amp;comment=Title%3A+HQL+Standardized+Functions%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11479-767312+12+Aug+2015+22%3A05+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_the_Concatenation_Operation">
      ⁠</a>13.4.11. About the Concatenation Operation</h2></div></div></div><div class="para">
		HQL defines a concatenation operator in addition to supporting the concatenation (<code class="literal">CONCAT</code>) function. This is not defined by JPQL, so portable applications should avoid using it. The concatenation operator is taken from the SQL concatenation operator - <code class="literal">||</code>.
	</div><div class="example"><a id="idm140550772684960">
      ⁠</a><p class="title"><strong>Example 13.10. Concatenation Operation Example</strong></p><div class="example-contents"><pre class="programlisting JAVA">
select 'Mr. ' || c.name.first || ' ' || c.name.last
from Customer c
where c.gender = Gender.MALE
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11783-591992+%5BLatest%5D&amp;comment=Title%3A+About+the+Concatenation+Operation%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11783-591992+23+Feb+2014+16%3A56+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="The_SELECT_Clause_in_HQL">
      ⁠</a>13.4.12. About Dynamic Instantiation</h2></div></div></div><div class="para">
		There is a particular expression type that is only valid in the select clause. Hibernate calls this "dynamic instantiation". JPQL supports some of this feature and calls it a "constructor expression".
	</div><div class="example"><a id="idm140550784651696">
      ⁠</a><p class="title"><strong>Example 13.11. Dynamic Instantiation Example - Constructor</strong></p><div class="example-contents"><pre class="programlisting">
select new Family( mother, mate, offspr )
from DomesticCat as mother
    join mother.mate as mate
    left join mother.kittens as offspr
</pre></div></div><div class="para">
		So rather than dealing with the Object[] here we are wrapping the values in a type-safe java object that will be returned as the results of the query. The class reference must be fully qualified and it must have a matching constructor.
	</div><div class="para">
		The class here need not be mapped. If it does represent an entity, the resulting instances are returned in the NEW state (not managed!).
	</div><div class="para">
		This is the part JPQL supports as well. HQL supports additional "dynamic instantiation" features. First, the query can specify to return a List rather than an Object[] for scalar results:
	</div><div class="example"><a id="idm140550724403520">
      ⁠</a><p class="title"><strong>Example 13.12. Dynamic Instantiation Example - List</strong></p><div class="example-contents"><pre class="programlisting">
select new list(mother, offspr, mate.name)
from DomesticCat as mother
    inner join mother.mate as mate
    left outer join mother.kittens as offspr
</pre></div></div><div class="para">
		The results from this query will be a List&lt;List&gt; as opposed to a List&lt;Object[]&gt;
	</div><div class="para">
		HQL also supports wrapping the scalar results in a Map.
	</div><div class="example"><a id="idm140550743095776">
      ⁠</a><p class="title"><strong>Example 13.13. Dynamic Instantiation Example - Map</strong></p><div class="example-contents"><pre class="programlisting">
select new map( mother as mother, offspr as offspr, mate as mate )
from DomesticCat as mother
    inner join mother.mate as mate
    left outer join mother.kittens as offspr

select new map( max(c.bodyWeight) as max, min(c.bodyWeight) as min, count(*) as n )
from Cat cxt
</pre></div></div><div class="para">
		The results from this query will be a List&lt;Map&lt;String,Object&gt;&gt; as opposed to a List&lt;Object[]&gt;. The keys of the map are defined by the aliases given to the select expressions.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11480-745127+%5BLatest%5D&amp;comment=Title%3A+About+Dynamic+Instantiation%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11480-745127+27+Feb+2015+09%3A19+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="HQL_Predicates">
      ⁠</a>13.4.13. About HQL Predicates</h2></div></div></div><div class="para">
		Predicates form the basis of the where clause, the having clause and searched case expressions. They are expressions which resolve to a truth value, generally <code class="literal">TRUE</code> or <code class="literal">FALSE</code>, although boolean comparisons involving NULLs generally resolve to <code class="literal">UNKNOWN</code>.
	</div><div class="variablelist"><p class="title"><strong>HQL Predicates</strong></p><dl class="variablelist"><dt><span class="term">Nullness Predicate</span></dt><dd><div class="para">
					Check a value for nullness. Can be applied to basic attribute references, entity references and parameters. HQL additionally allows it to be applied to component/embeddable types.
				</div><div class="example"><a id="idm140550780522624">
      ⁠</a><p class="title"><strong>Example 13.14. Nullness Checking Examples</strong></p><div class="example-contents"><pre class="programlisting">
// select everyone with an associated address
select p
from Person p
where p.address is not null

// select everyone without an associated address
select p
from Person p
where p.address is null
</pre></div></div></dd><dt><span class="term">Like Predicate</span></dt><dd><div class="para">
					Performs a like comparison on string values. The syntax is:
				</div><pre class="programlisting">
like_expression ::=
   string_expression
   [NOT] LIKE pattern_value
   [ESCAPE escape_character]
</pre><div class="para">
					The semantics follow that of the SQL like expression. The <code class="literal">pattern_value</code> is the pattern to attempt to match in the <code class="literal">string_expression</code>. Just like SQL, <code class="literal">pattern_value</code> can use "_" and "%" as wildcards. The meanings are the same. "_" matches any single character. "%" matches any number of characters.
				</div><div class="para">
					The optional <code class="literal">escape_character</code> is used to specify an escape character used to escape the special meaning of "_" and "%" in the <code class="literal">pattern_value</code>. This is useful when needing to search on patterns including either "_" or "%".
				</div><div class="example"><a id="idm140550813888000">
      ⁠</a><p class="title"><strong>Example 13.15. Like Predicate Examples</strong></p><div class="example-contents"><pre class="programlisting">
select p
from Person p
where p.name like '%Schmidt'

select p
from Person p
where p.name not like 'Jingleheimmer%'

// find any with name starting with "sp_"
select sp
from StoredProcedureMetadata sp
where sp.name like 'sp|_%' escape '|'
</pre></div></div></dd><dt><span class="term">Between Predicate</span></dt><dd><div class="para">
					Analogous to the SQL <code class="literal">BETWEEN</code> expression. Perform a evaluation that a value is within the range of 2 other values. All the operands should have comparable types.
				</div><div class="example"><a id="idm140550726213072">
      ⁠</a><p class="title"><strong>Example 13.16. Between Predicate Examples</strong></p><div class="example-contents"><pre class="programlisting">
select p
from Customer c
    join c.paymentHistory p
where c.id = 123
  and index(p) between 0 and 9

select c
from Customer c
where c.president.dateOfBirth
        between {d '1945-01-01'}
            and {d '1965-01-01'}

select o
from Order o
where o.total between 500 and 5000

select p
from Person p
where p.name between 'A' and 'E'
</pre></div></div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11481-591978+%5BLatest%5D&amp;comment=Title%3A+About+HQL+Predicates%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11481-591978+23+Feb+2014+16%3A56+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_Relational_Comparisons">
      ⁠</a>13.4.14. About Relational Comparisons</h2></div></div></div><div class="para">
		Comparisons involve one of the comparison operators - =, &gt;, &gt;=, &lt;, &lt;=, &lt;&gt;. HQL also defines != as a comparison operator synonymous with &lt;&gt;. The operands should be of the same type.
	</div><div class="example"><a id="idm140550791822256">
      ⁠</a><p class="title"><strong>Example 13.17. Relational Comparison Examples</strong></p><div class="example-contents"><pre class="programlisting">
// numeric comparison
select c
from Customer c
where c.chiefExecutive.age &lt; 30

// string comparison
select c
from Customer c
where c.name = 'Acme'

// datetime comparison
select c
from Customer c
where c.inceptionDate &lt; {d '2000-01-01'}

// enum comparison
select c
from Customer c
where c.chiefExecutive.gender = com.acme.Gender.MALE

// boolean comparison
select c
from Customer c
where c.sendEmail = true

// entity type comparison
select p
from Payment p
where type(p) = WireTransferPayment

// entity value comparison
select c
from Customer c
where c.chiefExecutive = c.chiefTechnologist
</pre></div></div><div class="para">
		Comparisons can also involve subquery qualifiers - <code class="literal">ALL</code>, <code class="literal">ANY</code>, <code class="literal">SOME</code>. <code class="literal">SOME</code> and <code class="literal">ANY</code> are synonymous.
	</div><div class="para">
		The <code class="literal">ALL</code> qualifier resolves to true if the comparison is true for all of the values in the result of the subquery. It resolves to false if the subquery result is empty.
	</div><div class="example"><a id="idm140550730644224">
      ⁠</a><p class="title"><strong>Example 13.18. ALL Subquery Comparison Qualifier Example</strong></p><div class="example-contents"><pre class="programlisting">
// select all players that scored at least 3 points
// in every game.
select p
from Player p
where 3 &gt; all (
   select spg.points
   from StatsPerGame spg
   where spg.player = p
)
</pre></div></div><div class="para">
		The <code class="literal">ANY</code>/<code class="literal">SOME</code> qualifier resolves to true if the comparison is true for some of (at least one of) the values in the result of the subquery. It resolves to false if the subquery result is empty.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11784-706658+%5BLatest%5D&amp;comment=Title%3A+About+Relational+Comparisons%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11784-706658+04+Sep+2014+21%3A27+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_the_IN_Predicate">
      ⁠</a>13.4.15. About the IN Predicate</h2></div></div></div><div class="para">
		The <code class="literal">IN</code> predicate performs a check that a particular value is in a list of values. Its syntax is:
	</div><pre class="programlisting">
in_expression ::= single_valued_expression
            [NOT] IN single_valued_list

single_valued_list ::= constructor_expression |
            (subquery) |
            collection_valued_input_parameter

constructor_expression ::= (expression[, expression]*)
</pre><div class="para">
		The types of the <code class="literal">single_valued_expression</code> and the individual values in the <code class="literal">single_valued_list</code> must be consistent. JPQL limits the valid types here to string, numeric, date, time, timestamp, and enum types. In JPQL, <code class="literal">single_valued_expression</code> can only refer to:
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				"state fields", which is its term for simple attributes. Specifically this excludes association and component/embedded attributes.
			</div></li><li class="listitem"><div class="para">
				entity type expressions.
			</div></li></ul></div><div class="para">
		In HQL, <code class="literal">single_valued_expression</code> can refer to a far more broad set of expression types. Single-valued association are allowed. So are component/embedded attributes, although that feature depends on the level of support for tuple or "row value constructor syntax" in the underlying database. Additionally, HQL does not limit the value type in any way, though application developers should be aware that different types may incur limited support based on the underlying database vendor. This is largely the reason for the JPQL limitations.
	</div><div class="para">
		The list of values can come from a number of different sources. In the <code class="literal">constructor_expression</code> and <code class="literal">collection_valued_input_parameter</code>, the list of values must not be empty; it must contain at least one value.
	</div><div class="example"><a id="idm140550797822304">
      ⁠</a><p class="title"><strong>Example 13.19. In Predicate Examples</strong></p><div class="example-contents"><pre class="programlisting">
select p
from Payment p
where type(p) in (CreditCardPayment, WireTransferPayment)

select c
from Customer c
where c.hqAddress.state in ('TX', 'OK', 'LA', 'NM')

select c
from Customer c
where c.hqAddress.state in ?

select c
from Customer c
where c.hqAddress.state in (
    select dm.state
    from DeliveryMetadata dm
    where dm.salesTax is not null
)

// Not JPQL compliant!
select c
from Customer c
where c.name in (
    ('John','Doe'),
    ('Jane','Doe')
)

// Not JPQL compliant!
select c
from Customer c
where c.chiefExecutive in (
    select p
    from Person p
    where ...
)
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11785-591992+%5BLatest%5D&amp;comment=Title%3A+About+the+IN+Predicate%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11785-591992+23+Feb+2014+16%3A56+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Ordering_in_HQL">
      ⁠</a>13.4.16. About HQL Ordering</h2></div></div></div><div class="para">
		The results of the query can also be ordered. The <code class="literal">ORDER BY</code> clause is used to specify the selected values to be used to order the result. The types of expressions considered valid as part of the order-by clause include:
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				state fields
			</div></li><li class="listitem"><div class="para">
				component/embeddable attributes
			</div></li><li class="listitem"><div class="para">
				scalar expressions such as arithmetic operations, functions, etc.
			</div></li><li class="listitem"><div class="para">
				identification variable declared in the select clause for any of the previous expression types
			</div></li></ul></div><div class="para">
		HQL does not mandate that all values referenced in the order-by clause must be named in the select clause, but it is required by JPQL. Applications desiring database portability should be aware that not all databases support referencing values in the order-by clause that are not referenced in the select clause.
	</div><div class="para">
		Individual expressions in the order-by can be qualified with either <code class="literal">ASC</code> (ascending) or <code class="literal">DESC</code> (descending) to indicated the desired ordering direction.
	</div><div class="example"><a id="idm140550724807104">
      ⁠</a><p class="title"><strong>Example 13.20. Order-by Examples</strong></p><div class="example-contents"><pre class="programlisting">
// legal because p.name is implicitly part of p
select p
from Person p
order by p.name

select c.id, sum( o.total ) as t
from Order o
    inner join o.customer c
group by c.id
order by t
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+11482-591978+%5BLatest%5D&amp;comment=Title%3A+About+HQL+Ordering%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11482-591978+23+Feb+2014+16%3A56+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-Hibernate_Services">
      ⁠</a>13.5. Hibernate Services</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_Hibernate_Services">
      ⁠</a>13.5.1. About Hibernate Services</h2></div></div></div><div class="para">
		Services are classes that provide Hibernate with pluggable implementations of various types of functionality. Specifically they are implementations of certain service contract interfaces. The interface is known as the service role; the implementation class is know as the service implementation. Generally speaking, users can plug in alternate implementations of all standard service roles (overriding); they can also define additional services beyond the base set of service roles (extending).
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+9992-591906+%5BLatest%5D&amp;comment=Title%3A+About+Hibernate+Services%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9992-591906+23+Feb+2014+16%3A55+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_Service_Contracts">
      ⁠</a>13.5.2. About Service Contracts</h2></div></div></div><div class="para">
		The basic requirement for a service is to implement the marker interface <code class="classname">org.hibernate.service.Service</code>. Hibernate uses this internally for some basic type safety.
	</div><div class="para">
		Optionally, the service can also implement the <code class="classname">org.hibernate.service.spi.Startable</code> and <code class="classname">org.hibernate.service.spi.Stoppable</code> interfaces to receive notifications of being started and stopped. Another optional service contract is <code class="classname">org.hibernate.service.spi.Manageable</code> which marks the service as manageable in JMX provided the JMX integration is enabled.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+9993-591906+%5BLatest%5D&amp;comment=Title%3A+About+Service+Contracts%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9993-591906+23+Feb+2014+16%3A55+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Types_of_Service_Dependencies">
      ⁠</a>13.5.3. Types of Service Dependencies</h2></div></div></div><div class="para">
		Services are allowed to declare dependencies on other services using either of 2 approaches:
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">@<code class="classname">org.hibernate.service.spi.InjectService</code></span></dt><dd><div class="para">
					Any method on the service implementation class accepting a single parameter and annotated with @<code class="classname">InjectService</code> is considered requesting injection of another service.
				</div><div class="para">
					By default the type of the method parameter is expected to be the service role to be injected. If the parameter type is different than the service role, the <code class="classname">serviceRole</code> attribute of the <code class="classname">InjectService</code> should be used to explicitly name the role.
				</div><div class="para">
					By default injected services are considered required, that is the start up will fail if a named dependent service is missing. If the service to be injected is optional, the <code class="classname">required</code> attribute of the <code class="classname">InjectService</code> should be declared as <code class="literal">false</code> (default is <code class="literal">true</code>).
				</div></dd><dt><span class="term"><code class="classname">org.hibernate.service.spi.ServiceRegistryAwareService</code></span></dt><dd><div class="para">
					The second approach is a pull approach where the service implements the optional service interface <code class="classname">org.hibernate.service.spi.ServiceRegistryAwareService</code> which declares a single <code class="classname">injectServices</code> method.
				</div><div class="para">
					During startup, Hibernate will inject the <code class="classname">org.hibernate.service.ServiceRegistry</code> itself into services which implement this interface. The service can then use the <code class="classname">ServiceRegistry</code> reference to locate any additional services it needs.
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+9994-591907+%5BLatest%5D&amp;comment=Title%3A+Types+of+Service+Dependencies%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9994-591907+23+Feb+2014+16%3A55+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-The_ServiceRegistry">
      ⁠</a>13.5.4. The ServiceRegistry</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="About_the_ServiceRegistry">
      ⁠</a>13.5.4.1. About the ServiceRegistry</h3></div></div></div><div class="para">
		The central service API, aside from the services themselves, is the <code class="classname">org.hibernate.service.ServiceRegistry</code> interface. The main purpose of a service registry is to hold, manage and provide access to services.
	</div><div class="para">
		Service registries are hierarchical. Services in one registry can depend on and utilize services in that same registry as well as any parent registries.
	</div><div class="para">
		Use <code class="classname">org.hibernate.service.ServiceRegistryBuilder</code> to build a <code class="classname">org.hibernate.service.ServiceRegistry</code> instance.
	</div><div class="example"><a id="idm140550801597008">
      ⁠</a><p class="title"><strong>Example 13.21. Use ServiceRegistryBuilder to create a ServiceRegistry</strong></p><div class="example-contents"><pre class="programlisting JAVA">
ServiceRegistryBuilder registryBuilder = new ServiceRegistryBuilder( bootstrapServiceRegistry );
    ServiceRegistry serviceRegistry = registryBuilder.buildServiceRegistry();
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+9995-591907+%5BLatest%5D&amp;comment=Title%3A+About+the+ServiceRegistry%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9995-591907+23+Feb+2014+16%3A55+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Custom_Services">
      ⁠</a>13.5.5. Custom Services</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="About_Custom_Services">
      ⁠</a>13.5.5.1. About Custom Services</h3></div></div></div><div class="para">
		Once a <code class="classname">org.hibernate.service.ServiceRegistry</code> is built it is considered immutable; the services themselves might accept re-configuration, but immutability here means adding/replacing services. So another role provided by the <code class="classname">org.hibernate.service.ServiceRegistryBuilder</code> is to allow tweaking of the services that will be contained in the <code class="classname">org.hibernate.service.ServiceRegistry</code> generated from it.
	</div><div class="para">
		There are two means to tell a <code class="classname">org.hibernate.service.ServiceRegistryBuilder</code> about custom services.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				Implement a <code class="classname">org.hibernate.service.spi.BasicServiceInitiator</code> class to control on-demand construction of the service class and add it to the <code class="classname">org.hibernate.service.ServiceRegistryBuilder</code> via its <code class="methodname">addInitiator</code> method.
			</div></li><li class="listitem"><div class="para">
				Just instantiate the service class and add it to the <code class="classname">org.hibernate.service.ServiceRegistryBuilder</code> via its <code class="methodname">addService</code> method.
			</div></li></ul></div><div class="para">
		Either approach the adding a service approach or the adding an initiator approach are valid for extending a registry (adding new service roles) and overriding services (replacing service implementations).
	</div><div class="example"><a id="idm140550798363680">
      ⁠</a><p class="title"><strong>Example 13.22. Use ServiceRegistryBuilder to Replace an Existing Service with a Custom Service</strong></p><div class="example-contents"><pre class="programlisting JAVA">
   ServiceRegistryBuilder registryBuilder = new ServiceRegistryBuilder( bootstrapServiceRegistry );
   registryBuilder.addService( JdbcServices.class, new FakeJdbcService() ); 
   ServiceRegistry serviceRegistry = registryBuilder.buildServiceRegistry();


   public class FakeJdbcService implements JdbcServices{

       @Override
       public ConnectionProvider getConnectionProvider() {
           return null;
       }

       @Override
       public Dialect getDialect() {
           return null;
       }

       @Override
       public SqlStatementLogger getSqlStatementLogger() {
           return null;
       }

       @Override
       public SqlExceptionHelper getSqlExceptionHelper() {
           return null;
       }

       @Override
       public ExtractedDatabaseMetaData getExtractedMetaDataSupport() {
           return null;
       }

       @Override
       public LobCreator getLobCreator(LobCreationContext lobCreationContext) {
           return null;
       }

       @Override
       public ResultSetWrapper getResultSetWrapper() {
           return null;
       }
   }
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+9997-707094+%5BLatest%5D&amp;comment=Title%3A+About+Custom+Services%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9997-707094+08+Sep+2014+00%3A12+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-The_Bootstrap_Registry">
      ⁠</a>13.5.6. The Bootstrap Registry</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="About_the_Boot-strap_Registry">
      ⁠</a>13.5.6.1. About the Boot-strap Registry</h3></div></div></div><div class="para">
		The boot-strap registry holds services that absolutely have to be available for most things to work. The main service here is the <code class="classname">ClassLoaderService</code> which is a perfect example. Even resolving configuration files needs access to class loading services (resource look ups). This is the root registry (no parent) in normal use.
	</div><div class="para">
		Instances of boot-strap registries are built using the <code class="classname">org.hibernate.service.BootstrapServiceRegistryBuilder</code> class.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+9998-591907+%5BLatest%5D&amp;comment=Title%3A+About+the+Boot-strap+Registry%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9998-591907+23+Feb+2014+16%3A55+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Using_BootstrapServiceRegistryBuilder">
      ⁠</a>13.5.6.2. Using BootstrapServiceRegistryBuilder</h3></div></div></div><div class="example"><a id="idm140550741813504">
      ⁠</a><p class="title"><strong>Example 13.23. Using BootstrapServiceRegistryBuilder</strong></p><div class="example-contents"><pre class="programlisting JAVA">
BootstrapServiceRegistry bootstrapServiceRegistry = new BootstrapServiceRegistryBuilder()
        // pass in org.hibernate.integrator.spi.Integrator instances which are not
        // auto-discovered (for whatever reason) but which should be included
        .with( anExplicitIntegrator )
        // pass in a class loader that Hibernate should use to load application classes
        .with( anExplicitClassLoaderForApplicationClasses )
        // pass in a class loader that Hibernate should use to load resources
        .with( anExplicitClassLoaderForResources )
        // see BootstrapServiceRegistryBuilder for rest of available methods
        ...
        // finally, build the bootstrap registry with all the above options
        .build();
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+9999-765012+%5BLatest%5D&amp;comment=Title%3A+Using+BootstrapServiceRegistryBuilder%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9999-765012+14+Jul+2015+13%3A17+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="BootstrapRegistry_Services">
      ⁠</a>13.5.6.3. BootstrapRegistry Services</h3></div></div></div><div class="para">
		<code class="classname">org.hibernate.service.classloading.spi.ClassLoaderService</code>
	</div><div class="para">
		Hibernate needs to interact with class loaders. However, the manner in which Hibernate (or any library) should interact with class loaders varies based on the runtime environment which is hosting the application. Application servers, OSGi containers, and other modular class loading systems impose very specific class loading requirements. This service is provides Hibernate an abstraction from this environmental complexity. And just as importantly, it does so in a single-swappable-component manner.
	</div><div class="para">
		In terms of interacting with a class loader, Hibernate needs the following capabilities: 
		<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					the ability to locate application classes
				</div></li><li class="listitem"><div class="para">
					the ability to locate integration classes
				</div></li><li class="listitem"><div class="para">
					the ability to locate resources (properties files, xml files, etc)
				</div></li><li class="listitem"><div class="para">
					the ability to load <code class="classname">java.util.ServiceLoader</code>
				</div></li></ul></div>

	</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			Currently, the ability to load application classes and the ability to load integration classes are combined into a single "load class" capability on the service. That may change in a later release.
		</div></div></div><div class="para">
		<code class="interfacename">org.hibernate.integrator.spi.IntegratorService</code>
	</div><div class="para">
		Applications, add-ons and other modules need to integrate with Hibernate. The previous approach required a component, usually an application, to coordinate the registration of each individual module. This registration was conducted on behalf of each module's integrator.
	</div><div class="para">
		This service focuses on the discovery aspect. It leverages the standard Java <code class="classname">java.util.ServiceLoader</code> capability provided by the <code class="interfacename">org.hibernate.service.classloading.spi.ClassLoaderService</code> in order to discover implementations of the <code class="interfacename">org.hibernate.integrator.spi.Integrator</code> contract.
	</div><div class="para">
		Integrators would simply define a file named <code class="filename">/META-INF/services/org.hibernate.integrator.spi.Integrator</code> and make it available on the classpath.
	</div><div class="para">
		This file is used by the <code class="classname">java.util.ServiceLoader</code> mechanism. It lists, one per line, the fully qualified names of classes which implement the <code class="classname">org.hibernate.integrator.spi.Integrator</code> interface.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+10000-765000+%5BLatest%5D&amp;comment=Title%3A+BootstrapRegistry+Services%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=10000-765000+14+Jul+2015+11%3A51+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-The_SessionFactory_Registry">
      ⁠</a>13.5.7. The SessionFactory Registry</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="SessionFactory_Registry">
      ⁠</a>13.5.7.1. SessionFactory Registry</h3></div></div></div><div class="para">
		While it is best practice to treat instances of all the registry types as targeting a given <code class="interfacename">org.hibernate.SessionFactory</code>, the instances of services in this group explicitly belong to a single <code class="interfacename">org.hibernate.SessionFactory</code>.
	</div><div class="para">
		The difference is a matter of timing in when they need to be initiated. Generally they need access to the <code class="interfacename">org.hibernate.SessionFactory</code> to be initiated. This special registry is <code class="interfacename">org.hibernate.service.spi.SessionFactoryServiceRegistry</code>
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+10001-591907+%5BLatest%5D&amp;comment=Title%3A+SessionFactory+Registry%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=10001-591907+23+Feb+2014+16%3A55+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="SessionFactory_Services">
      ⁠</a>13.5.7.2. SessionFactory Services</h3></div></div></div><div class="variablelist"><p class="title"><strong><code class="interfacename">org.hibernate.event.service.spi.EventListenerRegistry</code></strong></p><dl class="variablelist"><dt><span class="term">Description</span></dt><dd><div class="para">
					Service for managing event listeners.
				</div></dd><dt><span class="term">Initiator</span></dt><dd><div class="para">
					<code class="classname">org.hibernate.event.service.internal.EventListenerServiceInitiator</code>
				</div></dd><dt><span class="term">Implementations</span></dt><dd><div class="para">
					<code class="classname">org.hibernate.event.service.internal.EventListenerRegistryImpl</code>
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+10002-591907+%5BLatest%5D&amp;comment=Title%3A+SessionFactory+Services%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=10002-591907+23+Feb+2014+16%3A55+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Integrators">
      ⁠</a>13.5.8. Integrators</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Integrators">
      ⁠</a>13.5.8.1. Integrators</h3></div></div></div><div class="para">
		The <code class="interfacename">org.hibernate.integrator.spi.Integrator</code> is intended to provide a simple means for allowing developers to hook into the process of building a functioning SessionFactory. The <code class="interfacename">org.hibernate.integrator.spi.Integrator</code> interface defines 2 methods of interest: <code class="methodname">integrate</code> allows us to hook into the building process; <code class="methodname">disintegrate</code> allows us to hook into a SessionFactory shutting down.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			There is a 3rd method defined on <code class="interfacename">org.hibernate.integrator.spi.Integrator</code>, an overloaded form of <code class="methodname">integrate</code> accepting a <code class="interfacename">org.hibernate.metamodel.source.MetadataImplementor</code> instead of <code class="classname">org.hibernate.cfg.Configuration</code>. This form is intended for use with the new metamodel code scheduled for completion in 5.0.
		</div></div></div><div class="para">
		In addition to the discovery approach provided by the IntegratorService, applications can manually register Integrator implementations when building the BootstrapServiceRegistry.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+10004-591907+%5BLatest%5D&amp;comment=Title%3A+Integrators%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=10004-591907+23+Feb+2014+16%3A55+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Integrator_use-cases">
      ⁠</a>13.5.8.2. Integrator use-cases</h3></div></div></div><div class="para">
		The main use cases for an <code class="interfacename">org.hibernate.integrator.spi.Integrator</code> right now are registering event listeners and providing services (see <code class="interfacename">org.hibernate.integrator.spi.ServiceContributingIntegrator</code>). With 5.0 we plan on expanding that to allow altering the metamodel describing the mapping between object and relational models.
	</div><div class="example"><a id="idm140550727778096">
      ⁠</a><p class="title"><strong>Example 13.24. Registering event listeners</strong></p><div class="example-contents"><pre class="programlisting JAVA">
public class MyIntegrator implements org.hibernate.integrator.spi.Integrator {

    public void integrate(
            Configuration configuration,
            SessionFactoryImplementor sessionFactory,
            SessionFactoryServiceRegistry serviceRegistry) {
        // As you might expect, an EventListenerRegistry is the thing with which event listeners are registered  It is a
        // service so we look it up using the service registry
        final EventListenerRegistry eventListenerRegistry = serviceRegistry.getService( EventListenerRegistry.class );

        // If you wish to have custom determination and handling of "duplicate" listeners, you would have to add an
        // implementation of the org.hibernate.event.service.spi.DuplicationStrategy contract like this
        eventListenerRegistry.addDuplicationStrategy( myDuplicationStrategy );

        // EventListenerRegistry defines 3 ways to register listeners:
        //     1) This form overrides any existing registrations with
        eventListenerRegistry.setListeners( EventType.AUTO_FLUSH, myCompleteSetOfListeners );
        //     2) This form adds the specified listener(s) to the beginning of the listener chain
        eventListenerRegistry.prependListeners( EventType.AUTO_FLUSH, myListenersToBeCalledFirst );
		//     3) This form adds the specified listener(s) to the end of the listener chain
        eventListenerRegistry.appendListeners( EventType.AUTO_FLUSH, myListenersToBeCalledLast ); 
    }
}
</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+10267-591920+%5BLatest%5D&amp;comment=Title%3A+Integrator+use-cases%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=10267-591920+23+Feb+2014+16%3A55+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-Bean_Validation">
      ⁠</a>13.6. Bean Validation</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_Bean_Validation1">
      ⁠</a>13.6.1. About Bean Validation</h2></div></div></div><div class="para">
		Bean Validation, or JavaBeans Validation, is a model for validating data in Java objects. The model uses built-in and custom annotation constraints to ensure the integrity of application data. The specification is documented here: <a href="http://jcp.org/en/jsr/detail?id=303">http://jcp.org/en/jsr/detail?id=303</a>.
	</div><div class="para">
		Hibernate Validator is the JBoss EAP 6 implementation of Bean Validation. It is also the reference implementation of the JSR.
	</div><div class="para">
		JBoss EAP 6 is 100% compliant with JSR 303 - Bean Validation. Hibernate Validator also provides additional features to the specification.
	</div><div class="para">
		To get started with Bean Validation, refer to the <code class="code">bean-validation</code> quickstart example: <a class="xref" href="chap-Get_Started_Developing_Applications.html#Access_the_Java_EE_Quickstart_Examples">Section 1.4.1.1, “Access the Quickstarts”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+2243-591649+%5BLatest%5D&amp;comment=Title%3A+About+Bean+Validation%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=2243-591649+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Hibernate_Validator1">
      ⁠</a>13.6.2. Hibernate Validator</h2></div></div></div><div class="para">
		Hibernate Validator is the reference implementation of <a href="http://jcp.org/en/jsr/detail?id=303">JSR 303 - Bean Validation</a>.
	</div><div class="para">
		Bean Validation provides users with a model for validating Java object data. For more information, refer to <a class="xref" href="chap-Hibernate.html#About_Bean_Validation1">Section 13.6.1, “About Bean Validation”</a> and <a class="xref" href="chap-Hibernate.html#About_Validation_Constraints1">Section 13.6.3.1, “About Validation Constraints”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+4416-591662+%5BLatest%5D&amp;comment=Title%3A+Hibernate+Validator%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4416-591662+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Validation_Constraints">
      ⁠</a>13.6.3. Validation Constraints</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="About_Validation_Constraints1">
      ⁠</a>13.6.3.1. About Validation Constraints</h3></div></div></div><div class="para">
		Validation constraints are rules applied to a java element, such as a field, property or bean. A constraint will usually have a set of attributes used to set its limits. There are predefined constraints, and custom ones can be created. Each constraint is expressed in the form of an annotation.
	</div><div class="para">
		The built-in validation constraints for Hibernate Validator are listed here: <a class="xref" href="chap-Hibernate.html#Hibernate_Validator_Constraints1">Section 13.6.3.3, “Hibernate Validator Constraints”</a>
	</div><div class="para">
		For more information, refer to <a class="xref" href="chap-Hibernate.html#Hibernate_Validator1">Section 13.6.2, “Hibernate Validator”</a> and <a class="xref" href="chap-Hibernate.html#About_Bean_Validation1">Section 13.6.1, “About Bean Validation”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+2396-591649+%5BLatest%5D&amp;comment=Title%3A+About+Validation+Constraints%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=2396-591649+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Create_a_Constraint_Annotation_in_the_JBoss_Developer_Studio1">
      ⁠</a>13.6.3.2. Create a Constraint Annotation in Red Hat JBoss Developer Studio</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			This task covers the process of creating a constraint annotation in Red Hat JBoss Developer Studio, for use within a Java application.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				<a class="xref" href="chap-Get_Started_Developing_Applications.html#Start_JBoss_Developer_Studio">Section 1.3.1.4, “Start Red Hat JBoss Developer Studio”</a>
			</div></li></ul></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140550774639520">
      ⁠</a><p class="title"><strong>Procedure 13.5. Create a Constraint Annotation</strong></p><ol class="1"><li class="step"><div class="para">
				Open a Java project in Red Hat JBoss Developer Studio.
			</div></li><li class="step"><p class="title"><strong>Create a Data Set</strong></p><div class="para">
				A constraint annotation requires a data set that defines the acceptable values.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Right click on the project root folder in the <span class="guilabel"><strong>Project Explorer</strong></span> panel.
					</div></li><li class="step"><div class="para">
						Select <span class="guimenu"><strong>New</strong></span> → <span class="guimenuitem"><strong>Enum</strong></span>.
					</div></li><li class="step"><div class="para">
						Configure the following elements:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<span class="guilabel"><strong>Package:</strong></span>
							</div></li><li class="listitem"><div class="para">
								<span class="guilabel"><strong>Name:</strong></span>
							</div></li></ul></div></li><li class="step"><div class="para">
						Click the <span class="guibutton"><strong>Add...</strong></span> button to add any required interfaces.
					</div></li><li class="step"><div class="para">
						Click <span class="guibutton"><strong>Finish</strong></span> to create the file.
					</div></li><li class="step"><div class="para">
						Add a set of values to the data set and click <span class="guibutton"><strong>Save</strong></span>.
					</div></li></ol><div class="example"><a id="idm140550813820672">
      ⁠</a><p class="title"><strong>Example 13.25. Example Data Set</strong></p><div class="example-contents"><pre class="programlisting">
package com.example;

public enum CaseMode {
    UPPER,
    LOWER;
}
</pre></div></div></li><li class="step"><p class="title"><strong>Create the Annotation File</strong></p><div class="para">
				Create a new Java class.
			</div></li><li class="step"><div class="para">
				Configure the constraint annotation and click <span class="guibutton"><strong>Save</strong></span>.
			</div><div class="example"><a id="idm140550772756720">
      ⁠</a><p class="title"><strong>Example 13.26. Example Constraint Annotation File</strong></p><div class="example-contents"><pre class="programlisting">package com.mycompany;

import static java.lang.annotation.ElementType.*;
import static java.lang.annotation.RetentionPolicy.*;

import java.lang.annotation.Documented;
import java.lang.annotation.Retention;
import java.lang.annotation.Target;

import javax.validation.Constraint;
import javax.validation.Payload;

@Target( { METHOD, FIELD, ANNOTATION_TYPE })
@Retention(RUNTIME)
@Constraint(validatedBy = CheckCaseValidator.class)
@Documented
public @interface CheckCase {

    String message() default "{com.mycompany.constraints.checkcase}";

    Class&lt;?&gt;[] groups() default {};

    Class&lt;? extends Payload&gt;[] payload() default {};
    
    CaseMode value();

}</pre></div></div></li></ol></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Result</span></dt><dd><div class="para">
					A custom constraint annotation with a set of possible values has been created, ready to be used in the Java project.
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+2448-744241+%5BLatest%5D&amp;comment=Title%3A+Create+a+Constraint+Annotation+in+Red+Hat+JBoss+Developer+Studio%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=2448-744241+22+Feb+2015+18%3A22+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Hibernate_Validator_Constraints1">
      ⁠</a>13.6.3.3. Hibernate Validator Constraints</h3></div></div></div><div class="table"><a id="idm140550810276208">
      ⁠</a><p class="title"><strong>Table 13.11. Built-in Constraints</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="gt-4-cols gt-14-rows" summary="Built-in Constraints"><colgroup><col width="25%" style="text-align: left" class="c1"/><col width="25%" style="text-align: left" class="c2"/><col width="25%" style="text-align: left" class="c3"/><col width="25%" style="text-align: left" class="c4"/></colgroup><thead><tr><th style="text-align: left"> Annotation </th><th style="text-align: left"> Apply on </th><th style="text-align: left"> Runtime checking </th><th style="text-align: left"> Hibernate Metadata impact </th></tr></thead><tbody><tr><td style="text-align: left"> @Length(min=, max=) </td><td style="text-align: left"> property (String) </td><td style="text-align: left"> Check if the string length matches the range. </td><td style="text-align: left"> Column length will be set to max. </td></tr><tr><td style="text-align: left"> @Max(value=) </td><td style="text-align: left"> property (numeric or string representation of a numeric) </td><td style="text-align: left"> Check if the value is less than or equal to max. </td><td style="text-align: left"> Add a check constraint on the column. </td></tr><tr><td style="text-align: left"> @Min(value=) </td><td style="text-align: left"> property (numeric or string representation of a numeric) </td><td style="text-align: left"> Check if the value is more than or equal to Min. </td><td style="text-align: left"> Add a check constraint on the column. </td></tr><tr><td style="text-align: left"> @NotNull </td><td style="text-align: left"> property </td><td style="text-align: left"> Check if the value is not null. </td><td style="text-align: left"> Column(s) are not null. </td></tr><tr><td style="text-align: left"> @NotEmpty </td><td style="text-align: left"> property </td><td style="text-align: left"> Check if the string is not null nor empty. Check if the connection is not null nor empty. </td><td style="text-align: left"> Column(s) are not null (for String). </td></tr><tr><td style="text-align: left"> @Past </td><td style="text-align: left"> property (date or calendar) </td><td style="text-align: left"> Check if the date is in the past. </td><td style="text-align: left"> Add a check constraint on the column. </td></tr><tr><td style="text-align: left"> @Future </td><td style="text-align: left"> property (date or calendar) </td><td style="text-align: left"> Check if the date is in the future. </td><td style="text-align: left"> None. </td></tr><tr><td style="text-align: left"> @Pattern(regex="regexp", flag=) or @Patterns( {@Pattern(...)} ) </td><td style="text-align: left"> property (string) </td><td style="text-align: left"> Check if the property matches the regular expression given a match flag (see <code class="classname">java.util.regex.Pattern</code>). </td><td style="text-align: left"> None. </td></tr><tr><td style="text-align: left"> @Range(min=, max=) </td><td style="text-align: left"> property (numeric or string representation of a numeric) </td><td style="text-align: left"> Check if the value is between min and max (included). </td><td style="text-align: left"> Add a check constraint on the column. </td></tr><tr><td style="text-align: left"> @Size(min=, max=) </td><td style="text-align: left"> property (array, collection, map) </td><td style="text-align: left"> Check if the element size is between min and max (included). </td><td style="text-align: left"> None. </td></tr><tr><td style="text-align: left"> @AssertFalse </td><td style="text-align: left"> property </td><td style="text-align: left"> Check that the method evaluates to false (useful for constraints expressed in code rather than annotations). </td><td style="text-align: left"> None. </td></tr><tr><td style="text-align: left"> @AssertTrue </td><td style="text-align: left"> property </td><td style="text-align: left"> Check that the method evaluates to true (useful for constraints expressed in code rather than annotations). </td><td style="text-align: left"> None. </td></tr><tr><td style="text-align: left"> @Valid </td><td style="text-align: left"> property (object) </td><td style="text-align: left"> Perform validation recursively on the associated object. If the object is a Collection or an array, the elements are validated recursively. If the object is a Map, the value elements are validated recursively. </td><td style="text-align: left"> None. </td></tr><tr><td style="text-align: left"> @Email </td><td style="text-align: left"> property (String) </td><td style="text-align: left"> Check whether the string is conform to the e-mail address specification. </td><td style="text-align: left"> None. </td></tr><tr><td style="text-align: left"> @CreditCardNumber </td><td style="text-align: left"> property (String) </td><td style="text-align: left"> Check whether the string is a well formatted credit card number (derivative of the Luhn algorithm). </td><td style="text-align: left"> None. </td></tr><tr><td style="text-align: left"> @Digits(integerDigits=1) </td><td style="text-align: left"> property (numeric or string representation of a numeric) </td><td style="text-align: left"> Check whether the property is a number having up to <code class="literal">integerDigits</code> integer digits and <code class="literal">fractionalDigits</code> fractional digits. </td><td style="text-align: left"> Define column precision and scale. </td></tr><tr><td style="text-align: left"> @EAN </td><td style="text-align: left"> property (string) </td><td style="text-align: left"> Check whether the string is a properly formatted EAN or UPC-A code. </td><td style="text-align: left"> None. </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+2432-591649+%5BLatest%5D&amp;comment=Title%3A+Hibernate+Validator+Constraints%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=2432-591649+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Configuration">
      ⁠</a>13.6.4. Configuration</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Example_Validation_Configuration_File">
      ⁠</a>13.6.4.1. Example Validation Configuration File</h3></div></div></div><div class="example"><a id="idm140550769494560">
      ⁠</a><p class="title"><strong>Example 13.27. validation.xml</strong></p><div class="example-contents"><pre class="programlisting">&lt;validation-config xmlns="http://jboss.org/xml/ns/javax/validation/configuration"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://jboss.org/xml/ns/javax/validation/configuration"&gt;

    &lt;default-provider&gt;
        org.hibernate.validator.HibernateValidator
    &lt;/default-provider&gt;
    &lt;message-interpolator&gt;
        org.hibernate.validator.messageinterpolation.ResourceBundleMessageInterpolator
    &lt;/message-interpolator&gt;
    &lt;constraint-validator-factory&gt;
        org.hibernate.validator.engine.ConstraintValidatorFactoryImpl
    &lt;/constraint-validator-factory&gt;
    
    &lt;constraint-mapping&gt;
        /constraints-example.xml
    &lt;/constraint-mapping&gt;
    
    &lt;property name="prop1"&gt;value1&lt;/property&gt;
    &lt;property name="prop2"&gt;value2&lt;/property&gt;
&lt;/validation-config&gt;</pre></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+4623-591670+%5BLatest%5D&amp;comment=Title%3A+Example+Validation+Configuration+File%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4623-591670+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-Envers">
      ⁠</a>13.7. Envers</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_Hibernate_Envers1">
      ⁠</a>13.7.1. About Hibernate Envers</h2></div></div></div><div class="para">
		Hibernate Envers is an auditing and versioning system, providing JBoss EAP 6 with a means to track historical changes to persistent classes. Audit tables are created for entities annotated with <code class="code">@Audited</code>, which store the history of changes made to the entity. The data can then be retrieved and queried.
	</div><div class="para">
		Envers allows developers to:
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				audit all mappings defined by the JPA specification,
			</div></li><li class="listitem"><div class="para">
				audit all hibernate mappings that extend the JPA specification,
			</div></li><li class="listitem"><div class="para">
				audit entities mapped by or using the native Hibernate API
			</div></li><li class="listitem"><div class="para">
				log data for each revision using a revision entity, and
			</div></li><li class="listitem"><div class="para">
				query historical data.
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+5010-591675+%5BLatest%5D&amp;comment=Title%3A+About+Hibernate+Envers%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5010-591675+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="About_Auditing_Persistent_Classes">
      ⁠</a>13.7.2. About Auditing Persistent Classes</h2></div></div></div><div class="para">
		Auditing of persistent classes is done in JBoss EAP 6 through Hibernate Envers and the <code class="code">@Audited</code> annotation. When the annotation is applied to a class, a table is created, which stores the revision history of the entity.
	</div><div class="para">
		Each time a change is made to the class, an entry is added to the audit table. The entry contains the changes to the class, and is given a revision number. This means that changes can be rolled back, or previous revisions can be viewed.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+5011-591675+%5BLatest%5D&amp;comment=Title%3A+About+Auditing+Persistent+Classes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5011-591675+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Auditing_Strategies">
      ⁠</a>13.7.3. Auditing Strategies</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="About_Auditing_Strategies">
      ⁠</a>13.7.3.1. About Auditing Strategies</h3></div></div></div><div class="para">
		Auditing strategies define how audit information is persisted, queried and stored. There are currently two audit strategies available with Hibernate Envers:
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Default Audit Strategy</span></dt><dd><div class="para">
					This strategy persists the audit data together with a start revision. For each row that is inserted, updated or deleted in an audited table, one or more rows are inserted in the audit tables, along with the start revision of its validity.
				</div><div class="para">
					Rows in the audit tables are never updated after insertion. Queries of audit information use subqueries to select the applicable rows in the audit tables, which are slow and difficult to index.
				</div></dd><dt><span class="term">Validity Audit Strategy</span></dt><dd><div class="para">
					This strategy stores the start revision, as well as the end revision of the audit information. For each row that is inserted, updated or deleted in an audited table, one or more rows are inserted in the audit tables, along with the start revision of its validity.
				</div><div class="para">
					At the same time, the end revision field of the previous audit rows (if available) is set to this revision. Queries on the audit information can then use <span class="emphasis"><em> between <em class="replaceable">start</em> and <em class="replaceable">end</em> revision</em></span>, instead of subqueries. This means that persisting audit information is a little slower because of the extra updates, but retrieving audit information is a lot faster.
				</div><div class="para">
					This can also be improved by adding extra indexes.
				</div></dd></dl></div><div class="para">
		For more information on auditing, refer to <a class="xref" href="chap-Hibernate.html#About_Auditing_Persistent_Classes">Section 13.7.2, “About Auditing Persistent Classes”</a>. To set the auditing strategy for the application, refer here: <a class="xref" href="chap-Hibernate.html#Set_the_Auditing_Strategy">Section 13.7.3.2, “Set the Auditing Strategy”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+5028-591680+%5BLatest%5D&amp;comment=Title%3A+About+Auditing+Strategies%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5028-591680+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Set_the_Auditing_Strategy">
      ⁠</a>13.7.3.2. Set the Auditing Strategy</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			There are two audit strategies supported by JBoss EAP 6: the default and validity audit strategies. This task covers the steps required to define the auditing strategy for an application.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140550729328208">
      ⁠</a><p class="title"><strong>Procedure 13.6. Define a Auditing Strategy</strong></p><ul><li class="step"><div class="para">
				Configure the <code class="code">org.hibernate.envers.audit_strategy</code> property in the <code class="filename">persistence.xml</code> file of the application. If the property is not set in the <code class="filename">persistence.xml</code> file, then the default audit strategy is used.
			</div><div class="example"><a id="idm140550718743664">
      ⁠</a><p class="title"><strong>Example 13.28. Set the Default Audit Strategy</strong></p><div class="example-contents"><pre class="programlisting">
&lt;property name="org.hibernate.envers.audit_strategy" value="org.hibernate.envers.strategy.DefaultAuditStrategy"/&gt;
</pre></div></div><div class="example"><a id="idm140550723584976">
      ⁠</a><p class="title"><strong>Example 13.29. Set the Validity Audit Strategy</strong></p><div class="example-contents"><pre class="programlisting">
&lt;property name="org.hibernate.envers.audit_strategy" value="org.hibernate.envers.strategy.ValidityAuditStrategy"/&gt;
</pre></div></div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+5014-591680+%5BLatest%5D&amp;comment=Title%3A+Set+the+Auditing+Strategy%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5014-591680+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Getting_Started_with_Entity_Auditing">
      ⁠</a>13.7.4. Getting Started with Entity Auditing</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Add_Auditing_Support_to_a_JPA_Entity">
      ⁠</a>13.7.4.1. Add Auditing Support to a JPA Entity</h3></div></div></div><div class="para">
		JBoss EAP 6 uses entity auditing, through <a class="xref" href="chap-Hibernate.html#About_Hibernate_Envers1">Section 13.7.1, “About Hibernate Envers”</a>, to track the historical changes of a persistent class. This topic covers adding auditing support for a JPA entity.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140550772528144">
      ⁠</a><p class="title"><strong>Procedure 13.7. Add Auditing Support to a JPA Entity</strong></p><ol class="1"><li class="step"><div class="para">
				Configure the available auditing parameters to suit the deployment: <a class="xref" href="chap-Hibernate.html#Configure_Envers_Parameters1">Section 13.7.5.1, “Configure Envers Parameters”</a>.
			</div></li><li class="step"><div class="para">
				Open the JPA entity to be audited.
			</div></li><li class="step"><div class="para">
				Import the <code class="methodname">org.hibernate.envers.Audited</code> interface.
			</div></li><li class="step"><div class="para">
				Apply the <code class="code">@Audited</code> annotation to each field or property to be audited, or apply it once to the whole class.
			</div><div class="example"><a id="idm140550741725664">
      ⁠</a><p class="title"><strong>Example 13.30. Audit Two Fields</strong></p><div class="example-contents"><pre class="programlisting">
import org.hibernate.envers.Audited;

import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.GeneratedValue;
import javax.persistence.Column;

@Entity
public class Person {
    @Id
    @GeneratedValue
    private int id;

    @Audited
    private String name;

    private String surname;

    @ManyToOne
    @Audited
    private Address address;

    // add getters, setters, constructors, equals and hashCode here
}
</pre></div></div><div class="example"><a id="idm140550723279392">
      ⁠</a><p class="title"><strong>Example 13.31. Audit an entire Class</strong></p><div class="example-contents"><pre class="programlisting">
import org.hibernate.envers.Audited;

import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.GeneratedValue;
import javax.persistence.Column;

@Entity
@Audited
public class Person {
    @Id
    @GeneratedValue
    private int id;

    private String name;

    private String surname;

    @ManyToOne
    private Address address;

    // add getters, setters, constructors, equals and hashCode here
}
</pre></div></div></li></ol></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Result</div>
			The JPA entity has been configured for auditing. A table called <code class="filename"><em class="replaceable">Entity</em>_AUD</code> will be created to store the historical changes.
		</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+5016-591680+%5BLatest%5D&amp;comment=Title%3A+Add+Auditing+Support+to+a+JPA+Entity%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5016-591680+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Configuration2">
      ⁠</a>13.7.5. Configuration</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_Envers_Parameters1">
      ⁠</a>13.7.5.1. Configure Envers Parameters</h3></div></div></div><div class="para">
		JBoss EAP 6 uses entity auditing, through Hibernate Envers, to track the historical changes of a persistent class. This topic covers configuring the available Envers parameters.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140550724616592">
      ⁠</a><p class="title"><strong>Procedure 13.8. Configure Envers Parameters</strong></p><ol class="1"><li class="step"><div class="para">
				Open the <code class="filename">persistence.xml</code> file for the application.
			</div></li><li class="step"><div class="para">
				Add, remove or configure Envers properties as required. For a list of available properties, refer to <a class="xref" href="chap-Hibernate.html#Envers_Configuration_Properties">Section 13.7.5.4, “Envers Configuration Properties”</a>.
			</div></li></ol></div><div class="example"><a id="idm140550723204528">
      ⁠</a><p class="title"><strong>Example 13.32. Example Envers Parameters</strong></p><div class="example-contents"><pre class="programlisting">&lt;persistence-unit name="mypc"&gt;
  &lt;description&gt;Persistence Unit.&lt;/description&gt;
  &lt;jta-data-source&gt;java:jboss/datasources/ExampleDS&lt;/jta-data-source&gt;
  &lt;shared-cache-mode&gt;ENABLE_SELECTIVE&lt;/shared-cache-mode&gt;
  &lt;properties&gt;
    &lt;property name="hibernate.hbm2ddl.auto" value="create-drop" /&gt;
    &lt;property name="hibernate.show_sql" value="true" /&gt;
    &lt;property name="hibernate.cache.use_second_level_cache"	value="true" /&gt;
    &lt;property name="hibernate.cache.use_query_cache" value="true" /&gt;
    &lt;property name="hibernate.generate_statistics" value="true" /&gt;
    &lt;property name="org.hibernate.envers.versionsTableSuffix" value="_V" /&gt;
    &lt;property name="org.hibernate.envers.revisionFieldName" value="ver_rev" /&gt;
  &lt;/properties&gt;
&lt;/persistence-unit&gt;</pre></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Result</span></dt><dd><div class="para">
					Auditing has been configured for all JPA entities in the application.
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+5013-591675+%5BLatest%5D&amp;comment=Title%3A+Configure+Envers+Parameters%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5013-591675+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Enable_or_Disable_Auditing_at_Runtime1">
      ⁠</a>13.7.5.2. Enable or Disable Auditing at Runtime</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			This task covers the configuration steps required to enable/disable entity version auditing at runtime.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140550810609584">
      ⁠</a><p class="title"><strong>Procedure 13.9. Enable/Disable Auditing</strong></p><ol class="1"><li class="step"><div class="para">
				Subclass the <code class="classname">AuditEventListener</code> class.
			</div></li><li class="step"><div class="para">
				Override the following methods that are called on Hibernate events:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						onPostInsert
					</div></li><li class="listitem"><div class="para">
						onPostUpdate
					</div></li><li class="listitem"><div class="para">
						onPostDelete
					</div></li><li class="listitem"><div class="para">
						onPreUpdateCollection
					</div></li><li class="listitem"><div class="para">
						onPreRemoveCollection
					</div></li><li class="listitem"><div class="para">
						onPostRecreateCollection
					</div></li></ul></div></li><li class="step"><div class="para">
				Specify the subclass as the listener for the events.
			</div></li><li class="step"><div class="para">
				Determine if the change should be audited.
			</div></li><li class="step optional"><div class="para">
				Pass the call to the superclass if the change should be audited.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+5025-591680+%5BLatest%5D&amp;comment=Title%3A+Enable+or+Disable+Auditing+at+Runtime%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5025-591680+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_Conditional_Auditing">
      ⁠</a>13.7.5.3. Configure Conditional Auditing</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			Hibernate Envers persists audit data in reaction to various Hibernate events, using a series of event listeners. These listeners are registered automatically if the Envers jar is in the class path. This task covers the steps required to implement conditional auditing, by overriding some of the Envers event listeners.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm140550725457344">
      ⁠</a><p class="title"><strong>Procedure 13.10. Implement Conditional Auditing</strong></p><ol class="1"><li class="step"><div class="para">
				Set the <code class="classname">hibernate.listeners.envers.autoRegister</code> Hibernate property to false in the <code class="filename">persistence.xml</code> file.
			</div></li><li class="step"><div class="para">
				Subclass each event listener to be overridden. Place the conditional auditing logic in the subclass, and call the super method if auditing should be performed.
			</div></li><li class="step"><div class="para">
				Create a custom implementation of <code class="classname">org.hibernate.integrator.spi.Integrator</code>, similar to <code class="classname">org.hibernate.envers.event.EnversIntegrator</code>. Use the event listener subclasses created in step two, rather than the default classes.
			</div></li><li class="step"><div class="para">
				Add a <code class="filename">META-INF/services/org.hibernate.integrator.spi.Integrator</code> file to the jar. This file should contain the fully qualified name of the class implementing the interface.
			</div></li></ol></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Result</div>
			Conditional auditing has been configured, overriding the default Envers event listeners.
		</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+5023-591680+%5BLatest%5D&amp;comment=Title%3A+Configure+Conditional+Auditing%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5023-591680+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Envers_Configuration_Properties">
      ⁠</a>13.7.5.4. Envers Configuration Properties</h3></div></div></div><div class="table"><a id="idm140550771311888">
      ⁠</a><p class="title"><strong>Table 13.12. Entity Data Versioning Configuration Parameters</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-7-rows" summary="Entity Data Versioning Configuration Parameters"><colgroup><col width="33%" class="c1"/><col width="33%" class="c2"/><col width="33%" class="c2"/></colgroup><thead><tr><th> Property Name </th><th> Default Value </th><th> Description </th></tr></thead><tbody><tr><td> <div class="para">
						<span class="property"> org.hibernate.envers.audit_table_prefix</span>
					</div>
					 </td><td> <div class="para">

					</div>
					 </td><td> <div class="para">
						A string that is prepended to the name of an audited entity, to create the name of the entity that will hold the audit information.
					</div>
					 </td></tr><tr><td> <div class="para">
						<span class="property"> org.hibernate.envers.audit_table_suffix</span>
					</div>
					 </td><td> <div class="para">
						_AUD
					</div>
					 </td><td> <div class="para">
						A string that is appended to the name of an audited entity to create the name of the entity that will hold the audit information. For example, if an entity with a table name of <code class="literal">Person</code> is audited, Envers will generate a table called <code class="literal">Person_AUD</code> to store the historical data.
					</div>
					 </td></tr><tr><td> <div class="para">
						<span class="property"> org.hibernate.envers.revision_field_name</span>
					</div>
					 </td><td> <div class="para">
						REV
					</div>
					 </td><td> <div class="para">
						The name of the field in the audit entity that holds the revision number.
					</div>
					 </td></tr><tr><td> <div class="para">
						<span class="property"> org.hibernate.envers.revision_type_field_name</span>
					</div>
					 </td><td> <div class="para">
						REVTYPE
					</div>
					 </td><td> <div class="para">
						The name of the field in the audit entity that holds the type of revision. The current types of revisions possible are: <code class="literal">add</code>, <code class="literal">mod</code> and <code class="literal">del</code>.
					</div>
					 </td></tr><tr><td> <div class="para">
						<span class="property"> org.hibernate.envers.revision_on_collection_change</span>
					</div>
					 </td><td> <div class="para">
						true
					</div>
					 </td><td> <div class="para">
						This property determines if a revision should be generated if a relation field that is not owned changes. This can either be a collection in a one-to-many relation, or the field using the <code class="code">mappedBy</code> attribute in a one-to-one relation.
					</div>
					 </td></tr><tr><td> <div class="para">
						<span class="property"> org.hibernate.envers.do_not_audit_optimistic_locking_field</span>
					</div>
					 </td><td> <div class="para">
						true
					</div>
					 </td><td> <div class="para">
						When true, properties used for optimistic locking (annotated with <code class="code">@Version</code>) will automatically be excluded from auditing.
					</div>
					 </td></tr><tr><td> <div class="para">
						<span class="property"> org.hibernate.envers.store_data_at_delete</span>
					</div>
					 </td><td> <div class="para">
						false
					</div>
					 </td><td> <div class="para">
						This property defines whether or not entity data should be stored in the revision when the entity is deleted, instead of only the ID, with all other properties marked as null. This is not usually necessary, as the data is present in the last-but-one revision. Sometimes, however, it is easier and more efficient to access it in the last revision. However, this means the data the entity contained before deletion is stored twice.
					</div>
					 </td></tr><tr><td> <div class="para">
						<span class="property"> org.hibernate.envers.default_schema</span>
					</div>
					 </td><td> <div class="para">
						null (same as normal tables)
					</div>
					 </td><td> <div class="para">
						The default schema name used for audit tables. Can be overridden using the <code class="literal">@AuditTable(schema="...")</code> annotation. If not present, the schema will be the same as the schema of the normal tables.
					</div>
					 </td></tr><tr><td> <div class="para">
						<span class="property"> org.hibernate.envers.default_catalog</span>
					</div>
					 </td><td> <div class="para">
						null (same as normal tables)
					</div>
					 </td><td> <div class="para">
						The default catalog name that should be used for audit tables. Can be overridden using the <code class="literal">@AuditTable(catalog="...")</code> annotation. If not present, the catalog will be the same as the catalog of the normal tables.
					</div>
					 </td></tr><tr><td> <div class="para">
						<span class="property"> org.hibernate.envers.audit_strategy</span>
					</div>
					 </td><td> <div class="para">
						org.hibernate.envers.strategy.DefaultAuditStrategy
					</div>
					 </td><td> <div class="para">
						This property defines the audit strategy that should be used when persisting audit data. By default, only the revision where an entity was modified is stored. Alternatively, <code class="literal">org.hibernate.envers.strategy.ValidityAuditStrategy</code> stores both the start revision and the end revision. Together, these define when an audit row was valid.
					</div>
					 </td></tr><tr><td> <div class="para">
						<span class="property"> org.hibernate.envers.audit_strategy_validity_end_rev_field_name</span>
					</div>
					 </td><td> <div class="para">
						REVEND
					</div>
					 </td><td> <div class="para">
						The column name that will hold the end revision number in audit entities. This property is only valid if the validity audit strategy is used.
					</div>
					 </td></tr><tr><td> <div class="para">
						<span class="property"> org.hibernate.envers.audit_strategy_validity_store_revend_timestamp</span>
					</div>
					 </td><td> <div class="para">
						false
					</div>
					 </td><td> <div class="para">
						This property defines whether the timestamp of the end revision, where the data was last valid, should be stored in addition to the end revision itself. This is useful to be able to purge old audit records out of a relational database by using table partitioning. Partitioning requires a column that exists within the table. This property is only evaluated if the <code class="literal">ValidityAuditStrategy</code> is used.
					</div>
					 </td></tr><tr><td> <div class="para">
						<span class="property"> org.hibernate.envers.audit_strategy_validity_revend_timestamp_field_name</span>
					</div>
					 </td><td> <div class="para">
						REVEND_TSTMP
					</div>
					 </td><td> <div class="para">
						Column name of the timestamp of the end revision at which point the data was still valid. Only used if the <code class="literal">ValidityAuditStrategy</code> is used, and <code class="methodname"> org.hibernate.envers.audit_strategy_validity_store_revend_timestamp</code> evaluates to true.
					</div>
					 </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+5015-591680+%5BLatest%5D&amp;comment=Title%3A+Envers+Configuration+Properties%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5015-591680+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Queries">
      ⁠</a>13.7.6. Queries</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Retrieve_Auditing_Information">
      ⁠</a>13.7.6.1. Retrieve Auditing Information</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			Hibernate Envers provides the functionality to retrieve audit information through queries. This topic provides examples of those queries.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			Queries on the audited data will be, in many cases, much slower than corresponding queries on <code class="literal">live</code> data, as they involve correlated subselects.
		</div></div></div><div class="example"><a id="idm140550729077776">
      ⁠</a><p class="title"><strong>Example 13.33. Querying for Entities of a Class at a Given Revision</strong></p><div class="example-contents"><div class="para">
			The entry point for this type of query is:
		</div><pre class="programlisting">AuditQuery query = getAuditReader()
    .createQuery()
    .forEntitiesAtRevision(MyEntity.class, revisionNumber);</pre><div class="para">
			Constraints can then be specified, using the <code class="literal">AuditEntity</code> factory class. The query below only selects entities where the <code class="literal">name</code> property is equal to <code class="literal">John</code>:
		</div><pre class="programlisting">query.add(AuditEntity.property("name").eq("John"));</pre><div class="para">
			The queries below only select entities that are related to a given entity:
		</div><pre class="programlisting">query.add(AuditEntity.property("address").eq(relatedEntityInstance));
// or
query.add(AuditEntity.relatedId("address").eq(relatedEntityId));</pre><div class="para">
			The results can then be ordered, limited, and have aggregations and projections (except grouping) set. The example below is a full query.
		</div><pre class="programlisting">List personsAtAddress = getAuditReader().createQuery()
    .forEntitiesAtRevision(Person.class, 12)
    .addOrder(AuditEntity.property("surname").desc())
    .add(AuditEntity.relatedId("address").eq(addressId))
    .setFirstResult(4)
    .setMaxResults(2)
    .getResultList();</pre></div></div><div class="example"><a id="idm140550804708384">
      ⁠</a><p class="title"><strong>Example 13.34. Query Revisions where Entities of a Given Class Changed</strong></p><div class="example-contents"><div class="para">
			The entry point for this type of query is:
		</div><pre class="programlisting">AuditQuery query = getAuditReader().createQuery()
    .forRevisionsOfEntity(MyEntity.class, false, true);</pre><div class="para">
			Constraints can be added to this query in the same way as the previous example. There are additional possibilities for this query:
		</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">AuditEntity.revisionNumber()</code></span></dt><dd><div class="para">
						Specify constraints, projections and order on the revision number in which the audited entity was modified.
					</div></dd><dt><span class="term"><code class="literal">AuditEntity.revisionProperty(propertyName)</code></span></dt><dd><div class="para">
						Specify constraints, projections and order on a property of the revision entity, corresponding to the revision in which the audited entity was modified.
					</div></dd><dt><span class="term"><code class="literal">AuditEntity.revisionType()</code></span></dt><dd><div class="para">
						Provides accesses to the type of the revision (ADD, MOD, DEL).
					</div></dd></dl></div><div class="para">
			The query results can then be adjusted as necessary. The query below selects the smallest revision number at which the entity of the <code class="code">MyEntity</code> class, with the <code class="code">entityId</code> ID has changed, after revision number 42:
		</div><pre class="programlisting">Number revision = (Number) getAuditReader().createQuery()
    .forRevisionsOfEntity(MyEntity.class, false, true)
    .setProjection(AuditEntity.revisionNumber().min())
    .add(AuditEntity.id().eq(entityId))
    .add(AuditEntity.revisionNumber().gt(42))
    .getSingleResult();</pre><div class="para">
			Queries for revisions can also minimize/maximize a property. The query below selects the revision at which the value of the <code class="literal">actualDate</code> for a given entity was larger than a given value, but as small as possible:
		</div><pre class="programlisting">Number revision = (Number) getAuditReader().createQuery()
    .forRevisionsOfEntity(MyEntity.class, false, true)
    // We are only interested in the first revision
    .setProjection(AuditEntity.revisionNumber().min())
    .add(AuditEntity.property("actualDate").minimize()
        .add(AuditEntity.property("actualDate").ge(givenDate))
        .add(AuditEntity.id().eq(givenEntityId)))
    .getSingleResult();</pre><div class="para">
			The <code class="literal">minimize()</code> and <code class="literal">maximize()</code> methods return a criteria, to which constraints can be added, which must be met by the entities with the maximized/minimized properties.
		</div><div class="para">
			There are two boolean parameters passed when creating the query.
		</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">selectEntitiesOnly</code></span></dt><dd><div class="para">
						This parameter is only valid when an explicit projection is not set.
					</div><div class="para">
						If true, the result of the query will be a list of entities that changed at revisions satisfying the specified constraints.
					</div><div class="para">
						If false, the result will be a list of three element arrays. The first element will be the changed entity instance. The second will be an entity containing revision data. If no custom entity is used, this will be an instance of <code class="literal">DefaultRevisionEntity</code>. The third element array will be the type of the revision (ADD, MOD, DEL).
					</div></dd><dt><span class="term"><code class="literal">selectDeletedEntities</code></span></dt><dd><div class="para">
						This parameter specifies if revisions in which the entity was deleted must be included in the results. If true, the entities will have the revision type <code class="literal">DEL</code>, and all fields, except id, will have the value <code class="literal">null</code>.
					</div></dd></dl></div></div></div><div class="example"><a id="idm140550722289168">
      ⁠</a><p class="title"><strong>Example 13.35. Query Revisions of an Entity that Modified a Given Property</strong></p><div class="example-contents"><div class="para">
			The query below will return all revisions of <code class="code">MyEntity</code> with a given id, where the <code class="code">actualDate</code> property has been changed.
		</div><pre class="programlisting">AuditQuery query = getAuditReader().createQuery()
  .forRevisionsOfEntity(MyEntity.class, false, true)
  .add(AuditEntity.id().eq(id));
  .add(AuditEntity.property("actualDate").hasChanged())</pre><div class="para">
			The <code class="code">hasChanged</code> condition can be combined with additional criteria. The query below will return a horizontal slice for <code class="code">MyEntity</code> at the time the <em class="replaceable">revisionNumber</em> was generated. It will be limited to the revisions that modified <code class="code">prop1</code>, but not <code class="code">prop2</code>.
		</div><pre class="programlisting">AuditQuery query = getAuditReader().createQuery()
  .forEntitiesAtRevision(MyEntity.class, revisionNumber)
  .add(AuditEntity.property("prop1").hasChanged())
  .add(AuditEntity.property("prop2").hasNotChanged());</pre><div class="para">
			The result set will also contain revisions with numbers lower than the <em class="replaceable">revisionNumber</em>. This means that this query cannot be read as "Return all <code class="code">MyEntities</code> changed in <em class="replaceable">revisionNumber</em> with <code class="code">prop1</code> modified and <code class="code">prop2</code> untouched."
		</div><div class="para">
			The query below shows how this result can be returned, using the <code class="code">forEntitiesModifiedAtRevision</code> query:
		</div><pre class="programlisting">AuditQuery query = getAuditReader().createQuery()
  .forEntitiesModifiedAtRevision(MyEntity.class, revisionNumber)
  .add(AuditEntity.property("prop1").hasChanged())
  .add(AuditEntity.property("prop2").hasNotChanged());</pre></div></div><div class="example"><a id="idm140550728859504">
      ⁠</a><p class="title"><strong>Example 13.36. Query Entities Modified in a Given Revision</strong></p><div class="example-contents"><div class="para">
			The example below shows the basic query for entities modified in a given revision. It allows entity names and corresponding Java classes changed in a specified revision to be retrieved:
		</div><pre class="programlisting">Set&lt;Pair&lt;String, Class&gt;&gt; modifiedEntityTypes = getAuditReader()
    .getCrossTypeRevisionChangesReader().findEntityTypes(revisionNumber);</pre><div class="para">
			There are a number of other queries that are also accessible from <code class="interfacename"> org.hibernate.envers.CrossTypeRevisionChangesReader</code>:
		</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="methodname">List&lt;Object&gt; findEntities(Number)</code></span></dt><dd><div class="para">
						Returns snapshots of all audited entities changed (added, updated and removed) in a given revision. Executes <code class="literal">n+1</code> SQL queries, where <code class="literal">n</code> is a number of different entity classes modified within the specified revision.
					</div></dd><dt><span class="term"><code class="methodname">List&lt;Object&gt; findEntities(Number, RevisionType)</code></span></dt><dd><div class="para">
						Returns snapshots of all audited entities changed (added, updated or removed) in a given revision filtered by modification type. Executes <code class="literal">n+1</code> SQL queries, where <code class="literal">n</code> is a number of different entity classes modified within specified revision.
					</div></dd><dt><span class="term"><code class="methodname">Map&lt;RevisionType, List&lt;Object&gt;&gt; findEntitiesGroupByRevisionType(Number)</code></span></dt><dd><div class="para">
						Returns a map containing lists of entity snapshots grouped by modification operation (e.g. addition, update and removal). Executes <code class="literal">3n+1</code> SQL queries, where <code class="literal">n</code> is a number of different entity classes modified within specified revision.
					</div></dd></dl></div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+5017-745436+%5BLatest%5D&amp;comment=Title%3A+Retrieve+Auditing+Information%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5017-745436+02+Mar+2015+06%3A48+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-Performance_Tuning">
      ⁠</a>13.8. Performance Tuning</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Alternative_Batch_Loading_Algorithms">
      ⁠</a>13.8.1. Alternative Batch Loading Algorithms</h2></div></div></div><div class="para">
		Hibernate allows you to load data for associations using one of four fetching strategies: join, select, subselect and batch. Out of these four strategies, batch loading allows for the biggest performance gains as it is an optimization strategy for select fetching. In this strategy, Hibernate retrieves a batch of entity instances or collections in a single SELECT statement by specifying a list of primary or foreign keys. Batch fetching is an optimization of the lazy select fetching strategy.
	</div><div class="para">
		There are two ways to configure batch fetching: per-class level or per-collection level.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				Per-Class Level
			</div><div class="para">
				When Hibernate loads data on a per-class level, it requires the batch size of the association to pre-load when queried. For example, consider that at runtime you have 30 instances of a <code class="literal">car</code> object loaded in session. Each <code class="literal">car</code> object belongs to an <code class="literal">owner</code> object. If you were to iterate through all the <code class="literal">car</code> objects and request their owners, with <code class="literal">lazy</code> loading, Hibernate will issue 30 select statements - one for each owner. This is a performance bottleneck.
			</div><div class="para">
				You can instead, tell Hibernate to pre-load the data for the next batch of owners before they have been sought via a query. When an <code class="code">owner</code> object has been queried, Hibernate will query many more of these objects in the same SELECT statement.
			</div><div class="para">
				The number of <code class="code">owner</code> objects to query in advance depends upon the <em class="parameter"><code>batch-size</code></em> parameter specified at configuration time: 
<pre class="programlisting">&lt;class name="owner" batch-size="10"&gt;&lt;/class&gt;</pre>

			</div><div class="para">
				This tells Hibernate to query at least 10 more <code class="code">owner</code> objects in expectation of them being needed in the near future. When a user queries the <code class="code">owner</code> of <code class="code">car A</code>, the <code class="code">owner</code> of <code class="code">car B</code> may already have been loaded as part of batch loading. When the user actually needs the <code class="code">owner</code> of <code class="code">car B</code>, instead of going to the database (and issuing a SELECT statement), the value can be retrieved from the current session.
			</div><div class="para">
				In addition to the <code class="code">batch-size</code> parameter, Hibernate 4.2.0 has introduced a new configuration item to improve in batch loading performance. The configuration item is called <code class="code">Batch Fetch Style</code> configuration and specified by the <em class="parameter"><code>hibernate.batch_fetch_style</code></em> parameter.
			</div><div class="para">
				Three different batch fetch styles are supported: LEGACY, PADDED and DYNAMIC. To specify which style to use, use <code class="code">org.hibernate.cfg.AvailableSettings#BATCH_FETCH_STYLE</code>.
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						LEGACY: In the legacy style of loading, a set of pre-built batch sizes based on <code class="code">ArrayHelper.getBatchSizes(int)</code> are utilized. Batches are loaded using the next-smaller pre-built batch size from the number of existing batchable identifiers.
					</div><div class="para">
						Continuing with the above example, with a <code class="code">batch-size</code> setting of 30, the pre-built batch sizes would be [30, 15, 10, 9, 8, 7, .., 1]. An attempt to batch load 29 identifiers would result in batches of 15, 10, and 4. There will be 3 corresponding SQL queries, each loading 15, 10 and 4 owners from the database.
					</div></li><li class="listitem"><div class="para">
						PADDED - Padded is similar to LEGACY style of batch loading. It still utilizes pre-built batch sizes, but uses the next-bigger batch size and pads the extra identifier placeholders.
					</div><div class="para">
						As with the example above, if 30 owner objects are to be initialized, there will only be one query executed against the database.
					</div><div class="para">
						However, if 29 owner objects are to be initialized, Hibernate will still execute only 1 SQL select statement of batch size 30, with the extra space padded with a repeated identifier.
					</div></li><li class="listitem"><div class="para">
						Dynamic - While still conforming to batch-size restrictions, this style of batch loading dynamically builds its SQL SELECT statement using the actual number of objects to be loaded.
					</div><div class="para">
						For example, for 30 owner objects, and a maximum batch size of 30, a call to retrieve 30 owner objects will result in one SQL SELECT statement. A call to retrieve 35 will result in two SQL statements, of batch sizes 30 and 5 respectively. Hibernate will dynamically alter the second SQL statement to keep at 5, the required number, while still remaining under the restriction of 30 as the batch-size. This is different to the PADDED version, as the second SQL will not get PADDED, and unlike the LEGACY style, there is no fixed size for the second SQL statement - the second SQL is created dynamically.
					</div><div class="para">
						For a query of less than 30 identifiers, this style will dynamically only load the number of identifiers requested.
					</div></li></ul></div></li><li class="listitem"><div class="para">
				Per-Collection Level
			</div><div class="para">
				Hibernate can also batch load collections honoring the batch fetch size and styles as listed in the per-class section above.
			</div><div class="para">
				To reverse the example used in the previous section, consider that you need to load all the <code class="code">car</code> objects owned by each <code class="code">owner</code> object. If 10 <code class="code">owner</code> objects are loaded in the current session iterating through all owners will generate 10 SELECT statements, one for every call to <code class="code">getCars()</code> method. If you enable batch fetching for the cars collection in the mapping of Owner, Hibernate can pre-fetch these collections, as shown below.
			</div><pre class="programlisting">&lt;class name="Owner"&gt;&lt;set name="cars" batch-size="5"&gt;&lt;/set&gt;&lt;/class&gt;</pre><div class="para">
				Thus, with a batch-size of 5 and using legacy batch style to load 10 collections, Hibernate will execute two SELECT statements, each retrieving 5 collections.
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+21769-745445+%5BLatest%5D&amp;comment=Title%3A+Alternative+Batch+Loading+Algorithms%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=21769-745445+02+Mar+2015+09%3A41+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Second_Level_Caching_of_Object_References_for_Non-mutable_Data">
      ⁠</a>13.8.2. Second Level Caching of Object References for Non-mutable Data</h2></div></div></div><div class="para">
		Hibernate automatically caches data within memory for improved performance. This is accomplished by an in-memory cache which reduces the number of times that database lookups are required, especially for data that rarely changes.
	</div><div class="para">
		Hibernate maintains two types of caches. The primary cache (also called the first-level cache) is mandatory. This cache is associated with the current session and all requests must pass through it. The secondary cache (also called the second-level cache) is optional, and is only consulted after the primary cache has been consulted first.
	</div><div class="para">
		Data is stored in the second-level cache by first disassembling it into a state array. This array is deep copied, and that deep copy is put into the cache. The reverse is done for reading from the cache. This works well for data that changes (mutable data), but is inefficient for immutable data.
	</div><div class="para">
		Deep copying data is an expensive operation in terms of memory usage and processing speed. For large data sets, memory and processing speed become a performance-limiting factor. Hibernate allows you to specify that immutable data be referenced rather than copied. Instead of copying entire data sets, Hibernate can now store the reference to the data in the cache.
	</div><div class="para">
		This can be done by changing the value of the configuration setting <code class="code">hibernate.cache.use_reference_entries</code> to <code class="code">true</code>. By default, <code class="code">hibernate.cache.use_reference_entries</code> is set to <code class="code">false</code>.
	</div><div class="para">
		When <code class="code">hibernate.cache.use_reference_entries</code> is set to <code class="code">true</code>, an immutable data object that does not have any associations is not copied into the second-level cache, and only a reference to it is stored.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			When <code class="code">hibernate.cache.use_reference_entries</code> is set to <code class="code">true</code>, immutable data objects with associations are still deep copied into the second-level cache.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23088%2C+Red+Hat+Development+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A13%3A01%0ATopic+ID%3A+20657-742326+%5BLatest%5D&amp;comment=Title%3A+Second+Level+Caching+of+Object+References+for+Non-mutable+Data%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=20657-742326+09+Feb+2015+22%3A49+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0">Report a bug</a>
	</div></div></div></div></body></html>