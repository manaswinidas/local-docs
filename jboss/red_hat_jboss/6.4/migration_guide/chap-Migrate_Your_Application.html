<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:d="http://docbook.org/ns/docbook">Chapter 3. Migrate Your Application</title><link rel="stylesheet" type="text/css" href="Common_Content/css/epub.css"/><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.3.3"/><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content=""/></head><body><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="chap-Migrate_Your_Application">
      ⁠</a>Chapter 3. Migrate Your Application</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-Changes_Required_by_Most_Applications">
      ⁠</a>3.1. Changes Required by Most Applications</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Review_Changes_Required_by_Most_Applications">
      ⁠</a>3.1.1. Review Changes Required by Most Applications</h2></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><div class="para">
			Class loading and configuration changes in JBoss EAP 6 will impact almost every application. JBoss EAP 6 also uses new standard portable JNDI naming syntax. These changes will impact most applications, so it is suggested you review the following information first when you migrate your application.
		</div><ol class="1"><li class="step"><div class="para">
				 <a class="xref" href="chap-Migrate_Your_Application.html#Update_the_Application_Due_to_Class_Loading_Changes">Section 3.1.2.1, “Update the Application Due to Class Loading Changes”</a>
			</div></li><li class="step"><div class="para">
				 <a class="xref" href="chap-Migrate_Your_Application.html#Update_the_Application_Due_to_Configuration_Changes1">Section 3.1.6.1, “Update the Application Due to Configuration Changes”</a>
			</div></li><li class="step"><div class="para">
				 <a class="xref" href="chap-Migrate_Your_Application.html#Update_Application_JNDI_Namespace_Names1">Section 3.1.8.1, “Update Application JNDI Namespace Names”</a>
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+7669-606469+%5BLatest%5D&amp;comment=Title%3A+Review+Changes+Required+by+Most+Applications%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7669-606469+26+Feb+2014+14%3A46+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Class_Loading_Changes">
      ⁠</a>3.1.2. Class Loading Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Update_the_Application_Due_to_Class_Loading_Changes">
      ⁠</a>3.1.2.1. Update the Application Due to Class Loading Changes</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><div class="para">
			Modular class loading is a significant change in JBoss EAP 6 and will impact almost every application. Review the following information first when you migrate your application.
		</div><ol class="1"><li class="step"><div class="para">
				First, look at the packaging of your application and its dependencies. For more information, see:  <a class="xref" href="chap-Migrate_Your_Application.html#Update_Application_Dependencies_Due_to_Class_Loading_Changes">Section 3.1.2.3, “Update Application Dependencies Due to Class Loading Changes”</a>
			</div></li><li class="step"><div class="para">
				If your application does logging, you need to specify the correct module dependencies. For more information, see:  <a class="xref" href="chap-Migrate_Your_Application.html#Modify_Logging_Dependencies">Section 3.1.4.1, “Modify Logging Dependencies”</a>
			</div></li><li class="step"><div class="para">
				Due to the modular class loading changes, you may have to change the packaging structure of your EAR or WAR. For more information, see:  <a class="xref" href="chap-Migrate_Your_Application.html#Modify_Packaging_of_EARs_and_WARs">Section 3.1.5.1, “Modify Packaging of EARs and WARs”</a>
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+7670-606470+%5BLatest%5D&amp;comment=Title%3A+Update+the+Application+Due+to+Class+Loading+Changes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7670-606470+26+Feb+2014+14%3A46+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Understand_Module_Dependencies">
      ⁠</a>3.1.2.2. Understand Module Dependencies</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			A module is only able to access its own classes and the classes of any module on which it has an explicit or implicit dependency.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Implicit Dependencies</div>
			The deployers within the server implicitly automatically add some commonly used module dependencies, like the <code class="code">javax.api</code> and <code class="code">sun.jdk</code>. This makes the classes visible to the deployment at runtime and relieves the developer of the task of explicitly adding the dependencies. For details on how and when these implicit dependencies are added, refer to <em class="citetitle">Implicit Module Dependencies</em> in the chapter entitled <em class="citetitle">Class Loading and Modules</em> in the <em class="citetitle">Development Guide</em> for JBoss EAP 6 on <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Explicit Dependencies</div>
			For other classes, the modules must be specified explicitly or else the missing dependencies result in deployment or runtime errors. If a dependency is missing, you see <code class="classname">ClassNotFoundExceptions</code> or <code class="classname">NoClassDefFoundErrors</code> traces in the server log. If more than one module loads the same JAR or a module loads a class that extends a class loaded by a different module, you see <code class="classname">ClassCastExceptions</code> traces in the server log. To specify dependencies explicitly, modify the <code class="filename">MANIFEST.MF</code> or create a JBoss specific deployment descriptor file <code class="filename">jboss-deployment-structure.xml</code>. For more information on module dependencies, see <em class="citetitle">Overview of Class Loading and Modules</em> in the chapter entitled <em class="citetitle">Class Loading and Module</em> in the <em class="citetitle">Development Guide</em> for JBoss EAP 6 on <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
		</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4601-781546+%5BLatest%5D&amp;comment=Title%3A+Understand+Module+Dependencies%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4601-781546+13+Nov+2017+13%3A01+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Update_Application_Dependencies_Due_to_Class_Loading_Changes">
      ⁠</a>3.1.2.3. Update Application Dependencies Due to Class Loading Changes</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			Class loading in JBoss EAP 6 is considerably different from previous versions of JBoss EAP. Class loading is now based on the JBoss Modules project. Rather than a single, hierarchical class loader that loads all JARs into a flat class path, each library becomes a module that only links against the exact modules on which it depends. Deployments in JBoss EAP 6 are also modules and do not have access to classes that are defined in JARs in the application server unless an explicit dependency on those classes is defined. Some module dependencies defined by the application server are set up for you automatically. For instance, if you are deploying a Java EE application, a dependency on the Java EE API is added automatically, or implicitly. For the complete list of dependencies automatically added by the server, see <em class="citetitle">Implicit Module Dependencies</em> in the chapter entitled <em class="citetitle">Class Loading and Modules</em> in the <em class="citetitle">Development Guide</em> for JBoss EAP 6 on <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Tasks</div>
			When you migrate your application to JBoss EAP 6, you might need to perform one or more of the following tasks due to the modular class loading changes:
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				 <a class="xref" href="chap-Migrate_Your_Application.html#Understand_Module_Dependencies">Section 3.1.2.2, “Understand Module Dependencies”</a>
			</div></li><li class="listitem"><div class="para">
				 <a class="xref" href="chap-Tools_and_Tips.html#Use_Tattletale_to_Find_Application_Dependencies">Section 4.1.3, “Use Tattletale to Find Application Dependencies”</a>
			</div></li><li class="listitem"><div class="para">
				 <a class="xref" href="chap-Migrate_Your_Application.html#Create_or_Modify_Files_That_Control_Class_Loading_in_JBoss_Enterprise_Application_Platform_6">Section 3.1.3.1, “Create or Modify Files That Control Class Loading in JBoss EAP 6”</a>
			</div></li><li class="listitem"><div class="para">
				 <a class="xref" href="chap-Migrate_Your_Application.html#Package_Resources_for_the_New_Modular_Class_Loading_System">Section 3.1.3.3, “Package Resources for the New Modular Class Loading System”</a>
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4588-781553+%5BLatest%5D&amp;comment=Title%3A+Update+Application+Dependencies+Due+to+Class+Loading+Changes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4588-781553+13+Nov+2017+13%3A19+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Configuration_File_Changes">
      ⁠</a>3.1.3. Configuration File Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Create_or_Modify_Files_That_Control_Class_Loading_in_JBoss_Enterprise_Application_Platform_6">
      ⁠</a>3.1.3.1. Create or Modify Files That Control Class Loading in JBoss EAP 6</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			Due to the change in JBoss EAP 6 to use modular class loading, you might need to create or modify one or more files to add dependencies or to prevent automatic dependencies from loading. For more information on class loading and class loading precedence, see the chapter entitled <em class="citetitle">Class Loading and Modules</em> in the <em class="citetitle">Development Guide</em> for JBoss EAP 6 on <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
		</div><div class="para">
		The following files are used to control class loading in JBoss EAP 6.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">jboss-web.xml</span></dt><dd><div class="para">
					If you have defined a <code class="code">&lt;class-loading&gt;</code> element in the <code class="filename">jboss-web.xml</code> file, you need to remove it. The behavior that this evoked in JBoss EAP 5 is now the default class loading behavior in JBoss EAP 6, so it is no longer necessary. If you do not remove this element, you see a ParseError and XMLStreamException in your server log.
				</div><div class="para">
					This is an example of a <code class="code">&lt;class-loading&gt;</code> element in the <code class="filename">jboss-web.xml</code> file that is commented out. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">&lt;!DOCTYPE </span>jboss-web PUBLIC
<span xmlns="" class="line">​</span>    "-//JBoss//DTD Web Application 4.2//EN"
<span xmlns="" class="line">​</span>    "http://www.jboss.org/j2ee/dtd/jboss-web_4_2.dtd"<span xmlns="" class="perl_DataType">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-web&gt;</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    &lt;class-loading java2ClassLoadingCompliance="false"&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">        &lt;loader-repository&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">            seam.jboss.org:loader=MyApplication</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">            &lt;loader-repository-config&gt;java2ParentDelegation=false&lt;/loader-repository-config&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">        &lt;/loader-repository&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    &lt;/class-loading&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> --&gt;</span>
<span xmlns="" class="line">​</span> <span xmlns="" class="perl_Keyword">&lt;/jboss-web&gt;</span>
<span xmlns="" class="line">​</span>
</pre>

				</div></dd><dt><span class="term">MANIFEST.MF</span></dt><dd><div class="para">
					<div class="variablelist"><dl class="variablelist"><dt><span class="term">Manually edited</span></dt><dd><div class="para">
									Depending on which components or modules your application uses, you might need to add one or more dependencies to this file. You can add them as either <code class="code"> Dependencies</code> or <code class="code"> Class-Path</code> entries.
								</div><div class="para">
									The following is an example of <code class="filename">MANIFEST.MF</code> edited by a developer: 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>Manifest-Version: 1.0
<span xmlns="" class="line">​</span>Dependencies: org.jboss.logmanager
<span xmlns="" class="line">​</span>Class-Path: OrderManagerEJB.jar
<span xmlns="" class="line">​</span>
</pre>

								</div><div class="para">
									If you modify this file, be sure to include a newline character at the end of the file.
								</div></dd><dt><span class="term">Generated using Maven</span></dt><dd><div class="para">
									If you use Maven, you need to modify your <code class="filename">pom.xml</code> file to generate the dependencies for the <code class="filename">MANIFEST.MF</code> file. If your application uses EJB 3.0, you might have a section in the <code class="filename">pom.xml</code> file that looks like the following: 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;plugin&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;groupId&gt;</span>org.apache.maven.plugins<span xmlns="" class="perl_Keyword">&lt;/groupId&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;artifactId&gt;</span>maven-ejb-plugin<span xmlns="" class="perl_Keyword">&lt;/artifactId&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;configuration&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;ejbVersion&gt;</span>3.0<span xmlns="" class="perl_Keyword">&lt;/ejbVersion&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/configuration&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/plugin&gt;</span>
</pre>

								</div><div class="para">
									If the EJB 3.0 code uses <code class="classname">org.apache.commons.log</code>, you need that dependency in the <code class="filename">MANIFEST.MF</code> file. To generate that dependency, add the <code class="code">&lt;plugin&gt;</code> element to the <code class="filename">pom.xml</code> file as follows: 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;plugin&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;groupId&gt;</span>org.apache.maven.plugins<span xmlns="" class="perl_Keyword">&lt;/groupId&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;artifactId&gt;</span>maven-ejb-plugin<span xmlns="" class="perl_Keyword">&lt;/artifactId&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;configuration&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;ejbVersion&gt;</span>3.0<span xmlns="" class="perl_Keyword">&lt;/ejbVersion&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;archive&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;manifestFile&gt;</span>src/main/resources/META-INF/MANIFEST.MF<span xmlns="" class="perl_Keyword">&lt;/manifestFile&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/archive&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/configuration&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/plugin&gt;</span>
</pre>

								</div><div class="para">
									In the above example, the <code class="filename">src/main/resources/META-INF/MANIFEST.MF</code> file only needs to contain the dependency entry: 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>Dependencies: org.apache.commons.logging
</pre>

								</div><div class="para">
									Maven will generate the complete <code class="filename">MANIFEST.MF</code> file: 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>Manifest-Version: 1.0
<span xmlns="" class="line">​</span>Dependencies: org.apache.commons.logging
</pre>

								</div></dd></dl></div>

				</div></dd><dt><span class="term">jboss-deployment-structure.xml</span></dt><dd><div class="para">
					This file is a JBoss specific deployment descriptor that can be used to control class loading in a fine grained manner. Like the <code class="filename">MANIFEST.MF</code>, this file can be used to add dependencies. It can also prevent automatic dependencies from being added, define additional modules, change an EAR deployment's isolated class loading behavior, and add additional resource roots to a module.
				</div><div class="para">
					The following is an example of a <code class="filename">jboss-deployment-structure.xml</code> file that adds a dependency for JSF 1.2 module and prevents the automatic loading of the JSF 2.0 module. 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-deployment-structure</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:deployment-structure:1.0"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;deployment&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;dependencies&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.faces.api"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"1.2"</span><span xmlns="" class="perl_Others"> export=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"com.sun.jsf-impl"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"1.2"</span><span xmlns="" class="perl_Others"> export=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/dependencies&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/deployment&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;sub-deployment</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jboss-seam-booking.war"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;exclusions&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.faces.api"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"main"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"com.sun.jsf-impl"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"main"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/exclusions&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;dependencies&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.faces.api"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"1.2"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"com.sun.jsf-impl"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"1.2"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/dependencies&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/sub-deployment&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-deployment-structure&gt;</span></pre>

				</div><div class="para">
					For additional information about this file, see:  <a class="xref" href="chap-Migrate_Your_Application.html#jboss-deployment-structurexml">Section 3.1.3.2, “jboss-deployment-structure.xml”</a>.
				</div></dd><dt><span class="term">application.xml</span></dt><dd><div class="para">
					In previous versions of JBoss EAP, you controlled the order of deployments within an EAR using the <code class="filename">jboss-app.xml</code> file. This is no longer the case. The Java EE6 spec provides the <code class="code">&lt;initialize-in-order&gt;</code> element in the <code class="filename">application.xml</code> which allows control of the order in which the Java EE modules within an EAR are deployed.
				</div><div class="para">
					In most cases you do not need to specify deployment order. If your application uses dependency injections and resource-refs to refer to components in external modules, in most cases the <code class="code">&lt;initialize-in-order&gt;</code> element is not required because the application server is able to implicitly determine the correct and optimal way of ordering the components.
				</div><div class="para">
					Let's assume you have an application that contains a <code class="filename">myBeans.jar</code> and a <code class="filename">myApp.war</code> that are packaged within a <code class="filename">myApp.ear</code>. A servlet in the <code class="filename">myApp.war</code> uses an <code class="code">@EJB</code> annotation to inject a bean from the <code class="filename">myBeans.jar</code>. In this case, the application server has the appropriate knowledge to be sure that the EJB component is available before the servlet is started and you do not have to use the <code class="code">&lt;initialize-in-order&gt;</code> element.
				</div><div class="para">
					However, if that servlet uses legacy JNDI lookup style remote references like the following to access the bean, you might need to specify module order. 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Function">init</span>() {
<span xmlns="" class="line">​</span>  Context ctx = <span xmlns="" class="perl_Keyword">new</span> InitialContext();
<span xmlns="" class="line">​</span>  ctx.<span xmlns="" class="perl_Function">lookup</span>(<span xmlns="" class="perl_String">"TheBeanInMyBeansModule"</span>);
<span xmlns="" class="line">​</span>}
</pre>
					 In this case, the server is not able to determine that the EJB component is in the <code class="filename">myBeans.jar</code> and you need to enforce that the components in the <code class="filename">myBeans.jar</code> are initialized and started before the components in <code class="filename">myApp.war</code>. To do this, you set the <code class="code">&lt;initialize-in-order&gt;</code> element to <code class="literal">true</code> and specify the order of the <code class="filename">myBeans.jar</code> and <code class="filename">myApp.war</code> modules in the <code class="filename">application.xml</code> file.
				</div><div class="para">
					The following is an example that uses the <code class="code">&lt;initialize-in-order&gt;</code> element to control deployment order. The <code class="filename">myBeans.jar</code> is deployed before the <code class="filename">myApp.war</code> file. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;application</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://java.sun.com/xml/ns/javaee"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">             xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span><span xmlns="" class="perl_Others"> version=</span><span xmlns="" class="perl_String">"6"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">             xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://java.sun.com/xml/ns/javaee </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_String">             http://java.sun.com/xml/ns/javaee/application_6.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;application-name&gt;</span>myApp<span xmlns="" class="perl_Keyword">&lt;/application-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;initialize-in-order&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/initialize-in-order&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;module&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;ejb&gt;</span>myBeans.jar<span xmlns="" class="perl_Keyword">&lt;/ejb&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/module&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;module&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;web&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;web-uri&gt;</span>myApp.war<span xmlns="" class="perl_Keyword">&lt;/web-uri&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;context-root&gt;</span>myApp<span xmlns="" class="perl_Keyword">&lt;/context-root&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/web&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/module&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/application&gt;</span></pre>

				</div><div class="para">
					The schema for the <code class="filename">application.xml</code> file can be found here at <a href="http://java.sun.com/xml/ns/javaee/application_6.xsd">http://java.sun.com/xml/ns/javaee/application_6.xsd</a>.
				</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						Be aware that setting the <code class="code">&lt;initialize-in-order&gt;</code> element to <code class="literal">true</code> slows down deployment. It is preferable to define proper dependencies using dependency injections or resource-refs because it allows the container more flexibility in optimizing deployments.
					</div></div></div></dd><dt><span class="term">jboss-ejb3.xml</span></dt><dd><div class="para">
					The <code class="filename">jboss-ejb3.xml</code> deployment descriptor replaces the <code class="filename">jboss.xml</code> deployment descriptor to override and add to the features provided by the Java Enterprise Edition (EE) defined <code class="filename">ejb-jar.xml</code> deployment descriptor. The new file is incompatible with <code class="filename">jboss.xml</code>, and the <code class="filename">jboss.xml</code> is now ignored in deployments.
				</div></dd><dt><span class="term">login-config.xml</span></dt><dd><div class="para">
					The <code class="filename">login-config.xml</code> file is no longer used for security configuration. Security is now configured in the <code class="code">&lt;security-domain&gt;</code> element in the server configuration file. For a standalone server, this is the <code class="filename">standalone/configuration/standalone.xml</code> file. If you are running your server in a managed domain, this is the <code class="filename">domain/configuration/domain.xml</code> file.
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4600-781551+%5BLatest%5D&amp;comment=Title%3A+Create+or+Modify+Files+That+Control+Class+Loading+in+JBoss+EAP+6%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4600-781551+13+Nov+2017+13%3A15+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="jboss-deployment-structurexml">
      ⁠</a>3.1.3.2. jboss-deployment-structure.xml</h3></div></div></div><div class="para">
		<code class="filename">jboss-deployment-structure.xml</code> is a new optional deployment descriptor for JBoss EAP 6. This deployment descriptor provides control over class loading in the deployment.
	</div><div class="para">
		The XML schema for this deployment descriptor is in <code class="filename"><em class="replaceable">EAP_HOME</em>/docs/schema/jboss-deployment-structure-1_2.xsd</code>
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4611-591668+%5BLatest%5D&amp;comment=Title%3A+jboss-deployment-structure.xml%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4611-591668+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Package_Resources_for_the_New_Modular_Class_Loading_System">
      ⁠</a>3.1.3.3. Package Resources for the New Modular Class Loading System</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			In previous versions of JBoss EAP, all resources inside the <code class="filename">WEB-INF/</code> directory were added to the WAR classpath. In JBoss EAP 6, web application artifacts are only loaded from the <code class="filename">WEB-INF/classes</code> and <code class="filename">WEB-INF/lib</code> directories. Failure to package application artifacts in the specified locations can result in <code class="classname">ClassNotFoundException</code>, <code class="classname">NoClassDefError</code>, or other runtime errors.
		</div><div class="para">
		To resolve these class loading errors, you must modify the structure of your application archive or define a custom module.
	</div><div class="variablelist"><p class="title"><strong/></p><dl class="variablelist"><dt><span class="term">Modify the Resource Packaging</span></dt><dd><div class="para">
					To make the resources available only to the application, you must bundle the properties files, JARs, or other artifacts with the WAR by moving them to the <code class="filename">WEB-INF/classes/</code> or <code class="filename">WEB-INF/lib/</code> directory. This approach is described in more detail here:  <a class="xref" href="chap-Migrate_Your_Application.html#Change_ResourceBundle_Properties_Location">Section 3.1.3.4, “Change ResourceBundle Properties Location”</a>
				</div></dd><dt><span class="term">Create a Custom Module</span></dt><dd><div class="para">
					If you want make custom resources available to all applications running on the JBoss EAP 6 server, you must create a custom module. This approach is described in more detail here:  <a class="xref" href="chap-Migrate_Your_Application.html#Create_a_Custom_Module">Section 3.1.3.5, “Create a Custom Module”</a>
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+11490-591977+%5BLatest%5D&amp;comment=Title%3A+Package+Resources+for+the+New+Modular+Class+Loading+System%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11490-591977+23+Feb+2014+16%3A56+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Change_ResourceBundle_Properties_Location">
      ⁠</a>3.1.3.4. Change ResourceBundle Properties Location</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			In previous versions of JBoss EAP, the <code class="filename"><em class="replaceable">EAP_HOME</em>/server/<em class="replaceable">SERVER_NAME</em>/conf/</code> directory was in the classpath and available to the application. To make properties available to the classpath of the application in JBoss EAP 6, you must package them within your application.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819320581072">
      ⁠</a><p class="title"><strong>Procedure 3.1. Change the ResourceBundle Properties Location</strong></p><ol class="1"><li class="step"><div class="para">
				If you are deploying a WAR archive, you must package those properties in the WAR's <code class="filename">WEB-INF/classes/</code> folder.
			</div></li><li class="step"><div class="para">
				If you want those properties accessible to all components in an EAR, then you must package them at the root of a JAR and then place the JAR in EAR's <code class="filename">lib/</code> folder.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4595-603730+%5BLatest%5D&amp;comment=Title%3A+Change+ResourceBundle+Properties+Location%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4595-603730+25+Feb+2014+17%3A20+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Create_a_Custom_Module">
      ⁠</a>3.1.3.5. Create a Custom Module</h3></div></div></div><div class="para">
		The following procedure describes how to create a custom module in order to make properties files and other resources available to all applications running on the JBoss EAP server.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819315626752">
      ⁠</a><p class="title"><strong>Procedure 3.2. Create a Custom Module</strong></p><ol class="1"><li class="step"><div class="para">
				Create and populate the <code class="filename">module/</code> directory structure.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Create a directory structure under the <code class="filename"><em class="replaceable">EAP_HOME</em>/module</code> directory to contain the files and JARs. For example: 
<pre class="screen"><code class="command">$ cd <em class="replaceable">EAP_HOME</em>/modules/ </code>
<code class="command">$ mkdir -p myorg-conf/main/properties</code></pre>

					</div></li><li class="step"><div class="para">
						Move the properties files to the <code class="filename"><em class="replaceable">EAP_HOME</em>/modules/myorg-conf/main/properties/</code> directory you created in the previous step.
					</div></li><li class="step"><div class="para">
						Create a <code class="filename">module.xml</code> file in the <code class="filename"><em class="replaceable">EAP_HOME</em>/modules/myorg-conf/main/</code> directory containing the following XML: 
<pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:module:1.1"</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"myorg-conf"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;resources&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;resource-root</span><span xmlns="" class="perl_Others"> path=</span><span xmlns="" class="perl_String">"properties"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/resources&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/module&gt;</span></pre>

					</div></li></ol></li><li class="step"><div class="para">
				Modify the <code class="literal">ee</code> subsystem in the server configuration file. You can use the Managemet CLI or you can manually edit the file.
			</div><ul class="stepalternatives">
				<li class="step"><div class="para">
						Follow these steps to modify the server configuration file using the Management CLI.
					</div><ol class="substeps a"><li class="step"><div class="para">
								Start the server and connect to the Management CLI.
							</div><ul class="stepalternatives">
								<li class="step"><div class="para">
										For Linux, enter the following at the command line:
									</div><pre class="screen"> <em class="replaceable">EAP_HOME</em>/bin/jboss-cli.sh --connect</pre></li>
								 <li class="step"><div class="para">
										For Windows, enter the following at a command line:
									</div><pre class="screen">C:\&gt;<em class="replaceable">EAP_HOME</em>\bin\jboss-cli.bat --connect</pre></li>

							</ul><div class="para">
								You should see the following response: 
<pre class="screen">Connected to standalone controller at localhost:9999</pre>

							</div></li><li class="step"><div class="para">
								To create the <code class="code">myorg-conf</code> &lt;global-modules&gt; element in the <code class="literal">ee</code> subsystem, type the following in the command line:
							</div><pre class="screen">/subsystem=ee:write-attribute(name=global-modules, value=[{"name"=&gt;"myorg-conf","slot"=&gt;"main"}])</pre><div class="para">
								You should see the following result:
							</div><pre class="screen">{"outcome" =&gt; "success"}</pre></li></ol></li>
				 <li class="step"><div class="para">
						Follow these steps if you prefer to manually edit the server configuration file.
					</div><ol class="substeps a"><li class="step"><div class="para">
								Stop the server and open the server configuration file in a text editor. If you are running a standalone server, this is the <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/configuration/standalone.xml</code> file, or the <code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/domain.xml</code> file if you are running a managed domain.
							</div></li><li class="step"><div class="para">
								Find the <code class="literal">ee</code> subsystem and add the global module for <code class="code">myorg-conf</code>. The following is an example of the <code class="literal">ee</code> subsystem element, modified to include the <code class="code">myorg-conf</code> element:
							</div><div class="example"><a id="idm139819296527904">
      ⁠</a><p class="title"><strong>Example 3.1. <code class="literal">myorg-conf</code> element</strong></p><div class="example-contents"><pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:ee:1.0"</span> <span xmlns="" class="perl_Keyword">&gt;</span>            
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;global-modules&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"myorg-conf"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"main"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>            
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/global-modules&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/subsystem&gt;</span></pre></div></div></li></ol></li>

			</ul></li><li class="step"><div class="para">
				Assuming you copied a file named <code class="filename">my.properties</code> into the correct module location, you are now able to load properties files using code similar to the following:
			</div><div class="example"><a id="idm139819317774976">
      ⁠</a><p class="title"><strong>Example 3.2. Load properties file</strong></p><div class="example-contents"><pre class="programlisting"><span xmlns="" class="line">​</span>Thread.<span xmlns="" class="perl_Function">currentThread</span>().<span xmlns="" class="perl_Function">getContextClassLoader</span>().<span xmlns="" class="perl_Function">getResource</span>(<span xmlns="" class="perl_String">"my.properties"</span>);</pre></div></div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+11489-763135+%5BLatest%5D&amp;comment=Title%3A+Create+a+Custom+Module%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11489-763135+26+Jun+2015+15%3A17+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Logging_Changes">
      ⁠</a>3.1.4. Logging Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Modify_Logging_Dependencies">
      ⁠</a>3.1.4.1. Modify Logging Dependencies</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			JBoss LogManager supports front ends for all logging frameworks, so you can keep your current logging code or move to the new JBoss logging infrastructure. Regardless of your decision, because of the modular class loading changes, you probably need to modify your application to add the required dependencies.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819291394672">
      ⁠</a><p class="title"><strong>Procedure 3.3. Update application logging code</strong></p><ol class="1"><li class="step"><div class="para">
				 <a class="xref" href="chap-Migrate_Your_Application.html#Update_Application_Code_for_Third-party_Logging_Frameworks">Section 3.1.4.2, “Update Application Code for Third-party Logging Frameworks”</a>
			</div></li><li class="step"><div class="para">
				 <a class="xref" href="chap-Migrate_Your_Application.html#Modify_Code_to_Use_the_New_JBoss_Logging_Framework">Section 3.1.4.3, “Modify Code to Use the New JBoss Logging Framework”</a>
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4590-591669+%5BLatest%5D&amp;comment=Title%3A+Modify+Logging+Dependencies%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4590-591669+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Update_Application_Code_for_Third-party_Logging_Frameworks">
      ⁠</a>3.1.4.2. Update Application Code for Third-party Logging Frameworks</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			In JBoss EAP 6, logging dependencies for common third-party frameworks like Apache Commons Logging, Apache log4j, SLF4J, and Java Logging are added by default. In most cases, it is preferable to use the logging framework provided by the JBoss EAP container. However, if you require specific functionality provided by a third-party framework, you must exclude the corresponding JBoss EAP module from your deployment. Note that although your deployment uses the third-party logging framework, the server logs continue to use the JBoss EAP logging subsystem configuration.
		</div><div class="para">
		The following procedures demonstrate how to exclude the JBoss EAP 6 <code class="code">org.apache.log4j</code> module from your deployment. The first procedure works on any release of JBoss EAP 6. The second procedure applies only to JBoss EAP 6.3 or later.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819305210896">
      ⁠</a><p class="title"><strong>Procedure 3.4. Configure JBoss EAP 6 to use a log4j.properties or log4j.xml file</strong></p><div class="para">
			This procedure works for all versions of JBoss EAP 6. 
			<div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Because this method uses a log4j configuration file, you will no longer be able to change the log4j logging configuration at runtime.
				</div></div></div>

		</div><ol class="1"><li class="step"><div class="para">
				Create a <code class="filename">jboss-deployment-structure.xml</code> with the following content:
			</div><div class="para">
				
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-deployment-structure&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;deployment&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">&lt;!-- Exclusions allow you to prevent the server from automatically adding some dependencies --&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;exclusions&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.log4j"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/exclusions&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/deployment&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-deployment-structure&gt;</span>
</pre>

			</div></li><li class="step"><div class="para">
				Place the <code class="filename">jboss-deployment-structure.xml</code> file in either the <code class="filename">META-INF/</code> directory or the <code class="filename">WEB-INF/</code> directory if you are deploying a WAR, or in the <code class="filename">META-INF/</code> directory if you are deploying an EAR. If your deployment includes dependent child deployments, you must also exclude the module for each subdeployment.
			</div></li><li class="step"><div class="para">
				Include the <code class="filename">log4j.properties</code> or <code class="filename">log4j.xml</code> file in the <code class="filename">lib/</code> directory of your EAR, or the <code class="filename">WEB-INF/classes/</code> directory of your WAR deployment. If you prefer to place the file in <code class="filename">lib/</code> directory of your WAR, you must specify the <code class="code">&lt;resource-root&gt;</code> path in the <code class="filename">jboss-deployment-structure.xml</code> file.
			</div><div class="para">
				
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-deployment-structure&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;deployment&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">&lt;!-- Exclusions allow you to prevent the server from automatically adding some dependencies --&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;exclusions&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.log4j"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/exclusions&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;resources&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;resource-root</span><span xmlns="" class="perl_Others"> path=</span><span xmlns="" class="perl_String">"lib"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/resources&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/deployment&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-deployment-structure&gt;</span>
</pre>

			</div></li><li class="step"><div class="para">
				Start the JBoss EAP 6 server with the following runtime argument to prevent a <code class="classname">ClassCastException</code> from appearing in the console when you deploy the application: 
<pre class="screen">-Dorg.jboss.as.logging.per-deployment=false</pre>

			</div></li><li class="step"><div class="para">
				Deploy your application.
			</div></li></ol></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819301170944">
      ⁠</a><p class="title"><strong>Procedure 3.5. Configure Logging Dependencies for JBoss EAP 6.3 or later</strong></p><div class="para">
			In JBoss EAP 6.3 and later, you can use the new <code class="code">add-logging-api-dependencies</code> logging system attribute to exclude third party logging framework dependencies. The following steps demonstrate how to modify this logging attribute on a JBoss EAP standalone server.
		</div><ol class="1"><li class="step"><div class="para">
				Start the JBoss EAP 6 server with the following runtime argument to prevent a <code class="classname">ClassCastException</code> from appearing in the console when you deploy the application: 
<pre class="screen">-Dorg.jboss.as.logging.per-deployment=false</pre>

			</div></li><li class="step"><div class="para">
				Open a terminal and connect to the Management CLI.
			</div><ul class="stepalternatives">
				<li class="step"><div class="para">
						For Linux, enter the following at the command line:
					</div><pre class="screen">
$ <em class="replaceable">EAP_HOME</em>/bin/jboss-cli.sh --connect
</pre></li>
				 <li class="step"><div class="para">
						For Windows, enter the following at a command line:
					</div><pre class="screen">
C:\&gt;<em class="replaceable">EAP_HOME</em>\bin\jboss-cli.bat --connect
</pre></li>

			</ul></li><li class="step"><div class="para">
				Modify the <code class="code">add-logging-api-dependencies</code> attribute in the logging subsystem.
			</div><div class="para">
				This attribute controls whether the container adds implicit logging API dependencies to your deployments. 
				<div class="itemizedlist"><ul><li class="listitem"><div class="para">
							If set to <code class="literal">true</code>, which is the default, all implicit logging API dependencies are added.
						</div></li><li class="listitem"><div class="para">
							If set to <code class="literal">false</code>, the dependencies are not added to your deployments.
						</div></li></ul></div>

			</div><div class="para">
				To exclude the third-party logging framework dependencies, you must set this attribute to <code class="literal">false</code> using the following command: 
<pre class="screen"><code class="command">/subsystem=logging:write-attribute(name=add-logging-api-dependencies, value=false)</code></pre>

			</div><div class="para">
				This command adds the <code class="code">&lt;add-logging-api-dependencies&gt;</code> element to the <code class="literal">logging</code> subsystem of the <code class="filename">standalone.xml</code> configuration file. 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:logging:1.4"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;add-logging-api-dependencies</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    ....
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/subsystem&gt;</span>
</pre>

			</div></li><li class="step"><div class="para">
				Deploy your application.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4593-760075+%5BLatest%5D&amp;comment=Title%3A+Update+Application+Code+for+Third-party+Logging+Frameworks%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4593-760075+01+Jun+2015+02%3A48+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Modify_Code_to_Use_the_New_JBoss_Logging_Framework">
      ⁠</a>3.1.4.3. Modify Code to Use the New JBoss Logging Framework</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			To use the new framework, change your imports and code as described in the following procedure.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819319015568">
      ⁠</a><p class="title"><strong>Procedure 3.6. Modify Code and Dependencies to Use the JBoss Logging Framework</strong></p><ol class="1"><li class="step"><div class="para">
				Change your imports and logging code.
			</div><div class="para">
				The following is an example of code that uses the new JBoss Logging framework. 
<pre class="programlisting JAVA"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.logging.Level;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.logging.Logger;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">static</span> <span xmlns="" class="perl_DataType">final</span> Logger logger = Logger.<span xmlns="" class="perl_Function">getLogger</span>(MyClass.<span xmlns="" class="perl_Function">class</span>.<span xmlns="" class="perl_Function">toString</span>());
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">if</span>(logger.<span xmlns="" class="perl_Function">isTraceEnabled</span>()) {
<span xmlns="" class="line">​</span>    logger.<span xmlns="" class="perl_Function">tracef</span>(<span xmlns="" class="perl_String">"Starting..."</span>, subsystem);
<span xmlns="" class="line">​</span>}
</pre>

			</div></li><li class="step"><div class="para">
				Add the logging dependency.
			</div><div class="para">
				The JAR containing the JBoss Logging classes is located in the module named <code class="code">org.jboss.logging</code>. Your <code class="filename">MANIFEST-MF</code> file should look like the following.
			</div><div class="para">
				
<pre class="programlisting">
Manifest-Version: 1.0
Dependencies: org.jboss.logging
</pre>

			</div><div class="para">
				For more information on how to find the module dependency, refer <a class="xref" href="chap-Migrate_Your_Application.html#Update_Application_Dependencies_Due_to_Class_Loading_Changes">Section 3.1.2.3, “Update Application Dependencies Due to Class Loading Changes”</a> and <a class="xref" href="chap-Tools_and_Tips.html#Debug_and_Resolve_Migration_Issues">Section 4.2.1, “Debug and Resolve Migration Issues”</a>.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4594-766882+%5BLatest%5D&amp;comment=Title%3A+Modify+Code+to+Use+the+New+JBoss+Logging+Framework%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4594-766882+05+Aug+2015+13%3A05+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Application_Packaging_Changes">
      ⁠</a>3.1.5. Application Packaging Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Modify_Packaging_of_EARs_and_WARs">
      ⁠</a>3.1.5.1. Modify Packaging of EARs and WARs</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			When you migrate your application, you might have to change the packaging structure of your EAR or WAR due to the change to modular class loading. Module dependencies are loaded in this specific order: 
			<div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
						System dependencies
					</div></li><li class="listitem"><div class="para">
						User dependencies
					</div></li><li class="listitem"><div class="para">
						Local resources
					</div></li><li class="listitem"><div class="para">
						Inter-deployment dependencies
					</div></li></ol></div>

		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819319002048">
      ⁠</a><p class="title"><strong>Procedure 3.7. Modify archive packaging</strong></p><ol class="1"><li class="step"><div class="para">
				Package a WAR.
			</div><div class="para">
				A WAR is a single module and all classes in the WAR are loaded with the same class loader. This means classes packaged in the <code class="filename">WEB-INF/lib/</code> directory are treated the same as classes in the <code class="filename">WEB-INF/classes</code> directory.
			</div></li><li class="step"><div class="para">
				Package an EAR.
			</div><div class="para">
				An EAR consists of multiple modules. The <code class="filename">EAR/lib/</code> directory is a single module and every WAR or EJB jar subdeployment within the EAR is a separate module. Classes do not have access to classes in other modules within the EAR unless explicit dependencies have been defined. Subdeployments always have an automatic dependency on the parent module which gives them access to classes in the <code class="filename">EAR/lib/</code> directory. However, subdeployments do not always have an automatic dependency to allow them to access each other. This behavior is controlled by setting the <code class="code">&lt;ear-subdeployments-isolated&gt;</code> element in the <code class="code"> ee</code> subsystem configuration as follows.
			</div><div class="para">
				
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:ee:1.0"</span> <span xmlns="" class="perl_Keyword">&gt;</span>            
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;ear-subdeployments-isolated&gt;</span>false<span xmlns="" class="perl_Keyword">&lt;/ear-subdeployments-isolated&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/subsystem&gt;</span></pre>

			</div><div class="para">
				By default this is set to false which allows the subdeployments to see classes belonging to other subdeployments within the EAR.
			</div><div class="para">
				For more information on class loading, see the chapter entitled <em class="citetitle">Class Loading and Modules</em> in the <em class="citetitle">Development Guide</em> for JBoss EAP 6 on <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4941-781540+%5BLatest%5D&amp;comment=Title%3A+Modify+Packaging+of+EARs+and+WARs%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4941-781540+13+Nov+2017+12%3A39+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Change_in_Precedence_of_Root_Context">
      ⁠</a>3.1.5.2. Change in Precedence of Root Context</h3></div></div></div><div class="para">
		In JBoss EAP 5, a <code class="code">&lt;context-root&gt;</code> element defined in the <code class="filename">jboss-web.xml</code> WAR file took precedence over a <code class="code">&lt;context-root&gt;</code> element defined in the <code class="filename">application.xml</code> EAR file.
	</div><div class="para">
		In JBoss EAP 6, the reverse is true. A <code class="code">&lt;context-root&gt;</code> element defined in the <code class="filename">application.xml</code> EAR file takes precedence over a <code class="code">&lt;context-root&gt;</code> element defined in the <code class="filename">jboss-web.xml</code> WAR file. If a WAR file is deployed within an EAR archive, define the <code class="code">&lt;context-root&gt;</code> element in the <code class="filename">application.xml</code> file.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+45401-779851+%5BLatest%5D&amp;comment=Title%3A+Change+in+Precedence+of+Root+Context%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=45401-779851+15+Sep+2016+07%3A12+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Datasource_and_Resource_Adapter_Configuration_Changes">
      ⁠</a>3.1.6. Datasource and Resource Adapter Configuration Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Update_the_Application_Due_to_Configuration_Changes1">
      ⁠</a>3.1.6.1. Update the Application Due to Configuration Changes</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><div class="para">
			In JBoss EAP 5, services and subsystems were configured in many different files. In JBoss EAP 6, configuration is now done mainly in one file. If your application uses any of the following resources or services, configuration changes may be needed.
		</div><ol class="1"><li class="step"><div class="para">
				If your application uses a datasource, see:  <a class="xref" href="chap-Migrate_Your_Application.html#Update_the_DataSource_Configuration">Section 3.1.6.2, “Update the DataSource Configuration”</a>.
			</div></li><li class="step"><div class="para">
				If your application uses JPA and currently bundles the Hibernate JARs, see the following for your migration options:  <a class="xref" href="chap-Migrate_Your_Application.html#Configure_the_Datasource_for_Hibernate_or_JPA1">Section 3.1.6.4, “Configure the Datasource for Hibernate or JPA”</a>.
			</div></li><li class="step"><div class="para">
				If your application uses a resource adapter, see:  <a class="xref" href="chap-Migrate_Your_Application.html#Update_the_Resource_Adapter_Configuration">Section 3.1.6.5, “Update the Resource Adapter Configuration”</a>.
			</div></li><li class="step"><div class="para">
				Review the following for information on how to configure changes for basic security:  <a class="xref" href="chap-Migrate_Your_Application.html#Configure_Application_Security_Changes">Section 3.1.7.1, “Configure Application Security Changes”</a>.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+7671-603642+%5BLatest%5D&amp;comment=Title%3A+Update+the+Application+Due+to+Configuration+Changes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7671-603642+25+Feb+2014+17%3A11+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Update_the_DataSource_Configuration">
      ⁠</a>3.1.6.2. Update the DataSource Configuration</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			In previous versions of JBoss EAP, the JCA DataSource configuration is defined in a file with a suffix of <code class="filename">*-ds.xml</code>. This file is then deployed in the server's <code class="filename">deploy/</code> directory or packaged with the application. The JDBC driver is copied to the <code class="filename">server/lib/</code> directory or packaged in the application's <code class="filename">WEB-INF/lib/</code> directory. While this method of configuring a DataSource is still supported for development, it is not recommended for production because it is not supported by the JBoss administrative and management tools.
		</div><div class="para">
		In JBoss EAP 6, the DataSource is configured in the server configuration file. If the JBoss EAP 6 instance is running in a managed domain, the DataSource is configured in the <code class="filename">domain/configuration/domain.xml</code> file. If the JBoss EAP 6 instance is running as a standalone server, the DataSource is configured in the <code class="filename">standalone/configuration/standalone.xml file</code>. DataSources configured this way can be managed and controlled using the JBoss management interfaces, including the Web Management Console and command line interface (CLI). These tools make it easy to manage deployments and configure multiple servers running in a managed domain.
	</div><div class="para">
		The following section describes how to modify your DataSource configuration so that it can be managed and supported by the available management tools.
	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Migrate to a Manageable DataSource Configuration for JBoss EAP 6</div>
			A JDBC 4.0 compliant driver can be installed as a deployment or as a core module. A driver that is JDBC 4.0 compliant contains a <code class="filename">META-INF/services/java.sql.Driver</code> file that specifies the driver class name. A driver that is not JDBC 4.0 compliant requires additional steps. For details on how to make a driver JDBC 4.0 compliant and how update your current DataSource configuration to one that is manageable by the Web Management Console and CLI, see  <a class="xref" href="chap-Migrate_Your_Application.html#Install_and_Configure_the_JDBC_Driver">Section 3.1.6.3, “Install and Configure the JDBC Driver”</a>.
		</div><div class="para">
		If your application uses Hibernate or JPA, it may require additional changes. See  <a class="xref" href="chap-Migrate_Your_Application.html#Configure_the_Datasource_for_Hibernate_or_JPA1">Section 3.1.6.4, “Configure the Datasource for Hibernate or JPA”</a> for more information.
	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Use the IronJacamar Migration Tool to Convert Configuration Data</div>
			You can use the IronJacamar tool to migrate DataSource and ResourceAdapter configurations. This tool converts the <code class="filename">*-ds.xml</code> style configuration files into the format expected by JBoss EAP 6. For more information, see:  <a class="xref" href="chap-Tools_and_Tips.html#Use_the_IronJacamar_Tool_to_Migrate_Datasource_and_Resource_Adapter_Configurations">Section 4.1.6, “Use the IronJacamar Tool to Migrate Datasource and Resource Adapter Configurations”</a>.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Migrate Code That Performs Remote DataSource Lookups</div>
			In previous versions of JBoss EAP, is possible to perform a JNDI remote lookup of DataSource objects, however it is never a recommended practice for the following reasons. 
			<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						Client control of a server resource is unreliable and can result in leaked connections if the client crashes or loses the connection to the server.
					</div></li><li class="listitem"><div class="para">
						Performance is very slow because all database operations are proxied through an <code class="code">MBean</code>.
					</div></li><li class="listitem"><div class="para">
						Transaction propagation is not supported.
					</div></li></ul></div>

		</div><div class="para">
		This functionality was removed from JBoss EAP 6 and you might see a <code class="code">NotSerializableException</code> when you migrate your application. The recommended approach is to create an EJB to access the DataSource and then call the EJB remotely. For more information, see the section in this book entitled <em class="citetitle">Remote Invocation Changes</em>. Additional information can be found in the <em class="citetitle">Development Guide</em> for JBoss EAP 6 on <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4587-781556+%5BLatest%5D&amp;comment=Title%3A+Update+the+DataSource+Configuration%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4587-781556+13+Nov+2017+13%3A32+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Install_and_Configure_the_JDBC_Driver">
      ⁠</a>3.1.6.3. Install and Configure the JDBC Driver</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			The JDBC driver can be installed into the container in one of the following two ways: 
			<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						As a deployment
					</div></li><li class="listitem"><div class="para">
						As a core module
					</div></li></ul></div>
			 The pros and cons of each approach are noted below.
		</div><div class="para">
		In JBoss EAP 6, the datasource is configured in the server configuration file. If the JBoss EAP 6 instance is running in a managed domain, the datasource is configured in the <code class="filename">domain/configuration/domain.xml</code> file. If the JBoss EAP 6 instance is running as a standalone server, the datasource is configured in the <code class="filename">standalone/configuration/standalone.xml</code> file. Schema reference information, which is the same for both modes, can be found in the <code class="filename">docs/schema/</code> directory of the JBoss EAP 6 install. For purposes of this discussion, assume the server is running as standalone server and the datasource is configured in the <code class="filename">standalone.xml</code> file.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819324792464">
      ⁠</a><p class="title"><strong>Procedure 3.8. Install and Configure the JDBC Driver</strong></p><div class="para">

		</div><ol class="1"><li class="step"><div class="para">
				Install the JDBC Driver.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Install the JDBC Driver as a deployment.
					</div><div class="para">
						This is the recommended way to install the driver. When the JDBC driver is installed as a deployment, it is deployed as a regular JAR. If the JBoss EAP 6 instance is running as a standalone server, copy the JDBC 4.0 compliant JAR into the <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/deployments/</code> directory. For a managed domain, you must use the Management Console or Management CLI to deploy the JAR to the server groups.
					</div><div class="para">
						The following is an example of a MySQL JDBC driver installed as a deployment to a standalone server: 
<pre class="screen">$cp mysql-connector-java-5.1.15.jar <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/deployments/</code></pre>

					</div><div class="para">
						Any JDBC 4.0 compliant driver is automatically recognized and installed into the system by name and version. A JDBC 4.0 compliant JAR contains a text file named <code class="filename">META-INF/services/java.sql.Driver</code> which specifies the driver class name(s). If the driver is not JDBC 4.0 compliant, it can be made deployable in one of the following ways: 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									Create and add a <code class="filename">java.sql.Driver</code> file to the JAR under the <code class="filename">META-INF/services/</code> path. This file should contain the driver class name, for example: 
<pre class="screen"><code class="code">com.mysql.jdbc.Driver</code></pre>

								</div></li><li class="listitem"><div class="para">
									Create a <code class="filename">java.sql.Driver</code> file in the deployment directory. For a JBoss EAP 6 instance running as a standalone server, the file should be placed here: <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/deployments/META-INF/services/java.sql.Driver</code>. If the server is in a managed domain, you must use the Management Console or Management CLI to deploy the file.
								</div></li></ul></div>

					</div><div class="para">
						The pros of this approach are: 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									This is the easiest method because there is no need to define a module.
								</div></li><li class="listitem"><div class="para">
									When the server is running in a managed domain, deployments that use this approach are automatically propagated to all servers in the domain. This means the administrator does not need to distribute the driver JAR manually.
								</div></li></ul></div>
						 The cons of this approach are: 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									If the JDBC driver consists of more than one JAR, for example the driver JAR plus a dependent license JAR or localization JAR, you can not install the driver as a deployment. You must install the JDBC driver as a core module.
								</div></li><li class="listitem"><div class="para">
									If the driver is not JDBC 4.0 compliant, a file must be created containing the driver class name(s) and must be imported into the JAR or overlayed in the <code class="filename">deployments/</code> directory.
								</div></li></ul></div>

					</div></li><li class="step"><div class="para">
						Install the JDBC Driver as a core module.
					</div><div class="para">
						To install a JDBC driver as a core module, you must create a file path structure under the <code class="filename"><em class="replaceable">EAP_HOME</em>/modules/</code> directory. This structure contains the JDBC driver JAR, any additional vendor license or localization JARs, and a <code class="filename">module.xml</code> file to define the module.
					</div><ul class="stepalternatives">
						<li class="step"><div class="para">
								Install the MySQL JDBC Driver as a core module
							</div><ol class="substeps i"><li class="step"><div class="para">
										Create the directory structure <code class="filename"><em class="replaceable">EAP_HOME</em>/modules/com/mysql/main/</code>
									</div></li><li class="step"><div class="para">
										In the <code class="filename">main/</code> subdirectory, create a <code class="filename">module.xml</code> file containing the following module definition for the MySQL JDBC driver: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:module:1.0"</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"com.mysql"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;resources&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;resource-root</span><span xmlns="" class="perl_Others"> path=</span><span xmlns="" class="perl_String">"mysql-connector-java-5.1.15.jar"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/resources&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;dependencies&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.api"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/dependencies&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/module&gt;</span>
<span xmlns="" class="line">​</span>
</pre>

									</div><div class="para">
										The module name, "com.mysql", matches the directory structure for this module. The <code class="code">&lt;dependencies&gt;</code> element is used to specify this module's dependencies on other modules. In this case, as is the case with all JDBC datasources, it is dependent on the Java JDBC APIs which are defined in another module named <code class="code">javax.api</code>. That module is located under the <code class="filename">modules/system/layers/base/javax/api/main/</code> directory.
									</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
											Make sure you do NOT have a space at the beginning of <code class="filename">module.xml</code> file or you will get a "New missing/unsatisfied dependencies" error for this driver.
										</div></div></div></li><li class="step"><div class="para">
										Copy the MySQL JDBC driver JAR into the <code class="filename"><em class="replaceable">EAP_HOME</em>/modules/com/mysql/main/</code> directory: 
<pre class="screen">$ cp mysql-connector-java-5.1.15.jar <code class="filename"><em class="replaceable">EAP_HOME</em>/modules/com/mysql/main/</code></pre>

									</div></li></ol></li>
						 <li class="step"><div class="para">
								Install the IBM DB2 JDBC driver and license JAR as a core module.
							</div><div class="para">
								This example is provided to only demonstrate how to deploy drivers that require JARs in addition to the JDBC Driver JAR.
							</div><ol class="substeps i"><li class="step"><div class="para">
										Create the directory structure <code class="filename"><em class="replaceable">EAP_HOME</em>/modules/com/ibm/db2/main/</code>.
									</div></li><li class="step"><div class="para">
										In the <code class="filename">main/</code> subdirectory, create a <code class="filename">module.xml</code> file containing the following module definition for the IBM DB2 JDBC driver and license: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:module:1.1"</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"com.ibm.db2"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;resources&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;resource-root</span><span xmlns="" class="perl_Others"> path=</span><span xmlns="" class="perl_String">"db2jcc.jar"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;resource-root</span><span xmlns="" class="perl_Others"> path=</span><span xmlns="" class="perl_String">"db2jcc_license_cisuz.jar"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/resources&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;dependencies&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.api"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.transaction.api"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/dependencies&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/module&gt;</span>
</pre>

									</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
											Make sure you do NOT have a space at the beginning of <code class="filename">module.xml</code> file or you will get a "New missing/unsatisfied dependencies" error for this driver.
										</div></div></div></li><li class="step"><div class="para">
										Copy the JDBC driver and license JAR to the <code class="filename"><em class="replaceable">EAP_HOME</em>/modules/com/ibm/db2/main/</code> directory. 
<pre class="screen">
$ cp db2jcc.jar <code class="filename"><em class="replaceable">EAP_HOME</em>/modules/com/ibm/db2/main/</code>
$ cp db2jcc_license_cisuz.jar <code class="filename"><em class="replaceable">EAP_HOME</em>/modules/com/ibm/db2/main/</code></pre>

									</div></li></ol></li>

					</ul><div class="para">
						The pros of this approach are: 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									This is the only approach that works when the JDBC driver consists of more than one JAR.
								</div></li><li class="listitem"><div class="para">
									With this approach, drivers that are not JDBC 4.0 compliant can be installed without modifying the driver JAR or creating a file overlay.
								</div></li></ul></div>
						 The cons of this approach are: 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									It is more difficult to set up a module.
								</div></li><li class="listitem"><div class="para">
									The module must be manually copied to every server running in a managed domain.
								</div></li></ul></div>

					</div></li></ol></li><li class="step"><div class="para">
				Configure the datasource.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Add the database driver.
					</div><div class="para">
						Add the <code class="code">&lt;driver&gt;</code> element to the <code class="code">&lt;drivers&gt;</code> element of the same file. Again, this contains some of the same datasource information that was previously defined in the <code class="filename">*-ds.xml</code> file.
					</div><div class="para">
						First determine if the driver JAR is JDBC 4.0 compliant. A JAR that is JDBC 4.0 compliant contains a <code class="filename">META-INF/services/java.sql.Driver</code> file that specifies the driver class name. The server uses this file to find the name of the driver class(es) in the JAR. A driver that is JDBC 4.0 compliant does not require a <code class="code">&lt;driver-class&gt;</code> element since it is already specified in the JAR. This is an example of the driver element for a JDBC 4.0 compliant MySQL driver: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;driver</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"mysql-connector-java-5.1.15.jar"</span><span xmlns="" class="perl_Others"> module=</span><span xmlns="" class="perl_String">"com.mysql"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre>
						 A driver that is not JDBC 4.0 compliant requires a <code class="code">&lt;driver-class&gt;</code> attribute to identify the driver class since there is no <code class="filename">META-INF/services/java.sql.Driver</code> file that specifies the driver class name. This is an example of the driver element for driver that is not JDBC 4.0 compliant: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;driver</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"mysql-connector-java-5.1.15.jar"</span><span xmlns="" class="perl_Others"> module=</span><span xmlns="" class="perl_String">"com.mysql"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;driver-class&gt;</span>com.mysql.jdbc.Driver<span xmlns="" class="perl_Keyword">&lt;/driver-class&gt;&lt;/driver&gt;</span>
</pre>

					</div></li><li class="step"><div class="para">
						Create the datasource.
					</div><div class="para">
						Create a <code class="code">&lt;datasource&gt;</code> element in the <code class="code">&lt;datasources&gt;</code> section of the <code class="filename">standalone.xml</code> file. This file contains much of the same datasource information that was previously defined in the <code class="filename">*-ds.xml</code> file.
					</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
							You must stop the server before editing the server configuration file for your change to be persisted on server restart.
						</div></div></div><div class="para">
						The following is an example of a MySQL datasource element in the <code class="filename">standalone.xml</code> file: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;datasource</span><span xmlns="" class="perl_Others"> jndi-name=</span><span xmlns="" class="perl_String">"java:/YourDatasourceName"</span><span xmlns="" class="perl_Others"> pool-name=</span><span xmlns="" class="perl_String">"YourDatasourceName"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;connection-url&gt;</span>jdbc:mysql://localhost:3306/YourApplicationURL<span xmlns="" class="perl_Keyword">&lt;/connection-url&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;driver&gt;</span>mysql-connector-java-5.1.15.jar<span xmlns="" class="perl_Keyword">&lt;/driver&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;transaction-isolation&gt;</span>TRANSACTION_READ_COMMITTED<span xmlns="" class="perl_Keyword">&lt;/transaction-isolation&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;pool&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;min-pool-size&gt;</span>100<span xmlns="" class="perl_Keyword">&lt;/min-pool-size&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;max-pool-size&gt;</span>200<span xmlns="" class="perl_Keyword">&lt;/max-pool-size&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/pool&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;security&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;user-name&gt;</span>USERID<span xmlns="" class="perl_Keyword">&lt;/user-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;password&gt;</span>PASSWORD<span xmlns="" class="perl_Keyword">&lt;/password&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/security&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;statement&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;prepared-statement-cache-size&gt;</span>100<span xmlns="" class="perl_Keyword">&lt;/prepared-statement-cache-size&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;share-prepared-statements/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/statement&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/datasource&gt;</span>
</pre>

					</div></li></ol></li><li class="step"><div class="para">
				Update JNDI references in the application code.
			</div><div class="para">
				You must replace outdated JNDI lookup names in the application source code to use the new JNDI standardized datasource names you have defined. For more information, see:  <a class="xref" href="chap-Migrate_Your_Application.html#Modify_the_Application_to_Follow_the_New_JNDI_Namespace_Rules">Section 3.1.8.4, “Modify the Application to Follow the New JNDI Namespace Rules”</a>.
			</div><div class="para">
				You must also replace any existing <code class="code">@Resource</code> annotations that access the datasource to use the new JNDI name. For example: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Resource</span>(name = <span xmlns="" class="perl_String">"java:/YourDatasourceName"</span>).
</pre>

			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+5718-766872+%5BLatest%5D&amp;comment=Title%3A+Install+and+Configure+the+JDBC+Driver%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5718-766872+05+Aug+2015+12%3A20+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_the_Datasource_for_Hibernate_or_JPA1">
      ⁠</a>3.1.6.4. Configure the Datasource for Hibernate or JPA</h3></div></div></div><div class="para">
		If your application uses JPA and currently bundles the Hibernate JARs, you may want to use the Hibernate that is included with JBoss EAP 6. To use this version of Hibernate, you must remove the old Hibernate bundle from your application.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819302715872">
      ⁠</a><p class="title"><strong>Procedure 3.9. Remove the Hibernate bundle</strong></p><ol class="1"><li class="step"><div class="para">
				Remove the Hibernate JARs from your application library folders.
			</div></li><li class="step"><div class="para">
				Remove or comment out the <code class="code">&lt;hibernate.transaction.manager_lookup_class&gt;</code> element in your <code class="filename">persistence.xml</code> file as this element is not needed.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4640-603795+%5BLatest%5D&amp;comment=Title%3A+Configure+the+Datasource+for+Hibernate+or+JPA%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4640-603795+25+Feb+2014+17%3A30+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Update_the_Resource_Adapter_Configuration">
      ⁠</a>3.1.6.5. Update the Resource Adapter Configuration</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			In previous versions of the application server, the resource adapter configuration was defined in a file with a suffix of <code class="filename">*-ds.xml</code>. In JBoss EAP 6, a resource adapter is configured in the server configuration file. If you are running in a managed domain, the configuration file is the <code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/domain.xml</code> file. If you are running as a standalone server, configure the resource adapter in the <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/configuration/standalone.xml</code> file. Schema reference information, which is the same for both modes, can be found under <em class="citetitle">Schemas</em> on the IronJacamar web site here: <a href="http://www.ironjacamar.org/documentation.html">http://www.ironjacamar.org/documentation.html</a>.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			You must stop the server before editing the server configuration file for your change to be persisted on server restart.
		</div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Define the resource adapter</div>
			The resource adapter descriptor information is defined under the following subsystem element in the server configuration file: 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:resource-adapters:1.1"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre>
			 You will use some of the same information that was previously defined in the resource adapter <code class="filename">*-ds.xml</code> file.
		</div><div class="para">
		The following is an example of a resource adapter element in the server configuration file: 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;resource-adapters&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;resource-adapter&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;archive&gt;</span>multiple-full.rar<span xmlns="" class="perl_Keyword">&lt;/archive&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;config-property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Name"</span><span xmlns="" class="perl_Keyword">&gt;</span>ResourceAdapterValue<span xmlns="" class="perl_Keyword">&lt;/config-property&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;transaction-support&gt;</span>NoTransaction<span xmlns="" class="perl_Keyword">&lt;/transaction-support&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;connection-definitions&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;connection-definition</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      class-name=</span><span xmlns="" class="perl_String">"org.jboss.jca.test.deployers.spec.rars.multiple.MultipleManagedConnectionFactory1"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      enabled=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> jndi-name=</span><span xmlns="" class="perl_String">"java:/eis/MultipleConnectionFactory1"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      pool-name=</span><span xmlns="" class="perl_String">"MultipleConnectionFactory1"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;config-property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Name"</span><span xmlns="" class="perl_Keyword">&gt;</span>MultipleConnectionFactory1Value<span xmlns="" class="perl_Keyword">&lt;/config-property&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/connection-definition&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;connection-definition</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      class-name=</span><span xmlns="" class="perl_String">"org.jboss.jca.test.deployers.spec.rars.multiple.MultipleManagedConnectionFactory2"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      enabled=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> jndi-name=</span><span xmlns="" class="perl_String">"java:/eis/MultipleConnectionFactory2"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      pool-name=</span><span xmlns="" class="perl_String">"MultipleConnectionFactory2"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;config-property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Name"</span><span xmlns="" class="perl_Keyword">&gt;</span>MultipleConnectionFactory2Value<span xmlns="" class="perl_Keyword">&lt;/config-property&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/connection-definition&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/connection-definitions&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;admin-objects&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;admin-object</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      class-name=</span><span xmlns="" class="perl_String">"org.jboss.jca.test.deployers.spec.rars.multiple.MultipleAdminObject1Impl"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      jndi-name=</span><span xmlns="" class="perl_String">"java:/eis/MultipleAdminObject1"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;config-property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Name"</span><span xmlns="" class="perl_Keyword">&gt;</span>MultipleAdminObject1Value<span xmlns="" class="perl_Keyword">&lt;/config-property&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/admin-object&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;admin-object</span><span xmlns="" class="perl_Others"> class-name=</span><span xmlns="" class="perl_String">"org.jboss.jca.test.deployers.spec.rars.multiple.MultipleAdminObject2Impl"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      jndi-name=</span><span xmlns="" class="perl_String">"java:/eis/MultipleAdminObject2"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;config-property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Name"</span><span xmlns="" class="perl_Keyword">&gt;</span>MultipleAdminObject2Value<span xmlns="" class="perl_Keyword">&lt;/config-property&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/admin-object&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/admin-objects&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/resource-adapter&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/resource-adapters&gt;</span></pre>

	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+5327-593713+%5BLatest%5D&amp;comment=Title%3A+Update+the+Resource+Adapter+Configuration%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5327-593713+24+Feb+2014+14%3A37+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Detect_Leaked_Datasource_Connections">
      ⁠</a>3.1.6.6. Detect Leaked Datasource Connections</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			In JBoss EAP 6, you can detect leaked datasource connections using the Cached Connection Manager (CCM) debug utility. This topic describes how to enable and debug the CCM utility.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819308098608">
      ⁠</a><p class="title"><strong>Procedure 3.10. Enable the Cached Connection Manager</strong></p><ol class="1"><li class="step"><div class="para">
				Enable CCM in the <code class="literal">datasources</code> subsystem of the server configuration file by setting <code class="code">&lt;use-ccm="true"</code>. This is the default value and does not need to be set explicitly. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:datasources:1.2"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;datasources&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;datasource</span> <span xmlns="" class="perl_Error">...</span><span xmlns="" class="perl_Others"> enabled=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> use-ccm=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      ...
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/datasource&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/datasources&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/subsystem&gt;</span></pre>

			</div></li><li class="step"><div class="para">
				Verify that the <code class="code">&lt;cached-connection-manager&gt;</code> exists in the <code class="literal">jca</code> subsystem of the server configuration file. Set the <code class="code">debug</code> attribute to <code class="literal">true</code>. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:jca:1.1"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;cached-connection-manager</span><span xmlns="" class="perl_Others"> debug=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> error=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/subsystem&gt;</span></pre>
				 Setting <code class="code">debug="true"</code> causes the following to happen. 
				<div class="itemizedlist"><ul><li class="listitem"><div class="para">
							An <code class="literal">INFO</code> message is logged with the following message: "Closing a connection for you. Please close them yourself"
						</div></li><li class="listitem"><div class="para">
							A stacktrace is generated for the code that opened the leaked connection.
						</div></li><li class="listitem"><div class="para">
							The leaked connection is closed.
						</div></li></ul></div>
				 The additional property <code class="code">error="true"</code> can be used to raise a <code class="classname">RuntimeException</code> and generate an <code class="literal">ERROR</code> message in the log.
			</div></li><li class="step"><div class="para">
				Activating debug will have some impact on performance and log file size, so it is only recommended for use during testing. After verifying that no leaks remain and before deploying applications to production, restore the configuration by removing the <code class="code">debug="true"</code> setting or using <code class="code">&lt;cached-connection-manager debug="false"/&gt;</code>.
			</div></li></ol></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819328489216">
      ⁠</a><p class="title"><strong>Procedure 3.11. Debug Leaks Not Reported by Cached Connection Manager</strong></p><ol class="1"><li class="step"><div class="para">
				Be sure the <code class="literal">datasource</code> subsystem of the server configuration file is not configured with <code class="code">use-ccm="false"</code>
			</div></li><li class="step"><div class="para">
				Be sure the <code class="literal">datasource</code> subsystem of the server configuration file is not configured with <code class="code">jta="false"</code>
			</div></li><li class="step"><div class="para">
				Be sure the minimum logging level is set to <code class="literal">INFO</code> for <code class="classname">org.jboss.jca</code>.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44669-766763+%5BLatest%5D&amp;comment=Title%3A+Detect+Leaked+Datasource+Connections%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44669-766763+04+Aug+2015+13%3A11+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Security_Changes">
      ⁠</a>3.1.7. Security Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_Application_Security_Changes">
      ⁠</a>3.1.7.1. Configure Application Security Changes</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Configure security for basic authentication</div>
			In previous versions of JBoss EAP, properties files placed in the <code class="filename"><em class="replaceable">EAP_HOME</em>/server/<em class="replaceable">SERVER_NAME</em>/conf/</code> directory were on classpath and could be easily found by the <code class="code">UsersRolesLoginModule</code>. In JBoss EAP 6, the directory structure has changed. Properties files must be packaged within the application to make them available in the classpath.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			You must stop the server before editing the server configuration file for your change to be persisted on server restart.
		</div></div></div><div class="para">
		To configure security for basic authentication, add a new security domain under <code class="code">security-domains</code> to the <code class="filename">standalone/configuration/standalone.xml</code> or the <code class="filename">domain/configuration/domain.xml</code> server configuration file: 
<pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;security-domain</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"example"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;authentication&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;login-module</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"UsersRoles"</span><span xmlns="" class="perl_Others"> flag=</span><span xmlns="" class="perl_String">"required"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"usersProperties"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">                    value=</span><span xmlns="" class="perl_String">"${jboss.server.config.dir}/example-users.properties"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"rolesProperties"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">                    value=</span><span xmlns="" class="perl_String">"${jboss.server.config.dir}/example-roles.properties"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/login-module&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/authentication&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/security-domain&gt;</span></pre>

	</div><div class="para">
		If the JBoss EAP 6 instance is running as a standalone server, <code class="varname"> ${jboss.server.config.dir}</code> refers to the <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/configuration/</code> directory. If the instance is running in a managed domain, <code class="varname"> ${jboss.server.config.dir}</code> refers to the <code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/</code> directory.
	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Modify security domain names</div>
			In JBoss EAP 6, security domains no longer use the prefix <code class="code">java:/jaas/</code> in their names. 
			<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						For Web applications, you must remove this prefix from the security domain configurations in the <code class="filename">jboss-web.xml</code>.
					</div></li><li class="listitem"><div class="para">
						For Enterprise applications, you must remove this prefix from the security domain configurations in the <code class="filename">jboss-ejb3.xml</code> file. This file has replaced the <code class="filename">jboss.xml</code> in JBoss EAP 6.
					</div></li></ul></div>

		</div><div class="para">

	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4945-591678+%5BLatest%5D&amp;comment=Title%3A+Configure+Application+Security+Changes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4945-591678+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Update_Applications_That_Use_PicketLink_STS_and_Web_Services">
      ⁠</a>3.1.7.2. Update Applications That Use PicketLink STS and Web Services</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			If your JBoss EAP 6.1 application uses PicketLink STS and Web services, you might need to make changes when you migrate to JBoss EAP 6.2 or later. A fix applied to JBoss EAP to address <a href="https://access.redhat.com/security/cve/CVE-2013-2133">CVE-2013-2133</a> enforces authorization checks by the container before running any JAXWS handlers attached to EJB3-based WS endpoints. As a consequence, some PicketLink STS functionality can be affected because the PicketLink <code class="classname">SAML2Handler</code> establishes a security principal that is intended to be used later in the process. You might see a <code class="classname">NullPointerException</code> in the server log because the principal is <code class="literal">NULL</code> when the <code class="classname">HandlerAuthInterceptor</code> accesses the <code class="classname">SAML2Handler</code>. You must disable this security check to fix this problem.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819320551920">
      ⁠</a><p class="title"><strong>Procedure 3.12. Disable Additional Authorization Checks</strong></p><ul><li class="step"><div class="para">
				You can disable the additional authorization checks and keep using the existing PicketLink deployments by using one of the following methods.
			</div><ul class="stepalternatives">
				<li class="step"><div class="para">
						Set a system-wide property.
					</div><div class="para">
						You can disable additional authorization checks at the server level by setting the <code class="code">org.jboss.ws.cxf.disableHandlerAuthChecks</code> system property value to <code class="literal">true</code>. This method affects any deployment made to the application server.
					</div><div class="para">
						For information on how to set a system property, see the topic entitled <em class="citetitle">Configure System Properties Using the Management CLI</em> in the <em class="citetitle">Administration and Configuration Guide</em> for JBoss EAP.
					</div></li>
				 <li class="step"><div class="para">
						Create a property in the deployment's web services descriptor file.
					</div><div class="para">
						You can disable additional authorization checks at the deployment level by setting the <code class="code">org.jboss.ws.cxf.disableHandlerAuthChecks</code> property value to <code class="literal">true</code> in the <code class="filename">jboss-webservices.xml</code> file. This method impacts only the specific deployment.
					</div><ol class="substeps a"><li class="step"><div class="para">
								Create a <code class="filename">jboss-webservices.xml</code> file in the <code class="filename">META-INF/</code> directory of the deployment in which you want to disable additional authorization checks.
							</div></li><li class="step"><div class="para">
								Add the following content. 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.1" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;webservices</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://www.jboss.com/xml/ns/javaee"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  version=</span><span xmlns="" class="perl_String">"1.2"</span><span xmlns="" class="perl_Others"> xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://www.jboss.com/xml/ns/javaee"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;property&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;name&gt;</span>org.jboss.ws.cxf.disableHandlerAuthChecks<span xmlns="" class="perl_Keyword">&lt;/name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/webservices&gt;</span></pre>

							</div></li></ol></li>

			</ul></li></ul></div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			Enabling the <code class="code">org.jboss.ws.cxf.disableHandlerAuthChecks</code> property renders a system vulnerable to <a href="https://access.redhat.com/security/cve/CVE-2013-2133">CVE-2013-2133</a>. If the application expects security restrictions declared on EJB methods to be applied and does not apply them independent to the JAX-WS handler, then the property should not be enabled. The property should only be used for purposes of backwards compatibility when needed to avoid breaking the application.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+36181-779889+%5BLatest%5D&amp;comment=Title%3A+Update+Applications+That+Use+PicketLink+STS+and+Web+Services%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=36181-779889+20+Sep+2016+15%3A24+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-JNDI_Changes">
      ⁠</a>3.1.8. JNDI Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Update_Application_JNDI_Namespace_Names1">
      ⁠</a>3.1.8.1. Update Application JNDI Namespace Names</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			EJB 3.1 introduced a standardized global JNDI namespace and a series of related namespaces that map to the various scopes of a Java EE application. Portable EJB names only get bound to three of them: <code class="literal">java:global</code>, <code class="literal">java:module</code>, and <code class="literal">java:app</code>. Applications with EJBs that use JNDI must be changed to follow the new standardized JNDI namespace convention.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819303776640">
      ⁠</a><p class="title"><strong>Procedure 3.13. Modify JNDI lookups</strong></p><ol class="1"><li class="step"><div class="para">
				 Learn more about <a class="xref" href="chap-Migrate_Your_Application.html#Portable_JNDI_Naming_Syntax">Section 3.1.8.2, “Portable EJB JNDI Names”</a>
			</div></li><li class="step"><div class="para">
				 <a class="xref" href="chap-Migrate_Your_Application.html#Review_the_JNDI_Namespace_Rules">Section 3.1.8.3, “Review the JNDI Namespace Rules”</a>
			</div></li><li class="step"><div class="para">
				 <a class="xref" href="chap-Migrate_Your_Application.html#Modify_the_Application_to_Follow_the_New_JNDI_Namespace_Rules">Section 3.1.8.4, “Modify the Application to Follow the New JNDI Namespace Rules”</a>
			</div></li></ol></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Example JNDI Mappings</div>
			Examples of JNDI namespaces in previous releases and how they are specified in JBoss EAP 6 can be found here:  <a class="xref" href="chap-Migrate_Your_Application.html#Examples_of_JNDI_Namespaces_in_Previous_Releases_and_How_They_are_Specified_in_JBoss_Enterprise_Application_Platform_61">Section 3.1.8.5, “Examples of JNDI Namespaces in Previous Releases and How They are Specified in JBoss EAP 6”</a>
		</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4589-603696+%5BLatest%5D&amp;comment=Title%3A+Update+Application+JNDI+Namespace+Names%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4589-603696+25+Feb+2014+17%3A16+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Portable_JNDI_Naming_Syntax">
      ⁠</a>3.1.8.2. Portable EJB JNDI Names</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			The Java EE 6 specification defines four logical namespaces, each with its own scope, but portable EJB names only get bound to three of them. The following table details when and how to use each namespace.
		</div><div class="table"><a id="table-portable-jndi-namespaces">
      ⁠</a><p class="title"><strong>Table 3.1. Portable JNDI Namespaces</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols lt-7-rows" summary="Portable JNDI Namespaces"><colgroup><col width="33%" style="text-align: left" class="c1"/><col width="67%" style="text-align: left" class="c2"/></colgroup><thead><tr><th style="text-align: left"> JNDI Namespace </th><th style="text-align: left"> Description </th></tr></thead><tbody><tr><td style="text-align: left"> java:global </td><td style="text-align: left"> <div class="para">
						Names in this namespace are shared by all applications deployed in an application server instance. Use names in this namespace to find EJBs external archives deployed to the same server.
					</div>
					 <div class="para">
						The following is an example of a java:global namespace: <code class="code">java:global/jboss-seam-booking/jboss-seam-booking-jar/HotelBookingAction</code>
					</div>
					 </td></tr><tr><td style="text-align: left"> java:module </td><td style="text-align: left"> <div class="para">
						Names in this namespace are shared by all components in a module, for example, all enterprise beans in a single EJB module or all components in a web module.
					</div>
					 <div class="para">
						The following is an example of a java:module namespace: <code class="code">java:module/HotelBookingAction!org.jboss.seam.example.booking.HotelBooking</code>
					</div>
					 </td></tr><tr><td style="text-align: left"> java:app </td><td style="text-align: left"> <div class="para">
						Names in this namespace are shared by all components in all modules in a single application. For example, a WAR and an EJB jar file in the same EAR file would have access to resources in the java:app namespace.
					</div>
					 <div class="para">
						The following is an example of a java:app namespace: <code class="code">java:app/jboss-seam-booking-jar/HotelBookingAction</code>
					</div>
					 </td></tr></tbody></table></div></div><div class="para">
		You can find more information about JNDI naming contexts in section EE.5.2.2, "Application Component Environment Namespaces" in the "JSR 316: JavaTM Platform, Enterprise Edition (Java EE) Specification, v6". You can download the specification from here: <a href="http://jcp.org/en/jsr/detail?id=316">http://jcp.org/en/jsr/detail?id=316</a>
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+5419-591696+%5BLatest%5D&amp;comment=Title%3A+Portable+EJB+JNDI+Names%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5419-591696+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Review_the_JNDI_Namespace_Rules">
      ⁠</a>3.1.8.3. Review the JNDI Namespace Rules</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			JBoss EAP 6 has improved upon JNDI namespace names, not only to provide predictable and consistent rules for every name bound in the application server, but also to prevent future compatibility issues. This means you might run into issues with the current namespaces in your application if they don't follow the new rules.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Namespaces should follow these rules:</div>
			<div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
						Unqualified relative names like <code class="literal">DefaultDS</code> or <code class="literal">jdbc/DefaultDS</code> should be qualified relative to <code class="literal">java:comp/env</code>, <code class="literal">java:module/env</code>, or <code class="literal">java:jboss/env</code>, depending on the context.
					</div></li><li class="listitem"><div class="para">
						Unqualified <code class="literal">absolute</code> names like <code class="literal">/jdbc/DefaultDS</code> should be qualified relative to a <code class="literal">java:jboss/root</code> name.
					</div></li><li class="listitem"><div class="para">
						Qualified <code class="literal">absolute</code> names like <code class="literal">java:/jdbc/DefaultDS</code> should be qualified the same way as Unqualified <code class="literal">absolute</code> names above.
					</div></li><li class="listitem"><div class="para">
						The special <code class="literal">java:jboss</code> namespace is shared across the entire AS server instance.
					</div></li><li class="listitem"><div class="para">
						Any <code class="literal">relative</code> name with a <code class="literal">java:</code> prefix must be in one of the five namespaces: <code class="literal">comp</code>, <code class="literal">module</code>, <code class="literal">app</code>, <code class="literal">global</code>, or the proprietary <code class="literal">jboss</code>. Any name starting with <code class="literal">java:xxx</code> where <em class="replaceable">xxx</em> does not match any of the above five would result in an invalid name error.
					</div></li></ol></div>

		</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4642-591670+%5BLatest%5D&amp;comment=Title%3A+Review+the+JNDI+Namespace+Rules%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4642-591670+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Modify_the_Application_to_Follow_the_New_JNDI_Namespace_Rules">
      ⁠</a>3.1.8.4. Modify the Application to Follow the New JNDI Namespace Rules</h3></div></div></div><div class="para">
		<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					Here is an example of a JNDI lookup in JBoss EAP 5.1. This code is usually found in an initialization method.
				</div><div class="para">
					
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">private</span> ProductManager productManager;
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">try</span> {
<span xmlns="" class="line">​</span>    context = <span xmlns="" class="perl_Keyword">new</span> InitialContext();
<span xmlns="" class="line">​</span>    productManager = (ProductManager) context.<span xmlns="" class="perl_Function">lookup</span>(<span xmlns="" class="perl_String">"OrderManagerApp/ProductManagerBean/local"</span>);
<span xmlns="" class="line">​</span>} <span xmlns="" class="perl_Keyword">catch</span>(Exception lookupError) {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">throw</span> <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">ServletException</span>(<span xmlns="" class="perl_String">"Unable to find the ProductManager bean"</span>, lookupError);
<span xmlns="" class="line">​</span>}
</pre>

				</div><div class="para">
					Note the lookup name is <code class="code">OrderManagerApp/ProductManagerBean/local</code>.
				</div></li><li class="listitem"><div class="para">
					The following is an example of how the same lookup would be coded in JBoss EAP 6 using dependency injection.
				</div><div class="para">
					
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">EJB</span>(lookup=<span xmlns="" class="perl_String">"java:app/OrderManagerEJB/ProductManagerBean!services.ejb.ProductManager"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">private</span> ProductManager productManager;
</pre>

				</div><div class="para">
					The lookup values are now defined as member variables and use the new portable <code class="literal">java:app</code> JNDI namespace name <code class="code">java:app/OrderManagerEJB/ProductManagerBean!services.ejb.ProductManager</code>.
				</div></li><li class="listitem"><div class="para">
					If you prefer not to use dependency injection, you can continue to create the new InitialContext as above and modify the lookup to use the new JNDI namespace name. 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">private</span> ProductManager productManager;
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">try</span> {
<span xmlns="" class="line">​</span>    context = <span xmlns="" class="perl_Keyword">new</span> InitialContext();
<span xmlns="" class="line">​</span>    productManager = (ProductManager) context.<span xmlns="" class="perl_Function">lookup</span>(<span xmlns="" class="perl_String">"java:app/OrderManagerEJB/ProductManagerBean!services.ejb.ProductManager"</span>);
<span xmlns="" class="line">​</span>} <span xmlns="" class="perl_Keyword">catch</span>(Exception lookupError) {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">throw</span> <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">ServletException</span>(<span xmlns="" class="perl_String">"Unable to find the ProductManager bean"</span>, lookupError);
<span xmlns="" class="line">​</span>}
</pre>

				</div></li></ul></div>

	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4641-634555+%5BLatest%5D&amp;comment=Title%3A+Modify+the+Application+to+Follow+the+New+JNDI+Namespace+Rules%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4641-634555+29+Apr+2014+12%3A29+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Examples_of_JNDI_Namespaces_in_Previous_Releases_and_How_They_are_Specified_in_JBoss_Enterprise_Application_Platform_61">
      ⁠</a>3.1.8.5. Examples of JNDI Namespaces in Previous Releases and How They are Specified in JBoss EAP 6</h3></div></div></div><div class="table"><a id="tableJNDINamespaceMapping">
      ⁠</a><p class="title"><strong>Table 3.2. JNDI Namespace Mapping Table</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-7-rows" summary="JNDI Namespace Mapping Table"><colgroup><col width="33%" style="text-align: left" class="c1"/><col width="33%" style="text-align: left" class="c2"/><col width="33%" style="text-align: left" class="c3"/></colgroup><thead><tr><th style="text-align: left"> Namespace in JBoss EAP 5.x </th><th style="text-align: left"> Namespace in JBoss EAP 6 </th><th style="text-align: left"> Additional Comments </th></tr></thead><tbody><tr><td style="text-align: left"> OrderManagerApp/ProductManagerBean/local </td><td style="text-align: left"> java:module/ProductManagerBean!services.ejb.ProductManager </td><td style="text-align: left"> Java EE 6 standard binding. Scoped to the current module and only accessible within the same module. </td></tr><tr><td style="text-align: left"> OrderManagerApp/ProductManagerBean/local </td><td style="text-align: left"> java:app/OrderManagerEJB/ProductManagerBean!services.ejb.ProductManager </td><td style="text-align: left"> Java EE 6 standard binding. Scoped to the current application and only accessible within the same application. </td></tr><tr><td style="text-align: left"> OrderManagerApp/ProductManagerBean/local </td><td style="text-align: left"> java:global/OrderManagerApp/OrderManagerEJB/ProductManagerBean!services.ejb.ProductManager </td><td style="text-align: left"> Java EE 6 standard binding. Scoped to the application server and globally accessible. </td></tr><tr><td style="text-align: left"> java:comp/UserTransaction </td><td style="text-align: left"> java:comp/UserTransaction </td><td style="text-align: left"> Namespace is scoped to the current component. Not accessible for threads that are not Java EE 6, for example, threads created directly by your application. </td></tr><tr><td style="text-align: left"> java:comp/UserTransaction </td><td style="text-align: left"> java:jboss/UserTransaction </td><td style="text-align: left"> Globally accessible. Use this if java:comp/UserTransaction is not available. </td></tr><tr><td style="text-align: left"> java:/TransactionManager </td><td style="text-align: left"> java:jboss/TransactionManager </td><td style="text-align: left"> </td></tr><tr><td style="text-align: left"> java:/TransactionSynchronizationRegistry </td><td style="text-align: left"> java:jboss/TransactionSynchronizationRegistry </td><td style="text-align: left"> </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4961-606458+%5BLatest%5D&amp;comment=Title%3A+Examples+of+JNDI+Namespaces+in+Previous+Releases+and+How+They+are+Specified+in+JBoss+EAP+6%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4961-606458+26+Feb+2014+14%3A30+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="sect-Changes_Dependent_on_Your_Application_Architecture_and_Components">
      ⁠</a>3.2. Changes Dependent on Your Application Architecture and Components</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="Review_Changes_Dependent_on_Your_Application_Architecture_and_Components1">
      ⁠</a>3.2.1. Review Changes Dependent on Your Application Architecture and Components</h2></div></div></div><div class="para">
		If your application uses any of the following technologies or components, you may need to make modifications to your application when you migrate to JBoss EAP 6.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Hibernate and JPA</span></dt><dd><div class="para">
					If your application uses Hibernate or JPA, your application may need some modifications. For more information, refer:  <a class="xref" href="chap-Migrate_Your_Application.html#Update_Applications_That_Use_Hibernate_andor_JPA1">Section 3.2.2.1, “Update Applications That Use Hibernate and/or JPA”</a>.
				</div></dd><dt><span class="term">REST</span></dt><dd><div class="para">
					If your application uses JAX-RS, you should be aware that JBoss EAP 6 automatically sets up RESTEasy, so you no longer need to configure it yourself. For more information, refer:  <a class="xref" href="chap-Migrate_Your_Application.html#Configure_JAX-RS_and_RESTEasy_Changes1">Section 3.2.7.1, “Configure JAX-RS and RESTEasy Changes”</a>
				</div></dd><dt><span class="term">LDAP</span></dt><dd><div class="para">
					The LDAP security realm is configured differently in JBoss EAP 6. If your application uses LDAP, refer to the following topic for more information:  <a class="xref" href="chap-Migrate_Your_Application.html#Configure_LDAP_Security_Realm_Changes1">Section 3.2.8.1, “Configure LDAP Security Realm Changes”</a>.
				</div></dd><dt><span class="term">Messaging</span></dt><dd><div class="para">
					JBoss Messaging is no longer included in JBoss EAP 6. If your application uses JBoss Messaging as the messaging provider, you need to replace the JBoss Messaging code with HornetQ. The following topic describes what you need to do:  <a class="xref" href="chap-Migrate_Your_Application.html#Migrate_Your_Application_to_Use_HornetQ_as_the_JMS_Provider">Section 3.2.9.4, “Migrate Your Application to Use HornetQ as the JMS Provider”</a>.
				</div></dd><dt><span class="term">Clustering</span></dt><dd><div class="para">
					The way you enable clustering has changed in JBoss EAP 6. For details, refer:  <a class="xref" href="chap-Migrate_Your_Application.html#Make_Changes_to_Your_Application_for_Clustering">Section 3.2.10.1, “Make Changes to Your Application for Clustering”</a>.
				</div></dd><dt><span class="term">Service-style deployment</span></dt><dd><div class="para">
					Although JBoss EAP 6 no longer uses service-style descriptors, the container supports these service-style deployments without change where possible. For deployment information, refer:  <a class="xref" href="chap-Migrate_Your_Application.html#Update_Applications_That_Use_Service-style_Deployments">Section 3.2.11.1, “Update Applications That Use Service-style Deployments”</a>
				</div></dd><dt><span class="term">Remote invocation</span></dt><dd><div class="para">
					If your application makes remote invocations, you can still use JNDI to lookup a proxy for your bean and invoke on that returned proxy. For more information about required syntax and namespaces changes, refer:  <a class="xref" href="chap-Migrate_Your_Application.html#Migrate_JBoss_Enterprise_Application_Platform_5_Deployed_Applications_That_Make_Remote_Invocations_to_JBoss_Enterprise_Application_Platform_6">Section 3.2.12.1, “Migrate JBoss EAP 5 Deployed Applications That Make Remote Invocations to JBoss EAP 6”</a>.
				</div></dd><dt><span class="term">Seam 2.2</span></dt><dd><div class="para">
					If your application uses Seam 2.2, refer to the following topic for changes you need to make:  <a class="xref" href="chap-Migrate_Your_Application.html#Migrate_Seam_22_Archives_to_JBoss_Enterprise_Application_Platform_6">Section 3.2.18.1, “Migrate Seam 2.2 Archives to JBoss EAP 6”</a>.
				</div></dd><dt><span class="term">Spring</span></dt><dd><div class="para">
					If your application uses Spring, refer:  <a class="xref" href="chap-Migrate_Your_Application.html#Migrate_Spring_Applications">Section 3.2.19.1, “Migrate Spring Applications”</a>.
				</div></dd><dt><span class="term">Other changes that may impact your migration</span></dt><dd><div class="para">
					For additional changes in JBoss EAP 6 that may impact your application, refer:  <a class="xref" href="chap-Migrate_Your_Application.html#Become_Familiar_with_Other_Changes_That_May_Affect_Your_Migration">Section 3.2.20.1, “Become Familiar with Other Changes That May Affect Your Migration”</a>.
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+7672-760076+%5BLatest%5D&amp;comment=Title%3A+Review+Changes+Dependent+on+Your+Application+Architecture+and+Components%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7672-760076+01+Jun+2015+02%3A55+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Hibernate_and_JPA_Changes">
      ⁠</a>3.2.2. Hibernate and JPA Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Update_Applications_That_Use_Hibernate_andor_JPA1">
      ⁠</a>3.2.2.1. Update Applications That Use Hibernate and/or JPA</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			If your application uses Hibernate or JPA, read through the following sections and make any changes necessary to migrate to JBoss EAP 6.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				<a class="xref" href="chap-Migrate_Your_Application.html#Configure_Changes_for_Applications_That_Use_Hibernate_and_JPA1">Section 3.2.2.2, “Configure Changes for Applications That Use Hibernate and JPA”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="chap-Migrate_Your_Application.html#Update_Your_Hibernate_3_Application_to_Use_Hibernate_41">Section 3.2.2.4, “Update Your Hibernate 3 Application to Use Hibernate 4”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="chap-Migrate_Your_Application.html#Update_Your_Application_to_Conform_to_the_JPA_20_Specification">Section 3.2.2.9, “Update Your Application to Conform to the JPA 2.0 Specification”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="chap-Migrate_Your_Application.html#Replace_JPAHibernate_Second_Level_Cache_with_Infinispan">Section 3.2.2.10, “Replace JPA/Hibernate Second Level Cache with Infinispan”</a>
			</div></li><li class="listitem"><div class="para">
				<a class="xref" href="chap-Migrate_Your_Application.html#Migrate_to_Hibernate_Validator_41">Section 3.2.2.12, “Migrate to Hibernate Validator 4”</a>
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+5132-606462+%5BLatest%5D&amp;comment=Title%3A+Update+Applications+That+Use+Hibernate+and%2For+JPA%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5132-606462+26+Feb+2014+14%3A36+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_Changes_for_Applications_That_Use_Hibernate_and_JPA1">
      ⁠</a>3.2.2.2. Configure Changes for Applications That Use Hibernate and JPA</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			If your application contains a <code class="filename">persistence.xml</code> file or the code uses the annotations <code class="code">@PersistenceContext</code> or <code class="code">@PersistenceUnit</code>, JBoss EAP 6 detects this during deployment and assumes the application uses JPA. It implicitly adds Hibernate 4 plus a few other dependencies to your application classpath.
		</div><div class="para">
		If your application currently uses Hibernate 3 libraries, in most cases you will be able to switch to using Hibernate 4 and run successfully. However, if you see <code class="code">ClassNotFoundExceptions</code> when you deploy your application, you can try to resolve them using one of the following approaches.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			Applications that use Hibernate directly with Seam 2.2 may use a version of Hibernate 3 packaged inside the application. Hibernate 4, which is provided through the org.hibernate module of JBoss EAP 6, is not supported by Seam 2.2. This example is intended to help you get your application running on JBoss EAP 6 as a first step. Please be aware that packaging Hibernate 3 with a Seam 2.2 application is not a supported configuration.
		</div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819310704896">
      ⁠</a><p class="title"><strong>Procedure 3.14. Configure the Application</strong></p><ol class="1"><li class="step"><div class="para">
				Copy the required Hibernate 3 JARs to your application library.
			</div><div class="para">
				You may be able to resolve the issue by copying the specific Hibernate 3 JARs that contain the missing classes into the application's <code class="filename">lib/</code> directory or by adding them to the classpath using some other method. In some cases this may result in <code class="classname">ClassCastExceptions</code> or other class loading issues due to the mixed use of the Hibernate versions. If that happens, you need to use the next approach.
			</div></li><li class="step"><div class="para">
				Instruct the server to use only the Hibernate 3 libraries.
			</div><div class="para">
				JBoss EAP 6 allows you to package Hibernate 3.5 (or greater) persistence provider jars with the application. To direct the server to use only the Hibernate 3 libraries and to exclude the Hibernate 4 libraries, you need to set the <code class="code">jboss.as.jpa.providerModule</code> to <code class="literal">hibernate3-bundled</code> in the <code class="filename">persistence.xml</code> as follows: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;persistence</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://java.sun.com/xml/ns/persistence"</span><span xmlns="" class="perl_Others"> version=</span><span xmlns="" class="perl_String">"1.0"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;persistence-unit</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"plannerdatasource_pu"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;description&gt;</span>Hibernate 3 Persistence Unit.<span xmlns="" class="perl_Keyword">&lt;/description&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;jta-data-source&gt;</span>java:jboss/datasources/PlannerDS<span xmlns="" class="perl_Keyword">&lt;/jta-data-source&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;properties&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernate.show_sql"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"false"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jboss.as.jpa.providerModule"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"hibernate3-bundled"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/properties&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/persistence-unit&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/persistence&gt;</span>
</pre>
				 The Java Persistence API (JPA) deployer will detect the presence of a persistence provider in the application and use the Hibernate 3 libraries. For more information on the JPA persistence properties, refer  <a class="xref" href="chap-Migrate_Your_Application.html#Persistence_Unit_Properties">Section 3.2.2.3, “Persistence Unit Properties”</a>.
			</div></li><li class="step"><div class="para">
				Disable Hibernate second-level cache.
			</div><div class="para">
				Second-level cache for Hibernate 3 does not exhibit the same behavior with JBoss EAP 6 as it did in previous releases. If you are using Hibernate second-level cache with your application, you must disable it until you upgrade to Hibernate 4. To disable second-level cache, set the <code class="code">&lt;hibernate.cache.use_second_level_cache&gt;</code> to <code class="literal">false</code> in the <code class="filename">persistence.xml</code> file.
			</div></li><li class="step"><div class="para">
				Replace references to <code class="classname">org.jboss.ejb3.entity.ExtendedEntityManager</code>.
			</div><div class="para">
				In JBoss EAP 5, the <code class="classname">org.jboss.ejb3.entity.ExtendedEntityManager</code> class extended <code class="classname">javax.persistence.EntityManager</code> for extended persistence context management. In JBoss EAP 6, this class was replaced with the <code class="classname">org.jboss.as.jpa.container.ExtendedEntityManager</code> class. However, it is recommended that you update the code to use the standard Java EE 6 JPA API <code class="classname">javax.persistence.EntityManager</code> class instead of the proprietary class.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4909-766891+%5BLatest%5D&amp;comment=Title%3A+Configure+Changes+for+Applications+That+Use+Hibernate+and+JPA%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4909-766891+05+Aug+2015+13%3A21+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Persistence_Unit_Properties">
      ⁠</a>3.2.2.3. Persistence Unit Properties</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Hibernate 4.x configuration properties</div>
			JBoss EAP 6 automatically sets the following Hibernate 4.x configuration properties:
		</div><div class="table"><a id="table-hibernate-persistence-unit-properties">
      ⁠</a><p class="title"><strong>Table 3.3. Hibernate Persistence Unit Properties</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-7-rows" summary="Hibernate Persistence Unit Properties"><colgroup><col width="20%" style="text-align: left" class="c1"/><col width="20%" style="text-align: left" class="c2"/><col width="60%" style="text-align: left" class="c3"/></colgroup><thead><tr><th style="text-align: left"> Property Name </th><th style="text-align: left"> Default Value </th><th style="text-align: left"> Purpose </th></tr></thead><tbody><tr><td style="text-align: left"> <code class="code">hibernate.id.new_generator_mappings</code> </td><td style="text-align: left"> true </td><td style="text-align: left"> <div class="para">
						This setting is relevant if you use <code class="code">@GeneratedValue(AUTO)</code> to generate unique index key values for new entities. New applications should keep the default value of <code class="literal">true</code>. Existing applications that used Hibernate 3.3.x might need to change it to <code class="literal">false</code> to continue using a sequence object or table based generator and maintain backward compatibility. The application can override this value in the <code class="filename">persistence.xml</code> file.
					</div>
					 <div class="para">
						More information on this behavior is provided below.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">hibernate.transaction.jta.platform</code> </td><td style="text-align: left"> Instance of <code class="classname">org.hibernate.service.jta.platform.spi.JtaPlatform</code> Interface </td><td style="text-align: left"> <div class="para">
						This class passes the transaction manager, user transaction, and transaction synchronization registry into Hibernate.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">hibernate.ejb.resource_scanner</code> </td><td style="text-align: left"> Instance of <code class="classname">org.hibernate.ejb.packaging.Scanner</code> Interface </td><td style="text-align: left"> <div class="para">
						This class knows how to use the JBoss EAP 6 annotation indexer to provide faster deployment.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">hibernate.transaction.manager_lookup_class</code> </td><td style="text-align: left"> </td><td style="text-align: left"> <div class="para">
						This property is removed if found in the persistence.xml because it could conflict with <code class="code">hibernate.transaction.jta.platform</code>
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">hibernate.session_factory_name</code> </td><td style="text-align: left"> <em class="replaceable">QUALIFIED_PERSISTENCE_UNIT_NAME</em> </td><td style="text-align: left"> <div class="para">
						This is set to the application name + persistence unit name. The application can specify a different value, but it must be unique across all application deployments on the JBoss EAP 6 instance.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">hibernate.session_factory_name_is_jndi</code> </td><td style="text-align: left"> false </td><td style="text-align: left"> <div class="para">
						This is set only if the application did not specify a value for the <code class="code">hibernate.session_factory_name</code>.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">hibernate.ejb.entitymanager_factory_name</code> </td><td style="text-align: left"> <em class="replaceable">QUALIFIED_PERSISTENCE_UNIT_NAME</em> </td><td style="text-align: left"> <div class="para">
						This is set to the application name + persistence unit name. The application can specify a different value but it needs to be unique across all application deployments on the JBoss EAP 6 instance.
					</div>
					 </td></tr></tbody></table></div></div><div class="para">
		In Hibernate 4.x, if <code class="code">new_generator_mappings</code> is set to <code class="literal">true</code>:
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				<code class="code">@GeneratedValue(AUTO)</code> maps to <code class="classname">org.hibernate.id.enhanced.SequenceStyleGenerator</code>.
			</div></li><li class="listitem"><div class="para">
				<code class="code">@GeneratedValue(TABLE)</code> maps to <code class="classname">org.hibernate.id.enhanced.TableGenerator</code>.
			</div></li><li class="listitem"><div class="para">
				<code class="code">@GeneratedValue(SEQUENCE)</code> maps to <code class="classname">org.hibernate.id.enhanced.SequenceStyleGenerator</code>.
			</div></li></ul></div><div class="para">
		In Hibernate 4.x, if <code class="code">new_generator_mappings</code> is set to <code class="literal">false</code>:
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				<code class="code">@GeneratedValue(AUTO)</code> maps to Hibernate "native".
			</div></li><li class="listitem"><div class="para">
				<code class="code">@GeneratedValue(TABLE)</code> maps to <code class="classname">org.hibernate.id.MultipleHiLoPerTableGenerator</code>.
			</div></li><li class="listitem"><div class="para">
				<code class="code">@GeneratedValue(SEQUENCE)</code> maps to Hibernate "seqhilo".
			</div></li></ul></div><div class="para">
		For more information about these properties, go to <a href="http://www.hibernate.org/docs">http://www.hibernate.org/docs</a> and view the <a href="http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html_single/">Hibernate 4.1 Developer Guide</a>.
	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">JPA persistence properties</div>
			The following JPA properties are supported in the persistence unit definition in the <code class="filename">persistence.xml</code> file:
		</div><div class="table"><a id="table-jpa-persistence-unit-properties">
      ⁠</a><p class="title"><strong>Table 3.4. JPA Persistence Unit Properties</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols lt-7-rows" summary="JPA Persistence Unit Properties"><colgroup><col width="20%" style="text-align: left" class="c1"/><col width="20%" style="text-align: left" class="c2"/><col width="60%" style="text-align: left" class="c3"/></colgroup><thead><tr><th style="text-align: left"> Property Name </th><th style="text-align: left"> Default Value </th><th style="text-align: left"> Purpose </th></tr></thead><tbody><tr><td style="text-align: left"> <code class="code">jboss.as.jpa.providerModule</code> </td><td style="text-align: left"> <code class="classname">org.hibernate</code> </td><td style="text-align: left"> <div class="para">
						The name of the persistence provider module.
					</div>
					 <div class="para">
						The value should be <code class="literal">hibernate3-bundled</code> if Hibernate 3 JARs are in the application archive.
					</div>
					 <div class="para">
						If a persistence provider is packaged with the application, this value should be <code class="literal">application</code>.
					</div>
					 </td></tr><tr><td style="text-align: left"> <code class="code">jboss.as.jpa.adapterModule</code> </td><td style="text-align: left"> <code class="classname">org.jboss.as.jpa.hibernate:4</code> </td><td style="text-align: left"> <div class="para">
						The name of the integration classes that help JBoss EAP 6 to work with the persistence provider.
					</div>
					 <div class="para">
						Current valid values are: 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									<code class="classname">org.jboss.as.jpa.hibernate:4</code>: This is for the Hibernate 4 integration classes
								</div></li><li class="listitem"><div class="para">
									<code class="classname">org.jboss.as.jpa.hibernate:3</code>: This is for the Hibernate 3 integration classes
								</div></li></ul></div>

					</div>
					 </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+8323-591831+%5BLatest%5D&amp;comment=Title%3A+Persistence+Unit+Properties%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=8323-591831+23+Feb+2014+16%3A55+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Update_Your_Hibernate_3_Application_to_Use_Hibernate_41">
      ⁠</a>3.2.2.4. Update Your Hibernate 3 Application to Use Hibernate 4</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			When you update your application to use Hibernate 4, some updates are general and apply regardless of version of Hibernate currently used by the application. For other updates, you must determine which version the application currently uses.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819300554544">
      ⁠</a><p class="title"><strong>Procedure 3.15. Update the application to use Hibernate 4</strong></p><ol class="1"><li class="step"><div class="para">
				The default behavior of autoincrement sequence generator has changed in JBoss EAP 6. For more information, refer  <a class="xref" href="chap-Migrate_Your_Application.html#Preserve_the_Existing_Behavior_of_the_Hibernate_Identity_Auto_Generated_Value1">Section 3.2.2.5, “Preserve the Existing Behavior of the Hibernate Identity Auto Generated Value”</a>.
			</div></li><li class="step"><div class="para">
				Determine the version of Hibernate currently used by the application and choose the correct update procedure below.
			</div><ul class="stepalternatives">
				<li class="step"><div class="para">
						 <a class="xref" href="chap-Migrate_Your_Application.html#Migrate_Your_Hibernate_33x_Application_to_Hibernate_4x">Section 3.2.2.6, “Migrate Your Hibernate 3.3.x Application to Hibernate 4.x”</a>
					</div></li>
				 <li class="step"><div class="para">
						 <a class="xref" href="chap-Migrate_Your_Application.html#Migrate_Your_Hibernate_3.5.x_Application_to_Hibernate_4.x">Section 3.2.2.7, “Migrate Your Hibernate 3.5.x Application to Hibernate 4.x”</a>
					</div></li>

			</ul></li><li class="step"><div class="para">
				Refer  <a class="xref" href="chap-Migrate_Your_Application.html#Modify_Persistence_Properties_for_Migrated_Seam_and_Hibernate_Applications_that_Run_in_a_Clustered_Environment">Section 3.2.2.8, “Modify Persistence Properties for Migrated Seam and Hibernate Applications that Run in a Clustered Environment”</a> if you plan to run your application in a clustered environment.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4944-760078+%5BLatest%5D&amp;comment=Title%3A+Update+Your+Hibernate+3+Application+to+Use+Hibernate+4%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4944-760078+01+Jun+2015+04%3A19+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Preserve_the_Existing_Behavior_of_the_Hibernate_Identity_Auto_Generated_Value1">
      ⁠</a>3.2.2.5. Preserve the Existing Behavior of the Hibernate Identity Auto Generated Value</h3></div></div></div><div class="para">
		Hibernate 3.5 introduced a core property named <code class="code">hibernate.id.new_generator_mappings</code> that directs how identity or sequence columns are generated when using <code class="code">@GeneratedValue</code>. In JBoss EAP 6, the default value for this property is set as follows:
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				When you deploy a native Hibernate application, the default value is <code class="literal">false</code>.
			</div></li><li class="listitem"><div class="para">
				When you deploy a JPA application, the default value is <code class="literal">true</code>.
			</div></li></ul></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Guidelines for New Applications</div>
			New applications that use the <code class="code">@GeneratedValue</code> annotation should set the value for the <code class="code">hibernate.id.new_generator_mappings</code> property to <code class="literal">true</code>. This is the preferred setting because it is more portable across different databases. In most cases it is more efficient and, in some cases, it addresses compatibility with the JPA 2 specification.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				For new JPA applications, JBoss EAP 6 defaults the <code class="code">hibernate.id.new_generator_mappings</code> property to <code class="literal">true</code> and it should not be changed.
			</div></li><li class="listitem"><div class="para">
				For new native Hibernate applications, JBoss EAP 6 defaults the <code class="code">hibernate.id.new_generator_mappings</code> property to <code class="literal">false</code>. You should set this property to <code class="literal">true</code>.
			</div></li></ul></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Guidelines for Existing JBoss EAP 5 Applications</div>
			Existing applications that use the <code class="code">@GeneratedValue</code> annotation should make sure that the same generator is used to create primary key values for new entities when the application is migrated to JBoss EAP 6.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				For existing JPA applications, JBoss EAP 6 defaults the <code class="code">hibernate.id.new_generator_mappings</code> property to <code class="literal">true</code>. You should set this property to <code class="literal">false</code> in the <code class="filename">persistence.xml</code> file.
			</div></li><li class="listitem"><div class="para">
				For existing native Hibernate applications, JBoss EAP 6 defaults the <code class="code">hibernate.id.new_generator_mappings</code> to <code class="literal">false</code> and it should not be changed.
			</div></li></ul></div><div class="para">
		For more information about these property settings, refer  <a class="xref" href="chap-Migrate_Your_Application.html#Persistence_Unit_Properties">Section 3.2.2.3, “Persistence Unit Properties”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+7880-760079+%5BLatest%5D&amp;comment=Title%3A+Preserve+the+Existing+Behavior+of+the+Hibernate+Identity+Auto+Generated+Value%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7880-760079+01+Jun+2015+04%3A20+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Migrate_Your_Hibernate_33x_Application_to_Hibernate_4x">
      ⁠</a>3.2.2.6. Migrate Your Hibernate 3.3.x Application to Hibernate 4.x</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><ol class="1"><li class="step"><div class="para">
				Hibernate <code class="literal">text</code> types are now mapped to <code class="literal">JDBC LONGVARCHAR</code>
			</div><div class="para">
				In versions of Hibernate prior to 3.5, <code class="literal">text</code> type was mapped to <code class="literal">JDBC CLOB</code>. A new Hibernate type, <code class="literal">materialized_clob</code>, was added in Hibernate 4 to map Java <code class="literal">String</code> properties to <code class="literal">JDBC CLOB</code>. If your application has properties configured as <code class="code">type="text"</code> that are intended to be mapped to <code class="literal">JDBC CLOB</code>, you must do one of the following:
			</div><ol class="substeps a"><li class="step"><div class="para">
						If your application uses hbm mapping files, change the property to <code class="code">type="materialized_clob"</code>.
					</div></li><li class="step"><div class="para">
						If your application uses annotations, you should replace <code class="code">@Type(type = "text")</code> with <code class="code">@Lob</code>.
					</div></li></ol></li><li class="step"><div class="para">
				Review code to find changes in returned value types
			</div><div class="para">
				Numeric aggregate criteria projections now return the same value type as their HQL counterparts. As a result, the return types from the following projections in <code class="code">org.hibernate.criterion</code> have changed.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Due to changes in <code class="code">CountProjection</code>, <code class="code">Projections.rowCount()</code>, <code class="code">Projections.count(propertyName)</code>, and <code class="code">Projections.countDistinct(propertyName)</code>, the <code class="literal">count</code> and <code class="literal">count distinct</code> projections now return a <code class="literal">Long</code> value.
					</div></li><li class="step"><div class="para">
						Due to changes in <code class="code">Projections.sum(propertyName)</code>, the <code class="literal">sum</code> projections now return a value type that depends on the property type. 
						<div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
								Failure to modify your application code could result in a <code class="code">java.lang.ClassCastException</code>.
							</div></div></div>

					</div><ol class="substeps i"><li class="step"><div class="para">
								For properties mapped as Long, Short, Integer, or primitive integer types, a Long value is returned;
							</div></li><li class="step"><div class="para">
								For properties mapped as Float, Double, or primitive floating point types, a Double value is returned.
							</div></li></ol></li></ol></li><li class="step"><div class="para">
				Update the <code class="classname">UserType</code> signatures for the <code class="code">nullSafeGet()</code> and <code class="code">nullSafeSet()</code> methods.
			</div><div class="para">
				The signatures for the <code class="code">nullSafeGet()</code> and <code class="code">nullSafeSet()</code> methods in the <code class="classname">UserType</code> class changed in Hibernate 4. Any application code that uses these methods must be updated to use the new signatures.
			</div><div class="para">
				The following is an example of the method signatures in Hibernate 3.x. 
<pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> Object <span xmlns="" class="perl_Function">nullSafeGet</span>(ResultSet rs, String[] names, Object owner) 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">throws</span> HibernateException, SQLException;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">nullSafeSet</span>(PreparedStatement st, Object value, <span xmlns="" class="perl_DataType">int</span> index) 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">throws</span> HibernateException, SQLException;</pre>
				 The following is an example of the new method signatures in Hibernate 4. 
<pre class="programlisting JAVA"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> Object <span xmlns="" class="perl_Function">nullSafeGet</span>(ResultSet rs, String[] names, SessionImplementor session, Object owner) 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">throws</span> HibernateException, SQLException;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">nullSafeSet</span>(PreparedStatement st, Object value, <span xmlns="" class="perl_DataType">int</span> index, SessionImplementor session) 
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">throws</span> HibernateException, SQLException;</pre>

			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+5130-766856+%5BLatest%5D&amp;comment=Title%3A+Migrate+Your+Hibernate+3.3.x+Application+to+Hibernate+4.x%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5130-766856+05+Aug+2015+11%3A07+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Migrate_Your_Hibernate_3.5.x_Application_to_Hibernate_4.x">
      ⁠</a>3.2.2.7. Migrate Your Hibernate 3.5.x Application to Hibernate 4.x</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><ol class="1"><li class="step"><div class="para">
				AnnotationConfiguration was merged into Configuration
			</div><div class="para">
				Although <code class="filename">AnnotationConfiguration</code> is now deprecated, it should not affect your migration.
			</div><ol class="substeps a"><li class="step"><div class="para">
						If you are still using an <code class="filename">hbm.xml</code> file, you should be aware that JBoss EAP 6 now uses the <code class="code">org.hibernate.cfg.EJB3NamingStrategy</code> in <code class="filename">AnnotationConfiguration</code> instead of the <code class="code">org.hibernate.cfg.DefaultNamingStrategy</code> that was used in previous releases. This can result in naming mismatches.
					</div></li><li class="step"><div class="para">
						If you rely on the naming strategy to default the name of an association (many-to-many and collections of elements) table, you may see this issue. To resolve it, you can tell Hibernate to use the legacy <code class="code">org.hibernate.cfg.DefaultNamingStrategy</code> by calling <code class="code">Configuration#setNamingStrategy</code> and passing it <code class="code">org.hibernate.cfg.DefaultNamingStrategy#INSTANCE</code>.
					</div></li></ol></li><li class="step"><div class="para">
				Modify the namespaces to conform to the new Hibernate DTD file names as noted in the following table.
			</div><div class="para">
				<div class="table"><a id="idm139819301487296">
      ⁠</a><p class="title"><strong>Table 3.5. DTD Namespace Mapping Table</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="DTD Namespace Mapping Table"><colgroup><col width="50%" style="text-align: left" class="c1"/><col width="50%" style="text-align: left" class="c2"/></colgroup><thead><tr><th style="text-align: left"> Previous DTD Namespace </th><th style="text-align: left"> New DTD Namespace </th></tr></thead><tbody><tr><td style="text-align: left"> http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd </td><td style="text-align: left"> http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd </td></tr><tr><td style="text-align: left"> http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd </td><td style="text-align: left"> http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd </td></tr></tbody></table></div></div>

			</div></li><li class="step"><div class="para">
				Modify environment variables.
			</div><ol class="substeps a"><li class="step"><div class="para">
						If you are using Oracle and using the <code class="literal">materialized_clob</code> or <code class="literal">materialized_blob</code> properties, the global environment variable <code class="varname"> hibernate.jdbc.use_streams_for_binary</code> must be set to true.
					</div></li><li class="step"><div class="para">
						If you are using PostgreSQL and using the <code class="literal">CLOB</code> or <code class="literal">BLOB</code> properties, the global environment variable <code class="varname"> hibernate.jdbc.use_streams_for_binary</code> must be set to false.
					</div></li></ol></li><li class="step"><div class="para">
				Update the <code class="classname">UserType</code> signatures for the <code class="code">nullSafeGet()</code> and <code class="code">nullSafeSet()</code> methods.
			</div><div class="para">
				The signatures for the <code class="code">nullSafeGet()</code> and <code class="code">nullSafeSet()</code> methods in the <code class="classname">UserType</code> class changed in Hibernate 4. Any application code that uses these methods must be updated to use the new signatures. See <a class="xref" href="chap-Migrate_Your_Application.html#Migrate_Your_Hibernate_33x_Application_to_Hibernate_4x">Section 3.2.2.6, “Migrate Your Hibernate 3.3.x Application to Hibernate 4.x”</a> for details.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+5131-766857+%5BLatest%5D&amp;comment=Title%3A+Migrate+Your+Hibernate+3.5.x+Application+to+Hibernate+4.x%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5131-766857+05+Aug+2015+11%3A08+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Modify_Persistence_Properties_for_Migrated_Seam_and_Hibernate_Applications_that_Run_in_a_Clustered_Environment">
      ⁠</a>3.2.2.8. Modify Persistence Properties for Migrated Seam and Hibernate Applications that Run in a Clustered Environment</h3></div></div></div><div class="para">
		If you migrate a JPA container-managed application, the properties that influence serialization of extended persistence contexts are automatically passed to the container.
	</div><div class="para">
		However, due to changes in Hibernate, you may run into serialization issues if you run your migrated Seam or Hibernate application in a clustered environment. You may see error log messages similar to the following: 
<pre class="programlisting">
javax.ejb.EJBTransactionRolledbackException: JBAS010361: Failed to deserialize 
....
Caused by: java.io.InvalidObjectException: could not resolve session factory during session deserialization [uuid=8aa29e74373ce3a301373ce3a44b0000, name=null]
</pre>
		 To resolve these errors, you need to modify properties in the configuration file. In most cases this is the <code class="filename">persistence.xml</code> file. For native Hibernate API applications, this is the <code class="filename">hibernate.cfg.xml</code> file.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819316008704">
      ⁠</a><p class="title"><strong>Procedure 3.16. Set persistence properties to run in a clustered environment</strong></p><ol class="1"><li class="step"><div class="para">
				Set the <code class="code">hibernate.session_factory_name</code> value to a unique name. This name must be unique across all application deployments on the JBoss EAP 6 instance. For example:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernate.session_factory_name"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"jboss-seam-booking.ear_session_factory"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre></li><li class="step"><div class="para">
				Set the <code class="code">hibernate.ejb.entitymanager_factory_name</code> value to a unique name. This name must be unique across all application deployments on the JBoss EAP 6 instance. For example:
			</div><pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernate.ejb.entitymanager_factory_name"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"seam-booking.ear_PersistenceUnitName"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre></li></ol></div><div class="para">
		For more information about the Hibernate JPA Persistence Unit Property settings, see  <a class="xref" href="chap-Migrate_Your_Application.html#Persistence_Unit_Properties">Section 3.2.2.3, “Persistence Unit Properties”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+8831-591850+%5BLatest%5D&amp;comment=Title%3A+Modify+Persistence+Properties+for+Migrated+Seam+and+Hibernate+Applications+that+Run+in+a+Clustered+Environment%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=8831-591850+23+Feb+2014+16%3A55+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Update_Your_Application_to_Conform_to_the_JPA_20_Specification">
      ⁠</a>3.2.2.9. Update Your Application to Conform to the JPA 2.0 Specification</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			The JPA 2.0 specification requires that a persistence context cannot be propagated outside of a JTA transaction. If your application uses only transaction-scoped persistence contexts, the behavior is the same in JBoss EAP 6 as it was in previous versions of the application server and no changes are required. However, if your application uses an extended persistence context (XPC) to allow queuing or batching of data modifications, you may need to make changes to your application.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Persistence context propagation behavior</div>
			If your application has a stateful session bean, <code class="varname"> Bean1</code>, that uses an extended persistence context, and it calls a stateless session bean, <code class="varname"> Bean2</code>, that uses a transaction-scoped persistence context, you can expect the following behavior to occur: 
			<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						If <code class="varname"> Bean1</code> starts a JTA transaction and makes the <code class="varname"> Bean2</code> method invocation with the JTA transaction active, the behavior in JBoss EAP 6 is the same as previous releases and no change is necessary.
					</div></li><li class="listitem"><div class="para">
						If <code class="varname"> Bean1</code> does not start a JTA transaction and makes the <code class="varname"> Bean2</code> method invocation, JBoss EAP 6 does not propagate the extended persistence context into <code class="varname"> Bean2</code>. This behavior is different than in previous releases which did propagate the extended persistence context into <code class="varname"> Bean2</code>. If your application expects the extended persistence context to be propagated to the bean with the transactional entity manager, you need to change your application to do the invocation within an active JTA transaction.
					</div></li></ul></div>

		</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+5235-606463+%5BLatest%5D&amp;comment=Title%3A+Update+Your+Application+to+Conform+to+the+JPA+2.0+Specification%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5235-606463+26+Feb+2014+14%3A37+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Replace_JPAHibernate_Second_Level_Cache_with_Infinispan">
      ⁠</a>3.2.2.10. Replace JPA/Hibernate Second Level Cache with Infinispan</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			JBoss Cache has been replaced by Infinispan for second-level cache (2LC). This requires a change to the <code class="filename">persistence.xml</code> file. The syntax is slightly different, depending on if you are using JPA or Hibernate second level cache. These examples assume you are using Hibernate.
		</div><div class="para">
		This is an example of how properties for second level cache were specified in the <code class="filename">persistence.xml</code> file in JBoss EAP 5.x. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernate.cache.region.factory_class"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">     value=</span><span xmlns="" class="perl_String">"org.hibernate.cache.jbc2.JndiMultiplexedJBossCacheRegionFactory"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernate.cache.region.jbc2.cachefactory"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"java:CacheManager"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernate.cache.use_second_level_cache"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernate.cache.region.jbc2.cfg.entity"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"mvcc-entity"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernate.cache.region_prefix"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"services"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre>
		 The following steps will use this example to configure Infinispan in JBoss EAP 6.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819293421680">
      ⁠</a><p class="title"><strong>Procedure 3.17. Modify the <code class="filename">persistence.xml</code> file to use Infinispan</strong></p><ol class="1"><li class="step"><div class="para">
				Configure Infinispan for a JPA application in JBoss EAP 6
			</div><div class="para">
				This is an example of how properties to achieve the same configuration for a JPA application using Infinispan in JBoss EAP 6 can be specified: 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernate.cache.use_second_level_cache"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre>
				 In addition, you need to specify a <code class="code">shared-cache-mode</code> with a value of <code class="literal">ENABLE_SELECTIVE</code> or <code class="literal">ALL</code> as follows:
			</div><ul class="stepalternatives">
				<li class="step"><div class="para">
						<code class="literal">ENABLE_SELECTIVE</code> is the default and recommended value. It means entities are not cached unless you explicitly mark them as cacheable. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;shared-cache-mode&gt;</span>ENABLE_SELECTIVE<span xmlns="" class="perl_Keyword">&lt;/shared-cache-mode&gt;</span>
</pre>

					</div></li>
				 <li class="step"><div class="para">
						<code class="literal">ALL</code> means entities are always cached even if you mark them as not cacheable. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;shared-cache-mode&gt;</span>ALL<span xmlns="" class="perl_Keyword">&lt;/shared-cache-mode&gt;</span>
</pre>

					</div></li>

			</ul></li><li class="step"><div class="para">
				Configure Infinispan for a native Hibernate application in JBoss EAP 6
			</div><div class="para">
				This is an example of how the same configuration for a native Hibernate application using Infinispan with JBoss EAP 6 can be specified: 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernate.cache.region.factory_class"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">     value=</span><span xmlns="" class="perl_String">"org.jboss.as.jpa.hibernate4.infinispan.InfinispanRegionFactory"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernate.cache.infinispan.cachemanager"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">     value=</span><span xmlns="" class="perl_String">"java:jboss/infinispan/container/hibernate"</span><span xmlns="" class="perl_Keyword">/&gt;</span>     
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernate.transaction.jta.platform"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">     value=</span><span xmlns="" class="perl_String">"org.hibernate.service.jta.platform.internal.JBossAppServerJtaPlatform"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"hibernate.cache.use_second_level_cache"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>
</pre>
				 You must also add the following dependencies to the <code class="filename">MANIFEST.MF</code> file: 
<pre class="programlisting">
Manifest-Version: 1.0
Dependencies: org.infinispan, org.hibernate
</pre>

			</div></li></ol></div><div class="para">
		For more information about Hibernate cache properties, see:  <a class="xref" href="chap-Migrate_Your_Application.html#Hibernate_Cache_Properties">Section 3.2.2.11, “Hibernate Cache Properties”</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4591-781516+%5BLatest%5D&amp;comment=Title%3A+Replace+JPA%2FHibernate+Second+Level+Cache+with+Infinispan%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4591-781516+15+Sep+2017+15%3A11+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Hibernate_Cache_Properties">
      ⁠</a>3.2.2.11. Hibernate Cache Properties</h3></div></div></div><div class="table"><a id="idm139819306354128">
      ⁠</a><p class="title"><strong>Table 3.6. Properties</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-7-rows" summary="Properties"><colgroup><col width="50%" class="c1"/><col width="50%" class="c2"/></colgroup><thead><tr><th> Property Name </th><th> Description </th></tr></thead><tbody><tr><td> <code class="literal">hibernate.cache.region.factory_class</code> </td><td> <div class="para">
						The classname of a custom <code class="literal">CacheProvider</code>.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.cache.use_minimal_puts</code> </td><td> <div class="para">
						Boolean. Optimizes second-level cache operation to minimize writes, at the cost of more frequent reads. This setting is most useful for clustered caches and, in Hibernate3, is enabled by default for clustered cache implementations.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.cache.use_query_cache</code> </td><td> <div class="para">
						Boolean. Enables the query cache. Individual queries still have to be set cacheable.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.cache.use_second_level_cache</code> </td><td> <div class="para">
						Boolean. Used to completely disable the second level cache, which is enabled by default for classes that specify a <code class="literal">&lt;cache&gt;</code> mapping.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.cache.query_cache_factory</code> </td><td> <div class="para">
						The classname of a custom <code class="literal">QueryCache</code> interface. The default value is the built-in <code class="literal">StandardQueryCache</code>.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.cache.region_prefix</code> </td><td> <div class="para">
						A prefix to use for second-level cache region names.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.cache.use_structured_entries</code> </td><td> <div class="para">
						Boolean. Forces Hibernate to store data in the second-level cache in a more human-friendly format.
					</div>
					 </td></tr><tr><td> <code class="literal">hibernate.cache.default_cache_concurrency_strategy</code> </td><td> <div class="para">
						Setting used to give the name of the default <code class="classname">org.hibernate.annotations.CacheConcurrencyStrategy</code> to use when either <code class="classname">@Cacheable</code> or <code class="classname">@Cache</code> is used. <code class="code">@Cache(strategy="..")</code> is used to override this default.
					</div>
					 </td></tr></tbody></table></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+7449-606745+%5BLatest%5D&amp;comment=Title%3A+Hibernate+Cache+Properties%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=7449-606745+27+Feb+2014+12%3A41+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Migrate_to_Hibernate_Validator_41">
      ⁠</a>3.2.2.12. Migrate to Hibernate Validator 4</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			Hibernate Validator 4.x is a completely new code base that implements <a href="http://jcp.org/en/jsr/detail?id=303">JSR 303 - Bean Validation</a>. The migration process from Validator 3.x to 4.x is fairly straightforward, but there are a few changes you must make when you migrate your application.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819303777680">
      ⁠</a><p class="title"><strong>Procedure 3.18. You may need to perform one or more of the following tasks</strong></p><ol class="1"><li class="step"><div class="para">
				Access the default ValidatorFactory
			</div><div class="para">
				JBoss EAP 6 binds a default ValidatorFactory to the JNDI context under the name <code class="code">java:comp/ValidatorFactory</code>.
			</div></li><li class="step"><div class="para">
				Understand life cycle triggered validation
			</div><div class="para">
				When used in combination with Hibernate Core 4, life-cycle based validation is automatically enabled by Hibernate Core.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Validation occurs on entity <code class="literal">INSERT</code>, <code class="literal">UPDATE</code>, and <code class="literal">DELETE</code> operations.
					</div></li><li class="step"><div class="para">
						You can configure the groups to be validated by event type using the following properties: 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									<code class="code">javax.persistence.validation.group.pre-persist</code>,
								</div></li><li class="listitem"><div class="para">
									<code class="code">javax.persistence.validation.group.pre-update</code>, and
								</div></li><li class="listitem"><div class="para">
									<code class="code">javax.persistence.validation.group.pre-remove</code>.
								</div></li></ul></div>
						 The values of these properties are the comma-separated, fully qualified class names of the groups to validate.
					</div><div class="para">
						Validation groups are a new feature of the Bean Validation specification. If you do not want to take advantage of this new feature, no changes are required when you migrate to Hibernate Validator 4.
					</div></li><li class="step"><div class="para">
						You can disable life-cycle based validation by setting the <code class="code">javax.persistence.validation.mode</code> property to <code class="code">none</code>. Other valid values for this property are <code class="code">auto</code> (the default), <code class="code">callback</code> and <code class="code">ddl</code>.
					</div></li></ol></li><li class="step"><div class="para">
				Configure your application to use manual validation
			</div><div class="para">

			</div><ol class="substeps a"><li class="step"><div class="para">
						To manually control validation, you can create a Validator in either of the following ways: 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									Create a <code class="classname">Validator</code> instance from the <code class="classname">ValidatorFactory</code> using the <code class="code">getValidator()</code> method.
								</div></li><li class="listitem"><div class="para">
									Inject Validator instances in your EJB, CDI bean or any other Java EE injectable resource.
								</div></li></ul></div>

					</div></li><li class="step"><div class="para">
						You can use the <code class="classname">ValidatorContext</code> returned by the <code class="code">ValidatorFactory.usingContext()</code> to customize your Validator instance. Using this API you can configure a custom <code class="classname">MessageInterpolator</code>, <code class="classname">TraverableResolver</code> and <code class="classname">ConstraintValidatorFactory</code>. These interfaces are specified in the Bean Validation specification and are new to Hibernate Validator 4.
					</div></li></ol></li><li class="step"><div class="para">
				Modify code to use the new Bean Validation constraints
			</div><div class="para">
				The new Bean level validation constraints require code changes when you migrate to Hibernate Validator 4.
			</div><ol class="substeps a"><li class="step"><div class="para">
						To upgrade to Hibernate Validator 4, you must use the constraints in the following packages: 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									<code class="code">javax.validation.constraints</code>
								</div></li><li class="listitem"><div class="para">
									<code class="code">org.hibernate.validator.constraints</code>
								</div></li></ul></div>

					</div></li><li class="step"><div class="para">
						All constraints that existed in Hibernate Validator 3 are still available in Hibernate Validator 4. To use them, you need to import the specified class, and in some cases, change the name or type of the constraint parameter.
					</div></li></ol></li><li class="step"><div class="para">
				Use custom constraints
			</div><div class="para">
				In Hibernate Validator 3, a custom constraint needed to implement the <code class="classname">org.hibernate.validator.Validator</code> interface. In Hibernate Validator 4, you need to implement the <code class="classname">javax.validation.ConstraintValidator</code> interface. This interface contains the same <code class="code">initialize()</code> and <code class="code">isValid()</code> methods as the previous interface, however, the method signature has changed. In addition, <code class="literal">DDL</code> alteration is no longer supported in Hibernate Validator 4.
			</div></li><li class="step"><div class="para">
				The following Hibernate 3.x <code class="classname">Validator</code> classes are obsolete.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Replace <code class="classname">org.hibernate.validator.NotNull</code> with <code class="classname">javax.validation.constraints.NotNull</code>.
					</div></li><li class="step"><div class="para">
						Replace <code class="classname">org.hibernate.validator.ClassValidator</code> with <code class="classname">javax.validation.Validator.</code>.
					</div></li><li class="step"><div class="para">
						Replace <code class="classname">org.hibernate.validator.InvalidValue</code> with <code class="classname">javax.validation.Validator.</code>.
					</div></li></ol><div class="para">
				For more information, see the <a href="http://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/">Hibernate Valitator Reference Guide</a>.
			</div></li><li class="step"><div class="para">
				The <code class="filename">jboss-ejb3-ext-api-<em class="replaceable">VERSION</em>.jar</code> file removed many of the annotation extension APIs because they are no longer needed in JBoss EAP 6. For example, the <code class="classname">org.jboss.ejb3.annotation.IgnoreDependency</code> class is no longer available or needed because JBoss EAP 6 handles the interdependencies automatically.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4422-766859+%5BLatest%5D&amp;comment=Title%3A+Migrate+to+Hibernate+Validator+4%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4422-766859+05+Aug+2015+11%3A13+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-JTS_and_JTA_Changes">
      ⁠</a>3.2.3. JTS and JTA Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Migrate_JBoss_Transaction_Service_Configurations">
      ⁠</a>3.2.3.1. Migrate JBoss Transaction Service Configurations</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			In previous versions of JBoss EAP, the JBoss Transaction Service transaction manager was configured in one of the following XML files: 
			<div class="table"><a id="table-weblogic--applicationmapping">
      ⁠</a><p class="title"><strong>Table 3.7. JBossTS Configuration Files</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols lt-7-rows" summary="JBossTS Configuration Files"><colgroup><col width="20%" style="text-align: left" class="c1"/><col width="80%" style="text-align: left" class="c2"/></colgroup><thead><tr><th style="text-align: left"> JBoss EAP Version </th><th style="text-align: left"> Configuration File Name </th></tr></thead><tbody><tr><td style="text-align: left"> <div class="para">
								4.2
							</div>
							 </td><td style="text-align: left"> <div class="para">
								jboss-eap-4.2.0/server/default/conf/jbossjta-properties.xml
							</div>
							 </td></tr><tr><td style="text-align: left"> <div class="para">
								4.3
							</div>
							 </td><td style="text-align: left"> <div class="para">
								jboss-eap-4.3.0/server/default/conf/jbossjta-properties.xml
							</div>
							 </td></tr><tr><td style="text-align: left"> <div class="para">
								5.2
							</div>
							 </td><td style="text-align: left"> <div class="para">
								jboss-eap-5.2.0/server/default/conf/jbossts-properties.xml
							</div>
							 </td></tr></tbody></table></div></div>

		</div><div class="para">
		In JBoss EAP 6, transaction services are configured in the server configuration file. 
		<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					JBoss EAP 6 includes a default value for the node identifier, which is fine when running a single instance of the JBoss EAP server, but must be modified when running multiple instances of the server.
				</div></li><li class="listitem"><div class="para">
					JBoss EAP 6 ships with JTA transactions enabled by default. Additional steps are needed to configure JTS transactions.
				</div></li></ul></div>

	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Migrate Node Identifier Settings for JTA Transactions</div>
			JBoss EAP 6 ships with a default value setting for the node identifier. This is fine when running a single instance of the JBoss EAP server, but because the node identifier must be unique across all JBoss EAP server instances, the value must be modified when running multiple instances of the server. 
			<div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The following examples use the replaceable value <em class="replaceable">UNIQUE_NODE_ID</em> and <em class="replaceable">UNIQUE_JACORB_ID</em> to represent the unique node and JacORB IDs. Be sure to replace it with an identifier value that is unique across all JBoss EAP server instances.
				</div></div></div>

		</div><div class="para">
		In JBoss EAP 5, the node identifier was set in the <code class="filename">jbossts-properties.xml</code> file using the following property. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"com.arjuna.ats.arjuna.xa.nodeIdentifier"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_Error">UNIQUE_NODE_ID/&gt;</span></pre>

	</div><div class="para">
		In JBoss EAP 6, the node identifier is configured in the <code class="literal">transaction</code> subsystem of the server configuration file using Management CLI commands. The commands you use depend on whether you are running a managed domain or a standalone server.
	</div><div class="para">
		The following is an example of the commands to configure the node identifier for a standalone server. 
<pre class="screen">/system-property=jboss.tx.node.id:add(value=UNIQUE_NODE_ID)
/subsystem=transactions:write-attribute(name=node-identifier,value="${jboss.tx.node.id}")
reload
</pre>

	</div><div class="para">
		The following is an example of how to configure the node identifier for a managed domain. When running in a managed domain, repeat the following commands with a unique identifier for every host and server in the domain. 
<pre class="screen">/host=master/server-config=server-one/system-property=jboss.tx.node.id:add(boot-time=true,value=UNIQUE_NODE_ID)
/profile=PROFILE_NAME/subsystem=transactions:write-attribute(name=node-identifier,value="${jboss.tx.node.id}")
reload
</pre>

	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Changes to Enable JTS Transactions in JBoss EAP 6</div>
			In JBoss EAP 5, you enabled JTS transactions by running an Ant script located in the <code class="filename"><em class="replaceable">EAP5_HOME</em>/docs/examples/transactions</code> directory and then performed some manual steps. The script updated the <code class="filename">jbossts-properties.xml</code> and <code class="filename">jacorb.properties</code> files for all JBoss EAP server configurations.
		</div><div class="para">
		JBoss EAP 6, you uniquely identify JBoss EAP and JacORB instances using the Management CLI. The commands you use depend on whether you are running a managed domain or a standalone server.
	</div><div class="para">
		The following is an example of the script that identifies JBoss EAP and JacORB instances for standalone server. 
<pre class="screen">batch
			
# Create a system property for the unique node identifier

/system-property=jboss.tx.node.id:add(value=UNIQUE_NODE_ID) 
/system-property=jacorb.node.id:add(value=UNIQUE_JACORB_ID)

# JacORB properties must be unique for each JBoss server instance
# JacORB name must appear in JacORB context root i.e. ${jacorb.name}/Naming/root

/subsystem=jacorb:write-attribute(name=transactions,value="on")
/subsystem=jacorb:write-attribute(name="name",value="${jacorb.node.id}")
/subsystem=jacorb:write-attribute(name="root-context",value="${jacorb.node.id}/Naming/root")

/subsystem=transactions:write-attribute(name=jts,value=true)
/subsystem=transactions:write-attribute(name=node-identifier,value="${jboss.tx.node.id}")

run-batch

reload
</pre>

	</div><div class="para">
		The following is an example of the script that identifies JBoss EAP and JacORB instances in a managed domain. When running in a managed domain, you must execute the following script for each profile in the configuration. 
<pre class="screen">batch

#
# Define global system properties for the node identifier and JacORB implementation name. 
#
/system-property=jboss.tx.node.id/:add(value="11",boot-time="true")
/system-property=jacorb.node.id:add(value="mars",boot-time="true")

/profile=PROFILE_NAME/subsystem=jacorb:write-attribute(name="security",value="on")
/profile=PROFILE_NAME/subsystem=jacorb:write-attribute(name="transactions",value="on")
/profile=PROFILE_NAME/subsystem=jacorb:write-attribute(name="name",value="${jacorb.node.id}")
/profile=PROFILE_NAME/subsystem=jacorb:write-attribute(name="root-context",value="${jacorb.node.id}/Naming/root")

/profile=PROFILE_NAME/subsystem=transactions:write-attribute(name="jts",value="true")
/profile=PROFILE_NAME/subsystem=transactions:write-attribute(name="node-identifier",value="${jboss.tx.node.id:1}")

run-batch

reload --host=master
</pre>

	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44603-778585+%5BLatest%5D&amp;comment=Title%3A+Migrate+JBoss+Transaction+Service+Configurations%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44603-778585+11+Jul+2016+15%3A25+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-JSF_changes">
      ⁠</a>3.2.4. JSF changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Enable_Applications_To_Use_Older_Versions_of_JSF">
      ⁠</a>3.2.4.1. Enable Applications To Use Older Versions of JSF</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			If your application uses an older version of JSF, you do not need to upgrade to JSF 2.0. Instead, you can create a <code class="filename">jboss-deployment-structure.xml</code> file to request that JBoss EAP 6 use JSF 1.2 rather than JSF 2.0 with your application deployment. This JBoss specific deployment descriptor is used to control class loading and is placed in the <code class="filename">META-INF/</code> or <code class="filename">WEB-INF/</code> directory of your WAR, or in the <code class="filename">META-INF/</code> directory of your EAR.
		</div><div class="para">
		The following is an example of a <code class="filename">jboss-deployment-structure.xml</code> file that adds a dependency for the JSF 1.2 module and excludes or prevents the automatic loading of the JSF 2.0 module. 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-deployment-structure</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:deployment-structure:1.0"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;deployment&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;dependencies&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.faces.api"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"1.2"</span><span xmlns="" class="perl_Others"> export=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"com.sun.jsf-impl"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"1.2"</span><span xmlns="" class="perl_Others"> export=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/dependencies&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/deployment&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;sub-deployment</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jboss-seam-booking.war"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;exclusions&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.faces.api"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"main"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"com.sun.jsf-impl"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"main"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/exclusions&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;dependencies&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.faces.api"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"1.2"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"com.sun.jsf-impl"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"1.2"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/dependencies&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/sub-deployment&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-deployment-structure&gt;</span>
</pre>

	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+12398-592020+%5BLatest%5D&amp;comment=Title%3A+Enable+Applications+To+Use+Older+Versions+of+JSF%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=12398-592020+23+Feb+2014+16%3A56+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Cache_Changes">
      ⁠</a>3.2.5. Cache Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Replace_JBoss_Cache">
      ⁠</a>3.2.5.1. Replace JBoss Cache</h3></div></div></div><div class="para">
		In previous versions of JBoss EAP, JBoss Cache provided the underlying distributed cache support for the internal needs of the server. It also provided caching for JBoss EAP applications.
	</div><div class="para">
		In JBoss EAP 6, JBoss Cache was replaced by Infinispan for internal use by the server only. These internal caches control session replication, stateful session bean replication, and JPA-Hibernate second-level cache, and are configured in the <code class="literal">infinispan</code> subsystem of the server configuration file. They should not be used directly by any application and are not supported for this purpose.
	</div><div class="para">
		Applications that previously used JBoss Cache must migrate the code to use Red Hat JBoss Data Grid. This is the supported solution and requires a separate entitlement. JBoss Data Grid is available in two usage modes.
	</div><div class="para">
		<div class="variablelist"><dl class="variablelist"><dt><span class="term">Remote Client-Server</span></dt><dd><div class="para">
						This mode provides a managed, distributed and clusterable data grid server. Applications can remotely access the data grid server using Hot Rod, memcached or REST client APIs.
					</div></dd><dt><span class="term">Library</span></dt><dd><div class="para">
						This mode allows the user to build and deploy a custom runtime environment. The Library usage mode hosts a single data grid node in the applications process, with remote access to nodes hosted in other JVMs.
					</div></dd></dl></div>

	</div><div class="para">
		For more information about JBoss Data Grid, see the <em class="citetitle">Getting Started Guide</em> for <em class="citetitle">Red Hat JBoss Data Grid</em> located on the Customer Portal at <a href="https://access.redhat.com/documentation/en-US/Red_Hat_JBoss_Data_Grid/">https://access.redhat.com/documentation/en-US/Red_Hat_JBoss_Data_Grid/</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44601-765696+%5BLatest%5D&amp;comment=Title%3A+Replace+JBoss+Cache%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44601-765696+22+Jul+2015+09%3A11+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Web_Services_Changes">
      ⁠</a>3.2.6. Web Services Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Web_Services_Changes">
      ⁠</a>3.2.6.1. Web Services Changes</h3></div></div></div><div class="para">
		JBoss EAP 6 includes support for deploying JAX-WS Web Service endpoints. This support is provided by JBossWS. For more information about Web Services, see the chapter entitled <em class="citetitle">JAX-WS Web Services</em> in the <em class="citetitle">Development Guide</em> for JBoss EAP 6 on <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
	</div><div class="para">
		JBossWS 4 includes the following changes that may impact your migration.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">JBossWS API Changes</span></dt><dd><div class="para">
					SPI and Common components were refactored in JBossWS 4. The following table lists API and packaging changes may affect your application migration.
				</div><div class="para">
					<div class="table"><a id="jboss-ws-api-mapping-table">
      ⁠</a><p class="title"><strong>Table 3.8. JBossWS API Changes</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="gt-4-cols gt-7-rows" summary="JBossWS API Changes"><colgroup><col width="17%" style="text-align: left" class="c1"/><col width="33%" style="text-align: left" class="c2"/><col width="17%" style="text-align: left" class="c3"/><col width="33%" style="text-align: left" class="c4"/></colgroup><thead><tr><th style="text-align: left"> Old JAR </th><th style="text-align: left"> Old Package </th><th style="text-align: left"> New JAR </th><th style="text-align: left"> New Package </th></tr></thead><tbody><tr><td style="text-align: left"> JBossWS SPI </td><td style="text-align: left"> org.jboss.wsf.spi.annotation.* </td><td style="text-align: left"> JBossWS API </td><td style="text-align: left"> org.jboss.ws.api.annotation.* </td></tr><tr><td style="text-align: left"> JBossWS SPI </td><td style="text-align: left"> org.jboss.wsf.spi.binding.* </td><td style="text-align: left"> JBossWS API </td><td style="text-align: left"> org.jboss.ws.api.binding.* </td></tr><tr><td style="text-align: left"> JBossWS SPI </td><td style="text-align: left"> org.jboss.wsf.spi.management.recording.* </td><td style="text-align: left"> JBossWS API </td><td style="text-align: left"> org.jboss.ws.api.monitoring.* </td></tr><tr><td style="text-align: left"> JBossWS SPI </td><td style="text-align: left"> org.jboss.wsf.spi.tools.* </td><td style="text-align: left"> JBossWS API </td><td style="text-align: left"> org.jboss.ws.api.tools.* </td></tr><tr><td style="text-align: left"> JBossWS SPI </td><td style="text-align: left"> org.jboss.wsf.spi.tools.ant.* </td><td style="text-align: left"> JBossWS API </td><td style="text-align: left"> org.jboss.ws.tools.ant.* </td></tr><tr><td style="text-align: left"> JBossWS SPI </td><td style="text-align: left"> org.jboss.wsf.spi.tools.cmd.* </td><td style="text-align: left"> JBossWS API </td><td style="text-align: left"> org.jboss.ws.tools.cmd.* </td></tr><tr><td style="text-align: left"> JBossWS SPI </td><td style="text-align: left"> org.jboss.wsf.spi.util.ServiceLoader </td><td style="text-align: left"> JBossWS API </td><td style="text-align: left"> org.jboss.ws.api.util.ServiceLoader </td></tr><tr><td style="text-align: left"> JBossWS Common </td><td style="text-align: left"> org.jboss.wsf.common.* </td><td style="text-align: left"> JBossWS API </td><td style="text-align: left"> org.jboss.ws.common.* </td></tr><tr><td style="text-align: left"> JBossWS Common </td><td style="text-align: left"> org.jboss.wsf.common.handler.* </td><td style="text-align: left"> JBossWS API </td><td style="text-align: left"> org.jboss.ws.api.handler.* </td></tr><tr><td style="text-align: left"> JBossWS Common </td><td style="text-align: left"> org.jboss.wsf.common.addressing.* </td><td style="text-align: left"> JBossWS API </td><td style="text-align: left"> org.jboss.ws.api.addressing.* </td></tr><tr><td style="text-align: left"> JBossWS Common </td><td style="text-align: left"> org.jboss.wsf.common.DOMUtils </td><td style="text-align: left"> JBossWS API </td><td style="text-align: left"> org.jboss.ws.api.util.DOMUtils </td></tr><tr><td style="text-align: left"> JBossWS Native </td><td style="text-align: left"> org.jboss.ws.annotation.EndpointConfig </td><td style="text-align: left"> JBossWS API </td><td style="text-align: left"> org.jboss.ws.api.annotation.EndpointConfig </td></tr><tr><td style="text-align: left"> JBossWS Framework </td><td style="text-align: left"> org.jboss.wsf.framework.invocation.RecordingServerHandler </td><td style="text-align: left"> JBossWS Common </td><td style="text-align: left"> org.jboss.ws.common.invocation.RecordingServerHandler </td></tr></tbody></table></div></div>

				</div></dd><dt><span class="term">@WebContext Annotation</span></dt><dd><div class="para">
					In JBossWS 3.4.x, this annotation was packaged as <code class="code">org.jboss.wsf.spi.annotation.WebContext</code> in the JBossWS SPI JAR. In JBossWS 4.0, this annotation was moved to <code class="code">org.jboss.ws.api.annotation.WebContext</code> in the JBossWS API JAR. If your application includes the obsolete dependency, you must replace the imports and dependencies in your application source code and compile it against the new JBossWS API JAR.
				</div><div class="para">
					There is also a change to an attribute that is not backward compatible. The <code class="code">String[] virtualHosts</code> attribute has been changed to <code class="code">String virtualHost</code>. In JBoss EAP 6, you can specify only one virtual host per deployment. If multiple webservices use the <code class="code">@WebContext</code> annotation, the virtualHost value must be identical for all endpoints defined in the deployment archive.
				</div></dd><dt><span class="term">Endpoint Configuration</span></dt><dd><div class="para">
					JBossWS 4.0 provides integration of the JBoss Web Services stack with most of the Apache CXF modules. The integration layer allows the use of standard webservices APIs, including JAX-WS. It also allows the use of Apache CFX advanced features on top of the JBoss EAP 6 container without requiring complex configuration or setup.
				</div><div class="para">
					The <code class="literal">webservice</code> subsystem in the domain configuration of JBoss EAP 6 includes predefined endpoint configurations. You can also define your own additional endpoint configurations. The <code class="code">@org.jboss.ws.api.annotation.EndpointConfig</code> annotation is used to reference a given endpoint configuration.
				</div><div class="para">
					For more information on how to configure webservice endpoints in the JBoss server, see the chapter entitled <em class="citetitle">JAX-WS Web Services</em> in the Development Guide for JBoss EAP 6 on <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
				</div></dd><dt><span class="term">jboss-webservices.xml Deployment Descriptor</span></dt><dd><div class="para">
					JBossWS 4.0 introduces a new deployment descriptor to configure web services. The <code class="filename">jboss-webservices.xml</code> file provides additional information for the given deployment and partially replaces the obsolete <code class="filename">jboss.xml</code> file.
				</div><div class="para">
					For EJB webservice deployments, the expected location of the <code class="filename">jboss-webservices.xml</code> descriptor file is in the <code class="filename">META-INF/</code> directory. For POJO and EJB webservice endpoints bundled in WAR file, the expected location of the <code class="filename">jboss-webservices.xml</code> file is in the <code class="filename">WEB-INF/</code> directory.
				</div><div class="para">
					The following is an example of a <code class="filename">jboss-webservices.xml</code> descriptor file and a table describing the elements. 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;webservices&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;context-root&gt;</span>foo<span xmlns="" class="perl_Keyword">&lt;context-root&gt;</span>    
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;config-name&gt;</span>Standard WSSecurity Endpoint<span xmlns="" class="perl_Keyword">&lt;/config-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;config-file&gt;</span>META-INF/custom.xml<span xmlns="" class="perl_Keyword">&lt;/config-file&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;name&gt;</span>prop.name<span xmlns="" class="perl_Keyword">&lt;/name&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;value&gt;</span>prop.value<span xmlns="" class="perl_Keyword">&lt;/value&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/property&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;port-component&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>TestService<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;port-component-name&gt;</span>TestServicePort<span xmlns="" class="perl_Keyword">&lt;/port-component-name&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;port-component-uri&gt;</span>/*<span xmlns="" class="perl_Keyword">&lt;/port-component-uri&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;auth-method&gt;</span>BASIC<span xmlns="" class="perl_Keyword">&lt;/auth-method&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;transport-guarantee&gt;</span>NONE<span xmlns="" class="perl_Keyword">&lt;/transport-guarantee&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;secure-wsdl-access&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/secure-wsdl-access&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/port-component&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;webservice-description&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;webservice-description-name&gt;</span>TestService<span xmlns="" class="perl_Keyword">&lt;/webservice-description-name&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;wsdl-publish-location&gt;</span>file:///bar/foo.wsdl<span xmlns="" class="perl_Keyword">&lt;/wsdl-publish-location&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/webservice-description&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/webservices&gt;</span>
</pre>
					 <div class="table"><a id="table-jboss-service-xml">
      ⁠</a><p class="title"><strong>Table 3.9. jboss-webservice.xml File Element Description</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols lt-7-rows" summary="jboss-webservice.xml File Element Description"><colgroup><col width="33%" style="text-align: left" class="c1"/><col width="67%" style="text-align: left" class="c2"/></colgroup><thead><tr><th style="text-align: left"> Element Name </th><th style="text-align: left"> Description </th></tr></thead><tbody><tr><td style="text-align: left"> <div class="para">
										context-root
									</div>
									 </td><td style="text-align: left"> <div class="para">
										Used to customize the context root of the webservices deployment.
									</div>
									 </td></tr><tr><td style="text-align: left"> <div class="para">
										config-name
									</div>
									 <div class="para">
										config-file
									</div>
									 </td><td style="text-align: left"> <div class="para">
										Used to associate an endpoint deployment with a given endpoint configuration. Endpoint configurations are specified in the referenced configuration file or in the <code class="literal">webservices</code> subsystem of the domain configuration.
									</div>
									 </td></tr><tr><td style="text-align: left"> <div class="para">
										property
									</div>
									 </td><td style="text-align: left"> <div class="para">
										Used to set up simple property name value pairs to configure the webservice stack behavior.
									</div>
									 </td></tr><tr><td style="text-align: left"> <div class="para">
										port-component
									</div>
									 </td><td style="text-align: left"> <div class="para">
										Used to customize the EJB endpoint target URI or to configure security related properties.
									</div>
									 </td></tr><tr><td style="text-align: left"> <div class="para">
										webservice-description
									</div>
									 </td><td style="text-align: left"> <div class="para">
										Used to customize or override the webservice WSDL published location.
									</div>
									 </td></tr></tbody></table></div></div>

				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+14386-781550+%5BLatest%5D&amp;comment=Title%3A+Web+Services+Changes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=14386-781550+13+Nov+2017+13%3A13+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Use_Apache_Axis_in_JBoss_EAP_6">
      ⁠</a>3.2.6.2. Use Apache Axis in JBoss EAP 6</h3></div></div></div><div class="para">

	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			It is recommended that you use JBossWS Apache CXF, which is bundled with JBoss EAP 6, for developing and deploying Web Service applications. The JBossWS Apache CXF that ships with JBoss EAP 6 is the supported configuration. If you prefer to use Axis, this topic describes how to use it in JBoss EAP 6. Be aware that this implementation is considered part of your application and is not a supported configuration.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819263130576">
      ⁠</a><p class="title"><strong>Procedure 3.19. Configure JBoss EAP to Use Axis</strong></p><ol class="1"><li class="step"><div class="para">
				You must first disable the web services implementation that ships with JBoss EAP 6. For detailed instructions, see  <a class="xref" href="chap-Migrate_Your_Application.html#Disable_JBossWS_in_JBoss_EAP_6">Section 3.2.6.3, “Disable JBossWS in JBoss EAP 6”</a>.
			</div></li><li class="step"><div class="para">
				Rebuild and deploy the application. The Axis WS API implementation should now access the Java EE 6 API classes correctly.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44645-766328+%5BLatest%5D&amp;comment=Title%3A+Use+Apache+Axis+in+JBoss+EAP+6%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44645-766328+29+Jul+2015+12%3A02+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Disable_JBossWS_in_JBoss_EAP_6">
      ⁠</a>3.2.6.3. Disable JBossWS in JBoss EAP 6</h3></div></div></div><div class="para">

	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			The Java Enterprise Edition Specification (Java EE) 6 requires that application servers provide an integrated JAX-WS implementation for developing and deploying Web Service applications. Applications that migrate from other containers, such as Servlet containers that do not provide support for JAX-WS, may be packaged with their own JAX-WS implementations. If you do not deploy anything that uses JBossWS CXF and plan to package your own JAX-WS implementation, you can disable the <code class="literal">webservices</code> subsystem in JBoss EAP 6. Be aware that the JBossWS Apache CXF that ships with JBoss EAP 6 is the supported configuration. Any other implementation is considered part of your application and is not a supported configuration.
		</div><div class="para">
		This topic describes how to disable JBossWS for a single deployment and for all deployments to the server.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819256951232">
      ⁠</a><p class="title"><strong>Procedure 3.20. Disable JBossWS for a Single Deployment</strong></p><ol class="1"><li class="step"><div class="para">
				Create a <code class="filename">jboss-deployment-structure.xml</code> file for your application.
			</div><ul class="stepalternatives">
				<li class="step"><div class="para">
						If your application is packaged and deployed as a WAR, create the <code class="filename">jboss-deployment-structure.xml</code> file in either the <code class="filename">META-INF/</code> or the <code class="filename">WEB-INF/</code> directory of the WAR with the following contents. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-deployment-structure</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:deployment-structure:1.2"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;deployment&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- Exclude webservices subsystem so the implicit dependencies will not be added --&gt;</span>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;exclude-subsystems&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"webservices"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/exclude-subsystems&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/deployment&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-deployment-structure&gt;</span></pre>

					</div></li>
				 <li class="step"><div class="para">
						If your application is packaged and deployed in an EAR, create the <code class="filename">jboss-deployment-structure.xml</code> file in the <code class="filename">META-INF/</code> directory of the EAR with contents similar to the following example. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-deployment-structure</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:deployment-structure:1.2"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;sub-deployment</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"example.war"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- Exclude webservices subsystem so the implicit dependencies will not be added --&gt;</span>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;exclude-subsystems&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"webservices"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/exclude-subsystems&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;dependencies&gt;</span>
<span xmlns="" class="line">​</span>       ...
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/dependencies&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/sub-deployment&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-deployment-structure&gt;</span>
</pre>

					</div></li>

			</ul></li><li class="step"><div class="para">
				Deploy the application in the usual manner. JBossWS is now disabled for the application.
			</div></li></ol></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819307705312">
      ⁠</a><p class="title"><strong>Procedure 3.21. Disable JBossWS for All Deployments to the Server</strong></p><ol class="1"><li class="step"><div class="para">
				Stop the JBoss EAP server.
			</div></li><li class="step"><div class="para">
				Open the server configuration file for editing. For a standalone server, this is the <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/configuration/standalone.xml</code> file. For a managed domain, this is the <code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/domain.xml</code> file.
			</div></li><li class="step"><div class="para">
				Find the <code class="literal">org.jboss.as.webservices</code> extension and either comment it out or remove it.
			</div></li><li class="step"><div class="para">
				Find the <code class="literal">webservices</code> subsystem profile and either comment it out or remove it.
			</div></li><li class="step"><div class="para">
				The following is an example of the changes maded to a <code class="filename">standalone.xml</code> file. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version='1.0' encoding='UTF-8'<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;server</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:1.7"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;extensions&gt;</span>
<span xmlns="" class="line">​</span>       ...
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- &lt;extension module="org.jboss.as.webservices"/&gt; --&gt;</span>
<span xmlns="" class="line">​</span>       ...
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/extensions&gt;</span>
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;profile&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!--</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    &lt;subsystem xmlns="urn:jboss:domain:webservices:1.2"&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">      &lt;modify-wsdl-address&gt;true&lt;/modify-wsdl-address&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">      &lt;wsdl-host&gt;${jboss.bind.address:127.0.0.1}&lt;/wsdl-host&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">      &lt;endpoint-config name="Standard-Endpoint-Config"/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">      &lt;endpoint-config name="Recording-Endpoint-Config"&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">        &lt;pre-handler-chain name="recording-handlers" protocol-bindings="##SOAP11_HTTP ##SOAP11_HTTP_MTOM ##SOAP12_HTTP ##SOAP12_HTTP_MTOM"&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">	       &lt;handler name="RecordingHandler" class="org.jboss.ws.common.invocation.RecordingServerHandler"/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">        &lt;/pre-handler-chain&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">      &lt;/endpoint-config&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    	&lt;client-config name="Standard-Client-Config"/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">  	&lt;/subsystem&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">    --&gt;</span>
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/profile&gt;</span>
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/server&gt;</span></pre>

			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44647-766330+%5BLatest%5D&amp;comment=Title%3A+Disable+JBossWS+in+JBoss+EAP+6%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44647-766330+29+Jul+2015+12%3A24+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-JAX-RS_and_RESTEasy_Changes">
      ⁠</a>3.2.7. JAX-RS and RESTEasy Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_JAX-RS_and_RESTEasy_Changes1">
      ⁠</a>3.2.7.1. Configure JAX-RS and RESTEasy Changes</h3></div></div></div><div class="para">
		JBoss EAP 6 automatically sets up RESTEasy, so you do not need to configure it yourself. Therefore, you should remove all of the existing RESTEasy configuration from your <code class="filename">web.xml</code> file and replace it with one of the following three options:
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="orderedlist"><ol><li class="listitem"><div class="para">
				Subclass <code class="code">javax.ws.rs.core.Application</code> and use the <code class="code">@ApplicationPath</code> annotation.
			</div><div class="para">
				This is the easiest option and does not require any xml configuration. Simply subclass <code class="code">javax.ws.rs.core.Application</code> in your application and annotate it with the path where you want to make your JAX-RS classes available. For example:
			</div><div class="para">
				
<pre class="programlisting JAVA"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">ApplicationPath</span>(<span xmlns="" class="perl_String">"/mypath"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> MyApplication <span xmlns="" class="perl_Keyword">extends</span> Application {
<span xmlns="" class="line">​</span>}
</pre>

			</div><div class="para">
				In the above example, your JAX-RS resources are available in the path <code class="filename">/<em class="replaceable">MY_WEB_APP_CONTEXT</em>/mypath/</code>.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Note the path should be specified as <code class="filename">/mypath</code>, not <code class="filename">/mypath/*</code>. There should be no trailing forward-slash or asterisk.
				</div></div></div></li><li class="listitem"><div class="para">
				Subclass <code class="code">javax.ws.rs.core.Application</code> and use the <code class="filename">web.xml</code> file to set up the JAX-RS mapping.
			</div><div class="para">
				If you do not wish to use the <code class="code">@ApplicationPath</code> annotation, you still need to subclass <code class="code">javax.ws.rs.core.Application</code>. You then set up the JAX-RS mapping in the <code class="filename">web.xml</code> file. For example:
			</div><div class="para">
				
<pre class="programlisting JAVA"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> MyApplication <span xmlns="" class="perl_Keyword">extends</span> Application {
<span xmlns="" class="line">​</span>}
</pre>

			</div><div class="para">
				
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;servlet-mapping&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>com.acme.MyApplication<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;url-pattern&gt;</span>/hello/*<span xmlns="" class="perl_Keyword">&lt;/url-pattern&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/servlet-mapping&gt;</span></pre>

			</div><div class="para">
				In the above example, your JAX-RS resources are available in the path <code class="filename">/<em class="replaceable">MY_WEB_APP_CONTEXT</em>/hello</code>.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					You can also use this approach to override an application path that was set using the <code class="code">@ApplicationPath</code> annotation.
				</div></div></div></li><li class="listitem"><div class="para">
				Modify the <code class="filename">web.xml</code> file.
			</div><div class="para">
				If you do not want to subclass <code class="code">Application</code>, you can set up the JAX-RS mapping in the <code class="filename">web.xml</code> file as follows:
			</div><div class="para">
				
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;servlet-mapping&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;servlet-name&gt;</span>javax.ws.rs.core.Application<span xmlns="" class="perl_Keyword">&lt;/servlet-name&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;url-pattern&gt;</span>/hello/*<span xmlns="" class="perl_Keyword">&lt;/url-pattern&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/servlet-mapping&gt;</span></pre>

			</div><div class="para">
				In the above example, your JAX-RS resources are available in the path <code class="filename">/<em class="replaceable">MY_WEB_APP_CONTEXT</em>/hello</code>.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					When you choose this option, you only need to add the mapping. You do not need to add the corresponding servlet. The server is responsible for adding the corresponding servlet automatically.
				</div></div></div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4613-603769+%5BLatest%5D&amp;comment=Title%3A+Configure+JAX-RS+and+RESTEasy+Changes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4613-603769+25+Feb+2014+17%3A27+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-LDAP_Security_Realm_Changes">
      ⁠</a>3.2.8. LDAP Security Realm Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_LDAP_Security_Realm_Changes1">
      ⁠</a>3.2.8.1. Configure LDAP Security Realm Changes</h3></div></div></div><div class="para">
		In JBoss EAP 5, the LDAP security realm was configured in an <code class="code">&lt;application-policy&gt;</code> element in the <code class="filename">login-config.xml</code> file. In JBoss EAP 6, the LDAP security realm is configured in the <code class="code">&lt;security-domain&gt;</code> element in the server configuration file. For a standalone server, this is the <code class="filename">standalone/configuration/standalone.xml</code> file. If you are running your server in a managed domain, this is the <code class="filename">domain/configuration/domain.xml</code> file.
	</div><div class="para">
		The following is an example of LDAP security realm configuration in the <code class="filename">login-config.xml</code> file in JBoss EAP 5: 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;application-policy</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"mcp_ldap_domain"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;authentication&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;login-module</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.security.auth.spi.LdapExtLoginModule"</span><span xmlns="" class="perl_Others"> flag=</span><span xmlns="" class="perl_String">"required"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"java.naming.factory.initial"</span><span xmlns="" class="perl_Keyword">&gt;</span>com.sun.jndi.ldap.LdapCtxFactory<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"java.naming.security.authentication"</span><span xmlns="" class="perl_Keyword">&gt;</span>simple<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span>
<span xmlns="" class="line">​</span>      ....
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/login-module&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/authentication&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/application-policy&gt;</span></pre>

	</div><div class="para">
		This is an example of the LDAP configuration in the server configuration file in JBoss EAP 6: 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:security:1.2"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;security-domains&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;security-domain</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"mcp_ldap_domain"</span><span xmlns="" class="perl_Others"> cache-type=</span><span xmlns="" class="perl_String">"default"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;authentication&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;login-module</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.security.auth.spi.LdapLoginModule"</span><span xmlns="" class="perl_Others"> flag=</span><span xmlns="" class="perl_String">"required"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"java.naming.factory.initial"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"com.sun.jndi.ldap.LdapCtxFactory"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"java.naming.security.authentication"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"simple"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>          ...
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/login-module&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/authentication&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/security-domain&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/security-domains&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/subsystem&gt;</span></pre>

	</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			The XML parser changed in JBoss EAP 6. In JBoss EAP 5, you specified the module options as element content like this: 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"java.naming.factory.initial"</span><span xmlns="" class="perl_Keyword">&gt;</span>com.sun.jndi.ldap.LdapCtxFactory<span xmlns="" class="perl_Keyword">&lt;/module-option&gt;</span></pre>
			 Now, the module options must be specified as element attributes with "value=" as follows: 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;module-option</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"java.naming.factory.initial"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"com.sun.jndi.ldap.LdapCtxFactory"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre>

		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+5241-631728+%5BLatest%5D&amp;comment=Title%3A+Configure+LDAP+Security+Realm+Changes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5241-631728+15+Apr+2014+13%3A43+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-HornetQ_Changes">
      ⁠</a>3.2.9. HornetQ Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="About_HornetQ_and_NFS">
      ⁠</a>3.2.9.1. About HornetQ and NFS</h3></div></div></div><div class="para">
		In most cases, NFS is not an appropriate method of storing JMS data for use with HornetQ, when using NIO as the journal type, due to the way the synchronous locking mechanism works. However, NFS can be used in certain circumstances, only on Red Hat Enterprise Linux servers. This is due to the NFS implementation used by Red Hat Enterprise Linux.
	</div><div class="para">
		The Red Hat Enterprise Linux NFS implementation supports both direct I/O (opening files with the O_DIRECT flag set), and kernel based asynchronous I/O. With both of these features present, it is possible to use NFS as a shared storage option, under strict configuration rules:
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				The Red Hat Enterprise Linux NFS client cache must be disabled.
			</div></li></ul></div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			The server log should be checked after JBoss EAP 6 is started, to ensure that the native library successfully loaded, and that the ASYNCIO journal type is being used. If the native library fails to load, HornetQ will gracefully fail to the NIO journal type, and this will be stated in the server log.
		</div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			The native library that implements asynchronous I/O requires that <code class="filename">libaio</code> is installed on the Red Hat Enterprise Linux system where JBoss EAP 6 is running.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+13603-592077+%5BLatest%5D&amp;comment=Title%3A+About+HornetQ+and+NFS%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=13603-592077+23+Feb+2014+16%3A57+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_a_JMS_Bridge_to_Migrate_Existing_JMS_Messages_to_Enterprise_Application_Platform_6">
      ⁠</a>3.2.9.2. Configure a JMS Bridge to Migrate Existing JMS Messages to JBoss EAP 6</h3></div></div></div><div class="para">
		JBoss EAP 6 replaced JBoss Messaging with HornetQ as the default JMS implementation. The easiest way to migrate JMS messages from one environment to the other is to use a JMS bridge. The function of a JMS bridge is to consume messages from a source JMS destination, and send them to a target JMS destination. You can configure and deploy a JMS bridge to a JBoss EAP 5.x server or to JBoss EAP 6.1 or later server.
	</div><div class="para">
		For details on how to migrate JMS messages from JBoss EAP 5.x to JBoss EAP 6.x, see: <a class="xref" href="chap-Migrate_Your_Application.html#Create_a_JMS_Bridge">Section 3.2.9.3, “Create a JMS Bridge”</a> 
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+9374-651545+%5BLatest%5D&amp;comment=Title%3A+Configure+a+JMS+Bridge+to+Migrate+Existing+JMS+Messages+to+JBoss+EAP+6%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9374-651545+04+Jun+2014+14%3A29+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Create_a_JMS_Bridge">
      ⁠</a>3.2.9.3. Create a JMS Bridge</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			A JMS bridge consumes messages from a source JMS queue or topic and sends them to a target JMS queue or topic, which is typically on a different server. It can be used to bridge messages between any JMS servers, as long as they are JMS 1.1 compliant. The source and destination JMS resources are looked up using JNDI and the client classes for the JNDI lookup must be bundled in a module. The module name is then declared in the JMS bridge configuration.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819310901712">
      ⁠</a><p class="title"><strong>Procedure 3.22. Create a JMS Bridge</strong></p><div class="para">
			This procedure demonstrates how to configure a JMS bridge to migrate messages from a JBoss EAP 5.x server to a JBoss EAP 6 server.
		</div><ol class="1"><li class="step"><div class="para">
				Configure the Bridge on the Source JBoss EAP 5.x Server
			</div><div class="para">
				To avoid conflicts in classes between releases, you must follow these steps to configure the JMS bridge on JBoss EAP 5.x. The names of the SAR directory and bridge are arbitrary and can be changed if you prefer.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Create a subdirectory in the JBoss EAP 5 deployment directory to contain the SAR, for example: <code class="filename"><em class="replaceable">EAP5_HOME</em>/server/<em class="replaceable">PROFILE_NAME</em>/deploy/myBridge.sar/</code>.
					</div></li><li class="step"><div class="para">
						Create a subdirectory named <code class="filename">META-INF</code> in <code class="filename"><em class="replaceable">EAP5_HOME</em>/server/<em class="replaceable">PROFILE_NAME</em>/deploy/myBridge.sar/</code>.
					</div></li><li class="step"><div class="para">
						Create a <code class="filename">jboss-service.xml</code> file in the <code class="filename"><em class="replaceable">EAP5_HOME</em>/server/<em class="replaceable">PROFILE_NAME</em>/deploy/myBridge.sar/META-INF/</code> directory. It should contain information similar to the following example.
					</div><div class="para">
						
<pre class="programlisting JAVA"><span xmlns="" class="line">​</span>&lt;server&gt;
<span xmlns="" class="line">​</span>   &lt;loader-repository&gt;
<span xmlns="" class="line">​</span>      com.<span xmlns="" class="perl_Function">example</span>:archive=unique-archive-name
<span xmlns="" class="line">​</span>      &lt;loader-repository-config&gt;java2ParentDelegation=<span xmlns="" class="perl_Keyword">false</span>&lt;/loader-repository-config&gt;
<span xmlns="" class="line">​</span>   &lt;/loader-repository&gt; 
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>   &lt;!-- JBoss EAP <span xmlns="" class="perl_Float">6</span> JMS Provider --&gt; 
<span xmlns="" class="line">​</span>   &lt;mbean code=<span xmlns="" class="perl_String">"org.jboss.jms.jndi.JMSProviderLoader"</span> name=<span xmlns="" class="perl_String">"jboss.messaging:service=JMSProviderLoader,name=EnterpriseApplicationPlatform6JMSProvider"</span>&gt;
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"ProviderName"</span>&gt;EnterpriseApplicationPlatform6JMSProvider&lt;/attribute&gt;
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"ProviderAdapterClass"</span>&gt;org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">jms</span>.<span xmlns="" class="perl_Function">jndi</span>.<span xmlns="" class="perl_Function">JNDIProviderAdapter</span>&lt;/attribute&gt;
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"FactoryRef"</span>&gt;jms/RemoteConnectionFactory&lt;/attribute&gt; 
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"QueueFactoryRef"</span>&gt;jms/RemoteConnectionFactory&lt;/attribute&gt;  
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"TopicFactoryRef"</span>&gt;jms/RemoteConnectionFactory&lt;/attribute&gt;      
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"Properties"</span>&gt;
<span xmlns="" class="line">​</span>         java.<span xmlns="" class="perl_Function">naming</span>.<span xmlns="" class="perl_Function">factory</span>.<span xmlns="" class="perl_Function">initial</span>=org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">naming</span>.<span xmlns="" class="perl_Function">remote</span>.<span xmlns="" class="perl_Function">client</span>.<span xmlns="" class="perl_Function">InitialContextFactory</span>
<span xmlns="" class="line">​</span>         java.<span xmlns="" class="perl_Function">naming</span>.<span xmlns="" class="perl_Function">provider</span>.<span xmlns="" class="perl_Function">url</span>=remote:<span xmlns="" class="perl_Comment">//EnterpriseApplicationPlatform6host:4447</span>
<span xmlns="" class="line">​</span>         java.<span xmlns="" class="perl_Function">naming</span>.<span xmlns="" class="perl_Function">security</span>.<span xmlns="" class="perl_Function">principal</span>=jbossuser
<span xmlns="" class="line">​</span>         java.<span xmlns="" class="perl_Function">naming</span>.<span xmlns="" class="perl_Function">security</span>.<span xmlns="" class="perl_Function">credentials</span>=jbosspass
<span xmlns="" class="line">​</span>      &lt;/attribute&gt;
<span xmlns="" class="line">​</span>   &lt;/mbean&gt; 
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>   &lt;mbean code=<span xmlns="" class="perl_String">"org.jboss.jms.server.bridge.BridgeService"</span> name=<span xmlns="" class="perl_String">"jboss.jms:service=Bridge,name=MyBridgeName"</span> xmbean-dd=<span xmlns="" class="perl_String">"xmdesc/Bridge-xmbean.xml"</span>&gt;      
<span xmlns="" class="line">​</span>      &lt;depends optional-attribute-name=<span xmlns="" class="perl_String">"SourceProviderLoader"</span>&gt;jboss.<span xmlns="" class="perl_Function">messaging</span>:service=JMSProviderLoader,name=JMSProvider&lt;/depends&gt;          
<span xmlns="" class="line">​</span>      &lt;depends optional-attribute-name=<span xmlns="" class="perl_String">"TargetProviderLoader"</span>&gt;jboss.<span xmlns="" class="perl_Function">messaging</span>:service=JMSProviderLoader,name=EnterpriseApplicationPlatform6JMSProvider&lt;/depends&gt;          
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"SourceDestinationLookup"</span>&gt;/queue/A&lt;/attribute&gt;      
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"TargetDestinationLookup"</span>&gt;jms/queue/test&lt;/attribute&gt;       
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"QualityOfServiceMode"</span>&gt;<span xmlns="" class="perl_Float">1</span>&lt;/attribute&gt;           
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"MaxBatchSize"</span>&gt;<span xmlns="" class="perl_Float">1</span>&lt;/attribute&gt;      
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"MaxBatchTime"</span>&gt;<span xmlns="" class="perl_DecVal">-1</span>&lt;/attribute&gt;           
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"FailureRetryInterval"</span>&gt;<span xmlns="" class="perl_Float">60000</span>&lt;/attribute&gt;      
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"MaxRetries"</span>&gt;<span xmlns="" class="perl_DecVal">-1</span>&lt;/attribute&gt;      
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"AddMessageIDInHeader"</span>&gt;<span xmlns="" class="perl_Keyword">false</span>&lt;/attribute&gt;
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"TargetUsername"</span>&gt;jbossuser&lt;/attribute&gt;
<span xmlns="" class="line">​</span>      &lt;attribute name=<span xmlns="" class="perl_String">"TargetPassword"</span>&gt;jbosspass&lt;/attribute&gt;
<span xmlns="" class="line">​</span>   &lt;/mbean&gt;
<span xmlns="" class="line">​</span>&lt;/server&gt;
<span xmlns="" class="line">​</span>
</pre>

					</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							The <code class="literal">load-repository</code> element is present to ensure the SAR has an isolated class loader. Also note both the JNDI look-up and the bridge "target" include security credentials for user "jbossuser" with password "jbosspass". This is because JBoss EAP 6 is secured by default. The user named "jbossuser" with password "jbosspass" was created in the <code class="literal">ApplicationRealm</code> with the <code class="literal">guest</code> role using the <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/add_user.sh</code> script.
						</div></div></div></li><li class="step"><div class="para">
						Copy the following JARs from the <code class="filename"><em class="replaceable">EAP_HOME</em>/modules/system/layers/base/</code> directory into the <code class="filename"><em class="replaceable">EAP5_HOME</em>/server/<em class="replaceable">PROFILE_NAME</em>/deploy/myBridge.sar/</code> directory. Replace each <em class="replaceable">VERSION_NUMBER</em> with the actual version number in your JBoss EAP 6 distribution. 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									<code class="filename">org/hornetq/main/hornetq-core-<em class="replaceable">VERSION_NUMBER</em>.jar</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">org/hornetq/main/hornetq-jms-<em class="replaceable">VERSION_NUMBER</em>.jar</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">org/jboss/ejb-client/main/jboss-ejb-client-<em class="replaceable">VERSION_NUMBER</em>.jar</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">org/jboss/logging/main/jboss-logging-<em class="replaceable">VERSION_NUMBER</em>.jar</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">org/jboss/logmanager/main/jboss-logmanager-<em class="replaceable">VERSION_NUMBER</em>.jar</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">org/jboss/marshalling/main/jboss-marshalling-<em class="replaceable">VERSION_NUMBER</em>.jar</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">org/jboss/marshalling/river/main/jboss-marshalling-river-<em class="replaceable">VERSION_NUMBER</em>.jar</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">org/jboss/remote-naming/main/jboss-remote-naming-<em class="replaceable">VERSION_NUMBER</em>.jar</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">org/jboss/remoting3/main/jboss-remoting-<em class="replaceable">VERSION_NUMBER</em>.jar</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">org/jboss/sasl/main/jboss-sasl-<em class="replaceable">VERSION_NUMBER</em>.jar</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">org/jboss/netty/main/netty-<em class="replaceable">VERSION_NUMBER</em>.jar</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">org/jboss/remoting3/remote-jmx/main/remoting-jmx-<em class="replaceable">VERSION_NUMBER</em>.jar</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">org/jboss/xnio/main/xnio-api-<em class="replaceable">VERSION_NUMBER</em>.jar</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">org/jboss/xnio/nio/main.xnio-nio-<em class="replaceable">VERSION_NUMBER</em>.jar</code>
								</div></li></ul></div>

					</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							Do not simply copy the <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/client/jboss-client.jar</code> because the javax API classes will conflict with those in JBoss EAP 5.x.
						</div></div></div></li></ol></li><li class="step"><div class="para">
				Configure the Bridge on the Destination JBoss EAP 6 Server
			</div><div class="para">
				In JBoss EAP 6.1 and later, the JMS bridge can be used to bridge messages from any JMS 1.1 compliant server. Because the source and target JMS resources are looked up using JNDI, the JNDI lookup classes of the source messaging provider, or message broker, must be bundled in a JBoss Module. The following steps use the fictitious 'MyCustomMQ' message broker as an example.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Create the JBoss module for the messaging provider.
					</div><ol class="substeps i"><li class="step"><div class="para">
								Create a directory structure under <code class="filename"><em class="replaceable">EAP_HOME</em>/modules/system/layers/base/</code> for the new module. The <code class="filename">main/</code> subdirectory will contain the client JARs and <code class="filename">module.xml</code> file. The following is an example of the directory structure created for the MyCustomMQ messaging provider: <code class="filename"><em class="replaceable">EAP_HOME</em>/modules/system/layers/base/org/mycustommq/main/</code>
							</div></li><li class="step"><div class="para">
								In the <code class="filename">main/</code> subdirectory, create a <code class="filename">module.xml</code> file containing the module definition for the messaging provider. The following is an example of the <code class="filename">module.xml</code> created for the MyCustomMQ messaging provider. 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:module:1.1"</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.mycustommq"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;properties&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jboss.api"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"private"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/properties&gt;</span> 
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;resources&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">&lt;!-- Insert resources required to connect to the source or target   --&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;resource-root</span><span xmlns="" class="perl_Others"> path=</span><span xmlns="" class="perl_String">"mycustommq-1.2.3.jar"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;resource-root</span><span xmlns="" class="perl_Others"> path=</span><span xmlns="" class="perl_String">"mylogapi-0.0.1.jar"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/resources&gt;</span> 
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;dependencies&gt;</span>
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Comment">&lt;!-- Add the dependencies required by JMS Bridge code                 --&gt;</span>
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.api"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.jms.api"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.transaction.api"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Comment">&lt;!-- Add a dependency on the org.hornetq module since we send         --&gt;</span>
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Comment">&lt;!-- messages tothe HornetQ server embedded in the local EAP instance --&gt;</span>
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.hornetq"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/dependencies&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/module&gt;</span>
</pre>

							</div></li><li class="step"><div class="para">
								Copy the messaging provider JARs required for the JNDI lookup of the source resources to the module's <code class="filename">main/</code> subdirectory. The directory structure for the MyCustomMQ module should now look like the following. 
<pre class="screen">
modules/
`-- system
    `-- layers
        `-- base
            `-- org
                  `-- mycustommq
                      `-- main
                          |-- mycustommq-1.2.3.jar
                          |-- mylogapi-0.0.1.jar
                          |-- module.xml
</pre>

							</div></li></ol></li><li class="step"><div class="para">
						Configure the JMS bridge in the <code class="literal">messaging</code> subsystem of the JBoss EAP 6 server.
					</div><ol class="substeps i"><li class="step"><div class="para">
								Before you begin, stop the server and back up the current server configuration files. If you are running a standalone server, this is the <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/configuration/standalone-full-ha.xml</code> file. If you are running a managed domain, back up both the <code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/domain.xml</code> and the <code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/host.xml</code> files.
							</div></li><li class="step"><div class="para">
								Add the <code class="literal">jms-bridge</code> element to the <code class="literal">messaging</code> subsystem in the server configuration file. The <code class="literal">source</code> and <code class="literal">target</code> elements provide the names of the JMS resources used for JNDI lookups. If <code class="literal">user</code> and <code class="literal">password</code> credentials are specified, they are passed as arguments when JMS connection is created.
							</div><div class="para">
								The following is an example of the <code class="literal">jms-bridge</code> element configured for the MyCustomMQ messaging provider: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:messaging:1.3"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   ...
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;jms-bridge</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"myBridge"</span><span xmlns="" class="perl_Others"> module=</span><span xmlns="" class="perl_String">"org.mycustommq"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;source&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;connection-factory</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ConnectionFactory"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;destination</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"sourceQ"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;user&gt;</span>user1<span xmlns="" class="perl_Keyword">&lt;/user&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;password&gt;</span>pwd1<span xmlns="" class="perl_Keyword">&lt;/password&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;context&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> key=</span><span xmlns="" class="perl_String">"java.naming.factory.initial"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"org.mycustommq.jndi.MyCustomMQInitialContextFactory"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> key=</span><span xmlns="" class="perl_String">"java.naming.provider.url"</span><span xmlns="" class="perl_Others">    value=</span><span xmlns="" class="perl_String">"tcp://127.0.0.1:9292"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;/context&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/source&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;target&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;connection-factory</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"java:/ConnectionFactory"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>         <span xmlns="" class="perl_Keyword">&lt;destination</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"/jms/targetQ"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/target&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;quality-of-service&gt;</span>DUPLICATES_OK<span xmlns="" class="perl_Keyword">&lt;/quality-of-service&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;failure-retry-interval&gt;</span>500<span xmlns="" class="perl_Keyword">&lt;/failure-retry-interval&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;max-retries&gt;</span>1<span xmlns="" class="perl_Keyword">&lt;/max-retries&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;max-batch-size&gt;</span>500<span xmlns="" class="perl_Keyword">&lt;/max-batch-size&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;max-batch-time&gt;</span>500<span xmlns="" class="perl_Keyword">&lt;/max-batch-time&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;add-messageID-in-header&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/add-messageID-in-header&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/jms-bridge&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/subsystem&gt;</span>
</pre>
								 In the above example, the JNDI properties are defined in the <code class="literal">context</code> element for the <code class="literal">source</code>. If the <code class="literal">context</code> element is omitted, as in the <code class="literal">target</code> example above, the JMS resources are looked up in the local instance.
							</div></li></ol></li></ol></li></ol></div><div class="para">

	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+34417-766860+%5BLatest%5D&amp;comment=Title%3A+Create+a+JMS+Bridge%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=34417-766860+05+Aug+2015+11%3A16+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Migrate_Your_Application_to_Use_HornetQ_as_the_JMS_Provider">
      ⁠</a>3.2.9.4. Migrate Your Application to Use HornetQ as the JMS Provider</h3></div></div></div><div class="para">
		JBoss Messaging is no longer included in JBoss EAP 6. If your application uses JBoss Messaging as the messaging provider, you need to replace the JBoss Messaging code with HornetQ.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul><li class="listitem"><div class="para">
				Shut down the client and server.
			</div></li><li class="listitem"><div class="para">
				Make a backup copy of any JBoss Messaging data. The message data is stored in a database in tables prefixed with <code class="literal">JBM_</code>.
			</div></li></ul></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819321338176">
      ⁠</a><p class="title"><strong>Procedure 3.23. Change Your Provider to HornetQ</strong></p><ol class="1"><li class="step"><div class="para">
				Transfer configurations.
			</div><div class="para">
				Transfer the existing JBoss Messaging configurations to the JBoss EAP 6 configuration. The following configurations can be found in deployment descriptors located on the JBoss Messaging server:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						Connection Factories Service Configuration
					</div><div class="para">
						This configuration describes the JMS connection factories deployed with the JBoss Messaging server. JBoss Messaging configures connection factories in a file named <code class="filename">connection-factories-service.xml</code> which is located in the deployment directory of the application server.
					</div></li><li class="listitem"><div class="para">
						Destination Configuration
					</div><div class="para">
						This configuration describes JMS queues and topics deployed with JBoss Messaging server. By default, JBoss Messaging configures destinations in a file named <code class="filename">destinations-service.xml</code> which is located in the deployment directory of the application server.
					</div></li><li class="listitem"><div class="para">
						Message Bridge Service Configuration
					</div><div class="para">
						This configuration includes bridge services deployed with JBoss Messaging server. No bridges are deployed by default so the name of the deployment file varies depending on your JBoss Messaging installation.
					</div></li></ul></div></li><li class="step"><div class="para">
				Modify your application code.
			</div><div class="para">
				If the application code uses standard JMS, no code changes are required. However, you must modify the application to use the new standardized JNDI namespaces as described in the section  <a class="xref" href="chap-Migrate_Your_Application.html#Portable_JNDI_Naming_Syntax">Section 3.1.8.2, “Portable EJB JNDI Names”</a>. If the application uses features specific to JBoss Messaging, you must modify the code to use the equivalent features available in HornetQ.
			</div><div class="para">
				The following is an example of a JMS client that creates the <code class="code">InitialContext</code> and looks up a queue in JBoss EAP 6. 
<pre class="programlisting"><span xmlns="" class="line">​</span>Hashtable&lt;String, String&gt; env = <span xmlns="" class="perl_Keyword">new</span> Hashtable&lt;String, String&gt;();
<span xmlns="" class="line">​</span>String providerUrl = <span xmlns="" class="perl_String">"remote:"</span> + host + <span xmlns="" class="perl_String">":"</span> + port;
<span xmlns="" class="line">​</span>env.<span xmlns="" class="perl_Function">put</span>(Context.<span xmlns="" class="perl_Function">URL_PKG_PREFIXES</span>, <span xmlns="" class="perl_String">"org.jboss.ejb.client.naming"</span>);
<span xmlns="" class="line">​</span>env.<span xmlns="" class="perl_Function">put</span>(<span xmlns="" class="perl_String">"java.naming.factory.initial"</span>, <span xmlns="" class="perl_String">"org.jboss.naming.remote.client.InitialContextFactory"</span>);
<span xmlns="" class="line">​</span>env.<span xmlns="" class="perl_Function">put</span>(<span xmlns="" class="perl_String">"java.naming.provider.url"</span>, providerUrl);
<span xmlns="" class="line">​</span>env.<span xmlns="" class="perl_Function">put</span>(Context.<span xmlns="" class="perl_Function">SECURITY_PRINCIPAL</span>, user);
<span xmlns="" class="line">​</span>env.<span xmlns="" class="perl_Function">put</span>(Context.<span xmlns="" class="perl_Function">SECURITY_CREDENTIALS</span>, pass);
<span xmlns="" class="line">​</span>InitialContext context = <span xmlns="" class="perl_Keyword">new</span> InitialContext(env);
<span xmlns="" class="line">​</span>Queue myTestQueue = (Queue) context.<span xmlns="" class="perl_Function">lookup</span>(<span xmlns="" class="perl_String">"jms/queue/myTestQueue"</span>);
</pre>

			</div><div class="para">
				If the application will be connecting to a cluster, you must carefully review the HornetQ documentation on clustering semantics. Clustering is outside the scope of the JMS specification and HornetQ and JBoss Messaging have taken substantially different approaches in their respective implementations of clustering functionality.
			</div><div class="para">
				For more information on how to configure messaging with HornetQ, see:  <a class="xref" href="chap-Migrate_Your_Application.html#Configure_Messaging_with_HornetQ2">Section 3.2.9.5, “Configure Messaging with HornetQ”</a>
			</div></li><li class="step"><div class="para">
				Migrate existing messages.
			</div><div class="para">
				Move any messages in the JBoss Messaging database to the HornetQ journal using a JMS bridge. Instructions for configuring the JMS bridge can be found here:  <a class="xref" href="chap-Migrate_Your_Application.html#Configure_a_JMS_Bridge_to_Migrate_Existing_JMS_Messages_to_Enterprise_Application_Platform_6">Section 3.2.9.2, “Configure a JMS Bridge to Migrate Existing JMS Messages to JBoss EAP 6”</a>.
			</div></li></ol></div><div class="para">
		For information about how to access a JMS queue from a remote client, see the chapter entitled <em class="citetitle">Remote JNDI Lookup</em> in the <em class="citetitle">Development Guide</em> for JBoss Enterprise Application Platform 6.4 located on the Customer Portal at <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
	</div><div class="para">
		For information about how to send messages from one instance of a JBoss EAP 6 server to another, see <em class="citetitle">Configuring the HornetQ JCA Adapter for Remote Connections</em> in the <em class="citetitle">Administration and Configuration Guide</em> for JBoss Enterprise Application Platform 6.4 located on the Customer Portal at <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4370-781549+%5BLatest%5D&amp;comment=Title%3A+Migrate+Your+Application+to+Use+HornetQ+as+the+JMS+Provider%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4370-781549+13+Nov+2017+13%3A08+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_Messaging_with_HornetQ2">
      ⁠</a>3.2.9.5. Configure Messaging with HornetQ</h3></div></div></div><div class="para">
		The recommended method of configuring messaging in JBoss EAP 6 is in either the Management Console or Management CLI. You can make persistent changes with either of these management tools without needing to manually edit the <code class="filename">standalone.xml</code> or <code class="filename">domain.xml</code> configuration files. It is useful however to familiarize yourself with the messaging components of the default configuration files, where documentation examples using management tools give configuration file snippets for reference.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4371-591665+%5BLatest%5D&amp;comment=Title%3A+Configure+Messaging+with+HornetQ%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4371-591665+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Migrate_JMS_Destinations">
      ⁠</a>3.2.9.6. Migrate JMS Destinations</h3></div></div></div><div class="para">
		In previous releases of JBoss EAP, JBoss Messaging JMS destinations were configured in the <code class="code">&lt;mbeans&gt;</code> element of the <code class="filename">jbossmq-destinations-service.xml</code> or <code class="filename">destinations-service.xml</code> file. Because HornetQ replaces JBoss Messaging in JBoss EAP 6, JMS destinations are now configured in the <code class="literal">messaging</code> subsystem of the server configuration file.
	</div><div class="example"><a id="idm139819315531056">
      ⁠</a><p class="title"><strong>Example 3.3. JBoss EAP 4.2 Destination Configuration Example</strong></p><div class="example-contents"><div class="para">
			The following is an example of a JBoss MQ destination configured in the <code class="filename">jbossmq-destinations-service.xml</code> file in JBoss EAP 4.2. Note that if the <code class="literal">JNDIName</code> attribute is not specified, the value defaults to the name shown in the example. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;mbean</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.mq.server.jmx.Queue"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  name=</span><span xmlns="" class="perl_String">"jboss.mq.destination:service=Queue,name=DLQ"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- The following JNDIName attribute shows the default JNDI binding name  --&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"JNDIName"</span><span xmlns="" class="perl_Keyword">&gt;</span>queue/DLQ<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;depends</span><span xmlns="" class="perl_Others"> optional-attribute-name=</span><span xmlns="" class="perl_String">"DestinationManager"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    jboss.mq:service=DestinationManager
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/depends&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/mbean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;mbean</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.mq.server.jmx.Queue"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  name=</span><span xmlns="" class="perl_String">"jboss.mq.destination:service=Queue,name=ExpiryQueue"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- The following JNDIName attribute shows the default JNDI binding name  --&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"JNDIName"</span><span xmlns="" class="perl_Keyword">&gt;</span>queue/ExpiryQueue<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;depends</span><span xmlns="" class="perl_Others"> optional-attribute-name=</span><span xmlns="" class="perl_String">"DestinationManager"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    jboss.mq:service=DestinationManager
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/depends&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/mbean&gt;</span></pre>

		</div></div></div><div class="example"><a id="idm139819327457696">
      ⁠</a><p class="title"><strong>Example 3.4. JBoss EAP 5 Destination Configuration Example</strong></p><div class="example-contents"><div class="para">
			The following is an example of a JBoss Messaging destination configured in the <code class="filename">destinations-service.xml</code> file in JBoss EAP 5. Note that if the <code class="literal">JNDIName</code> <code class="code">attribute</code> is not specified, the value defaults to the name shown in the example. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;mbean</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.jms.server.destination.QueueService"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  name=</span><span xmlns="" class="perl_String">"jboss.messaging.destination:service=Queue,name=DLQ"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmbean-dd=</span><span xmlns="" class="perl_String">"xmdesc/Queue-xmbean.xml"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- The following JNDIName attribute shows the default JNDI binding name  --&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"JNDIName"</span><span xmlns="" class="perl_Keyword">&gt;</span>queue/DLQ<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;depends</span><span xmlns="" class="perl_Others"> optional-attribute-name=</span><span xmlns="" class="perl_String">"ServerPeer"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    jboss.messaging:service=ServerPeer
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/depends&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;depends&gt;</span>
<span xmlns="" class="line">​</span>    jboss.messaging:service=PostOffice
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/depends&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/mbean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;mbean</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.jms.server.destination.QueueService"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  name=</span><span xmlns="" class="perl_String">"jboss.messaging.destination:service=Queue,name=ExpiryQueue"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  xmbean-dd=</span><span xmlns="" class="perl_String">"xmdesc/Queue-xmbean.xml"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Comment">&lt;!-- The following JNDIName attribute shows the default JNDI binding name  --&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;attribute</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"JNDIName"</span><span xmlns="" class="perl_Keyword">&gt;</span>queue/ExpiryQueue<span xmlns="" class="perl_Keyword">&lt;/attribute&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;depends</span><span xmlns="" class="perl_Others"> optional-attribute-name=</span><span xmlns="" class="perl_String">"ServerPeer"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    jboss.messaging:service=ServerPeer
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/depends&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;depends&gt;</span>
<span xmlns="" class="line">​</span>    jboss.messaging:service=PostOffice
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/depends&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/mbean&gt;</span></pre>

		</div></div></div><div class="example"><a id="idm139819261492528">
      ⁠</a><p class="title"><strong>Example 3.5. JBoss EAP 6 Destination Configuration Example</strong></p><div class="example-contents"><div class="para">
			The following is an example of a JMS destination configured in the <code class="literal">messaging</code> subsystem of the server configuration file in JBoss EAP 6. In JBoss EAP 6, the <code class="code">entry</code> element configures the name that is used to bind the queue to JNDI. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:messaging:1.4"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;hornetq-server&gt;</span>
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;jms-destinations&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;jms-queue</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ExpiryQueue"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;entry</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"java:/jms/queue/ExpiryQueue"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/jms-queue&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;jms-queue</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"DLQ"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;entry</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"java:/jms/queue/DLQ"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/jms-queue&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/jms-destinations&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/hornetq-server&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/subsystem&gt;</span></pre>

		</div><div class="para">
			For more information about how to configure destinations, see <em class="citetitle">Configure the JMS Server</em> in the <em class="citetitle">Administration and Configuration Guide</em> for JBoss Enterprise Application Platform located on the Customer Portal at <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44638-781537+%5BLatest%5D&amp;comment=Title%3A+Migrate+JMS+Destinations%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44638-781537+13+Nov+2017+12%3A31+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Clustering_Changes">
      ⁠</a>3.2.10. Clustering Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Make_Changes_to_Your_Application_for_Clustering">
      ⁠</a>3.2.10.1. Make Changes to Your Application for Clustering</h3></div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><ol class="1"><li class="step"><p class="title"><strong>Start JBoss EAP 6 with clustering enabled</strong></p><div class="para">
				To enable clustering in JBoss EAP 5.x, you needed to start your server instances using the <code class="code">all</code> profile or some derivation of it, like this:
			</div><div class="para">
				
<pre class="screen"><code class="command">$ <em class="replaceable">EAP5_HOME</em>/bin/run.sh -c all</code></pre>

			</div><div class="para">
				In JBoss EAP 6, the method for enabling clustering depends on whether the servers are standalone or running in a managed domain.
			</div><ol class="substeps a"><li class="step"><p class="title"><strong>Enable clustering for servers running in a managed domain</strong></p><div class="para">
						To enable clustering for servers started using the domain controller, update your <code class="filename">domain.xml</code> and designate a server group to use the <code class="code">ha</code> profile and <code class="code">ha-sockets</code> socket binding group. For example: 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;server-groups&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;server-group</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"main-server-group"</span><span xmlns="" class="perl_Others"> profile=</span><span xmlns="" class="perl_String">"ha"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;jvm</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"default"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;heap</span><span xmlns="" class="perl_Others"> size=</span><span xmlns="" class="perl_String">"64m"</span><span xmlns="" class="perl_Others"> max-size=</span><span xmlns="" class="perl_String">"512m"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/jvm&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;socket-binding-group</span><span xmlns="" class="perl_Others"> ref=</span><span xmlns="" class="perl_String">"ha-sockets"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/server-group&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/server-group&gt;</span></pre>

					</div></li><li class="step"><p class="title"><strong>Enable clustering for standalone servers</strong></p><div class="para">
						To enable clustering for standalone servers, start the server using the appropriate configuration file as follows: 
<pre class="screen"><code class="command">$ <em class="replaceable">EAP_HOME</em>/bin/standalone.sh --server-config=standalone-ha.xml -Djboss.node.name=<em class="replaceable">UNIQUE_NODE_NAME</em></code></pre>

					</div></li></ol></li><li class="step"><p class="title"><strong>Specify the bind address</strong></p><div class="para">
				In JBoss EAP 5.x, you would typically indicate the bind address used for clustering using the <code class="code">-b</code> command line argument like this: 
<pre class="screen"><code class="command">$ <em class="replaceable">EAP5_HOME</em>/bin/run.sh -c all -b 192.168.0.2</code></pre>

			</div><div class="para">
				JBoss EAP 6 binds sockets to the IP addresses and interfaces contained in the <code class="code">&lt;interfaces&gt;</code> elements in <code class="filename">standalone.xml</code>, <code class="filename">domain.xml</code> and <code class="filename">host.xml</code> files. The standard configurations that ship with JBoss EAP include two interface configurations: 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;interfaces&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;interface</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"management"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;inet-address</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"${jboss.bind.address.management:127.0.0.1}"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/interface&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;interface</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"public"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Keyword">&lt;inet-address</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"${jboss.bind.address:127.0.0.1}"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/interface&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/interfaces&gt;</span></pre>
				 These interface configurations use the values of the system properties <code class="code">jboss.bind.address.management</code> and <code class="code">jboss.bind.address</code>. If these system properties are not set, the default <code class="literal">127.0.0.1</code> is used for each value.
			</div><div class="para">
				You can also specify the bind address as a command line argument when you start the server or you can explicitly define it within the JBoss EAP 6 server configuration file.
			</div><ul class="stepalternatives">
				<li class="step"><div class="para">
						Specify the bind argument on the command line when you start the JBoss EAP standalone server.
					</div><div class="para">
						The following is an example of how to specify the bind address on the command line for a standalone server: 
<pre class="screen"><code class="command"><em class="replaceable">EAP_HOME</em>/bin/standalone.sh -Djboss.bind.address=127.0.0.1</code></pre>
						 <div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
								You can also use the <code class="code">-b</code> argument, which is a shortcut for <code class="code">-Djboss.bind.address=127.0.0.1</code>: 
<pre class="screen"><code class="command"><em class="replaceable">EAP_HOME</em>/bin/standalone.sh -b=127.0.0.1</code></pre>

							</div><div class="para">
								The JBoss EAP 5 syntax format is also still supported: 
<pre class="screen"><code class="command"><em class="replaceable">EAP_HOME</em>/bin/standalone.sh -b 127.0.0.1</code></pre>
								 Note that the <code class="code">-b</code> argument only changes the <code class="literal">public</code> interface. It does not affect the <code class="literal">management</code> interface.
							</div></div></div>

					</div></li>
				 <li class="step"><div class="para">
						Specify the bind address in the server configuration file.
					</div><div class="para">
						For servers running in a managed domain, specify the bind addresses in the <code class="filename">domain/configuration/host.xml</code> file. For standalone servers, specify the bind addresses in the <code class="filename">standalone-ha.xml</code> file.
					</div><div class="para">
						In the following example, the <code class="code">public</code> interface is specified as the default interface for all sockets within the <code class="code">ha-sockets</code> socket binding group. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;interfaces&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;interface</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"management"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;inet-address</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"192.168.0.2"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/interface&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;interface</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"public"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;inet-address</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"192.168.0.2"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/interface&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/interfaces&gt;</span></pre>
						 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;socket-binding-groups&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;socket-binding-group</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ha-sockets"</span><span xmlns="" class="perl_Others"> default-interface=</span><span xmlns="" class="perl_String">"public"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/socket-binding-group&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/socket-binding-groups&gt;</span></pre>
						 <div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
								If you specify the bind address as a hard-coded value rather than a system property in the configuration file, you can not override it with a command line argument.
							</div></div></div>

					</div></li>

			</ul></li><li class="step"><p class="title"><strong>Configure <code class="literal">jvmRoute</code> to support mod_jk and mod_proxy</strong></p><div class="para">
				In JBoss EAP 5, the web server <code class="literal">jvmRoute</code> was configured using a property in the <code class="filename">server.xml</code> file. In JBoss EAP 6, the <code class="literal">jvmRoute</code> attribute is configured in the web subsystem of the server configuration file using the <code class="literal">instance-id</code> attribute as follows: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:web:1.1"</span><span xmlns="" class="perl_Others"> default-virtual-server=</span><span xmlns="" class="perl_String">"default-host"</span><span xmlns="" class="perl_Others"> native=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Others"> instance-id=</span><span xmlns="" class="perl_String">"{JVM_ROUTE_SERVER}"</span><span xmlns="" class="perl_Keyword">&gt;</span>
</pre>
				 The <em class="replaceable">{JVM_ROUTE_SERVER}</em> above should be replaced by the jvmRoute server ID.
			</div><div class="para">
				The <code class="literal">instance-id</code> can also be set using the Management Console.
			</div></li><li class="step"><p class="title"><strong>Specify the multicast address and port</strong></p><div class="para">
				In JBoss EAP 5.x, you could specify the multicast address and port used for intra-cluster communication using the command line arguments <code class="code">-u</code> and <code class="code">-m</code>, respectively, like this: 
<pre class="screen"><code class="command"><em class="replaceable">$ EAP5_HOME</em>/bin/run.sh -c all -u 228.11.11.11 -m 45688</code></pre>

			</div><div class="para">
				In JBoss EAP 6, the multicast address and port used for intra-cluster communication are defined by the socket-binding referenced by the relevant JGroups protocol stack as follows: 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:jgroups:1.0"</span><span xmlns="" class="perl_Others"> default-stack=</span><span xmlns="" class="perl_String">"udp"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;stack</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"udp"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;transport</span><span xmlns="" class="perl_Others"> type=</span><span xmlns="" class="perl_String">"UDP"</span><span xmlns="" class="perl_Others"> socket-binding=</span><span xmlns="" class="perl_String">"jgroups-udp"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/stack&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/subsystem&gt;</span></pre>
				 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;socket-binding-groups&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;socket-binding-group</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ha-sockets"</span><span xmlns="" class="perl_Others"> default-interface=</span><span xmlns="" class="perl_String">"public"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;socket-binding</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jgroups-udp"</span><span xmlns="" class="perl_Others"> port=</span><span xmlns="" class="perl_String">"55200"</span><span xmlns="" class="perl_Others"> multicast-address=</span><span xmlns="" class="perl_String">"228.11.11.11"</span><span xmlns="" class="perl_Others"> multicast-port=</span><span xmlns="" class="perl_String">"45688"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/socket-binding-group&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/socket-binding-groups&gt;</span>
</pre>
				 If you prefer to specify the multicast address and port in the command line, you can define the multicast address and ports as system properties and then use those properties on the command line when you start the server. In the following example, <code class="varname"> jboss.mcast.addr</code> is the variable name for the multicast address and <code class="varname"> jboss.mcast.port</code> is the variable name for the port. 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;socket-binding</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jgroups-udp"</span><span xmlns="" class="perl_Others"> port=</span><span xmlns="" class="perl_String">"55200"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others"> multicast-address=</span><span xmlns="" class="perl_String">"${jboss.mcast.addr:230.0.0.4}"</span><span xmlns="" class="perl_Others"> multicast-port=</span><span xmlns="" class="perl_String">"${jboss.mcast.port:45688}"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre>
				 You can then start your server using the following command line arguments: 
<pre class="screen"><code class="command">$ <em class="replaceable">EAP_HOME</em>/bin/domain.sh -Djboss.mcast.addr=228.11.11.11 -Djboss.mcast.port=45688</code></pre>

			</div></li><li class="step"><p class="title"><strong>Use an alternate protocol stack</strong></p><div class="para">
				In JBoss EAP 5.x, you could manipulate the default protocol stack used for all clustering services using the <code class="code">jboss.default.jgroups.stack</code> system property. 
<pre class="screen"><code class="command">$ <em class="replaceable">EAP5_HOME</em>/bin/run.sh -c all -Djboss.default.jgroups.stack=tcp</code></pre>

			</div><div class="para">
				In JBoss EAP 6, the default protocol stack is defined by the JGroups subsystem within <code class="filename">domain.xml</code> or <code class="filename">standalone-ha.xml</code>: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:jgroups:1.0"</span><span xmlns="" class="perl_Others"> default-stack=</span><span xmlns="" class="perl_String">"udp"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;stack</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"udp"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">&lt;!-- ... --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/stack&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/subsystem&gt;</span></pre>

			</div></li><li class="step"><p class="title"><strong>Replace Buddy Replication</strong></p><div class="para">
				JBoss EAP 5.x used JBoss Cache Buddy Replication to suppress replication of data to all instances in a cluster.
			</div><div class="para">
				In JBoss EAP 6, Buddy Replication has been replaced by Infinispan's distributed cache, also known as <code class="literal">DIST</code> mode. Distribution is a powerful clustering mode which allows Infinispan to scale linearly as more servers are added to the cluster. The following is an example of how to configure the server to use the DIST caching mode.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Open a command line and start the server with either the HA or Full Profile, for example: 
<pre class="screen"><em class="replaceable">EAP_HOME</em>/bin/standalone.sh -c standalone-ha.xml</pre>

					</div></li><li class="step"><div class="para">
						Open another command line and connect to the Management CLI.
					</div><ul class="stepalternatives">
						<li class="step"><div class="para">
								For Linux, enter the following at the command line:
							</div><pre class="screen">
$ <em class="replaceable">EAP_HOME</em>/bin/jboss-cli.sh --connect
</pre></li>
						 <li class="step"><div class="para">
								For Windows, enter the following at a command line:
							</div><pre class="screen">
C:\&gt;<em class="replaceable">EAP_HOME</em>\bin\jboss-cli.bat --connect
</pre></li>

					</ul><div class="para">
						You should see the following response: 
<pre class="screen">Connected to standalone controller at localhost:9999</pre>

					</div></li><li class="step"><div class="para">
						Issue the following commands to configure the cache tell the server to reload the new configuration: 
<pre class="screen">
/subsystem=infinispan/cache-container=web/:write-attribute(name=default-cache,value=dist)
/subsystem=infinispan/cache-container=web/distributed-cache=dist/:write-attribute(name=owners,value=3)
reload
</pre>

					</div><div class="para">
						You should see the following response after each command: 
<pre class="screen">
"outcome" =&gt; "success"
</pre>

					</div><div class="para">
						These commands modify the <code class="literal">dist</code> <code class="code">&lt;distributed-cache&gt;</code> element in the <code class="literal">web</code> <code class="code">&lt;cache-container&gt;</code> configuration in the <code class="literal">infinispan</code> subsystem of the <code class="filename">standalone-ha.xml</code> file as follows: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;cache-container</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"web"</span><span xmlns="" class="perl_Others"> aliases=</span><span xmlns="" class="perl_String">"standard-session-cache"</span><span xmlns="" class="perl_Others"> default-cache=</span><span xmlns="" class="perl_String">"dist"</span><span xmlns="" class="perl_Others"> module=</span><span xmlns="" class="perl_String">"org.jboss.as.clustering.web.infinispan"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;transport</span><span xmlns="" class="perl_Others"> lock-timeout=</span><span xmlns="" class="perl_String">"60000"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;replicated-cache</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"repl"</span><span xmlns="" class="perl_Others"> mode=</span><span xmlns="" class="perl_String">"ASYNC"</span><span xmlns="" class="perl_Others"> batching=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;file-store/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/replicated-cache&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;replicated-cache</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"sso"</span><span xmlns="" class="perl_Others"> mode=</span><span xmlns="" class="perl_String">"SYNC"</span><span xmlns="" class="perl_Others"> batching=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;distributed-cache</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"dist"</span><span xmlns="" class="perl_Others"> owners=</span><span xmlns="" class="perl_String">"3"</span><span xmlns="" class="perl_Others"> l1-lifespan=</span><span xmlns="" class="perl_String">"0"</span><span xmlns="" class="perl_Others"> mode=</span><span xmlns="" class="perl_String">"ASYNC"</span><span xmlns="" class="perl_Others"> batching=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;file-store/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/distributed-cache&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/cache-container&gt;</span>
</pre>
						 For more information, see the chapter entitled <em class="citetitle">Clustering in Web Applications</em> in the <em class="citetitle">Development Guide</em> for JBoss EAP 6 located on the Customer Portal at <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
					</div></li></ol></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4948-781552+%5BLatest%5D&amp;comment=Title%3A+Make+Changes+to+Your+Application+for+Clustering%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4948-781552+13+Nov+2017+13%3A17+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Implement_an_HA_Singleton">
      ⁠</a>3.2.10.2. Implement an HA Singleton</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			The following procedure demonstrates how to deploy a service that is wrapped with the SingletonService decorator and used as a cluster-wide singleton service. The service activates a scheduled timer, which is started only once in the cluster.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819299175088">
      ⁠</a><p class="title"><strong>Procedure 3.24. Implement an HA Singleton Service</strong></p><ol class="1"><li class="step"><div class="para">
				Write the HA singleton service application.
			</div><div class="para">
				The following is a simple example of a <code class="classname">Service</code> that is wrapped with the <code class="classname">SingletonService</code> decorator to be deployed as a singleton service. A complete example can be found in the <code class="literal">cluster-ha-singleton</code> quickstart that ships with Red Hat JBoss Enterprise Application Platform 6. This quickstart contains all the instructions to build and deploy the application.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Create a service.
					</div><div class="para">
						The following listing is an example of a service: 
<pre class="programlisting JAVA"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>package org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">as</span>.<span xmlns="" class="perl_Function">quickstarts</span>.<span xmlns="" class="perl_Function">cluster</span>.<span xmlns="" class="perl_Function">hasingleton</span>.<span xmlns="" class="perl_Function">service</span>.<span xmlns="" class="perl_Function">ejb</span>;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import java.util.Date;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import java.util.concurrent.atomic.AtomicBoolean;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.naming.InitialContext;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.naming.NamingException;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.logging.Logger;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.msc.service.Service;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.msc.service.ServiceName;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.msc.service.StartContext;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.msc.service.StartException;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.msc.service.StopContext;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * </span><span xmlns="" class="perl_Keyword">@author &lt;a</span><span xmlns="" class="perl_Others"> href=</span><span xmlns="" class="perl_String">"mailto:wfink@redhat.com"</span><span xmlns="" class="perl_Keyword">&gt;</span><span xmlns="" class="perl_Comment">Wolf-Dieter Fink</span><span xmlns="" class="perl_Keyword">&lt;/a&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> HATimerService <span xmlns="" class="perl_Keyword">implements</span> Service&lt;String&gt; {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">static</span> <span xmlns="" class="perl_DataType">final</span> Logger LOGGER = Logger.<span xmlns="" class="perl_Function">getLogger</span>(HATimerService.<span xmlns="" class="perl_Function">class</span>);
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">static</span> <span xmlns="" class="perl_DataType">final</span> ServiceName SINGLETON_SERVICE_NAME = ServiceName.<span xmlns="" class="perl_Function">JBOSS</span>.<span xmlns="" class="perl_Function">append</span>(<span xmlns="" class="perl_String">"quickstart"</span>, <span xmlns="" class="perl_String">"ha"</span>, <span xmlns="" class="perl_String">"singleton"</span>, <span xmlns="" class="perl_String">"timer"</span>);
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">     * A flag whether the service is started.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">     */</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">final</span> AtomicBoolean started = <span xmlns="" class="perl_Keyword">new</span> AtomicBoolean(<span xmlns="" class="perl_Keyword">false</span>);
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">     * </span><span xmlns="" class="perl_Keyword">@return </span><span xmlns="" class="perl_Comment">the name of the server node</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">     */</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> String <span xmlns="" class="perl_Function">getValue</span>() <span xmlns="" class="perl_Keyword">throws</span> IllegalStateException, IllegalArgumentException {
<span xmlns="" class="line">​</span>        LOGGER.<span xmlns="" class="perl_Function">infof</span>(<span xmlns="" class="perl_String">"%s is %s at %s"</span>, HATimerService.<span xmlns="" class="perl_Function">class</span>.<span xmlns="" class="perl_Function">getSimpleName</span>(), (started.<span xmlns="" class="perl_Function">get</span>() ? <span xmlns="" class="perl_String">"started"</span> : <span xmlns="" class="perl_String">"not started"</span>), System.<span xmlns="" class="perl_Function">getProperty</span>(<span xmlns="" class="perl_String">"jboss.node.name"</span>));
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_String">""</span>;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">start</span>(StartContext arg0) <span xmlns="" class="perl_Keyword">throws</span> StartException {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">if</span> (!started.<span xmlns="" class="perl_Function">compareAndSet</span>(<span xmlns="" class="perl_Keyword">false</span>, <span xmlns="" class="perl_Keyword">true</span>)) {
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">throw</span> <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">StartException</span>(<span xmlns="" class="perl_String">"The service is still started!"</span>);
<span xmlns="" class="line">​</span>        }
<span xmlns="" class="line">​</span>        LOGGER.<span xmlns="" class="perl_Function">info</span>(<span xmlns="" class="perl_String">"Start HASingleton timer service '"</span> + <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">getClass</span>().<span xmlns="" class="perl_Function">getName</span>() + <span xmlns="" class="perl_String">"'"</span>);
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_DataType">final</span> String node = System.<span xmlns="" class="perl_Function">getProperty</span>(<span xmlns="" class="perl_String">"jboss.node.name"</span>);
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">try</span> {
<span xmlns="" class="line">​</span>            InitialContext ic = <span xmlns="" class="perl_Keyword">new</span> InitialContext();
<span xmlns="" class="line">​</span>            ((Scheduler) ic.<span xmlns="" class="perl_Function">lookup</span>(<span xmlns="" class="perl_String">"global/jboss-cluster-ha-singleton-service/SchedulerBean!org.jboss.as.quickstarts.cluster.hasingleton.service.ejb.Scheduler"</span>)).<span xmlns="" class="perl_Function">initialize</span>(<span xmlns="" class="perl_String">"HASingleton timer @"</span> + node + <span xmlns="" class="perl_String">" "</span> + <span xmlns="" class="perl_Keyword">new</span> Date());
<span xmlns="" class="line">​</span>        } <span xmlns="" class="perl_Keyword">catch</span> (NamingException e) {
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">throw</span> <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">StartException</span>(<span xmlns="" class="perl_String">"Could not initialize timer"</span>, e);
<span xmlns="" class="line">​</span>        }
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">stop</span>(StopContext arg0) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">if</span> (!started.<span xmlns="" class="perl_Function">compareAndSet</span>(<span xmlns="" class="perl_Keyword">true</span>, <span xmlns="" class="perl_Keyword">false</span>)) {
<span xmlns="" class="line">​</span>            LOGGER.<span xmlns="" class="perl_Function">warn</span>(<span xmlns="" class="perl_String">"The service '"</span> + <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">getClass</span>().<span xmlns="" class="perl_Function">getName</span>() + <span xmlns="" class="perl_String">"' is not active!"</span>);
<span xmlns="" class="line">​</span>        } <span xmlns="" class="perl_Keyword">else</span> {
<span xmlns="" class="line">​</span>            LOGGER.<span xmlns="" class="perl_Function">info</span>(<span xmlns="" class="perl_String">"Stop HASingleton timer service '"</span> + <span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">getClass</span>().<span xmlns="" class="perl_Function">getName</span>() + <span xmlns="" class="perl_String">"'"</span>);
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">try</span> {
<span xmlns="" class="line">​</span>                InitialContext ic = <span xmlns="" class="perl_Keyword">new</span> InitialContext();
<span xmlns="" class="line">​</span>                ((Scheduler) ic.<span xmlns="" class="perl_Function">lookup</span>(<span xmlns="" class="perl_String">"global/jboss-cluster-ha-singleton-service/SchedulerBean!org.jboss.as.quickstarts.cluster.hasingleton.service.ejb.Scheduler"</span>)).<span xmlns="" class="perl_Function">stop</span>();
<span xmlns="" class="line">​</span>            } <span xmlns="" class="perl_Keyword">catch</span> (NamingException e) {
<span xmlns="" class="line">​</span>                LOGGER.<span xmlns="" class="perl_Function">error</span>(<span xmlns="" class="perl_String">"Could not stop timer"</span>, e);
<span xmlns="" class="line">​</span>            }
<span xmlns="" class="line">​</span>        }
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
</pre>

					</div></li><li class="step"><div class="para">
						Create an activator that installs the <code class="classname">Service</code> as a clustered singleton.
					</div><div class="para">
						The following listing is an example of a Service activator that installs the <code class="classname">HATimerService</code> as a clustered singleton service: 
<pre class="programlisting JAVA"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>package org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">as</span>.<span xmlns="" class="perl_Function">quickstarts</span>.<span xmlns="" class="perl_Function">cluster</span>.<span xmlns="" class="perl_Function">hasingleton</span>.<span xmlns="" class="perl_Function">service</span>.<span xmlns="" class="perl_Function">ejb</span>;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.as.clustering.singleton.SingletonService;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.logging.Logger;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.msc.service.DelegatingServiceContainer;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.msc.service.ServiceActivator;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.msc.service.ServiceActivatorContext;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.msc.service.ServiceController;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * Service activator that installs the HATimerService as a clustered singleton service</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * during deployment.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> *</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * </span><span xmlns="" class="perl_Keyword">@author </span><span xmlns="" class="perl_Comment">Paul Ferraro</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> HATimerServiceActivator <span xmlns="" class="perl_Keyword">implements</span> ServiceActivator {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">final</span> Logger log = Logger.<span xmlns="" class="perl_Function">getLogger</span>(<span xmlns="" class="perl_Keyword">this</span>.<span xmlns="" class="perl_Function">getClass</span>());
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    @Override
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">activate</span>(ServiceActivatorContext context) {
<span xmlns="" class="line">​</span>        log.<span xmlns="" class="perl_Function">info</span>(<span xmlns="" class="perl_String">"HATimerService will be installed!"</span>);
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        HATimerService service = <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">HATimerService</span>();
<span xmlns="" class="line">​</span>        SingletonService&lt;String&gt; singleton = <span xmlns="" class="perl_Keyword">new</span> SingletonService&lt;String&gt;(service, HATimerService.<span xmlns="" class="perl_Function">SINGLETON_SERVICE_NAME</span>);
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">/*</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">         * To pass a chain of election policies to the singleton, for example, </span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">         * to tell JGroups to prefer running the singleton on a node with a</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">         * particular name, uncomment the following line:</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">         */</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">// singleton.setElectionPolicy(new PreferredSingletonElectionPolicy(new SimpleSingletonElectionPolicy(), new NamePreference("node1/singleton")));</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>        singleton.<span xmlns="" class="perl_Function">build</span>(<span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">DelegatingServiceContainer</span>(context.<span xmlns="" class="perl_Function">getServiceTarget</span>(), context.<span xmlns="" class="perl_Function">getServiceRegistry</span>()))
<span xmlns="" class="line">​</span>                .<span xmlns="" class="perl_Function">setInitialMode</span>(ServiceController.<span xmlns="" class="perl_Function">Mode</span>.<span xmlns="" class="perl_Function">ACTIVE</span>)
<span xmlns="" class="line">​</span>                .<span xmlns="" class="perl_Function">install</span>()
<span xmlns="" class="line">​</span>        ;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
</pre>
						 <div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
								The above code example uses a class, <code class="code">org.jboss.as.clustering.singleton.SingletonService</code>, that is part of the JBoss EAP private API. A public API will become available in the JBoss EAP 7 release and the private class will be deprecated, but these classes will be maintained and available for the duration of the JBoss EAP 6.x release cycle.
							</div></div></div>

					</div></li><li class="step"><div class="para">
						Create a ServiceActivator File
					</div><div class="para">
						Create a file named <code class="filename">org.jboss.msc.service.ServiceActivator</code> in the application's <code class="filename">resources/META-INF/services/</code> directory. Add a line containing the fully qualified name of the ServiceActivator class created in the previous step. 
<pre class="screen"><code class="code">org.jboss.as.quickstarts.cluster.hasingleton.service.ejb.HATimerServiceActivator </code></pre>

					</div></li><li class="step"><div class="para">
						Create a Singleton bean that implements a timer to be used as a cluster-wide singleton timer.
					</div><div class="para">
						This Singleton bean must not have a remote interface and you must not reference its local interface from another EJB in any application. This prevents a lookup by a client or other component and ensures the SingletonService has total control of the Singleton.
					</div><ol class="substeps i"><li class="step"><div class="para">
								Create the Scheduler interface
							</div><div class="para">
								
<pre class="programlisting JAVA"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>package org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">as</span>.<span xmlns="" class="perl_Function">quickstarts</span>.<span xmlns="" class="perl_Function">cluster</span>.<span xmlns="" class="perl_Function">hasingleton</span>.<span xmlns="" class="perl_Function">service</span>.<span xmlns="" class="perl_Function">ejb</span>;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * </span><span xmlns="" class="perl_Keyword">@author &lt;a</span><span xmlns="" class="perl_Others"> href=</span><span xmlns="" class="perl_String">"mailto:wfink@redhat.com"</span><span xmlns="" class="perl_Keyword">&gt;</span><span xmlns="" class="perl_Comment">Wolf-Dieter Fink</span><span xmlns="" class="perl_Keyword">&lt;/a&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">interface</span> Scheduler {
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_DataType">void</span> initialize(String info);
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">stop</span>();
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>}
</pre>

							</div></li><li class="step"><div class="para">
								Create the Singleton bean that implements the cluster-wide singleton timer.
							</div><div class="para">
								
<pre class="programlisting JAVA"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>package org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">as</span>.<span xmlns="" class="perl_Function">quickstarts</span>.<span xmlns="" class="perl_Function">cluster</span>.<span xmlns="" class="perl_Function">hasingleton</span>.<span xmlns="" class="perl_Function">service</span>.<span xmlns="" class="perl_Function">ejb</span>;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.annotation.Resource;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.ScheduleExpression;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.Singleton;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.Timeout;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.Timer;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.TimerConfig;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.TimerService;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import org.jboss.logging.Logger;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">/**</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * A simple example to demonstrate a implementation of a cluster-wide singleton timer.</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> *</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> * </span><span xmlns="" class="perl_Keyword">@author &lt;a</span><span xmlns="" class="perl_Others"> href=</span><span xmlns="" class="perl_String">"mailto:wfink@redhat.com"</span><span xmlns="" class="perl_Keyword">&gt;</span><span xmlns="" class="perl_Comment">Wolf-Dieter Fink</span><span xmlns="" class="perl_Keyword">&lt;/a&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment"> */</span>
<span xmlns="" class="line">​</span>@Singleton
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> SchedulerBean <span xmlns="" class="perl_Keyword">implements</span> Scheduler {
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">static</span> Logger LOGGER = Logger.<span xmlns="" class="perl_Function">getLogger</span>(SchedulerBean.<span xmlns="" class="perl_Function">class</span>);
<span xmlns="" class="line">​</span>    @Resource
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">private</span> TimerService timerService;
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    @Timeout
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">scheduler</span>(Timer timer) {
<span xmlns="" class="line">​</span>        LOGGER.<span xmlns="" class="perl_Function">info</span>(<span xmlns="" class="perl_String">"HASingletonTimer: Info="</span> + timer.<span xmlns="" class="perl_Function">getInfo</span>());
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    @Override
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> initialize(String info) {
<span xmlns="" class="line">​</span>        ScheduleExpression sexpr = <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">ScheduleExpression</span>();
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">// set schedule to every 10 seconds for demonstration</span>
<span xmlns="" class="line">​</span>        sexpr.<span xmlns="" class="perl_Function">hour</span>(<span xmlns="" class="perl_String">"*"</span>).<span xmlns="" class="perl_Function">minute</span>(<span xmlns="" class="perl_String">"*"</span>).<span xmlns="" class="perl_Function">second</span>(<span xmlns="" class="perl_String">"0/10"</span>);
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">// persistent must be false because the timer is started by the HASingleton service</span>
<span xmlns="" class="line">​</span>        timerService.<span xmlns="" class="perl_Function">createCalendarTimer</span>(sexpr, <span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">TimerConfig</span>(info, <span xmlns="" class="perl_Keyword">false</span>));
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    @Override
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">void</span> <span xmlns="" class="perl_Function">stop</span>() {
<span xmlns="" class="line">​</span>        LOGGER.<span xmlns="" class="perl_Function">info</span>(<span xmlns="" class="perl_String">"Stop all existing HASingleton timers"</span>);
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">for</span> (Timer timer : timerService.<span xmlns="" class="perl_Function">getTimers</span>()) {
<span xmlns="" class="line">​</span>            LOGGER.<span xmlns="" class="perl_Function">trace</span>(<span xmlns="" class="perl_String">"Stop HASingleton timer: "</span> + timer.<span xmlns="" class="perl_Function">getInfo</span>());
<span xmlns="" class="line">​</span>            timer.<span xmlns="" class="perl_Function">cancel</span>();
<span xmlns="" class="line">​</span>        }
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
</pre>

							</div></li></ol></li></ol></li><li class="step"><div class="para">
				Start each JBoss EAP 6 instance with clustering enabled.
			</div><div class="para">

			</div><div class="para">
				To enable clustering for standalone servers, you must start each server with the <code class="literal">HA</code> profile, using a unique node name and port offset for each instance.
			</div><ul class="stepalternatives">
				<li class="step"><div class="para">
						For Linux, use the following command syntax to start the servers:
					</div><div class="para">
						<pre class="synopsis"><em class="replaceable">EAP_HOME</em>/bin/standalone.sh --server-config=standalone-ha.xml -Djboss.node.name=<em class="replaceable">UNIQUE_NODE_NAME</em> -Djboss.socket.binding.port-offset=<em class="replaceable">PORT_OFFSET</em></pre> <div class="example"><a id="idm139819303334672">
      ⁠</a><p class="title"><strong>Example 3.6. Start multiple standalone servers on Linux</strong></p><div class="example-contents"><pre class="screen"><code class="command">$ <em class="replaceable">EAP_HOME</em>/bin/standalone.sh --server-config=standalone-ha.xml -Djboss.node.name=node1</code>
<code class="command">$ <em class="replaceable">EAP_HOME</em>/bin/standalone.sh --server-config=standalone-ha.xml -Djboss.node.name=node2 -Djboss.socket.binding.port-offset=100</code></pre></div></div>

					</div></li>
				 <li class="step"><div class="para">
						For Microsoft Windows, use the following command syntax to start the servers:
					</div><pre class="synopsis"><em class="replaceable">EAP_HOME</em>\bin\standalone.bat --server-config=standalone-ha.xml -Djboss.node.name=<em class="replaceable">UNIQUE_NODE_NAME</em> -Djboss.socket.binding.port-offset=<em class="replaceable">PORT_OFFSET</em></pre><div class="example"><a id="idm139819308044304">
      ⁠</a><p class="title"><strong>Example 3.7. Start multiple standalone servers on Microsoft Windows</strong></p><div class="example-contents"><pre class="screen"><code class="command">C:&gt; <em class="replaceable">EAP_HOME</em>\bin\standalone.bat --server-config=standalone-ha.xml -Djboss.node.name=node1</code>
<code class="command">C:&gt; <em class="replaceable">EAP_HOME</em>\bin\standalone.bat --server-config=standalone-ha.xml -Djboss.node.name=node2 -Djboss.socket.binding.port-offset=100</code></pre></div></div></li>

			</ul><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					If you prefer not to use command line arguments, you can configure the <code class="filename">standalone-ha.xml</code> file for each server instance to bind on a separate interface.
				</div></div></div></li><li class="step"><div class="para">
				Deploy the application to the servers
			</div><div class="para">
				The following Maven command deploys the application to a standalone server running on the default ports.
			</div><div class="para">
				
<pre class="screen"><code class="command">mvn clean install jboss-as:deploy</code></pre>

			</div><div class="para">
				To deploy to additional servers, pass the server name. if it is on a different host, pass the host name and port number on the command line:
			</div><div class="para">
				
<pre class="screen"><code class="command">mvn clean package jboss-as:deploy -Djboss-as.hostname=localhost -Djboss-as.port=10099</code></pre>

			</div><div class="para">
				See the <code class="literal">cluster-ha-singleton</code> quickstart that ships with JBoss EAP 6 for Maven configuration and deployment details.
			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+9154-766862+%5BLatest%5D&amp;comment=Title%3A+Implement+an+HA+Singleton%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9154-766862+05+Aug+2015+11%3A21+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Service-style_Deployment_Changes">
      ⁠</a>3.2.11. Service-style Deployment Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Update_Applications_That_Use_Service-style_Deployments">
      ⁠</a>3.2.11.1. Update Applications That Use Service-style Deployments</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			MBeans were part of the core architecture in previous versions of Red Hat JBoss Enterprise Application Platform. JBoss Service Archive (SAR) deployments using the JBoss specific <code class="filename">jboss-service.xml</code> and <code class="filename">jboss-beans.xml</code> service-style descriptors were used by the application server to create MBeans based on JBoss Beans. The internal architecture has changed in JBoss EAP 6 and is no longer based on an MBean JMX architecture. MBeans are no longer part of the core architecture. They are now a wrapper for the management API.
		</div><div class="para">
		If your application uses service-style deployment descriptors, it may continue to work in JBoss EAP 6 as long as it depends only on MBeans that your application defined and does not depend on the JBoss Management API MBean wrappers. In JBoss EAP 6, SARs can only declare MBean dependencies on MBeans that were created by another SAR deployment. This means if your application depends on MBeans that JBoss EAP created, such as an MBean for an EJB or messaging component, they will no longer work. The only MBeans you can depend on are other MBeans that you defined in other <code class="filename">jboss-service.xml</code> files.
	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Replace Service-style Deployments with @Singleton</div>
			The JBoss Service Archive (SAR) and service-style descriptors used in previous versions of JBoss EAP are not a part of the Java EE 6 specification and are not recommended for use in JBoss EAP 6. It is recommended that you modify your application to the Java EE 6 specification. For MBeans singletons, you should modify the code to use the more portable Java EE 6 <code class="code">@Singleton</code> instead of the JBoss EAP proprietary <code class="filename">*-beans.xml</code> and <code class="filename">*-service.xml</code> files. For more information about creating and deploying MBean services, see the chapter entitled <em class="citetitle">JBoss MBean Services</em> in the <em class="citetitle">Development Guide</em> for JBoss EAP 6 located on the Customer Portal at <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Service-style Descriptor Changes</div>
			If choose not to modify the code to use the standard Java EE 6 EJB <code class="code">@Singleton</code>, be aware that the <code class="filename">jboss-beans.xml</code> and <code class="filename">jboss-service.xml</code> files changed between JBoss EAP 5 and JBoss EAP 6.
		</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"> The XML declaration in <code class="filename">jboss-beans.xml</code> file changed between JBoss EAP 5 and JBoss EAP 6. </span></dt><dd><div class="para">
					The following is an example of a <code class="filename">jboss-beans.xml</code> file in JBoss EAP 5. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;deployment</span><span xmlns="" class="perl_Others"> xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xsi:schemaLocation=</span><span xmlns="" class="perl_String">"urn:jboss:bean-deployer:2.0 bean-deployer_2_0.xsd"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:bean-deployer:2.0"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"TestServantBean"</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.test.iiop.jbpapp6462.servant.TestServantBean"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/deployment&gt;</span>
</pre>
					 The following is an example of a <code class="filename">jboss-beans.xml</code> file in JBoss EAP 6. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;deployment</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:pojo:7.0"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xsi:schemaLocation=</span><span xmlns="" class="perl_String">"urn:jboss:pojo:7.0 jboss-mc_7_0.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;bean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Bean"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;alias&gt;</span>Alias-Bean<span xmlns="" class="perl_Keyword">&lt;/alias&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;constructor</span><span xmlns="" class="perl_Others"> factory-class=</span><span xmlns="" class="perl_String">"org.jboss.as.test.integration.pojo.support.TFactory"</span><span xmlns="" class="perl_Others"> factory-method=</span><span xmlns="" class="perl_String">"createBean"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;value&gt;</span>test<span xmlns="" class="perl_Keyword">&lt;/value&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/constructor&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"injectee"</span><span xmlns="" class="perl_Keyword">&gt;&lt;inject</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"Injectee"</span><span xmlns="" class="perl_Keyword">/&gt;&lt;/property&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;start&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;value&gt;</span>start<span xmlns="" class="perl_Keyword">&lt;/value&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/start&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;stop&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;value&gt;</span>stop<span xmlns="" class="perl_Keyword">&lt;/value&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/stop&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;install</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"install"</span><span xmlns="" class="perl_Others"> state=</span><span xmlns="" class="perl_String">"CREATE"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;value&gt;</span>install<span xmlns="" class="perl_Keyword">&lt;/value&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/install&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;install</span><span xmlns="" class="perl_Others"> bean=</span><span xmlns="" class="perl_String">"Alias-Injectee"</span><span xmlns="" class="perl_Others"> method=</span><span xmlns="" class="perl_String">"sayHello"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;parameter&gt;&lt;value&gt;</span>from-other-bean<span xmlns="" class="perl_Keyword">&lt;/value&gt;&lt;/parameter&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/install&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/bean&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/deployment&gt;</span>
</pre>

				</div></dd><dt><span class="term"> The DTD for the <code class="filename">jboss-service.xml</code> file changed between JBoss EAP 5 and JBoss EAP 6. </span></dt><dd><div class="para">
					The following is an example of a <code class="filename">jboss-service.xml</code> file in JBoss EAP 5. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">&lt;!DOCTYPE </span>server
<span xmlns="" class="line">​</span>    PUBLIC "-//JBoss//DTD MBean Service 5.0//EN"
<span xmlns="" class="line">​</span>    "http://www.jboss.org/j2ee/dtd/jboss-service_5_0.dtd"<span xmlns="" class="perl_DataType">&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;server&gt;</span>
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/server&gt;</span>
<span xmlns="" class="line">​</span>
</pre>
					 The following is an example of a <code class="filename">jboss-service.xml</code> file in JBoss EAP 6. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;server</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:service:7.0"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xsi:schemaLocation=</span><span xmlns="" class="perl_String">"urn:jboss:service:7.0 jboss-service_7_0.xsd"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;mbean</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jboss.test:service=testdeployments"</span><span xmlns="" class="perl_Others"> code=</span><span xmlns="" class="perl_String">"org.jboss.as.test.integration.mgmt.access.deployment.sar.Simple"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/server&gt;</span>
<span xmlns="" class="line">​</span>
</pre>

				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4949-781538+%5BLatest%5D&amp;comment=Title%3A+Update+Applications+That+Use+Service-style+Deployments%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4949-781538+13+Nov+2017+12%3A35+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Remote_Invocation_Changes">
      ⁠</a>3.2.12. Remote Invocation Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Migrate_JBoss_Enterprise_Application_Platform_5_Deployed_Applications_That_Make_Remote_Invocations_to_JBoss_Enterprise_Application_Platform_6">
      ⁠</a>3.2.12.1. Migrate JBoss EAP 5 Deployed Applications That Make Remote Invocations to JBoss EAP 6</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			In JBoss EAP 5, the EJB remote interface was bound in JNDI, by default, under the name <code class="literal"><em class="replaceable">EJB_NAME</em>/local</code> for local interfaces, and <code class="literal"><em class="replaceable">EJB_NAME</em>/remote</code> for remote interfaces. The client application then looked up the bean using <code class="literal"><em class="replaceable">EJB_NAME</em>/remote</code>.
		</div><div class="para">
		In JBoss EAP 6, a new EJB client API was introduced for remote invocations. However, if you do not want to rewrite your code to use the new API, you can modify the existing code to use the <code class="literal">ejb:</code><em class="replaceable">BEAN_REFERENCE</em> for remote access to EJBs using the following syntax.
	</div><div class="para">
		For stateless beans, the <code class="literal">ejb:</code><em class="replaceable">BEAN_REFERENCE</em> syntax is: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>ejb:<span xmlns="" class="perl_Keyword">&lt;app-name&gt;</span>/<span xmlns="" class="perl_Keyword">&lt;module-name&gt;</span>/<span xmlns="" class="perl_Keyword">&lt;distinct-name&gt;</span>/<span xmlns="" class="perl_Keyword">&lt;bean-name&gt;</span>!<span xmlns="" class="perl_Keyword">&lt;fully-qualified-classname-of-the-remote-interface&gt;</span>
</pre>
		 For stateful beans, the <code class="literal">ejb:</code><em class="replaceable">BEAN_REFERENCE</em> syntax is: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>ejb:<span xmlns="" class="perl_Keyword">&lt;app-name&gt;</span>/<span xmlns="" class="perl_Keyword">&lt;module-name&gt;</span>/<span xmlns="" class="perl_Keyword">&lt;distinct-name&gt;</span>/<span xmlns="" class="perl_Keyword">&lt;bean-name&gt;</span>!<span xmlns="" class="perl_Keyword">&lt;fully-qualified-classname-of-the-remote-interface&gt;</span>?stateful
</pre>

	</div><div class="para">
		The values to be substituted in the above syntax are: 
		<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="varname">&lt;app-name&gt;</code> - the application name of the deployed EJBs. This is typically the ear name without the .ear suffix, however, the name can be overridden in the application.xml file. If the application is not deployed as a .ear, this value is an empty string. Assume this example was not deployed as an EAR.
				</div></li><li class="listitem"><div class="para">
					<code class="varname">&lt;module-name&gt;</code> - the module name of the deployed EJBs on the server. This is typically the jar name of the EJB deployment, without the .jar suffix, but can be overridden using the ejb-jar.xml. In this example, assume the EJBs were deployed in a jboss-ejb-remote-app.jar, so the module name is jboss-ejb-remote-app.
				</div></li><li class="listitem"><div class="para">
					<code class="varname">&lt;distinct-name&gt;</code> - an optional distinct name for the EJB. This example does not use a distinct name, so it uses an empty string.
				</div></li><li class="listitem"><div class="para">
					<code class="varname">&lt;bean-name&gt;</code> - by default, is the simple class name of the bean implementation class.
				</div></li><li class="listitem"><div class="para">
					<code class="varname">&lt;fully-qualified-classname-of-the-remote-interface&gt;</code> - the remote view fully qualified class name.
				</div></li></ul></div>

	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Update the Client Code</div>
			The client code examples below assume you deployed the following stateless EJB to a JBoss EAP 6 server. Note that it exposes a remote view for the bean using the <code class="classname">@Remote</code> annotation. 
			<div class="example"><a id="idm139819327334400">
      ⁠</a><p class="title"><strong>Example 3.8. Stateless Session Bean Code Example</strong></p><div class="example-contents"><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@Stateless
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Remote</span>(RemoteCalculator.<span xmlns="" class="perl_Function">class</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> CalculatorBean <span xmlns="" class="perl_Keyword">implements</span> RemoteCalculator {
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span>    @Override
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">int</span> <span xmlns="" class="perl_Function">add</span>(<span xmlns="" class="perl_DataType">int</span> a, <span xmlns="" class="perl_DataType">int</span> b) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> a + b;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span>    @Override
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_DataType">int</span> <span xmlns="" class="perl_Function">subtract</span>(<span xmlns="" class="perl_DataType">int</span> a, <span xmlns="" class="perl_DataType">int</span> b) {
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">return</span> a - b;
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}
</pre></div></div>
			 In the JBoss EAP 5 client code, you created an <code class="classname">InitialContext</code> and looked up the EJB using its JNDI name. 
			<div class="example"><a id="idm139819324378352">
      ⁠</a><p class="title"><strong>Example 3.9. JBoss EAP 5 Client Example</strong></p><div class="example-contents"><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>InitialContext ctx = <span xmlns="" class="perl_Keyword">new</span> InitialContext();
<span xmlns="" class="line">​</span>RemoteCalculator calculator = (RemoteCalculator) ctx.<span xmlns="" class="perl_Function">lookup</span>(<span xmlns="" class="perl_String">"CalculatorBean/remote"</span>);
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">int</span> a = <span xmlns="" class="perl_Float">204</span>;
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">int</span> b = <span xmlns="" class="perl_Float">340</span>;
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">int</span> sum = calculator.<span xmlns="" class="perl_Function">add</span>(a, b);
</pre></div></div>
			 In JBoss EAP 6, you create a <code class="classname">Hashtable</code> and set the properties for the bean reference as described above. The following is an example of the client lookup and invocation. 
			<div class="example"><a id="idm139819322849936">
      ⁠</a><p class="title"><strong>Example 3.10. JBoss EAP 6 Stateless Client Example</strong></p><div class="example-contents"><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">final</span> Hashtable jndiProperties = <span xmlns="" class="perl_Keyword">new</span> Hashtable();
<span xmlns="" class="line">​</span>jndiProperties.<span xmlns="" class="perl_Function">put</span>(Context.<span xmlns="" class="perl_Function">URL_PKG_PREFIXES</span>, <span xmlns="" class="perl_String">"org.jboss.ejb.client.naming"</span>);
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">final</span> Context context = <span xmlns="" class="perl_Keyword">new</span> InitialContext(jndiProperties);
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">final</span> String appName = <span xmlns="" class="perl_String">""</span>;
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">final</span> String moduleName = <span xmlns="" class="perl_String">"jboss-ejb-remote-app"</span>;
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">final</span> String distinctName = <span xmlns="" class="perl_String">""</span>;
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">final</span> String beanName = CalculatorBean.<span xmlns="" class="perl_Function">class</span>.<span xmlns="" class="perl_Function">getSimpleName</span>();
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">final</span> String viewClassName = RemoteCalculator.<span xmlns="" class="perl_Function">class</span>.<span xmlns="" class="perl_Function">getName</span>();
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">final</span> RemoteCalculator statelessRemoteCalculator =  (RemoteCalculator) context.<span xmlns="" class="perl_Function">lookup</span>(<span xmlns="" class="perl_String">"ejb:"</span> + appName + <span xmlns="" class="perl_String">"/"</span> + moduleName + <span xmlns="" class="perl_String">"/"</span> + distinctName + <span xmlns="" class="perl_String">"/"</span> + beanName + <span xmlns="" class="perl_String">"!"</span> + viewClassName);
<span xmlns="" class="line">​</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">int</span> a = <span xmlns="" class="perl_Float">204</span>;
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">int</span> b = <span xmlns="" class="perl_Float">340</span>;
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">int</span> sum = statelessRemoteCalculator.<span xmlns="" class="perl_Function">add</span>(a, b);
</pre></div></div>
			 If your client is accessing a stateful EJB, you must append "?stateful" to the end of the context lookup. 
			<div class="example"><a id="idm139819305734080">
      ⁠</a><p class="title"><strong>Example 3.11. JBoss EAP 6 Stateful Client Example</strong></p><div class="example-contents"><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">final</span> RemoteCalculator statefulRemoteCalculator =  (RemoteCalculator) context.<span xmlns="" class="perl_Function">lookup</span>(<span xmlns="" class="perl_String">"ejb:"</span> + appName + <span xmlns="" class="perl_String">"/"</span> + moduleName + <span xmlns="" class="perl_String">"/"</span> + distinctName + <span xmlns="" class="perl_String">"/"</span> + beanName + <span xmlns="" class="perl_String">"!"</span> + viewClassName + <span xmlns="" class="perl_String">"?stateful"</span>)
</pre></div></div>

		</div><div class="para">
		A complete working example, including both server and client code, can be found in the quickstarts that ship with JBoss EAP 6. For more information, see <em class="citetitle">Review the Quickstart Tutorials</em> in the chapter entitled <em class="citetitle">Get Started Developing Applications</em> in the <em class="citetitle">Development Guide</em> for JBoss EAP 6 on <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
	</div><div class="para">
		For more information on remote invocations using JNDI, see <a class="xref" href="chap-Migrate_Your_Application.html#Invoke_a_Session_Bean_Remotely_using_JNDI1">Section 3.2.12.2, “Invoke a Session Bean Remotely using JNDI”</a> .
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4943-781541+%5BLatest%5D&amp;comment=Title%3A+Migrate+JBoss+EAP+5+Deployed+Applications+That+Make+Remote+Invocations+to+JBoss+EAP+6%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4943-781541+13+Nov+2017+12%3A40+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Invoke_a_Session_Bean_Remotely_using_JNDI1">
      ⁠</a>3.2.12.2. Invoke a Session Bean Remotely using JNDI</h3></div></div></div><div class="para">
		This task describes how to add support to a remote client for the invocation of session beans using JNDI. The task assumes that the project is being built using Maven.
	</div><div class="para">
		The <code class="filename">ejb-remote</code> quickstart contains working Maven projects that demonstrate this functionality. The quickstart contains projects for both the session beans to deploy and the remote client. The code samples below are taken from the remote client project.
	</div><div class="para">
		This task assumes that the session beans do not require authentication.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
			Red Hat recommends that you explicitly disable SSL in favor of TLSv1.1 or TLSv1.2 in all affected packages.
		</div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><div class="para">
			The following prerequisites must be satisfied before beginning:
		</div><ul><li class="listitem"><div class="para">
				You must already have a Maven project created ready to use.
			</div></li><li class="listitem"><div class="para">
				Configuration for the JBoss EAP 6 Maven repository has already been added.
			</div></li><li class="listitem"><div class="para">
				The session beans that you want to invoke are already deployed.
			</div></li><li class="listitem"><div class="para">
				The deployed session beans implement remote business interfaces.
			</div></li><li class="listitem"><div class="para">
				The remote business interfaces of the session beans are available as a Maven dependency. If the remote business interfaces are only available as a JAR file then it is recommended to add the JAR to your Maven repository as an artifact. Refer to the Maven documentation for the <code class="command">install:install-file</code> goal for directions, <a href="http://maven.apache.org/plugins/maven-install-plugin/usage.html">http://maven.apache.org/plugins/maven-install-plugin/usage.html</a>
			</div></li><li class="listitem"><div class="para">
				You need to know the hostname and JNDI port of the server hosting the session beans.
			</div></li></ul></div><div class="para">
		To invoke a session bean from a remote client you must first configure the project correctly.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819304577888">
      ⁠</a><p class="title"><strong>Procedure 3.25. Add Maven Project Configuration for Remote Invocation of Session Beans</strong></p><ol class="1"><li class="step"><div class="para">
				Add the required project dependencies
			</div><div class="para">
				The <code class="filename">pom.xml</code> for the project must be updated to include the necessary dependencies.
			</div></li><li class="step"><div class="para">
				Add the <code class="filename">jboss-ejb-client.properties</code> file
			</div><div class="para">
				The JBoss EJB client API expects to find a file in the root of the project named <code class="filename">jboss-ejb-client.properties</code> that contains the connection information for the JNDI service. Add this file to the <code class="filename">src/main/resources/</code> directory of your project with the following content.
			</div><pre class="programlisting">
# In the following line, set SSL_ENABLED to true for SSL
remote.connectionprovider.create.options.org.xnio.Options.SSL_ENABLED=false
remote.connections=default
# Uncomment the following line to set SSL_STARTTLS to true for SSL
# remote.connection.default.connect.options.org.xnio.Options.SSL_STARTTLS=true
remote.connection.default.host=localhost
remote.connection.default.port = 4447
remote.connection.default.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false
# Add any of the following SASL options if required
# remote.connection.default.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false
# remote.connection.default.connect.options.org.xnio.Options.SASL_POLICY_NOPLAINTEXT=false
# remote.connection.default.connect.options.org.xnio.Options.SASL_DISALLOWED_MECHANISMS=JBOSS-LOCAL-USER
</pre><div class="para">
				Change the host name and port to match your server. <code class="literal">4447</code> is the default port number. For a secure connection, set the <code class="literal">SSL_ENABLED</code> line to <code class="literal">true</code> and uncomment the <code class="literal">SSL_STARTTLS</code> line. The Remoting interface in the container supports secured and unsecured connections using the same port.
			</div></li><li class="step"><div class="para">
				Add dependencies for the remote business interfaces
			</div><div class="para">
				Add the Maven dependencies to the <code class="filename">pom.xml</code> for the remote business interfaces of the session beans.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>&lt;dependency&gt;
<span xmlns="" class="line">​</span>   &lt;groupId&gt;org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">as</span>.<span xmlns="" class="perl_Function">quickstarts</span>&lt;/groupId&gt;
<span xmlns="" class="line">​</span>   &lt;artifactId&gt;jboss-ejb-remote-server-side&lt;/artifactId&gt;
<span xmlns="" class="line">​</span>   &lt;type&gt;ejb-client&lt;/type&gt;
<span xmlns="" class="line">​</span>   &lt;version&gt;${project.<span xmlns="" class="perl_Function">version</span>}&lt;/version&gt;
<span xmlns="" class="line">​</span>&lt;/dependency&gt;</pre></li></ol></div><div class="para">
		Now that the project has been configured correctly, you can add the code to access and invoke the session beans.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819320236608">
      ⁠</a><p class="title"><strong>Procedure 3.26. Obtain a Bean Proxy using JNDI and Invoke Methods of the Bean</strong></p><ol class="1"><li class="step"><div class="para">
				Handle checked exceptions
			</div><div class="para">
				Two of the methods used in the following code (<code class="code">InitialContext()</code> and <code class="code">lookup()</code>) have a checked exception of type <code class="code">javax.naming.NamingException</code>. These method calls must either be enclosed in a try/catch block that catches <code class="code">NamingException</code> or in a method that is declared to throw <code class="code">NamingException</code>. The <code class="filename">ejb-remote</code> quickstart uses the second technique.
			</div></li><li class="step"><div class="para">
				Create a JNDI Context
			</div><div class="para">
				A JNDI Context object provides the mechanism for requesting resources from the server. Create a JNDI context using the following code:
			</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">final</span> Hashtable jndiProperties = <span xmlns="" class="perl_Keyword">new</span> Hashtable();
<span xmlns="" class="line">​</span>jndiProperties.<span xmlns="" class="perl_Function">put</span>(Context.<span xmlns="" class="perl_Function">URL_PKG_PREFIXES</span>, <span xmlns="" class="perl_String">"org.jboss.ejb.client.naming"</span>);
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">final</span> Context context = <span xmlns="" class="perl_Keyword">new</span> InitialContext(jndiProperties);</pre><div class="para">
				The connection properties for the JNDI service are read from the <code class="filename">jboss-ejb-client.properties</code> file.
			</div></li><li class="step"><div class="para">
				Use the JNDI Context's lookup() method to obtain a bean proxy
			</div><div class="para">
				Invoke the <code class="code">lookup()</code> method of the bean proxy and pass it the JNDI name of the session bean you require. This will return an object that must be cast to the type of the remote business interface that contains the methods you want to invoke.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">final</span> RemoteCalculator statelessRemoteCalculator = (RemoteCalculator) context.<span xmlns="" class="perl_Function">lookup</span>(
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_String">"ejb:/jboss-ejb-remote-server-side//CalculatorBean!"</span> + 
<span xmlns="" class="line">​</span>    RemoteCalculator.<span xmlns="" class="perl_Function">class</span>.<span xmlns="" class="perl_Function">getName</span>());
</pre><div class="para">
				Session bean JNDI names are defined using a special syntax. For more information, see <a class="xref" href="chap-Migrate_Your_Application.html#EJB_JNDI_Naming_Reference">Section 3.2.12.3, “EJB JNDI Naming Reference”</a> .
			</div></li><li class="step"><div class="para">
				Invoke methods
			</div><div class="para">
				Now that you have a proxy bean object you can invoke any of the methods contained in the remote business interface.
			</div><pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">int</span> a = <span xmlns="" class="perl_Float">204</span>;
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">int</span> b = <span xmlns="" class="perl_Float">340</span>;
<span xmlns="" class="line">​</span>System.<span xmlns="" class="perl_Function">out</span>.<span xmlns="" class="perl_Function">println</span>(<span xmlns="" class="perl_String">"Adding "</span> + a + <span xmlns="" class="perl_String">" and "</span> + b + <span xmlns="" class="perl_String">" via the remote stateless calculator deployed on the server"</span>);
<span xmlns="" class="line">​</span><span xmlns="" class="perl_DataType">int</span> sum = statelessRemoteCalculator.<span xmlns="" class="perl_Function">add</span>(a, b);
<span xmlns="" class="line">​</span>System.<span xmlns="" class="perl_Function">out</span>.<span xmlns="" class="perl_Function">println</span>(<span xmlns="" class="perl_String">"Remote calculator returned sum = "</span> + sum);</pre><div class="para">
				The proxy bean passes the method invocation request to the session bean on the server, where it is executed. The result is returned to the proxy bean which then returns it to the caller. The communication between the proxy bean and the remote session bean is transparent to the caller.
			</div></li></ol></div><div class="para">
		You should now be able to configure a Maven project to support invoking session beans on a remote server and write the code invoke the session beans methods using a proxy bean retrieved from the server using JNDI.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+5719-766863+%5BLatest%5D&amp;comment=Title%3A+Invoke+a+Session+Bean+Remotely+using+JNDI%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5719-766863+05+Aug+2015+11%3A28+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="EJB_JNDI_Naming_Reference">
      ⁠</a>3.2.12.3. EJB JNDI Naming Reference</h3></div></div></div><div class="para">
		The JNDI lookup name for a session bean has the syntax of:
	</div><pre class="synopsis"> ejb:<em class="replaceable">&lt;appName&gt;</em>/<em class="replaceable">&lt;moduleName&gt;</em>/<em class="replaceable">&lt;distinctName&gt;</em>/<em class="replaceable">&lt;beanName&gt;</em>!<em class="replaceable">&lt;viewClassName&gt;</em><em class="replaceable">?stateful</em> </pre><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="code">&lt;appName&gt;</code></span></dt><dd><div class="para">
					If the session bean's JAR file has been deployed within an enterprise archive (EAR) then this is the name of that EAR. By default, the name of an EAR is its filename without the <code class="filename">.ear</code> suffix. The application name can also be overridden in its <code class="filename">application.xml</code> file. If the session bean is not deployed in an EAR then leave this blank.
				</div></dd><dt><span class="term"><code class="code">&lt;moduleName&gt;</code></span></dt><dd><div class="para">
					The module name is the name of the JAR file that the session bean is deployed in. By the default, the name of the JAR file is its filename without the <code class="filename">.jar</code> suffix. The module name can also be overridden in the JAR's <code class="filename">ejb-jar.xml</code> file.
				</div></dd><dt><span class="term"><code class="code">&lt;distinctName&gt;</code></span></dt><dd><div class="para">
					JBoss EAP 6 allows each deployment to specify an optional distinct name. If the deployment does not have a distinct name then leave this blank.
				</div></dd><dt><span class="term"><code class="code">&lt;beanName&gt;</code></span></dt><dd><div class="para">
					The bean name is the classname of the session bean to be invoked.
				</div></dd><dt><span class="term"><code class="code">&lt;viewClassName&gt;</code></span></dt><dd><div class="para">
					The view class name is the fully qualified classname of the remote interface. This includes the package name of the interface.
				</div></dd><dt><span class="term"><code class="code">?stateful</code></span></dt><dd><div class="para">
					The <code class="code">?stateful</code> suffix is required when the JNDI name refers to a stateful session bean. It is not included for other bean types.
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+5119-591683+%5BLatest%5D&amp;comment=Title%3A+EJB+JNDI+Naming+Reference%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=5119-591683+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Migrate_EJB_Asynchronous_Method_Calls">
      ⁠</a>3.2.12.4. Migrate EJB Asynchronous Method Calls</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			The EJB 3.1 specification introduced the ability to make asynchronous methods calls. Prior to the introduction of this feature, some application servers provided proprietary asynchronous functionality. JBoss EAP 4.x provided classes in the <code class="code">org.jboss.ejb3.asynchronous</code> package and JBoss EAP 5.x provided the <code class="literal">org.jboss.ejb3.common.proxy.plugins.async.AsyncUtils</code> class for this purpose. These classes are not supported in JBoss EAP 6 and must be replaced. The following is an example of how to make an asynchronous method call in JBoss EAP 6.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819298215232">
      ⁠</a><p class="title"><strong>Procedure 3.27. Create the Asynchronous Session Bean and Client</strong></p><ol class="1"><li class="step"><div class="para">
				Create the Asynchronous session bean method.
			</div><div class="para">
				In the following example, the <code class="code">sayHelloAsync()</code> method is marked as asynchronous using the <code class="classname">@Asynchronous</code> annotation. It returns the required <code class="classname">Future</code> class implementation with a result of type <code class="classname">String</code>. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.Remote;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.SessionContext;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.Stateless;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.TransactionAttribute;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.TransactionAttributeType;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.interceptor.Interceptors;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import java.util.concurrent.Future;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.AsyncResult;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">import javax.ejb.Asynchronous;</span>
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Stateless</span>(name=<span xmlns="" class="perl_String">"Hello"</span>)
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Remote</span>(Hello.<span xmlns="" class="perl_Function">class</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> HelloBean <span xmlns="" class="perl_Keyword">implements</span> Hello {
<span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span>    @Asynchronous
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">public</span> Future&lt;String&gt; <span xmlns="" class="perl_Function">sayHelloAsync</span>() {
<span xmlns="" class="line">​</span>       <span xmlns="" class="perl_Keyword">return</span> <span xmlns="" class="perl_Keyword">new</span> AsyncResult&lt;String&gt;(<span xmlns="" class="perl_String">"Hello"</span>);
<span xmlns="" class="line">​</span>    }
<span xmlns="" class="line">​</span>}</pre>

			</div></li><li class="step"><div class="para">
				Create the client code.
			</div><div class="para">
				Look up the EJB and call its asynchronous method using one of the available <code class="classname">Future.get()</code> methods. The following example limits the wait time to the values specified by the timeout and unit arguments. 
<pre class="programlisting"><span xmlns="" class="line">​</span>Future&lt;String&gt; future = ejbObject.<span xmlns="" class="perl_Function">sayHelloAsync</span>();
<span xmlns="" class="line">​</span>String response = future.<span xmlns="" class="perl_Function">get</span>(timeout, unit);</pre>

			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44631-766876+%5BLatest%5D&amp;comment=Title%3A+Migrate+EJB+Asynchronous+Method+Calls%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44631-766876+05+Aug+2015+12%3A37+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-EJB_Changes">
      ⁠</a>3.2.13. EJB Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Migrate_Stateful_EJB_Cache_Configuration">
      ⁠</a>3.2.13.1. Migrate Stateful EJB Cache Configuration</h3></div></div></div><div class="para">
		In JBoss EAP 5, stateful EJB cache was configured using the <code class="sgmltag-element">container-cache-conf</code> element in the <code class="filename">jboss.xml</code> file. The following is an example of stateful cache configuration in JBoss EAP 5. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;container-cache-conf&gt;</span>
<span xmlns="" class="line">​</span>	  <span xmlns="" class="perl_Keyword">&lt;cache-policy&gt;</span>org.jboss.ejb.plugins.LRUStatefulContextCachePolicy<span xmlns="" class="perl_Keyword">&lt;/cache-policy&gt;</span>
<span xmlns="" class="line">​</span>	  <span xmlns="" class="perl_Keyword">&lt;cache-policy-conf&gt;</span>
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">&lt;min-capacity&gt;</span>50<span xmlns="" class="perl_Keyword">&lt;/min-capacity&gt;</span>
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">&lt;max-capacity&gt;</span>200<span xmlns="" class="perl_Keyword">&lt;/max-capacity&gt;</span>
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">&lt;remover-period&gt;</span>1800<span xmlns="" class="perl_Keyword">&lt;/remover-period&gt;</span>
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">&lt;max-bean-life&gt;</span>1320<span xmlns="" class="perl_Keyword">&lt;/max-bean-life&gt;</span>
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">&lt;overager-period&gt;</span>300<span xmlns="" class="perl_Keyword">&lt;/overager-period&gt;</span>
<span xmlns="" class="line">​</span>	    <span xmlns="" class="perl_Keyword">&lt;max-bean-age&gt;</span>1260<span xmlns="" class="perl_Keyword">&lt;/max-bean-age&gt;</span>
<span xmlns="" class="line">​</span>	  <span xmlns="" class="perl_Keyword">&lt;/cache-policy-conf&gt;</span>
<span xmlns="" class="line">​</span>	<span xmlns="" class="perl_Keyword">&lt;/container-cache-conf&gt;</span></pre>

	</div><div class="para">
		In JBoss EAP 6, stateful EJB cache is configured in the <code class="literal">ejb3</code> subsystem of the server configuration file. For detailed instructions, see <a class="xref" href="chap-Migrate_Your_Application.html#Configure_Stateful_Session_Bean_Cache">Section 3.2.13.2, “Configure Stateful Session Bean Cache”</a>. The instructions also describe how to configure <code class="code">stateful-timeout</code>, which replaces the <code class="code">&lt;max-bean-age&gt;</code> that was specified in JBoss EAP 5.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44582-779891+%5BLatest%5D&amp;comment=Title%3A+Migrate+Stateful+EJB+Cache+Configuration%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44582-779891+20+Sep+2016+15%3A30+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_Stateful_Session_Bean_Cache">
      ⁠</a>3.2.13.2. Configure Stateful Session Bean Cache</h3></div></div></div><div class="para">

	</div><div class="para">
		In JBoss EAP 6, stateful EJB cache is configured in the <code class="literal">ejb3</code> subsystem of the server configuration file. The following procedure describes how to configure stateful EJB cache and stateful timeout.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819291490080">
      ⁠</a><p class="title"><strong>Procedure 3.28. Configure Stateful EJB Cache</strong></p><ol class="1"><li class="step"><div class="para">
				Find the <code class="code">&lt;caches&gt;</code> element in the <code class="literal">ejb3</code> subsystem of the server configuration file. Add a <code class="code">&lt;cache&gt;</code> element. The following example creates a cache named "my=cache". 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;cache</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"my-cache"</span><span xmlns="" class="perl_Others"> passivation-store-ref=</span><span xmlns="" class="perl_String">"my-cache-file"</span><span xmlns="" class="perl_Others"> aliases=</span><span xmlns="" class="perl_String">"my-custom-cache"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre>

			</div></li><li class="step"><div class="para">
				Find the <code class="code">&lt;passivation-stores&gt;</code> element in the <code class="literal">ejb3</code> subsystem of the server configuration file. Create a <code class="code">&lt;file-passivation-store&gt;</code> for the cache defined in the previous step. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;file-passivation-store</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"my-cache-file"</span><span xmlns="" class="perl_Others"> idle-timeout=</span><span xmlns="" class="perl_String">"1260"</span><span xmlns="" class="perl_Others"> idle-timeout-unit=</span><span xmlns="" class="perl_String">"SECONDS"</span><span xmlns="" class="perl_Others"> max-size=</span><span xmlns="" class="perl_String">"200"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre>

			</div></li><li class="step"><div class="para">
				The <code class="literal">ejb3</code> subsystem configuration should now look like the following example. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:ejb3:1.4"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;caches&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;cache</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"simple"</span><span xmlns="" class="perl_Others"> aliases=</span><span xmlns="" class="perl_String">"NoPassivationCache"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;cache</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"passivating"</span><span xmlns="" class="perl_Others"> passivation-store-ref=</span><span xmlns="" class="perl_String">"file"</span><span xmlns="" class="perl_Others"> aliases=</span><span xmlns="" class="perl_String">"SimpleStatefulCache"</span><span xmlns="" class="perl_Keyword">/&gt;</span>  
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;cache</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"clustered"</span><span xmlns="" class="perl_Others"> passivation-store-ref=</span><span xmlns="" class="perl_String">"infinispan"</span><span xmlns="" class="perl_Others"> aliases=</span><span xmlns="" class="perl_String">"StatefulTreeCache"</span><span xmlns="" class="perl_Keyword">/&gt;</span>  
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;cache</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"my-cache"</span><span xmlns="" class="perl_Others"> passivation-store-ref=</span><span xmlns="" class="perl_String">"my-cache-file"</span><span xmlns="" class="perl_Others"> aliases=</span><span xmlns="" class="perl_String">"my-custom-cache"</span><span xmlns="" class="perl_Keyword">/&gt;</span>               
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/caches&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;passivation-stores&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;file-passivation-store</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"file"</span><span xmlns="" class="perl_Others"> idle-timeout=</span><span xmlns="" class="perl_String">"120"</span><span xmlns="" class="perl_Others"> idle-timeout-unit=</span><span xmlns="" class="perl_String">"SECONDS"</span><span xmlns="" class="perl_Others"> max-size=</span><span xmlns="" class="perl_String">"500"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;cluster-passivation-store</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"infinispan"</span><span xmlns="" class="perl_Others"> cache-container=</span><span xmlns="" class="perl_String">"ejb"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;file-passivation-store</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"my-cache-file"</span><span xmlns="" class="perl_Others"> idle-timeout=</span><span xmlns="" class="perl_String">"1260"</span><span xmlns="" class="perl_Others"> idle-timeout-unit=</span><span xmlns="" class="perl_String">"SECONDS"</span><span xmlns="" class="perl_Others"> max-size=</span><span xmlns="" class="perl_String">"200"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/passivation-stores&gt;</span>
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/subsystem&gt;</span></pre>
				 The passivating cache, "my-cache", passivates stateful session beans to the file system as configured in the "my-cache-file" passivation store, which has the <code class="code">idle-timeout</code>, <code class="code">idle-timeout-unit</code> and <code class="code">max-size</code> options.
			</div></li><li class="step"><div class="para">
				Create a <code class="filename">jboss-ejb3.xml</code> file in the EJB JAR <code class="filename">META-INF/</code> directory. The following example configures the EJBs to use the cache defined in the previous steps. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss:ejb-jar</span><span xmlns="" class="perl_Others"> xmlns:jboss=</span><span xmlns="" class="perl_String">"http://www.jboss.com/xml/ns/javaee"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xmlns=</span><span xmlns="" class="perl_String">"http://java.sun.com/xml/ns/javaee"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xmlns:c=</span><span xmlns="" class="perl_String">"urn:ejb-cache:1.0"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://www.jboss.com/xml/ns/javaee http://www.jboss.org/j2ee/schema/jboss-ejb3-2_0.xsd http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/ejb-jar_3_1.xsd"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      version=</span><span xmlns="" class="perl_String">"3.1"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      impl-version=</span><span xmlns="" class="perl_String">"2.0"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;assembly-descriptor&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;c:cache&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>*<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;c:cache-ref&gt;</span>my-cache<span xmlns="" class="perl_Keyword">&lt;/c:cache-ref&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/c:cache&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/assembly-descriptor&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss:ejb-jar&gt;</span></pre>

			</div></li><li class="step"><div class="para">
				To method to configure a timeout value depends on whether you are implementing EJB 2 or EJB 3.
			</div><ul class="stepalternatives">
				<li class="step"><div class="para">
						EJB 3 introduced annotations, so you can specify the <code class="code">javax.ejb.StatefulTimeout</code> annotation in the EJB code as follows. 
<pre class="programlisting"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">StatefulTimeout</span>(value = <span xmlns="" class="perl_Float">1320</span>, unit=java.<span xmlns="" class="perl_Function">util</span>.<span xmlns="" class="perl_Function">concurrent</span>.<span xmlns="" class="perl_Function">TimeUnit</span>.<span xmlns="" class="perl_Function">SECONDS</span>) 
<span xmlns="" class="line">​</span>@Stateful
<span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Remote</span>(MyStatefulEJBRemote.<span xmlns="" class="perl_Function">class</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> MyStatefulEJB <span xmlns="" class="perl_Keyword">implements</span> MyStatefulEJBRemote {
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span>}</pre>

					</div><div class="para">
						The <code class="code">@StatefulTimeout</code> value can be set to one of the following. 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									A value of <code class="literal">0</code> means the bean is immediately eligible for removal.
								</div></li><li class="listitem"><div class="para">
									A value greater than <code class="literal">0</code> indicates a timeout value in the units specified by the <code class="code">unit</code> parameter. The default timeout unit is <code class="literal">MINUTES</code>. If you are using a passivating cache configuration and the <code class="code">idle-timeout</code> value is less than the <code class="code">StatefulTimeout</code> value, JBoss EAP will passivate the bean when it is idle for the <code class="code">idle-timeout</code> period specified. The bean is then eligible for removal after the <code class="code">StatefulTimeout</code> period specified.
								</div></li><li class="listitem"><div class="para">
									A value of <code class="literal">-1</code> means the bean will never be removed due to timeout. If you are using a passivating cache configuration and the bean is idle for <code class="code">idle-timeout</code>, JBoss EAP will passivate the bean instance to the <code class="code">passivation-store</code>.
								</div></li><li class="listitem"><div class="para">
									Values less than <code class="literal">-1</code> are not valid.
								</div></li></ul></div>

					</div></li>
				 <li class="step"><div class="para">
						For both EJB 2 and EJB 3, you can configure the stateful timeout in the <code class="filename">ejb-jar.xml</code> file. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;ejb-jar</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://java.sun.com/xml/ns/javaee"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">         xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">         xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/ejb-jar_3_1.xsd"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">         version=</span><span xmlns="" class="perl_String">"3.1"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;enterprise-beans&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;session&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>HelloBean<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;session-type&gt;</span>Stateful<span xmlns="" class="perl_Keyword">&lt;/session-type&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;stateful-timeout&gt;</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;timeout&gt;</span>1320<span xmlns="" class="perl_Keyword">&lt;/timeout&gt;</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;unit&gt;</span>Seconds<span xmlns="" class="perl_Keyword">&lt;/unit&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/stateful-timeout&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/session&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/enterprise-beans&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/ejb-jar&gt;</span></pre>

					</div></li>
				 <li class="step"><div class="para">
						For both EJB 2 and EJB 3, you can configure the stateful timeout in the <code class="filename">jboss-ejb3.xml</code> file. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss:ejb-jar</span><span xmlns="" class="perl_Others"> xmlns:jboss=</span><span xmlns="" class="perl_String">"http://www.jboss.com/xml/ns/javaee"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xmlns=</span><span xmlns="" class="perl_String">"http://java.sun.com/xml/ns/javaee"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xmlns:xsi=</span><span xmlns="" class="perl_String">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xmlns:c=</span><span xmlns="" class="perl_String">"urn:ejb-cache:1.0"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      xsi:schemaLocation=</span><span xmlns="" class="perl_String">"http://www.jboss.com/xml/ns/javaee http://www.jboss.org/j2ee/schema/jboss-ejb3-2_0.xsd http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/ejb-jar_3_1.xsd"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      version=</span><span xmlns="" class="perl_String">"3.1"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">      impl-version=</span><span xmlns="" class="perl_String">"2.0"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;enterprise-beans&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;session&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>HelloBean<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;session-type&gt;</span>Stateful<span xmlns="" class="perl_Keyword">&lt;/session-type&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;stateful-timeout&gt;</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;timeout&gt;</span>1320<span xmlns="" class="perl_Keyword">&lt;/timeout&gt;</span>
<span xmlns="" class="line">​</span>          <span xmlns="" class="perl_Keyword">&lt;unit&gt;</span>Seconds<span xmlns="" class="perl_Keyword">&lt;/unit&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/stateful-timeout&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/session&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/enterprise-beans&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;assembly-descriptor&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;c:cache&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>*<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;c:cache-ref&gt;</span>my-cache<span xmlns="" class="perl_Keyword">&lt;/c:cache-ref&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/c:cache&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/assembly-descriptor&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss:ejb-jar&gt;</span></pre>

					</div></li>

			</ul></li></ol></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Additional Information</div>
			<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						To disable passivation of stateful session beans, do one of the following: 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									If you implement stateful session beans using EJB 3 annotations, you can disable the passivation of the stateful session bean the annotation <code class="code">@org.jboss.ejb3.annotation.Cache("NoPassivationCache")</code>
								</div></li><li class="listitem"><div class="para">
									If the stateful session bean is configured in the <code class="filename">jboss-ejb3.xml</code> file, set the <code class="code">&lt;c:cache-ref&gt;</code> element value to "simple", which is the equivalent of <code class="code">NoPassivationCache</code>. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;c:cache-ref&gt;</span>simple<span xmlns="" class="perl_Keyword">&lt;/c:cache-ref&gt;</span></pre>

								</div></li></ul></div>

					</div></li><li class="listitem"><div class="para">
						EJB cache policy "LRUStatefulContextCachePolicy" has been changed in JBoss EAP 6 so it is impossible to have 1-to-1 configuration mapping in JBoss EAP 6.
					</div></li><li class="listitem"><div class="para">
						In JBoss EAP 6, you can set up the following cache properties: 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									Bean life time is configured using the @StatefulTimeout in EJB 3.1.
								</div></li><li class="listitem"><div class="para">
									Configure passivation of a bean to disk in the <code class="literal">ejb3</code> subsystem of the server configuration file using the <code class="literal">idle-timeout</code> attribute of the <code class="code">&lt;file-passivation-store&gt;</code> element.
								</div></li><li class="listitem"><div class="para">
									Configure the maximum size of the passivation store in the <code class="literal">ejb3</code> subsystem of the server configuration file using the <code class="literal">max-size</code> attribute of the <code class="code">&lt;file-passivation-store&gt;</code> element.
								</div></li></ul></div>

					</div></li><li class="listitem"><div class="para">
						In JBoss EAP 6, you can not configure the following cache properties: 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									The minimum and maximum numbers in memory cache.
								</div></li><li class="listitem"><div class="para">
									The minimum numbers in passivation store.
								</div></li><li class="listitem"><div class="para">
									The <code class="code">*-period</code> configurations that control the frequency of cache operations.
								</div></li></ul></div>

					</div></li></ul></div>

		</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44640-766956+%5BLatest%5D&amp;comment=Title%3A+Configure+Stateful+Session+Bean+Cache%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44640-766956+06+Aug+2015+07%3A42+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_Stateless_Session_Bean_Pool_Size">
      ⁠</a>3.2.13.3. Configure Stateless Session Bean Pool Size</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			In JBoss EAP 5, stateless EJB pool defaults were configured in <code class="filename"><em class="replaceable">EAP_HOME</em>/server/<em class="replaceable">PROFILE</em>/deploy/ejb3-interceptors-aop.xml</code> file. The following is an example of pool configuration in JBoss EAP 5. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;domain</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"Stateless Bean"</span><span xmlns="" class="perl_Others"> extends=</span><span xmlns="" class="perl_String">"Intercepted Bean"</span><span xmlns="" class="perl_Others"> inheritBindings=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;annotation</span><span xmlns="" class="perl_Others"> expr=</span><span xmlns="" class="perl_String">"class(*) AND !class(@org.jboss.ejb3.annotation.Pool)"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>	  @org.jboss.ejb3.annotation.Pool (value="ThreadlocalPool", maxSize=30, timeout=10000)
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/annotation&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/domain&gt;</span></pre>
			 This topic describes how to configure EJB session bean stateless pools in JBoss EAP 6.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Configure the Default Stateless Session Bean Pool Size in JBoss EAP 6</div>
			In JBoss EAP 6, stateless session bean pools are configured in the <code class="code">&lt;bean-instance-pools&gt;</code> section of the <code class="literal">ejb3</code> subsytem in the server configuration file. The default pool for stateless session beans is the "slsb-strict-max-pool". You can define additional configurations in the <code class="code">&lt;bean-instance-pools&gt;</code>. The following example defines a new configuration named "my-stateless-bean-pool" in JBoss EAP 6. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:ejb3:1.3"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;session-bean&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;stateless&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;bean-instance-pool-ref</span><span xmlns="" class="perl_Others"> pool-name=</span><span xmlns="" class="perl_String">"slsb-strict-max-pool"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/stateless&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;stateful</span><span xmlns="" class="perl_Others"> default-access-timeout=</span><span xmlns="" class="perl_String">"5000"</span><span xmlns="" class="perl_Others"> cache-ref=</span><span xmlns="" class="perl_String">"simple"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;singleton</span><span xmlns="" class="perl_Others"> default-access-timeout=</span><span xmlns="" class="perl_String">"5000"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/session-bean&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;pools&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;bean-instance-pools&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;strict-max-pool</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"slsb-strict-max-pool"</span><span xmlns="" class="perl_Others"> max-pool-size=</span><span xmlns="" class="perl_String">"20"</span><span xmlns="" class="perl_Others"> instance-acquisition-timeout=</span><span xmlns="" class="perl_String">"5"</span><span xmlns="" class="perl_Others"> instance-acquisition-timeout-unit=</span><span xmlns="" class="perl_String">"MINUTES"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;strict-max-pool</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"mdb-strict-max-pool"</span><span xmlns="" class="perl_Others"> max-pool-size=</span><span xmlns="" class="perl_String">"20"</span><span xmlns="" class="perl_Others"> instance-acquisition-timeout=</span><span xmlns="" class="perl_String">"5"</span><span xmlns="" class="perl_Others"> instance-acquisition-timeout-unit=</span><span xmlns="" class="perl_String">"MINUTES"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;strict-max-pool</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"my-stateless-bean-pool"</span><span xmlns="" class="perl_Others"> max-pool-size=</span><span xmlns="" class="perl_String">"50"</span><span xmlns="" class="perl_Others"> instance-acquisition-timeout=</span><span xmlns="" class="perl_String">"20"</span><span xmlns="" class="perl_Others"> instance-acquisition-timeout-unit=</span><span xmlns="" class="perl_String">"SECONDS"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/bean-instance-pools&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/pools&gt;</span>
<span xmlns="" class="line">​</span>  ...
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/subsystem&gt;</span>
</pre>

		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Configure an EJB to Use a Bean Pool in JBoss EAP 6</div>
			You can associate an EJB with a pool using one of the following approaches. 
			<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						Associate the EJB to the pool using annotations, where the value is the name of the pool defined in the server configuration file. The following is an example that associates the EJB to the "my-stateless-bean-pool" in JBoss EAP 6. 
<pre class="programlisting"><span xmlns="" class="line">​</span>@Stateless
<span xmlns="" class="line">​</span>@org.<span xmlns="" class="perl_Function">jboss</span>.<span xmlns="" class="perl_Function">ejb3</span>.<span xmlns="" class="perl_Function">annotation</span>.<span xmlns="" class="perl_Function">Pool</span>(value=<span xmlns="" class="perl_String">"my-stateless-bean-pool"</span>)
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">public</span> <span xmlns="" class="perl_Keyword">class</span> MyBean....</pre>

					</div></li><li class="listitem"><div class="para">
						Associate the EJB to the pool by configuring the <code class="filename">jboss-ejb3.xml</code> file in the EJB JAR <code class="filename">META-INF/</code> directory. The following example associates the EJB to the pool using the jboss-ejb3.xml file in JBoss EAP 6. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://java.sun.com/xml/ns/javaee"</span><span xmlns="" class="perl_Others"> xmlns:p=</span><span xmlns="" class="perl_String">"urn:ejb-pool:1.0"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span> .... 
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;assembly-descriptor&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;p:pool&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;ejb-name&gt;</span>MyBean<span xmlns="" class="perl_Keyword">&lt;/ejb-name&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;p:bean-instance-pool-ref&gt;</span>my-stateless-bean-pool<span xmlns="" class="perl_Keyword">&lt;/p:bean-instance-pool-ref&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/p:pool&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/assembly-descriptor&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss&gt;</span>
</pre>

					</div></li></ul></div>
			 <code class="filename"/>
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Disable Stateless Session Bean Pooling in JBoss EAP 6</div>
			If EJB instance memory is not an issue and the EJB instance is not doing costly initialization in its <code class="code">PostConstruct</code> method, it can be useful to disable pooling by default. When the pool is not used, any thread that invokes a method on an EJB simply creates an instance of the EJB, invokes the method on it, and then destroys the EJB instance.
		</div><div class="para">
		To disable pooling, remove the stateless EJB <code class="code">&lt;bean-instance-pool-ref&gt;</code> element in the <code class="literal">ejb3</code> subsystem of the server configuration file. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:ejb3:1.3"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;session-bean&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;stateless&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Comment">&lt;!-- Remove the following line --&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;bean-instance-pool-ref</span><span xmlns="" class="perl_Others"> pool-name=</span><span xmlns="" class="perl_String">"slsb-strict-max-pool"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/stateless&gt;</span>
<span xmlns="" class="line">​</span>    ...
</pre>

	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44581-766839+%5BLatest%5D&amp;comment=Title%3A+Configure+Stateless+Session+Bean+Pool+Size%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44581-766839+05+Aug+2015+10%3A26+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Replace_the_jboss.xml_File">
      ⁠</a>3.2.13.4. Replace the jboss.xml File</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Summary</div>
			The <code class="filename">jboss-ejb3.xml</code> deployment descriptor replaces the <code class="filename">jboss.xml</code> deployment descriptor file. This file is used to override and add to the features provided by the Java Enterprise Edition (EE) defined <code class="filename">ejb-jar.xml</code> deployment descriptor. The new file is incompatible with <code class="filename">jboss.xml</code>, and the <code class="filename">jboss.xml</code> is now ignored in deployments.
		</div><div class="para">
		If your application uses EJB 2.x, you must replace the <code class="filename">jboss.xml</code> file with the <code class="filename">jboss-ejb3.xml</code> deployment descriptor file. If your application uses EJB 3.x, you can use the <code class="filename">jboss-ejb3.xml</code> file, or you might be able eliminate it entirely by using EJB3 annotations.
	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Replace the jboss.xml File with the jboss-ejb3.xml File</div>
			In previous releases of JBoss EAP, if you defined a <code class="sgmltag-element">&lt;resource-ref&gt;</code> in the <code class="filename">ejb-jar.xml</code> file, you needed a corresponding resource definition for the JNDI name in the <code class="filename">jboss.xml</code> file. XDoclet automatically generated both of these deployment descriptor files. In JBoss EAP 6, the JNDI mapping information is now defined in the <code class="filename">jboss-ejb3.xml</code> file. Assume the datasource is defined in the Java source code as follows. 
<pre class="programlisting JAVA"><span xmlns="" class="line">​</span>DataSource ds1 = (DataSource) <span xmlns="" class="perl_Keyword">new</span> InitialContext().<span xmlns="" class="perl_Function">lookup</span>(<span xmlns="" class="perl_String">"java:comp/env/jdbc/Resource1"</span>);
<span xmlns="" class="line">​</span>DataSource ds2 = (DataSource) <span xmlns="" class="perl_Keyword">new</span> InitialContext().<span xmlns="" class="perl_Function">lookup</span>(<span xmlns="" class="perl_String">"java:comp/env/jdbc/Resource2"</span>);
</pre>
			 The <code class="filename">ejb-jar.xml</code> defines the following resource references. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;resource-ref</span> <span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;res-ref-name&gt;</span>jdbc/Resource1<span xmlns="" class="perl_Keyword">&lt;/res-ref-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;res-type&gt;</span>javax.sql.DataSource<span xmlns="" class="perl_Keyword">&lt;/res-type&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;res-auth&gt;</span>Container<span xmlns="" class="perl_Keyword">&lt;/res-auth&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/resource-ref&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;resource-ref</span> <span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;res-ref-name&gt;</span>java:comp/env/jdbc/Resource2<span xmlns="" class="perl_Keyword">&lt;/res-ref-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;res-type&gt;</span>javax.sql.DataSource<span xmlns="" class="perl_Keyword">&lt;/res-type&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;res-auth&gt;</span>Container<span xmlns="" class="perl_Keyword">&lt;/res-auth&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/resource-ref&gt;</span></pre>

		</div><div class="para">
		The <code class="filename">jboss-ejb3.jxml</code> file maps the JNDI names to the references using the following XML syntax. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;resource-ref&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;res-ref-name&gt;</span>jdbc/Resource1<span xmlns="" class="perl_Keyword">&lt;/res-ref-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;jndi-name&gt;</span>java:jboss/datasources/ExampleDS<span xmlns="" class="perl_Keyword">&lt;/jndi-name&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/resource-ref&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;resource-ref&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;res-ref-name&gt;</span>java:comp/env/jdbc/Resource2<span xmlns="" class="perl_Keyword">&lt;/res-ref-name&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;jndi-name&gt;</span>java:jboss/datasources/ExampleDS<span xmlns="" class="perl_Keyword">&lt;/jndi-name&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/resource-ref&gt;</span></pre>

	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Handle Missing jboss.xml Configuration Attributes</div>
			Some of the configuration options that were available in the JBoss EAP 5.x <code class="filename">jboss.xml</code> file were not implemented in JBoss EAP 6. The following list describes some of the commonly used attributes in the <code class="filename">jboss.xml</code> file and whether there is an alternate way to achieve them in JBoss EAP 6.
		</div><div class="para">
		<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					The <code class="code">method-attribute</code> element was used to configure individual entity and session beans methods. 
					<div class="itemizedlist"><ul><li class="listitem"><div class="para">
								The <code class="code">read-only</code> and <code class="code">idempotent</code> configuration options were not ported to JBoss EAP 6.
							</div></li><li class="listitem"><div class="para">
								The <code class="code">transaction-timeout</code> option is now configured in the <code class="filename">jboss-ejb3.xml</code> file.
							</div></li></ul></div>

				</div></li><li class="listitem"><div class="para">
					The <code class="code">missing-method-permission-exclude-mode</code> attribute changed the behavior of methods without implementing explicit security metadata on a secured bean. In JBoss EAP 6, the absence of a <code class="code">@RolesAllowed</code> annotation is currently treated in a similar manner to the <code class="code">@PermitAll</code>
				</div></li></ul></div>
		 Additional examples of <code class="filename">jboss-ejb3.xml</code> file configuration are located in the topics entitled <em class="citetitle">Specifying a Resource Adapter in jboss-ejb3.xml for an MDB</em>, <em class="citetitle">Configure a Container Interceptor</em>, and <em class="citetitle">jboss-ejb3.xml Deployment Descriptor Reference</em> in the <em class="citetitle">Enterprise JavaBeans</em> chapter of the <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">Development Guide</a> for JBoss EAP.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44600-781535+%5BLatest%5D&amp;comment=Title%3A+Replace+the+jboss.xml+File%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44600-781535+13+Nov+2017+12%3A22+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-EJB_2.x_and_Earlier_Changes">
      ⁠</a>3.2.14. EJB 2.x and Earlier Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="EJB_1.x_and_EJB_2.x_Deprecated_Features">
      ⁠</a>3.2.14.1. EJB 1.x and EJB 2.x Deprecated Features</h3></div></div></div><div class="para">
		JBoss EAP 6 was built on open standards and is compliant with the Java Enterprise Edition 6 specification. While the application server provides support for EJB 1.1 and EJB 2.x, it may no longer support features which go beyond the specification. Keep in mind that the Java EE 6 specification deprecated the following features. 
		<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					EJB 2.1 and earlier CMP and BMP entity bean
				</div></li><li class="listitem"><div class="para">
					Client view of an EJB 2.1 entity bean
				</div></li><li class="listitem"><div class="para">
					EJB QL for CMP entity bean queries
				</div></li><li class="listitem"><div class="para">
					JAX-RPC-based web service endpoints and client view
				</div></li></ul></div>

	</div><div class="para">
		The EE 7 specification has made these features optional, so it is strongly recommended that you rewrite your application code to use the EJB 3.x specification and JPA.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44639-765585+%5BLatest%5D&amp;comment=Title%3A+EJB+1.x+and+EJB+2.x+Deprecated+Features%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44639-765585+21+Jul+2015+12%3A52+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sect-Changes_Required_for_Applications_That_Use_EJB_1.x_and_EJB_2.x">
      ⁠</a>3.2.14.2. Changes Required for Applications That Use EJB 1.x and EJB 2.x</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Configuration_Changes_Required_to_Run_EJB_2.x">
      ⁠</a>3.2.14.2.1. Configuration Changes Required to Run EJB 2.x</h4></div></div></div><div class="para">

	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Start the Server With the Full Profile</div>
			EJB 2.x Container Managed Persistence (CMP) beans require the Java Enterprise Edition 6 Full Profile. This profile contains configuration elements that are needed to run CMP EJBs.
		</div><div class="para">
		This configuration profile contains the <code class="literal">org.jboss.as.cmp</code> extension module: 
<pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;extensions&gt;</span>
<span xmlns="" class="line">​</span>    ...
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;extension</span><span xmlns="" class="perl_Others"> module=</span><span xmlns="" class="perl_String">"org.jboss.as.cmp"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    ...
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/extensions&gt;</span></pre>
		 It also contains the <code class="literal">cmp</code> subsystem: 
<pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;profiles&gt;</span>
<span xmlns="" class="line">​</span>    ...
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:cmp:1.1"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    ...
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/profiles&gt;</span></pre>
		 .
	</div><div class="para">
		To start a JBoss EAP 6 standalone server with the full profile, pass the <em class="parameter"><code>-c standalone-full.xml</code></em> or <em class="parameter"><code>-c standalone-full-ha.xml</code></em> argument on the command line when you start the server.
	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Container Configuration Is No Longer Supported</div>
			In previous versions of JBoss EAP, it was possible to configure a different container for CMP entity and other beans and use it by setting references inside the <code class="filename">jboss.xml</code> application deployment descriptor file. For example, there were different configurations for SLSB to session beans in general.
		</div><div class="para">
		In JBoss EAP 6.x, it is possible to use EJB 2 Entity beans with a standard container. However, the different container configurations are no longer supported. The recommended approach is to migrate the EJB2 Stateful Session Beans (SFSB), Stateless Session Beans (SLSB), Message Driven Beans (MDB) to EJB 3, and for the Container-Managed Persistence (CMP) and Bean-Managed Persistence (BMP) Entity Beans to use the Java Persistence API (JPA) according to the EJB 3 specification.
	</div><div class="para">
		The default container configuration in JBoss EAP 6 contains several changes for EJB 2 CMP beans: 
		<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					Pessimistic locking is active by default. This can result in deadlocks.
				</div></li><li class="listitem"><div class="para">
					The deadlock detection code that was in the CMP layer in JBoss EAP 5.x is no longer in JBoss EAP 6.
				</div></li></ul></div>

	</div><div class="para">
		In JBoss EAP 5.x, it was also possible to customize caching, pooling, <code class="code">commit-options</code>, and the interceptor stack. In JBoss EAP 6, this is no longer possible. There is only one implementation, which is similar to the <code class="literal">Instance Per Transaction</code> policy with <code class="code">commit-option</code> <code class="literal">C</code>. If you migrate an application that uses the <code class="literal">cmp2.x jdbc2 pm</code> entity bean container configuration, which uses CMP2.x compatible JDBC based persistence manager, there will be a performance impact. This container was optimized for performance. It is recommended that you migrate these entities to EJB 3 before migrating the application.
	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Server Side Interceptor Configuration</div>
			JBoss EAP 6 supports the standard Java EE <code class="classname">Interceptor</code> using the <code class="code">@Interceptors</code> and <code class="code">@AroundInvoke</code> annotations. However, this does not allow manipulation outside the Security or Transaction.
		</div><div class="para">
		In previous versions of JBoss EAP, it was possible to modify the interceptor stack to have custom Interceptors for each EJB invocation. This was often used to implement customized security or retry mechanisms before security checks or transaction checks or creation. JBoss EAP 6.1 introduced container interceptors to provide similar functionality. For more information about container interceptors, see the chapter entitled <em class="citetitle">Container Interceptors</em> in the <em class="citetitle">Development Guide</em> for JBoss EAP.
	</div><div class="para">
		Another approach to provide more control before, during, or after the commit phase of a transaction while keeping with the Java EE specification is to use the Transaction Synchronization Registry to add a listener.
	</div><div class="para">
		The resource can be retrieved using one of the following methods: 
		<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					Use the <code class="classname">InitialContext</code>
<pre class="programlisting Java"><span xmlns="" class="line">​</span>TransactionSynchronizationRegistry tsr = (TransactionSynchronizationRegistry) 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">new</span> InitialContext().<span xmlns="" class="perl_Function">lookup</span>(<span xmlns="" class="perl_String">"java:jboss/TransactionSynchronizationRegistry"</span>);
<span xmlns="" class="line">​</span>tsr.<span xmlns="" class="perl_Function">registerInterposedSynchronization</span>(<span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">MyTxCallback</span>());
</pre>

				</div></li><li class="listitem"><div class="para">
					Use Injection 
<pre class="programlisting Java"><span xmlns="" class="line">​</span>@<span xmlns="" class="perl_Function">Resource</span>(mappedName = <span xmlns="" class="perl_String">"java:comp/TransactionSynchronizationRegistry"</span>)
<span xmlns="" class="line">​</span>TransactionSynchronizationRegistry tsr;
<span xmlns="" class="line">​</span>...
<span xmlns="" class="line">​</span>tsr.<span xmlns="" class="perl_Function">registerInterposedSynchronization</span>(<span xmlns="" class="perl_Keyword">new</span> <span xmlns="" class="perl_Function">MyTxCallback</span>());
</pre>

				</div></li></ul></div>
		 The callback routine must implement the <code class="classname">javax.transaction.Synchronization</code> Interface. Use the <code class="code">beforeCompletion{}</code> method to perform any checks before the transaction is committed or rolled back. If a <code class="classname">RuntimeException</code> is thrown from this method, the transaction is rolled back and the client is informed with a <code class="classname">EJBTransactionRolledbackException</code>. In case of an XA-Transaction, all resources will be rolled back according to the XA contract. It is also possible for enable business logic to depend on the transaction state using the <code class="code">afterCompletion(int txStatus)</code> method. If a <code class="classname">RuntimeException</code> is thrown from this method, the transaction remains in the former state, either committed or rolled-back, and the client is not informed. Only the transaction manager shows a warning within the server log files.
	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Server Side Configuration for Client Side Interceptors</div>
			In previous versions of JBoss EAP, it was possible to configure the client interceptors within the server configuration and provide only the classes with the client API.
		</div><div class="para">
		In JBoss EAP 6, this is no longer possible because the client Proxy is no longer created on the server side and transmitted to the client after the lookup. The proxy is now generated on the client side. This optimization avoids a server invocation for the lookup and class uploads,
	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Entity Bean Pool Configuration</div>
			Entity bean pool configuration is not recommended in JBoss EAP 6. Because it is limited to configuration of the <code class="sgmltag-element">&lt;strict-max-pool&gt;</code> element, deadlocks and other issues can occur if the pool is too small to load all entities in the result set. Entity beans do not have large lifecycle methods during initialization, so creating the instance and surrounding container is no slower than when using a pooled entity bean instance.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Replace the jboss.xml Deployment Descriptor File</div>
			The <code class="filename">jboss-ejb3.xml</code> deployment descriptor replaces the <code class="filename">jboss.xml</code> deployment descriptor file. This file is used to override and add to the features provided by the Java Enterprise Edition (EE) defined <code class="filename">ejb-jar.xml</code> deployment descriptor. The new <code class="filename">jboss-ejb3.xml</code> file is incompatible with the <code class="filename">jboss.xml</code> file, which is now ignored in deployments. For more information, see  <a class="xref" href="chap-Migrate_Your_Application.html#Replace_the_jboss.xml_File">Section 3.2.13.4, “Replace the jboss.xml File”</a>.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">DataSource Type Mapping Configuration</div>
			In previous versions of JBoss EAP, it was possible to configure the datasource type-mapping within the <code class="filename">*-ds.xml</code> datasource deployment configuration file.
		</div><div class="para">
		In JBoss EAP 6, this must now be done in the <code class="filename">jbosscmp-jdbc.xml</code> deployment descriptor file. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;defaults&gt;</span>  
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;datasource-mapping&gt;</span>mySQL<span xmlns="" class="perl_Keyword">&lt;/datasource-mapping&gt;</span>  
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;create-table&gt;</span>true<span xmlns="" class="perl_Keyword">&lt;/create-table&gt;</span>  
<span xmlns="" class="line">​</span>    ....  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/defaults&gt;</span></pre>

	</div><div class="para">
		In previous versions of JBoss EAP, customized mapping was done in the <code class="filename">standardjbosscmp-jdbc.xml</code> file. This file is no longer available and mapping is now done in the <code class="filename">jbosscmp-jdbc.xml</code> deployment descriptor file.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+45364-779868+%5BLatest%5D&amp;comment=Title%3A+Configuration+Changes+Required+to+Run+EJB+2.x%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=45364-779868+20+Sep+2016+07%3A30+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Container-Managed_Persistence_and_Container-Managed_Relationship_Changes_Required_for_EJB_2.x">
      ⁠</a>3.2.14.2.2. Container-Managed Persistence and Container-Managed Relationship Changes Required for EJB 2.x</h4></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Container Managed Relationship (CMR) Iterator and Collection Changes</div>
			In previous releases of JBoss EAP, it was possible for some containers, for example the <code class="literal">cmp2.x jdbc2 pm</code> container, to iterate CMR collections and remove or add relations. Because container configuration is not supported, this is no longer possible in JBoss EAP 6. For information about how to achieve this same functionality in the application code, see <a href="https://access.redhat.com/solutions/330463">EJB2.1 Finder for CMP entities with relations (CMR) returns duplicates in EAP6</a> in the Support Knowledgebase Solutions section of the Customer Portal .
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Container Managed Relationship (CMR) Duplicate Entries for Finders</div>
			In previous versions of JBoss EAP, it was possible to select different CMP containers which used different persistence strategies. The <code class="literal">cmp2.x jdbc2 pm</code> container in JBoss EAP 5.x used optimized <code class="literal">SQL-92</code> to generate optimized LEFT OUTER JOIN syntax for finders. Because JBoss EAP 6.x only supports the standard container for CMP and CMR, the implementation does not contain these optimizations. The finder should include the keyword <code class="literal">DISTINCT</code> in the <code class="literal">SELECT</code> statement to avoid cartesian product in the result set. For more information , see <a href="https://access.redhat.com/solutions/330463">EJB2.1 Finder for CMP entities with relations (CMR) returns duplicates in EAP6</a> in the Support Knowledgebase Solutions section of the Customer Portal.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Cascade Delete Default Change for CMP Entity Beans</div>
			The cascade delete default value has changed to <code class="literal">false</code>. This can result in delete failures in JBoss EAP 6. If entity relations are marked as <code class="literal">cascade-delete</code>, you must explicitly set the <code class="literal">batch-cascade-delete</code> to <code class="literal">true</code> in the <code class="filename">jbosscmp-jdbc.xml</code> file. For more information , see <a href="https://access.redhat.com/solutions/315153">cascade delete fail for EJB2 CMP Entities after migration to EAP6</a> in the Support Knowledgebase Solutions section of the Customer Portal.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">CMP Customized Mappers for Custom Fields</div>
			If you used customer mapper classes such as <code class="classname">JDBCParameterSetter</code>, <code class="classname">JDBCResultSetReader</code> and <code class="classname">Mapper</code> in your JBoss EAP 5.x application, you might see <code class="classname">java.lang.ClassNotFoundException</code> when you deploy your application to JBoss EAP 6. This is because the package names for the interfaces were changed from <code class="classname">org.jboss.ejb.plugins.cmp.jdbc.Mapper</code> to <code class="classname">org.jboss.as.cmp.jdbc.Mapper</code>. For more information , see <a href="https://access.redhat.com/solutions/779293">How to use Field mapping for custom classes in an EJB2 CMP application in EAP6</a> in the Support Knowledgebase Solutions section of the Customer Portal.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Generation of Primary Keys Using entity-commands</div>
			If your JBoss EAP 5 application uses <code class="literal">entity-commands</code> to generate primary keys, for example <code class="literal">Sequence</code> or <code class="literal">Auto-increment</code>, you might see a <code class="classname">ClassNotFoundException</code> for the <code class="classname">JDBCOracleSequenceCreateCommand</code> class when you migrate your application to JBoss EAP 6. This is because the class package was changed from <code class="code"> org.jboss.ejb.plugins.cmp.jdbc</code> to <code class="code">org.jboss.as.cmp.jdbc.keygen</code>. If you use this class in your JBoss EAP 6 application, you must also add a dependency on the <code class="filename">EAP_HOME/modules/system/layers/base/org/jboss/as/cmp</code> module.
		</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+45365-779896+%5BLatest%5D&amp;comment=Title%3A+Container-Managed+Persistence+and+Container-Managed+Relationship+Changes+Required+for+EJB+2.x%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=45365-779896+20+Sep+2016+15%3A49+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Application_Changes_Required_to_Run_EJB_2.x">
      ⁠</a>3.2.14.2.3. Application Changes Required to Run EJB 2.x</h4></div></div></div><div class="para">

	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Modify the Code to Use the New JNDI Namespace Rules</div>
			As with EJB 3.0, you must use the full JNDI prefix with EJB 2.x. For more information on the new JNDI namespace rules and code examples, see  <a class="xref" href="chap-Migrate_Your_Application.html#Update_Application_JNDI_Namespace_Names1">Section 3.1.8.1, “Update Application JNDI Namespace Names”</a>.
		</div><div class="para">
		Examples showing how to update JNDI namespaces from previous releases can be found here:  <a class="xref" href="chap-Migrate_Your_Application.html#Examples_of_JNDI_Namespaces_in_Previous_Releases_and_How_They_are_Specified_in_JBoss_Enterprise_Application_Platform_61">Section 3.1.8.5, “Examples of JNDI Namespaces in Previous Releases and How They are Specified in JBoss EAP 6”</a>.
	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Modify the jboss-web.xml File Descriptor</div>
			Modify the <code class="code">&lt;jndi-name&gt;</code> for each <code class="code">&lt;ejb-ref&gt;</code> to use the new JNDI fully qualified lookup format.
		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Use XDoclet to Map JNDI Name of Internal Local Interfaces</div>
			With EJB 2, it was very common to use the <code class="literal">Locator</code> pattern to look up Beans. If you used this pattern in your application, rather than modify application code, you can use <a href="http://doclet.sourceforge.net/xdoclet/index.html">XDoclet</a> to generate a map for the new JNDI names.
		</div><div class="para">
		A typical XDoclet annotation looks like this: 
<pre class="programlisting Java"><span xmlns="" class="line">​</span>@ejb.<span xmlns="" class="perl_Function">bean</span> name=<span xmlns="" class="perl_String">"UserAttribute"</span> display-name=<span xmlns="" class="perl_String">"UserAttribute"</span> local-jndi-name=<span xmlns="" class="perl_String">"ejb21/UserAttributeEntity"</span> view-type=<span xmlns="" class="perl_String">"local"</span> type=<span xmlns="" class="perl_String">"CMP"</span> cmp-version=<span xmlns="" class="perl_String">"2.x"</span> primkey-field=<span xmlns="" class="perl_String">"id"</span></pre>
		 The JNDI name <code class="code">ejb21/UserAttributeEntity</code> in the above example is no longer valid in JBoss EAP 6. You can map this name to a valid JNDI name using the <code class="literal">naming</code> subsystem in the server configuration and a patch for XDoclet.
	</div><div class="para">
		You can create customized mappers, as noted in the paragraph above entitled <em class="citetitle">CMP Customized Mappers for Custom Fields</em> or you can modify the code as described in the following procedure.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819315533776">
      ⁠</a><p class="title"><strong>Procedure 3.29. Change the XDoclet Generated Code and Use the Naming Subsystem</strong></p><ol class="1"><li class="step"><div class="para">
				Extract the XDoclet <code class="filename">lookup.xdt</code> template located in the <code class="filename">ejb-module.jar</code> and modify the <code class="code">lookup()</code> in the <code class="code">lookupHome</code> as follows: 
<pre class="programlisting Java"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">private</span> <span xmlns="" class="perl_DataType">static</span> Object <span xmlns="" class="perl_Function">lookupHome</span>(java.<span xmlns="" class="perl_Function">util</span>.<span xmlns="" class="perl_Function">Hashtable</span> environment, String jndiName, <span xmlns="" class="perl_Keyword">Class</span> narrowTo) <span xmlns="" class="perl_Keyword">throws</span> javax.<span xmlns="" class="perl_Function">naming</span>.<span xmlns="" class="perl_Function">NamingException</span> {  
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">// Obtain initial context  </span>
<span xmlns="" class="line">​</span>    javax.<span xmlns="" class="perl_Function">naming</span>.<span xmlns="" class="perl_Function">InitialContext</span> initialContext = <span xmlns="" class="perl_Keyword">new</span> javax.<span xmlns="" class="perl_Function">naming</span>.<span xmlns="" class="perl_Function">InitialContext</span>(environment);  
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">try</span> { 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">// Replace the existing lookup      </span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">// Object objRef = initialContext.lookup(jndiName);  </span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">// This is the new mapped lookup</span>
<span xmlns="" class="line">​</span>        Object objRef;  
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">try</span> {  
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Comment">// try JBoss EAP mapping  </span>
<span xmlns="" class="line">​</span>            objRef = initialContext.<span xmlns="" class="perl_Function">lookup</span>(<span xmlns="" class="perl_String">"global/"</span>+jndiName);  
<span xmlns="" class="line">​</span>        } <span xmlns="" class="perl_Keyword">catch</span>(java.<span xmlns="" class="perl_Function">lang</span>.<span xmlns="" class="perl_Function">Exception</span> e) {  
<span xmlns="" class="line">​</span>            objRef = initialContext.<span xmlns="" class="perl_Function">lookup</span>(jndiName);  
<span xmlns="" class="line">​</span>        }  
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Comment">// only narrow if necessary  </span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">if</span> (java.<span xmlns="" class="perl_Function">rmi</span>.<span xmlns="" class="perl_Function">Remote</span>.<span xmlns="" class="perl_Function">class</span>.<span xmlns="" class="perl_Function">isAssignableFrom</span>(narrowTo))  
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">return</span> javax.<span xmlns="" class="perl_Function">rmi</span>.<span xmlns="" class="perl_Function">PortableRemoteObject</span>.<span xmlns="" class="perl_Function">narrow</span>(objRef, narrowTo); 
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">else</span>  
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">return</span> objRef;  
<span xmlns="" class="line">​</span>    } <span xmlns="" class="perl_Keyword">finally</span> {  
<span xmlns="" class="line">​</span>        initialContext.<span xmlns="" class="perl_Function">close</span>();  
<span xmlns="" class="line">​</span>    }  
<span xmlns="" class="line">​</span>}</pre>

			</div></li><li class="step"><div class="para">
				Run Ant, setting the template attribute to use the modified <code class="filename">lookup.xdt</code> for the <code class="code">ejbdoclet</code> task.
			</div></li><li class="step"><div class="para">
				Modify the <code class="literal">naming</code> subsystem in the server configuration file to map the old JNDI name to the new valid JNDI name. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;subsystem</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:domain:naming:1.2"</span><span xmlns="" class="perl_Keyword">&gt;</span>  
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;bindings&gt;</span>  
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;lookup</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"java:global/ejb21/UserAttributeEntity"</span><span xmlns="" class="perl_Others"> lookup=</span><span xmlns="" class="perl_String">"java:global/ejb2CMP/ejb/UserAttribute!de.wfink.ejb21.cmp.cmr.UserAttributeLocalHome"</span><span xmlns="" class="perl_Keyword">/&gt;</span>  
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/bindings&gt;</span>  
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;remote-naming/&gt;</span>  
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/subsystem&gt;</span></pre>

			</div></li></ol></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+45366-778643+%5BLatest%5D&amp;comment=Title%3A+Application+Changes+Required+to+Run+EJB+2.x%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=45366-778643+12+Jul+2016+15%3A29+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Known_Issues_with_EJB_2.x">
      ⁠</a>3.2.14.2.4. Known Issues with EJB 2.x</h4></div></div></div><div class="para">
		There is known issue with deployment of EJB 2.0 <code class="filename">ejb-jar.xml</code> descriptor files that define Message Driven Beans (MDBs) in releases of JBoss EAP 6.3 and older. The server throws a parsing error at the time of deployment and you see the following output in the server log. 
<pre class="screen">
ERROR [org.jboss.msc.service.fail] (MSC service thread 1-7) MSC000001: Failed to start service jboss.deployment.unit."<em class="replaceable">EJB_JAR_NAME</em>.jar".PARSE: org.jboss.msc.service.StartException in service jboss.deployment.unit."<em class="replaceable">EJB_JAR_NAME</em>jar".PARSE: JBAS018733: Failed to process phase PARSE of deployment "<em class="replaceable">EJB_JAR_NAME</em>.jar"
</pre>
		 This issue was fixed in JBoss EAP 6.4. See <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1057835">Bugzilla 1057835</a> for details.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+45367-778636+%5BLatest%5D&amp;comment=Title%3A+Known+Issues+with+EJB+2.x%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=45367-778636+12+Jul+2016+14%3A22+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="Summary_of_Obsolete_EJB_2.x_Files">
      ⁠</a>3.2.14.2.5. Summary of Obsolete EJB 2.x Files</h4></div></div></div><div class="para">
		The following files are no longer supported in JBoss EAP 6.
	</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">jboss.xml</span></dt><dd><div class="para">
					The <code class="filename">jboss.xml</code> application deployment descriptor file is no longer supported and ignored if included in the deployed archive. This file has been replaced by the <code class="filename">jboss-ejb3.xml</code> deployment descriptor file.
				</div></dd><dt><span class="term">standardjbosscmp-jdbc.xml</span></dt><dd><div class="para">
					The <code class="filename">standardjbosscmp-jdbc.xml</code> server configuration file is no longer supported. This configuration information is now included in the <code class="code">org.jboss.as.cmp</code> module and it is no longer customizable.
				</div></dd><dt><span class="term">standardjboss.xml</span></dt><dd><div class="para">
					The <code class="filename">standardjboss.xml</code> server configuration file is no longer supported. This configuration information is now included in the <code class="filename">standalone.xml</code> file when running a standalone server or the <code class="filename">domain.xml</code> file when running in a managed domain..
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+45368-778644+%5BLatest%5D&amp;comment=Title%3A+Summary+of+Obsolete+EJB+2.x+Files%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=45368-778644+12+Jul+2016+15%3A47+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-JBoss_AOP_Changes">
      ⁠</a>3.2.15. JBoss AOP Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Update_Applications_That_Use_JBoss_AOP">
      ⁠</a>3.2.15.1. Update Applications That Use JBoss AOP</h3></div></div></div><div class="para">
		JBoss AOP (Aspect Oriented Programming) is no longer included in JBoss EAP 6. In previous releases, JBoss AOP was used by the EJB container. In JBoss EAP 6, the EJB container uses a new mechanism. If your application uses JBoss AOP, you must modify your application code as follows.
	</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Refactor the Application</div>
			<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						Standard EJB3 configurations that were previously made in the <code class="filename">ejb3-interceptors-aop.xml</code> file are now configured in the server configuration file. For a standalone server, this is the <code class="filename">standalone/configuration/standalone-full.xml</code> file. If you are running your server in a managed domain, this is the <code class="filename">domain/configuration/domain.xml</code> file.
					</div></li><li class="listitem"><div class="para">
						Server side AOP Interceptors should be modified to use the standard Java EE <code class="code">Interceptor</code>. For more information about container interceptors and how to use a client side interceptor in an application, see the chapter entitled <em class="citetitle">Container Interceptors</em> in the <em class="citetitle">Development Guide</em> for JBoss EAP 6 located on the Customer Portal at <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
					</div></li></ul></div>

		</div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Use JBoss AOP Libraries</div>
			<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						If you are not able to refactor the code, you can obtain a copy of the JBoss AOP libraries and bundle them with the application. The AOP libraries may work in JBoss EAP 6, but are not deployed. You can manually deploy them by using the following command line argument when you start your server: <code class="command">-Djboss.aop.path=<em class="replaceable">PATH_TO_AOP_CONFIG</em></code>
					</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							Although the JBoss AOP libraries may work in JBoss EAP 6, this not a supported configuration.
						</div></div></div></li></ul></div>

		</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+20278-781539+%5BLatest%5D&amp;comment=Title%3A+Update+Applications+That+Use+JBoss+AOP%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=20278-781539+13+Nov+2017+12%3A37+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-JacORB_Changes">
      ⁠</a>3.2.16. JacORB Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="JacORB_Configuration_Changes">
      ⁠</a>3.2.16.1. JacORB Configuration Changes</h3></div></div></div><div class="para">
		In JBoss EAP 5, JacORB configuration was accomplished using properties specified in the <code class="filename"><em class="replaceable">EAP_HOME</em>/server/production/conf/jacorb.properties</code> file. The following is an example of JacORB properties configured in that file. 
<pre class="programlisting">
jacorb.connection.client.pending_reply_timeout=600000
jacorb.connection.client.idle_timeout=120000
jacorb.connection.server.timeout=300000
jacorb.native_char_codeset=UTF8
jacorb.native_wchar_codeset=UTF16
</pre>

	</div><div class="para">
		In JBoss EAP 6, JacORB properties are configured in the server configuration file using the Management CLI. For instructions to configure JacORB properties using the Management CLI, see the topic entitled <em class="citetitle">JacORB Configuration</em> in the <em class="citetitle">Administration and Configuration Guide</em> for JBoss Enterprise Application Platform located on the Customer Portal at <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44538-781555+%5BLatest%5D&amp;comment=Title%3A+JacORB+Configuration+Changes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44538-781555+13+Nov+2017+13%3A30+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-JBoss_Web_Component_Changes">
      ⁠</a>3.2.17. JBoss Web Component Changes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Map_HTTPHTTPSAJP_Connector_Attributes">
      ⁠</a>3.2.17.1. Map HTTP/HTTPS/AJP Connector Attributes</h3></div></div></div><div class="para">
		The following table shows how to map HTTP, HTTPS and AJP Connector attributes from previous releases to the new attributes in Red Hat JBoss Enterprise Application Platform 6.
	</div><div class="table"><a id="table-map-http-https-ajp-connector-attributes">
      ⁠</a><p class="title"><strong>Table 3.10. Map Connector Attributes</strong></p><div class="table-contents"><table xmlns:d="http://docbook.org/ns/docbook" class="lt-4-cols gt-14-rows" summary="Map Connector Attributes"><colgroup><col width="17%" style="text-align: left" class="c1"/><col width="17%" style="text-align: left" class="c2"/><col width="67%" style="text-align: left" class="c2"/></colgroup><thead><tr><th style="text-align: left"> Attribute Name in Previous Release </th><th style="text-align: left"> Equivalent in JBoss EAP 6 </th><th style="text-align: left"> Details </th></tr></thead><tbody><tr><td style="text-align: left"> maxThreads </td><td style="text-align: left"> max-connections </td><td style="text-align: left"> This attribute sizes the JBossWeb level thread/connection pool. It is set on the connectors in the web subsystem. The default is 512 per CPU core. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;connector</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"http"</span><span xmlns="" class="perl_Others"> protocol=</span><span xmlns="" class="perl_String">"HTTP/1.1"</span><span xmlns="" class="perl_Others"> scheme=</span><span xmlns="" class="perl_String">"http"</span><span xmlns="" class="perl_Others"> socket-binding=</span><span xmlns="" class="perl_String">"http"</span><span xmlns="" class="perl_Others"> enabled=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> max-connections=</span><span xmlns="" class="perl_String">"200"</span> <span xmlns="" class="perl_Keyword">/&gt;</span></pre>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						minSpareThreads
					</div>
					 <div class="para">
						maxSpareThreads
					</div>
					 </td><td style="text-align: left"> N/A </td><td style="text-align: left"> There is no equivalent for <code class="code">minSpareThreads</code> or <code class="code">maxSpareThreads</code> since there is little incentive to reclaim threads. If you use an executor for the connector instead of the default worker thread pool, The closest thing to this would be the <code class="code">core-threads</code> size and <code class="code">keepalive-time</code> attributes. </td></tr><tr><td style="text-align: left"> <div class="para">
						proxyName
					</div>
					 <div class="para">
						proxyPort
					</div>
					 </td><td style="text-align: left"> <div class="para">
						proxy-name
					</div>
					 <div class="para">
						proxy-port
					</div>
					 </td><td style="text-align: left"> This attribute is set on the <code class="literal">connector</code> in the <code class="literal">web</code> subsystem. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;connector</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"http"</span><span xmlns="" class="perl_Others"> protocol=</span><span xmlns="" class="perl_String">"HTTP/1.1"</span><span xmlns="" class="perl_Others"> scheme=</span><span xmlns="" class="perl_String">"http"</span><span xmlns="" class="perl_Others"> socket-binding=</span><span xmlns="" class="perl_String">"http"</span><span xmlns="" class="perl_Others"> enabled=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> proxy-name=</span><span xmlns="" class="perl_String">"proxy.com"</span><span xmlns="" class="perl_Others"> proxy-port=</span><span xmlns="" class="perl_String">"80"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						redirectPort
					</div>
					 </td><td style="text-align: left"> <div class="para">
						redirect-port
					</div>
					 </td><td style="text-align: left"> <div class="para">
						This attribute is set on the <code class="literal">connector</code> in the <code class="literal">web</code> subsystem. 
<pre class="programlisting"><span xmlns="" class="line">​</span>connector name="http" protocol="HTTP/1.1" scheme="https" secure="true" socket-binding="http" 
<span xmlns="" class="line">​</span>           redirect-port="8443" proxy-name="loadbalancer.hostname.com" proxy-port="443"</pre>

					</div>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						enableLookups
					</div>
					 </td><td style="text-align: left"> <div class="para">
						enable-lookups
					</div>
					 </td><td style="text-align: left"> <div class="para">
						This attribute is set on the <code class="literal">connector</code> in the <code class="literal">web</code> subsystem. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;connector</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"http"</span><span xmlns="" class="perl_Others"> protocol=</span><span xmlns="" class="perl_String">"HTTP/1.1"</span><span xmlns="" class="perl_Others"> scheme=</span><span xmlns="" class="perl_String">"http"</span><span xmlns="" class="perl_Others"> socket-binding=</span><span xmlns="" class="perl_String">"http"</span><span xmlns="" class="perl_Others"> enable-lookups=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>"</pre>

					</div>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						MaxHttpHeaderSize
					</div>
					 </td><td style="text-align: left"> System Property </td><td style="text-align: left"> This attribute is set using System Properties. The default value is 8 KB. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;system-properties&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.coyote.http11.Http11Protocol.MAX_HEADER_SIZE"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"8192"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/system-properties&gt;</span></pre>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						maxKeepAliveRequests
					</div>
					 </td><td style="text-align: left"> System Property </td><td style="text-align: left"> This attribute is set using System Properties. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;system-properties&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.coyote.http11.Http11Protocol.MAX_KEEP_ALIVE_REQUESTS"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"1"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/system-properties&gt;</span></pre>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						connectionTimeout
					</div>
					 </td><td style="text-align: left"> System Property </td><td style="text-align: left"> This attribute is set using System Properties. The following configurations set the AJP connectionTimeout to 600000 milliseconds (10 minutes) and the HTTP connectionTimeout to 120000 milliseconds (2 minutes). 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;system-properties&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- connectionTimeout for AJP connector. Default value is "-1" (no timeout). --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.coyote.ajp.DEFAULT_CONNECTION_TIMEOUT"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"600000"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Comment">&lt;!-- connectionTimeout for HTTP connector. Default value is "60000". --&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.coyote.http11.DEFAULT_CONNECTION_TIMEOUT"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"120000"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/system-properties&gt;</span></pre>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						compression
					</div>
					 </td><td style="text-align: left"> System Property </td><td style="text-align: left"> This attribute enables compression. You can specify the content type, which defaults to <code class="literal">text/html,text/xml,text/plain</code>. You can also specify the minimum size of content that is to be compressed, which defaults to <code class="literal">2048</code> bytes. Compression is set using System Properties. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;system-properties&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.coyote.http11.Http11Protocol.COMPRESSION"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"on"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.coyote.http11.Http11Protocol.COMPRESSION_MIN_SIZE"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"4096"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.coyote.http11.Http11Protocol.COMPRESSION_MIME_TYPES"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"text/javascript,text/css,text/html"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/system-properties&gt;</span></pre>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						URIEncoding
					</div>
					 </td><td style="text-align: left"> System Property </td><td style="text-align: left"> This attribute is set using System Properties. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;system-properties&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.catalina.connector.URI_ENCODING"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"UTF-8"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/system-properties&gt;</span></pre>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						useBodyEncodingForURI
					</div>
					 </td><td style="text-align: left"> System Property </td><td style="text-align: left"> This attribute is set using System Properties. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;system-properties&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.catalina.connector.USE_BODY_ENCODING_FOR_QUERY_STRING"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/system-properties&gt;</span></pre>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						server
					</div>
					 </td><td style="text-align: left"> System Property </td><td style="text-align: left"> This attribute is set using System Properties. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;system-properties&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.coyote.http11.Http11Protocol.SERVER"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"NewServerHeader"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span> <span xmlns="" class="perl_Keyword">&lt;/system-properties&gt;</span></pre>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						allowTrace
					</div>
					 </td><td style="text-align: left"> System Property </td><td style="text-align: left"> This attribute is set using System Properties. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;system-properties&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.catalina.connector.ALLOW_TRACE "</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span> <span xmlns="" class="perl_Keyword">&lt;/system-properties&gt;</span></pre>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						xpoweredby
					</div>
					 </td><td style="text-align: left"> System Property </td><td style="text-align: left"> This attribute is set using System Properties. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;system-properties&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.catalina.connector.X_POWERED_BY "</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span> <span xmlns="" class="perl_Keyword">&lt;/system-properties&gt;</span></pre>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						keepAliveTimeout
					</div>
					 </td><td style="text-align: left"> N/A </td><td style="text-align: left"> <div class="para">
						Prior to JBoss EAP 6.4, there was no equivalent parameter in JBoss EAP 6. Internally, it defaulted to the <code class="code">connectionTimeout</code> value.
					</div>
					 <div class="para">
						In JBoss EAP 6.4, a new system property, <code class="code">org.apache.coyote.http11.DEFAULT_KEEP_ALIVE_TIMEOUT</code>, was introduced to control keepAliveTimeout. The <code class="code">-Dorg.apache.coyote.http11.DEFAULT_KEEP_ALIVE_TIMEOUT</code> argument takes affect when used with the <code class="code">-Dorg.apache.coyote.http11.DEFAULT_DISABLE_UPLOAD_TIMEOUT=true</code> argument.
					</div>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						disableUploadTimeout
					</div>
					 <div class="para">
						connectionUploadTimeout
					</div>
					 </td><td style="text-align: left"> N/A </td><td style="text-align: left"> <div class="para">
						There are currently no equivalent parameters in JBoss EAP 6. The <code class="code">disableUploadTimeout</code> is true by default and the <code class="code">connectionUploadTimeout</code> internally uses the <code class="code">connectionTimeout</code> value.
					</div>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						packetSize
					</div>
					 </td><td style="text-align: left"> System Property </td><td style="text-align: left"> This attribute is set using System Properties. The following configurations set the AJP packetSize to <code class="literal">20000</code>
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;system-properties&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.coyote.ajp.MAX_PACKET_SIZE"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"20000"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/system-properties&gt;</span></pre>
					 </td></tr><tr><td style="text-align: left"> <div class="para">
						maxPostSize
					</div>
					 <div class="para">
						maxSavePostSize
					</div>
					 </td><td style="text-align: left"> <div class="para">
						max-post-size
					</div>
					 <div class="para">
						max-save-post-size
					</div>
					 </td><td style="text-align: left"> A value of <code class="literal">0</code> means unlimited. Note that this parameter can limit data size only when <code class="literal">Content-Type</code> is <code class="literal">application/x-www-form-urlencoded</code>. For more information, see this solution on the Customer Portal: <a href="https://access.redhat.com/solutions/26690">How to limit data size of HTTP POST method from a client to JBoss</a> </td></tr><tr><td style="text-align: left"> <div class="para">
						tomcatAuthentication
					</div>
					 </td><td style="text-align: left"> System Property </td><td style="text-align: left"> <div class="para">
						Depending on the version of JBoss EAP 6, this attribute is set using the System Property <code class="code">org.apache.coyote.ajp.AprProcessor.TOMCATAUTHENTICATION</code> or <code class="code">org.apache.coyote.ajp.DEFAULT_TOMCAT_AUTHENTICATION</code>. A patch or upgrade is required for all versions of the server.
					</div>
					 <div class="para">
						In JBoss EAP 6.0.1, tomcatAuthentication is configured using the following property. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;system-properties&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.coyote.ajp.AprProcessor.TOMCATAUTHENTICATION"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/system-properties&gt;</span></pre>

					</div>
					 <div class="para">
						In JBoss EAP 6.1 and later, tomcatAuthentication is configured as follows: 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;system-properties&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.apache.coyote.ajp.DEFAULT_TOMCAT_AUTHENTICATION"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/system-properties&gt;</span></pre>

					</div>
					 <div class="para">
						For more information, see this solution on the Customer Portal: <a href="https://access.redhat.com/solutions/238033">How to configure tomcatAuthentication in JBoss EAP 6</a>
					</div>
					 </td></tr></tbody></table></div></div><div class="para">
		For more information about connector attributes, see this solution on the Customer Portal: <a href="https://access.redhat.com/solutions/110003">Equivalent HTTP/HTTPS/AJP connector attributes mapping between JBoss EAP 5.x and JBoss EAP 6.x</a>
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+42388-747307+%5BLatest%5D&amp;comment=Title%3A+Map+HTTP%2FHTTPS%2FAJP+Connector+Attributes%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=42388-747307+16+Mar+2015+08%3A10+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_1-Way_SSL">
      ⁠</a>3.2.17.2. Configure 1-Way SSL</h3></div></div></div><div class="para">
		The method to configure 1-way SSL for the management interfaces has changed in JBoss EAP 6. This topic describes how to configure 1-way SSL in JBoss EAP 6.
	</div><div class="para">
		In JBoss EAP 5, you generated the certificate store. The <code class="filename">keystore.jks</code> file created by that process was placed in the <code class="filename"><em class="replaceable">EAP_HOME</em>/server/<em class="replaceable">PROFILE</em>/conf/</code> directory. You then configured the HTTP connector in the <code class="filename"><em class="replaceable">EAP_HOME</em>/server/<em class="replaceable">PROFILE</em>/deploy/jbossweb.sar/server.xml</code> file as follows. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;Connector</span><span xmlns="" class="perl_Others"> protocol=</span><span xmlns="" class="perl_String">"HTTP/1.1"</span><span xmlns="" class="perl_Others"> SSLEnabled=</span><span xmlns="" class="perl_String">"true"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  port=</span><span xmlns="" class="perl_String">"8443"</span><span xmlns="" class="perl_Others"> address=</span><span xmlns="" class="perl_String">"${jboss.bind.address}"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  scheme=</span><span xmlns="" class="perl_String">"https"</span><span xmlns="" class="perl_Others"> secure=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> clientAuth=</span><span xmlns="" class="perl_String">"false"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  keystoreFile=</span><span xmlns="" class="perl_String">"${jboss.server.home.dir}/conf/keystore.jks"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  keystorePass=</span><span xmlns="" class="perl_String">"password"</span><span xmlns="" class="perl_Others"> SSLProtocol</span> <span xmlns="" class="perl_Others">=</span> <span xmlns="" class="perl_String">"TLS"</span> <span xmlns="" class="perl_Keyword">/&gt;</span></pre>

	</div><div class="para">
		To configure the HTTP connector in JBoss EAP 6, you also generate the certificate store. Depending on whether you are running a standalone server or in a managed domain, the <code class="filename">keystore.jks</code> file created by that process is placed in the <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/configuration/</code> or <code class="filename"><em class="replaceable">EAP_HOME</em>/domain/configuration/</code> directory. The HTTP connector is then configured in the <code class="literal">web</code> subsystem of the server configuration file as follows. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;connector</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"https"</span><span xmlns="" class="perl_Others"> protocol=</span><span xmlns="" class="perl_String">"HTTP/1.1"</span><span xmlns="" class="perl_Others"> scheme=</span><span xmlns="" class="perl_String">"https"</span><span xmlns="" class="perl_Others"> socket-binding=</span><span xmlns="" class="perl_String">"https"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;ssl</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ssl"</span><span xmlns="" class="perl_Others"> key-alias=</span><span xmlns="" class="perl_String">"jboss"</span><span xmlns="" class="perl_Others"> password=</span><span xmlns="" class="perl_String">"password"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">    certificate-key-file=</span><span xmlns="" class="perl_String">"${jboss.server.config.dir}/keystore.jks"</span> 
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">    protocol=</span><span xmlns="" class="perl_String">"TLSv1"</span><span xmlns="" class="perl_Others"> verify-client=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/connector&gt;</span></pre>

	</div><div class="para">
		If you installed the Native Components for your operating system with the JBoss EAP installation and have also installed Apache Portability Runtime (APR), you can instead choose to configure 1-way SSL using the APR connector. Like the HTTP connector, the APR connector is configured in the <code class="literal">web</code> subsystem of the server configuration file, however, the connector protocol is set to "org.apache.coyote.http11.Http11AprProtocol".
	</div><div class="para">
		Regardless of the method you choose, be sure to restart the server after making the SSL configuration.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44666-766897+%5BLatest%5D&amp;comment=Title%3A+Configure+1-Way+SSL%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44666-766897+05+Aug+2015+14%3A17+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Migrate_Valve_Configuration">
      ⁠</a>3.2.17.3. Migrate Valve Configuration</h3></div></div></div><div class="para">
		In previous versions of JBoss EAP, it was possible to configure Tomcat Valves by adding JAR to the <code class="filename"><em class="replaceable">EAP_HOME</em>/server/<em class="replaceable">PROFILE</em>/lib</code> directory and then configuring the one of the following files. 
		<div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
					For JBoss EAP 4.x, valves were configured in either the <code class="filename"><em class="replaceable">EAP_HOME</em>/server/<em class="replaceable">PROFILE</em>deploy/jboss-web.deployer/server.xml</code> or <code class="filename"><em class="replaceable">EAP_HOME</em>/server/<em class="replaceable">PROFILE</em>deploy/jboss-web.deployer/context.xml</code> file.
				</div></li><li class="listitem"><div class="para">
					For JBoss EAP 5.x, valves were configured in the <code class="filename"><em class="replaceable">EAP_HOME</em>/server/<em class="replaceable">PROFILE</em>deploy/jbossweb.sar/server.xml</code> file.
				</div></li></ul></div>

	</div><div class="para">
		In JBoss EAP 6, this has changed. To enable valves, you first create a module and then configure the module in the <code class="literal">web</code> subsystem of the server configuration file. For detailed instructions on how to configure valves, see the chapter entitled <em class="citetitle">Global Valves</em> in the <em class="citetitle">Administration and Configuration Guide</em> for JBoss EAP located on the Customer Portal at <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			Global Valves are not supported in JBoss EAP 6.0.x. You must upgrade to JBoss EAP 6.1 or later to use them.
		</div></div></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44667-781542+%5BLatest%5D&amp;comment=Title%3A+Migrate+Valve+Configuration%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44667-781542+13+Nov+2017+12%3A56+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Configure_the_CertificatePrincipal_Class">
      ⁠</a>3.2.17.4. Configure the CertificatePrincipal Class</h3></div></div></div><div class="para">
		In JBoss EAP 5, the <code class="classname">CertificatePrincipal</code> class was configured on the JBossWeb container by setting the <code class="code">certificatePrincipal</code> attribute for the <code class="code">Realm</code> in the <code class="filename">jbossweb-tomcat.sar/server.xml</code> file as in the following example. 
<pre class="programlisting XML"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;Realm</span><span xmlns="" class="perl_Others"> className=</span><span xmlns="" class="perl_String">"org.jboss.web.tomcat.security.JBossWebRealm"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  certificatePrincipal=</span><span xmlns="" class="perl_String">"org.jboss.security.auth.certs.SubjectDNMapping"</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Others">  allRolesMode=</span><span xmlns="" class="perl_String">"authOnly"</span><span xmlns="" class="perl_Keyword">/&gt;</span></pre>

	</div><div class="para">
		JBoss EAP 6 includes the <a href="https://access.redhat.com/documentation/en-US/JBoss_Enterprise_Application_Platform/6.4/html/API_Documentation/files/javadoc/org/jboss/security/CertificatePrincipal.html">CertificatePrincipal</a> interface along with several implementations, for example, the <a href="https://access.redhat.com/documentation/en-US/JBoss_Enterprise_Application_Platform/6.4/html/API_Documentation/files/javadoc/org/jboss/security/auth/certs/SubjectDNMapping.html">SubjectDNMapping</a> class. To use these implementations in JBoss EAP 6, you create a custom login module. For instructions on how to create a custom login module, see the <em class="citetitle">Login Module Reference</em> for Red Hat JBoss Enterprise Application Platform 6.4 located on the Customer Portal at <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4">https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/?version=6.4</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+44668-781554+%5BLatest%5D&amp;comment=Title%3A+Configure+the+CertificatePrincipal+Class%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=44668-781554+13+Nov+2017+13%3A27+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Migrate_Seam_2.2_Applications">
      ⁠</a>3.2.18. Migrate Seam 2.2 Applications</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Migrate_Seam_22_Archives_to_JBoss_Enterprise_Application_Platform_6">
      ⁠</a>3.2.18.1. Migrate Seam 2.2 Archives to JBoss EAP 6</h3></div></div></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Overview</div>
			When you migrate a Seam 2.2 application, you need to configure the datasource and specify any module dependencies. You also need to determine if the application has any dependencies on archives that do not ship with JBoss EAP 6 and copy any dependent JARs into the application <code class="filename">lib/</code> directory.
		</div><div xmlns:d="http://docbook.org/ns/docbook" class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			Applications that use Hibernate directly with Seam 2.2 may use a version of Hibernate 3 packaged inside the application. Hibernate 4, which is provided through the org.hibernate module of JBoss EAP 6, is not supported by Seam 2.2. This example is intended to help you get your application running on JBoss EAP 6 as a first step. Please be aware that packaging Hibernate 3 with a Seam 2.2 application is not a supported configuration.
		</div></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="procedure"><a id="idm139819322731648">
      ⁠</a><p class="title"><strong>Procedure 3.30. Migrate Seam 2.2 Archives</strong></p><ol class="1"><li class="step"><div class="para">
				Update the datasource configuration.
			</div><div class="para">
				Some Seam 2.2 examples use the default JDBC datasource named <code class="code">java:/ExampleDS</code>. This default datasource has changed in JBoss EAP 6 to <code class="code">java:jboss/datasources/ExampleDS</code>. If your application uses the example database, you can do one of the following. 
				<div class="itemizedlist"><ul><li class="listitem"><div class="para">
							If you want to use the example database that ships with JBoss EAP 6, modify the <code class="filename">META-INF/persistence.xml</code> file to replace the existing <code class="code">jta-data-source</code> element with the example database datasource JNDI name. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- &lt;jta-data-source&gt;java:/ExampleDS&lt;/jta-data-source&gt; --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jta-data-source&gt;</span>java:jboss/datasources/ExampleDS<span xmlns="" class="perl_Keyword">&lt;/jta-data-source&gt;</span></pre>

						</div></li><li class="listitem"><div class="para">
							If you prefer to keep your existing database, you can add the datasource definition to the <code class="filename"><em class="replaceable">EAP_HOME</em>/standalone/configuration/standalone.xml</code> file.
						</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
								You must stop the server before editing the server configuration file for your change to be persisted on server restart.
							</div></div></div><div class="para">
							The following definition is a copy of the default HSQL datasource defined in JBoss EAP 6. 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;datasource</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"ExampleDS"</span><span xmlns="" class="perl_Others"> jndi-name=</span><span xmlns="" class="perl_String">"java:/ExampleDS"</span><span xmlns="" class="perl_Others"> enabled=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> jta=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> use-java-context=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> use-ccm=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;connection-url&gt;</span>jdbc:h2:mem:test;DB_CLOSE_DELAY=-1<span xmlns="" class="perl_Keyword">&lt;/connection-url&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;driver&gt;</span>h2<span xmlns="" class="perl_Keyword">&lt;/driver&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;security&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;user-name&gt;</span>sa<span xmlns="" class="perl_Keyword">&lt;/user-name&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;password&gt;</span>sa<span xmlns="" class="perl_Keyword">&lt;/password&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/security&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/datasource&gt;</span></pre>

						</div></li><li class="listitem"><div class="para">
							You can also add the datasource definition using the Management CLI command line interface. The following is an example of the syntax you must use to add a datasource. The "\" at the end of line indicates the continuation of the command on the following line. 
							<div class="example"><a id="idm139819309699216">
      ⁠</a><p class="title"><strong>Example 3.12. Example of syntax to add the datasource definition</strong></p><div class="example-contents"><pre class="screen">
$ <em class="replaceable">EAP_HOME</em>/bin/jboss-cli --connect 
[standalone@localhost:9999 /] data-source add --name=ExampleDS --jndi-name=java:/ExampleDS \ 
      --connection-url=jdbc:h2:mem:test;DB_CLOSE_DELAY=-1 --driver-name=h2 \ 
      --user-name=sa --password=sa
</pre></div></div>

						</div></li></ul></div>
				 For more information on how to configure a datasource, see  <a class="xref" href="chap-Migrate_Your_Application.html#Update_the_DataSource_Configuration">Section 3.1.6.2, “Update the DataSource Configuration”</a>.
			</div></li><li class="step"><div class="para">
				Add any required dependencies.
			</div><div class="para">
				Because Seam 2.2 applications use JSF 1.2, you need to add dependencies for the JSF 1.2 modules and exclude the JSF 2.0 modules. To accomplish this, you need to create a <code class="filename">jboss-deployment-structure.xml</code> file in the EAR's <code class="filename">META-INF/</code> directory that contains the following data. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-deployment-structure</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:deployment-structure:1.0"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;deployment&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;dependencies&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.faces.api"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"1.2"</span><span xmlns="" class="perl_Others"> export=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>              <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"com.sun.jsf-impl"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"1.2"</span><span xmlns="" class="perl_Others"> export=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/dependencies&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/deployment&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;sub-deployment</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jboss-seam-booking.war"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;exclusions&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.faces.api"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"main"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>              <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"com.sun.jsf-impl"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"main"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/exclusions&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;dependencies&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"javax.faces.api"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"1.2"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>              <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"com.sun.jsf-impl"</span><span xmlns="" class="perl_Others"> slot=</span><span xmlns="" class="perl_String">"1.2"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>      <span xmlns="" class="perl_Keyword">&lt;/dependencies&gt;</span>
<span xmlns="" class="line">​</span>  <span xmlns="" class="perl_Keyword">&lt;/sub-deployment&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-deployment-structure&gt;</span></pre>
				 If your application uses any third-party logging frameworks you need to add those dependencies as described here: <a class="xref" href="chap-Migrate_Your_Application.html#Modify_Logging_Dependencies">Section 3.1.4.1, “Modify Logging Dependencies”</a>.
			</div></li><li class="step"><div class="para">
				If your application uses Hibernate 3.x, first try to run the application using the Hibernate 4 libraries.
			</div><div class="para">
				If your application does not use the Seam Managed Persistence Context, Hibernate search, validation, or other features that have changed with Hibernate 4, you may be able to run with the Hibernate 4 libraries. However, if you see <code class="code">ClassNotFoundExceptions</code> or <code class="code">ClassCastExceptions</code> that point to Hibernate classes, or see errors similar to the following, you may have to follow the instructions in the next step and modify the application to use Hibernate 3.3 libraries.
			</div><pre class="screen">
        Caused by: java.lang.LinkageError: loader constraint violation in interface itable initialization: when resolving method "org.jboss.seam.persistence.HibernateSessionProxy.getSession(Lorg/hibernate/EntityMode;)Lorg/hibernate/Session;" the class loader (instance of org/jboss/modules/ModuleClassLoader) of the current class, org/jboss/seam/persistence/HibernateSessionProxy, and the class loader (instance of org/jboss/modules/ModuleClassLoader) for interface org/hibernate/Session have different Class objects for the type org/hibernate/Session used in the signature
</pre></li><li class="step"><div class="para">
				Copy dependent archives from outside frameworks or other locations.
			</div><div class="para">
				If your application uses Hibernate 3.x and you are not able to use Hibernate 4 successfully with your application, you will need to copy the Hibernate 3.x JARs into the <code class="filename">/lib</code> directory and exclude the Hibernate module in the deployments section of the <code class="filename">META-INF/jboss-deployment-structure.xml</code> as follows. 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;jboss-deployment-structure</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"urn:jboss:deployment-structure:1.0"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span> <span xmlns="" class="perl_Keyword">&lt;deployment&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;exclusions&gt;</span>
<span xmlns="" class="line">​</span>     <span xmlns="" class="perl_Keyword">&lt;module</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"org.hibernate"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>   <span xmlns="" class="perl_Keyword">&lt;/exclusions&gt;</span>
<span xmlns="" class="line">​</span> <span xmlns="" class="perl_Keyword">&lt;deployment&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/jboss-deployment-structure&gt;</span></pre>

			</div><div class="para">
				There are additional steps you must take when you bundle Hibernate 3.x with your application. For more information, see  <a class="xref" href="chap-Migrate_Your_Application.html#Configure_Changes_for_Applications_That_Use_Hibernate_and_JPA1">Section 3.2.2.2, “Configure Changes for Applications That Use Hibernate and JPA”</a>.
			</div></li><li class="step"><div class="para">
				Debug and resolve Seam 2.2 JNDI errors.
			</div><div class="para">
				When you migrate a Seam 2.2 application, you may see <code class="code">javax.naming.NameNotFoundException</code> errors in the log like the following. 
<pre class="screen">javax.naming.NameNotFoundException: Name 'jboss-seam-booking' not found in context ''</pre>
				 If you don't want to modify JNDI lookups throughout the code, you can modify the application's <code class="filename">components.xml</code> file as follows.
			</div><ol class="substeps a"><li class="step"><div class="para">
						Replace the existing core-init element.
					</div><div class="para">
						First, you need to replace the existing core-init element as follows: 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Comment">&lt;!-- &lt;core:init jndi-pattern="jboss-seam-booking/#{ejbName}/local" debug="true" distributable="false"/&gt;   --&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;core:init</span><span xmlns="" class="perl_Others"> debug=</span><span xmlns="" class="perl_String">"true"</span><span xmlns="" class="perl_Others"> distributable=</span><span xmlns="" class="perl_String">"false"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre>

					</div></li><li class="step"><div class="para">
						Find the JNDI binding INFO messages in the server log
					</div><div class="para">
						Next, find the JNDI binding INFO messages that are printed in the server log when the application is deployed. The JNDI binding messages should look similar to the following. 
<pre class="screen">
INFO org.jboss.as.ejb3.deployment.processors.EjbJndiBindingsDeploymentUnitProcessor (MSC service thread 1-1) JNDI bindings for session bean
named AuthenticatorAction in deployment unit subdeployment "jboss-seam-booking.jar" of deployment "jboss-seam-booking.ear" are as follows.
    java:global/jboss-seam-booking/jboss-seam-booking.jar/AuthenticatorAction!org.jboss.seam.example.booking.Authenticator
    java:app/jboss-seam-booking.jar/AuthenticatorAction!org.jboss.seam.example.booking.Authenticator
    java:module/AuthenticatorAction!org.jboss.seam.example.booking.Authenticator
    java:global/jboss-seam-booking/jboss-seam-booking.jar/AuthenticatorAction
    java:app/jboss-seam-booking.jar/AuthenticatorAction
    java:module/AuthenticatorAction
</pre>

					</div></li><li class="step"><div class="para">
						Add component elements.
					</div><div class="para">
						For each JNDI binding INFO message in the log, add a matching <code class="code">component</code> element to the <code class="filename">components.xml</code> file. 
<pre class="programlisting"><span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;component</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.seam.example.booking.AuthenticatorAction"</span><span xmlns="" class="perl_Others"> jndi-name=</span><span xmlns="" class="perl_String">"java:app/jboss-seam-booking.jar/AuthenticatorAction"</span> <span xmlns="" class="perl_Keyword">/&gt;</span></pre>

					</div></li></ol><div class="para">
				For more information on how to debug and resolve migration issues, see  <a class="xref" href="chap-Tools_and_Tips.html#Debug_and_Resolve_Migration_Issues">Section 4.2.1, “Debug and Resolve Migration Issues”</a>.
			</div><div class="para">
				For a list of known migration issues with Seam 2 archives, see  <a class="xref" href="chap-Migrate_Your_Application.html#Seam_2.2_Archive_Migration_Issues">Section 3.2.18.2, “Seam 2.2 Archive Migration Issues”</a>.
			</div></li></ol></div><div class="para"><div xmlns:d="http://docbook.org/ns/docbook" class="title">Result</div>
			The Seam 2.2 archive deploys and runs successfully on JBoss EAP 6.
		</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4592-766877+%5BLatest%5D&amp;comment=Title%3A+Migrate+Seam+2.2+Archives+to+JBoss+EAP+6%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4592-766877+05+Aug+2015+12%3A42+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Seam_2.2_Archive_Migration_Issues">
      ⁠</a>3.2.18.2. Seam 2.2 Archive Migration Issues</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Seam 2.2 Drools and Java 7 are not compatible</span></dt><dd><div class="para">
					Seam 2.2 Drools and Java 7 are incompatible and fail with an org.drools.RuntimeDroolsException: value '1.7' is not a valid language level error.
				</div></dd><dt><span class="term">Seam 2.2.5 signed <code class="filename">cglib.jar</code> prevents the Spring example from working</span></dt><dd><div class="para">
					When the Spring example is run using the signed <code class="filename">cglib.jar</code> that shipped with Seam 2.2.5 in JBoss EAP 5, it fails with the following root cause: 
<pre class="screen">
java.lang.SecurityException: class "org.jboss.seam.example.spring.UserService$$EnhancerByCGLIB$$7d6c3d12"'s signer information does not match signer information of other classes in the same package
</pre>

				</div><div class="para">
					The work around for this issue is to unsign the <code class="filename">cglib.jar</code> as follows:
				</div><div class="para">
					<code class="command"> zip -d $SEAM_DIR/lib/cglib.jar META-INF/JBOSSCOD\*</code>
				</div></dd><dt><span class="term">Seambay example fails with <code class="classname">NotLoggedInException</code></span></dt><dd><div class="para">
					The cause of this issue is the SOAP message header being null when processing the message in the SOAPRequestHandler and consequently, the conversation ID not being set.
				</div><div class="para">
					The work around for this issue is to override <code class="classname">org.jboss.seam.webservice.SOAPRequestHandler.handleOutbound</code>, as described in <a href="https://issues.jboss.org/browse/JBPAPP-8376">https://issues.jboss.org/browse/JBPAPP-8376</a>.
				</div></dd><dt><span class="term">Seambay example fails with <code class="classname">UnsupportedOperationException</code>: no transaction</span></dt><dd><div class="para">
					This bug is caused by changes in the JNDI name of UserTransaction in JBoss EAP 6.
				</div><div class="para">
					The work around for this issue is to override <code class="classname">org.jboss.seam.transaction.Transaction.getUserTransaction</code>, as described in <a href="https://issues.jboss.org/browse/JBPAPP-8322">https://issues.jboss.org/browse/JBPAPP-8322</a>.
				</div></dd><dt><span class="term">Tasks example throws <code class="classname">org.jboss.resteasy.spi.UnhandledException</code>: Unable to unmarshall request body</span></dt><dd><div class="para">
					This bug is caused by the incompatibility between seam-resteasy-2.2.5 included in JBoss EAP 5.1.2) and RESTEasy 2.3.1.GA included in JBoss EAP 6.
				</div><div class="para">
					The work around for this issue is to use the <code class="filename">jboss-deployment-structure.xml</code> to exclude resteasy-jaxrs, resteasy-jettison-provider, and resteasy-jaxb-provider from the main deployment and resteasy-jaxrs, resteasy-jettison-provider, resteasy-jaxb-provider, and resteasy-yaml-provider from the <code class="filename">jboss-seam-tasks.war</code> as described in <a href="https://issues.jboss.org/browse/JBPAPP-8315">https://issues.jboss.org/browse/JBPAPP-8315</a>. It is then necessary to include the RESTEasy libraries bundled with Seam 2.2 in the EAR.
				</div></dd><dt><span class="term">Deadlock between <code class="classname">org.jboss.seam.core.SynchronizationInterceptor</code> and stateful component instance EJB lock during an AJAX request</span></dt><dd><div class="para">
					An error page with "Caused by javax.servlet.ServletException with message: "javax.el.ELException: /main.xhtml @36,71 value="#{hotelSearch.pageSize}": org.jboss.seam.core.LockTimeoutException: could not acquire lock on @Synchronized component: hotelSearch" or similar error message is displayed.
				</div><div class="para">
					The problem is that Seam 2 does its own locking outside the stateful session bean (SFSB) lock and with a different scope. This means that if a thread accesses an EJB twice in the same transaction, after the first invocation it will have the SFSB lock, but not the seam lock. A second thread can then acquire the seam lock, which will then hit the EJB lock and wait. When the first thread attempts its second invocation it will block on the seam 2 interceptor and deadlock. In Java EE 5, EJBs would throw an exception immediately on concurrent access. This behavior has changed in Java EE 6.
				</div><div class="para">
					The work around for this issue is to add @AccessTimeout(0) to the EJB. This will cause it to throw a <code class="classname">ConcurrentAccessException</code> immediately when this situation occurs.
				</div></dd><dt><span class="term">Dvdstore example create order fails with a <code class="classname">javax.ejb.EJBTransactionRolledbackException</code></span></dt><dd><div class="para">
					The dvdstore example displays the following error: 
<pre class="screen">
JBAS011437: Found extended persistence context in SFSB invocation call stack but that cannot be used because the transaction already has a transactional context associated with it. This can be avoided by changing application code, either eliminate the extended persistence context or the transactional context. See JPA spec 2.0 section 7.6.3.1.
</pre>

				</div><div class="para">
					This problem is due to changes in the JPA specification.
				</div><div class="para">
					The fix for this issue is to change the persistence context to <code class="literal">transactional</code> in the <code class="code">CheckoutAction</code> and <code class="code">ShowOrdersAction</code> classes and use the entity manager merge operation in the <code class="code">cancelOrder</code> and <code class="code">detailOrder</code> methods.
				</div></dd><dt><span class="term">JBoss Cache Seam Cache provider cannot be used in JBoss EAP 6</span></dt><dd><div class="para">
					JBoss Cache is not supported in JBoss EAP 6. This causes JBoss Cache Seam Cache provider to fail in a Seam application on the application server with a 
<pre class="screen">java.lang.NoClassDefFoundError: org/jboss/util/xml/JBossEntityResolver</pre>
					 .
				</div></dd><dt><span class="term">Hibernate 3.3.x Auto scan for JPA entities issue with JBoss EAP 6</span></dt><dd><div class="para">
					The fix for this issue is to list all the entity classes in the persistence.xml file manually. For example: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;?xml</span> version="1.0" encoding="UTF-8"<span xmlns="" class="perl_Keyword">?&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;persistence</span><span xmlns="" class="perl_Others"> xmlns=</span><span xmlns="" class="perl_String">"http://java.sun.com/xml/ns/persistence"</span><span xmlns="" class="perl_Others"> version=</span><span xmlns="" class="perl_String">"1.0"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;persistence-unit</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"example_pu"</span><span xmlns="" class="perl_Keyword">&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;description&gt;</span>Hibernate 3 Persistence Unit.<span xmlns="" class="perl_Keyword">&lt;/description&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;jta-data-source&gt;</span>java:jboss/datasources/ExampleDS<span xmlns="" class="perl_Keyword">&lt;/jta-data-source&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;properties&gt;</span>
<span xmlns="" class="line">​</span>            <span xmlns="" class="perl_Keyword">&lt;property</span><span xmlns="" class="perl_Others"> name=</span><span xmlns="" class="perl_String">"jboss.as.jpa.providerModule"</span><span xmlns="" class="perl_Others"> value=</span><span xmlns="" class="perl_String">"hibernate3-bundled"</span> <span xmlns="" class="perl_Keyword">/&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;/properties&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;class&gt;</span>com.acme.Foo<span xmlns="" class="perl_Keyword">&lt;/class&gt;</span>
<span xmlns="" class="line">​</span>        <span xmlns="" class="perl_Keyword">&lt;class&gt;</span>com.acme.Bar<span xmlns="" class="perl_Keyword">&lt;/class&gt;</span>
<span xmlns="" class="line">​</span>    <span xmlns="" class="perl_Keyword">&lt;/persistence-unit&gt;</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;/persistence&gt;</span>
</pre>

				</div></dd><dt><span class="term">Calling EJB Seam components from non-EJB Threads results in a javax.naming.NameNotFoundException</span></dt><dd><div class="para">
					This issue is a result of changes in JBoss EAP 6 to implement the new modular class loading system and to adopt the new standardized JNDI namespace conventions. The <code class="code">java:app</code> namespace is designated for names shared by all components in a single application. Non-EE threads, such as Quartz asynchronous threads, must use the <code class="code">java:global</code> namespace, which is shared by all applications deployed in an application server instance.
				</div><div class="para">
					If you receive a <code class="code">javax.naming.NameNotFoundException</code> when you try to call EJB Seam components from Quartz asynchronous methods, you must modify the <code class="filename">components.xml</code> file to use the global JNDI name, for example: 
<pre class="programlisting"><span xmlns="" class="line">​</span>
<span xmlns="" class="line">​</span><span xmlns="" class="perl_Keyword">&lt;component</span><span xmlns="" class="perl_Others"> class=</span><span xmlns="" class="perl_String">"org.jboss.seam.example.quartz.MyBean"</span><span xmlns="" class="perl_Others"> jndi-name=</span><span xmlns="" class="perl_String">"java:global/seam-quartz/quartz-ejb/myBean"</span><span xmlns="" class="perl_Keyword">/&gt;</span>
</pre>

				</div><div class="para">
					For more information on JNDI changes, refer to the following topic: <a class="xref" href="chap-Migrate_Your_Application.html#Update_Application_JNDI_Namespace_Names1">Section 3.1.8.1, “Update Application JNDI Namespace Names”</a> . For more information on this specific issue, refer to <em class="citetitle">BZ#948215 - Seam2.3 javax.naming.NameNotFoundException trying to call EJB Seam components from quartz asynchronous methods</em> in the <em class="citetitle">2.2.0 Release Notes</em> for <em class="citetitle">Red Hat JBoss Web Framework Kit</em> on the Red Hat Customer Portal.
				</div></dd></dl></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+9039-623882+%5BLatest%5D&amp;comment=Title%3A+Seam+2.2+Archive+Migration+Issues%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9039-623882+25+Mar+2014+01%3A14+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Migrate_Spring_Applications">
      ⁠</a>3.2.19. Migrate Spring Applications</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Migrate_Spring_Applications">
      ⁠</a>3.2.19.1. Migrate Spring Applications</h3></div></div></div><div class="para">
		Information about how to migrate Spring applications can be found in the <em class="firstterm">Red Hat JBoss Web Framework Kit</em> documentation. The <em class="citetitle">Spring Installation Guide</em> and <em class="citetitle">Spring Developer Guide</em> are available in multiple formats on the Customer Portal at <a href="https://access.redhat.com/documentation/en-US/Red_Hat_JBoss_Web_Framework_Kit/">https://access.redhat.com/documentation/en-US/Red_Hat_JBoss_Web_Framework_Kit/</a>.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+9104-765967+%5BLatest%5D&amp;comment=Title%3A+Migrate+Spring+Applications%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=9104-765967+24+Jul+2015+10%3A06+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="sect-Other_Changes_That_Affect_Migration">
      ⁠</a>3.2.20. Other Changes That Affect Migration</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Become_Familiar_with_Other_Changes_That_May_Affect_Your_Migration">
      ⁠</a>3.2.20.1. Become Familiar with Other Changes That May Affect Your Migration</h3></div></div></div><div class="para">
		The following is a list of other changes in JBoss EAP 6 that could impact your migration efforts.
	</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
				 <a class="xref" href="chap-Migrate_Your_Application.html#Change_the_Maven_Plug-in_Name">Section 3.2.20.2, “Change the Maven Plug-in Name”</a>
			</div></li><li class="listitem"><div class="para">
				 <a class="xref" href="chap-Migrate_Your_Application.html#Modify_Client_Applications">Section 3.2.20.3, “Modify Client Applications”</a>
			</div></li></ul></div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4888-591677+%5BLatest%5D&amp;comment=Title%3A+Become+Familiar+with+Other+Changes+That+May+Affect+Your+Migration%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4888-591677+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Change_the_Maven_Plug-in_Name">
      ⁠</a>3.2.20.2. Change the Maven Plug-in Name</h3></div></div></div><div class="para">
		The <code class="code">jboss-maven-plugin</code> has not been updated and does not work in JBoss EAP 6. You must now use <code class="code">org.jboss.as.plugins:jboss-as-maven-plugin</code> to deploy to the correct directory.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+4887-591677+%5BLatest%5D&amp;comment=Title%3A+Change+the+Maven+Plug-in+Name%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=4887-591677+23+Feb+2014+16%3A54+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="Modify_Client_Applications">
      ⁠</a>3.2.20.3. Modify Client Applications</h3></div></div></div><div class="para">
		If you plan to migrate a client application that will connect to JBoss EAP 6, be aware that the name and location of the JAR that bundles the client libraries has changed. This JAR is now named <code class="filename">jboss-client.jar</code> and is located in the <code class="filename"><em class="replaceable">EAP_HOME</em>/bin/client/</code> directory. It replaces the <code class="filename"><em class="replaceable">EAP_HOME</em>/client/jbossall-client.jar</code> and contains all the dependencies required to connect to JBoss EAP 6 from a remote client.
	</div><div class="para RoleCreateBugPara">
		<a href="https://bugzilla.redhat.com/enter_bug.cgi?cf_environment=Build+Name%3A+23091%2C+Red+Hat+Migration+Guide-6.4%0ABuild+Date%3A+16-11-2017+09%3A12%3A34%0ATopic+ID%3A+11567-591982+%5BLatest%5D&amp;comment=Title%3A+Modify+Client+Applications%0A%0ADescribe+the+issue%3A%0A%0A%0ASuggestions+for+improvement%3A%0A%0A%0AAdditional+information%3A&amp;cf_build_id=11567-591982+23+Feb+2014+16%3A56+en-US+%5BLatest%5D&amp;product=JBoss+Enterprise+Application+Platform+6&amp;component=Documentation&amp;version=6.4.0&amp;keywords=Documentation">Report a bug</a>
	</div></div></div></div></div></body></html>